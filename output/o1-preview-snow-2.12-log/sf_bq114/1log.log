2025-02-11 20:07:46 - openai._base_client - INFO - Retrying request to /chat/completions in 0.469320 seconds
2025-02-11 20:08:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 20:08:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:08:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:08:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:08:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 20:08:40 - snowflake.connector.connection - INFO - closed
2025-02-11 20:08:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:08:40 - root - INFO - SQL:
SELECT DISTINCT "parameter_name"
   FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
   LIMIT 100;
Results:
parameter_name
Total NMOC (non-methane organic compound)
trans-2-Pentene
3-Methylhexane
Methyl Butyl Ketone
OC1 CSN Unadjusted PM2.5 LC TOT
2-Methyl-1-butene
1-Heptene
Selenium PM10 LC
Beryllium PM2.5 LC
Phenol  (TSP) STP
Anthracene (TSP) STP
Ozone
Lead (TSP) STP
"1,1-Difluoroethane"
Light Absorption Coeffiecient
Potassium PM10 STP
"1,2,4-Trichlorobenzene (TSP) STP"
"1,1,1,2-Tetrachloroethane"
m(and p)-Xylene & bromoform
Manganese PM2.5 STP
Cobalt PM2.5 STP
Std Dev Vt Wind Speed
Nitric oxide (NO)
Cyclohexane
"2,3-Dimethylpentane"
Butyl acetate
"1,1-Dichloroethylene"
Propionaldehyde
Hexachlorobutadiene
Average Ambient Pressure
Arsenic PM10 STP
Tantalum PM2.5 LC
Ammonium Sulfate PM2.5 LC
Beryllium (TSP) STP
Nickel (TSP) STP
Aniline  (TSP) STP
Pentachlorophenol (TSP) STP
Sulfate (TSP) LC
Deciview
Elemental Carbon Extinction PM2.5 LC
"Benzo[g,h,i]perylene (TSP) STP"
Tantalum (TSP) STP
Ethyl acrylate
Std Dev Hz Wind Speed
Aluminum PM10 STP
"Particle Number, Total Count"
1-Naphthylamine (TSP) STP
Yttrium PM2.5 STP
Cobalt PM2.5 LC
Samarium PM2.5 LC
Potassium Ion PM2.5 LC
Sulfate PM2.5 LC
Ambient Min Temperature
Cerium PM2.5 LC
Molybdenum PM2.5 LC
EC CSN PM2.5 LC TOT
Soil PM2.5 LC
"2,2,4-Trimethylpentane"
Methylcyclopentane
n-Undecane
Outdoor Temperature
Ethyl alcohol
Sodium PM10 LC
EC1 CSN_Rev Unadjusted PM2.5 LC
Magnesium (TSP) STP
Chloride PM10 STP
Methane
"2,3,4,6-Tetrachlorophenol (TSP) STP"
Azobenzene  (TSP) STP
"2,4,6-Trichlorophenol (TSP) STP"
"7,12-Dimethylbenz[a]anthracene  (TSP) STP"
Total hydrocarbons
Zirconium PM10-2.5 STP
Magnesium (precip)
Silicon PM2.5 STP
n-Heptane
Ethylbenzene
Styrene
Heptanal
"2,5-Dimethylbenzaldehyde"
Chromium PM2.5 LC
Cesium PM2.5 LC
Silver PM2.5 LC
Tungsten PM2.5 LC
Ammonium Nitrate PM2.5 LC
OP PM2.5 LC TOR
EC3 PM2.5 LC
Cobalt PM10 LC
Methyl methacrylate
Rain 24hr total
Copper(precip)
Mannosan PM2.5 LC
Hexachlorocyclopentadiene (TSP) STP
2-Acetylaminofluorene (TSP) STP
Chlorobenzilate  (TSP) STP
Total dustfall (SP)
Silver (TSP) STP
Methanol
Fluoride (TSP) STP
Aluminum PM2.5 STP

2025-02-11 20:08:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:08:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:08:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:08:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-11 20:08:42 - snowflake.connector.connection - INFO - closed
2025-02-11 20:08:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:08:42 - root - INFO - SQL:
SELECT COUNT(*)
   FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
   WHERE "year" = 1990
     AND "parameter_name" = 'Acceptable PM2.5 AQI & Speciation Mass'
     AND "units_of_measure" = 'Micrograms/cubic meter (LC)';
Results:
COUNT(*)
44

2025-02-11 20:08:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:08:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:08:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:08:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 44
2025-02-11 20:08:44 - snowflake.connector.connection - INFO - closed
2025-02-11 20:08:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:08:44 - root - INFO - SQL:
SELECT *
   FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
   WHERE "year" = 1990
     AND "parameter_name" = 'Acceptable PM2.5 AQI & Speciation Mass'
     AND "units_of_measure" = 'Micrograms/cubic meter (LC)'
   LIMIT 100;
Results:
Too long, hard cut:
state_code,county_code,site_num,parameter_code,poc,latitude,longitude,datum,parameter_name,sample_duration,pollutant_standard,metric_used,method_name,year,units_of_measure,event_type,observation_count,observation_percent,completeness_indicator,valid_day_count,required_day_count,exceptional_data_count,null_data_count,primary_exceedance_count,secondary_exceedance_count,certification_indicator,num_obs_below_mdl,arithmetic_mean,arithmetic_standard_dev,first_max_value,first_max_datetime,second_max_value,second_max_datetime,third_max_value,third_max_datetime,fourth_max_value,fourth_max_datetime,first_max_non_overlapping_value,first_no_max_datetime,second_max_non_overlapping_value,second_no_max_datetime,ninety_nine_percentile,ninety_eight_percentile,ninety_five_percentile,ninety_percentile,seventy_five_percentile,fifty_percentile,ten_percentile,local_site_name,address,state_name,county_name,city_name,cbsa_name,date_of_last_change
47,009,0101,88502,1,35.63348,-83.941606,WGS84,Acceptable PM2.5 AQI & Speciation Mass,24 HOUR,,Observed Values,Multiple Methods Used,1990,Micrograms/cubic meter (LC),No Events,92,75.0,N,92,122,0,12,,,Certification not required,0,14.81396,9.898241,45.10904,650937600000000,42.0743,652492800000000,38.82716,651542400000000,34.6395,649468800000000,,,,,45.10904,42.0743,34.3402,28.47619,21.39682,11.77177,5.0,Great Smoky Mountains NP - Look Rock,GREAT SMOKY MOUNTAINS NP LOOK ROCK,Tennessee,Blount,,"Knoxville, TN",2020-05-21
04,017,0119,88502,1,34.82251,-109.89249,WGS84,Acceptable PM2.5 AQI & Speciation Mass,24 HOUR,,Observed Values,Multiple Methods Used,1990,Micrograms/cubic meter (LC),No Events,98,80.0,N,98,122,0,6,,,Certification not required,0,4.841313,3.310643,20.0,646444800000000,15.969,647049600000000,12.65432,646704000000000,10.77399,644889600000000,,,,,20.0,15.969,10.40124,9.26829,5.95541,4.58204,0.0,Petrified Forest NP - South Entrance,"PET FOR NAT PARK, NEAR OLD SW ENTERANCE ON OLD ROUTE 180",Arizona,Navajo,,"Show Low, AZ",2020-05-21
78,020,0001,88502,1,18.334399,-64.795972,WGS84,Acceptable PM2.5 AQI & Speciation Mass,24 HOUR,,Observed Values,Multiple Methods Used,1990,Micrograms/cubic meter (LC),No Events,18,67.0,N,17,27,0,5,,,Certification not required,0,4.590638,2.392119,8.5061,656985600000000,8.212,658195200000000,7.75076,661219200000000,6.636,657590400000000,,,,,8.5061,8.5061,8.5061,8.212,6.06607,4.88166,0.0,"CRUZ BAY, ST JOHN U.S. VIRGIN ISLANDS","ST JOHN, VIRGIN ISLANDS",Virgin Islands,St John,Not in a city,,2020-05-21
30,029,8001,88502,1,48.5103,-113.99681,WGS84,Acceptable PM2.5 AQI & Speciation Mass,24 HOUR,,Observed Values,Multiple Methods Used,1990,Micrograms/cubic meter (LC),No Events,100,82.0,Y,100,122,0,4,,,Certification not required,0,6.210656,3.863379,23.04487,657590400000000,16.40483,650678400000000,15.09434,660614400000000,14.88673,656726400000000,,,,,23.04487,16.40483,14.78528,11.22754,8.35913,5.40298,2.125,Glacier NP - West Glacier Horse Stables,GLACIER NATIONAL PARK,Montana,Flathead,,"Kalispell, MT",2020-05-21
08,083,0101,88502,1,37.1984,-108.49046,WGS84,Acceptable PM2.5 AQI & Speciation Mass,24 HOUR,,Observed Values,Multiple Methods Used,1990,Micrograms/cubic meter (LC),No Events,97,80.0,N,97,122,0,7,,,Certification not required,0,3.973077,2.631622,14.00651,641260800000000,11.55488,646704000000000,11.44144,651542400000000,9.01198,648864000000000,,,,,14.00651,11.55488,8.53293,7.65396,5.25525,3.52542,1.16505,Mesa Verde NP - Resource Management Area,"MESA VERDE NATIONAL PARK, COLORADO",Colorado,Montezuma,,,2020-05-21
53,053,1010,88502,1,46.75838,-122.12429,WGS84,Acceptable PM2.5 AQI & Speciation Mass,24 HOUR,,Observed Values,Multiple Methods Used,1990,Micrograms/cubic meter (LC),No Events,70,57.0,N,70,122,0,34,,,Certification not required,0,6.085609,5.47591,28.42593,654307200000000,26.08025,654566400000000,24.76489,638841600000000,19.75904,639446400000000,,,,,28.42593,26.08025,19.75904,11.23028,7.1559,4.78528,1.54574,"Mount Rainier National Park, Tahoma Woods","MOUNT RAINIER NP, TAHOMA WOODS ADMIN",Washington,Pierce,,"Seattle-Tacoma-Bellevue, WA",2020-05-21
23,009,0103,88502,1,44.37705,-68.2609,WGS84,Acceptable PM2.5 AQI & Speciation Mass,24 HOUR,,Observed Values,Multiple Methods Used,1990,Micrograms/cubic meter (LC),No Events,99,81.0,Y,99,122,0,5,,,Certification not required,0,8.179546,5.828297,28.61538,654566400000000,26.58385,648259200000000,24.16667,653097600000000,21.43322,632534400000000,,,,,28.61538,26.58385,21.2037,16.14197,10.09203,6.42857,2.34043,MCFARLAND HILL Air Pollutant Research Site,567 Eagle Lake Road,Maine,Hancock,,,2020-05-21
15,001,0005,88502,1,19.4308,-155.2578,WGS84,Acceptable PM2.5 AQI & Speciation Mass,24 HOUR,,Observed Values,Multiple Methods Used,1990,Micrograms/cubic meter (LC),No Events,80,66.0,N,80,122,0,24,,,Certification not required,0,3.097558,3.786551,22.32639,656380800000000,18.28313,652147200000000,13.31361,651888000000000,11.8018,657936000000000,,,,,22.32639,18.28313,11.8018,6.59763,3.3033,2.10059,0.0,Hawaii Volcanoes NP - Kilauea Vi

2025-02-11 20:08:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:08:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:08:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:08:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 45
2025-02-11 20:08:45 - snowflake.connector.connection - INFO - closed
2025-02-11 20:08:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:08:46 - root - INFO - SQL:
SELECT DISTINCT "year"
   FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
   ORDER BY "year"
   LIMIT 100;
Results:
year
1980
1981
1982
1983
1984
1985
1986
1987
1988
1989
1990
1991
1992
1993
1994
1995
1996
1997
1998
1999
2000
2001
2002
2003
2004
2005
2006
2007
2008
2009
2010
2011
2012
2013
2014
2015
2016
2017
2018
2019
2020
2021
2022
2023
2024

2025-02-11 20:08:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:08:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:08:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:08:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 8
2025-02-11 20:08:47 - snowflake.connector.connection - INFO - closed
2025-02-11 20:08:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:08:48 - root - INFO - SQL:
SELECT DISTINCT "pollutant"
   FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
   LIMIT 100;
Results:
pollutant
so2
o3
pm10
no2
bc
pm25
co
no

2025-02-11 20:08:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:08:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:08:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:08:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 20:08:49 - snowflake.connector.connection - INFO - closed
2025-02-11 20:08:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:08:49 - root - INFO - SQL:
SELECT *
   FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
   WHERE "pollutant" = 'pm25'
   LIMIT 100;
Results:
Too long, hard cut:
location,city,country,pollutant,value,timestamp,unit,source_name,latitude,longitude,averaged_over_in_hours,location_geom
Kuwait City,N/A,KU,pm25,39.0,1591833600000000,µg/m³,AirNow,29.292316,48.04768,1.0,bytearray(b'\x01\x01\x00\x00\x00/V\xd4`\x1a\x06H@\xf8\x18\xac8\xd5J=@')
SAN BORJA,Lima,PE,pm25,54.37,1652346000000000,µg/m³,Senamhi,1.0,-12.108872,-77.007689,bytearray(b'\x01\x01\x00\x00\x00u\xe6\x1e\x12\xbe7(\xc0\x00\x00\x00\x00\x00\x00\xf0?')
US Diplomatic Post: Ho Chi Minh City,Ho Chi Minh City,VN,pm25,16.0,1652954400000000,µg/m³,Ho Chi Minh City,1.0,10.782773,106.700035,bytearray(b'\x01\x01\x00\x00\x005bf\x9f\xc7\x90%@\x00\x00\x00\x00\x00\x00\xf0?')
Abu Dhabi,N/A,AE,pm25,53.0,1651190400000000,µg/m³,AirNow,1.0,24.42431,54.433874,bytearray(b'\x01\x01\x00\x00\x00\xa2]\x85\x94\x9fl8@\x00\x00\x00\x00\x00\x00\xf0?')
HU0057A,Csongrád,HU,pm25,7.61735,1651240800000000,µg/m³,EEA Hungary,1.0,46.2666139994637,20.153053,"bytearray(b'\x01\x01\x00\x00\x00\x1a-Th ""G@\xfe\xff\xff\xff\xff\xff\xef?')"
Sportska dvorana Topolica,Bar,ME,pm25,9.6,1651611600000000,µg/m³,Montenegro,1.0,42.103842,19.09441,bytearray(b'\x01\x01\x00\x00\x00\xc2\xf9\xd4\xb1J\rE@\x00\x00\x00\x00\x00\x00\xf0?')
US Diplomatic Post: Ashgabat,Ashgabat,TM,pm25,28.0,1651197600000000,µg/m³,StateAir_Ashgabat,1.0,37.941857,58.387945,bytearray(b'\x01\x01\x00\x00\x00\x1cA*\xc5\x8e\xf8B@\x00\x00\x00\x00\x00\x00\xf0?')
US Diplomatic Post: Dhaka,Dhaka,BD,pm25,101.0,1652378400000000,µg/m³,StateAir_Dhaka,1.0,23.796373,90.424614,bytearray(b'\x01\x01\x00\x00\x00\xdaj\xd6\x19\xdf\xcb7@\xfe\xff\xff\xff\xff\xff\xef?')
US Diplomatic Post: Amman,Amman,JO,pm25,-999.0,1652295600000000,µg/m³,StateAir_Amman,1.0,31.945388,35.880556,bytearray(b'\x01\x01\x00\x00\x00\xe7\x07\xae\xf2\x04\xf2?@\x00\x00\x00\x00\x00\x00\xf0?')
HR0012A,Krapinsko-zagorska,HR,pm25,17.1,1651924800000000,µg/m³,EEA Croatia,1.0,46.1690555550192,15.6606388888889,bytearray(b'\x01\x01\x00\x00\x00\xde\x01\xc8\x9c\xa3\x15G@\xfe\xff\xff\xff\xff\xff\xef?')
US Diplomatic Post: Karachi,Karachi,PK,pm25,42.0,1652184000000000,µg/m³,StateAir_Karachi,1.0,24.8415,67.0091,bytearray(b'\x01\x01\x00\x00\x00\x82\x95C\x8bl\xd78@\x00\x00\x00\x00\x00\x00\xf0?')
GR0030A,ΑΤΤΙΚΗ,GR,pm25,6.0,1651690800000000,µg/m³,EEA Greece,1.0,37.9432869,23.64751053,bytearray(b'\x01\x01\x00\x00\x00d\x1f\t\xa0\xbd\xf8B@\x00\x00\x00\x00\x00\x00\xf0?')
US Diplomatic Post: Dhaka,Dhaka,BD,pm25,-999.0,1652619600000000,µg/m³,StateAir_Dhaka,1.0,23.796373,90.424614,bytearray(b'\x01\x01\x00\x00\x00\xdaj\xd6\x19\xdf\xcb7@\xfe\xff\xff\xff\xff\xff\xef?')
US Diplomatic Post: Ho Chi Minh City,Ho Chi Minh City,VN,pm25,29.0,1652968800000000,µg/m³,Ho Chi Minh City,1.0,10.782773,106.700035,bytearray(b'\x01\x01\x00\x00\x005bf\x9f\xc7\x90%@\x00\x00\x00\x00\x00\x00\xf0?')
US Diplomatic Post: Karachi,Karachi,PK,pm25,51.0,1651874400000000,µg/m³,StateAir_Karachi,1.0,24.8415,67.0091,bytearray(b'\x01\x01\x00\x00\x00\x82\x95C\x8bl\xd78@\x00\x00\x00\x00\x00\x00\xf0?')
Addis Ababa Jacros,N/A,ET,pm25,23.0,1651305600000000,µg/m³,AirNow,1.0,9.011444,38.820909,"bytearray(b'\x01\x01\x00\x00\x00\x89x\xeb\xfc\xdb\x05""@\x00\x00\x00\x00\x00\x00\xf0?')"
BETN121,Luxembourg,BE,pm25,1.2025,1653357600000000,µg/m³,EEA Belgium,1.0,49.877128,5.202387,bytearray(b'\x01\x01\x00\x00\x00\xf33\xf5\xbaE\xf0H@\x00\x00\x00\x00\x00\x00\xf0?')
US Diplomatic Post: Colombo,Colombo,LK,pm25,11.0,1652304600000000,µg/m³,StateAir_Colombo,1.0,6.913253,79.848684,bytearray(b'\x01\x01\x00\x00\x00D\xe5_\xcb+\xa7\x1b@\x00\x00\x00\x00\x00\x00\xf0?')
US Diplomatic Post: Kampala,Kampala,UG,pm25,50.0,1652482800000000,µg/m³,StateAir_Kampala,1.0,0.300225,32.591553,bytearray(b'\x01\x01\x00\x00\x00-C\x1c\xeb\xe26\xd3?\x00\x00\x00\x00\x00\x00\xf0?')
BETR502,Hainaut,BE,pm25,15.7075,1652144400000000,µg/m³,EEA Belgium,1.0,50.428995,4.458681,bytearray(b'\x01\x01\x00\x00\x00\xe2\x92\xe3N\xe96I@\x00\x00\x00\x00\x00\x00\xf0?')
Obilićeva,Pljevlja,ME,pm25,31.2,1651924800000000,µg/m³,Montenegro,1.0,43.357173,19.349157,bytearray(b'\x01\x01\x00\x00\x00\xd1\x01I\xd8\xb7\xadE@\x00\x00\x00\x00\x00\x00\xf0?')
SANTA ANITA,Lima,PE,pm25,36.49,1651734000000000,µg/m³,Senamhi,1.0,-12.043022,-76.971444,bytearray(b'\x01\x01\x00\x00\x00]\x04\xc6\xfa\x06\x16(\xc0\x00\x00\x00\x00\x00\x00\xf0?')
SAN BORJA,Lima,PE,pm25,20.92,1651784400000000,µg/m³,Senamhi,1.0,-12.108872,-77.007689,bytearray(b'\x01\x01\x00\x00\x00u\xe6\x1e\x12\xbe7(\xc0\x00\x00\x00\x00\x00\x00\xf0?')
SANTA ANITA,Lima,PE,pm25,63.06,1651204800000000,µg/m³,Senamhi,1.0,-12.043022,-76.971444,bytearray(b'\x01\x01\x00\x00\x00]\x04\xc6\xfa\x06\x16(\xc0\x00\x00\x00\x00\x00\x00\xf0?')
Banja Luka,N/A,BK,pm25,11.0,1652374800000000,µg/m³,AirNow,1.0,44.7725,17.185556,bytearray(b'\x01\x01\x00\x00\x00{\x14\xaeG\xe1bF@\x00\x00\x00\x00\x00\x00\xf0?')
IE0028A,Dublin City,IE,pm25,8.59,1651075200000000,µg/m³,EEA Ireland,1.0,53.353889,-6.278056,bytearray(b'\x01\x01\x00\x00\x00\x03\xb5\x18<L\xadJ@\x00\x00\x00\x00\x00\x00\xf0?')
Khartoum Embassy,N/A,SU,pm25,66.0,1652994000000000,µg/m³,StateAir_KhartoumResidential

2025-02-11 20:08:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:08:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:08:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:08:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 20:08:51 - snowflake.connector.connection - INFO - closed
2025-02-11 20:08:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:08:52 - root - INFO - SQL:
SELECT DISTINCT EXTRACT(YEAR FROM TO_TIMESTAMP("timestamp" / 1000)) AS "year"
   FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
   ORDER BY "year"
   LIMIT 100;
Results:
year
39077
39236
39493
39647
40580
40597
46166
46332
46583
46704
47239
47254
47491
47605
47668
47671
47690
47691
47701
47720
47757
47762
47793
47830
47835
47882
47887
47913
47963
48030
48078
48097
48103
48115
48116
48119
48138
48139
48149
48151
48159
48167
48175
48177
48190
48192
48193
48194
48195
48196
48197
48200
48208
48217
48220
48245
48249
48269
48270
48271
48275
48278
48288
48289
48291
48292
48296
48307
48339
48363
48400
48403
48408
48409
48419
48421
48422
48431
48437
48449
48451
48452
48458
48460
48463
48465
48469
48471
48486
48505
48531
48540
48543
48544
48556
48567
48570
48573
48581
48601

2025-02-11 20:08:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:08:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:08:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:08:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-11 20:08:53 - snowflake.connector.connection - INFO - closed
2025-02-11 20:08:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:09:12 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 20:09:12 - root - INFO - ```sql
SELECT COUNT(*)
FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
WHERE "pollutant" = 'pm25'
  AND EXTRACT(YEAR FROM TO_TIMESTAMP("timestamp" / 1000000)) = 2020;
```
2025-02-11 20:09:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:09:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:09:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:09:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-11 20:09:13 - snowflake.connector.connection - INFO - closed
2025-02-11 20:09:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:10:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 20:10:13 - root - INFO - SQL:
SELECT COUNT(*)
FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
WHERE "pollutant" = 'pm25'
  AND EXTRACT(YEAR FROM TO_TIMESTAMP("timestamp" / 1000000)) = 2020;
Results:
COUNT(*)
3093

2025-02-11 20:10:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:10:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:10:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:10:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-11 20:10:14 - snowflake.connector.connection - INFO - closed
2025-02-11 20:10:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:11:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 20:11:25 - root - INFO - ```sql
SELECT COUNT(*)
FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
WHERE "pollutant" = 'pm25'
  AND EXTRACT(YEAR FROM TO_TIMESTAMP("timestamp" / 1000000)) = 2022;
```
2025-02-11 20:11:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:11:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:11:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:11:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-11 20:11:26 - snowflake.connector.connection - INFO - closed
2025-02-11 20:11:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:12:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 20:12:22 - root - INFO - SQL:
SELECT COUNT(*)
FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
WHERE "pollutant" = 'pm25'
  AND EXTRACT(YEAR FROM TO_TIMESTAMP("timestamp" / 1000000)) = 2022;
Results:
COUNT(*)
1193344

2025-02-11 20:12:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:12:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:12:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:12:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 42
2025-02-11 20:12:23 - snowflake.connector.connection - INFO - closed
2025-02-11 20:12:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:12:24 - root - INFO - SQL:
SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon"
    FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
    WHERE "year" = 1990
      AND "parameter_name" = 'Acceptable PM2.5 AQI & Speciation Mass'
      AND "units_of_measure" = 'Micrograms/cubic meter (LC)'
    GROUP BY "lat", "lon"
    LIMIT 100;
Results:
lat,lon
47.92,-89.15
37.62,-112.17
38.98,-120.1
35.63,-83.94
46.76,-122.12
44.38,-68.26
19.43,-155.26
38.52,-78.43
38.12,-122.91
37.71,-119.71
29.3,-103.18
63.72,-148.97
40.28,-105.55
32.01,-109.39
36.08,-112.16
37.66,-107.8
38.88,-77.03
44.57,-110.4
33.65,-111.11
34.82,-109.89
36.48,-121.16
25.39,-80.68
32.17,-110.74
43.75,-101.94
36.08,-112.13
38.93,-119.97
34.19,-116.91
37.72,-105.52
40.36,-105.56
48.41,-92.83
35.8,-106.3
42.97,-109.76
38.78,-109.6
41.56,-124.08
42.91,-122.14
18.33,-64.8
48.51,-114.0
37.2,-108.49
40.54,-121.58
31.83,-104.81
41.89,-115.43
38.46,-109.82

2025-02-11 20:12:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:12:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:12:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:12:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-11 20:12:25 - snowflake.connector.connection - INFO - closed
2025-02-11 20:12:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:12:52 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 20:12:52 - root - INFO - ```sql
SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon"
FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
WHERE "year" = 1990
  AND "parameter_name" LIKE '%PM2.5%'
GROUP BY "lat", "lon"
LIMIT 100;
```
2025-02-11 20:12:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:12:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:12:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:12:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 89
2025-02-11 20:12:54 - snowflake.connector.connection - INFO - closed
2025-02-11 20:12:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:13:48 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 20:13:48 - root - INFO - SQL:
SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon"
FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
WHERE "year" = 1990
  AND "parameter_name" LIKE '%PM2.5%'
GROUP BY "lat", "lon"
LIMIT 100;
Results:
lat,lon
42.31,-83.15
38.52,-90.34
34.19,-116.91
37.66,-107.8
29.96,-90.12
40.36,-80.62
34.14,-117.92
34.09,-80.96
33.65,-111.11
38.85,-122.76
42.23,-83.21
40.32,-80.61
41.56,-124.08
36.34,-120.11
40.76,-73.98
44.38,-68.26
19.43,-155.26
35.14,-119.46
37.95,-121.27
33.82,-118.19
37.34,-121.89
32.79,-115.56
37.64,-120.99
36.09,-119.56
38.9,-104.76
40.31,-80.61
40.34,-80.62
35.76,-117.37
38.93,-119.97
37.72,-105.52
38.88,-77.03
36.08,-112.13
48.41,-92.83
38.77,-90.29
40.73,-74.14
42.97,-109.76
40.76,-73.97
38.78,-109.6
40.75,-73.99
34.82,-109.89
48.51,-114.0
46.76,-122.12
40.54,-121.58
25.39,-80.68
37.2,-108.49
36.61,-118.06
36.95,-120.04
39.19,-122.0
41.89,-115.43
40.44,-80.07
37.71,-119.71
43.75,-101.94
35.37,-119.02
39.2,-106.83
36.08,-112.16
47.92,-89.15
35.8,-106.3
37.65,-118.97
38.98,-120.1
42.91,-122.14
43.07,-76.18
32.94,-79.66
35.63,-83.94
18.33,-64.8
36.48,-121.16
36.33,-119.29
38.77,-122.7
38.87,-106.98
36.78,-119.77
38.52,-78.43
38.12,-122.91
40.28,-105.55
32.01,-109.39
63.72,-148.97
40.36,-105.56
36.08,-80.3
38.65,-90.35
38.73,-90.38
37.62,-112.17
44.57,-110.4
34.0,-117.42
31.76,-106.49
40.01,-75.1
31.83,-104.81
32.17,-110.74
40.64,-74.21
37.65,-121.0
29.3,-103.18
38.46,-109.82

2025-02-11 20:13:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:13:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:13:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:13:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-11 20:13:49 - snowflake.connector.connection - INFO - closed
2025-02-11 20:13:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:14:28 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 20:14:28 - root - INFO - ```sql
-- Corrected Query 1
SELECT DISTINCT e."lat", e."lon"
FROM (
  SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon"
  FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
  WHERE "year" = 1990
    AND "parameter_name" LIKE '%PM2.5%'
    AND "latitude" IS NOT NULL
    AND "longitude" IS NOT NULL
) e
INNER JOIN (
  SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon"
  FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
  WHERE "pollutant" = 'pm25'
    AND EXTRACT(YEAR FROM TO_TIMESTAMP("timestamp" / 1000000)) = 2022
    AND "latitude" IS NOT NULL
    AND "longitude" IS NOT NULL
) o ON e."lat" = o."lat" AND e."lon" = o."lon"
LIMIT 100;
```

```sql
-- Corrected Query 2
SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon", AVG("arithmetic_mean") AS "avg_pm25_1990"
FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
WHERE "year" = 1990
  AND "parameter_name" LIKE '%PM2.5%'
  AND "arithmetic_mean" IS NOT NULL
  AND "latitude" IS NOT NULL
  AND "longitude" IS NOT NULL
GROUP BY "lat", "lon"
LIMIT 100;
```

```sql
-- Corrected Query 3
SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon", AVG("value") AS "avg_pm25_2022"
FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
WHERE "pollutant" = 'pm25'
  AND EXTRACT(YEAR FROM TO_TIMESTAMP("timestamp" / 1000000)) = 2022
  AND "value" IS NOT NULL
  AND "latitude" IS NOT NULL
  AND "longitude" IS NOT NULL
GROUP BY "lat", "lon"
LIMIT 100;
```

```sql
-- Corrected Query 4
SELECT "city_name", ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon"
FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
WHERE "year" = 1990
  AND "parameter_name" LIKE '%PM2.5%'
  AND "city_name" IS NOT NULL
  AND "latitude" IS NOT NULL
  AND "longitude" IS NOT NULL
LIMIT 100;
```
2025-02-11 20:14:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:14:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:14:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:14:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-11 20:14:30 - snowflake.connector.connection - INFO - closed
2025-02-11 20:14:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:15:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 20:15:17 - root - INFO - ```sql
SELECT DISTINCT e."lat", e."lon"
FROM (
  SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon"
  FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
  WHERE "year" = 1990
) e
INNER JOIN (
  SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon"
  FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
  WHERE "pollutant" = 'pm25'
) o ON e."lat" = o."lat" AND e."lon" = o."lon"
LIMIT 100;
```
2025-02-11 20:15:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:15:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:15:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:15:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 20:15:19 - snowflake.connector.connection - INFO - closed
2025-02-11 20:15:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:15:48 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 20:15:48 - root - INFO - SQL:
SELECT DISTINCT e."lat", e."lon"
FROM (
  SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon"
  FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
  WHERE "year" = 1990
) e
INNER JOIN (
  SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon"
  FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
  WHERE "pollutant" = 'pm25'
) o ON e."lat" = o."lat" AND e."lon" = o."lon"
LIMIT 100;
Results:
lat,lon
39.28,-84.37
33.39,-86.82
37.64,-120.99
37.96,-119.12
38.61,-121.37
47.36,-68.32
47.27,-122.39
44.38,-68.26
42.31,-83.15
40.0,-82.99
40.15,-79.9
38.61,-90.16
42.95,-82.46
35.49,-120.67
39.42,-75.03
42.19,-121.73
40.74,-73.59
28.75,-81.31
37.7,-97.31
33.57,-112.19
34.09,-80.96
48.95,-122.55
58.39,-134.57
40.85,-73.97
36.98,-121.99
35.19,-106.51
34.28,-118.68
35.94,-84.54
35.86,-78.57
35.02,-120.56
47.21,-123.1
41.77,-88.15
32.84,-116.77
36.38,-105.58
37.26,-93.3
40.73,-74.05
33.33,-87.0
41.82,-90.21
35.95,-96.0
41.73,-122.63
43.74,-122.48
32.79,-116.94
40.25,-111.66
38.1,-122.24
43.47,-88.62
38.14,-85.58
44.03,-123.08
33.48,-112.14
47.5,-122.28
38.88,-77.03
37.56,-77.4
36.18,-86.74
35.77,-83.94
40.32,-79.87
34.14,-117.85
36.16,-115.11
31.75,-106.4
41.76,-72.67
41.49,-81.68
34.76,-92.28
41.1,-80.66
61.33,-149.57
41.44,-75.62
35.73,-81.37
39.31,-75.8
40.81,-96.68
39.53,-107.78
47.61,-122.2
42.89,-73.25
38.07,-84.5
37.94,-122.03
29.73,-95.26
34.1,-117.63
27.89,-82.54
42.3,-72.33
37.77,-122.4
42.14,-80.04
45.29,-121.78
42.19,-72.56
34.81,-83.24
36.33,-119.29
33.69,-84.29
38.52,-78.43
45.26,-122.59
27.79,-82.74
37.97,-122.52
45.5,-122.6
40.55,-122.38
39.54,-119.75
42.98,-85.67
44.48,-73.21
38.67,-120.94
25.79,-80.22
39.79,-104.99
39.99,-75.08
47.03,-122.82
48.76,-122.44
36.3,-86.65
34.26,-85.32
38.23,-85.82

2025-02-11 20:15:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:15:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:15:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:15:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 42
2025-02-11 20:15:49 - snowflake.connector.connection - INFO - closed
2025-02-11 20:15:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:15:49 - root - INFO - SQL:
SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon", AVG("arithmetic_mean") AS "avg_pm25_1990"
    FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
    WHERE "year" = 1990
      AND "parameter_name" = 'Acceptable PM2.5 AQI & Speciation Mass'
      AND "units_of_measure" = 'Micrograms/cubic meter (LC)'
    GROUP BY "lat", "lon"
    LIMIT 100;
Results:
lat,lon,avg_pm25_1990
47.92,-89.15,5.444296
37.62,-112.17,3.129025
38.98,-120.1,2.808961
35.63,-83.94,14.81396
46.76,-122.12,6.085609
44.38,-68.26,8.179546
19.43,-155.26,3.097558
38.52,-78.43,11.873345
38.12,-122.91,7.298337
37.71,-119.71,4.977234
29.3,-103.18,6.214457
63.72,-148.97,3.140923
40.28,-105.55,2.177029
32.01,-109.39,4.318591
36.08,-112.16,3.586879
37.66,-107.8,3.437746
38.88,-77.03,15.31707
44.57,-110.4,3.236092
33.65,-111.11,5.183431
34.82,-109.89,4.841313
36.48,-121.16,6.732712
25.39,-80.68,8.037468
32.17,-110.74,5.673265
43.75,-101.94,5.304384
36.08,-112.13,4.8095300000000005
38.93,-119.97,8.26853
34.19,-116.91,10.023154
37.72,-105.52,4.314568
40.36,-105.56,4.387627
48.41,-92.83,5.188732
35.8,-106.3,3.603756
42.97,-109.76,2.905573
38.78,-109.6,4.810891
41.56,-124.08,4.947744
42.91,-122.14,3.133994
18.33,-64.8,4.590638
48.51,-114.0,6.210656
37.2,-108.49,3.973077
40.54,-121.58,2.383836
31.83,-104.81,5.785072
41.89,-115.43,3.839134
38.46,-109.82,3.942235

2025-02-11 20:15:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:15:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:15:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:15:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-11 20:15:51 - snowflake.connector.connection - INFO - closed
2025-02-11 20:15:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:16:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 20:16:32 - root - INFO - ```sql
SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon",
       AVG("arithmetic_mean") AS "avg_pm25"
FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
WHERE "parameter_name" LIKE '%PM2.5%'
  AND "arithmetic_mean" IS NOT NULL
GROUP BY "lat", "lon"
LIMIT 100;
```
2025-02-11 20:16:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:16:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:16:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:16:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 20:16:33 - snowflake.connector.connection - INFO - closed
2025-02-11 20:16:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:16:46 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 20:16:46 - root - INFO - SQL:
SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon",
       AVG("arithmetic_mean") AS "avg_pm25"
FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
WHERE "parameter_name" LIKE '%PM2.5%'
  AND "arithmetic_mean" IS NOT NULL
GROUP BY "lat", "lon"
LIMIT 100;
Results:
lat,lon,avg_pm25
37.11,-113.58,8.875
41.22,-111.97,13.28046853846154
39.93,-75.22,3.149440719594595
33.57,-112.19,6.134070261044177
37.36,-118.42,13.785045209090908
38.75,-121.26,10.770193879569891
34.89,-120.43,3.2561405555555556
37.64,-120.99,3.4728813618784535
38.08,-102.62,4.303231888888889
39.87,-108.22,4.744968277777777
28.75,-81.31,7.900875229390681
32.61,-83.6,10.750131393719808
47.32,-116.57,9.982750975095787
41.53,-88.12,11.295939829166667
31.18,-92.41,9.170169807407408
39.34,-76.59,6.3812543
42.47,-70.97,7.545908475675675
42.35,-71.1,9.497459566153848
42.76,-84.56,7.785607
46.85,-95.85,6.5032669806451615
36.14,-115.18,8.318611580645161
40.77,-74.04,7.456947824561404
40.73,-74.05,11.091138699570815
46.83,-100.77,2.2392121702127663
41.48,-81.68,2.560245805959806
40.74,-111.87,2.27632115844315
40.77,-111.83,3.540619888888889
39.48,-80.13,11.405757504132229
43.02,-87.93,4.928473900564972
44.1,-115.97,6.431406429824561
44.95,-93.26,1.5982073133286814
37.7,-94.03,3.1773460053128693
40.82,-73.9,2.4580764683020946
35.86,-78.57,3.225738024658348
40.0,-82.99,10.876826568831168
40.15,-79.9,11.564224155688624
44.09,-103.27,7.425559432664756
47.89,-117.99,6.074333797297298
48.27,-116.55,10.182792000000001
31.57,-91.46,11.821990357142857
42.83,-108.74,9.9917195
41.21,-111.98,9.80826339721793
33.83,-87.27,13.27164792
35.05,-118.15,6.4501286222222225
40.32,-80.61,4.178710430046948
45.24,-86.99,7.444856428571429
40.7,-75.18,11.381964854166668
42.26,-71.8,9.127269111111111
43.16,-93.21,10.444746222222223
32.11,-81.16,11.420835507575758
34.63,-87.05,18.57698866666667
33.28,-86.35,12.397166484848485
41.66,-87.7,14.16409676335878
37.65,-97.36,9.429145
40.6,-74.13,10.967842807692309
36.31,-79.47,6.642179684931507
45.8,-108.43,7.601541305555555
33.82,-118.19,7.961860139103554
42.2,-86.31,10.057061272727275
26.6,-81.88,7.348743023391814
44.14,-87.62,2.5573489600000006
36.7,-97.09,8.699057890909092
32.48,-84.98,12.3854187
35.15,-80.87,11.533985384479717
28.0,-82.78,10.726425857142857
18.26,-66.85,5.8272038
29.39,-94.92,12.235407999999998
40.25,-77.14,15.8605435
44.94,-93.01,9.784374999999999
38.42,-82.43,12.440317305084747
39.52,-84.37,15.743814200000001
46.6,-112.04,7.7697299338521395
40.69,-91.99,10.552055421875
38.22,-84.84,13.142124843137253
33.82,-117.91,21.08759275
37.66,-107.8,0.38671333918128653
36.61,-92.92,1.0024677838099856
40.34,-76.38,6.54858534375
37.27,-107.88,12.895833333333334
40.76,-73.98,36.068884583333336
33.46,-116.97,0.8659630539160045
42.05,-88.11,18.179212666666665
37.3,-107.48,0.24692949724137933
36.78,-87.85,2.3294427009345795
39.24,-76.71,2.3676661857142856
38.89,-121.31,14.1813975
44.57,-69.62,10.710259999999998
45.46,-122.62,0.6726445
58.37,-134.52,3.157895
45.66,-118.69,6.188207388888888
17.96,-66.16,7.2801605
35.9,-96.01,6.727106750000001
64.85,-147.68,3.6593088287037037
64.78,-147.36,25.51117975
41.06,-73.53,12.86055376923077
29.67,-95.13,1.0103835152998777
47.14,-122.3,8.684082842592593
40.8,-74.48,10.552353072916665
41.91,-71.67,9.34377037037037
30.53,-87.2,5.020667117596567

2025-02-11 20:16:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:16:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:16:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:16:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 44
2025-02-11 20:16:47 - snowflake.connector.connection - INFO - closed
2025-02-11 20:16:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:16:47 - root - INFO - SQL:
SELECT "city_name", ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon"
    FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
    WHERE "year" = 1990
      AND "parameter_name" = 'Acceptable PM2.5 AQI & Speciation Mass'
      AND "units_of_measure" = 'Micrograms/cubic meter (LC)'
    LIMIT 100;
Results:
city_name,lat,lon
Grand Canyon,36.08,-112.16
,36.08,-112.13
,36.08,-112.13
South Lake Tahoe,38.93,-119.97
,34.19,-116.91
,37.72,-105.52
,40.36,-105.56
,37.66,-107.8
Washington,38.88,-77.03
,47.92,-89.15
,48.41,-92.83
Not in a city,35.8,-106.3
,37.62,-112.17
,42.97,-109.76
,44.57,-110.4
,38.98,-120.1
Tonto National Monument,33.65,-111.11
,38.78,-109.6
Redwood National Park,41.56,-124.08
,42.91,-122.14
,35.63,-83.94
,34.82,-109.89
Not in a city,18.33,-64.8
,48.51,-114.0
,37.2,-108.49
,46.76,-122.12
,44.38,-68.26
Hawaii Volcanoes National Park,19.43,-155.26
,40.54,-121.58
,36.48,-121.16
,31.83,-104.81
,25.39,-80.68
,32.17,-110.74
,41.89,-115.43
,38.52,-78.43
,48.41,-92.83
Point Reyes National Seashore,38.12,-122.91
,37.71,-119.71
,29.3,-103.18
,63.72,-148.97
,40.28,-105.55
,32.01,-109.39
,43.75,-101.94
,38.46,-109.82

2025-02-11 20:16:47 - root - INFO - itercount: 0
2025-02-11 20:16:47 - root - INFO - Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,0
table_name,CO_HOURLY_SUMMARY
description,
DDL,"create or replace TABLE CO_HOURLY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""date_local"" DATE,
	""time_local"" VARCHAR(16777216),
	""date_gmt"" DATE,
	""time_gmt"" VARCHAR(16777216),
	""sample_measurement"" FLOAT,
	""units_of_measure"" VARCHAR(16777216),
	""mdl"" FLOAT,
	""uncertainty"" FLOAT,
	""qualifier"" VARCHAR(16777216),
	""method_type"" VARCHAR(16777216),
	""method_code"" VARCHAR(16777216),
	""method_name"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,1
table_name,NONOXNOY_HOURLY_SUMMARY
description,
DDL,"create or replace TABLE NONOXNOY_HOURLY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""date_local"" DATE,
	""time_local"" VARCHAR(16777216),
	""date_gmt"" DATE,
	""time_gmt"" VARCHAR(16777216),
	""sample_measurement"" FLOAT,
	""units_of_measure"" VARCHAR(16777216),
	""mdl"" FLOAT,
	""uncertainty"" FLOAT,
	""qualifier"" VARCHAR(16777216),
	""method_type"" VARCHAR(16777216),
	""method_code"" VARCHAR(16777216),
	""method_name"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,2
table_name,O3_DAILY_SUMMARY
description,
DDL,"create or replace TABLE O3_DAILY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""sample_duration"" VARCHAR(16777216),
	""pollutant_standard"" VARCHAR(16777216),
	""date_local"" DATE,
	""units_of_measure"" VARCHAR(16777216),
	""event_type"" VARCHAR(16777216),
	""observation_count"" NUMBER(38,0),
	""observation_percent"" FLOAT,
	""arithmetic_mean"" FLOAT,
	""first_max_value"" FLOAT,
	""first_max_hour"" NUMBER(38,0),
	""aqi"" NUMBER(38,0),
	""method_code"" NUMBER(38,0),
	""method_name"" VARCHAR(16777216),
	""local_site_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""city_name"" VARCHAR(16777216),
	""cbsa_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,3
table_name,VOC_HOURLY_SUMMARY
description,
DDL,"create or replace TABLE VOC_HOURLY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""date_local"" DATE,
	""time_local"" VARCHAR(16777216),
	""date_gmt"" DATE,
	""time_gmt"" VARCHAR(16777216),
	""sample_measurement"" FLOAT,
	""units_of_measure"" VARCHAR(16777216),
	""mdl"" FLOAT,
	""uncertainty"" FLOAT,
	""qualifier"" VARCHAR(16777216),
	""method_type"" VARCHAR(16777216),
	""method_code"" VARCHAR(16777216),
	""method_name"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,4
table_name,WIND_DAILY_SUMMARY
description,
DDL,"create or replace TABLE WIND_DAILY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""sample_duration"" VARCHAR(16777216),
	""pollutant_standard"" VARCHAR(16777216),
	""date_local"" DATE,
	""units_of_measure"" VARCHAR(16777216),
	""event_type"" VARCHAR(16777216),
	""observation_count"" NUMBER(38,0),
	""observation_percent"" FLOAT,
	""arithmetic_mean"" FLOAT,
	""first_max_value"" FLOAT,
	""first_max_hour"" NUMBER(38,0),
	""aqi"" NUMBER(38,0),
	""method_code"" NUMBER(38,0),
	""method_name"" VARCHAR(16777216),
	""local_site_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""city_name"" VARCHAR(16777216),
	""cbsa_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,5
table_name,HAP_DAILY_SUMMARY
description,
DDL,"create or replace TABLE HAP_DAILY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""sample_duration"" VARCHAR(16777216),
	""pollutant_standard"" VARCHAR(16777216),
	""date_local"" DATE,
	""units_of_measure"" VARCHAR(16777216),
	""event_type"" VARCHAR(16777216),
	""observation_count"" NUMBER(38,0),
	""observation_percent"" FLOAT,
	""arithmetic_mean"" FLOAT,
	""first_max_value"" FLOAT,
	""first_max_hour"" NUMBER(38,0),
	""aqi"" NUMBER(38,0),
	""method_code"" NUMBER(38,0),
	""method_name"" VARCHAR(16777216),
	""local_site_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""city_name"" VARCHAR(16777216),
	""cbsa_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,6
table_name,PM10_DAILY_SUMMARY
description,
DDL,"create or replace TABLE PM10_DAILY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""sample_duration"" VARCHAR(16777216),
	""pollutant_standard"" VARCHAR(16777216),
	""date_local"" DATE,
	""units_of_measure"" VARCHAR(16777216),
	""event_type"" VARCHAR(16777216),
	""observation_count"" NUMBER(38,0),
	""observation_percent"" FLOAT,
	""arithmetic_mean"" FLOAT,
	""first_max_value"" FLOAT,
	""first_max_hour"" NUMBER(38,0),
	""aqi"" NUMBER(38,0),
	""method_code"" NUMBER(38,0),
	""method_name"" VARCHAR(16777216),
	""local_site_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""city_name"" VARCHAR(16777216),
	""cbsa_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,7
table_name,PM25_NONFRM_DAILY_SUMMARY
description,
DDL,"create or replace TABLE PM25_NONFRM_DAILY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""sample_duration"" VARCHAR(16777216),
	""pollutant_standard"" VARCHAR(16777216),
	""date_local"" DATE,
	""units_of_measure"" VARCHAR(16777216),
	""event_type"" VARCHAR(16777216),
	""observation_count"" NUMBER(38,0),
	""observation_percent"" FLOAT,
	""arithmetic_mean"" FLOAT,
	""first_max_value"" FLOAT,
	""first_max_hour"" NUMBER(38,0),
	""aqi"" NUMBER(38,0),
	""method_code"" NUMBER(38,0),
	""method_name"" VARCHAR(16777216),
	""local_site_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""city_name"" VARCHAR(16777216),
	""cbsa_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,8
table_name,RH_AND_DP_HOURLY_SUMMARY
description,
DDL,"create or replace TABLE RH_AND_DP_HOURLY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""date_local"" DATE,
	""time_local"" VARCHAR(16777216),
	""date_gmt"" DATE,
	""time_gmt"" VARCHAR(16777216),
	""sample_measurement"" FLOAT,
	""units_of_measure"" VARCHAR(16777216),
	""mdl"" FLOAT,
	""uncertainty"" FLOAT,
	""qualifier"" VARCHAR(16777216),
	""method_type"" VARCHAR(16777216),
	""method_code"" VARCHAR(16777216),
	""method_name"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,9
table_name,WIND_HOURLY_SUMMARY
description,
DDL,"create or replace TABLE WIND_HOURLY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""date_local"" DATE,
	""time_local"" VARCHAR(16777216),
	""date_gmt"" DATE,
	""time_gmt"" VARCHAR(16777216),
	""sample_measurement"" FLOAT,
	""units_of_measure"" VARCHAR(16777216),
	""mdl"" FLOAT,
	""uncertainty"" FLOAT,
	""qualifier"" VARCHAR(16777216),
	""method_type"" VARCHAR(16777216),
	""method_code"" VARCHAR(16777216),
	""method_name"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,10
table_name,PM25_FRM_DAILY_SUMMARY
description,
DDL,"create or replace TABLE PM25_FRM_DAILY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""sample_duration"" VARCHAR(16777216),
	""pollutant_standard"" VARCHAR(16777216),
	""date_local"" DATE,
	""units_of_measure"" VARCHAR(16777216),
	""event_type"" VARCHAR(16777216),
	""observation_count"" NUMBER(38,0),
	""observation_percent"" FLOAT,
	""arithmetic_mean"" FLOAT,
	""first_max_value"" FLOAT,
	""first_max_hour"" NUMBER(38,0),
	""aqi"" NUMBER(38,0),
	""method_code"" NUMBER(38,0),
	""method_name"" VARCHAR(16777216),
	""local_site_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""city_name"" VARCHAR(16777216),
	""cbsa_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,11
table_name,TEMPERATURE_DAILY_SUMMARY
description,
DDL,"create or replace TABLE TEMPERATURE_DAILY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""sample_duration"" VARCHAR(16777216),
	""pollutant_standard"" VARCHAR(16777216),
	""date_local"" DATE,
	""units_of_measure"" VARCHAR(16777216),
	""event_type"" VARCHAR(16777216),
	""observation_count"" NUMBER(38,0),
	""observation_percent"" FLOAT,
	""arithmetic_mean"" FLOAT,
	""first_max_value"" FLOAT,
	""first_max_hour"" NUMBER(38,0),
	""aqi"" NUMBER(38,0),
	""method_code"" NUMBER(38,0),
	""method_name"" VARCHAR(16777216),
	""local_site_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""city_name"" VARCHAR(16777216),
	""cbsa_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,12
table_name,NO2_HOURLY_SUMMARY
description,
DDL,"create or replace TABLE NO2_HOURLY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""date_local"" DATE,
	""time_local"" VARCHAR(16777216),
	""date_gmt"" DATE,
	""time_gmt"" VARCHAR(16777216),
	""sample_measurement"" FLOAT,
	""units_of_measure"" VARCHAR(16777216),
	""mdl"" FLOAT,
	""uncertainty"" FLOAT,
	""qualifier"" VARCHAR(16777216),
	""method_type"" VARCHAR(16777216),
	""method_code"" VARCHAR(16777216),
	""method_name"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,13
table_name,O3_HOURLY_SUMMARY
description,
DDL,"create or replace TABLE O3_HOURLY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""date_local"" DATE,
	""time_local"" VARCHAR(16777216),
	""date_gmt"" DATE,
	""time_gmt"" VARCHAR(16777216),
	""sample_measurement"" FLOAT,
	""units_of_measure"" VARCHAR(16777216),
	""mdl"" FLOAT,
	""uncertainty"" FLOAT,
	""qualifier"" VARCHAR(16777216),
	""method_type"" VARCHAR(16777216),
	""method_code"" VARCHAR(16777216),
	""method_name"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,14
table_name,PM10_HOURLY_SUMMARY
description,
DDL,"create or replace TABLE PM10_HOURLY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""date_local"" DATE,
	""time_local"" VARCHAR(16777216),
	""date_gmt"" DATE,
	""time_gmt"" VARCHAR(16777216),
	""sample_measurement"" FLOAT,
	""units_of_measure"" VARCHAR(16777216),
	""mdl"" FLOAT,
	""uncertainty"" FLOAT,
	""qualifier"" VARCHAR(16777216),
	""method_type"" VARCHAR(16777216),
	""method_code"" VARCHAR(16777216),
	""method_name"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,15
table_name,PRESSURE_DAILY_SUMMARY
description,
DDL,"create or replace TABLE PRESSURE_DAILY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""sample_duration"" VARCHAR(16777216),
	""pollutant_standard"" VARCHAR(16777216),
	""date_local"" DATE,
	""units_of_measure"" VARCHAR(16777216),
	""event_type"" VARCHAR(16777216),
	""observation_count"" NUMBER(38,0),
	""observation_percent"" FLOAT,
	""arithmetic_mean"" FLOAT,
	""first_max_value"" FLOAT,
	""first_max_hour"" NUMBER(38,0),
	""aqi"" NUMBER(38,0),
	""method_code"" NUMBER(38,0),
	""method_name"" VARCHAR(16777216),
	""local_site_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""city_name"" VARCHAR(16777216),
	""cbsa_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,16
table_name,PRESSURE_HOURLY_SUMMARY
description,
DDL,"create or replace TABLE PRESSURE_HOURLY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""date_local"" DATE,
	""time_local"" VARCHAR(16777216),
	""date_gmt"" DATE,
	""time_gmt"" VARCHAR(16777216),
	""sample_measurement"" FLOAT,
	""units_of_measure"" VARCHAR(16777216),
	""mdl"" FLOAT,
	""uncertainty"" FLOAT,
	""qualifier"" VARCHAR(16777216),
	""method_type"" VARCHAR(16777216),
	""method_code"" VARCHAR(16777216),
	""method_name"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,17
table_name,SO2_DAILY_SUMMARY
description,
DDL,"create or replace TABLE SO2_DAILY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""sample_duration"" VARCHAR(16777216),
	""pollutant_standard"" VARCHAR(16777216),
	""date_local"" DATE,
	""units_of_measure"" VARCHAR(16777216),
	""event_type"" VARCHAR(16777216),
	""observation_count"" NUMBER(38,0),
	""observation_percent"" FLOAT,
	""arithmetic_mean"" FLOAT,
	""first_max_value"" FLOAT,
	""first_max_hour"" NUMBER(38,0),
	""aqi"" NUMBER(38,0),
	""method_code"" NUMBER(38,0),
	""method_name"" VARCHAR(16777216),
	""local_site_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""city_name"" VARCHAR(16777216),
	""cbsa_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,18
table_name,PM25_FRM_HOURLY_SUMMARY
description,
DDL,"create or replace TABLE PM25_FRM_HOURLY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""date_local"" DATE,
	""time_local"" VARCHAR(16777216),
	""date_gmt"" DATE,
	""time_gmt"" VARCHAR(16777216),
	""sample_measurement"" FLOAT,
	""units_of_measure"" VARCHAR(16777216),
	""mdl"" FLOAT,
	""uncertainty"" FLOAT,
	""qualifier"" VARCHAR(16777216),
	""method_type"" VARCHAR(16777216),
	""method_code"" VARCHAR(16777216),
	""method_name"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,19
table_name,VOC_DAILY_SUMMARY
description,
DDL,"create or replace TABLE VOC_DAILY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""sample_duration"" VARCHAR(16777216),
	""pollutant_standard"" VARCHAR(16777216),
	""date_local"" DATE,
	""units_of_measure"" VARCHAR(16777216),
	""event_type"" VARCHAR(16777216),
	""observation_count"" NUMBER(38,0),
	""observation_percent"" FLOAT,
	""arithmetic_mean"" FLOAT,
	""first_max_value"" FLOAT,
	""first_max_hour"" NUMBER(38,0),
	""aqi"" NUMBER(38,0),
	""method_code"" NUMBER(38,0),
	""method_name"" VARCHAR(16777216),
	""local_site_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""city_name"" VARCHAR(16777216),
	""cbsa_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,20
table_name,PM25_SPECIATION_DAILY_SUMMARY
description,
DDL,"create or replace TABLE PM25_SPECIATION_DAILY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""sample_duration"" VARCHAR(16777216),
	""pollutant_standard"" VARCHAR(16777216),
	""date_local"" DATE,
	""units_of_measure"" VARCHAR(16777216),
	""event_type"" VARCHAR(16777216),
	""observation_count"" NUMBER(38,0),
	""observation_percent"" FLOAT,
	""arithmetic_mean"" FLOAT,
	""first_max_value"" FLOAT,
	""first_max_hour"" NUMBER(38,0),
	""aqi"" NUMBER(38,0),
	""method_code"" NUMBER(38,0),
	""method_name"" VARCHAR(16777216),
	""local_site_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""city_name"" VARCHAR(16777216),
	""cbsa_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,21
table_name,AIR_QUALITY_ANNUAL_SUMMARY
description,
DDL,"create or replace TABLE AIR_QUALITY_ANNUAL_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""sample_duration"" VARCHAR(16777216),
	""pollutant_standard"" VARCHAR(16777216),
	""metric_used"" VARCHAR(16777216),
	""method_name"" VARCHAR(16777216),
	""year"" NUMBER(38,0),
	""units_of_measure"" VARCHAR(16777216),
	""event_type"" VARCHAR(16777216),
	""observation_count"" NUMBER(38,0),
	""observation_percent"" FLOAT,
	""completeness_indicator"" VARCHAR(16777216),
	""valid_day_count"" NUMBER(38,0),
	""required_day_count"" NUMBER(38,0),
	""exceptional_data_count"" NUMBER(38,0),
	""null_data_count"" NUMBER(38,0),
	""primary_exceedance_count"" NUMBER(38,0),
	""secondary_exceedance_count"" NUMBER(38,0),
	""certification_indicator"" VARCHAR(16777216),
	""num_obs_below_mdl"" NUMBER(38,0),
	""arithmetic_mean"" FLOAT,
	""arithmetic_standard_dev"" FLOAT,
	""first_max_value"" FLOAT,
	""first_max_datetime"" NUMBER(38,0),
	""second_max_value"" FLOAT,
	""second_max_datetime"" NUMBER(38,0),
	""third_max_value"" FLOAT,
	""third_max_datetime"" NUMBER(38,0),
	""fourth_max_value"" FLOAT,
	""fourth_max_datetime"" NUMBER(38,0),
	""first_max_non_overlapping_value"" FLOAT,
	""first_no_max_datetime"" NUMBER(38,0),
	""second_max_non_overlapping_value"" FLOAT,
	""second_no_max_datetime"" NUMBER(38,0),
	""ninety_nine_percentile"" FLOAT,
	""ninety_eight_percentile"" FLOAT,
	""ninety_five_percentile"" FLOAT,
	""ninety_percentile"" FLOAT,
	""seventy_five_percentile"" FLOAT,
	""fifty_percentile"" FLOAT,
	""ten_percentile"" FLOAT,
	""local_site_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""city_name"" VARCHAR(16777216),
	""cbsa_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,22
table_name,CO_DAILY_SUMMARY
description,
DDL,"create or replace TABLE CO_DAILY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""sample_duration"" VARCHAR(16777216),
	""pollutant_standard"" VARCHAR(16777216),
	""date_local"" DATE,
	""units_of_measure"" VARCHAR(16777216),
	""event_type"" VARCHAR(16777216),
	""observation_count"" NUMBER(38,0),
	""observation_percent"" FLOAT,
	""arithmetic_mean"" FLOAT,
	""first_max_value"" FLOAT,
	""first_max_hour"" NUMBER(38,0),
	""aqi"" NUMBER(38,0),
	""method_code"" NUMBER(38,0),
	""method_name"" VARCHAR(16777216),
	""local_site_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""city_name"" VARCHAR(16777216),
	""cbsa_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,23
table_name,HAP_HOURLY_SUMMARY
description,
DDL,"create or replace TABLE HAP_HOURLY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""date_local"" DATE,
	""time_local"" VARCHAR(16777216),
	""date_gmt"" DATE,
	""time_gmt"" VARCHAR(16777216),
	""sample_measurement"" FLOAT,
	""units_of_measure"" VARCHAR(16777216),
	""mdl"" FLOAT,
	""uncertainty"" FLOAT,
	""qualifier"" VARCHAR(16777216),
	""method_type"" VARCHAR(16777216),
	""method_code"" VARCHAR(16777216),
	""method_name"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,24
table_name,LEAD_DAILY_SUMMARY
description,
DDL,"create or replace TABLE LEAD_DAILY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""sample_duration"" VARCHAR(16777216),
	""pollutant_standard"" VARCHAR(16777216),
	""date_local"" DATE,
	""units_of_measure"" VARCHAR(16777216),
	""event_type"" VARCHAR(16777216),
	""observation_count"" NUMBER(38,0),
	""observation_percent"" FLOAT,
	""arithmetic_mean"" FLOAT,
	""first_max_value"" FLOAT,
	""first_max_hour"" NUMBER(38,0),
	""aqi"" NUMBER(38,0),
	""method_code"" NUMBER(38,0),
	""method_name"" VARCHAR(16777216),
	""local_site_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""city_name"" VARCHAR(16777216),
	""cbsa_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,25
table_name,NONOXNOY_DAILY_SUMMARY
description,
DDL,"create or replace TABLE NONOXNOY_DAILY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""sample_duration"" VARCHAR(16777216),
	""pollutant_standard"" VARCHAR(16777216),
	""date_local"" DATE,
	""units_of_measure"" VARCHAR(16777216),
	""event_type"" VARCHAR(16777216),
	""observation_count"" NUMBER(38,0),
	""observation_percent"" FLOAT,
	""arithmetic_mean"" FLOAT,
	""first_max_value"" FLOAT,
	""first_max_hour"" NUMBER(38,0),
	""aqi"" NUMBER(38,0),
	""method_code"" NUMBER(38,0),
	""method_name"" VARCHAR(16777216),
	""local_site_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""city_name"" VARCHAR(16777216),
	""cbsa_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,26
table_name,PM25_SPECIATION_HOURLY_SUMMARY
description,
DDL,"create or replace TABLE PM25_SPECIATION_HOURLY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""date_local"" DATE,
	""time_local"" VARCHAR(16777216),
	""date_gmt"" DATE,
	""time_gmt"" VARCHAR(16777216),
	""sample_measurement"" FLOAT,
	""units_of_measure"" VARCHAR(16777216),
	""mdl"" FLOAT,
	""uncertainty"" FLOAT,
	""qualifier"" VARCHAR(16777216),
	""method_type"" VARCHAR(16777216),
	""method_code"" VARCHAR(16777216),
	""method_name"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,27
table_name,RH_AND_DP_DAILY_SUMMARY
description,
DDL,"create or replace TABLE RH_AND_DP_DAILY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""sample_duration"" VARCHAR(16777216),
	""pollutant_standard"" VARCHAR(16777216),
	""date_local"" DATE,
	""units_of_measure"" VARCHAR(16777216),
	""event_type"" VARCHAR(16777216),
	""observation_count"" NUMBER(38,0),
	""observation_percent"" FLOAT,
	""arithmetic_mean"" FLOAT,
	""first_max_value"" FLOAT,
	""first_max_hour"" NUMBER(38,0),
	""aqi"" NUMBER(38,0),
	""method_code"" NUMBER(38,0),
	""method_name"" VARCHAR(16777216),
	""local_site_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""city_name"" VARCHAR(16777216),
	""cbsa_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,28
table_name,SO2_HOURLY_SUMMARY
description,
DDL,"create or replace TABLE SO2_HOURLY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""date_local"" DATE,
	""time_local"" VARCHAR(16777216),
	""date_gmt"" DATE,
	""time_gmt"" VARCHAR(16777216),
	""sample_measurement"" FLOAT,
	""units_of_measure"" VARCHAR(16777216),
	""mdl"" FLOAT,
	""uncertainty"" FLOAT,
	""qualifier"" VARCHAR(16777216),
	""method_type"" VARCHAR(16777216),
	""method_code"" VARCHAR(16777216),
	""method_name"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,29
table_name,TEMPERATURE_HOURLY_SUMMARY
description,
DDL,"create or replace TABLE TEMPERATURE_HOURLY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""date_local"" DATE,
	""time_local"" VARCHAR(16777216),
	""date_gmt"" DATE,
	""time_gmt"" VARCHAR(16777216),
	""sample_measurement"" FLOAT,
	""units_of_measure"" VARCHAR(16777216),
	""mdl"" FLOAT,
	""uncertainty"" FLOAT,
	""qualifier"" VARCHAR(16777216),
	""method_type"" VARCHAR(16777216),
	""method_code"" VARCHAR(16777216),
	""method_name"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,30
table_name,PM25_NONFRM_HOURLY_SUMMARY
description,
DDL,"create or replace TABLE PM25_NONFRM_HOURLY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""date_local"" DATE,
	""time_local"" VARCHAR(16777216),
	""date_gmt"" DATE,
	""time_gmt"" VARCHAR(16777216),
	""sample_measurement"" FLOAT,
	""units_of_measure"" VARCHAR(16777216),
	""mdl"" FLOAT,
	""uncertainty"" FLOAT,
	""qualifier"" VARCHAR(16777216),
	""method_type"" VARCHAR(16777216),
	""method_code"" VARCHAR(16777216),
	""method_name"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: EPA_HISTORICAL_AIR_QUALITY
,31
table_name,NO2_DAILY_SUMMARY
description,
DDL,"create or replace TABLE NO2_DAILY_SUMMARY (
	""state_code"" VARCHAR(16777216),
	""county_code"" VARCHAR(16777216),
	""site_num"" VARCHAR(16777216),
	""parameter_code"" NUMBER(38,0),
	""poc"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""datum"" VARCHAR(16777216),
	""parameter_name"" VARCHAR(16777216),
	""sample_duration"" VARCHAR(16777216),
	""pollutant_standard"" VARCHAR(16777216),
	""date_local"" DATE,
	""units_of_measure"" VARCHAR(16777216),
	""event_type"" VARCHAR(16777216),
	""observation_count"" NUMBER(38,0),
	""observation_percent"" FLOAT,
	""arithmetic_mean"" FLOAT,
	""first_max_value"" FLOAT,
	""first_max_hour"" NUMBER(38,0),
	""aqi"" NUMBER(38,0),
	""method_code"" NUMBER(38,0),
	""method_name"" VARCHAR(16777216),
	""local_site_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""city_name"" VARCHAR(16777216),
	""cbsa_name"" VARCHAR(16777216),
	""date_of_last_change"" DATE
);"

Database Name: OPENAQ
Schema Name: OPENAQ
,0
table_name,GLOBAL_AIR_QUALITY
description,
DDL,"create or replace TABLE GLOBAL_AIR_QUALITY (
	""location"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""pollutant"" VARCHAR(16777216),
	""value"" FLOAT,
	""timestamp"" NUMBER(38,0),
	""unit"" VARCHAR(16777216),
	""source_name"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""averaged_over_in_hours"" FLOAT,
	""location_geom"" BINARY(8388608)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'OPENAQ': {'EPA_HISTORICAL_AIR_QUALITY': ['CO_HOURLY_SUMMARY', 'NONOXNOY_HOURLY_SUMMARY', 'O3_DAILY_SUMMARY', 'VOC_HOURLY_SUMMARY', 'WIND_DAILY_SUMMARY', 'HAP_DAILY_SUMMARY', 'PM10_DAILY_SUMMARY', 'PM25_NONFRM_DAILY_SUMMARY', 'RH_AND_DP_HOURLY_SUMMARY', 'WIND_HOURLY_SUMMARY', 'PM25_FRM_DAILY_SUMMARY', 'TEMPERATURE_DAILY_SUMMARY', 'NO2_HOURLY_SUMMARY', 'O3_HOURLY_SUMMARY', 'PM10_HOURLY_SUMMARY', 'PRESSURE_DAILY_SUMMARY', 'PRESSURE_HOURLY_SUMMARY', 'SO2_DAILY_SUMMARY', 'PM25_FRM_HOURLY_SUMMARY', 'VOC_DAILY_SUMMARY', 'PM25_SPECIATION_DAILY_SUMMARY', 'AIR_QUALITY_ANNUAL_SUMMARY', 'CO_DAILY_SUMMARY', 'HAP_HOURLY_SUMMARY', 'LEAD_DAILY_SUMMARY', 'NONOXNOY_DAILY_SUMMARY', 'PM25_SPECIATION_HOURLY_SUMMARY', 'RH_AND_DP_DAILY_SUMMARY', 'SO2_HOURLY_SUMMARY', 'TEMPERATURE_HOURLY_SUMMARY', 'PM25_NONFRM_HOURLY_SUMMARY', 'NO2_DAILY_SUMMARY'], 'OPENAQ': ['GLOBAL_AIR_QUALITY']}}
Begin Exploring Related Columns
**Relevant Tables and Columns**

To address the task, we'll focus on the following tables and columns:

1. **EPA Data (1990 measurements)**
   - **Table:** `"OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"`
     - `"latitude"`: Used to match with OpenAQ data (rounded to two decimals).
     - `"longitude"`: Used to match with OpenAQ data (rounded to two decimals).
     - `"year"`: Filter data where `year = 1990`.
     - `"parameter_name"`: Filter data for `'Acceptable PM2.5 AQI & Speciation Mass'`.
     - `"units_of_measure"`: Filter data for `'Micrograms/cubic meter (LC)'`.
     - `"arithmetic_mean"`: PM2.5 measurement to calculate the difference.
     - `"city_name"`: Provides the city name for reporting.

2. **OpenAQ Data (2020 measurements)**
   - **Table:** `"OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"`
     - `"latitude"`: Used to match with EPA data (rounded to two decimals).
     - `"longitude"`: Used to match with EPA data (rounded to two decimals).
     - `"timestamp"`: Extract year from timestamp to filter data where year is 2020.
     - `"pollutant"`: Filter data for `'pm25'`.
     - `"value"`: PM2.5 measurement to calculate the difference.
     - `"city"`: Provides the city name for reporting.

**Conditions to be Used**

- **For EPA Data:**
  - `"year" = 1990`
  - `"parameter_name" = 'Acceptable PM2.5 AQI & Speciation Mass'`
  - `"units_of_measure" = 'Micrograms/cubic meter (LC)'`
- **For OpenAQ Data:**
  - `YEAR FROM "timestamp" = 2020` (after converting timestamp)
  - `"pollutant" = 'pm25'`

---

**SQL Queries to Explore the Data**

1. **List distinct parameter names in EPA's annual summary table:**

   ```sql
   SELECT DISTINCT "parameter_name"
   FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
   LIMIT 100;
   ```

2. **Count records in EPA data for the year 1990 with specified parameter and units:**

   ```sql
   SELECT COUNT(*)
   FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
   WHERE "year" = 1990
     AND "parameter_name" = 'Acceptable PM2.5 AQI & Speciation Mass'
     AND "units_of_measure" = 'Micrograms/cubic meter (LC)';
   ```

3. **Retrieve sample EPA data for 1990 with specified parameter and units:**

   ```sql
   SELECT *
   FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
   WHERE "year" = 1990
     AND "parameter_name" = 'Acceptable PM2.5 AQI & Speciation Mass'
     AND "units_of_measure" = 'Micrograms/cubic meter (LC)'
   LIMIT 100;
   ```

4. **List distinct years available in EPA's annual summary data:**

   ```sql
   SELECT DISTINCT "year"
   FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
   ORDER BY "year"
   LIMIT 100;
   ```

5. **List distinct parameter names in OpenAQ's global air quality data:**

   ```sql
   SELECT DISTINCT "pollutant"
   FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
   LIMIT 100;
   ```

6. **Retrieve sample OpenAQ data where pollutant is 'pm25':**

   ```sql
   SELECT *
   FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
   WHERE "pollutant" = 'pm25'
   LIMIT 100;
   ```

7. **Extract years from OpenAQ timestamps to find available years:**

   ```sql
   SELECT DISTINCT EXTRACT(YEAR FROM TO_TIMESTAMP("timestamp" / 1000)) AS "year"
   FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
   ORDER BY "year"
   LIMIT 100;
   ```

8. **Count OpenAQ records for the year 2020 where pollutant is 'pm25':**

   ```sql
   SELECT COUNT(*)
   FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
   WHERE "pollutant" = 'pm25'
     AND EXTRACT(YEAR FROM TO_TIMESTAMP("timestamp" / 1000)) = 2020;
   ```

9. **Get average PM2.5 values for each city from OpenAQ data for 2020:**

   ```sql
   SELECT "city", AVG("value") AS "avg_pm25"
   FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
   WHERE "pollutant" = 'pm25'
     AND EXTRACT(YEAR FROM TO_TIMESTAMP("timestamp" / 1000)) = 2020
   GROUP BY "city"
   LIMIT 100;
   ```

10. **Retrieve unique rounded coordinates from EPA data to identify potential matches:**

    ```sql
    SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon"
    FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
    WHERE "year" = 1990
      AND "parameter_name" = 'Acceptable PM2.5 AQI & Speciation Mass'
      AND "units_of_measure" = 'Micrograms/cubic meter (LC)'
    GROUP BY "lat", "lon"
    LIMIT 100;
    ```

11. **Retrieve unique rounded coordinates from OpenAQ data to identify potential matches:**

    ```sql
    SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon"
    FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
    WHERE "pollutant" = 'pm25'
      AND EXTRACT(YEAR FROM TO_TIMESTAMP("timestamp" / 1000)) = 2020
    GROUP BY "lat", "lon"
    LIMIT 100;
    ```

12. **Find matching coordinates between EPA and OpenAQ data:**

    ```sql
    SELECT DISTINCT e."lat", e."lon"
    FROM (
      SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon"
      FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
      WHERE "year" = 1990
        AND "parameter_name" = 'Acceptable PM2.5 AQI & Speciation Mass'
        AND "units_of_measure" = 'Micrograms/cubic meter (LC)'
    ) e
    INNER JOIN (
      SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon"
      FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
      WHERE "pollutant" = 'pm25'
        AND EXTRACT(YEAR FROM TO_TIMESTAMP("timestamp" / 1000)) = 2020
    ) o ON e."lat" = o."lat" AND e."lon" = o."lon"
    LIMIT 100;
    ```

13. **Get average PM2.5 measurements from EPA data grouped by coordinates:**

    ```sql
    SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon", AVG("arithmetic_mean") AS "avg_pm25_1990"
    FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
    WHERE "year" = 1990
      AND "parameter_name" = 'Acceptable PM2.5 AQI & Speciation Mass'
      AND "units_of_measure" = 'Micrograms/cubic meter (LC)'
    GROUP BY "lat", "lon"
    LIMIT 100;
    ```

14. **Get average PM2.5 measurements from OpenAQ data grouped by coordinates:**

    ```sql
    SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon", AVG("value") AS "avg_pm25_2020"
    FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
    WHERE "pollutant" = 'pm25'
      AND EXTRACT(YEAR FROM TO_TIMESTAMP("timestamp" / 1000)) = 2020
    GROUP BY "lat", "lon"
    LIMIT 100;
    ```

15. **List cities with their coordinates from EPA data (1990):**

    ```sql
    SELECT "city_name", ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon"
    FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
    WHERE "year" = 1990
      AND "parameter_name" = 'Acceptable PM2.5 AQI & Speciation Mass'
      AND "units_of_measure" = 'Micrograms/cubic meter (LC)'
    LIMIT 100;
    ```

---

These queries progressively explore the relevant data needed to address the task, helping to understand:

- The availability of PM2.5 measurements in both datasets.
- The specific parameters and units used in EPA data.
- How to extract and work with timestamps in OpenAQ data.
- Potential matching of locations based on rounded latitude and longitude.
- Gathering average measurements to eventually compute differences.

Note that these queries are intended for data exploration and understanding, and they don't directly provide the final answer to the task.Query:
SELECT DISTINCT "parameter_name"
   FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
   LIMIT 100;
Answer:
parameter_name
Total NMOC (non-methane organic compound)
trans-2-Pentene
3-Methylhexane
Methyl Butyl Ketone
OC1 CSN Unadjusted PM2.5 LC TOT
2-Methyl-1-butene
1-Heptene
Selenium PM10 LC
Beryllium PM2.5 LC
Phenol  (TSP) STP
Anthracene (TSP) STP
Ozone
Lead (TSP) STP
"1,1-Difluoroethane"
Light Absorption Coeffiecient
Potassium PM10 STP
"1,2,4-Trichlorobenzene (TSP) STP"
"1,1,1,2-Tetrachloroethane"
m(and p)-Xylene & bromoform
Manganese PM2.5 STP
Cobalt PM2.5 STP
Std Dev Vt Wind Speed
Nitric oxide (NO)
Cyclohexane
"2,3-Dimethylpentane"
Butyl acetate
"1,1-Dichloroethylene"
Propionaldehyde
Hexachlorobutadiene
Average Ambient Pressure
Arsenic PM10 STP
Tantalum PM2.5 LC
Ammonium Sulfate PM2.5 LC
Beryllium (TSP) STP
Nickel (TSP) STP
Aniline  (TSP) STP
Pentachlorophenol (TSP) STP
Sulfate (TSP) LC
Deciview
Elemental Carbon Extinction PM2.5 LC
"Benzo[g,h,i]perylene (TSP) STP"
Tantalum (TSP) STP
Ethyl acrylate
Std Dev Hz Wind Speed
Aluminum PM10 STP
"Particle Number, Total Count"
1-Naphthylamine (TSP) STP
Yttrium PM2.5 STP
Cobalt PM2.5 LC
Samarium PM2.5 LC
Potassium Ion PM2.5 LC
Sulfate PM2.5 LC
Ambient Min Temperature
Cerium PM2.5 LC
Molybdenum PM2.5 LC
EC CSN PM2.5 LC TOT
Soil PM2.5 LC
"2,2,4-Trimethylpentane"
Methylcyclopentane
n-Undecane
Outdoor Temperature
Ethyl alcohol
Sodium PM10 LC
EC1 CSN_Rev Unadjusted PM2.5 LC
Magnesium (TSP) STP
Chloride PM10 STP
Methane
"2,3,4,6-Tetrachlorophenol (TSP) STP"
Azobenzene  (TSP) STP
"2,4,6-Trichlorophenol (TSP) STP"
"7,12-Dimethylbenz[a]anthracene  (TSP) STP"
Total hydrocarbons
Zirconium PM10-2.5 STP
Magnesium (precip)
Silicon PM2.5 STP
n-Heptane
Ethylbenzene
Styrene
Heptanal
"2,5-Dimethylbenzaldehyde"
Chromium PM2.5 LC
Cesium PM2.5 LC
Silver PM2.5 LC
Tungsten PM2.5 LC
Ammonium Nitrate PM2.5 LC
OP PM2.5 LC TOR
EC3 PM2.5 LC
Cobalt PM10 LC
Methyl methacrylate
Rain 24hr total
Copper(precip)
Mannosan PM2.5 LC
Hexachlorocyclopentadiene (TSP) STP
2-Acetylaminofluorene (TSP) STP
Chlorobenzilate  (TSP) STP
Total dustfall (SP)
Silver (TSP) STP
Methanol
Fluoride (TSP) STP
Aluminum PM2.5 STP
Query:
SELECT COUNT(*)
   FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
   WHERE "year" = 1990
     AND "parameter_name" = 'Acceptable PM2.5 AQI & Speciation Mass'
     AND "units_of_measure" = 'Micrograms/cubic meter (LC)';
Answer:
COUNT(*)
44
Query:
SELECT *
   FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
   WHERE "year" = 1990
     AND "parameter_name" = 'Acceptable PM2.5 AQI & Speciation Mass'
     AND "units_of_measure" = 'Micrograms/cubic meter (LC)'
   LIMIT 100;
Answer:
Too long, hard cut:
state_code,county_code,site_num,parameter_code,poc,latitude,longitude,datum,parameter_name,sample_duration,pollutant_standard,metric_used,method_name,year,units_of_measure,event_type,observation_count,observation_percent,completeness_indicator,valid_day_count,required_day_count,exceptional_data_count,null_data_count,primary_exceedance_count,secondary_exceedance_count,certification_indicator,num_obs_below_mdl,arithmetic_mean,arithmetic_standard_dev,first_max_value,first_max_datetime,second_max_value,second_max_datetime,third_max_value,third_max_datetime,fourth_max_value,fourth_max_datetime,first_max_non_overlapping_value,first_no_max_datetime,second_max_non_overlapping_value,second_no_max_datetime,ninety_nine_percentile,ninety_eight_percentile,ninety_five_percentile,ninety_percentile,seventy_five_percentile,fifty_percentile,ten_percentile,local_site_name,address,state_name,county_name,city_name,cbsa_name,date_of_last_change
47,009,0101,88502,1,35.63348,-83.941606,WGS84,Acceptable PM2.5 AQI & Speciation Mass,24 HOUR,,Observed Values,Multiple Methods Used,1990,Micrograms/cubic meter (LC),No Events,92,75.0,N,92,122,0,12,,,Certification not required,0,14.81396,9.898241,45.10904,650937600000000,42.0743,652492800000000,38.82716,651542400000000,34.6395,649468800000000,,,,,45.10904,42.0743,34.3402,28.47619,21.39682,11.77177,5.0,Great Smoky Mountains NP - Look Rock,GREAT SMOKY MOUNTAINS NP LOOK ROCK,Tennessee,Blount,,"Knoxville, TN",2020-05-21
04,017,0119,88502,1,34.82251,-109.89249,WGS84,Acceptable PM2.5 AQI & Speciation Mass,24 HOUR,,Observed Values,Multiple Methods Used,1990,Micrograms/cubic meter (LC),No Events,98,80.0,N,98,122,0,6,,,Certification not required,0,4.841313,3.310643,20.0,646444800000000,15.969,647049600000000,12.65432,646704000000000,10.77399,644889600000000,,,,,20.0,15.969,10.40124,9.26829,5.95541,4.58204,0.0,Petrified Forest NP - South Entrance,"PET FOR NAT PARK, NEAR OLD SW ENTERANCE ON OLD ROUTE 180",Arizona,Navajo,,"Show Low, AZ",2020-05-21
78,020,0001,88502,1,18.334399,-64.795972,WGS84,Acceptable PM2.5 AQI & Speciation Mass,24 HOUR,,Observed Values,Multiple Methods Used,1990,Micrograms/cubic meter (LC),No Events,18,67.0,N,17,27,0,5,,,Certification not required,0,4.590638,2.392119,8.5061,656985600000000,8.212,658195200000000,7.75076,661219200000000,6.636,657590400000000,,,,,8.5061,8.5061,8.5061,8.212,6.06607,4.88166,0.0,"CRUZ BAY, ST JOHN U.S. VIRGIN ISLANDS","ST JOHN, VIRGIN ISLANDS",Virgin Islands,St John,Not in a city,,2020-05-21
30,029,8001,88502,1,48.5103,-113.99681,WGS84,Acceptable PM2.5 AQI & Speciation Mass,24 HOUR,,Observed Values,Multiple Methods Used,1990,Micrograms/cubic meter (LC),No Events,100,82.0,Y,100,122,0,4,,,Certification not required,0,6.210656,3.863379,23.04487,657590400000000,16.40483,650678400000000,15.09434,660614400000000,14.88673,656726400000000,,,,,23.04487,16.40483,14.78528,11.22754,8.35913,5.40298,2.125,Glacier NP - West Glacier Horse Stables,GLACIER NATIONAL PARK,Montana,Flathead,,"Kalispell, MT",2020-05-21
08,083,0101,88502,1,37.1984,-108.49046,WGS84,Acceptable PM2.5 AQI & Speciation Mass,24 HOUR,,Observed Values,Multiple Methods Used,1990,Micrograms/cubic meter (LC),No Events,97,80.0,N,97,122,0,7,,,Certification not required,0,3.973077,2.631622,14.00651,641260800000000,11.55488,646704000000000,11.44144,651542400000000,9.01198,648864000000000,,,,,14.00651,11.55488,8.53293,7.65396,5.25525,3.52542,1.16505,Mesa Verde NP - Resource Management Area,"MESA VERDE NATIONAL PARK, COLORADO",Colorado,Montezuma,,,2020-05-21
53,053,1010,88502,1,46.75838,-122.12429,WGS84,Acceptable PM2.5 AQI & Speciation Mass,24 HOUR,,Observed Values,Multiple Methods Used,1990,Micrograms/cubic meter (LC),No Events,70,57.0,N,70,122,0,34,,,Certification not required,0,6.085609,5.47591,28.42593,654307200000000,26.08025,654566400000000,24.76489,638841600000000,19.75904,639446400000000,,,,,28.42593,26.08025,19.75904,11.23028,7.1559,4.78528,1.54574,"Mount Rainier National Park, Tahoma Woods","MOUNT RAINIER NP, TAHOMA WOODS ADMIN",Washington,Pierce,,"Seattle-Tacoma-Bellevue, WA",2020-05-21
23,009,0103,88502,1,44.37705,-68.2609,WGS84,Acceptable PM2.5 AQI & Speciation Mass,24 HOUR,,Observed Values,Multiple Methods Used,1990,Micrograms/cubic meter (LC),No Events,99,81.0,Y,99,122,0,5,,,Certification not required,0,8.179546,5.828297,28.61538,654566400000000,26.58385,648259200000000,24.16667,653097600000000,21.43322,632534400000000,,,,,28.61538,26.58385,21.2037,16.14197,10.09203,6.42857,2.34043,MCFARLAND HILL Air Pollutant Research Site,567 Eagle Lake Road,Maine,Hancock,,,2020-05-21
15,001,0005,88502,1,19.4308,-155.2578,WGS84,Acceptable PM2.5 AQI & Speciation Mass,24 HOUR,,Observed Values,Multiple Methods Used,1990,Micrograms/cubic meter (LC),No Events,80,66.0,N,80,122,0,24,,,Certification not required,0,3.097558,3.786551,22.32639,656380800000000,18.28313,652147200000000,13.31361,651888000000000,11.8018,657936000000000,,,,,22.32639,18.28313,11.8018,6.59763,3.3033,2.10059,0.0,Hawaii Volcanoes NP - Kilauea Vi
Query:
SELECT DISTINCT "year"
   FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
   ORDER BY "year"
   LIMIT 100;
Answer:
year
1980
1981
1982
1983
1984
1985
1986
1987
1988
1989
1990
1991
1992
1993
1994
1995
1996
1997
1998
1999
2000
2001
2002
2003
2004
2005
2006
2007
2008
2009
2010
2011
2012
2013
2014
2015
2016
2017
2018
2019
2020
2021
2022
2023
2024
Query:
SELECT DISTINCT "pollutant"
   FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
   LIMIT 100;
Answer:
pollutant
so2
o3
pm10
no2
bc
pm25
co
no
Query:
SELECT *
   FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
   WHERE "pollutant" = 'pm25'
   LIMIT 100;
Answer:
Too long, hard cut:
location,city,country,pollutant,value,timestamp,unit,source_name,latitude,longitude,averaged_over_in_hours,location_geom
Kuwait City,N/A,KU,pm25,39.0,1591833600000000,µg/m³,AirNow,29.292316,48.04768,1.0,bytearray(b'\x01\x01\x00\x00\x00/V\xd4`\x1a\x06H@\xf8\x18\xac8\xd5J=@')
SAN BORJA,Lima,PE,pm25,54.37,1652346000000000,µg/m³,Senamhi,1.0,-12.108872,-77.007689,bytearray(b'\x01\x01\x00\x00\x00u\xe6\x1e\x12\xbe7(\xc0\x00\x00\x00\x00\x00\x00\xf0?')
US Diplomatic Post: Ho Chi Minh City,Ho Chi Minh City,VN,pm25,16.0,1652954400000000,µg/m³,Ho Chi Minh City,1.0,10.782773,106.700035,bytearray(b'\x01\x01\x00\x00\x005bf\x9f\xc7\x90%@\x00\x00\x00\x00\x00\x00\xf0?')
Abu Dhabi,N/A,AE,pm25,53.0,1651190400000000,µg/m³,AirNow,1.0,24.42431,54.433874,bytearray(b'\x01\x01\x00\x00\x00\xa2]\x85\x94\x9fl8@\x00\x00\x00\x00\x00\x00\xf0?')
HU0057A,Csongrád,HU,pm25,7.61735,1651240800000000,µg/m³,EEA Hungary,1.0,46.2666139994637,20.153053,"bytearray(b'\x01\x01\x00\x00\x00\x1a-Th ""G@\xfe\xff\xff\xff\xff\xff\xef?')"
Sportska dvorana Topolica,Bar,ME,pm25,9.6,1651611600000000,µg/m³,Montenegro,1.0,42.103842,19.09441,bytearray(b'\x01\x01\x00\x00\x00\xc2\xf9\xd4\xb1J\rE@\x00\x00\x00\x00\x00\x00\xf0?')
US Diplomatic Post: Ashgabat,Ashgabat,TM,pm25,28.0,1651197600000000,µg/m³,StateAir_Ashgabat,1.0,37.941857,58.387945,bytearray(b'\x01\x01\x00\x00\x00\x1cA*\xc5\x8e\xf8B@\x00\x00\x00\x00\x00\x00\xf0?')
US Diplomatic Post: Dhaka,Dhaka,BD,pm25,101.0,1652378400000000,µg/m³,StateAir_Dhaka,1.0,23.796373,90.424614,bytearray(b'\x01\x01\x00\x00\x00\xdaj\xd6\x19\xdf\xcb7@\xfe\xff\xff\xff\xff\xff\xef?')
US Diplomatic Post: Amman,Amman,JO,pm25,-999.0,1652295600000000,µg/m³,StateAir_Amman,1.0,31.945388,35.880556,bytearray(b'\x01\x01\x00\x00\x00\xe7\x07\xae\xf2\x04\xf2?@\x00\x00\x00\x00\x00\x00\xf0?')
HR0012A,Krapinsko-zagorska,HR,pm25,17.1,1651924800000000,µg/m³,EEA Croatia,1.0,46.1690555550192,15.6606388888889,bytearray(b'\x01\x01\x00\x00\x00\xde\x01\xc8\x9c\xa3\x15G@\xfe\xff\xff\xff\xff\xff\xef?')
US Diplomatic Post: Karachi,Karachi,PK,pm25,42.0,1652184000000000,µg/m³,StateAir_Karachi,1.0,24.8415,67.0091,bytearray(b'\x01\x01\x00\x00\x00\x82\x95C\x8bl\xd78@\x00\x00\x00\x00\x00\x00\xf0?')
GR0030A,ΑΤΤΙΚΗ,GR,pm25,6.0,1651690800000000,µg/m³,EEA Greece,1.0,37.9432869,23.64751053,bytearray(b'\x01\x01\x00\x00\x00d\x1f\t\xa0\xbd\xf8B@\x00\x00\x00\x00\x00\x00\xf0?')
US Diplomatic Post: Dhaka,Dhaka,BD,pm25,-999.0,1652619600000000,µg/m³,StateAir_Dhaka,1.0,23.796373,90.424614,bytearray(b'\x01\x01\x00\x00\x00\xdaj\xd6\x19\xdf\xcb7@\xfe\xff\xff\xff\xff\xff\xef?')
US Diplomatic Post: Ho Chi Minh City,Ho Chi Minh City,VN,pm25,29.0,1652968800000000,µg/m³,Ho Chi Minh City,1.0,10.782773,106.700035,bytearray(b'\x01\x01\x00\x00\x005bf\x9f\xc7\x90%@\x00\x00\x00\x00\x00\x00\xf0?')
US Diplomatic Post: Karachi,Karachi,PK,pm25,51.0,1651874400000000,µg/m³,StateAir_Karachi,1.0,24.8415,67.0091,bytearray(b'\x01\x01\x00\x00\x00\x82\x95C\x8bl\xd78@\x00\x00\x00\x00\x00\x00\xf0?')
Addis Ababa Jacros,N/A,ET,pm25,23.0,1651305600000000,µg/m³,AirNow,1.0,9.011444,38.820909,"bytearray(b'\x01\x01\x00\x00\x00\x89x\xeb\xfc\xdb\x05""@\x00\x00\x00\x00\x00\x00\xf0?')"
BETN121,Luxembourg,BE,pm25,1.2025,1653357600000000,µg/m³,EEA Belgium,1.0,49.877128,5.202387,bytearray(b'\x01\x01\x00\x00\x00\xf33\xf5\xbaE\xf0H@\x00\x00\x00\x00\x00\x00\xf0?')
US Diplomatic Post: Colombo,Colombo,LK,pm25,11.0,1652304600000000,µg/m³,StateAir_Colombo,1.0,6.913253,79.848684,bytearray(b'\x01\x01\x00\x00\x00D\xe5_\xcb+\xa7\x1b@\x00\x00\x00\x00\x00\x00\xf0?')
US Diplomatic Post: Kampala,Kampala,UG,pm25,50.0,1652482800000000,µg/m³,StateAir_Kampala,1.0,0.300225,32.591553,bytearray(b'\x01\x01\x00\x00\x00-C\x1c\xeb\xe26\xd3?\x00\x00\x00\x00\x00\x00\xf0?')
BETR502,Hainaut,BE,pm25,15.7075,1652144400000000,µg/m³,EEA Belgium,1.0,50.428995,4.458681,bytearray(b'\x01\x01\x00\x00\x00\xe2\x92\xe3N\xe96I@\x00\x00\x00\x00\x00\x00\xf0?')
Obilićeva,Pljevlja,ME,pm25,31.2,1651924800000000,µg/m³,Montenegro,1.0,43.357173,19.349157,bytearray(b'\x01\x01\x00\x00\x00\xd1\x01I\xd8\xb7\xadE@\x00\x00\x00\x00\x00\x00\xf0?')
SANTA ANITA,Lima,PE,pm25,36.49,1651734000000000,µg/m³,Senamhi,1.0,-12.043022,-76.971444,bytearray(b'\x01\x01\x00\x00\x00]\x04\xc6\xfa\x06\x16(\xc0\x00\x00\x00\x00\x00\x00\xf0?')
SAN BORJA,Lima,PE,pm25,20.92,1651784400000000,µg/m³,Senamhi,1.0,-12.108872,-77.007689,bytearray(b'\x01\x01\x00\x00\x00u\xe6\x1e\x12\xbe7(\xc0\x00\x00\x00\x00\x00\x00\xf0?')
SANTA ANITA,Lima,PE,pm25,63.06,1651204800000000,µg/m³,Senamhi,1.0,-12.043022,-76.971444,bytearray(b'\x01\x01\x00\x00\x00]\x04\xc6\xfa\x06\x16(\xc0\x00\x00\x00\x00\x00\x00\xf0?')
Banja Luka,N/A,BK,pm25,11.0,1652374800000000,µg/m³,AirNow,1.0,44.7725,17.185556,bytearray(b'\x01\x01\x00\x00\x00{\x14\xaeG\xe1bF@\x00\x00\x00\x00\x00\x00\xf0?')
IE0028A,Dublin City,IE,pm25,8.59,1651075200000000,µg/m³,EEA Ireland,1.0,53.353889,-6.278056,bytearray(b'\x01\x01\x00\x00\x00\x03\xb5\x18<L\xadJ@\x00\x00\x00\x00\x00\x00\xf0?')
Khartoum Embassy,N/A,SU,pm25,66.0,1652994000000000,µg/m³,StateAir_KhartoumResidential
Query:
SELECT DISTINCT EXTRACT(YEAR FROM TO_TIMESTAMP("timestamp" / 1000)) AS "year"
   FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
   ORDER BY "year"
   LIMIT 100;
Answer:
year
39077
39236
39493
39647
40580
40597
46166
46332
46583
46704
47239
47254
47491
47605
47668
47671
47690
47691
47701
47720
47757
47762
47793
47830
47835
47882
47887
47913
47963
48030
48078
48097
48103
48115
48116
48119
48138
48139
48149
48151
48159
48167
48175
48177
48190
48192
48193
48194
48195
48196
48197
48200
48208
48217
48220
48245
48249
48269
48270
48271
48275
48278
48288
48289
48291
48292
48296
48307
48339
48363
48400
48403
48408
48409
48419
48421
48422
48431
48437
48449
48451
48452
48458
48460
48463
48465
48469
48471
48486
48505
48531
48540
48543
48544
48556
48567
48570
48573
48581
48601
Query:
SELECT COUNT(*)
FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
WHERE "pollutant" = 'pm25'
  AND EXTRACT(YEAR FROM TO_TIMESTAMP("timestamp" / 1000000)) = 2020;
Answer:
COUNT(*)
3093
Query:
SELECT COUNT(*)
FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
WHERE "pollutant" = 'pm25'
  AND EXTRACT(YEAR FROM TO_TIMESTAMP("timestamp" / 1000000)) = 2022;
Answer:
COUNT(*)
1193344
Query:
SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon"
    FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
    WHERE "year" = 1990
      AND "parameter_name" = 'Acceptable PM2.5 AQI & Speciation Mass'
      AND "units_of_measure" = 'Micrograms/cubic meter (LC)'
    GROUP BY "lat", "lon"
    LIMIT 100;
Answer:
lat,lon
47.92,-89.15
37.62,-112.17
38.98,-120.1
35.63,-83.94
46.76,-122.12
44.38,-68.26
19.43,-155.26
38.52,-78.43
38.12,-122.91
37.71,-119.71
29.3,-103.18
63.72,-148.97
40.28,-105.55
32.01,-109.39
36.08,-112.16
37.66,-107.8
38.88,-77.03
44.57,-110.4
33.65,-111.11
34.82,-109.89
36.48,-121.16
25.39,-80.68
32.17,-110.74
43.75,-101.94
36.08,-112.13
38.93,-119.97
34.19,-116.91
37.72,-105.52
40.36,-105.56
48.41,-92.83
35.8,-106.3
42.97,-109.76
38.78,-109.6
41.56,-124.08
42.91,-122.14
18.33,-64.8
48.51,-114.0
37.2,-108.49
40.54,-121.58
31.83,-104.81
41.89,-115.43
38.46,-109.82
Query:
SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon"
FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
WHERE "year" = 1990
  AND "parameter_name" LIKE '%PM2.5%'
GROUP BY "lat", "lon"
LIMIT 100;
Answer:
lat,lon
42.31,-83.15
38.52,-90.34
34.19,-116.91
37.66,-107.8
29.96,-90.12
40.36,-80.62
34.14,-117.92
34.09,-80.96
33.65,-111.11
38.85,-122.76
42.23,-83.21
40.32,-80.61
41.56,-124.08
36.34,-120.11
40.76,-73.98
44.38,-68.26
19.43,-155.26
35.14,-119.46
37.95,-121.27
33.82,-118.19
37.34,-121.89
32.79,-115.56
37.64,-120.99
36.09,-119.56
38.9,-104.76
40.31,-80.61
40.34,-80.62
35.76,-117.37
38.93,-119.97
37.72,-105.52
38.88,-77.03
36.08,-112.13
48.41,-92.83
38.77,-90.29
40.73,-74.14
42.97,-109.76
40.76,-73.97
38.78,-109.6
40.75,-73.99
34.82,-109.89
48.51,-114.0
46.76,-122.12
40.54,-121.58
25.39,-80.68
37.2,-108.49
36.61,-118.06
36.95,-120.04
39.19,-122.0
41.89,-115.43
40.44,-80.07
37.71,-119.71
43.75,-101.94
35.37,-119.02
39.2,-106.83
36.08,-112.16
47.92,-89.15
35.8,-106.3
37.65,-118.97
38.98,-120.1
42.91,-122.14
43.07,-76.18
32.94,-79.66
35.63,-83.94
18.33,-64.8
36.48,-121.16
36.33,-119.29
38.77,-122.7
38.87,-106.98
36.78,-119.77
38.52,-78.43
38.12,-122.91
40.28,-105.55
32.01,-109.39
63.72,-148.97
40.36,-105.56
36.08,-80.3
38.65,-90.35
38.73,-90.38
37.62,-112.17
44.57,-110.4
34.0,-117.42
31.76,-106.49
40.01,-75.1
31.83,-104.81
32.17,-110.74
40.64,-74.21
37.65,-121.0
29.3,-103.18
38.46,-109.82
Query:
SELECT DISTINCT e."lat", e."lon"
FROM (
  SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon"
  FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
  WHERE "year" = 1990
) e
INNER JOIN (
  SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon"
  FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
  WHERE "pollutant" = 'pm25'
) o ON e."lat" = o."lat" AND e."lon" = o."lon"
LIMIT 100;
Answer:
lat,lon
39.28,-84.37
33.39,-86.82
37.64,-120.99
37.96,-119.12
38.61,-121.37
47.36,-68.32
47.27,-122.39
44.38,-68.26
42.31,-83.15
40.0,-82.99
40.15,-79.9
38.61,-90.16
42.95,-82.46
35.49,-120.67
39.42,-75.03
42.19,-121.73
40.74,-73.59
28.75,-81.31
37.7,-97.31
33.57,-112.19
34.09,-80.96
48.95,-122.55
58.39,-134.57
40.85,-73.97
36.98,-121.99
35.19,-106.51
34.28,-118.68
35.94,-84.54
35.86,-78.57
35.02,-120.56
47.21,-123.1
41.77,-88.15
32.84,-116.77
36.38,-105.58
37.26,-93.3
40.73,-74.05
33.33,-87.0
41.82,-90.21
35.95,-96.0
41.73,-122.63
43.74,-122.48
32.79,-116.94
40.25,-111.66
38.1,-122.24
43.47,-88.62
38.14,-85.58
44.03,-123.08
33.48,-112.14
47.5,-122.28
38.88,-77.03
37.56,-77.4
36.18,-86.74
35.77,-83.94
40.32,-79.87
34.14,-117.85
36.16,-115.11
31.75,-106.4
41.76,-72.67
41.49,-81.68
34.76,-92.28
41.1,-80.66
61.33,-149.57
41.44,-75.62
35.73,-81.37
39.31,-75.8
40.81,-96.68
39.53,-107.78
47.61,-122.2
42.89,-73.25
38.07,-84.5
37.94,-122.03
29.73,-95.26
34.1,-117.63
27.89,-82.54
42.3,-72.33
37.77,-122.4
42.14,-80.04
45.29,-121.78
42.19,-72.56
34.81,-83.24
36.33,-119.29
33.69,-84.29
38.52,-78.43
45.26,-122.59
27.79,-82.74
37.97,-122.52
45.5,-122.6
40.55,-122.38
39.54,-119.75
42.98,-85.67
44.48,-73.21
38.67,-120.94
25.79,-80.22
39.79,-104.99
39.99,-75.08
47.03,-122.82
48.76,-122.44
36.3,-86.65
34.26,-85.32
38.23,-85.82
Query:
SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon", AVG("arithmetic_mean") AS "avg_pm25_1990"
    FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
    WHERE "year" = 1990
      AND "parameter_name" = 'Acceptable PM2.5 AQI & Speciation Mass'
      AND "units_of_measure" = 'Micrograms/cubic meter (LC)'
    GROUP BY "lat", "lon"
    LIMIT 100;
Answer:
lat,lon,avg_pm25_1990
47.92,-89.15,5.444296
37.62,-112.17,3.129025
38.98,-120.1,2.808961
35.63,-83.94,14.81396
46.76,-122.12,6.085609
44.38,-68.26,8.179546
19.43,-155.26,3.097558
38.52,-78.43,11.873345
38.12,-122.91,7.298337
37.71,-119.71,4.977234
29.3,-103.18,6.214457
63.72,-148.97,3.140923
40.28,-105.55,2.177029
32.01,-109.39,4.318591
36.08,-112.16,3.586879
37.66,-107.8,3.437746
38.88,-77.03,15.31707
44.57,-110.4,3.236092
33.65,-111.11,5.183431
34.82,-109.89,4.841313
36.48,-121.16,6.732712
25.39,-80.68,8.037468
32.17,-110.74,5.673265
43.75,-101.94,5.304384
36.08,-112.13,4.8095300000000005
38.93,-119.97,8.26853
34.19,-116.91,10.023154
37.72,-105.52,4.314568
40.36,-105.56,4.387627
48.41,-92.83,5.188732
35.8,-106.3,3.603756
42.97,-109.76,2.905573
38.78,-109.6,4.810891
41.56,-124.08,4.947744
42.91,-122.14,3.133994
18.33,-64.8,4.590638
48.51,-114.0,6.210656
37.2,-108.49,3.973077
40.54,-121.58,2.383836
31.83,-104.81,5.785072
41.89,-115.43,3.839134
38.46,-109.82,3.942235
Query:
SELECT ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon",
       AVG("arithmetic_mean") AS "avg_pm25"
FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
WHERE "parameter_name" LIKE '%PM2.5%'
  AND "arithmetic_mean" IS NOT NULL
GROUP BY "lat", "lon"
LIMIT 100;
Answer:
lat,lon,avg_pm25
37.11,-113.58,8.875
41.22,-111.97,13.28046853846154
39.93,-75.22,3.149440719594595
33.57,-112.19,6.134070261044177
37.36,-118.42,13.785045209090908
38.75,-121.26,10.770193879569891
34.89,-120.43,3.2561405555555556
37.64,-120.99,3.4728813618784535
38.08,-102.62,4.303231888888889
39.87,-108.22,4.744968277777777
28.75,-81.31,7.900875229390681
32.61,-83.6,10.750131393719808
47.32,-116.57,9.982750975095787
41.53,-88.12,11.295939829166667
31.18,-92.41,9.170169807407408
39.34,-76.59,6.3812543
42.47,-70.97,7.545908475675675
42.35,-71.1,9.497459566153848
42.76,-84.56,7.785607
46.85,-95.85,6.5032669806451615
36.14,-115.18,8.318611580645161
40.77,-74.04,7.456947824561404
40.73,-74.05,11.091138699570815
46.83,-100.77,2.2392121702127663
41.48,-81.68,2.560245805959806
40.74,-111.87,2.27632115844315
40.77,-111.83,3.540619888888889
39.48,-80.13,11.405757504132229
43.02,-87.93,4.928473900564972
44.1,-115.97,6.431406429824561
44.95,-93.26,1.5982073133286814
37.7,-94.03,3.1773460053128693
40.82,-73.9,2.4580764683020946
35.86,-78.57,3.225738024658348
40.0,-82.99,10.876826568831168
40.15,-79.9,11.564224155688624
44.09,-103.27,7.425559432664756
47.89,-117.99,6.074333797297298
48.27,-116.55,10.182792000000001
31.57,-91.46,11.821990357142857
42.83,-108.74,9.9917195
41.21,-111.98,9.80826339721793
33.83,-87.27,13.27164792
35.05,-118.15,6.4501286222222225
40.32,-80.61,4.178710430046948
45.24,-86.99,7.444856428571429
40.7,-75.18,11.381964854166668
42.26,-71.8,9.127269111111111
43.16,-93.21,10.444746222222223
32.11,-81.16,11.420835507575758
34.63,-87.05,18.57698866666667
33.28,-86.35,12.397166484848485
41.66,-87.7,14.16409676335878
37.65,-97.36,9.429145
40.6,-74.13,10.967842807692309
36.31,-79.47,6.642179684931507
45.8,-108.43,7.601541305555555
33.82,-118.19,7.961860139103554
42.2,-86.31,10.057061272727275
26.6,-81.88,7.348743023391814
44.14,-87.62,2.5573489600000006
36.7,-97.09,8.699057890909092
32.48,-84.98,12.3854187
35.15,-80.87,11.533985384479717
28.0,-82.78,10.726425857142857
18.26,-66.85,5.8272038
29.39,-94.92,12.235407999999998
40.25,-77.14,15.8605435
44.94,-93.01,9.784374999999999
38.42,-82.43,12.440317305084747
39.52,-84.37,15.743814200000001
46.6,-112.04,7.7697299338521395
40.69,-91.99,10.552055421875
38.22,-84.84,13.142124843137253
33.82,-117.91,21.08759275
37.66,-107.8,0.38671333918128653
36.61,-92.92,1.0024677838099856
40.34,-76.38,6.54858534375
37.27,-107.88,12.895833333333334
40.76,-73.98,36.068884583333336
33.46,-116.97,0.8659630539160045
42.05,-88.11,18.179212666666665
37.3,-107.48,0.24692949724137933
36.78,-87.85,2.3294427009345795
39.24,-76.71,2.3676661857142856
38.89,-121.31,14.1813975
44.57,-69.62,10.710259999999998
45.46,-122.62,0.6726445
58.37,-134.52,3.157895
45.66,-118.69,6.188207388888888
17.96,-66.16,7.2801605
35.9,-96.01,6.727106750000001
64.85,-147.68,3.6593088287037037
64.78,-147.36,25.51117975
41.06,-73.53,12.86055376923077
29.67,-95.13,1.0103835152998777
47.14,-122.3,8.684082842592593
40.8,-74.48,10.552353072916665
41.91,-71.67,9.34377037037037
30.53,-87.2,5.020667117596567
Query:
SELECT "city_name", ROUND("latitude", 2) AS "lat", ROUND("longitude", 2) AS "lon"
    FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
    WHERE "year" = 1990
      AND "parameter_name" = 'Acceptable PM2.5 AQI & Speciation Mass'
      AND "units_of_measure" = 'Micrograms/cubic meter (LC)'
    LIMIT 100;
Answer:
city_name,lat,lon
Grand Canyon,36.08,-112.16
,36.08,-112.13
,36.08,-112.13
South Lake Tahoe,38.93,-119.97
,34.19,-116.91
,37.72,-105.52
,40.36,-105.56
,37.66,-107.8
Washington,38.88,-77.03
,47.92,-89.15
,48.41,-92.83
Not in a city,35.8,-106.3
,37.62,-112.17
,42.97,-109.76
,44.57,-110.4
,38.98,-120.1
Tonto National Monument,33.65,-111.11
,38.78,-109.6
Redwood National Park,41.56,-124.08
,42.91,-122.14
,35.63,-83.94
,34.82,-109.89
Not in a city,18.33,-64.8
,48.51,-114.0
,37.2,-108.49
,46.76,-122.12
,44.38,-68.26
Hawaii Volcanoes National Park,19.43,-155.26
,40.54,-121.58
,36.48,-121.16
,31.83,-104.81
,25.39,-80.68
,32.17,-110.74
,41.89,-115.43
,38.52,-78.43
,48.41,-92.83
Point Reyes National Seashore,38.12,-122.91
,37.71,-119.71
,29.3,-103.18
,63.72,-148.97
,40.28,-105.55
,32.01,-109.39
,43.75,-101.94
,38.46,-109.82
End Exploring Related Columns
Task: Which three cities have the largest difference between their 1990 EPA PM2.5 measurements (using units_of_measure = 'Micrograms/cubic meter (LC)' and parameter_name = 'Acceptable PM2.5 AQI & Speciation Mass') and their 2020 OpenAQ PM2.5 measurements (where pollutant = 'pm25' based on the year extracted from the timestamp), with both datasets matched by latitude and longitude rounded to two decimals, and the difference ordered from greatest to least?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To determine the three cities with the largest difference between their 1990 EPA PM2.5 measurements and their 2020 OpenAQ PM2.5 measurements, matched by latitude and longitude rounded to two decimals and ordered from greatest to least difference, the results are:

```csv
City,Difference
city1:str,difference1:float
city2:str,difference2:float
city3:str,difference3:float
(Attention: results ordered from greatest to least)
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'OPENAQ': {'EPA_HISTORICAL_AIR_QUALITY': ['CO_HOURLY_SUMMARY', 'NONOXNOY_HOURLY_SUMMARY', 'O3_DAILY_SUMMARY', 'VOC_HOURLY_SUMMARY', 'WIND_DAILY_SUMMARY', 'HAP_DAILY_SUMMARY', 'PM10_DAILY_SUMMARY', 'PM25_NONFRM_DAILY_SUMMARY', 'RH_AND_DP_HOURLY_SUMMARY', 'WIND_HOURLY_SUMMARY', 'PM25_FRM_DAILY_SUMMARY', 'TEMPERATURE_DAILY_SUMMARY', 'NO2_HOURLY_SUMMARY', 'O3_HOURLY_SUMMARY', 'PM10_HOURLY_SUMMARY', 'PRESSURE_DAILY_SUMMARY', 'PRESSURE_HOURLY_SUMMARY', 'SO2_DAILY_SUMMARY', 'PM25_FRM_HOURLY_SUMMARY', 'VOC_DAILY_SUMMARY', 'PM25_SPECIATION_DAILY_SUMMARY', 'AIR_QUALITY_ANNUAL_SUMMARY', 'CO_DAILY_SUMMARY', 'HAP_HOURLY_SUMMARY', 'LEAD_DAILY_SUMMARY', 'NONOXNOY_DAILY_SUMMARY', 'PM25_SPECIATION_HOURLY_SUMMARY', 'RH_AND_DP_DAILY_SUMMARY', 'SO2_HOURLY_SUMMARY', 'TEMPERATURE_HOURLY_SUMMARY', 'PM25_NONFRM_HOURLY_SUMMARY', 'NO2_DAILY_SUMMARY'], 'OPENAQ': ['GLOBAL_AIR_QUALITY']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-11 20:17:27 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 20:17:27 - root - INFO - ```sql
WITH epa_data AS (
    SELECT
        ROUND("latitude", 2) AS lat,
        ROUND("longitude", 2) AS lon,
        AVG("arithmetic_mean") AS avg_pm25_1990,
        MAX("city_name") AS city
    FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
    WHERE "year" = 1990
      AND "parameter_name" = 'Acceptable PM2.5 AQI & Speciation Mass'
      AND "units_of_measure" = 'Micrograms/cubic meter (LC)'
    GROUP BY lat, lon
),
openaq_data AS (
    SELECT
        ROUND("latitude", 2) AS lat,
        ROUND("longitude", 2) AS lon,
        AVG("value") AS avg_pm25_2020,
        MAX("city") AS city
    FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
    WHERE "pollutant" = 'pm25'
      AND EXTRACT(YEAR FROM TO_TIMESTAMP("timestamp" / 1000000)) = 2020
    GROUP BY lat, lon
),
combined_data AS (
    SELECT
        epa.lat,
        epa.lon,
        COALESCE(openaq.city, epa.city) AS city,
        epa.avg_pm25_1990,
        openaq.avg_pm25_2020,
        (openaq.avg_pm25_2020 - epa.avg_pm25_1990) AS difference
    FROM epa_data epa
    INNER JOIN openaq_data openaq
      ON epa.lat = openaq.lat AND epa.lon = openaq.lon
)
SELECT
    city,
    difference
FROM combined_data
ORDER BY ABS(difference) DESC NULLS LAST
LIMIT 3;
```
2025-02-11 20:17:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:17:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:17:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:17:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-02-11 20:17:29 - snowflake.connector.connection - INFO - closed
2025-02-11 20:17:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:17:29 - root - INFO - itercount: 1
2025-02-11 20:17:29 - root - INFO - 0
2025-02-11 20:17:29 - root - INFO - results: 
CITY,DIFFERENCE
Knoxville,-8.81396
MADISON,-4.8733450000000005
HANCOCK,-4.679546


2025-02-11 20:17:29 - root - INFO - Please check the answer again by reviewing Which three cities have the largest difference between their 1990 EPA PM2.5 measurements (using units_of_measure = 'Micrograms/cubic meter (LC)' and parameter_name = 'Acceptable PM2.5 AQI & Speciation Mass') and their 2020 OpenAQ PM2.5 measurements (where pollutant = 'pm25' based on the year extracted from the timestamp), with both datasets matched by latitude and longitude rounded to two decimals, and the difference ordered from greatest to least?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: To determine the three cities with the largest difference between their 1990 EPA PM2.5 measurements and their 2020 OpenAQ PM2.5 measurements, matched by latitude and longitude rounded to two decimals and ordered from greatest to least difference, the results are:

```csv
City,Difference
city1:str,difference1:float
city2:str,difference2:float
city3:str,difference3:float
(Attention: results ordered from greatest to least)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
CITY,DIFFERENCE
Knoxville,-8.81396
MADISON,-4.8733450000000005
HANCOCK,-4.679546
Current sql:
WITH epa_data AS (
    SELECT
        ROUND("latitude", 2) AS lat,
        ROUND("longitude", 2) AS lon,
        AVG("arithmetic_mean") AS avg_pm25_1990,
        MAX("city_name") AS city
    FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
    WHERE "year" = 1990
      AND "parameter_name" = 'Acceptable PM2.5 AQI & Speciation Mass'
      AND "units_of_measure" = 'Micrograms/cubic meter (LC)'
    GROUP BY lat, lon
),
openaq_data AS (
    SELECT
        ROUND("latitude", 2) AS lat,
        ROUND("longitude", 2) AS lon,
        AVG("value") AS avg_pm25_2020,
        MAX("city") AS city
    FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
    WHERE "pollutant" = 'pm25'
      AND EXTRACT(YEAR FROM TO_TIMESTAMP("timestamp" / 1000000)) = 2020
    GROUP BY lat, lon
),
combined_data AS (
    SELECT
        epa.lat,
        epa.lon,
        COALESCE(openaq.city, epa.city) AS city,
        epa.avg_pm25_1990,
        openaq.avg_pm25_2020,
        (openaq.avg_pm25_2020 - epa.avg_pm25_1990) AS difference
    FROM epa_data epa
    INNER JOIN openaq_data openaq
      ON epa.lat = openaq.lat AND epa.lon = openaq.lon
)
SELECT
    city,
    difference
FROM combined_data
ORDER BY ABS(difference) DESC NULLS LAST
LIMIT 3;
2025-02-11 20:18:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 20:18:02 - root - INFO - The SQL query you provided is correct and will retrieve the required results.

To determine the three cities with the largest difference between their 1990 EPA PM2.5 measurements and their 2020 OpenAQ PM2.5 measurements, matched by latitude and longitude rounded to two decimals and ordered from greatest to least difference, the results are:

```csv
City,Difference
Knoxville,-8.8139
Madison,-4.8733
Hancock,-4.6795
(Attention: results ordered from greatest to least)
```

Here is the SQL query:

```sql
WITH epa_data AS (
    SELECT
        ROUND("latitude", 2) AS lat,
        ROUND("longitude", 2) AS lon,
        AVG("arithmetic_mean") AS avg_pm25_1990,
        MAX("city_name") AS city
    FROM "OPENAQ"."EPA_HISTORICAL_AIR_QUALITY"."AIR_QUALITY_ANNUAL_SUMMARY"
    WHERE "year" = 1990
      AND "parameter_name" = 'Acceptable PM2.5 AQI & Speciation Mass'
      AND "units_of_measure" = 'Micrograms/cubic meter (LC)'
    GROUP BY lat, lon
),
openaq_data AS (
    SELECT
        ROUND("latitude", 2) AS lat,
        ROUND("longitude", 2) AS lon,
        AVG("value") AS avg_pm25_2020,
        MAX("city") AS city
    FROM "OPENAQ"."OPENAQ"."GLOBAL_AIR_QUALITY"
    WHERE "pollutant" = 'pm25'
      AND EXTRACT(YEAR FROM TO_TIMESTAMP("timestamp" / 1000000)) = 2020
    GROUP BY lat, lon
),
combined_data AS (
    SELECT
        epa.lat,
        epa.lon,
        COALESCE(openaq.city, epa.city) AS city,
        epa.avg_pm25_1990,
        openaq.avg_pm25_2020,
        (openaq.avg_pm25_2020 - epa.avg_pm25_1990) AS difference
    FROM epa_data epa
    INNER JOIN openaq_data openaq
      ON epa.lat = openaq.lat AND epa.lon = openaq.lon
)
SELECT
    city,
    ROUND(difference, 4) AS difference
FROM combined_data
ORDER BY ABS(difference) DESC NULLS LAST
LIMIT 3;
```
2025-02-11 20:18:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 20:18:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 20:18:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 20:18:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-02-11 20:18:03 - snowflake.connector.connection - INFO - closed
2025-02-11 20:18:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 20:18:04 - root - INFO - itercount: 2
2025-02-11 20:18:04 - root - INFO - 0
2025-02-11 20:18:04 - root - INFO - Total iteration counts: 2
