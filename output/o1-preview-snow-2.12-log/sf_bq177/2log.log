2025-02-12 17:42:31 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 17:42:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:42:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:42:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:42:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 17:42:32 - snowflake.connector.connection - INFO - closed
2025-02-12 17:42:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:42:32 - root - INFO - SQL:
SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
   LIMIT 100;
Results:
provider_id,provider_name,total_discharges,average_medicare_payments
220024,HOLYOKE MEDICAL CENTER,13,6359.0
220024,HOLYOKE MEDICAL CENTER,17,10863.0
220024,HOLYOKE MEDICAL CENTER,26,6702.0
220024,HOLYOKE MEDICAL CENTER,26,3866.0
220024,HOLYOKE MEDICAL CENTER,21,4203.0
220024,HOLYOKE MEDICAL CENTER,11,5802.0
220024,HOLYOKE MEDICAL CENTER,18,12339.0
220024,HOLYOKE MEDICAL CENTER,22,8730.0
220024,HOLYOKE MEDICAL CENTER,23,7867.0
220024,HOLYOKE MEDICAL CENTER,54,6900.0
220024,HOLYOKE MEDICAL CENTER,91,5491.0
220024,HOLYOKE MEDICAL CENTER,59,3819.0
220024,HOLYOKE MEDICAL CENTER,36,8891.0
220024,HOLYOKE MEDICAL CENTER,91,5708.0
220024,HOLYOKE MEDICAL CENTER,26,3516.0
220024,HOLYOKE MEDICAL CENTER,23,4775.0
220024,HOLYOKE MEDICAL CENTER,17,3120.0
220024,HOLYOKE MEDICAL CENTER,12,13307.0
220024,HOLYOKE MEDICAL CENTER,13,16699.0
220024,HOLYOKE MEDICAL CENTER,27,9636.0
220024,HOLYOKE MEDICAL CENTER,18,5933.0
220024,HOLYOKE MEDICAL CENTER,12,4546.0
220024,HOLYOKE MEDICAL CENTER,45,8637.0
220024,HOLYOKE MEDICAL CENTER,51,5861.0
220024,HOLYOKE MEDICAL CENTER,28,3752.0
220024,HOLYOKE MEDICAL CENTER,16,7502.0
220024,HOLYOKE MEDICAL CENTER,35,4639.0
220024,HOLYOKE MEDICAL CENTER,42,2860.0
220024,HOLYOKE MEDICAL CENTER,32,4070.0
220024,HOLYOKE MEDICAL CENTER,48,2790.0
220024,HOLYOKE MEDICAL CENTER,11,29904.0
220024,HOLYOKE MEDICAL CENTER,15,15996.0
220024,HOLYOKE MEDICAL CENTER,13,7572.0
220024,HOLYOKE MEDICAL CENTER,18,9819.0
220024,HOLYOKE MEDICAL CENTER,38,6013.0
220024,HOLYOKE MEDICAL CENTER,13,3887.0
220024,HOLYOKE MEDICAL CENTER,12,4905.0
220024,HOLYOKE MEDICAL CENTER,14,3193.0
220024,HOLYOKE MEDICAL CENTER,18,7885.0
220024,HOLYOKE MEDICAL CENTER,76,3912.0
220024,HOLYOKE MEDICAL CENTER,14,5590.0
220024,HOLYOKE MEDICAL CENTER,11,6776.0
220024,HOLYOKE MEDICAL CENTER,41,12542.0
220024,HOLYOKE MEDICAL CENTER,19,11315.0
220024,HOLYOKE MEDICAL CENTER,15,4250.0
220024,HOLYOKE MEDICAL CENTER,11,3653.0
220024,HOLYOKE MEDICAL CENTER,59,4715.0
220024,HOLYOKE MEDICAL CENTER,21,4084.0
220024,HOLYOKE MEDICAL CENTER,12,7350.0
220024,HOLYOKE MEDICAL CENTER,34,3816.0
220024,HOLYOKE MEDICAL CENTER,43,9430.0
220024,HOLYOKE MEDICAL CENTER,81,5789.0
220024,HOLYOKE MEDICAL CENTER,19,6397.0
220024,HOLYOKE MEDICAL CENTER,78,4267.0
220024,HOLYOKE MEDICAL CENTER,14,4318.0
220024,HOLYOKE MEDICAL CENTER,101,11836.0
220024,HOLYOKE MEDICAL CENTER,29,6259.0
220024,HOLYOKE MEDICAL CENTER,23,3649.0
220024,HOLYOKE MEDICAL CENTER,11,3447.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",31,5627.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",29,3712.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",42,3513.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",23,3786.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",15,2982.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",21,4163.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",23,9526.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",34,7380.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",21,6644.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",52,6003.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",37,5007.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",29,3147.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",39,7676.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",109,5061.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",38,3145.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",20,4392.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",11,3075.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",22,12849.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",23,9875.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",21,5638.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",42,7884.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",83,5264.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",29,3154.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",14,4547.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",18,2977.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",37,6543.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",45,4200.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",48,2472.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",80,3441.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",58,2279.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",11,39400.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",25,14565.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",15,7041.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",16,10131.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",44,5057.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",13,3227.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",22,4662.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",13,2766.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",19,6234.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",103,3515.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",16,5367.0

2025-02-12 17:42:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:42:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:42:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:42:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 17:42:33 - snowflake.connector.connection - INFO - closed
2025-02-12 17:42:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:42:34 - root - INFO - SQL:
SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments"
   FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
   LIMIT 100;
Results:
provider_id,provider_name,outpatient_services,average_total_payments
220024,HOLYOKE MEDICAL CENTER,12,59.0
220024,HOLYOKE MEDICAL CENTER,26,103.0
220024,HOLYOKE MEDICAL CENTER,52,351.0
220024,HOLYOKE MEDICAL CENTER,27,597.0
220024,HOLYOKE MEDICAL CENTER,127,100.0
220024,HOLYOKE MEDICAL CENTER,55,109.0
220024,HOLYOKE MEDICAL CENTER,757,184.0
220024,HOLYOKE MEDICAL CENTER,29,533.0
220024,HOLYOKE MEDICAL CENTER,133,792.0
220024,HOLYOKE MEDICAL CENTER,210,64.0
220024,HOLYOKE MEDICAL CENTER,336,155.0
220024,HOLYOKE MEDICAL CENTER,559,409.0
220024,HOLYOKE MEDICAL CENTER,469,349.0
220024,HOLYOKE MEDICAL CENTER,235,61.0
220024,HOLYOKE MEDICAL CENTER,267,771.0
220024,HOLYOKE MEDICAL CENTER,8520,53.0
220024,HOLYOKE MEDICAL CENTER,6287,76.0
220024,HOLYOKE MEDICAL CENTER,217,101.0
220024,HOLYOKE MEDICAL CENTER,41,131.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",29,101.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",107,109.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",176,63.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",274,156.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",426,408.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",802,349.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",184,61.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",91,769.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",1047,53.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,504,22.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,1153,62.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,58,103.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,34,352.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,89,100.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,203,183.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,27,494.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,58,779.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,258,64.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,239,156.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,343,407.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,232,60.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,111,770.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,3029,53.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,287,36.0
220050,BAYSTATE MARY LANE HOSPITAL,67,101.0
220050,BAYSTATE MARY LANE HOSPITAL,30,533.0
220050,BAYSTATE MARY LANE HOSPITAL,28,797.0
220050,BAYSTATE MARY LANE HOSPITAL,36,62.0
220050,BAYSTATE MARY LANE HOSPITAL,109,156.0
220050,BAYSTATE MARY LANE HOSPITAL,138,408.0
220050,BAYSTATE MARY LANE HOSPITAL,125,61.0
220050,BAYSTATE MARY LANE HOSPITAL,56,761.0
220050,BAYSTATE MARY LANE HOSPITAL,577,58.0
220050,BAYSTATE MARY LANE HOSPITAL,61,77.0
220050,BAYSTATE MARY LANE HOSPITAL,56,129.0
220065,NOBLE HOSPITAL,11,49.0
220065,NOBLE HOSPITAL,19,109.0
220065,NOBLE HOSPITAL,29,497.0
220065,NOBLE HOSPITAL,104,64.0
220065,NOBLE HOSPITAL,226,156.0
220065,NOBLE HOSPITAL,157,409.0
220065,NOBLE HOSPITAL,282,348.0
220065,NOBLE HOSPITAL,47,53.0
220065,NOBLE HOSPITAL,3724,76.0
220065,NOBLE HOSPITAL,977,102.0
220066,MERCY MEDICAL CENTER,88,44.0
220066,MERCY MEDICAL CENTER,547,97.0
220066,MERCY MEDICAL CENTER,128,508.0
220066,MERCY MEDICAL CENTER,20,101.0
220066,MERCY MEDICAL CENTER,38,109.0
220066,MERCY MEDICAL CENTER,32,797.0
220066,MERCY MEDICAL CENTER,327,63.0
220066,MERCY MEDICAL CENTER,393,156.0
220066,MERCY MEDICAL CENTER,34,411.0
220066,MERCY MEDICAL CENTER,13,61.0
220066,MERCY MEDICAL CENTER,27,775.0
220066,MERCY MEDICAL CENTER,465,53.0
220066,MERCY MEDICAL CENTER,894,77.0
220066,MERCY MEDICAL CENTER,460,102.0
220066,MERCY MEDICAL CENTER,47,131.0
220066,MERCY MEDICAL CENTER,141,172.0
220077,BAYSTATE MEDICAL CENTER,115,63.0
220077,BAYSTATE MEDICAL CENTER,803,108.0
220077,BAYSTATE MEDICAL CENTER,37,366.0
220077,BAYSTATE MEDICAL CENTER,39,619.0
220077,BAYSTATE MEDICAL CENTER,19,1531.0
220077,BAYSTATE MEDICAL CENTER,662,103.0
220077,BAYSTATE MEDICAL CENTER,337,191.0
220077,BAYSTATE MEDICAL CENTER,149,285.0
220077,BAYSTATE MEDICAL CENTER,1281,548.0
220077,BAYSTATE MEDICAL CENTER,819,816.0
220077,BAYSTATE MEDICAL CENTER,628,65.0
220077,BAYSTATE MEDICAL CENTER,624,161.0
220077,BAYSTATE MEDICAL CENTER,1755,423.0
220077,BAYSTATE MEDICAL CENTER,41,584.0
220077,BAYSTATE MEDICAL CENTER,615,369.0
220077,BAYSTATE MEDICAL CENTER,1609,63.0
220077,BAYSTATE MEDICAL CENTER,77,220.0
220077,BAYSTATE MEDICAL CENTER,681,798.0
220077,BAYSTATE MEDICAL CENTER,15302,56.0
220077,BAYSTATE MEDICAL CENTER,17785,79.0

2025-02-12 17:42:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:42:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:42:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:42:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 17:42:35 - snowflake.connector.connection - INFO - closed
2025-02-12 17:42:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:42:36 - root - INFO - SQL:
SELECT DISTINCT "provider_id", "provider_name"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
   LIMIT 100;
Results:
provider_id,provider_name
220024,HOLYOKE MEDICAL CENTER
220015,"COOLEY DICKINSON HOSPITAL INC,THE"
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER
220050,BAYSTATE MARY LANE HOSPITAL
220065,NOBLE HOSPITAL
220066,MERCY MEDICAL CENTER
220077,BAYSTATE MEDICAL CENTER
220046,BERKSHIRE MEDICAL CENTER INC
220051,NORTH ADAMS REGIONAL HOSPITAL
220016,BAYSTATE FRANKLIN MEDICAL CENTER
220098,NASHOBA VALLEY MEDICAL CENTER
220095,HEYWOOD HOSPITAL
220058,CLINTON HOSPITAL ASSOCIATION
220019,HARRINGTON MEMORIAL HOSPITAL
220062,ADCARE HOSPITAL OF WORCESTER INC
220163,UMASS MEMORIAL MEDICAL CENTER INC
220176,ST VINCENT HOSPITAL
220084,EMERSON HOSPITAL
220049,MARLBOROUGH HOSPITAL
220090,MILFORD REGIONAL MEDICAL CENTER
220174,MERRIMACK VALLEY HOSPITAL
220010,LAWRENCE GENERAL HOSPITAL
220080,HOLY FAMILY HOSPITAL
220063,LOWELL GENERAL HOSPITAL
220105,WINCHESTER HOSPITAL
220029,ANNA JAQUES HOSPITAL
220126,NORWOOD HOSPITAL
220071,MASSACHUSETTS GENERAL HOSPITAL
220110,BRIGHAM AND WOMEN'S HOSPITAL
220017,CARNEY HOSPITAL
220119,FAULKNER HOSPITAL
220002,MOUNT AUBURN HOSPITAL
220011,CAMBRIDGE HEALTH ALLIANCE
220070,HALLMARK HEALTH SYSTEM
220111,GOOD SAMARITAN MEDICAL CENTER
220060,JORDAN HOSPITAL INC
220083,BETH ISRAEL DEACONESS HOSPITAL - NEEDHAM
220135,FALMOUTH HOSPITAL
220177,NANTUCKET COTTAGE HOSPITAL
220008,STURDY MEMORIAL HOSPITAL
220108,MILTON HOSPITAL INC
410007,RHODE ISLAND HOSPITAL
410005,ST JOSEPH HEALTH SERVICES OF RI
410004,ROGER WILLIAMS MEDICAL CENTER
300011,ST JOSEPH HOSPITAL
300020,SOUTHERN NH MEDICAL CENTER
300034,CATHOLIC MEDICAL CENTER
300003,MARY HITCHCOCK MEMORIAL HOSPITAL
200020,YORK HOSPITAL
200025,PARKVIEW ADVENTIST MEDICAL CENTER
200033,EASTERN MAINE MEDICAL CENTER
200063,PENOBSCOT BAY MEDICAL CENTER
70029,BRISTOL HOSPITAL
70007,LAWRENCE & MEMORIAL HOSPITAL
70028,ST VINCENT'S MEDICAL CENTER
70016,SAINT MARYS HOSPITAL
300018,WENTWORTH-DOUGLASS HOSPITAL
200018,"AROOSTOOK MEDICAL CENTER,THE"
470012,SOUTHWESTERN VERMONT MEDICAL CENTER
470005,RUTLAND REGIONAL MEDICAL CENTER
220001,"HEALTHALLIANCE HOSPITALS, INC"
220175,METROWEST MEDICAL CENTER
220171,LAHEY CLINIC HOSPITAL
220082,SAINTS  MEDICAL CENTER INC
220035,NORTH SHORE MEDICAL CENTER
220033,BEVERLY HOSPITAL CORPORATION
220116,TUFTS MEDICAL CENTER
220031,BOSTON MEDICAL CENTER CORPORATION
220088,NEW ENGLAND BAPTIST HOSPITAL
220036,ST ELIZABETH'S MEDICAL CENTER
220067,QUINCY MEDICAL CENTER
220086,BETH ISRAEL DEACONESS MEDICAL CENTER
220052,SIGNATURE HEALTHCARE BROCKTON HOSPITAL
220012,CAPE COD HOSPITAL
220074,"SOUTHCOAST HOSPITAL GROUP, INC"
220073,MORTON HOSPITAL
220100,SOUTH SHORE HOSPITAL
220101,NEWTON-WELLESLEY HOSPITAL
220020,SAINT ANNE'S HOSPITAL
410006,NEWPORT HOSPITAL
410001,MEMORIAL HOSPITAL OF RHODE ISLAND
410009,KENT COUNTY MEMORIAL HOSPITAL
410013,WESTERLY HOSPITAL
410010,WOMEN AND INFANTS HOSPITAL OF RHODE ISLAND
410012,MIRIAM HOSPITAL
300017,PARKLAND MEDICAL CENTER
300012,ELLIOT HOSPITAL
300001,CONCORD HOSPITAL
300014,FRISBIE MEMORIAL HOSPITAL
200021,MID COAST HOSPITAL
200040,HENRIETTA D GOODALL HOSPITAL
200009,MAINE MEDICAL CENTER
200039,MAINE GENERAL MEDICAL CENTER
200001,ST JOSEPH HOSPITAL
200002,MILES MEMORIAL HOSPITAL (LINCOLN COUNTY HEALTHCARE
470003,FLETCHER ALLEN HOSPITAL OF VERMONT
470001,CENTRAL VERMONT MEDICAL CENTER
70035,"HOSPITAL OF CENTRAL CONNECTICUT, THE"
70004,SHARON HOSPITAL
70008,JOHNSON MEMORIAL HOSPITAL

2025-02-12 17:42:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:42:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:42:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:42:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-12 17:42:37 - snowflake.connector.connection - INFO - closed
2025-02-12 17:42:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:42:37 - root - INFO - SQL:
SELECT COUNT(DISTINCT "provider_id") AS "num_providers"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011;
Results:
num_providers
3337

2025-02-12 17:42:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:42:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:42:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:42:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 17:42:38 - snowflake.connector.connection - INFO - closed
2025-02-12 17:42:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:42:39 - root - INFO - SQL:
SELECT "provider_id", "provider_name", 
          "total_discharges", "average_medicare_payments",
          ("total_discharges" * "average_medicare_payments") AS "inpatient_cost"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
   LIMIT 100;
Results:
Too long, hard cut:
provider_id,provider_name,total_discharges,average_medicare_payments,inpatient_cost
220024,HOLYOKE MEDICAL CENTER,13,6359.0,82667.0
220024,HOLYOKE MEDICAL CENTER,17,10863.0,184671.0
220024,HOLYOKE MEDICAL CENTER,26,6702.0,174252.0
220024,HOLYOKE MEDICAL CENTER,26,3866.0,100516.0
220024,HOLYOKE MEDICAL CENTER,21,4203.0,88263.0
220024,HOLYOKE MEDICAL CENTER,11,5802.0,63822.0
220024,HOLYOKE MEDICAL CENTER,18,12339.0,222102.0
220024,HOLYOKE MEDICAL CENTER,22,8730.0,192060.0
220024,HOLYOKE MEDICAL CENTER,23,7867.0,180941.0
220024,HOLYOKE MEDICAL CENTER,54,6900.0,372600.0
220024,HOLYOKE MEDICAL CENTER,91,5491.0,499681.0
220024,HOLYOKE MEDICAL CENTER,59,3819.0,225321.0
220024,HOLYOKE MEDICAL CENTER,36,8891.0,320076.0
220024,HOLYOKE MEDICAL CENTER,91,5708.0,519428.0
220024,HOLYOKE MEDICAL CENTER,26,3516.0,91416.0
220024,HOLYOKE MEDICAL CENTER,23,4775.0,109825.0
220024,HOLYOKE MEDICAL CENTER,17,3120.0,53040.0
220024,HOLYOKE MEDICAL CENTER,12,13307.0,159684.0
220024,HOLYOKE MEDICAL CENTER,13,16699.0,217087.0
220024,HOLYOKE MEDICAL CENTER,27,9636.0,260172.0
220024,HOLYOKE MEDICAL CENTER,18,5933.0,106794.0
220024,HOLYOKE MEDICAL CENTER,12,4546.0,54552.0
220024,HOLYOKE MEDICAL CENTER,45,8637.0,388665.0
220024,HOLYOKE MEDICAL CENTER,51,5861.0,298911.0
220024,HOLYOKE MEDICAL CENTER,28,3752.0,105056.0
220024,HOLYOKE MEDICAL CENTER,16,7502.0,120032.0
220024,HOLYOKE MEDICAL CENTER,35,4639.0,162365.0
220024,HOLYOKE MEDICAL CENTER,42,2860.0,120120.0
220024,HOLYOKE MEDICAL CENTER,32,4070.0,130240.0
220024,HOLYOKE MEDICAL CENTER,48,2790.0,133920.0
220024,HOLYOKE MEDICAL CENTER,11,29904.0,328944.0
220024,HOLYOKE MEDICAL CENTER,15,15996.0,239940.0
220024,HOLYOKE MEDICAL CENTER,13,7572.0,98436.0
220024,HOLYOKE MEDICAL CENTER,18,9819.0,176742.0
220024,HOLYOKE MEDICAL CENTER,38,6013.0,228494.0
220024,HOLYOKE MEDICAL CENTER,13,3887.0,50531.0
220024,HOLYOKE MEDICAL CENTER,12,4905.0,58860.0
220024,HOLYOKE MEDICAL CENTER,14,3193.0,44702.0
220024,HOLYOKE MEDICAL CENTER,18,7885.0,141930.0
220024,HOLYOKE MEDICAL CENTER,76,3912.0,297312.0
220024,HOLYOKE MEDICAL CENTER,14,5590.0,78260.0
220024,HOLYOKE MEDICAL CENTER,11,6776.0,74536.0
220024,HOLYOKE MEDICAL CENTER,41,12542.0,514222.0
220024,HOLYOKE MEDICAL CENTER,19,11315.0,214985.0
220024,HOLYOKE MEDICAL CENTER,15,4250.0,63750.0
220024,HOLYOKE MEDICAL CENTER,11,3653.0,40183.0
220024,HOLYOKE MEDICAL CENTER,59,4715.0,278185.0
220024,HOLYOKE MEDICAL CENTER,21,4084.0,85764.0
220024,HOLYOKE MEDICAL CENTER,12,7350.0,88200.0
220024,HOLYOKE MEDICAL CENTER,34,3816.0,129744.0
220024,HOLYOKE MEDICAL CENTER,43,9430.0,405490.0
220024,HOLYOKE MEDICAL CENTER,81,5789.0,468909.0
220024,HOLYOKE MEDICAL CENTER,19,6397.0,121543.0
220024,HOLYOKE MEDICAL CENTER,78,4267.0,332826.0
220024,HOLYOKE MEDICAL CENTER,14,4318.0,60452.0
220024,HOLYOKE MEDICAL CENTER,101,11836.0,1195436.0
220024,HOLYOKE MEDICAL CENTER,29,6259.0,181511.0
220024,HOLYOKE MEDICAL CENTER,23,3649.0,83927.0
220024,HOLYOKE MEDICAL CENTER,11,3447.0,37917.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",31,5627.0,174437.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",29,3712.0,107648.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",42,3513.0,147546.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",23,3786.0,87078.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",15,2982.0,44730.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",21,4163.0,87423.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",23,9526.0,219098.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",34,7380.0,250920.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",21,6644.0,139524.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",52,6003.0,312156.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",37,5007.0,185259.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",29,3147.0,91263.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",39,7676.0,299364.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",109,5061.0,551649.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",38,3145.0,119510.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",20,4392.0,87840.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",11,3075.0,33825.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",22,12849.0,282678.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",23,9875.0,227125.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",21,5638.0,118398.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",42,7884.0,331128.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",83,5264.0,436912.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",29,3154.0,91466.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",14,4547.0,63658.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",18,2977.0,53586.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",37,6543.0,242091.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",45,4200.0,189000.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",48,2472.0,118656.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",80,3441.0,275280.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",58,2279.0,132182.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",11,39400.0,433400.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",25,14565.0,364125.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",15,7041.0,1

2025-02-12 17:42:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:42:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:42:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:42:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 17:42:40 - snowflake.connector.connection - INFO - closed
2025-02-12 17:42:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:42:40 - root - INFO - SQL:
SELECT "provider_id", "provider_name",
          SUM("total_discharges" * "average_medicare_payments") AS "total_inpatient_cost"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
   GROUP BY "provider_id", "provider_name"
   ORDER BY "total_inpatient_cost" DESC
   LIMIT 100;
Results:
provider_id,provider_name,total_inpatient_cost
330101,NEW YORK-PRESBYTERIAN HOSPITAL,259982825.0
330059,MONTEFIORE MEDICAL CENTER,195468269.0
100007,FLORIDA HOSPITAL,191577360.0
330024,MOUNT SINAI HOSPITAL,168906912.0
50625,CEDARS-SINAI MEDICAL CENTER,144399584.0
330194,MAIMONIDES MEDICAL CENTER,140492753.0
230130,WILLIAM BEAUMONT HOSPITAL,140231502.0
80001,"CHRISTIANA CARE HEALTH SERVICES, INC.",135782767.0
330169,BETH ISRAEL MEDICAL CENTER,135413177.0
330106,NORTH SHORE UNIVERSITY HOSPITAL,132352253.0
450388,METHODIST HOSPITAL,130432929.0
220071,MASSACHUSETTS GENERAL HOSPITAL,122073585.0
440049,METHODIST HEALTHCARE MEMPHIS HOSPITALS,116640323.0
340040,PITT COUNTY MEMORIAL HOSPITAL,116503878.0
70022,YALE-NEW HAVEN HOSPITAL,112535496.0
210009,"JOHNS HOPKINS HOSPITAL, THE",109110007.0
220163,UMASS MEMORIAL MEDICAL CENTER INC,107824605.0
220074,"SOUTHCOAST HOSPITAL GROUP, INC",104650325.0
150056,INDIANA UNIVERSITY HEALTH,103664087.0
180088,"NORTON HOSPITALS, INC",102956561.0
450184,MEMORIAL HERMANN HOSPITAL SYSTEM,101763479.0
390164,UPMC PRESBYTERIAN SHADYSIDE,99226492.0
70025,HARTFORD HOSPITAL,98872186.0
260032,BARNES JEWISH HOSPITAL,98077689.0
340141,NEW HANOVER REGIONAL MEDICAL CENTER,96576892.0
220086,BETH ISRAEL DEACONESS MEDICAL CENTER,96200183.0
340002,MEMORIAL MISSION HOSPITAL AND ASHEVILLE SURGERY CE,95487026.0
230038,SPECTRUM HEALTH - BUTTERWORTH CAMPUS,95174984.0
340047,NORTH CAROLINA BAPTIST HOSPITAL,94154603.0
90011,WASHINGTON HOSPITAL CENTER,93607169.0
520138,AURORA ST LUKES MEDICAL CENTER,92125754.0
310001,HACKENSACK UNIVERSITY MEDICAL CENTER,91992875.0
330214,NYU HOSPITALS CENTER,91958983.0
450058,BAPTIST MEDICAL CENTER,91542398.0
220110,BRIGHAM AND WOMEN'S HOSPITAL,91471310.0
140208,ADVOCATE CHRIST HOSPITAL & MEDICAL CENTER,91126208.0
340069,"WAKEMED, RALEIGH CAMPUS",90456558.0
330055,NEW YORK HOSPITAL MEDICAL CENTER OF QUEENS,90025921.0
340030,DUKE UNIVERSITY HOSPITAL,88272764.0
230046,UNIVERSITY OF MICHIGAN HEALTH SYSTEM,88134168.0
10039,HUNTSVILLE HOSPITAL,86899365.0
140281,NORTHWESTERN MEMORIAL HOSPITAL,86249092.0
230020,OAKWOOD HOSPITAL AND MEDICAL CENTER,85552858.0
100006,ORLANDO HEALTH,85500486.0
450358,"METHODIST HOSPITAL,THE",85359076.0
360180,CLEVELAND CLINIC,85266922.0
310019,ST JOSEPH'S REGIONAL MEDICAL CENTER,85138563.0
230019,PROVIDENCE HOSPITAL AND MEDICAL CENTERS,84516458.0
240010,MAYO CLINIC - SAINT MARYS HOSPITAL,84160623.0
140010,EVANSTON HOSPITAL,83907335.0
230165,ST JOHN HOSPITAL AND MEDICAL CENTER,83688887.0
50441,STANFORD HOSPITAL,83688471.0
340113,CAROLINAS MEDICAL CENTER/BEHAV HEALTH,83143896.0
390133,LEHIGH VALLEY HOSPITAL,83098918.0
230053,HENRY FORD HOSPITAL,82888752.0
70002,ST FRANCIS HOSPITAL & MEDICAL CENTER,82046635.0
450021,BAYLOR UNIVERSITY MEDICAL CENTER,81804632.0
330195,LONG ISLAND JEWISH MEDICAL CENTER,81441504.0
310015,MORRISTOWN MEMORIAL HOSPITAL,80628692.0
390174,THOMAS JEFFERSON UNIVERSITY HOSPITAL,80359683.0
180040,JEWISH HOSPITAL & ST MARY'S HEALTHCARE,80332763.0
340028,CAPE FEAR VALLEY MEDICAL CENTER,80171344.0
210002,UNIVERSITY OF MARYLAND MEDICAL CENTER,79780810.0
340091,"MOSES H CONE MEMORIAL HOSPITAL, THE",79740916.0
330046,ST LUKE'S ROOSEVELT HOSPITAL,79633498.0
310041,COMMUNITY MEDICAL CENTER,78298044.0
220077,BAYSTATE MEDICAL CENTER,78242916.0
210019,PENINSULA REGIONAL MEDICAL CENTER,77407646.0
310038,ROBERT WOOD JOHNSON UNIVERSITY HOSPITAL,76864921.0
510022,CHARLESTON AREA MEDICAL CENTER,75647510.0
330393,UNIVERSITY HOSPITAL ( STONY BROOK ),75302882.0
360085,OHIO STATE UNIVERSITY HOSPITALS,74086123.0
310012,VALLEY HOSPITAL,74021525.0
100113,SHANDS HOSPITAL AT THE UNIVERSITY OF FLORIDA,73892519.0
330236,NEW YORK METHODIST HOSPITAL,73786339.0
360006,RIVERSIDE METHODIST HOSPITAL,73771415.0
100022,JACKSON MEMORIAL HOSPITAL,73763711.0
330005,KALEIDA HEALTH,73655973.0
490063,INOVA FAIRFAX HOSPITAL,73220718.0
450054,SCOTT & WHITE MEMORIAL HOSPITAL,72958960.0
440002,JACKSON-MADISON COUNTY GENERAL HOSPITAL,72841064.0
50093,SAINT AGNES MEDICAL CENTER,72703418.0
100018,NAPLES COMMUNITY HOSPITAL,72234288.0
490024,CARILION ROANOKE MEMORIAL CENTER,71919204.0
330167,WINTHROP-UNIVERSITY HOSPITAL,71892870.0
210015,FRANKLIN SQUARE HOSPITAL CENTER,71725448.0
240057,ABBOTT NORTHWESTERN HOSPITAL,71609336.0
440048,BAPTIST MEMORIAL HOSPITAL,71347358.0
310086,KENNEDY UNIVERSITY HOSPITAL - STRATFORD DIV,70940053.0
230195,ST JOHN MACOMB-OAKLAND HOSPITAL-MACOMB CENTER,70694114.0
340061,UNIVERSITY OF NORTH CAROLINA HOSPITAL,70485004.0
70001,HOSPITAL OF ST RAPHAEL,70376738.0
140223,ADVOCATE LUTHERAN GENERAL HOSPITAL,69681268.0
410007,RHODE ISLAND HOSPITAL,69493056.0
330119,LENOX HILL HOSPITAL,69296319.0
330160,STATEN ISLAND UNIVERSITY HOSPITAL,69113229.0
170122,VIA CHRISTI HOSPITALS WICHITA INC,69088908.0
210023,ANNE ARUNDEL MEDICAL CENTER,69064241.0
100040,ST VINCENT'S MEDICAL CENTER,68455066.0
210043,BALTIMORE WASHINGTON  MEDICAL CENTER,68171980.0

2025-02-12 17:42:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:42:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:42:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:42:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 17:42:42 - snowflake.connector.connection - INFO - closed
2025-02-12 17:42:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:42:42 - root - INFO - SQL:
SELECT "provider_id", "provider_name",
          SUM("total_discharges" * "average_medicare_payments") AS "total_inpatient_cost"
   FROM (
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
       UNION ALL
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
       UNION ALL
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
       UNION ALL
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
       UNION ALL
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
   ) AS combined_inpatient
   GROUP BY "provider_id", "provider_name"
   ORDER BY "total_inpatient_cost" DESC
   LIMIT 100;
Results:
provider_id,provider_name,total_inpatient_cost
330101,NEW YORK-PRESBYTERIAN HOSPITAL,1921462142.0
100007,FLORIDA HOSPITAL,1293059027.0
50625,CEDARS-SINAI MEDICAL CENTER,1111247205.0
70022,YALE-NEW HAVEN HOSPITAL,1065172588.0
330059,MONTEFIORE MEDICAL CENTER,1064056005.0
330024,MOUNT SINAI HOSPITAL,1029121838.0
220071,MASSACHUSETTS GENERAL HOSPITAL,999580128.0
210009,"JOHNS HOPKINS HOSPITAL, THE",985951009.0
80001,"CHRISTIANA CARE HEALTH SERVICES, INC.",915920368.0
260032,BARNES JEWISH HOSPITAL,823355959.0
450388,METHODIST HOSPITAL,796111529.0
220110,BRIGHAM AND WOMEN'S HOSPITAL,785511555.0
210002,UNIVERSITY OF MARYLAND MEDICAL CENTER,780576440.0
440049,METHODIST HEALTHCARE MEMPHIS HOSPITALS,765625561.0
330106,NORTH SHORE UNIVERSITY HOSPITAL,763949450.0
360180,CLEVELAND CLINIC,762405614.0
240010,MAYO CLINIC HOSPITAL ROCHESTER,761687402.0
150056,INDIANA UNIVERSITY HEALTH,749972082.0
330194,MAIMONIDES MEDICAL CENTER,717409561.0
230046,UNIVERSITY OF MICHIGAN HEALTH SYSTEM,680185220.0
340030,DUKE UNIVERSITY HOSPITAL,674120048.0
330169,BETH ISRAEL MEDICAL CENTER,668306090.0
340040,VIDANT MEDICAL CENTER,647383497.0
70025,HARTFORD HOSPITAL,641833194.0
450358,"METHODIST HOSPITAL,THE",640404017.0
220163,UMASS MEMORIAL MEDICAL CENTER INC,639284118.0
390164,UPMC PRESBYTERIAN SHADYSIDE,635584986.0
50454,UCSF MEDICAL CENTER,629965827.0
220086,BETH ISRAEL DEACONESS MEDICAL CENTER,628999939.0
340141,NEW HANOVER REGIONAL MEDICAL CENTER,627341625.0
220077,BAYSTATE MEDICAL CENTER,619696360.0
450184,MEMORIAL HERMANN HOSPITAL SYSTEM,605791482.0
340113,CAROLINAS MEDICAL CENTER/BEHAV HEALTH,601536705.0
520138,AURORA ST LUKES MEDICAL CENTER,597720284.0
220074,"SOUTHCOAST HOSPITAL GROUP, INC",596408540.0
390174,THOMAS JEFFERSON UNIVERSITY HOSPITAL,591302486.0
310001,HACKENSACK UNIVERSITY MEDICAL CENTER,589208916.0
330214,NYU HOSPITALS CENTER,586976434.0
340002,MEMORIAL MISSION HOSPITAL AND ASHEVILLE SURGERY CE,578546731.0
230038,SPECTRUM HEALTH - BUTTERWORTH CAMPUS,563866815.0
340047,NORTH CAROLINA BAPTIST HOSPITAL,549377243.0
140208,ADVOCATE CHRIST HOSPITAL & MEDICAL CENTER,545101224.0
10039,HUNTSVILLE HOSPITAL,544633462.0
330393,UNIVERSITY HOSPITAL ( STONY BROOK ),543113100.0
390111,HOSPITAL OF UNIV OF PENNSYLVANIA,538983088.0
140281,NORTHWESTERN MEMORIAL HOSPITAL,538087456.0
450021,BAYLOR UNIVERSITY MEDICAL CENTER,537318164.0
140010,EVANSTON HOSPITAL,533259623.0
450058,BAPTIST MEDICAL CENTER,532086753.0
50599,UNIVERSITY OF CALIFORNIA DAVIS MEDICAL CENTER,528556816.0
10033,UNIVERSITY OF ALABAMA HOSPITAL,524499396.0
240057,ABBOTT NORTHWESTERN HOSPITAL,515792716.0
490009,UNIVERSITY OF VIRGINIA MEDICAL CENTER,514587395.0
310038,ROBERT WOOD JOHNSON UNIVERSITY HOSPITAL,514020951.0
230053,HENRY FORD HOSPITAL,510781418.0
440039,VANDERBILT UNIVERSITY HOSPITAL,504866186.0
490063,INOVA FAIRFAX HOSPITAL,500332494.0
390133,LEHIGH VALLEY HOSPITAL,497494077.0
50441,STANFORD HOSPITAL,493924448.0
440048,BAPTIST MEMORIAL HOSPITAL,489992582.0
360085,OHIO STATE UNIVERSITY HOSPITALS,487904640.0
90011,MEDSTAR WASHINGTON HOSPITAL CENTER,484962664.0
100006,ORLANDO HEALTH,484862174.0
140119,RUSH UNIVERSITY MEDICAL CENTER,483003764.0
510022,CHARLESTON AREA MEDICAL CENTER,481852784.0
210012,SINAI HOSPITAL OF BALTIMORE,474328777.0
230019,PROVIDENCE HOSPITAL AND MEDICAL CENTERS,473555057.0
360006,RIVERSIDE METHODIST HOSPITAL,469873025.0
310015,MORRISTOWN MEDICAL CENTER,468776617.0
310019,ST JOSEPH'S REGIONAL MEDICAL CENTER,465103950.0
70002,ST FRANCIS HOSPITAL & MEDICAL CENTER,459151564.0
180040,JEWISH HOSPITAL & ST MARY'S HEALTHCARE,456244616.0
330195,LONG ISLAND JEWISH MEDICAL CENTER,452383012.0
100128,TAMPA GENERAL HOSPITAL,450221944.0
330167,WINTHROP-UNIVERSITY HOSPITAL,447812197.0
300003,MARY HITCHCOCK MEMORIAL HOSPITAL,446928737.0
180067,UNIVERSITY OF KENTUCKY HOSPITAL,445617826.0
240036,ST CLOUD HOSPITAL,443229378.0
490032,MEDICAL COLLEGE OF VIRGINIA HOSPITALS,439445420.0
340061,UNIVERSITY OF NORTH CAROLINA HOSPITAL,438379406.0
100022,JACKSON MEMORIAL HOSPITAL,437767504.0
520098,UNIVERSITY OF WI  HOSPITALS & CLINICS AUTHORITY,436625317.0
410007,RHODE ISLAND HOSPITAL,433277541.0
230130,"BEAUMONT HOSPITAL, ROYAL OAK",432176037.0
330236,NEW YORK METHODIST HOSPITAL,431974064.0
330005,KALEIDA HEALTH,431313771.0
440002,JACKSON-MADISON COUNTY GENERAL HOSPITAL,426679347.0
340091,"MOSES H CONE MEMORIAL HOSPITAL, THE",426045334.0
200009,MAINE MEDICAL CENTER,423146721.0
310073,JERSEY SHORE UNIVERSITY MEDICAL CENTER,418163270.0
100113,UF HEALTH SHANDS HOSPITAL,416675818.0
210019,PENINSULA REGIONAL MEDICAL CENTER,416412362.0
150084,ST VINCENT HOSPITAL & HEALTH SERVICES,410484481.0
340069,"WAKEMED, RALEIGH CAMPUS",410252731.0
420004,MUSC MEDICAL CENTER,409044716.0
160058,UNIVERSITY OF IOWA HOSPITAL & CLINICS,408141448.0
100018,NAPLES COMMUNITY HOSPITAL,408047982.0
330160,STATEN ISLAND UNIVERSITY HOSPITAL,407788453.0
310012,VALLEY HOSPITAL,407403963.0
340028,CAPE FEAR VALLEY MEDICAL CENTER,407343779.0

2025-02-12 17:42:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:42:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:42:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:42:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-12 17:42:43 - snowflake.connector.connection - INFO - closed
2025-02-12 17:42:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:42:44 - root - INFO - SQL:
SELECT "provider_id", "provider_name",
          SUM("total_discharges" * "average_medicare_payments") AS "total_inpatient_cost"
   FROM (
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
       UNION ALL
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
       UNION ALL
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
       UNION ALL
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
       UNION ALL
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
   ) AS combined_inpatient
   GROUP BY "provider_id", "provider_name"
   ORDER BY "total_inpatient_cost" DESC
   LIMIT 1;
Results:
provider_id,provider_name,total_inpatient_cost
330101,NEW YORK-PRESBYTERIAN HOSPITAL,1921462142.0

2025-02-12 17:42:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:42:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:42:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:42:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-02-12 17:42:45 - snowflake.connector.connection - INFO - closed
2025-02-12 17:42:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:43:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 17:43:33 - root - INFO - ```sql
WITH combined_inpatient AS (
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2011 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2012 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2013 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2014 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2015 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
),
total_inpatient_cost_per_provider AS (
    SELECT "provider_id", "provider_name", SUM("total_discharges" * "average_medicare_payments") AS "total_inpatient_cost"
    FROM combined_inpatient
    GROUP BY "provider_id", "provider_name"
),
top_provider AS (
    SELECT "provider_id", "provider_name"
    FROM total_inpatient_cost_per_provider
    ORDER BY "total_inpatient_cost" DESC
    LIMIT 1
),
yearly_inpatient_cost AS (
    SELECT c."Year", AVG(c."average_medicare_payments" * c."total_discharges") AS "Average_Inpatient_Cost"
    FROM combined_inpatient c
    JOIN top_provider tp ON c."provider_id" = tp."provider_id"
    GROUP BY c."Year"
),
combined_outpatient AS (
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2011 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2012 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2012
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2013 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2014 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2014
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2015 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2015
),
yearly_outpatient_cost AS (
    SELECT c."Year", AVG(c."average_total_payments" * c."outpatient_services") AS "Average_Outpatient_Cost"
    FROM combined_outpatient c
    JOIN top_provider tp ON c."provider_id" = tp."provider_id"
    GROUP BY c."Year"
)
SELECT y."Year", y."Average_Inpatient_Cost", yo."Average_Outpatient_Cost"
FROM yearly_inpatient_cost y
LEFT JOIN yearly_outpatient_cost yo ON y."Year" = yo."Year"
ORDER BY y."Year";
```
2025-02-12 17:43:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:43:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:43:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:43:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-02-12 17:43:35 - snowflake.connector.connection - INFO - closed
2025-02-12 17:43:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:44:45 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 17:44:45 - root - INFO - SQL:
WITH combined_inpatient AS (
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2011 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2012 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2013 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2014 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2015 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
),
total_inpatient_cost_per_provider AS (
    SELECT "provider_id", "provider_name", SUM("total_discharges" * "average_medicare_payments") AS "total_inpatient_cost"
    FROM combined_inpatient
    GROUP BY "provider_id", "provider_name"
),
top_provider AS (
    SELECT "provider_id", "provider_name"
    FROM total_inpatient_cost_per_provider
    ORDER BY "total_inpatient_cost" DESC
    LIMIT 1
),
yearly_inpatient_cost AS (
    SELECT c."Year", AVG(c."average_medicare_payments" * c."total_discharges") AS "Average_Inpatient_Cost"
    FROM combined_inpatient c
    JOIN top_provider tp ON c."provider_id" = tp."provider_id"
    GROUP BY c."Year"
),
combined_outpatient AS (
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2011 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2012 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2012
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2013 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2014 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2014
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2015 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2015
),
yearly_outpatient_cost AS (
    SELECT c."Year", AVG(c."average_total_payments" * c."outpatient_services") AS "Average_Outpatient_Cost"
    FROM combined_outpatient c
    JOIN top_provider tp ON c."provider_id" = tp."provider_id"
    GROUP BY c."Year"
)
SELECT y."Year", y."Average_Inpatient_Cost", yo."Average_Outpatient_Cost"
FROM yearly_inpatient_cost y
LEFT JOIN yearly_outpatient_cost yo ON y."Year" = yo."Year"
ORDER BY y."Year";
Results:
Year,Average_Inpatient_Cost,Average_Outpatient_Cost
2011,2626089.1414141413,443473.7083333333
2012,2547851.28,406864.6
2013,2335016.89,382465.44
2014,1541546.1721518987,343631.46428571426
2015,1520975.099730458,409001.4434685575

2025-02-12 17:44:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:44:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:44:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:44:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-02-12 17:44:46 - snowflake.connector.connection - INFO - closed
2025-02-12 17:44:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:45:41 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 17:45:41 - root - INFO - ```sql
WITH combined_inpatient AS (
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2011 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2012 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2013 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2014 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2015 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
),
combined_outpatient AS (
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2011 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2012 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2012
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2013 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2014 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2014
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2015 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2015
),
providers_with_both AS (
    SELECT DISTINCT ci."provider_id", ci."provider_name"
    FROM combined_inpatient ci
    INNER JOIN combined_outpatient co ON ci."provider_id" = co."provider_id"
),
total_inpatient_cost_per_provider AS (
    SELECT ci."provider_id", ci."provider_name", SUM(ci."total_discharges" * ci."average_medicare_payments") AS "total_inpatient_cost"
    FROM combined_inpatient ci
    JOIN providers_with_both pb ON ci."provider_id" = pb."provider_id"
    GROUP BY ci."provider_id", ci."provider_name"
),
top_provider AS (
    SELECT "provider_id", "provider_name"
    FROM total_inpatient_cost_per_provider
    ORDER BY "total_inpatient_cost" DESC
    LIMIT 1
),
yearly_inpatient_cost AS (
    SELECT c."Year", AVG(c."average_medicare_payments" * c."total_discharges") AS "Average_Inpatient_Cost"
    FROM combined_inpatient c
    JOIN top_provider tp ON c."provider_id" = tp."provider_id"
    GROUP BY c."Year"
),
yearly_outpatient_cost AS (
    SELECT c."Year", AVG(c."average_total_payments" * c."outpatient_services") AS "Average_Outpatient_Cost"
    FROM combined_outpatient c
    JOIN top_provider tp ON c."provider_id" = tp."provider_id"
    GROUP BY c."Year"
)
SELECT y."Year", y."Average_Inpatient_Cost", yo."Average_Outpatient_Cost"
FROM yearly_inpatient_cost y
LEFT JOIN yearly_outpatient_cost yo ON y."Year" = yo."Year"
ORDER BY y."Year";
```
2025-02-12 17:45:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:45:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:45:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:45:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-02-12 17:45:43 - snowflake.connector.connection - INFO - closed
2025-02-12 17:45:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:46:57 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 17:46:57 - root - INFO - SQL:
WITH combined_inpatient AS (
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2011 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2012 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2013 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2014 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2015 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
),
combined_outpatient AS (
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2011 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2012 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2012
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2013 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2014 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2014
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2015 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2015
),
providers_with_both AS (
    SELECT DISTINCT ci."provider_id", ci."provider_name"
    FROM combined_inpatient ci
    INNER JOIN combined_outpatient co ON ci."provider_id" = co."provider_id"
),
total_inpatient_cost_per_provider AS (
    SELECT ci."provider_id", ci."provider_name", SUM(ci."total_discharges" * ci."average_medicare_payments") AS "total_inpatient_cost"
    FROM combined_inpatient ci
    JOIN providers_with_both pb ON ci."provider_id" = pb."provider_id"
    GROUP BY ci."provider_id", ci."provider_name"
),
top_provider AS (
    SELECT "provider_id", "provider_name"
    FROM total_inpatient_cost_per_provider
    ORDER BY "total_inpatient_cost" DESC
    LIMIT 1
),
yearly_inpatient_cost AS (
    SELECT c."Year", AVG(c."average_medicare_payments" * c."total_discharges") AS "Average_Inpatient_Cost"
    FROM combined_inpatient c
    JOIN top_provider tp ON c."provider_id" = tp."provider_id"
    GROUP BY c."Year"
),
yearly_outpatient_cost AS (
    SELECT c."Year", AVG(c."average_total_payments" * c."outpatient_services") AS "Average_Outpatient_Cost"
    FROM combined_outpatient c
    JOIN top_provider tp ON c."provider_id" = tp."provider_id"
    GROUP BY c."Year"
)
SELECT y."Year", y."Average_Inpatient_Cost", yo."Average_Outpatient_Cost"
FROM yearly_inpatient_cost y
LEFT JOIN yearly_outpatient_cost yo ON y."Year" = yo."Year"
ORDER BY y."Year";
Results:
Year,Average_Inpatient_Cost,Average_Outpatient_Cost
2011,858781.8673469388,29201.055555555555
2012,834227.24,33373.9375
2013,820016.2727272727,27117.764705882353
2014,931714.380952381,285271.8181818182
2015,1134943.5806451612,468363.62158114894

2025-02-12 17:46:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:46:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:46:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:46:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-02-12 17:46:59 - snowflake.connector.connection - INFO - closed
2025-02-12 17:46:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:46:59 - root - INFO - SQL:
SELECT "provider_id", "provider_name",
           SUM("average_total_payments" * "outpatient_services") AS "total_outpatient_cost"
    FROM (
        SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
        FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
        UNION ALL
        SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
        FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2012
        UNION ALL
        SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
        FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
        UNION ALL
        SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
        FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2014
        UNION ALL
        SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
        FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2015
    ) AS combined_outpatient
    GROUP BY "provider_id", "provider_name"
    ORDER BY "total_outpatient_cost" DESC
    LIMIT 5;
Results:
provider_id,provider_name,total_outpatient_cost
360180,CLEVELAND CLINIC,150549148.0
450054,SCOTT & WHITE MEMORIAL HOSPITAL,136956624.0
140010,EVANSTON HOSPITAL,123573299.0
220071,MASSACHUSETTS GENERAL HOSPITAL,85101884.0
50441,STANFORD HOSPITAL,82699500.0

2025-02-12 17:46:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:46:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:46:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:47:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 17:47:01 - snowflake.connector.connection - INFO - closed
2025-02-12 17:47:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:47:01 - root - INFO - SQL:
SELECT inpatient."provider_id", inpatient."provider_name",
           inpatient."total_inpatient_cost", outpatient."total_outpatient_cost"
    FROM (
        SELECT "provider_id", "provider_name",
               SUM("total_discharges" * "average_medicare_payments") AS "total_inpatient_cost"
        FROM (
            SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
            FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
            UNION ALL
            SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
            FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
            UNION ALL
            SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
            FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
            UNION ALL
            SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
            FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
            UNION ALL
            SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
            FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
        ) AS combined_inpatient
        GROUP BY "provider_id", "provider_name"
    ) AS inpatient
    JOIN (
        SELECT "provider_id", "provider_name",
               SUM("average_total_payments" * "outpatient_services") AS "total_outpatient_cost"
        FROM (
            SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
            FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
            UNION ALL
            SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
            FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2012
            UNION ALL
            SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
            FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
            UNION ALL
            SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
            FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2014
            UNION ALL
            SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
            FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2015
        ) AS combined_outpatient
        GROUP BY "provider_id", "provider_name"
    ) AS outpatient
    ON inpatient."provider_id" = outpatient."provider_id"
    ORDER BY inpatient."total_inpatient_cost" DESC
    LIMIT 100;
Results:
Too long, hard cut:
provider_id,provider_name,total_inpatient_cost,total_outpatient_cost
330101,NEW YORK-PRESBYTERIAN HOSPITAL,1921462142.0,39998301.0
330101,NEW YORK-PRESBYTERIAN HOSPITAL,1921462142.0,9407033.199776823
100007,FLORIDA HOSPITAL,1293059027.0,6002536.1900027245
100007,FLORIDA HOSPITAL,1293059027.0,21199643.0
50625,CEDARS-SINAI MEDICAL CENTER,1111247205.0,46337688.0
70022,YALE-NEW HAVEN HOSPITAL,1065172588.0,41166131.0
330059,MONTEFIORE MEDICAL CENTER,1064056005.0,32726033.0
330059,MONTEFIORE MEDICAL CENTER,1064056005.0,10395142.40029329
330024,MOUNT SINAI HOSPITAL,1029121838.0,8119652.15014505
330024,MOUNT SINAI HOSPITAL,1029121838.0,22636625.0
220071,MASSACHUSETTS GENERAL HOSPITAL,999580128.0,85101884.0
220071,MASSACHUSETTS GENERAL HOSPITAL,999580128.0,23400267.119404454
80001,"CHRISTIANA CARE HEALTH SERVICES, INC.",915920368.0,39204001.0
260032,BARNES JEWISH HOSPITAL,823355959.0,5090139.749996881
260032,BARNES JEWISH HOSPITAL,823355959.0,17250163.0
450388,METHODIST HOSPITAL,796111529.0,26203709.0
450388,METHODIST HOSPITAL,796111529.0,7105325.029859422
220110,BRIGHAM AND WOMEN'S HOSPITAL,785511555.0,16085388.899918554
220110,BRIGHAM AND WOMEN'S HOSPITAL,785511555.0,54394052.0
440049,METHODIST HEALTHCARE MEMPHIS HOSPITALS,765625561.0,5423035.149979259
440049,METHODIST HEALTHCARE MEMPHIS HOSPITALS,765625561.0,22049274.0
330106,NORTH SHORE UNIVERSITY HOSPITAL,763949450.0,5417512.01998135
330106,NORTH SHORE UNIVERSITY HOSPITAL,763949450.0,17915485.0
360180,CLEVELAND CLINIC,762405614.0,54990709.43008416
360180,CLEVELAND CLINIC,762405614.0,150549148.0
240010,MAYO CLINIC HOSPITAL ROCHESTER,761687402.0,533983.0
240010,MAYO CLINIC HOSPITAL ROCHESTER,761687402.0,525619.0
240010,MAYO CLINIC HOSPITAL ROCHESTER,761687402.0,8898908.81004183
240010,MAYO CLINIC HOSPITAL ROCHESTER,761687402.0,6736982.0
150056,INDIANA UNIVERSITY HEALTH,749972082.0,6685666.569976699
150056,INDIANA UNIVERSITY HEALTH,749972082.0,21824602.0
330194,MAIMONIDES MEDICAL CENTER,717409561.0,8152564.0
330194,MAIMONIDES MEDICAL CENTER,717409561.0,5695991.699980838
230046,UNIVERSITY OF MICHIGAN HEALTH SYSTEM,680185220.0,67257221.0
230046,UNIVERSITY OF MICHIGAN HEALTH SYSTEM,680185220.0,27590245.59999176
340030,DUKE UNIVERSITY HOSPITAL,674120048.0,15344092.51999104
340030,DUKE UNIVERSITY HOSPITAL,674120048.0,55787406.0
330169,BETH ISRAEL MEDICAL CENTER,668306090.0,8391604.549768595
330169,BETH ISRAEL MEDICAL CENTER,668306090.0,37751459.0
340040,VIDANT MEDICAL CENTER,647383497.0,2742965.21999448
340040,VIDANT MEDICAL CENTER,647383497.0,7773628.0
340040,VIDANT MEDICAL CENTER,647383497.0,2250830.0
70025,HARTFORD HOSPITAL,641833194.0,12505429.0
450358,"METHODIST HOSPITAL,THE",640404017.0,11310303.0
450358,"METHODIST HOSPITAL,THE",640404017.0,2942626.98998078
220163,UMASS MEMORIAL MEDICAL CENTER INC,639284118.0,67128558.0
220163,UMASS MEMORIAL MEDICAL CENTER INC,639284118.0,18680004.019428506
390164,UPMC PRESBYTERIAN SHADYSIDE,635584986.0,21593270.0
390164,UPMC PRESBYTERIAN SHADYSIDE,635584986.0,3991250.2000091583
50454,UCSF MEDICAL CENTER,629965827.0,80752369.0
220086,BETH ISRAEL DEACONESS MEDICAL CENTER,628999939.0,64111619.0
220086,BETH ISRAEL DEACONESS MEDICAL CENTER,628999939.0,16372895.700483732
340141,NEW HANOVER REGIONAL MEDICAL CENTER,627341625.0,5695645.0800252315
340141,NEW HANOVER REGIONAL MEDICAL CENTER,627341625.0,19742167.0
220077,BAYSTATE MEDICAL CENTER,619696360.0,32089214.0
220077,BAYSTATE MEDICAL CENTER,619696360.0,8045928.690004963
450184,MEMORIAL HERMANN HOSPITAL SYSTEM,605791482.0,3241684.339978442
450184,MEMORIAL HERMANN HOSPITAL SYSTEM,605791482.0,12305889.0
340113,CAROLINAS MEDICAL CENTER/BEHAV HEALTH,601536705.0,10125402.380011812
340113,CAROLINAS MEDICAL CENTER/BEHAV HEALTH,601536705.0,30494834.0
520138,AURORA ST LUKES MEDICAL CENTER,597720284.0,20785132.0
520138,AURORA ST LUKES MEDICAL CENTER,597720284.0,5932276.009966872
220074,"SOUTHCOAST HOSPITAL GROUP, INC",596408540.0,6693870.949936705
220074,"SOUTHCOAST HOSPITAL GROUP, INC",596408540.0,17330442.0
390174,THOMAS JEFFERSON UNIVERSITY HOSPITAL,591302486.0,12403883.0
390174,THOMAS JEFFERSON UNIVERSITY HOSPITAL,591302486.0,3283511.4399867663
310001,HACKENSACK UNIVERSITY MEDICAL CENTER,589208916.0,6289267.450082436
310001,HACKENSACK UNIVERSITY MEDICAL CENTER,589208916.0,17795108.0
330214,NYU HOSPITALS CENTER,586976434.0,10744924.870009555
330214,NYU HOSPITALS CENTER,586976434.0,23693487.0
340002,MEMORIAL MISSION HOSPITAL AND ASHEVILLE SURGERY CE,578546731.0,25295316.0
340002,MEMORIAL MISSION HOSPITAL AND ASHEVILLE SURGERY CE,578546731.0,7734261.9199386
230038,SPECTRUM HEALTH - BUTTERWORTH CAMPUS,563866815.0,3489645.540008816
230038,SPECTRUM HEALTH - BUTTERWORTH CAMPUS,563866815.0,15391126.0
340047,NORTH CAROLINA BAPTIST HOSPITAL,549377243.0,11783704.710026164
340047,NORTH CAROLINA BAPTIST HOSPITAL,549377243.0,42950059.0
140208,ADVOCATE CHRIST HOSPITAL & MEDICAL CENTER,545101224.0,11662939.0
140208,ADVOCATE CHRIST HOSPITAL & MEDICAL CENTER,545101224.0,3130497.530007915
10039,HUNTSVILLE HOS

2025-02-12 17:47:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:47:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:47:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:47:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 17:47:02 - snowflake.connector.connection - INFO - closed
2025-02-12 17:47:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:47:03 - root - INFO - SQL:
SELECT DISTINCT i."provider_id", i."provider_name"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011 AS i
    INNER JOIN CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011 AS o
    ON i."provider_id" = o."provider_id"
    LIMIT 100;
Results:
provider_id,provider_name
220024,HOLYOKE MEDICAL CENTER
220015,"COOLEY DICKINSON HOSPITAL INC,THE"
220065,NOBLE HOSPITAL
220066,MERCY MEDICAL CENTER
220046,BERKSHIRE MEDICAL CENTER INC
220098,NASHOBA VALLEY MEDICAL CENTER
220001,"HEALTHALLIANCE HOSPITALS, INC"
220176,ST VINCENT HOSPITAL
220163,UMASS MEMORIAL MEDICAL CENTER INC
220175,METROWEST MEDICAL CENTER
220080,HOLY FAMILY HOSPITAL
220036,ST ELIZABETH'S MEDICAL CENTER
220108,MILTON HOSPITAL INC
220052,SIGNATURE HEALTHCARE BROCKTON HOSPITAL
220101,NEWTON-WELLESLEY HOSPITAL
220008,STURDY MEMORIAL HOSPITAL
220074,"SOUTHCOAST HOSPITAL GROUP, INC"
220060,JORDAN HOSPITAL INC
410001,MEMORIAL HOSPITAL OF RHODE ISLAND
300017,PARKLAND MEDICAL CENTER
200025,PARKVIEW ADVENTIST MEDICAL CENTER
200052,NORTHERN MAINE MEDICAL CENTER
470011,BRATTLEBORO MEMORIAL HOSPITAL
70005,WATERBURY HOSPITAL
310086,KENNEDY UNIVERSITY HOSPITAL - STRATFORD DIV
390150,SOUTHWEST REGIONAL MEDICAL CENTER
220031,BOSTON MEDICAL CENTER CORPORATION
410008,SOUTH COUNTY HOSPITAL INC
410005,ST JOSEPH HEALTH SERVICES OF RI
300011,ST JOSEPH HOSPITAL
300034,CATHOLIC MEDICAL CENTER
200031,CARY MEDICAL CENTER
200041,INLAND HOSPITAL
70029,BRISTOL HOSPITAL
70021,WINDHAM COMM MEM HOSP & HATCH HOSP
70016,SAINT MARYS HOSPITAL
70039,MASONIC HOME AND HOSPITAL
310045,ENGLEWOOD HOSPITAL AND MEDICAL CENTER
310091,MEMORIAL HOSPITAL OF SALEM COUNTY
310029,OUR LADY OF LOURDES MEDICAL CENTER
310073,JERSEY SHORE UNIVERSITY MEDICAL CENTER
330002,PENINSULA HOSPITAL CENTER
330224,BENEDICTINE HOSPITAL
330135,BON SECOURS COMMUNITY HOSPITAL
390173,INDIANA REGIONAL MEDICAL CENTER
390122,TITUSVILLE HOSPITAL
490045,PRINCE WILLIAM HOSPITAL
340114,REX HOSPITAL
420091,CAROLINAS HOSPITAL SYSTEM
310012,VALLEY HOSPITAL
330372,FRANKLIN HOSPITAL
330215,"ROME MEMORIAL HOSPITAL, INC"
330219,ERIE COUNTY MEDICAL CENTER
330102,KENMORE MERCY HOSPITAL
330037,LAKESIDE MEMORIAL HOSPITAL
390219,EXCELA HEALTH LATROBE HOSPITAL
330277,CORNING HOSPITAL
390058,CARLISLE REGIONAL MEDICAL CENTER
390045,WILLIAMSPORT REGIONAL MEDICAL CENTER
80007,BEEBE MEDICAL CENTER
510085,CAMC TEAYS VALLEY HOSPITAL
420101,COASTAL CAROLINA HOSPITAL
110031,SPALDING REGIONAL MEDICAL CENTER
260163,PARKLAND HEALTH CENTER
220095,HEYWOOD HOSPITAL
220082,SAINTS  MEDICAL CENTER INC
220126,NORWOOD HOSPITAL
220017,CARNEY HOSPITAL
200033,EASTERN MAINE MEDICAL CENTER
470024,NORTHWESTERN MEDICAL CENTER INC
310032,SOUTH JERSEY HEALTHCARE REGIONAL MEDICAL CENTER
330195,LONG ISLAND JEWISH MEDICAL CENTER
220063,LOWELL GENERAL HOSPITAL
220067,QUINCY MEDICAL CENTER
220070,HALLMARK HEALTH SYSTEM
410006,NEWPORT HOSPITAL
410013,WESTERLY HOSPITAL
410010,WOMEN AND INFANTS HOSPITAL OF RHODE ISLAND
200008,MERCY HOSPITAL
70035,"HOSPITAL OF CENTRAL CONNECTICUT, THE"
200020,YORK HOSPITAL
200019,SOUTHERN MAINE MEDICAL CENTER
310111,CENTRASTATE MEDICAL CENTER
310069,SOUTH JERSEY HEALTHCARE-ELMER HOSPITAL
330169,BETH ISRAEL MEDICAL CENTER
330158,GOOD SAMARITAN HOSPITAL OF SUFFERN
330019,"NEW YORK COMMUNITY HOSPITAL OF BROOKLYN, INC."
330055,NEW YORK HOSPITAL MEDICAL CENTER OF QUEENS
330225,LONG BEACH MEDICAL CENTER
330043,SOUTHSIDE HOSPITAL
330047,ST MARY'S HOSPITAL AT AMSTERDAM
330394,"UNITED HEALTH SERVICES HOSPITALS, INC"
330229,BROOKS MEMORIAL HOSPITAL
330188,MOUNT ST MARY'S HOSPITAL AND  HEALTH CENTER
330065,NIAGARA FALLS MEMORIAL MEDICAL CENTER
330226,UNITY HOSPITAL OF ROCHESTER
390211,SHARON REGIONAL HEALTH SYSTEM
390307,EDGEWOOD SURGICAL HOSPITAL
410004,ROGER WILLIAMS MEDICAL CENTER
200039,MAINE GENERAL MEDICAL CENTER

2025-02-12 17:47:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:47:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:47:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:47:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 17:47:04 - snowflake.connector.connection - INFO - closed
2025-02-12 17:47:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:47:04 - root - INFO - SQL:
SELECT "provider_id", "provider_name",
           SUM("total_discharges") AS "total_discharges"
    FROM (
        SELECT "provider_id", "provider_name", "total_discharges"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
        UNION ALL
        SELECT "provider_id", "provider_name", "total_discharges"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
        UNION ALL
        SELECT "provider_id", "provider_name", "total_discharges"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
        UNION ALL
        SELECT "provider_id", "provider_name", "total_discharges"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
        UNION ALL
        SELECT "provider_id", "provider_name", "total_discharges"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
    ) AS combined_discharges
    GROUP BY "provider_id", "provider_name"
    ORDER BY "total_discharges" DESC
    LIMIT 100;
Results:
provider_id,provider_name,total_discharges
100007,FLORIDA HOSPITAL,151068
330101,NEW YORK-PRESBYTERIAN HOSPITAL,100564
80001,"CHRISTIANA CARE HEALTH SERVICES, INC.",87542
450388,METHODIST HOSPITAL,85615
440049,METHODIST HEALTHCARE MEMPHIS HOSPITALS,76872
70022,YALE-NEW HAVEN HOSPITAL,68410
220074,"SOUTHCOAST HOSPITAL GROUP, INC",66784
50625,CEDARS-SINAI MEDICAL CENTER,62828
260032,BARNES JEWISH HOSPITAL,62522
220071,MASSACHUSETTS GENERAL HOSPITAL,61915
340141,NEW HANOVER REGIONAL MEDICAL CENTER,61780
450184,MEMORIAL HERMANN HOSPITAL SYSTEM,61671
340002,MEMORIAL MISSION HOSPITAL AND ASHEVILLE SURGERY CE,61570
450058,BAPTIST MEDICAL CENTER,61022
10039,HUNTSVILLE HOSPITAL,60872
330059,MONTEFIORE MEDICAL CENTER,60434
140010,EVANSTON HOSPITAL,60363
330106,NORTH SHORE UNIVERSITY HOSPITAL,59485
330024,MOUNT SINAI HOSPITAL,57926
520138,AURORA ST LUKES MEDICAL CENTER,57198
360180,CLEVELAND CLINIC,55776
100018,NAPLES COMMUNITY HOSPITAL,55066
310022,VIRTUA WEST JERSEY HOSPITALS BERLIN,53382
390133,LEHIGH VALLEY HOSPITAL,53322
230038,SPECTRUM HEALTH - BUTTERWORTH CAMPUS,52917
310041,COMMUNITY MEDICAL CENTER,52666
340040,VIDANT MEDICAL CENTER,52467
150056,INDIANA UNIVERSITY HEALTH,52386
510022,CHARLESTON AREA MEDICAL CENTER,51883
440048,BAPTIST MEMORIAL HOSPITAL,51118
340091,"MOSES H CONE MEMORIAL HOSPITAL, THE",50880
230019,PROVIDENCE HOSPITAL AND MEDICAL CENTERS,50719
330169,BETH ISRAEL MEDICAL CENTER,50578
450358,"METHODIST HOSPITAL,THE",50124
100012,LEE MEMORIAL HOSPITAL,49833
390164,UPMC PRESBYTERIAN SHADYSIDE,49747
440002,JACKSON-MADISON COUNTY GENERAL HOSPITAL,49728
360006,RIVERSIDE METHODIST HOSPITAL,49418
180040,JEWISH HOSPITAL & ST MARY'S HEALTHCARE,48943
490021,"CENTRA  HEALTH, INC",48621
340113,CAROLINAS MEDICAL CENTER/BEHAV HEALTH,48077
440091,"MEMORIAL HEALTHCARE SYSTEM, INC",48064
70025,HARTFORD HOSPITAL,48013
100157,LAKELAND REGIONAL MEDICAL CENTER,47914
10092,D C H REGIONAL MEDICAL CENTER,47243
100006,ORLANDO HEALTH,47138
100204,NORTH FLORIDA REGIONAL MEDICAL CENTER,46894
370091,"SAINT FRANCIS HOSPITAL, INC",46466
340115,FIRSTHEALTH MOORE REGIONAL HOSPITAL,46116
220077,BAYSTATE MEDICAL CENTER,46087
230195,ST JOHN MACOMB-OAKLAND HOSPITAL-MACOMB CENTER,45936
140208,ADVOCATE CHRIST HOSPITAL & MEDICAL CENTER,45753
310012,VALLEY HOSPITAL,45361
190111,WILLIS KNIGHTON MEDICAL CENTER,45361
310086,KENNEDY UNIVERSITY HOSPITAL - STRATFORD DIV,45356
230156,ST JOSEPH MERCY HOSPITAL,44934
150082,DEACONESS HOSPITAL INC,44880
240057,ABBOTT NORTHWESTERN HOSPITAL,44849
340028,CAPE FEAR VALLEY MEDICAL CENTER,44430
310001,HACKENSACK UNIVERSITY MEDICAL CENTER,44418
110035,WELLSTAR KENNESTONE HOSPITAL,44134
450021,BAYLOR UNIVERSITY MEDICAL CENTER,43948
240010,MAYO CLINIC HOSPITAL ROCHESTER,43369
140281,NORTHWESTERN MEMORIAL HOSPITAL,43303
220110,BRIGHAM AND WOMEN'S HOSPITAL,43219
490063,INOVA FAIRFAX HOSPITAL,43013
100087,SARASOTA MEMORIAL HOSPITAL,42807
230046,UNIVERSITY OF MICHIGAN HEALTH SYSTEM,42707
220163,UMASS MEMORIAL MEDICAL CENTER INC,42685
390174,THOMAS JEFFERSON UNIVERSITY HOSPITAL,42386
390100,LANCASTER GENERAL HOSPITAL,42225
250004,NORTH MISSISSIPPI MEDICAL CENTER,41853
340069,"WAKEMED, RALEIGH CAMPUS",41718
40114,BAPTIST HEALTH MEDICAL CENTER-LITTLE ROCK,40968
210023,ANNE ARUNDEL MEDICAL CENTER,40936
340030,DUKE UNIVERSITY HOSPITAL,40884
10033,UNIVERSITY OF ALABAMA HOSPITAL,40857
450135,TEXAS HEALTH HARRIS METHODIST FORT WORTH,40783
340047,NORTH CAROLINA BAPTIST HOSPITAL,40298
140062,PALOS COMMUNITY HOSPITAL,40096
140148,MEMORIAL MEDICAL CENTER,39885
330140,ST JOSEPH'S HOSPITAL HEALTH CENTER,39883
210009,"JOHNS HOPKINS HOSPITAL, THE",39881
230130,"BEAUMONT HOSPITAL, ROYAL OAK",39708
110029,"NORTHEAST GEORGIA MEDICAL CENTER, INC",39556
230165,ST JOHN HOSPITAL AND MEDICAL CENTER,39331
70002,ST FRANCIS HOSPITAL & MEDICAL CENTER,39266
370114,"ST JOHN MEDICAL CENTER, INC",38784
420051,MCLEOD REGIONAL MEDICAL CENTER-PEE DEE,38773
100019,HOLMES REGIONAL MEDICAL CENTER,38757
220100,SOUTH SHORE HOSPITAL,38656
100220,GULF COAST MEDICAL CENTER LEE MEM HEALTH SYSTEM,38560
330005,KALEIDA HEALTH,38522
450102,MOTHER FRANCES HOSPITAL,38491
150084,ST VINCENT HOSPITAL & HEALTH SERVICES,38490
220086,BETH ISRAEL DEACONESS MEDICAL CENTER,38328
360085,OHIO STATE UNIVERSITY HOSPITALS,38041
250078,FORREST GENERAL HOSPITAL,37984
240036,ST CLOUD HOSPITAL,37801
140067,SAINT FRANCIS MEDICAL CENTER,37698

2025-02-12 17:47:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:47:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:47:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:47:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 17:47:06 - snowflake.connector.connection - INFO - closed
2025-02-12 17:47:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:47:07 - root - INFO - SQL:
SELECT "provider_id", "provider_name",
           SUM("total_discharges" * "average_medicare_payments") AS "total_inpatient_cost"
    FROM (
        SELECT "provider_id", "provider_name", "provider_state",
               "total_discharges", "average_medicare_payments"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
        WHERE "provider_state" = 'CA'
        UNION ALL
        SELECT "provider_id", "provider_name", "provider_state",
               "total_discharges", "average_medicare_payments"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
        WHERE "provider_state" = 'CA'
        UNION ALL
        SELECT "provider_id", "provider_name", "provider_state",
               "total_discharges", "average_medicare_payments"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
        WHERE "provider_state" = 'CA'
        UNION ALL
        SELECT "provider_id", "provider_name", "provider_state",
               "total_discharges", "average_medicare_payments"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
        WHERE "provider_state" = 'CA'
        UNION ALL
        SELECT "provider_id", "provider_name", "provider_state",
               "total_discharges", "average_medicare_payments"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
        WHERE "provider_state" = 'CA'
    ) AS combined_inpatient
    GROUP BY "provider_id", "provider_name"
    ORDER BY "total_inpatient_cost" DESC
    LIMIT 100;
Results:
provider_id,provider_name,total_inpatient_cost
50625,CEDARS-SINAI MEDICAL CENTER,1111247205.0
50454,UCSF MEDICAL CENTER,629965827.0
50599,UNIVERSITY OF CALIFORNIA DAVIS MEDICAL CENTER,528556816.0
50441,STANFORD HOSPITAL,493924448.0
50060,COMMUNITY REGIONAL MEDICAL CENTER,397058089.0
50093,SAINT AGNES MEDICAL CENTER,382653459.0
50025,UNIVERSITY OF CALIFORNIA SAN DIEGO MEDICAL CENTER,357422325.0
50026,GROSSMONT HOSPITAL,305211986.0
50573,EISENHOWER MEDICAL CENTER,305153473.0
50077,SCRIPPS MERCY HOSPITAL,304003807.0
50438,HUNTINGTON MEMORIAL HOSPITAL,294481681.0
50516,MERCY SAN JUAN MEDICAL CENTER,293385859.0
50108,SUTTER GENERAL HOSPITAL,290471328.0
50047,CALIFORNIA PACIFIC MEDICAL CTR-PACIFIC CAMPUS HOSP,289492325.0
50739,CENTINELA HOSPITAL MEDICAL CENTER,289057406.0
50262,RONALD REAGAN U C L A MEDICAL CENTER,286935217.0
50327,LOMA LINDA UNIVERSITY MEDICAL CENTER,286163879.0
50057,KAWEAH DELTA MEDICAL CENTER,282720729.0
50239,GLENDALE ADVENTIST MEDICAL CENTER,281308333.0
50224,HOAG MEMORIAL HOSPITAL PRESBYTERIAN,279292338.0
50125,REGIONAL MEDICAL CENTER OF SAN JOSE,274866328.0
50180,JOHN MUIR MEDICAL CENTER - WALNUT CREEK CAMPUS,274002976.0
50039,ENLOE MEDICAL CENTER,273148803.0
50280,MERCY MEDICAL CENTER REDDING,266529582.0
50195,WASHINGTON HOSPITAL,264040254.0
50441,STANFORD HEALTH CARE,252808051.0
50308,EL CAMINO HOSPITAL,248170668.0
50235,PROVIDENCE SAINT JOSEPH MEDICAL CTR,246172403.0
50043,ALTA BATES SUMMIT MEDICAL CENTER,241870845.0
50549,LOS ROBLES HOSPITAL & MEDICAL CENTER,237836768.0
50174,SANTA ROSA MEMORIAL HOSPITAL,236075660.0
50238,METHODIST HOSPITAL OF SOUTHERN CA,235285226.0
50485,LONG BEACH MEMORIAL MEDICAL CENTER,232455135.0
50017,MERCY GENERAL HOSPITAL,229714379.0
50382,CITRUS VALLEY MEDICAL CENTER-IC CAMPUS,223193669.0
50133,RIDEOUT MEMORIAL HOSPITAL,222819497.0
50309,SUTTER ROSEVILLE MEDICAL CENTER,220056792.0
50145,COMMUNITY HOSPITAL OF THE MONTEREY PENINSULA,217304411.0
50380,GOOD SAMARITAN HOSPITAL,213120770.0
50100,SHARP MEMORIAL HOSPITAL,212948158.0
50396,SANTA BARBARA COTTAGE HOSPITAL,211229751.0
50334,SALINAS VALLEY MEMORIAL HOSPITAL,210705739.0
50696,KECK HOSPITAL OF USC,207748412.0
50464,DOCTORS MEDICAL CENTER,197658876.0
50761,PROVIDENCE TARZANA MEDICAL CENTER,197463841.0
50351,TORRANCE MEMORIAL MEDICAL CENTER,192795493.0
50112,SANTA MONICA - UCLA MED CTR & ORTHOPAEDIC HOSPITAL,192704914.0
50496,JOHN MUIR MEDICAL CENTER - CONCORD CAMPUS,190674650.0
50348,UNIVERSITY OF CALIFORNIA IRVINE MED CENTER,190516222.0
50471,GOOD SAMARITAN HOSPITAL,188399530.0
50022,RIVERSIDE COMMUNITY HOSPITAL,185667023.0
50444,MERCY MEDICAL CENTER,183559457.0
50030,OROVILLE HOSPITAL,179326996.0
50557,MEMORIAL  MEDICAL CENTER,177949865.0
50567,MISSION HOSPITAL REGIONAL MED CENTER,177078817.0
50353,PROVIDENCE LITTLE COMPANY OF MARY MED CTR TORRANCE,176871296.0
50764,SHASTA REGIONAL MEDICAL CENTER,175675449.0
50570,FOUNTAIN VALLEY REGIONAL HOSPITAL & MEDICAL CENTER,172114646.0
50242,DOMINICAN HOSPITAL,171989587.0
50153,O'CONNOR HOSPITAL,171378757.0
50502,SAINT VINCENT MEDICAL CENTER,166907178.0
50278,PROVIDENCE HOLY CROSS MEDICAL CENTER,166677564.0
50360,MARIN GENERAL HOSPITAL,164282514.0
50103,WHITE MEMORIAL MEDICAL CENTER,160983979.0
50069,ST JOSEPH HOSPITAL,159658624.0
50231,POMONA VALLEY HOSPITAL MEDICAL CENTER,158260309.0
50488,EDEN MEDICAL CENTER,158214007.0
50063,HOLLYWOOD PRESBYTERIAN MEDICAL CENTER,157412627.0
50324,SCRIPPS MEMORIAL HOSPITAL LA JOLLA,156741969.0
50116,NORTHRIDGE HOSPITAL MEDICAL CENTER,155927407.0
50222,SHARP CHULA VISTA MEDICAL CENTER,154456962.0
50305,ALTA BATES SUMMIT MEDICAL CENTER - ALTA BATES CAMP,152319781.0
50126,VALLEY PRESBYTERIAN HOSPITAL,152151314.0
50455,SAN JOAQUIN COMMUNITY HOSPITAL,149116529.0
50168,ST JUDE MEDICAL CENTER,147333825.0
50058,GLENDALE MEM HOSPITAL & HLTH CENTER,146388455.0
50424,SCRIPPS GREEN HOSPITAL,146106032.0
50038,SANTA CLARA VALLEY MEDICAL CENTER,144979112.0
50367,NORTHBAY MEDICAL CENTER,144946195.0
50084,ST JOSEPHS MEDICAL CENTER OF STOCKTON,144110167.0
50262,RONALD REAGAN UCLA MEDICAL CENTER,142892122.0
50128,TRI-CITY MEDICAL CENTER,141139051.0
50737,GARFIELD MEDICAL CENTER,140738718.0
50013,ST HELENA HOSPITAL,139475784.0
50107,MARIAN REGIONAL MEDICAL CENTER,138819733.0
50024,PARADISE VALLEY HOSPITAL,137111439.0
50082,ST JOHNS REGIONAL MEDICAL CENTER,136151056.0
50121,ADVENTIST MEDICAL CENTER,135802656.0
50169,PRESBYTERIAN INTERCOMMUNITY HOSPITAL,134771795.0
50481,WEST HILLS HOSPITAL & MEDICAL CENTER,132757865.0
50135,SOUTHERN CALIFORNIA HOSPITAL AT HOLLYWOOD,130547306.0
50300,ST MARY MEDICAL CENTER,126398672.0
50603,SADDLEBACK MEMORIAL MEDICAL CENTER,125695304.0
50289,SETON MEDICAL CENTER,125610412.0
50742,OLYMPIA MEDICAL CENTER,124149008.0
50036,BAKERSFIELD MEMORIAL HOSPITAL,122538590.0
50115,PALOMAR HEALTH DOWNTOWN CAMPUS,122050749.0
50129,ST BERNARDINE MEDICAL CENTER,121048734.0
50590,METHODIST HOSPITAL OF SACRAMENTO,120663286.0
50104,SAINT FRANCIS MEDICAL CENTER,112198248.0

2025-02-12 17:47:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:47:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:47:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:47:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-12 17:47:08 - snowflake.connector.connection - INFO - closed
2025-02-12 17:47:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:47:08 - root - INFO - SQL:
SELECT "drg_definition",
           AVG("average_total_payments") AS "avg_total_payments"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
    GROUP BY "drg_definition"
    ORDER BY "avg_total_payments" DESC
    LIMIT 100;
Results:
Too long, hard cut:
drg_definition,avg_total_payments
870 - SEPTICEMIA OR SEVERE SEPSIS W MV 96+ HOURS,44259.482428115014
853 - INFECTIOUS & PARASITIC DISEASES W O.R. PROCEDURE W MCC,40315.96511627907
207 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT 96+ HOURS,38588.93379191746
329 - MAJOR SMALL & LARGE BOWEL PROCEDURES W MCC,37765.60907859079
460 - SPINAL FUSION EXCEPT CERVICAL W/O MCC,27778.671921921923
246 - PERC CARDIOVASC PROC W DRUG-ELUTING STENT W MCC OR 4+ VESSELS/STENTS,23326.346782988003
252 - OTHER VASCULAR PROCEDURES W MCC,22845.635099913117
469 - MAJOR JOINT REPLACEMENT OR REATTACHMENT OF LOWER EXTREMITY W MCC,22531.270386266093
238 - MAJOR CARDIOVASC PROCEDURES W/O MCC,21948.559772296016
480 - HIP & FEMUR PROCEDURES EXCEPT MAJOR JOINT W MCC,20984.37029063509
243 - PERMANENT CARDIAC PACEMAKER IMPLANT W CC,18132.926086956522
330 - MAJOR SMALL & LARGE BOWEL PROCEDURES W CC,17926.67122473246
253 - OTHER VASCULAR PROCEDURES W CC,17317.72152950956
208 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT <96 HOURS,16213.295534370296
"286 - CIRCULATORY DISORDERS EXCEPT AMI, W CARD CATH W MCC",14937.647252747252
473 - CERVICAL SPINAL FUSION W/O CC/MCC,14672.594562647753
470 - MAJOR JOINT REPLACEMENT OR REATTACHMENT OF LOWER EXTREMITY W/O MCC,14566.933454545455
247 - PERC CARDIOVASC PROC W DRUG-ELUTING STENT W/O MCC,14353.513494318182
244 - PERMANENT CARDIAC PACEMAKER IMPLANT W/O CC/MCC,13899.711627906976
177 - RESPIRATORY INFECTIONS & INFLAMMATIONS W MCC,13829.388067581838
314 - OTHER CIRCULATORY SYSTEM DIAGNOSES W MCC,13316.076576576577
251 - PERC CARDIOVASC PROC W/O CORONARY ARTERY STENT W/O MCC,13315.21870701513
064 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W MCC,13263.828812537673
871 - SEPTICEMIA OR SEVERE SEPSIS W/O MV 96+ HOURS W MCC,13238.827169274538
481 - HIP & FEMUR PROCEDURES EXCEPT MAJOR JOINT W CC,12632.269377990431
249 - PERC CARDIOVASC PROC W NON-DRUG-ELUTING STENT W/O MCC,12593.507853403142
377 - G.I. HEMORRHAGE W MCC,12490.134008338297
"280 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W MCC",12441.674109516214
698 - OTHER KIDNEY & URINARY TRACT DIAGNOSES W MCC,11706.83180778032
418 - LAPAROSCOPIC CHOLECYSTECTOMY W/O C.D.E. W CC,11576.15849843587
682 - RENAL FAILURE W MCC,11540.286847014926
254 - OTHER VASCULAR PROCEDURES W/O CC/MCC,11488.65108695652
917 - POISONING & TOXIC EFFECTS OF DRUGS W MCC,10763.817319098458
482 - HIP & FEMUR PROCEDURES EXCEPT MAJOR JOINT W/O CC/MCC,10468.1875
602 - CELLULITIS W MCC,10425.569312169313
291 - HEART FAILURE & SHOCK W MCC,10266.53926311872
193 - SIMPLE PNEUMONIA & PLEURISY W MCC,10053.691650485436
178 - RESPIRATORY INFECTIONS & INFLAMMATIONS W CC,9800.383000512033
811 - RED BLOOD CELL DISORDERS W MCC,9256.672246696035
189 - PULMONARY EDEMA & RESPIRATORY FAILURE,9056.333015267175
372 - MAJOR GASTROINTESTINAL DISORDERS & PERITONEAL INFECTIONS W CC,8747.234387672344
308 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W MCC,8690.29840425532
"391 - ESOPHAGITIS, GASTROENT & MISC DIGEST DISORDERS W MCC",8481.85796178344
689 - KIDNEY & URINARY TRACT INFECTIONS W MCC,8193.42725409836
190 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W MCC,8163.0
"640 - MISC DISORDERS OF NUTRITION,METABOLISM,FLUIDS/ELECTROLYTES W MCC",8129.8835616438355
419 - LAPAROSCOPIC CHOLECYSTECTOMY W/O C.D.E. W/O CC/MCC,8068.098737083812
"281 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W CC",7994.263933376041
065 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W CC,7922.669017188188
872 - SEPTICEMIA OR SEVERE SEPSIS W/O MV 96+ HOURS W/O MCC,7886.2
"287 - CIRCULATORY DISORDERS EXCEPT AMI, W CARD CATH W/O MCC",7736.451388888889
699 - OTHER KIDNEY & URINARY TRACT DIAGNOSES W CC,7288.379347826087
176 - PULMONARY EMBOLISM W/O MCC,7279.953438395415
439 - DISORDERS OF PANCREAS EXCEPT MALIGNANCY W CC,7266.566492146597
394 - OTHER DIGESTIVE SYSTEM DIAGNOSES W CC,7110.477022653722
491 - BACK & NECK PROC EXC SPINAL FUSION W/O CC/MCC,7083.436923076923
378 - G.I. HEMORRHAGE W CC,7027.50156128025
315 - OTHER CIRCULATORY SYSTEM DIAGNOSES W CC,7020.110593713621
683 - RENAL FAILURE W CC,6995.784290271133
885 - PSYCHOSES,6968.740619902121
194 - SIMPLE PNEUMONIA & PLEURISY W CC,6963.26132980483
039 - EXTRACRANIAL PROCEDURES W/O CC/MCC,6960.548656163114
292 - HEART FAILURE & SHOCK W CC,6957.839146630546
300 - PERIPHERAL VASCULAR DISORDERS W CC,6761.6086671043995
057 - DEGENERATIVE NERVOUS SYSTEM DISORDERS W/O MCC,6706.283930058285
191 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W CC,6627.31580882353
389 - G.I. OBSTRUCTION W CC,6447.10286677909
074 - CRANIAL & PERIPHERAL NERVE DISORDERS W/O MCC,6386.799795709908
202 - BRONCHITIS & ASTHMA W CC/MCC,6011.3309248554915
638 - DIABETES W CC,5889.57967032967
603 - CELLULITIS W/O MCC,5798.943712148201
309 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W CC,5791.492170969107
552 - MEDICAL BACK PROBLEMS W/O MCC,5725.792892837313
066 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W/O CC/MCC,5714.003322259136
812 - RED BLOOD CELL DISORDERS W/O MCC,5562.1516587677725
"282 - ACUTE MYOC

2025-02-12 17:47:08 - root - INFO - itercount: 0
2025-02-12 17:47:08 - root - INFO - Database Name: CMS_DATA
Schema Name: CMS_CODES
,0
table_name,HCPCS
description,
DDL,"create or replace TABLE HCPCS (
	HCPC VARCHAR(16777216),
	SEQNUM VARCHAR(16777216),
	RECID NUMBER(38,0),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216),
	PRICE1 VARCHAR(16777216),
	PRICE2 VARCHAR(16777216),
	PRICE3 VARCHAR(16777216),
	PRICE4 VARCHAR(16777216),
	MULT_PI VARCHAR(16777216),
	CIM1 VARCHAR(16777216),
	CIM2 VARCHAR(16777216),
	CIM3 VARCHAR(16777216),
	MCM1 FLOAT,
	MCM2 NUMBER(38,0),
	MCM3 VARCHAR(16777216),
	STATUTE VARCHAR(16777216),
	LABCERT1 VARCHAR(16777216),
	LABCERT2 VARCHAR(16777216),
	LABCERT3 VARCHAR(16777216),
	LABCERT4 VARCHAR(16777216),
	LABCERT5 VARCHAR(16777216),
	LABCERT6 VARCHAR(16777216),
	LABCERT7 VARCHAR(16777216),
	LABCERT8 VARCHAR(16777216),
	XREF1 VARCHAR(16777216),
	XREF2 VARCHAR(16777216),
	XREF3 VARCHAR(16777216),
	XREF4 VARCHAR(16777216),
	XREF5 VARCHAR(16777216),
	COV VARCHAR(16777216),
	ASC_GRP VARCHAR(16777216),
	ASC_DT VARCHAR(16777216),
	OPPS VARCHAR(16777216),
	OPPS_PI VARCHAR(16777216),
	OPPS_DT VARCHAR(16777216),
	PROCNOTE VARCHAR(16777216),
	BETOS VARCHAR(16777216),
	TOS1 VARCHAR(16777216),
	TOS2 VARCHAR(16777216),
	TOS3 VARCHAR(16777216),
	TOS4 VARCHAR(16777216),
	TOS5 VARCHAR(16777216),
	ANEST_BU VARCHAR(16777216),
	ADD_DT VARCHAR(16777216),
	ACT_EFF_DT VARCHAR(16777216),
	TERM_DT VARCHAR(16777216),
	ACTION_CD BOOLEAN
);"

Database Name: CMS_DATA
Schema Name: CMS_CODES
,1
table_name,ICD10_PROCEDURES_2019
description,
DDL,"create or replace TABLE ICD10_PROCEDURES_2019 (
	""order_number"" VARCHAR(16777216),
	""pcs_code"" VARCHAR(16777216),
	""is_header_code"" BOOLEAN,
	""short_description"" VARCHAR(16777216),
	""long_description"" VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_CODES
,2
table_name,ICD9_DIAGNOSES
description,
DDL,"create or replace TABLE ICD9_DIAGNOSES (
	DIAGNOSIS_CODE VARCHAR(16777216),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_CODES
,3
table_name,ICD10_DIAGNOSES_2019
description,
DDL,"create or replace TABLE ICD10_DIAGNOSES_2019 (
	""order_number"" VARCHAR(16777216),
	""cm_code"" VARCHAR(16777216),
	""is_header_code"" BOOLEAN,
	""short_description"" VARCHAR(16777216),
	""long_description"" VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_CODES
,4
table_name,ICD9_PROCEDURES
description,
DDL,"create or replace TABLE ICD9_PROCEDURES (
	PROCEDURE_CODE VARCHAR(16777216),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_MEDICARE
,0
table_name,HOME_HEALTH_AGENCIES_2013
description,
DDL,"create or replace TABLE HOME_HEALTH_AGENCIES_2013 (
	""provider_id"" VARCHAR(16777216),
	""agency_name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""total_episodes_non_lupa"" NUMBER(38,0),
	""distinct_users_non_lupa"" NUMBER(38,0),
	""total_hha_charge_amount_non_lupa"" NUMBER(38,0),
	""total_hha_medicare_payment_amount_non_lupa"" NUMBER(38,0),
	""total_hha_medicare_standard_payment_amount_non_lupa"" NUMBER(38,0),
	""outlier_payments_as_a_percent_of_medicare_payment_amount_non_lupa"" NUMBER(38,0),
	""total_lupa_episodes"" NUMBER(38,0),
	""total_hha_medicare_payment_amount_for_lupas"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014']
Database Name: CMS_DATA
Schema Name: CMS_MEDICARE
,1
table_name,HOSPICE_PROVIDERS_2014
description,
DDL,"create or replace TABLE HOSPICE_PROVIDERS_2014 (
	""provider_id"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""hrr"" VARCHAR(16777216),
	""hospice_beneficiaries"" NUMBER(38,0),
	""total_days"" NUMBER(38,0),
	""total_medicare_payment_amount"" NUMBER(38,0),
	""total_medicare_standard_payment_amount"" NUMBER(38,0),
	""total_charge_amount"" NUMBER(38,0),
	""percent_routine_home_care_days"" NUMBER(38,0),
	""physician_services"" NUMBER(38,0),
	""home_health_visit_hours_per_day"" FLOAT,
	""skilled_nursing_visit_hours_per_day"" FLOAT,
	""social_service_visit_hours_per_day"" FLOAT,
	""total_live_discharges"" NUMBER(38,0),
	""hospice_beneficiaries_with_seven_or_fewer_hospice_care_days"" NUMBER(38,0),
	""hospice_beneficiaries_with_more_than_sixty_hospice_care_days"" NUMBER(38,0),
	""hospice_beneficiaries_with_more_than_one_hundred_eighty_hospice_care_days"" NUMBER(38,0),
	""home_health_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""skilled_nursing_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""social_service_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""average_age"" FLOAT,
	""male_hospice_beneficiaries"" NUMBER(38,0),
	""female_hospice_beneficiaries"" NUMBER(38,0),
	""white_hospice_beneficiaries"" NUMBER(38,0),
	""black_hospice_beneficiaries"" NUMBER(38,0),
	""asian_hospice_beneficiaries"" NUMBER(38,0),
	""hispanic_hospice_beneficiaries"" NUMBER(38,0),
	""other_unknown_race_hospice_beneficiaries"" NUMBER(38,0),
	""medicare_advantage_hospice_beneficiaries"" NUMBER(38,0),
	""medicaid_eligible_hospice_beneficiaries"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_cancer"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_dementia"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_stroke"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_circulatory_heart_disease"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_respiratory_disease"" NUMBER(38,0),
	""hospice_beneficiaries_with_other_primary_diagnoses"" NUMBER(38,0),
	""site_of_service_home_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_assisted_living_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_long_term_care_or_non_skilled_nursing_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_skilled_nursing_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_inpatient_hospital_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_inpatient_hospice_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_other_facility_hospice_beneficiaries"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_MEDICARE
,2
table_name,HOSPITAL_GENERAL_INFO
description,
DDL,"create or replace TABLE HOSPITAL_GENERAL_INFO (
	""provider_id"" VARCHAR(16777216),
	""hospital_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""phone_number"" VARCHAR(16777216),
	""hospital_type"" VARCHAR(16777216),
	""hospital_ownership"" VARCHAR(16777216),
	""emergency_services"" BOOLEAN,
	""meets_criteria_for_promoting_interoperability_of_ehrs"" BOOLEAN,
	""hospital_overall_rating"" VARCHAR(16777216),
	""hospital_overall_rating_footnote"" VARCHAR(16777216),
	""mortality_group_measure_count"" VARCHAR(16777216),
	""facility_mortaility_measures_count"" VARCHAR(16777216),
	""mortality_measures_better_count"" VARCHAR(16777216),
	""mortality_measures_no_different_count"" VARCHAR(16777216),
	""mortality_measures_worse_count"" VARCHAR(16777216),
	""mortaility_group_footnote"" VARCHAR(16777216),
	""safety_measures_count"" VARCHAR(16777216),
	""facility_care_safety_measures_count"" VARCHAR(16777216),
	""safety_measures_better_count"" VARCHAR(16777216),
	""safety_measures_no_different_count"" VARCHAR(16777216),
	""safety_measures_worse_count"" VARCHAR(16777216),
	""safety_group_footnote"" VARCHAR(16777216),
	""readmission_measures_count"" VARCHAR(16777216),
	""facility_readmission_measures_count"" VARCHAR(16777216),
	""readmission_measures_better_count"" VARCHAR(16777216),
	""readmission_measures_no_different_count"" VARCHAR(16777216),
	""readmission_measures_worse_count"" VARCHAR(16777216),
	""readmission_measures_footnote"" VARCHAR(16777216),
	""patient_experience_measures_count"" VARCHAR(16777216),
	""facility_patient_experience_measures_count"" VARCHAR(16777216),
	""patient_experience_measures_footnote"" VARCHAR(16777216),
	""timely_and_effective_care_measures_count"" VARCHAR(16777216),
	""facility_timely_and_effective_care_measures_count"" VARCHAR(16777216),
	""timely_and_effective_care_measures_footnote"" VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_MEDICARE
,3
table_name,INPATIENT_CHARGES_2011
description,
DDL,"create or replace TABLE INPATIENT_CHARGES_2011 (
	""provider_id"" VARCHAR(16777216),
	""provider_name"" VARCHAR(16777216),
	""provider_street_address"" VARCHAR(16777216),
	""provider_city"" VARCHAR(16777216),
	""provider_state"" VARCHAR(16777216),
	""provider_zipcode"" VARCHAR(16777216),
	""drg_definition"" VARCHAR(16777216),
	""hospital_referral_region_description"" VARCHAR(16777216),
	""total_discharges"" NUMBER(38,0),
	""average_covered_charges"" FLOAT,
	""average_total_payments"" FLOAT,
	""average_medicare_payments"" FLOAT
);"

Some other tables have the similar structure: ['INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2015']
Database Name: CMS_DATA
Schema Name: CMS_MEDICARE
,4
table_name,NURSING_FACILITIES_2014
description,
DDL,"create or replace TABLE NURSING_FACILITIES_2014 (
	""provider_id"" VARCHAR(16777216),
	""facility_name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""total_stays"" NUMBER(38,0),
	""distinct_beneficiaries_per_provider"" NUMBER(38,0),
	""average_length_of_stays_days"" FLOAT,
	""total_snf_charge_amount"" NUMBER(38,0),
	""total_snf_medicare_allowed_amount"" NUMBER(38,0),
	""total_snf_medicare_payment_amount"" NUMBER(38,0),
	""total_snf_medicare_standard_payment_amount"" NUMBER(38,0),
	""average_age"" NUMBER(38,0),
	""male_beneficiaries"" NUMBER(38,0),
	""female_beneficiaries"" NUMBER(38,0),
	""nondual_beneficiaries"" NUMBER(38,0),
	""dual_beneficiaries"" NUMBER(38,0),
	""white_beneficiaries"" NUMBER(38,0),
	""black_beneficiaries"" NUMBER(38,0),
	""asian_pacific_islander_beneficiaries"" NUMBER(38,0),
	""hispanic_beneficiaries"" NUMBER(38,0),
	""american_indian_or_alaska_native_beneficiaries"" NUMBER(38,0),
	""other_unknown_beneficiaries"" NUMBER(38,0),
	""average_hcc_score"" FLOAT,
	""percent_of_beneficiaries_with_atrial_fibrillation"" NUMBER(38,0),
	""percent_of_beneficiaries_with_alzheimers"" NUMBER(38,0),
	""percent_of_beneficiaries_with_asthma"" NUMBER(38,0),
	""percent_of_beneficiaries_with_cancer"" NUMBER(38,0),
	""percent_of_beneficiaries_with_chf"" NUMBER(38,0),
	""percent_of_beneficiaries_with_chronic_kidney_disease"" NUMBER(38,0),
	""percent_of_beneficiaries_with_copd"" NUMBER(38,0),
	""percent_of_beneficiaries_with_depression"" NUMBER(38,0),
	""percent_of_beneficiaries_with_diabetes"" NUMBER(38,0),
	""percent_of_beneficiaries_with_hyperlipidemia"" NUMBER(38,0),
	""percent_of_beneficiaries_with_hypertension"" NUMBER(38,0),
	""percent_of_beneficiaries_with_ihd"" NUMBER(38,0),
	""percent_of_beneficiaries_with_osteoporosis"" NUMBER(38,0),
	""percent_of_beneficiaries_with_ra_oa"" NUMBER(38,0),
	""percent_of_beneficiaries_with_schizophrenia"" NUMBER(38,0),
	""percent_of_beneficiaries_with_stroke"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['NURSING_FACILITIES_2014', 'NURSING_FACILITIES_2013']
Database Name: CMS_DATA
Schema Name: CMS_MEDICARE
,5
table_name,OUTPATIENT_CHARGES_2012
description,
DDL,"create or replace TABLE OUTPATIENT_CHARGES_2012 (
	""provider_id"" VARCHAR(16777216),
	""provider_name"" VARCHAR(16777216),
	""provider_street_address"" VARCHAR(16777216),
	""provider_city"" VARCHAR(16777216),
	""provider_state"" VARCHAR(16777216),
	""provider_zipcode"" VARCHAR(16777216),
	""apc"" VARCHAR(16777216),
	""hospital_referral_region"" VARCHAR(16777216),
	""outpatient_services"" NUMBER(38,0),
	""average_estimated_submitted_charges"" FLOAT,
	""average_total_payments"" FLOAT
);"

Some other tables have the similar structure: ['OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2015']
Database Name: CMS_DATA
Schema Name: CMS_MEDICARE
,6
table_name,PART_D_PRESCRIBER_2014
description,
DDL,"create or replace TABLE PART_D_PRESCRIBER_2014 (
	""npi"" VARCHAR(16777216),
	""nppes_provider_last_org_name"" VARCHAR(16777216),
	""nppes_provider_first_name"" VARCHAR(16777216),
	""nppes_provider_city"" VARCHAR(16777216),
	""nppes_provider_state"" VARCHAR(16777216),
	""specialty_description"" VARCHAR(16777216),
	""description_flag"" VARCHAR(16777216),
	""drug_name"" VARCHAR(16777216),
	""generic_name"" VARCHAR(16777216),
	""bene_count"" NUMBER(38,0),
	""total_claim_count"" NUMBER(38,0),
	""total_day_supply"" NUMBER(38,0),
	""total_drug_cost"" FLOAT,
	""bene_count_ge65"" NUMBER(38,0),
	""bene_count_ge65_suppress_flag"" VARCHAR(16777216),
	""total_claim_count_ge65"" NUMBER(38,0),
	""ge65_suppress_flag"" VARCHAR(16777216),
	""total_day_supply_ge65"" NUMBER(38,0),
	""total_drug_cost_ge65"" FLOAT,
	""total_30_day_fill_count"" FLOAT,
	""total_30_day_fill_count_ge65"" FLOAT
);"

Database Name: CMS_DATA
Schema Name: CMS_MEDICARE
,7
table_name,REFERRING_DURABLE_MEDICAL_EQUIP_2013
description,
DDL,"create or replace TABLE REFERRING_DURABLE_MEDICAL_EQUIP_2013 (
	""referring_npi"" VARCHAR(16777216),
	""referring_provider_last_name_organization_name"" VARCHAR(16777216),
	""referring_provider_first_name"" VARCHAR(16777216),
	""referring_provider_middle_initial"" VARCHAR(16777216),
	""referring_provider_credentials"" VARCHAR(16777216),
	""referring_provider_gender"" VARCHAR(16777216),
	""referring_provider_entity_code"" VARCHAR(16777216),
	""referring_provider_street_1"" VARCHAR(16777216),
	""referring_provider_street_2"" VARCHAR(16777216),
	""referring_provider_city"" VARCHAR(16777216),
	""referring_provider_state"" VARCHAR(16777216),
	""referring_provider_zip"" VARCHAR(16777216),
	""referring_provider_country"" VARCHAR(16777216),
	""referring_provider_type"" VARCHAR(16777216),
	""referring_provider_type_flag"" VARCHAR(16777216),
	""number_of_suppliers"" NUMBER(38,0),
	""number_of_supplier_hcpcs"" NUMBER(38,0),
	""number_of_supplier_beneficiaries"" NUMBER(38,0),
	""number_of_supplier_claims"" NUMBER(38,0),
	""number_of_supplier_services"" NUMBER(38,0),
	""supplier_submitted_charges"" FLOAT,
	""supplier_medicare_allowed_amount"" FLOAT,
	""supplier_medicare_payment_amount"" FLOAT,
	""durable_medical_equipment_suppression_indicator"" VARCHAR(16777216),
	""number_of_durable_medical_equipment_suppliers"" NUMBER(38,0),
	""number_of_durable_medical_equipment_hcpcs"" NUMBER(38,0),
	""number_of_durable_medical_equipment_beneficiaries"" NUMBER(38,0),
	""number_of_durable_medical_equipment_claims"" NUMBER(38,0),
	""number_of_durable_medical_equipment_services"" NUMBER(38,0),
	""durable_medical_equipment_submitted_charges"" FLOAT,
	""durable_medical_equipment_medicare_allowed_amount"" FLOAT,
	""durable_medical_equipment_medicare_payment_amount"" FLOAT,
	""prosthetic_and_orthotic_suppression_indicator"" VARCHAR(16777216),
	""number_of_prosthetic_and_orthotic_suppliers"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_hcpcs"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_beneficiaries"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_claims"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_services"" NUMBER(38,0),
	""prosthetic_and_orthotic_submitted_charges"" FLOAT,
	""prosthetic_and_orthotic_medicare_allowed_amount"" FLOAT,
	""prosthetic_and_orthotic_medicare_payment_amount"" FLOAT,
	""drug_and_nutritional_suppression_indicator"" VARCHAR(16777216),
	""number_of_drug_and_nutritional_products_suppliers"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_hcpcs"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_beneficiaries"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_claims"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_services"" NUMBER(38,0),
	""drug_and_nutritional_products_submitted_charges"" FLOAT,
	""drug_and_nutritional_products_medicare_allowed_amount"" FLOAT,
	""drug_and_nutritional_products_medicare_payment_amount"" FLOAT
);"

Some other tables have the similar structure: ['REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014']
Database Name: CMS_DATA
Schema Name: CMS_MEDICARE
,8
table_name,PHYSICIANS_AND_OTHER_SUPPLIER_2015
description,
DDL,"create or replace TABLE PHYSICIANS_AND_OTHER_SUPPLIER_2015 (
	""npi"" VARCHAR(16777216),
	""nppes_provider_last_org_name"" VARCHAR(16777216),
	""nppes_provider_first_name"" VARCHAR(16777216),
	""nppes_provider_mi"" VARCHAR(16777216),
	""nppes_credentials"" VARCHAR(16777216),
	""nppes_provider_gender"" VARCHAR(16777216),
	""nppes_entity_code"" VARCHAR(16777216),
	""nppes_provider_street1"" VARCHAR(16777216),
	""nppes_provider_street2"" VARCHAR(16777216),
	""nppes_provider_city"" VARCHAR(16777216),
	""nppes_provider_zip"" VARCHAR(16777216),
	""nppes_provider_state"" VARCHAR(16777216),
	""nppes_provider_country"" VARCHAR(16777216),
	""provider_type"" VARCHAR(16777216),
	""medicare_participation_indicator"" VARCHAR(16777216),
	""place_of_service"" VARCHAR(16777216),
	""hcpcs_code"" VARCHAR(16777216),
	""hcpcs_description"" VARCHAR(16777216),
	""hcpcs_drug_indicator"" VARCHAR(16777216),
	""line_srvc_cnt"" FLOAT,
	""bene_unique_cnt"" NUMBER(38,0),
	""bene_day_srvc_cnt"" NUMBER(38,0),
	""average_medicare_allowed_amt"" FLOAT,
	""average_submitted_chrg_amt"" FLOAT,
	""average_medicare_payment_amt"" FLOAT,
	""average_medicare_standard_amt"" FLOAT
);"

Some other tables have the similar structure: ['PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014']
Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,0
table_name,CONDITION_OCCURRENCE
description,
DDL,"create or replace TABLE CONDITION_OCCURRENCE (
	""condition_occurrence_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""condition_concept_id"" NUMBER(38,0),
	""condition_start_date"" DATE,
	""condition_start_datetime"" NUMBER(38,0),
	""condition_end_date"" DATE,
	""condition_end_datetime"" NUMBER(38,0),
	""condition_type_concept_id"" NUMBER(38,0),
	""stop_reason"" VARCHAR(16777216),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""condition_source_value"" VARCHAR(16777216),
	""condition_source_concept_id"" NUMBER(38,0),
	""condition_status_source_value"" VARCHAR(16777216),
	""condition_status_concept_id"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,1
table_name,DRUG_ERA
description,
DDL,"create or replace TABLE DRUG_ERA (
	""drug_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""drug_era_start_date"" DATE,
	""drug_era_end_date"" DATE,
	""drug_exposure_count"" NUMBER(38,0),
	""gap_days"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,2
table_name,LOCATION
description,
DDL,"create or replace TABLE LOCATION (
	""location_id"" NUMBER(38,0),
	""address_1"" VARCHAR(16777216),
	""address_2"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""location_source_value"" VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,3
table_name,PERSON
description,
DDL,"create or replace TABLE PERSON (
	""race_concept_id"" NUMBER(38,0),
	""ethnicity_concept_id"" NUMBER(38,0),
	""location_id"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""care_site_id"" NUMBER(38,0),
	""person_source_value"" VARCHAR(16777216),
	""gender_source_value"" VARCHAR(16777216),
	""gender_source_concept_id"" NUMBER(38,0),
	""race_source_value"" VARCHAR(16777216),
	""race_source_concept_id"" NUMBER(38,0),
	""ethnicity_source_value"" VARCHAR(16777216),
	""ethnicity_source_concept_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""gender_concept_id"" NUMBER(38,0),
	""year_of_birth"" NUMBER(38,0),
	""month_of_birth"" NUMBER(38,0),
	""day_of_birth"" NUMBER(38,0),
	""birth_datetime"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,4
table_name,CONDITION_ERA
description,
DDL,"create or replace TABLE CONDITION_ERA (
	""condition_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""condition_concept_id"" NUMBER(38,0),
	""condition_era_start_date"" DATE,
	""condition_era_end_date"" DATE,
	""condition_occurrence_count"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,5
table_name,DEVICE_EXPOSURE
description,
DDL,"create or replace TABLE DEVICE_EXPOSURE (
	""device_exposure_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""device_concept_id"" NUMBER(38,0),
	""device_exposure_start_date"" DATE,
	""device_exposure_start_datetime"" NUMBER(38,0),
	""device_exposure_end_date"" DATE,
	""device_exposure_end_datetime"" NUMBER(38,0),
	""device_type_concept_id"" NUMBER(38,0),
	""unique_device_id"" VARCHAR(16777216),
	""quantity"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""device_source_value"" VARCHAR(16777216),
	""device_source_concept_id"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,6
table_name,DOMAIN
description,
DDL,"create or replace TABLE DOMAIN (
	""domain_id"" VARCHAR(16777216),
	""domain_name"" VARCHAR(16777216),
	""domain_concept_id"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,7
table_name,DOSE_ERA
description,
DDL,"create or replace TABLE DOSE_ERA (
	""dose_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""unit_concept_id"" NUMBER(38,0),
	""dose_value"" FLOAT,
	""dose_era_start_date"" DATE,
	""dose_era_end_date"" DATE
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,8
table_name,OBSERVATION
description,
DDL,"create or replace TABLE OBSERVATION (
	""observation_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""observation_concept_id"" NUMBER(38,0),
	""observation_date"" DATE,
	""observation_datetime"" NUMBER(38,0),
	""observation_type_concept_id"" NUMBER(38,0),
	""value_as_number"" FLOAT,
	""value_as_string"" VARCHAR(16777216),
	""value_as_concept_id"" NUMBER(38,0),
	""qualifier_concept_id"" NUMBER(38,0),
	""unit_concept_id"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""observation_source_value"" VARCHAR(16777216),
	""observation_source_concept_id"" NUMBER(38,0),
	""unit_source_value"" VARCHAR(16777216),
	""qualifier_source_value"" VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,9
table_name,COST
description,
DDL,"create or replace TABLE COST (
	""cost_id"" NUMBER(38,0),
	""cost_event_id"" NUMBER(38,0),
	""cost_domain_id"" VARCHAR(16777216),
	""cost_type_concept_id"" NUMBER(38,0),
	""currency_concept_id"" NUMBER(38,0),
	""total_charge"" FLOAT,
	""total_cost"" FLOAT,
	""total_paid"" FLOAT,
	""paid_by_payer"" FLOAT,
	""paid_by_patient"" FLOAT,
	""paid_patient_copay"" FLOAT,
	""paid_patient_coinsurance"" FLOAT,
	""paid_patient_deductible"" FLOAT,
	""paid_by_primary"" FLOAT,
	""paid_ingredient_cost"" FLOAT,
	""paid_dispensing_fee"" FLOAT,
	""payer_plan_period_id"" NUMBER(38,0),
	""amount_allowed"" FLOAT,
	""revenue_code_concept_id"" NUMBER(38,0),
	""revenue_code_source_value"" VARCHAR(16777216),
	""drg_concept_id"" NUMBER(38,0),
	""drg_source_value"" VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,10
table_name,PROVIDER
description,
DDL,"create or replace TABLE PROVIDER (
	""provider_id"" NUMBER(38,0),
	""provider_name"" VARCHAR(16777216),
	""npi"" VARCHAR(16777216),
	""dea"" VARCHAR(16777216),
	""specialty_concept_id"" NUMBER(38,0),
	""care_site_id"" NUMBER(38,0),
	""year_of_birth"" NUMBER(38,0),
	""gender_concept_id"" NUMBER(38,0),
	""provider_source_value"" VARCHAR(16777216),
	""specialty_source_value"" VARCHAR(16777216),
	""specialty_source_concept_id"" NUMBER(38,0),
	""gender_source_value"" VARCHAR(16777216),
	""gender_source_concept_id"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,11
table_name,CARE_SITE
description,
DDL,"create or replace TABLE CARE_SITE (
	""care_site_id"" NUMBER(38,0),
	""care_site_name"" VARCHAR(16777216),
	""place_of_service_concept_id"" NUMBER(38,0),
	""location_id"" NUMBER(38,0),
	""care_site_source_value"" VARCHAR(16777216),
	""place_of_service_source_value"" VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,12
table_name,CONCEPT_ANCESTOR
description,
DDL,"create or replace TABLE CONCEPT_ANCESTOR (
	""ancestor_concept_id"" NUMBER(38,0),
	""descendant_concept_id"" NUMBER(38,0),
	""min_levels_of_separation"" NUMBER(38,0),
	""max_levels_of_separation"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,13
table_name,CONCEPT_RELATIONSHIP
description,
DDL,"create or replace TABLE CONCEPT_RELATIONSHIP (
	""concept_id_1"" NUMBER(38,0),
	""concept_id_2"" NUMBER(38,0),
	""relationship_id"" VARCHAR(16777216),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,14
table_name,DEATH
description,
DDL,"create or replace TABLE DEATH (
	""person_id"" NUMBER(38,0),
	""death_date"" DATE,
	""death_datetime"" NUMBER(38,0),
	""death_type_concept_id"" NUMBER(38,0),
	""cause_concept_id"" NUMBER(38,0),
	""cause_source_value"" VARCHAR(16777216),
	""cause_source_concept_id"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,15
table_name,DRUG_STRENGTH
description,
DDL,"create or replace TABLE DRUG_STRENGTH (
	""drug_concept_id"" NUMBER(38,0),
	""ingredient_concept_id"" NUMBER(38,0),
	""amount_value"" FLOAT,
	""amount_unit_concept_id"" NUMBER(38,0),
	""numerator_value"" FLOAT,
	""numerator_unit_concept_id"" NUMBER(38,0),
	""denominator_value"" FLOAT,
	""denominator_unit_concept_id"" NUMBER(38,0),
	""box_size"" NUMBER(38,0),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,16
table_name,CONCEPT
description,
DDL,"create or replace TABLE CONCEPT (
	""concept_id"" NUMBER(38,0),
	""concept_name"" VARCHAR(16777216),
	""domain_id"" VARCHAR(16777216),
	""vocabulary_id"" VARCHAR(16777216),
	""concept_class_id"" VARCHAR(16777216),
	""standard_concept"" VARCHAR(16777216),
	""concept_code"" VARCHAR(16777216),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,17
table_name,CONCEPT_CLASS
description,
DDL,"create or replace TABLE CONCEPT_CLASS (
	""concept_class_id"" VARCHAR(16777216),
	""concept_class_name"" VARCHAR(16777216),
	""concept_class_concept_id"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,18
table_name,DRUG_EXPOSURE
description,
DDL,"create or replace TABLE DRUG_EXPOSURE (
	""drug_type_concept_id"" NUMBER(38,0),
	""stop_reason"" VARCHAR(16777216),
	""refills"" NUMBER(38,0),
	""quantity"" FLOAT,
	""days_supply"" NUMBER(38,0),
	""sig"" VARCHAR(16777216),
	""route_concept_id"" NUMBER(38,0),
	""lot_number"" VARCHAR(16777216),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""drug_source_value"" VARCHAR(16777216),
	""drug_source_concept_id"" NUMBER(38,0),
	""route_source_value"" VARCHAR(16777216),
	""dose_unit_source_value"" VARCHAR(16777216),
	""drug_exposure_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""drug_exposure_start_date"" DATE,
	""drug_exposure_start_datetime"" NUMBER(38,0),
	""drug_exposure_end_date"" DATE,
	""drug_exposure_end_datetime"" NUMBER(38,0),
	""verbatim_end_date"" DATE
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,19
table_name,OBSERVATION_PERIOD
description,
DDL,"create or replace TABLE OBSERVATION_PERIOD (
	""observation_period_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""observation_period_start_date"" DATE,
	""observation_period_end_date"" DATE,
	""period_type_concept_id"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,20
table_name,PAYER_PLAN_PERIOD
description,
DDL,"create or replace TABLE PAYER_PLAN_PERIOD (
	""payer_concept_id"" NUMBER(38,0),
	""payer_source_value"" VARCHAR(16777216),
	""payer_source_concept_id"" NUMBER(38,0),
	""plan_concept_id"" NUMBER(38,0),
	""plan_source_value"" VARCHAR(16777216),
	""plan_source_concept_id"" NUMBER(38,0),
	""sponsor_concept_id"" NUMBER(38,0),
	""sponsor_source_value"" VARCHAR(16777216),
	""sponsor_source_concept_id"" NUMBER(38,0),
	""family_source_value"" VARCHAR(16777216),
	""stop_reason_concept_id"" NUMBER(38,0),
	""stop_reason_source_value"" VARCHAR(16777216),
	""stop_reason_source_concept_id"" NUMBER(38,0),
	""payer_plan_period_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""payer_plan_period_start_date"" DATE,
	""payer_plan_period_end_date"" DATE
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,21
table_name,RELATIONSHIP
description,
DDL,"create or replace TABLE RELATIONSHIP (
	""relationship_id"" VARCHAR(16777216),
	""relationship_name"" VARCHAR(16777216),
	""is_hierarchical"" VARCHAR(16777216),
	""defines_ancestry"" VARCHAR(16777216),
	""reverse_relationship_id"" VARCHAR(16777216),
	""relationship_concept_id"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,22
table_name,VOCABULARY
description,
DDL,"create or replace TABLE VOCABULARY (
	""vocabulary_id"" VARCHAR(16777216),
	""vocabulary_name"" VARCHAR(16777216),
	""vocabulary_reference"" VARCHAR(16777216),
	""vocabulary_version"" VARCHAR(16777216),
	""vocabulary_concept_id"" NUMBER(38,0)
);"

Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
,23
table_name,PROCEDURE_OCCURRENCE
description,
DDL,"create or replace TABLE PROCEDURE_OCCURRENCE (
	""procedure_type_concept_id"" NUMBER(38,0),
	""modifier_concept_id"" NUMBER(38,0),
	""quantity"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""procedure_source_value"" VARCHAR(16777216),
	""procedure_source_concept_id"" NUMBER(38,0),
	""modifier_source_value"" VARCHAR(16777216),
	""procedure_occurrence_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""procedure_concept_id"" NUMBER(38,0),
	""procedure_dat"" DATE,
	""procedure_datetime"" NUMBER(38,0)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'CMS_DATA': {'CMS_CODES': ['HCPCS', 'ICD10_PROCEDURES_2019', 'ICD9_DIAGNOSES', 'ICD10_DIAGNOSES_2019', 'ICD9_PROCEDURES'], 'CMS_MEDICARE': ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014', 'HOSPICE_PROVIDERS_2014', 'HOSPITAL_GENERAL_INFO', 'INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2015', 'NURSING_FACILITIES_2014', 'NURSING_FACILITIES_2014', 'NURSING_FACILITIES_2013', 'OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2015', 'PART_D_PRESCRIBER_2014', 'REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014'], 'CMS_SYNTHETIC_PATIENT_DATA_OMOP': ['CONDITION_OCCURRENCE', 'DRUG_ERA', 'LOCATION', 'PERSON', 'CONDITION_ERA', 'DEVICE_EXPOSURE', 'DOMAIN', 'DOSE_ERA', 'OBSERVATION', 'COST', 'PROVIDER', 'CARE_SITE', 'CONCEPT_ANCESTOR', 'CONCEPT_RELATIONSHIP', 'DEATH', 'DRUG_STRENGTH', 'CONCEPT', 'CONCEPT_CLASS', 'DRUG_EXPOSURE', 'OBSERVATION_PERIOD', 'PAYER_PLAN_PERIOD', 'RELATIONSHIP', 'VOCABULARY', 'PROCEDURE_OCCURRENCE']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **INPATIENT_CHARGES_2011 to INPATIENT_CHARGES_2015**

   - **"provider_id"**: Used to identify providers uniquely.
   - **"provider_name"**: Name of the provider; useful for readability.
   - **"total_discharges"**: Number of inpatient discharges; used to calculate inpatient cost.
   - **"average_medicare_payments"**: Average Medicare payment per discharge; used to calculate inpatient cost.

2. **OUTPATIENT_CHARGES_2011 to OUTPATIENT_CHARGES_2015**

   - **"provider_id"**: Used to identify providers uniquely.
   - **"provider_name"**: Name of the provider; useful for readability.
   - **"outpatient_services"**: Number of outpatient services; used to calculate outpatient cost.
   - **"average_total_payments"**: Average total payment per outpatient service; used to calculate outpatient cost.

**Conditions That May Be Used:**

- Filtering data for the years **2011 through 2015**.
- **Grouping** data by **"provider_id"** and **"provider_name"** to aggregate costs.
- Calculating the **total inpatient cost** per provider across all years.
- **Identifying the provider** with the **highest total inpatient cost**.
- Calculating the **yearly average inpatient and outpatient costs** for the identified provider.

---

**SQL Queries:**

1. **View sample data from INPATIENT_CHARGES_2011**

   ```sql
   SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
   LIMIT 100;
   ```

2. **View sample data from OUTPATIENT_CHARGES_2011**

   ```sql
   SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments"
   FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
   LIMIT 100;
   ```

3. **List distinct providers in INPATIENT_CHARGES_2011**

   ```sql
   SELECT DISTINCT "provider_id", "provider_name"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
   LIMIT 100;
   ```

4. **Count the number of unique providers in INPATIENT_CHARGES_2011**

   ```sql
   SELECT COUNT(DISTINCT "provider_id") AS "num_providers"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011;
   ```

5. **Calculate inpatient cost per record in INPATIENT_CHARGES_2011**

   ```sql
   SELECT "provider_id", "provider_name", 
          "total_discharges", "average_medicare_payments",
          ("total_discharges" * "average_medicare_payments") AS "inpatient_cost"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
   LIMIT 100;
   ```

6. **Compute total inpatient cost per provider for 2011**

   ```sql
   SELECT "provider_id", "provider_name",
          SUM("total_discharges" * "average_medicare_payments") AS "total_inpatient_cost"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
   GROUP BY "provider_id", "provider_name"
   ORDER BY "total_inpatient_cost" DESC
   LIMIT 100;
   ```

7. **Compute total inpatient cost per provider from 2011 to 2015**

   ```sql
   SELECT "provider_id", "provider_name",
          SUM("total_discharges" * "average_medicare_payments") AS "total_inpatient_cost"
   FROM (
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
       UNION ALL
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
       UNION ALL
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
       UNION ALL
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
       UNION ALL
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
   ) AS combined_inpatient
   GROUP BY "provider_id", "provider_name"
   ORDER BY "total_inpatient_cost" DESC
   LIMIT 100;
   ```

8. **Identify the provider with the highest total inpatient cost from 2011 to 2015**

   ```sql
   SELECT "provider_id", "provider_name",
          SUM("total_discharges" * "average_medicare_payments") AS "total_inpatient_cost"
   FROM (
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
       UNION ALL
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
       UNION ALL
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
       UNION ALL
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
       UNION ALL
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
   ) AS combined_inpatient
   GROUP BY "provider_id", "provider_name"
   ORDER BY "total_inpatient_cost" DESC
   LIMIT 1;
   ```

9. **Compute yearly average inpatient cost for the top provider**

   ```sql
   -- Replace 'TOP_PROVIDER_ID' with the provider_id obtained from the previous query
   SELECT '2011' AS "Year",
          AVG("total_discharges" * "average_medicare_payments") AS "Average_Inpatient_Cost"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
   WHERE "provider_id" = 'TOP_PROVIDER_ID'
   UNION ALL
   SELECT '2012',
          AVG("total_discharges" * "average_medicare_payments")
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
   WHERE "provider_id" = 'TOP_PROVIDER_ID'
   UNION ALL
   SELECT '2013',
          AVG("total_discharges" * "average_medicare_payments")
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
   WHERE "provider_id" = 'TOP_PROVIDER_ID'
   UNION ALL
   SELECT '2014',
          AVG("total_discharges" * "average_medicare_payments")
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
   WHERE "provider_id" = 'TOP_PROVIDER_ID'
   UNION ALL
   SELECT '2015',
          AVG("total_discharges" * "average_medicare_payments")
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
   WHERE "provider_id" = 'TOP_PROVIDER_ID';
   ```

10. **Compute yearly average outpatient cost for the top provider**

    ```sql
    -- Replace 'TOP_PROVIDER_ID' with the provider_id obtained from query 8
    SELECT '2011' AS "Year",
           AVG("average_total_payments" * "outpatient_services") AS "Average_Outpatient_Cost"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
    WHERE "provider_id" = 'TOP_PROVIDER_ID'
    UNION ALL
    SELECT '2012',
           AVG("average_total_payments" * "outpatient_services")
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2012
    WHERE "provider_id" = 'TOP_PROVIDER_ID'
    UNION ALL
    SELECT '2013',
           AVG("average_total_payments" * "outpatient_services")
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
    WHERE "provider_id" = 'TOP_PROVIDER_ID'
    UNION ALL
    SELECT '2014',
           AVG("average_total_payments" * "outpatient_services")
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2014
    WHERE "provider_id" = 'TOP_PROVIDER_ID'
    UNION ALL
    SELECT '2015',
           AVG("average_total_payments" * "outpatient_services")
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2015
    WHERE "provider_id" = 'TOP_PROVIDER_ID';
    ```

11. **List top 5 providers by total outpatient cost from 2011 to 2015**

    ```sql
    SELECT "provider_id", "provider_name",
           SUM("average_total_payments" * "outpatient_services") AS "total_outpatient_cost"
    FROM (
        SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
        FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
        UNION ALL
        SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
        FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2012
        UNION ALL
        SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
        FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
        UNION ALL
        SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
        FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2014
        UNION ALL
        SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
        FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2015
    ) AS combined_outpatient
    GROUP BY "provider_id", "provider_name"
    ORDER BY "total_outpatient_cost" DESC
    LIMIT 5;
    ```

12. **Compute total inpatient and outpatient cost per provider from 2011 to 2015**

    ```sql
    SELECT inpatient."provider_id", inpatient."provider_name",
           inpatient."total_inpatient_cost", outpatient."total_outpatient_cost"
    FROM (
        SELECT "provider_id", "provider_name",
               SUM("total_discharges" * "average_medicare_payments") AS "total_inpatient_cost"
        FROM (
            SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
            FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
            UNION ALL
            SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
            FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
            UNION ALL
            SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
            FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
            UNION ALL
            SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
            FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
            UNION ALL
            SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
            FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
        ) AS combined_inpatient
        GROUP BY "provider_id", "provider_name"
    ) AS inpatient
    JOIN (
        SELECT "provider_id", "provider_name",
               SUM("average_total_payments" * "outpatient_services") AS "total_outpatient_cost"
        FROM (
            SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
            FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
            UNION ALL
            SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
            FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2012
            UNION ALL
            SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
            FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
            UNION ALL
            SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
            FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2014
            UNION ALL
            SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
            FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2015
        ) AS combined_outpatient
        GROUP BY "provider_id", "provider_name"
    ) AS outpatient
    ON inpatient."provider_id" = outpatient."provider_id"
    ORDER BY inpatient."total_inpatient_cost" DESC
    LIMIT 100;
    ```

13. **List distinct providers with both inpatient and outpatient services in 2011**

    ```sql
    SELECT DISTINCT i."provider_id", i."provider_name"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011 AS i
    INNER JOIN CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011 AS o
    ON i."provider_id" = o."provider_id"
    LIMIT 100;
    ```

14. **Calculate total number of discharges per provider over 2011-2015**

    ```sql
    SELECT "provider_id", "provider_name",
           SUM("total_discharges") AS "total_discharges"
    FROM (
        SELECT "provider_id", "provider_name", "total_discharges"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
        UNION ALL
        SELECT "provider_id", "provider_name", "total_discharges"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
        UNION ALL
        SELECT "provider_id", "provider_name", "total_discharges"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
        UNION ALL
        SELECT "provider_id", "provider_name", "total_discharges"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
        UNION ALL
        SELECT "provider_id", "provider_name", "total_discharges"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
    ) AS combined_discharges
    GROUP BY "provider_id", "provider_name"
    ORDER BY "total_discharges" DESC
    LIMIT 100;
    ```

15. **Identify providers in California with the highest inpatient costs from 2011 to 2015**

    ```sql
    SELECT "provider_id", "provider_name",
           SUM("total_discharges" * "average_medicare_payments") AS "total_inpatient_cost"
    FROM (
        SELECT "provider_id", "provider_name", "provider_state",
               "total_discharges", "average_medicare_payments"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
        WHERE "provider_state" = 'CA'
        UNION ALL
        SELECT "provider_id", "provider_name", "provider_state",
               "total_discharges", "average_medicare_payments"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
        WHERE "provider_state" = 'CA'
        UNION ALL
        SELECT "provider_id", "provider_name", "provider_state",
               "total_discharges", "average_medicare_payments"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
        WHERE "provider_state" = 'CA'
        UNION ALL
        SELECT "provider_id", "provider_name", "provider_state",
               "total_discharges", "average_medicare_payments"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
        WHERE "provider_state" = 'CA'
        UNION ALL
        SELECT "provider_id", "provider_name", "provider_state",
               "total_discharges", "average_medicare_payments"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
        WHERE "provider_state" = 'CA'
    ) AS combined_inpatient
    GROUP BY "provider_id", "provider_name"
    ORDER BY "total_inpatient_cost" DESC
    LIMIT 100;
    ```

16. **Find the average total payments for each DRG code in INPATIENT_CHARGES_2011**

    ```sql
    SELECT "drg_definition",
           AVG("average_total_payments") AS "avg_total_payments"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
    GROUP BY "drg_definition"
    ORDER BY "avg_total_payments" DESC
    LIMIT 100;
    ```

---

These queries help us understand the data related to providers' inpatient and outpatient costs from 2011 through 2015, identify the provider with the highest total inpatient cost, and calculate their yearly average inpatient and outpatient costs.Query:
SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
   LIMIT 100;
Answer:
provider_id,provider_name,total_discharges,average_medicare_payments
220024,HOLYOKE MEDICAL CENTER,13,6359.0
220024,HOLYOKE MEDICAL CENTER,17,10863.0
220024,HOLYOKE MEDICAL CENTER,26,6702.0
220024,HOLYOKE MEDICAL CENTER,26,3866.0
220024,HOLYOKE MEDICAL CENTER,21,4203.0
220024,HOLYOKE MEDICAL CENTER,11,5802.0
220024,HOLYOKE MEDICAL CENTER,18,12339.0
220024,HOLYOKE MEDICAL CENTER,22,8730.0
220024,HOLYOKE MEDICAL CENTER,23,7867.0
220024,HOLYOKE MEDICAL CENTER,54,6900.0
220024,HOLYOKE MEDICAL CENTER,91,5491.0
220024,HOLYOKE MEDICAL CENTER,59,3819.0
220024,HOLYOKE MEDICAL CENTER,36,8891.0
220024,HOLYOKE MEDICAL CENTER,91,5708.0
220024,HOLYOKE MEDICAL CENTER,26,3516.0
220024,HOLYOKE MEDICAL CENTER,23,4775.0
220024,HOLYOKE MEDICAL CENTER,17,3120.0
220024,HOLYOKE MEDICAL CENTER,12,13307.0
220024,HOLYOKE MEDICAL CENTER,13,16699.0
220024,HOLYOKE MEDICAL CENTER,27,9636.0
220024,HOLYOKE MEDICAL CENTER,18,5933.0
220024,HOLYOKE MEDICAL CENTER,12,4546.0
220024,HOLYOKE MEDICAL CENTER,45,8637.0
220024,HOLYOKE MEDICAL CENTER,51,5861.0
220024,HOLYOKE MEDICAL CENTER,28,3752.0
220024,HOLYOKE MEDICAL CENTER,16,7502.0
220024,HOLYOKE MEDICAL CENTER,35,4639.0
220024,HOLYOKE MEDICAL CENTER,42,2860.0
220024,HOLYOKE MEDICAL CENTER,32,4070.0
220024,HOLYOKE MEDICAL CENTER,48,2790.0
220024,HOLYOKE MEDICAL CENTER,11,29904.0
220024,HOLYOKE MEDICAL CENTER,15,15996.0
220024,HOLYOKE MEDICAL CENTER,13,7572.0
220024,HOLYOKE MEDICAL CENTER,18,9819.0
220024,HOLYOKE MEDICAL CENTER,38,6013.0
220024,HOLYOKE MEDICAL CENTER,13,3887.0
220024,HOLYOKE MEDICAL CENTER,12,4905.0
220024,HOLYOKE MEDICAL CENTER,14,3193.0
220024,HOLYOKE MEDICAL CENTER,18,7885.0
220024,HOLYOKE MEDICAL CENTER,76,3912.0
220024,HOLYOKE MEDICAL CENTER,14,5590.0
220024,HOLYOKE MEDICAL CENTER,11,6776.0
220024,HOLYOKE MEDICAL CENTER,41,12542.0
220024,HOLYOKE MEDICAL CENTER,19,11315.0
220024,HOLYOKE MEDICAL CENTER,15,4250.0
220024,HOLYOKE MEDICAL CENTER,11,3653.0
220024,HOLYOKE MEDICAL CENTER,59,4715.0
220024,HOLYOKE MEDICAL CENTER,21,4084.0
220024,HOLYOKE MEDICAL CENTER,12,7350.0
220024,HOLYOKE MEDICAL CENTER,34,3816.0
220024,HOLYOKE MEDICAL CENTER,43,9430.0
220024,HOLYOKE MEDICAL CENTER,81,5789.0
220024,HOLYOKE MEDICAL CENTER,19,6397.0
220024,HOLYOKE MEDICAL CENTER,78,4267.0
220024,HOLYOKE MEDICAL CENTER,14,4318.0
220024,HOLYOKE MEDICAL CENTER,101,11836.0
220024,HOLYOKE MEDICAL CENTER,29,6259.0
220024,HOLYOKE MEDICAL CENTER,23,3649.0
220024,HOLYOKE MEDICAL CENTER,11,3447.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",31,5627.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",29,3712.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",42,3513.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",23,3786.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",15,2982.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",21,4163.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",23,9526.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",34,7380.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",21,6644.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",52,6003.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",37,5007.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",29,3147.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",39,7676.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",109,5061.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",38,3145.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",20,4392.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",11,3075.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",22,12849.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",23,9875.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",21,5638.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",42,7884.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",83,5264.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",29,3154.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",14,4547.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",18,2977.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",37,6543.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",45,4200.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",48,2472.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",80,3441.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",58,2279.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",11,39400.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",25,14565.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",15,7041.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",16,10131.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",44,5057.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",13,3227.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",22,4662.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",13,2766.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",19,6234.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",103,3515.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",16,5367.0
Query:
SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments"
   FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
   LIMIT 100;
Answer:
provider_id,provider_name,outpatient_services,average_total_payments
220024,HOLYOKE MEDICAL CENTER,12,59.0
220024,HOLYOKE MEDICAL CENTER,26,103.0
220024,HOLYOKE MEDICAL CENTER,52,351.0
220024,HOLYOKE MEDICAL CENTER,27,597.0
220024,HOLYOKE MEDICAL CENTER,127,100.0
220024,HOLYOKE MEDICAL CENTER,55,109.0
220024,HOLYOKE MEDICAL CENTER,757,184.0
220024,HOLYOKE MEDICAL CENTER,29,533.0
220024,HOLYOKE MEDICAL CENTER,133,792.0
220024,HOLYOKE MEDICAL CENTER,210,64.0
220024,HOLYOKE MEDICAL CENTER,336,155.0
220024,HOLYOKE MEDICAL CENTER,559,409.0
220024,HOLYOKE MEDICAL CENTER,469,349.0
220024,HOLYOKE MEDICAL CENTER,235,61.0
220024,HOLYOKE MEDICAL CENTER,267,771.0
220024,HOLYOKE MEDICAL CENTER,8520,53.0
220024,HOLYOKE MEDICAL CENTER,6287,76.0
220024,HOLYOKE MEDICAL CENTER,217,101.0
220024,HOLYOKE MEDICAL CENTER,41,131.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",29,101.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",107,109.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",176,63.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",274,156.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",426,408.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",802,349.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",184,61.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",91,769.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",1047,53.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,504,22.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,1153,62.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,58,103.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,34,352.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,89,100.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,203,183.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,27,494.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,58,779.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,258,64.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,239,156.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,343,407.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,232,60.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,111,770.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,3029,53.0
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER,287,36.0
220050,BAYSTATE MARY LANE HOSPITAL,67,101.0
220050,BAYSTATE MARY LANE HOSPITAL,30,533.0
220050,BAYSTATE MARY LANE HOSPITAL,28,797.0
220050,BAYSTATE MARY LANE HOSPITAL,36,62.0
220050,BAYSTATE MARY LANE HOSPITAL,109,156.0
220050,BAYSTATE MARY LANE HOSPITAL,138,408.0
220050,BAYSTATE MARY LANE HOSPITAL,125,61.0
220050,BAYSTATE MARY LANE HOSPITAL,56,761.0
220050,BAYSTATE MARY LANE HOSPITAL,577,58.0
220050,BAYSTATE MARY LANE HOSPITAL,61,77.0
220050,BAYSTATE MARY LANE HOSPITAL,56,129.0
220065,NOBLE HOSPITAL,11,49.0
220065,NOBLE HOSPITAL,19,109.0
220065,NOBLE HOSPITAL,29,497.0
220065,NOBLE HOSPITAL,104,64.0
220065,NOBLE HOSPITAL,226,156.0
220065,NOBLE HOSPITAL,157,409.0
220065,NOBLE HOSPITAL,282,348.0
220065,NOBLE HOSPITAL,47,53.0
220065,NOBLE HOSPITAL,3724,76.0
220065,NOBLE HOSPITAL,977,102.0
220066,MERCY MEDICAL CENTER,88,44.0
220066,MERCY MEDICAL CENTER,547,97.0
220066,MERCY MEDICAL CENTER,128,508.0
220066,MERCY MEDICAL CENTER,20,101.0
220066,MERCY MEDICAL CENTER,38,109.0
220066,MERCY MEDICAL CENTER,32,797.0
220066,MERCY MEDICAL CENTER,327,63.0
220066,MERCY MEDICAL CENTER,393,156.0
220066,MERCY MEDICAL CENTER,34,411.0
220066,MERCY MEDICAL CENTER,13,61.0
220066,MERCY MEDICAL CENTER,27,775.0
220066,MERCY MEDICAL CENTER,465,53.0
220066,MERCY MEDICAL CENTER,894,77.0
220066,MERCY MEDICAL CENTER,460,102.0
220066,MERCY MEDICAL CENTER,47,131.0
220066,MERCY MEDICAL CENTER,141,172.0
220077,BAYSTATE MEDICAL CENTER,115,63.0
220077,BAYSTATE MEDICAL CENTER,803,108.0
220077,BAYSTATE MEDICAL CENTER,37,366.0
220077,BAYSTATE MEDICAL CENTER,39,619.0
220077,BAYSTATE MEDICAL CENTER,19,1531.0
220077,BAYSTATE MEDICAL CENTER,662,103.0
220077,BAYSTATE MEDICAL CENTER,337,191.0
220077,BAYSTATE MEDICAL CENTER,149,285.0
220077,BAYSTATE MEDICAL CENTER,1281,548.0
220077,BAYSTATE MEDICAL CENTER,819,816.0
220077,BAYSTATE MEDICAL CENTER,628,65.0
220077,BAYSTATE MEDICAL CENTER,624,161.0
220077,BAYSTATE MEDICAL CENTER,1755,423.0
220077,BAYSTATE MEDICAL CENTER,41,584.0
220077,BAYSTATE MEDICAL CENTER,615,369.0
220077,BAYSTATE MEDICAL CENTER,1609,63.0
220077,BAYSTATE MEDICAL CENTER,77,220.0
220077,BAYSTATE MEDICAL CENTER,681,798.0
220077,BAYSTATE MEDICAL CENTER,15302,56.0
220077,BAYSTATE MEDICAL CENTER,17785,79.0
Query:
SELECT DISTINCT "provider_id", "provider_name"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
   LIMIT 100;
Answer:
provider_id,provider_name
220024,HOLYOKE MEDICAL CENTER
220015,"COOLEY DICKINSON HOSPITAL INC,THE"
220030,WING MEMORIAL HOSPITAL AND MEDICAL CENTER
220050,BAYSTATE MARY LANE HOSPITAL
220065,NOBLE HOSPITAL
220066,MERCY MEDICAL CENTER
220077,BAYSTATE MEDICAL CENTER
220046,BERKSHIRE MEDICAL CENTER INC
220051,NORTH ADAMS REGIONAL HOSPITAL
220016,BAYSTATE FRANKLIN MEDICAL CENTER
220098,NASHOBA VALLEY MEDICAL CENTER
220095,HEYWOOD HOSPITAL
220058,CLINTON HOSPITAL ASSOCIATION
220019,HARRINGTON MEMORIAL HOSPITAL
220062,ADCARE HOSPITAL OF WORCESTER INC
220163,UMASS MEMORIAL MEDICAL CENTER INC
220176,ST VINCENT HOSPITAL
220084,EMERSON HOSPITAL
220049,MARLBOROUGH HOSPITAL
220090,MILFORD REGIONAL MEDICAL CENTER
220174,MERRIMACK VALLEY HOSPITAL
220010,LAWRENCE GENERAL HOSPITAL
220080,HOLY FAMILY HOSPITAL
220063,LOWELL GENERAL HOSPITAL
220105,WINCHESTER HOSPITAL
220029,ANNA JAQUES HOSPITAL
220126,NORWOOD HOSPITAL
220071,MASSACHUSETTS GENERAL HOSPITAL
220110,BRIGHAM AND WOMEN'S HOSPITAL
220017,CARNEY HOSPITAL
220119,FAULKNER HOSPITAL
220002,MOUNT AUBURN HOSPITAL
220011,CAMBRIDGE HEALTH ALLIANCE
220070,HALLMARK HEALTH SYSTEM
220111,GOOD SAMARITAN MEDICAL CENTER
220060,JORDAN HOSPITAL INC
220083,BETH ISRAEL DEACONESS HOSPITAL - NEEDHAM
220135,FALMOUTH HOSPITAL
220177,NANTUCKET COTTAGE HOSPITAL
220008,STURDY MEMORIAL HOSPITAL
220108,MILTON HOSPITAL INC
410007,RHODE ISLAND HOSPITAL
410005,ST JOSEPH HEALTH SERVICES OF RI
410004,ROGER WILLIAMS MEDICAL CENTER
300011,ST JOSEPH HOSPITAL
300020,SOUTHERN NH MEDICAL CENTER
300034,CATHOLIC MEDICAL CENTER
300003,MARY HITCHCOCK MEMORIAL HOSPITAL
200020,YORK HOSPITAL
200025,PARKVIEW ADVENTIST MEDICAL CENTER
200033,EASTERN MAINE MEDICAL CENTER
200063,PENOBSCOT BAY MEDICAL CENTER
70029,BRISTOL HOSPITAL
70007,LAWRENCE & MEMORIAL HOSPITAL
70028,ST VINCENT'S MEDICAL CENTER
70016,SAINT MARYS HOSPITAL
300018,WENTWORTH-DOUGLASS HOSPITAL
200018,"AROOSTOOK MEDICAL CENTER,THE"
470012,SOUTHWESTERN VERMONT MEDICAL CENTER
470005,RUTLAND REGIONAL MEDICAL CENTER
220001,"HEALTHALLIANCE HOSPITALS, INC"
220175,METROWEST MEDICAL CENTER
220171,LAHEY CLINIC HOSPITAL
220082,SAINTS  MEDICAL CENTER INC
220035,NORTH SHORE MEDICAL CENTER
220033,BEVERLY HOSPITAL CORPORATION
220116,TUFTS MEDICAL CENTER
220031,BOSTON MEDICAL CENTER CORPORATION
220088,NEW ENGLAND BAPTIST HOSPITAL
220036,ST ELIZABETH'S MEDICAL CENTER
220067,QUINCY MEDICAL CENTER
220086,BETH ISRAEL DEACONESS MEDICAL CENTER
220052,SIGNATURE HEALTHCARE BROCKTON HOSPITAL
220012,CAPE COD HOSPITAL
220074,"SOUTHCOAST HOSPITAL GROUP, INC"
220073,MORTON HOSPITAL
220100,SOUTH SHORE HOSPITAL
220101,NEWTON-WELLESLEY HOSPITAL
220020,SAINT ANNE'S HOSPITAL
410006,NEWPORT HOSPITAL
410001,MEMORIAL HOSPITAL OF RHODE ISLAND
410009,KENT COUNTY MEMORIAL HOSPITAL
410013,WESTERLY HOSPITAL
410010,WOMEN AND INFANTS HOSPITAL OF RHODE ISLAND
410012,MIRIAM HOSPITAL
300017,PARKLAND MEDICAL CENTER
300012,ELLIOT HOSPITAL
300001,CONCORD HOSPITAL
300014,FRISBIE MEMORIAL HOSPITAL
200021,MID COAST HOSPITAL
200040,HENRIETTA D GOODALL HOSPITAL
200009,MAINE MEDICAL CENTER
200039,MAINE GENERAL MEDICAL CENTER
200001,ST JOSEPH HOSPITAL
200002,MILES MEMORIAL HOSPITAL (LINCOLN COUNTY HEALTHCARE
470003,FLETCHER ALLEN HOSPITAL OF VERMONT
470001,CENTRAL VERMONT MEDICAL CENTER
70035,"HOSPITAL OF CENTRAL CONNECTICUT, THE"
70004,SHARON HOSPITAL
70008,JOHNSON MEMORIAL HOSPITAL
Query:
SELECT COUNT(DISTINCT "provider_id") AS "num_providers"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011;
Answer:
num_providers
3337
Query:
SELECT "provider_id", "provider_name", 
          "total_discharges", "average_medicare_payments",
          ("total_discharges" * "average_medicare_payments") AS "inpatient_cost"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
   LIMIT 100;
Answer:
Too long, hard cut:
provider_id,provider_name,total_discharges,average_medicare_payments,inpatient_cost
220024,HOLYOKE MEDICAL CENTER,13,6359.0,82667.0
220024,HOLYOKE MEDICAL CENTER,17,10863.0,184671.0
220024,HOLYOKE MEDICAL CENTER,26,6702.0,174252.0
220024,HOLYOKE MEDICAL CENTER,26,3866.0,100516.0
220024,HOLYOKE MEDICAL CENTER,21,4203.0,88263.0
220024,HOLYOKE MEDICAL CENTER,11,5802.0,63822.0
220024,HOLYOKE MEDICAL CENTER,18,12339.0,222102.0
220024,HOLYOKE MEDICAL CENTER,22,8730.0,192060.0
220024,HOLYOKE MEDICAL CENTER,23,7867.0,180941.0
220024,HOLYOKE MEDICAL CENTER,54,6900.0,372600.0
220024,HOLYOKE MEDICAL CENTER,91,5491.0,499681.0
220024,HOLYOKE MEDICAL CENTER,59,3819.0,225321.0
220024,HOLYOKE MEDICAL CENTER,36,8891.0,320076.0
220024,HOLYOKE MEDICAL CENTER,91,5708.0,519428.0
220024,HOLYOKE MEDICAL CENTER,26,3516.0,91416.0
220024,HOLYOKE MEDICAL CENTER,23,4775.0,109825.0
220024,HOLYOKE MEDICAL CENTER,17,3120.0,53040.0
220024,HOLYOKE MEDICAL CENTER,12,13307.0,159684.0
220024,HOLYOKE MEDICAL CENTER,13,16699.0,217087.0
220024,HOLYOKE MEDICAL CENTER,27,9636.0,260172.0
220024,HOLYOKE MEDICAL CENTER,18,5933.0,106794.0
220024,HOLYOKE MEDICAL CENTER,12,4546.0,54552.0
220024,HOLYOKE MEDICAL CENTER,45,8637.0,388665.0
220024,HOLYOKE MEDICAL CENTER,51,5861.0,298911.0
220024,HOLYOKE MEDICAL CENTER,28,3752.0,105056.0
220024,HOLYOKE MEDICAL CENTER,16,7502.0,120032.0
220024,HOLYOKE MEDICAL CENTER,35,4639.0,162365.0
220024,HOLYOKE MEDICAL CENTER,42,2860.0,120120.0
220024,HOLYOKE MEDICAL CENTER,32,4070.0,130240.0
220024,HOLYOKE MEDICAL CENTER,48,2790.0,133920.0
220024,HOLYOKE MEDICAL CENTER,11,29904.0,328944.0
220024,HOLYOKE MEDICAL CENTER,15,15996.0,239940.0
220024,HOLYOKE MEDICAL CENTER,13,7572.0,98436.0
220024,HOLYOKE MEDICAL CENTER,18,9819.0,176742.0
220024,HOLYOKE MEDICAL CENTER,38,6013.0,228494.0
220024,HOLYOKE MEDICAL CENTER,13,3887.0,50531.0
220024,HOLYOKE MEDICAL CENTER,12,4905.0,58860.0
220024,HOLYOKE MEDICAL CENTER,14,3193.0,44702.0
220024,HOLYOKE MEDICAL CENTER,18,7885.0,141930.0
220024,HOLYOKE MEDICAL CENTER,76,3912.0,297312.0
220024,HOLYOKE MEDICAL CENTER,14,5590.0,78260.0
220024,HOLYOKE MEDICAL CENTER,11,6776.0,74536.0
220024,HOLYOKE MEDICAL CENTER,41,12542.0,514222.0
220024,HOLYOKE MEDICAL CENTER,19,11315.0,214985.0
220024,HOLYOKE MEDICAL CENTER,15,4250.0,63750.0
220024,HOLYOKE MEDICAL CENTER,11,3653.0,40183.0
220024,HOLYOKE MEDICAL CENTER,59,4715.0,278185.0
220024,HOLYOKE MEDICAL CENTER,21,4084.0,85764.0
220024,HOLYOKE MEDICAL CENTER,12,7350.0,88200.0
220024,HOLYOKE MEDICAL CENTER,34,3816.0,129744.0
220024,HOLYOKE MEDICAL CENTER,43,9430.0,405490.0
220024,HOLYOKE MEDICAL CENTER,81,5789.0,468909.0
220024,HOLYOKE MEDICAL CENTER,19,6397.0,121543.0
220024,HOLYOKE MEDICAL CENTER,78,4267.0,332826.0
220024,HOLYOKE MEDICAL CENTER,14,4318.0,60452.0
220024,HOLYOKE MEDICAL CENTER,101,11836.0,1195436.0
220024,HOLYOKE MEDICAL CENTER,29,6259.0,181511.0
220024,HOLYOKE MEDICAL CENTER,23,3649.0,83927.0
220024,HOLYOKE MEDICAL CENTER,11,3447.0,37917.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",31,5627.0,174437.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",29,3712.0,107648.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",42,3513.0,147546.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",23,3786.0,87078.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",15,2982.0,44730.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",21,4163.0,87423.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",23,9526.0,219098.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",34,7380.0,250920.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",21,6644.0,139524.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",52,6003.0,312156.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",37,5007.0,185259.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",29,3147.0,91263.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",39,7676.0,299364.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",109,5061.0,551649.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",38,3145.0,119510.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",20,4392.0,87840.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",11,3075.0,33825.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",22,12849.0,282678.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",23,9875.0,227125.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",21,5638.0,118398.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",42,7884.0,331128.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",83,5264.0,436912.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",29,3154.0,91466.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",14,4547.0,63658.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",18,2977.0,53586.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",37,6543.0,242091.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",45,4200.0,189000.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",48,2472.0,118656.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",80,3441.0,275280.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",58,2279.0,132182.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",11,39400.0,433400.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",25,14565.0,364125.0
220015,"COOLEY DICKINSON HOSPITAL INC,THE",15,7041.0,1
Query:
SELECT "provider_id", "provider_name",
          SUM("total_discharges" * "average_medicare_payments") AS "total_inpatient_cost"
   FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
   GROUP BY "provider_id", "provider_name"
   ORDER BY "total_inpatient_cost" DESC
   LIMIT 100;
Answer:
provider_id,provider_name,total_inpatient_cost
330101,NEW YORK-PRESBYTERIAN HOSPITAL,259982825.0
330059,MONTEFIORE MEDICAL CENTER,195468269.0
100007,FLORIDA HOSPITAL,191577360.0
330024,MOUNT SINAI HOSPITAL,168906912.0
50625,CEDARS-SINAI MEDICAL CENTER,144399584.0
330194,MAIMONIDES MEDICAL CENTER,140492753.0
230130,WILLIAM BEAUMONT HOSPITAL,140231502.0
80001,"CHRISTIANA CARE HEALTH SERVICES, INC.",135782767.0
330169,BETH ISRAEL MEDICAL CENTER,135413177.0
330106,NORTH SHORE UNIVERSITY HOSPITAL,132352253.0
450388,METHODIST HOSPITAL,130432929.0
220071,MASSACHUSETTS GENERAL HOSPITAL,122073585.0
440049,METHODIST HEALTHCARE MEMPHIS HOSPITALS,116640323.0
340040,PITT COUNTY MEMORIAL HOSPITAL,116503878.0
70022,YALE-NEW HAVEN HOSPITAL,112535496.0
210009,"JOHNS HOPKINS HOSPITAL, THE",109110007.0
220163,UMASS MEMORIAL MEDICAL CENTER INC,107824605.0
220074,"SOUTHCOAST HOSPITAL GROUP, INC",104650325.0
150056,INDIANA UNIVERSITY HEALTH,103664087.0
180088,"NORTON HOSPITALS, INC",102956561.0
450184,MEMORIAL HERMANN HOSPITAL SYSTEM,101763479.0
390164,UPMC PRESBYTERIAN SHADYSIDE,99226492.0
70025,HARTFORD HOSPITAL,98872186.0
260032,BARNES JEWISH HOSPITAL,98077689.0
340141,NEW HANOVER REGIONAL MEDICAL CENTER,96576892.0
220086,BETH ISRAEL DEACONESS MEDICAL CENTER,96200183.0
340002,MEMORIAL MISSION HOSPITAL AND ASHEVILLE SURGERY CE,95487026.0
230038,SPECTRUM HEALTH - BUTTERWORTH CAMPUS,95174984.0
340047,NORTH CAROLINA BAPTIST HOSPITAL,94154603.0
90011,WASHINGTON HOSPITAL CENTER,93607169.0
520138,AURORA ST LUKES MEDICAL CENTER,92125754.0
310001,HACKENSACK UNIVERSITY MEDICAL CENTER,91992875.0
330214,NYU HOSPITALS CENTER,91958983.0
450058,BAPTIST MEDICAL CENTER,91542398.0
220110,BRIGHAM AND WOMEN'S HOSPITAL,91471310.0
140208,ADVOCATE CHRIST HOSPITAL & MEDICAL CENTER,91126208.0
340069,"WAKEMED, RALEIGH CAMPUS",90456558.0
330055,NEW YORK HOSPITAL MEDICAL CENTER OF QUEENS,90025921.0
340030,DUKE UNIVERSITY HOSPITAL,88272764.0
230046,UNIVERSITY OF MICHIGAN HEALTH SYSTEM,88134168.0
10039,HUNTSVILLE HOSPITAL,86899365.0
140281,NORTHWESTERN MEMORIAL HOSPITAL,86249092.0
230020,OAKWOOD HOSPITAL AND MEDICAL CENTER,85552858.0
100006,ORLANDO HEALTH,85500486.0
450358,"METHODIST HOSPITAL,THE",85359076.0
360180,CLEVELAND CLINIC,85266922.0
310019,ST JOSEPH'S REGIONAL MEDICAL CENTER,85138563.0
230019,PROVIDENCE HOSPITAL AND MEDICAL CENTERS,84516458.0
240010,MAYO CLINIC - SAINT MARYS HOSPITAL,84160623.0
140010,EVANSTON HOSPITAL,83907335.0
230165,ST JOHN HOSPITAL AND MEDICAL CENTER,83688887.0
50441,STANFORD HOSPITAL,83688471.0
340113,CAROLINAS MEDICAL CENTER/BEHAV HEALTH,83143896.0
390133,LEHIGH VALLEY HOSPITAL,83098918.0
230053,HENRY FORD HOSPITAL,82888752.0
70002,ST FRANCIS HOSPITAL & MEDICAL CENTER,82046635.0
450021,BAYLOR UNIVERSITY MEDICAL CENTER,81804632.0
330195,LONG ISLAND JEWISH MEDICAL CENTER,81441504.0
310015,MORRISTOWN MEMORIAL HOSPITAL,80628692.0
390174,THOMAS JEFFERSON UNIVERSITY HOSPITAL,80359683.0
180040,JEWISH HOSPITAL & ST MARY'S HEALTHCARE,80332763.0
340028,CAPE FEAR VALLEY MEDICAL CENTER,80171344.0
210002,UNIVERSITY OF MARYLAND MEDICAL CENTER,79780810.0
340091,"MOSES H CONE MEMORIAL HOSPITAL, THE",79740916.0
330046,ST LUKE'S ROOSEVELT HOSPITAL,79633498.0
310041,COMMUNITY MEDICAL CENTER,78298044.0
220077,BAYSTATE MEDICAL CENTER,78242916.0
210019,PENINSULA REGIONAL MEDICAL CENTER,77407646.0
310038,ROBERT WOOD JOHNSON UNIVERSITY HOSPITAL,76864921.0
510022,CHARLESTON AREA MEDICAL CENTER,75647510.0
330393,UNIVERSITY HOSPITAL ( STONY BROOK ),75302882.0
360085,OHIO STATE UNIVERSITY HOSPITALS,74086123.0
310012,VALLEY HOSPITAL,74021525.0
100113,SHANDS HOSPITAL AT THE UNIVERSITY OF FLORIDA,73892519.0
330236,NEW YORK METHODIST HOSPITAL,73786339.0
360006,RIVERSIDE METHODIST HOSPITAL,73771415.0
100022,JACKSON MEMORIAL HOSPITAL,73763711.0
330005,KALEIDA HEALTH,73655973.0
490063,INOVA FAIRFAX HOSPITAL,73220718.0
450054,SCOTT & WHITE MEMORIAL HOSPITAL,72958960.0
440002,JACKSON-MADISON COUNTY GENERAL HOSPITAL,72841064.0
50093,SAINT AGNES MEDICAL CENTER,72703418.0
100018,NAPLES COMMUNITY HOSPITAL,72234288.0
490024,CARILION ROANOKE MEMORIAL CENTER,71919204.0
330167,WINTHROP-UNIVERSITY HOSPITAL,71892870.0
210015,FRANKLIN SQUARE HOSPITAL CENTER,71725448.0
240057,ABBOTT NORTHWESTERN HOSPITAL,71609336.0
440048,BAPTIST MEMORIAL HOSPITAL,71347358.0
310086,KENNEDY UNIVERSITY HOSPITAL - STRATFORD DIV,70940053.0
230195,ST JOHN MACOMB-OAKLAND HOSPITAL-MACOMB CENTER,70694114.0
340061,UNIVERSITY OF NORTH CAROLINA HOSPITAL,70485004.0
70001,HOSPITAL OF ST RAPHAEL,70376738.0
140223,ADVOCATE LUTHERAN GENERAL HOSPITAL,69681268.0
410007,RHODE ISLAND HOSPITAL,69493056.0
330119,LENOX HILL HOSPITAL,69296319.0
330160,STATEN ISLAND UNIVERSITY HOSPITAL,69113229.0
170122,VIA CHRISTI HOSPITALS WICHITA INC,69088908.0
210023,ANNE ARUNDEL MEDICAL CENTER,69064241.0
100040,ST VINCENT'S MEDICAL CENTER,68455066.0
210043,BALTIMORE WASHINGTON  MEDICAL CENTER,68171980.0
Query:
SELECT "provider_id", "provider_name",
          SUM("total_discharges" * "average_medicare_payments") AS "total_inpatient_cost"
   FROM (
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
       UNION ALL
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
       UNION ALL
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
       UNION ALL
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
       UNION ALL
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
   ) AS combined_inpatient
   GROUP BY "provider_id", "provider_name"
   ORDER BY "total_inpatient_cost" DESC
   LIMIT 100;
Answer:
provider_id,provider_name,total_inpatient_cost
330101,NEW YORK-PRESBYTERIAN HOSPITAL,1921462142.0
100007,FLORIDA HOSPITAL,1293059027.0
50625,CEDARS-SINAI MEDICAL CENTER,1111247205.0
70022,YALE-NEW HAVEN HOSPITAL,1065172588.0
330059,MONTEFIORE MEDICAL CENTER,1064056005.0
330024,MOUNT SINAI HOSPITAL,1029121838.0
220071,MASSACHUSETTS GENERAL HOSPITAL,999580128.0
210009,"JOHNS HOPKINS HOSPITAL, THE",985951009.0
80001,"CHRISTIANA CARE HEALTH SERVICES, INC.",915920368.0
260032,BARNES JEWISH HOSPITAL,823355959.0
450388,METHODIST HOSPITAL,796111529.0
220110,BRIGHAM AND WOMEN'S HOSPITAL,785511555.0
210002,UNIVERSITY OF MARYLAND MEDICAL CENTER,780576440.0
440049,METHODIST HEALTHCARE MEMPHIS HOSPITALS,765625561.0
330106,NORTH SHORE UNIVERSITY HOSPITAL,763949450.0
360180,CLEVELAND CLINIC,762405614.0
240010,MAYO CLINIC HOSPITAL ROCHESTER,761687402.0
150056,INDIANA UNIVERSITY HEALTH,749972082.0
330194,MAIMONIDES MEDICAL CENTER,717409561.0
230046,UNIVERSITY OF MICHIGAN HEALTH SYSTEM,680185220.0
340030,DUKE UNIVERSITY HOSPITAL,674120048.0
330169,BETH ISRAEL MEDICAL CENTER,668306090.0
340040,VIDANT MEDICAL CENTER,647383497.0
70025,HARTFORD HOSPITAL,641833194.0
450358,"METHODIST HOSPITAL,THE",640404017.0
220163,UMASS MEMORIAL MEDICAL CENTER INC,639284118.0
390164,UPMC PRESBYTERIAN SHADYSIDE,635584986.0
50454,UCSF MEDICAL CENTER,629965827.0
220086,BETH ISRAEL DEACONESS MEDICAL CENTER,628999939.0
340141,NEW HANOVER REGIONAL MEDICAL CENTER,627341625.0
220077,BAYSTATE MEDICAL CENTER,619696360.0
450184,MEMORIAL HERMANN HOSPITAL SYSTEM,605791482.0
340113,CAROLINAS MEDICAL CENTER/BEHAV HEALTH,601536705.0
520138,AURORA ST LUKES MEDICAL CENTER,597720284.0
220074,"SOUTHCOAST HOSPITAL GROUP, INC",596408540.0
390174,THOMAS JEFFERSON UNIVERSITY HOSPITAL,591302486.0
310001,HACKENSACK UNIVERSITY MEDICAL CENTER,589208916.0
330214,NYU HOSPITALS CENTER,586976434.0
340002,MEMORIAL MISSION HOSPITAL AND ASHEVILLE SURGERY CE,578546731.0
230038,SPECTRUM HEALTH - BUTTERWORTH CAMPUS,563866815.0
340047,NORTH CAROLINA BAPTIST HOSPITAL,549377243.0
140208,ADVOCATE CHRIST HOSPITAL & MEDICAL CENTER,545101224.0
10039,HUNTSVILLE HOSPITAL,544633462.0
330393,UNIVERSITY HOSPITAL ( STONY BROOK ),543113100.0
390111,HOSPITAL OF UNIV OF PENNSYLVANIA,538983088.0
140281,NORTHWESTERN MEMORIAL HOSPITAL,538087456.0
450021,BAYLOR UNIVERSITY MEDICAL CENTER,537318164.0
140010,EVANSTON HOSPITAL,533259623.0
450058,BAPTIST MEDICAL CENTER,532086753.0
50599,UNIVERSITY OF CALIFORNIA DAVIS MEDICAL CENTER,528556816.0
10033,UNIVERSITY OF ALABAMA HOSPITAL,524499396.0
240057,ABBOTT NORTHWESTERN HOSPITAL,515792716.0
490009,UNIVERSITY OF VIRGINIA MEDICAL CENTER,514587395.0
310038,ROBERT WOOD JOHNSON UNIVERSITY HOSPITAL,514020951.0
230053,HENRY FORD HOSPITAL,510781418.0
440039,VANDERBILT UNIVERSITY HOSPITAL,504866186.0
490063,INOVA FAIRFAX HOSPITAL,500332494.0
390133,LEHIGH VALLEY HOSPITAL,497494077.0
50441,STANFORD HOSPITAL,493924448.0
440048,BAPTIST MEMORIAL HOSPITAL,489992582.0
360085,OHIO STATE UNIVERSITY HOSPITALS,487904640.0
90011,MEDSTAR WASHINGTON HOSPITAL CENTER,484962664.0
100006,ORLANDO HEALTH,484862174.0
140119,RUSH UNIVERSITY MEDICAL CENTER,483003764.0
510022,CHARLESTON AREA MEDICAL CENTER,481852784.0
210012,SINAI HOSPITAL OF BALTIMORE,474328777.0
230019,PROVIDENCE HOSPITAL AND MEDICAL CENTERS,473555057.0
360006,RIVERSIDE METHODIST HOSPITAL,469873025.0
310015,MORRISTOWN MEDICAL CENTER,468776617.0
310019,ST JOSEPH'S REGIONAL MEDICAL CENTER,465103950.0
70002,ST FRANCIS HOSPITAL & MEDICAL CENTER,459151564.0
180040,JEWISH HOSPITAL & ST MARY'S HEALTHCARE,456244616.0
330195,LONG ISLAND JEWISH MEDICAL CENTER,452383012.0
100128,TAMPA GENERAL HOSPITAL,450221944.0
330167,WINTHROP-UNIVERSITY HOSPITAL,447812197.0
300003,MARY HITCHCOCK MEMORIAL HOSPITAL,446928737.0
180067,UNIVERSITY OF KENTUCKY HOSPITAL,445617826.0
240036,ST CLOUD HOSPITAL,443229378.0
490032,MEDICAL COLLEGE OF VIRGINIA HOSPITALS,439445420.0
340061,UNIVERSITY OF NORTH CAROLINA HOSPITAL,438379406.0
100022,JACKSON MEMORIAL HOSPITAL,437767504.0
520098,UNIVERSITY OF WI  HOSPITALS & CLINICS AUTHORITY,436625317.0
410007,RHODE ISLAND HOSPITAL,433277541.0
230130,"BEAUMONT HOSPITAL, ROYAL OAK",432176037.0
330236,NEW YORK METHODIST HOSPITAL,431974064.0
330005,KALEIDA HEALTH,431313771.0
440002,JACKSON-MADISON COUNTY GENERAL HOSPITAL,426679347.0
340091,"MOSES H CONE MEMORIAL HOSPITAL, THE",426045334.0
200009,MAINE MEDICAL CENTER,423146721.0
310073,JERSEY SHORE UNIVERSITY MEDICAL CENTER,418163270.0
100113,UF HEALTH SHANDS HOSPITAL,416675818.0
210019,PENINSULA REGIONAL MEDICAL CENTER,416412362.0
150084,ST VINCENT HOSPITAL & HEALTH SERVICES,410484481.0
340069,"WAKEMED, RALEIGH CAMPUS",410252731.0
420004,MUSC MEDICAL CENTER,409044716.0
160058,UNIVERSITY OF IOWA HOSPITAL & CLINICS,408141448.0
100018,NAPLES COMMUNITY HOSPITAL,408047982.0
330160,STATEN ISLAND UNIVERSITY HOSPITAL,407788453.0
310012,VALLEY HOSPITAL,407403963.0
340028,CAPE FEAR VALLEY MEDICAL CENTER,407343779.0
Query:
SELECT "provider_id", "provider_name",
          SUM("total_discharges" * "average_medicare_payments") AS "total_inpatient_cost"
   FROM (
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
       UNION ALL
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
       UNION ALL
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
       UNION ALL
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
       UNION ALL
       SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
       FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
   ) AS combined_inpatient
   GROUP BY "provider_id", "provider_name"
   ORDER BY "total_inpatient_cost" DESC
   LIMIT 1;
Answer:
provider_id,provider_name,total_inpatient_cost
330101,NEW YORK-PRESBYTERIAN HOSPITAL,1921462142.0
Query:
WITH combined_inpatient AS (
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2011 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2012 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2013 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2014 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2015 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
),
total_inpatient_cost_per_provider AS (
    SELECT "provider_id", "provider_name", SUM("total_discharges" * "average_medicare_payments") AS "total_inpatient_cost"
    FROM combined_inpatient
    GROUP BY "provider_id", "provider_name"
),
top_provider AS (
    SELECT "provider_id", "provider_name"
    FROM total_inpatient_cost_per_provider
    ORDER BY "total_inpatient_cost" DESC
    LIMIT 1
),
yearly_inpatient_cost AS (
    SELECT c."Year", AVG(c."average_medicare_payments" * c."total_discharges") AS "Average_Inpatient_Cost"
    FROM combined_inpatient c
    JOIN top_provider tp ON c."provider_id" = tp."provider_id"
    GROUP BY c."Year"
),
combined_outpatient AS (
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2011 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2012 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2012
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2013 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2014 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2014
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2015 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2015
),
yearly_outpatient_cost AS (
    SELECT c."Year", AVG(c."average_total_payments" * c."outpatient_services") AS "Average_Outpatient_Cost"
    FROM combined_outpatient c
    JOIN top_provider tp ON c."provider_id" = tp."provider_id"
    GROUP BY c."Year"
)
SELECT y."Year", y."Average_Inpatient_Cost", yo."Average_Outpatient_Cost"
FROM yearly_inpatient_cost y
LEFT JOIN yearly_outpatient_cost yo ON y."Year" = yo."Year"
ORDER BY y."Year";
Answer:
Year,Average_Inpatient_Cost,Average_Outpatient_Cost
2011,2626089.1414141413,443473.7083333333
2012,2547851.28,406864.6
2013,2335016.89,382465.44
2014,1541546.1721518987,343631.46428571426
2015,1520975.099730458,409001.4434685575
Query:
WITH combined_inpatient AS (
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2011 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2012 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2013 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2014 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2015 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
),
combined_outpatient AS (
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2011 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2012 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2012
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2013 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2014 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2014
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2015 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2015
),
providers_with_both AS (
    SELECT DISTINCT ci."provider_id", ci."provider_name"
    FROM combined_inpatient ci
    INNER JOIN combined_outpatient co ON ci."provider_id" = co."provider_id"
),
total_inpatient_cost_per_provider AS (
    SELECT ci."provider_id", ci."provider_name", SUM(ci."total_discharges" * ci."average_medicare_payments") AS "total_inpatient_cost"
    FROM combined_inpatient ci
    JOIN providers_with_both pb ON ci."provider_id" = pb."provider_id"
    GROUP BY ci."provider_id", ci."provider_name"
),
top_provider AS (
    SELECT "provider_id", "provider_name"
    FROM total_inpatient_cost_per_provider
    ORDER BY "total_inpatient_cost" DESC
    LIMIT 1
),
yearly_inpatient_cost AS (
    SELECT c."Year", AVG(c."average_medicare_payments" * c."total_discharges") AS "Average_Inpatient_Cost"
    FROM combined_inpatient c
    JOIN top_provider tp ON c."provider_id" = tp."provider_id"
    GROUP BY c."Year"
),
yearly_outpatient_cost AS (
    SELECT c."Year", AVG(c."average_total_payments" * c."outpatient_services") AS "Average_Outpatient_Cost"
    FROM combined_outpatient c
    JOIN top_provider tp ON c."provider_id" = tp."provider_id"
    GROUP BY c."Year"
)
SELECT y."Year", y."Average_Inpatient_Cost", yo."Average_Outpatient_Cost"
FROM yearly_inpatient_cost y
LEFT JOIN yearly_outpatient_cost yo ON y."Year" = yo."Year"
ORDER BY y."Year";
Answer:
Year,Average_Inpatient_Cost,Average_Outpatient_Cost
2011,858781.8673469388,29201.055555555555
2012,834227.24,33373.9375
2013,820016.2727272727,27117.764705882353
2014,931714.380952381,285271.8181818182
2015,1134943.5806451612,468363.62158114894
Query:
SELECT "provider_id", "provider_name",
           SUM("average_total_payments" * "outpatient_services") AS "total_outpatient_cost"
    FROM (
        SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
        FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
        UNION ALL
        SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
        FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2012
        UNION ALL
        SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
        FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
        UNION ALL
        SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
        FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2014
        UNION ALL
        SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
        FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2015
    ) AS combined_outpatient
    GROUP BY "provider_id", "provider_name"
    ORDER BY "total_outpatient_cost" DESC
    LIMIT 5;
Answer:
provider_id,provider_name,total_outpatient_cost
360180,CLEVELAND CLINIC,150549148.0
450054,SCOTT & WHITE MEMORIAL HOSPITAL,136956624.0
140010,EVANSTON HOSPITAL,123573299.0
220071,MASSACHUSETTS GENERAL HOSPITAL,85101884.0
50441,STANFORD HOSPITAL,82699500.0
Query:
SELECT inpatient."provider_id", inpatient."provider_name",
           inpatient."total_inpatient_cost", outpatient."total_outpatient_cost"
    FROM (
        SELECT "provider_id", "provider_name",
               SUM("total_discharges" * "average_medicare_payments") AS "total_inpatient_cost"
        FROM (
            SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
            FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
            UNION ALL
            SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
            FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
            UNION ALL
            SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
            FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
            UNION ALL
            SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
            FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
            UNION ALL
            SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments"
            FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
        ) AS combined_inpatient
        GROUP BY "provider_id", "provider_name"
    ) AS inpatient
    JOIN (
        SELECT "provider_id", "provider_name",
               SUM("average_total_payments" * "outpatient_services") AS "total_outpatient_cost"
        FROM (
            SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
            FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
            UNION ALL
            SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
            FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2012
            UNION ALL
            SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
            FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
            UNION ALL
            SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
            FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2014
            UNION ALL
            SELECT "provider_id", "provider_name", "average_total_payments", "outpatient_services"
            FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2015
        ) AS combined_outpatient
        GROUP BY "provider_id", "provider_name"
    ) AS outpatient
    ON inpatient."provider_id" = outpatient."provider_id"
    ORDER BY inpatient."total_inpatient_cost" DESC
    LIMIT 100;
Answer:
Too long, hard cut:
provider_id,provider_name,total_inpatient_cost,total_outpatient_cost
330101,NEW YORK-PRESBYTERIAN HOSPITAL,1921462142.0,39998301.0
330101,NEW YORK-PRESBYTERIAN HOSPITAL,1921462142.0,9407033.199776823
100007,FLORIDA HOSPITAL,1293059027.0,6002536.1900027245
100007,FLORIDA HOSPITAL,1293059027.0,21199643.0
50625,CEDARS-SINAI MEDICAL CENTER,1111247205.0,46337688.0
70022,YALE-NEW HAVEN HOSPITAL,1065172588.0,41166131.0
330059,MONTEFIORE MEDICAL CENTER,1064056005.0,32726033.0
330059,MONTEFIORE MEDICAL CENTER,1064056005.0,10395142.40029329
330024,MOUNT SINAI HOSPITAL,1029121838.0,8119652.15014505
330024,MOUNT SINAI HOSPITAL,1029121838.0,22636625.0
220071,MASSACHUSETTS GENERAL HOSPITAL,999580128.0,85101884.0
220071,MASSACHUSETTS GENERAL HOSPITAL,999580128.0,23400267.119404454
80001,"CHRISTIANA CARE HEALTH SERVICES, INC.",915920368.0,39204001.0
260032,BARNES JEWISH HOSPITAL,823355959.0,5090139.749996881
260032,BARNES JEWISH HOSPITAL,823355959.0,17250163.0
450388,METHODIST HOSPITAL,796111529.0,26203709.0
450388,METHODIST HOSPITAL,796111529.0,7105325.029859422
220110,BRIGHAM AND WOMEN'S HOSPITAL,785511555.0,16085388.899918554
220110,BRIGHAM AND WOMEN'S HOSPITAL,785511555.0,54394052.0
440049,METHODIST HEALTHCARE MEMPHIS HOSPITALS,765625561.0,5423035.149979259
440049,METHODIST HEALTHCARE MEMPHIS HOSPITALS,765625561.0,22049274.0
330106,NORTH SHORE UNIVERSITY HOSPITAL,763949450.0,5417512.01998135
330106,NORTH SHORE UNIVERSITY HOSPITAL,763949450.0,17915485.0
360180,CLEVELAND CLINIC,762405614.0,54990709.43008416
360180,CLEVELAND CLINIC,762405614.0,150549148.0
240010,MAYO CLINIC HOSPITAL ROCHESTER,761687402.0,533983.0
240010,MAYO CLINIC HOSPITAL ROCHESTER,761687402.0,525619.0
240010,MAYO CLINIC HOSPITAL ROCHESTER,761687402.0,8898908.81004183
240010,MAYO CLINIC HOSPITAL ROCHESTER,761687402.0,6736982.0
150056,INDIANA UNIVERSITY HEALTH,749972082.0,6685666.569976699
150056,INDIANA UNIVERSITY HEALTH,749972082.0,21824602.0
330194,MAIMONIDES MEDICAL CENTER,717409561.0,8152564.0
330194,MAIMONIDES MEDICAL CENTER,717409561.0,5695991.699980838
230046,UNIVERSITY OF MICHIGAN HEALTH SYSTEM,680185220.0,67257221.0
230046,UNIVERSITY OF MICHIGAN HEALTH SYSTEM,680185220.0,27590245.59999176
340030,DUKE UNIVERSITY HOSPITAL,674120048.0,15344092.51999104
340030,DUKE UNIVERSITY HOSPITAL,674120048.0,55787406.0
330169,BETH ISRAEL MEDICAL CENTER,668306090.0,8391604.549768595
330169,BETH ISRAEL MEDICAL CENTER,668306090.0,37751459.0
340040,VIDANT MEDICAL CENTER,647383497.0,2742965.21999448
340040,VIDANT MEDICAL CENTER,647383497.0,7773628.0
340040,VIDANT MEDICAL CENTER,647383497.0,2250830.0
70025,HARTFORD HOSPITAL,641833194.0,12505429.0
450358,"METHODIST HOSPITAL,THE",640404017.0,11310303.0
450358,"METHODIST HOSPITAL,THE",640404017.0,2942626.98998078
220163,UMASS MEMORIAL MEDICAL CENTER INC,639284118.0,67128558.0
220163,UMASS MEMORIAL MEDICAL CENTER INC,639284118.0,18680004.019428506
390164,UPMC PRESBYTERIAN SHADYSIDE,635584986.0,21593270.0
390164,UPMC PRESBYTERIAN SHADYSIDE,635584986.0,3991250.2000091583
50454,UCSF MEDICAL CENTER,629965827.0,80752369.0
220086,BETH ISRAEL DEACONESS MEDICAL CENTER,628999939.0,64111619.0
220086,BETH ISRAEL DEACONESS MEDICAL CENTER,628999939.0,16372895.700483732
340141,NEW HANOVER REGIONAL MEDICAL CENTER,627341625.0,5695645.0800252315
340141,NEW HANOVER REGIONAL MEDICAL CENTER,627341625.0,19742167.0
220077,BAYSTATE MEDICAL CENTER,619696360.0,32089214.0
220077,BAYSTATE MEDICAL CENTER,619696360.0,8045928.690004963
450184,MEMORIAL HERMANN HOSPITAL SYSTEM,605791482.0,3241684.339978442
450184,MEMORIAL HERMANN HOSPITAL SYSTEM,605791482.0,12305889.0
340113,CAROLINAS MEDICAL CENTER/BEHAV HEALTH,601536705.0,10125402.380011812
340113,CAROLINAS MEDICAL CENTER/BEHAV HEALTH,601536705.0,30494834.0
520138,AURORA ST LUKES MEDICAL CENTER,597720284.0,20785132.0
520138,AURORA ST LUKES MEDICAL CENTER,597720284.0,5932276.009966872
220074,"SOUTHCOAST HOSPITAL GROUP, INC",596408540.0,6693870.949936705
220074,"SOUTHCOAST HOSPITAL GROUP, INC",596408540.0,17330442.0
390174,THOMAS JEFFERSON UNIVERSITY HOSPITAL,591302486.0,12403883.0
390174,THOMAS JEFFERSON UNIVERSITY HOSPITAL,591302486.0,3283511.4399867663
310001,HACKENSACK UNIVERSITY MEDICAL CENTER,589208916.0,6289267.450082436
310001,HACKENSACK UNIVERSITY MEDICAL CENTER,589208916.0,17795108.0
330214,NYU HOSPITALS CENTER,586976434.0,10744924.870009555
330214,NYU HOSPITALS CENTER,586976434.0,23693487.0
340002,MEMORIAL MISSION HOSPITAL AND ASHEVILLE SURGERY CE,578546731.0,25295316.0
340002,MEMORIAL MISSION HOSPITAL AND ASHEVILLE SURGERY CE,578546731.0,7734261.9199386
230038,SPECTRUM HEALTH - BUTTERWORTH CAMPUS,563866815.0,3489645.540008816
230038,SPECTRUM HEALTH - BUTTERWORTH CAMPUS,563866815.0,15391126.0
340047,NORTH CAROLINA BAPTIST HOSPITAL,549377243.0,11783704.710026164
340047,NORTH CAROLINA BAPTIST HOSPITAL,549377243.0,42950059.0
140208,ADVOCATE CHRIST HOSPITAL & MEDICAL CENTER,545101224.0,11662939.0
140208,ADVOCATE CHRIST HOSPITAL & MEDICAL CENTER,545101224.0,3130497.530007915
10039,HUNTSVILLE HOS
Query:
SELECT DISTINCT i."provider_id", i."provider_name"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011 AS i
    INNER JOIN CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011 AS o
    ON i."provider_id" = o."provider_id"
    LIMIT 100;
Answer:
provider_id,provider_name
220024,HOLYOKE MEDICAL CENTER
220015,"COOLEY DICKINSON HOSPITAL INC,THE"
220065,NOBLE HOSPITAL
220066,MERCY MEDICAL CENTER
220046,BERKSHIRE MEDICAL CENTER INC
220098,NASHOBA VALLEY MEDICAL CENTER
220001,"HEALTHALLIANCE HOSPITALS, INC"
220176,ST VINCENT HOSPITAL
220163,UMASS MEMORIAL MEDICAL CENTER INC
220175,METROWEST MEDICAL CENTER
220080,HOLY FAMILY HOSPITAL
220036,ST ELIZABETH'S MEDICAL CENTER
220108,MILTON HOSPITAL INC
220052,SIGNATURE HEALTHCARE BROCKTON HOSPITAL
220101,NEWTON-WELLESLEY HOSPITAL
220008,STURDY MEMORIAL HOSPITAL
220074,"SOUTHCOAST HOSPITAL GROUP, INC"
220060,JORDAN HOSPITAL INC
410001,MEMORIAL HOSPITAL OF RHODE ISLAND
300017,PARKLAND MEDICAL CENTER
200025,PARKVIEW ADVENTIST MEDICAL CENTER
200052,NORTHERN MAINE MEDICAL CENTER
470011,BRATTLEBORO MEMORIAL HOSPITAL
70005,WATERBURY HOSPITAL
310086,KENNEDY UNIVERSITY HOSPITAL - STRATFORD DIV
390150,SOUTHWEST REGIONAL MEDICAL CENTER
220031,BOSTON MEDICAL CENTER CORPORATION
410008,SOUTH COUNTY HOSPITAL INC
410005,ST JOSEPH HEALTH SERVICES OF RI
300011,ST JOSEPH HOSPITAL
300034,CATHOLIC MEDICAL CENTER
200031,CARY MEDICAL CENTER
200041,INLAND HOSPITAL
70029,BRISTOL HOSPITAL
70021,WINDHAM COMM MEM HOSP & HATCH HOSP
70016,SAINT MARYS HOSPITAL
70039,MASONIC HOME AND HOSPITAL
310045,ENGLEWOOD HOSPITAL AND MEDICAL CENTER
310091,MEMORIAL HOSPITAL OF SALEM COUNTY
310029,OUR LADY OF LOURDES MEDICAL CENTER
310073,JERSEY SHORE UNIVERSITY MEDICAL CENTER
330002,PENINSULA HOSPITAL CENTER
330224,BENEDICTINE HOSPITAL
330135,BON SECOURS COMMUNITY HOSPITAL
390173,INDIANA REGIONAL MEDICAL CENTER
390122,TITUSVILLE HOSPITAL
490045,PRINCE WILLIAM HOSPITAL
340114,REX HOSPITAL
420091,CAROLINAS HOSPITAL SYSTEM
310012,VALLEY HOSPITAL
330372,FRANKLIN HOSPITAL
330215,"ROME MEMORIAL HOSPITAL, INC"
330219,ERIE COUNTY MEDICAL CENTER
330102,KENMORE MERCY HOSPITAL
330037,LAKESIDE MEMORIAL HOSPITAL
390219,EXCELA HEALTH LATROBE HOSPITAL
330277,CORNING HOSPITAL
390058,CARLISLE REGIONAL MEDICAL CENTER
390045,WILLIAMSPORT REGIONAL MEDICAL CENTER
80007,BEEBE MEDICAL CENTER
510085,CAMC TEAYS VALLEY HOSPITAL
420101,COASTAL CAROLINA HOSPITAL
110031,SPALDING REGIONAL MEDICAL CENTER
260163,PARKLAND HEALTH CENTER
220095,HEYWOOD HOSPITAL
220082,SAINTS  MEDICAL CENTER INC
220126,NORWOOD HOSPITAL
220017,CARNEY HOSPITAL
200033,EASTERN MAINE MEDICAL CENTER
470024,NORTHWESTERN MEDICAL CENTER INC
310032,SOUTH JERSEY HEALTHCARE REGIONAL MEDICAL CENTER
330195,LONG ISLAND JEWISH MEDICAL CENTER
220063,LOWELL GENERAL HOSPITAL
220067,QUINCY MEDICAL CENTER
220070,HALLMARK HEALTH SYSTEM
410006,NEWPORT HOSPITAL
410013,WESTERLY HOSPITAL
410010,WOMEN AND INFANTS HOSPITAL OF RHODE ISLAND
200008,MERCY HOSPITAL
70035,"HOSPITAL OF CENTRAL CONNECTICUT, THE"
200020,YORK HOSPITAL
200019,SOUTHERN MAINE MEDICAL CENTER
310111,CENTRASTATE MEDICAL CENTER
310069,SOUTH JERSEY HEALTHCARE-ELMER HOSPITAL
330169,BETH ISRAEL MEDICAL CENTER
330158,GOOD SAMARITAN HOSPITAL OF SUFFERN
330019,"NEW YORK COMMUNITY HOSPITAL OF BROOKLYN, INC."
330055,NEW YORK HOSPITAL MEDICAL CENTER OF QUEENS
330225,LONG BEACH MEDICAL CENTER
330043,SOUTHSIDE HOSPITAL
330047,ST MARY'S HOSPITAL AT AMSTERDAM
330394,"UNITED HEALTH SERVICES HOSPITALS, INC"
330229,BROOKS MEMORIAL HOSPITAL
330188,MOUNT ST MARY'S HOSPITAL AND  HEALTH CENTER
330065,NIAGARA FALLS MEMORIAL MEDICAL CENTER
330226,UNITY HOSPITAL OF ROCHESTER
390211,SHARON REGIONAL HEALTH SYSTEM
390307,EDGEWOOD SURGICAL HOSPITAL
410004,ROGER WILLIAMS MEDICAL CENTER
200039,MAINE GENERAL MEDICAL CENTER
Query:
SELECT "provider_id", "provider_name",
           SUM("total_discharges") AS "total_discharges"
    FROM (
        SELECT "provider_id", "provider_name", "total_discharges"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
        UNION ALL
        SELECT "provider_id", "provider_name", "total_discharges"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
        UNION ALL
        SELECT "provider_id", "provider_name", "total_discharges"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
        UNION ALL
        SELECT "provider_id", "provider_name", "total_discharges"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
        UNION ALL
        SELECT "provider_id", "provider_name", "total_discharges"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
    ) AS combined_discharges
    GROUP BY "provider_id", "provider_name"
    ORDER BY "total_discharges" DESC
    LIMIT 100;
Answer:
provider_id,provider_name,total_discharges
100007,FLORIDA HOSPITAL,151068
330101,NEW YORK-PRESBYTERIAN HOSPITAL,100564
80001,"CHRISTIANA CARE HEALTH SERVICES, INC.",87542
450388,METHODIST HOSPITAL,85615
440049,METHODIST HEALTHCARE MEMPHIS HOSPITALS,76872
70022,YALE-NEW HAVEN HOSPITAL,68410
220074,"SOUTHCOAST HOSPITAL GROUP, INC",66784
50625,CEDARS-SINAI MEDICAL CENTER,62828
260032,BARNES JEWISH HOSPITAL,62522
220071,MASSACHUSETTS GENERAL HOSPITAL,61915
340141,NEW HANOVER REGIONAL MEDICAL CENTER,61780
450184,MEMORIAL HERMANN HOSPITAL SYSTEM,61671
340002,MEMORIAL MISSION HOSPITAL AND ASHEVILLE SURGERY CE,61570
450058,BAPTIST MEDICAL CENTER,61022
10039,HUNTSVILLE HOSPITAL,60872
330059,MONTEFIORE MEDICAL CENTER,60434
140010,EVANSTON HOSPITAL,60363
330106,NORTH SHORE UNIVERSITY HOSPITAL,59485
330024,MOUNT SINAI HOSPITAL,57926
520138,AURORA ST LUKES MEDICAL CENTER,57198
360180,CLEVELAND CLINIC,55776
100018,NAPLES COMMUNITY HOSPITAL,55066
310022,VIRTUA WEST JERSEY HOSPITALS BERLIN,53382
390133,LEHIGH VALLEY HOSPITAL,53322
230038,SPECTRUM HEALTH - BUTTERWORTH CAMPUS,52917
310041,COMMUNITY MEDICAL CENTER,52666
340040,VIDANT MEDICAL CENTER,52467
150056,INDIANA UNIVERSITY HEALTH,52386
510022,CHARLESTON AREA MEDICAL CENTER,51883
440048,BAPTIST MEMORIAL HOSPITAL,51118
340091,"MOSES H CONE MEMORIAL HOSPITAL, THE",50880
230019,PROVIDENCE HOSPITAL AND MEDICAL CENTERS,50719
330169,BETH ISRAEL MEDICAL CENTER,50578
450358,"METHODIST HOSPITAL,THE",50124
100012,LEE MEMORIAL HOSPITAL,49833
390164,UPMC PRESBYTERIAN SHADYSIDE,49747
440002,JACKSON-MADISON COUNTY GENERAL HOSPITAL,49728
360006,RIVERSIDE METHODIST HOSPITAL,49418
180040,JEWISH HOSPITAL & ST MARY'S HEALTHCARE,48943
490021,"CENTRA  HEALTH, INC",48621
340113,CAROLINAS MEDICAL CENTER/BEHAV HEALTH,48077
440091,"MEMORIAL HEALTHCARE SYSTEM, INC",48064
70025,HARTFORD HOSPITAL,48013
100157,LAKELAND REGIONAL MEDICAL CENTER,47914
10092,D C H REGIONAL MEDICAL CENTER,47243
100006,ORLANDO HEALTH,47138
100204,NORTH FLORIDA REGIONAL MEDICAL CENTER,46894
370091,"SAINT FRANCIS HOSPITAL, INC",46466
340115,FIRSTHEALTH MOORE REGIONAL HOSPITAL,46116
220077,BAYSTATE MEDICAL CENTER,46087
230195,ST JOHN MACOMB-OAKLAND HOSPITAL-MACOMB CENTER,45936
140208,ADVOCATE CHRIST HOSPITAL & MEDICAL CENTER,45753
310012,VALLEY HOSPITAL,45361
190111,WILLIS KNIGHTON MEDICAL CENTER,45361
310086,KENNEDY UNIVERSITY HOSPITAL - STRATFORD DIV,45356
230156,ST JOSEPH MERCY HOSPITAL,44934
150082,DEACONESS HOSPITAL INC,44880
240057,ABBOTT NORTHWESTERN HOSPITAL,44849
340028,CAPE FEAR VALLEY MEDICAL CENTER,44430
310001,HACKENSACK UNIVERSITY MEDICAL CENTER,44418
110035,WELLSTAR KENNESTONE HOSPITAL,44134
450021,BAYLOR UNIVERSITY MEDICAL CENTER,43948
240010,MAYO CLINIC HOSPITAL ROCHESTER,43369
140281,NORTHWESTERN MEMORIAL HOSPITAL,43303
220110,BRIGHAM AND WOMEN'S HOSPITAL,43219
490063,INOVA FAIRFAX HOSPITAL,43013
100087,SARASOTA MEMORIAL HOSPITAL,42807
230046,UNIVERSITY OF MICHIGAN HEALTH SYSTEM,42707
220163,UMASS MEMORIAL MEDICAL CENTER INC,42685
390174,THOMAS JEFFERSON UNIVERSITY HOSPITAL,42386
390100,LANCASTER GENERAL HOSPITAL,42225
250004,NORTH MISSISSIPPI MEDICAL CENTER,41853
340069,"WAKEMED, RALEIGH CAMPUS",41718
40114,BAPTIST HEALTH MEDICAL CENTER-LITTLE ROCK,40968
210023,ANNE ARUNDEL MEDICAL CENTER,40936
340030,DUKE UNIVERSITY HOSPITAL,40884
10033,UNIVERSITY OF ALABAMA HOSPITAL,40857
450135,TEXAS HEALTH HARRIS METHODIST FORT WORTH,40783
340047,NORTH CAROLINA BAPTIST HOSPITAL,40298
140062,PALOS COMMUNITY HOSPITAL,40096
140148,MEMORIAL MEDICAL CENTER,39885
330140,ST JOSEPH'S HOSPITAL HEALTH CENTER,39883
210009,"JOHNS HOPKINS HOSPITAL, THE",39881
230130,"BEAUMONT HOSPITAL, ROYAL OAK",39708
110029,"NORTHEAST GEORGIA MEDICAL CENTER, INC",39556
230165,ST JOHN HOSPITAL AND MEDICAL CENTER,39331
70002,ST FRANCIS HOSPITAL & MEDICAL CENTER,39266
370114,"ST JOHN MEDICAL CENTER, INC",38784
420051,MCLEOD REGIONAL MEDICAL CENTER-PEE DEE,38773
100019,HOLMES REGIONAL MEDICAL CENTER,38757
220100,SOUTH SHORE HOSPITAL,38656
100220,GULF COAST MEDICAL CENTER LEE MEM HEALTH SYSTEM,38560
330005,KALEIDA HEALTH,38522
450102,MOTHER FRANCES HOSPITAL,38491
150084,ST VINCENT HOSPITAL & HEALTH SERVICES,38490
220086,BETH ISRAEL DEACONESS MEDICAL CENTER,38328
360085,OHIO STATE UNIVERSITY HOSPITALS,38041
250078,FORREST GENERAL HOSPITAL,37984
240036,ST CLOUD HOSPITAL,37801
140067,SAINT FRANCIS MEDICAL CENTER,37698
Query:
SELECT "provider_id", "provider_name",
           SUM("total_discharges" * "average_medicare_payments") AS "total_inpatient_cost"
    FROM (
        SELECT "provider_id", "provider_name", "provider_state",
               "total_discharges", "average_medicare_payments"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
        WHERE "provider_state" = 'CA'
        UNION ALL
        SELECT "provider_id", "provider_name", "provider_state",
               "total_discharges", "average_medicare_payments"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
        WHERE "provider_state" = 'CA'
        UNION ALL
        SELECT "provider_id", "provider_name", "provider_state",
               "total_discharges", "average_medicare_payments"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
        WHERE "provider_state" = 'CA'
        UNION ALL
        SELECT "provider_id", "provider_name", "provider_state",
               "total_discharges", "average_medicare_payments"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
        WHERE "provider_state" = 'CA'
        UNION ALL
        SELECT "provider_id", "provider_name", "provider_state",
               "total_discharges", "average_medicare_payments"
        FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
        WHERE "provider_state" = 'CA'
    ) AS combined_inpatient
    GROUP BY "provider_id", "provider_name"
    ORDER BY "total_inpatient_cost" DESC
    LIMIT 100;
Answer:
provider_id,provider_name,total_inpatient_cost
50625,CEDARS-SINAI MEDICAL CENTER,1111247205.0
50454,UCSF MEDICAL CENTER,629965827.0
50599,UNIVERSITY OF CALIFORNIA DAVIS MEDICAL CENTER,528556816.0
50441,STANFORD HOSPITAL,493924448.0
50060,COMMUNITY REGIONAL MEDICAL CENTER,397058089.0
50093,SAINT AGNES MEDICAL CENTER,382653459.0
50025,UNIVERSITY OF CALIFORNIA SAN DIEGO MEDICAL CENTER,357422325.0
50026,GROSSMONT HOSPITAL,305211986.0
50573,EISENHOWER MEDICAL CENTER,305153473.0
50077,SCRIPPS MERCY HOSPITAL,304003807.0
50438,HUNTINGTON MEMORIAL HOSPITAL,294481681.0
50516,MERCY SAN JUAN MEDICAL CENTER,293385859.0
50108,SUTTER GENERAL HOSPITAL,290471328.0
50047,CALIFORNIA PACIFIC MEDICAL CTR-PACIFIC CAMPUS HOSP,289492325.0
50739,CENTINELA HOSPITAL MEDICAL CENTER,289057406.0
50262,RONALD REAGAN U C L A MEDICAL CENTER,286935217.0
50327,LOMA LINDA UNIVERSITY MEDICAL CENTER,286163879.0
50057,KAWEAH DELTA MEDICAL CENTER,282720729.0
50239,GLENDALE ADVENTIST MEDICAL CENTER,281308333.0
50224,HOAG MEMORIAL HOSPITAL PRESBYTERIAN,279292338.0
50125,REGIONAL MEDICAL CENTER OF SAN JOSE,274866328.0
50180,JOHN MUIR MEDICAL CENTER - WALNUT CREEK CAMPUS,274002976.0
50039,ENLOE MEDICAL CENTER,273148803.0
50280,MERCY MEDICAL CENTER REDDING,266529582.0
50195,WASHINGTON HOSPITAL,264040254.0
50441,STANFORD HEALTH CARE,252808051.0
50308,EL CAMINO HOSPITAL,248170668.0
50235,PROVIDENCE SAINT JOSEPH MEDICAL CTR,246172403.0
50043,ALTA BATES SUMMIT MEDICAL CENTER,241870845.0
50549,LOS ROBLES HOSPITAL & MEDICAL CENTER,237836768.0
50174,SANTA ROSA MEMORIAL HOSPITAL,236075660.0
50238,METHODIST HOSPITAL OF SOUTHERN CA,235285226.0
50485,LONG BEACH MEMORIAL MEDICAL CENTER,232455135.0
50017,MERCY GENERAL HOSPITAL,229714379.0
50382,CITRUS VALLEY MEDICAL CENTER-IC CAMPUS,223193669.0
50133,RIDEOUT MEMORIAL HOSPITAL,222819497.0
50309,SUTTER ROSEVILLE MEDICAL CENTER,220056792.0
50145,COMMUNITY HOSPITAL OF THE MONTEREY PENINSULA,217304411.0
50380,GOOD SAMARITAN HOSPITAL,213120770.0
50100,SHARP MEMORIAL HOSPITAL,212948158.0
50396,SANTA BARBARA COTTAGE HOSPITAL,211229751.0
50334,SALINAS VALLEY MEMORIAL HOSPITAL,210705739.0
50696,KECK HOSPITAL OF USC,207748412.0
50464,DOCTORS MEDICAL CENTER,197658876.0
50761,PROVIDENCE TARZANA MEDICAL CENTER,197463841.0
50351,TORRANCE MEMORIAL MEDICAL CENTER,192795493.0
50112,SANTA MONICA - UCLA MED CTR & ORTHOPAEDIC HOSPITAL,192704914.0
50496,JOHN MUIR MEDICAL CENTER - CONCORD CAMPUS,190674650.0
50348,UNIVERSITY OF CALIFORNIA IRVINE MED CENTER,190516222.0
50471,GOOD SAMARITAN HOSPITAL,188399530.0
50022,RIVERSIDE COMMUNITY HOSPITAL,185667023.0
50444,MERCY MEDICAL CENTER,183559457.0
50030,OROVILLE HOSPITAL,179326996.0
50557,MEMORIAL  MEDICAL CENTER,177949865.0
50567,MISSION HOSPITAL REGIONAL MED CENTER,177078817.0
50353,PROVIDENCE LITTLE COMPANY OF MARY MED CTR TORRANCE,176871296.0
50764,SHASTA REGIONAL MEDICAL CENTER,175675449.0
50570,FOUNTAIN VALLEY REGIONAL HOSPITAL & MEDICAL CENTER,172114646.0
50242,DOMINICAN HOSPITAL,171989587.0
50153,O'CONNOR HOSPITAL,171378757.0
50502,SAINT VINCENT MEDICAL CENTER,166907178.0
50278,PROVIDENCE HOLY CROSS MEDICAL CENTER,166677564.0
50360,MARIN GENERAL HOSPITAL,164282514.0
50103,WHITE MEMORIAL MEDICAL CENTER,160983979.0
50069,ST JOSEPH HOSPITAL,159658624.0
50231,POMONA VALLEY HOSPITAL MEDICAL CENTER,158260309.0
50488,EDEN MEDICAL CENTER,158214007.0
50063,HOLLYWOOD PRESBYTERIAN MEDICAL CENTER,157412627.0
50324,SCRIPPS MEMORIAL HOSPITAL LA JOLLA,156741969.0
50116,NORTHRIDGE HOSPITAL MEDICAL CENTER,155927407.0
50222,SHARP CHULA VISTA MEDICAL CENTER,154456962.0
50305,ALTA BATES SUMMIT MEDICAL CENTER - ALTA BATES CAMP,152319781.0
50126,VALLEY PRESBYTERIAN HOSPITAL,152151314.0
50455,SAN JOAQUIN COMMUNITY HOSPITAL,149116529.0
50168,ST JUDE MEDICAL CENTER,147333825.0
50058,GLENDALE MEM HOSPITAL & HLTH CENTER,146388455.0
50424,SCRIPPS GREEN HOSPITAL,146106032.0
50038,SANTA CLARA VALLEY MEDICAL CENTER,144979112.0
50367,NORTHBAY MEDICAL CENTER,144946195.0
50084,ST JOSEPHS MEDICAL CENTER OF STOCKTON,144110167.0
50262,RONALD REAGAN UCLA MEDICAL CENTER,142892122.0
50128,TRI-CITY MEDICAL CENTER,141139051.0
50737,GARFIELD MEDICAL CENTER,140738718.0
50013,ST HELENA HOSPITAL,139475784.0
50107,MARIAN REGIONAL MEDICAL CENTER,138819733.0
50024,PARADISE VALLEY HOSPITAL,137111439.0
50082,ST JOHNS REGIONAL MEDICAL CENTER,136151056.0
50121,ADVENTIST MEDICAL CENTER,135802656.0
50169,PRESBYTERIAN INTERCOMMUNITY HOSPITAL,134771795.0
50481,WEST HILLS HOSPITAL & MEDICAL CENTER,132757865.0
50135,SOUTHERN CALIFORNIA HOSPITAL AT HOLLYWOOD,130547306.0
50300,ST MARY MEDICAL CENTER,126398672.0
50603,SADDLEBACK MEMORIAL MEDICAL CENTER,125695304.0
50289,SETON MEDICAL CENTER,125610412.0
50742,OLYMPIA MEDICAL CENTER,124149008.0
50036,BAKERSFIELD MEMORIAL HOSPITAL,122538590.0
50115,PALOMAR HEALTH DOWNTOWN CAMPUS,122050749.0
50129,ST BERNARDINE MEDICAL CENTER,121048734.0
50590,METHODIST HOSPITAL OF SACRAMENTO,120663286.0
50104,SAINT FRANCIS MEDICAL CENTER,112198248.0
Query:
SELECT "drg_definition",
           AVG("average_total_payments") AS "avg_total_payments"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
    GROUP BY "drg_definition"
    ORDER BY "avg_total_payments" DESC
    LIMIT 100;
Answer:
Too long, hard cut:
drg_definition,avg_total_payments
870 - SEPTICEMIA OR SEVERE SEPSIS W MV 96+ HOURS,44259.482428115014
853 - INFECTIOUS & PARASITIC DISEASES W O.R. PROCEDURE W MCC,40315.96511627907
207 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT 96+ HOURS,38588.93379191746
329 - MAJOR SMALL & LARGE BOWEL PROCEDURES W MCC,37765.60907859079
460 - SPINAL FUSION EXCEPT CERVICAL W/O MCC,27778.671921921923
246 - PERC CARDIOVASC PROC W DRUG-ELUTING STENT W MCC OR 4+ VESSELS/STENTS,23326.346782988003
252 - OTHER VASCULAR PROCEDURES W MCC,22845.635099913117
469 - MAJOR JOINT REPLACEMENT OR REATTACHMENT OF LOWER EXTREMITY W MCC,22531.270386266093
238 - MAJOR CARDIOVASC PROCEDURES W/O MCC,21948.559772296016
480 - HIP & FEMUR PROCEDURES EXCEPT MAJOR JOINT W MCC,20984.37029063509
243 - PERMANENT CARDIAC PACEMAKER IMPLANT W CC,18132.926086956522
330 - MAJOR SMALL & LARGE BOWEL PROCEDURES W CC,17926.67122473246
253 - OTHER VASCULAR PROCEDURES W CC,17317.72152950956
208 - RESPIRATORY SYSTEM DIAGNOSIS W VENTILATOR SUPPORT <96 HOURS,16213.295534370296
"286 - CIRCULATORY DISORDERS EXCEPT AMI, W CARD CATH W MCC",14937.647252747252
473 - CERVICAL SPINAL FUSION W/O CC/MCC,14672.594562647753
470 - MAJOR JOINT REPLACEMENT OR REATTACHMENT OF LOWER EXTREMITY W/O MCC,14566.933454545455
247 - PERC CARDIOVASC PROC W DRUG-ELUTING STENT W/O MCC,14353.513494318182
244 - PERMANENT CARDIAC PACEMAKER IMPLANT W/O CC/MCC,13899.711627906976
177 - RESPIRATORY INFECTIONS & INFLAMMATIONS W MCC,13829.388067581838
314 - OTHER CIRCULATORY SYSTEM DIAGNOSES W MCC,13316.076576576577
251 - PERC CARDIOVASC PROC W/O CORONARY ARTERY STENT W/O MCC,13315.21870701513
064 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W MCC,13263.828812537673
871 - SEPTICEMIA OR SEVERE SEPSIS W/O MV 96+ HOURS W MCC,13238.827169274538
481 - HIP & FEMUR PROCEDURES EXCEPT MAJOR JOINT W CC,12632.269377990431
249 - PERC CARDIOVASC PROC W NON-DRUG-ELUTING STENT W/O MCC,12593.507853403142
377 - G.I. HEMORRHAGE W MCC,12490.134008338297
"280 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W MCC",12441.674109516214
698 - OTHER KIDNEY & URINARY TRACT DIAGNOSES W MCC,11706.83180778032
418 - LAPAROSCOPIC CHOLECYSTECTOMY W/O C.D.E. W CC,11576.15849843587
682 - RENAL FAILURE W MCC,11540.286847014926
254 - OTHER VASCULAR PROCEDURES W/O CC/MCC,11488.65108695652
917 - POISONING & TOXIC EFFECTS OF DRUGS W MCC,10763.817319098458
482 - HIP & FEMUR PROCEDURES EXCEPT MAJOR JOINT W/O CC/MCC,10468.1875
602 - CELLULITIS W MCC,10425.569312169313
291 - HEART FAILURE & SHOCK W MCC,10266.53926311872
193 - SIMPLE PNEUMONIA & PLEURISY W MCC,10053.691650485436
178 - RESPIRATORY INFECTIONS & INFLAMMATIONS W CC,9800.383000512033
811 - RED BLOOD CELL DISORDERS W MCC,9256.672246696035
189 - PULMONARY EDEMA & RESPIRATORY FAILURE,9056.333015267175
372 - MAJOR GASTROINTESTINAL DISORDERS & PERITONEAL INFECTIONS W CC,8747.234387672344
308 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W MCC,8690.29840425532
"391 - ESOPHAGITIS, GASTROENT & MISC DIGEST DISORDERS W MCC",8481.85796178344
689 - KIDNEY & URINARY TRACT INFECTIONS W MCC,8193.42725409836
190 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W MCC,8163.0
"640 - MISC DISORDERS OF NUTRITION,METABOLISM,FLUIDS/ELECTROLYTES W MCC",8129.8835616438355
419 - LAPAROSCOPIC CHOLECYSTECTOMY W/O C.D.E. W/O CC/MCC,8068.098737083812
"281 - ACUTE MYOCARDIAL INFARCTION, DISCHARGED ALIVE W CC",7994.263933376041
065 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W CC,7922.669017188188
872 - SEPTICEMIA OR SEVERE SEPSIS W/O MV 96+ HOURS W/O MCC,7886.2
"287 - CIRCULATORY DISORDERS EXCEPT AMI, W CARD CATH W/O MCC",7736.451388888889
699 - OTHER KIDNEY & URINARY TRACT DIAGNOSES W CC,7288.379347826087
176 - PULMONARY EMBOLISM W/O MCC,7279.953438395415
439 - DISORDERS OF PANCREAS EXCEPT MALIGNANCY W CC,7266.566492146597
394 - OTHER DIGESTIVE SYSTEM DIAGNOSES W CC,7110.477022653722
491 - BACK & NECK PROC EXC SPINAL FUSION W/O CC/MCC,7083.436923076923
378 - G.I. HEMORRHAGE W CC,7027.50156128025
315 - OTHER CIRCULATORY SYSTEM DIAGNOSES W CC,7020.110593713621
683 - RENAL FAILURE W CC,6995.784290271133
885 - PSYCHOSES,6968.740619902121
194 - SIMPLE PNEUMONIA & PLEURISY W CC,6963.26132980483
039 - EXTRACRANIAL PROCEDURES W/O CC/MCC,6960.548656163114
292 - HEART FAILURE & SHOCK W CC,6957.839146630546
300 - PERIPHERAL VASCULAR DISORDERS W CC,6761.6086671043995
057 - DEGENERATIVE NERVOUS SYSTEM DISORDERS W/O MCC,6706.283930058285
191 - CHRONIC OBSTRUCTIVE PULMONARY DISEASE W CC,6627.31580882353
389 - G.I. OBSTRUCTION W CC,6447.10286677909
074 - CRANIAL & PERIPHERAL NERVE DISORDERS W/O MCC,6386.799795709908
202 - BRONCHITIS & ASTHMA W CC/MCC,6011.3309248554915
638 - DIABETES W CC,5889.57967032967
603 - CELLULITIS W/O MCC,5798.943712148201
309 - CARDIAC ARRHYTHMIA & CONDUCTION DISORDERS W CC,5791.492170969107
552 - MEDICAL BACK PROBLEMS W/O MCC,5725.792892837313
066 - INTRACRANIAL HEMORRHAGE OR CEREBRAL INFARCTION W/O CC/MCC,5714.003322259136
812 - RED BLOOD CELL DISORDERS W/O MCC,5562.1516587677725
"282 - ACUTE MYOC
End Exploring Related Columns
Task: For the provider whose total inpatient Medicare cost from 2011 through 2015 is the highest (computed as the sum of average_medicare_payments multiplied by total_discharges), please list that provider’s yearly average inpatient cost and yearly average outpatient cost for each calendar year in this period, where the inpatient cost is calculated as the average of (average_medicare_payments × total_discharges) and the outpatient cost is calculated as the average of (average_total_payments × outpatient_services).

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Year,Average_Inpatient_Cost,Average_Outpatient_Cost
2011,avg_inpatient_cost_2011:float,avg_outpatient_cost_2011:float
2012,avg_inpatient_cost_2012:float,avg_outpatient_cost_2012:float
2013,avg_inpatient_cost_2013:float,avg_outpatient_cost_2013:float
2014,avg_inpatient_cost_2014:float,avg_outpatient_cost_2014:float
2015,avg_inpatient_cost_2015:float,avg_outpatient_cost_2015:float
```
*(Attention: answer in five rows for the provider with the highest total inpatient Medicare cost)*

**Explanation:**

The provider with the highest total inpatient Medicare cost from 2011 through 2015 is determined by calculating the sum of *(average_medicare_payments × total_discharges)* across all years. The table above lists this provider's yearly average inpatient cost and yearly average outpatient cost for each calendar year in the period from 2011 to 2015.

- **Average Inpatient Cost** for each year is calculated as the average of *(average_medicare_payments × total_discharges)* for that year.
- **Average Outpatient Cost** for each year is calculated as the average of *(average_total_payments × outpatient_services)* for that year..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'CMS_DATA': {'CMS_CODES': ['HCPCS', 'ICD10_PROCEDURES_2019', 'ICD9_DIAGNOSES', 'ICD10_DIAGNOSES_2019', 'ICD9_PROCEDURES'], 'CMS_MEDICARE': ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014', 'HOSPICE_PROVIDERS_2014', 'HOSPITAL_GENERAL_INFO', 'INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2015', 'NURSING_FACILITIES_2014', 'NURSING_FACILITIES_2014', 'NURSING_FACILITIES_2013', 'OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2015', 'PART_D_PRESCRIBER_2014', 'REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014'], 'CMS_SYNTHETIC_PATIENT_DATA_OMOP': ['CONDITION_OCCURRENCE', 'DRUG_ERA', 'LOCATION', 'PERSON', 'CONDITION_ERA', 'DEVICE_EXPOSURE', 'DOMAIN', 'DOSE_ERA', 'OBSERVATION', 'COST', 'PROVIDER', 'CARE_SITE', 'CONCEPT_ANCESTOR', 'CONCEPT_RELATIONSHIP', 'DEATH', 'DRUG_STRENGTH', 'CONCEPT', 'CONCEPT_CLASS', 'DRUG_EXPOSURE', 'OBSERVATION_PERIOD', 'PAYER_PLAN_PERIOD', 'RELATIONSHIP', 'VOCABULARY', 'PROCEDURE_OCCURRENCE']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-12 17:47:48 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 17:47:48 - root - INFO - ```sql
WITH combined_inpatient AS (
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2011 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2012 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2013 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2014 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2015 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
),
total_inpatient_cost_per_provider AS (
    SELECT "provider_id", "provider_name", SUM("total_discharges" * "average_medicare_payments") AS "total_inpatient_cost"
    FROM combined_inpatient
    GROUP BY "provider_id", "provider_name"
),
top_provider AS (
    SELECT "provider_id", "provider_name"
    FROM total_inpatient_cost_per_provider
    ORDER BY "total_inpatient_cost" DESC
    LIMIT 1
),
yearly_inpatient_cost AS (
    SELECT c."Year", AVG(c."total_discharges" * c."average_medicare_payments") AS "Average_Inpatient_Cost"
    FROM combined_inpatient c
    JOIN top_provider tp ON c."provider_id" = tp."provider_id"
    GROUP BY c."Year"
),
combined_outpatient AS (
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2011 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2012 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2012
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2013 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2014 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2014
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2015 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2015
),
yearly_outpatient_cost AS (
    SELECT c."Year", AVG(c."outpatient_services" * c."average_total_payments") AS "Average_Outpatient_Cost"
    FROM combined_outpatient c
    JOIN top_provider tp ON c."provider_id" = tp."provider_id"
    GROUP BY c."Year"
)
SELECT y."Year", y."Average_Inpatient_Cost", yo."Average_Outpatient_Cost"
FROM yearly_inpatient_cost y
LEFT JOIN yearly_outpatient_cost yo ON y."Year" = yo."Year"
ORDER BY y."Year";
```
2025-02-12 17:47:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:47:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:47:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:47:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-02-12 17:47:50 - snowflake.connector.connection - INFO - closed
2025-02-12 17:47:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:47:51 - root - INFO - itercount: 1
2025-02-12 17:47:51 - root - INFO - 0
2025-02-12 17:47:51 - root - INFO - results: 
Year,Average_Inpatient_Cost,Average_Outpatient_Cost
2011,2626089.1414141413,443473.7083333333
2012,2547851.28,406864.6
2013,2335016.89,382465.44
2014,1541546.1721518987,343631.46428571426
2015,1520975.099730458,409001.4434685575


2025-02-12 17:47:51 - root - INFO - Please check the answer again by reviewing For the provider whose total inpatient Medicare cost from 2011 through 2015 is the highest (computed as the sum of average_medicare_payments multiplied by total_discharges), please list that provider’s yearly average inpatient cost and yearly average outpatient cost for each calendar year in this period, where the inpatient cost is calculated as the average of (average_medicare_payments × total_discharges) and the outpatient cost is calculated as the average of (average_total_payments × outpatient_services)., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Year,Average_Inpatient_Cost,Average_Outpatient_Cost
2011,avg_inpatient_cost_2011:float,avg_outpatient_cost_2011:float
2012,avg_inpatient_cost_2012:float,avg_outpatient_cost_2012:float
2013,avg_inpatient_cost_2013:float,avg_outpatient_cost_2013:float
2014,avg_inpatient_cost_2014:float,avg_outpatient_cost_2014:float
2015,avg_inpatient_cost_2015:float,avg_outpatient_cost_2015:float
```
*(Attention: answer in five rows for the provider with the highest total inpatient Medicare cost)*

**Explanation:**

The provider with the highest total inpatient Medicare cost from 2011 through 2015 is determined by calculating the sum of *(average_medicare_payments × total_discharges)* across all years. The table above lists this provider's yearly average inpatient cost and yearly average outpatient cost for each calendar year in the period from 2011 to 2015.

- **Average Inpatient Cost** for each year is calculated as the average of *(average_medicare_payments × total_discharges)* for that year.
- **Average Outpatient Cost** for each year is calculated as the average of *(average_total_payments × outpatient_services)* for that year. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Year,Average_Inpatient_Cost,Average_Outpatient_Cost
2011,2626089.1414141413,443473.7083333333
2012,2547851.28,406864.6
2013,2335016.89,382465.44
2014,1541546.1721518987,343631.46428571426
2015,1520975.099730458,409001.4434685575
Current sql:
WITH combined_inpatient AS (
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2011 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2012 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2013 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2014 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2015 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
),
total_inpatient_cost_per_provider AS (
    SELECT "provider_id", "provider_name", SUM("total_discharges" * "average_medicare_payments") AS "total_inpatient_cost"
    FROM combined_inpatient
    GROUP BY "provider_id", "provider_name"
),
top_provider AS (
    SELECT "provider_id", "provider_name"
    FROM total_inpatient_cost_per_provider
    ORDER BY "total_inpatient_cost" DESC
    LIMIT 1
),
yearly_inpatient_cost AS (
    SELECT c."Year", AVG(c."total_discharges" * c."average_medicare_payments") AS "Average_Inpatient_Cost"
    FROM combined_inpatient c
    JOIN top_provider tp ON c."provider_id" = tp."provider_id"
    GROUP BY c."Year"
),
combined_outpatient AS (
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2011 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2012 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2012
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2013 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2014 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2014
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2015 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2015
),
yearly_outpatient_cost AS (
    SELECT c."Year", AVG(c."outpatient_services" * c."average_total_payments") AS "Average_Outpatient_Cost"
    FROM combined_outpatient c
    JOIN top_provider tp ON c."provider_id" = tp."provider_id"
    GROUP BY c."Year"
)
SELECT y."Year", y."Average_Inpatient_Cost", yo."Average_Outpatient_Cost"
FROM yearly_inpatient_cost y
LEFT JOIN yearly_outpatient_cost yo ON y."Year" = yo."Year"
ORDER BY y."Year";When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-02-12 17:48:45 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-12 17:48:45 - root - INFO - ```sql
WITH combined_inpatient AS (
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2011 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2011
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2012 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2012
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2013 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2013
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2014 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2014
    UNION ALL
    SELECT "provider_id", "provider_name", "total_discharges", "average_medicare_payments", 2015 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.INPATIENT_CHARGES_2015
),
total_inpatient_cost_per_provider AS (
    SELECT "provider_id", "provider_name", SUM("total_discharges" * "average_medicare_payments") AS "total_inpatient_cost"
    FROM combined_inpatient
    GROUP BY "provider_id", "provider_name"
),
top_provider AS (
    SELECT "provider_id", "provider_name"
    FROM total_inpatient_cost_per_provider
    ORDER BY "total_inpatient_cost" DESC NULLS LAST
    LIMIT 1
),
yearly_inpatient_cost AS (
    SELECT c."Year", AVG(c."total_discharges" * c."average_medicare_payments") AS "Average_Inpatient_Cost"
    FROM combined_inpatient c
    JOIN top_provider tp ON c."provider_id" = tp."provider_id"
    GROUP BY c."Year"
),
combined_outpatient AS (
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2011 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2011
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2012 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2012
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2013 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2013
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2014 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2014
    UNION ALL
    SELECT "provider_id", "provider_name", "outpatient_services", "average_total_payments", 2015 AS "Year"
    FROM CMS_DATA.CMS_MEDICARE.OUTPATIENT_CHARGES_2015
),
yearly_outpatient_cost AS (
    SELECT c."Year", AVG(c."outpatient_services" * c."average_total_payments") AS "Average_Outpatient_Cost"
    FROM combined_outpatient c
    JOIN top_provider tp ON c."provider_id" = tp."provider_id"
    GROUP BY c."Year"
)
SELECT y."Year", y."Average_Inpatient_Cost", yo."Average_Outpatient_Cost"
FROM yearly_inpatient_cost y
LEFT JOIN yearly_outpatient_cost yo ON y."Year" = yo."Year"
ORDER BY y."Year";
```
2025-02-12 17:48:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-12 17:48:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-12 17:48:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-12 17:48:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-02-12 17:48:48 - snowflake.connector.connection - INFO - closed
2025-02-12 17:48:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-12 17:48:48 - root - INFO - itercount: 2
2025-02-12 17:48:48 - root - INFO - 0
2025-02-12 17:48:48 - root - INFO - Total iteration counts: 2
