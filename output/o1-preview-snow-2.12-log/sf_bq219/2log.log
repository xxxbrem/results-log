2025-02-11 15:27:47 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 15:27:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:27:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:27:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:27:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 15:27:48 - snowflake.connector.connection - INFO - closed
2025-02-11 15:27:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:27:49 - root - INFO - SQL:
SELECT DISTINCT "category", "category_name"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   LIMIT 100;
Results:
category,category_name
1011700.0,CORN WHISKIES
1012300.0,SINGLE MALT SCOTCH
1701200.0,HOLIDAY VAP
1012100.0,CANADIAN WHISKIES
1022100.0,TEQUILA
1081300.0,AMERICAN CORDIALS & LIQUEURS
1081335.0,RASPBERRY SCHNAPPS
1081250.0,WHITE CREME DE MENTHE
1091400.0,IOWA DISTILLERIES
1011500.0,STRAIGHT RYE WHISKIES
1081500.0,ROCK & RYE
1082200.0,IMPORTED SCHNAPPS
1052100.0,IMPORTED BRANDIES
1062200.0,WHITE RUM
1062100.0,GOLD RUM
1031100.0,100 PROOF VODKA
1062300.0,AGED DARK RUM
1071100.0,AMERICAN COCKTAILS
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY
1081015.0,IMPORTED AMARETTO
1032200.0,IMPORTED VODKA - MISC
1011300.0,SINGLE BARREL BOURBON WHISKIES
1700000.0,TEMPORARY & SPECIALTY PACKAGES
1901000.0,SPECIAL ORDER ITEMS
1081240.0,GREEN CREME DE MENTHE
1701100.0,DECANTERS & SPECIALTY PACKAGES
1071000.0,COCKTAILS/RTD
1091200.0,NEUTRAL GRAIN SPIRITS
1081305.0,APPLE SCHNAPPS
1041300.0,AMERICAN SLOE GINS
1082100.0,
1081030.0,COFFEE LIQUEURS
1081230.0,WHITE CREME DE CACAO
1062500.0,
1501100.0,HIGH PROOF BEER - AMERICAN
1051010.0,AMERICAN GRAPE BRANDIES
1081370.0,WATERMELON SCHNAPPS
1090000.0,DISTILLED SPIRITS SPECIALTY
1081600.0,WHISKEY LIQUEUR
1051100.0,APRICOT BRANDIES
1012400.0,JAPANESE WHISKY
1031200.0,VODKA FLAVORED
1031000.0,AMERICAN VODKAS
1101100.0,AMERICAN ALCOHOL
1052010.0,IMPORTED GRAPE BRANDIES
1012400.0,IRISH WHISKIES
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY
1032100.0,
1032080.0,IMPORTED VODKAS
1081315.0,CINNAMON SCHNAPPS
1041200.0,FLAVORED GIN
1011800.0,IOWA DISTILLERY WHISKIES
1011300.0,TENNESSEE WHISKIES
1022200.0,
1012300.0,IRISH WHISKIES
1062050.0,BARBADOS RUM
1082900.0,MISC. IMPORTED CORDIALS & LIQUEURS
1012200.0,SCOTCH WHISKIES
1081330.0,PEACH SCHNAPPS
1081400.0,AMERICAN SCHNAPPS
1081210.0,CREME DE ALMOND
1081500.0,TRIPLE SEC
1062400.0,
1011400.0,TENNESSEE WHISKIES
1081400.0,TRIPLE SEC
1011600.0,STRAIGHT RYE WHISKIES
1031080.0,VODKA 80 PROOF
1011700.0,
1022200.0,100% AGAVE TEQUILA
1051120.0,CHERRY BRANDIES
1041200.0,AMERICAN SLOE GINS
1081317.0,GRAPE SCHNAPPS
1062200.0,PUERTO RICO & VIRGIN ISLANDS RUM
1901200.0,SPECIAL ORDER ITEMS
1031110.0,LOW PROOF VODKA
1032200.0,IMPORTED FLAVORED VODKA
1031090.0,OTHER PROOF VODKA
1031200.0,AMERICAN FLAVORED VODKA
1081220.0,DARK CREME DE CACAO
1011600.0,CORN WHISKIES
1070000.0,COCKTAILS/RTD
1082000.0,IMPORTED CORDIALS & LIQUEURS
1081300.0,PEPPERMINT SCHNAPPS
1081312.0,BUTTERSCOTCH SCHNAPPS
1012210.0,SINGLE MALT SCOTCH
1082100.0,IMPORTED CORDIALS & LIQUEURS
1042100.0,IMPORTED DRY GINS
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY
1062300.0,FLAVORED RUM
1701100.0,TEMPORARY & SPECIALTY PACKAGES
1081390.0,IMPORTED SCHNAPPS
1031100.0,AMERICAN VODKAS
1011400.0,BOTTLED IN BOND BOURBON
1032000.0,IMPORTED VODKAS
1091100.0,
1051140.0,PEACH BRANDIES
1081000.0,AMERICAN CORDIALS & LIQUEURS
1051150.0,MISCELLANEOUS  BRANDIES
1011100.0,BLENDED WHISKIES
1011250.0,SINGLE BARREL BOURBON WHISKIES

2025-02-11 15:27:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:27:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:27:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:27:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 15:27:51 - snowflake.connector.connection - INFO - closed
2025-02-11 15:27:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:27:51 - root - INFO - SQL:
SELECT *
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   LIMIT 100;
Results:
Too long, hard cut:
invoice_and_item_number,date,store_number,store_name,address,city,zip_code,store_location,county_number,county,category,category_name,vendor_number,vendor_name,item_number,item_description,pack,bottle_volume_ml,state_bottle_cost,state_bottle_retail,bottles_sold,sale_dollars,volume_sold_liters,volume_sold_gallons
INV-50000500199,2022-08-02,2603,HY-VEE WINE AND SPIRITS / BETTENDORF,2890 DEVILS GLEN ROAD,BETTENDORF,52722.0,bytearray(b'\x01\x01\x00\x00\x00\xe2\x95$\xcf\xf5\x9eV\xc0\xc8\xd5\xc8\xae\xb4\xc6D@'),,SCOTT,1022200.0,100% AGAVE TEQUILA,395,PROXIMO,64933,1800 COCONUT,12,750,16.5,24.75,3,74.25,2.25,0.59
INV-44886700006,2022-02-18,4299,HOMETOWN MARKET / CENTRAL CITY,9 WATERHOUSE AVE,CENTRAL CITY,52214.0,bytearray(b'\x01\x01\x00\x00\x00\xd7O\xffY\xf3\xe1V\xc0\x9f\x1c\x05\x88\x82\x19E@'),57,LINN,1082200.0,IMPORTED SCHNAPPS,421,SAZERAC COMPANY  INC,65066,GOLDSCHLAGER CINNAMON SCHNAPPS,12,750,13.0,19.5,3,58.5,2.25,0.59
INV-58297800165,2023-05-10,2590,HY-VEE FOOD STORE #5 / CEDAR RAPIDS,3235 OAKLAND ROAD NE,CEDAR RAPIDS,52402.0,bytearray(b'\x01\x01\x00\x00\x00\xd8\xdb\xbbs9\xeaV\xc0\x00\xd9\xd1\xf6w\x01E@'),,LINN,1082200.0,IMPORTED SCHNAPPS,421,SAZERAC COMPANY  INC,65066,GOLDSCHLAGER CINNAMON SCHNAPPS,12,750,13.5,20.25,3,60.75,2.25,0.59
INV-72428100092,2024-07-22,2637,HY-VEE #5 / DAVENPORT,2351 W LOCUST,DAVENPORT,52804.0,bytearray(b'\x01\x01\x00\x00\x000+\xa7L0\xa7V\xc0\x91\x9b\x9a1\xb0\xc4D@'),,SCOTT,1082200.0,IMPORTED SCHNAPPS,421,SAZERAC COMPANY  INC,65066,GOLDSCHLAGER CINNAMON SCHNAPPS,12,750,13.5,20.25,3,60.75,2.25,0.59
INV-55500100015,2023-02-01,2558,HY-VEE FOOD STORE (1433) / MOUNT PLEASANT,1700 E WASHINGTON,MOUNT PLEASANT,52641.0,"bytearray(b'\x01\x01\x00\x00\x00o/i\x8c\xd6\xe1V\xc0lxz\xa5,{D@')",,HENRY,1082100.0,IMPORTED CORDIALS & LIQUEURS,619,CAMPARI AMERICA,65126,GRAND MARNIER CORDON ROUGE,12,750,23.0,34.5,3,103.5,2.25,0.59
INV-66967100018,2024-02-06,4255,FAREWAY STORES #058 / ORANGE CITY,512  8TH SE,ORANGE CITY,51041.0,bytearray(b'\x01\x01\x00\x00\x00\xf2\xda\x19dZ\x03X\xc0:\x91`\xaa\x99\x7fE@'),,SIOUX,1082100.0,IMPORTED CORDIALS & LIQUEURS,619,CAMPARI AMERICA,65126,GRAND MARNIER CORDON ROUGE,12,750,23.5,35.25,3,103.5,2.25,0.59
INV-52601300029,2022-10-31,3650,"SPIRITS, STOGIES AND STUFF",118 SOUTH MAIN ST.,HOLSTEIN,51025.0,bytearray(b'\x01\x01\x00\x00\x00\xa6C\xa7\xe7\xdd\xe2W\xc0\x82:\xe5\xd1\x8d>E@'),,IDA,1082100.0,IMPORTED CORDIALS & LIQUEURS,619,CAMPARI AMERICA,65126,GRAND MARNIER CORDON ROUGE,12,750,23.0,34.5,3,103.5,2.25,0.59
INV-72995900030,2024-08-07,10102,WORLD LIQUOR AND TOBACCO PLUS VAPORS /  CHEROKEE,114 SOUTH 2ND STREET,CHEROKEE,51012.0,bytearray(b'\x01\x01\x00\x00\x00\xf1\xbe/\xd0C\xe3W\xc0\x9c\\\x8e\x82\xe0_E@'),,CHEROKEE,1082100.0,IMPORTED CORDIALS & LIQUEURS,259,HEAVEN HILL BRANDS,65194,HPNOTIQ,12,375,7.5,11.25,6,63.0,2.25,0.59
INV-58944600049,2023-06-01,4725,CASEY'S GENERAL STORE #1548 / ANKENY,2905 W 1ST ST,ANKENY,50023.0,bytearray(b'\x01\x01\x00\x00\x00qi\xae3\xdbhW\xc0X\xb7\xb9\x1f\x9a\xddD@'),,POLK,1082100.0,IMPORTED CORDIALS & LIQUEURS,259,HEAVEN HILL BRANDS,65195,HPNOTIQ,6,750,12.0,18.0,3,54.0,2.25,0.59
INV-46334800012,2022-04-08,5925,FREDRICKSBURG FOOD CENTER,100 W MAIN ST,FREDERICKSBURG,50630.0,bytearray(b'\x01\x01\x00\x00\x00\xd8\xdbf*\xc4\x0cW\xc0\xae\xb7\xcdT\x88{E@'),19,CHICKASAW,1081200.0,CREAM LIQUEURS,300,MCCORMICK DISTILLING CO.,65200,TEQUILA ROSE LIQUEUR,12,750,11.5,17.25,3,51.75,2.25,0.59
INV-58882700047,2023-05-30,4269,TIPTON FAMILY FOODS,610 CEDAR ST,TIPTON,52772.0,"bytearray(b""\x01\x01\x00\x00\x00\xac\n\xcc\xf1\'\xc8V\xc0\xa894*\xc5\xe2D@"")",,CEDAR,1081200.0,CREAM LIQUEURS,300,MCCORMICK DISTILLING CO.,65200,TEQUILA ROSE LIQUEUR,12,750,12.5,18.75,3,56.25,2.25,0.59
INV-51700400025,2022-09-30,6303,WORLD LIQUOR & TOBACCO + VAPORS / DES MOINES,3200 SOUTHEAST 14TH STREET,DES MOINES,50320,bytearray(b'\x01\x01\x00\x00\x00b\x9d*\xdf3fW\xc0|\xf0\xda\xa5\r\xc7D@'),,POLK,1081200.0,CREAM LIQUEURS,300,MCCORMICK DISTILLING CO.,65200,TEQUILA ROSE LIQUEUR,12,750,12.5,18.75,3,56.25,2.25,0.59
INV-56631000005,2023-03-13,10035,LIQUOR TOBACCO & VAPE / CLINTON,122 SOUTH 2ND STREET,CLINTON,52732,bytearray(b'\x01\x01\x00\x00\x00k\x9f\x8e\xc7\x0c\x8cV\xc0\x15\x00\xe3\x194\xecD@'),,CLINTON,1082100.0,IMPORTED CORDIALS & LIQUEURS,192,"MAST-JAGERMEISTER US, INC",65254,JAGERMEISTER LIQUEUR,24,375,7.68,11.52,6,69.12,2.25,0.59
INV-61840700006,2023-09-01,4722,WALGREENS #09476 / BURLINGTON,201 S CENTRAL AVE,BURLINGTON,52601.0,bytearray(b'\x01\x01\x00\x00\x00\xe6D\x11\x0bB\xc7V\xc0\xaa\x9dajKgD@'),,DES MOINES,1082100.0,IMPORTED CORDIALS & LIQUEURS,192,"MAST-JAGERMEISTER US, INC",65254,JAGERMEISTER LIQUEUR,24,375,7.68,11.52,6,69.12,2.25,0.59
INV-73541700025,2024-08-23,6264,MLK LIQUOR LLC / DES MOINES,3424 MARTIN LUTHER KING JUNIOR PARKWAY,DES MOINES,50310.0,"bytearray(b""\x01\x01\x00\x00\x00\x12(#\xad\xbfiW\xc0\'\x1a\xa4\xe0)\xd0D@"")",,POLK,1082100.0,IMPORTED CORDIALS & LIQUEURS,192,"MAST-JAGERMEISTER US, INC",65254,JAGERMEISTER LIQUEUR,24,375,7.68,11.52,6,69.12,2.25,0.59
INV-73370100022,2024

2025-02-11 15:27:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:27:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:27:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:27:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 57
2025-02-11 15:27:52 - snowflake.connector.connection - INFO - closed
2025-02-11 15:27:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:27:53 - root - INFO - SQL:
SELECT "category", SUM("bottles_sold") AS "total_bottles_sold"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   GROUP BY "category"
   ORDER BY "total_bottles_sold" DESC
   LIMIT 100;
Results:
category,total_bottles_sold
1031100.0,17547955
1081600.0,11967870
1012100.0,8173740
1011200.0,4596736
1062400.0,3852972
1022200.0,2921968
1031200.0,2851618
1081400.0,2531079
1011100.0,2316625
1022100.0,2176287
1011400.0,1981355
1051100.0,1969307
1032100.0,1946590
1071000.0,1470706
1062500.0,1463377
1062200.0,1362966
1052100.0,1354991
1081300.0,1217234
1701100.0,1175307
1082100.0,1170433
1081200.0,1046003
1041100.0,972021
1082200.0,957833
1012400.0,956732
1092100.0,885389
1032200.0,749291
1042100.0,572572
1081500.0,561286
1012200.0,533417
1091300.0,532612
1071100.0,399626
1011600.0,365308
1081100.0,274028
1082000.0,260140
1091100.0,232261
1012300.0,212487
1901000.0,209270
1062100.0,206689
1011300.0,127435
1062300.0,124723
1091200.0,116228
1011500.0,108448
1041200.0,101892
1901200.0,67123
1022300.0,41970
1011700.0,27851
1700000.0,16242
1041300.0,8617
1032000.0,2404
1081000.0,2044
1092000.0,700
1031000.0,289
1091000.0,198
1090000.0,100
1042000.0,72
1070000.0,24
1012000.0,12

2025-02-11 15:27:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:27:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:27:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:27:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 15:27:54 - snowflake.connector.connection - INFO - closed
2025-02-11 15:27:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:27:54 - root - INFO - SQL:
SELECT DATE_TRUNC('month', "date") AS "month", "category", SUM("volume_sold_liters") AS "monthly_volume_liters"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   GROUP BY "month", "category"
   ORDER BY "month", "category"
   LIMIT 100;
Results:
month,category,monthly_volume_liters
2022-01-01,1011100.0,58176.44
2022-01-01,1011200.0,92011.67000000001
2022-01-01,1011300.0,1507.5
2022-01-01,1011400.0,30197.190000000002
2022-01-01,1011500.0,1507.5
2022-01-01,1011600.0,7415.780000000001
2022-01-01,1011700.0,349.85
2022-01-01,1012100.0,180763.57
2022-01-01,1012200.0,28549.509999999995
2022-01-01,1012300.0,5691.9
2022-01-01,1012400.0,20216.009999999995
2022-01-01,1022100.0,35947.30999999999
2022-01-01,1022200.0,34750.74999999999
2022-01-01,1022300.0,551.25
2022-01-01,1031000.0,143.64999999999998
2022-01-01,1031100.0,381361.1499999999
2022-01-01,1031200.0,46170.820000000014
2022-01-01,1032000.0,4.5
2022-01-01,1032100.0,41300.22999999999
2022-01-01,1032200.0,15887.25
2022-01-01,1041100.0,21860.83999999999
2022-01-01,1041200.0,677.2999999999998
2022-01-01,1041300.0,274.0
2022-01-01,1042000.0,18.0
2022-01-01,1042100.0,11226.01
2022-01-01,1051100.0,32754.750000000004
2022-01-01,1052100.0,12598.969999999998
2022-01-01,1062100.0,5789.070000000001
2022-01-01,1062200.0,35469.829999999994
2022-01-01,1062300.0,3004.0
2022-01-01,1062400.0,91831.70000000001
2022-01-01,1062500.0,30555.590000000004
2022-01-01,1070000.0,12.0
2022-01-01,1071100.0,44270.22
2022-01-01,1081100.0,6624.709999999997
2022-01-01,1081200.0,27799.109999999997
2022-01-01,1081300.0,17391.379999999997
2022-01-01,1081400.0,33701.16999999999
2022-01-01,1081500.0,10041.25
2022-01-01,1081600.0,89703.06000000001
2022-01-01,1082000.0,18824.57
2022-01-01,1082100.0,2525.5099999999993
2022-01-01,1082200.0,25046.16
2022-01-01,1090000.0,46.5
2022-01-01,1091000.0,36.0
2022-01-01,1091100.0,3599.3500000000004
2022-01-01,1091200.0,2180.0
2022-01-01,1091300.0,4657.750000000002
2022-01-01,1092000.0,4.5
2022-01-01,1092100.0,12293.97
2022-01-01,1700000.0,872.8500000000001
2022-01-01,1701100.0,26909.54
2022-01-01,1901200.0,12094.5
2022-02-01,1011100.0,57679.22
2022-02-01,1011200.0,90042.63000000002
2022-02-01,1011300.0,2340.0
2022-02-01,1011400.0,33219.51
2022-02-01,1011500.0,1920.25
2022-02-01,1011600.0,7916.829999999999
2022-02-01,1011700.0,372.75
2022-02-01,1012000.0,9.0
2022-02-01,1012100.0,232939.92
2022-02-01,1012200.0,14892.599999999997
2022-02-01,1012300.0,5445.900000000001
2022-02-01,1012400.0,32271.96999999999
2022-02-01,1022100.0,47175.04
2022-02-01,1022200.0,43229.89999999999
2022-02-01,1022300.0,1024.5
2022-02-01,1031000.0,67.5
2022-02-01,1031100.0,387203.72
2022-02-01,1031200.0,47006.86000000001
2022-02-01,1032100.0,47930.890000000014
2022-02-01,1032200.0,15670.260000000002
2022-02-01,1041100.0,24677.72
2022-02-01,1041200.0,628.5000000000001
2022-02-01,1041300.0,213.75
2022-02-01,1042100.0,14815.110000000006
2022-02-01,1051100.0,31344.240000000005
2022-02-01,1052100.0,19855.480000000007
2022-02-01,1062100.0,6643.880000000001
2022-02-01,1062200.0,41235.200000000004
2022-02-01,1062300.0,2691.5
2022-02-01,1062400.0,77545.32000000002
2022-02-01,1062500.0,33986.579999999994
2022-02-01,1071100.0,62950.78999999999
2022-02-01,1081000.0,63.0
2022-02-01,1081100.0,6417.930000000001
2022-02-01,1081200.0,26864.83
2022-02-01,1081300.0,16267.810000000007
2022-02-01,1081400.0,30248.469999999994
2022-02-01,1081500.0,12388.0
2022-02-01,1081600.0,81928.67000000004
2022-02-01,1082000.0,28668.83999999999
2022-02-01,1082100.0,2941.98
2022-02-01,1082200.0,26341.06
2022-02-01,1090000.0,27.0
2022-02-01,1091000.0,18.0
2022-02-01,1091100.0,3181.1499999999996
2022-02-01,1091200.0,2716.25
2022-02-01,1091300.0,4894.55

2025-02-11 15:27:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:27:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:27:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:27:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 33
2025-02-11 15:27:55 - snowflake.connector.connection - INFO - closed
2025-02-11 15:27:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:27:56 - root - INFO - SQL:
SELECT DATE_TRUNC('month', "date") AS "month", SUM("sale_dollars") AS "total_sales_dollars"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   GROUP BY "month"
   ORDER BY "month"
   LIMIT 100;
Results:
month,total_sales_dollars
2022-01-01,27597708.3
2022-02-01,29474100.930000003
2022-03-01,30225874.55
2022-04-01,34781761.59
2022-05-01,35948167.34
2022-06-01,38614152.41000001
2022-07-01,33792893.14
2022-08-01,41374068.24000001
2022-09-01,36622693.61000001
2022-10-01,39688632.57999998
2022-11-01,37513438.63
2022-12-01,43146512.17
2023-01-01,32547784.890000004
2023-02-01,32114831.480000004
2023-03-01,36403505.9
2023-04-01,32884344.37
2023-05-01,39684933.96999999
2023-06-01,41194749.13000001
2023-07-01,35838999.870000005
2023-08-01,39788043.98
2023-09-01,35096963.96000001
2023-10-01,40281758.90000001
2023-11-01,39289673.49
2023-12-01,40945072.58000001
2024-01-01,32972812.840000004
2024-02-01,35101475.449999996
2024-03-01,34164169.29
2024-04-01,36385547.870000005
2024-05-01,39359095.65
2024-06-01,36769358.27999999
2024-07-01,37563557.73
2024-08-01,36529981.19
2024-09-01,34410490.22

2025-02-11 15:27:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:27:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:27:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:27:57 - snowflake.connector.connection - INFO - closed
2025-02-11 15:27:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:28:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 15:28:32 - root - INFO - The error in your SQL query occurs because in some SQL dialects, including Snowflake, you cannot use a subquery directly within the `HAVING` clause in the way you've attempted. Specifically, the subquery in the `HAVING` clause is causing a syntax error.

To fix this issue, you can calculate the total volume of liquor sold since January 1, 2022, in a subquery and then use that value in your main query. Here's how you can adjust your query:

```sql
SELECT
  c."category",
  c."category_name",
  c."total_volume_liters"
FROM
  (
    SELECT
      "category",
      "category_name",
      SUM("volume_sold_liters") AS "total_volume_liters"
    FROM
      "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE
      "date" >= '2022-01-01'
    GROUP BY
      "category",
      "category_name"
  ) AS c
CROSS JOIN
  (
    SELECT
      SUM("volume_sold_liters") * 0.01 AS "one_percent_volume"
    FROM
      "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE
      "date" >= '2022-01-01'
  ) AS t
WHERE
  c."total_volume_liters" >= t."one_percent_volume"
ORDER BY
  c."total_volume_liters" DESC
LIMIT
  100;
```

**Explanation:**

- **Subquery `c`**: Calculates the total volume sold per category since January 1, 2022.
- **Subquery `t`**: Calculates 1% of the overall total volume sold since January 1, 2022.
- **CROSS JOIN**: Combines both subqueries so that the `one_percent_volume` can be compared with each category's total volume.
- **`WHERE` Clause**: Filters out categories that contribute less than 1% to the total volume.
- **Ordering and Limiting**: Orders the results by total volume in descending order and limits the output to 100 records.

**By restructuring the query this way, you avoid using a subquery directly within the `HAVING` clause, which resolves the syntax error.**

---

**Here's what the corrected query does:**

- **Calculates total volume per category**: This allows you to know how much each category has sold in terms of liters.
- **Calculates 1% of total volume**: This gives you the threshold that each category must meet or exceed.
- **Filters categories based on the threshold**: Only categories that have sold at least 1% of the total volume are included.
- **Provides the categories and their names**: So you can identify which categories meet the criteria.

**This should resolve the syntax errors and provide the desired results.**
2025-02-11 15:28:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:28:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:28:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:28:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 23
2025-02-11 15:28:33 - snowflake.connector.connection - INFO - closed
2025-02-11 15:28:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:29:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 15:29:30 - root - INFO - SQL:
SELECT
  c."category",
  c."category_name",
  c."total_volume_liters"
FROM
  (
    SELECT
      "category",
      "category_name",
      SUM("volume_sold_liters") AS "total_volume_liters"
    FROM
      "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE
      "date" >= '2022-01-01'
    GROUP BY
      "category",
      "category_name"
  ) AS c
CROSS JOIN
  (
    SELECT
      SUM("volume_sold_liters") * 0.01 AS "one_percent_volume"
    FROM
      "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE
      "date" >= '2022-01-01'
  ) AS t
WHERE
  c."total_volume_liters" >= t."one_percent_volume"
ORDER BY
  c."total_volume_liters" DESC
LIMIT
  100;
Results:
category,category_name,total_volume_liters
1031100.0,AMERICAN VODKAS,15645738.359999996
1012100.0,CANADIAN WHISKIES,7888910.250000001
1062400.0,SPICED RUM,3769932.2400000007
1011200.0,STRAIGHT BOURBON WHISKIES,3661763.7800000003
1081600.0,WHISKEY LIQUEUR,2996627.110000001
1022200.0,100% AGAVE TEQUILA,2033489.7700000003
1031200.0,AMERICAN FLAVORED VODKA,2000078.39
1071000.0,COCKTAILS/RTD,1976413.39
1032100.0,IMPORTED VODKAS,1964598.2199999993
1011100.0,BLENDED WHISKIES,1924959.8900000001
1022100.0,MIXTO TEQUILA,1673871.5000000002
1062200.0,WHITE RUM,1415858.47
1011400.0,TENNESSEE WHISKIES,1408056.17
1062500.0,FLAVORED RUM,1348587.1199999996
1081400.0,AMERICAN SCHNAPPS,1268049.6599999997
1051100.0,AMERICAN BRANDIES,1014426.1400000002
1701100.0,TEMPORARY & SPECIALTY PACKAGES,894384.3700000002
1081200.0,CREAM LIQUEURS,892286.9799999997
1082200.0,IMPORTED SCHNAPPS,852297.6999999997
1082100.0,IMPORTED CORDIALS & LIQUEURS,851256.7600000002
1041100.0,AMERICAN DRY GINS,808267.27
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,801322.54
1012400.0,IRISH WHISKIES,801182.62

2025-02-11 15:29:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:29:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:29:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:29:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 57
2025-02-11 15:29:31 - snowflake.connector.connection - INFO - closed
2025-02-11 15:29:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:29:32 - root - INFO - SQL:
SELECT "category", "category_name", COUNT(DISTINCT DATE_TRUNC('month', "date")) AS "months_with_sales"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   GROUP BY "category", "category_name"
   ORDER BY "months_with_sales" DESC
   LIMIT 100;
Results:
category,category_name,months_with_sales
1012100.0,CANADIAN WHISKIES,33
1031100.0,AMERICAN VODKAS,33
1062200.0,WHITE RUM,33
1032200.0,IMPORTED FLAVORED VODKA,33
1011700.0,CORN WHISKIES,33
1031200.0,AMERICAN FLAVORED VODKA,33
1011500.0,BOTTLED IN BOND BOURBON,33
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,33
1011400.0,TENNESSEE WHISKIES,33
1012200.0,SCOTCH WHISKIES,33
1022300.0,MEZCAL,33
1062100.0,GOLD RUM,33
1082200.0,IMPORTED SCHNAPPS,33
1062400.0,SPICED RUM,33
1052100.0,IMPORTED BRANDIES,33
1012300.0,SINGLE MALT SCOTCH,33
1011300.0,SINGLE BARREL BOURBON WHISKIES,33
1011600.0,STRAIGHT RYE WHISKIES,33
1082100.0,IMPORTED CORDIALS & LIQUEURS,33
1042100.0,IMPORTED DRY GINS,33
1081500.0,TRIPLE SEC,33
1081400.0,AMERICAN SCHNAPPS,33
1022200.0,100% AGAVE TEQUILA,33
1081200.0,CREAM LIQUEURS,33
1091200.0,NEUTRAL GRAIN SPIRITS,33
1041200.0,FLAVORED GIN,33
1041300.0,AMERICAN SLOE GINS,33
1011100.0,BLENDED WHISKIES,33
1051100.0,AMERICAN BRANDIES,33
1062300.0,AGED DARK RUM,33
1011200.0,STRAIGHT BOURBON WHISKIES,33
1032100.0,IMPORTED VODKAS,33
1081600.0,WHISKEY LIQUEUR,33
1081100.0,COFFEE LIQUEURS,33
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,33
1022100.0,MIXTO TEQUILA,33
1012400.0,IRISH WHISKIES,33
1701100.0,TEMPORARY & SPECIALTY PACKAGES,33
1041100.0,AMERICAN DRY GINS,33
1062500.0,FLAVORED RUM,33
1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,33
1081300.0,AMERICAN CORDIALS & LIQUEURS,33
1901000.0,SPECIAL ORDER ITEMS,27
1082000.0,IMPORTED CORDIALS & LIQUEURS,27
1071000.0,COCKTAILS/RTD,27
1032000.0,IMPORTED VODKAS,19
1081000.0,AMERICAN CORDIALS & LIQUEURS,19
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY,16
1901200.0,SPECIAL ORDER ITEMS,7
1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,7
1700000.0,TEMPORARY & SPECIALTY PACKAGES,7
1071100.0,COCKTAILS/RTD,7
1090000.0,DISTILLED SPIRITS SPECIALTY,3
1042000.0,IMPORTED GINS,3
1070000.0,COCKTAILS/RTD,2
1031000.0,AMERICAN VODKAS,2
1012000.0,IMPORTED WHISKIES,1

2025-02-11 15:29:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:29:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:29:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:29:33 - snowflake.connector.connection - INFO - closed
2025-02-11 15:29:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:29:52 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 15:29:52 - root - INFO - The error you're encountering occurs because the alias `sub` in your query doesn't include the `"category_name"` column. As a result, the outer query cannot reference `"category_name"` since it doesn't exist in the subquery's result set.

**Explanation:**

- In the subquery `sub`, you're selecting only `"category"` and `monthly_volume`.
- You're grouping by `"category"` and `DATE_TRUNC('month', "date")`, but not by `"category_name"`.
- Since `"category_name"` is not selected in the subquery, it's not available for the outer query to use, leading to the `invalid identifier '"category_name"'` error.

**To fix this issue**, you need to:

1. Include `"category_name"` in the SELECT clause of the subquery.
2. Add `"category_name"` to the GROUP BY clause within the subquery.

Here is the corrected SQL query:

```sql
SELECT
  "category",
  "category_name",
  AVG(monthly_volume) AS "average_monthly_volume"
FROM (
  SELECT
    "category",
    "category_name",
    SUM("volume_sold_liters") AS monthly_volume
  FROM
    "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
  WHERE
    "date" >= '2022-01-01'
  GROUP BY
    "category",
    "category_name",
    DATE_TRUNC('month', "date")
) sub
GROUP BY
  "category",
  "category_name"
ORDER BY
  "average_monthly_volume" DESC
LIMIT 100;
```

**Explanation of the Corrected Query:**

- **Subquery `sub`:**
  - **SELECT Clause:** Now includes `"category_name"` along with `"category"` and `SUM("volume_sold_liters") AS monthly_volume`.
  - **GROUP BY Clause:** Includes `"category"`, `"category_name"`, and `DATE_TRUNC('month', "date")` to aggregate monthly volumes per category and category name.
- **Outer Query:**
  - Calculates the average monthly volume (`AVG(monthly_volume)`) for each `"category"` and `"category_name"`.
  - Groups by `"category"` and `"category_name"` to get averages per category.
  - Orders the results by `"average_monthly_volume"` in descending order.

**By including `"category_name"` in the subquery and grouping appropriately, the outer query can now reference it without errors.**

---

**Additional Notes:**

- **Assurance of Correctness:** Including `"category_name"` ensures that you're calculating the average monthly volume for each unique category and its corresponding name.
- **Maintaining Data Integrity:** Grouping by both `"category"` and `"category_name"` prevents any mismatches if there are categories sharing the same code but different names due to data inconsistencies.

**I hope this helps resolve the error and gives you the desired results!**
2025-02-11 15:29:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:29:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:29:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:29:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 57
2025-02-11 15:29:54 - snowflake.connector.connection - INFO - closed
2025-02-11 15:29:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:30:43 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 15:30:43 - root - INFO - SQL:
SELECT
  "category",
  "category_name",
  AVG(monthly_volume) AS "average_monthly_volume"
FROM (
  SELECT
    "category",
    "category_name",
    SUM("volume_sold_liters") AS monthly_volume
  FROM
    "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
  WHERE
    "date" >= '2022-01-01'
  GROUP BY
    "category",
    "category_name",
    DATE_TRUNC('month', "date")
) sub
GROUP BY
  "category",
  "category_name"
ORDER BY
  "average_monthly_volume" DESC
LIMIT 100;
Results:
category,category_name,average_monthly_volume
1031100.0,AMERICAN VODKAS,474113.28363636363
1012100.0,CANADIAN WHISKIES,239057.88636363638
1062400.0,SPICED RUM,114240.37090909087
1011200.0,STRAIGHT BOURBON WHISKIES,110962.5387878788
1081600.0,WHISKEY LIQUEUR,90806.88212121211
1071100.0,COCKTAILS/RTD,81444.53285714285
1071000.0,COCKTAILS/RTD,73200.49592592592
1022200.0,100% AGAVE TEQUILA,61620.902121212115
1031200.0,AMERICAN FLAVORED VODKA,60608.43606060606
1032100.0,IMPORTED VODKAS,59533.2793939394
1011100.0,BLENDED WHISKIES,58332.11787878787
1022100.0,MIXTO TEQUILA,50723.37878787878
1062200.0,WHITE RUM,42904.80212121212
1011400.0,TENNESSEE WHISKIES,42668.36878787879
1062500.0,FLAVORED RUM,40866.276363636345
1081400.0,AMERICAN SCHNAPPS,38425.74727272727
1051100.0,AMERICAN BRANDIES,30740.186060606058
1701100.0,TEMPORARY & SPECIALTY PACKAGES,27102.556666666664
1081200.0,CREAM LIQUEURS,27038.999393939393
1082200.0,IMPORTED SCHNAPPS,25827.203030303026
1082100.0,IMPORTED CORDIALS & LIQUEURS,25795.659393939382
1041100.0,AMERICAN DRY GINS,24492.947575757575
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,24282.501212121202
1012400.0,IRISH WHISKIES,24278.261212121215
1052100.0,IMPORTED BRANDIES,19022.36515151515
1032200.0,IMPORTED FLAVORED VODKA,17680.80212121212
1012200.0,SCOTCH WHISKIES,17297.46575757576
1081500.0,TRIPLE SEC,16761.083333333332
1081300.0,AMERICAN CORDIALS & LIQUEURS,16609.013636363637
1042100.0,IMPORTED DRY GINS,16545.878181818185
1901200.0,SPECIAL ORDER ITEMS,14980.602857142858
1901000.0,SPECIAL ORDER ITEMS,10960.257037037036
1011600.0,STRAIGHT RYE WHISKIES,8529.675757575757
1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,8361.324242424243
1081100.0,COFFEE LIQUEURS,7055.785757575757
1062100.0,GOLD RUM,6871.060909090909
1082000.0,IMPORTED CORDIALS & LIQUEURS,6524.17148148148
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,5011.4236363636355
1012300.0,SINGLE MALT SCOTCH,4974.880303030302
1062300.0,AGED DARK RUM,3089.3090909090906
1700000.0,TEMPORARY & SPECIALTY PACKAGES,3030.06
1011300.0,SINGLE BARREL BOURBON WHISKIES,2898.0227272727275
1011500.0,BOTTLED IN BOND BOURBON,2825.5621212121214
1091200.0,NEUTRAL GRAIN SPIRITS,2682.730303030303
1041200.0,FLAVORED GIN,2307.5454545454545
1022300.0,MEZCAL,956.0969696969697
1011700.0,CORN WHISKIES,605.8227272727273
1041300.0,AMERICAN SLOE GINS,259.1515151515151
1032000.0,IMPORTED VODKAS,107.86842105263158
1031000.0,AMERICAN VODKAS,105.575
1081000.0,AMERICAN CORDIALS & LIQUEURS,67.21578947368421
1090000.0,DISTILLED SPIRITS SPECIALTY,25.0
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY,23.374999999999996
1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,21.214285714285715
1042000.0,IMPORTED GINS,18.0
1070000.0,COCKTAILS/RTD,12.0
1012000.0,IMPORTED WHISKIES,9.0

2025-02-11 15:30:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:30:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:30:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:30:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 15:30:45 - snowflake.connector.connection - INFO - closed
2025-02-11 15:30:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:30:45 - root - INFO - SQL:
SELECT
     "month",
     "category",
     "category_name",
     ("monthly_volume_liters" / "total_volume_liters") * 100 AS "percentage_contribution"
   FROM (
     SELECT
       DATE_TRUNC('month', "date") AS "month",
       "category",
       "category_name",
       SUM("volume_sold_liters") AS "monthly_volume_liters"
     FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
     WHERE "date" >= '2022-01-01'
     GROUP BY "month", "category", "category_name"
   ) vol
   INNER JOIN (
     SELECT
       DATE_TRUNC('month', "date") AS "month",
       SUM("volume_sold_liters") AS "total_volume_liters"
     FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
     WHERE "date" >= '2022-01-01'
     GROUP BY "month"
   ) total_vol USING ("month")
   ORDER BY "month", "percentage_contribution" DESC
   LIMIT 100;
Results:
Too long, hard cut:
month,category,category_name,percentage_contribution
2022-01-01,1031100.0,AMERICAN VODKAS,24.333948386444774
2022-01-01,1012100.0,CANADIAN WHISKIES,11.53418847863632
2022-01-01,1011200.0,STRAIGHT BOURBON WHISKIES,5.87109418127827
2022-01-01,1062400.0,SPICED RUM,5.859610629030986
2022-01-01,1081600.0,WHISKEY LIQUEUR,5.723786054626066
2022-01-01,1011100.0,BLENDED WHISKIES,3.7121308457012487
2022-01-01,1031200.0,AMERICAN FLAVORED VODKA,2.946074477800983
2022-01-01,1071100.0,COCKTAILS/RTD,2.824800713278097
2022-01-01,1032100.0,IMPORTED VODKAS,2.635291154246567
2022-01-01,1022100.0,MIXTO TEQUILA,2.293731247064705
2022-01-01,1062200.0,WHITE RUM,2.263264132951064
2022-01-01,1022200.0,100% AGAVE TEQUILA,2.2173809704796774
2022-01-01,1081400.0,AMERICAN SCHNAPPS,2.150409215366592
2022-01-01,1051100.0,AMERICAN BRANDIES,2.090019908716192
2022-01-01,1062500.0,FLAVORED RUM,1.9496955837724113
2022-01-01,1011400.0,TENNESSEE WHISKIES,1.9268267438244984
2022-01-01,1012200.0,SCOTCH WHISKIES,1.821691335885391
2022-01-01,1081200.0,CREAM LIQUEURS,1.7738097022444488
2022-01-01,1701100.0,TEMPORARY & SPECIALTY PACKAGES,1.7170478887610106
2022-01-01,1082200.0,IMPORTED SCHNAPPS,1.5981490634760194
2022-01-01,1041100.0,AMERICAN DRY GINS,1.3948996961130604
2022-01-01,1012400.0,IRISH WHISKIES,1.2899461413934046
2022-01-01,1082000.0,IMPORTED CORDIALS & LIQUEURS,1.2011609330866997
2022-01-01,1081300.0,AMERICAN CORDIALS & LIQUEURS,1.1097117346353922
2022-01-01,1032200.0,IMPORTED FLAVORED VODKA,1.0137359862234125
2022-01-01,1052100.0,IMPORTED BRANDIES,0.8039169320272034
2022-01-01,1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,0.7844554471384947
2022-01-01,1901200.0,SPECIAL ORDER ITEMS,0.7717276360212789
2022-01-01,1042100.0,IMPORTED DRY GINS,0.7163108982803125
2022-01-01,1081500.0,TRIPLE SEC,0.6407135578319622
2022-01-01,1011600.0,STRAIGHT RYE WHISKIES,0.4731871816655404
2022-01-01,1081100.0,COFFEE LIQUEURS,0.42271047067894696
2022-01-01,1062100.0,GOLD RUM,0.36938983057271507
2022-01-01,1012300.0,SINGLE MALT SCOTCH,0.3631895929116142
2022-01-01,1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,0.29720239750945576
2022-01-01,1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,0.22966785453827693
2022-01-01,1062300.0,AGED DARK RUM,0.19167967411698886
2022-01-01,1082100.0,IMPORTED CORDIALS & LIQUEURS,0.16114811377469918
2022-01-01,1091200.0,NEUTRAL GRAIN SPIRITS,0.13910176084388673
2022-01-01,1011500.0,BOTTLED IN BOND BOURBON,0.09619078186796295
2022-01-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,0.09619078186796295
2022-01-01,1700000.0,TEMPORARY & SPECIALTY PACKAGES,0.05569494126265437
2022-01-01,1041200.0,FLAVORED GIN,0.04321725808236901
2022-01-01,1022300.0,MEZCAL,0.03517424113082227
2022-01-01,1011700.0,CORN WHISKIES,0.022323280289556775
2022-01-01,1041300.0,AMERICAN SLOE GINS,0.017483432326249982
2022-01-01,1031000.0,AMERICAN VODKAS,0.009166040341846022
2022-01-01,1090000.0,DISTILLED SPIRITS SPECIALTY,0.0029670788436884097
2022-01-01,1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,0.0022970932983394136
2022-01-01,1042000.0,IMPORTED GINS,0.0011485466491697068
2022-01-01,1070000.0,COCKTAILS/RTD,0.0007656977661131379
2022-01-01,1032000.0,IMPORTED VODKAS,0.0002871366622924267
2022-01-01,1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY,0.0002871366622924267
2022-02-01,1031100.0,AMERICAN VODKAS,23.265532323033693
2022-02-01,1012100.0,CANADIAN WHISKIES,13.996433810307613
2022-02-01,1011200.0,STRAIGHT BOURBON WHISKIES,5.410303699344529
2022-02-01,1081600.0,WHISKEY LIQUEUR,4.922768097548652
2022-02-01,1062400.0,SPICED RUM,4.659390020736345
2022-02-01,1071100.0,COCKTAILS/RTD,3.78246272919461
2022-02-01,1011100.0,BLENDED WHISKIES,3.465715043433392
2022-02-01,1032100.0,IMPORTED VODKAS,2.87997664528319
2022-02-01,1022100.0,MIXTO TEQUILA,2.8345606234372114
2022-02-01,1031200.0,AMERICAN FLAVORED VODKA,2.8244553557861476
2022-02-01,1022200.0,100% AGAVE TEQUILA,2.5975128435530364
2022-02-01,1062200.0,WHITE RUM,2.477659249882101
2022-02-01,1062500.0,FLAVORED RUM,2.0421184887876866
2022-02-01,1011400.0,TENNESSEE WHISKIES,1.996028301743436
2022-02-01,1012400.0,IRISH WHISKIES,1.9390943898033153
2022-02-01,1051100.0,AMERICAN BRANDIES,1.8833507820145052
2022-02-01,1081400.0,AMERICAN SCHNAPPS,1.817510318618103
2022-02-01,1082000.0,IMPORTED CORDIALS & LIQUEURS,1.722596631261396
2022-02-01,1081200.0,CREAM LIQUEURS,1.614200841659799
2022-02-01,1082200.0,IMPORTED SCHNAPPS,1.582729584449679
2022-02-01,1041100.0,AMERICAN DRY GINS,1.4827860959568646
2022-02-01,1052100.0,IMPORTED BRANDIES,1.1930368637195659
2022-02-01,1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,1.0863391051788498
2022-02-01,1081300.0,AMERICAN CORDIALS & LIQUEURS,0.9774680351210745
2022-02-01,1701100.0,TEMPORARY & SPECIALTY PACKAGES,0.9501763617961252
2022-02-01,1032200.0,IMPORTED FLAVORED VODKA,0.9415636310011225
2022-02-01,1012200.0,SCOTCH WHISKIES,0.8948371329542274
2022-02-01,1042100.0,IMPORTED DRY GINS,0.8901810668923836
2022-02-01,1081500.0,TRIPLE SEC,0.7443456752371629
2022-02-01,1011600.0,STRAIGHT RYE WHISKIES

2025-02-11 15:30:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:30:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:30:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:30:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 15:30:46 - snowflake.connector.connection - INFO - closed
2025-02-11 15:30:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:30:47 - root - INFO - SQL:
SELECT DATE_TRUNC('month', "date") AS "month", "category", "category_name", SUM("volume_sold_liters") AS "monthly_volume_liters"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01'
    GROUP BY "month", "category", "category_name"
    ORDER BY "category", "month"
    LIMIT 100;
Results:
Too long, hard cut:
month,category,category_name,monthly_volume_liters
2022-01-01,1011100.0,BLENDED WHISKIES,58176.43999999999
2022-02-01,1011100.0,BLENDED WHISKIES,57679.219999999994
2022-03-01,1011100.0,BLENDED WHISKIES,55020.28999999999
2022-04-01,1011100.0,BLENDED WHISKIES,65683.95999999999
2022-05-01,1011100.0,BLENDED WHISKIES,58072.57
2022-06-01,1011100.0,BLENDED WHISKIES,71310.53000000001
2022-07-01,1011100.0,BLENDED WHISKIES,56114.90000000001
2022-08-01,1011100.0,BLENDED WHISKIES,69279.48000000003
2022-09-01,1011100.0,BLENDED WHISKIES,62558.90999999999
2022-10-01,1011100.0,BLENDED WHISKIES,59852.11000000002
2022-11-01,1011100.0,BLENDED WHISKIES,61036.799999999996
2022-12-01,1011100.0,BLENDED WHISKIES,64280.51999999999
2023-01-01,1011100.0,BLENDED WHISKIES,59537.960000000014
2023-02-01,1011100.0,BLENDED WHISKIES,50495.08999999999
2023-03-01,1011100.0,BLENDED WHISKIES,62095.63
2023-04-01,1011100.0,BLENDED WHISKIES,50343.83000000001
2023-05-01,1011100.0,BLENDED WHISKIES,59986.05
2023-06-01,1011100.0,BLENDED WHISKIES,63184.71999999999
2023-07-01,1011100.0,BLENDED WHISKIES,50654.759999999995
2023-08-01,1011100.0,BLENDED WHISKIES,55137.44
2023-09-01,1011100.0,BLENDED WHISKIES,55882.289999999986
2023-10-01,1011100.0,BLENDED WHISKIES,57235.87
2023-11-01,1011100.0,BLENDED WHISKIES,58030.62
2023-12-01,1011100.0,BLENDED WHISKIES,61930.92
2024-01-01,1011100.0,BLENDED WHISKIES,56964.109999999964
2024-02-01,1011100.0,BLENDED WHISKIES,61376.63
2024-03-01,1011100.0,BLENDED WHISKIES,57105.62999999999
2024-04-01,1011100.0,BLENDED WHISKIES,56393.26999999997
2024-05-01,1011100.0,BLENDED WHISKIES,56952.99000000001
2024-06-01,1011100.0,BLENDED WHISKIES,53904.67
2024-07-01,1011100.0,BLENDED WHISKIES,54958.96000000001
2024-08-01,1011100.0,BLENDED WHISKIES,55400.24999999998
2024-09-01,1011100.0,BLENDED WHISKIES,48322.46999999998
2022-01-01,1011200.0,STRAIGHT BOURBON WHISKIES,92011.67
2022-02-01,1011200.0,STRAIGHT BOURBON WHISKIES,90042.63000000002
2022-03-01,1011200.0,STRAIGHT BOURBON WHISKIES,96255.12000000001
2022-04-01,1011200.0,STRAIGHT BOURBON WHISKIES,111162.0
2022-05-01,1011200.0,STRAIGHT BOURBON WHISKIES,106571.83000000002
2022-06-01,1011200.0,STRAIGHT BOURBON WHISKIES,107202.46
2022-07-01,1011200.0,STRAIGHT BOURBON WHISKIES,100378.09999999999
2022-08-01,1011200.0,STRAIGHT BOURBON WHISKIES,126854.78999999998
2022-09-01,1011200.0,STRAIGHT BOURBON WHISKIES,106896.45
2022-10-01,1011200.0,STRAIGHT BOURBON WHISKIES,140560.49000000002
2022-11-01,1011200.0,STRAIGHT BOURBON WHISKIES,102490.94000000003
2022-12-01,1011200.0,STRAIGHT BOURBON WHISKIES,132734.63000000006
2023-01-01,1011200.0,STRAIGHT BOURBON WHISKIES,101561.92000000001
2023-02-01,1011200.0,STRAIGHT BOURBON WHISKIES,100771.81999999998
2023-03-01,1011200.0,STRAIGHT BOURBON WHISKIES,108885.08
2023-04-01,1011200.0,STRAIGHT BOURBON WHISKIES,99841.95999999999
2023-05-01,1011200.0,STRAIGHT BOURBON WHISKIES,117759.85999999997
2023-06-01,1011200.0,STRAIGHT BOURBON WHISKIES,121726.93
2023-07-01,1011200.0,STRAIGHT BOURBON WHISKIES,99810.36000000003
2023-08-01,1011200.0,STRAIGHT BOURBON WHISKIES,126254.05000000002
2023-09-01,1011200.0,STRAIGHT BOURBON WHISKIES,108074.86999999995
2023-10-01,1011200.0,STRAIGHT BOURBON WHISKIES,124033.26
2023-11-01,1011200.0,STRAIGHT BOURBON WHISKIES,114805.63999999998
2023-12-01,1011200.0,STRAIGHT BOURBON WHISKIES,134280.03000000003
2024-01-01,1011200.0,STRAIGHT BOURBON WHISKIES,106868.07
2024-02-01,1011200.0,STRAIGHT BOURBON WHISKIES,105023.97000000002
2024-03-01,1011200.0,STRAIGHT BOURBON WHISKIES,106167.47999999998
2024-04-01,1011200.0,STRAIGHT BOURBON WHISKIES,111954.72999999995
2024-05-01,1011200.0,STRAIGHT BOURBON WHISKIES,116640.11999999998
2024-06-01,1011200.0,STRAIGHT BOURBON WHISKIES,112871.89999999997
2024-07-01,1011200.0,STRAIGHT BOURBON WHISKIES,111245.77999999998
2024-08-01,1011200.0,STRAIGHT BOURBON WHISKIES,110951.26999999996
2024-09-01,1011200.0,STRAIGHT BOURBON WHISKIES,109073.56999999999
2022-01-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,1507.5
2022-02-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,2340.0
2022-03-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,1623.75
2022-04-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,2307.75
2022-05-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,2653.5
2022-06-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,1830.0
2022-07-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,2046.75
2022-08-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,3618.75
2022-09-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,1696.5
2022-10-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,2419.5
2022-11-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,2785.5
2022-12-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,3280.5
2023-01-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,2583.0
2023-02-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,1794.0
2023-03-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,3140.25
2023-04-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,1726.5
2023-05-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,2452.5
2023-06-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,2786.25
2023-07-

2025-02-11 15:30:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:30:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:30:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:30:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-02-11 15:30:48 - snowflake.connector.connection - INFO - closed
2025-02-11 15:30:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:30:48 - root - INFO - SQL:
SELECT "category", "category_name", SUM("sale_dollars") AS "total_sales_dollars"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01'
    GROUP BY "category", "category_name"
    ORDER BY "total_sales_dollars" DESC
    LIMIT 10;
Results:
category,category_name,total_sales_dollars
1031100.0,AMERICAN VODKAS,179745485.1200001
1012100.0,CANADIAN WHISKIES,132576922.83
1011200.0,STRAIGHT BOURBON WHISKIES,103185787.80999999
1022200.0,100% AGAVE TEQUILA,85464658.23000002
1081600.0,WHISKEY LIQUEUR,71569310.75
1062400.0,SPICED RUM,59913495.670000024
1011400.0,TENNESSEE WHISKIES,45330463.41999998
1701100.0,TEMPORARY & SPECIALTY PACKAGES,32814181.100000005
1032100.0,IMPORTED VODKAS,32765618.359999996
1031200.0,AMERICAN FLAVORED VODKA,31694810.599999987

2025-02-11 15:30:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:30:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:30:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:30:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 15:30:50 - snowflake.connector.connection - INFO - closed
2025-02-11 15:30:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:30:50 - root - INFO - SQL:
SELECT *
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "category_name" IS NULL
    LIMIT 100;
Results:
Too long, hard cut:
invoice_and_item_number,date,store_number,store_name,address,city,zip_code,store_location,county_number,county,category,category_name,vendor_number,vendor_name,item_number,item_description,pack,bottle_volume_ml,state_bottle_cost,state_bottle_retail,bottles_sold,sale_dollars,volume_sold_liters,volume_sold_gallons
INV-05515400005,2017-06-14,2603,HY-VEE WINE AND SPIRITS / BETTENDORF,2890 DEVILS GLEN ROAD,BETTENDORF,52722.0,bytearray(b'\x01\x01\x00\x00\x00\xb8\x02\n\xf5\xf4\x9eV\xc0E+\xf7\x02\xb3\xc6D@'),82,SCOTT,,,259,HEAVEN HILL BRANDS,927114,HA PIKESVILLE RYE 110PRF,6,750,24.96,37.44,3,112.32,2.25,0.59
INV-01329300036,2016-11-02,4669,VOM FASS / DES MOINES,"833, 42ND ST",DES MOINES,50312,bytearray(b'\x01\x01\x00\x00\x00\x86<\x82\x1b)kW\xc0`\xb7\x08\x8c\xf5\xcbD@'),77,POLK,,,885.0,YAHARA BAY DISTILLERS INC,987873,GRAPEFRUIT LIQUEUR,3,750,25.36,38.04,3,114.12,2.25,0.59
INV-15020700109,2018-10-12,3963,TOBACCO HUT #14 / COUNCIL BLUFFS,1925 W BROADWAY,COUNCIL BLUFFS,51501,bytearray(b'\x01\x01\x00\x00\x00R\x81\x93m\xe0\xf7W\xc0\x98\xf78\xd3\x84\xa1D@'),78,POTTAWATTAMIE,,,55,SAZERAC NORTH AMERICA,84197,99 PINEAPPLE MINI,10,600,6.0,9.0,4,36.0,2.4,0.63
INV-18059100123,2019-03-11,2613,HY-VEE FOOD STORE #1 / COUNCIL BLUFFS,2323 W BROADWAY,COUNCIL BLUFFS,51501,"bytearray(b'\x01\x01\x00\x00\x00,b\xd8aL\xf8W\xc0\x9d\x80&\xc2\x86\xa1D@')",78,POTTAWATTAMIE,,,55,SAZERAC NORTH AMERICA,84197,99 PINEAPPLE MINI,10,600,6.0,9.0,4,36.0,2.4,0.63
INV-00856800001,2016-10-10,4277,CORK IT!,769 PROSPECT ST SW,LE MARS,51031,bytearray(b'\x01\x01\x00\x00\x00\xa7!\xaa\xf0g\x0bX\xc0\x00\x02\xd6\xaa]cE@'),75,PLYMOUTH,,,370.0,PERNOD RICARD USA,160,CHIVAS REGAL 12YR W/50ML CHIVAS EXTRA & CHIVAS 18YR,6,850,17.49,26.24,3,78.72,2.55,0.67
INV-00693900156,2016-10-04,3495,GREAT PASTIMES,228 N MAIN ST,MONTICELLO,52310,bytearray(b'\x01\x01\x00\x00\x00R*\xe1\t\xbd\xcbV\xc0\x90\\7\xa5\xbc\x1eE@'),53,JONES,,,115.0,CONSTELLATION BRANDS INC,10549,BLACK VELVET TOASTED CARAMEL MINI DISCO,10,600,7.12,10.68,5,53.4,3.0,0.79
INV-00477600005,2016-09-22,2544,HY-VEE FOOD STORE / MARSHALLTOWN,802 SOUTH CENTER,MARSHALLTOWN,50158,bytearray(b'\x01\x01\x00\x00\x00\xe7\x8e\xfe\x97k:W\xc0|k`\xab\x04\x05E@'),64,MARSHALL,,,115,CONSTELLATION BRANDS INC,10549,BLACK VELVET TOASTED CARAMEL MINI DISCO,10,600,7.12,10.68,5,53.4,3.0,0.79
INV-01319400001,2016-11-01,2597,HY-VEE FOOD STORE / CHEROKEE,1300 N. SECOND,CHEROKEE,51012,bytearray(b'\x01\x01\x00\x00\x00\xa6\xd0y\x8d]\xe3W\xc0\x1e\xfc\xc4\x01\xf4aE@'),18,CHEROKEE,,,300.0,MCCORMICK DISTILLING CO.,2313,MCCORMICK EGG NOG W/2 GLASSES,6,750,8.49,12.74,4,50.96,3.0,0.79
INV-01315800001,2016-11-01,5230,POINT LIQUOR & TOBACCO,,,,,,,,,300,MCCORMICK DISTILLING CO.,2313,MCCORMICK EGG NOG W/2 GLASSES,6,750,8.49,12.74,4,50.96,3.0,0.79
INV-02301800008,2016-12-21,2536,HY-VEE / PLEASANT HILL,4815 MAPLE DRIVE,PLEASANT HILL,50317,bytearray(b'\x01\x01\x00\x00\x00\x89`\x1c\\:aW\xc0\xbd8\xf1\xd5\x8e\xccD@'),77,POLK,,,125.0,CEDAR RIDGE VINEYARDS LL,27849,CEDAR RIDGE RESERVE BOURBON,6,750,25.47,38.21,4,150.0,3.0,0.79
S30780800019,2016-02-17,3896,SMOKIN' JOE'S #18 TOBACCO AND LIQUOR,1901 BROADWAY ST,IOWA CITY,52240,bytearray(b'\x01\x01\x00\x00\x008\xf6\xec\xb9L\xe1V\xc0\xee\x9a\x90\xd6\x18\xd2D@'),52,JOHNSON,1032100.0,,115,"CONSTELLATION WINE COMPANY, INC.",34820,SVEDKA VODKA,12,750,8.25,12.38,4,49.52,3.0,0.79
S07038600019,2012-08-09,4057,TEQUILA'S LIQUOR STORE,1434 DES MOINES ST STE 5,DES MOINES,50316,bytearray(b'\x01\x01\x00\x00\x00\xd9\x99B\xe75fW\xc0\xc5\xc0:\x8e\x1f\xccD@'),77,POLK,1022200.0,,85,BROWN-FORMAN CORPORATION,3657,HERRADURA GOLD REPOSADO 6PAK,6,750,19.59,30.89,4,123.56,3.0,0.79
S30912900135,2016-02-24,2625,HY-VEE WINE AND SPIRITS #2,3301 W KIMBERLY RD,DAVENPORT,52804,,82,SCOTT,1062500.0,,305,MHW LTD,42204,BLUE CHAIR BAY BANANA,12,750,9.42,14.13,4,56.52,3.0,0.79
S33145900036,2016-06-30,5029,THE LIQUOR STOP LLC,"211, W 53RD ST",DAVENPORT,52806,bytearray(b'\x01\x01\x00\x00\x00<s\x0f\t\xdf\xa4V\xc0\xf5/Ie\x8a\xc9D@'),82,SCOTT,1062400.0,,240,"WILLIAM GRANT AND SONS, INC.",45886,SAILOR JERRY SPICED NAVY RUM,12,750,9.65,14.48,4,57.92,3.0,0.79
S32896100041,2016-06-16,2616,HY-VEE FOOD AND DRUG / CLINTON,901 SOUTH 4TH ST,CLINTON,52732,bytearray(b'\x01\x01\x00\x00\x005]Ot]\x8cV\xc0~Xo\xd4\n\xebD@'),23,CLINTON,1062400.0,,240,"WILLIAM GRANT AND SONS, INC.",45886,SAILOR JERRY SPICED NAVY RUM,12,750,9.65,14.48,4,57.92,3.0,0.79
S30476300098,2016-02-01,2560,HY-VEE FOOD STORE / MARION,3600 BUSINESS HWY 151 EAST,MARION,52302,,57,LINN,1082100.0,,420,"MOET HENNESSY USA, INC.",65126,GRAND MARNIER CORDON ROUGE,12,750,23.31,34.97,4,139.88,3.0,0.79
INV-02251200003,2016-12-20,3417,BIG G FOOD STORE,PO BOX 261  310 W DILLON,MARENGO,52301,,48,IOWA,,,421.0,SAZERAC COMPANY  INC,76436,OLD ST. NICK'S EGG NOG,12,750,3.64,5.46,4,21.84,3.0,0.79
INV-07658800158,2017-10-04,2616,HY-VEE FOOD AND DRUG / CLINTON,901 SOUTH 4TH ST,CLINTON,52732,bytearray(b'\x01\x01\x00\x00\x005]Ot]\x8cV\xc0~Xo\xd4\n\xebD@'),23,CLINTON,,,305,MHW LTD,80024,BLUE CHAIR BAY BANANA RUM CREAM,12,750,9.42,

2025-02-11 15:30:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:30:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:30:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:30:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-11 15:30:51 - snowflake.connector.connection - INFO - closed
2025-02-11 15:30:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:31:06 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 15:31:06 - root - INFO - ```sql
SELECT *
FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
WHERE "category_name" ILIKE '%VODKA%'
  AND "date" >= '2022-01-01'
LIMIT 100;
```
2025-02-11 15:31:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:31:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:31:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:31:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 15:31:07 - snowflake.connector.connection - INFO - closed
2025-02-11 15:31:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:32:00 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 15:32:00 - root - INFO - SQL:
SELECT *
FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
WHERE "category_name" ILIKE '%VODKA%'
  AND "date" >= '2022-01-01'
LIMIT 100;
Results:
Too long, hard cut:
invoice_and_item_number,date,store_number,store_name,address,city,zip_code,store_location,county_number,county,category,category_name,vendor_number,vendor_name,item_number,item_description,pack,bottle_volume_ml,state_bottle_cost,state_bottle_retail,bottles_sold,sale_dollars,volume_sold_liters,volume_sold_gallons
INV-69572400250,2024-04-25,10389,HOME TOWN WINE AND SPIRIT / KEOKUK,1501 MAIN STREET,KEOKUK,52632.0,bytearray(b'\x01\x01\x00\x00\x00\x81&4\xdc\x0f\xd9V\xc0\xfa\xe0\xc1\xbe\xb93D@'),,LEE,1032100.0,IMPORTED VODKAS,260,DIAGEO AMERICAS,73094,CIROC LIMONATA,12,750,16.49,24.74,3,74.22,2.25,0.59
INV-60481000066,2023-07-19,2555,HY-VEE FOOD STORE (1324) / KEOKUK,3111 MAIN,KEOKUK,52632.0,bytearray(b'\x01\x01\x00\x00\x00\x84\x9b;\xe3\xc3\xd9V\xc0kb\xf3\x04Q5D@'),,LEE,1032200.0,IMPORTED FLAVORED VODKA,260,DIAGEO AMERICAS,75165,KETEL ONE BOTANICAL CUCUMBER & MINT,12,750,11.33,17.0,3,51.0,2.25,0.59
INV-52831100131,2022-11-08,2603,HY-VEE WINE AND SPIRITS / BETTENDORF,2890 DEVILS GLEN ROAD,BETTENDORF,52722.0,bytearray(b'\x01\x01\x00\x00\x00\x05\x86\xacn\xf5\x9eV\xc0.\xcf\x83\xbb\xb3\xc6D@'),,SCOTT,1032200.0,IMPORTED FLAVORED VODKA,260,DIAGEO AMERICAS,75165,KETEL ONE BOTANICAL CUCUMBER & MINT,12,750,11.33,17.0,3,51.0,2.25,0.59
INV-57333500022,2023-04-07,3465,HOMETOWN FOODS / PANORA,601 E MAIN,PANORA,50216.0,bytearray(b'\x01\x01\x00\x00\x00\x18\xd3\xd62\xe0\x96W\xc00\x1b\x95\xef\xa7\xd8D@'),,GUTHRIE,1032200.0,IMPORTED FLAVORED VODKA,260,DIAGEO AMERICAS,75181,KETEL ONE BOTANICAL GRAPEFRUIT & ROSE,12,750,11.33,17.0,3,51.0,2.25,0.59
INV-50049600229,2022-08-04,2538,HY-VEE FOOD STORE #3 / WATERLOO,1422 FLAMMANG DR,WATERLOO,50702.0,bytearray(b'\x01\x01\x00\x00\x00Cq\xc7\x9b\xfc\x14W\xc0\x04\x18\x96?\xdf:E@'),,BLACK HAWK,1032200.0,IMPORTED FLAVORED VODKA,260,DIAGEO AMERICAS,75181,KETEL ONE BOTANICAL GRAPEFRUIT & ROSE,12,750,11.33,17.0,3,51.0,2.25,0.59
INV-66644200059,2024-01-26,10333,"FAREWAY STORES, INC. #077B / NORWALK",2200 SUNSET DRIVE,NORWALK,50211.0,bytearray(b'\x01\x01\x00\x00\x00r1\xd1\xe3!kW\xc0.\xc15\xb9\x90\xbeD@'),,WARREN,1032200.0,IMPORTED FLAVORED VODKA,260,DIAGEO AMERICAS,75181,KETEL ONE BOTANICAL GRAPEFRUIT & ROSE,12,750,11.33,17.0,3,51.0,2.25,0.59
INV-73292400011,2024-08-16,4252,FAREWAY STORES #840 / MONTICELLO,433 NORTH FARLEY STREET,MONTICELLO,52310.0,"bytearray(b""\x01\x01\x00\x00\x00\x7fk\'JB\xccV\xc0\xfa\x8d\xe60\xee\x1eE@"")",,JONES,1032200.0,IMPORTED FLAVORED VODKA,260,DIAGEO AMERICAS,75183,KETEL ONE BOTANICAL PEACH & ORANGE BLOSSOM,12,750,11.33,17.0,3,51.0,2.25,0.59
INV-54668600244,2023-01-05,2572,HY-VEE FOOD STORE / CEDAR FALLS,6301 UNIVERSITY,CEDAR FALLS,50613,bytearray(b'\x01\x01\x00\x00\x00\xf2\x07\x03\xcf\xbd\x1bW\xc0\xe9\xc1\xddY\xbbAE@'),,BLACK HAWK,1032200.0,IMPORTED FLAVORED VODKA,260,DIAGEO AMERICAS,75183,KETEL ONE BOTANICAL PEACH & ORANGE BLOSSOM,12,750,11.33,17.0,3,51.0,2.25,0.59
INV-61012100014,2023-08-07,4230,FAREWAY STORES #106 / CLIVE,10151 UNIVERSITY AVE,CLIVE,50325.0,bytearray(b'\x01\x01\x00\x00\x00\xe7.\xb7\xebmpW\xc0\xa3\x85\x82T5\xcdD@'),,POLK,1032200.0,IMPORTED FLAVORED VODKA,260,DIAGEO AMERICAS,75183,KETEL ONE BOTANICAL PEACH & ORANGE BLOSSOM,12,750,11.33,17.0,3,51.0,2.25,0.59
INV-68534400106,2024-03-24,4169,SUPER QUICK 2 / HUBBELL,1824 HUBBELL AVE,DES MOINES,50317.0,bytearray(b'\x01\x01\x00\x00\x00\xe6\xb2P\xb9\x89eW\xc0\xabO\xf0OT\xccD@'),,POLK,1031200.0,AMERICAN FLAVORED VODKA,772,INTERCONTINENTAL PACKAGING COMPANY/PRESTIGE BEVERAGE GROUP,75198,KINKY BLUE,6,750,10.0,15.0,3,45.0,2.25,0.59
INV-65577700075,2023-12-22,2524,HY-VEE FOOD STORE #1 (1159) / DUBUQUE,3500 DODGE ST,DUBUQUE,52001.0,bytearray(b'\x01\x01\x00\x00\x00u(}\x006\xaeV\xc0\xae\xad\xd0\xee\xad>E@'),,DUBUQUE,1031200.0,AMERICAN FLAVORED VODKA,772,INTERCONTINENTAL PACKAGING COMPANY/PRESTIGE BEVERAGE GROUP,75198,KINKY BLUE,6,750,10.0,15.0,3,45.0,2.25,0.59
INV-57485400032,2023-04-12,2653,HY-VEE WINE AND SPIRITS / WASHINGTON,1004 W MADISON ST,WASHINGTON,52353.0,bytearray(b'\x01\x01\x00\x00\x00p\xed\x1b\xca\x16\xedV\xc0@b^.\xff\xa5D@'),,WASHINGTON,1031200.0,AMERICAN FLAVORED VODKA,772,INTERCONTINENTAL PACKAGING COMPANY/PRESTIGE BEVERAGE GROUP,75198,KINKY BLUE,6,750,10.0,15.0,3,45.0,2.25,0.59
INV-68915000076,2024-04-05,2618,HY-VEE DRUGSTORE #6 / CEDAR RAPIDS,505 BOYSON RD NE,CEDAR RAPIDS,52402.0,bytearray(b'\x01\x01\x00\x00\x00\xd3H]\xc8\xe9\xe8V\xc0\x1b:\x82\xc3\xe7\x05E@'),,LINN,1031200.0,AMERICAN FLAVORED VODKA,772,INTERCONTINENTAL PACKAGING COMPANY/PRESTIGE BEVERAGE GROUP,75198,KINKY BLUE,6,750,10.0,15.0,3,45.0,2.25,0.59
INV-57318500021,2023-04-07,6311,LIGHTNING LIQUOR AND SMOKE SHOP - BURLINGTON,624 ANGULAR STREET,BURLINGTON,52601.0,bytearray(b'\x01\x01\x00\x00\x00\xf4\xffeO\xe6\xc6V\xc0QZ:\xe4\xbbfD@'),,DES MOINES,1031200.0,AMERICAN FLAVORED VODKA,772,INTERCONTINENTAL PACKAGING COMPANY/PRESTIGE BEVERAGE GROUP,75210,KINKY PINK,6,750,10.0,15.0,3,45.0,2.25,0.59
INV-64369400031,2023-11-16,4511,SUPER QUICK / SE 30 DM,303 SE 30TH ST,DES MOINES,50317.0,bytearray(b'\x01\x01\x00\x00\x00\xd9\xcc\xec\xb6\xb5cW\xc0\xa6sM\x9a\x

2025-02-11 15:32:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:32:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:32:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:32:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 15:32:02 - snowflake.connector.connection - INFO - closed
2025-02-11 15:32:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:32:02 - root - INFO - SQL:
SELECT "store_number", "store_name", SUM("sale_dollars") AS "total_sales_dollars"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01'
    GROUP BY "store_number", "store_name"
    ORDER BY "total_sales_dollars" DESC
    LIMIT 100;
Results:
Too long, hard cut:
store_number,store_name,total_sales_dollars
2633,HY-VEE #3 / BDI / DES MOINES,40326490.22999999
4829,CENTRAL CITY 2,37179568.260000005
5916,ANOTHER ROUND / DEWITT,17450182.919999998
3773,BENZ DISTRIBUTING,13706848.05
2512,HY-VEE WINE AND SPIRITS #1 (1281) / IOWA CITY,10665945.850000003
3814,COSTCO WHOLESALE #788 / WDM,10576299.34
5102,WILKIE LIQUORS,10005976.930000002
4312,I-80 LIQUOR / COUNCIL BLUFFS,9988231.03
6242,WALL TO WALL WINE AND SPIRITS / WEST DES MOINES,9899922.169999996
3420,SAM'S CLUB 6344 / WINDSOR HEIGHTS,8598921.799999999
3385,SAM'S CLUB 8162 / CEDAR RAPIDS,8239790.3100000005
2663,HY-VEE FOOD STORE / URBANDALE,7671482.069999997
2670,HY-VEE FOOD STORE / CORALVILLE,6856516.610000001
4677,COSTCO WHOLESALE #1111 / CORALVILLE,6813402.389999999
3494,SAM'S CLUB 6514 / WATERLOO,6506959.360000002
2647,HY-VEE #7 / CEDAR RAPIDS,6489704.799999997
3447,SAM'S CLUB 6432 / SIOUX CITY,6480574.040000001
5144,SAM'S CLUB 6979 / ANKENY,6350959.9799999995
2665,HY-VEE / WAUKEE,6181162.099999998
2190,"CENTRAL CITY LIQUOR, INC.",5964593.790000001
2603,HY-VEE WINE AND SPIRITS / BETTENDORF,5931172.979999999
3354,SAM'S CLUB 8238 / DAVENPORT,5888910.680000002
2619,HY-VEE WINE AND SPIRITS / WDM,5872963.469999999
2614,HY-VEE #3 FOOD & DRUGSTORE / DAVENPORT,5838720.389999999
2512,HY-VEE WINE AND SPIRITS / IOWA CITY,5818034.62
2666,HY-VEE FOOD STORE #2 / STATE ANKENY,5307621.789999999
3477,SAM'S CLUB 6472 / COUNCIL BLUFFS,5157638.560000001
3944,SAM'S CLUB 4973 / DUBUQUE,5140687.95
2648,HY-VEE #4 / WDM,4904259.020000001
2629,HY-VEE FOOD STORE #2 / COUNCIL BLUFFS,4890856.760000001
5666,COSTCO WHOLESALE #1325 / DAVENPORT,4864606.949999999
6144,NORTHSIDE LIQUOR AND GROCERY / MASON CITY,4709774.75
3524,SAM'S CLUB 6568 / AMES,4687341.4399999995
2625,HY-VEE WINE & SPIRITS #2 / DAVENPORT,4669665.31
2590,HY-VEE FOOD STORE #5 / CEDAR RAPIDS,4511021.020000001
2635,HY-VEE #4 / DAVENPORT,4346947.080000001
2675,HY-VEE #2 / CORALVILLE,4346597.999999999
6209,HY-VEE / GRIMES,4195115.610000001
2501,HY-VEE  #2 (1018) / AMES,4194726.5
2201,HAPPY'S WINE & SPIRITS WHOLESALE,4124747.6799999997
10074,COSTCO WHOLESALE #1630 / ANKENY,4122018.8200000003
2130,SYCAMORE CONVENIENCE,4110776.590000001
2644,HY-VEE FORT DODGE WINE AND SPIRITS,4110255.149999999
2502,HY-VEE WINE AND SPIRITS (1022) / ANKENY,3941422.7400000007
2191,KEOKUK SPIRITS,3883023.7000000007
3390,OKOBOJI AVENUE LIQUOR,3860382.8600000003
2613,HY-VEE FOOD STORE #1 / COUNCIL BLUFFS,3816352.810000001
5444,MARSHALL BEER WINE SPIRITS,3737499.6800000006
2593,HY-VEE FOOD STORE / CARROLL,3649611.6400000006
2573,HY-VEE FOOD STORE / MUSCATINE,3603199.6300000004
2621,HY-VEE FOOD STORE #3 / SIOUX CITY,3595022.73
4988,HAPPY'S WINE & SPIRITS,3586230.529999999
2616,HY-VEE FOOD AND DRUG / CLINTON,3527226.0000000005
2572,HY-VEE FOOD STORE / CEDAR FALLS,3525822.3599999994
2624,HY-VEE #2 / DUBUQUE,3514604.040000001
5293,THE BOONEDOCKS,3391781.079999999
2515,HY-VEE FOOD STORE #1 (1410) / MASON CITY,3380027.4099999997
3820,"CHARLIE'S WINE AND SPIRITS,",3373055.860000001
2623,HY-VEE FOOD STORE #4 / SIOUX CITY,3325432.690000001
2651,HY-VEE / WAVERLY,3205212.6399999997
2548,HY-VEE FOOD STORE (1011) / ALTOONA,3072236.0199999996
4129,CYCLONE LIQUORS,3018019.1799999992
10065,MADELLA WINE AND SPIRITS / BETTENDORF,2954133.43
2561,HY-VEE FOOD STORE (1148) / FLEUR / DSM,2884695.710000001
2524,HY-VEE FOOD STORE #1 (1159) / DUBUQUE,2866904.3100000005
2642,HY-VEE WINE AND SPIRITS / PELLA,2822847.0700000003
5351,DOWNTOWN LIQUOR,2774202.859999999
2594,HY-VEE FOOD STORE / SIOUX CITY,2751908.429999999
2637,HY-VEE #5 / DAVENPORT,2751044.3100000005
2588,HY-VEE FOOD AND DRUG #6 / CEDAR RAPIDS,2688203.8800000004
2605,HY-VEE DRUGSTORE #5 / CEDAR RAPIDS,2635556.3700000006
2622,HY-VEE FOOD STORE / IOWA CITY,2635068.860000001
2620,HY-VEE / WINDSOR HEIGHTS,2629670.029999999
4969,LAKE LIQUORS WINE AND SPIRITS,2610844.3699999987
2587,HY-VEE FOOD STORE / JOHNSTON,2565506.229999999
2626,HY-VEE DRUGSTORE / UNIVERSITY / DSM,2549828.21
2106,HILLSTREET NEWS AND TOBACCO,2413762.0299999993
2560,HY-VEE FOOD STORE (1396) / MARION,2356853.9499999997
2528,HY-VEE FOOD STORE #3 (1142) / DES MOINES,2333466.5199999996
2549,HY-VEE FOOD STORE (1271) / INDIANOLA,2316761.98
2506,HY-VEE #2 (1044) / BURLINGTON,2290721.13
5257,MAD AVE QUIK SHOP,2290007.8200000003
2465,SID'S BEVERAGE SHOP,2237728.1399999997
2527,HY-VEE FOOD STORE #5 (1151) / DES MOINES,2221500.150000001
2538,HY-VEE FOOD STORE #3 (1866) / WATERLOO,2181047.9000000004
2649,HY-VEE #3 / DUBUQUE,2167209.8200000003
3525,WINES AND SPIRITS / WASHINGTON,2161043.4499999997
2582,HY-VEE #2 FOOD STORE / MASON CITY,2152686.4899999998
2606,HY-VEE WINE AND SPIRITS / HUMBOLDT,2140696.51
2643,HY-VEE WINE AND SPIRITS / WATERLOO,2130183.380000001
5600,H & A MINI MART,2112290.9699999997
3868,WAL-MART 3630 / MARION,2107462.81
2285,JOHN'S GROCERY,2084236.24
2591,HY-VEE WINE AND SPIRITS / ATLANTIC,2083075.0
2501,HY-VEE  #2 / AMES,2065575.3400000003
6316,BEER THIRTY CARROLL / CARROLL,2059999.6499999994
2502,HY-VEE WINE

2025-02-11 15:32:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:32:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:32:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:32:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-11 15:32:03 - snowflake.connector.connection - INFO - closed
2025-02-11 15:32:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:32:04 - root - INFO - SQL:
SELECT "category", "category_name", AVG("bottle_volume_ml") AS "average_bottle_volume_ml"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    GROUP BY "category", "category_name"
    ORDER BY "average_bottle_volume_ml" DESC
    LIMIT 100;
Results:
category,category_name,average_bottle_volume_ml
1070100.0,TEMPORARY & SPECIALTY PACKAGES,1750.000000
1011600.0,CORN WHISKIES,1727.393617
1071100.0,COCKTAILS/RTD,1540.303140
1071100.0,AMERICAN COCKTAILS,1534.270711
1082015.0,IMPORTED AMARETTO,1500.000000
1071000.0,COCKTAILS/RTD,1442.910303
1070000.0,COCKTAILS/RTD,1395.929622
1031100.0,100 PROOF VODKA,1109.822545
1062100.0,GOLD RUM,1097.438011
1062200.0,PUERTO RICO & VIRGIN ISLANDS RUM,1085.194030
1031080.0,VODKA 80 PROOF,1061.283861
1012200.0,SCOTCH WHISKIES,1044.534654
1032100.0,,1044.502408
1062200.0,WHITE RUM,1040.868368
1031000.0,AMERICAN VODKAS,1018.684359
1032230.0,IMPORTED VODKA - CHERRY,1000.000000
1041100.0,AMERICAN DRY GINS,998.367829
1041300.0,AMERICAN SLOE GINS,996.834374
1081350.0,SPEARMINT SCHNAPPS,986.936475
1011100.0,BLENDED WHISKIES,976.203366
1031100.0,AMERICAN VODKAS,969.776211
1062310.0,SPICED RUM,967.431829
1081500.0,TRIPLE SEC,951.311398
1012100.0,CANADIAN WHISKIES,950.260301
1062400.0,,934.073107
1081010.0,AMERICAN AMARETTO,933.372410
1062400.0,SPICED RUM,932.615184
1081340.0,ROOT BEER SCHNAPPS,928.745869
1042100.0,IMPORTED DRY GINS,926.669565
1081400.0,TRIPLE SEC,923.974470
1032080.0,IMPORTED VODKAS,908.981047
1081300.0,PEPPERMINT SCHNAPPS,906.561400
1032000.0,IMPORTED VODKAS,903.424486
1081317.0,GRAPE SCHNAPPS,902.062251
1051110.0,BLACKBERRY BRANDIES,899.345380
1081365.0,TROPICAL FRUIT SCHNAPPS,895.340098
1081330.0,PEACH SCHNAPPS,894.398659
1081370.0,WATERMELON SCHNAPPS,893.510424
1032100.0,IMPORTED VODKAS,884.866278
1062500.0,FLAVORED RUM,868.847493
1081390.0,IMPORTED SCHNAPPS,860.562180
1011200.0,STRAIGHT BOURBON WHISKIES,852.199285
1041200.0,AMERICAN SLOE GINS,849.507284
1701100.0,DECANTERS & SPECIALTY PACKAGES,846.418831
1062300.0,FLAVORED RUM,845.862229
1081335.0,RASPBERRY SCHNAPPS,844.722496
1081305.0,APPLE SCHNAPPS,843.252787
,,839.385236
1901000.0,SPECIAL ORDER ITEMS,836.613561
1012300.0,IRISH WHISKIES,831.883628
1011500.0,BOTTLED IN BOND BOURBON,830.888770
1081312.0,BUTTERSCOTCH SCHNAPPS,829.374044
1062300.0,AGED DARK RUM,818.575172
1081315.0,CINNAMON SCHNAPPS,810.165153
1081030.0,COFFEE LIQUEURS,808.121316
1062100.0,JAMAICA RUM,806.940084
1031200.0,VODKA FLAVORED,805.275096
1701200.0,HOLIDAY VAP,802.083333
1081380.0,MISCELLANEOUS SCHNAPPS,802.080309
1031090.0,OTHER PROOF VODKA,800.618011
1081100.0,COFFEE LIQUEURS,799.827897
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,799.662372
1081200.0,CREAM LIQUEURS,796.458882
1901100.0,DELISTED ITEMS,793.650794
1901200.0,SPECIAL ORDER ITEMS,793.349474
1082200.0,IMPORTED SCHNAPPS,776.305061
1081700.0,DISTILLED SPIRITS SPECIALTY,774.934001
1012400.0,IRISH WHISKIES,774.717846
1012300.0,SINGLE MALT SCOTCH,768.618506
1091200.0,NEUTRAL GRAIN SPIRITS,768.219432
1022100.0,TEQUILA,767.853542
1031110.0,LOW PROOF VODKA,765.335463
1012210.0,SINGLE MALT SCOTCH,762.496099
1011600.0,STRAIGHT RYE WHISKIES,757.595643
1051100.0,APRICOT BRANDIES,757.323613
1022100.0,MIXTO TEQUILA,756.995549
1011400.0,BOTTLED IN BOND BOURBON,756.895746
1012400.0,JAPANESE WHISKY,756.818182
1011300.0,TENNESSEE WHISKIES,756.579017
1022200.0,,755.136187
1022300.0,MEZCAL,753.561010
1101100.0,AMERICAN ALCOHOL,752.324340
1081210.0,CREME DE ALMOND,751.379522
1041150.0,FLAVORED GINS,751.255204
1011300.0,SINGLE BARREL BOURBON WHISKIES,750.738310
1081250.0,WHITE CREME DE MENTHE,750.203335
1081220.0,DARK CREME DE CACAO,750.189653
1081240.0,GREEN CREME DE MENTHE,750.069747
1042000.0,IMPORTED GINS,750.000000
1082010.0,AMARETTO - IMPORTED,750.000000
1081100.0,,750.000000
1081500.0,ROCK & RYE,750.000000
1081355.0,STRAWBERRY SCHNAPPS,750.000000
1900000.0,DELISTED / SPECIAL ORDER ITEMS,750.000000
1091400.0,IOWA DISTILLERIES,750.000000
1089290.0,,750.000000
1022300.0,,750.000000
1062250.0,,750.000000
1012000.0,IMPORTED WHISKIES,750.000000
101220.0,,750.000000

2025-02-11 15:32:04 - root - INFO - itercount: 0
2025-02-11 15:32:04 - root - INFO - Database Name: IOWA_LIQUOR_SALES
Schema Name: IOWA_LIQUOR_SALES
,0
table_name,SALES
description,
DDL,"create or replace TABLE SALES (
	""invoice_and_item_number"" VARCHAR(16777216),
	""date"" DATE,
	""store_number"" VARCHAR(16777216),
	""store_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""zip_code"" VARCHAR(16777216),
	""store_location"" BINARY(8388608),
	""county_number"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""category"" VARCHAR(16777216),
	""category_name"" VARCHAR(16777216),
	""vendor_number"" VARCHAR(16777216),
	""vendor_name"" VARCHAR(16777216),
	""item_number"" VARCHAR(16777216),
	""item_description"" VARCHAR(16777216),
	""pack"" NUMBER(38,0),
	""bottle_volume_ml"" NUMBER(38,0),
	""state_bottle_cost"" FLOAT,
	""state_bottle_retail"" FLOAT,
	""bottles_sold"" NUMBER(38,0),
	""sale_dollars"" FLOAT,
	""volume_sold_liters"" FLOAT,
	""volume_sold_gallons"" FLOAT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'IOWA_LIQUOR_SALES': {'IOWA_LIQUOR_SALES': ['SALES']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **"date"**: Used to filter sales data from January 1, 2022, through the last fully completed month.
- **"category"**: Used to identify liquor category codes.
- **"category_name"**: Provides the names of the liquor categories.
- **"bottles_sold"**: Used to calculate the sales volume per category.
- **"sale_dollars"**: Used to calculate total sales in dollars per category.
- **"volume_sold_liters"**: Used to measure the sales volume in liters per category.
- **"volume_sold_gallons"**: Alternative measure of sales volume in gallons.
- **"store_name"**: Could be used to identify sales distribution across different stores.
- **"item_description"**: Provides details about the liquor items sold.
- **"vendor_name"**: May help in identifying sales associated with different vendors.

**SQL Queries to Explore the Data:**

1. **View distinct liquor categories and their names:**
   ```sql
   SELECT DISTINCT "category", "category_name"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   LIMIT 100;
   ```

2. **Fetch sales records from January 1, 2022, onwards:**
   ```sql
   SELECT *
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   LIMIT 100;
   ```

3. **List total bottles sold per category since January 1, 2022:**
   ```sql
   SELECT "category", SUM("bottles_sold") AS "total_bottles_sold"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   GROUP BY "category"
   ORDER BY "total_bottles_sold" DESC
   LIMIT 100;
   ```

4. **Get monthly sales volume in liters per category:**
   ```sql
   SELECT DATE_TRUNC('month', "date") AS "month", "category", SUM("volume_sold_liters") AS "monthly_volume_liters"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   GROUP BY "month", "category"
   ORDER BY "month", "category"
   LIMIT 100;
   ```

5. **Calculate total sales dollars per month for all categories:**
   ```sql
   SELECT DATE_TRUNC('month', "date") AS "month", SUM("sale_dollars") AS "total_sales_dollars"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   GROUP BY "month"
   ORDER BY "month"
   LIMIT 100;
   ```

6. **Identify categories contributing at least 1% to total monthly volume:**
   ```sql
   SELECT "category", "category_name", SUM("volume_sold_liters") AS "total_volume_liters"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   GROUP BY "category", "category_name"
   HAVING SUM("volume_sold_liters") >= 0.01 * (SELECT SUM("volume_sold_liters") FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES" WHERE "date" >= '2022-01-01")
   ORDER BY "total_volume_liters" DESC
   LIMIT 100;
   ```

7. **Check the number of months each category has sales data since January 1, 2022:**
   ```sql
   SELECT "category", "category_name", COUNT(DISTINCT DATE_TRUNC('month', "date")) AS "months_with_sales"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   GROUP BY "category", "category_name"
   ORDER BY "months_with_sales" DESC
   LIMIT 100;
   ```

8. **Retrieve average monthly sales volume per category:**
   ```sql
   SELECT "category", "category_name", AVG(monthly_volume) AS "average_monthly_volume"
   FROM (
     SELECT "category", SUM("volume_sold_liters") AS monthly_volume
     FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
     WHERE "date" >= '2022-01-01'
     GROUP BY "category", DATE_TRUNC('month', "date")
   ) sub
   GROUP BY "category", "category_name"
   ORDER BY "average_monthly_volume" DESC
   LIMIT 100;
   ```

9. **Extract the monthly percentage contribution of each category to total sales volume:**
   ```sql
   SELECT
     "month",
     "category",
     "category_name",
     ("monthly_volume_liters" / "total_volume_liters") * 100 AS "percentage_contribution"
   FROM (
     SELECT
       DATE_TRUNC('month', "date") AS "month",
       "category",
       "category_name",
       SUM("volume_sold_liters") AS "monthly_volume_liters"
     FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
     WHERE "date" >= '2022-01-01'
     GROUP BY "month", "category", "category_name"
   ) vol
   INNER JOIN (
     SELECT
       DATE_TRUNC('month', "date") AS "month",
       SUM("volume_sold_liters") AS "total_volume_liters"
     FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
     WHERE "date" >= '2022-01-01'
     GROUP BY "month"
   ) total_vol USING ("month")
   ORDER BY "month", "percentage_contribution" DESC
   LIMIT 100;
   ```

10. **List categories with their monthly sales volumes across months:**
    ```sql
    SELECT DATE_TRUNC('month', "date") AS "month", "category", "category_name", SUM("volume_sold_liters") AS "monthly_volume_liters"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01'
    GROUP BY "month", "category", "category_name"
    ORDER BY "category", "month"
    LIMIT 100;
    ```

11. **Find top 10 categories by total sales dollars since January 1, 2022:**
    ```sql
    SELECT "category", "category_name", SUM("sale_dollars") AS "total_sales_dollars"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01'
    GROUP BY "category", "category_name"
    ORDER BY "total_sales_dollars" DESC
    LIMIT 10;
    ```

12. **Check for any missing or null category names:**
    ```sql
    SELECT *
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "category_name" IS NULL
    LIMIT 100;
    ```

13. **Retrieve sales data for a specific category (e.g., Vodka):**
    ```sql
    SELECT *
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "category_name" = 'VODKA'
    AND "date" >= '2022-01-01'
    LIMIT 100;
    ```

14. **List all stores and their total sales since January 1, 2022:**
    ```sql
    SELECT "store_number", "store_name", SUM("sale_dollars") AS "total_sales_dollars"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01'
    GROUP BY "store_number", "store_name"
    ORDER BY "total_sales_dollars" DESC
    LIMIT 100;
    ```

15. **Find the average bottle volume sold per category:**
    ```sql
    SELECT "category", "category_name", AVG("bottle_volume_ml") AS "average_bottle_volume_ml"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    GROUP BY "category", "category_name"
    ORDER BY "average_bottle_volume_ml" DESC
    LIMIT 100;
    ```

These queries are designed to explore the dataset by examining sales volumes, identifying key liquor categories, and understanding sales trends over time from January 1, 2022, onwards. By analyzing the results of these queries, we can gain insights into category contributions, monthly sales patterns, and prepare for further analysis such as calculating Pearson correlation coefficients between categories.Query:
SELECT DISTINCT "category", "category_name"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   LIMIT 100;
Answer:
category,category_name
1011700.0,CORN WHISKIES
1012300.0,SINGLE MALT SCOTCH
1701200.0,HOLIDAY VAP
1012100.0,CANADIAN WHISKIES
1022100.0,TEQUILA
1081300.0,AMERICAN CORDIALS & LIQUEURS
1081335.0,RASPBERRY SCHNAPPS
1081250.0,WHITE CREME DE MENTHE
1091400.0,IOWA DISTILLERIES
1011500.0,STRAIGHT RYE WHISKIES
1081500.0,ROCK & RYE
1082200.0,IMPORTED SCHNAPPS
1052100.0,IMPORTED BRANDIES
1062200.0,WHITE RUM
1062100.0,GOLD RUM
1031100.0,100 PROOF VODKA
1062300.0,AGED DARK RUM
1071100.0,AMERICAN COCKTAILS
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY
1081015.0,IMPORTED AMARETTO
1032200.0,IMPORTED VODKA - MISC
1011300.0,SINGLE BARREL BOURBON WHISKIES
1700000.0,TEMPORARY & SPECIALTY PACKAGES
1901000.0,SPECIAL ORDER ITEMS
1081240.0,GREEN CREME DE MENTHE
1701100.0,DECANTERS & SPECIALTY PACKAGES
1071000.0,COCKTAILS/RTD
1091200.0,NEUTRAL GRAIN SPIRITS
1081305.0,APPLE SCHNAPPS
1041300.0,AMERICAN SLOE GINS
1082100.0,
1081030.0,COFFEE LIQUEURS
1081230.0,WHITE CREME DE CACAO
1062500.0,
1501100.0,HIGH PROOF BEER - AMERICAN
1051010.0,AMERICAN GRAPE BRANDIES
1081370.0,WATERMELON SCHNAPPS
1090000.0,DISTILLED SPIRITS SPECIALTY
1081600.0,WHISKEY LIQUEUR
1051100.0,APRICOT BRANDIES
1012400.0,JAPANESE WHISKY
1031200.0,VODKA FLAVORED
1031000.0,AMERICAN VODKAS
1101100.0,AMERICAN ALCOHOL
1052010.0,IMPORTED GRAPE BRANDIES
1012400.0,IRISH WHISKIES
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY
1032100.0,
1032080.0,IMPORTED VODKAS
1081315.0,CINNAMON SCHNAPPS
1041200.0,FLAVORED GIN
1011800.0,IOWA DISTILLERY WHISKIES
1011300.0,TENNESSEE WHISKIES
1022200.0,
1012300.0,IRISH WHISKIES
1062050.0,BARBADOS RUM
1082900.0,MISC. IMPORTED CORDIALS & LIQUEURS
1012200.0,SCOTCH WHISKIES
1081330.0,PEACH SCHNAPPS
1081400.0,AMERICAN SCHNAPPS
1081210.0,CREME DE ALMOND
1081500.0,TRIPLE SEC
1062400.0,
1011400.0,TENNESSEE WHISKIES
1081400.0,TRIPLE SEC
1011600.0,STRAIGHT RYE WHISKIES
1031080.0,VODKA 80 PROOF
1011700.0,
1022200.0,100% AGAVE TEQUILA
1051120.0,CHERRY BRANDIES
1041200.0,AMERICAN SLOE GINS
1081317.0,GRAPE SCHNAPPS
1062200.0,PUERTO RICO & VIRGIN ISLANDS RUM
1901200.0,SPECIAL ORDER ITEMS
1031110.0,LOW PROOF VODKA
1032200.0,IMPORTED FLAVORED VODKA
1031090.0,OTHER PROOF VODKA
1031200.0,AMERICAN FLAVORED VODKA
1081220.0,DARK CREME DE CACAO
1011600.0,CORN WHISKIES
1070000.0,COCKTAILS/RTD
1082000.0,IMPORTED CORDIALS & LIQUEURS
1081300.0,PEPPERMINT SCHNAPPS
1081312.0,BUTTERSCOTCH SCHNAPPS
1012210.0,SINGLE MALT SCOTCH
1082100.0,IMPORTED CORDIALS & LIQUEURS
1042100.0,IMPORTED DRY GINS
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY
1062300.0,FLAVORED RUM
1701100.0,TEMPORARY & SPECIALTY PACKAGES
1081390.0,IMPORTED SCHNAPPS
1031100.0,AMERICAN VODKAS
1011400.0,BOTTLED IN BOND BOURBON
1032000.0,IMPORTED VODKAS
1091100.0,
1051140.0,PEACH BRANDIES
1081000.0,AMERICAN CORDIALS & LIQUEURS
1051150.0,MISCELLANEOUS  BRANDIES
1011100.0,BLENDED WHISKIES
1011250.0,SINGLE BARREL BOURBON WHISKIES
Query:
SELECT *
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   LIMIT 100;
Answer:
Too long, hard cut:
invoice_and_item_number,date,store_number,store_name,address,city,zip_code,store_location,county_number,county,category,category_name,vendor_number,vendor_name,item_number,item_description,pack,bottle_volume_ml,state_bottle_cost,state_bottle_retail,bottles_sold,sale_dollars,volume_sold_liters,volume_sold_gallons
INV-50000500199,2022-08-02,2603,HY-VEE WINE AND SPIRITS / BETTENDORF,2890 DEVILS GLEN ROAD,BETTENDORF,52722.0,bytearray(b'\x01\x01\x00\x00\x00\xe2\x95$\xcf\xf5\x9eV\xc0\xc8\xd5\xc8\xae\xb4\xc6D@'),,SCOTT,1022200.0,100% AGAVE TEQUILA,395,PROXIMO,64933,1800 COCONUT,12,750,16.5,24.75,3,74.25,2.25,0.59
INV-44886700006,2022-02-18,4299,HOMETOWN MARKET / CENTRAL CITY,9 WATERHOUSE AVE,CENTRAL CITY,52214.0,bytearray(b'\x01\x01\x00\x00\x00\xd7O\xffY\xf3\xe1V\xc0\x9f\x1c\x05\x88\x82\x19E@'),57,LINN,1082200.0,IMPORTED SCHNAPPS,421,SAZERAC COMPANY  INC,65066,GOLDSCHLAGER CINNAMON SCHNAPPS,12,750,13.0,19.5,3,58.5,2.25,0.59
INV-58297800165,2023-05-10,2590,HY-VEE FOOD STORE #5 / CEDAR RAPIDS,3235 OAKLAND ROAD NE,CEDAR RAPIDS,52402.0,bytearray(b'\x01\x01\x00\x00\x00\xd8\xdb\xbbs9\xeaV\xc0\x00\xd9\xd1\xf6w\x01E@'),,LINN,1082200.0,IMPORTED SCHNAPPS,421,SAZERAC COMPANY  INC,65066,GOLDSCHLAGER CINNAMON SCHNAPPS,12,750,13.5,20.25,3,60.75,2.25,0.59
INV-72428100092,2024-07-22,2637,HY-VEE #5 / DAVENPORT,2351 W LOCUST,DAVENPORT,52804.0,bytearray(b'\x01\x01\x00\x00\x000+\xa7L0\xa7V\xc0\x91\x9b\x9a1\xb0\xc4D@'),,SCOTT,1082200.0,IMPORTED SCHNAPPS,421,SAZERAC COMPANY  INC,65066,GOLDSCHLAGER CINNAMON SCHNAPPS,12,750,13.5,20.25,3,60.75,2.25,0.59
INV-55500100015,2023-02-01,2558,HY-VEE FOOD STORE (1433) / MOUNT PLEASANT,1700 E WASHINGTON,MOUNT PLEASANT,52641.0,"bytearray(b'\x01\x01\x00\x00\x00o/i\x8c\xd6\xe1V\xc0lxz\xa5,{D@')",,HENRY,1082100.0,IMPORTED CORDIALS & LIQUEURS,619,CAMPARI AMERICA,65126,GRAND MARNIER CORDON ROUGE,12,750,23.0,34.5,3,103.5,2.25,0.59
INV-66967100018,2024-02-06,4255,FAREWAY STORES #058 / ORANGE CITY,512  8TH SE,ORANGE CITY,51041.0,bytearray(b'\x01\x01\x00\x00\x00\xf2\xda\x19dZ\x03X\xc0:\x91`\xaa\x99\x7fE@'),,SIOUX,1082100.0,IMPORTED CORDIALS & LIQUEURS,619,CAMPARI AMERICA,65126,GRAND MARNIER CORDON ROUGE,12,750,23.5,35.25,3,103.5,2.25,0.59
INV-52601300029,2022-10-31,3650,"SPIRITS, STOGIES AND STUFF",118 SOUTH MAIN ST.,HOLSTEIN,51025.0,bytearray(b'\x01\x01\x00\x00\x00\xa6C\xa7\xe7\xdd\xe2W\xc0\x82:\xe5\xd1\x8d>E@'),,IDA,1082100.0,IMPORTED CORDIALS & LIQUEURS,619,CAMPARI AMERICA,65126,GRAND MARNIER CORDON ROUGE,12,750,23.0,34.5,3,103.5,2.25,0.59
INV-72995900030,2024-08-07,10102,WORLD LIQUOR AND TOBACCO PLUS VAPORS /  CHEROKEE,114 SOUTH 2ND STREET,CHEROKEE,51012.0,bytearray(b'\x01\x01\x00\x00\x00\xf1\xbe/\xd0C\xe3W\xc0\x9c\\\x8e\x82\xe0_E@'),,CHEROKEE,1082100.0,IMPORTED CORDIALS & LIQUEURS,259,HEAVEN HILL BRANDS,65194,HPNOTIQ,12,375,7.5,11.25,6,63.0,2.25,0.59
INV-58944600049,2023-06-01,4725,CASEY'S GENERAL STORE #1548 / ANKENY,2905 W 1ST ST,ANKENY,50023.0,bytearray(b'\x01\x01\x00\x00\x00qi\xae3\xdbhW\xc0X\xb7\xb9\x1f\x9a\xddD@'),,POLK,1082100.0,IMPORTED CORDIALS & LIQUEURS,259,HEAVEN HILL BRANDS,65195,HPNOTIQ,6,750,12.0,18.0,3,54.0,2.25,0.59
INV-46334800012,2022-04-08,5925,FREDRICKSBURG FOOD CENTER,100 W MAIN ST,FREDERICKSBURG,50630.0,bytearray(b'\x01\x01\x00\x00\x00\xd8\xdbf*\xc4\x0cW\xc0\xae\xb7\xcdT\x88{E@'),19,CHICKASAW,1081200.0,CREAM LIQUEURS,300,MCCORMICK DISTILLING CO.,65200,TEQUILA ROSE LIQUEUR,12,750,11.5,17.25,3,51.75,2.25,0.59
INV-58882700047,2023-05-30,4269,TIPTON FAMILY FOODS,610 CEDAR ST,TIPTON,52772.0,"bytearray(b""\x01\x01\x00\x00\x00\xac\n\xcc\xf1\'\xc8V\xc0\xa894*\xc5\xe2D@"")",,CEDAR,1081200.0,CREAM LIQUEURS,300,MCCORMICK DISTILLING CO.,65200,TEQUILA ROSE LIQUEUR,12,750,12.5,18.75,3,56.25,2.25,0.59
INV-51700400025,2022-09-30,6303,WORLD LIQUOR & TOBACCO + VAPORS / DES MOINES,3200 SOUTHEAST 14TH STREET,DES MOINES,50320,bytearray(b'\x01\x01\x00\x00\x00b\x9d*\xdf3fW\xc0|\xf0\xda\xa5\r\xc7D@'),,POLK,1081200.0,CREAM LIQUEURS,300,MCCORMICK DISTILLING CO.,65200,TEQUILA ROSE LIQUEUR,12,750,12.5,18.75,3,56.25,2.25,0.59
INV-56631000005,2023-03-13,10035,LIQUOR TOBACCO & VAPE / CLINTON,122 SOUTH 2ND STREET,CLINTON,52732,bytearray(b'\x01\x01\x00\x00\x00k\x9f\x8e\xc7\x0c\x8cV\xc0\x15\x00\xe3\x194\xecD@'),,CLINTON,1082100.0,IMPORTED CORDIALS & LIQUEURS,192,"MAST-JAGERMEISTER US, INC",65254,JAGERMEISTER LIQUEUR,24,375,7.68,11.52,6,69.12,2.25,0.59
INV-61840700006,2023-09-01,4722,WALGREENS #09476 / BURLINGTON,201 S CENTRAL AVE,BURLINGTON,52601.0,bytearray(b'\x01\x01\x00\x00\x00\xe6D\x11\x0bB\xc7V\xc0\xaa\x9dajKgD@'),,DES MOINES,1082100.0,IMPORTED CORDIALS & LIQUEURS,192,"MAST-JAGERMEISTER US, INC",65254,JAGERMEISTER LIQUEUR,24,375,7.68,11.52,6,69.12,2.25,0.59
INV-73541700025,2024-08-23,6264,MLK LIQUOR LLC / DES MOINES,3424 MARTIN LUTHER KING JUNIOR PARKWAY,DES MOINES,50310.0,"bytearray(b""\x01\x01\x00\x00\x00\x12(#\xad\xbfiW\xc0\'\x1a\xa4\xe0)\xd0D@"")",,POLK,1082100.0,IMPORTED CORDIALS & LIQUEURS,192,"MAST-JAGERMEISTER US, INC",65254,JAGERMEISTER LIQUEUR,24,375,7.68,11.52,6,69.12,2.25,0.59
INV-73370100022,2024
Query:
SELECT "category", SUM("bottles_sold") AS "total_bottles_sold"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   GROUP BY "category"
   ORDER BY "total_bottles_sold" DESC
   LIMIT 100;
Answer:
category,total_bottles_sold
1031100.0,17547955
1081600.0,11967870
1012100.0,8173740
1011200.0,4596736
1062400.0,3852972
1022200.0,2921968
1031200.0,2851618
1081400.0,2531079
1011100.0,2316625
1022100.0,2176287
1011400.0,1981355
1051100.0,1969307
1032100.0,1946590
1071000.0,1470706
1062500.0,1463377
1062200.0,1362966
1052100.0,1354991
1081300.0,1217234
1701100.0,1175307
1082100.0,1170433
1081200.0,1046003
1041100.0,972021
1082200.0,957833
1012400.0,956732
1092100.0,885389
1032200.0,749291
1042100.0,572572
1081500.0,561286
1012200.0,533417
1091300.0,532612
1071100.0,399626
1011600.0,365308
1081100.0,274028
1082000.0,260140
1091100.0,232261
1012300.0,212487
1901000.0,209270
1062100.0,206689
1011300.0,127435
1062300.0,124723
1091200.0,116228
1011500.0,108448
1041200.0,101892
1901200.0,67123
1022300.0,41970
1011700.0,27851
1700000.0,16242
1041300.0,8617
1032000.0,2404
1081000.0,2044
1092000.0,700
1031000.0,289
1091000.0,198
1090000.0,100
1042000.0,72
1070000.0,24
1012000.0,12
Query:
SELECT DATE_TRUNC('month', "date") AS "month", "category", SUM("volume_sold_liters") AS "monthly_volume_liters"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   GROUP BY "month", "category"
   ORDER BY "month", "category"
   LIMIT 100;
Answer:
month,category,monthly_volume_liters
2022-01-01,1011100.0,58176.44
2022-01-01,1011200.0,92011.67000000001
2022-01-01,1011300.0,1507.5
2022-01-01,1011400.0,30197.190000000002
2022-01-01,1011500.0,1507.5
2022-01-01,1011600.0,7415.780000000001
2022-01-01,1011700.0,349.85
2022-01-01,1012100.0,180763.57
2022-01-01,1012200.0,28549.509999999995
2022-01-01,1012300.0,5691.9
2022-01-01,1012400.0,20216.009999999995
2022-01-01,1022100.0,35947.30999999999
2022-01-01,1022200.0,34750.74999999999
2022-01-01,1022300.0,551.25
2022-01-01,1031000.0,143.64999999999998
2022-01-01,1031100.0,381361.1499999999
2022-01-01,1031200.0,46170.820000000014
2022-01-01,1032000.0,4.5
2022-01-01,1032100.0,41300.22999999999
2022-01-01,1032200.0,15887.25
2022-01-01,1041100.0,21860.83999999999
2022-01-01,1041200.0,677.2999999999998
2022-01-01,1041300.0,274.0
2022-01-01,1042000.0,18.0
2022-01-01,1042100.0,11226.01
2022-01-01,1051100.0,32754.750000000004
2022-01-01,1052100.0,12598.969999999998
2022-01-01,1062100.0,5789.070000000001
2022-01-01,1062200.0,35469.829999999994
2022-01-01,1062300.0,3004.0
2022-01-01,1062400.0,91831.70000000001
2022-01-01,1062500.0,30555.590000000004
2022-01-01,1070000.0,12.0
2022-01-01,1071100.0,44270.22
2022-01-01,1081100.0,6624.709999999997
2022-01-01,1081200.0,27799.109999999997
2022-01-01,1081300.0,17391.379999999997
2022-01-01,1081400.0,33701.16999999999
2022-01-01,1081500.0,10041.25
2022-01-01,1081600.0,89703.06000000001
2022-01-01,1082000.0,18824.57
2022-01-01,1082100.0,2525.5099999999993
2022-01-01,1082200.0,25046.16
2022-01-01,1090000.0,46.5
2022-01-01,1091000.0,36.0
2022-01-01,1091100.0,3599.3500000000004
2022-01-01,1091200.0,2180.0
2022-01-01,1091300.0,4657.750000000002
2022-01-01,1092000.0,4.5
2022-01-01,1092100.0,12293.97
2022-01-01,1700000.0,872.8500000000001
2022-01-01,1701100.0,26909.54
2022-01-01,1901200.0,12094.5
2022-02-01,1011100.0,57679.22
2022-02-01,1011200.0,90042.63000000002
2022-02-01,1011300.0,2340.0
2022-02-01,1011400.0,33219.51
2022-02-01,1011500.0,1920.25
2022-02-01,1011600.0,7916.829999999999
2022-02-01,1011700.0,372.75
2022-02-01,1012000.0,9.0
2022-02-01,1012100.0,232939.92
2022-02-01,1012200.0,14892.599999999997
2022-02-01,1012300.0,5445.900000000001
2022-02-01,1012400.0,32271.96999999999
2022-02-01,1022100.0,47175.04
2022-02-01,1022200.0,43229.89999999999
2022-02-01,1022300.0,1024.5
2022-02-01,1031000.0,67.5
2022-02-01,1031100.0,387203.72
2022-02-01,1031200.0,47006.86000000001
2022-02-01,1032100.0,47930.890000000014
2022-02-01,1032200.0,15670.260000000002
2022-02-01,1041100.0,24677.72
2022-02-01,1041200.0,628.5000000000001
2022-02-01,1041300.0,213.75
2022-02-01,1042100.0,14815.110000000006
2022-02-01,1051100.0,31344.240000000005
2022-02-01,1052100.0,19855.480000000007
2022-02-01,1062100.0,6643.880000000001
2022-02-01,1062200.0,41235.200000000004
2022-02-01,1062300.0,2691.5
2022-02-01,1062400.0,77545.32000000002
2022-02-01,1062500.0,33986.579999999994
2022-02-01,1071100.0,62950.78999999999
2022-02-01,1081000.0,63.0
2022-02-01,1081100.0,6417.930000000001
2022-02-01,1081200.0,26864.83
2022-02-01,1081300.0,16267.810000000007
2022-02-01,1081400.0,30248.469999999994
2022-02-01,1081500.0,12388.0
2022-02-01,1081600.0,81928.67000000004
2022-02-01,1082000.0,28668.83999999999
2022-02-01,1082100.0,2941.98
2022-02-01,1082200.0,26341.06
2022-02-01,1090000.0,27.0
2022-02-01,1091000.0,18.0
2022-02-01,1091100.0,3181.1499999999996
2022-02-01,1091200.0,2716.25
2022-02-01,1091300.0,4894.55
Query:
SELECT DATE_TRUNC('month', "date") AS "month", SUM("sale_dollars") AS "total_sales_dollars"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   GROUP BY "month"
   ORDER BY "month"
   LIMIT 100;
Answer:
month,total_sales_dollars
2022-01-01,27597708.3
2022-02-01,29474100.930000003
2022-03-01,30225874.55
2022-04-01,34781761.59
2022-05-01,35948167.34
2022-06-01,38614152.41000001
2022-07-01,33792893.14
2022-08-01,41374068.24000001
2022-09-01,36622693.61000001
2022-10-01,39688632.57999998
2022-11-01,37513438.63
2022-12-01,43146512.17
2023-01-01,32547784.890000004
2023-02-01,32114831.480000004
2023-03-01,36403505.9
2023-04-01,32884344.37
2023-05-01,39684933.96999999
2023-06-01,41194749.13000001
2023-07-01,35838999.870000005
2023-08-01,39788043.98
2023-09-01,35096963.96000001
2023-10-01,40281758.90000001
2023-11-01,39289673.49
2023-12-01,40945072.58000001
2024-01-01,32972812.840000004
2024-02-01,35101475.449999996
2024-03-01,34164169.29
2024-04-01,36385547.870000005
2024-05-01,39359095.65
2024-06-01,36769358.27999999
2024-07-01,37563557.73
2024-08-01,36529981.19
2024-09-01,34410490.22
Query:
SELECT
  c."category",
  c."category_name",
  c."total_volume_liters"
FROM
  (
    SELECT
      "category",
      "category_name",
      SUM("volume_sold_liters") AS "total_volume_liters"
    FROM
      "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE
      "date" >= '2022-01-01'
    GROUP BY
      "category",
      "category_name"
  ) AS c
CROSS JOIN
  (
    SELECT
      SUM("volume_sold_liters") * 0.01 AS "one_percent_volume"
    FROM
      "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE
      "date" >= '2022-01-01'
  ) AS t
WHERE
  c."total_volume_liters" >= t."one_percent_volume"
ORDER BY
  c."total_volume_liters" DESC
LIMIT
  100;
Answer:
category,category_name,total_volume_liters
1031100.0,AMERICAN VODKAS,15645738.359999996
1012100.0,CANADIAN WHISKIES,7888910.250000001
1062400.0,SPICED RUM,3769932.2400000007
1011200.0,STRAIGHT BOURBON WHISKIES,3661763.7800000003
1081600.0,WHISKEY LIQUEUR,2996627.110000001
1022200.0,100% AGAVE TEQUILA,2033489.7700000003
1031200.0,AMERICAN FLAVORED VODKA,2000078.39
1071000.0,COCKTAILS/RTD,1976413.39
1032100.0,IMPORTED VODKAS,1964598.2199999993
1011100.0,BLENDED WHISKIES,1924959.8900000001
1022100.0,MIXTO TEQUILA,1673871.5000000002
1062200.0,WHITE RUM,1415858.47
1011400.0,TENNESSEE WHISKIES,1408056.17
1062500.0,FLAVORED RUM,1348587.1199999996
1081400.0,AMERICAN SCHNAPPS,1268049.6599999997
1051100.0,AMERICAN BRANDIES,1014426.1400000002
1701100.0,TEMPORARY & SPECIALTY PACKAGES,894384.3700000002
1081200.0,CREAM LIQUEURS,892286.9799999997
1082200.0,IMPORTED SCHNAPPS,852297.6999999997
1082100.0,IMPORTED CORDIALS & LIQUEURS,851256.7600000002
1041100.0,AMERICAN DRY GINS,808267.27
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,801322.54
1012400.0,IRISH WHISKIES,801182.62
Query:
SELECT "category", "category_name", COUNT(DISTINCT DATE_TRUNC('month', "date")) AS "months_with_sales"
   FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
   WHERE "date" >= '2022-01-01'
   GROUP BY "category", "category_name"
   ORDER BY "months_with_sales" DESC
   LIMIT 100;
Answer:
category,category_name,months_with_sales
1012100.0,CANADIAN WHISKIES,33
1031100.0,AMERICAN VODKAS,33
1062200.0,WHITE RUM,33
1032200.0,IMPORTED FLAVORED VODKA,33
1011700.0,CORN WHISKIES,33
1031200.0,AMERICAN FLAVORED VODKA,33
1011500.0,BOTTLED IN BOND BOURBON,33
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,33
1011400.0,TENNESSEE WHISKIES,33
1012200.0,SCOTCH WHISKIES,33
1022300.0,MEZCAL,33
1062100.0,GOLD RUM,33
1082200.0,IMPORTED SCHNAPPS,33
1062400.0,SPICED RUM,33
1052100.0,IMPORTED BRANDIES,33
1012300.0,SINGLE MALT SCOTCH,33
1011300.0,SINGLE BARREL BOURBON WHISKIES,33
1011600.0,STRAIGHT RYE WHISKIES,33
1082100.0,IMPORTED CORDIALS & LIQUEURS,33
1042100.0,IMPORTED DRY GINS,33
1081500.0,TRIPLE SEC,33
1081400.0,AMERICAN SCHNAPPS,33
1022200.0,100% AGAVE TEQUILA,33
1081200.0,CREAM LIQUEURS,33
1091200.0,NEUTRAL GRAIN SPIRITS,33
1041200.0,FLAVORED GIN,33
1041300.0,AMERICAN SLOE GINS,33
1011100.0,BLENDED WHISKIES,33
1051100.0,AMERICAN BRANDIES,33
1062300.0,AGED DARK RUM,33
1011200.0,STRAIGHT BOURBON WHISKIES,33
1032100.0,IMPORTED VODKAS,33
1081600.0,WHISKEY LIQUEUR,33
1081100.0,COFFEE LIQUEURS,33
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,33
1022100.0,MIXTO TEQUILA,33
1012400.0,IRISH WHISKIES,33
1701100.0,TEMPORARY & SPECIALTY PACKAGES,33
1041100.0,AMERICAN DRY GINS,33
1062500.0,FLAVORED RUM,33
1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,33
1081300.0,AMERICAN CORDIALS & LIQUEURS,33
1901000.0,SPECIAL ORDER ITEMS,27
1082000.0,IMPORTED CORDIALS & LIQUEURS,27
1071000.0,COCKTAILS/RTD,27
1032000.0,IMPORTED VODKAS,19
1081000.0,AMERICAN CORDIALS & LIQUEURS,19
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY,16
1901200.0,SPECIAL ORDER ITEMS,7
1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,7
1700000.0,TEMPORARY & SPECIALTY PACKAGES,7
1071100.0,COCKTAILS/RTD,7
1090000.0,DISTILLED SPIRITS SPECIALTY,3
1042000.0,IMPORTED GINS,3
1070000.0,COCKTAILS/RTD,2
1031000.0,AMERICAN VODKAS,2
1012000.0,IMPORTED WHISKIES,1
Query:
SELECT
  "category",
  "category_name",
  AVG(monthly_volume) AS "average_monthly_volume"
FROM (
  SELECT
    "category",
    "category_name",
    SUM("volume_sold_liters") AS monthly_volume
  FROM
    "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
  WHERE
    "date" >= '2022-01-01'
  GROUP BY
    "category",
    "category_name",
    DATE_TRUNC('month', "date")
) sub
GROUP BY
  "category",
  "category_name"
ORDER BY
  "average_monthly_volume" DESC
LIMIT 100;
Answer:
category,category_name,average_monthly_volume
1031100.0,AMERICAN VODKAS,474113.28363636363
1012100.0,CANADIAN WHISKIES,239057.88636363638
1062400.0,SPICED RUM,114240.37090909087
1011200.0,STRAIGHT BOURBON WHISKIES,110962.5387878788
1081600.0,WHISKEY LIQUEUR,90806.88212121211
1071100.0,COCKTAILS/RTD,81444.53285714285
1071000.0,COCKTAILS/RTD,73200.49592592592
1022200.0,100% AGAVE TEQUILA,61620.902121212115
1031200.0,AMERICAN FLAVORED VODKA,60608.43606060606
1032100.0,IMPORTED VODKAS,59533.2793939394
1011100.0,BLENDED WHISKIES,58332.11787878787
1022100.0,MIXTO TEQUILA,50723.37878787878
1062200.0,WHITE RUM,42904.80212121212
1011400.0,TENNESSEE WHISKIES,42668.36878787879
1062500.0,FLAVORED RUM,40866.276363636345
1081400.0,AMERICAN SCHNAPPS,38425.74727272727
1051100.0,AMERICAN BRANDIES,30740.186060606058
1701100.0,TEMPORARY & SPECIALTY PACKAGES,27102.556666666664
1081200.0,CREAM LIQUEURS,27038.999393939393
1082200.0,IMPORTED SCHNAPPS,25827.203030303026
1082100.0,IMPORTED CORDIALS & LIQUEURS,25795.659393939382
1041100.0,AMERICAN DRY GINS,24492.947575757575
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,24282.501212121202
1012400.0,IRISH WHISKIES,24278.261212121215
1052100.0,IMPORTED BRANDIES,19022.36515151515
1032200.0,IMPORTED FLAVORED VODKA,17680.80212121212
1012200.0,SCOTCH WHISKIES,17297.46575757576
1081500.0,TRIPLE SEC,16761.083333333332
1081300.0,AMERICAN CORDIALS & LIQUEURS,16609.013636363637
1042100.0,IMPORTED DRY GINS,16545.878181818185
1901200.0,SPECIAL ORDER ITEMS,14980.602857142858
1901000.0,SPECIAL ORDER ITEMS,10960.257037037036
1011600.0,STRAIGHT RYE WHISKIES,8529.675757575757
1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,8361.324242424243
1081100.0,COFFEE LIQUEURS,7055.785757575757
1062100.0,GOLD RUM,6871.060909090909
1082000.0,IMPORTED CORDIALS & LIQUEURS,6524.17148148148
1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,5011.4236363636355
1012300.0,SINGLE MALT SCOTCH,4974.880303030302
1062300.0,AGED DARK RUM,3089.3090909090906
1700000.0,TEMPORARY & SPECIALTY PACKAGES,3030.06
1011300.0,SINGLE BARREL BOURBON WHISKIES,2898.0227272727275
1011500.0,BOTTLED IN BOND BOURBON,2825.5621212121214
1091200.0,NEUTRAL GRAIN SPIRITS,2682.730303030303
1041200.0,FLAVORED GIN,2307.5454545454545
1022300.0,MEZCAL,956.0969696969697
1011700.0,CORN WHISKIES,605.8227272727273
1041300.0,AMERICAN SLOE GINS,259.1515151515151
1032000.0,IMPORTED VODKAS,107.86842105263158
1031000.0,AMERICAN VODKAS,105.575
1081000.0,AMERICAN CORDIALS & LIQUEURS,67.21578947368421
1090000.0,DISTILLED SPIRITS SPECIALTY,25.0
1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY,23.374999999999996
1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,21.214285714285715
1042000.0,IMPORTED GINS,18.0
1070000.0,COCKTAILS/RTD,12.0
1012000.0,IMPORTED WHISKIES,9.0
Query:
SELECT
     "month",
     "category",
     "category_name",
     ("monthly_volume_liters" / "total_volume_liters") * 100 AS "percentage_contribution"
   FROM (
     SELECT
       DATE_TRUNC('month', "date") AS "month",
       "category",
       "category_name",
       SUM("volume_sold_liters") AS "monthly_volume_liters"
     FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
     WHERE "date" >= '2022-01-01'
     GROUP BY "month", "category", "category_name"
   ) vol
   INNER JOIN (
     SELECT
       DATE_TRUNC('month', "date") AS "month",
       SUM("volume_sold_liters") AS "total_volume_liters"
     FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
     WHERE "date" >= '2022-01-01'
     GROUP BY "month"
   ) total_vol USING ("month")
   ORDER BY "month", "percentage_contribution" DESC
   LIMIT 100;
Answer:
Too long, hard cut:
month,category,category_name,percentage_contribution
2022-01-01,1031100.0,AMERICAN VODKAS,24.333948386444774
2022-01-01,1012100.0,CANADIAN WHISKIES,11.53418847863632
2022-01-01,1011200.0,STRAIGHT BOURBON WHISKIES,5.87109418127827
2022-01-01,1062400.0,SPICED RUM,5.859610629030986
2022-01-01,1081600.0,WHISKEY LIQUEUR,5.723786054626066
2022-01-01,1011100.0,BLENDED WHISKIES,3.7121308457012487
2022-01-01,1031200.0,AMERICAN FLAVORED VODKA,2.946074477800983
2022-01-01,1071100.0,COCKTAILS/RTD,2.824800713278097
2022-01-01,1032100.0,IMPORTED VODKAS,2.635291154246567
2022-01-01,1022100.0,MIXTO TEQUILA,2.293731247064705
2022-01-01,1062200.0,WHITE RUM,2.263264132951064
2022-01-01,1022200.0,100% AGAVE TEQUILA,2.2173809704796774
2022-01-01,1081400.0,AMERICAN SCHNAPPS,2.150409215366592
2022-01-01,1051100.0,AMERICAN BRANDIES,2.090019908716192
2022-01-01,1062500.0,FLAVORED RUM,1.9496955837724113
2022-01-01,1011400.0,TENNESSEE WHISKIES,1.9268267438244984
2022-01-01,1012200.0,SCOTCH WHISKIES,1.821691335885391
2022-01-01,1081200.0,CREAM LIQUEURS,1.7738097022444488
2022-01-01,1701100.0,TEMPORARY & SPECIALTY PACKAGES,1.7170478887610106
2022-01-01,1082200.0,IMPORTED SCHNAPPS,1.5981490634760194
2022-01-01,1041100.0,AMERICAN DRY GINS,1.3948996961130604
2022-01-01,1012400.0,IRISH WHISKIES,1.2899461413934046
2022-01-01,1082000.0,IMPORTED CORDIALS & LIQUEURS,1.2011609330866997
2022-01-01,1081300.0,AMERICAN CORDIALS & LIQUEURS,1.1097117346353922
2022-01-01,1032200.0,IMPORTED FLAVORED VODKA,1.0137359862234125
2022-01-01,1052100.0,IMPORTED BRANDIES,0.8039169320272034
2022-01-01,1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,0.7844554471384947
2022-01-01,1901200.0,SPECIAL ORDER ITEMS,0.7717276360212789
2022-01-01,1042100.0,IMPORTED DRY GINS,0.7163108982803125
2022-01-01,1081500.0,TRIPLE SEC,0.6407135578319622
2022-01-01,1011600.0,STRAIGHT RYE WHISKIES,0.4731871816655404
2022-01-01,1081100.0,COFFEE LIQUEURS,0.42271047067894696
2022-01-01,1062100.0,GOLD RUM,0.36938983057271507
2022-01-01,1012300.0,SINGLE MALT SCOTCH,0.3631895929116142
2022-01-01,1091300.0,NEUTRAL GRAIN SPIRITS FLAVORED,0.29720239750945576
2022-01-01,1091100.0,AMERICAN DISTILLED SPIRITS SPECIALTY,0.22966785453827693
2022-01-01,1062300.0,AGED DARK RUM,0.19167967411698886
2022-01-01,1082100.0,IMPORTED CORDIALS & LIQUEURS,0.16114811377469918
2022-01-01,1091200.0,NEUTRAL GRAIN SPIRITS,0.13910176084388673
2022-01-01,1011500.0,BOTTLED IN BOND BOURBON,0.09619078186796295
2022-01-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,0.09619078186796295
2022-01-01,1700000.0,TEMPORARY & SPECIALTY PACKAGES,0.05569494126265437
2022-01-01,1041200.0,FLAVORED GIN,0.04321725808236901
2022-01-01,1022300.0,MEZCAL,0.03517424113082227
2022-01-01,1011700.0,CORN WHISKIES,0.022323280289556775
2022-01-01,1041300.0,AMERICAN SLOE GINS,0.017483432326249982
2022-01-01,1031000.0,AMERICAN VODKAS,0.009166040341846022
2022-01-01,1090000.0,DISTILLED SPIRITS SPECIALTY,0.0029670788436884097
2022-01-01,1091000.0,AMERICAN DISTILLED SPIRITS SPECIALTY,0.0022970932983394136
2022-01-01,1042000.0,IMPORTED GINS,0.0011485466491697068
2022-01-01,1070000.0,COCKTAILS/RTD,0.0007656977661131379
2022-01-01,1032000.0,IMPORTED VODKAS,0.0002871366622924267
2022-01-01,1092000.0,IMPORTED DISTILLED SPIRITS SPECIALTY,0.0002871366622924267
2022-02-01,1031100.0,AMERICAN VODKAS,23.265532323033693
2022-02-01,1012100.0,CANADIAN WHISKIES,13.996433810307613
2022-02-01,1011200.0,STRAIGHT BOURBON WHISKIES,5.410303699344529
2022-02-01,1081600.0,WHISKEY LIQUEUR,4.922768097548652
2022-02-01,1062400.0,SPICED RUM,4.659390020736345
2022-02-01,1071100.0,COCKTAILS/RTD,3.78246272919461
2022-02-01,1011100.0,BLENDED WHISKIES,3.465715043433392
2022-02-01,1032100.0,IMPORTED VODKAS,2.87997664528319
2022-02-01,1022100.0,MIXTO TEQUILA,2.8345606234372114
2022-02-01,1031200.0,AMERICAN FLAVORED VODKA,2.8244553557861476
2022-02-01,1022200.0,100% AGAVE TEQUILA,2.5975128435530364
2022-02-01,1062200.0,WHITE RUM,2.477659249882101
2022-02-01,1062500.0,FLAVORED RUM,2.0421184887876866
2022-02-01,1011400.0,TENNESSEE WHISKIES,1.996028301743436
2022-02-01,1012400.0,IRISH WHISKIES,1.9390943898033153
2022-02-01,1051100.0,AMERICAN BRANDIES,1.8833507820145052
2022-02-01,1081400.0,AMERICAN SCHNAPPS,1.817510318618103
2022-02-01,1082000.0,IMPORTED CORDIALS & LIQUEURS,1.722596631261396
2022-02-01,1081200.0,CREAM LIQUEURS,1.614200841659799
2022-02-01,1082200.0,IMPORTED SCHNAPPS,1.582729584449679
2022-02-01,1041100.0,AMERICAN DRY GINS,1.4827860959568646
2022-02-01,1052100.0,IMPORTED BRANDIES,1.1930368637195659
2022-02-01,1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,1.0863391051788498
2022-02-01,1081300.0,AMERICAN CORDIALS & LIQUEURS,0.9774680351210745
2022-02-01,1701100.0,TEMPORARY & SPECIALTY PACKAGES,0.9501763617961252
2022-02-01,1032200.0,IMPORTED FLAVORED VODKA,0.9415636310011225
2022-02-01,1012200.0,SCOTCH WHISKIES,0.8948371329542274
2022-02-01,1042100.0,IMPORTED DRY GINS,0.8901810668923836
2022-02-01,1081500.0,TRIPLE SEC,0.7443456752371629
2022-02-01,1011600.0,STRAIGHT RYE WHISKIES
Query:
SELECT DATE_TRUNC('month', "date") AS "month", "category", "category_name", SUM("volume_sold_liters") AS "monthly_volume_liters"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01'
    GROUP BY "month", "category", "category_name"
    ORDER BY "category", "month"
    LIMIT 100;
Answer:
Too long, hard cut:
month,category,category_name,monthly_volume_liters
2022-01-01,1011100.0,BLENDED WHISKIES,58176.43999999999
2022-02-01,1011100.0,BLENDED WHISKIES,57679.219999999994
2022-03-01,1011100.0,BLENDED WHISKIES,55020.28999999999
2022-04-01,1011100.0,BLENDED WHISKIES,65683.95999999999
2022-05-01,1011100.0,BLENDED WHISKIES,58072.57
2022-06-01,1011100.0,BLENDED WHISKIES,71310.53000000001
2022-07-01,1011100.0,BLENDED WHISKIES,56114.90000000001
2022-08-01,1011100.0,BLENDED WHISKIES,69279.48000000003
2022-09-01,1011100.0,BLENDED WHISKIES,62558.90999999999
2022-10-01,1011100.0,BLENDED WHISKIES,59852.11000000002
2022-11-01,1011100.0,BLENDED WHISKIES,61036.799999999996
2022-12-01,1011100.0,BLENDED WHISKIES,64280.51999999999
2023-01-01,1011100.0,BLENDED WHISKIES,59537.960000000014
2023-02-01,1011100.0,BLENDED WHISKIES,50495.08999999999
2023-03-01,1011100.0,BLENDED WHISKIES,62095.63
2023-04-01,1011100.0,BLENDED WHISKIES,50343.83000000001
2023-05-01,1011100.0,BLENDED WHISKIES,59986.05
2023-06-01,1011100.0,BLENDED WHISKIES,63184.71999999999
2023-07-01,1011100.0,BLENDED WHISKIES,50654.759999999995
2023-08-01,1011100.0,BLENDED WHISKIES,55137.44
2023-09-01,1011100.0,BLENDED WHISKIES,55882.289999999986
2023-10-01,1011100.0,BLENDED WHISKIES,57235.87
2023-11-01,1011100.0,BLENDED WHISKIES,58030.62
2023-12-01,1011100.0,BLENDED WHISKIES,61930.92
2024-01-01,1011100.0,BLENDED WHISKIES,56964.109999999964
2024-02-01,1011100.0,BLENDED WHISKIES,61376.63
2024-03-01,1011100.0,BLENDED WHISKIES,57105.62999999999
2024-04-01,1011100.0,BLENDED WHISKIES,56393.26999999997
2024-05-01,1011100.0,BLENDED WHISKIES,56952.99000000001
2024-06-01,1011100.0,BLENDED WHISKIES,53904.67
2024-07-01,1011100.0,BLENDED WHISKIES,54958.96000000001
2024-08-01,1011100.0,BLENDED WHISKIES,55400.24999999998
2024-09-01,1011100.0,BLENDED WHISKIES,48322.46999999998
2022-01-01,1011200.0,STRAIGHT BOURBON WHISKIES,92011.67
2022-02-01,1011200.0,STRAIGHT BOURBON WHISKIES,90042.63000000002
2022-03-01,1011200.0,STRAIGHT BOURBON WHISKIES,96255.12000000001
2022-04-01,1011200.0,STRAIGHT BOURBON WHISKIES,111162.0
2022-05-01,1011200.0,STRAIGHT BOURBON WHISKIES,106571.83000000002
2022-06-01,1011200.0,STRAIGHT BOURBON WHISKIES,107202.46
2022-07-01,1011200.0,STRAIGHT BOURBON WHISKIES,100378.09999999999
2022-08-01,1011200.0,STRAIGHT BOURBON WHISKIES,126854.78999999998
2022-09-01,1011200.0,STRAIGHT BOURBON WHISKIES,106896.45
2022-10-01,1011200.0,STRAIGHT BOURBON WHISKIES,140560.49000000002
2022-11-01,1011200.0,STRAIGHT BOURBON WHISKIES,102490.94000000003
2022-12-01,1011200.0,STRAIGHT BOURBON WHISKIES,132734.63000000006
2023-01-01,1011200.0,STRAIGHT BOURBON WHISKIES,101561.92000000001
2023-02-01,1011200.0,STRAIGHT BOURBON WHISKIES,100771.81999999998
2023-03-01,1011200.0,STRAIGHT BOURBON WHISKIES,108885.08
2023-04-01,1011200.0,STRAIGHT BOURBON WHISKIES,99841.95999999999
2023-05-01,1011200.0,STRAIGHT BOURBON WHISKIES,117759.85999999997
2023-06-01,1011200.0,STRAIGHT BOURBON WHISKIES,121726.93
2023-07-01,1011200.0,STRAIGHT BOURBON WHISKIES,99810.36000000003
2023-08-01,1011200.0,STRAIGHT BOURBON WHISKIES,126254.05000000002
2023-09-01,1011200.0,STRAIGHT BOURBON WHISKIES,108074.86999999995
2023-10-01,1011200.0,STRAIGHT BOURBON WHISKIES,124033.26
2023-11-01,1011200.0,STRAIGHT BOURBON WHISKIES,114805.63999999998
2023-12-01,1011200.0,STRAIGHT BOURBON WHISKIES,134280.03000000003
2024-01-01,1011200.0,STRAIGHT BOURBON WHISKIES,106868.07
2024-02-01,1011200.0,STRAIGHT BOURBON WHISKIES,105023.97000000002
2024-03-01,1011200.0,STRAIGHT BOURBON WHISKIES,106167.47999999998
2024-04-01,1011200.0,STRAIGHT BOURBON WHISKIES,111954.72999999995
2024-05-01,1011200.0,STRAIGHT BOURBON WHISKIES,116640.11999999998
2024-06-01,1011200.0,STRAIGHT BOURBON WHISKIES,112871.89999999997
2024-07-01,1011200.0,STRAIGHT BOURBON WHISKIES,111245.77999999998
2024-08-01,1011200.0,STRAIGHT BOURBON WHISKIES,110951.26999999996
2024-09-01,1011200.0,STRAIGHT BOURBON WHISKIES,109073.56999999999
2022-01-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,1507.5
2022-02-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,2340.0
2022-03-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,1623.75
2022-04-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,2307.75
2022-05-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,2653.5
2022-06-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,1830.0
2022-07-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,2046.75
2022-08-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,3618.75
2022-09-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,1696.5
2022-10-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,2419.5
2022-11-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,2785.5
2022-12-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,3280.5
2023-01-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,2583.0
2023-02-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,1794.0
2023-03-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,3140.25
2023-04-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,1726.5
2023-05-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,2452.5
2023-06-01,1011300.0,SINGLE BARREL BOURBON WHISKIES,2786.25
2023-07-
Query:
SELECT "category", "category_name", SUM("sale_dollars") AS "total_sales_dollars"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01'
    GROUP BY "category", "category_name"
    ORDER BY "total_sales_dollars" DESC
    LIMIT 10;
Answer:
category,category_name,total_sales_dollars
1031100.0,AMERICAN VODKAS,179745485.1200001
1012100.0,CANADIAN WHISKIES,132576922.83
1011200.0,STRAIGHT BOURBON WHISKIES,103185787.80999999
1022200.0,100% AGAVE TEQUILA,85464658.23000002
1081600.0,WHISKEY LIQUEUR,71569310.75
1062400.0,SPICED RUM,59913495.670000024
1011400.0,TENNESSEE WHISKIES,45330463.41999998
1701100.0,TEMPORARY & SPECIALTY PACKAGES,32814181.100000005
1032100.0,IMPORTED VODKAS,32765618.359999996
1031200.0,AMERICAN FLAVORED VODKA,31694810.599999987
Query:
SELECT *
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "category_name" IS NULL
    LIMIT 100;
Answer:
Too long, hard cut:
invoice_and_item_number,date,store_number,store_name,address,city,zip_code,store_location,county_number,county,category,category_name,vendor_number,vendor_name,item_number,item_description,pack,bottle_volume_ml,state_bottle_cost,state_bottle_retail,bottles_sold,sale_dollars,volume_sold_liters,volume_sold_gallons
INV-05515400005,2017-06-14,2603,HY-VEE WINE AND SPIRITS / BETTENDORF,2890 DEVILS GLEN ROAD,BETTENDORF,52722.0,bytearray(b'\x01\x01\x00\x00\x00\xb8\x02\n\xf5\xf4\x9eV\xc0E+\xf7\x02\xb3\xc6D@'),82,SCOTT,,,259,HEAVEN HILL BRANDS,927114,HA PIKESVILLE RYE 110PRF,6,750,24.96,37.44,3,112.32,2.25,0.59
INV-01329300036,2016-11-02,4669,VOM FASS / DES MOINES,"833, 42ND ST",DES MOINES,50312,bytearray(b'\x01\x01\x00\x00\x00\x86<\x82\x1b)kW\xc0`\xb7\x08\x8c\xf5\xcbD@'),77,POLK,,,885.0,YAHARA BAY DISTILLERS INC,987873,GRAPEFRUIT LIQUEUR,3,750,25.36,38.04,3,114.12,2.25,0.59
INV-15020700109,2018-10-12,3963,TOBACCO HUT #14 / COUNCIL BLUFFS,1925 W BROADWAY,COUNCIL BLUFFS,51501,bytearray(b'\x01\x01\x00\x00\x00R\x81\x93m\xe0\xf7W\xc0\x98\xf78\xd3\x84\xa1D@'),78,POTTAWATTAMIE,,,55,SAZERAC NORTH AMERICA,84197,99 PINEAPPLE MINI,10,600,6.0,9.0,4,36.0,2.4,0.63
INV-18059100123,2019-03-11,2613,HY-VEE FOOD STORE #1 / COUNCIL BLUFFS,2323 W BROADWAY,COUNCIL BLUFFS,51501,"bytearray(b'\x01\x01\x00\x00\x00,b\xd8aL\xf8W\xc0\x9d\x80&\xc2\x86\xa1D@')",78,POTTAWATTAMIE,,,55,SAZERAC NORTH AMERICA,84197,99 PINEAPPLE MINI,10,600,6.0,9.0,4,36.0,2.4,0.63
INV-00856800001,2016-10-10,4277,CORK IT!,769 PROSPECT ST SW,LE MARS,51031,bytearray(b'\x01\x01\x00\x00\x00\xa7!\xaa\xf0g\x0bX\xc0\x00\x02\xd6\xaa]cE@'),75,PLYMOUTH,,,370.0,PERNOD RICARD USA,160,CHIVAS REGAL 12YR W/50ML CHIVAS EXTRA & CHIVAS 18YR,6,850,17.49,26.24,3,78.72,2.55,0.67
INV-00693900156,2016-10-04,3495,GREAT PASTIMES,228 N MAIN ST,MONTICELLO,52310,bytearray(b'\x01\x01\x00\x00\x00R*\xe1\t\xbd\xcbV\xc0\x90\\7\xa5\xbc\x1eE@'),53,JONES,,,115.0,CONSTELLATION BRANDS INC,10549,BLACK VELVET TOASTED CARAMEL MINI DISCO,10,600,7.12,10.68,5,53.4,3.0,0.79
INV-00477600005,2016-09-22,2544,HY-VEE FOOD STORE / MARSHALLTOWN,802 SOUTH CENTER,MARSHALLTOWN,50158,bytearray(b'\x01\x01\x00\x00\x00\xe7\x8e\xfe\x97k:W\xc0|k`\xab\x04\x05E@'),64,MARSHALL,,,115,CONSTELLATION BRANDS INC,10549,BLACK VELVET TOASTED CARAMEL MINI DISCO,10,600,7.12,10.68,5,53.4,3.0,0.79
INV-01319400001,2016-11-01,2597,HY-VEE FOOD STORE / CHEROKEE,1300 N. SECOND,CHEROKEE,51012,bytearray(b'\x01\x01\x00\x00\x00\xa6\xd0y\x8d]\xe3W\xc0\x1e\xfc\xc4\x01\xf4aE@'),18,CHEROKEE,,,300.0,MCCORMICK DISTILLING CO.,2313,MCCORMICK EGG NOG W/2 GLASSES,6,750,8.49,12.74,4,50.96,3.0,0.79
INV-01315800001,2016-11-01,5230,POINT LIQUOR & TOBACCO,,,,,,,,,300,MCCORMICK DISTILLING CO.,2313,MCCORMICK EGG NOG W/2 GLASSES,6,750,8.49,12.74,4,50.96,3.0,0.79
INV-02301800008,2016-12-21,2536,HY-VEE / PLEASANT HILL,4815 MAPLE DRIVE,PLEASANT HILL,50317,bytearray(b'\x01\x01\x00\x00\x00\x89`\x1c\\:aW\xc0\xbd8\xf1\xd5\x8e\xccD@'),77,POLK,,,125.0,CEDAR RIDGE VINEYARDS LL,27849,CEDAR RIDGE RESERVE BOURBON,6,750,25.47,38.21,4,150.0,3.0,0.79
S30780800019,2016-02-17,3896,SMOKIN' JOE'S #18 TOBACCO AND LIQUOR,1901 BROADWAY ST,IOWA CITY,52240,bytearray(b'\x01\x01\x00\x00\x008\xf6\xec\xb9L\xe1V\xc0\xee\x9a\x90\xd6\x18\xd2D@'),52,JOHNSON,1032100.0,,115,"CONSTELLATION WINE COMPANY, INC.",34820,SVEDKA VODKA,12,750,8.25,12.38,4,49.52,3.0,0.79
S07038600019,2012-08-09,4057,TEQUILA'S LIQUOR STORE,1434 DES MOINES ST STE 5,DES MOINES,50316,bytearray(b'\x01\x01\x00\x00\x00\xd9\x99B\xe75fW\xc0\xc5\xc0:\x8e\x1f\xccD@'),77,POLK,1022200.0,,85,BROWN-FORMAN CORPORATION,3657,HERRADURA GOLD REPOSADO 6PAK,6,750,19.59,30.89,4,123.56,3.0,0.79
S30912900135,2016-02-24,2625,HY-VEE WINE AND SPIRITS #2,3301 W KIMBERLY RD,DAVENPORT,52804,,82,SCOTT,1062500.0,,305,MHW LTD,42204,BLUE CHAIR BAY BANANA,12,750,9.42,14.13,4,56.52,3.0,0.79
S33145900036,2016-06-30,5029,THE LIQUOR STOP LLC,"211, W 53RD ST",DAVENPORT,52806,bytearray(b'\x01\x01\x00\x00\x00<s\x0f\t\xdf\xa4V\xc0\xf5/Ie\x8a\xc9D@'),82,SCOTT,1062400.0,,240,"WILLIAM GRANT AND SONS, INC.",45886,SAILOR JERRY SPICED NAVY RUM,12,750,9.65,14.48,4,57.92,3.0,0.79
S32896100041,2016-06-16,2616,HY-VEE FOOD AND DRUG / CLINTON,901 SOUTH 4TH ST,CLINTON,52732,bytearray(b'\x01\x01\x00\x00\x005]Ot]\x8cV\xc0~Xo\xd4\n\xebD@'),23,CLINTON,1062400.0,,240,"WILLIAM GRANT AND SONS, INC.",45886,SAILOR JERRY SPICED NAVY RUM,12,750,9.65,14.48,4,57.92,3.0,0.79
S30476300098,2016-02-01,2560,HY-VEE FOOD STORE / MARION,3600 BUSINESS HWY 151 EAST,MARION,52302,,57,LINN,1082100.0,,420,"MOET HENNESSY USA, INC.",65126,GRAND MARNIER CORDON ROUGE,12,750,23.31,34.97,4,139.88,3.0,0.79
INV-02251200003,2016-12-20,3417,BIG G FOOD STORE,PO BOX 261  310 W DILLON,MARENGO,52301,,48,IOWA,,,421.0,SAZERAC COMPANY  INC,76436,OLD ST. NICK'S EGG NOG,12,750,3.64,5.46,4,21.84,3.0,0.79
INV-07658800158,2017-10-04,2616,HY-VEE FOOD AND DRUG / CLINTON,901 SOUTH 4TH ST,CLINTON,52732,bytearray(b'\x01\x01\x00\x00\x005]Ot]\x8cV\xc0~Xo\xd4\n\xebD@'),23,CLINTON,,,305,MHW LTD,80024,BLUE CHAIR BAY BANANA RUM CREAM,12,750,9.42,
Query:
SELECT *
FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
WHERE "category_name" ILIKE '%VODKA%'
  AND "date" >= '2022-01-01'
LIMIT 100;
Answer:
Too long, hard cut:
invoice_and_item_number,date,store_number,store_name,address,city,zip_code,store_location,county_number,county,category,category_name,vendor_number,vendor_name,item_number,item_description,pack,bottle_volume_ml,state_bottle_cost,state_bottle_retail,bottles_sold,sale_dollars,volume_sold_liters,volume_sold_gallons
INV-69572400250,2024-04-25,10389,HOME TOWN WINE AND SPIRIT / KEOKUK,1501 MAIN STREET,KEOKUK,52632.0,bytearray(b'\x01\x01\x00\x00\x00\x81&4\xdc\x0f\xd9V\xc0\xfa\xe0\xc1\xbe\xb93D@'),,LEE,1032100.0,IMPORTED VODKAS,260,DIAGEO AMERICAS,73094,CIROC LIMONATA,12,750,16.49,24.74,3,74.22,2.25,0.59
INV-60481000066,2023-07-19,2555,HY-VEE FOOD STORE (1324) / KEOKUK,3111 MAIN,KEOKUK,52632.0,bytearray(b'\x01\x01\x00\x00\x00\x84\x9b;\xe3\xc3\xd9V\xc0kb\xf3\x04Q5D@'),,LEE,1032200.0,IMPORTED FLAVORED VODKA,260,DIAGEO AMERICAS,75165,KETEL ONE BOTANICAL CUCUMBER & MINT,12,750,11.33,17.0,3,51.0,2.25,0.59
INV-52831100131,2022-11-08,2603,HY-VEE WINE AND SPIRITS / BETTENDORF,2890 DEVILS GLEN ROAD,BETTENDORF,52722.0,bytearray(b'\x01\x01\x00\x00\x00\x05\x86\xacn\xf5\x9eV\xc0.\xcf\x83\xbb\xb3\xc6D@'),,SCOTT,1032200.0,IMPORTED FLAVORED VODKA,260,DIAGEO AMERICAS,75165,KETEL ONE BOTANICAL CUCUMBER & MINT,12,750,11.33,17.0,3,51.0,2.25,0.59
INV-57333500022,2023-04-07,3465,HOMETOWN FOODS / PANORA,601 E MAIN,PANORA,50216.0,bytearray(b'\x01\x01\x00\x00\x00\x18\xd3\xd62\xe0\x96W\xc00\x1b\x95\xef\xa7\xd8D@'),,GUTHRIE,1032200.0,IMPORTED FLAVORED VODKA,260,DIAGEO AMERICAS,75181,KETEL ONE BOTANICAL GRAPEFRUIT & ROSE,12,750,11.33,17.0,3,51.0,2.25,0.59
INV-50049600229,2022-08-04,2538,HY-VEE FOOD STORE #3 / WATERLOO,1422 FLAMMANG DR,WATERLOO,50702.0,bytearray(b'\x01\x01\x00\x00\x00Cq\xc7\x9b\xfc\x14W\xc0\x04\x18\x96?\xdf:E@'),,BLACK HAWK,1032200.0,IMPORTED FLAVORED VODKA,260,DIAGEO AMERICAS,75181,KETEL ONE BOTANICAL GRAPEFRUIT & ROSE,12,750,11.33,17.0,3,51.0,2.25,0.59
INV-66644200059,2024-01-26,10333,"FAREWAY STORES, INC. #077B / NORWALK",2200 SUNSET DRIVE,NORWALK,50211.0,bytearray(b'\x01\x01\x00\x00\x00r1\xd1\xe3!kW\xc0.\xc15\xb9\x90\xbeD@'),,WARREN,1032200.0,IMPORTED FLAVORED VODKA,260,DIAGEO AMERICAS,75181,KETEL ONE BOTANICAL GRAPEFRUIT & ROSE,12,750,11.33,17.0,3,51.0,2.25,0.59
INV-73292400011,2024-08-16,4252,FAREWAY STORES #840 / MONTICELLO,433 NORTH FARLEY STREET,MONTICELLO,52310.0,"bytearray(b""\x01\x01\x00\x00\x00\x7fk\'JB\xccV\xc0\xfa\x8d\xe60\xee\x1eE@"")",,JONES,1032200.0,IMPORTED FLAVORED VODKA,260,DIAGEO AMERICAS,75183,KETEL ONE BOTANICAL PEACH & ORANGE BLOSSOM,12,750,11.33,17.0,3,51.0,2.25,0.59
INV-54668600244,2023-01-05,2572,HY-VEE FOOD STORE / CEDAR FALLS,6301 UNIVERSITY,CEDAR FALLS,50613,bytearray(b'\x01\x01\x00\x00\x00\xf2\x07\x03\xcf\xbd\x1bW\xc0\xe9\xc1\xddY\xbbAE@'),,BLACK HAWK,1032200.0,IMPORTED FLAVORED VODKA,260,DIAGEO AMERICAS,75183,KETEL ONE BOTANICAL PEACH & ORANGE BLOSSOM,12,750,11.33,17.0,3,51.0,2.25,0.59
INV-61012100014,2023-08-07,4230,FAREWAY STORES #106 / CLIVE,10151 UNIVERSITY AVE,CLIVE,50325.0,bytearray(b'\x01\x01\x00\x00\x00\xe7.\xb7\xebmpW\xc0\xa3\x85\x82T5\xcdD@'),,POLK,1032200.0,IMPORTED FLAVORED VODKA,260,DIAGEO AMERICAS,75183,KETEL ONE BOTANICAL PEACH & ORANGE BLOSSOM,12,750,11.33,17.0,3,51.0,2.25,0.59
INV-68534400106,2024-03-24,4169,SUPER QUICK 2 / HUBBELL,1824 HUBBELL AVE,DES MOINES,50317.0,bytearray(b'\x01\x01\x00\x00\x00\xe6\xb2P\xb9\x89eW\xc0\xabO\xf0OT\xccD@'),,POLK,1031200.0,AMERICAN FLAVORED VODKA,772,INTERCONTINENTAL PACKAGING COMPANY/PRESTIGE BEVERAGE GROUP,75198,KINKY BLUE,6,750,10.0,15.0,3,45.0,2.25,0.59
INV-65577700075,2023-12-22,2524,HY-VEE FOOD STORE #1 (1159) / DUBUQUE,3500 DODGE ST,DUBUQUE,52001.0,bytearray(b'\x01\x01\x00\x00\x00u(}\x006\xaeV\xc0\xae\xad\xd0\xee\xad>E@'),,DUBUQUE,1031200.0,AMERICAN FLAVORED VODKA,772,INTERCONTINENTAL PACKAGING COMPANY/PRESTIGE BEVERAGE GROUP,75198,KINKY BLUE,6,750,10.0,15.0,3,45.0,2.25,0.59
INV-57485400032,2023-04-12,2653,HY-VEE WINE AND SPIRITS / WASHINGTON,1004 W MADISON ST,WASHINGTON,52353.0,bytearray(b'\x01\x01\x00\x00\x00p\xed\x1b\xca\x16\xedV\xc0@b^.\xff\xa5D@'),,WASHINGTON,1031200.0,AMERICAN FLAVORED VODKA,772,INTERCONTINENTAL PACKAGING COMPANY/PRESTIGE BEVERAGE GROUP,75198,KINKY BLUE,6,750,10.0,15.0,3,45.0,2.25,0.59
INV-68915000076,2024-04-05,2618,HY-VEE DRUGSTORE #6 / CEDAR RAPIDS,505 BOYSON RD NE,CEDAR RAPIDS,52402.0,bytearray(b'\x01\x01\x00\x00\x00\xd3H]\xc8\xe9\xe8V\xc0\x1b:\x82\xc3\xe7\x05E@'),,LINN,1031200.0,AMERICAN FLAVORED VODKA,772,INTERCONTINENTAL PACKAGING COMPANY/PRESTIGE BEVERAGE GROUP,75198,KINKY BLUE,6,750,10.0,15.0,3,45.0,2.25,0.59
INV-57318500021,2023-04-07,6311,LIGHTNING LIQUOR AND SMOKE SHOP - BURLINGTON,624 ANGULAR STREET,BURLINGTON,52601.0,bytearray(b'\x01\x01\x00\x00\x00\xf4\xffeO\xe6\xc6V\xc0QZ:\xe4\xbbfD@'),,DES MOINES,1031200.0,AMERICAN FLAVORED VODKA,772,INTERCONTINENTAL PACKAGING COMPANY/PRESTIGE BEVERAGE GROUP,75210,KINKY PINK,6,750,10.0,15.0,3,45.0,2.25,0.59
INV-64369400031,2023-11-16,4511,SUPER QUICK / SE 30 DM,303 SE 30TH ST,DES MOINES,50317.0,bytearray(b'\x01\x01\x00\x00\x00\xd9\xcc\xec\xb6\xb5cW\xc0\xa6sM\x9a\x
Query:
SELECT "store_number", "store_name", SUM("sale_dollars") AS "total_sales_dollars"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01'
    GROUP BY "store_number", "store_name"
    ORDER BY "total_sales_dollars" DESC
    LIMIT 100;
Answer:
Too long, hard cut:
store_number,store_name,total_sales_dollars
2633,HY-VEE #3 / BDI / DES MOINES,40326490.22999999
4829,CENTRAL CITY 2,37179568.260000005
5916,ANOTHER ROUND / DEWITT,17450182.919999998
3773,BENZ DISTRIBUTING,13706848.05
2512,HY-VEE WINE AND SPIRITS #1 (1281) / IOWA CITY,10665945.850000003
3814,COSTCO WHOLESALE #788 / WDM,10576299.34
5102,WILKIE LIQUORS,10005976.930000002
4312,I-80 LIQUOR / COUNCIL BLUFFS,9988231.03
6242,WALL TO WALL WINE AND SPIRITS / WEST DES MOINES,9899922.169999996
3420,SAM'S CLUB 6344 / WINDSOR HEIGHTS,8598921.799999999
3385,SAM'S CLUB 8162 / CEDAR RAPIDS,8239790.3100000005
2663,HY-VEE FOOD STORE / URBANDALE,7671482.069999997
2670,HY-VEE FOOD STORE / CORALVILLE,6856516.610000001
4677,COSTCO WHOLESALE #1111 / CORALVILLE,6813402.389999999
3494,SAM'S CLUB 6514 / WATERLOO,6506959.360000002
2647,HY-VEE #7 / CEDAR RAPIDS,6489704.799999997
3447,SAM'S CLUB 6432 / SIOUX CITY,6480574.040000001
5144,SAM'S CLUB 6979 / ANKENY,6350959.9799999995
2665,HY-VEE / WAUKEE,6181162.099999998
2190,"CENTRAL CITY LIQUOR, INC.",5964593.790000001
2603,HY-VEE WINE AND SPIRITS / BETTENDORF,5931172.979999999
3354,SAM'S CLUB 8238 / DAVENPORT,5888910.680000002
2619,HY-VEE WINE AND SPIRITS / WDM,5872963.469999999
2614,HY-VEE #3 FOOD & DRUGSTORE / DAVENPORT,5838720.389999999
2512,HY-VEE WINE AND SPIRITS / IOWA CITY,5818034.62
2666,HY-VEE FOOD STORE #2 / STATE ANKENY,5307621.789999999
3477,SAM'S CLUB 6472 / COUNCIL BLUFFS,5157638.560000001
3944,SAM'S CLUB 4973 / DUBUQUE,5140687.95
2648,HY-VEE #4 / WDM,4904259.020000001
2629,HY-VEE FOOD STORE #2 / COUNCIL BLUFFS,4890856.760000001
5666,COSTCO WHOLESALE #1325 / DAVENPORT,4864606.949999999
6144,NORTHSIDE LIQUOR AND GROCERY / MASON CITY,4709774.75
3524,SAM'S CLUB 6568 / AMES,4687341.4399999995
2625,HY-VEE WINE & SPIRITS #2 / DAVENPORT,4669665.31
2590,HY-VEE FOOD STORE #5 / CEDAR RAPIDS,4511021.020000001
2635,HY-VEE #4 / DAVENPORT,4346947.080000001
2675,HY-VEE #2 / CORALVILLE,4346597.999999999
6209,HY-VEE / GRIMES,4195115.610000001
2501,HY-VEE  #2 (1018) / AMES,4194726.5
2201,HAPPY'S WINE & SPIRITS WHOLESALE,4124747.6799999997
10074,COSTCO WHOLESALE #1630 / ANKENY,4122018.8200000003
2130,SYCAMORE CONVENIENCE,4110776.590000001
2644,HY-VEE FORT DODGE WINE AND SPIRITS,4110255.149999999
2502,HY-VEE WINE AND SPIRITS (1022) / ANKENY,3941422.7400000007
2191,KEOKUK SPIRITS,3883023.7000000007
3390,OKOBOJI AVENUE LIQUOR,3860382.8600000003
2613,HY-VEE FOOD STORE #1 / COUNCIL BLUFFS,3816352.810000001
5444,MARSHALL BEER WINE SPIRITS,3737499.6800000006
2593,HY-VEE FOOD STORE / CARROLL,3649611.6400000006
2573,HY-VEE FOOD STORE / MUSCATINE,3603199.6300000004
2621,HY-VEE FOOD STORE #3 / SIOUX CITY,3595022.73
4988,HAPPY'S WINE & SPIRITS,3586230.529999999
2616,HY-VEE FOOD AND DRUG / CLINTON,3527226.0000000005
2572,HY-VEE FOOD STORE / CEDAR FALLS,3525822.3599999994
2624,HY-VEE #2 / DUBUQUE,3514604.040000001
5293,THE BOONEDOCKS,3391781.079999999
2515,HY-VEE FOOD STORE #1 (1410) / MASON CITY,3380027.4099999997
3820,"CHARLIE'S WINE AND SPIRITS,",3373055.860000001
2623,HY-VEE FOOD STORE #4 / SIOUX CITY,3325432.690000001
2651,HY-VEE / WAVERLY,3205212.6399999997
2548,HY-VEE FOOD STORE (1011) / ALTOONA,3072236.0199999996
4129,CYCLONE LIQUORS,3018019.1799999992
10065,MADELLA WINE AND SPIRITS / BETTENDORF,2954133.43
2561,HY-VEE FOOD STORE (1148) / FLEUR / DSM,2884695.710000001
2524,HY-VEE FOOD STORE #1 (1159) / DUBUQUE,2866904.3100000005
2642,HY-VEE WINE AND SPIRITS / PELLA,2822847.0700000003
5351,DOWNTOWN LIQUOR,2774202.859999999
2594,HY-VEE FOOD STORE / SIOUX CITY,2751908.429999999
2637,HY-VEE #5 / DAVENPORT,2751044.3100000005
2588,HY-VEE FOOD AND DRUG #6 / CEDAR RAPIDS,2688203.8800000004
2605,HY-VEE DRUGSTORE #5 / CEDAR RAPIDS,2635556.3700000006
2622,HY-VEE FOOD STORE / IOWA CITY,2635068.860000001
2620,HY-VEE / WINDSOR HEIGHTS,2629670.029999999
4969,LAKE LIQUORS WINE AND SPIRITS,2610844.3699999987
2587,HY-VEE FOOD STORE / JOHNSTON,2565506.229999999
2626,HY-VEE DRUGSTORE / UNIVERSITY / DSM,2549828.21
2106,HILLSTREET NEWS AND TOBACCO,2413762.0299999993
2560,HY-VEE FOOD STORE (1396) / MARION,2356853.9499999997
2528,HY-VEE FOOD STORE #3 (1142) / DES MOINES,2333466.5199999996
2549,HY-VEE FOOD STORE (1271) / INDIANOLA,2316761.98
2506,HY-VEE #2 (1044) / BURLINGTON,2290721.13
5257,MAD AVE QUIK SHOP,2290007.8200000003
2465,SID'S BEVERAGE SHOP,2237728.1399999997
2527,HY-VEE FOOD STORE #5 (1151) / DES MOINES,2221500.150000001
2538,HY-VEE FOOD STORE #3 (1866) / WATERLOO,2181047.9000000004
2649,HY-VEE #3 / DUBUQUE,2167209.8200000003
3525,WINES AND SPIRITS / WASHINGTON,2161043.4499999997
2582,HY-VEE #2 FOOD STORE / MASON CITY,2152686.4899999998
2606,HY-VEE WINE AND SPIRITS / HUMBOLDT,2140696.51
2643,HY-VEE WINE AND SPIRITS / WATERLOO,2130183.380000001
5600,H & A MINI MART,2112290.9699999997
3868,WAL-MART 3630 / MARION,2107462.81
2285,JOHN'S GROCERY,2084236.24
2591,HY-VEE WINE AND SPIRITS / ATLANTIC,2083075.0
2501,HY-VEE  #2 / AMES,2065575.3400000003
6316,BEER THIRTY CARROLL / CARROLL,2059999.6499999994
2502,HY-VEE WINE
Query:
SELECT "category", "category_name", AVG("bottle_volume_ml") AS "average_bottle_volume_ml"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    GROUP BY "category", "category_name"
    ORDER BY "average_bottle_volume_ml" DESC
    LIMIT 100;
Answer:
category,category_name,average_bottle_volume_ml
1070100.0,TEMPORARY & SPECIALTY PACKAGES,1750.000000
1011600.0,CORN WHISKIES,1727.393617
1071100.0,COCKTAILS/RTD,1540.303140
1071100.0,AMERICAN COCKTAILS,1534.270711
1082015.0,IMPORTED AMARETTO,1500.000000
1071000.0,COCKTAILS/RTD,1442.910303
1070000.0,COCKTAILS/RTD,1395.929622
1031100.0,100 PROOF VODKA,1109.822545
1062100.0,GOLD RUM,1097.438011
1062200.0,PUERTO RICO & VIRGIN ISLANDS RUM,1085.194030
1031080.0,VODKA 80 PROOF,1061.283861
1012200.0,SCOTCH WHISKIES,1044.534654
1032100.0,,1044.502408
1062200.0,WHITE RUM,1040.868368
1031000.0,AMERICAN VODKAS,1018.684359
1032230.0,IMPORTED VODKA - CHERRY,1000.000000
1041100.0,AMERICAN DRY GINS,998.367829
1041300.0,AMERICAN SLOE GINS,996.834374
1081350.0,SPEARMINT SCHNAPPS,986.936475
1011100.0,BLENDED WHISKIES,976.203366
1031100.0,AMERICAN VODKAS,969.776211
1062310.0,SPICED RUM,967.431829
1081500.0,TRIPLE SEC,951.311398
1012100.0,CANADIAN WHISKIES,950.260301
1062400.0,,934.073107
1081010.0,AMERICAN AMARETTO,933.372410
1062400.0,SPICED RUM,932.615184
1081340.0,ROOT BEER SCHNAPPS,928.745869
1042100.0,IMPORTED DRY GINS,926.669565
1081400.0,TRIPLE SEC,923.974470
1032080.0,IMPORTED VODKAS,908.981047
1081300.0,PEPPERMINT SCHNAPPS,906.561400
1032000.0,IMPORTED VODKAS,903.424486
1081317.0,GRAPE SCHNAPPS,902.062251
1051110.0,BLACKBERRY BRANDIES,899.345380
1081365.0,TROPICAL FRUIT SCHNAPPS,895.340098
1081330.0,PEACH SCHNAPPS,894.398659
1081370.0,WATERMELON SCHNAPPS,893.510424
1032100.0,IMPORTED VODKAS,884.866278
1062500.0,FLAVORED RUM,868.847493
1081390.0,IMPORTED SCHNAPPS,860.562180
1011200.0,STRAIGHT BOURBON WHISKIES,852.199285
1041200.0,AMERICAN SLOE GINS,849.507284
1701100.0,DECANTERS & SPECIALTY PACKAGES,846.418831
1062300.0,FLAVORED RUM,845.862229
1081335.0,RASPBERRY SCHNAPPS,844.722496
1081305.0,APPLE SCHNAPPS,843.252787
,,839.385236
1901000.0,SPECIAL ORDER ITEMS,836.613561
1012300.0,IRISH WHISKIES,831.883628
1011500.0,BOTTLED IN BOND BOURBON,830.888770
1081312.0,BUTTERSCOTCH SCHNAPPS,829.374044
1062300.0,AGED DARK RUM,818.575172
1081315.0,CINNAMON SCHNAPPS,810.165153
1081030.0,COFFEE LIQUEURS,808.121316
1062100.0,JAMAICA RUM,806.940084
1031200.0,VODKA FLAVORED,805.275096
1701200.0,HOLIDAY VAP,802.083333
1081380.0,MISCELLANEOUS SCHNAPPS,802.080309
1031090.0,OTHER PROOF VODKA,800.618011
1081100.0,COFFEE LIQUEURS,799.827897
1092100.0,IMPORTED DISTILLED SPIRITS SPECIALTY,799.662372
1081200.0,CREAM LIQUEURS,796.458882
1901100.0,DELISTED ITEMS,793.650794
1901200.0,SPECIAL ORDER ITEMS,793.349474
1082200.0,IMPORTED SCHNAPPS,776.305061
1081700.0,DISTILLED SPIRITS SPECIALTY,774.934001
1012400.0,IRISH WHISKIES,774.717846
1012300.0,SINGLE MALT SCOTCH,768.618506
1091200.0,NEUTRAL GRAIN SPIRITS,768.219432
1022100.0,TEQUILA,767.853542
1031110.0,LOW PROOF VODKA,765.335463
1012210.0,SINGLE MALT SCOTCH,762.496099
1011600.0,STRAIGHT RYE WHISKIES,757.595643
1051100.0,APRICOT BRANDIES,757.323613
1022100.0,MIXTO TEQUILA,756.995549
1011400.0,BOTTLED IN BOND BOURBON,756.895746
1012400.0,JAPANESE WHISKY,756.818182
1011300.0,TENNESSEE WHISKIES,756.579017
1022200.0,,755.136187
1022300.0,MEZCAL,753.561010
1101100.0,AMERICAN ALCOHOL,752.324340
1081210.0,CREME DE ALMOND,751.379522
1041150.0,FLAVORED GINS,751.255204
1011300.0,SINGLE BARREL BOURBON WHISKIES,750.738310
1081250.0,WHITE CREME DE MENTHE,750.203335
1081220.0,DARK CREME DE CACAO,750.189653
1081240.0,GREEN CREME DE MENTHE,750.069747
1042000.0,IMPORTED GINS,750.000000
1082010.0,AMARETTO - IMPORTED,750.000000
1081100.0,,750.000000
1081500.0,ROCK & RYE,750.000000
1081355.0,STRAWBERRY SCHNAPPS,750.000000
1900000.0,DELISTED / SPECIAL ORDER ITEMS,750.000000
1091400.0,IOWA DISTILLERIES,750.000000
1089290.0,,750.000000
1022300.0,,750.000000
1062250.0,,750.000000
1012000.0,IMPORTED WHISKIES,750.000000
101220.0,,750.000000
End Exploring Related Columns
Task: In the Iowa Liquor Sales dataset, starting from January 1, 2022 through the last fully completed month, which two liquor categories, each contributing an average of at least 1% to the monthly sales volume over at least 24 months of available data, have the lowest Pearson correlation coefficient when comparing their monthly percentages of total liquor sales across those months, and what are their names?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Category1,Category2
Brandy,Tequila
```

Brandy and Tequila are the two liquor categories that each contributed an average of at least 1% to the monthly sales volume over at least 24 months. They have the lowest Pearson correlation coefficient when comparing their monthly percentages of total liquor sales from January 1, 2022 through the last fully completed month..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'IOWA_LIQUOR_SALES': {'IOWA_LIQUOR_SALES': ['SALES']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-11 15:32:53 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 15:32:53 - root - INFO - ```sql
WITH total_volume_per_month AS (
    SELECT DATE_TRUNC('month', "date") AS "month",
           SUM("volume_sold_liters") AS "total_volume"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATE_TRUNC('month', CURRENT_DATE)
    GROUP BY "month"
),
category_volume_per_month AS (
    SELECT DATE_TRUNC('month', "date") AS "month",
           "category",
           "category_name",
           SUM("volume_sold_liters") AS "category_volume"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATE_TRUNC('month', CURRENT_DATE)
    GROUP BY "month", "category", "category_name"
),
category_percentage_per_month AS (
    SELECT c."month",
           c."category",
           c."category_name",
           c."category_volume" / t."total_volume" AS "percentage"
    FROM category_volume_per_month c
    JOIN total_volume_per_month t ON c."month" = t."month"
),
category_stats AS (
    SELECT "category",
           "category_name",
           COUNT(*) AS "months_with_data",
           AVG("percentage") AS "average_monthly_percentage"
    FROM category_percentage_per_month
    GROUP BY "category", "category_name"
    HAVING AVG("percentage") >= 0.01 AND COUNT(*) >= 24
),
selected_category_percentages AS (
    SELECT cpm."month",
           cpm."category",
           cpm."category_name",
           cpm."percentage"
    FROM category_percentage_per_month cpm
    WHERE cpm."category" IN (SELECT "category" FROM category_stats)
)
SELECT
    a."category_name" AS "Category1",
    b."category_name" AS "Category2"
FROM selected_category_percentages a
JOIN selected_category_percentages b ON a."month" = b."month" AND a."category" < b."category"
GROUP BY a."category", a."category_name", b."category", b."category_name"
ORDER BY CORR(a."percentage", b."percentage") ASC
LIMIT 1;
```
2025-02-11 15:32:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:32:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:32:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:32:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-11 15:32:55 - snowflake.connector.connection - INFO - closed
2025-02-11 15:32:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:32:55 - root - INFO - itercount: 1
2025-02-11 15:32:55 - root - INFO - 0
2025-02-11 15:32:55 - root - INFO - results: 
Category1,Category2
AMERICAN FLAVORED VODKA,CREAM LIQUEURS


2025-02-11 15:32:55 - root - INFO - Please check the answer again by reviewing In the Iowa Liquor Sales dataset, starting from January 1, 2022 through the last fully completed month, which two liquor categories, each contributing an average of at least 1% to the monthly sales volume over at least 24 months of available data, have the lowest Pearson correlation coefficient when comparing their monthly percentages of total liquor sales across those months, and what are their names?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: ```csv
Category1,Category2
Brandy,Tequila
```

Brandy and Tequila are the two liquor categories that each contributed an average of at least 1% to the monthly sales volume over at least 24 months. They have the lowest Pearson correlation coefficient when comparing their monthly percentages of total liquor sales from January 1, 2022 through the last fully completed month. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Category1,Category2
AMERICAN FLAVORED VODKA,CREAM LIQUEURS
Current sql:
WITH total_volume_per_month AS (
    SELECT DATE_TRUNC('month', "date") AS "month",
           SUM("volume_sold_liters") AS "total_volume"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATE_TRUNC('month', CURRENT_DATE)
    GROUP BY "month"
),
category_volume_per_month AS (
    SELECT DATE_TRUNC('month', "date") AS "month",
           "category",
           "category_name",
           SUM("volume_sold_liters") AS "category_volume"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATE_TRUNC('month', CURRENT_DATE)
    GROUP BY "month", "category", "category_name"
),
category_percentage_per_month AS (
    SELECT c."month",
           c."category",
           c."category_name",
           c."category_volume" / t."total_volume" AS "percentage"
    FROM category_volume_per_month c
    JOIN total_volume_per_month t ON c."month" = t."month"
),
category_stats AS (
    SELECT "category",
           "category_name",
           COUNT(*) AS "months_with_data",
           AVG("percentage") AS "average_monthly_percentage"
    FROM category_percentage_per_month
    GROUP BY "category", "category_name"
    HAVING AVG("percentage") >= 0.01 AND COUNT(*) >= 24
),
selected_category_percentages AS (
    SELECT cpm."month",
           cpm."category",
           cpm."category_name",
           cpm."percentage"
    FROM category_percentage_per_month cpm
    WHERE cpm."category" IN (SELECT "category" FROM category_stats)
)
SELECT
    a."category_name" AS "Category1",
    b."category_name" AS "Category2"
FROM selected_category_percentages a
JOIN selected_category_percentages b ON a."month" = b."month" AND a."category" < b."category"
GROUP BY a."category", a."category_name", b."category", b."category_name"
ORDER BY CORR(a."percentage", b."percentage") ASC
LIMIT 1;
2025-02-11 15:33:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-11 15:33:17 - root - INFO - ```csv
Category1,Category2
AMERICAN FLAVORED VODKA,CREAM LIQUEURS
```

```sql
WITH total_volume_per_month AS (
    SELECT DATE_TRUNC('month', "date") AS "month",
           SUM("volume_sold_liters") AS "total_volume"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATE_TRUNC('month', CURRENT_DATE)
    GROUP BY "month"
),
category_volume_per_month AS (
    SELECT DATE_TRUNC('month', "date") AS "month",
           "category",
           "category_name",
           SUM("volume_sold_liters") AS "category_volume"
    FROM "IOWA_LIQUOR_SALES"."IOWA_LIQUOR_SALES"."SALES"
    WHERE "date" >= '2022-01-01' AND "date" < DATE_TRUNC('month', CURRENT_DATE)
    GROUP BY "month", "category", "category_name"
),
category_percentage_per_month AS (
    SELECT c."month",
           c."category",
           c."category_name",
           c."category_volume" / t."total_volume" AS "percentage"
    FROM category_volume_per_month c
    JOIN total_volume_per_month t ON c."month" = t."month"
),
category_stats AS (
    SELECT "category",
           "category_name",
           COUNT(*) AS "months_with_data",
           AVG("percentage") AS "average_monthly_percentage"
    FROM category_percentage_per_month
    GROUP BY "category", "category_name"
    HAVING AVG("percentage") >= 0.01 AND COUNT(*) >= 24
),
selected_category_percentages AS (
    SELECT cpm."month",
           cpm."category",
           cpm."category_name",
           cpm."percentage"
    FROM category_percentage_per_month cpm
    WHERE cpm."category" IN (SELECT "category" FROM category_stats)
)
SELECT
    a."category_name" AS "Category1",
    b."category_name" AS "Category2"
FROM selected_category_percentages a
JOIN selected_category_percentages b ON a."month" = b."month" AND a."category" < b."category"
GROUP BY a."category", a."category_name", b."category", b."category_name"
ORDER BY CORR(a."percentage", b."percentage") ASC
LIMIT 1;
```
2025-02-11 15:33:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-11 15:33:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-11 15:33:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-11 15:33:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-11 15:33:18 - snowflake.connector.connection - INFO - closed
2025-02-11 15:33:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-11 15:33:19 - root - INFO - itercount: 2
2025-02-11 15:33:19 - root - INFO - 0
2025-02-11 15:33:19 - root - INFO - Total iteration counts: 2
