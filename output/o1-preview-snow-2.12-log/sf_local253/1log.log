2025-02-10 11:46:29 - openai._base_client - INFO - Retrying request to /chat/completions in 0.401710 seconds
2025-02-10 11:46:54 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 11:46:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:46:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:46:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:46:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-02-10 11:46:56 - snowflake.connector.connection - INFO - closed
2025-02-10 11:46:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:46:56 - root - INFO - SQL:
SELECT DISTINCT "Location"
   FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
   LIMIT 100;
Results:
Location
Bangalore
Pune
Hyderabad
New Delhi
Mumbai

2025-02-10 11:46:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:46:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:46:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:46:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:46:57 - snowflake.connector.connection - INFO - closed
2025-02-10 11:46:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:46:58 - root - INFO - SQL:
SELECT DISTINCT "CompanyName"
   FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
   LIMIT 100;
Results:
CompanyName
Mu Sigma
IBM
Tata Consultancy Services
Impact Analytics
Accenture
Infosys
Capgemini
Cognizant Technology Solutions
Anheuser-Busch InBev
Fractal
Embibe
Amazon
Google
Flipkart
HP Inc.
Wipro
Ericsson-Worldwide
MiQ
Deloitte
Genpact
Fresher
Honeywell
Affine
Myntra
Oracle
Ola
Walmart Global Tech
Wipro Technologies
HCL Technologies
Cisco Systems
FlyNava Technologies
Nokia
LinkedIn
Bharti Airtel
YouPlus
ascena
Innodatatics
Mobile Premier League
Apple
Flutura
Jio
First Student
Noodle.ai
ABB
Swiggy
Idexcel
Mphasis
Blueocean Market Intelligence
J.P. Morgan
Knowledge Lens
ITC Infotech
NeenOpal
Robert Bosch
Two Roads Tech
NetApp
Exposys Data Labs
TheMathCompany
Flip Robo
Mercedes-Benz International
QuantZig
Tech Data
Caterpillar
HCL
Société Générale
Fuzzy Logix
Bharat Light & Power
Nielsen
Fidelity Investments
Mercedes-Benz Research and Development India
Hewlett Packard Enterprise | HPE
EY
Robert Bosch India
UnitedHealth Group
UniQreate
Shadowfax Technologies
Rolls-Royce
Everlytics
Publicis Sapient
Artificial Learning Systems
PwC
Terra Economics and Analytics Lab
Money View
NovelSynth Soft Solutions
Dun & Bradstreet
DXC Technology
Philips
[24]7.ai
SAP
Thoucentric
Walmart
Brillio
Great Learning
Optum
Adobe
Scienaptic Systems
Citi
Dell Technologies
Applied Materials
Target
CRED

2025-02-10 11:46:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:46:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:46:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:46:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:46:59 - snowflake.connector.connection - INFO - closed
2025-02-10 11:46:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:46:59 - root - INFO - SQL:
SELECT "Salary"
   FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
   LIMIT 100;
Results:
Salary
"₹6,48,573/yr"
"₹11,91,950/yr"
"₹8,36,874/yr"
"₹6,69,578/yr"
"₹9,44,110/yr"
"₹9,08,764/yr"
"₹9,26,124/yr"
"₹7,36,708/yr"
"₹16,46,721/yr"
"₹13,92,960/yr"
"₹14,04,773/yr"
"₹15,07,343/yr"
"₹15,58,095/yr"
"₹25,57,843/yr"
"₹15,10,081/yr"
"₹7,32,821/yr"
"₹12,21,750/yr"
"₹17,39,484/yr"
"₹11,24,939/yr"
"₹16,30,396/yr"
"₹10,09,436/yr"
"₹5,50,980/yr"
"₹18,70,000/yr"
"₹7,58,376/yr"
"₹15,56,575/yr"
"₹11,94,327/yr"
"₹14,70,000/yr"
"₹15,49,942/yr"
"₹10,09,436/yr"
"₹15,41,572/yr"
"₹8,11,182/yr"
"₹12,05,874/yr"
"₹7,27,111/yr"
"₹19,23,257/yr"
"₹21,43,501/yr"
"₹19,26,965/yr"
"₹41,271/mo"
"₹12,94,984/yr"
"₹23,34,960/yr"
"₹22,67,616/yr"
"₹13,66,992/yr"
"₹14,53,427/yr"
"₹14,58,032/yr"
"₹17,30,166/yr"
"₹6,58,109/yr"
"₹7,94,460/yr"
"₹25,67,381/yr"
"₹16,37,231/yr"
"₹9,00,000/yr"
"₹9,02,935/yr"
"₹9,70,782/yr"
"₹10,50,000/yr"
"₹21,19,584/yr"
"₹16,87,111/yr"
"₹14,65,641/yr"
"₹6,00,000/yr"
"₹18,05,869/yr"
"₹26,24,063/yr"
"₹9,55,297/yr"
"₹7,61,478/yr"
"₹28,05,476/yr"
"₹9,69,112/yr"
"₹4,50,979/yr"
"₹13,38,795/yr"
"₹10,40,493/yr"
"₹12,91,549/yr"
"₹49,928/mo"
"₹16,63,189/yr"
"₹13,23,387/yr"
"₹12,46,266/yr"
"₹4,94,147/yr"
"₹18,92,758/yr"
"₹15,72,054/yr"
"₹20,24,533/yr"
"₹19,27,564/yr"
"₹8,00,000/yr"
"₹20,09,790/yr"
"₹8,31,462/yr"
"₹5,16,323/yr"
"₹23,33,241/yr"
"₹12,00,000/yr"
"₹20,06,522/yr"
"₹21,60,000/yr"
"₹13,41,316/yr"
"₹16,34,105/yr"
"₹13,89,256/yr"
"₹10,00,000/yr"
"₹12,31,116/yr"
"₹23,52,941/yr"
"₹7,44,551/yr"
"₹30,14,686/yr"
"₹13,57,204/yr"
"₹10,53,196/yr"
"₹13,37,606/yr"
"₹48,825/mo"
"₹32,953/mo"
"₹16,49,930/yr"
"₹11,38,060/yr"
"₹16,12,744/yr"
"₹4,32,776/yr"

2025-02-10 11:46:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:46:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:46:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:47:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-10 11:47:00 - snowflake.connector.connection - INFO - closed
2025-02-10 11:47:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:48:06 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 11:48:06 - root - INFO - ```sql
SELECT
  "Location",
  "CompanyName",
  "AvgSalaryState",
  "AvgSalaryCountry"
FROM (
  SELECT
    t1."Location",
    t1."CompanyName",
    t1."AvgSalaryState",
    t2."AvgSalaryCountry",
    ROW_NUMBER() OVER (PARTITION BY t1."Location" ORDER BY t1."AvgSalaryState" DESC) AS rn
  FROM (
    SELECT
      "Location",
      "CompanyName",
      AVG(TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', ''))) AS "AvgSalaryState"
    FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
    WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
    GROUP BY "Location", "CompanyName"
  ) t1
  JOIN (
    SELECT
      "CompanyName",
      AVG(TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', ''))) AS "AvgSalaryCountry"
    FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
    GROUP BY "CompanyName"
  ) t2 ON t1."CompanyName" = t2."CompanyName"
) sub
WHERE sub.rn <= 5
ORDER BY sub."Location", sub."AvgSalaryState" DESC;
```
2025-02-10 11:48:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:48:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:48:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:48:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-02-10 11:48:07 - snowflake.connector.connection - INFO - closed
2025-02-10 11:48:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:49:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 11:49:30 - root - INFO - SQL:
SELECT
  "Location",
  "CompanyName",
  "AvgSalaryState",
  "AvgSalaryCountry"
FROM (
  SELECT
    t1."Location",
    t1."CompanyName",
    t1."AvgSalaryState",
    t2."AvgSalaryCountry",
    ROW_NUMBER() OVER (PARTITION BY t1."Location" ORDER BY t1."AvgSalaryState" DESC) AS rn
  FROM (
    SELECT
      "Location",
      "CompanyName",
      AVG(TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', ''))) AS "AvgSalaryState"
    FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
    WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
    GROUP BY "Location", "CompanyName"
  ) t1
  JOIN (
    SELECT
      "CompanyName",
      AVG(TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', ''))) AS "AvgSalaryCountry"
    FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
    GROUP BY "CompanyName"
  ) t2 ON t1."CompanyName" = t2."CompanyName"
) sub
WHERE sub.rn <= 5
ORDER BY sub."Location", sub."AvgSalaryState" DESC;
Results:
Location,CompanyName,AvgSalaryState,AvgSalaryCountry
Hyderabad,Qwerty Concepts,5081882.000000,5081882.000000
Hyderabad,SetuServ,4949704.000000,4949704.000000
Hyderabad,XYZ (Turkey),3000000.000000,1510743.500000
Hyderabad,ABCDEF,2745265.500000,1643757.750000
Hyderabad,MarketLinc,2658491.000000,2658491.000000
Mumbai,Rahul Industries,6044006.000000,3037137.500000
Mumbai,NVIDIA,4187500.000000,1541363.333333
Mumbai,VINAYA KUMAR,4029337.000000,2414668.500000
Mumbai,Goldman Sachs,3977066.000000,1903402.600000
Mumbai,Zee Entertainment Enterprises Ltd.,3531413.000000,3531413.000000
New Delhi,Super Highway Labs,3665141.000000,3665141.000000
New Delhi,Greenlight Planet,2876666.000000,1918288.500000
New Delhi,Boston Scientific,2707106.000000,2707106.000000
New Delhi,DreamOrbit Softech,2612697.000000,2612697.000000
New Delhi,OLX Group,2606510.000000,2606510.000000
Pune,Atos,5273205.000000,5273205.000000
Pune,Volkswagen,5184922.000000,5184922.000000
Pune,RAKESH GROUP,5016304.000000,5016304.000000
Pune,The City Bank,5000000.000000,5000000.000000
Pune,DasDas,4466071.000000,4466071.000000

2025-02-10 11:49:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:49:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:49:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:49:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:49:31 - snowflake.connector.connection - INFO - closed
2025-02-10 11:49:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:49:31 - root - INFO - SQL:
-- Corrected SQL 1
SELECT TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', '')) AS "CleanedSalary"
FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
LIMIT 100
Results:
CleanedSalary
648573
1191950
836874
669578
944110
908764
926124
736708
1646721
1392960
1404773
1507343
1558095
2557843
1510081
732821
1221750
1739484
1124939
1630396
1009436
550980
1870000
758376
1556575
1194327
1470000
1549942
1009436
1541572
811182
1205874
727111
1923257
2143501
1926965
41271
1294984
2334960
2267616
1366992
1453427
1458032
1730166
658109
794460
2567381
1637231
900000
902935
970782
1050000
2119584
1687111
1465641
600000
1805869
2624063
955297
761478
2805476
969112
450979
1338795
1040493
1291549
49928
1663189
1323387
1246266
494147
1892758
1572054
2024533
1927564
800000
2009790
831462
516323
2333241
1200000
2006522
2160000
1341316
1634105
1389256
1000000
1231116
2352941
744551
3014686
1357204
1053196
1337606
48825
32953
1649930
1138060
1612744
432776

2025-02-10 11:49:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:49:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:49:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:49:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:49:32 - snowflake.connector.connection - INFO - closed
2025-02-10 11:49:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:49:33 - root - INFO - SQL:
-- Corrected SQL 2
SELECT "CompanyName", "Location", "Salary"
FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
WHERE "Location" = 'Mumbai'
LIMIT 100
Results:
CompanyName,Location,Salary
Fractal,Mumbai,"₹16,43,351/yr"
Tata Consultancy Services,Mumbai,"₹5,66,756/yr"
Accenture,Mumbai,"₹9,00,000/yr"
Capgemini,Mumbai,"₹10,55,889/yr"
Jio,Mumbai,"₹10,37,441/yr"
Reliance Industries,Mumbai,"₹17,73,222/yr"
Housing.com,Mumbai,"₹23,83,368/yr"
Quantiphi,Mumbai,"₹9,19,025/yr"
Axis Bank,Mumbai,"₹11,93,674/yr"
LTI,Mumbai,"₹6,44,930/yr"
HDFC Bank,Mumbai,"₹10,70,583/yr"
Vodafone Idea,Mumbai,"₹20,09,767/yr"
CASHe,Mumbai,"₹10,98,034/yr"
Infosys,Mumbai,"₹11,02,095/yr"
Cognizant Technology Solutions,Mumbai,"₹8,30,959/yr"
Deloitte,Mumbai,"₹11,91,942/yr"
First Student,Mumbai,"₹12,10,857/yr"
CitiusTech,Mumbai,"₹2,94,111/yr"
RBL Bank,Mumbai,"₹11,80,704/yr"
ZEE5,Mumbai,"₹14,58,789/yr"
Mahindra Integrated Business Solutions,Mumbai,"₹9,74,832/yr"
DataScientest,Mumbai,"₹45,684/mo"
Pentation Analytics,Mumbai,"₹6,50,654/yr"
NDS InfoServ,Mumbai,"₹9,26,744/yr"
Arya.ai,Mumbai,"₹8,38,354/yr"
Wipro,Mumbai,"₹30,368/mo"
Amazon,Mumbai,"₹10,18,095/yr"
IBM,Mumbai,"₹11,93,120/yr"
PwC,Mumbai,"₹14,49,831/yr"
Google,Mumbai,"₹13,55,169/yr"
Atos-Syntel,Mumbai,"₹8,75,733/yr"
Siemens,Mumbai,"₹12,57,890/yr"
Mahindra,Mumbai,"₹10,22,850/yr"
eClerx,Mumbai,"₹7,33,769/yr"
HERE Technologies,Mumbai,"₹17,82,011/yr"
HDFC Standard Life Insurance,Mumbai,"₹12,21,714/yr"
Morningstar,Mumbai,"₹9,57,432/yr"
L&T Financial Services,Mumbai,"₹8,86,778/yr"
Piramal Enterprises,Mumbai,"₹72,216/mo"
Piramal Enterprises,Mumbai,"₹11,60,523/yr"
Episource,Mumbai,"₹8,94,949/yr"
XPO Logistics,Mumbai,"₹15,81,030/yr"
Loylty Rewardz Mngt,Mumbai,"₹12,23,523/yr"
Karza Technologies,Mumbai,"₹17,00,000/yr"
Prudential plc,Mumbai,"₹11,08,264/yr"
Dure Technologies,Mumbai,"₹12,89,859/yr"
Tata Consultancy Services,Mumbai,"₹18,737/mo"
Tech Mahindra,Mumbai,"₹8,85,892/yr"
EY,Mumbai,"₹10,25,737/yr"
Fresher,Mumbai,"₹50,367/mo"
ICICI Bank,Mumbai,"₹49,111/mo"
Microsoft,Mumbai,"₹2,16,685/mo"
ABC,Mumbai,"₹10,36,761/yr"
Kotak Mahindra,Mumbai,"₹66,648/mo"
Freshworks,Mumbai,"₹4,94,353/yr"
NVIDIA,Mumbai,"₹41,87,500/yr"
HERE Technologies,Mumbai,"₹41,940/mo"
Fractal,Mumbai,"₹39,822/mo"
MAERSK,Mumbai,"₹17,17,206/yr"
Tata AIG General Insurance,Mumbai,"₹14,06,673/yr"
General Mills,Mumbai,"₹17,34,062/yr"
Motilal Oswal Securities,Mumbai,"₹6,49,989/yr"
Hdfc,Mumbai,"₹64,952/mo"
Tata Group,Mumbai,"₹9,77,421/yr"
PharmEasy,Mumbai,"₹14,51,194/yr"
Decimal Point Analytics,Mumbai,"₹11,26,055/yr"
People Group,Mumbai,"₹13,14,654/yr"
MiQ,Mumbai,"₹12,40,055/yr"
UPL,Mumbai,"₹9,91,653/yr"
Lead School (India),Mumbai,"₹1,10,833/mo"
LogiNext Solutions,Mumbai,"₹4,65,001/yr"
Bewakoof Brands,Mumbai,"₹7,30,703/yr"
Meru Mobility Tech,Mumbai,"₹9,60,996/yr"
Kissht,Mumbai,"₹56,676/mo"
Radhakrishna Foodland,Mumbai,"₹3,04,060/yr"
Tableau Software,Mumbai,"₹28,65,536/yr"
FlexiLoans Technologies,Mumbai,"₹8,27,693/yr"
Square Panda,Mumbai,"₹6,76,720/yr"
Think Analytics,Mumbai,"₹6,06,168/yr"
Locobuzz,Mumbai,"₹8,35,493/yr"
SMEcorner,Mumbai,"₹40,725/mo"
Quantsapp,Mumbai,"₹18,926/mo"
HDFC Developers,Mumbai,"₹14,94,696/yr"
Javis,Mumbai,"₹20,75,185/yr"
Cuddle,Mumbai,"₹19,61,487/yr"
Arohi Operations,Mumbai,"₹30,834/mo"
Accenture,Mumbai,"₹1,01,809/yr"
IBM,Mumbai,"$2,05,476/yr"
IBM,Mumbai,"₹7,02,485/yr"
HCL Technologies,Mumbai,"₹14,17,138/yr"
Oracle,Mumbai,"₹10,00,000/yr"
BYJU'S,Mumbai,"₹10,00,000/yr"
LTI,Mumbai,"₹6,13,163/yr"
Mindtree,Mumbai,"₹10,31,658/yr"
Microsoft,Mumbai,"₹45,172/mo"
J.P. Morgan,Mumbai,"₹21,86,509/yr"
J.P. Morgan,Mumbai,"₹81,105/mo"
Cisco Systems,Mumbai,"₹10,880/mo"
ABC,Mumbai,"$96,739/yr"
Reliance Industries,Mumbai,"₹9,59,911/yr"

2025-02-10 11:49:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:49:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:49:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:49:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:49:34 - snowflake.connector.connection - INFO - closed
2025-02-10 11:49:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:49:34 - root - INFO - SQL:
-- Corrected SQL 3
SELECT "CompanyName", AVG(TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', ''))) AS "AvgSalary"
FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
WHERE "Location" = 'Mumbai'
GROUP BY "CompanyName"
LIMIT 100
Results:
CompanyName,AvgSalary
Fractal,948593.200000
Tata Consultancy Services,303868.555556
Accenture,611859.800000
Jio,750159.333333
Reliance Industries,686877.600000
Housing.com,2383368.000000
Quantiphi,440232.100000
Axis Bank,736602.333333
LTI,482902.000000
HDFC Bank,949680.000000
Vodafone Idea,2009767.000000
CASHe,1098034.000000
Cognizant Technology Solutions,702609.000000
Deloitte,893336.333333
First Student,403978.750000
ZEE5,1082536.000000
Mahindra Integrated Business Solutions,974832.000000
NDS InfoServ,926744.000000
Arya.ai,838354.000000
Google,633084.800000
Atos-Syntel,596458.000000
Infosys,840363.333333
DataScientest,45684.000000
Pentation Analytics,650654.000000
PwC,860093.666667
IBM,823493.000000
Mahindra,684695.333333
eClerx,480246.500000
HERE Technologies,687286.000000
HDFC Standard Life Insurance,1221714.000000
L&T Financial Services,886778.000000
Loylty Rewardz Mngt,1223523.000000
Dure Technologies,1289859.000000
Tech Mahindra,885892.000000
Kotak Mahindra,66648.000000
Motilal Oswal Securities,649989.000000
Hdfc,64952.000000
Tata Group,977421.000000
PharmEasy,514873.666667
Decimal Point Analytics,600401.750000
People Group,664962.500000
Lead School (India),110833.000000
Bewakoof Brands,831538.500000
Radhakrishna Foodland,304060.000000
Tableau Software,2865536.000000
Think Analytics,320968.000000
Quantsapp,18926.000000
HCL Technologies,869495.500000
Capgemini Engineering,45172.000000
Virtusa,237656.000000
L&T Technology Services,368431.500000
Tata Motors,62472.000000
Angel One,527662.666667
Moody's Analytics,1362714.000000
BDO,790515.000000
infrasoft technologies,488006.000000
vPhrase,702792.500000
Development Credit Bank Limited,524564.000000
DXC Technology,731418.000000
ICICI Lombard General Insurance Company Limited,814476.000000
Mondelēz International,2098257.000000
Barclays,1040054.000000
Stellar Organisation,338792.000000
Moneytor,30821.000000
Capgemini,789216.000000
CitiusTech,955754.666667
Wipro,30368.000000
Siemens,1156846.000000
RBL Bank,1180704.000000
Amazon,1010146.500000
Morningstar,661035.000000
Piramal Enterprises,571052.800000
Episource,992560.000000
XPO Logistics,1581030.000000
Karza Technologies,863948.500000
Prudential plc,1167295.500000
EY,739888.000000
Fresher,34244.250000
Microsoft,379100.666667
ABC,595485.000000
NVIDIA,4187500.000000
Tata AIG General Insurance,1406673.000000
UPL,991653.000000
LogiNext Solutions,465001.000000
Meru Mobility Tech,960996.000000
Kissht,56676.000000
FlexiLoans Technologies,827693.000000
Locobuzz,835493.000000
SMEcorner,276252.000000
Cuddle,1961487.000000
J.P. Morgan,1004043.333333
Cisco Systems,10880.000000
Flipkart,2576614.000000
Mu Sigma,1585281.500000
Bharti Airtel,604401.000000
Intel Corporation,94844.000000
State Bank of India,1816155.000000
Yes Bank,203619.000000
TCS,293629.000000
Mercedes-Benz Research and Development India,1251537.000000

2025-02-10 11:49:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:49:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:49:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:49:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:49:35 - snowflake.connector.connection - INFO - closed
2025-02-10 11:49:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:49:35 - root - INFO - SQL:
-- Corrected SQL 4
SELECT "CompanyName", COUNT(*) AS "SalariesCount"
FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
GROUP BY "CompanyName"
ORDER BY "SalariesCount" DESC
LIMIT 100
Results:
CompanyName,SalariesCount
Tata Consultancy Services,41
Amazon,32
Accenture,30
Google,27
IBM,26
Fresher,26
First Student,25
Infosys,23
Cognizant Technology Solutions,21
DONE by NONE,21
ABC,20
Wipro,17
Microsoft,17
Capgemini,17
Deloitte,16
Tech Mahindra,16
LTI,16
Nones,15
Fractal,14
Quantiphi,14
Wipro Technologies,14
HCL Technologies,14
Genpact,13
Optum,12
Freelancer,11
PwC,10
ZS Associates,10
Honeywell,10
DXC Technology,10
NTT DATA,9
Jio,9
Dell Technologies,9
KPMG,9
XYZ,9
Virtusa,9
American Express,9
TCS,9
EY,9
Reliance Industries,9
ICICI Bank,9
Anonymous,9
Mu Sigma,9
Optum Global Solutions,8
Innodatatics,8
J.P. Morgan,8
Axis Bank,8
Adobe,8
UnitedHealth Group,8
Mindtree,8
Oracle,8
Atos-Syntel,8
Tata Consultancy Services (North America),8
EMPLOYERS,8
WNS,8
Siemens,7
Barclays,7
Tiger Analytics,7
Maxgen Technologies,7
MAERSK,7
Flipkart,7
Course5 Intelligence,7
Citi,7
OYO,7
iNeuron,7
HSBC,7
Novartis,7
Ugam,7
Persistent Systems,7
TEKsystems,7
Bajaj Finance,7
Publicis Sapient,7
Schlumberger,7
Mahindra,6
SG Analytics,6
Mercedes-Benz Research and Development India,6
Red Hat,6
Techolution,6
GE,6
EXL Service,6
Fresherworld.com,6
Tableau Software,6
ThinkBumblebee Analytics,6
Wells Fargo,6
Freshers.com,6
Mastercard,6
Abzooba,6
Kantar,6
Enquero,6
Datametica,6
ITC Infotech,6
Piramal Enterprises,6
SAP,6
Credit Suisse,6
Anonymous Content,6
Cisco Systems,6
Cyient,6
Ericsson-Worldwide,5
Nielsen,5
Fidelity Investments,5
Verizon,5

2025-02-10 11:49:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:49:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:49:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:49:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:49:36 - snowflake.connector.connection - INFO - closed
2025-02-10 11:49:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:49:37 - root - INFO - SQL:
-- Corrected SQL 5
SELECT "CompanyName", AVG(TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', ''))) AS "AvgNationalSalary"
FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
GROUP BY "CompanyName"
LIMIT 100
Results:
CompanyName,AvgNationalSalary
Mu Sigma,837406.777778
IBM,697564.923077
Tata Consultancy Services,453467.853659
Accenture,658121.100000
Infosys,727739.347826
Capgemini,753792.117647
Cognizant Technology Solutions,568052.190476
Anheuser-Busch InBev,1425940.666667
Fractal,972820.714286
Embibe,1314907.000000
Google,1202518.851852
Flipkart,1204149.000000
HP Inc.,1141776.200000
Wipro,740449.823529
Ericsson-Worldwide,685326.200000
MiQ,1538585.250000
Deloitte,936493.812500
Microsoft,982857.705882
Fresher,221045.615385
Flutura,931079.000000
Fuzzy Logix,1556575.000000
Affine,784572.000000
Bharat Light & Power,808672.000000
First Student,311641.920000
Walmart Global Tech,1321157.000000
SAP,1079052.666667
Brillio,1075812.000000
Happiest Minds Technologies,1036507.000000
Noodle.ai,1175607.666667
Scienaptic Systems,1291549.000000
FlyNava Technologies,49928.000000
Idexcel,601965.500000
Citi,1327199.428571
Aptus Data Labs,726734.750000
CRED,3014686.000000
ANZ Bank,1111352.000000
Artivatic Data Labs,649755.000000
InMobi,1700000.000000
Fidelity Investments,1233345.400000
Cisco Systems,990140.166667
INSOFE,751723.000000
Adobe,850445.625000
Swiggy,1403670.666667
GE Healthcare,1061007.000000
Ericsson IT Solutions & Services,1072989.000000
UniQreate,516323.000000
Everlytics,432776.000000
Siemens,623141.142857
Mindtree,661573.250000
Hinduja Global Solutions,960451.000000
GE Digital,1463805.000000
Innodatatics,448540.250000
upGrad,399330.000000
Zoom Video Communications,2839076.000000
Tata,1439736.500000
NTT Ltd.,134323.000000
Cartesian Consulting,742603.500000
Head Digital Works,977543.000000
HDFC Standard Life Insurance,1199622.500000
Flip Robo,87060.250000
Terra Economics and Analytics Lab,720000.000000
mfine,1625481.000000
SalesKen,1039792.000000
Volvo Group,1200000.000000
Genpact,494632.076923
Société Générale,4099921.000000
Jio,845938.000000
Antuit,1205874.000000
[24]7.ai,773328.500000
Ola,1483888.750000
Mercedes-Benz Research and Development India,1199758.500000
Great Learning,884572.750000
Hewlett Packard Enterprise | HPE,1144763.666667
Optum,1041432.583333
Dell Technologies,1058908.000000
FICO,1634105.000000
IQVIA,693982.750000
ShareChat,2300000.000000
MAERSK,1124309.571429
Caterpillar,1526335.000000
VMware,2189676.500000
Accentue,1041548.500000
Kabbage,1117778.000000
Sutherland,737504.333333
Impact Analytics,515136.333333
DXC Technology,761862.700000
Myntra,1442248.666667
Oracle,1126035.500000
Tredence,927895.000000
HCL Technologies,705485.500000
EY,793424.777778
Subex,948156.000000
Nokia,870151.750000
UnitedHealth Group,987090.250000
LinkedIn,1225515.666667
Shadowfax Technologies,1232332.500000
Applied Materials,1374542.000000
Blueocean Market Intelligence,744551.000000
J.P. Morgan,964828.375000
Knowledge Lens,48825.000000

2025-02-10 11:49:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:49:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:49:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:49:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:49:38 - snowflake.connector.connection - INFO - closed
2025-02-10 11:49:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:49:38 - root - INFO - SQL:
-- Corrected SQL 6
SELECT "CompanyName", AVG(TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', ''))) AS "AvgSalaryHyderabad"
FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
WHERE "Location" = 'Hyderabad'
GROUP BY "CompanyName"
LIMIT 100
Results:
CompanyName,AvgSalaryHyderabad
Microsoft,1424931.200000
Cyient,542333.000000
Infosys,588163.250000
Amazon,452094.142857
Tech Mahindra,382072.666667
Jotter,618746.500000
Cognizant Technology Solutions,517920.285714
Verizon,1109216.000000
Optum,1206212.333333
Accenture,713493.000000
Novartis,502761.333333
Karvy Group,304548.000000
HighRadius,437780.000000
Google,1166513.666667
Blue Yonder,2020386.000000
DataScientest,56039.000000
Genpact,480471.250000
DXC Technology,1284729.500000
Dell Technologies,877553.333333
Sutherland,573825.500000
Enquero,1148838.000000
Brane Enterprises (nslhub),1665911.000000
AlgonoX Technologies,1074883.000000
Persistent Systems,664440.000000
DBS Bank,839115.750000
WinWire Technologies,1269639.000000
eKincare,650865.000000
Bepec Solutions,646889.000000
Prudent Technologies & Consulting,376159.000000
RisingRoot Technologies,13255.000000
diwo,792506.000000
Freelancer,503064.750000
DONE by NONE,277042.500000
Nones,285930.000000
Tiger Analytics,1221751.500000
SoCtronics,37271.000000
Molecular Connections,45220.000000
Gi Group,312358.000000
Innominds Software,670103.000000
Micron Technology,912937.333333
Tata Consultancy Services (North America),882399.000000
Virtusa,480943.750000
Dr. Reddy's,230611.500000
Optum Global Solutions,824493.666667
DigiTele Networks,787723.000000
Honeywell,1653407.000000
Hexaware Technologies,882154.500000
Infosys BPM,854151.000000
Fresherworld.com,300000.000000
Myntra,1394897.000000
GS Lab,56465.000000
Verzeo,12813.000000
MathWorks,605385.000000
AGS Health,413352.000000
Don't Know,25122.000000
Optum Global Solutions India,1628949.000000
Industryarc,1094666.000000
Intellect Design Arena,346152.000000
MOURI Tech,21116.000000
Zen3 Info Solutions,1262347.333333
Saras Analytics,703418.000000
Wells Fargo,805643.500000
Realshoppee Retail,41922.000000
BYJU'S,633866.000000
Tata Consultancy Services,589855.250000
Oracle,1180565.500000
INSOFE,903446.000000
Claim Genius,1944821.000000
Capgemini,642964.000000
MetLife,1760000.000000
Great Learning,777837.000000
CallHealth,823971.000000
Gaian Solutions India,1100233.000000
GoLorry,792139.000000
Mindtree,493096.666667
Mu Sigma,519381.500000
S&P Global,636288.666667
ABCDEF,2745265.500000
Government of India,312358.000000
upGrad,211160.000000
CBRE,733769.000000
Raja Software Labs,206332.000000
IVL Global,727471.000000
IBM,444414.600000
Jio,686809.333333
Deloitte,1154386.200000
Wipro,824595.250000
Fresher,221766.600000
Wipro Technologies,443818.500000
UnitedHealth Group,1144968.000000
Freshers.com,630000.000000
Legato Health Technologies,1082148.500000
Broadridge,1061463.000000
National Payments Corporation of India,1492543.000000
Excelra Knowledge Solutions,452130.000000
Siva Solutions,335625.000000
SysBasis Solutions,25204.000000
HSBC,695263.333333
State Bank of India,1159476.000000
HSBC Software Development India,1104068.333333

2025-02-10 11:49:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:49:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:49:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:49:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-10 11:49:39 - snowflake.connector.connection - INFO - closed
2025-02-10 11:49:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:50:04 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 11:50:04 - root - INFO - ```sql
SELECT
  "Location",
  "CompanyName",
  "AvgSalaryState",
  "AvgSalaryCountry"
FROM (
  SELECT
    t1."Location",
    t1."CompanyName",
    t1."AvgSalaryState",
    t2."AvgSalaryCountry",
    ROW_NUMBER() OVER (PARTITION BY t1."Location" ORDER BY t1."AvgSalaryState" DESC) AS rn
  FROM (
    SELECT
      "Location",
      "CompanyName",
      AVG(TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', ''))) AS "AvgSalaryState"
    FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
    WHERE "Location" ILIKE '%Mumbai%' OR "Location" ILIKE '%Pune%' OR "Location" ILIKE '%New Delhi%' OR "Location" ILIKE '%Hyderabad%'
    GROUP BY "Location", "CompanyName"
  ) t1
  JOIN (
    SELECT
      "CompanyName",
      AVG(TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', ''))) AS "AvgSalaryCountry"
    FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
    GROUP BY "CompanyName"
  ) t2 ON t1."CompanyName" = t2."CompanyName"
) sub
WHERE sub.rn <= 5
ORDER BY sub."Location", sub."AvgSalaryState" DESC;
```
2025-02-10 11:50:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:50:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:50:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:50:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-02-10 11:50:05 - snowflake.connector.connection - INFO - closed
2025-02-10 11:50:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:51:35 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 11:51:35 - root - INFO - SQL:
SELECT
  "Location",
  "CompanyName",
  "AvgSalaryState",
  "AvgSalaryCountry"
FROM (
  SELECT
    t1."Location",
    t1."CompanyName",
    t1."AvgSalaryState",
    t2."AvgSalaryCountry",
    ROW_NUMBER() OVER (PARTITION BY t1."Location" ORDER BY t1."AvgSalaryState" DESC) AS rn
  FROM (
    SELECT
      "Location",
      "CompanyName",
      AVG(TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', ''))) AS "AvgSalaryState"
    FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
    WHERE "Location" ILIKE '%Mumbai%' OR "Location" ILIKE '%Pune%' OR "Location" ILIKE '%New Delhi%' OR "Location" ILIKE '%Hyderabad%'
    GROUP BY "Location", "CompanyName"
  ) t1
  JOIN (
    SELECT
      "CompanyName",
      AVG(TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', ''))) AS "AvgSalaryCountry"
    FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
    GROUP BY "CompanyName"
  ) t2 ON t1."CompanyName" = t2."CompanyName"
) sub
WHERE sub.rn <= 5
ORDER BY sub."Location", sub."AvgSalaryState" DESC;
Results:
Location,CompanyName,AvgSalaryState,AvgSalaryCountry
Hyderabad,Qwerty Concepts,5081882.000000,5081882.000000
Hyderabad,SetuServ,4949704.000000,4949704.000000
Hyderabad,XYZ (Turkey),3000000.000000,1510743.500000
Hyderabad,ABCDEF,2745265.500000,1643757.750000
Hyderabad,MarketLinc,2658491.000000,2658491.000000
Mumbai,Rahul Industries,6044006.000000,3037137.500000
Mumbai,NVIDIA,4187500.000000,1541363.333333
Mumbai,VINAYA KUMAR,4029337.000000,2414668.500000
Mumbai,Goldman Sachs,3977066.000000,1903402.600000
Mumbai,Zee Entertainment Enterprises Ltd.,3531413.000000,3531413.000000
New Delhi,Super Highway Labs,3665141.000000,3665141.000000
New Delhi,Greenlight Planet,2876666.000000,1918288.500000
New Delhi,Boston Scientific,2707106.000000,2707106.000000
New Delhi,DreamOrbit Softech,2612697.000000,2612697.000000
New Delhi,OLX Group,2606510.000000,2606510.000000
Pune,Atos,5273205.000000,5273205.000000
Pune,Volkswagen,5184922.000000,5184922.000000
Pune,RAKESH GROUP,5016304.000000,5016304.000000
Pune,The City Bank,5000000.000000,5000000.000000
Pune,DasDas,4466071.000000,4466071.000000

2025-02-10 11:51:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:51:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:51:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:51:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:51:36 - snowflake.connector.connection - INFO - closed
2025-02-10 11:51:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:51:36 - root - INFO - SQL:
-- Corrected SQL 8
SELECT "JobTitle", "Salary"
FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
WHERE "Location" ILIKE '%Pune%'
LIMIT 100
Results:
JobTitle,Salary
Data Scientist,"₹7,17,331/yr"
Data Scientist,"₹11,63,186/yr"
Data Scientist,"₹10,36,536/yr"
Data Scientist,"₹7,42,883/yr"
Data Scientist,"₹12,94,039/yr"
Data Scientist,"₹11,54,579/yr"
Data Scientist,"₹7,65,632/yr"
Data Scientist,"₹6,02,937/yr"
Data Scientist,"₹11,50,000/yr"
Data Scientist,"₹8,54,957/yr"
Data Scientist,"₹9,56,307/yr"
Data Scientist,"₹8,16,946/yr"
Data Scientist,"₹10,70,536/yr"
Data Scientist,"₹11,46,043/yr"
Data Scientist,"₹11,14,163/yr"
Data Scientist,"₹20,54,972/yr"
Data Scientist,"₹11,34,768/yr"
Data Scientist,"₹8,78,252/yr"
Data Scientist,"₹8,98,351/yr"
Data Scientist,"₹8,14,017/yr"
Data Scientist,"₹4,25,000/yr"
Data Scientist,"₹9,40,423/yr"
Data Scientist,"₹11,21,845/yr"
Data Scientist,"₹12,15,906/yr"
Data Scientist,"₹10,55,811/yr"
Data Scientist,"₹16,22,612/yr"
Data Scientist,"₹42,249/mo"
Data Scientist,"₹7,18,534/yr"
Data Scientist,"₹4,23,422/yr"
Data Scientist,"₹17,33,746/yr"
Data Scientist,"₹16,55,120/yr"
Data Scientist,"₹14,21,672/yr"
Data Scientist,"₹9,34,857/yr"
Data Scientist,"₹8,56,429/yr"
Data Scientist,"₹18,00,000/yr"
Data Scientist,"₹4,11,680/yr"
Data Scientist,"₹61,248/mo"
Data Scientist,"₹51,920/mo"
Data Scientist,"₹2,32,796/mo"
Data Scientist,"₹10,01,630/yr"
Data Scientist,"₹15,77,759/yr"
Data Scientist,"₹52,491/mo"
Data Scientist,"₹52,16,933/yr"
Data Scientist,"₹14,63,658/yr"
Data Scientist,"₹17,72,001/yr"
Data Scientist,"₹8,34,387/yr"
Data Scientist,"₹8,28,221/yr"
Data Scientist,"₹1,00,275/mo"
Data Scientist,"₹9,32,104/yr"
Data Scientist,"₹9,83,550/yr"
Data Scientist,"₹25,446/mo"
Data Scientist,₹602/hr
Data Scientist,"₹53,475/mo"
Data Scientist,"₹11,61,602/yr"
Data Scientist,"₹63,058/mo"
Data Scientist,"₹46,977/mo"
Data Scientist,"₹2,83,914/yr"
Data Scientist,"₹7,31,758/yr"
Data Scientist,"₹16,87,208/yr"
Data Scientist,"₹7,13,466/yr"
Data Scientist,"₹56,250/mo"
Data Scientist,"₹4,99,961/yr"
Data Scientist,"₹8,95,000/yr"
Data Scientist,"₹2,53,851/yr"
Data Scientist,"₹6,37,645/yr"
Data Scientist,"₹19,54,650/yr"
Data Scientist,"₹6,69,083/yr"
Data Scientist,"₹18,33,778/yr"
Data Scientist,"₹25,000/mo"
Data Scientist,"£7,03,427/yr"
Data Scientist,"₹1,15,884/yr"
Data Scientist,"₹6,19,069/yr"
Data Scientist,"₹16,00,000/yr"
Data Scientist,"₹30,147/mo"
Data Scientist,"₹4,00,000/yr"
Data Scientist,"₹6,42,322/yr"
Data Scientist,"₹1,01,398/mo"
Data Scientist,"₹30,000/mo"
Data Scientist,"₹2,89,045/mo"
Data Scientist,"₹75,71,032/yr"
Data Scientist,"₹14,38,481/yr"
Data Scientist,"₹2,141/hr"
Data Scientist,"₹1,00,000/mo"
Data Scientist,"₹44,44,315/yr"
Data Scientist,"₹3,01,469/yr"
Data Scientist,"£2,05,049/yr"
Data Scientist,"₹70,000/mo"
Data Scientist,"₹6,00,000/yr"
Data Scientist,"₹6,42,322/yr"
Data Scientist,"₹9,05,000/yr"
Data Scientist,"₹6,23,238/yr"
Data Scientist,"₹8,70,000/yr"
Data Scientist,"₹64,232/mo"
Data Scientist,"₹12,50,000/yr"
Data Scientist,"₹11,76,710/yr"
Data Scientist,"₹4,14,794/yr"
Data Scientist,"₹25,69,287/yr"
Data Scientist,"₹14,04,565/yr"
Data Scientist,"₹7,87,318/yr"
Data Scientist,"₹20,54,972/yr"

2025-02-10 11:51:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:51:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:51:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:51:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:51:37 - snowflake.connector.connection - INFO - closed
2025-02-10 11:51:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:51:37 - root - INFO - SQL:
-- Corrected SQL 9
SELECT DISTINCT "CompanyName"
FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
WHERE "Location" ILIKE '%Mumbai%' 
   OR "Location" ILIKE '%Pune%' 
   OR "Location" ILIKE '%New Delhi%' 
   OR "Location" ILIKE '%Hyderabad%'
LIMIT 100
Results:
CompanyName
Tata Consultancy Services
Innoplexus
IBM
AlgoAnalytics Financial Consultancy
Wolters Kluwer
Accenture
Wipro
Zensar Technologies
Bajaj Finance
ThinkBumblebee Analytics
Michelin
Tech Mahindra
Schlumberger
First Student
Eaton
T-Systems
ABC
Amdocs
Barclays
Exela Technologies
Fresher
Citi
Xoriant
Globant
Datametica
Vyom Labs
Vishwakarma Institute of Technology
MindBowser Info Solutions
Larsen & Toubro
Concentrix
Hinduja Global Solutions
Dassault Systemes
C-DAC
AXA
Volkswagen
SS Supply Chain Solutions
Pratham
Smartek21
Nones Data Science
DBS Bank
ZS Associates
Axis Bank
GS Lab
ThinkBridge
Climate Connect
HiLabs (MD)
Persistent Systems
Nones
Other
Netcracker Technology
Nothing Something
Sokrati
Sandvik
Cognizant Softvision
Amphisoft Technologies
vPhrase
Optra Health
HiLabs
STL - Sterlite Technologies Limited
Internshala
IVL Global
TorcAI
Innoplexus Associate
Fiserv
Cognizant Technology Solutions
SG Analytics
Capgemini
LTI
KPIT Technologies
Credit Suisse
Freelancer
Knorex
CanWill Technologies
Coditation Systems
DXC Technology
KPMG
DONE by NONE
Kotak Mahindra
eClerx
Fractal
Apple
Fresh Gravity
Merkle
Infosys
Atos-Syntel
Saama Technologies
John Deere
Searce
e-Zest Solutions
Fusion Practices
DeepTek Medical Imaging
Jash Data Sciences
Genpact
Google
Honeywell
WNS
Siemens
Mahindra
Thoughtworks
Yash Technologies

2025-02-10 11:51:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:51:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:51:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:51:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:51:39 - snowflake.connector.connection - INFO - closed
2025-02-10 11:51:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:51:39 - root - INFO - SQL:
-- Corrected SQL 10
SELECT "CompanyName", COUNT(*) AS "SalariesReported"
FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
WHERE "Location" ILIKE '%New Delhi%'
GROUP BY "CompanyName"
ORDER BY "SalariesReported" DESC
LIMIT 100
Results:
CompanyName,SalariesReported
Google,8
Tata Consultancy Services,6
ABC,6
Amazon,5
Adobe,5
Snapdeal,5
Delhivery,5
OYO,5
Optum,5
American Express,5
Elucidata (MA),4
Freelancer,4
Innovaccer,4
Capgemini,4
Fresher,4
Genpact,4
Mastercard,4
Nagarro,4
Zomato,4
Accenture,4
EXL Service,4
IBM,4
Tech Mahindra,4
McKinsey Knowledge Center,4
Fractal,4
Optum Global Solutions,3
Decision Point,3
First Student,3
Nokia,3
Deloitte,3
Blackcoffer,3
UnitedHealth Group,3
Analytics Vidhya,3
Gemini Solutions,3
Infosys,3
WNS,3
ZS Associates,3
DXC Technology,3
HCL Technologies,3
IHS Markit,3
Publicis Sapient,3
Cognizant Technology Solutions,3
Ericsson-Worldwide,3
Gartner,3
DONE by NONE,3
Microsoft,3
Valiance Solutions,3
TCS,3
Atlan,3
Unified Healthcare Group,3
Paytm,3
Nones,2
ParallelDots,2
Ezappsolution,2
SupplyCopia,2
Dell Technologies,2
EasyRewardz,2
Lumiq (India),2
Info Edge,2
Absolutdata,2
Urban Company,2
Infogain,2
Octro,2
LiquidHub,2
Wipro Technologies,2
Concentrix,2
EY,2
KPMG,2
R Systems,2
Optum Global Solutions India,2
GALYTIX,2
Honeywell,2
Times Internet,2
LTI,2
Vidooly Media Tech,2
Ericsson IT Solutions & Services,2
Loginworks,2
McKinsey & Company,2
Monsoon (India),2
Evalueserve,2
Denave,2
Teleperformance,2
Aon,2
Pitney Bowes,2
iEnergizer,2
Tata Consultancy Services (North America),2
Bank of America,2
Yatra Online Pvt Ltd,2
Ameriprise,2
Coforge,2
dunnhumby,2
Wipro,2
J.P. Morgan,2
OLX Group,2
PolicyBazaar,2
Tokopedia,2
Samsung Electronics,2
MakeMyTrip,2
Bharti Airtel,2
Maruti Suzuki,2

2025-02-10 11:51:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:51:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:51:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:51:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:51:40 - snowflake.connector.connection - INFO - closed
2025-02-10 11:51:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:51:41 - root - INFO - SQL:
-- Corrected SQL 11
SELECT TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', '')) AS "NumericSalary"
FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
WHERE "Location" ILIKE '%Mumbai%'
LIMIT 100
Results:
NumericSalary
1643351
566756
900000
1055889
1037441
1773222
2383368
919025
1193674
644930
1070583
2009767
1098034
1102095
830959
1191942
1210857
294111
1180704
1458789
974832
45684
650654
926744
838354
30368
1018095
1193120
1449831
1355169
875733
1257890
1022850
733769
1782011
1221714
957432
886778
72216
1160523
894949
1581030
1223523
1700000
1108264
1289859
18737
885892
1025737
50367
49111
216685
1036761
66648
494353
4187500
41940
39822
1717206
1406673
1734062
649989
64952
977421
1451194
1126055
1314654
1240055
991653
110833
465001
730703
960996
56676
304060
2865536
827693
676720
606168
835493
40725
18926
1494696
2075185
1961487
30834
101809
205476
702485
1417138
1000000
1000000
613163
1031658
45172
2186509
81105
10880
96739
959911

2025-02-10 11:51:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:51:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:51:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:51:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:51:42 - snowflake.connector.connection - INFO - closed
2025-02-10 11:51:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:51:42 - root - INFO - SQL:
-- Corrected SQL 12
SELECT "CompanyName", "Location", TRY_TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', '')) AS "NumericSalary"
FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
WHERE TRY_TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', '')) > 1000000
LIMIT 100
Results:
CompanyName,Location,NumericSalary
IBM,Bangalore,1191950
Anheuser-Busch InBev,Bangalore,1646721
Fractal,Bangalore,1392960
Embibe,Bangalore,1404773
Amazon,Bangalore,1507343
Google,Bangalore,1558095
Flipkart,Bangalore,2557843
HP Inc.,Bangalore,1510081
Ericsson-Worldwide,Bangalore,1221750
MiQ,Bangalore,1739484
Deloitte,Bangalore,1124939
Microsoft,Bangalore,1630396
Genpact,Bangalore,1009436
Société Générale,Bangalore,1870000
Fuzzy Logix,Bangalore,1556575
DXC Technology,Bangalore,1194327
Jio,Bangalore,1470000
Honeywell,Bangalore,1549942
Affine,Bangalore,1009436
Philips,Bangalore,1541572
Antuit,Bangalore,1205874
[24]7.ai,Bangalore,1923257
Fidelity Investments,Bangalore,2143501
Myntra,Bangalore,1926965
Oracle,Bangalore,1294984
Ola,Bangalore,2334960
Walmart Global Tech,Bangalore,2267616
Tredence,Bangalore,1366992
Intel Corporation,Bangalore,1453427
Mercedes-Benz Research and Development India,Bangalore,1458032
SAP,Bangalore,1730166
Walmart,Bangalore,2567381
Brillio,Bangalore,1637231
Happiest Minds Technologies,Bangalore,1050000
Hewlett Packard Enterprise | HPE,Bangalore,2119584
Noodle.ai,Bangalore,1687111
Cisco Systems,Bangalore,1465641
Optum,Bangalore,1805869
Adobe,Bangalore,2624063
Swiggy,Bangalore,2805476
ZS Associates,Bangalore,1338795
Robert Bosch India,Bangalore,1040493
Scienaptic Systems,Bangalore,1291549
Nokia,Bangalore,1663189
UnitedHealth Group,Bangalore,1323387
Sigmoid Analytics,Bangalore,1246266
Citi,Bangalore,1892758
GE Healthcare,Bangalore,1572054
SigTuple,Bangalore,2024533
Dell Technologies,Bangalore,1927564
Ericsson IT Solutions & Services,Bangalore,2009790
LinkedIn,Bangalore,2333241
Apexon,Bangalore,1200000
Shadowfax Technologies,Bangalore,2006522
Bharti Airtel,Bangalore,2160000
Applied Materials,Bangalore,1341316
FICO,Bangalore,1634105
YouPlus,Bangalore,1389256
Target,Bangalore,1231116
Gojek,Bangalore,2352941
CRED,Bangalore,3014686
Rolls-Royce,Bangalore,1357204
Curl Analytics,Bangalore,1053196
J.P. Morgan,Bangalore,1337606
ascena,Bangalore,1649930
QuantZig,Bangalore,1138060
Baker Hughes,Bangalore,1612744
ANZ Bank,Bangalore,1512297
Lowe's Home Improvement,Bangalore,1752935
Nones,Bangalore,1197944
HDFC Standard Life Insurance,Bangalore,1177531
AntWorks,Bangalore,1194925
American Express,Bangalore,1693208
Knowledge Foundry,Bangalore,1119069
Nones,Bangalore,1013978
TVS Motor Company,Bangalore,1252803
Publicis Sapient,Bangalore,1670405
Hinduja Global Solutions,Bangalore,1284643
GE Digital,Bangalore,1653106
MakeMyTrip,Bangalore,1200000
Artificial Learning Systems,Bangalore,1124740
Dailyhunt,Bangalore,2600000
Draup,Bangalore,1859109
PwC,Bangalore,1205874
Robert Bosch,Bangalore,1180355
Two Roads Tech,Bangalore,3812913
ExxonMobil,Bangalore,2873437
Bidgely,Bangalore,1438481
ShareChat,Bangalore,2300000
MAERSK,Bangalore,2207174
Caterpillar,Bangalore,1526335
NetApp,Bangalore,2875549
Spoonshot,Bangalore,1615535
InMobi,Bangalore,1700000
Swiss Re,Bangalore,1352802
Shell,Bangalore,2148775
upGrad,Bangalore,1284643
Legato Health Technologies,Bangalore,1200000
HDFC Bank,Bangalore,1105385
Halodoc,Bangalore,1879205

2025-02-10 11:51:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:51:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:51:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:51:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-02-10 11:51:43 - snowflake.connector.connection - INFO - closed
2025-02-10 11:51:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:51:44 - root - INFO - SQL:
-- Corrected SQL 13
SELECT "Location", AVG(TRY_TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', ''))) AS "AvgSalaryByLocation"
FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
WHERE "Salary" IS NOT NULL AND "Salary" != ''
GROUP BY "Location"
LIMIT 100
Results:
Location,AvgSalaryByLocation
Bangalore,892445.762626
Pune,736137.405868
Hyderabad,677650.000000
New Delhi,692217.763720
Mumbai,669215.609400

2025-02-10 11:51:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:51:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:51:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:51:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 29
2025-02-10 11:51:45 - snowflake.connector.connection - INFO - closed
2025-02-10 11:51:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:51:45 - root - INFO - SQL:
-- Corrected SQL 14
SELECT "CompanyName"
FROM (
  SELECT "CompanyName", COUNT(DISTINCT CASE 
      WHEN "Location" ILIKE '%Mumbai%' THEN 'Mumbai'
      WHEN "Location" ILIKE '%Pune%' THEN 'Pune'
      WHEN "Location" ILIKE '%New Delhi%' THEN 'New Delhi'
      WHEN "Location" ILIKE '%Hyderabad%' THEN 'Hyderabad'
    END) AS "CityCount"
  FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
  WHERE "Location" ILIKE '%Mumbai%' 
     OR "Location" ILIKE '%Pune%' 
     OR "Location" ILIKE '%New Delhi%' 
     OR "Location" ILIKE '%Hyderabad%'
  GROUP BY "CompanyName"
) AS sub
WHERE "CityCount" = 4
LIMIT 100
Results:
CompanyName
Tata Consultancy Services
IBM
Cognizant Technology Solutions
Wipro
Tech Mahindra
Capgemini
LTI
First Student
Amazon
Accenture
Larsen & Toubro
WNS
Fresherworld.com
HCL Technologies
Fresher
Google
Tata Consultancy Services (North America)
DONE by NONE
DXC Technology
Infosys
Anonymous
Microsoft
ABC
Deloitte
EMPLOYERS
The Sparks Foundation
Kantar
BYJU'S
Nones

2025-02-10 11:51:45 - root - INFO - itercount: 0
2025-02-10 11:51:45 - root - INFO - Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,0
table_name,WEB_ORDERS
description,
DDL,"create or replace TABLE WEB_ORDERS (
	""id"" NUMBER(38,0),
	""account_id"" NUMBER(38,0),
	""occurred_at"" VARCHAR(16777216),
	""standard_qty"" NUMBER(38,0),
	""gloss_qty"" NUMBER(38,0),
	""poster_qty"" NUMBER(38,0),
	""total"" NUMBER(38,0),
	""standard_amt_usd"" FLOAT,
	""gloss_amt_usd"" FLOAT,
	""poster_amt_usd"" FLOAT,
	""total_amt_usd"" FLOAT
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,1
table_name,HARDWARE_FACT_MANUFACTURING_COST
description,
DDL,"create or replace TABLE HARDWARE_FACT_MANUFACTURING_COST (
	""product_code"" VARCHAR(16777216),
	""cost_year"" NUMBER(38,0),
	""manufacturing_cost"" FLOAT
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,2
table_name,SALARYDATASET
description,
DDL,"create or replace TABLE SALARYDATASET (
	""index"" NUMBER(38,0),
	""CompanyName"" VARCHAR(16777216),
	""JobTitle"" VARCHAR(16777216),
	""SalariesReported"" FLOAT,
	""Location"" VARCHAR(16777216),
	""Salary"" VARCHAR(16777216)
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,3
table_name,WEB_SALES_REPS
description,
DDL,"create or replace TABLE WEB_SALES_REPS (
	""id"" NUMBER(38,0),
	""name"" VARCHAR(16777216),
	""region_id"" NUMBER(38,0)
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,4
table_name,HARDWARE_DIM_PRODUCT
description,
DDL,"create or replace TABLE HARDWARE_DIM_PRODUCT (
	""product_code"" VARCHAR(16777216),
	""division"" VARCHAR(16777216),
	""segment"" VARCHAR(16777216),
	""category"" VARCHAR(16777216),
	""product"" VARCHAR(16777216),
	""variant"" VARCHAR(16777216)
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,5
table_name,HARDWARE_FACT_GROSS_PRICE
description,
DDL,"create or replace TABLE HARDWARE_FACT_GROSS_PRICE (
	""product_code"" VARCHAR(16777216),
	""fiscal_year"" NUMBER(38,0),
	""gross_price"" FLOAT
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,6
table_name,HARDWARE_FACT_SALES_MONTHLY
description,
DDL,"create or replace TABLE HARDWARE_FACT_SALES_MONTHLY (
	""date"" VARCHAR(16777216),
	""product_code"" VARCHAR(16777216),
	""customer_code"" NUMBER(38,0),
	""sold_quantity"" NUMBER(38,0),
	""fiscal_year"" NUMBER(38,0)
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,7
table_name,UNIVERSITY_FACULTY
description,
DDL,"create or replace TABLE UNIVERSITY_FACULTY (
	""FacNo"" NUMBER(38,0),
	""FacFirstName"" VARCHAR(16777216),
	""FacLastName"" VARCHAR(16777216),
	""FacCity"" VARCHAR(16777216),
	""FacState"" VARCHAR(16777216),
	""FacDept"" VARCHAR(16777216),
	""FacRank"" VARCHAR(16777216),
	""FacSalary"" NUMBER(38,0),
	""FacSupervisor"" FLOAT,
	""FacHireDate"" VARCHAR(16777216),
	""FacZipCode"" VARCHAR(16777216)
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,8
table_name,WEB_EVENTS
description,
DDL,"create or replace TABLE WEB_EVENTS (
	""id"" NUMBER(38,0),
	""account_id"" NUMBER(38,0),
	""occurred_at"" VARCHAR(16777216),
	""channel"" VARCHAR(16777216)
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,9
table_name,HARDWARE_DIM_CUSTOMER
description,
DDL,"create or replace TABLE HARDWARE_DIM_CUSTOMER (
	""customer_code"" NUMBER(38,0),
	""customer"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216),
	""channel"" VARCHAR(16777216),
	""market"" VARCHAR(16777216),
	""sub_zone"" VARCHAR(16777216),
	""region"" VARCHAR(16777216)
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,10
table_name,STAFFHOURS
description,
DDL,"create or replace TABLE STAFFHOURS (
	""StaffMember"" VARCHAR(16777216),
	""EventDate"" VARCHAR(16777216),
	""EventTime"" VARCHAR(16777216),
	""EventType"" VARCHAR(16777216)
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,11
table_name,UNIVERSITY_COURSE
description,
DDL,"create or replace TABLE UNIVERSITY_COURSE (
	""CourseNo"" VARCHAR(16777216),
	""CrsDesc"" VARCHAR(16777216),
	""CrsUnits"" NUMBER(38,0)
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,12
table_name,UNIVERSITY_ENROLLMENT
description,
DDL,"create or replace TABLE UNIVERSITY_ENROLLMENT (
	""OfferNo"" NUMBER(38,0),
	""StdNo"" NUMBER(38,0),
	""EnrGrade"" FLOAT
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,13
table_name,UNIVERSITY_OFFERING
description,
DDL,"create or replace TABLE UNIVERSITY_OFFERING (
	""OfferNo"" NUMBER(38,0),
	""CourseNo"" VARCHAR(16777216),
	""OffTerm"" VARCHAR(16777216),
	""OffYear"" NUMBER(38,0),
	""OffLocation"" VARCHAR(16777216),
	""OffTime"" VARCHAR(16777216),
	""FacNo"" FLOAT,
	""OffDays"" VARCHAR(16777216)
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,14
table_name,UNIVERSITY_STUDENT
description,
DDL,"create or replace TABLE UNIVERSITY_STUDENT (
	""StdNo"" NUMBER(38,0),
	""StdFirstName"" VARCHAR(16777216),
	""StdLastName"" VARCHAR(16777216),
	""StdCity"" VARCHAR(16777216),
	""StdState"" VARCHAR(16777216),
	""StdZip"" VARCHAR(16777216),
	""StdMajor"" VARCHAR(16777216),
	""StdClass"" VARCHAR(16777216),
	""StdGPA"" FLOAT
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,15
table_name,WEB_ACCOUNTS
description,
DDL,"create or replace TABLE WEB_ACCOUNTS (
	""id"" NUMBER(38,0),
	""name"" VARCHAR(16777216),
	""website"" VARCHAR(16777216),
	""lat"" FLOAT,
	""long"" FLOAT,
	""primary_poc"" VARCHAR(16777216),
	""sales_rep_id"" NUMBER(38,0)
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,16
table_name,WEB_REGION
description,
DDL,"create or replace TABLE WEB_REGION (
	""id"" NUMBER(38,0),
	""name"" VARCHAR(16777216)
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,17
table_name,HARDWARE_FACT_PRE_INVOICE_DEDUCTIONS
description,
DDL,"create or replace TABLE HARDWARE_FACT_PRE_INVOICE_DEDUCTIONS (
	""customer_code"" NUMBER(38,0),
	""fiscal_year"" NUMBER(38,0),
	""pre_invoice_discount_pct"" FLOAT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'EDUCATION_BUSINESS': {'EDUCATION_BUSINESS': ['WEB_ORDERS', 'HARDWARE_FACT_MANUFACTURING_COST', 'SALARYDATASET', 'WEB_SALES_REPS', 'HARDWARE_DIM_PRODUCT', 'HARDWARE_FACT_GROSS_PRICE', 'HARDWARE_FACT_SALES_MONTHLY', 'UNIVERSITY_FACULTY', 'WEB_EVENTS', 'HARDWARE_DIM_CUSTOMER', 'STAFFHOURS', 'UNIVERSITY_COURSE', 'UNIVERSITY_ENROLLMENT', 'UNIVERSITY_OFFERING', 'UNIVERSITY_STUDENT', 'WEB_ACCOUNTS', 'WEB_REGION', 'HARDWARE_FACT_PRE_INVOICE_DEDUCTIONS']}}
Begin Exploring Related Columns
**Relevant Table and Columns:**

- **Table**: `SALARYDATASET`
- **Columns and Potential Usage**:
  - `"CompanyName"`: Used to identify and group data by company.
  - `"Location"`: Used to filter data for the specified cities (Mumbai, Pune, New Delhi, Hyderabad).
  - `"Salary"`: Needs to be cleaned to remove non-numeric characters and converted to numeric type for calculations.
  - `"JobTitle"`: Could provide additional context or be used for further filtering if needed.
  - `"SalariesReported"`: Represents the number of salaries reported; could be used to weight averages or assess data reliability.

**Conditions that May Be Used:**

- Filtering `"Location"` to include only Mumbai, Pune, New Delhi, and Hyderabad.
- Extracting numeric values from `"Salary"` using string functions or regular expressions.
- Grouping data by `"CompanyName"` and `"Location"` to calculate average salaries.
- Comparing each company's average salary in a city to their national average.

---

**SQL Queries to Explore the Data:**

1. **View Distinct Locations in the Dataset:**
   ```sql
   SELECT DISTINCT "Location"
   FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
   LIMIT 100;
   ```
   
2. **List Distinct Company Names:**
   ```sql
   SELECT DISTINCT "CompanyName"
   FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
   LIMIT 100;
   ```
   
3. **Sample Salaries to Inspect Non-Numeric Characters:**
   ```sql
   SELECT "Salary"
   FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
   LIMIT 100;
   ```
   
4. **Filter Salaries with Non-Numeric Characters:**
   ```sql
   SELECT "Salary"
   FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
   WHERE REGEXP_LIKE("Salary", '[^0-9.]')
   LIMIT 100;
   ```
   
5. **Extract Numeric Salary Values Using Regular Expression:**
   ```sql
   SELECT REGEXP_REPLACE("Salary", '[^0-9.]', '') AS "CleanedSalary"
   FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
   LIMIT 100;
   ```
   
6. **View Sample Data for Mumbai:**
   ```sql
   SELECT "CompanyName", "Location", "Salary"
   FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
   WHERE "Location" ILIKE '%Mumbai%'
   LIMIT 100;
   ```
   
7. **Calculate Average Salary per Company in Mumbai (Before Cleaning):**
   ```sql
   SELECT "CompanyName", AVG(TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', ''))) AS "AvgSalary"
   FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
   WHERE "Location" ILIKE '%Mumbai%'
   GROUP BY "CompanyName"
   LIMIT 100;
   ```
   
8. **List Top Companies by Number of Salaries Reported Nationwide:**
   ```sql
   SELECT "CompanyName", COUNT(*) AS "SalariesCount"
   FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
   GROUP BY "CompanyName"
   ORDER BY "SalariesCount" DESC
   LIMIT 100;
   ```
   
9. **Find Average Salary Nationwide per Company:**
   ```sql
   SELECT "CompanyName", AVG(TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', ''))) AS "AvgNationalSalary"
   FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
   GROUP BY "CompanyName"
   LIMIT 100;
   ```
   
10. **Compare Company’s Average Salary in Hyderabad to National Average:**
    ```sql
    SELECT 
      "CompanyName",
      AVG(TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', ''))) AS "AvgSalaryHyderabad"
    FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
    WHERE "Location" ILIKE '%Hyderabad%'
    GROUP BY "CompanyName"
    LIMIT 100;
    ```
    
11. **Check for Any Null or Missing Salary Values:**
    ```sql
    SELECT *
    FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
    WHERE "Salary" IS NULL OR "Salary" = ''
    LIMIT 100;
    ```
    
12. **List Salaries for Specific Job Titles in Pune:**
    ```sql
    SELECT "JobTitle", "Salary"
    FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
    WHERE "Location" ILIKE '%Pune%'
    LIMIT 100;
    ```
    
13. **Find Companies Present in Multiple Specified Cities:**
    ```sql
    SELECT DISTINCT "CompanyName"
    FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
    WHERE "Location" ILIKE '%Mumbai%' 
       OR "Location" ILIKE '%Pune%' 
       OR "Location" ILIKE '%New Delhi%' 
       OR "Location" ILIKE '%Hyderabad%'
    LIMIT 100;
    ```
    
14. **Count Number of Salaries Reported per Company in New Delhi:**
    ```sql
    SELECT "CompanyName", COUNT(*) AS "SalariesReported"
    FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
    WHERE "Location" ILIKE '%New Delhi%'
    GROUP BY "CompanyName"
    ORDER BY "SalariesReported" DESC
    LIMIT 100;
    ```
    
15. **Check Distribution of Salaries in Mumbai After Cleaning:**
    ```sql
    SELECT TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', '')) AS "NumericSalary"
    FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
    WHERE "Location" ILIKE '%Mumbai%'
    LIMIT 100;
    ```
    
16. **Identify Potential Anomalies or Outliers in Salaries:**
    ```sql
    SELECT "CompanyName", "Location", TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', '')) AS "NumericSalary"
    FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
    WHERE TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', '')) > 1000000
    LIMIT 100;
    ```
    
17. **Aggregate Average Salary by Location Across All Companies:**
    ```sql
    SELECT "Location", AVG(TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', ''))) AS "AvgSalaryByLocation"
    FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
    GROUP BY "Location"
    LIMIT 100;
    ```
    
18. **List Companies with Salaries Reported in All Specified Cities:**
    ```sql
    SELECT "CompanyName"
    FROM (
      SELECT "CompanyName", COUNT(DISTINCT CASE 
          WHEN "Location" ILIKE '%Mumbai%' THEN 'Mumbai'
          WHEN "Location" ILIKE '%Pune%' THEN 'Pune'
          WHEN "Location" ILIKE '%New Delhi%' THEN 'New Delhi'
          WHEN "Location" ILIKE '%Hyderabad%' THEN 'Hyderabad'
        END) AS "CityCount"
      FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
      WHERE "Location" ILIKE '%Mumbai%' 
         OR "Location" ILIKE '%Pune%' 
         OR "Location" ILIKE '%New Delhi%' 
         OR "Location" ILIKE '%Hyderabad%'
      GROUP BY "CompanyName"
    ) AS sub
    WHERE "CityCount" = 4
    LIMIT 100;
    ```

**Notes:**

- **Cleaning the Salary Data**: Since the `"Salary"` column contains non-numeric characters, we use `REGEXP_REPLACE("Salary", '[^0-9.]', '')` to remove all non-digit and non-period characters. This cleans the salary values, allowing us to convert them to numeric type using `TO_NUMBER()` for calculations.
- **Filtering Locations**: The `ILIKE` operator is used to perform a case-insensitive match, and `%` wildcards handle potential variations in how locations are recorded (e.g., 'Mumbai', 'Mumbai, India').
- **Grouping and Aggregation**: We group data by `"CompanyName"` and sometimes by `"Location"` to calculate averages and counts, which will be crucial for identifying the top companies per city and comparing to national averages.
- **Limitations**: The `LIMIT 100` clause ensures that we do not retrieve an excessive amount of data during exploration. In a real analysis, you might remove this limit or adjust it as necessary.
- **Data Exploration**: These queries help in understanding the data distribution, identifying any anomalies, and preparing for the final query that answers the task.

**Next Steps:**

- Use the insights gained from these queries to construct the final SQL query that fulfills the task requirements, ensuring that data cleaning is properly handled, and averages are correctly calculated for both city-specific and national salary comparisons.Query:
SELECT DISTINCT "Location"
   FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
   LIMIT 100;
Answer:
Location
Bangalore
Pune
Hyderabad
New Delhi
Mumbai
Query:
SELECT DISTINCT "CompanyName"
   FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
   LIMIT 100;
Answer:
CompanyName
Mu Sigma
IBM
Tata Consultancy Services
Impact Analytics
Accenture
Infosys
Capgemini
Cognizant Technology Solutions
Anheuser-Busch InBev
Fractal
Embibe
Amazon
Google
Flipkart
HP Inc.
Wipro
Ericsson-Worldwide
MiQ
Deloitte
Genpact
Fresher
Honeywell
Affine
Myntra
Oracle
Ola
Walmart Global Tech
Wipro Technologies
HCL Technologies
Cisco Systems
FlyNava Technologies
Nokia
LinkedIn
Bharti Airtel
YouPlus
ascena
Innodatatics
Mobile Premier League
Apple
Flutura
Jio
First Student
Noodle.ai
ABB
Swiggy
Idexcel
Mphasis
Blueocean Market Intelligence
J.P. Morgan
Knowledge Lens
ITC Infotech
NeenOpal
Robert Bosch
Two Roads Tech
NetApp
Exposys Data Labs
TheMathCompany
Flip Robo
Mercedes-Benz International
QuantZig
Tech Data
Caterpillar
HCL
Société Générale
Fuzzy Logix
Bharat Light & Power
Nielsen
Fidelity Investments
Mercedes-Benz Research and Development India
Hewlett Packard Enterprise | HPE
EY
Robert Bosch India
UnitedHealth Group
UniQreate
Shadowfax Technologies
Rolls-Royce
Everlytics
Publicis Sapient
Artificial Learning Systems
PwC
Terra Economics and Analytics Lab
Money View
NovelSynth Soft Solutions
Dun & Bradstreet
DXC Technology
Philips
[24]7.ai
SAP
Thoucentric
Walmart
Brillio
Great Learning
Optum
Adobe
Scienaptic Systems
Citi
Dell Technologies
Applied Materials
Target
CRED
Query:
SELECT "Salary"
   FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
   LIMIT 100;
Answer:
Salary
"₹6,48,573/yr"
"₹11,91,950/yr"
"₹8,36,874/yr"
"₹6,69,578/yr"
"₹9,44,110/yr"
"₹9,08,764/yr"
"₹9,26,124/yr"
"₹7,36,708/yr"
"₹16,46,721/yr"
"₹13,92,960/yr"
"₹14,04,773/yr"
"₹15,07,343/yr"
"₹15,58,095/yr"
"₹25,57,843/yr"
"₹15,10,081/yr"
"₹7,32,821/yr"
"₹12,21,750/yr"
"₹17,39,484/yr"
"₹11,24,939/yr"
"₹16,30,396/yr"
"₹10,09,436/yr"
"₹5,50,980/yr"
"₹18,70,000/yr"
"₹7,58,376/yr"
"₹15,56,575/yr"
"₹11,94,327/yr"
"₹14,70,000/yr"
"₹15,49,942/yr"
"₹10,09,436/yr"
"₹15,41,572/yr"
"₹8,11,182/yr"
"₹12,05,874/yr"
"₹7,27,111/yr"
"₹19,23,257/yr"
"₹21,43,501/yr"
"₹19,26,965/yr"
"₹41,271/mo"
"₹12,94,984/yr"
"₹23,34,960/yr"
"₹22,67,616/yr"
"₹13,66,992/yr"
"₹14,53,427/yr"
"₹14,58,032/yr"
"₹17,30,166/yr"
"₹6,58,109/yr"
"₹7,94,460/yr"
"₹25,67,381/yr"
"₹16,37,231/yr"
"₹9,00,000/yr"
"₹9,02,935/yr"
"₹9,70,782/yr"
"₹10,50,000/yr"
"₹21,19,584/yr"
"₹16,87,111/yr"
"₹14,65,641/yr"
"₹6,00,000/yr"
"₹18,05,869/yr"
"₹26,24,063/yr"
"₹9,55,297/yr"
"₹7,61,478/yr"
"₹28,05,476/yr"
"₹9,69,112/yr"
"₹4,50,979/yr"
"₹13,38,795/yr"
"₹10,40,493/yr"
"₹12,91,549/yr"
"₹49,928/mo"
"₹16,63,189/yr"
"₹13,23,387/yr"
"₹12,46,266/yr"
"₹4,94,147/yr"
"₹18,92,758/yr"
"₹15,72,054/yr"
"₹20,24,533/yr"
"₹19,27,564/yr"
"₹8,00,000/yr"
"₹20,09,790/yr"
"₹8,31,462/yr"
"₹5,16,323/yr"
"₹23,33,241/yr"
"₹12,00,000/yr"
"₹20,06,522/yr"
"₹21,60,000/yr"
"₹13,41,316/yr"
"₹16,34,105/yr"
"₹13,89,256/yr"
"₹10,00,000/yr"
"₹12,31,116/yr"
"₹23,52,941/yr"
"₹7,44,551/yr"
"₹30,14,686/yr"
"₹13,57,204/yr"
"₹10,53,196/yr"
"₹13,37,606/yr"
"₹48,825/mo"
"₹32,953/mo"
"₹16,49,930/yr"
"₹11,38,060/yr"
"₹16,12,744/yr"
"₹4,32,776/yr"
Query:
SELECT
  "Location",
  "CompanyName",
  "AvgSalaryState",
  "AvgSalaryCountry"
FROM (
  SELECT
    t1."Location",
    t1."CompanyName",
    t1."AvgSalaryState",
    t2."AvgSalaryCountry",
    ROW_NUMBER() OVER (PARTITION BY t1."Location" ORDER BY t1."AvgSalaryState" DESC) AS rn
  FROM (
    SELECT
      "Location",
      "CompanyName",
      AVG(TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', ''))) AS "AvgSalaryState"
    FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
    WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
    GROUP BY "Location", "CompanyName"
  ) t1
  JOIN (
    SELECT
      "CompanyName",
      AVG(TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', ''))) AS "AvgSalaryCountry"
    FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
    GROUP BY "CompanyName"
  ) t2 ON t1."CompanyName" = t2."CompanyName"
) sub
WHERE sub.rn <= 5
ORDER BY sub."Location", sub."AvgSalaryState" DESC;
Answer:
Location,CompanyName,AvgSalaryState,AvgSalaryCountry
Hyderabad,Qwerty Concepts,5081882.000000,5081882.000000
Hyderabad,SetuServ,4949704.000000,4949704.000000
Hyderabad,XYZ (Turkey),3000000.000000,1510743.500000
Hyderabad,ABCDEF,2745265.500000,1643757.750000
Hyderabad,MarketLinc,2658491.000000,2658491.000000
Mumbai,Rahul Industries,6044006.000000,3037137.500000
Mumbai,NVIDIA,4187500.000000,1541363.333333
Mumbai,VINAYA KUMAR,4029337.000000,2414668.500000
Mumbai,Goldman Sachs,3977066.000000,1903402.600000
Mumbai,Zee Entertainment Enterprises Ltd.,3531413.000000,3531413.000000
New Delhi,Super Highway Labs,3665141.000000,3665141.000000
New Delhi,Greenlight Planet,2876666.000000,1918288.500000
New Delhi,Boston Scientific,2707106.000000,2707106.000000
New Delhi,DreamOrbit Softech,2612697.000000,2612697.000000
New Delhi,OLX Group,2606510.000000,2606510.000000
Pune,Atos,5273205.000000,5273205.000000
Pune,Volkswagen,5184922.000000,5184922.000000
Pune,RAKESH GROUP,5016304.000000,5016304.000000
Pune,The City Bank,5000000.000000,5000000.000000
Pune,DasDas,4466071.000000,4466071.000000
Query:
-- Corrected SQL 1
SELECT TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', '')) AS "CleanedSalary"
FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
LIMIT 100
Answer:
CleanedSalary
648573
1191950
836874
669578
944110
908764
926124
736708
1646721
1392960
1404773
1507343
1558095
2557843
1510081
732821
1221750
1739484
1124939
1630396
1009436
550980
1870000
758376
1556575
1194327
1470000
1549942
1009436
1541572
811182
1205874
727111
1923257
2143501
1926965
41271
1294984
2334960
2267616
1366992
1453427
1458032
1730166
658109
794460
2567381
1637231
900000
902935
970782
1050000
2119584
1687111
1465641
600000
1805869
2624063
955297
761478
2805476
969112
450979
1338795
1040493
1291549
49928
1663189
1323387
1246266
494147
1892758
1572054
2024533
1927564
800000
2009790
831462
516323
2333241
1200000
2006522
2160000
1341316
1634105
1389256
1000000
1231116
2352941
744551
3014686
1357204
1053196
1337606
48825
32953
1649930
1138060
1612744
432776
Query:
-- Corrected SQL 2
SELECT "CompanyName", "Location", "Salary"
FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
WHERE "Location" = 'Mumbai'
LIMIT 100
Answer:
CompanyName,Location,Salary
Fractal,Mumbai,"₹16,43,351/yr"
Tata Consultancy Services,Mumbai,"₹5,66,756/yr"
Accenture,Mumbai,"₹9,00,000/yr"
Capgemini,Mumbai,"₹10,55,889/yr"
Jio,Mumbai,"₹10,37,441/yr"
Reliance Industries,Mumbai,"₹17,73,222/yr"
Housing.com,Mumbai,"₹23,83,368/yr"
Quantiphi,Mumbai,"₹9,19,025/yr"
Axis Bank,Mumbai,"₹11,93,674/yr"
LTI,Mumbai,"₹6,44,930/yr"
HDFC Bank,Mumbai,"₹10,70,583/yr"
Vodafone Idea,Mumbai,"₹20,09,767/yr"
CASHe,Mumbai,"₹10,98,034/yr"
Infosys,Mumbai,"₹11,02,095/yr"
Cognizant Technology Solutions,Mumbai,"₹8,30,959/yr"
Deloitte,Mumbai,"₹11,91,942/yr"
First Student,Mumbai,"₹12,10,857/yr"
CitiusTech,Mumbai,"₹2,94,111/yr"
RBL Bank,Mumbai,"₹11,80,704/yr"
ZEE5,Mumbai,"₹14,58,789/yr"
Mahindra Integrated Business Solutions,Mumbai,"₹9,74,832/yr"
DataScientest,Mumbai,"₹45,684/mo"
Pentation Analytics,Mumbai,"₹6,50,654/yr"
NDS InfoServ,Mumbai,"₹9,26,744/yr"
Arya.ai,Mumbai,"₹8,38,354/yr"
Wipro,Mumbai,"₹30,368/mo"
Amazon,Mumbai,"₹10,18,095/yr"
IBM,Mumbai,"₹11,93,120/yr"
PwC,Mumbai,"₹14,49,831/yr"
Google,Mumbai,"₹13,55,169/yr"
Atos-Syntel,Mumbai,"₹8,75,733/yr"
Siemens,Mumbai,"₹12,57,890/yr"
Mahindra,Mumbai,"₹10,22,850/yr"
eClerx,Mumbai,"₹7,33,769/yr"
HERE Technologies,Mumbai,"₹17,82,011/yr"
HDFC Standard Life Insurance,Mumbai,"₹12,21,714/yr"
Morningstar,Mumbai,"₹9,57,432/yr"
L&T Financial Services,Mumbai,"₹8,86,778/yr"
Piramal Enterprises,Mumbai,"₹72,216/mo"
Piramal Enterprises,Mumbai,"₹11,60,523/yr"
Episource,Mumbai,"₹8,94,949/yr"
XPO Logistics,Mumbai,"₹15,81,030/yr"
Loylty Rewardz Mngt,Mumbai,"₹12,23,523/yr"
Karza Technologies,Mumbai,"₹17,00,000/yr"
Prudential plc,Mumbai,"₹11,08,264/yr"
Dure Technologies,Mumbai,"₹12,89,859/yr"
Tata Consultancy Services,Mumbai,"₹18,737/mo"
Tech Mahindra,Mumbai,"₹8,85,892/yr"
EY,Mumbai,"₹10,25,737/yr"
Fresher,Mumbai,"₹50,367/mo"
ICICI Bank,Mumbai,"₹49,111/mo"
Microsoft,Mumbai,"₹2,16,685/mo"
ABC,Mumbai,"₹10,36,761/yr"
Kotak Mahindra,Mumbai,"₹66,648/mo"
Freshworks,Mumbai,"₹4,94,353/yr"
NVIDIA,Mumbai,"₹41,87,500/yr"
HERE Technologies,Mumbai,"₹41,940/mo"
Fractal,Mumbai,"₹39,822/mo"
MAERSK,Mumbai,"₹17,17,206/yr"
Tata AIG General Insurance,Mumbai,"₹14,06,673/yr"
General Mills,Mumbai,"₹17,34,062/yr"
Motilal Oswal Securities,Mumbai,"₹6,49,989/yr"
Hdfc,Mumbai,"₹64,952/mo"
Tata Group,Mumbai,"₹9,77,421/yr"
PharmEasy,Mumbai,"₹14,51,194/yr"
Decimal Point Analytics,Mumbai,"₹11,26,055/yr"
People Group,Mumbai,"₹13,14,654/yr"
MiQ,Mumbai,"₹12,40,055/yr"
UPL,Mumbai,"₹9,91,653/yr"
Lead School (India),Mumbai,"₹1,10,833/mo"
LogiNext Solutions,Mumbai,"₹4,65,001/yr"
Bewakoof Brands,Mumbai,"₹7,30,703/yr"
Meru Mobility Tech,Mumbai,"₹9,60,996/yr"
Kissht,Mumbai,"₹56,676/mo"
Radhakrishna Foodland,Mumbai,"₹3,04,060/yr"
Tableau Software,Mumbai,"₹28,65,536/yr"
FlexiLoans Technologies,Mumbai,"₹8,27,693/yr"
Square Panda,Mumbai,"₹6,76,720/yr"
Think Analytics,Mumbai,"₹6,06,168/yr"
Locobuzz,Mumbai,"₹8,35,493/yr"
SMEcorner,Mumbai,"₹40,725/mo"
Quantsapp,Mumbai,"₹18,926/mo"
HDFC Developers,Mumbai,"₹14,94,696/yr"
Javis,Mumbai,"₹20,75,185/yr"
Cuddle,Mumbai,"₹19,61,487/yr"
Arohi Operations,Mumbai,"₹30,834/mo"
Accenture,Mumbai,"₹1,01,809/yr"
IBM,Mumbai,"$2,05,476/yr"
IBM,Mumbai,"₹7,02,485/yr"
HCL Technologies,Mumbai,"₹14,17,138/yr"
Oracle,Mumbai,"₹10,00,000/yr"
BYJU'S,Mumbai,"₹10,00,000/yr"
LTI,Mumbai,"₹6,13,163/yr"
Mindtree,Mumbai,"₹10,31,658/yr"
Microsoft,Mumbai,"₹45,172/mo"
J.P. Morgan,Mumbai,"₹21,86,509/yr"
J.P. Morgan,Mumbai,"₹81,105/mo"
Cisco Systems,Mumbai,"₹10,880/mo"
ABC,Mumbai,"$96,739/yr"
Reliance Industries,Mumbai,"₹9,59,911/yr"
Query:
-- Corrected SQL 3
SELECT "CompanyName", AVG(TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', ''))) AS "AvgSalary"
FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
WHERE "Location" = 'Mumbai'
GROUP BY "CompanyName"
LIMIT 100
Answer:
CompanyName,AvgSalary
Fractal,948593.200000
Tata Consultancy Services,303868.555556
Accenture,611859.800000
Jio,750159.333333
Reliance Industries,686877.600000
Housing.com,2383368.000000
Quantiphi,440232.100000
Axis Bank,736602.333333
LTI,482902.000000
HDFC Bank,949680.000000
Vodafone Idea,2009767.000000
CASHe,1098034.000000
Cognizant Technology Solutions,702609.000000
Deloitte,893336.333333
First Student,403978.750000
ZEE5,1082536.000000
Mahindra Integrated Business Solutions,974832.000000
NDS InfoServ,926744.000000
Arya.ai,838354.000000
Google,633084.800000
Atos-Syntel,596458.000000
Infosys,840363.333333
DataScientest,45684.000000
Pentation Analytics,650654.000000
PwC,860093.666667
IBM,823493.000000
Mahindra,684695.333333
eClerx,480246.500000
HERE Technologies,687286.000000
HDFC Standard Life Insurance,1221714.000000
L&T Financial Services,886778.000000
Loylty Rewardz Mngt,1223523.000000
Dure Technologies,1289859.000000
Tech Mahindra,885892.000000
Kotak Mahindra,66648.000000
Motilal Oswal Securities,649989.000000
Hdfc,64952.000000
Tata Group,977421.000000
PharmEasy,514873.666667
Decimal Point Analytics,600401.750000
People Group,664962.500000
Lead School (India),110833.000000
Bewakoof Brands,831538.500000
Radhakrishna Foodland,304060.000000
Tableau Software,2865536.000000
Think Analytics,320968.000000
Quantsapp,18926.000000
HCL Technologies,869495.500000
Capgemini Engineering,45172.000000
Virtusa,237656.000000
L&T Technology Services,368431.500000
Tata Motors,62472.000000
Angel One,527662.666667
Moody's Analytics,1362714.000000
BDO,790515.000000
infrasoft technologies,488006.000000
vPhrase,702792.500000
Development Credit Bank Limited,524564.000000
DXC Technology,731418.000000
ICICI Lombard General Insurance Company Limited,814476.000000
Mondelēz International,2098257.000000
Barclays,1040054.000000
Stellar Organisation,338792.000000
Moneytor,30821.000000
Capgemini,789216.000000
CitiusTech,955754.666667
Wipro,30368.000000
Siemens,1156846.000000
RBL Bank,1180704.000000
Amazon,1010146.500000
Morningstar,661035.000000
Piramal Enterprises,571052.800000
Episource,992560.000000
XPO Logistics,1581030.000000
Karza Technologies,863948.500000
Prudential plc,1167295.500000
EY,739888.000000
Fresher,34244.250000
Microsoft,379100.666667
ABC,595485.000000
NVIDIA,4187500.000000
Tata AIG General Insurance,1406673.000000
UPL,991653.000000
LogiNext Solutions,465001.000000
Meru Mobility Tech,960996.000000
Kissht,56676.000000
FlexiLoans Technologies,827693.000000
Locobuzz,835493.000000
SMEcorner,276252.000000
Cuddle,1961487.000000
J.P. Morgan,1004043.333333
Cisco Systems,10880.000000
Flipkart,2576614.000000
Mu Sigma,1585281.500000
Bharti Airtel,604401.000000
Intel Corporation,94844.000000
State Bank of India,1816155.000000
Yes Bank,203619.000000
TCS,293629.000000
Mercedes-Benz Research and Development India,1251537.000000
Query:
-- Corrected SQL 4
SELECT "CompanyName", COUNT(*) AS "SalariesCount"
FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
GROUP BY "CompanyName"
ORDER BY "SalariesCount" DESC
LIMIT 100
Answer:
CompanyName,SalariesCount
Tata Consultancy Services,41
Amazon,32
Accenture,30
Google,27
IBM,26
Fresher,26
First Student,25
Infosys,23
Cognizant Technology Solutions,21
DONE by NONE,21
ABC,20
Wipro,17
Microsoft,17
Capgemini,17
Deloitte,16
Tech Mahindra,16
LTI,16
Nones,15
Fractal,14
Quantiphi,14
Wipro Technologies,14
HCL Technologies,14
Genpact,13
Optum,12
Freelancer,11
PwC,10
ZS Associates,10
Honeywell,10
DXC Technology,10
NTT DATA,9
Jio,9
Dell Technologies,9
KPMG,9
XYZ,9
Virtusa,9
American Express,9
TCS,9
EY,9
Reliance Industries,9
ICICI Bank,9
Anonymous,9
Mu Sigma,9
Optum Global Solutions,8
Innodatatics,8
J.P. Morgan,8
Axis Bank,8
Adobe,8
UnitedHealth Group,8
Mindtree,8
Oracle,8
Atos-Syntel,8
Tata Consultancy Services (North America),8
EMPLOYERS,8
WNS,8
Siemens,7
Barclays,7
Tiger Analytics,7
Maxgen Technologies,7
MAERSK,7
Flipkart,7
Course5 Intelligence,7
Citi,7
OYO,7
iNeuron,7
HSBC,7
Novartis,7
Ugam,7
Persistent Systems,7
TEKsystems,7
Bajaj Finance,7
Publicis Sapient,7
Schlumberger,7
Mahindra,6
SG Analytics,6
Mercedes-Benz Research and Development India,6
Red Hat,6
Techolution,6
GE,6
EXL Service,6
Fresherworld.com,6
Tableau Software,6
ThinkBumblebee Analytics,6
Wells Fargo,6
Freshers.com,6
Mastercard,6
Abzooba,6
Kantar,6
Enquero,6
Datametica,6
ITC Infotech,6
Piramal Enterprises,6
SAP,6
Credit Suisse,6
Anonymous Content,6
Cisco Systems,6
Cyient,6
Ericsson-Worldwide,5
Nielsen,5
Fidelity Investments,5
Verizon,5
Query:
-- Corrected SQL 5
SELECT "CompanyName", AVG(TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', ''))) AS "AvgNationalSalary"
FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
GROUP BY "CompanyName"
LIMIT 100
Answer:
CompanyName,AvgNationalSalary
Mu Sigma,837406.777778
IBM,697564.923077
Tata Consultancy Services,453467.853659
Accenture,658121.100000
Infosys,727739.347826
Capgemini,753792.117647
Cognizant Technology Solutions,568052.190476
Anheuser-Busch InBev,1425940.666667
Fractal,972820.714286
Embibe,1314907.000000
Google,1202518.851852
Flipkart,1204149.000000
HP Inc.,1141776.200000
Wipro,740449.823529
Ericsson-Worldwide,685326.200000
MiQ,1538585.250000
Deloitte,936493.812500
Microsoft,982857.705882
Fresher,221045.615385
Flutura,931079.000000
Fuzzy Logix,1556575.000000
Affine,784572.000000
Bharat Light & Power,808672.000000
First Student,311641.920000
Walmart Global Tech,1321157.000000
SAP,1079052.666667
Brillio,1075812.000000
Happiest Minds Technologies,1036507.000000
Noodle.ai,1175607.666667
Scienaptic Systems,1291549.000000
FlyNava Technologies,49928.000000
Idexcel,601965.500000
Citi,1327199.428571
Aptus Data Labs,726734.750000
CRED,3014686.000000
ANZ Bank,1111352.000000
Artivatic Data Labs,649755.000000
InMobi,1700000.000000
Fidelity Investments,1233345.400000
Cisco Systems,990140.166667
INSOFE,751723.000000
Adobe,850445.625000
Swiggy,1403670.666667
GE Healthcare,1061007.000000
Ericsson IT Solutions & Services,1072989.000000
UniQreate,516323.000000
Everlytics,432776.000000
Siemens,623141.142857
Mindtree,661573.250000
Hinduja Global Solutions,960451.000000
GE Digital,1463805.000000
Innodatatics,448540.250000
upGrad,399330.000000
Zoom Video Communications,2839076.000000
Tata,1439736.500000
NTT Ltd.,134323.000000
Cartesian Consulting,742603.500000
Head Digital Works,977543.000000
HDFC Standard Life Insurance,1199622.500000
Flip Robo,87060.250000
Terra Economics and Analytics Lab,720000.000000
mfine,1625481.000000
SalesKen,1039792.000000
Volvo Group,1200000.000000
Genpact,494632.076923
Société Générale,4099921.000000
Jio,845938.000000
Antuit,1205874.000000
[24]7.ai,773328.500000
Ola,1483888.750000
Mercedes-Benz Research and Development India,1199758.500000
Great Learning,884572.750000
Hewlett Packard Enterprise | HPE,1144763.666667
Optum,1041432.583333
Dell Technologies,1058908.000000
FICO,1634105.000000
IQVIA,693982.750000
ShareChat,2300000.000000
MAERSK,1124309.571429
Caterpillar,1526335.000000
VMware,2189676.500000
Accentue,1041548.500000
Kabbage,1117778.000000
Sutherland,737504.333333
Impact Analytics,515136.333333
DXC Technology,761862.700000
Myntra,1442248.666667
Oracle,1126035.500000
Tredence,927895.000000
HCL Technologies,705485.500000
EY,793424.777778
Subex,948156.000000
Nokia,870151.750000
UnitedHealth Group,987090.250000
LinkedIn,1225515.666667
Shadowfax Technologies,1232332.500000
Applied Materials,1374542.000000
Blueocean Market Intelligence,744551.000000
J.P. Morgan,964828.375000
Knowledge Lens,48825.000000
Query:
-- Corrected SQL 6
SELECT "CompanyName", AVG(TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', ''))) AS "AvgSalaryHyderabad"
FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
WHERE "Location" = 'Hyderabad'
GROUP BY "CompanyName"
LIMIT 100
Answer:
CompanyName,AvgSalaryHyderabad
Microsoft,1424931.200000
Cyient,542333.000000
Infosys,588163.250000
Amazon,452094.142857
Tech Mahindra,382072.666667
Jotter,618746.500000
Cognizant Technology Solutions,517920.285714
Verizon,1109216.000000
Optum,1206212.333333
Accenture,713493.000000
Novartis,502761.333333
Karvy Group,304548.000000
HighRadius,437780.000000
Google,1166513.666667
Blue Yonder,2020386.000000
DataScientest,56039.000000
Genpact,480471.250000
DXC Technology,1284729.500000
Dell Technologies,877553.333333
Sutherland,573825.500000
Enquero,1148838.000000
Brane Enterprises (nslhub),1665911.000000
AlgonoX Technologies,1074883.000000
Persistent Systems,664440.000000
DBS Bank,839115.750000
WinWire Technologies,1269639.000000
eKincare,650865.000000
Bepec Solutions,646889.000000
Prudent Technologies & Consulting,376159.000000
RisingRoot Technologies,13255.000000
diwo,792506.000000
Freelancer,503064.750000
DONE by NONE,277042.500000
Nones,285930.000000
Tiger Analytics,1221751.500000
SoCtronics,37271.000000
Molecular Connections,45220.000000
Gi Group,312358.000000
Innominds Software,670103.000000
Micron Technology,912937.333333
Tata Consultancy Services (North America),882399.000000
Virtusa,480943.750000
Dr. Reddy's,230611.500000
Optum Global Solutions,824493.666667
DigiTele Networks,787723.000000
Honeywell,1653407.000000
Hexaware Technologies,882154.500000
Infosys BPM,854151.000000
Fresherworld.com,300000.000000
Myntra,1394897.000000
GS Lab,56465.000000
Verzeo,12813.000000
MathWorks,605385.000000
AGS Health,413352.000000
Don't Know,25122.000000
Optum Global Solutions India,1628949.000000
Industryarc,1094666.000000
Intellect Design Arena,346152.000000
MOURI Tech,21116.000000
Zen3 Info Solutions,1262347.333333
Saras Analytics,703418.000000
Wells Fargo,805643.500000
Realshoppee Retail,41922.000000
BYJU'S,633866.000000
Tata Consultancy Services,589855.250000
Oracle,1180565.500000
INSOFE,903446.000000
Claim Genius,1944821.000000
Capgemini,642964.000000
MetLife,1760000.000000
Great Learning,777837.000000
CallHealth,823971.000000
Gaian Solutions India,1100233.000000
GoLorry,792139.000000
Mindtree,493096.666667
Mu Sigma,519381.500000
S&P Global,636288.666667
ABCDEF,2745265.500000
Government of India,312358.000000
upGrad,211160.000000
CBRE,733769.000000
Raja Software Labs,206332.000000
IVL Global,727471.000000
IBM,444414.600000
Jio,686809.333333
Deloitte,1154386.200000
Wipro,824595.250000
Fresher,221766.600000
Wipro Technologies,443818.500000
UnitedHealth Group,1144968.000000
Freshers.com,630000.000000
Legato Health Technologies,1082148.500000
Broadridge,1061463.000000
National Payments Corporation of India,1492543.000000
Excelra Knowledge Solutions,452130.000000
Siva Solutions,335625.000000
SysBasis Solutions,25204.000000
HSBC,695263.333333
State Bank of India,1159476.000000
HSBC Software Development India,1104068.333333
Query:
SELECT
  "Location",
  "CompanyName",
  "AvgSalaryState",
  "AvgSalaryCountry"
FROM (
  SELECT
    t1."Location",
    t1."CompanyName",
    t1."AvgSalaryState",
    t2."AvgSalaryCountry",
    ROW_NUMBER() OVER (PARTITION BY t1."Location" ORDER BY t1."AvgSalaryState" DESC) AS rn
  FROM (
    SELECT
      "Location",
      "CompanyName",
      AVG(TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', ''))) AS "AvgSalaryState"
    FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
    WHERE "Location" ILIKE '%Mumbai%' OR "Location" ILIKE '%Pune%' OR "Location" ILIKE '%New Delhi%' OR "Location" ILIKE '%Hyderabad%'
    GROUP BY "Location", "CompanyName"
  ) t1
  JOIN (
    SELECT
      "CompanyName",
      AVG(TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', ''))) AS "AvgSalaryCountry"
    FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
    GROUP BY "CompanyName"
  ) t2 ON t1."CompanyName" = t2."CompanyName"
) sub
WHERE sub.rn <= 5
ORDER BY sub."Location", sub."AvgSalaryState" DESC;
Answer:
Location,CompanyName,AvgSalaryState,AvgSalaryCountry
Hyderabad,Qwerty Concepts,5081882.000000,5081882.000000
Hyderabad,SetuServ,4949704.000000,4949704.000000
Hyderabad,XYZ (Turkey),3000000.000000,1510743.500000
Hyderabad,ABCDEF,2745265.500000,1643757.750000
Hyderabad,MarketLinc,2658491.000000,2658491.000000
Mumbai,Rahul Industries,6044006.000000,3037137.500000
Mumbai,NVIDIA,4187500.000000,1541363.333333
Mumbai,VINAYA KUMAR,4029337.000000,2414668.500000
Mumbai,Goldman Sachs,3977066.000000,1903402.600000
Mumbai,Zee Entertainment Enterprises Ltd.,3531413.000000,3531413.000000
New Delhi,Super Highway Labs,3665141.000000,3665141.000000
New Delhi,Greenlight Planet,2876666.000000,1918288.500000
New Delhi,Boston Scientific,2707106.000000,2707106.000000
New Delhi,DreamOrbit Softech,2612697.000000,2612697.000000
New Delhi,OLX Group,2606510.000000,2606510.000000
Pune,Atos,5273205.000000,5273205.000000
Pune,Volkswagen,5184922.000000,5184922.000000
Pune,RAKESH GROUP,5016304.000000,5016304.000000
Pune,The City Bank,5000000.000000,5000000.000000
Pune,DasDas,4466071.000000,4466071.000000
Query:
-- Corrected SQL 8
SELECT "JobTitle", "Salary"
FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
WHERE "Location" ILIKE '%Pune%'
LIMIT 100
Answer:
JobTitle,Salary
Data Scientist,"₹7,17,331/yr"
Data Scientist,"₹11,63,186/yr"
Data Scientist,"₹10,36,536/yr"
Data Scientist,"₹7,42,883/yr"
Data Scientist,"₹12,94,039/yr"
Data Scientist,"₹11,54,579/yr"
Data Scientist,"₹7,65,632/yr"
Data Scientist,"₹6,02,937/yr"
Data Scientist,"₹11,50,000/yr"
Data Scientist,"₹8,54,957/yr"
Data Scientist,"₹9,56,307/yr"
Data Scientist,"₹8,16,946/yr"
Data Scientist,"₹10,70,536/yr"
Data Scientist,"₹11,46,043/yr"
Data Scientist,"₹11,14,163/yr"
Data Scientist,"₹20,54,972/yr"
Data Scientist,"₹11,34,768/yr"
Data Scientist,"₹8,78,252/yr"
Data Scientist,"₹8,98,351/yr"
Data Scientist,"₹8,14,017/yr"
Data Scientist,"₹4,25,000/yr"
Data Scientist,"₹9,40,423/yr"
Data Scientist,"₹11,21,845/yr"
Data Scientist,"₹12,15,906/yr"
Data Scientist,"₹10,55,811/yr"
Data Scientist,"₹16,22,612/yr"
Data Scientist,"₹42,249/mo"
Data Scientist,"₹7,18,534/yr"
Data Scientist,"₹4,23,422/yr"
Data Scientist,"₹17,33,746/yr"
Data Scientist,"₹16,55,120/yr"
Data Scientist,"₹14,21,672/yr"
Data Scientist,"₹9,34,857/yr"
Data Scientist,"₹8,56,429/yr"
Data Scientist,"₹18,00,000/yr"
Data Scientist,"₹4,11,680/yr"
Data Scientist,"₹61,248/mo"
Data Scientist,"₹51,920/mo"
Data Scientist,"₹2,32,796/mo"
Data Scientist,"₹10,01,630/yr"
Data Scientist,"₹15,77,759/yr"
Data Scientist,"₹52,491/mo"
Data Scientist,"₹52,16,933/yr"
Data Scientist,"₹14,63,658/yr"
Data Scientist,"₹17,72,001/yr"
Data Scientist,"₹8,34,387/yr"
Data Scientist,"₹8,28,221/yr"
Data Scientist,"₹1,00,275/mo"
Data Scientist,"₹9,32,104/yr"
Data Scientist,"₹9,83,550/yr"
Data Scientist,"₹25,446/mo"
Data Scientist,₹602/hr
Data Scientist,"₹53,475/mo"
Data Scientist,"₹11,61,602/yr"
Data Scientist,"₹63,058/mo"
Data Scientist,"₹46,977/mo"
Data Scientist,"₹2,83,914/yr"
Data Scientist,"₹7,31,758/yr"
Data Scientist,"₹16,87,208/yr"
Data Scientist,"₹7,13,466/yr"
Data Scientist,"₹56,250/mo"
Data Scientist,"₹4,99,961/yr"
Data Scientist,"₹8,95,000/yr"
Data Scientist,"₹2,53,851/yr"
Data Scientist,"₹6,37,645/yr"
Data Scientist,"₹19,54,650/yr"
Data Scientist,"₹6,69,083/yr"
Data Scientist,"₹18,33,778/yr"
Data Scientist,"₹25,000/mo"
Data Scientist,"£7,03,427/yr"
Data Scientist,"₹1,15,884/yr"
Data Scientist,"₹6,19,069/yr"
Data Scientist,"₹16,00,000/yr"
Data Scientist,"₹30,147/mo"
Data Scientist,"₹4,00,000/yr"
Data Scientist,"₹6,42,322/yr"
Data Scientist,"₹1,01,398/mo"
Data Scientist,"₹30,000/mo"
Data Scientist,"₹2,89,045/mo"
Data Scientist,"₹75,71,032/yr"
Data Scientist,"₹14,38,481/yr"
Data Scientist,"₹2,141/hr"
Data Scientist,"₹1,00,000/mo"
Data Scientist,"₹44,44,315/yr"
Data Scientist,"₹3,01,469/yr"
Data Scientist,"£2,05,049/yr"
Data Scientist,"₹70,000/mo"
Data Scientist,"₹6,00,000/yr"
Data Scientist,"₹6,42,322/yr"
Data Scientist,"₹9,05,000/yr"
Data Scientist,"₹6,23,238/yr"
Data Scientist,"₹8,70,000/yr"
Data Scientist,"₹64,232/mo"
Data Scientist,"₹12,50,000/yr"
Data Scientist,"₹11,76,710/yr"
Data Scientist,"₹4,14,794/yr"
Data Scientist,"₹25,69,287/yr"
Data Scientist,"₹14,04,565/yr"
Data Scientist,"₹7,87,318/yr"
Data Scientist,"₹20,54,972/yr"
Query:
-- Corrected SQL 9
SELECT DISTINCT "CompanyName"
FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
WHERE "Location" ILIKE '%Mumbai%' 
   OR "Location" ILIKE '%Pune%' 
   OR "Location" ILIKE '%New Delhi%' 
   OR "Location" ILIKE '%Hyderabad%'
LIMIT 100
Answer:
CompanyName
Tata Consultancy Services
Innoplexus
IBM
AlgoAnalytics Financial Consultancy
Wolters Kluwer
Accenture
Wipro
Zensar Technologies
Bajaj Finance
ThinkBumblebee Analytics
Michelin
Tech Mahindra
Schlumberger
First Student
Eaton
T-Systems
ABC
Amdocs
Barclays
Exela Technologies
Fresher
Citi
Xoriant
Globant
Datametica
Vyom Labs
Vishwakarma Institute of Technology
MindBowser Info Solutions
Larsen & Toubro
Concentrix
Hinduja Global Solutions
Dassault Systemes
C-DAC
AXA
Volkswagen
SS Supply Chain Solutions
Pratham
Smartek21
Nones Data Science
DBS Bank
ZS Associates
Axis Bank
GS Lab
ThinkBridge
Climate Connect
HiLabs (MD)
Persistent Systems
Nones
Other
Netcracker Technology
Nothing Something
Sokrati
Sandvik
Cognizant Softvision
Amphisoft Technologies
vPhrase
Optra Health
HiLabs
STL - Sterlite Technologies Limited
Internshala
IVL Global
TorcAI
Innoplexus Associate
Fiserv
Cognizant Technology Solutions
SG Analytics
Capgemini
LTI
KPIT Technologies
Credit Suisse
Freelancer
Knorex
CanWill Technologies
Coditation Systems
DXC Technology
KPMG
DONE by NONE
Kotak Mahindra
eClerx
Fractal
Apple
Fresh Gravity
Merkle
Infosys
Atos-Syntel
Saama Technologies
John Deere
Searce
e-Zest Solutions
Fusion Practices
DeepTek Medical Imaging
Jash Data Sciences
Genpact
Google
Honeywell
WNS
Siemens
Mahindra
Thoughtworks
Yash Technologies
Query:
-- Corrected SQL 10
SELECT "CompanyName", COUNT(*) AS "SalariesReported"
FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
WHERE "Location" ILIKE '%New Delhi%'
GROUP BY "CompanyName"
ORDER BY "SalariesReported" DESC
LIMIT 100
Answer:
CompanyName,SalariesReported
Google,8
Tata Consultancy Services,6
ABC,6
Amazon,5
Adobe,5
Snapdeal,5
Delhivery,5
OYO,5
Optum,5
American Express,5
Elucidata (MA),4
Freelancer,4
Innovaccer,4
Capgemini,4
Fresher,4
Genpact,4
Mastercard,4
Nagarro,4
Zomato,4
Accenture,4
EXL Service,4
IBM,4
Tech Mahindra,4
McKinsey Knowledge Center,4
Fractal,4
Optum Global Solutions,3
Decision Point,3
First Student,3
Nokia,3
Deloitte,3
Blackcoffer,3
UnitedHealth Group,3
Analytics Vidhya,3
Gemini Solutions,3
Infosys,3
WNS,3
ZS Associates,3
DXC Technology,3
HCL Technologies,3
IHS Markit,3
Publicis Sapient,3
Cognizant Technology Solutions,3
Ericsson-Worldwide,3
Gartner,3
DONE by NONE,3
Microsoft,3
Valiance Solutions,3
TCS,3
Atlan,3
Unified Healthcare Group,3
Paytm,3
Nones,2
ParallelDots,2
Ezappsolution,2
SupplyCopia,2
Dell Technologies,2
EasyRewardz,2
Lumiq (India),2
Info Edge,2
Absolutdata,2
Urban Company,2
Infogain,2
Octro,2
LiquidHub,2
Wipro Technologies,2
Concentrix,2
EY,2
KPMG,2
R Systems,2
Optum Global Solutions India,2
GALYTIX,2
Honeywell,2
Times Internet,2
LTI,2
Vidooly Media Tech,2
Ericsson IT Solutions & Services,2
Loginworks,2
McKinsey & Company,2
Monsoon (India),2
Evalueserve,2
Denave,2
Teleperformance,2
Aon,2
Pitney Bowes,2
iEnergizer,2
Tata Consultancy Services (North America),2
Bank of America,2
Yatra Online Pvt Ltd,2
Ameriprise,2
Coforge,2
dunnhumby,2
Wipro,2
J.P. Morgan,2
OLX Group,2
PolicyBazaar,2
Tokopedia,2
Samsung Electronics,2
MakeMyTrip,2
Bharti Airtel,2
Maruti Suzuki,2
Query:
-- Corrected SQL 11
SELECT TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', '')) AS "NumericSalary"
FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
WHERE "Location" ILIKE '%Mumbai%'
LIMIT 100
Answer:
NumericSalary
1643351
566756
900000
1055889
1037441
1773222
2383368
919025
1193674
644930
1070583
2009767
1098034
1102095
830959
1191942
1210857
294111
1180704
1458789
974832
45684
650654
926744
838354
30368
1018095
1193120
1449831
1355169
875733
1257890
1022850
733769
1782011
1221714
957432
886778
72216
1160523
894949
1581030
1223523
1700000
1108264
1289859
18737
885892
1025737
50367
49111
216685
1036761
66648
494353
4187500
41940
39822
1717206
1406673
1734062
649989
64952
977421
1451194
1126055
1314654
1240055
991653
110833
465001
730703
960996
56676
304060
2865536
827693
676720
606168
835493
40725
18926
1494696
2075185
1961487
30834
101809
205476
702485
1417138
1000000
1000000
613163
1031658
45172
2186509
81105
10880
96739
959911
Query:
-- Corrected SQL 12
SELECT "CompanyName", "Location", TRY_TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', '')) AS "NumericSalary"
FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
WHERE TRY_TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', '')) > 1000000
LIMIT 100
Answer:
CompanyName,Location,NumericSalary
IBM,Bangalore,1191950
Anheuser-Busch InBev,Bangalore,1646721
Fractal,Bangalore,1392960
Embibe,Bangalore,1404773
Amazon,Bangalore,1507343
Google,Bangalore,1558095
Flipkart,Bangalore,2557843
HP Inc.,Bangalore,1510081
Ericsson-Worldwide,Bangalore,1221750
MiQ,Bangalore,1739484
Deloitte,Bangalore,1124939
Microsoft,Bangalore,1630396
Genpact,Bangalore,1009436
Société Générale,Bangalore,1870000
Fuzzy Logix,Bangalore,1556575
DXC Technology,Bangalore,1194327
Jio,Bangalore,1470000
Honeywell,Bangalore,1549942
Affine,Bangalore,1009436
Philips,Bangalore,1541572
Antuit,Bangalore,1205874
[24]7.ai,Bangalore,1923257
Fidelity Investments,Bangalore,2143501
Myntra,Bangalore,1926965
Oracle,Bangalore,1294984
Ola,Bangalore,2334960
Walmart Global Tech,Bangalore,2267616
Tredence,Bangalore,1366992
Intel Corporation,Bangalore,1453427
Mercedes-Benz Research and Development India,Bangalore,1458032
SAP,Bangalore,1730166
Walmart,Bangalore,2567381
Brillio,Bangalore,1637231
Happiest Minds Technologies,Bangalore,1050000
Hewlett Packard Enterprise | HPE,Bangalore,2119584
Noodle.ai,Bangalore,1687111
Cisco Systems,Bangalore,1465641
Optum,Bangalore,1805869
Adobe,Bangalore,2624063
Swiggy,Bangalore,2805476
ZS Associates,Bangalore,1338795
Robert Bosch India,Bangalore,1040493
Scienaptic Systems,Bangalore,1291549
Nokia,Bangalore,1663189
UnitedHealth Group,Bangalore,1323387
Sigmoid Analytics,Bangalore,1246266
Citi,Bangalore,1892758
GE Healthcare,Bangalore,1572054
SigTuple,Bangalore,2024533
Dell Technologies,Bangalore,1927564
Ericsson IT Solutions & Services,Bangalore,2009790
LinkedIn,Bangalore,2333241
Apexon,Bangalore,1200000
Shadowfax Technologies,Bangalore,2006522
Bharti Airtel,Bangalore,2160000
Applied Materials,Bangalore,1341316
FICO,Bangalore,1634105
YouPlus,Bangalore,1389256
Target,Bangalore,1231116
Gojek,Bangalore,2352941
CRED,Bangalore,3014686
Rolls-Royce,Bangalore,1357204
Curl Analytics,Bangalore,1053196
J.P. Morgan,Bangalore,1337606
ascena,Bangalore,1649930
QuantZig,Bangalore,1138060
Baker Hughes,Bangalore,1612744
ANZ Bank,Bangalore,1512297
Lowe's Home Improvement,Bangalore,1752935
Nones,Bangalore,1197944
HDFC Standard Life Insurance,Bangalore,1177531
AntWorks,Bangalore,1194925
American Express,Bangalore,1693208
Knowledge Foundry,Bangalore,1119069
Nones,Bangalore,1013978
TVS Motor Company,Bangalore,1252803
Publicis Sapient,Bangalore,1670405
Hinduja Global Solutions,Bangalore,1284643
GE Digital,Bangalore,1653106
MakeMyTrip,Bangalore,1200000
Artificial Learning Systems,Bangalore,1124740
Dailyhunt,Bangalore,2600000
Draup,Bangalore,1859109
PwC,Bangalore,1205874
Robert Bosch,Bangalore,1180355
Two Roads Tech,Bangalore,3812913
ExxonMobil,Bangalore,2873437
Bidgely,Bangalore,1438481
ShareChat,Bangalore,2300000
MAERSK,Bangalore,2207174
Caterpillar,Bangalore,1526335
NetApp,Bangalore,2875549
Spoonshot,Bangalore,1615535
InMobi,Bangalore,1700000
Swiss Re,Bangalore,1352802
Shell,Bangalore,2148775
upGrad,Bangalore,1284643
Legato Health Technologies,Bangalore,1200000
HDFC Bank,Bangalore,1105385
Halodoc,Bangalore,1879205
Query:
-- Corrected SQL 13
SELECT "Location", AVG(TRY_TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', ''))) AS "AvgSalaryByLocation"
FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
WHERE "Salary" IS NOT NULL AND "Salary" != ''
GROUP BY "Location"
LIMIT 100
Answer:
Location,AvgSalaryByLocation
Bangalore,892445.762626
Pune,736137.405868
Hyderabad,677650.000000
New Delhi,692217.763720
Mumbai,669215.609400
Query:
-- Corrected SQL 14
SELECT "CompanyName"
FROM (
  SELECT "CompanyName", COUNT(DISTINCT CASE 
      WHEN "Location" ILIKE '%Mumbai%' THEN 'Mumbai'
      WHEN "Location" ILIKE '%Pune%' THEN 'Pune'
      WHEN "Location" ILIKE '%New Delhi%' THEN 'New Delhi'
      WHEN "Location" ILIKE '%Hyderabad%' THEN 'Hyderabad'
    END) AS "CityCount"
  FROM EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
  WHERE "Location" ILIKE '%Mumbai%' 
     OR "Location" ILIKE '%Pune%' 
     OR "Location" ILIKE '%New Delhi%' 
     OR "Location" ILIKE '%Hyderabad%'
  GROUP BY "CompanyName"
) AS sub
WHERE "CityCount" = 4
LIMIT 100
Answer:
CompanyName
Tata Consultancy Services
IBM
Cognizant Technology Solutions
Wipro
Tech Mahindra
Capgemini
LTI
First Student
Amazon
Accenture
Larsen & Toubro
WNS
Fresherworld.com
HCL Technologies
Fresher
Google
Tata Consultancy Services (North America)
DONE by NONE
DXC Technology
Infosys
Anonymous
Microsoft
ABC
Deloitte
EMPLOYERS
The Sparks Foundation
Kantar
BYJU'S
Nones
End Exploring Related Columns
Task: Using a Salary Dataset where the salary values need to be cleaned by removing non-numeric characters and converting them to a numeric type, write a detailed SQL query that identifies the top 5 companies by average salary in each of Mumbai, Pune, New Delhi, and Hyderabad, then compares each company’s average salary in those cities to the overall national average salary. The final result should display four columns: Location, Company Name, Average Salary in State, and Average Salary in Country, listing only the top 5 companies in each of the specified locations.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To identify the top 5 companies by average salary in each of Mumbai, Pune, New Delhi, and Hyderabad, and compare each company's average salary in those cities to the overall national average salary, you would perform the following steps:

1. **Clean the Salary Data**: Remove any non-numeric characters from the `Salary` column and convert the values to a numeric data type.
2. **Calculate Average Salaries**:
   - Compute the average salary for each company in each specified city.
   - Compute the national average salary for each company across all locations.
3. **Identify Top Companies**:
   - For each city, select the top 5 companies based on their average salary in that city.
4. **Compile the Results**: Present the findings in a table with the required columns.

Here is the expected format of the final result:

```csv
Location,Company Name,Average Salary in State,Average Salary in Country
Mumbai,company1:str,avg_salary_state1:float,avg_salary_country1:float
Mumbai,company2:str,avg_salary_state2:float,avg_salary_country2:float
Mumbai,company3:str,avg_salary_state3:float,avg_salary_country3:float
Mumbai,company4:str,avg_salary_state4:float,avg_salary_country4:float
Mumbai,company5:str,avg_salary_state5:float,avg_salary_country5:float
Pune,company1:str,avg_salary_state1:float,avg_salary_country1:float
Pune,company2:str,avg_salary_state2:float,avg_salary_country2:float
Pune,company3:str,avg_salary_state3:float,avg_salary_country3:float
Pune,company4:str,avg_salary_state4:float,avg_salary_country4:float
Pune,company5:str,avg_salary_state5:float,avg_salary_country5:float
New Delhi,company1:str,avg_salary_state1:float,avg_salary_country1:float
New Delhi,company2:str,avg_salary_state2:float,avg_salary_country2:float
New Delhi,company3:str,avg_salary_state3:float,avg_salary_country3:float
New Delhi,company4:str,avg_salary_state4:float,avg_salary_country4:float
New Delhi,company5:str,avg_salary_state5:float,avg_salary_country5:float
Hyderabad,company1:str,avg_salary_state1:float,avg_salary_country1:float
Hyderabad,company2:str,avg_salary_state2:float,avg_salary_country2:float
Hyderabad,company3:str,avg_salary_state3:float,avg_salary_country3:float
Hyderabad,company4:str,avg_salary_state4:float,avg_salary_country4:float
Hyderabad,company5:str,avg_salary_state5:float,avg_salary_country5:float
```

**Explanation:**

- **Location**: The city (Mumbai, Pune, New Delhi, or Hyderabad).
- **Company Name**: Name of the company.
- **Average Salary in State**: The company's average salary in the specified city.
- **Average Salary in Country**: The company's average salary across all locations.

Each city lists the top 5 companies based on the highest average salary within that city, along with their national average salary for comparison.

*Note: The actual data values are placeholders since the dataset is not accessible for computation.*.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'EDUCATION_BUSINESS': {'EDUCATION_BUSINESS': ['WEB_ORDERS', 'HARDWARE_FACT_MANUFACTURING_COST', 'SALARYDATASET', 'WEB_SALES_REPS', 'HARDWARE_DIM_PRODUCT', 'HARDWARE_FACT_GROSS_PRICE', 'HARDWARE_FACT_SALES_MONTHLY', 'UNIVERSITY_FACULTY', 'WEB_EVENTS', 'HARDWARE_DIM_CUSTOMER', 'STAFFHOURS', 'UNIVERSITY_COURSE', 'UNIVERSITY_ENROLLMENT', 'UNIVERSITY_OFFERING', 'UNIVERSITY_STUDENT', 'WEB_ACCOUNTS', 'WEB_REGION', 'HARDWARE_FACT_PRE_INVOICE_DEDUCTIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-10 11:52:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 11:52:17 - root - INFO - ```sql
WITH cleaned_data AS (
    SELECT
        "CompanyName",
        "Location",
        TRY_TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', '')) AS "SalaryNumeric"
    FROM
        EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
    WHERE
        "Salary" IS NOT NULL
        AND "Salary" != ''
)
, avg_salary_state AS (
    SELECT
        "CompanyName",
        "Location",
        AVG("SalaryNumeric") AS "AvgSalaryState"
    FROM
        cleaned_data
    WHERE
        "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
    GROUP BY
        "CompanyName", "Location"
)
, avg_salary_country AS (
    SELECT
        "CompanyName",
        AVG("SalaryNumeric") AS "AvgSalaryCountry"
    FROM
        cleaned_data
    GROUP BY
        "CompanyName"
)
, ranked_companies AS (
    SELECT
        t1."Location",
        t1."CompanyName",
        t1."AvgSalaryState",
        t2."AvgSalaryCountry",
        ROW_NUMBER() OVER (PARTITION BY t1."Location" ORDER BY t1."AvgSalaryState" DESC) AS rn
    FROM
        avg_salary_state t1
        JOIN avg_salary_country t2 ON t1."CompanyName" = t2."CompanyName"
)
SELECT
    "Location",
    "CompanyName",
    "AvgSalaryState",
    "AvgSalaryCountry"
FROM
    ranked_companies
WHERE
    rn <= 5
ORDER BY
    "Location",
    "AvgSalaryState" DESC;
```
2025-02-10 11:52:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:52:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:52:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:52:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-02-10 11:52:18 - snowflake.connector.connection - INFO - closed
2025-02-10 11:52:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:52:18 - root - INFO - itercount: 1
2025-02-10 11:52:18 - root - INFO - 0
2025-02-10 11:52:18 - root - INFO - results: 
Location,CompanyName,AvgSalaryState,AvgSalaryCountry
Hyderabad,Qwerty Concepts,5081882.000000,5081882.000000
Hyderabad,SetuServ,4949704.000000,4949704.000000
Hyderabad,XYZ (Turkey),3000000.000000,1510743.500000
Hyderabad,ABCDEF,2745265.500000,1643757.750000
Hyderabad,MarketLinc,2658491.000000,2658491.000000
Mumbai,Rahul Industries,6044006.000000,3037137.500000
Mumbai,NVIDIA,4187500.000000,1541363.333333
Mumbai,VINAYA KUMAR,4029337.000000,2414668.500000
Mumbai,Goldman Sachs,3977066.000000,1903402.600000
Mumbai,Zee Entertainment Enterprises Ltd.,3531413.000000,3531413.000000
New Delhi,Super Highway Labs,3665141.000000,3665141.000000
New Delhi,Greenlight Planet,2876666.000000,1918288.500000
New Delhi,Boston Scientific,2707106.000000,2707106.000000
New Delhi,DreamOrbit Softech,2612697.000000,2612697.000000
New Delhi,OLX Group,2606510.000000,2606510.000000
Pune,Atos,5273205.000000,5273205.000000
Pune,Volkswagen,5184922.000000,5184922.000000
Pune,RAKESH GROUP,5016304.000000,5016304.000000
Pune,The City Bank,5000000.000000,5000000.000000
Pune,DasDas,4466071.000000,4466071.000000


2025-02-10 11:52:18 - root - INFO - Please check the answer again by reviewing Using a Salary Dataset where the salary values need to be cleaned by removing non-numeric characters and converting them to a numeric type, write a detailed SQL query that identifies the top 5 companies by average salary in each of Mumbai, Pune, New Delhi, and Hyderabad, then compares each company’s average salary in those cities to the overall national average salary. The final result should display four columns: Location, Company Name, Average Salary in State, and Average Salary in Country, listing only the top 5 companies in each of the specified locations., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: To identify the top 5 companies by average salary in each of Mumbai, Pune, New Delhi, and Hyderabad, and compare each company's average salary in those cities to the overall national average salary, you would perform the following steps:

1. **Clean the Salary Data**: Remove any non-numeric characters from the `Salary` column and convert the values to a numeric data type.
2. **Calculate Average Salaries**:
   - Compute the average salary for each company in each specified city.
   - Compute the national average salary for each company across all locations.
3. **Identify Top Companies**:
   - For each city, select the top 5 companies based on their average salary in that city.
4. **Compile the Results**: Present the findings in a table with the required columns.

Here is the expected format of the final result:

```csv
Location,Company Name,Average Salary in State,Average Salary in Country
Mumbai,company1:str,avg_salary_state1:float,avg_salary_country1:float
Mumbai,company2:str,avg_salary_state2:float,avg_salary_country2:float
Mumbai,company3:str,avg_salary_state3:float,avg_salary_country3:float
Mumbai,company4:str,avg_salary_state4:float,avg_salary_country4:float
Mumbai,company5:str,avg_salary_state5:float,avg_salary_country5:float
Pune,company1:str,avg_salary_state1:float,avg_salary_country1:float
Pune,company2:str,avg_salary_state2:float,avg_salary_country2:float
Pune,company3:str,avg_salary_state3:float,avg_salary_country3:float
Pune,company4:str,avg_salary_state4:float,avg_salary_country4:float
Pune,company5:str,avg_salary_state5:float,avg_salary_country5:float
New Delhi,company1:str,avg_salary_state1:float,avg_salary_country1:float
New Delhi,company2:str,avg_salary_state2:float,avg_salary_country2:float
New Delhi,company3:str,avg_salary_state3:float,avg_salary_country3:float
New Delhi,company4:str,avg_salary_state4:float,avg_salary_country4:float
New Delhi,company5:str,avg_salary_state5:float,avg_salary_country5:float
Hyderabad,company1:str,avg_salary_state1:float,avg_salary_country1:float
Hyderabad,company2:str,avg_salary_state2:float,avg_salary_country2:float
Hyderabad,company3:str,avg_salary_state3:float,avg_salary_country3:float
Hyderabad,company4:str,avg_salary_state4:float,avg_salary_country4:float
Hyderabad,company5:str,avg_salary_state5:float,avg_salary_country5:float
```

**Explanation:**

- **Location**: The city (Mumbai, Pune, New Delhi, or Hyderabad).
- **Company Name**: Name of the company.
- **Average Salary in State**: The company's average salary in the specified city.
- **Average Salary in Country**: The company's average salary across all locations.

Each city lists the top 5 companies based on the highest average salary within that city, along with their national average salary for comparison.

*Note: The actual data values are placeholders since the dataset is not accessible for computation.* The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Location,CompanyName,AvgSalaryState,AvgSalaryCountry
Hyderabad,Qwerty Concepts,5081882.000000,5081882.000000
Hyderabad,SetuServ,4949704.000000,4949704.000000
Hyderabad,XYZ (Turkey),3000000.000000,1510743.500000
Hyderabad,ABCDEF,2745265.500000,1643757.750000
Hyderabad,MarketLinc,2658491.000000,2658491.000000
Mumbai,Rahul Industries,6044006.000000,3037137.500000
Mumbai,NVIDIA,4187500.000000,1541363.333333
Mumbai,VINAYA KUMAR,4029337.000000,2414668.500000
Mumbai,Goldman Sachs,3977066.000000,1903402.600000
Mumbai,Zee Entertainment Enterprises Ltd.,3531413.000000,3531413.000000
New Delhi,Super Highway Labs,3665141.000000,3665141.000000
New Delhi,Greenlight Planet,2876666.000000,1918288.500000
New Delhi,Boston Scientific,2707106.000000,2707106.000000
New Delhi,DreamOrbit Softech,2612697.000000,2612697.000000
New Delhi,OLX Group,2606510.000000,2606510.000000
Pune,Atos,5273205.000000,5273205.000000
Pune,Volkswagen,5184922.000000,5184922.000000
Pune,RAKESH GROUP,5016304.000000,5016304.000000
Pune,The City Bank,5000000.000000,5000000.000000
Pune,DasDas,4466071.000000,4466071.000000
Current sql:
WITH cleaned_data AS (
    SELECT
        "CompanyName",
        "Location",
        TRY_TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', '')) AS "SalaryNumeric"
    FROM
        EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
    WHERE
        "Salary" IS NOT NULL
        AND "Salary" != ''
)
, avg_salary_state AS (
    SELECT
        "CompanyName",
        "Location",
        AVG("SalaryNumeric") AS "AvgSalaryState"
    FROM
        cleaned_data
    WHERE
        "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
    GROUP BY
        "CompanyName", "Location"
)
, avg_salary_country AS (
    SELECT
        "CompanyName",
        AVG("SalaryNumeric") AS "AvgSalaryCountry"
    FROM
        cleaned_data
    GROUP BY
        "CompanyName"
)
, ranked_companies AS (
    SELECT
        t1."Location",
        t1."CompanyName",
        t1."AvgSalaryState",
        t2."AvgSalaryCountry",
        ROW_NUMBER() OVER (PARTITION BY t1."Location" ORDER BY t1."AvgSalaryState" DESC) AS rn
    FROM
        avg_salary_state t1
        JOIN avg_salary_country t2 ON t1."CompanyName" = t2."CompanyName"
)
SELECT
    "Location",
    "CompanyName",
    "AvgSalaryState",
    "AvgSalaryCountry"
FROM
    ranked_companies
WHERE
    rn <= 5
ORDER BY
    "Location",
    "AvgSalaryState" DESC;When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-02-10 11:52:43 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 11:52:43 - root - INFO - To identify the top 5 companies by average salary in each of Mumbai, Pune, New Delhi, and Hyderabad, and compare each company's average salary in those cities to the overall national average salary, you would perform the following steps:

1. **Clean the Salary Data**: Remove any non-numeric characters from the `Salary` column and convert the values to a numeric data type.

2. **Calculate Average Salaries**:
   - Compute the average salary for each company in each specified city.
   - Compute the national average salary for each company across all locations.

3. **Identify Top Companies**:
   - For each city, select the top 5 companies based on their average salary in that city.

4. **Compile the Results**: Present the findings in a table with the required columns, ensuring that the average salaries retain all decimals up to four places.

Here is the SQL query to achieve this:

```sql
WITH cleaned_data AS (
    SELECT
        "CompanyName",
        "Location",
        TRY_TO_NUMBER(REGEXP_REPLACE("Salary", '[^0-9.]', '')) AS "SalaryNumeric"
    FROM
        EDUCATION_BUSINESS.EDUCATION_BUSINESS.SALARYDATASET
    WHERE
        "Salary" IS NOT NULL
        AND "Salary" != ''
),
avg_salary_state AS (
    SELECT
        "CompanyName",
        "Location",
        ROUND(AVG("SalaryNumeric"), 4) AS "AvgSalaryState"
    FROM
        cleaned_data
    WHERE
        "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
    GROUP BY
        "CompanyName", "Location"
),
avg_salary_country AS (
    SELECT
        "CompanyName",
        ROUND(AVG("SalaryNumeric"), 4) AS "AvgSalaryCountry"
    FROM
        cleaned_data
    GROUP BY
        "CompanyName"
),
ranked_companies AS (
    SELECT
        t1."Location",
        t1."CompanyName",
        t1."AvgSalaryState",
        t2."AvgSalaryCountry",
        ROW_NUMBER() OVER (
            PARTITION BY t1."Location"
            ORDER BY t1."AvgSalaryState" DESC NULLS LAST
        ) AS rn
    FROM
        avg_salary_state t1
        JOIN avg_salary_country t2 ON t1."CompanyName" = t2."CompanyName"
)
SELECT
    "Location",
    "CompanyName",
    "AvgSalaryState",
    "AvgSalaryCountry"
FROM
    ranked_companies
WHERE
    rn <= 5
ORDER BY
    "Location",
    "AvgSalaryState" DESC NULLS LAST;
```

This query performs the required data cleaning, calculations, and rankings while adhering to the specified formatting and decimal precision. It ensures that any NULL values are placed last in the ordering, as instructed.
2025-02-10 11:52:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:52:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:52:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:52:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-02-10 11:52:44 - snowflake.connector.connection - INFO - closed
2025-02-10 11:52:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:52:45 - root - INFO - itercount: 2
2025-02-10 11:52:45 - root - INFO - 0
2025-02-10 11:52:45 - root - INFO - Total iteration counts: 2
