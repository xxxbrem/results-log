2025-02-10 11:46:29 - openai._base_client - INFO - Retrying request to /chat/completions in 0.409714 seconds
2025-02-10 11:47:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 11:47:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:47:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:47:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:47:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-02-10 11:47:10 - snowflake.connector.connection - INFO - closed
2025-02-10 11:47:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:47:10 - root - INFO - SQL:
SELECT DISTINCT "Location"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   LIMIT 100;
Results:
Location
Bangalore
Pune
Hyderabad
New Delhi
Mumbai

2025-02-10 11:47:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:47:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:47:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:47:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:47:11 - snowflake.connector.connection - INFO - closed
2025-02-10 11:47:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:47:12 - root - INFO - SQL:
SELECT "CompanyName", "Salary"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   WHERE "Location" = 'Mumbai'
   LIMIT 100;
Results:
CompanyName,Salary
Fractal,"₹16,43,351/yr"
Tata Consultancy Services,"₹5,66,756/yr"
Accenture,"₹9,00,000/yr"
Capgemini,"₹10,55,889/yr"
Jio,"₹10,37,441/yr"
Reliance Industries,"₹17,73,222/yr"
Housing.com,"₹23,83,368/yr"
Quantiphi,"₹9,19,025/yr"
Axis Bank,"₹11,93,674/yr"
LTI,"₹6,44,930/yr"
HDFC Bank,"₹10,70,583/yr"
Vodafone Idea,"₹20,09,767/yr"
CASHe,"₹10,98,034/yr"
Infosys,"₹11,02,095/yr"
Cognizant Technology Solutions,"₹8,30,959/yr"
Deloitte,"₹11,91,942/yr"
First Student,"₹12,10,857/yr"
CitiusTech,"₹2,94,111/yr"
RBL Bank,"₹11,80,704/yr"
ZEE5,"₹14,58,789/yr"
Mahindra Integrated Business Solutions,"₹9,74,832/yr"
DataScientest,"₹45,684/mo"
Pentation Analytics,"₹6,50,654/yr"
NDS InfoServ,"₹9,26,744/yr"
Arya.ai,"₹8,38,354/yr"
Wipro,"₹30,368/mo"
Amazon,"₹10,18,095/yr"
IBM,"₹11,93,120/yr"
PwC,"₹14,49,831/yr"
Google,"₹13,55,169/yr"
Atos-Syntel,"₹8,75,733/yr"
Siemens,"₹12,57,890/yr"
Mahindra,"₹10,22,850/yr"
eClerx,"₹7,33,769/yr"
HERE Technologies,"₹17,82,011/yr"
HDFC Standard Life Insurance,"₹12,21,714/yr"
Morningstar,"₹9,57,432/yr"
L&T Financial Services,"₹8,86,778/yr"
Piramal Enterprises,"₹72,216/mo"
Piramal Enterprises,"₹11,60,523/yr"
Episource,"₹8,94,949/yr"
XPO Logistics,"₹15,81,030/yr"
Loylty Rewardz Mngt,"₹12,23,523/yr"
Karza Technologies,"₹17,00,000/yr"
Prudential plc,"₹11,08,264/yr"
Dure Technologies,"₹12,89,859/yr"
Tata Consultancy Services,"₹18,737/mo"
Tech Mahindra,"₹8,85,892/yr"
EY,"₹10,25,737/yr"
Fresher,"₹50,367/mo"
ICICI Bank,"₹49,111/mo"
Microsoft,"₹2,16,685/mo"
ABC,"₹10,36,761/yr"
Kotak Mahindra,"₹66,648/mo"
Freshworks,"₹4,94,353/yr"
NVIDIA,"₹41,87,500/yr"
HERE Technologies,"₹41,940/mo"
Fractal,"₹39,822/mo"
MAERSK,"₹17,17,206/yr"
Tata AIG General Insurance,"₹14,06,673/yr"
General Mills,"₹17,34,062/yr"
Motilal Oswal Securities,"₹6,49,989/yr"
Hdfc,"₹64,952/mo"
Tata Group,"₹9,77,421/yr"
PharmEasy,"₹14,51,194/yr"
Decimal Point Analytics,"₹11,26,055/yr"
People Group,"₹13,14,654/yr"
MiQ,"₹12,40,055/yr"
UPL,"₹9,91,653/yr"
Lead School (India),"₹1,10,833/mo"
LogiNext Solutions,"₹4,65,001/yr"
Bewakoof Brands,"₹7,30,703/yr"
Meru Mobility Tech,"₹9,60,996/yr"
Kissht,"₹56,676/mo"
Radhakrishna Foodland,"₹3,04,060/yr"
Tableau Software,"₹28,65,536/yr"
FlexiLoans Technologies,"₹8,27,693/yr"
Square Panda,"₹6,76,720/yr"
Think Analytics,"₹6,06,168/yr"
Locobuzz,"₹8,35,493/yr"
SMEcorner,"₹40,725/mo"
Quantsapp,"₹18,926/mo"
HDFC Developers,"₹14,94,696/yr"
Javis,"₹20,75,185/yr"
Cuddle,"₹19,61,487/yr"
Arohi Operations,"₹30,834/mo"
Accenture,"₹1,01,809/yr"
IBM,"$2,05,476/yr"
IBM,"₹7,02,485/yr"
HCL Technologies,"₹14,17,138/yr"
Oracle,"₹10,00,000/yr"
BYJU'S,"₹10,00,000/yr"
LTI,"₹6,13,163/yr"
Mindtree,"₹10,31,658/yr"
Microsoft,"₹45,172/mo"
J.P. Morgan,"₹21,86,509/yr"
J.P. Morgan,"₹81,105/mo"
Cisco Systems,"₹10,880/mo"
ABC,"$96,739/yr"
Reliance Industries,"₹9,59,911/yr"

2025-02-10 11:47:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:47:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:47:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:47:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:47:13 - snowflake.connector.connection - INFO - closed
2025-02-10 11:47:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:47:13 - root - INFO - SQL:
SELECT "CompanyName", "Salary", "Location"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
   LIMIT 100;
Results:
CompanyName,Salary,Location
Tata Consultancy Services,"₹7,17,331/yr",Pune
Innoplexus,"₹11,63,186/yr",Pune
IBM,"₹10,36,536/yr",Pune
AlgoAnalytics Financial Consultancy,"₹7,42,883/yr",Pune
ZS Associates,"₹12,94,039/yr",Pune
Wolters Kluwer,"₹11,54,579/yr",Pune
Cognizant Technology Solutions,"₹7,65,632/yr",Pune
Accenture,"₹6,02,937/yr",Pune
Wipro,"₹11,50,000/yr",Pune
Zensar Technologies,"₹8,54,957/yr",Pune
Bajaj Finance,"₹9,56,307/yr",Pune
SG Analytics,"₹8,16,946/yr",Pune
ThinkBumblebee Analytics,"₹10,70,536/yr",Pune
Michelin,"₹11,46,043/yr",Pune
Tech Mahindra,"₹11,14,163/yr",Pune
Schlumberger,"₹20,54,972/yr",Pune
Merkle,"₹11,34,768/yr",Pune
Infosys,"₹8,78,252/yr",Pune
Capgemini,"₹8,98,351/yr",Pune
LTI,"₹8,14,017/yr",Pune
First Student,"₹4,25,000/yr",Pune
Vodafone,"₹9,40,423/yr",Pune
Eaton,"₹11,21,845/yr",Pune
T-Systems,"₹12,15,906/yr",Pune
Coupa Software Inc,"₹10,55,811/yr",Pune
Aera Technology,"₹16,22,612/yr",Pune
ABC,"₹42,249/mo",Pune
Amdocs,"₹7,18,534/yr",Pune
Atos-Syntel,"₹4,23,422/yr",Pune
Barclays,"₹17,33,746/yr",Pune
KPIT Technologies,"₹16,55,120/yr",Pune
Credit Suisse,"₹14,21,672/yr",Pune
Saama Technologies,"₹9,34,857/yr",Pune
Exela Technologies,"₹8,56,429/yr",Pune
Abzooba,"₹18,00,000/yr",Pune
Linsyssoft Technologies,"₹4,11,680/yr",Pune
HCL Technologies,"₹61,248/mo",Pune
Fresher,"₹51,920/mo",Pune
Axis Bank,"₹2,32,796/mo",Pune
Freelancer,"₹10,01,630/yr",Pune
Citi,"₹15,77,759/yr",Pune
ADP,"₹52,491/mo",Pune
Birlasoft,"₹52,16,933/yr",Pune
John Deere,"₹14,63,658/yr",Pune
Xoriant,"₹17,72,001/yr",Pune
GS Lab,"₹8,34,387/yr",Pune
Searce,"₹8,28,221/yr",Pune
Globant,"₹1,00,275/mo",Pune
e-Zest Solutions,"₹9,32,104/yr",Pune
Datametica,"₹9,83,550/yr",Pune
Vyom Labs,"₹25,446/mo",Pune
Vishwakarma Institute of Technology,₹602/hr,Pune
Knorex,"₹53,475/mo",Pune
CanWill Technologies,"₹11,61,602/yr",Pune
ThinkBridge,"₹63,058/mo",Pune
Coditation Systems,"₹46,977/mo",Pune
MindBowser Info Solutions,"₹2,83,914/yr",Pune
Climate Connect,"₹7,31,758/yr",Pune
Tech9,"₹16,87,208/yr",Pune
Eagle TK Infotech,"₹7,13,466/yr",Pune
Fusion Practices,"₹56,250/mo",Pune
Xeco,"₹4,99,961/yr",Pune
DeepTek Medical Imaging,"₹8,95,000/yr",Pune
vElement,"₹2,53,851/yr",Pune
Asquared IoT,"₹6,37,645/yr",Pune
HiLabs (MD),"₹19,54,650/yr",Pune
Jash Data Sciences,"₹6,69,083/yr",Pune
HiLabs,"₹18,33,778/yr",Pune
Tata Consultancy Services,"₹25,000/mo",Pune
Tata Consultancy Services,"£7,03,427/yr",Pune
Amazon,"₹1,15,884/yr",Pune
Amazon,"₹6,19,069/yr",Pune
Genpact,"₹16,00,000/yr",Pune
Fresher,"₹30,147/mo",Pune
DXC Technology,"₹4,00,000/yr",Pune
KPMG,"₹6,42,322/yr",Pune
ABC,"₹1,01,398/mo",Pune
Larsen & Toubro,"₹30,000/mo",Pune
Concentrix,"₹2,89,045/mo",Pune
Google,"₹75,71,032/yr",Pune
Honeywell,"₹14,38,481/yr",Pune
Persistent Systems,"₹2,141/hr",Pune
DONE by NONE,"₹1,00,000/mo",Pune
DONE by NONE,"₹44,44,315/yr",Pune
DONE by NONE,"₹3,01,469/yr",Pune
WNS,"£2,05,049/yr",Pune
Siemens,"₹70,000/mo",Pune
Nones,"₹6,00,000/yr",Pune
ITC Infotech,"₹6,42,322/yr",Pune
Mahindra,"₹9,05,000/yr",Pune
Kotak Mahindra,"₹6,23,238/yr",Pune
eClerx,"₹8,70,000/yr",Pune
BNY Mellon,"₹64,232/mo",Pune
Zomato,"₹12,50,000/yr",Pune
Hinduja Global Solutions,"₹11,76,710/yr",Pune
Other,"₹4,14,794/yr",Pune
Thoughtworks,"₹25,69,287/yr",Pune
Fractal,"₹14,04,565/yr",Pune
TietoEVRY,"₹7,87,318/yr",Pune
Yash Technologies,"₹20,54,972/yr",Pune

2025-02-10 11:47:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:47:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:47:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:47:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:47:14 - snowflake.connector.connection - INFO - closed
2025-02-10 11:47:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:47:15 - root - INFO - SQL:
SELECT "Salary"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   LIMIT 100;
Results:
Salary
"₹6,48,573/yr"
"₹11,91,950/yr"
"₹8,36,874/yr"
"₹6,69,578/yr"
"₹9,44,110/yr"
"₹9,08,764/yr"
"₹9,26,124/yr"
"₹7,36,708/yr"
"₹16,46,721/yr"
"₹13,92,960/yr"
"₹14,04,773/yr"
"₹15,07,343/yr"
"₹15,58,095/yr"
"₹25,57,843/yr"
"₹15,10,081/yr"
"₹7,32,821/yr"
"₹12,21,750/yr"
"₹17,39,484/yr"
"₹11,24,939/yr"
"₹16,30,396/yr"
"₹10,09,436/yr"
"₹5,50,980/yr"
"₹18,70,000/yr"
"₹7,58,376/yr"
"₹15,56,575/yr"
"₹11,94,327/yr"
"₹14,70,000/yr"
"₹15,49,942/yr"
"₹10,09,436/yr"
"₹15,41,572/yr"
"₹8,11,182/yr"
"₹12,05,874/yr"
"₹7,27,111/yr"
"₹19,23,257/yr"
"₹21,43,501/yr"
"₹19,26,965/yr"
"₹41,271/mo"
"₹12,94,984/yr"
"₹23,34,960/yr"
"₹22,67,616/yr"
"₹13,66,992/yr"
"₹14,53,427/yr"
"₹14,58,032/yr"
"₹17,30,166/yr"
"₹6,58,109/yr"
"₹7,94,460/yr"
"₹25,67,381/yr"
"₹16,37,231/yr"
"₹9,00,000/yr"
"₹9,02,935/yr"
"₹9,70,782/yr"
"₹10,50,000/yr"
"₹21,19,584/yr"
"₹16,87,111/yr"
"₹14,65,641/yr"
"₹6,00,000/yr"
"₹18,05,869/yr"
"₹26,24,063/yr"
"₹9,55,297/yr"
"₹7,61,478/yr"
"₹28,05,476/yr"
"₹9,69,112/yr"
"₹4,50,979/yr"
"₹13,38,795/yr"
"₹10,40,493/yr"
"₹12,91,549/yr"
"₹49,928/mo"
"₹16,63,189/yr"
"₹13,23,387/yr"
"₹12,46,266/yr"
"₹4,94,147/yr"
"₹18,92,758/yr"
"₹15,72,054/yr"
"₹20,24,533/yr"
"₹19,27,564/yr"
"₹8,00,000/yr"
"₹20,09,790/yr"
"₹8,31,462/yr"
"₹5,16,323/yr"
"₹23,33,241/yr"
"₹12,00,000/yr"
"₹20,06,522/yr"
"₹21,60,000/yr"
"₹13,41,316/yr"
"₹16,34,105/yr"
"₹13,89,256/yr"
"₹10,00,000/yr"
"₹12,31,116/yr"
"₹23,52,941/yr"
"₹7,44,551/yr"
"₹30,14,686/yr"
"₹13,57,204/yr"
"₹10,53,196/yr"
"₹13,37,606/yr"
"₹48,825/mo"
"₹32,953/mo"
"₹16,49,930/yr"
"₹11,38,060/yr"
"₹16,12,744/yr"
"₹4,32,776/yr"

2025-02-10 11:47:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:47:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:47:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:47:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:47:15 - snowflake.connector.connection - INFO - closed
2025-02-10 11:47:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:47:16 - root - INFO - SQL:
SELECT "Salary", REGEXP_REPLACE("Salary", '[^0-9.]', '') AS "CleanedSalary"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   LIMIT 100;
Results:
Salary,CleanedSalary
"₹6,48,573/yr",648573
"₹11,91,950/yr",1191950
"₹8,36,874/yr",836874
"₹6,69,578/yr",669578
"₹9,44,110/yr",944110
"₹9,08,764/yr",908764
"₹9,26,124/yr",926124
"₹7,36,708/yr",736708
"₹16,46,721/yr",1646721
"₹13,92,960/yr",1392960
"₹14,04,773/yr",1404773
"₹15,07,343/yr",1507343
"₹15,58,095/yr",1558095
"₹25,57,843/yr",2557843
"₹15,10,081/yr",1510081
"₹7,32,821/yr",732821
"₹12,21,750/yr",1221750
"₹17,39,484/yr",1739484
"₹11,24,939/yr",1124939
"₹16,30,396/yr",1630396
"₹10,09,436/yr",1009436
"₹5,50,980/yr",550980
"₹18,70,000/yr",1870000
"₹7,58,376/yr",758376
"₹15,56,575/yr",1556575
"₹11,94,327/yr",1194327
"₹14,70,000/yr",1470000
"₹15,49,942/yr",1549942
"₹10,09,436/yr",1009436
"₹15,41,572/yr",1541572
"₹8,11,182/yr",811182
"₹12,05,874/yr",1205874
"₹7,27,111/yr",727111
"₹19,23,257/yr",1923257
"₹21,43,501/yr",2143501
"₹19,26,965/yr",1926965
"₹41,271/mo",41271
"₹12,94,984/yr",1294984
"₹23,34,960/yr",2334960
"₹22,67,616/yr",2267616
"₹13,66,992/yr",1366992
"₹14,53,427/yr",1453427
"₹14,58,032/yr",1458032
"₹17,30,166/yr",1730166
"₹6,58,109/yr",658109
"₹7,94,460/yr",794460
"₹25,67,381/yr",2567381
"₹16,37,231/yr",1637231
"₹9,00,000/yr",900000
"₹9,02,935/yr",902935
"₹9,70,782/yr",970782
"₹10,50,000/yr",1050000
"₹21,19,584/yr",2119584
"₹16,87,111/yr",1687111
"₹14,65,641/yr",1465641
"₹6,00,000/yr",600000
"₹18,05,869/yr",1805869
"₹26,24,063/yr",2624063
"₹9,55,297/yr",955297
"₹7,61,478/yr",761478
"₹28,05,476/yr",2805476
"₹9,69,112/yr",969112
"₹4,50,979/yr",450979
"₹13,38,795/yr",1338795
"₹10,40,493/yr",1040493
"₹12,91,549/yr",1291549
"₹49,928/mo",49928
"₹16,63,189/yr",1663189
"₹13,23,387/yr",1323387
"₹12,46,266/yr",1246266
"₹4,94,147/yr",494147
"₹18,92,758/yr",1892758
"₹15,72,054/yr",1572054
"₹20,24,533/yr",2024533
"₹19,27,564/yr",1927564
"₹8,00,000/yr",800000
"₹20,09,790/yr",2009790
"₹8,31,462/yr",831462
"₹5,16,323/yr",516323
"₹23,33,241/yr",2333241
"₹12,00,000/yr",1200000
"₹20,06,522/yr",2006522
"₹21,60,000/yr",2160000
"₹13,41,316/yr",1341316
"₹16,34,105/yr",1634105
"₹13,89,256/yr",1389256
"₹10,00,000/yr",1000000
"₹12,31,116/yr",1231116
"₹23,52,941/yr",2352941
"₹7,44,551/yr",744551
"₹30,14,686/yr",3014686
"₹13,57,204/yr",1357204
"₹10,53,196/yr",1053196
"₹13,37,606/yr",1337606
"₹48,825/mo",48825
"₹32,953/mo",32953
"₹16,49,930/yr",1649930
"₹11,38,060/yr",1138060
"₹16,12,744/yr",1612744
"₹4,32,776/yr",432776

2025-02-10 11:47:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:47:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:47:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:47:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:47:17 - snowflake.connector.connection - INFO - closed
2025-02-10 11:47:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:47:17 - root - INFO - SQL:
SELECT "CompanyName", REGEXP_REPLACE("Salary", '[^0-9.]', '') AS "CleanedSalary"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   WHERE "Location" = 'Hyderabad'
   LIMIT 100;
Results:
CompanyName,CleanedSalary
Microsoft,1712178
Cyient,999578
Tata Consultancy Services,697843
Infosys,583334
Amazon,1693961
Innominds Software,743423
IBM,628945
Tech Mahindra,652546
Quadratic Insights,583954
Jotter,915028
Cognizant Technology Solutions,890344
Jio,1997027
Verizon,1330683
Optum,1464110
Accenture,1104293
Deloitte,1483132
First Student,53365
Novartis,1280703
Karvy Group,594589
Wipro,1041195
Oracle,1221714
HighRadius,861434
Micron Technology,1564421
INSOFE,903446
Google,1121437
Blue Yonder,2020386
Yash Technologies,54290
DataScientest,56039
Claim Genius,1944821
Capgemini,651206
Genpact,653174
Fresher,503667
Fresher,302693
ICICI Bank,1600000
DXC Technology,1252143
Dell Technologies,825326
Microsoft,53351
Wipro Technologies,895427
Tata Consultancy Services (North America),814476
Google,411763
NTT DATA,564654
Jio,37173
ADP,1200000
Sutherland,926912
MetLife,1760000
Franklin Templeton Investments,1353553
Enquero,1048242
Brane Enterprises (nslhub),1665911
AlgonoX Technologies,1074883
Voziq,642113
HCL Technologies,1561319
First Student,25304
Virtusa,304522
Persistent Systems,1287441
UnitedHealth Group,1152418
Freshers.com,630000
Legato Health Technologies,1260152
Dr. Reddy's,433223
DBS Bank,995830
Broadridge,1607926
Optum Global Solutions,778902
Great Learning,777837
National Payments Corporation of India,1492543
Excelra Knowledge Solutions,452130
WinWire Technologies,1269639
CallHealth,823971
Gaian Solutions India,1100233
eKincare,650865
Siva Solutions,335625
Innodatatics,9392
Innodatatics,1157086
SpringML,65953
AppsTek,725664
Vertiv,702649
My Ally,89047
GoLorry,792139
Bepec Solutions,646889
KOGENTiX,700977
Prudent Technologies & Consulting,376159
App Orchid,1492959
3LOQ Labs,778644
RisingRoot Technologies,13255
Artificial Penetration,585088
Wave Infosoft,619995
SetuServ,4949704
DigiTele Networks,787723
Human Network,58648
diwo,792506
SysBasis Solutions,25204
Tata Consultancy Services,665229
Accenture,122633
Deloitte,644153
LTI,1041195
First Student,610857
Mindtree,1105372
ABC,12515
Reliance Industries,169396
Tata Consultancy Services (North America),908078
Google,1243165
Honeywell,1653407

2025-02-10 11:47:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:47:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:47:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:47:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:47:18 - snowflake.connector.connection - INFO - closed
2025-02-10 11:47:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:47:19 - root - INFO - SQL:
SELECT "CompanyName", CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT) AS "SalaryNumeric"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   WHERE "Location" = 'Pune'
   LIMIT 100;
Results:
CompanyName,SalaryNumeric
Tata Consultancy Services,717331.0
Innoplexus,1163186.0
IBM,1036536.0
AlgoAnalytics Financial Consultancy,742883.0
ZS Associates,1294039.0
Wolters Kluwer,1154579.0
Cognizant Technology Solutions,765632.0
Accenture,602937.0
Wipro,1150000.0
Zensar Technologies,854957.0
Bajaj Finance,956307.0
SG Analytics,816946.0
ThinkBumblebee Analytics,1070536.0
Michelin,1146043.0
Tech Mahindra,1114163.0
Schlumberger,2054972.0
Merkle,1134768.0
Infosys,878252.0
Capgemini,898351.0
LTI,814017.0
First Student,425000.0
Vodafone,940423.0
Eaton,1121845.0
T-Systems,1215906.0
Coupa Software Inc,1055811.0
Aera Technology,1622612.0
ABC,42249.0
Amdocs,718534.0
Atos-Syntel,423422.0
Barclays,1733746.0
KPIT Technologies,1655120.0
Credit Suisse,1421672.0
Saama Technologies,934857.0
Exela Technologies,856429.0
Abzooba,1800000.0
Linsyssoft Technologies,411680.0
HCL Technologies,61248.0
Fresher,51920.0
Axis Bank,232796.0
Freelancer,1001630.0
Citi,1577759.0
ADP,52491.0
Birlasoft,5216933.0
John Deere,1463658.0
Xoriant,1772001.0
GS Lab,834387.0
Searce,828221.0
Globant,100275.0
e-Zest Solutions,932104.0
Datametica,983550.0
Vyom Labs,25446.0
Vishwakarma Institute of Technology,602.0
Knorex,53475.0
CanWill Technologies,1161602.0
ThinkBridge,63058.0
Coditation Systems,46977.0
MindBowser Info Solutions,283914.0
Climate Connect,731758.0
Tech9,1687208.0
Eagle TK Infotech,713466.0
Fusion Practices,56250.0
Xeco,499961.0
DeepTek Medical Imaging,895000.0
vElement,253851.0
Asquared IoT,637645.0
HiLabs (MD),1954650.0
Jash Data Sciences,669083.0
HiLabs,1833778.0
Tata Consultancy Services,25000.0
Tata Consultancy Services,703427.0
Amazon,115884.0
Amazon,619069.0
Genpact,1600000.0
Fresher,30147.0
DXC Technology,400000.0
KPMG,642322.0
ABC,101398.0
Larsen & Toubro,30000.0
Concentrix,289045.0
Google,7571032.0
Honeywell,1438481.0
Persistent Systems,2141.0
DONE by NONE,100000.0
DONE by NONE,4444315.0
DONE by NONE,301469.0
WNS,205049.0
Siemens,70000.0
Nones,600000.0
ITC Infotech,642322.0
Mahindra,905000.0
Kotak Mahindra,623238.0
eClerx,870000.0
BNY Mellon,64232.0
Zomato,1250000.0
Hinduja Global Solutions,1176710.0
Other,414794.0
Thoughtworks,2569287.0
Fractal,1404565.0
TietoEVRY,787318.0
Yash Technologies,2054972.0

2025-02-10 11:47:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:47:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:47:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:47:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:47:20 - snowflake.connector.connection - INFO - closed
2025-02-10 11:47:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:47:20 - root - INFO - SQL:
SELECT "CompanyName", AVG(CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT)) AS "AverageSalary"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   GROUP BY "CompanyName"
   ORDER BY "AverageSalary" DESC
   LIMIT 100;
Results:
CompanyName,AverageSalary
Artis signature,7524456.0
CAPA - Centre for Aviation,5995002.0
BITS Pilani,5742016.0
Atos,5273205.0
Volkswagen,5184922.0
Qwerty Concepts,5081882.0
RAKESH GROUP,5016304.0
The City Bank,5000000.0
SetuServ,4949704.0
qplum,4885471.0
Snap,4498962.0
DasDas,4466071.0
ABC Consultants,4282144.0
Société Générale,4099921.0
Two Roads Tech,3812913.0
Instamojo,3808049.0
Rplus Analytics,3808049.0
Super Highway Labs,3665141.0
Zee Entertainment Enterprises Ltd.,3531413.0
Alfonso & Associates Consulting,3530641.0
Amphisoft Technologies,3517133.0
QiO Technologies,3517133.0
Pratilipi,3447524.0
Kiwi labs,3411087.0
Daimler,3387921.0
Freelance,3250773.0
Google Cloud,3211608.0
Automation Anywhere,3200000.0
Hypersonix (CA),3146934.0
Dacasa Financeira,3132009.0
Seernet Technologies,3123584.0
Fellowship.AI,3115175.0
Endurance International Group,3108546.0
MoneyTap,3097936.0
Microland,3070054.0
Rahul Industries,3037137.5
Priyanshu Plastic,3026926.0
CRED,3014686.0
Seventh Contact Hiring Solutions,3008206.0
i4u Labs,2992992.0
Agara Labs,2954147.0
Freshworks,2939735.5
Zoom Video Communications,2839076.0
R.S. Consultants,2816193.0
Cvedia,2794695.0
Bright Money,2739727.0
Boston Scientific,2707106.0
Standard Chartered Global Business Services,2682633.0
Equinor,2676340.0
MarketLinc,2658491.0
ConcertAI,2647046.0
DreamOrbit Softech,2612697.0
Hitachi,2611178.0
OLX Group,2606510.0
Bizongo,2597406.0
Sabre,2581613.0
Aligned Automation,2579455.0
Interactions,2579145.0
Naukri.com,2576614.0
Juniper Networks,2561949.0
Intuit,2560448.5
Savit Interactive,2558957.0
PhonePe,2550000.0
Colors Software,2545237.0
Priceline.com,2540253.0
Numerify,2530666.0
CognitiveScale,2511982.0
Nuartin Labs,2508152.0
Aegon,2508152.0
SmartCow,2500000.0
Locus,2472920.0
Incubit,2452654.0
None of Your Business Boutique,2452654.0
Avaamo,2452646.0
Acalvio,2442736.0
KhataBook,2433547.0
Wabtec,2420967.0
VINAYA KUMAR,2414668.5
Thoughtworks,2402800.5
ICE Mortgage Technology Senior,2400000.0
Zopper,2360899.0
Credit Saison India,2332149.0
Birdeye,2311305.0
FogHorn Systems,2300000.0
ShareChat,2300000.0
Compass,2269647.0
Smith & Nephew,2266502.0
Boeing,2266312.0
Connaizen Software,2265784.0
Meta,2258845.5
mroads,2239989.0
Sama Technology,2210744.0
Atlassian,2200000.0
redBus India,2194861.0
VMware,2189676.5
Lymbyc,2149765.0
XPO Logistics,2148867.0
Peak,2148775.0
Procter & Gamble,2144970.0
Fractal Systems,2141072.0

2025-02-10 11:47:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:47:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:47:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:47:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:47:21 - snowflake.connector.connection - INFO - closed
2025-02-10 11:47:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:47:22 - root - INFO - SQL:
SELECT "CompanyName", "Location", AVG(CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT)) AS "AverageSalary"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
   GROUP BY "CompanyName", "Location"
   ORDER BY "Location", "AverageSalary" DESC
   LIMIT 100;
Results:
CompanyName,Location,AverageSalary
Qwerty Concepts,Hyderabad,5081882.0
SetuServ,Hyderabad,4949704.0
XYZ (Turkey),Hyderabad,3000000.0
ABCDEF,Hyderabad,2745265.5
MarketLinc,Hyderabad,2658491.0
Hitachi,Hyderabad,2611178.0
Procter & Gamble,Hyderabad,2576614.0
CognitiveScale,Hyderabad,2511982.0
SmartCow,Hyderabad,2500000.0
Compass,Hyderabad,2269647.0
mroads,Hyderabad,2239989.0
Hitachi Consulting,Hyderabad,2063316.0
Blue Yonder,Hyderabad,2020386.0
Gainsight,Hyderabad,2000000.0
Claim Genius,Hyderabad,1944821.0
Fanatics,Hyderabad,1917053.0
ICS Consultancy,Hyderabad,1881045.0
Meeami Technologies,Hyderabad,1864748.0
Toppr.com,Hyderabad,1857397.0
MTX Group,Hyderabad,1813738.5
Cognizant,Hyderabad,1800000.0
Zenoti,Hyderabad,1792230.0
MetLife,Hyderabad,1760000.0
FactSet,Hyderabad,1746411.0
ValueLabs,Hyderabad,1744360.6666666667
Bharat Heavy Electricals,Hyderabad,1668775.0
Brane Enterprises (nslhub),Hyderabad,1665911.0
Honeywell,Hyderabad,1653407.0
Optum Global Solutions India,Hyderabad,1628949.0
Neudesic,Hyderabad,1611735.0
CreditVidya,Hyderabad,1581030.0
Altimetrik,Hyderabad,1572363.0
Landmark IT Solutions,Hyderabad,1562895.0
Anonymous,Hyderabad,1527142.0
Franklin Templeton Investments,Hyderabad,1514658.0
Qualcomm Technologies,Hyderabad,1513463.0
Byteridge Software,Hyderabad,1500000.0
App Orchid,Hyderabad,1492959.0
National Payments Corporation of India,Hyderabad,1492543.0
Activa (CA),Hyderabad,1490685.0
Apple,Hyderabad,1472350.0
Snap2Insight,Hyderabad,1452000.0
Microsoft,Hyderabad,1424931.2
Aeries Technology,Hyderabad,1410268.0
Myntra,Hyderabad,1394897.0
Ivy,Hyderabad,1370025.5
Qualcomm,Hyderabad,1362714.0
American Express,Hyderabad,1362714.0
Evoke Technologies,Hyderabad,1355831.0
Globex Digital Solutions,Hyderabad,1343603.0
Bharat Financial Inclusion,Hyderabad,1309535.0
Bank of America,Hyderabad,1285125.0
DXC Technology,Hyderabad,1284729.5
WinWire Technologies,Hyderabad,1269639.0
DuPont,Hyderabad,1265383.5
Zen3 Info Solutions,Hyderabad,1262347.3333333333
Jaffar Engineering Works,Hyderabad,1262223.0
ProArch,Hyderabad,1251537.0
TTEC,Hyderabad,1251502.0
Uber,Hyderabad,1247607.5
Tiger Analytics,Hyderabad,1221751.5
Applied Information Sciences,Hyderabad,1221714.0
Arcadis,Hyderabad,1221714.0
ICICI Bank,Hyderabad,1215690.5
E-rachit Technologies,Hyderabad,1210770.0
PepsiCo,Hyderabad,1210770.0
Optum,Hyderabad,1206212.3333333333
College Board,Hyderabad,1205860.0
Netflix,Hyderabad,1200000.0
Guidewire,Hyderabad,1200000.0
PwC,Hyderabad,1200000.0
CoreCompete,Hyderabad,1191367.0
Ola,Hyderabad,1182371.0
Oracle,Hyderabad,1180565.5
Google,Hyderabad,1166513.6666666667
State Bank of India,Hyderabad,1159476.0
Deloitte,Hyderabad,1154386.2
Enquero,Hyderabad,1148838.0
UnitedHealth Group,Hyderabad,1144968.0
Astegic,Hyderabad,1134824.0
CDK Global,Hyderabad,1123734.0
Amnet Digital,Hyderabad,1119904.0
EPAM,Hyderabad,1115191.0
Verizon,Hyderabad,1109216.0
Dun & Bradstreet,Hyderabad,1108068.0
Salesforce,Hyderabad,1107300.5
HSBC Software Development India,Hyderabad,1104068.3333333333
Gaian Solutions India,Hyderabad,1100233.0
Kroll,Hyderabad,1100000.0
BizReach,Hyderabad,1098034.0
Industryarc,Hyderabad,1094666.0
Legato Health Technologies,Hyderabad,1082148.5
AlgonoX Technologies,Hyderabad,1074883.0
Klaxon India Private Limited,Hyderabad,1074883.0
Quantium,Hyderabad,1072842.0
Broadridge,Hyderabad,1061463.0
XYZ Innovations,Hyderabad,1049129.0
PayPal,Hyderabad,1035971.0
Bullhorn,Hyderabad,1030115.0
Ravindra Kala Vidyalaya,Hyderabad,1027381.0

2025-02-10 11:47:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:47:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:47:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:47:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:47:23 - snowflake.connector.connection - INFO - closed
2025-02-10 11:47:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:47:23 - root - INFO - SQL:
SELECT "Location", "CompanyName", AVG(CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT)) AS "AverageSalaryInCity"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
    GROUP BY "Location", "CompanyName"
    ORDER BY "Location", "AverageSalaryInCity" DESC
    LIMIT 100;
Results:
Location,CompanyName,AverageSalaryInCity
Hyderabad,Qwerty Concepts,5081882.0
Hyderabad,SetuServ,4949704.0
Hyderabad,XYZ (Turkey),3000000.0
Hyderabad,ABCDEF,2745265.5
Hyderabad,MarketLinc,2658491.0
Hyderabad,Hitachi,2611178.0
Hyderabad,Procter & Gamble,2576614.0
Hyderabad,CognitiveScale,2511982.0
Hyderabad,SmartCow,2500000.0
Hyderabad,Compass,2269647.0
Hyderabad,mroads,2239989.0
Hyderabad,Hitachi Consulting,2063316.0
Hyderabad,Blue Yonder,2020386.0
Hyderabad,Gainsight,2000000.0
Hyderabad,Claim Genius,1944821.0
Hyderabad,Fanatics,1917053.0
Hyderabad,ICS Consultancy,1881045.0
Hyderabad,Meeami Technologies,1864748.0
Hyderabad,Toppr.com,1857397.0
Hyderabad,MTX Group,1813738.5
Hyderabad,Cognizant,1800000.0
Hyderabad,Zenoti,1792230.0
Hyderabad,MetLife,1760000.0
Hyderabad,FactSet,1746411.0
Hyderabad,ValueLabs,1744360.6666666667
Hyderabad,Bharat Heavy Electricals,1668775.0
Hyderabad,Brane Enterprises (nslhub),1665911.0
Hyderabad,Honeywell,1653407.0
Hyderabad,Optum Global Solutions India,1628949.0
Hyderabad,Neudesic,1611735.0
Hyderabad,CreditVidya,1581030.0
Hyderabad,Altimetrik,1572363.0
Hyderabad,Landmark IT Solutions,1562895.0
Hyderabad,Anonymous,1527142.0
Hyderabad,Franklin Templeton Investments,1514658.0
Hyderabad,Qualcomm Technologies,1513463.0
Hyderabad,Byteridge Software,1500000.0
Hyderabad,App Orchid,1492959.0
Hyderabad,National Payments Corporation of India,1492543.0
Hyderabad,Activa (CA),1490685.0
Hyderabad,Apple,1472350.0
Hyderabad,Snap2Insight,1452000.0
Hyderabad,Microsoft,1424931.2
Hyderabad,Aeries Technology,1410268.0
Hyderabad,Myntra,1394897.0
Hyderabad,Ivy,1370025.5
Hyderabad,American Express,1362714.0
Hyderabad,Qualcomm,1362714.0
Hyderabad,Evoke Technologies,1355831.0
Hyderabad,Globex Digital Solutions,1343603.0
Hyderabad,Bharat Financial Inclusion,1309535.0
Hyderabad,Bank of America,1285125.0
Hyderabad,DXC Technology,1284729.5
Hyderabad,WinWire Technologies,1269639.0
Hyderabad,DuPont,1265383.5
Hyderabad,Zen3 Info Solutions,1262347.3333333333
Hyderabad,Jaffar Engineering Works,1262223.0
Hyderabad,ProArch,1251537.0
Hyderabad,TTEC,1251502.0
Hyderabad,Uber,1247607.5
Hyderabad,Tiger Analytics,1221751.5
Hyderabad,Applied Information Sciences,1221714.0
Hyderabad,Arcadis,1221714.0
Hyderabad,ICICI Bank,1215690.5
Hyderabad,PepsiCo,1210770.0
Hyderabad,E-rachit Technologies,1210770.0
Hyderabad,Optum,1206212.3333333333
Hyderabad,College Board,1205860.0
Hyderabad,PwC,1200000.0
Hyderabad,Guidewire,1200000.0
Hyderabad,Netflix,1200000.0
Hyderabad,CoreCompete,1191367.0
Hyderabad,Ola,1182371.0
Hyderabad,Oracle,1180565.5
Hyderabad,Google,1166513.6666666667
Hyderabad,State Bank of India,1159476.0
Hyderabad,Deloitte,1154386.2
Hyderabad,Enquero,1148838.0
Hyderabad,UnitedHealth Group,1144968.0
Hyderabad,Astegic,1134824.0
Hyderabad,CDK Global,1123734.0
Hyderabad,Amnet Digital,1119904.0
Hyderabad,EPAM,1115191.0
Hyderabad,Verizon,1109216.0
Hyderabad,Dun & Bradstreet,1108068.0
Hyderabad,Salesforce,1107300.5
Hyderabad,HSBC Software Development India,1104068.3333333333
Hyderabad,Gaian Solutions India,1100233.0
Hyderabad,Kroll,1100000.0
Hyderabad,BizReach,1098034.0
Hyderabad,Industryarc,1094666.0
Hyderabad,Legato Health Technologies,1082148.5
Hyderabad,Klaxon India Private Limited,1074883.0
Hyderabad,AlgonoX Technologies,1074883.0
Hyderabad,Quantium,1072842.0
Hyderabad,Broadridge,1061463.0
Hyderabad,XYZ Innovations,1049129.0
Hyderabad,PayPal,1035971.0
Hyderabad,Bullhorn,1030115.0
Hyderabad,Ravindra Kala Vidyalaya,1027381.0

2025-02-10 11:47:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:47:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:47:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:47:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:47:24 - snowflake.connector.connection - INFO - closed
2025-02-10 11:47:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:47:25 - root - INFO - SQL:
SELECT "CompanyName", AVG(CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT)) AS "AverageSalaryNationwide"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    GROUP BY "CompanyName"
    ORDER BY "AverageSalaryNationwide" DESC
    LIMIT 100;
Results:
CompanyName,AverageSalaryNationwide
Artis signature,7524456.0
CAPA - Centre for Aviation,5995002.0
BITS Pilani,5742016.0
Atos,5273205.0
Volkswagen,5184922.0
Qwerty Concepts,5081882.0
RAKESH GROUP,5016304.0
The City Bank,5000000.0
SetuServ,4949704.0
qplum,4885471.0
Snap,4498962.0
DasDas,4466071.0
ABC Consultants,4282144.0
Société Générale,4099921.0
Two Roads Tech,3812913.0
Instamojo,3808049.0
Rplus Analytics,3808049.0
Super Highway Labs,3665141.0
Zee Entertainment Enterprises Ltd.,3531413.0
Alfonso & Associates Consulting,3530641.0
Amphisoft Technologies,3517133.0
QiO Technologies,3517133.0
Pratilipi,3447524.0
Kiwi labs,3411087.0
Daimler,3387921.0
Freelance,3250773.0
Google Cloud,3211608.0
Automation Anywhere,3200000.0
Hypersonix (CA),3146934.0
Dacasa Financeira,3132009.0
Seernet Technologies,3123584.0
Fellowship.AI,3115175.0
Endurance International Group,3108546.0
MoneyTap,3097936.0
Microland,3070054.0
Rahul Industries,3037137.5
Priyanshu Plastic,3026926.0
CRED,3014686.0
Seventh Contact Hiring Solutions,3008206.0
i4u Labs,2992992.0
Agara Labs,2954147.0
Freshworks,2939735.5
Zoom Video Communications,2839076.0
R.S. Consultants,2816193.0
Cvedia,2794695.0
Bright Money,2739727.0
Boston Scientific,2707106.0
Standard Chartered Global Business Services,2682633.0
Equinor,2676340.0
MarketLinc,2658491.0
ConcertAI,2647046.0
DreamOrbit Softech,2612697.0
Hitachi,2611178.0
OLX Group,2606510.0
Bizongo,2597406.0
Sabre,2581613.0
Aligned Automation,2579455.0
Interactions,2579145.0
Naukri.com,2576614.0
Juniper Networks,2561949.0
Intuit,2560448.5
Savit Interactive,2558957.0
PhonePe,2550000.0
Colors Software,2545237.0
Priceline.com,2540253.0
Numerify,2530666.0
CognitiveScale,2511982.0
Nuartin Labs,2508152.0
Aegon,2508152.0
SmartCow,2500000.0
Locus,2472920.0
Incubit,2452654.0
None of Your Business Boutique,2452654.0
Avaamo,2452646.0
Acalvio,2442736.0
KhataBook,2433547.0
Wabtec,2420967.0
VINAYA KUMAR,2414668.5
Thoughtworks,2402800.5
ICE Mortgage Technology Senior,2400000.0
Zopper,2360899.0
Credit Saison India,2332149.0
Birdeye,2311305.0
FogHorn Systems,2300000.0
ShareChat,2300000.0
Compass,2269647.0
Smith & Nephew,2266502.0
Boeing,2266312.0
Connaizen Software,2265784.0
Meta,2258845.5
mroads,2239989.0
Sama Technology,2210744.0
Atlassian,2200000.0
redBus India,2194861.0
VMware,2189676.5
Lymbyc,2149765.0
XPO Logistics,2148867.0
Peak,2148775.0
Procter & Gamble,2144970.0
Fractal Systems,2141072.0

2025-02-10 11:47:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:47:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:47:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:47:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:47:25 - snowflake.connector.connection - INFO - closed
2025-02-10 11:47:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:47:26 - root - INFO - SQL:
SELECT "CompanyName", COUNT(*) AS "RecordCount"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    GROUP BY "CompanyName"
    ORDER BY "RecordCount" DESC
    LIMIT 100;
Results:
CompanyName,RecordCount
Tata Consultancy Services,41
Amazon,32
Accenture,30
Google,27
IBM,26
Fresher,26
First Student,25
Infosys,23
Cognizant Technology Solutions,21
DONE by NONE,21
ABC,20
Wipro,17
Microsoft,17
Capgemini,17
Deloitte,16
Tech Mahindra,16
LTI,16
Nones,15
Fractal,14
Quantiphi,14
Wipro Technologies,14
HCL Technologies,14
Genpact,13
Optum,12
Freelancer,11
PwC,10
ZS Associates,10
Honeywell,10
DXC Technology,10
NTT DATA,9
Jio,9
Dell Technologies,9
KPMG,9
XYZ,9
Virtusa,9
American Express,9
TCS,9
EY,9
Reliance Industries,9
ICICI Bank,9
Anonymous,9
Mu Sigma,9
Optum Global Solutions,8
Innodatatics,8
J.P. Morgan,8
Axis Bank,8
Adobe,8
UnitedHealth Group,8
Mindtree,8
Oracle,8
Atos-Syntel,8
Tata Consultancy Services (North America),8
EMPLOYERS,8
WNS,8
Siemens,7
Barclays,7
Tiger Analytics,7
Maxgen Technologies,7
MAERSK,7
Flipkart,7
Course5 Intelligence,7
Citi,7
OYO,7
iNeuron,7
HSBC,7
Novartis,7
Ugam,7
Persistent Systems,7
TEKsystems,7
Bajaj Finance,7
Publicis Sapient,7
Schlumberger,7
Mahindra,6
SG Analytics,6
Mercedes-Benz Research and Development India,6
Red Hat,6
Techolution,6
GE,6
EXL Service,6
Fresherworld.com,6
Tableau Software,6
ThinkBumblebee Analytics,6
Wells Fargo,6
Freshers.com,6
Mastercard,6
Abzooba,6
Kantar,6
Enquero,6
Datametica,6
ITC Infotech,6
Piramal Enterprises,6
SAP,6
Credit Suisse,6
Anonymous Content,6
Cisco Systems,6
Cyient,6
Ericsson-Worldwide,5
Nielsen,5
Fidelity Investments,5
Verizon,5

2025-02-10 11:47:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:47:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:47:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:47:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 26
2025-02-10 11:47:27 - snowflake.connector.connection - INFO - closed
2025-02-10 11:47:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:47:27 - root - INFO - SQL:
SELECT DISTINCT "JobTitle"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    LIMIT 100;
Results:
JobTitle
Data Scientist
Data Science Associate
Data Science Consultant
Data Science
Senior Data Scientist
Junior Data Scientist
Lead Data Scientist
Data Science Manager
Data Scientist - Trainee
Data Analyst
Data Engineer
Machine Learning Engineer
Machine Learning Software Engineer
Software Engineer - Machine Learning
Machine Learning Engineer/Data Scientist
Machine Learning Consultant
Machine Learning Data Associate
Machine Learning Data Associate I
Machine Learning Data Analyst
Machine Learning Scientist
Machine Learning Developer
Data Science Lead
Machine Learning Associate
Machine Learning Data Associate II
Associate Machine Learning Engineer
Senior Machine Learning Engineer

2025-02-10 11:47:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:47:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:47:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:47:28 - snowflake.connector.connection - INFO - closed
2025-02-10 11:47:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:47:46 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 11:47:46 - root - INFO - The error you're encountering is due to the use of the `~` operator in your SQL query. In Snowflake SQL, the `~` operator is not used for regular expression matching. Instead, you should use the `RLIKE` operator or the `REGEXP_LIKE` function for regular expression comparisons.

**Explanation:**

- **`~` Operator**: In some SQL dialects like PostgreSQL, the `~` operator is used for regular expression matching. However, Snowflake SQL does not support this operator.
- **Snowflake SQL Regex Matching**: In Snowflake, you should use `RLIKE` (an alias for `REGEXP`) or the `REGEXP_LIKE` function to perform regular expression comparisons.

**Corrected SQL Query:**

To fix the error, replace the `~` operator with `RLIKE` in your `WHERE` clause:

```sql
SELECT "Salary"
FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
WHERE "Salary" RLIKE '[^0-9.]'
LIMIT 100;
```

**Alternate Using `REGEXP_LIKE` Function:**

Alternatively, you can use the `REGEXP_LIKE` function, which takes the column and the pattern as arguments:

```sql
SELECT "Salary"
FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
WHERE REGEXP_LIKE("Salary", '[^0-9.]')
LIMIT 100;
```

**What This Query Does:**

- **`"Salary" RLIKE '[^0-9.]'`**: This condition checks each `Salary` value for any character that is not a digit (`0-9`) or a dot (`.`). If such a character is found, the condition evaluates to `TRUE`.
- **Result**: The query retrieves all `Salary` values that contain non-numeric characters other than the dot, which may include currency symbols, commas, or text like `/yr` and `/mo`.

**Next Steps:**

- **Data Cleaning**: After identifying these records, you might want to clean the `Salary` values by removing non-numeric characters (as you have done previously) and converting them to a numeric data type for calculations.
- **Ensure Consistent Formats**: Verify that all `Salary` entries are in a consistent format to prevent issues during data processing and analysis.

**Example Usage:**

To see how many `Salary` entries contain non-numeric characters (excluding the dot), you could run:

```sql
SELECT COUNT(*)
FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
WHERE "Salary" RLIKE '[^0-9.]';
```

**Remember:**

- Always ensure you're using the correct syntax and operators specific to the SQL dialect of your database system.
- Refer to the [Snowflake Documentation on Pattern Matching](https://docs.snowflake.com/en/sql-reference/functions/regexp.html) for more details on regular expressions in Snowflake SQL.
2025-02-10 11:47:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:47:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:47:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:47:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-10 11:47:47 - snowflake.connector.connection - INFO - closed
2025-02-10 11:47:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:48:23 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 11:48:23 - root - INFO - ```sql
SELECT "Salary"
FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
WHERE REGEXP_LIKE("Salary", '[A-Za-z]')
LIMIT 100;
```
2025-02-10 11:48:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:48:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:48:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:48:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-10 11:48:24 - snowflake.connector.connection - INFO - closed
2025-02-10 11:48:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:49:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 11:49:32 - root - INFO - ```sql
SELECT "Salary"
FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
WHERE REGEXP_LIKE("Salary", '[^0-9.,]')
LIMIT 100;
```
2025-02-10 11:49:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:49:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:49:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:49:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-02-10 11:49:33 - snowflake.connector.connection - INFO - closed
2025-02-10 11:49:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:49:34 - root - INFO - SQL:
SELECT "Salary"
FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
WHERE REGEXP_LIKE("Salary", '[^0-9.,]')
LIMIT 100;
Results:
No data found for the specified query.

2025-02-10 11:49:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:49:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:49:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:49:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:49:35 - snowflake.connector.connection - INFO - closed
2025-02-10 11:49:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:49:35 - root - INFO - SQL:
SELECT "CompanyName", MAX(CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT)) AS "MaxSalary"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    WHERE "Location" = 'New Delhi'
    GROUP BY "CompanyName"
    ORDER BY "MaxSalary" DESC
    LIMIT 100;
Results:
CompanyName,MaxSalary
Wipro Technologies,5092618.0
Super Highway Labs,3665141.0
OLX Group,3644181.0
Zomato,3162981.0
NatWest Group,3141490.0
ABC,3082142.0
Nones,3026926.0
Greenlight Planet,2876666.0
Boston Scientific,2707106.0
DreamOrbit Softech,2612697.0
Naukri.com,2576614.0
Info Edge,2531779.0
Thoughtworks,2522438.0
Hike,2518336.0
Boston Consulting Group,2504513.0
Publicis Sapient,2500000.0
None of Your Business Boutique,2452654.0
Incubit,2452654.0
Mastercard,2372152.0
Birdeye,2311305.0
Connaizen Software,2265784.0
BYJU'S,2219746.0
Sama Technology,2210744.0
Amazon,2063316.0
Samsung Electronics,2063316.0
Sigma HR Solutions,2042277.0
Inshorts,2032753.0
Barclays,2014668.0
Orange Senior,2000000.0
Dell Technologies,2000000.0
Gartner,1929406.0
American Express,1919822.0
R Systems,1887245.0
McKinsey Knowledge Center,1881607.0
Times Internet,1849285.0
McKinsey & Company,1820394.0
Sprinklr,1804941.0
Paytm,1800000.0
Quantiphi Senior,1748000.0
CitiusTech,1726279.0
SAP,1712468.0
Bharat Heavy Electricals,1704749.0
TEKsystems,1643809.0
Gauge Data Solutions,1640740.0
Samsung R&D Institute India - Noida,1640000.0
Xebia,1634470.0
Bharti Airtel,1628952.0
HARMAN,1628952.0
Coforge,1600000.0
Urban Company,1589903.0
Netomi,1556582.0
Rackspace Technology,1547487.0
Goals101,1541071.0
Guavus,1531036.0
Ericsson IT Solutions & Services,1527142.0
Analytics Vidhya,1513955.0
Adobe,1511412.0
Bank of America,1507325.0
VMock,1507325.0
Honeywell,1500000.0
SRI Delhi,1500000.0
Dew Solutions,1489702.0
Beam Suntory,1478425.0
Coforge Senior,1476259.0
Zoho,1468099.0
Fractal,1463014.0
Nagarro,1460635.0
Optum Global Solutions,1455101.0
OYO,1451573.0
MakeMyTrip,1431111.0
Delhivery,1412565.0
Housing.com,1403697.0
Maven Wave Partners,1377267.0
Pitney Bowes,1364816.0
Tokopedia,1364409.0
CarDekho,1352722.0
Atlan,1331269.0
Fiserv,1324095.0
NTT DATA,1323523.0
dunnhumby,1320578.0
ZS Associates,1294964.0
SirionLabs,1289859.0
LinkedIn,1288344.0
Optum,1276202.0
Deloitte,1275546.0
Freelancer,1271011.0
naidu,1257890.0
Google,1251537.0
Musixspace,1244206.0
EXL Service,1242238.0
Bäckerei-Conditorei Fleischli,1242238.0
PeopleStrong Technologies,1240055.0
Innovaccer,1239994.0
McKinney and Company,1239375.0
NimbusHire,1236115.0
UnitedHealth Group,1235654.0
S&P Global,1230555.0
Snapdeal,1230555.0
J.P. Morgan,1221714.0
Unified Healthcare Group,1221714.0

2025-02-10 11:49:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:49:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:49:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:49:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 8
2025-02-10 11:49:36 - snowflake.connector.connection - INFO - closed
2025-02-10 11:49:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:49:37 - root - INFO - SQL:
SELECT "JobTitle", AVG(CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT)) AS "AverageSalary"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    WHERE "Location" = 'Mumbai'
    GROUP BY "JobTitle"
    ORDER BY "AverageSalary" DESC
    LIMIT 100;
Results:
JobTitle,AverageSalary
Software Engineer - Machine Learning,1612324.0
Senior Machine Learning Engineer,1280700.8333333333
Data Scientist,941085.4256410256
Data Engineer,782077.874015748
Machine Learning Developer,581119.0
Machine Learning Engineer,512746.76136363635
Data Analyst,379906.36734693876
Machine Learning Scientist,14176.5

2025-02-10 11:49:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:49:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:49:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:49:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 25
2025-02-10 11:49:38 - snowflake.connector.connection - INFO - closed
2025-02-10 11:49:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:49:38 - root - INFO - SQL:
SELECT "CompanyName", COUNT(*) AS "SalariesReported"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    GROUP BY "CompanyName"
    HAVING COUNT(*) > 10
    ORDER BY "SalariesReported" DESC
    LIMIT 100;
Results:
CompanyName,SalariesReported
Tata Consultancy Services,41
Amazon,32
Accenture,30
Google,27
IBM,26
Fresher,26
First Student,25
Infosys,23
DONE by NONE,21
Cognizant Technology Solutions,21
ABC,20
Microsoft,17
Capgemini,17
Wipro,17
LTI,16
Tech Mahindra,16
Deloitte,16
Nones,15
Fractal,14
Wipro Technologies,14
HCL Technologies,14
Quantiphi,14
Genpact,13
Optum,12
Freelancer,11

2025-02-10 11:49:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:49:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:49:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:49:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-02-10 11:49:39 - snowflake.connector.connection - INFO - closed
2025-02-10 11:49:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:49:39 - root - INFO - SQL:
SELECT AVG(CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT)) AS "NationalAverageSalary"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    LIMIT 100;
Results:
NationalAverageSalary
767988.770718232

2025-02-10 11:49:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:49:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:49:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:49:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-02-10 11:49:40 - snowflake.connector.connection - INFO - closed
2025-02-10 11:49:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:49:41 - root - INFO - SQL:
SELECT "Location", AVG(CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT)) AS "AverageSalaryByLocation"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    GROUP BY "Location"
    ORDER BY "AverageSalaryByLocation" DESC
    LIMIT 100;
Results:
Location,AverageSalaryByLocation
Bangalore,892445.7626262626
Pune,736137.4058679707
New Delhi,692217.7637195121
Hyderabad,677650.0
Mumbai,669215.6094003242

2025-02-10 11:49:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:49:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:49:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:49:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-02-10 11:49:42 - snowflake.connector.connection - INFO - closed
2025-02-10 11:49:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:49:42 - root - INFO - SQL:
SELECT "CompanyName", COUNT(DISTINCT "Location") AS "LocationCount"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    GROUP BY "CompanyName"
    HAVING COUNT(DISTINCT "Location") > 1
    ORDER BY "LocationCount" DESC
    LIMIT 100;
Results:
CompanyName,LocationCount
Capgemini,5
Fresherworld.com,5
EMPLOYERS,5
Deloitte,5
Cognizant Technology Solutions,5
WNS,5
Nones,5
Tech Mahindra,5
Amazon,5
DXC Technology,5
ABC,5
BYJU'S,5
First Student,5
Google,5
Anonymous,5
IBM,5
HCL Technologies,5
LTI,5
Microsoft,5
DONE by NONE,5
Infosys,5
Fresher,5
Tata Consultancy Services (North America),5
Wipro,5
Accenture,5
Tata Consultancy Services,5
Wipro Technologies,4
The Sparks Foundation,4
Optum,4
Atos-Syntel,4
Tiger Analytics,4
Self Opportunity,4
Genpact,4
Fractal,4
ITC Infotech,4
Honeywell,4
Great Learning,4
Jio,4
Larsen & Toubro,4
Freshers.com,4
ICICI Bank,4
TEKsystems,4
Tableau Software,4
Dell Technologies,4
XYZ,4
J.P. Morgan,4
Kantar,4
NTT DATA,4
Siemens,4
PwC,4
Mu Sigma,4
Yes Bank,4
KPMG,4
Freelancer,4
Reliance Industries,4
Citi,4
Tech Data,4
Flipkart,3
XYZ (Turkey),3
Mahindra,3
Verizon,3
Wipro Digital,3
Unacademy,3
Nielsen,3
Oracle,3
Mindtree,3
CSS Corporation,3
MakeMyTrip,3
Anonymous Content,3
TCS,3
Cyient,3
Apple,3
MAERSK,3
Bajaj Finance,3
Bharti Airtel,3
UnitedHealth Group,3
Dun & Bradstreet,3
Thoughtworks,3
HCL,3
Intellect Design Arena,3
iNeuron,3
IQVIA,3
Ericsson IT Solutions & Services,3
Mphasis,3
upGrad,3
ABCDEF,3
Synechron,3
Credit Suisse,3
ZS Associates,3
Diverse Lynx,3
Quess,3
Innodatatics,3
Virtusa,3
DataScientest,3
Axis Bank,3
American Express,3
Attra,3
Ugam,3
HSBC,3
Fiserv,3

2025-02-10 11:49:42 - root - INFO - itercount: 0
2025-02-10 11:49:42 - root - INFO - Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,0
table_name,WEB_ORDERS
description,
DDL,"create or replace TABLE WEB_ORDERS (
	""id"" NUMBER(38,0),
	""account_id"" NUMBER(38,0),
	""occurred_at"" VARCHAR(16777216),
	""standard_qty"" NUMBER(38,0),
	""gloss_qty"" NUMBER(38,0),
	""poster_qty"" NUMBER(38,0),
	""total"" NUMBER(38,0),
	""standard_amt_usd"" FLOAT,
	""gloss_amt_usd"" FLOAT,
	""poster_amt_usd"" FLOAT,
	""total_amt_usd"" FLOAT
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,1
table_name,HARDWARE_FACT_MANUFACTURING_COST
description,
DDL,"create or replace TABLE HARDWARE_FACT_MANUFACTURING_COST (
	""product_code"" VARCHAR(16777216),
	""cost_year"" NUMBER(38,0),
	""manufacturing_cost"" FLOAT
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,2
table_name,SALARYDATASET
description,
DDL,"create or replace TABLE SALARYDATASET (
	""index"" NUMBER(38,0),
	""CompanyName"" VARCHAR(16777216),
	""JobTitle"" VARCHAR(16777216),
	""SalariesReported"" FLOAT,
	""Location"" VARCHAR(16777216),
	""Salary"" VARCHAR(16777216)
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,3
table_name,WEB_SALES_REPS
description,
DDL,"create or replace TABLE WEB_SALES_REPS (
	""id"" NUMBER(38,0),
	""name"" VARCHAR(16777216),
	""region_id"" NUMBER(38,0)
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,4
table_name,HARDWARE_DIM_PRODUCT
description,
DDL,"create or replace TABLE HARDWARE_DIM_PRODUCT (
	""product_code"" VARCHAR(16777216),
	""division"" VARCHAR(16777216),
	""segment"" VARCHAR(16777216),
	""category"" VARCHAR(16777216),
	""product"" VARCHAR(16777216),
	""variant"" VARCHAR(16777216)
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,5
table_name,HARDWARE_FACT_GROSS_PRICE
description,
DDL,"create or replace TABLE HARDWARE_FACT_GROSS_PRICE (
	""product_code"" VARCHAR(16777216),
	""fiscal_year"" NUMBER(38,0),
	""gross_price"" FLOAT
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,6
table_name,HARDWARE_FACT_SALES_MONTHLY
description,
DDL,"create or replace TABLE HARDWARE_FACT_SALES_MONTHLY (
	""date"" VARCHAR(16777216),
	""product_code"" VARCHAR(16777216),
	""customer_code"" NUMBER(38,0),
	""sold_quantity"" NUMBER(38,0),
	""fiscal_year"" NUMBER(38,0)
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,7
table_name,UNIVERSITY_FACULTY
description,
DDL,"create or replace TABLE UNIVERSITY_FACULTY (
	""FacNo"" NUMBER(38,0),
	""FacFirstName"" VARCHAR(16777216),
	""FacLastName"" VARCHAR(16777216),
	""FacCity"" VARCHAR(16777216),
	""FacState"" VARCHAR(16777216),
	""FacDept"" VARCHAR(16777216),
	""FacRank"" VARCHAR(16777216),
	""FacSalary"" NUMBER(38,0),
	""FacSupervisor"" FLOAT,
	""FacHireDate"" VARCHAR(16777216),
	""FacZipCode"" VARCHAR(16777216)
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,8
table_name,WEB_EVENTS
description,
DDL,"create or replace TABLE WEB_EVENTS (
	""id"" NUMBER(38,0),
	""account_id"" NUMBER(38,0),
	""occurred_at"" VARCHAR(16777216),
	""channel"" VARCHAR(16777216)
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,9
table_name,HARDWARE_DIM_CUSTOMER
description,
DDL,"create or replace TABLE HARDWARE_DIM_CUSTOMER (
	""customer_code"" NUMBER(38,0),
	""customer"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216),
	""channel"" VARCHAR(16777216),
	""market"" VARCHAR(16777216),
	""sub_zone"" VARCHAR(16777216),
	""region"" VARCHAR(16777216)
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,10
table_name,STAFFHOURS
description,
DDL,"create or replace TABLE STAFFHOURS (
	""StaffMember"" VARCHAR(16777216),
	""EventDate"" VARCHAR(16777216),
	""EventTime"" VARCHAR(16777216),
	""EventType"" VARCHAR(16777216)
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,11
table_name,UNIVERSITY_COURSE
description,
DDL,"create or replace TABLE UNIVERSITY_COURSE (
	""CourseNo"" VARCHAR(16777216),
	""CrsDesc"" VARCHAR(16777216),
	""CrsUnits"" NUMBER(38,0)
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,12
table_name,UNIVERSITY_ENROLLMENT
description,
DDL,"create or replace TABLE UNIVERSITY_ENROLLMENT (
	""OfferNo"" NUMBER(38,0),
	""StdNo"" NUMBER(38,0),
	""EnrGrade"" FLOAT
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,13
table_name,UNIVERSITY_OFFERING
description,
DDL,"create or replace TABLE UNIVERSITY_OFFERING (
	""OfferNo"" NUMBER(38,0),
	""CourseNo"" VARCHAR(16777216),
	""OffTerm"" VARCHAR(16777216),
	""OffYear"" NUMBER(38,0),
	""OffLocation"" VARCHAR(16777216),
	""OffTime"" VARCHAR(16777216),
	""FacNo"" FLOAT,
	""OffDays"" VARCHAR(16777216)
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,14
table_name,UNIVERSITY_STUDENT
description,
DDL,"create or replace TABLE UNIVERSITY_STUDENT (
	""StdNo"" NUMBER(38,0),
	""StdFirstName"" VARCHAR(16777216),
	""StdLastName"" VARCHAR(16777216),
	""StdCity"" VARCHAR(16777216),
	""StdState"" VARCHAR(16777216),
	""StdZip"" VARCHAR(16777216),
	""StdMajor"" VARCHAR(16777216),
	""StdClass"" VARCHAR(16777216),
	""StdGPA"" FLOAT
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,15
table_name,WEB_ACCOUNTS
description,
DDL,"create or replace TABLE WEB_ACCOUNTS (
	""id"" NUMBER(38,0),
	""name"" VARCHAR(16777216),
	""website"" VARCHAR(16777216),
	""lat"" FLOAT,
	""long"" FLOAT,
	""primary_poc"" VARCHAR(16777216),
	""sales_rep_id"" NUMBER(38,0)
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,16
table_name,WEB_REGION
description,
DDL,"create or replace TABLE WEB_REGION (
	""id"" NUMBER(38,0),
	""name"" VARCHAR(16777216)
);"

Database Name: EDUCATION_BUSINESS
Schema Name: EDUCATION_BUSINESS
,17
table_name,HARDWARE_FACT_PRE_INVOICE_DEDUCTIONS
description,
DDL,"create or replace TABLE HARDWARE_FACT_PRE_INVOICE_DEDUCTIONS (
	""customer_code"" NUMBER(38,0),
	""fiscal_year"" NUMBER(38,0),
	""pre_invoice_discount_pct"" FLOAT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: [table name]}}): 
{'EDUCATION_BUSINESS': {'EDUCATION_BUSINESS': ['WEB_ORDERS', 'HARDWARE_FACT_MANUFACTURING_COST', 'SALARYDATASET', 'WEB_SALES_REPS', 'HARDWARE_DIM_PRODUCT', 'HARDWARE_FACT_GROSS_PRICE', 'HARDWARE_FACT_SALES_MONTHLY', 'UNIVERSITY_FACULTY', 'WEB_EVENTS', 'HARDWARE_DIM_CUSTOMER', 'STAFFHOURS', 'UNIVERSITY_COURSE', 'UNIVERSITY_ENROLLMENT', 'UNIVERSITY_OFFERING', 'UNIVERSITY_STUDENT', 'WEB_ACCOUNTS', 'WEB_REGION', 'HARDWARE_FACT_PRE_INVOICE_DEDUCTIONS']}}
Begin Exploring Related Columns
**Relevant Table and Columns:**

- **Table**: `"SALARYDATASET"` in the schema `"EDUCATION_BUSINESS"` of database `"EDUCATION_BUSINESS"`.
  
- **Columns and Potential Usage**:
  - `"CompanyName"`: Used to group salaries by company.
  - `"Location"`: Used to filter data for the specified cities (Mumbai, Pune, New Delhi, Hyderabad).
  - `"Salary"`: Contains salary values that need to be cleaned (removing non-numeric characters) and converted to numeric type for calculations.
  - `"JobTitle"`: May provide additional context but not directly used in calculations.
  - `"SalariesReported"`: Number of reported salaries; could be used to weigh average salaries or assess data reliability.

- **Conditions That May Be Used**:
  - Filtering `"Location"` to include only the specified cities: `'Mumbai'`, `'Pune'`, `'New Delhi'`, and `'Hyderabad'`.
  - Cleaning the `"Salary"` column using `REGEXP_REPLACE` to remove non-numeric characters.
  - Converting the cleaned `"Salary"` values to a numeric data type using `CAST` or `TO_NUMBER` for calculations.
  - Grouping data by `"CompanyName"` and `"Location"` to compute average salaries.
  - Limiting results to the top 5 companies per city based on average salary.

---

**SQL Queries to Explore the Data:**

1. **Retrieve Distinct Locations in the Dataset**

   ```sql
   SELECT DISTINCT "Location"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   LIMIT 100;
   ```

2. **View Salary Data for Companies in Mumbai**

   ```sql
   SELECT "CompanyName", "Salary"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   WHERE "Location" = 'Mumbai'
   LIMIT 100;
   ```

3. **Fetch Company Names and Salaries in Specified Cities**

   ```sql
   SELECT "CompanyName", "Salary", "Location"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
   LIMIT 100;
   ```

4. **Inspect Raw Salary Values Before Cleaning**

   ```sql
   SELECT "Salary"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   LIMIT 100;
   ```

5. **Clean Salary Values by Removing Non-Numeric Characters**

   ```sql
   SELECT "Salary", REGEXP_REPLACE("Salary", '[^0-9.]', '') AS "CleanedSalary"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   LIMIT 100;
   ```

6. **View Cleaned Salary Values for Companies in Hyderabad**

   ```sql
   SELECT "CompanyName", REGEXP_REPLACE("Salary", '[^0-9.]', '') AS "CleanedSalary"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   WHERE "Location" = 'Hyderabad'
   LIMIT 100;
   ```

7. **Convert Cleaned Salary Values to Numeric Type for Pune**

   ```sql
   SELECT "CompanyName", CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT) AS "SalaryNumeric"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   WHERE "Location" = 'Pune'
   LIMIT 100;
   ```

8. **Calculate Average Salary per Company Nationwide**

   ```sql
   SELECT "CompanyName", AVG(CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT)) AS "AverageSalary"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   GROUP BY "CompanyName"
   ORDER BY "AverageSalary" DESC
   LIMIT 100;
   ```

9. **Compute Average Salary per Company in Specified Cities**

   ```sql
   SELECT "CompanyName", "Location", AVG(CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT)) AS "AverageSalary"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
   GROUP BY "CompanyName", "Location"
   ORDER BY "Location", "AverageSalary" DESC
   LIMIT 100;
   ```

10. **List Top Companies by Average Salary in Each City**

    ```sql
    SELECT "Location", "CompanyName", AVG(CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT)) AS "AverageSalaryInCity"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
    GROUP BY "Location", "CompanyName"
    ORDER BY "Location", "AverageSalaryInCity" DESC
    LIMIT 100;
    ```

11. **Calculate National Average Salary per Company**

    ```sql
    SELECT "CompanyName", AVG(CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT)) AS "AverageSalaryNationwide"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    GROUP BY "CompanyName"
    ORDER BY "AverageSalaryNationwide" DESC
    LIMIT 100;
    ```

12. **Count Number of Salary Records per Company**

    ```sql
    SELECT "CompanyName", COUNT(*) AS "RecordCount"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    GROUP BY "CompanyName"
    ORDER BY "RecordCount" DESC
    LIMIT 100;
    ```

13. **List Unique Job Titles in the Dataset**

    ```sql
    SELECT DISTINCT "JobTitle"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    LIMIT 100;
    ```

14. **Inspect Records with Non-Numeric Characters in Salary**

    ```sql
    SELECT "Salary"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    WHERE "Salary" ~ '[^0-9.]'
    LIMIT 100;
    ```

15. **Find Maximum Salary per Company in New Delhi**

    ```sql
    SELECT "CompanyName", MAX(CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT)) AS "MaxSalary"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    WHERE "Location" = 'New Delhi'
    GROUP BY "CompanyName"
    ORDER BY "MaxSalary" DESC
    LIMIT 100;
    ```

16. **Compute Average Salary by Job Title in Mumbai**

    ```sql
    SELECT "JobTitle", AVG(CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT)) AS "AverageSalary"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    WHERE "Location" = 'Mumbai'
    GROUP BY "JobTitle"
    ORDER BY "AverageSalary" DESC
    LIMIT 100;
    ```

17. **Retrieve Companies with Salaries Reported More Than 10 Times**

    ```sql
    SELECT "CompanyName", COUNT(*) AS "SalariesReported"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    GROUP BY "CompanyName"
    HAVING COUNT(*) > 10
    ORDER BY "SalariesReported" DESC
    LIMIT 100;
    ```

18. **Aggregate National Average Salary**

    ```sql
    SELECT AVG(CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT)) AS "NationalAverageSalary"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    LIMIT 100;
    ```

19. **Determine Average Salary per Location**

    ```sql
    SELECT "Location", AVG(CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT)) AS "AverageSalaryByLocation"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    GROUP BY "Location"
    ORDER BY "AverageSalaryByLocation" DESC
    LIMIT 100;
    ```

20. **Identify Companies Present in Multiple Locations**

    ```sql
    SELECT "CompanyName", COUNT(DISTINCT "Location") AS "LocationCount"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    GROUP BY "CompanyName"
    HAVING COUNT(DISTINCT "Location") > 1
    ORDER BY "LocationCount" DESC
    LIMIT 100;
    ```

---

These queries collectively help in understanding the dataset, cleaning the necessary fields, and computing the required aggregates to eventually write the detailed SQL query as per the task requirements. They explore different facets of the data, such as distinct locations, salary cleaning, average calculations, grouping, and ordering, which are essential steps in data preparation and analysis.Query:
SELECT DISTINCT "Location"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   LIMIT 100;
Answer:
Location
Bangalore
Pune
Hyderabad
New Delhi
Mumbai
Query:
SELECT "CompanyName", "Salary"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   WHERE "Location" = 'Mumbai'
   LIMIT 100;
Answer:
CompanyName,Salary
Fractal,"₹16,43,351/yr"
Tata Consultancy Services,"₹5,66,756/yr"
Accenture,"₹9,00,000/yr"
Capgemini,"₹10,55,889/yr"
Jio,"₹10,37,441/yr"
Reliance Industries,"₹17,73,222/yr"
Housing.com,"₹23,83,368/yr"
Quantiphi,"₹9,19,025/yr"
Axis Bank,"₹11,93,674/yr"
LTI,"₹6,44,930/yr"
HDFC Bank,"₹10,70,583/yr"
Vodafone Idea,"₹20,09,767/yr"
CASHe,"₹10,98,034/yr"
Infosys,"₹11,02,095/yr"
Cognizant Technology Solutions,"₹8,30,959/yr"
Deloitte,"₹11,91,942/yr"
First Student,"₹12,10,857/yr"
CitiusTech,"₹2,94,111/yr"
RBL Bank,"₹11,80,704/yr"
ZEE5,"₹14,58,789/yr"
Mahindra Integrated Business Solutions,"₹9,74,832/yr"
DataScientest,"₹45,684/mo"
Pentation Analytics,"₹6,50,654/yr"
NDS InfoServ,"₹9,26,744/yr"
Arya.ai,"₹8,38,354/yr"
Wipro,"₹30,368/mo"
Amazon,"₹10,18,095/yr"
IBM,"₹11,93,120/yr"
PwC,"₹14,49,831/yr"
Google,"₹13,55,169/yr"
Atos-Syntel,"₹8,75,733/yr"
Siemens,"₹12,57,890/yr"
Mahindra,"₹10,22,850/yr"
eClerx,"₹7,33,769/yr"
HERE Technologies,"₹17,82,011/yr"
HDFC Standard Life Insurance,"₹12,21,714/yr"
Morningstar,"₹9,57,432/yr"
L&T Financial Services,"₹8,86,778/yr"
Piramal Enterprises,"₹72,216/mo"
Piramal Enterprises,"₹11,60,523/yr"
Episource,"₹8,94,949/yr"
XPO Logistics,"₹15,81,030/yr"
Loylty Rewardz Mngt,"₹12,23,523/yr"
Karza Technologies,"₹17,00,000/yr"
Prudential plc,"₹11,08,264/yr"
Dure Technologies,"₹12,89,859/yr"
Tata Consultancy Services,"₹18,737/mo"
Tech Mahindra,"₹8,85,892/yr"
EY,"₹10,25,737/yr"
Fresher,"₹50,367/mo"
ICICI Bank,"₹49,111/mo"
Microsoft,"₹2,16,685/mo"
ABC,"₹10,36,761/yr"
Kotak Mahindra,"₹66,648/mo"
Freshworks,"₹4,94,353/yr"
NVIDIA,"₹41,87,500/yr"
HERE Technologies,"₹41,940/mo"
Fractal,"₹39,822/mo"
MAERSK,"₹17,17,206/yr"
Tata AIG General Insurance,"₹14,06,673/yr"
General Mills,"₹17,34,062/yr"
Motilal Oswal Securities,"₹6,49,989/yr"
Hdfc,"₹64,952/mo"
Tata Group,"₹9,77,421/yr"
PharmEasy,"₹14,51,194/yr"
Decimal Point Analytics,"₹11,26,055/yr"
People Group,"₹13,14,654/yr"
MiQ,"₹12,40,055/yr"
UPL,"₹9,91,653/yr"
Lead School (India),"₹1,10,833/mo"
LogiNext Solutions,"₹4,65,001/yr"
Bewakoof Brands,"₹7,30,703/yr"
Meru Mobility Tech,"₹9,60,996/yr"
Kissht,"₹56,676/mo"
Radhakrishna Foodland,"₹3,04,060/yr"
Tableau Software,"₹28,65,536/yr"
FlexiLoans Technologies,"₹8,27,693/yr"
Square Panda,"₹6,76,720/yr"
Think Analytics,"₹6,06,168/yr"
Locobuzz,"₹8,35,493/yr"
SMEcorner,"₹40,725/mo"
Quantsapp,"₹18,926/mo"
HDFC Developers,"₹14,94,696/yr"
Javis,"₹20,75,185/yr"
Cuddle,"₹19,61,487/yr"
Arohi Operations,"₹30,834/mo"
Accenture,"₹1,01,809/yr"
IBM,"$2,05,476/yr"
IBM,"₹7,02,485/yr"
HCL Technologies,"₹14,17,138/yr"
Oracle,"₹10,00,000/yr"
BYJU'S,"₹10,00,000/yr"
LTI,"₹6,13,163/yr"
Mindtree,"₹10,31,658/yr"
Microsoft,"₹45,172/mo"
J.P. Morgan,"₹21,86,509/yr"
J.P. Morgan,"₹81,105/mo"
Cisco Systems,"₹10,880/mo"
ABC,"$96,739/yr"
Reliance Industries,"₹9,59,911/yr"
Query:
SELECT "CompanyName", "Salary", "Location"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
   LIMIT 100;
Answer:
CompanyName,Salary,Location
Tata Consultancy Services,"₹7,17,331/yr",Pune
Innoplexus,"₹11,63,186/yr",Pune
IBM,"₹10,36,536/yr",Pune
AlgoAnalytics Financial Consultancy,"₹7,42,883/yr",Pune
ZS Associates,"₹12,94,039/yr",Pune
Wolters Kluwer,"₹11,54,579/yr",Pune
Cognizant Technology Solutions,"₹7,65,632/yr",Pune
Accenture,"₹6,02,937/yr",Pune
Wipro,"₹11,50,000/yr",Pune
Zensar Technologies,"₹8,54,957/yr",Pune
Bajaj Finance,"₹9,56,307/yr",Pune
SG Analytics,"₹8,16,946/yr",Pune
ThinkBumblebee Analytics,"₹10,70,536/yr",Pune
Michelin,"₹11,46,043/yr",Pune
Tech Mahindra,"₹11,14,163/yr",Pune
Schlumberger,"₹20,54,972/yr",Pune
Merkle,"₹11,34,768/yr",Pune
Infosys,"₹8,78,252/yr",Pune
Capgemini,"₹8,98,351/yr",Pune
LTI,"₹8,14,017/yr",Pune
First Student,"₹4,25,000/yr",Pune
Vodafone,"₹9,40,423/yr",Pune
Eaton,"₹11,21,845/yr",Pune
T-Systems,"₹12,15,906/yr",Pune
Coupa Software Inc,"₹10,55,811/yr",Pune
Aera Technology,"₹16,22,612/yr",Pune
ABC,"₹42,249/mo",Pune
Amdocs,"₹7,18,534/yr",Pune
Atos-Syntel,"₹4,23,422/yr",Pune
Barclays,"₹17,33,746/yr",Pune
KPIT Technologies,"₹16,55,120/yr",Pune
Credit Suisse,"₹14,21,672/yr",Pune
Saama Technologies,"₹9,34,857/yr",Pune
Exela Technologies,"₹8,56,429/yr",Pune
Abzooba,"₹18,00,000/yr",Pune
Linsyssoft Technologies,"₹4,11,680/yr",Pune
HCL Technologies,"₹61,248/mo",Pune
Fresher,"₹51,920/mo",Pune
Axis Bank,"₹2,32,796/mo",Pune
Freelancer,"₹10,01,630/yr",Pune
Citi,"₹15,77,759/yr",Pune
ADP,"₹52,491/mo",Pune
Birlasoft,"₹52,16,933/yr",Pune
John Deere,"₹14,63,658/yr",Pune
Xoriant,"₹17,72,001/yr",Pune
GS Lab,"₹8,34,387/yr",Pune
Searce,"₹8,28,221/yr",Pune
Globant,"₹1,00,275/mo",Pune
e-Zest Solutions,"₹9,32,104/yr",Pune
Datametica,"₹9,83,550/yr",Pune
Vyom Labs,"₹25,446/mo",Pune
Vishwakarma Institute of Technology,₹602/hr,Pune
Knorex,"₹53,475/mo",Pune
CanWill Technologies,"₹11,61,602/yr",Pune
ThinkBridge,"₹63,058/mo",Pune
Coditation Systems,"₹46,977/mo",Pune
MindBowser Info Solutions,"₹2,83,914/yr",Pune
Climate Connect,"₹7,31,758/yr",Pune
Tech9,"₹16,87,208/yr",Pune
Eagle TK Infotech,"₹7,13,466/yr",Pune
Fusion Practices,"₹56,250/mo",Pune
Xeco,"₹4,99,961/yr",Pune
DeepTek Medical Imaging,"₹8,95,000/yr",Pune
vElement,"₹2,53,851/yr",Pune
Asquared IoT,"₹6,37,645/yr",Pune
HiLabs (MD),"₹19,54,650/yr",Pune
Jash Data Sciences,"₹6,69,083/yr",Pune
HiLabs,"₹18,33,778/yr",Pune
Tata Consultancy Services,"₹25,000/mo",Pune
Tata Consultancy Services,"£7,03,427/yr",Pune
Amazon,"₹1,15,884/yr",Pune
Amazon,"₹6,19,069/yr",Pune
Genpact,"₹16,00,000/yr",Pune
Fresher,"₹30,147/mo",Pune
DXC Technology,"₹4,00,000/yr",Pune
KPMG,"₹6,42,322/yr",Pune
ABC,"₹1,01,398/mo",Pune
Larsen & Toubro,"₹30,000/mo",Pune
Concentrix,"₹2,89,045/mo",Pune
Google,"₹75,71,032/yr",Pune
Honeywell,"₹14,38,481/yr",Pune
Persistent Systems,"₹2,141/hr",Pune
DONE by NONE,"₹1,00,000/mo",Pune
DONE by NONE,"₹44,44,315/yr",Pune
DONE by NONE,"₹3,01,469/yr",Pune
WNS,"£2,05,049/yr",Pune
Siemens,"₹70,000/mo",Pune
Nones,"₹6,00,000/yr",Pune
ITC Infotech,"₹6,42,322/yr",Pune
Mahindra,"₹9,05,000/yr",Pune
Kotak Mahindra,"₹6,23,238/yr",Pune
eClerx,"₹8,70,000/yr",Pune
BNY Mellon,"₹64,232/mo",Pune
Zomato,"₹12,50,000/yr",Pune
Hinduja Global Solutions,"₹11,76,710/yr",Pune
Other,"₹4,14,794/yr",Pune
Thoughtworks,"₹25,69,287/yr",Pune
Fractal,"₹14,04,565/yr",Pune
TietoEVRY,"₹7,87,318/yr",Pune
Yash Technologies,"₹20,54,972/yr",Pune
Query:
SELECT "Salary"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   LIMIT 100;
Answer:
Salary
"₹6,48,573/yr"
"₹11,91,950/yr"
"₹8,36,874/yr"
"₹6,69,578/yr"
"₹9,44,110/yr"
"₹9,08,764/yr"
"₹9,26,124/yr"
"₹7,36,708/yr"
"₹16,46,721/yr"
"₹13,92,960/yr"
"₹14,04,773/yr"
"₹15,07,343/yr"
"₹15,58,095/yr"
"₹25,57,843/yr"
"₹15,10,081/yr"
"₹7,32,821/yr"
"₹12,21,750/yr"
"₹17,39,484/yr"
"₹11,24,939/yr"
"₹16,30,396/yr"
"₹10,09,436/yr"
"₹5,50,980/yr"
"₹18,70,000/yr"
"₹7,58,376/yr"
"₹15,56,575/yr"
"₹11,94,327/yr"
"₹14,70,000/yr"
"₹15,49,942/yr"
"₹10,09,436/yr"
"₹15,41,572/yr"
"₹8,11,182/yr"
"₹12,05,874/yr"
"₹7,27,111/yr"
"₹19,23,257/yr"
"₹21,43,501/yr"
"₹19,26,965/yr"
"₹41,271/mo"
"₹12,94,984/yr"
"₹23,34,960/yr"
"₹22,67,616/yr"
"₹13,66,992/yr"
"₹14,53,427/yr"
"₹14,58,032/yr"
"₹17,30,166/yr"
"₹6,58,109/yr"
"₹7,94,460/yr"
"₹25,67,381/yr"
"₹16,37,231/yr"
"₹9,00,000/yr"
"₹9,02,935/yr"
"₹9,70,782/yr"
"₹10,50,000/yr"
"₹21,19,584/yr"
"₹16,87,111/yr"
"₹14,65,641/yr"
"₹6,00,000/yr"
"₹18,05,869/yr"
"₹26,24,063/yr"
"₹9,55,297/yr"
"₹7,61,478/yr"
"₹28,05,476/yr"
"₹9,69,112/yr"
"₹4,50,979/yr"
"₹13,38,795/yr"
"₹10,40,493/yr"
"₹12,91,549/yr"
"₹49,928/mo"
"₹16,63,189/yr"
"₹13,23,387/yr"
"₹12,46,266/yr"
"₹4,94,147/yr"
"₹18,92,758/yr"
"₹15,72,054/yr"
"₹20,24,533/yr"
"₹19,27,564/yr"
"₹8,00,000/yr"
"₹20,09,790/yr"
"₹8,31,462/yr"
"₹5,16,323/yr"
"₹23,33,241/yr"
"₹12,00,000/yr"
"₹20,06,522/yr"
"₹21,60,000/yr"
"₹13,41,316/yr"
"₹16,34,105/yr"
"₹13,89,256/yr"
"₹10,00,000/yr"
"₹12,31,116/yr"
"₹23,52,941/yr"
"₹7,44,551/yr"
"₹30,14,686/yr"
"₹13,57,204/yr"
"₹10,53,196/yr"
"₹13,37,606/yr"
"₹48,825/mo"
"₹32,953/mo"
"₹16,49,930/yr"
"₹11,38,060/yr"
"₹16,12,744/yr"
"₹4,32,776/yr"
Query:
SELECT "Salary", REGEXP_REPLACE("Salary", '[^0-9.]', '') AS "CleanedSalary"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   LIMIT 100;
Answer:
Salary,CleanedSalary
"₹6,48,573/yr",648573
"₹11,91,950/yr",1191950
"₹8,36,874/yr",836874
"₹6,69,578/yr",669578
"₹9,44,110/yr",944110
"₹9,08,764/yr",908764
"₹9,26,124/yr",926124
"₹7,36,708/yr",736708
"₹16,46,721/yr",1646721
"₹13,92,960/yr",1392960
"₹14,04,773/yr",1404773
"₹15,07,343/yr",1507343
"₹15,58,095/yr",1558095
"₹25,57,843/yr",2557843
"₹15,10,081/yr",1510081
"₹7,32,821/yr",732821
"₹12,21,750/yr",1221750
"₹17,39,484/yr",1739484
"₹11,24,939/yr",1124939
"₹16,30,396/yr",1630396
"₹10,09,436/yr",1009436
"₹5,50,980/yr",550980
"₹18,70,000/yr",1870000
"₹7,58,376/yr",758376
"₹15,56,575/yr",1556575
"₹11,94,327/yr",1194327
"₹14,70,000/yr",1470000
"₹15,49,942/yr",1549942
"₹10,09,436/yr",1009436
"₹15,41,572/yr",1541572
"₹8,11,182/yr",811182
"₹12,05,874/yr",1205874
"₹7,27,111/yr",727111
"₹19,23,257/yr",1923257
"₹21,43,501/yr",2143501
"₹19,26,965/yr",1926965
"₹41,271/mo",41271
"₹12,94,984/yr",1294984
"₹23,34,960/yr",2334960
"₹22,67,616/yr",2267616
"₹13,66,992/yr",1366992
"₹14,53,427/yr",1453427
"₹14,58,032/yr",1458032
"₹17,30,166/yr",1730166
"₹6,58,109/yr",658109
"₹7,94,460/yr",794460
"₹25,67,381/yr",2567381
"₹16,37,231/yr",1637231
"₹9,00,000/yr",900000
"₹9,02,935/yr",902935
"₹9,70,782/yr",970782
"₹10,50,000/yr",1050000
"₹21,19,584/yr",2119584
"₹16,87,111/yr",1687111
"₹14,65,641/yr",1465641
"₹6,00,000/yr",600000
"₹18,05,869/yr",1805869
"₹26,24,063/yr",2624063
"₹9,55,297/yr",955297
"₹7,61,478/yr",761478
"₹28,05,476/yr",2805476
"₹9,69,112/yr",969112
"₹4,50,979/yr",450979
"₹13,38,795/yr",1338795
"₹10,40,493/yr",1040493
"₹12,91,549/yr",1291549
"₹49,928/mo",49928
"₹16,63,189/yr",1663189
"₹13,23,387/yr",1323387
"₹12,46,266/yr",1246266
"₹4,94,147/yr",494147
"₹18,92,758/yr",1892758
"₹15,72,054/yr",1572054
"₹20,24,533/yr",2024533
"₹19,27,564/yr",1927564
"₹8,00,000/yr",800000
"₹20,09,790/yr",2009790
"₹8,31,462/yr",831462
"₹5,16,323/yr",516323
"₹23,33,241/yr",2333241
"₹12,00,000/yr",1200000
"₹20,06,522/yr",2006522
"₹21,60,000/yr",2160000
"₹13,41,316/yr",1341316
"₹16,34,105/yr",1634105
"₹13,89,256/yr",1389256
"₹10,00,000/yr",1000000
"₹12,31,116/yr",1231116
"₹23,52,941/yr",2352941
"₹7,44,551/yr",744551
"₹30,14,686/yr",3014686
"₹13,57,204/yr",1357204
"₹10,53,196/yr",1053196
"₹13,37,606/yr",1337606
"₹48,825/mo",48825
"₹32,953/mo",32953
"₹16,49,930/yr",1649930
"₹11,38,060/yr",1138060
"₹16,12,744/yr",1612744
"₹4,32,776/yr",432776
Query:
SELECT "CompanyName", REGEXP_REPLACE("Salary", '[^0-9.]', '') AS "CleanedSalary"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   WHERE "Location" = 'Hyderabad'
   LIMIT 100;
Answer:
CompanyName,CleanedSalary
Microsoft,1712178
Cyient,999578
Tata Consultancy Services,697843
Infosys,583334
Amazon,1693961
Innominds Software,743423
IBM,628945
Tech Mahindra,652546
Quadratic Insights,583954
Jotter,915028
Cognizant Technology Solutions,890344
Jio,1997027
Verizon,1330683
Optum,1464110
Accenture,1104293
Deloitte,1483132
First Student,53365
Novartis,1280703
Karvy Group,594589
Wipro,1041195
Oracle,1221714
HighRadius,861434
Micron Technology,1564421
INSOFE,903446
Google,1121437
Blue Yonder,2020386
Yash Technologies,54290
DataScientest,56039
Claim Genius,1944821
Capgemini,651206
Genpact,653174
Fresher,503667
Fresher,302693
ICICI Bank,1600000
DXC Technology,1252143
Dell Technologies,825326
Microsoft,53351
Wipro Technologies,895427
Tata Consultancy Services (North America),814476
Google,411763
NTT DATA,564654
Jio,37173
ADP,1200000
Sutherland,926912
MetLife,1760000
Franklin Templeton Investments,1353553
Enquero,1048242
Brane Enterprises (nslhub),1665911
AlgonoX Technologies,1074883
Voziq,642113
HCL Technologies,1561319
First Student,25304
Virtusa,304522
Persistent Systems,1287441
UnitedHealth Group,1152418
Freshers.com,630000
Legato Health Technologies,1260152
Dr. Reddy's,433223
DBS Bank,995830
Broadridge,1607926
Optum Global Solutions,778902
Great Learning,777837
National Payments Corporation of India,1492543
Excelra Knowledge Solutions,452130
WinWire Technologies,1269639
CallHealth,823971
Gaian Solutions India,1100233
eKincare,650865
Siva Solutions,335625
Innodatatics,9392
Innodatatics,1157086
SpringML,65953
AppsTek,725664
Vertiv,702649
My Ally,89047
GoLorry,792139
Bepec Solutions,646889
KOGENTiX,700977
Prudent Technologies & Consulting,376159
App Orchid,1492959
3LOQ Labs,778644
RisingRoot Technologies,13255
Artificial Penetration,585088
Wave Infosoft,619995
SetuServ,4949704
DigiTele Networks,787723
Human Network,58648
diwo,792506
SysBasis Solutions,25204
Tata Consultancy Services,665229
Accenture,122633
Deloitte,644153
LTI,1041195
First Student,610857
Mindtree,1105372
ABC,12515
Reliance Industries,169396
Tata Consultancy Services (North America),908078
Google,1243165
Honeywell,1653407
Query:
SELECT "CompanyName", CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT) AS "SalaryNumeric"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   WHERE "Location" = 'Pune'
   LIMIT 100;
Answer:
CompanyName,SalaryNumeric
Tata Consultancy Services,717331.0
Innoplexus,1163186.0
IBM,1036536.0
AlgoAnalytics Financial Consultancy,742883.0
ZS Associates,1294039.0
Wolters Kluwer,1154579.0
Cognizant Technology Solutions,765632.0
Accenture,602937.0
Wipro,1150000.0
Zensar Technologies,854957.0
Bajaj Finance,956307.0
SG Analytics,816946.0
ThinkBumblebee Analytics,1070536.0
Michelin,1146043.0
Tech Mahindra,1114163.0
Schlumberger,2054972.0
Merkle,1134768.0
Infosys,878252.0
Capgemini,898351.0
LTI,814017.0
First Student,425000.0
Vodafone,940423.0
Eaton,1121845.0
T-Systems,1215906.0
Coupa Software Inc,1055811.0
Aera Technology,1622612.0
ABC,42249.0
Amdocs,718534.0
Atos-Syntel,423422.0
Barclays,1733746.0
KPIT Technologies,1655120.0
Credit Suisse,1421672.0
Saama Technologies,934857.0
Exela Technologies,856429.0
Abzooba,1800000.0
Linsyssoft Technologies,411680.0
HCL Technologies,61248.0
Fresher,51920.0
Axis Bank,232796.0
Freelancer,1001630.0
Citi,1577759.0
ADP,52491.0
Birlasoft,5216933.0
John Deere,1463658.0
Xoriant,1772001.0
GS Lab,834387.0
Searce,828221.0
Globant,100275.0
e-Zest Solutions,932104.0
Datametica,983550.0
Vyom Labs,25446.0
Vishwakarma Institute of Technology,602.0
Knorex,53475.0
CanWill Technologies,1161602.0
ThinkBridge,63058.0
Coditation Systems,46977.0
MindBowser Info Solutions,283914.0
Climate Connect,731758.0
Tech9,1687208.0
Eagle TK Infotech,713466.0
Fusion Practices,56250.0
Xeco,499961.0
DeepTek Medical Imaging,895000.0
vElement,253851.0
Asquared IoT,637645.0
HiLabs (MD),1954650.0
Jash Data Sciences,669083.0
HiLabs,1833778.0
Tata Consultancy Services,25000.0
Tata Consultancy Services,703427.0
Amazon,115884.0
Amazon,619069.0
Genpact,1600000.0
Fresher,30147.0
DXC Technology,400000.0
KPMG,642322.0
ABC,101398.0
Larsen & Toubro,30000.0
Concentrix,289045.0
Google,7571032.0
Honeywell,1438481.0
Persistent Systems,2141.0
DONE by NONE,100000.0
DONE by NONE,4444315.0
DONE by NONE,301469.0
WNS,205049.0
Siemens,70000.0
Nones,600000.0
ITC Infotech,642322.0
Mahindra,905000.0
Kotak Mahindra,623238.0
eClerx,870000.0
BNY Mellon,64232.0
Zomato,1250000.0
Hinduja Global Solutions,1176710.0
Other,414794.0
Thoughtworks,2569287.0
Fractal,1404565.0
TietoEVRY,787318.0
Yash Technologies,2054972.0
Query:
SELECT "CompanyName", AVG(CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT)) AS "AverageSalary"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   GROUP BY "CompanyName"
   ORDER BY "AverageSalary" DESC
   LIMIT 100;
Answer:
CompanyName,AverageSalary
Artis signature,7524456.0
CAPA - Centre for Aviation,5995002.0
BITS Pilani,5742016.0
Atos,5273205.0
Volkswagen,5184922.0
Qwerty Concepts,5081882.0
RAKESH GROUP,5016304.0
The City Bank,5000000.0
SetuServ,4949704.0
qplum,4885471.0
Snap,4498962.0
DasDas,4466071.0
ABC Consultants,4282144.0
Société Générale,4099921.0
Two Roads Tech,3812913.0
Instamojo,3808049.0
Rplus Analytics,3808049.0
Super Highway Labs,3665141.0
Zee Entertainment Enterprises Ltd.,3531413.0
Alfonso & Associates Consulting,3530641.0
Amphisoft Technologies,3517133.0
QiO Technologies,3517133.0
Pratilipi,3447524.0
Kiwi labs,3411087.0
Daimler,3387921.0
Freelance,3250773.0
Google Cloud,3211608.0
Automation Anywhere,3200000.0
Hypersonix (CA),3146934.0
Dacasa Financeira,3132009.0
Seernet Technologies,3123584.0
Fellowship.AI,3115175.0
Endurance International Group,3108546.0
MoneyTap,3097936.0
Microland,3070054.0
Rahul Industries,3037137.5
Priyanshu Plastic,3026926.0
CRED,3014686.0
Seventh Contact Hiring Solutions,3008206.0
i4u Labs,2992992.0
Agara Labs,2954147.0
Freshworks,2939735.5
Zoom Video Communications,2839076.0
R.S. Consultants,2816193.0
Cvedia,2794695.0
Bright Money,2739727.0
Boston Scientific,2707106.0
Standard Chartered Global Business Services,2682633.0
Equinor,2676340.0
MarketLinc,2658491.0
ConcertAI,2647046.0
DreamOrbit Softech,2612697.0
Hitachi,2611178.0
OLX Group,2606510.0
Bizongo,2597406.0
Sabre,2581613.0
Aligned Automation,2579455.0
Interactions,2579145.0
Naukri.com,2576614.0
Juniper Networks,2561949.0
Intuit,2560448.5
Savit Interactive,2558957.0
PhonePe,2550000.0
Colors Software,2545237.0
Priceline.com,2540253.0
Numerify,2530666.0
CognitiveScale,2511982.0
Nuartin Labs,2508152.0
Aegon,2508152.0
SmartCow,2500000.0
Locus,2472920.0
Incubit,2452654.0
None of Your Business Boutique,2452654.0
Avaamo,2452646.0
Acalvio,2442736.0
KhataBook,2433547.0
Wabtec,2420967.0
VINAYA KUMAR,2414668.5
Thoughtworks,2402800.5
ICE Mortgage Technology Senior,2400000.0
Zopper,2360899.0
Credit Saison India,2332149.0
Birdeye,2311305.0
FogHorn Systems,2300000.0
ShareChat,2300000.0
Compass,2269647.0
Smith & Nephew,2266502.0
Boeing,2266312.0
Connaizen Software,2265784.0
Meta,2258845.5
mroads,2239989.0
Sama Technology,2210744.0
Atlassian,2200000.0
redBus India,2194861.0
VMware,2189676.5
Lymbyc,2149765.0
XPO Logistics,2148867.0
Peak,2148775.0
Procter & Gamble,2144970.0
Fractal Systems,2141072.0
Query:
SELECT "CompanyName", "Location", AVG(CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT)) AS "AverageSalary"
   FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
   WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
   GROUP BY "CompanyName", "Location"
   ORDER BY "Location", "AverageSalary" DESC
   LIMIT 100;
Answer:
CompanyName,Location,AverageSalary
Qwerty Concepts,Hyderabad,5081882.0
SetuServ,Hyderabad,4949704.0
XYZ (Turkey),Hyderabad,3000000.0
ABCDEF,Hyderabad,2745265.5
MarketLinc,Hyderabad,2658491.0
Hitachi,Hyderabad,2611178.0
Procter & Gamble,Hyderabad,2576614.0
CognitiveScale,Hyderabad,2511982.0
SmartCow,Hyderabad,2500000.0
Compass,Hyderabad,2269647.0
mroads,Hyderabad,2239989.0
Hitachi Consulting,Hyderabad,2063316.0
Blue Yonder,Hyderabad,2020386.0
Gainsight,Hyderabad,2000000.0
Claim Genius,Hyderabad,1944821.0
Fanatics,Hyderabad,1917053.0
ICS Consultancy,Hyderabad,1881045.0
Meeami Technologies,Hyderabad,1864748.0
Toppr.com,Hyderabad,1857397.0
MTX Group,Hyderabad,1813738.5
Cognizant,Hyderabad,1800000.0
Zenoti,Hyderabad,1792230.0
MetLife,Hyderabad,1760000.0
FactSet,Hyderabad,1746411.0
ValueLabs,Hyderabad,1744360.6666666667
Bharat Heavy Electricals,Hyderabad,1668775.0
Brane Enterprises (nslhub),Hyderabad,1665911.0
Honeywell,Hyderabad,1653407.0
Optum Global Solutions India,Hyderabad,1628949.0
Neudesic,Hyderabad,1611735.0
CreditVidya,Hyderabad,1581030.0
Altimetrik,Hyderabad,1572363.0
Landmark IT Solutions,Hyderabad,1562895.0
Anonymous,Hyderabad,1527142.0
Franklin Templeton Investments,Hyderabad,1514658.0
Qualcomm Technologies,Hyderabad,1513463.0
Byteridge Software,Hyderabad,1500000.0
App Orchid,Hyderabad,1492959.0
National Payments Corporation of India,Hyderabad,1492543.0
Activa (CA),Hyderabad,1490685.0
Apple,Hyderabad,1472350.0
Snap2Insight,Hyderabad,1452000.0
Microsoft,Hyderabad,1424931.2
Aeries Technology,Hyderabad,1410268.0
Myntra,Hyderabad,1394897.0
Ivy,Hyderabad,1370025.5
Qualcomm,Hyderabad,1362714.0
American Express,Hyderabad,1362714.0
Evoke Technologies,Hyderabad,1355831.0
Globex Digital Solutions,Hyderabad,1343603.0
Bharat Financial Inclusion,Hyderabad,1309535.0
Bank of America,Hyderabad,1285125.0
DXC Technology,Hyderabad,1284729.5
WinWire Technologies,Hyderabad,1269639.0
DuPont,Hyderabad,1265383.5
Zen3 Info Solutions,Hyderabad,1262347.3333333333
Jaffar Engineering Works,Hyderabad,1262223.0
ProArch,Hyderabad,1251537.0
TTEC,Hyderabad,1251502.0
Uber,Hyderabad,1247607.5
Tiger Analytics,Hyderabad,1221751.5
Applied Information Sciences,Hyderabad,1221714.0
Arcadis,Hyderabad,1221714.0
ICICI Bank,Hyderabad,1215690.5
E-rachit Technologies,Hyderabad,1210770.0
PepsiCo,Hyderabad,1210770.0
Optum,Hyderabad,1206212.3333333333
College Board,Hyderabad,1205860.0
Netflix,Hyderabad,1200000.0
Guidewire,Hyderabad,1200000.0
PwC,Hyderabad,1200000.0
CoreCompete,Hyderabad,1191367.0
Ola,Hyderabad,1182371.0
Oracle,Hyderabad,1180565.5
Google,Hyderabad,1166513.6666666667
State Bank of India,Hyderabad,1159476.0
Deloitte,Hyderabad,1154386.2
Enquero,Hyderabad,1148838.0
UnitedHealth Group,Hyderabad,1144968.0
Astegic,Hyderabad,1134824.0
CDK Global,Hyderabad,1123734.0
Amnet Digital,Hyderabad,1119904.0
EPAM,Hyderabad,1115191.0
Verizon,Hyderabad,1109216.0
Dun & Bradstreet,Hyderabad,1108068.0
Salesforce,Hyderabad,1107300.5
HSBC Software Development India,Hyderabad,1104068.3333333333
Gaian Solutions India,Hyderabad,1100233.0
Kroll,Hyderabad,1100000.0
BizReach,Hyderabad,1098034.0
Industryarc,Hyderabad,1094666.0
Legato Health Technologies,Hyderabad,1082148.5
AlgonoX Technologies,Hyderabad,1074883.0
Klaxon India Private Limited,Hyderabad,1074883.0
Quantium,Hyderabad,1072842.0
Broadridge,Hyderabad,1061463.0
XYZ Innovations,Hyderabad,1049129.0
PayPal,Hyderabad,1035971.0
Bullhorn,Hyderabad,1030115.0
Ravindra Kala Vidyalaya,Hyderabad,1027381.0
Query:
SELECT "Location", "CompanyName", AVG(CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT)) AS "AverageSalaryInCity"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
    GROUP BY "Location", "CompanyName"
    ORDER BY "Location", "AverageSalaryInCity" DESC
    LIMIT 100;
Answer:
Location,CompanyName,AverageSalaryInCity
Hyderabad,Qwerty Concepts,5081882.0
Hyderabad,SetuServ,4949704.0
Hyderabad,XYZ (Turkey),3000000.0
Hyderabad,ABCDEF,2745265.5
Hyderabad,MarketLinc,2658491.0
Hyderabad,Hitachi,2611178.0
Hyderabad,Procter & Gamble,2576614.0
Hyderabad,CognitiveScale,2511982.0
Hyderabad,SmartCow,2500000.0
Hyderabad,Compass,2269647.0
Hyderabad,mroads,2239989.0
Hyderabad,Hitachi Consulting,2063316.0
Hyderabad,Blue Yonder,2020386.0
Hyderabad,Gainsight,2000000.0
Hyderabad,Claim Genius,1944821.0
Hyderabad,Fanatics,1917053.0
Hyderabad,ICS Consultancy,1881045.0
Hyderabad,Meeami Technologies,1864748.0
Hyderabad,Toppr.com,1857397.0
Hyderabad,MTX Group,1813738.5
Hyderabad,Cognizant,1800000.0
Hyderabad,Zenoti,1792230.0
Hyderabad,MetLife,1760000.0
Hyderabad,FactSet,1746411.0
Hyderabad,ValueLabs,1744360.6666666667
Hyderabad,Bharat Heavy Electricals,1668775.0
Hyderabad,Brane Enterprises (nslhub),1665911.0
Hyderabad,Honeywell,1653407.0
Hyderabad,Optum Global Solutions India,1628949.0
Hyderabad,Neudesic,1611735.0
Hyderabad,CreditVidya,1581030.0
Hyderabad,Altimetrik,1572363.0
Hyderabad,Landmark IT Solutions,1562895.0
Hyderabad,Anonymous,1527142.0
Hyderabad,Franklin Templeton Investments,1514658.0
Hyderabad,Qualcomm Technologies,1513463.0
Hyderabad,Byteridge Software,1500000.0
Hyderabad,App Orchid,1492959.0
Hyderabad,National Payments Corporation of India,1492543.0
Hyderabad,Activa (CA),1490685.0
Hyderabad,Apple,1472350.0
Hyderabad,Snap2Insight,1452000.0
Hyderabad,Microsoft,1424931.2
Hyderabad,Aeries Technology,1410268.0
Hyderabad,Myntra,1394897.0
Hyderabad,Ivy,1370025.5
Hyderabad,American Express,1362714.0
Hyderabad,Qualcomm,1362714.0
Hyderabad,Evoke Technologies,1355831.0
Hyderabad,Globex Digital Solutions,1343603.0
Hyderabad,Bharat Financial Inclusion,1309535.0
Hyderabad,Bank of America,1285125.0
Hyderabad,DXC Technology,1284729.5
Hyderabad,WinWire Technologies,1269639.0
Hyderabad,DuPont,1265383.5
Hyderabad,Zen3 Info Solutions,1262347.3333333333
Hyderabad,Jaffar Engineering Works,1262223.0
Hyderabad,ProArch,1251537.0
Hyderabad,TTEC,1251502.0
Hyderabad,Uber,1247607.5
Hyderabad,Tiger Analytics,1221751.5
Hyderabad,Applied Information Sciences,1221714.0
Hyderabad,Arcadis,1221714.0
Hyderabad,ICICI Bank,1215690.5
Hyderabad,PepsiCo,1210770.0
Hyderabad,E-rachit Technologies,1210770.0
Hyderabad,Optum,1206212.3333333333
Hyderabad,College Board,1205860.0
Hyderabad,PwC,1200000.0
Hyderabad,Guidewire,1200000.0
Hyderabad,Netflix,1200000.0
Hyderabad,CoreCompete,1191367.0
Hyderabad,Ola,1182371.0
Hyderabad,Oracle,1180565.5
Hyderabad,Google,1166513.6666666667
Hyderabad,State Bank of India,1159476.0
Hyderabad,Deloitte,1154386.2
Hyderabad,Enquero,1148838.0
Hyderabad,UnitedHealth Group,1144968.0
Hyderabad,Astegic,1134824.0
Hyderabad,CDK Global,1123734.0
Hyderabad,Amnet Digital,1119904.0
Hyderabad,EPAM,1115191.0
Hyderabad,Verizon,1109216.0
Hyderabad,Dun & Bradstreet,1108068.0
Hyderabad,Salesforce,1107300.5
Hyderabad,HSBC Software Development India,1104068.3333333333
Hyderabad,Gaian Solutions India,1100233.0
Hyderabad,Kroll,1100000.0
Hyderabad,BizReach,1098034.0
Hyderabad,Industryarc,1094666.0
Hyderabad,Legato Health Technologies,1082148.5
Hyderabad,Klaxon India Private Limited,1074883.0
Hyderabad,AlgonoX Technologies,1074883.0
Hyderabad,Quantium,1072842.0
Hyderabad,Broadridge,1061463.0
Hyderabad,XYZ Innovations,1049129.0
Hyderabad,PayPal,1035971.0
Hyderabad,Bullhorn,1030115.0
Hyderabad,Ravindra Kala Vidyalaya,1027381.0
Query:
SELECT "CompanyName", AVG(CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT)) AS "AverageSalaryNationwide"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    GROUP BY "CompanyName"
    ORDER BY "AverageSalaryNationwide" DESC
    LIMIT 100;
Answer:
CompanyName,AverageSalaryNationwide
Artis signature,7524456.0
CAPA - Centre for Aviation,5995002.0
BITS Pilani,5742016.0
Atos,5273205.0
Volkswagen,5184922.0
Qwerty Concepts,5081882.0
RAKESH GROUP,5016304.0
The City Bank,5000000.0
SetuServ,4949704.0
qplum,4885471.0
Snap,4498962.0
DasDas,4466071.0
ABC Consultants,4282144.0
Société Générale,4099921.0
Two Roads Tech,3812913.0
Instamojo,3808049.0
Rplus Analytics,3808049.0
Super Highway Labs,3665141.0
Zee Entertainment Enterprises Ltd.,3531413.0
Alfonso & Associates Consulting,3530641.0
Amphisoft Technologies,3517133.0
QiO Technologies,3517133.0
Pratilipi,3447524.0
Kiwi labs,3411087.0
Daimler,3387921.0
Freelance,3250773.0
Google Cloud,3211608.0
Automation Anywhere,3200000.0
Hypersonix (CA),3146934.0
Dacasa Financeira,3132009.0
Seernet Technologies,3123584.0
Fellowship.AI,3115175.0
Endurance International Group,3108546.0
MoneyTap,3097936.0
Microland,3070054.0
Rahul Industries,3037137.5
Priyanshu Plastic,3026926.0
CRED,3014686.0
Seventh Contact Hiring Solutions,3008206.0
i4u Labs,2992992.0
Agara Labs,2954147.0
Freshworks,2939735.5
Zoom Video Communications,2839076.0
R.S. Consultants,2816193.0
Cvedia,2794695.0
Bright Money,2739727.0
Boston Scientific,2707106.0
Standard Chartered Global Business Services,2682633.0
Equinor,2676340.0
MarketLinc,2658491.0
ConcertAI,2647046.0
DreamOrbit Softech,2612697.0
Hitachi,2611178.0
OLX Group,2606510.0
Bizongo,2597406.0
Sabre,2581613.0
Aligned Automation,2579455.0
Interactions,2579145.0
Naukri.com,2576614.0
Juniper Networks,2561949.0
Intuit,2560448.5
Savit Interactive,2558957.0
PhonePe,2550000.0
Colors Software,2545237.0
Priceline.com,2540253.0
Numerify,2530666.0
CognitiveScale,2511982.0
Nuartin Labs,2508152.0
Aegon,2508152.0
SmartCow,2500000.0
Locus,2472920.0
Incubit,2452654.0
None of Your Business Boutique,2452654.0
Avaamo,2452646.0
Acalvio,2442736.0
KhataBook,2433547.0
Wabtec,2420967.0
VINAYA KUMAR,2414668.5
Thoughtworks,2402800.5
ICE Mortgage Technology Senior,2400000.0
Zopper,2360899.0
Credit Saison India,2332149.0
Birdeye,2311305.0
FogHorn Systems,2300000.0
ShareChat,2300000.0
Compass,2269647.0
Smith & Nephew,2266502.0
Boeing,2266312.0
Connaizen Software,2265784.0
Meta,2258845.5
mroads,2239989.0
Sama Technology,2210744.0
Atlassian,2200000.0
redBus India,2194861.0
VMware,2189676.5
Lymbyc,2149765.0
XPO Logistics,2148867.0
Peak,2148775.0
Procter & Gamble,2144970.0
Fractal Systems,2141072.0
Query:
SELECT "CompanyName", COUNT(*) AS "RecordCount"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    GROUP BY "CompanyName"
    ORDER BY "RecordCount" DESC
    LIMIT 100;
Answer:
CompanyName,RecordCount
Tata Consultancy Services,41
Amazon,32
Accenture,30
Google,27
IBM,26
Fresher,26
First Student,25
Infosys,23
Cognizant Technology Solutions,21
DONE by NONE,21
ABC,20
Wipro,17
Microsoft,17
Capgemini,17
Deloitte,16
Tech Mahindra,16
LTI,16
Nones,15
Fractal,14
Quantiphi,14
Wipro Technologies,14
HCL Technologies,14
Genpact,13
Optum,12
Freelancer,11
PwC,10
ZS Associates,10
Honeywell,10
DXC Technology,10
NTT DATA,9
Jio,9
Dell Technologies,9
KPMG,9
XYZ,9
Virtusa,9
American Express,9
TCS,9
EY,9
Reliance Industries,9
ICICI Bank,9
Anonymous,9
Mu Sigma,9
Optum Global Solutions,8
Innodatatics,8
J.P. Morgan,8
Axis Bank,8
Adobe,8
UnitedHealth Group,8
Mindtree,8
Oracle,8
Atos-Syntel,8
Tata Consultancy Services (North America),8
EMPLOYERS,8
WNS,8
Siemens,7
Barclays,7
Tiger Analytics,7
Maxgen Technologies,7
MAERSK,7
Flipkart,7
Course5 Intelligence,7
Citi,7
OYO,7
iNeuron,7
HSBC,7
Novartis,7
Ugam,7
Persistent Systems,7
TEKsystems,7
Bajaj Finance,7
Publicis Sapient,7
Schlumberger,7
Mahindra,6
SG Analytics,6
Mercedes-Benz Research and Development India,6
Red Hat,6
Techolution,6
GE,6
EXL Service,6
Fresherworld.com,6
Tableau Software,6
ThinkBumblebee Analytics,6
Wells Fargo,6
Freshers.com,6
Mastercard,6
Abzooba,6
Kantar,6
Enquero,6
Datametica,6
ITC Infotech,6
Piramal Enterprises,6
SAP,6
Credit Suisse,6
Anonymous Content,6
Cisco Systems,6
Cyient,6
Ericsson-Worldwide,5
Nielsen,5
Fidelity Investments,5
Verizon,5
Query:
SELECT DISTINCT "JobTitle"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    LIMIT 100;
Answer:
JobTitle
Data Scientist
Data Science Associate
Data Science Consultant
Data Science
Senior Data Scientist
Junior Data Scientist
Lead Data Scientist
Data Science Manager
Data Scientist - Trainee
Data Analyst
Data Engineer
Machine Learning Engineer
Machine Learning Software Engineer
Software Engineer - Machine Learning
Machine Learning Engineer/Data Scientist
Machine Learning Consultant
Machine Learning Data Associate
Machine Learning Data Associate I
Machine Learning Data Analyst
Machine Learning Scientist
Machine Learning Developer
Data Science Lead
Machine Learning Associate
Machine Learning Data Associate II
Associate Machine Learning Engineer
Senior Machine Learning Engineer
Query:
SELECT "Salary"
FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
WHERE REGEXP_LIKE("Salary", '[^0-9.,]')
LIMIT 100;
Answer:
No data found for the specified query.
Query:
SELECT "CompanyName", MAX(CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT)) AS "MaxSalary"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    WHERE "Location" = 'New Delhi'
    GROUP BY "CompanyName"
    ORDER BY "MaxSalary" DESC
    LIMIT 100;
Answer:
CompanyName,MaxSalary
Wipro Technologies,5092618.0
Super Highway Labs,3665141.0
OLX Group,3644181.0
Zomato,3162981.0
NatWest Group,3141490.0
ABC,3082142.0
Nones,3026926.0
Greenlight Planet,2876666.0
Boston Scientific,2707106.0
DreamOrbit Softech,2612697.0
Naukri.com,2576614.0
Info Edge,2531779.0
Thoughtworks,2522438.0
Hike,2518336.0
Boston Consulting Group,2504513.0
Publicis Sapient,2500000.0
None of Your Business Boutique,2452654.0
Incubit,2452654.0
Mastercard,2372152.0
Birdeye,2311305.0
Connaizen Software,2265784.0
BYJU'S,2219746.0
Sama Technology,2210744.0
Amazon,2063316.0
Samsung Electronics,2063316.0
Sigma HR Solutions,2042277.0
Inshorts,2032753.0
Barclays,2014668.0
Orange Senior,2000000.0
Dell Technologies,2000000.0
Gartner,1929406.0
American Express,1919822.0
R Systems,1887245.0
McKinsey Knowledge Center,1881607.0
Times Internet,1849285.0
McKinsey & Company,1820394.0
Sprinklr,1804941.0
Paytm,1800000.0
Quantiphi Senior,1748000.0
CitiusTech,1726279.0
SAP,1712468.0
Bharat Heavy Electricals,1704749.0
TEKsystems,1643809.0
Gauge Data Solutions,1640740.0
Samsung R&D Institute India - Noida,1640000.0
Xebia,1634470.0
Bharti Airtel,1628952.0
HARMAN,1628952.0
Coforge,1600000.0
Urban Company,1589903.0
Netomi,1556582.0
Rackspace Technology,1547487.0
Goals101,1541071.0
Guavus,1531036.0
Ericsson IT Solutions & Services,1527142.0
Analytics Vidhya,1513955.0
Adobe,1511412.0
Bank of America,1507325.0
VMock,1507325.0
Honeywell,1500000.0
SRI Delhi,1500000.0
Dew Solutions,1489702.0
Beam Suntory,1478425.0
Coforge Senior,1476259.0
Zoho,1468099.0
Fractal,1463014.0
Nagarro,1460635.0
Optum Global Solutions,1455101.0
OYO,1451573.0
MakeMyTrip,1431111.0
Delhivery,1412565.0
Housing.com,1403697.0
Maven Wave Partners,1377267.0
Pitney Bowes,1364816.0
Tokopedia,1364409.0
CarDekho,1352722.0
Atlan,1331269.0
Fiserv,1324095.0
NTT DATA,1323523.0
dunnhumby,1320578.0
ZS Associates,1294964.0
SirionLabs,1289859.0
LinkedIn,1288344.0
Optum,1276202.0
Deloitte,1275546.0
Freelancer,1271011.0
naidu,1257890.0
Google,1251537.0
Musixspace,1244206.0
EXL Service,1242238.0
Bäckerei-Conditorei Fleischli,1242238.0
PeopleStrong Technologies,1240055.0
Innovaccer,1239994.0
McKinney and Company,1239375.0
NimbusHire,1236115.0
UnitedHealth Group,1235654.0
S&P Global,1230555.0
Snapdeal,1230555.0
J.P. Morgan,1221714.0
Unified Healthcare Group,1221714.0
Query:
SELECT "JobTitle", AVG(CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT)) AS "AverageSalary"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    WHERE "Location" = 'Mumbai'
    GROUP BY "JobTitle"
    ORDER BY "AverageSalary" DESC
    LIMIT 100;
Answer:
JobTitle,AverageSalary
Software Engineer - Machine Learning,1612324.0
Senior Machine Learning Engineer,1280700.8333333333
Data Scientist,941085.4256410256
Data Engineer,782077.874015748
Machine Learning Developer,581119.0
Machine Learning Engineer,512746.76136363635
Data Analyst,379906.36734693876
Machine Learning Scientist,14176.5
Query:
SELECT "CompanyName", COUNT(*) AS "SalariesReported"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    GROUP BY "CompanyName"
    HAVING COUNT(*) > 10
    ORDER BY "SalariesReported" DESC
    LIMIT 100;
Answer:
CompanyName,SalariesReported
Tata Consultancy Services,41
Amazon,32
Accenture,30
Google,27
IBM,26
Fresher,26
First Student,25
Infosys,23
DONE by NONE,21
Cognizant Technology Solutions,21
ABC,20
Microsoft,17
Capgemini,17
Wipro,17
LTI,16
Tech Mahindra,16
Deloitte,16
Nones,15
Fractal,14
Wipro Technologies,14
HCL Technologies,14
Quantiphi,14
Genpact,13
Optum,12
Freelancer,11
Query:
SELECT AVG(CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT)) AS "NationalAverageSalary"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    LIMIT 100;
Answer:
NationalAverageSalary
767988.770718232
Query:
SELECT "Location", AVG(CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT)) AS "AverageSalaryByLocation"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    GROUP BY "Location"
    ORDER BY "AverageSalaryByLocation" DESC
    LIMIT 100;
Answer:
Location,AverageSalaryByLocation
Bangalore,892445.7626262626
Pune,736137.4058679707
New Delhi,692217.7637195121
Hyderabad,677650.0
Mumbai,669215.6094003242
Query:
SELECT "CompanyName", COUNT(DISTINCT "Location") AS "LocationCount"
    FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
    GROUP BY "CompanyName"
    HAVING COUNT(DISTINCT "Location") > 1
    ORDER BY "LocationCount" DESC
    LIMIT 100;
Answer:
CompanyName,LocationCount
Capgemini,5
Fresherworld.com,5
EMPLOYERS,5
Deloitte,5
Cognizant Technology Solutions,5
WNS,5
Nones,5
Tech Mahindra,5
Amazon,5
DXC Technology,5
ABC,5
BYJU'S,5
First Student,5
Google,5
Anonymous,5
IBM,5
HCL Technologies,5
LTI,5
Microsoft,5
DONE by NONE,5
Infosys,5
Fresher,5
Tata Consultancy Services (North America),5
Wipro,5
Accenture,5
Tata Consultancy Services,5
Wipro Technologies,4
The Sparks Foundation,4
Optum,4
Atos-Syntel,4
Tiger Analytics,4
Self Opportunity,4
Genpact,4
Fractal,4
ITC Infotech,4
Honeywell,4
Great Learning,4
Jio,4
Larsen & Toubro,4
Freshers.com,4
ICICI Bank,4
TEKsystems,4
Tableau Software,4
Dell Technologies,4
XYZ,4
J.P. Morgan,4
Kantar,4
NTT DATA,4
Siemens,4
PwC,4
Mu Sigma,4
Yes Bank,4
KPMG,4
Freelancer,4
Reliance Industries,4
Citi,4
Tech Data,4
Flipkart,3
XYZ (Turkey),3
Mahindra,3
Verizon,3
Wipro Digital,3
Unacademy,3
Nielsen,3
Oracle,3
Mindtree,3
CSS Corporation,3
MakeMyTrip,3
Anonymous Content,3
TCS,3
Cyient,3
Apple,3
MAERSK,3
Bajaj Finance,3
Bharti Airtel,3
UnitedHealth Group,3
Dun & Bradstreet,3
Thoughtworks,3
HCL,3
Intellect Design Arena,3
iNeuron,3
IQVIA,3
Ericsson IT Solutions & Services,3
Mphasis,3
upGrad,3
ABCDEF,3
Synechron,3
Credit Suisse,3
ZS Associates,3
Diverse Lynx,3
Quess,3
Innodatatics,3
Virtusa,3
DataScientest,3
Axis Bank,3
American Express,3
Attra,3
Ugam,3
HSBC,3
Fiserv,3
End Exploring Related Columns
Task: Using a Salary Dataset where the salary values need to be cleaned by removing non-numeric characters and converting them to a numeric type, write a detailed SQL query that identifies the top 5 companies by average salary in each of Mumbai, Pune, New Delhi, and Hyderabad, then compares each company’s average salary in those cities to the overall national average salary. The final result should display four columns: Location, Company Name, Average Salary in State, and Average Salary in Country, listing only the top 5 companies in each of the specified locations.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To identify the top 5 companies by average salary in each of Mumbai, Pune, New Delhi, and Hyderabad, and compare each company's average salary in those cities to the overall national average salary, you would perform the following steps:

1. **Clean the Salary Data**: Remove any non-numeric characters from the `Salary` column and convert the values to a numeric data type.
2. **Calculate Average Salaries**:
   - Compute the average salary for each company in each specified city.
   - Compute the national average salary for each company across all locations.
3. **Identify Top Companies**:
   - For each city, select the top 5 companies based on their average salary in that city.
4. **Compile the Results**: Present the findings in a table with the required columns.

Here is the expected format of the final result:

```csv
Location,Company Name,Average Salary in State,Average Salary in Country
Mumbai,company1:str,avg_salary_state1:float,avg_salary_country1:float
Mumbai,company2:str,avg_salary_state2:float,avg_salary_country2:float
Mumbai,company3:str,avg_salary_state3:float,avg_salary_country3:float
Mumbai,company4:str,avg_salary_state4:float,avg_salary_country4:float
Mumbai,company5:str,avg_salary_state5:float,avg_salary_country5:float
Pune,company1:str,avg_salary_state1:float,avg_salary_country1:float
Pune,company2:str,avg_salary_state2:float,avg_salary_country2:float
Pune,company3:str,avg_salary_state3:float,avg_salary_country3:float
Pune,company4:str,avg_salary_state4:float,avg_salary_country4:float
Pune,company5:str,avg_salary_state5:float,avg_salary_country5:float
New Delhi,company1:str,avg_salary_state1:float,avg_salary_country1:float
New Delhi,company2:str,avg_salary_state2:float,avg_salary_country2:float
New Delhi,company3:str,avg_salary_state3:float,avg_salary_country3:float
New Delhi,company4:str,avg_salary_state4:float,avg_salary_country4:float
New Delhi,company5:str,avg_salary_state5:float,avg_salary_country5:float
Hyderabad,company1:str,avg_salary_state1:float,avg_salary_country1:float
Hyderabad,company2:str,avg_salary_state2:float,avg_salary_country2:float
Hyderabad,company3:str,avg_salary_state3:float,avg_salary_country3:float
Hyderabad,company4:str,avg_salary_state4:float,avg_salary_country4:float
Hyderabad,company5:str,avg_salary_state5:float,avg_salary_country5:float
```

**Explanation:**

- **Location**: The city (Mumbai, Pune, New Delhi, or Hyderabad).
- **Company Name**: Name of the company.
- **Average Salary in State**: The company's average salary in the specified city.
- **Average Salary in Country**: The company's average salary across all locations.

Each city lists the top 5 companies based on the highest average salary within that city, along with their national average salary for comparison.

*Note: The actual data values are placeholders since the dataset is not accessible for computation.*.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: The table structure information is ({database name: {schema name: [table name]}}): 
{'EDUCATION_BUSINESS': {'EDUCATION_BUSINESS': ['WEB_ORDERS', 'HARDWARE_FACT_MANUFACTURING_COST', 'SALARYDATASET', 'WEB_SALES_REPS', 'HARDWARE_DIM_PRODUCT', 'HARDWARE_FACT_GROSS_PRICE', 'HARDWARE_FACT_SALES_MONTHLY', 'UNIVERSITY_FACULTY', 'WEB_EVENTS', 'HARDWARE_DIM_CUSTOMER', 'STAFFHOURS', 'UNIVERSITY_COURSE', 'UNIVERSITY_ENROLLMENT', 'UNIVERSITY_OFFERING', 'UNIVERSITY_STUDENT', 'WEB_ACCOUNTS', 'WEB_REGION', 'HARDWARE_FACT_PRE_INVOICE_DEDUCTIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.If the task description does not specify the number of decimal places, retain all decimals to four places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-02-10 11:50:07 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 11:50:07 - root - INFO - ```sql
WITH CleanSalaries AS (
  SELECT
    "CompanyName",
    "Location",
    CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT) AS "SalaryNumeric"
  FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
  WHERE "Salary" IS NOT NULL AND REGEXP_REPLACE("Salary", '[^0-9.]', '') <> ''
),
CompanyLocationSalary AS (
  SELECT
    "CompanyName",
    "Location",
    AVG("SalaryNumeric") AS "AvgSalaryState"
  FROM CleanSalaries
  WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
  GROUP BY "CompanyName", "Location"
),
CompanyNationalSalary AS (
  SELECT
    "CompanyName",
    AVG("SalaryNumeric") AS "AvgSalaryCountry"
  FROM CleanSalaries
  GROUP BY "CompanyName"
),
StateTopCompanies AS (
  SELECT
    cls."Location",
    cls."CompanyName",
    cls."AvgSalaryState",
    cns."AvgSalaryCountry",
    ROW_NUMBER() OVER (PARTITION BY cls."Location" ORDER BY cls."AvgSalaryState" DESC) AS rn
  FROM CompanyLocationSalary cls
  JOIN CompanyNationalSalary cns ON cls."CompanyName" = cns."CompanyName"
)
SELECT
  "Location",
  "CompanyName",
  "AvgSalaryState" AS "Average Salary in State",
  "AvgSalaryCountry" AS "Average Salary in Country"
FROM StateTopCompanies
WHERE rn <= 5
ORDER BY "Location", "AvgSalaryState" DESC;
```
2025-02-10 11:50:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:50:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:50:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:50:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-02-10 11:50:08 - snowflake.connector.connection - INFO - closed
2025-02-10 11:50:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:50:09 - root - INFO - itercount: 1
2025-02-10 11:50:09 - root - INFO - 0
2025-02-10 11:50:09 - root - INFO - results: 
Location,CompanyName,Average Salary in State,Average Salary in Country
Hyderabad,Qwerty Concepts,5081882.0,5081882.0
Hyderabad,SetuServ,4949704.0,4949704.0
Hyderabad,XYZ (Turkey),3000000.0,1510743.5
Hyderabad,ABCDEF,2745265.5,1643757.75
Hyderabad,MarketLinc,2658491.0,2658491.0
Mumbai,Rahul Industries,6044006.0,3037137.5
Mumbai,NVIDIA,4187500.0,1541363.3333333333
Mumbai,VINAYA KUMAR,4029337.0,2414668.5
Mumbai,Goldman Sachs,3977066.0,1903402.6
Mumbai,Zee Entertainment Enterprises Ltd.,3531413.0,3531413.0
New Delhi,Super Highway Labs,3665141.0,3665141.0
New Delhi,Greenlight Planet,2876666.0,1918288.5
New Delhi,Boston Scientific,2707106.0,2707106.0
New Delhi,DreamOrbit Softech,2612697.0,2612697.0
New Delhi,OLX Group,2606510.0,2606510.0
Pune,Atos,5273205.0,5273205.0
Pune,Volkswagen,5184922.0,5184922.0
Pune,RAKESH GROUP,5016304.0,5016304.0
Pune,The City Bank,5000000.0,5000000.0
Pune,DasDas,4466071.0,4466071.0


2025-02-10 11:50:09 - root - INFO - Please check the answer again by reviewing Using a Salary Dataset where the salary values need to be cleaned by removing non-numeric characters and converting them to a numeric type, write a detailed SQL query that identifies the top 5 companies by average salary in each of Mumbai, Pune, New Delhi, and Hyderabad, then compares each company’s average salary in those cities to the overall national average salary. The final result should display four columns: Location, Company Name, Average Salary in State, and Average Salary in Country, listing only the top 5 companies in each of the specified locations., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
If the task description does not specify the number of decimal places, retain all decimals to four places.
The answer format should be like: To identify the top 5 companies by average salary in each of Mumbai, Pune, New Delhi, and Hyderabad, and compare each company's average salary in those cities to the overall national average salary, you would perform the following steps:

1. **Clean the Salary Data**: Remove any non-numeric characters from the `Salary` column and convert the values to a numeric data type.
2. **Calculate Average Salaries**:
   - Compute the average salary for each company in each specified city.
   - Compute the national average salary for each company across all locations.
3. **Identify Top Companies**:
   - For each city, select the top 5 companies based on their average salary in that city.
4. **Compile the Results**: Present the findings in a table with the required columns.

Here is the expected format of the final result:

```csv
Location,Company Name,Average Salary in State,Average Salary in Country
Mumbai,company1:str,avg_salary_state1:float,avg_salary_country1:float
Mumbai,company2:str,avg_salary_state2:float,avg_salary_country2:float
Mumbai,company3:str,avg_salary_state3:float,avg_salary_country3:float
Mumbai,company4:str,avg_salary_state4:float,avg_salary_country4:float
Mumbai,company5:str,avg_salary_state5:float,avg_salary_country5:float
Pune,company1:str,avg_salary_state1:float,avg_salary_country1:float
Pune,company2:str,avg_salary_state2:float,avg_salary_country2:float
Pune,company3:str,avg_salary_state3:float,avg_salary_country3:float
Pune,company4:str,avg_salary_state4:float,avg_salary_country4:float
Pune,company5:str,avg_salary_state5:float,avg_salary_country5:float
New Delhi,company1:str,avg_salary_state1:float,avg_salary_country1:float
New Delhi,company2:str,avg_salary_state2:float,avg_salary_country2:float
New Delhi,company3:str,avg_salary_state3:float,avg_salary_country3:float
New Delhi,company4:str,avg_salary_state4:float,avg_salary_country4:float
New Delhi,company5:str,avg_salary_state5:float,avg_salary_country5:float
Hyderabad,company1:str,avg_salary_state1:float,avg_salary_country1:float
Hyderabad,company2:str,avg_salary_state2:float,avg_salary_country2:float
Hyderabad,company3:str,avg_salary_state3:float,avg_salary_country3:float
Hyderabad,company4:str,avg_salary_state4:float,avg_salary_country4:float
Hyderabad,company5:str,avg_salary_state5:float,avg_salary_country5:float
```

**Explanation:**

- **Location**: The city (Mumbai, Pune, New Delhi, or Hyderabad).
- **Company Name**: Name of the company.
- **Average Salary in State**: The company's average salary in the specified city.
- **Average Salary in Country**: The company's average salary across all locations.

Each city lists the top 5 companies based on the highest average salary within that city, along with their national average salary for comparison.

*Note: The actual data values are placeholders since the dataset is not accessible for computation.* The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Location,CompanyName,Average Salary in State,Average Salary in Country
Hyderabad,Qwerty Concepts,5081882.0,5081882.0
Hyderabad,SetuServ,4949704.0,4949704.0
Hyderabad,XYZ (Turkey),3000000.0,1510743.5
Hyderabad,ABCDEF,2745265.5,1643757.75
Hyderabad,MarketLinc,2658491.0,2658491.0
Mumbai,Rahul Industries,6044006.0,3037137.5
Mumbai,NVIDIA,4187500.0,1541363.3333333333
Mumbai,VINAYA KUMAR,4029337.0,2414668.5
Mumbai,Goldman Sachs,3977066.0,1903402.6
Mumbai,Zee Entertainment Enterprises Ltd.,3531413.0,3531413.0
New Delhi,Super Highway Labs,3665141.0,3665141.0
New Delhi,Greenlight Planet,2876666.0,1918288.5
New Delhi,Boston Scientific,2707106.0,2707106.0
New Delhi,DreamOrbit Softech,2612697.0,2612697.0
New Delhi,OLX Group,2606510.0,2606510.0
Pune,Atos,5273205.0,5273205.0
Pune,Volkswagen,5184922.0,5184922.0
Pune,RAKESH GROUP,5016304.0,5016304.0
Pune,The City Bank,5000000.0,5000000.0
Pune,DasDas,4466071.0,4466071.0
Current sql:
WITH CleanSalaries AS (
  SELECT
    "CompanyName",
    "Location",
    CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT) AS "SalaryNumeric"
  FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
  WHERE "Salary" IS NOT NULL AND REGEXP_REPLACE("Salary", '[^0-9.]', '') <> ''
),
CompanyLocationSalary AS (
  SELECT
    "CompanyName",
    "Location",
    AVG("SalaryNumeric") AS "AvgSalaryState"
  FROM CleanSalaries
  WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
  GROUP BY "CompanyName", "Location"
),
CompanyNationalSalary AS (
  SELECT
    "CompanyName",
    AVG("SalaryNumeric") AS "AvgSalaryCountry"
  FROM CleanSalaries
  GROUP BY "CompanyName"
),
StateTopCompanies AS (
  SELECT
    cls."Location",
    cls."CompanyName",
    cls."AvgSalaryState",
    cns."AvgSalaryCountry",
    ROW_NUMBER() OVER (PARTITION BY cls."Location" ORDER BY cls."AvgSalaryState" DESC) AS rn
  FROM CompanyLocationSalary cls
  JOIN CompanyNationalSalary cns ON cls."CompanyName" = cns."CompanyName"
)
SELECT
  "Location",
  "CompanyName",
  "AvgSalaryState" AS "Average Salary in State",
  "AvgSalaryCountry" AS "Average Salary in Country"
FROM StateTopCompanies
WHERE rn <= 5
ORDER BY "Location", "AvgSalaryState" DESC;When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-02-10 11:50:42 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com//openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-02-10 11:50:42 - root - INFO - ```sql
WITH CleanSalaries AS (
  SELECT
    "CompanyName",
    "Location",
    CAST(REGEXP_REPLACE("Salary", '[^0-9.]', '') AS FLOAT) AS "SalaryNumeric"
  FROM "EDUCATION_BUSINESS"."EDUCATION_BUSINESS"."SALARYDATASET"
  WHERE "Salary" IS NOT NULL AND REGEXP_REPLACE("Salary", '[^0-9.]', '') <> ''
),
CompanyLocationSalary AS (
  SELECT
    "CompanyName",
    "Location",
    AVG("SalaryNumeric") AS "AvgSalaryState"
  FROM CleanSalaries
  WHERE "Location" IN ('Mumbai', 'Pune', 'New Delhi', 'Hyderabad')
  GROUP BY "CompanyName", "Location"
),
CompanyNationalSalary AS (
  SELECT
    "CompanyName",
    AVG("SalaryNumeric") AS "AvgSalaryCountry"
  FROM CleanSalaries
  GROUP BY "CompanyName"
),
StateTopCompanies AS (
  SELECT
    cls."Location",
    cls."CompanyName",
    cls."AvgSalaryState",
    cns."AvgSalaryCountry",
    ROW_NUMBER() OVER (PARTITION BY cls."Location" ORDER BY cls."AvgSalaryState" DESC NULLS LAST) AS rn
  FROM CompanyLocationSalary cls
  JOIN CompanyNationalSalary cns ON cls."CompanyName" = cns."CompanyName"
)
SELECT
  "Location",
  "CompanyName",
  ROUND("AvgSalaryState", 4) AS "Average Salary in State",
  ROUND("AvgSalaryCountry", 4) AS "Average Salary in Country"
FROM StateTopCompanies
WHERE rn <= 5
ORDER BY "Location", "AvgSalaryState" DESC NULLS LAST;
```
2025-02-10 11:50:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.3, Python Version: 3.10.16, Platform: Linux-6.5.0-45-generic-x86_64-with-glibc2.35
2025-02-10 11:50:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-02-10 11:50:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-02-10 11:50:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-02-10 11:50:43 - snowflake.connector.connection - INFO - closed
2025-02-10 11:50:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-02-10 11:50:44 - root - INFO - itercount: 2
2025-02-10 11:50:44 - root - INFO - 0
2025-02-10 11:50:44 - root - INFO - Total iteration counts: 2
