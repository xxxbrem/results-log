2025-01-19 22:21:07 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 22:21:10 - root - INFO - SQL:
SELECT DISTINCT `event_date`
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210107'
   LIMIT 1000;
Results:
event_date
20210103
20210105
20210102
20210104
20210101
20210106
20210107

2025-01-19 22:21:12 - root - INFO - SQL:
SELECT `event_date`, COUNT(*) AS total_events
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210107'
   GROUP BY `event_date`
   ORDER BY `event_date`
   LIMIT 1000;
Results:
event_date,total_events
20210101,22096
20210102,23599
20210103,24743
20210104,31395
20210105,42827
20210106,56076
20210107,44473

2025-01-19 22:21:14 - root - INFO - SQL:
SELECT DISTINCT `user_pseudo_id`
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
   LIMIT 1000;
Results:
Too long, hard cut:
user_pseudo_id
1003046.9452926974
1023282.4639847710
1026043.4481623879
1026409.1551860912
1032138.1796039159
1037928.9294661675
1045950.7099606829
1051288.9523352374
1054372.6755770068
1064574.6224708641
1066655.6240997015
1080064.0071613184
1082746.7285674512
1097358.9593491100
1104313.9641823605
1107198.5152483918
1112823.8475775772
1116587.1725520171
1127824.3503063268
1134825.6533092350
1138692.0103796281
1160488.2375923167
1164648.0319944302
1168297.2853699605
1170405.4925804370
1174066.6437027818
1178889.6850461952
1188134.8498680538
1205590.2516186397
1211099.8247563235
1213932.4846099850
1215465.1474478000
1218586.5350251990
1240786.8917310160
1246063.3665874179
1255322.2973246181
1259302.9069938124
1269423.6724500672
1275797.1936238018
1277765.6068129494
1296701.2382814729
1308776.9803994658
1318624.9067804638
1320187.6719997668
1326289.2331853598
1333091.0887566663
1352892.5937639189
1375005.2583322863
1382535.7283137323
1385112.5897617274
1396456.6482506733
1401649.9529464111
1422161.0871788362
1437260.5988606411
1448835.0934102497
1453555.6810069410
1453951.1387928223
1456890.1673716823
1459436.8826692932
1473136.1149103090
1485472.4390061373
1499810.5142637849
1501018.3808301483
1503421.5168556763
1515646.3111272928
1518831.1475327211
1519124.8641457524
1534689.9343310805
1539940.5253610440
1543004.7243225422
1550901.3980286554
1564015.6880680172
1575061.4789497906
1582390.8206269591
1616136.8949543878
1619900.3195973863
1620024.8966870933
1646722.0078157231
1674937.2501954408
1677450.9117017807
1680043.1145812114
1684301.4109152707
1688147.2939632391
1693134.9790437518
1694910.7733232660
1699037.5870634483
1707918.4797422153
1713530.3382800695
1719564.6333875501
1729803.5105688857
1734528.1974041204
1745072.0004799132
1745171.2191701968
1749246.8534368616
1759212.2216007988
1762263.6990880514
1765594.3047173009
1784794.0627143380
1804199.2014328535
1820733.6464417466
1829763.3860332334
1846974.0316175078
1859470.4546513665
1884090.9722372635
1886250.8920156183
1912537.7440240268
1958116.3750166429
1958256.0896241884
1961265.4757052307
1967725.7354072666
1990491.3893000361
1993768.0582544668
1999213.1832096854
2007362.2149327588
2007867.8957787066
2019465.0056495205
2029664.5317923957
2041235.3400307589
2044855.8624761839
2077981.6202330137
2084772.9471491241
2091407.8804833129
2102395.6721696580
2142722.9676010623
2150276.2168438227
2157133.5876722467
2159725.7481437355
2165252.0147518395
2167343.6164963557
2168528.2202958861
2194957.7885097322
2228172.7936687802
2244553.9738621373
2245992.8909040661
2247846.3358362547
2263288.5212004372
2264573.5209212671
2268837.3082004933
2272023.1096248377
2275476.3701234224
2290904.3176780756
2304235.4728947355
2311908.3797713386
2322051.0966144624
2327547.5435328629
2329161.7120010083
2340587.9439563847
2344300.8375944627
2362829.7919429820
2375215.3636092839
2376646.7974930863
2378480.6534474606
2382451.4611706340
2384902.1644296925
2411763.0850272555
2417078.3361324500
2432374.8482039518
2437853.8047077377
2438148.3441039719
2463849.3270043637
2484010.5620979211
2485922.5515109543
2486846.9299481244
2489685.1683265365
2492721.1881800375
2501661.0331987453
2506075.7314444580
2539661.0024435471
2560700.2802998477
2563982.7084295364
2578870.7901059159
2589245.5979068367
2599362.6005762632
2613632.7561400432
2627874.7977372146
2630765.5704087315
2648480.7456264429
2655279.4923479690
2681967.7844689964
2683925.9434937492
2687473.9692412289
2688110.9777730450
2691270.4995570828
2692657.2939750667
2694084.5852510731
2709449.6736747839
2712864.2294346749
2719657.8629194725
2739425.0432989823
2746195.3557509904
2748139.1358063966
2754697.4847843626
2755973.1582682668
2767600.1190297171
2776706.0228802998
2779137.7674526641
2781408.6267522276
2783014.3813479767
2795133.4288865632
2795240.3198638943
2796100.1284437751
2803851.7451929280
2810822.2085903402
2821509.2290888995
2838667.1045753224
2839647.6325562515
2842598.5931018472
2844832.0483599899
2849086.2703560041
2856545.1057637132
2873742.8991614203
2882177.0250975565
2885429.0157235569
2892944.4318946076
2893808.1269182675
2908071.3197159392
2910024.9071648144
2912682.3106786643
2913205.0530257308
2914301.0348640426
2916336.4829526738
2917194.9600461127
2917834.9881423689
2938826.3390148112
2952066.5004557428
2965622.6326568063
2973917.2072647263
2979122.8002670631
3001110.3208062401
3007601.9537396348
3017509.1296773380
3022409.8765357635
3024189.6101670146
3027107.9482352721
3028781.2091495833
3038064.1337656016
3053669.9263927930
3055314.8442482614
3058967.2730251282
3059739.3349984598
3067110.2430706696
3071174.0445612133
3071789.9352232891
3080224.3554853323
3080530.8466730500
3084839.1075146820
3085295.3644476516
3092109.1666656387
3134983.8555001541
3149868.5539413842
3158627.0434170250
3160960.1631301259
3168155.2539701733
3186081.3790394525
3193679.0282666132
3195953.1676635966
3203474.4486080556
3205524.3451816980
3213363.3651446553
3215534.5876119688
3218982.5426906645
3234944.4290037633
3237903

2025-01-19 22:21:16 - root - INFO - SQL:
SELECT `event_date`, COUNT(DISTINCT `user_pseudo_id`) AS user_count
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210107'
   GROUP BY `event_date`
   ORDER BY `event_date`
   LIMIT 1000;
Results:
event_date,user_count
20210101,2160
20210102,2581
20210103,2579
20210104,3079
20210105,4101
20210106,5486
20210107,4171

2025-01-19 22:21:19 - root - INFO - SQL:
SELECT `event_name`, COUNT(*) AS event_count
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210107'
   GROUP BY `event_name`
   ORDER BY event_count DESC
   LIMIT 10;
Results:
event_name,event_count
page_view,85636
user_engagement,49952
session_start,26037
scroll,25420
first_visit,20798
view_item,15143
view_promotion,12396
add_to_cart,3012
select_item,1897
begin_checkout,1617

2025-01-19 22:21:20 - root - INFO - SQL:
SELECT `user_pseudo_id`, `event_name`, `event_timestamp`
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210102`
   LIMIT 1000;
Results:
Too long, hard cut:
user_pseudo_id,event_name,event_timestamp
1005484.1092567297,page_view,1609568188059459
1005484.1092567297,user_engagement,1609568195189041
1005484.1092567297,first_visit,1609568182969088
1005484.1092567297,page_view,1609568182969088
1005484.1092567297,session_start,1609568182969088
1019468.5334749980,page_view,1609588434999615
1019468.5334749980,session_start,1609589361129199
1019468.5334749980,page_view,1609588439992531
1019468.5334749980,session_start,1609588434999615
1019468.5334749980,first_visit,1609588434999615
1019468.5334749980,page_view,1609589361129199
1020695.6921096883,first_visit,1609582561969864
1020695.6921096883,page_view,1609582561969864
1020695.6921096883,session_start,1609582561969864
1020695.6921096883,user_engagement,1609582567665689
1020695.6921096883,page_view,1609582566985060
1034552.3956022963,page_view,1609600008394960
1034552.3956022963,first_visit,1609600008394960
1034552.3956022963,session_start,1609600008394960
1034552.3956022963,user_engagement,1609600115528646
1034552.3956022963,page_view,1609600013170398
1034552.3956022963,scroll,1609600013170398
1035433.9962487028,user_engagement,1609615947579987
1035433.9962487028,session_start,1609615938390610
1035433.9962487028,page_view,1609615938390610
1035433.9962487028,first_visit,1609615938390610
1035433.9962487028,page_view,1609615943253258
1054184.5156674867,page_view,1609619392891496
1054184.5156674867,session_start,1609619392891496
1054184.5156674867,first_visit,1609619392891496
1055969.5872512303,user_engagement,1609618475007287
1055969.5872512303,add_payment_info,1609553535013124
1055969.5872512303,session_start,1609618457635123
1055969.5872512303,page_view,1609553423965493
1055969.5872512303,page_view,1609553595416019
1055969.5872512303,user_engagement,1609553503099841
1055969.5872512303,scroll,1609618457635123
1055969.5872512303,page_view,1609618487976798
1055969.5872512303,user_engagement,1609618492581039
1055969.5872512303,view_promotion,1609553451853983
1055969.5872512303,page_view,1609553489098090
1055969.5872512303,scroll,1609618647684880
1055969.5872512303,session_start,1609553371057472
1055969.5872512303,page_view,1609618533869139
1055969.5872512303,add_payment_info,1609618533869139
1055969.5872512303,page_view,1609618498133132
1055969.5872512303,scroll,1609553503099841
1055969.5872512303,user_engagement,1609618468733263
1055969.5872512303,scroll,1609618598191779
1055969.5872512303,view_promotion,1609618480578051
1055969.5872512303,page_view,1609553473778370
1055969.5872512303,page_view,1609618639077394
1055969.5872512303,page_view,1609553371057472
1055969.5872512303,user_engagement,1609553589519202
1055969.5872512303,user_engagement,1609553529540762
1055969.5872512303,user_engagement,1609618498133132
1055969.5872512303,page_view,1609618480578051
1055969.5872512303,user_engagement,1609618481765702
1055969.5872512303,page_view,1609553376051937
1055969.5872512303,page_view,1609618475007287
1055969.5872512303,page_view,1609618508299834
1055969.5872512303,user_engagement,1609553446310467
1055969.5872512303,scroll,1609553488424949
1055969.5872512303,page_view,1609553446310467
1055969.5872512303,scroll,1609553446310467
1055969.5872512303,user_engagement,1609618528344692
1055969.5872512303,page_view,1609553535013124
1055969.5872512303,scroll,1609553649667731
1055969.5872512303,add_shipping_info,1609553473778370
1055969.5872512303,page_view,1609553462109417
1055969.5872512303,scroll,1609553529540762
1055969.5872512303,add_shipping_info,1609553489098090
1055969.5872512303,user_engagement,1609553381199223
1055969.5872512303,page_view,1609553387537738
1055969.5872512303,scroll,1609618475007287
1055969.5872512303,scroll,1609618507691027
1055969.5872512303,user_engagement,1609553456599186
1055969.5872512303,page_view,1609553649667731
1055969.5872512303,page_view,1609618503628150
1055969.5872512303,scroll,1609553541502831
1055969.5872512303,page_view,1609553503652567
1055969.5872512303,page_view,1609553607877330
1055969.5872512303,first_visit,1609553371057472
1055969.5872512303,user_engagement,1609553439445737
1055969.5872512303,user_engagement,1609553405674382
1055969.5872512303,user_engagement,1609553418058528
1055969.5872512303,user_engagement,1609553602255295
1055969.5872512303,add_shipping_info,1609618508299834
1055969.5872512303,add_shipping_info,1609553503652567
1055969.5872512303,scroll,1609553423965493
1055969.5872512303,scroll,1609553418058528
1055969.5872512303,user_engagement,1609553649667731
1055969.5872512303,user_engagement,1609553488424949
1055969.5872512303,scroll,1609553472743540
1055969.5872512303,user_engagement,1609553472743540
1055969.5872512303,page_view,1609553411650074
1055969.5872512303,page_view,1609553451853983
1055969.5872512303,user_engagement,1609618599066319
1104189.1961360907,scroll,1609615417977775
1104189.1961360907,page_view,1609615382420520
1104189.1961360907,user_engagement,1609615392825942
1104189.1961360907,session_start,1609615382420520
1104189.1961360907,user_engagement,1609615428650639
11

2025-01-19 22:21:22 - root - INFO - SQL:
SELECT DISTINCT `user_pseudo_id`
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE `event_name` = 'purchase'
     AND _TABLE_SUFFIX BETWEEN '20210101' AND '20210107'
   LIMIT 1000;
Results:
user_pseudo_id
2459937.2318206302
2637438.5895621403
2838161.4781702653
3056927.8375951035
3593045.4474754034
4181862.5710073931
5155655.8559554783
5963534.4700679023
6115983.2241878817
9220684.1553390889
19492128.7016911946
24377658.7213551870
28988900.6959315645
32591508.2385963314
39214432.1935349913
45529743.2756914140
74972717.1202590271
84389355.3658704825
84496993.3019099787
87431455.4720611025
6282998.3933758831
52461093.3056333183
73370809.3757379160
7312667.0266395141
41803452.7850037461
25712283.2548580985
61389953.5535318141
3048586.2373315420
5257023.2131424569
7634450.7489916014
7828968.5532093675
17494077.2658372366
22300841.9909876299
33280841.1628915296
47439165.5147551041
49456942.0436829148
2885429.0157235569
8894775.5253595050
62524109.3161787418
18161607.9002799024
24207018.3974015161
3351786.5083077372
40650638.8176789956
87047667.1042912591
68546038.8820428933
6101467.4740745406
15817556.8554808751
50844046.9564028621
53104811.8176614311
2783014.3813479767
3354006.4211651279
53550354.6354713181
1160488.2375923167
6097102.6516338254
68780200.6423809280
71568861.8035326636
72959035.2192369480
74650484.1255761858
6283343.2195449706
77327261.9614153178
78207562.9231433824
6363623135.4270133281
1158637.0383647084
46574324.9683380755
59643921.1694992453
44810382.7311730027
59487571.9263599382
88827381.9303945281
75571709.1157982540
1055969.5872512303
3024189.6101670146
7296845.4997447007
42807215.0722008548
43382307.1290802082
51954044.7234105463
77052125.0799530822
22857919.0356368006
25040095.0670087088
80435974.9462183494
40569893.9835575904
78839661.7033676134
84647660.6681637188
85305313.7561330759
2387737.8440654529
2605468.7128696165
3434475.4232528961
3949544.2182643123
7678145.6418665978
8676958.1154553142
12509391.0991562676
24390067.7154104169
68281659.9581386964
70825378.7231985352
86272927.5845958008
7946294.3682774932
20754226.2589569130
45421650.6526651864
83310359.0821475252
1873577.7239946701
19646880.6083875642
20631378.7981176516
38538077.3398709669
79944589.6932026672
88839956.1260646312
3287379.7416476309
3953783.0019328064
40387173.9002245801
57065333.7001768225
4211935.8810857498
3591907.4452081930
48482961.7353796273
6510522.7061313662
7742237.5794101746
10269098.5703813861
11677998.3685150844
31450884.9129417592
52669317.3821594758
56460399.1194105799
60952845.2415737283
77996608.4384679865
86953811.9568548667
90945046.7404900107
3517925.3227970426
5502422.3790987476
7687394.8608023492
9158325.4927360836
53406211.8724008214
71510217.3315206080
75336556.8734149504
4115432.9849138741
2265878.0595059594
29625533.6319169088
26105678.1036002654
58749509.5865067460
40957384.9471332754
2924215.0352437879

2025-01-19 22:21:24 - root - INFO - SQL:
SELECT `user_pseudo_id`, COUNT(*) AS event_count
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210103`
   GROUP BY `user_pseudo_id`
   ORDER BY event_count DESC
   LIMIT 1000;
Results:
Too long, hard cut:
user_pseudo_id,event_count
91675873.1352298917,388
10273164.5274553015,252
2885429.0157235569,234
68044587.8089465417,219
75571709.1157982540,192
5237743.2231683146,171
5712577.1182625340,167
24207018.3974015161,151
49426200.6314888908,134
78035137.0930503727,132
2038619.5845722539,125
70950266.4644317151,125
8741663.0518466186,120
7801689.0887224805,118
81559713.4631632468,117
6919080.3395786156,116
18161607.9002799024,116
3377339.5089753849,108
72525244.4757615854,106
85270287.8384530924,103
17494077.2658372366,102
20246616.8208729043,100
33280841.1628915296,99
3068634.6383481729,96
5765850.5948282569,95
7634450.7489916014,94
5971756.6682080637,94
6902555.6331797931,93
3593045.4474754034,92
2051660.3699709133,91
3048586.2373315420,89
3176404.4484412596,83
77327261.9614153178,76
49687999.1512301268,74
8289129.8211850061,71
8767768.5249017704,70
1493438.1834934820,70
48996419.4822821424,69
51278290.7724873670,68
8447373.0647826021,64
5492322788.7993357688,62
77385826.9962322494,61
7828968.5532093675,61
4583633111.4441762602,61
1979778.7331964605,60
62524109.3161787418,59
4584127.7203106647,59
36787079.8360448300,57
49456942.0436829148,57
8035696.1597387031,56
22300841.9909876299,55
6215048824.9659347018,54
65444107.8891276284,52
57746264.2440229048,51
64489888.5963828123,49
1492257.1138270046,48
53219536.1306282888,47
23138045.8449397571,47
8043621000.0220376456,46
88618114.6262085960,46
13413255.3939422273,45
4024190.3037653934,45
85290326.1742411983,44
7249551.6994075107,44
24443302.7659648569,43
8268471.0318384786,42
5257023.2131424569,42
90544926.0090701684,41
5687566.9810985467,41
32237894.7864730961,40
39049984.4198737878,39
9055634.6267700710,39
7160282.2417661246,39
48038218.3483866311,39
62258045.1747483641,38
47439165.5147551041,38
8894775.5253595050,37
79549234.2757633747,37
76784344.9112069115,35
30199603.5476237961,35
90295329.1271275379,35
2116278.5223204033,35
4451648.2986259133,34
3169195.7953388839,34
53860668.4757240899,34
5372253.4952715876,33
80159360.0979608390,33
88103904.7206552805,33
42717702.5461417546,33
66003152.6293590689,33
2328501657.2288090835,32
12796516.5743787947,32
3141277.0508009875,31
26220566.4678929051,31
4767726.9459482026,31
55686004.5190812643,30
98232650.3130769873,30
20394489.5566163330,29
23068457.7257052922,29
11321750.4742481705,29
42745051.8561886464,29
82790709.8741341477,29
25732325.7552101776,29
36135644.5721773322,29
19522194.3549446028,28
65058390.2787133295,28
43038329.0110993604,28
5332798.0334344774,28
30829821.6679425848,28
4777033.3943263498,28
38570160.2085473490,28
8183328.2038616516,28
61219218.7470481597,27
72560733.3437175307,27
4282416.7702392320,27
2989628.1463094396,27
6564799.9806825282,27
4127932.2190096724,26
5446935.0197277151,26
4819501.9483311114,26
51411443.9641714186,26
8960311.5644298530,26
5380693.1792584257,26
81460639.7679824956,26
5655735.7344284207,26
2553007.7989629504,25
64347064.3624433445,25
5346566.7251055228,25
11280285.6383562292,25
4980906.4887239358,25
22607982.7488826864,24
41252441.2354001560,24
8174001983.9035637635,24
95189736.5495320837,24
21787646.5950635572,24
22936048.1739497236,24
4489911.8248370010,24
33090559.1816854682,24
2039126.6383271583,23
86558317.1569669840,23
58751681.2860417490,23
4739295590.7137248905,23
5998832.1586803243,23
57489984.6489263708,23
91434315.3023859379,23
7738064.2633838278,23
47081559.1128986750,23
80259763.7226425588,23
83326933.7910380809,23
24652691.4955716686,23
12480877.1430029860,23
61836244.6153531118,23
29057959.6356005819,23
9115804.5909348436,23
29713270.9410751405,22
18918149.1966617530,22
24863109.6664550316,22
1676361.4249094214,22
4726379.3054653332,22
5579052.7307247809,22
14185921.8189064703,22
41750986.1235645474,22
2293260.7167260153,21
30863773.5872051762,21
60045735.9557612554,21
2051970101.9896106067,21
52050011.9038477112,21
6160571.7476726734,21
31588757.8825339636,21
80968856.1639925205,21
56275760.5320229166,21
28715478.3435707109,21
47985850.2911505398,21
4346454396.3932670436,20
3997259.2454147367,20
66037589.4192813712,20
5297219.0797104074,20
2477865562.8187386007,20
71175566.4374785888,20
8707100.5363547431,20
67183545.8916694663,20
6867779.6634381231,20
90517444.7336534522,20
44820732.9335740187,19
72277620.8350109221,19
1005317.0661766703,19
80808783.1089327810,19
83963310.9742826141,19
17778688.4962113680,19
2437168.2728482016,19
75336974.2076317636,19
9221768.6384592497,19
55210897.1970839104,19
7060799.6799023627,19
11414424.2086200067,18
6122284.2931453103,18
26355291.5224113375,18
9009731.0701454454,18
59513729.2877493835,18
43972587.9232451419,18
5101958.0754736254,18
14280112.1198939292,18
2345345.3780200574,18
10710587.2295536666,18
87080412.0399273960,18
23815881.7988103213,18
43845399.2620818316,18
5495827.3045253647,18
31452097.9029539265,18
8952897.5607478621,18
41939620.1033607756,18
8557210.6454347431,18
50095174.0437668583,17
26521546.0674230641,17
1162127.7258009994,17
18141360.4093124213,17
29107353.9472204559,17
5767091.1699699062,17

2025-01-19 22:21:26 - root - INFO - SQL:
SELECT `event_name`, COUNT(*) AS event_count
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210104`
   GROUP BY `event_name`
   ORDER BY event_count DESC
   LIMIT 1000;
Results:
event_name,event_count
page_view,11010
user_engagement,6502
scroll,3439
session_start,3319
first_visit,2620
view_item,1983
view_promotion,1265
add_to_cart,396
view_search_results,259
select_item,217
begin_checkout,183
select_promotion,72
add_shipping_info,61
add_payment_info,50
purchase,16
click,3

2025-01-19 22:21:28 - root - INFO - SQL:
SELECT DISTINCT `user_pseudo_id`, `event_date`
    FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
    WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210105'
    LIMIT 1000;
Results:
Too long, hard cut:
user_pseudo_id,event_date
1005484.1092567297,20210102
1019468.5334749980,20210102
1020695.6921096883,20210102
1034552.3956022963,20210102
1035433.9962487028,20210102
1054184.5156674867,20210102
1055969.5872512303,20210102
1104189.1961360907,20210102
1127197.7845904071,20210102
1134613.7634894426,20210102
1137060.9310088729,20210102
1140798.4477437179,20210102
1160488.2375923167,20210102
1161350.5694934880,20210102
1164110.7921696016,20210102
1219168.5485233162,20210102
1239682.4582755521,20210102
1246097.1442578537,20210102
1250553.7197007147,20210102
1253534.6863073074,20210102
1254621.7726451069,20210102
1272248.3527408128,20210102
1273851.7434031787,20210102
1274599.3928448053,20210102
1278408.9014565519,20210102
1279602.6727600031,20210102
1293446.1816560362,20210102
1296701.2382814729,20210102
1299487.6744511638,20210102
1314847.4544971351,20210102
1315049.1291069189,20210102
1325116.8912286004,20210102
1334700.6047036975,20210102
1359861.1338029424,20210102
1364085.2107948688,20210102
1370461.9318815596,20210102
1380837.6952136083,20210102
1381565.5047705405,20210102
1382535.7283137323,20210102
1390300.4796021112,20210102
1392466.8272664309,20210102
1402138.5184246691,20210102
1405619.5662753913,20210102
1413270.7201714861,20210102
1440319.2684459003,20210102
1441065.6470414018,20210102
1442997.6750483462,20210102
1470601.3891204117,20210102
1482331.8123183039,20210102
1505379.6854768255,20210102
1507645.2354095566,20210102
1508520.3631208357,20210102
1524258.4980135729,20210102
1537916.6494875994,20210102
1550647.9864364390,20210102
1587120.7886409442,20210102
1587333.3490610470,20210102
1595062.2978681339,20210102
1619900.3195973863,20210102
1621047.1809785712,20210102
1650186.4171427739,20210102
1652787.4806754655,20210102
1653230.5444867771,20210102
1661549.9249699570,20210102
1664037.8368386837,20210102
1664926.0864851694,20210102
1679710.5467997846,20210102
1684439.4801767659,20210102
1688021.5951717579,20210102
1689822.6628262328,20210102
1695729.1971283274,20210102
1698322.2974178584,20210102
1699537.8074625037,20210102
1704767.6168359047,20210102
1708071.1093492535,20210102
1720808.5659233423,20210102
1721354.6818865235,20210102
1722117.4481798918,20210102
1746667.8607565392,20210102
1778028.3352091849,20210102
1788337.3157672800,20210102
1793640.9588973139,20210102
1804084.9503910975,20210102
1810164.8096235223,20210102
1821461.3337986263,20210102
1824121.5656787337,20210102
1846974.0316175078,20210102
1849787.1417367270,20210102
1862279.2644343817,20210102
1873058.4156402266,20210102
1928081.8451007978,20210102
1929880.8943789391,20210102
1941137.5727282147,20210102
1946378.2604112351,20210102
1946567.8498627659,20210102
1966814.1086113170,20210102
1977599.8253595252,20210102
1988973.6797776774,20210102
1989653.0310679976,20210102
1990491.3893000361,20210102
1997680.4430170613,20210102
2003178.1919214406,20210102
2003410.3743325553,20210102
2014468.4429759626,20210102
2017291.1955110057,20210102
2022577.6028076666,20210102
2038564.1352340774,20210102
2047359.5675604073,20210102
2047377.2903997635,20210102
2063626.9238065250,20210102
2087721.6967658602,20210102
2096059.7363835654,20210102
2100078.5164826353,20210102
2109449.9660162118,20210102
2113798.0518736192,20210102
2115313.5923151214,20210102
2116832.9143999021,20210102
2124015.0378908424,20210102
2144124.6364405235,20210102
2149555.4176497170,20210102
2152321.4561806737,20210102
2181825.8993193032,20210102
2183606.6278528627,20210102
2197705.7004821624,20210102
2198590.4966974374,20210102
2202427.5069899276,20210102
2216286.4044820257,20210102
2221930.1797585103,20210102
2225774.7364227776,20210102
2226580.8704433782,20210102
2226624.7706208292,20210102
2235087.0942165188,20210102
2240072.6562005194,20210102
2253111.9586733581,20210102
2274040.6741003102,20210102
2275111.4028372694,20210102
2284553.4981188662,20210102
2296500.5827142601,20210102
2301921.2057149746,20210102
2303142.6308475718,20210102
2314215.6504049440,20210102
2329031.6103448704,20210102
2331461.5841279593,20210102
2336526.9274069819,20210102
2343354.0238884087,20210102
2345583.2413952607,20210102
2347781.8032119000,20210102
2350448.4141410843,20210102
2353015.7664381023,20210102
2361377.9933199841,20210102
2370322.3013967089,20210102
2371746.6281118505,20210102
2380241.2215017615,20210102
2394410.3295052541,20210102
2401649.3408462953,20210102
2403131.1457037836,20210102
2404282.2391450101,20210102
2430658.1327125161,20210102
2455077.3609833583,20210102
2482206.0801635150,20210102
2483927.4346404473,20210102
2492165.4306556688,20210102
2492500.1425673190,20210102
2498852.6851889965,20210102
2500745.7357943995,20210102
2507095.9841079823,20210102
2508716.6266480416,20210102
2520337.3364032237,20210102
2525713.0322520707,20210102
2525850.6494695512,20210102
2531897.1720965032,20210102
2534054.9013465326,20210102
2536363.5033290586,20210102
2537006.1447313249,20210102
2537784.9601456696,20210102
2543713.9652701500,20210102
2566092.9507111229,20210102
2570370.5558938997

2025-01-19 22:21:28 - root - INFO - itercount: 0
2025-01-19 22:21:28 - root - INFO - Database Name: bigquery-public-data
Schema Name: ga4_obfuscated_sample_ecommerce
DDL describes table information.
,0
table_name,events_20210109
ddl,"CREATE TABLE `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210109`
(
  event_date STRING,
  event_timestamp INT64,
  event_name STRING,
  event_params ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64>>>,
  event_previous_timestamp INT64,
  event_value_in_usd FLOAT64,
  event_bundle_sequence_id INT64,
  event_server_timestamp_offset INT64,
  user_id STRING,
  user_pseudo_id STRING,
  privacy_info STRUCT<analytics_storage INT64, ads_storage INT64, uses_transient_token STRING>,
  user_properties ARRAY<STRUCT<key INT64, value STRUCT<string_value INT64, int_value INT64, float_value INT64, double_value INT64, set_timestamp_micros INT64>>>,
  user_first_touch_timestamp INT64,
  user_ltv STRUCT<revenue FLOAT64, currency STRING>,
  device STRUCT<category STRING, mobile_brand_name STRING, mobile_model_name STRING, mobile_marketing_name STRING, mobile_os_hardware_model INT64, operating_system STRING, operating_system_version STRING, vendor_id INT64, advertising_id INT64, language STRING, is_limited_ad_tracking STRING, time_zone_offset_seconds INT64, web_info STRUCT<browser STRING, browser_version STRING>>,
  geo STRUCT<continent STRING, sub_continent STRING, country STRING, region STRING, city STRING, metro STRING>,
  app_info STRUCT<id STRING, version STRING, install_store STRING, firebase_app_id STRING, install_source STRING>,
  traffic_source STRUCT<medium STRING, name STRING, source STRING>,
  stream_id INT64,
  platform STRING,
  event_dimensions STRUCT<hostname STRING>,
  ecommerce STRUCT<total_item_quantity INT64, purchase_revenue_in_usd FLOAT64, purchase_revenue FLOAT64, refund_value_in_usd FLOAT64, refund_value FLOAT64, shipping_value_in_usd FLOAT64, shipping_value FLOAT64, tax_value_in_usd FLOAT64, tax_value FLOAT64, unique_items INT64, transaction_id STRING>,
  items ARRAY<STRUCT<item_id STRING, item_name STRING, item_brand STRING, item_variant STRING, item_category STRING, item_category2 STRING, item_category3 STRING, item_category4 STRING, item_category5 STRING, price_in_usd FLOAT64, price FLOAT64, quantity INT64, item_revenue_in_usd FLOAT64, item_revenue FLOAT64, item_refund_in_usd FLOAT64, item_refund FLOAT64, coupon STRING, affiliation STRING, location_id STRING, item_list_id STRING, item_list_name STRING, item_list_index STRING, promotion_id STRING, promotion_name STRING, creative_name STRING, creative_slot STRING>>
);"

Some other tables have the similar structure: ['events_20210109', 'events_20201109', 'events_20210110', 'events_20210123', 'events_20201107', 'events_20201111', 'events_20201228', 'events_20201224', 'events_20210119', 'events_20201105', 'events_20210131', 'events_20201218', 'events_20210124', 'events_20201222', 'events_20210103', 'events_20210127', 'events_20210108', 'events_20201120', 'events_20201130', 'events_20201124', 'events_20210104', 'events_20201115', 'events_20210128', 'events_20210121', 'events_20201114', 'events_20201127', 'events_20210111', 'events_20210118', 'events_20210113', 'events_20201212', 'events_20201113', 'events_20201221', 'events_20210112', 'events_20210120', 'events_20210101', 'events_20201209', 'events_20201206', 'events_20201225', 'events_20201129', 'events_20201112', 'events_20201230', 'events_20210115', 'events_20210107', 'events_20201210', 'events_20201121', 'events_20201215', 'events_20201229', 'events_20201123', 'events_20201204', 'events_20201201', 'events_20210102', 'events_20210106', 'events_20201205', 'events_20201226', 'events_20201211', 'events_20201203', 'events_20201102', 'events_20201106', 'events_20201213', 'events_20201128', 'events_20210105', 'events_20201220', 'events_20201117', 'events_20201231', 'events_20201208', 'events_20201108', 'events_20201214', 'events_20201207', 'events_20201223', 'events_20210117', 'events_20201219', 'events_20201110', 'events_20201122', 'events_20210130', 'events_20201216', 'events_20210126', 'events_20210129', 'events_20210125', 'events_20201227', 'events_20201126', 'events_20201217', 'events_20201101', 'events_20201116', 'events_20201103', 'events_20210122', 'events_20201104', 'events_20210114', 'events_20210116', 'events_20201119', 'events_20201125', 'events_20201118', 'events_20201202']
External knowledge that might be helpful: 
# GA4 - BigQuery Export schema

This article explains the format and schema of the Google Analytics 4 property data and the Google Analytics for Firebase data that is exported to BigQuery.

## Datasets

For each Google Analytics 4 property and each Firebase project that is linked to BigQuery, a single dataset named "analytics_<property_id>" is added to your BigQuery project. Property ID refers to your Analytics Property ID, which you can find in the property settings for your Google Analytics 4 property, and in App Analytics Settings in Firebase. Each Google Analytics 4 property and each app for which BigQuery exporting is enabled will export its data to that single dataset.

## Tables

Within each dataset, a table named `events_YYYYMMDD` is created each day if the Daily export option is enabled.

If the Streaming export option is enabled, a table named`events_intraday_YYYYMMDD`is created. This table is populated continuously as events are recorded throughout the day. This table is deleted at the end of each day once `events_YYYYMMDD` is complete.

Not all devices on which events are triggered send their data to Analytics on the same day the events are triggered. To account for this latency, Analytics will update the daily tables (`events_YYYYMMDD`) with events for those dates for up to three days after the dates of the events. Events will have the correct time stamp regardless of arriving late. Events that arrive after that three-day window are not recorded.

## Columns

Each column in the `events_YYYYMMDD`table represents an event-specific parameter. Note that some parameters are nested within RECORDS, and some RECORDS such as
`[items](https://support.google.com/analytics/answer/7029846?hl=en&ref_topic=9359001&sjid=16041154979191290935-EU#items)`
and
`[event_params](https://support.google.com/analytics/answer/7029846?hl=en&ref_topic=9359001&sjid=16041154979191290935-EU#event_params)`
are repeatable. Table columns are described below.

### event

The event fields contain information that uniquely identifies an event.

| Field name | Data type | Description |
|---|---|---|
| batch_event_index | INTEGER | A number indicating the sequential order of each event within a batch based on their order of occurrence on the device. |
| batch_ordering_id | INTEGER | A monotonically increasing number that is incremented each time a network request is sent from a given page. |
| batch_page_id | INTEGER | A sequential number assigned to a page that increases for each subsequent page within an engagement. |
| event_date | STRING | The date when the event was logged (YYYYMMDD format in the registered timezone of your app). |
| event_timestamp | INTEGER | The time (in microseconds, UTC) when the event was logged on the client. |
| event_previous_timestamp | INTEGER | The time (in microseconds, UTC) when the event was previously logged on the client. |
| event_name | STRING | The name of the event. |
| event_value_in_usd | FLOAT | The currency-converted value (in USD) of the event's "value" parameter. |
| event_bundle_sequence_id | INTEGER | The sequential ID of the bundle in which these events were uploaded. |
| event_server_timestamp_offset | INTEGER | Timestamp offset between collection time and upload time in micros. |

#### event_params RECORD

The event_params RECORD can store campaign-level and contextual event parameters as well as any user-defined event parameters. The event_params RECORD is repeated for each key that is associated with an event. The set of parameters stored in the event_params RECORD is unique to each implementation. To see the complete list of event parameters for your implementation, query the event parameter list.

| Field name | Data type | Description |
|---|---|---|
| event_params.key | STRING | The name of the event parameter. |
| event_params.value | RECORD | A record containing the event parameter's value. |
| event_params.value.string_value | STRING | If the event parameter is represented by a string, such as a URL or campaign name, it is populated in this field. |
| event_params.value.int_value | INTEGER | If the event parameter is represented by an integer, it is populated in this field. |
| event_params.value.double_value | FLOAT | If the event parameter is represented by a double value, it is populated in this field. |
| event_params.value.float_value | FLOAT | If the event parameter is represented by a floating point value, it is populated in this field. This field is not currently in use. |

#### item_params RECORD

The item_params RECORD can store item parameters as well as any user-defined item parameters. The set of parameters stored in the item_params RECORD is unique to each implementation.

| Field name | Data type | Description |
|---|---|---|
| item_params.key | STRING | The name of the item parameter. |
| item_params.value | RECORD | A record containing the item parameterâ€™s value. |
| item_params.value.string_value | STRING | If the item parameter is represented by a string, it is populated in this field. |
| item_params.value.int_value | INTEGER | If the item parameter is represented by an integer, it is populated in this field. |
| item_params.value.double_value | FLOAT | If the item parameter is represented by a double value, it is populated in this field. |
| item_params.value.float_value | FLOAT | If the item parameter is represented by a floating point value, it is populated in this field. | 

### user

The user fields contain information that uniquely identifies the user associated with the event.

| Field name | Data type | Description |
|---|---|---|
| is_active_user | BOOLEAN | Whether the user was active (True) or inactive (False) at any point in the calendar day Included in only the daily tables ( events_YYYYMMDD) . |
| user_id | STRING | The unique ID assigned to a user. |
| user_pseudo_id | STRING | The pseudonymous id (e.g., app instance ID) for the user. |
| user_first_touch_timestamp | INTEGER | The time (in microseconds) at which the user first opened the app or visited the site. |

#### privacy_info fields

The privacy_info fields contain information based on the consent status of a user when consent mode is enabled .

| Field name | Data type | Description |
|---|---|---|
| privacy_info.ads_storage | STRING | Whether ad targeting is enabled for a user. Possible values: Yes, No, Unset |
| privacy_info.analytics_storage | STRING | Whether Analytics storage is enabled for the user. Possible values: Yes, No, Unset |
| privacy_info.uses_transient_token | STRING | Whether a web user has denied Analytics storage and the developer has enabled measurement without cookies based on transient tokens in server data. Possible values: Yes, No, Unset |

#### user_properties RECORD

The user_properties RECORD contains any user properties that you have set. It is repeated for each key that is associated with a user.

| Field name | Data type | Description |
|---|---|---|
| user_properties.key | STRING | The name of the user property. |
| user_properties.value | RECORD | A record for the user property value. |
| user_properties.value.string_value | STRING | The string value of the user property. |
| user_properties.value.int_value | INTEGER | The integer value of the user property. |
| user_properties.value.double_value | FLOAT | The double value of the user property. |
| user_properties.value.float_value | FLOAT | This field is currently unused. |
| user_properties.value.set_timestamp_micros | INTEGER | The time (in microseconds) at which the user property was last set. |

#### user_ltv RECORD

The user_ltv RECORD contains Lifetime Value information about the user. This RECORD is not populated in intraday tables.

| Field name | Data type | Description |
|---|---|---|
| user_ltv.revenue | FLOAT | The Lifetime Value (revenue) of the user. This field is not populated in intraday tables. |
| user_ltv.currency | STRING | The Lifetime Value (currency) of the user. This field is not populated in intraday tables. | 

### device

The device RECORD contains information about the device from which the event originated.

| Field name | Data type | Description |
|---|---|---|
| device.category | STRING | The device category (mobile, tablet, desktop). |
| device.mobile_brand_name | STRING | The device brand name. |
| device.mobile_model_name | STRING | The device model name. |
| device.mobile_marketing_name | STRING | The device marketing name. |
| device.mobile_os_hardware_model | STRING | The device model information retrieved directly from the operating system. |
| device.operating_system | STRING | The operating system of the device. |
| device.operating_system_version | STRING | The OS version. |
| device.vendor_id | STRING | IDFV (present only if IDFA is not collected). |
| device.advertising_id | STRING | Advertising ID/IDFA. |
| device.language | STRING | The OS language. |
| device.time_zone_offset_seconds | INTEGER | The offset from GMT in seconds. |
| device.is_limited_ad_tracking | BOOLEAN | The device's Limit Ad Tracking setting. On iOS14+, returns false if the IDFA is non-zero. |
| device.web_info.browser | STRING | The browser in which the user viewed content. |
| device.web_info.browser_version | STRING | The version of the browser in which the user viewed content. |
| device.web_info.hostname | STRING | The hostname associated with the logged event. | 

### geo

The geo RECORD contains information about the geographic location where the event was initiated.

| Field name | Data type | Description |
|---|---|---|
| geo.continent | STRING | The continent from which events were reported, based on IP address. |
| geo.sub_continent | STRING | The subcontinent from which events were reported, based on IP address. |
| geo.country | STRING | The country from which events were reported, based on IP address. |
| geo.region | STRING | The region from which events were reported, based on IP address. |
| geo.metro | STRING | The metro from which events were reported, based on IP address. |
| geo.city | STRING | The city from which events were reported, based on IP address. | 

### app_info

The app_info RECORD contains information about the app in which the event was initiated. | Field name | Data type | Description |
|---|---|---|
| app_info.id | STRING | The package name or bundle ID of the app. |
| app_info.firebase_app_id | STRING | The Firebase App ID associated with the app |
| app_info.install_source | STRING | The store that installed the app. |
| app_info.version | STRING | The app's versionName (Android) or short bundle version. | 

### collected_traffic_source

The collected_traffic_source RECORD contains the traffic source data that was collected with the event.

| Field name | Data type | Description |
|---|---|---|
| manual_campaign_id | STRING | The manual campaign id (utm_id) that was collected with the event. |
| manual_campaign_name | STRING | The manual campaign name (utm_campaign) that was collected with the event. |
| manual_source | STRING | The manual campaign source (utm_source) that was collected with the event. Also includes parsed parameters from referral params, not just UTM values. |
| manual_medium | STRING | The manual campaign medium (utm_medium) that was collected with the event. Also includes parsed parameters from referral params, not just UTM values. |
| manual_term | STRING | The manual campaign keyword/term (utm_term) that was collected with the event. |
| manual_content | STRING | The additional manual campaign metadata (utm_content) that was collected with the event. |
| manual_creative_format | STRING | The manual campaign creative format (utm_creative_format) that was collected with the event. |
| manual_marketing_tactic | STRING | The manual campaign marketing tactic (utm_marketing_tactic) that was collected with the event. |
| manual_source_platform | STRING | The manual campaign source platform (utm_source_platform) that was collected with the event. |
| gclid | STRING | The Google click identifier that was collected with the event. |
| dclid | STRING | The DoubleClick Click Identifier for Display and Video 360 and Campaign Manager 360 that was collected with the event. |
| srsltid | STRING | The Google Merchant Center identifier that was collected with the event. | 

### session_traffic_source_last_click

The session_traffic_source_last_click RECORD contains the last-click attributed session traffic source data across Google ads and manual contexts, where available.

| Field Name | Data Type | Description |
|---|---|---|
| session_traffic_source_last_click. manual_campaign.campaign_id | STRING | The ID of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.campaign_name | STRING | The name of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.medium | STRING | The medium of the last clicked manual campaign (e.g., paid search, organic search, email) |
| session_traffic_source_last_click. manual_campaign.term | STRING | The keyword/search term of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.content | STRING | Additional metadata of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.source_platform | STRING | The platform of the last clicked manual campaign (e.g., search engine, social media) |
| session_traffic_source_last_click. manual_campaign.source | STRING | The specific source within the platform of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.creative_format | STRING | The format of the creative of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.marketing_tactic | STRING | The marketing tactic of the last clicked manual campaign |
| session_traffic_source_last_click. google_ads_campaign.customer_id | STRING | The customer ID associated with the Google Ads account |
| session_traffic_source_last_click. google_ads_campaign.account_name | STRING | The name of the Google Ads account |
| session_traffic_source_last_click. google_ads_campaign.campaign_id | STRING | The ID of the Google Ads campaign |
| session_traffic_source_last_click. google_ads_campaign.campaign_name | STRING | The name of the Google Ads campaign |
| session_traffic_source_last_click. google_ads_campaign.ad_group_id | STRING | The ID of the ad group within the Google Ads campaign |
| session_traffic_source_last_click. google_ads_campaign.ad_group_name | STRING | The name of the ad group within the Google Ads campaign | 

### traffic_source

The traffic_source RECORD contains information about the traffic source that first acquired the user. This record is not populated in intraday tables. Note: The traffic_source values do not change if the user interacts with subsequent campaigns after installation.

| Field name | Data type | Description |
|---|---|---|
| traffic_source.name | STRING | Name of the marketing campaign that first acquired the user. This field is not populated in intraday tables. |
| traffic_source.medium | STRING | Name of the medium (paid search, organic search, email, etc.) that first acquired the user. This field is not populated in intraday tables. |
| traffic_source.source | STRING | Name of the network that first acquired the user. This field is not populated in intraday tables. | 

### stream and platform

The stream and platform fields contain information about the stream and the app platform.

| Field name | Data type | Description |
|---|---|---|
| stream_id | STRING | The numeric ID of the data stream from which the event originated. |
| platform | STRING | The data stream platform (Web, IOS or Android) from which the event originated. | 

### ecommerce

This ecommerce RECORD contains information about any ecommerce events that have been setup on a website or app.

| Field name | Data type | Description |
|---|---|---|
| ecommerce.total_item_quantity | INTEGER | Total number of items in this event, which is the sum of items.quantity. |
| ecommerce.purchase_revenue_in_usd | FLOAT | Purchase revenue of this event, represented in USD with standard unit. Populated for purchase event only. |
| ecommerce.purchase_revenue | FLOAT | Purchase revenue of this event, represented in local currency with standard unit. Populated for purchase event only. |
| ecommerce.refund_value_in_usd | FLOAT | The amount of refund in this event, represented in USD with standard unit. Populated for refund event only. |
| ecommerce.refund_value | FLOAT | The amount of refund in this event, represented in local currency with standard unit. Populated for refund event only. |
| ecommerce.shipping_value_in_usd | FLOAT | The shipping cost in this event, represented in USD with standard unit. |
| ecommerce.shipping_value | FLOAT | The shipping cost in this event, represented in local currency. |
| ecommerce.tax_value_in_usd | FLOAT | The tax value in this event, represented in USD with standard unit. |
| ecommerce.tax_value | FLOAT | The tax value in this event, represented in local currency with standard unit. |
| ecommerce.transaction_id | STRING | The transaction ID of the ecommerce transaction. |
| ecommerce.unique_items | INTEGER | The number of unique items in this event, based on item_id, item_name, and item_brand. | 

### items

The items RECORD contains information about items included in an event. It is repeated for each item.

| Field name | Data type | Description |
|---|---|---|
| items.item_id | STRING | The ID of the item. |
| items.item_name | STRING | The name of the item. |
| items.item_brand | STRING | The brand of the item. |
| items.item_variant | STRING | The variant of the item. |
| items.item_category | STRING | The category of the item. |
| items.item_category2 | STRING | The sub category of the item. |
| items.item_category3 | STRING | The sub category of the item. |
| items.item_category4 | STRING | The sub category of the item. |
| items.item_category5 | STRING | The sub category of the item. |
| items.price_in_usd | FLOAT | The price of the item, in USD with standard unit. |
| items.price | FLOAT | The price of the item in local currency. |
| items.quantity | INTEGER | The quantity of the item. Quantity set to 1 if not specified. |
| items.item_revenue_in_usd | FLOAT | The revenue of this item, calculated as price_in_usd * quantity. It is populated for purchase events only, in USD with standard unit. |
| items.item_revenue | FLOAT | The revenue of this item, calculated as price * quantity. It is populated for purchase events only, in local currency with standard unit. |
| items.item_refund_in_usd | FLOAT | The refund value of this item, calculated as price_in_usd * quantity. It is populated for refund events only, in USD with standard unit. |
| items.item_refund | FLOAT | The refund value of this item, calculated as price * quantity. It is populated for refund events only, in local currency with standard unit. |
| items.coupon | STRING | Coupon code applied to this item. |
| items.affiliation | STRING | A product affiliation to designate a supplying company or brick and mortar store location. |
| items.location_id | STRING | The location associated with the item. |
| items.item_list_id | STRING | The ID of the list in which the item was presented to the user. |
| items.item_list_name | STRING | The name of the list in which the item was presented to the user. |
| Items.item_list_index | STRING | The position of the item in a list. |
| items.promotion_id | STRING | The ID of a product promotion. |
| items.promotion_name | STRING | The name of a product promotion. |
| items.creative_name | STRING | The name of a creative used in a promotional spot. |
| items.creative_slot | STRING | The name of a creative slot. |

#### item_params RECORD

The item_params RECORD stores the custom item parameters that you defined. Note that predefined item parameters like item_id, item_name etc, are not included here, instead they are exported as explicit fields. The set of parameters stored in the item_params RECORD is unique to each implementation. To learn more about ecommerce implementations and the Google Analytics 4 items array, see Measure ecommerce .

| Field name | Data type | Description |
|---|---|---|
| items.item_params.key | STRING | The name of the item parameter. |
| items.item_params.value | RECORD | A record containing the item parameterâ€™s value. |
| items.item_params.value.string_value | STRING | If the item parameter is represented by a string, it is populated in this field. |
| items.item_params.value.int_value | INTEGER | If the item parameter is represented by an integer, it is populated in this field. |
| items.item_params.value.double_value | FLOAT | If the item parameter is represented by a double value, it is populated in this field. |
| items.item_params.value.float_value | FLOAT | If the item parameter is represented by a floating point value, it is populated in this field. | 

## Rows

Data for a single event may be represented in one or multiple rows, depending on whether it contains repeated RECORDS. A `page_view` event with multiple
`[event_params](https://support.google.com/analytics/answer/7029846?hl=en&ref_topic=9359001&sjid=16041154979191290935-EU#event_params)`,
for example, would look similar to the following table. The initial row contains the event name, date, timestamp and other non-repeated data items. The
`[event_params](https://support.google.com/analytics/answer/7029846?hl=en&ref_topic=9359001&sjid=16041154979191290935-EU#event_params)`
RECORD is repeated for each parameter associated with the event. These repeated RECORDS are populated in subsequent rows directly under the initial event row.

| event_date | event_timestamp | event_name | event_params.key | event_params_value.string_value |
|---|---|---|---|---|
| 20220222 | 1643673600483790 | page_view | page_location | https://example.com |
| - | - | - | page_title | Home |
| - | - | - | medium | referral |
| - | - | - | source | google |
| - | - | - | page_referrer | https://www.google.com |
| - | - | - | parameters... | values... |
The table structure information is ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'ga4_obfuscated_sample_ecommerce': ['events_20201101', 'events_20201102', 'events_20201103', 'events_20201104', 'events_20201105', 'events_20201106', 'events_20201107', 'events_20201108', 'events_20201109', 'events_20201110', 'events_20201111', 'events_20201112', 'events_20201113', 'events_20201114', 'events_20201115', 'events_20201116', 'events_20201117', 'events_20201118', 'events_20201119', 'events_20201120', 'events_20201121', 'events_20201122', 'events_20201123', 'events_20201124', 'events_20201125', 'events_20201126', 'events_20201127', 'events_20201128', 'events_20201129', 'events_20201130', 'events_20201201', 'events_20201202', 'events_20201203', 'events_20201204', 'events_20201205', 'events_20201206', 'events_20201207', 'events_20201208', 'events_20201209', 'events_20201210', 'events_20201211', 'events_20201212', 'events_20201213', 'events_20201214', 'events_20201215', 'events_20201216', 'events_20201217', 'events_20201218', 'events_20201219', 'events_20201220', 'events_20201221', 'events_20201222', 'events_20201223', 'events_20201224', 'events_20201225', 'events_20201226', 'events_20201227', 'events_20201228', 'events_20201229', 'events_20201230', 'events_20201231', 'events_20210101', 'events_20210102', 'events_20210103', 'events_20210104', 'events_20210105', 'events_20210106', 'events_20210107', 'events_20210108', 'events_20210109', 'events_20210110', 'events_20210111', 'events_20210112', 'events_20210113', 'events_20210114', 'events_20210115', 'events_20210116', 'events_20210117', 'events_20210118', 'events_20210119', 'events_20210120', 'events_20210121', 'events_20210122', 'events_20210123', 'events_20210124', 'events_20210125', 'events_20210126', 'events_20210127', 'events_20210128', 'events_20210129', 'events_20210130', 'events_20210131']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Tables:**
  - All tables named `events_YYYYMMDD` between **January 1, 2021** and **January 7, 2021**:
    - `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
    - `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210102`
    - `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210103`
    - `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210104`
    - `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210105`
    - `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210106`
    - `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210107`

- **Columns:**
  - `event_date`: Used to filter events by specific dates.
  - `user_pseudo_id`: Used to identify unique pseudo users.
  - `event_name`: Potentially used to explore user activities (if necessary).

**Potential Usage of Columns:**

- **`event_date`**: Filter events within specified date ranges.
- **`user_pseudo_id`**: Identify and count unique users.
- **`event_name`**: Analyze specific user events (e.g., 'purchase').

**Conditions That May Be Used:**

- Filter `event_date` between '20210101' and '20210107'.
- Use `_TABLE_SUFFIX` to query multiple date-specific tables.
- Group or filter by `user_pseudo_id` to analyze user activity.

---

**Sample SQL Queries:**

1. **List distinct event dates within the dataset:**

   ```sql
   SELECT DISTINCT `event_date`
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210107'
   LIMIT 1000;
   ```

2. **Count total events per day between January 1 and January 7, 2021:**

   ```sql
   SELECT `event_date`, COUNT(*) AS total_events
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210107'
   GROUP BY `event_date`
   ORDER BY `event_date`
   LIMIT 1000;
   ```

3. **Retrieve unique pseudo users active on January 1, 2021:**

   ```sql
   SELECT DISTINCT `user_pseudo_id`
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
   LIMIT 1000;
   ```

4. **Count the number of unique pseudo users each day:**

   ```sql
   SELECT `event_date`, COUNT(DISTINCT `user_pseudo_id`) AS user_count
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210107'
   GROUP BY `event_date`
   ORDER BY `event_date`
   LIMIT 1000;
   ```

5. **Find the top 10 event names by frequency between January 1 and January 7, 2021:**

   ```sql
   SELECT `event_name`, COUNT(*) AS event_count
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210107'
   GROUP BY `event_name`
   ORDER BY event_count DESC
   LIMIT 10;
   ```

6. **List events along with user IDs on January 2, 2021:**

   ```sql
   SELECT `user_pseudo_id`, `event_name`, `event_timestamp`
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210102`
   LIMIT 1000;
   ```

7. **Identify users who performed a 'purchase' event between January 1 and January 7, 2021:**

   ```sql
   SELECT DISTINCT `user_pseudo_id`
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE `event_name` = 'purchase'
     AND _TABLE_SUFFIX BETWEEN '20210101' AND '20210107'
   LIMIT 1000;
   ```

8. **Get the count of events per user on January 3, 2021:**

   ```sql
   SELECT `user_pseudo_id`, COUNT(*) AS event_count
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210103`
   GROUP BY `user_pseudo_id`
   ORDER BY event_count DESC
   LIMIT 1000;
   ```

9. **List the event names and counts for January 4, 2021:**

   ```sql
   SELECT `event_name`, COUNT(*) AS event_count
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210104`
   GROUP BY `event_name`
   ORDER BY event_count DESC
   LIMIT 1000;
   ```

10. **Retrieve user IDs and their event dates for users active between January 1 and January 5, 2021:**

    ```sql
    SELECT DISTINCT `user_pseudo_id`, `event_date`
    FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
    WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210105'
    LIMIT 1000;
    ```

These queries help to:

- Understand the distribution of events over the specified dates.
- Identify unique users and their activity patterns.
- Analyze popular event types and user engagement.
- Prepare for calculating the number of users active in certain date ranges.

By running these queries, one can gain insights into the data structure and content, which is essential before performing more complex analyses related to the task.Query:
SELECT DISTINCT `event_date`
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210107'
   LIMIT 1000;
Answer:
event_date
20210103
20210105
20210102
20210104
20210101
20210106
20210107
Query:
SELECT `event_date`, COUNT(*) AS total_events
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210107'
   GROUP BY `event_date`
   ORDER BY `event_date`
   LIMIT 1000;
Answer:
event_date,total_events
20210101,22096
20210102,23599
20210103,24743
20210104,31395
20210105,42827
20210106,56076
20210107,44473
Query:
SELECT DISTINCT `user_pseudo_id`
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
   LIMIT 1000;
Answer:
Too long, hard cut:
user_pseudo_id
1003046.9452926974
1023282.4639847710
1026043.4481623879
1026409.1551860912
1032138.1796039159
1037928.9294661675
1045950.7099606829
1051288.9523352374
1054372.6755770068
1064574.6224708641
1066655.6240997015
1080064.0071613184
1082746.7285674512
1097358.9593491100
1104313.9641823605
1107198.5152483918
1112823.8475775772
1116587.1725520171
1127824.3503063268
1134825.6533092350
1138692.0103796281
1160488.2375923167
1164648.0319944302
1168297.2853699605
1170405.4925804370
1174066.6437027818
1178889.6850461952
1188134.8498680538
1205590.2516186397
1211099.8247563235
1213932.4846099850
1215465.1474478000
1218586.5350251990
1240786.8917310160
1246063.3665874179
1255322.2973246181
1259302.9069938124
1269423.6724500672
1275797.1936238018
1277765.6068129494
1296701.2382814729
1308776.9803994658
1318624.9067804638
1320187.6719997668
1326289.2331853598
1333091.0887566663
1352892.5937639189
1375005.2583322863
1382535.7283137323
1385112.5897617274
1396456.6482506733
1401649.9529464111
1422161.0871788362
1437260.5988606411
1448835.0934102497
1453555.6810069410
1453951.1387928223
1456890.1673716823
1459436.8826692932
1473136.1149103090
1485472.4390061373
1499810.5142637849
1501018.3808301483
1503421.5168556763
1515646.3111272928
1518831.1475327211
1519124.8641457524
1534689.9343310805
1539940.5253610440
1543004.7243225422
1550901.3980286554
1564015.6880680172
1575061.4789497906
1582390.8206269591
1616136.8949543878
1619900.3195973863
1620024.8966870933
1646722.0078157231
1674937.2501954408
1677450.9117017807
1680043.1145812114
1684301.4109152707
1688147.2939632391
1693134.9790437518
1694910.7733232660
1699037.5870634483
1707918.4797422153
1713530.3382800695
1719564.6333875501
1729803.5105688857
1734528.1974041204
1745072.0004799132
1745171.2191701968
1749246.8534368616
1759212.2216007988
1762263.6990880514
1765594.3047173009
1784794.0627143380
1804199.2014328535
1820733.6464417466
1829763.3860332334
1846974.0316175078
1859470.4546513665
1884090.9722372635
1886250.8920156183
1912537.7440240268
1958116.3750166429
1958256.0896241884
1961265.4757052307
1967725.7354072666
1990491.3893000361
1993768.0582544668
1999213.1832096854
2007362.2149327588
2007867.8957787066
2019465.0056495205
2029664.5317923957
2041235.3400307589
2044855.8624761839
2077981.6202330137
2084772.9471491241
2091407.8804833129
2102395.6721696580
2142722.9676010623
2150276.2168438227
2157133.5876722467
2159725.7481437355
2165252.0147518395
2167343.6164963557
2168528.2202958861
2194957.7885097322
2228172.7936687802
2244553.9738621373
2245992.8909040661
2247846.3358362547
2263288.5212004372
2264573.5209212671
2268837.3082004933
2272023.1096248377
2275476.3701234224
2290904.3176780756
2304235.4728947355
2311908.3797713386
2322051.0966144624
2327547.5435328629
2329161.7120010083
2340587.9439563847
2344300.8375944627
2362829.7919429820
2375215.3636092839
2376646.7974930863
2378480.6534474606
2382451.4611706340
2384902.1644296925
2411763.0850272555
2417078.3361324500
2432374.8482039518
2437853.8047077377
2438148.3441039719
2463849.3270043637
2484010.5620979211
2485922.5515109543
2486846.9299481244
2489685.1683265365
2492721.1881800375
2501661.0331987453
2506075.7314444580
2539661.0024435471
2560700.2802998477
2563982.7084295364
2578870.7901059159
2589245.5979068367
2599362.6005762632
2613632.7561400432
2627874.7977372146
2630765.5704087315
2648480.7456264429
2655279.4923479690
2681967.7844689964
2683925.9434937492
2687473.9692412289
2688110.9777730450
2691270.4995570828
2692657.2939750667
2694084.5852510731
2709449.6736747839
2712864.2294346749
2719657.8629194725
2739425.0432989823
2746195.3557509904
2748139.1358063966
2754697.4847843626
2755973.1582682668
2767600.1190297171
2776706.0228802998
2779137.7674526641
2781408.6267522276
2783014.3813479767
2795133.4288865632
2795240.3198638943
2796100.1284437751
2803851.7451929280
2810822.2085903402
2821509.2290888995
2838667.1045753224
2839647.6325562515
2842598.5931018472
2844832.0483599899
2849086.2703560041
2856545.1057637132
2873742.8991614203
2882177.0250975565
2885429.0157235569
2892944.4318946076
2893808.1269182675
2908071.3197159392
2910024.9071648144
2912682.3106786643
2913205.0530257308
2914301.0348640426
2916336.4829526738
2917194.9600461127
2917834.9881423689
2938826.3390148112
2952066.5004557428
2965622.6326568063
2973917.2072647263
2979122.8002670631
3001110.3208062401
3007601.9537396348
3017509.1296773380
3022409.8765357635
3024189.6101670146
3027107.9482352721
3028781.2091495833
3038064.1337656016
3053669.9263927930
3055314.8442482614
3058967.2730251282
3059739.3349984598
3067110.2430706696
3071174.0445612133
3071789.9352232891
3080224.3554853323
3080530.8466730500
3084839.1075146820
3085295.3644476516
3092109.1666656387
3134983.8555001541
3149868.5539413842
3158627.0434170250
3160960.1631301259
3168155.2539701733
3186081.3790394525
3193679.0282666132
3195953.1676635966
3203474.4486080556
3205524.3451816980
3213363.3651446553
3215534.5876119688
3218982.5426906645
3234944.4290037633
3237903
Query:
SELECT `event_date`, COUNT(DISTINCT `user_pseudo_id`) AS user_count
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210107'
   GROUP BY `event_date`
   ORDER BY `event_date`
   LIMIT 1000;
Answer:
event_date,user_count
20210101,2160
20210102,2581
20210103,2579
20210104,3079
20210105,4101
20210106,5486
20210107,4171
Query:
SELECT `event_name`, COUNT(*) AS event_count
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210107'
   GROUP BY `event_name`
   ORDER BY event_count DESC
   LIMIT 10;
Answer:
event_name,event_count
page_view,85636
user_engagement,49952
session_start,26037
scroll,25420
first_visit,20798
view_item,15143
view_promotion,12396
add_to_cart,3012
select_item,1897
begin_checkout,1617
Query:
SELECT `user_pseudo_id`, `event_name`, `event_timestamp`
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210102`
   LIMIT 1000;
Answer:
Too long, hard cut:
user_pseudo_id,event_name,event_timestamp
1005484.1092567297,page_view,1609568188059459
1005484.1092567297,user_engagement,1609568195189041
1005484.1092567297,first_visit,1609568182969088
1005484.1092567297,page_view,1609568182969088
1005484.1092567297,session_start,1609568182969088
1019468.5334749980,page_view,1609588434999615
1019468.5334749980,session_start,1609589361129199
1019468.5334749980,page_view,1609588439992531
1019468.5334749980,session_start,1609588434999615
1019468.5334749980,first_visit,1609588434999615
1019468.5334749980,page_view,1609589361129199
1020695.6921096883,first_visit,1609582561969864
1020695.6921096883,page_view,1609582561969864
1020695.6921096883,session_start,1609582561969864
1020695.6921096883,user_engagement,1609582567665689
1020695.6921096883,page_view,1609582566985060
1034552.3956022963,page_view,1609600008394960
1034552.3956022963,first_visit,1609600008394960
1034552.3956022963,session_start,1609600008394960
1034552.3956022963,user_engagement,1609600115528646
1034552.3956022963,page_view,1609600013170398
1034552.3956022963,scroll,1609600013170398
1035433.9962487028,user_engagement,1609615947579987
1035433.9962487028,session_start,1609615938390610
1035433.9962487028,page_view,1609615938390610
1035433.9962487028,first_visit,1609615938390610
1035433.9962487028,page_view,1609615943253258
1054184.5156674867,page_view,1609619392891496
1054184.5156674867,session_start,1609619392891496
1054184.5156674867,first_visit,1609619392891496
1055969.5872512303,user_engagement,1609618475007287
1055969.5872512303,add_payment_info,1609553535013124
1055969.5872512303,session_start,1609618457635123
1055969.5872512303,page_view,1609553423965493
1055969.5872512303,page_view,1609553595416019
1055969.5872512303,user_engagement,1609553503099841
1055969.5872512303,scroll,1609618457635123
1055969.5872512303,page_view,1609618487976798
1055969.5872512303,user_engagement,1609618492581039
1055969.5872512303,view_promotion,1609553451853983
1055969.5872512303,page_view,1609553489098090
1055969.5872512303,scroll,1609618647684880
1055969.5872512303,session_start,1609553371057472
1055969.5872512303,page_view,1609618533869139
1055969.5872512303,add_payment_info,1609618533869139
1055969.5872512303,page_view,1609618498133132
1055969.5872512303,scroll,1609553503099841
1055969.5872512303,user_engagement,1609618468733263
1055969.5872512303,scroll,1609618598191779
1055969.5872512303,view_promotion,1609618480578051
1055969.5872512303,page_view,1609553473778370
1055969.5872512303,page_view,1609618639077394
1055969.5872512303,page_view,1609553371057472
1055969.5872512303,user_engagement,1609553589519202
1055969.5872512303,user_engagement,1609553529540762
1055969.5872512303,user_engagement,1609618498133132
1055969.5872512303,page_view,1609618480578051
1055969.5872512303,user_engagement,1609618481765702
1055969.5872512303,page_view,1609553376051937
1055969.5872512303,page_view,1609618475007287
1055969.5872512303,page_view,1609618508299834
1055969.5872512303,user_engagement,1609553446310467
1055969.5872512303,scroll,1609553488424949
1055969.5872512303,page_view,1609553446310467
1055969.5872512303,scroll,1609553446310467
1055969.5872512303,user_engagement,1609618528344692
1055969.5872512303,page_view,1609553535013124
1055969.5872512303,scroll,1609553649667731
1055969.5872512303,add_shipping_info,1609553473778370
1055969.5872512303,page_view,1609553462109417
1055969.5872512303,scroll,1609553529540762
1055969.5872512303,add_shipping_info,1609553489098090
1055969.5872512303,user_engagement,1609553381199223
1055969.5872512303,page_view,1609553387537738
1055969.5872512303,scroll,1609618475007287
1055969.5872512303,scroll,1609618507691027
1055969.5872512303,user_engagement,1609553456599186
1055969.5872512303,page_view,1609553649667731
1055969.5872512303,page_view,1609618503628150
1055969.5872512303,scroll,1609553541502831
1055969.5872512303,page_view,1609553503652567
1055969.5872512303,page_view,1609553607877330
1055969.5872512303,first_visit,1609553371057472
1055969.5872512303,user_engagement,1609553439445737
1055969.5872512303,user_engagement,1609553405674382
1055969.5872512303,user_engagement,1609553418058528
1055969.5872512303,user_engagement,1609553602255295
1055969.5872512303,add_shipping_info,1609618508299834
1055969.5872512303,add_shipping_info,1609553503652567
1055969.5872512303,scroll,1609553423965493
1055969.5872512303,scroll,1609553418058528
1055969.5872512303,user_engagement,1609553649667731
1055969.5872512303,user_engagement,1609553488424949
1055969.5872512303,scroll,1609553472743540
1055969.5872512303,user_engagement,1609553472743540
1055969.5872512303,page_view,1609553411650074
1055969.5872512303,page_view,1609553451853983
1055969.5872512303,user_engagement,1609618599066319
1104189.1961360907,scroll,1609615417977775
1104189.1961360907,page_view,1609615382420520
1104189.1961360907,user_engagement,1609615392825942
1104189.1961360907,session_start,1609615382420520
1104189.1961360907,user_engagement,1609615428650639
11
Query:
SELECT DISTINCT `user_pseudo_id`
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
   WHERE `event_name` = 'purchase'
     AND _TABLE_SUFFIX BETWEEN '20210101' AND '20210107'
   LIMIT 1000;
Answer:
user_pseudo_id
2459937.2318206302
2637438.5895621403
2838161.4781702653
3056927.8375951035
3593045.4474754034
4181862.5710073931
5155655.8559554783
5963534.4700679023
6115983.2241878817
9220684.1553390889
19492128.7016911946
24377658.7213551870
28988900.6959315645
32591508.2385963314
39214432.1935349913
45529743.2756914140
74972717.1202590271
84389355.3658704825
84496993.3019099787
87431455.4720611025
6282998.3933758831
52461093.3056333183
73370809.3757379160
7312667.0266395141
41803452.7850037461
25712283.2548580985
61389953.5535318141
3048586.2373315420
5257023.2131424569
7634450.7489916014
7828968.5532093675
17494077.2658372366
22300841.9909876299
33280841.1628915296
47439165.5147551041
49456942.0436829148
2885429.0157235569
8894775.5253595050
62524109.3161787418
18161607.9002799024
24207018.3974015161
3351786.5083077372
40650638.8176789956
87047667.1042912591
68546038.8820428933
6101467.4740745406
15817556.8554808751
50844046.9564028621
53104811.8176614311
2783014.3813479767
3354006.4211651279
53550354.6354713181
1160488.2375923167
6097102.6516338254
68780200.6423809280
71568861.8035326636
72959035.2192369480
74650484.1255761858
6283343.2195449706
77327261.9614153178
78207562.9231433824
6363623135.4270133281
1158637.0383647084
46574324.9683380755
59643921.1694992453
44810382.7311730027
59487571.9263599382
88827381.9303945281
75571709.1157982540
1055969.5872512303
3024189.6101670146
7296845.4997447007
42807215.0722008548
43382307.1290802082
51954044.7234105463
77052125.0799530822
22857919.0356368006
25040095.0670087088
80435974.9462183494
40569893.9835575904
78839661.7033676134
84647660.6681637188
85305313.7561330759
2387737.8440654529
2605468.7128696165
3434475.4232528961
3949544.2182643123
7678145.6418665978
8676958.1154553142
12509391.0991562676
24390067.7154104169
68281659.9581386964
70825378.7231985352
86272927.5845958008
7946294.3682774932
20754226.2589569130
45421650.6526651864
83310359.0821475252
1873577.7239946701
19646880.6083875642
20631378.7981176516
38538077.3398709669
79944589.6932026672
88839956.1260646312
3287379.7416476309
3953783.0019328064
40387173.9002245801
57065333.7001768225
4211935.8810857498
3591907.4452081930
48482961.7353796273
6510522.7061313662
7742237.5794101746
10269098.5703813861
11677998.3685150844
31450884.9129417592
52669317.3821594758
56460399.1194105799
60952845.2415737283
77996608.4384679865
86953811.9568548667
90945046.7404900107
3517925.3227970426
5502422.3790987476
7687394.8608023492
9158325.4927360836
53406211.8724008214
71510217.3315206080
75336556.8734149504
4115432.9849138741
2265878.0595059594
29625533.6319169088
26105678.1036002654
58749509.5865067460
40957384.9471332754
2924215.0352437879
Query:
SELECT `user_pseudo_id`, COUNT(*) AS event_count
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210103`
   GROUP BY `user_pseudo_id`
   ORDER BY event_count DESC
   LIMIT 1000;
Answer:
Too long, hard cut:
user_pseudo_id,event_count
91675873.1352298917,388
10273164.5274553015,252
2885429.0157235569,234
68044587.8089465417,219
75571709.1157982540,192
5237743.2231683146,171
5712577.1182625340,167
24207018.3974015161,151
49426200.6314888908,134
78035137.0930503727,132
2038619.5845722539,125
70950266.4644317151,125
8741663.0518466186,120
7801689.0887224805,118
81559713.4631632468,117
6919080.3395786156,116
18161607.9002799024,116
3377339.5089753849,108
72525244.4757615854,106
85270287.8384530924,103
17494077.2658372366,102
20246616.8208729043,100
33280841.1628915296,99
3068634.6383481729,96
5765850.5948282569,95
7634450.7489916014,94
5971756.6682080637,94
6902555.6331797931,93
3593045.4474754034,92
2051660.3699709133,91
3048586.2373315420,89
3176404.4484412596,83
77327261.9614153178,76
49687999.1512301268,74
8289129.8211850061,71
8767768.5249017704,70
1493438.1834934820,70
48996419.4822821424,69
51278290.7724873670,68
8447373.0647826021,64
5492322788.7993357688,62
77385826.9962322494,61
7828968.5532093675,61
4583633111.4441762602,61
1979778.7331964605,60
62524109.3161787418,59
4584127.7203106647,59
36787079.8360448300,57
49456942.0436829148,57
8035696.1597387031,56
22300841.9909876299,55
6215048824.9659347018,54
65444107.8891276284,52
57746264.2440229048,51
64489888.5963828123,49
1492257.1138270046,48
53219536.1306282888,47
23138045.8449397571,47
8043621000.0220376456,46
88618114.6262085960,46
13413255.3939422273,45
4024190.3037653934,45
85290326.1742411983,44
7249551.6994075107,44
24443302.7659648569,43
8268471.0318384786,42
5257023.2131424569,42
90544926.0090701684,41
5687566.9810985467,41
32237894.7864730961,40
39049984.4198737878,39
9055634.6267700710,39
7160282.2417661246,39
48038218.3483866311,39
62258045.1747483641,38
47439165.5147551041,38
8894775.5253595050,37
79549234.2757633747,37
76784344.9112069115,35
30199603.5476237961,35
90295329.1271275379,35
2116278.5223204033,35
4451648.2986259133,34
3169195.7953388839,34
53860668.4757240899,34
5372253.4952715876,33
80159360.0979608390,33
88103904.7206552805,33
42717702.5461417546,33
66003152.6293590689,33
2328501657.2288090835,32
12796516.5743787947,32
3141277.0508009875,31
26220566.4678929051,31
4767726.9459482026,31
55686004.5190812643,30
98232650.3130769873,30
20394489.5566163330,29
23068457.7257052922,29
11321750.4742481705,29
42745051.8561886464,29
82790709.8741341477,29
25732325.7552101776,29
36135644.5721773322,29
19522194.3549446028,28
65058390.2787133295,28
43038329.0110993604,28
5332798.0334344774,28
30829821.6679425848,28
4777033.3943263498,28
38570160.2085473490,28
8183328.2038616516,28
61219218.7470481597,27
72560733.3437175307,27
4282416.7702392320,27
2989628.1463094396,27
6564799.9806825282,27
4127932.2190096724,26
5446935.0197277151,26
4819501.9483311114,26
51411443.9641714186,26
8960311.5644298530,26
5380693.1792584257,26
81460639.7679824956,26
5655735.7344284207,26
2553007.7989629504,25
64347064.3624433445,25
5346566.7251055228,25
11280285.6383562292,25
4980906.4887239358,25
22607982.7488826864,24
41252441.2354001560,24
8174001983.9035637635,24
95189736.5495320837,24
21787646.5950635572,24
22936048.1739497236,24
4489911.8248370010,24
33090559.1816854682,24
2039126.6383271583,23
86558317.1569669840,23
58751681.2860417490,23
4739295590.7137248905,23
5998832.1586803243,23
57489984.6489263708,23
91434315.3023859379,23
7738064.2633838278,23
47081559.1128986750,23
80259763.7226425588,23
83326933.7910380809,23
24652691.4955716686,23
12480877.1430029860,23
61836244.6153531118,23
29057959.6356005819,23
9115804.5909348436,23
29713270.9410751405,22
18918149.1966617530,22
24863109.6664550316,22
1676361.4249094214,22
4726379.3054653332,22
5579052.7307247809,22
14185921.8189064703,22
41750986.1235645474,22
2293260.7167260153,21
30863773.5872051762,21
60045735.9557612554,21
2051970101.9896106067,21
52050011.9038477112,21
6160571.7476726734,21
31588757.8825339636,21
80968856.1639925205,21
56275760.5320229166,21
28715478.3435707109,21
47985850.2911505398,21
4346454396.3932670436,20
3997259.2454147367,20
66037589.4192813712,20
5297219.0797104074,20
2477865562.8187386007,20
71175566.4374785888,20
8707100.5363547431,20
67183545.8916694663,20
6867779.6634381231,20
90517444.7336534522,20
44820732.9335740187,19
72277620.8350109221,19
1005317.0661766703,19
80808783.1089327810,19
83963310.9742826141,19
17778688.4962113680,19
2437168.2728482016,19
75336974.2076317636,19
9221768.6384592497,19
55210897.1970839104,19
7060799.6799023627,19
11414424.2086200067,18
6122284.2931453103,18
26355291.5224113375,18
9009731.0701454454,18
59513729.2877493835,18
43972587.9232451419,18
5101958.0754736254,18
14280112.1198939292,18
2345345.3780200574,18
10710587.2295536666,18
87080412.0399273960,18
23815881.7988103213,18
43845399.2620818316,18
5495827.3045253647,18
31452097.9029539265,18
8952897.5607478621,18
41939620.1033607756,18
8557210.6454347431,18
50095174.0437668583,17
26521546.0674230641,17
1162127.7258009994,17
18141360.4093124213,17
29107353.9472204559,17
5767091.1699699062,17
Query:
SELECT `event_name`, COUNT(*) AS event_count
   FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210104`
   GROUP BY `event_name`
   ORDER BY event_count DESC
   LIMIT 1000;
Answer:
event_name,event_count
page_view,11010
user_engagement,6502
scroll,3439
session_start,3319
first_visit,2620
view_item,1983
view_promotion,1265
add_to_cart,396
view_search_results,259
select_item,217
begin_checkout,183
select_promotion,72
add_shipping_info,61
add_payment_info,50
purchase,16
click,3
Query:
SELECT DISTINCT `user_pseudo_id`, `event_date`
    FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
    WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210105'
    LIMIT 1000;
Answer:
Too long, hard cut:
user_pseudo_id,event_date
1005484.1092567297,20210102
1019468.5334749980,20210102
1020695.6921096883,20210102
1034552.3956022963,20210102
1035433.9962487028,20210102
1054184.5156674867,20210102
1055969.5872512303,20210102
1104189.1961360907,20210102
1127197.7845904071,20210102
1134613.7634894426,20210102
1137060.9310088729,20210102
1140798.4477437179,20210102
1160488.2375923167,20210102
1161350.5694934880,20210102
1164110.7921696016,20210102
1219168.5485233162,20210102
1239682.4582755521,20210102
1246097.1442578537,20210102
1250553.7197007147,20210102
1253534.6863073074,20210102
1254621.7726451069,20210102
1272248.3527408128,20210102
1273851.7434031787,20210102
1274599.3928448053,20210102
1278408.9014565519,20210102
1279602.6727600031,20210102
1293446.1816560362,20210102
1296701.2382814729,20210102
1299487.6744511638,20210102
1314847.4544971351,20210102
1315049.1291069189,20210102
1325116.8912286004,20210102
1334700.6047036975,20210102
1359861.1338029424,20210102
1364085.2107948688,20210102
1370461.9318815596,20210102
1380837.6952136083,20210102
1381565.5047705405,20210102
1382535.7283137323,20210102
1390300.4796021112,20210102
1392466.8272664309,20210102
1402138.5184246691,20210102
1405619.5662753913,20210102
1413270.7201714861,20210102
1440319.2684459003,20210102
1441065.6470414018,20210102
1442997.6750483462,20210102
1470601.3891204117,20210102
1482331.8123183039,20210102
1505379.6854768255,20210102
1507645.2354095566,20210102
1508520.3631208357,20210102
1524258.4980135729,20210102
1537916.6494875994,20210102
1550647.9864364390,20210102
1587120.7886409442,20210102
1587333.3490610470,20210102
1595062.2978681339,20210102
1619900.3195973863,20210102
1621047.1809785712,20210102
1650186.4171427739,20210102
1652787.4806754655,20210102
1653230.5444867771,20210102
1661549.9249699570,20210102
1664037.8368386837,20210102
1664926.0864851694,20210102
1679710.5467997846,20210102
1684439.4801767659,20210102
1688021.5951717579,20210102
1689822.6628262328,20210102
1695729.1971283274,20210102
1698322.2974178584,20210102
1699537.8074625037,20210102
1704767.6168359047,20210102
1708071.1093492535,20210102
1720808.5659233423,20210102
1721354.6818865235,20210102
1722117.4481798918,20210102
1746667.8607565392,20210102
1778028.3352091849,20210102
1788337.3157672800,20210102
1793640.9588973139,20210102
1804084.9503910975,20210102
1810164.8096235223,20210102
1821461.3337986263,20210102
1824121.5656787337,20210102
1846974.0316175078,20210102
1849787.1417367270,20210102
1862279.2644343817,20210102
1873058.4156402266,20210102
1928081.8451007978,20210102
1929880.8943789391,20210102
1941137.5727282147,20210102
1946378.2604112351,20210102
1946567.8498627659,20210102
1966814.1086113170,20210102
1977599.8253595252,20210102
1988973.6797776774,20210102
1989653.0310679976,20210102
1990491.3893000361,20210102
1997680.4430170613,20210102
2003178.1919214406,20210102
2003410.3743325553,20210102
2014468.4429759626,20210102
2017291.1955110057,20210102
2022577.6028076666,20210102
2038564.1352340774,20210102
2047359.5675604073,20210102
2047377.2903997635,20210102
2063626.9238065250,20210102
2087721.6967658602,20210102
2096059.7363835654,20210102
2100078.5164826353,20210102
2109449.9660162118,20210102
2113798.0518736192,20210102
2115313.5923151214,20210102
2116832.9143999021,20210102
2124015.0378908424,20210102
2144124.6364405235,20210102
2149555.4176497170,20210102
2152321.4561806737,20210102
2181825.8993193032,20210102
2183606.6278528627,20210102
2197705.7004821624,20210102
2198590.4966974374,20210102
2202427.5069899276,20210102
2216286.4044820257,20210102
2221930.1797585103,20210102
2225774.7364227776,20210102
2226580.8704433782,20210102
2226624.7706208292,20210102
2235087.0942165188,20210102
2240072.6562005194,20210102
2253111.9586733581,20210102
2274040.6741003102,20210102
2275111.4028372694,20210102
2284553.4981188662,20210102
2296500.5827142601,20210102
2301921.2057149746,20210102
2303142.6308475718,20210102
2314215.6504049440,20210102
2329031.6103448704,20210102
2331461.5841279593,20210102
2336526.9274069819,20210102
2343354.0238884087,20210102
2345583.2413952607,20210102
2347781.8032119000,20210102
2350448.4141410843,20210102
2353015.7664381023,20210102
2361377.9933199841,20210102
2370322.3013967089,20210102
2371746.6281118505,20210102
2380241.2215017615,20210102
2394410.3295052541,20210102
2401649.3408462953,20210102
2403131.1457037836,20210102
2404282.2391450101,20210102
2430658.1327125161,20210102
2455077.3609833583,20210102
2482206.0801635150,20210102
2483927.4346404473,20210102
2492165.4306556688,20210102
2492500.1425673190,20210102
2498852.6851889965,20210102
2500745.7357943995,20210102
2507095.9841079823,20210102
2508716.6266480416,20210102
2520337.3364032237,20210102
2525713.0322520707,20210102
2525850.6494695512,20210102
2531897.1720965032,20210102
2534054.9013465326,20210102
2536363.5033290586,20210102
2537006.1447313249,20210102
2537784.9601456696,20210102
2543713.9652701500,20210102
2566092.9507111229,20210102
2570370.5558938997
End Exploring Related Columns
Task: How many pseudo users were active in the last 7 days but inactive in the last 2 days as of January 7, 2021?

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: To determine the number of pseudo users who were active in the last 7 days but inactive in the last 2 days as of January 7, 2021, we:

1. Identified pseudo users (`user_pseudo_id`) who had events between **January 1, 2021** and **January 5, 2021**.
2. Excluded those who had any events on **January 6, 2021** or **January 7, 2021**.
3. Counted the unique pseudo users remaining.

The result is:

```csv
number_of_pseudo_users
50
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'ga4_obfuscated_sample_ecommerce': ['events_20201101', 'events_20201102', 'events_20201103', 'events_20201104', 'events_20201105', 'events_20201106', 'events_20201107', 'events_20201108', 'events_20201109', 'events_20201110', 'events_20201111', 'events_20201112', 'events_20201113', 'events_20201114', 'events_20201115', 'events_20201116', 'events_20201117', 'events_20201118', 'events_20201119', 'events_20201120', 'events_20201121', 'events_20201122', 'events_20201123', 'events_20201124', 'events_20201125', 'events_20201126', 'events_20201127', 'events_20201128', 'events_20201129', 'events_20201130', 'events_20201201', 'events_20201202', 'events_20201203', 'events_20201204', 'events_20201205', 'events_20201206', 'events_20201207', 'events_20201208', 'events_20201209', 'events_20201210', 'events_20201211', 'events_20201212', 'events_20201213', 'events_20201214', 'events_20201215', 'events_20201216', 'events_20201217', 'events_20201218', 'events_20201219', 'events_20201220', 'events_20201221', 'events_20201222', 'events_20201223', 'events_20201224', 'events_20201225', 'events_20201226', 'events_20201227', 'events_20201228', 'events_20201229', 'events_20201230', 'events_20201231', 'events_20210101', 'events_20210102', 'events_20210103', 'events_20210104', 'events_20210105', 'events_20210106', 'events_20210107', 'events_20210108', 'events_20210109', 'events_20210110', 'events_20210111', 'events_20210112', 'events_20210113', 'events_20210114', 'events_20210115', 'events_20210116', 'events_20210117', 'events_20210118', 'events_20210119', 'events_20210120', 'events_20210121', 'events_20210122', 'events_20210123', 'events_20210124', 'events_20210125', 'events_20210126', 'events_20210127', 'events_20210128', 'events_20210129', 'events_20210130', 'events_20210131']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-19 22:22:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 22:22:21 - root - INFO - To determine the number of pseudo users who were active in the last 7 days but inactive in the last 2 days as of January 7, 2021, we:

1. **Identified pseudo users (`user_pseudo_id`) who had events between January 1, 2021, and January 5, 2021.**
2. **Excluded those who had any events on January 6, 2021, or January 7, 2021.**
3. **Counted the unique pseudo users remaining.**

The SQL query is:

```sql
WITH last_7_days_users AS (
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
  UNION DISTINCT
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210102`
  UNION DISTINCT
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210103`
  UNION DISTINCT
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210104`
  UNION DISTINCT
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210105`
),
last_2_days_users AS (
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210106`
  UNION DISTINCT
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210107`
)
SELECT COUNT(*) AS number_of_pseudo_users
FROM (
  SELECT `user_pseudo_id` FROM last_7_days_users
  EXCEPT DISTINCT
  SELECT `user_pseudo_id` FROM last_2_days_users
);
```

This query performs the following steps:

- **`last_7_days_users` CTE**: Retrieves all unique `user_pseudo_id`s from events on January 1 to January 5, 2021.
- **`last_2_days_users` CTE**: Retrieves all unique `user_pseudo_id`s from events on January 6 and January 7, 2021.
- **Final SELECT**: Uses the `EXCEPT DISTINCT` operation to exclude any users who were active in the last 2 days from those who were active in the last 7 days.
- **`COUNT(*)`**: Counts the number of unique pseudo users who meet the criteria.

**Result:**

```csv
number_of_pseudo_users
```
2025-01-19 22:22:23 - root - INFO - itercount: 1
2025-01-19 22:22:23 - root - INFO - 0
2025-01-19 22:22:23 - root - INFO - results: 
number_of_pseudo_users
13442


2025-01-19 22:22:23 - root - INFO - Please check the answer again by reviewing How many pseudo users were active in the last 7 days but inactive in the last 2 days as of January 7, 2021?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To determine the number of pseudo users who were active in the last 7 days but inactive in the last 2 days as of January 7, 2021, we:

1. Identified pseudo users (`user_pseudo_id`) who had events between **January 1, 2021** and **January 5, 2021**.
2. Excluded those who had any events on **January 6, 2021** or **January 7, 2021**.
3. Counted the unique pseudo users remaining.

The result is:

```csv
number_of_pseudo_users
50
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
number_of_pseudo_users
13442
Current sql:
WITH last_7_days_users AS (
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
  UNION DISTINCT
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210102`
  UNION DISTINCT
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210103`
  UNION DISTINCT
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210104`
  UNION DISTINCT
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210105`
),
last_2_days_users AS (
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210106`
  UNION DISTINCT
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210107`
)
SELECT COUNT(*) AS number_of_pseudo_users
FROM (
  SELECT `user_pseudo_id` FROM last_7_days_users
  EXCEPT DISTINCT
  SELECT `user_pseudo_id` FROM last_2_days_users
);
2025-01-19 22:23:15 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 22:23:15 - root - INFO - To determine the number of pseudo users who were active in the last 7 days but inactive in the last 2 days as of January 7, 2021, we:

1. **Identified pseudo users (`user_pseudo_id`) who had events between January 1, 2021, and January 5, 2021.**
2. **Excluded those who had any events on January 6, 2021, or January 7, 2021.**
3. **Counted the unique pseudo users remaining.**

The result is:

```csv
number_of_pseudo_users
13442
```

The SQL query is:

```sql
WITH last_7_days_users AS (
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
  UNION DISTINCT
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210102`
  UNION DISTINCT
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210103`
  UNION DISTINCT
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210104`
  UNION DISTINCT
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210105`
),
last_2_days_users AS (
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210106`
  UNION DISTINCT
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210107`
)
SELECT COUNT(*) AS number_of_pseudo_users
FROM (
  SELECT `user_pseudo_id` FROM last_7_days_users
  EXCEPT DISTINCT
  SELECT `user_pseudo_id` FROM last_2_days_users
);
```
2025-01-19 22:23:17 - root - INFO - itercount: 2
2025-01-19 22:23:17 - root - INFO - 0
2025-01-19 22:23:17 - root - INFO - Total iteration counts: 2
