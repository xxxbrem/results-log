2025-01-19 22:20:03 - openai._base_client - INFO - Retrying request to /chat/completions in 0.489254 seconds
2025-01-19 22:21:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 22:21:23 - root - INFO - SQL:
-- 1. Get distinct user_pseudo_id from events on January 1, 2021
SELECT DISTINCT `user_pseudo_id`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
LIMIT 1000
Results:
Too long, hard cut:
user_pseudo_id
1003046.9452926974
1023282.4639847710
1026043.4481623879
1026409.1551860912
1032138.1796039159
1037928.9294661675
1045950.7099606829
1051288.9523352374
1054372.6755770068
1064574.6224708641
1066655.6240997015
1080064.0071613184
1082746.7285674512
1097358.9593491100
1104313.9641823605
1107198.5152483918
1112823.8475775772
1116587.1725520171
1127824.3503063268
1134825.6533092350
1138692.0103796281
1160488.2375923167
1164648.0319944302
1168297.2853699605
1170405.4925804370
1174066.6437027818
1178889.6850461952
1188134.8498680538
1205590.2516186397
1211099.8247563235
1213932.4846099850
1215465.1474478000
1218586.5350251990
1240786.8917310160
1246063.3665874179
1255322.2973246181
1259302.9069938124
1269423.6724500672
1275797.1936238018
1277765.6068129494
1296701.2382814729
1308776.9803994658
1318624.9067804638
1320187.6719997668
1326289.2331853598
1333091.0887566663
1352892.5937639189
1375005.2583322863
1382535.7283137323
1385112.5897617274
1396456.6482506733
1401649.9529464111
1422161.0871788362
1437260.5988606411
1448835.0934102497
1453555.6810069410
1453951.1387928223
1456890.1673716823
1459436.8826692932
1473136.1149103090
1485472.4390061373
1499810.5142637849
1501018.3808301483
1503421.5168556763
1515646.3111272928
1518831.1475327211
1519124.8641457524
1534689.9343310805
1539940.5253610440
1543004.7243225422
1550901.3980286554
1564015.6880680172
1575061.4789497906
1582390.8206269591
1616136.8949543878
1619900.3195973863
1620024.8966870933
1646722.0078157231
1674937.2501954408
1677450.9117017807
1680043.1145812114
1684301.4109152707
1688147.2939632391
1693134.9790437518
1694910.7733232660
1699037.5870634483
1707918.4797422153
1713530.3382800695
1719564.6333875501
1729803.5105688857
1734528.1974041204
1745072.0004799132
1745171.2191701968
1749246.8534368616
1759212.2216007988
1762263.6990880514
1765594.3047173009
1784794.0627143380
1804199.2014328535
1820733.6464417466
1829763.3860332334
1846974.0316175078
1859470.4546513665
1884090.9722372635
1886250.8920156183
1912537.7440240268
1958116.3750166429
1958256.0896241884
1961265.4757052307
1967725.7354072666
1990491.3893000361
1993768.0582544668
1999213.1832096854
2007362.2149327588
2007867.8957787066
2019465.0056495205
2029664.5317923957
2041235.3400307589
2044855.8624761839
2077981.6202330137
2084772.9471491241
2091407.8804833129
2102395.6721696580
2142722.9676010623
2150276.2168438227
2157133.5876722467
2159725.7481437355
2165252.0147518395
2167343.6164963557
2168528.2202958861
2194957.7885097322
2228172.7936687802
2244553.9738621373
2245992.8909040661
2247846.3358362547
2263288.5212004372
2264573.5209212671
2268837.3082004933
2272023.1096248377
2275476.3701234224
2290904.3176780756
2304235.4728947355
2311908.3797713386
2322051.0966144624
2327547.5435328629
2329161.7120010083
2340587.9439563847
2344300.8375944627
2362829.7919429820
2375215.3636092839
2376646.7974930863
2378480.6534474606
2382451.4611706340
2384902.1644296925
2411763.0850272555
2417078.3361324500
2432374.8482039518
2437853.8047077377
2438148.3441039719
2463849.3270043637
2484010.5620979211
2485922.5515109543
2486846.9299481244
2489685.1683265365
2492721.1881800375
2501661.0331987453
2506075.7314444580
2539661.0024435471
2560700.2802998477
2563982.7084295364
2578870.7901059159
2589245.5979068367
2599362.6005762632
2613632.7561400432
2627874.7977372146
2630765.5704087315
2648480.7456264429
2655279.4923479690
2681967.7844689964
2683925.9434937492
2687473.9692412289
2688110.9777730450
2691270.4995570828
2692657.2939750667
2694084.5852510731
2709449.6736747839
2712864.2294346749
2719657.8629194725
2739425.0432989823
2746195.3557509904
2748139.1358063966
2754697.4847843626
2755973.1582682668
2767600.1190297171
2776706.0228802998
2779137.7674526641
2781408.6267522276
2783014.3813479767
2795133.4288865632
2795240.3198638943
2796100.1284437751
2803851.7451929280
2810822.2085903402
2821509.2290888995
2838667.1045753224
2839647.6325562515
2842598.5931018472
2844832.0483599899
2849086.2703560041
2856545.1057637132
2873742.8991614203
2882177.0250975565
2885429.0157235569
2892944.4318946076
2893808.1269182675
2908071.3197159392
2910024.9071648144
2912682.3106786643
2913205.0530257308
2914301.0348640426
2916336.4829526738
2917194.9600461127
2917834.9881423689
2938826.3390148112
2952066.5004557428
2965622.6326568063
2973917.2072647263
2979122.8002670631
3001110.3208062401
3007601.9537396348
3017509.1296773380
3022409.8765357635
3024189.6101670146
3027107.9482352721
3028781.2091495833
3038064.1337656016
3053669.9263927930
3055314.8442482614
3058967.2730251282
3059739.3349984598
3067110.2430706696
3071174.0445612133
3071789.9352232891
3080224.3554853323
3080530.8466730500
3084839.1075146820
3085295.3644476516
3092109.1666656387
3134983.8555001541
3149868.5539413842
3158627.0434170250
3160960.1631301259
3168155.2539701733
3186081.3790394525
3193679.0282666132
3195953.1676635966
3203474.4486080556
3205524.3451816980
3213363.3651446553
3215534.5876119688
3218982.5426906645
3234944.4290037633
3237903

2025-01-19 22:21:25 - root - INFO - SQL:
-- 2. Get distinct user_pseudo_id from events between January 1 and January 5, 2021
SELECT DISTINCT `user_pseudo_id`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210105'
LIMIT 1000
Results:
Too long, hard cut:
user_pseudo_id
1008499.5928445086
1013760.9231029745
1014209.5295344253
1026137.2290719007
1028167.1226079449
1032092.5249707229
1053193.3273260382
1057066.6724870774
1057265.5844727802
1065673.0722289663
1067841.4647153954
1075223.2681702246
1081165.5314971225
1082690.0377265261
1103286.8251708796
1109836.9501901728
1113469.1950253831
1114181.7368629788
1121518.2859510925
1130810.6137694456
1134613.7634894426
1158637.0383647084
1164741.6860607634
1181674.5265741661
1185078.3105419781
1194575.2891034137
1214573.9183644653
1215389.2295507570
1222867.5284822262
1227012.8467411408
1238230.5582832258
1243221.1777211525
1252690.3944441209
1284535.4676055384
1288248.9113459714
1289319.0865612371
1297488.8153560940
1299487.6744511638
1307038.3688504236
1309149.1848587742
1312237.6155331000
1313329.6311058857
1314747.6066644573
1320284.3859724504
1325688.1519909745
1334969.6157017719
1339205.5397897099
1373324.8357357420
1385090.1246142947
1385662.1127085473
1401785.6584445113
1402228.3482241994
1403129.5580554677
1445737.4102905419
1450787.9898569840
1458803.4123039458
1466910.4554610435
1470241.3611852177
1471187.8226858001
1488009.3142808321
1493030.0825468207
1497130.5055593166
1500615.9964438412
1504953.0746977838
1509456.3177418451
1519189.6398973848
1522857.5896662267
1536105.5891820566
1544748.2905250855
1556885.1837167077
1560589.3791460585
1578948.0834575091
1586022.1800460720
1588332.2823326217
1588666.3949365829
1590652.6726149736
1590715.7165540392
1607100.0381093527
1622235.9923526878
1624884.8451928269
1629639.2044968342
1632927.1894987991
1634789.3752037441
1639296.9002795622
1648032.7331818100
1656975.3346712388
1659842.4321850950
1665661.9122532614
1668023.4150976276
1668416.2014466630
1672632.0859250572
1689794.6230455628
1690623.2302780540
1702019.9842929153
1702845.7520261284
1703253.2388947937
1707319.9934501562
1711048.6268268364
1711971.4968010332
1726993.2463217900
1730497.6226428479
1732811.6786855240
1745835.9106014489
1751599.1685077136
1754331.3157951821
1757510.5330787128
1765047.7773329261
1765130.1889939374
1770215.5966952525
1780294.0221405041
1787504.7670504282
1791921.4002592107
1795540.6156637931
1799135.7941835837
1806356.1249501454
1807394.6792147711
1808170.2762309629
1808232.5654454206
1824201.1380052029
1841613.4096590753
1842336.8436996882
1843227.1315168145
1855160.6431356491
1857518.5760998088
1859470.4546513665
1888732.5808117060
1891844.3029317015
1895574.3356492898
1901730.7277275021
1908860.5902672888
1922936.0279129669
1929434.4518118388
1930569.1007455155
1934857.9616833097
1945068.8887037343
1949104.1690663627
1950108.6469907871
1954953.0721200891
1966048.6599698958
1976029.4501496209
1979778.7331964605
1982815.8232892378
1983421.2936555498
1993697.9945930656
2002776.5976883193
2005618.5376901983
2014270.2546235318
2022577.6028076666
2049590.8596560881
2051318.3089832623
2055215.4967663939
2070480.7661066255
2079154.1476733507
2094642.2631508719
2096766.0019470232
2116278.5223204033
2121651.9176614852
2127898.5527858242
2131056.2525081023
2131509.8375213648
2147417.5961373356
2157825.0718936880
2164352.2670593278
2167317.9816236215
2172399.2091034226
2175416.5833910330
2177462.5220423724
2177957.7412962494
2192432.3542621657
2193948.2281082270
2194441.0544343537
2197864.5182472083
2200081.2420876058
2203449.4497261194
2204878.2541228096
2214606.8300190111
2245385.0615539791
2245567.3795914474
2248364.4469117960
2248754.7783173763
2250793.6313697017
2250953.6316204806
2258641.1629826733
2262724.6807963688
2263380.7170574283
2263420.2110121128
2265208.1282213045
2276075.8079921958
2277998.4131015438
2279457.7315196874
2284976.1899128869
2301413.0302404690
2303928.3507051479
2304235.4728947355
2327460.3641621424
2329707.0387773385
2331461.5841279593
2333408.5403558380
2346000.3226235037
2349749.6508625488
2374910.1217694068
2376240.8034284857
2376717.3509701603
2382234.3846802600
2382887.9214525018
2388941.9518774856
2392346.1836393196
2393556.1146578015
2399121.7379674359
2404535.1253227145
2415432.3160368774
2415788.3641983779
2415858.4972221670
2417805.0150005257
2418145.6199610855
2419732.5640450460
2422137.6877778640
2423973.9449466734
2425570.7323199738
2430886.9385533523
2438902.8824385354
2440353.3206892115
2445188.0327038206
2461015.7427876593
2465015.1494457724
2467393.7377682212
2491439.4728767719
2494301.6460508569
2501970.2707488768
2507894.1372177453
2526432.6035949356
2526912.7108743899
2536104.6818349493
2543445.6389301518
2543525.0285025760
2546017.5150907817
2548737.2552051276
2551167.3034654376
2551300.8505181236
2558365.7246265443
2568488.0444965897
2581316.7226811113
2587147.0479569634
2593151.6733146848
2599191.1809781484
2613533.4409425127
2613732.0466667239
2614498.1516604416
2618461.8300567593
2622647.6350409806
2624431.4002749857
2630262.0012746307
2632235.6933492055
2636673.7777856869
2637684.2664716834
2647065.8603961769
2649423.6413575526
2653272.4444281234
2656338.3348390425
2667484.7677953678
2676729.6526609799
2689361.0389768864
2691197

2025-01-19 22:21:28 - root - INFO - SQL:
-- 3. Get the count of events per event_date between January 1 and January 5, 2021
SELECT `event_date`, COUNT(*) AS event_count
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210105'
GROUP BY `event_date`
LIMIT 1000
Results:
event_date,event_count
20210101,22096
20210103,24743
20210105,42827
20210102,23599
20210104,31395

2025-01-19 22:21:29 - root - INFO - SQL:
-- 4. List unique event_name values on January 1, 2021
SELECT DISTINCT `event_name`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
LIMIT 1000
Results:
event_name
first_visit
page_view
session_start
user_engagement
scroll
view_item
add_shipping_info
view_promotion
add_payment_info
view_search_results
select_promotion
click
begin_checkout
select_item
purchase
add_to_cart

2025-01-19 22:21:31 - root - INFO - SQL:
-- 5. Get the number of events per user_pseudo_id on January 1, 2021
SELECT `user_pseudo_id`, COUNT(*) AS event_count
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
GROUP BY `user_pseudo_id`
LIMIT 1000
Results:
Too long, hard cut:
user_pseudo_id,event_count
1003046.9452926974,5
1023282.4639847710,77
1026043.4481623879,9
1026409.1551860912,8
1032138.1796039159,5
1037928.9294661675,5
1045950.7099606829,5
1051288.9523352374,6
1054372.6755770068,5
1064574.6224708641,5
1066655.6240997015,4
1080064.0071613184,9
1082746.7285674512,5
1097358.9593491100,2
1104313.9641823605,5
1107198.5152483918,6
1112823.8475775772,73
1116587.1725520171,5
1127824.3503063268,7
1134825.6533092350,5
1138692.0103796281,6
1160488.2375923167,427
1164648.0319944302,20
1168297.2853699605,5
1170405.4925804370,12
1174066.6437027818,5
1178889.6850461952,5
1188134.8498680538,114
1205590.2516186397,3
1211099.8247563235,25
1213932.4846099850,4
1215465.1474478000,11
1218586.5350251990,6
1240786.8917310160,5
1246063.3665874179,8
1255322.2973246181,3
1259302.9069938124,9
1269423.6724500672,10
1275797.1936238018,10
1277765.6068129494,5
1296701.2382814729,3
1308776.9803994658,7
1318624.9067804638,4
1320187.6719997668,5
1326289.2331853598,5
1333091.0887566663,5
1352892.5937639189,9
1375005.2583322863,6
1382535.7283137323,14
1385112.5897617274,4
1396456.6482506733,2
1401649.9529464111,5
1422161.0871788362,9
1437260.5988606411,6
1448835.0934102497,5
1453555.6810069410,3
1453951.1387928223,12
1456890.1673716823,5
1459436.8826692932,3
1473136.1149103090,17
1485472.4390061373,5
1499810.5142637849,4
1501018.3808301483,5
1503421.5168556763,12
1515646.3111272928,5
1518831.1475327211,6
1519124.8641457524,19
1534689.9343310805,4
1539940.5253610440,9
1543004.7243225422,5
1550901.3980286554,4
1564015.6880680172,4
1575061.4789497906,6
1582390.8206269591,5
1616136.8949543878,4
1619900.3195973863,5
1620024.8966870933,5
1646722.0078157231,48
1674937.2501954408,8
1677450.9117017807,8
1680043.1145812114,4
1684301.4109152707,38
1688147.2939632391,5
1693134.9790437518,5
1694910.7733232660,7
1699037.5870634483,3
1707918.4797422153,3
1713530.3382800695,9
1719564.6333875501,5
1729803.5105688857,4
1734528.1974041204,6
1745072.0004799132,4
1745171.2191701968,28
1749246.8534368616,13
1759212.2216007988,5
1762263.6990880514,6
1765594.3047173009,5
1784794.0627143380,5
1804199.2014328535,5
1820733.6464417466,8
1829763.3860332334,31
1846974.0316175078,10
1859470.4546513665,14
1884090.9722372635,12
1886250.8920156183,4
1912537.7440240268,1
1958116.3750166429,6
1958256.0896241884,5
1961265.4757052307,4
1967725.7354072666,5
1990491.3893000361,67
1993768.0582544668,5
1999213.1832096854,17
2007362.2149327588,4
2007867.8957787066,5
2019465.0056495205,5
2029664.5317923957,5
2041235.3400307589,5
2044855.8624761839,4
2077981.6202330137,5
2084772.9471491241,3
2091407.8804833129,9
2102395.6721696580,6
2142722.9676010623,27
2150276.2168438227,2
2157133.5876722467,18
2159725.7481437355,5
2165252.0147518395,5
2167343.6164963557,4
2168528.2202958861,4
2194957.7885097322,4
2228172.7936687802,6
2244553.9738621373,18
2245992.8909040661,5
2247846.3358362547,3
2263288.5212004372,15
2264573.5209212671,6
2268837.3082004933,5
2272023.1096248377,7
2275476.3701234224,5
2290904.3176780756,5
2304235.4728947355,6
2311908.3797713386,5
2322051.0966144624,9
2327547.5435328629,6
2329161.7120010083,7
2340587.9439563847,5
2344300.8375944627,5
2362829.7919429820,2
2375215.3636092839,5
2376646.7974930863,7
2378480.6534474606,4
2382451.4611706340,3
2384902.1644296925,3
2411763.0850272555,10
2417078.3361324500,4
2432374.8482039518,5
2437853.8047077377,7
2438148.3441039719,5
2463849.3270043637,4
2484010.5620979211,5
2485922.5515109543,6
2486846.9299481244,11
2489685.1683265365,5
2492721.1881800375,2
2501661.0331987453,5
2506075.7314444580,4
2539661.0024435471,6
2560700.2802998477,4
2563982.7084295364,3
2578870.7901059159,5
2589245.5979068367,5
2599362.6005762632,5
2613632.7561400432,5
2627874.7977372146,6
2630765.5704087315,6
2648480.7456264429,19
2655279.4923479690,5
2681967.7844689964,4
2683925.9434937492,4
2687473.9692412289,5
2688110.9777730450,29
2691270.4995570828,6
2692657.2939750667,6
2694084.5852510731,15
2709449.6736747839,5
2712864.2294346749,3
2719657.8629194725,19
2739425.0432989823,2
2746195.3557509904,13
2748139.1358063966,5
2754697.4847843626,10
2755973.1582682668,11
2767600.1190297171,3
2776706.0228802998,7
2779137.7674526641,31
2781408.6267522276,6
2783014.3813479767,318
2795133.4288865632,11
2795240.3198638943,3
2796100.1284437751,8
2803851.7451929280,9
2810822.2085903402,4
2821509.2290888995,28
2838667.1045753224,5
2839647.6325562515,6
2842598.5931018472,6
2844832.0483599899,3
2849086.2703560041,6
2856545.1057637132,61
2873742.8991614203,5
2882177.0250975565,5
2885429.0157235569,68
2892944.4318946076,8
2893808.1269182675,5
2908071.3197159392,6
2910024.9071648144,5
2912682.3106786643,5
2913205.0530257308,4
2914301.0348640426,15
2916336.4829526738,4
2917194.9600461127,4
2917834.9881423689,9
2938826.3390148112,29
2952066.5004557428,5
2965622.6326568063,5
2973917.2072647263,5
2979122.8002670631,5
3001110.3208062401,33
3007601.9537396348,4
3017509.1296773380,5
3022409.8765357635,8
3024189.6101670146,4
3027107.9482352721,5
3028781.2

2025-01-19 22:21:33 - root - INFO - SQL:
-- 6. Get distinct user_pseudo_id who had events on January 6, 2021
SELECT DISTINCT `user_pseudo_id`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210106`
LIMIT 1000
Results:
Too long, hard cut:
user_pseudo_id
1001303.4827739208
1014060.1100191558
1015239.8458513676
1023213.5350684501
1025773.0920505617
1033020.5841925327
1042140.6802444773
1045720.9269650087
1049106.9990499157
1049739.7909391395
1060274.1098179258
1065322.6541302193
1069165.2811408476
1069494.0113686800
1072513.2161702512
1075240.7394043586
1075333.9269112947
1078788.8328338285
1081165.5314971225
1083792.6034832516
1084471.2677471598
1086668.0925005810
1086843.9052907013
1087271.0550084610
1087808.3711873816
1095740.4839642689
1111626.7442894456
1114964.3576383224
1115377.5526866793
1118833.2974558782
1126378.6956818362
1128261.6033595713
1128289.3662024583
1130911.8567954377
1133313.1103337373
1133962.3740970739
1135774.0646413552
1141870.4386338572
1144150.5821344535
1144792.8191246270
1146837.4730107711
1148615.3691736909
1151687.1996189042
1153093.0119048067
1160488.2375923167
1163998.9977514528
1169456.0744217795
1170673.0496256889
1173439.7311015929
1175417.7164964556
1177018.6074439798
1180762.6954492448
1185502.9456478888
1185607.4529846208
1211099.8247563235
1213730.2023854144
1214408.9886831537
1214882.5762650867
1216128.7020381390
1218031.2772164166
1221611.6181416961
1223402.7111643409
1224512.5360000287
1230929.5891057900
1243180.2889994882
1245742.1517954276
1250075.3055872841
1251677.0033366371
1252675.9812778248
1253621.4143036992
1255130.2864074728
1256871.5825332697
1257670.9852008771
1259037.7018534149
1264306.5410019941
1270650.6052564575
1274840.8216292245
1278990.5126400811
1280885.4587684428
1282586.4517477452
1283422.3494279515
1285418.4651557245
1285421.1033375628
1291684.5715903210
1295893.9741062295
1304296.6040710271
1304588.7510213626
1304912.9788917690
1306493.1469289903
1311409.7691253264
1312237.6155331000
1314525.6769250991
1318199.4944291645
1324330.4963761152
1324723.7882312578
1325005.1519738149
1326729.2901375460
1328537.2795814770
1332716.7234827218
1357835.0893556888
1358070.7682863119
1362293.0058255347
1366045.3922534826
1368947.6948566343
1369631.9406198523
1372261.7721304420
1374353.8427076075
1376090.8119482339
1377886.1560338090
1380305.7377133735
1383476.9026182603
1387570.7927046510
1388300.4678602079
1390300.4796021112
1390701.8959589858
1395824.1622992884
1404107.6346981032
1408865.7005954025
1412724.1344589310
1418623.6541339375
1421329.8121000178
1421856.0079266060
1433324.7672312716
1436098.4730553026
1442352.3658130118
1451268.4257155324
1470631.9552326980
1474912.2146834138
1483107.7440546761
1484136.6530214500
1485221.2761545005
1493982.6183998464
1496913.8935875858
1498978.1889757995
1499057.4357872580
1506112.7265258752
1506439.0847364167
1506539.1639843846
1513363.4705791183
1519792.3976302972
1520786.0949644980
1522572.1753325266
1524322.6852456903
1529639.2751490138
1529746.2151935759
1532659.8332550859
1537642.0362746652
1538853.8027080230
1542686.8251143701
1544033.2704162362
1553110.3711752329
1555307.6654439904
1557094.4086790025
1563588.5377359390
1565944.2403531565
1568701.7618656061
1569105.7216127560
1572598.8364509193
1573704.7204978503
1584311.2852657177
1585108.8221353211
1595752.5739499079
1600662.6721143107
1604576.0477201832
1606972.7164816338
1607155.9736505928
1614669.6038310943
1624875.9469354174
1627852.3385542986
1630439.0167164545
1644962.0672937719
1646872.3600157379
1648356.6327707257
1665685.1962105106
1670772.8517777467
1671731.4079391358
1673366.1492700771
1677342.6525684271
1685163.0188672299
1689794.6230455628
1702808.4648640313
1706543.4300583809
1711666.5759989568
1715613.1015599605
1718443.9020745667
1722746.7723659310
1725092.2005673007
1732904.4615563462
1743359.6937438402
1745401.8622362849
1747990.3808984476
1750371.7249808647
1754006.0994834886
1754096.9892214658
1754101.5236470415
1760327.1126266238
1760559.6974224035
1762188.0255397483
1763814.8337938888
1770542.1482149599
1774229.1142302813
1775022.8326960466
1776940.9301836875
1780380.8421968556
1782989.8792867764
1783326.7767103110
1784447.2994788629
1786806.6734812198
1789084.1816233251
1799418.1299673128
1803057.3123311699
1805650.8119186851
1805776.0486916905
1806270.7453025738
1817739.9801196106
1818888.2177557064
1819801.1582224257
1830571.5765734358
1834580.5106619345
1836291.9546308099
1838865.5456804179
1846977.2831502963
1847031.8084425545
1859868.1531344106
1860348.3130044315
1861628.8947054439
1869265.9376251928
1869304.3628726117
1870216.8883543271
1873577.7239946701
1874542.7243615119
1883044.6747975892
1883551.8077158377
1888612.2074326083
1896441.1015330367
1896493.1437757849
1907873.7154851308
1909593.9396452170
1912970.3114085343
1913596.0640126840
1921439.1124554416
1924207.3030440131
1925677.0426697206
1944841.0469682976
1950108.6469907871
1957727.6241797745
1959950.1321560119
1960091.6138417827
1960911.8305711573
1964130.2983828831
1964725.4724709933
1969417.8912253448
1972864.8412235262
1978839.9916116541
1981966.9921552984
1984800.0163024441
1986651.2774699608
1988560.6872382890
1990765.0839533057
1990797.7990017528
1992389.4170917308
1994261.2967787637
1998551

2025-01-19 22:21:34 - root - INFO - SQL:
-- 7. Get distinct user_pseudo_id who had events on January 7, 2021
SELECT DISTINCT `user_pseudo_id`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210107`
LIMIT 1000
Results:
Too long, hard cut:
user_pseudo_id
1000557.2911835023
1002616.3660015684
1008726.7423030385
1009541.6887464068
1009676.4905193951
1016428.1065641732
1019574.8776308935
1020795.7432964012
1028144.2081628525
1030326.1353640844
1036021.1054561259
1043511.9901401232
1046404.1129546883
1056020.6709260931
1063386.3828577009
1066407.3757892113
1072012.7284818935
1073430.9059120582
1087808.3711873816
1091162.1989694199
1098584.0776604006
1099671.3398238118
1100949.9283905733
1104189.1961360907
1107549.5710254296
1109808.6106046131
1114216.0904812151
1116865.4647068394
1122146.8997157148
1124540.2333393152
1132479.2425986879
1132946.8730897471
1138520.5891734753
1144754.6830399719
1149393.9441120966
1150257.3416332583
1150418.5729329589
1151529.7874029554
1151687.1996189042
1163998.9977514528
1166484.2621554560
1168153.2069804316
1169660.2704170325
1172211.4577928962
1174920.8866835138
1177876.9777589683
1181141.8389731329
1182923.0909175622
1186421.2997808469
1194177.8166317724
1195966.3969559148
1196040.9501767394
1209023.5496836341
1224731.3666771048
1227321.4549113942
1231601.8963574336
1237924.3309856915
1242735.7779476738
1246241.1259892311
1247293.4194247843
1256871.5825332697
1263510.2346903431
1266942.9616912837
1272559.2391561764
1275281.1401174806
1276927.7607362138
1280885.4587684428
1283562.7271739130
1287483.1535140122
1289021.8467378906
1291324.6496937233
1295828.0586489111
1296777.6630043403
1299775.3014967415
1304171.0604038711
1309980.6522015685
1317681.8410322222
1320383.7530644264
1329436.8221805419
1332979.8914503740
1333728.0047687977
1342173.6511298548
1342397.5707081379
1357251.3765617872
1359026.8307338454
1362228.4966015575
1364505.7481550412
1366103.4269040146
1366281.7261580221
1366363.8080922440
1369023.5738995470
1374932.4478575733
1378696.4627477130
1385336.9757682390
1390701.8959589858
1403236.7518250436
1404246.6716592021
1404269.7082895339
1406007.4609789626
1406098.2272398299
1406568.6449738818
1408955.7264448085
1414085.4804386953
1417342.6523496808
1418203.9991889841
1421115.4433330025
1421856.0079266060
1425808.3063725064
1431033.2186997626
1434822.0221853225
1444536.6153824784
1444614.0381635975
1446850.8020489502
1447620.3308368044
1450600.6803049558
1457470.5940116605
1459124.3307795496
1459299.1013763792
1461952.0290351411
1478029.4552762559
1480795.6595718331
1493167.5512652590
1518981.1076172913
1528342.2635970316
1536093.8467158445
1544241.6807718255
1550391.0083775168
1554803.8279036598
1561122.7855918216
1565944.2403531565
1569852.5468689472
1572474.2624475475
1574288.0335442195
1581678.4089346605
1583993.1803418505
1590652.6726149736
1607408.4697646280
1613328.8113572519
1626366.8919067582
1627454.0430815452
1631724.2395953902
1650314.7806652804
1655338.7233343192
1658205.7748137560
1659496.8938806193
1667250.8018262205
1668595.1498499526
1673328.4452718162
1676773.5069362381
1677041.1501664616
1680148.7300106081
1683135.7204561691
1690932.7741713887
1701036.7762199410
1702434.1337833338
1704559.1277489943
1706199.7091522122
1709858.9795411204
1713143.1515270435
1713151.7799105629
1717170.7325581233
1724440.6442958003
1725560.3896736022
1730865.8857828441
1733914.0614743326
1736811.0099185946
1739185.6417988339
1749175.3153107842
1749326.0413550275
1750084.1602132369
1766211.8575237576
1767689.7108431002
1778635.2272822812
1788873.5659424922
1790461.4302221148
1799694.8972403574
1803816.2751642917
1804942.4304035440
1825800.9927595957
1832746.6709228981
1839358.0620214551
1842685.0275380592
1845803.4216408728
1852845.4335508679
1867222.1866677990
1881056.5708385955
1882891.1942887897
1883648.1654112367
1889430.9379107863
1894733.4475939447
1900950.0040962720
1904312.5578123224
1905669.9634464574
1907356.8098775960
1911613.9628018306
1915112.3520066455
1916232.2044487343
1927473.5473152507
1930951.1042348154
1933629.8612777946
1935706.2469501287
1945311.8072067111
1946103.9953128236
1947409.1939782091
1947449.4066998823
1947877.1109354712
1951926.5035164256
1952518.4421988208
1961376.9468264317
1961698.6630150303
1963150.5780975373
1974627.5712881901
1983135.0030940300
1988560.6872382890
1999407.6082240854
2007362.2149327588
2008350.4389402699
2014270.2546235318
2014307.3611842210
2014709.5760211511
2017764.9469389867
2022153.9480150932
2023738.5952852555
2023891.7979970018
2026636.6794570307
2034349.2195692243
2039179.7218079866
2039856.4057543029
2040396.6725159529
2040937.1385074889
2041967.3881226587
2058616.9904162015
2062713.4006549189
2065953.3629381605
2073032.0340382286
2075161.4907764275
2080579.7444739445
2081586.3480335058
2081705.9190983707
2085160.9959749082
2089325.3811990256
2094636.6332384800
2100577.0184610827
2114922.0239883768
2115494.9408930616
2120457.3441823493
2120886.9334260185
2122058.1405701047
2122058.3240988510
2124862.5704236333
2131645.7694171953
2134701.3583866208
2139949.2328161912
2141161.4863265805
2141191.6534652110
2144973.3156012424
2147461.4105185527
2155647.5373862902
2156834.4695745566
2162918.4684165034
2183579.4397252771
2184518.9171442290
2184597

2025-01-19 22:21:36 - root - INFO - SQL:
-- 8. Get the count of events per event_name on January 1, 2021
SELECT `event_name`, COUNT(*) AS event_count
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
GROUP BY `event_name`
LIMIT 1000
Results:
event_name,event_count
first_visit,1916
page_view,7906
session_start,2289
user_engagement,4618
scroll,2113
view_item,1498
add_shipping_info,54
view_promotion,798
add_payment_info,33
view_search_results,149
select_promotion,63
click,2
begin_checkout,162
select_item,186
purchase,14
add_to_cart,295

2025-01-19 22:21:38 - root - INFO - SQL:
-- 9. Get the earliest event_timestamp per user_pseudo_id on January 1, 2021
SELECT `user_pseudo_id`, MIN(`event_timestamp`) AS first_event_timestamp
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
GROUP BY `user_pseudo_id`
LIMIT 1000
Results:
Too long, hard cut:
user_pseudo_id,first_event_timestamp
1003046.9452926974,1609468318563156
1023282.4639847710,1609517731708459
1026043.4481623879,1609503951286460
1026409.1551860912,1609500452334474
1032138.1796039159,1609463888907142
1037928.9294661675,1609536627941932
1045950.7099606829,1609486796294418
1051288.9523352374,1609510180700715
1054372.6755770068,1609471951587116
1064574.6224708641,1609517222788319
1066655.6240997015,1609520932444301
1080064.0071613184,1609543703762831
1082746.7285674512,1609537501332616
1097358.9593491100,1609487255084735
1104313.9641823605,1609515676836928
1107198.5152483918,1609505191191174
1112823.8475775772,1609459269887298
1116587.1725520171,1609543575127001
1127824.3503063268,1609540679911144
1134825.6533092350,1609544895241143
1138692.0103796281,1609527091611025
1160488.2375923167,1609516740350459
1164648.0319944302,1609539245792692
1168297.2853699605,1609508029958900
1170405.4925804370,1609491347558878
1174066.6437027818,1609481865836692
1178889.6850461952,1609512721843186
1188134.8498680538,1609515861944180
1205590.2516186397,1609507381593819
1211099.8247563235,1609520701839174
1213932.4846099850,1609483109149665
1215465.1474478000,1609507437971468
1218586.5350251990,1609528994116594
1240786.8917310160,1609470394748238
1246063.3665874179,1609510258708884
1255322.2973246181,1609497619324582
1259302.9069938124,1609514700580283
1269423.6724500672,1609496072763210
1275797.1936238018,1609524704414532
1277765.6068129494,1609476651368503
1296701.2382814729,1609545586565432
1308776.9803994658,1609501545419396
1318624.9067804638,1609514308988462
1320187.6719997668,1609461107109749
1326289.2331853598,1609481222678787
1333091.0887566663,1609528856739447
1352892.5937639189,1609473895782775
1375005.2583322863,1609519286075951
1382535.7283137323,1609463551522446
1385112.5897617274,1609542663862793
1396456.6482506733,1609510193708003
1401649.9529464111,1609477396149869
1422161.0871788362,1609489445708768
1437260.5988606411,1609534203788651
1448835.0934102497,1609520262368722
1453555.6810069410,1609503081136044
1453951.1387928223,1609514715374283
1456890.1673716823,1609540737998188
1459436.8826692932,1609522620586340
1473136.1149103090,1609479185006287
1485472.4390061373,1609517233816411
1499810.5142637849,1609476696996002
1501018.3808301483,1609479221449123
1503421.5168556763,1609462586351297
1515646.3111272928,1609485447213479
1518831.1475327211,1609484862429444
1519124.8641457524,1609497086741971
1534689.9343310805,1609534131634732
1539940.5253610440,1609485151696037
1543004.7243225422,1609519696838965
1550901.3980286554,1609497885356266
1564015.6880680172,1609527262625521
1575061.4789497906,1609508307631647
1582390.8206269591,1609536480076063
1616136.8949543878,1609479015861580
1619900.3195973863,1609519419471283
1620024.8966870933,1609507296195272
1646722.0078157231,1609485358139411
1674937.2501954408,1609515719174609
1677450.9117017807,1609517616856478
1680043.1145812114,1609523488536285
1684301.4109152707,1609500611817910
1688147.2939632391,1609531760521458
1693134.9790437518,1609495675043365
1694910.7733232660,1609529942291141
1699037.5870634483,1609536090704453
1707918.4797422153,1609527122307230
1713530.3382800695,1609542838460456
1719564.6333875501,1609514638403253
1729803.5105688857,1609539916248324
1734528.1974041204,1609463195244478
1745072.0004799132,1609525781951180
1745171.2191701968,1609518712869487
1749246.8534368616,1609520325363961
1759212.2216007988,1609500920105878
1762263.6990880514,1609509002559235
1765594.3047173009,1609498352425015
1784794.0627143380,1609462318464280
1804199.2014328535,1609526421210996
1820733.6464417466,1609491323472771
1829763.3860332334,1609519211966573
1846974.0316175078,1609468726877761
1859470.4546513665,1609531938290875
1884090.9722372635,1609501712250623
1886250.8920156183,1609541430788979
1912537.7440240268,1609518518256358
1958116.3750166429,1609539098734456
1958256.0896241884,1609508111289141
1961265.4757052307,1609509217720779
1967725.7354072666,1609515080100530
1990491.3893000361,1609481036303667
1993768.0582544668,1609526422714120
1999213.1832096854,1609527336983944
2007362.2149327588,1609466082573216
2007867.8957787066,1609526682969574
2019465.0056495205,1609461954159434
2029664.5317923957,1609507056286374
2041235.3400307589,1609483880156829
2044855.8624761839,1609544485320464
2077981.6202330137,1609494715981777
2084772.9471491241,1609510721542687
2091407.8804833129,1609536000393896
2102395.6721696580,1609515976307123
2142722.9676010623,1609477963788908
2150276.2168438227,1609475171944849
2157133.5876722467,1609544029824624
2159725.7481437355,1609505443138279
2165252.0147518395,1609470441445127
2167343.6164963557,1609486088978160
2168528.2202958861,1609519813589863
2194957.7885097322,1609500544802649
2228172.7936687802,1609476456571596
2244553.9738621373,1609499351873919
2245992.8909040661,1609467871177487
2247846.3358362547,1609528076115859
2263288.5212004372,1609531293734109
2264573.5209212671,1609520640448866
2268837.3082004933,160953779974

2025-01-19 22:21:39 - root - INFO - SQL:
-- 10. Get the list of event_params keys on January 1, 2021
SELECT DISTINCT ep.key
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`,
UNNEST(`event_params`) AS ep
LIMIT 1000
Results:
key
ga_session_number
ga_session_id
page_referrer
page_location
page_title
session_engaged
engaged_session_event
entrances
medium
campaign
source
term
all_data
clean_event
debug_mode
engagement_time_msec
percent_scrolled
currency
gclid
gclsrc
dclid
unique_search_term
search_term
link_url
link_domain
outbound
payment_type
value
tax
promotion_name
coupon
shipping_tier
transaction_id

2025-01-19 22:21:41 - root - INFO - SQL:
-- 11. Extract string_value from event_params where key is 'page_location' on January 1, 2021
SELECT ep.value.string_value
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101` AS t,
UNNEST(t.event_params) AS ep
WHERE LOWER(ep.key) = 'page_location'
LIMIT 1000
Results:
Too long, hard cut:
string_value
https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee
https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee
https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee
https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee
https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee
https://shop.googlemerchandisestore.com/Google+Redesign/Campus+Collection/Google+Sunnyvale+Campus+Bottle
https://shop.googlemerchandisestore.com/Google+Redesign/Lifestyle/Fun/Malibu+Sunglasses.axd
https://shop.googlemerchandisestore.com/
https://shop.googlemerchandisestore.com/Google+Redesign/Accessories/Google+Clear+Framed+Yellow+Shades
https://shop.googlemerchandisestore.com/Google+Redesign/Campus+Collection/Google+Sunnyvale+Campus+Bottle
https://shop.googlemerchandisestore.com/basket.html
https://shop.googlemerchandisestore.com/Google+Redesign/Lifestyle/Fun/Malibu+Sunglasses.axd
https://shop.googlemerchandisestore.com/registersuccess.html
https://shop.googlemerchandisestore.com/yourinfo.html
https://shop.googlemerchandisestore.com/basket.html
https://shop.googlemerchandisestore.com/yourinfo.html
https://shop.googlemerchandisestore.com/Google+Redesign/Lifestyle/Fun/Malibu+Sunglasses.axd
https://shop.googlemerchandisestore.com/Google+Redesign/New
https://shop.googlemerchandisestore.com/
https://shop.googlemerchandisestore.com/store.html
https://shop.googlemerchandisestore.com/Google+Redesign/Shop+by+Brand/Google
https://shop.googlemerchandisestore.com/Google+Redesign/Lifestyle/Fun/Malibu+Sunglasses.axd
https://shop.googlemerchandisestore.com/store.html
https://shop.googlemerchandisestore.com/yourinfo.html
https://shop.googlemerchandisestore.com/registersuccess.html
https://shop.googlemerchandisestore.com/yourinfo.html
https://shop.googlemerchandisestore.com/basket.html
https://shop.googlemerchandisestore.com/
https://shop.googlemerchandisestore.com/Google+Redesign/Accessories/Google+Clear+Framed+Yellow+Shades
https://shop.googlemerchandisestore.com/basket.html
https://shop.googlemerchandisestore.com/Google+Redesign/Shop+by+Brand/Google
https://shop.googlemerchandisestore.com/Google+Redesign/Lifestyle/Google+Aluminum+Bottle+Red
https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/IamRemarkable+Unisex+T-Shirt
https://shop.googlemerchandisestore.com/basket.html
https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/IamRemarkable+Unisex+T-Shirt
https://shop.googlemerchandisestore.com/
https://shop.googlemerchandisestore.com/Google+Redesign/New
https://shop.googlemerchandisestore.com/yourinfo.html
https://shop.googlemerchandisestore.com/store.html
https://shop.googlemerchandisestore.com/
https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Mens
https://shop.googlemerchandisestore.com/Google+Redesign/Lifestyle/Google+Aluminum+Bottle+Red
https://shop.googlemerchandisestore.com/Google+Redesign/Campus+Collection/Google+Sunnyvale+Campus+Bottle
https://shop.googlemerchandisestore.com/store.html
https://shop.googlemerchandisestore.com/Google+Redesign/Lifestyle/Google+Aluminum+Bottle+Red
https://shop.googlemerchandisestore.com/Google+Redesign/Lifestyle/Google+Aluminum+Bottle+Red
https://shop.googlemerchandisestore.com/
https://shop.googlemerchandisestore.com/basket.html
https://shop.googlemerchandisestore.com/yourinfo.html
https://shop.googlemerchandisestore.com/basket.html
https://shop.googlemerchandisestore.com/Google+Redesign/Accessories/Google+Clear+Framed+Yellow+Shades
https://shop.googlemerchandisestore.com/basket.html
https://shop.googlemerchandisestore.com/Google+Redesign/Accessories/Google+Clear+Framed+Yellow+Shades
https://shop.googlemerchandisestore.com/store.html
https://shop.googlemerchandisestore.com/Google+Redesign/Campus+Collection/Google+Sunnyvale+Campus+Bottle
https://shop.googlemerchandisestore.com/basket.html
https://shop.googlemerchandisestore.com/basket.html
https://shop.googlemerchandisestore.com/yourinfo.html
https://shop.googlemerchandisestore.com/store.html
https://shop.googlemerchandisestore.com/basket.html
https://shop.googlemerchandisestore.com/signin.html
https://shop.googlemerchandisestore.com/Google+Redesign/New
https://shop.googlemerchandisestore.com/registersuccess.html
https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Mens
https://shop.googlemerchandisestore.com/signin.html
https://shop.googlemerchandisestore.com/Google+Redesign/Shop+by+Brand/YouTube
https://shop.googlemerchandisestore.com/Google+Redesign/Shop+by+Brand/YouTube
https://shop.googlemerchandisestore.com/Google+Redesign/Shop+by+Brand/YouTube
https://shop.googlemerchandisestore.com/Google+Redesign/Shop+by+Brand/YouTube
https://shop.googlemerchandisestore.com/Google+Redesign/New
https://shop.googlemerchandisestore.com/Google+Redesign/Shop+by+Brand/YouTube
https://shop.googlemerchandisestore.com/Google+Redesign/New
https://shop.googlemerchandisestore.c

2025-01-19 22:21:43 - root - INFO - SQL:
-- 12. Get the number of users per day between January 1 and January 5, 2021
SELECT `event_date`, COUNT(DISTINCT `user_pseudo_id`) AS user_count
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210105'
GROUP BY `event_date`
LIMIT 1000
Results:
event_date,user_count
20210104,3079
20210101,2160
20210102,2581
20210103,2579
20210105,4101

2025-01-19 22:21:45 - root - INFO - SQL:
-- 13. List distinct platforms used between January 1 and January 5, 2021
SELECT DISTINCT `platform`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210105'
LIMIT 1000
Results:
platform
WEB

2025-01-19 22:21:47 - root - INFO - SQL:
-- 14. Get the count of events per device category on January 1, 2021
SELECT device.category, COUNT(*) AS event_count
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
GROUP BY device.category
LIMIT 1000
Results:
category,event_count
desktop,13477
mobile,8152
tablet,467

2025-01-19 22:21:50 - root - INFO - SQL:
-- 15. Get distinct user_pseudo_id active between January 1 and January 5, 2021 but not on January 6 and 7, 2021
SELECT DISTINCT `user_pseudo_id`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210105'
AND `user_pseudo_id` NOT IN (
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210106`
  UNION DISTINCT
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210107`
)
LIMIT 1000
Results:
Too long, hard cut:
user_pseudo_id
1008499.5928445086
1013760.9231029745
1014209.5295344253
1026137.2290719007
1028167.1226079449
1032092.5249707229
1053193.3273260382
1057066.6724870774
1057265.5844727802
1065673.0722289663
1067841.4647153954
1075223.2681702246
1082690.0377265261
1103286.8251708796
1109836.9501901728
1113469.1950253831
1114181.7368629788
1121518.2859510925
1130810.6137694456
1134613.7634894426
1158637.0383647084
1164741.6860607634
1181674.5265741661
1185078.3105419781
1194575.2891034137
1214573.9183644653
1215389.2295507570
1222867.5284822262
1227012.8467411408
1238230.5582832258
1243221.1777211525
1252690.3944441209
1284535.4676055384
1288248.9113459714
1289319.0865612371
1297488.8153560940
1299487.6744511638
1307038.3688504236
1309149.1848587742
1313329.6311058857
1314747.6066644573
1320284.3859724504
1325688.1519909745
1334969.6157017719
1339205.5397897099
1373324.8357357420
1385090.1246142947
1385662.1127085473
1401785.6584445113
1402228.3482241994
1403129.5580554677
1445737.4102905419
1450787.9898569840
1458803.4123039458
1466910.4554610435
1470241.3611852177
1471187.8226858001
1488009.3142808321
1493030.0825468207
1497130.5055593166
1500615.9964438412
1504953.0746977838
1509456.3177418451
1519189.6398973848
1522857.5896662267
1536105.5891820566
1544748.2905250855
1556885.1837167077
1560589.3791460585
1578948.0834575091
1586022.1800460720
1588332.2823326217
1588666.3949365829
1590715.7165540392
1607100.0381093527
1622235.9923526878
1624884.8451928269
1629639.2044968342
1632927.1894987991
1634789.3752037441
1639296.9002795622
1648032.7331818100
1656975.3346712388
1659842.4321850950
1665661.9122532614
1668023.4150976276
1668416.2014466630
1672632.0859250572
1690623.2302780540
1702019.9842929153
1702845.7520261284
1703253.2388947937
1707319.9934501562
1711048.6268268364
1711971.4968010332
1726993.2463217900
1730497.6226428479
1732811.6786855240
1745835.9106014489
1751599.1685077136
1754331.3157951821
1757510.5330787128
1765047.7773329261
1765130.1889939374
1770215.5966952525
1780294.0221405041
1787504.7670504282
1791921.4002592107
1795540.6156637931
1799135.7941835837
1806356.1249501454
1807394.6792147711
1808170.2762309629
1808232.5654454206
1824201.1380052029
1841613.4096590753
1842336.8436996882
1843227.1315168145
1855160.6431356491
1857518.5760998088
1859470.4546513665
1888732.5808117060
1891844.3029317015
1895574.3356492898
1901730.7277275021
1908860.5902672888
1922936.0279129669
1929434.4518118388
1930569.1007455155
1934857.9616833097
1945068.8887037343
1949104.1690663627
1954953.0721200891
1966048.6599698958
1976029.4501496209
1979778.7331964605
1982815.8232892378
1983421.2936555498
1993697.9945930656
2002776.5976883193
2005618.5376901983
2022577.6028076666
2049590.8596560881
2051318.3089832623
2055215.4967663939
2070480.7661066255
2079154.1476733507
2094642.2631508719
2096766.0019470232
2116278.5223204033
2121651.9176614852
2127898.5527858242
2131056.2525081023
2131509.8375213648
2147417.5961373356
2157825.0718936880
2164352.2670593278
2167317.9816236215
2172399.2091034226
2175416.5833910330
2177462.5220423724
2177957.7412962494
2192432.3542621657
2193948.2281082270
2194441.0544343537
2197864.5182472083
2200081.2420876058
2203449.4497261194
2204878.2541228096
2214606.8300190111
2245385.0615539791
2245567.3795914474
2248364.4469117960
2248754.7783173763
2250793.6313697017
2250953.6316204806
2258641.1629826733
2262724.6807963688
2263380.7170574283
2263420.2110121128
2265208.1282213045
2276075.8079921958
2277998.4131015438
2279457.7315196874
2284976.1899128869
2301413.0302404690
2303928.3507051479
2304235.4728947355
2327460.3641621424
2329707.0387773385
2331461.5841279593
2333408.5403558380
2346000.3226235037
2349749.6508625488
2374910.1217694068
2376240.8034284857
2376717.3509701603
2382234.3846802600
2382887.9214525018
2388941.9518774856
2392346.1836393196
2393556.1146578015
2399121.7379674359
2415432.3160368774
2415788.3641983779
2415858.4972221670
2417805.0150005257
2418145.6199610855
2419732.5640450460
2422137.6877778640
2423973.9449466734
2425570.7323199738
2430886.9385533523
2438902.8824385354
2440353.3206892115
2445188.0327038206
2461015.7427876593
2465015.1494457724
2467393.7377682212
2491439.4728767719
2494301.6460508569
2501970.2707488768
2507894.1372177453
2526432.6035949356
2526912.7108743899
2536104.6818349493
2543445.6389301518
2543525.0285025760
2546017.5150907817
2548737.2552051276
2551167.3034654376
2551300.8505181236
2558365.7246265443
2568488.0444965897
2581316.7226811113
2587147.0479569634
2593151.6733146848
2599191.1809781484
2613533.4409425127
2613732.0466667239
2614498.1516604416
2618461.8300567593
2622647.6350409806
2624431.4002749857
2630262.0012746307
2632235.6933492055
2636673.7777856869
2637684.2664716834
2647065.8603961769
2649423.6413575526
2653272.4444281234
2656338.3348390425
2667484.7677953678
2676729.6526609799
2689361.0389768864
2691197.8600859055
2712259.6042351009
2727985.5499136556
2744671.5449509941
2747046.8475558839
2774416.5678558071
2780178.2000494406
2782541

2025-01-19 22:21:52 - root - INFO - SQL:
-- 16. Get distinct event_dates from events between January 1 and January 7, 2021
SELECT DISTINCT `event_date`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210107'
LIMIT 1000
Results:
event_date
20210104
20210102
20210106
20210105
20210101
20210107
20210103

2025-01-19 22:21:53 - root - INFO - SQL:
-- 17. Get the top 1000 user_pseudo_id with the most events on January 1, 2021
SELECT `user_pseudo_id`, COUNT(*) AS event_count
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
GROUP BY `user_pseudo_id`
ORDER BY event_count DESC
LIMIT 1000
Results:
Too long, hard cut:
user_pseudo_id,event_count
72522849.6381089738,1011
1160488.2375923167,427
2783014.3813479767,318
5563930.3593101391,203
53550354.6354713181,180
8186100.1619066340,171
59533896.5320638489,170
68546038.8820428933,163
87047667.1042912591,149
53104811.8176614311,148
17007406.8391181695,144
72065348.6852495696,133
7515221.4303230400,126
28134106.1591086954,121
81574425.5434958788,117
6867779.6634381231,115
1188134.8498680538,114
7105959.6709528403,110
50844046.9564028621,99
74953787.0199910547,94
3354006.4211651279,90
75073588.1859607099,88
6328102986.3137432902,85
15817556.8554808751,83
6101467.4740745406,80
10860969.8635427479,80
32537212.0554785312,77
1023282.4639847710,77
76975305.9969820299,76
62524109.3161787418,76
45942478.6625384752,76
6801661.0213744991,76
1112823.8475775772,73
2885429.0157235569,68
1990491.3893000361,67
40650638.8176789956,67
6772624.5257726160,67
4626089.7083106102,66
78839661.7033676134,65
29404827.7870928470,63
2856545.1057637132,61
82379049.4680589452,57
15047683.3025668953,57
5510821.7058149595,57
4107999736.9770670225,56
53067943.8636445638,55
18097479.9566775994,53
3351786.5083077372,52
42142866.3416900702,51
64527390.2197615970,50
6482353.8828196074,50
5393985456.0596119848,48
1646722.0078157231,48
10115718.4867090359,48
38359877.5815012009,47
61687008.5702070839,47
22288916.8827658539,46
43470418.6139420304,45
81213220.7958656808,43
4124604.0408794437,43
84760862.0017504152,42
15932166.2076268855,41
43120797.5731831365,41
13167690.2693949122,40
8903783.1803413789,40
12685424.3792504835,39
16910393.5498744454,38
83736385.8758161413,38
8813737.3153270447,38
5686154.7174932299,38
1684301.4109152707,38
63655374.9348413503,37
1566834642.5850724108,37
39447924.7392393021,36
5554878.0772348619,36
73990466.9253242963,36
28889932.1687420790,35
6351413.2459505432,35
16584748.2250156564,34
76874793.6611457255,34
48293850.3499088450,33
3001110.3208062401,33
34851780.6903374642,33
14801022.9686481759,33
4647802.5572043944,33
5337490.6328314089,33
87188220.6252432191,32
11116091.7897694184,32
12177989.5566440967,32
4289529.7500442979,31
2779137.7674526641,31
77052125.0799530822,31
52170675.5101121559,31
1829763.3860332334,31
5831980.2827657871,31
8858380583.2491355805,30
9221726.8946931934,30
50994991.7786921042,30
88839956.1260646312,30
11369626.1068446121,30
2938826.3390148112,29
38945261.7275220036,29
75446459.8381341234,29
8233454.3379625056,29
70983845.8602218235,29
2688110.9777730450,29
1745171.2191701968,28
26776431.5444855772,28
6029218.0603649355,28
22570371.0320972505,28
5952403.0699076194,28
2821509.2290888995,28
67810822.6213098903,28
2142722.9676010623,27
69334767.8799342738,27
18281634.0263286465,27
5289818.5896545465,26
70070907.4592712107,26
9312196.4289187337,25
67150059.7765111802,25
5347187.1888352330,25
34150985.5240340128,25
1211099.8247563235,25
3247861.1783343704,24
25416145.7738087776,24
43935941.0459126619,24
34072087.4412395298,24
8764903.2626750908,24
12788887.8477521144,24
69671491.4417832889,24
5750356.4517628504,24
13623777.5841147931,24
5548979.4220764515,24
39261888.9474046490,24
7032927.5986019681,24
7833748.1492120206,23
3071789.9352232891,23
44361810.7796476736,23
4283464.4359186905,23
46271071.0418171780,23
5912802.1253450499,23
71774034.9487849217,22
90921275.4472518914,22
29538782.9408059000,21
68925463.5109471243,21
44740556.1615757380,21
60240245.7553258615,21
13794922.5461387312,21
5041502.7430031385,21
73659823.6409998130,21
3058967.2730251282,21
17595259.0522072964,21
82637393.7261976432,20
55271319.4094534400,20
1164648.0319944302,20
3455843.2119554439,20
9119509.2051111066,20
7454049374.5278441084,20
4640627.4777157751,20
45643625.0853629614,20
4499992609.9764785594,20
26943693.0634894898,20
3213363.3651446553,19
1519124.8641457524,19
78966520.2065669153,19
68497028.9313100402,19
24045383.4229050363,19
41109914.2938114399,19
5298013.7728745800,19
2364299980.1335009029,19
6991038.3370387967,19
2648480.7456264429,19
2719657.8629194725,19
21178461.3856148059,19
3718127.6303284550,18
3629907.7037376784,18
39335113.7845260204,18
4651894.8591529595,18
2244553.9738621373,18
92148877.5188210051,18
7051044.8537597066,18
4919799.0376731086,18
31711736.9819763479,18
49489352.0130765941,18
5227994.9289134236,18
6624046.1953842551,18
2157133.5876722467,18
29231866.0237322031,18
4933916.6307767169,18
35236652.2780808698,18
4675955.3422475397,17
4015519.0757720765,17
1999213.1832096854,17
7666337.2408476627,17
40937229.1554544663,17
7360503433.8016450106,17
31031519.3989745669,17
1473136.1149103090,17
55488010.7772988908,17
8135575.4106679316,17
5418076.2283249355,17
6050239.7863062718,17
7758527183.2977733624,17
42640994.6788353590,17
53327798.6735383085,17
9059021.8769836340,17
56510630.8658074346,17
59304688.2503711410,17
6171633.2360869637,17
7278044.1489631971,17
46504832.4995127040,17
6014286.9848367129,17
5520916.2190904037,16
18205474.8354291393,16
39585017.1090292162,16
72820486.6411427594,16
75328790.8293830754,16
3977023.4474982984,16
27339915.97000

2025-01-19 22:21:55 - root - INFO - SQL:
-- 18. Get distinct values of device.operating_system used on January 1, 2021
SELECT DISTINCT device.operating_system
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
LIMIT 1000
Results:
operating_system
Windows
Web
Android
<Other>
iOS
Macintosh

2025-01-19 22:21:57 - root - INFO - SQL:
-- 19. Get counts of events per country on January 1, 2021
SELECT geo.country, COUNT(*) AS event_count
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
GROUP BY geo.country
LIMIT 1000
Results:
country,event_count
France,335
India,2862
United States,9007
Canada,1779
Bangladesh,42
Kuwait,20
Indonesia,219
Brazil,491
Greece,24
China,475
Turkey,248
Japan,309
Portugal,451
Singapore,265
Saudi Arabia,47
Colombia,78
Israel,278
Egypt,108
Mexico,73
Ukraine,80
United Kingdom,816
Poland,175
Romania,110
South Korea,134
United Arab Emirates,76
Spain,398
Germany,203
South Africa,14
Cyprus,5
Thailand,49
Russia,153
Taiwan,263
Belarus,5
(not set),255
Azerbaijan,13
Jordan,40
Norway,60
Australia,100
Belgium,51
Ireland,51
Netherlands,185
Sweden,90
Argentina,29
Peru,110
New Zealand,21
Iceland,27
Finland,34
Vietnam,98
Austria,142
Switzerland,60
Venezuela,11
Chile,34
Albania,24
Hong Kong,97
Italy,148
Puerto Rico,12
Malaysia,32
Hungary,14
Pakistan,27
Algeria,99
Slovakia,11
Sri Lanka,48
Czechia,32
Morocco,45
Denmark,31
Philippines,200
Tunisia,9
Paraguay,4
Ecuador,4
Slovenia,13
Bolivia,5
Croatia,11
Iraq,26
Armenia,10
Lebanon,8
Nigeria,22
Bulgaria,22
North Macedonia,24
Estonia,15
Ghana,22
Uruguay,6
Latvia,6
Guatemala,50
Bahamas,6
El Salvador,3
Lithuania,4
Costa Rica,3

2025-01-19 22:21:59 - root - INFO - SQL:
-- 20. Get distinct user_pseudo_id who had 'purchase' events between January 1 and January 5, 2021
SELECT DISTINCT `user_pseudo_id`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210105'
AND LOWER(`event_name`) = 'purchase'
LIMIT 1000
Results:
user_pseudo_id
1055969.5872512303
3024189.6101670146
7296845.4997447007
42807215.0722008548
43382307.1290802082
51954044.7234105463
77052125.0799530822
22857919.0356368006
25040095.0670087088
80435974.9462183494
40569893.9835575904
78839661.7033676134
84647660.6681637188
85305313.7561330759
3048586.2373315420
5257023.2131424569
7634450.7489916014
7828968.5532093675
17494077.2658372366
22300841.9909876299
33280841.1628915296
47439165.5147551041
49456942.0436829148
2885429.0157235569
8894775.5253595050
62524109.3161787418
18161607.9002799024
24207018.3974015161
6097102.6516338254
68780200.6423809280
71568861.8035326636
72959035.2192369480
74650484.1255761858
6283343.2195449706
77327261.9614153178
78207562.9231433824
6363623135.4270133281
1158637.0383647084
46574324.9683380755
59643921.1694992453
44810382.7311730027
59487571.9263599382
88827381.9303945281
75571709.1157982540
2459937.2318206302
2637438.5895621403
2838161.4781702653
3056927.8375951035
3593045.4474754034
4181862.5710073931
5155655.8559554783
5963534.4700679023
6115983.2241878817
9220684.1553390889
19492128.7016911946
24377658.7213551870
28988900.6959315645
32591508.2385963314
39214432.1935349913
45529743.2756914140
74972717.1202590271
84389355.3658704825
84496993.3019099787
87431455.4720611025
6282998.3933758831
52461093.3056333183
73370809.3757379160
7312667.0266395141
41803452.7850037461
25712283.2548580985
61389953.5535318141
3351786.5083077372
40650638.8176789956
87047667.1042912591
68546038.8820428933
6101467.4740745406
15817556.8554808751
50844046.9564028621
53104811.8176614311
2783014.3813479767
3354006.4211651279
53550354.6354713181
1160488.2375923167

2025-01-19 22:21:59 - root - INFO - itercount: 0
2025-01-19 22:21:59 - root - INFO - Database Name: bigquery-public-data
Schema Name: ga4_obfuscated_sample_ecommerce
DDL describes table information.
,0
table_name,events_20210109
ddl,"CREATE TABLE `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210109`
(
  event_date STRING,
  event_timestamp INT64,
  event_name STRING,
  event_params ARRAY<STRUCT<key STRING, value STRUCT<string_value STRING, int_value INT64, float_value FLOAT64, double_value FLOAT64>>>,
  event_previous_timestamp INT64,
  event_value_in_usd FLOAT64,
  event_bundle_sequence_id INT64,
  event_server_timestamp_offset INT64,
  user_id STRING,
  user_pseudo_id STRING,
  privacy_info STRUCT<analytics_storage INT64, ads_storage INT64, uses_transient_token STRING>,
  user_properties ARRAY<STRUCT<key INT64, value STRUCT<string_value INT64, int_value INT64, float_value INT64, double_value INT64, set_timestamp_micros INT64>>>,
  user_first_touch_timestamp INT64,
  user_ltv STRUCT<revenue FLOAT64, currency STRING>,
  device STRUCT<category STRING, mobile_brand_name STRING, mobile_model_name STRING, mobile_marketing_name STRING, mobile_os_hardware_model INT64, operating_system STRING, operating_system_version STRING, vendor_id INT64, advertising_id INT64, language STRING, is_limited_ad_tracking STRING, time_zone_offset_seconds INT64, web_info STRUCT<browser STRING, browser_version STRING>>,
  geo STRUCT<continent STRING, sub_continent STRING, country STRING, region STRING, city STRING, metro STRING>,
  app_info STRUCT<id STRING, version STRING, install_store STRING, firebase_app_id STRING, install_source STRING>,
  traffic_source STRUCT<medium STRING, name STRING, source STRING>,
  stream_id INT64,
  platform STRING,
  event_dimensions STRUCT<hostname STRING>,
  ecommerce STRUCT<total_item_quantity INT64, purchase_revenue_in_usd FLOAT64, purchase_revenue FLOAT64, refund_value_in_usd FLOAT64, refund_value FLOAT64, shipping_value_in_usd FLOAT64, shipping_value FLOAT64, tax_value_in_usd FLOAT64, tax_value FLOAT64, unique_items INT64, transaction_id STRING>,
  items ARRAY<STRUCT<item_id STRING, item_name STRING, item_brand STRING, item_variant STRING, item_category STRING, item_category2 STRING, item_category3 STRING, item_category4 STRING, item_category5 STRING, price_in_usd FLOAT64, price FLOAT64, quantity INT64, item_revenue_in_usd FLOAT64, item_revenue FLOAT64, item_refund_in_usd FLOAT64, item_refund FLOAT64, coupon STRING, affiliation STRING, location_id STRING, item_list_id STRING, item_list_name STRING, item_list_index STRING, promotion_id STRING, promotion_name STRING, creative_name STRING, creative_slot STRING>>
);"

Some other tables have the similar structure: ['events_20210109', 'events_20201109', 'events_20210110', 'events_20210123', 'events_20201107', 'events_20201111', 'events_20201228', 'events_20201224', 'events_20210119', 'events_20201105', 'events_20210131', 'events_20201218', 'events_20210124', 'events_20201222', 'events_20210103', 'events_20210127', 'events_20210108', 'events_20201120', 'events_20201130', 'events_20201124', 'events_20210104', 'events_20201115', 'events_20210128', 'events_20210121', 'events_20201114', 'events_20201127', 'events_20210111', 'events_20210118', 'events_20210113', 'events_20201212', 'events_20201113', 'events_20201221', 'events_20210112', 'events_20210120', 'events_20210101', 'events_20201209', 'events_20201206', 'events_20201225', 'events_20201129', 'events_20201112', 'events_20201230', 'events_20210115', 'events_20210107', 'events_20201210', 'events_20201121', 'events_20201215', 'events_20201229', 'events_20201123', 'events_20201204', 'events_20201201', 'events_20210102', 'events_20210106', 'events_20201205', 'events_20201226', 'events_20201211', 'events_20201203', 'events_20201102', 'events_20201106', 'events_20201213', 'events_20201128', 'events_20210105', 'events_20201220', 'events_20201117', 'events_20201231', 'events_20201208', 'events_20201108', 'events_20201214', 'events_20201207', 'events_20201223', 'events_20210117', 'events_20201219', 'events_20201110', 'events_20201122', 'events_20210130', 'events_20201216', 'events_20210126', 'events_20210129', 'events_20210125', 'events_20201227', 'events_20201126', 'events_20201217', 'events_20201101', 'events_20201116', 'events_20201103', 'events_20210122', 'events_20201104', 'events_20210114', 'events_20210116', 'events_20201119', 'events_20201125', 'events_20201118', 'events_20201202']
External knowledge that might be helpful: 
# GA4 - BigQuery Export schema

This article explains the format and schema of the Google Analytics 4 property data and the Google Analytics for Firebase data that is exported to BigQuery.

## Datasets

For each Google Analytics 4 property and each Firebase project that is linked to BigQuery, a single dataset named "analytics_<property_id>" is added to your BigQuery project. Property ID refers to your Analytics Property ID, which you can find in the property settings for your Google Analytics 4 property, and in App Analytics Settings in Firebase. Each Google Analytics 4 property and each app for which BigQuery exporting is enabled will export its data to that single dataset.

## Tables

Within each dataset, a table named `events_YYYYMMDD` is created each day if the Daily export option is enabled.

If the Streaming export option is enabled, a table named`events_intraday_YYYYMMDD`is created. This table is populated continuously as events are recorded throughout the day. This table is deleted at the end of each day once `events_YYYYMMDD` is complete.

Not all devices on which events are triggered send their data to Analytics on the same day the events are triggered. To account for this latency, Analytics will update the daily tables (`events_YYYYMMDD`) with events for those dates for up to three days after the dates of the events. Events will have the correct time stamp regardless of arriving late. Events that arrive after that three-day window are not recorded.

## Columns

Each column in the `events_YYYYMMDD`table represents an event-specific parameter. Note that some parameters are nested within RECORDS, and some RECORDS such as
`[items](https://support.google.com/analytics/answer/7029846?hl=en&ref_topic=9359001&sjid=16041154979191290935-EU#items)`
and
`[event_params](https://support.google.com/analytics/answer/7029846?hl=en&ref_topic=9359001&sjid=16041154979191290935-EU#event_params)`
are repeatable. Table columns are described below.

### event

The event fields contain information that uniquely identifies an event.

| Field name | Data type | Description |
|---|---|---|
| batch_event_index | INTEGER | A number indicating the sequential order of each event within a batch based on their order of occurrence on the device. |
| batch_ordering_id | INTEGER | A monotonically increasing number that is incremented each time a network request is sent from a given page. |
| batch_page_id | INTEGER | A sequential number assigned to a page that increases for each subsequent page within an engagement. |
| event_date | STRING | The date when the event was logged (YYYYMMDD format in the registered timezone of your app). |
| event_timestamp | INTEGER | The time (in microseconds, UTC) when the event was logged on the client. |
| event_previous_timestamp | INTEGER | The time (in microseconds, UTC) when the event was previously logged on the client. |
| event_name | STRING | The name of the event. |
| event_value_in_usd | FLOAT | The currency-converted value (in USD) of the event's "value" parameter. |
| event_bundle_sequence_id | INTEGER | The sequential ID of the bundle in which these events were uploaded. |
| event_server_timestamp_offset | INTEGER | Timestamp offset between collection time and upload time in micros. |

#### event_params RECORD

The event_params RECORD can store campaign-level and contextual event parameters as well as any user-defined event parameters. The event_params RECORD is repeated for each key that is associated with an event. The set of parameters stored in the event_params RECORD is unique to each implementation. To see the complete list of event parameters for your implementation, query the event parameter list.

| Field name | Data type | Description |
|---|---|---|
| event_params.key | STRING | The name of the event parameter. |
| event_params.value | RECORD | A record containing the event parameter's value. |
| event_params.value.string_value | STRING | If the event parameter is represented by a string, such as a URL or campaign name, it is populated in this field. |
| event_params.value.int_value | INTEGER | If the event parameter is represented by an integer, it is populated in this field. |
| event_params.value.double_value | FLOAT | If the event parameter is represented by a double value, it is populated in this field. |
| event_params.value.float_value | FLOAT | If the event parameter is represented by a floating point value, it is populated in this field. This field is not currently in use. |

#### item_params RECORD

The item_params RECORD can store item parameters as well as any user-defined item parameters. The set of parameters stored in the item_params RECORD is unique to each implementation.

| Field name | Data type | Description |
|---|---|---|
| item_params.key | STRING | The name of the item parameter. |
| item_params.value | RECORD | A record containing the item parameter’s value. |
| item_params.value.string_value | STRING | If the item parameter is represented by a string, it is populated in this field. |
| item_params.value.int_value | INTEGER | If the item parameter is represented by an integer, it is populated in this field. |
| item_params.value.double_value | FLOAT | If the item parameter is represented by a double value, it is populated in this field. |
| item_params.value.float_value | FLOAT | If the item parameter is represented by a floating point value, it is populated in this field. | 

### user

The user fields contain information that uniquely identifies the user associated with the event.

| Field name | Data type | Description |
|---|---|---|
| is_active_user | BOOLEAN | Whether the user was active (True) or inactive (False) at any point in the calendar day Included in only the daily tables ( events_YYYYMMDD) . |
| user_id | STRING | The unique ID assigned to a user. |
| user_pseudo_id | STRING | The pseudonymous id (e.g., app instance ID) for the user. |
| user_first_touch_timestamp | INTEGER | The time (in microseconds) at which the user first opened the app or visited the site. |

#### privacy_info fields

The privacy_info fields contain information based on the consent status of a user when consent mode is enabled .

| Field name | Data type | Description |
|---|---|---|
| privacy_info.ads_storage | STRING | Whether ad targeting is enabled for a user. Possible values: Yes, No, Unset |
| privacy_info.analytics_storage | STRING | Whether Analytics storage is enabled for the user. Possible values: Yes, No, Unset |
| privacy_info.uses_transient_token | STRING | Whether a web user has denied Analytics storage and the developer has enabled measurement without cookies based on transient tokens in server data. Possible values: Yes, No, Unset |

#### user_properties RECORD

The user_properties RECORD contains any user properties that you have set. It is repeated for each key that is associated with a user.

| Field name | Data type | Description |
|---|---|---|
| user_properties.key | STRING | The name of the user property. |
| user_properties.value | RECORD | A record for the user property value. |
| user_properties.value.string_value | STRING | The string value of the user property. |
| user_properties.value.int_value | INTEGER | The integer value of the user property. |
| user_properties.value.double_value | FLOAT | The double value of the user property. |
| user_properties.value.float_value | FLOAT | This field is currently unused. |
| user_properties.value.set_timestamp_micros | INTEGER | The time (in microseconds) at which the user property was last set. |

#### user_ltv RECORD

The user_ltv RECORD contains Lifetime Value information about the user. This RECORD is not populated in intraday tables.

| Field name | Data type | Description |
|---|---|---|
| user_ltv.revenue | FLOAT | The Lifetime Value (revenue) of the user. This field is not populated in intraday tables. |
| user_ltv.currency | STRING | The Lifetime Value (currency) of the user. This field is not populated in intraday tables. | 

### device

The device RECORD contains information about the device from which the event originated.

| Field name | Data type | Description |
|---|---|---|
| device.category | STRING | The device category (mobile, tablet, desktop). |
| device.mobile_brand_name | STRING | The device brand name. |
| device.mobile_model_name | STRING | The device model name. |
| device.mobile_marketing_name | STRING | The device marketing name. |
| device.mobile_os_hardware_model | STRING | The device model information retrieved directly from the operating system. |
| device.operating_system | STRING | The operating system of the device. |
| device.operating_system_version | STRING | The OS version. |
| device.vendor_id | STRING | IDFV (present only if IDFA is not collected). |
| device.advertising_id | STRING | Advertising ID/IDFA. |
| device.language | STRING | The OS language. |
| device.time_zone_offset_seconds | INTEGER | The offset from GMT in seconds. |
| device.is_limited_ad_tracking | BOOLEAN | The device's Limit Ad Tracking setting. On iOS14+, returns false if the IDFA is non-zero. |
| device.web_info.browser | STRING | The browser in which the user viewed content. |
| device.web_info.browser_version | STRING | The version of the browser in which the user viewed content. |
| device.web_info.hostname | STRING | The hostname associated with the logged event. | 

### geo

The geo RECORD contains information about the geographic location where the event was initiated.

| Field name | Data type | Description |
|---|---|---|
| geo.continent | STRING | The continent from which events were reported, based on IP address. |
| geo.sub_continent | STRING | The subcontinent from which events were reported, based on IP address. |
| geo.country | STRING | The country from which events were reported, based on IP address. |
| geo.region | STRING | The region from which events were reported, based on IP address. |
| geo.metro | STRING | The metro from which events were reported, based on IP address. |
| geo.city | STRING | The city from which events were reported, based on IP address. | 

### app_info

The app_info RECORD contains information about the app in which the event was initiated. | Field name | Data type | Description |
|---|---|---|
| app_info.id | STRING | The package name or bundle ID of the app. |
| app_info.firebase_app_id | STRING | The Firebase App ID associated with the app |
| app_info.install_source | STRING | The store that installed the app. |
| app_info.version | STRING | The app's versionName (Android) or short bundle version. | 

### collected_traffic_source

The collected_traffic_source RECORD contains the traffic source data that was collected with the event.

| Field name | Data type | Description |
|---|---|---|
| manual_campaign_id | STRING | The manual campaign id (utm_id) that was collected with the event. |
| manual_campaign_name | STRING | The manual campaign name (utm_campaign) that was collected with the event. |
| manual_source | STRING | The manual campaign source (utm_source) that was collected with the event. Also includes parsed parameters from referral params, not just UTM values. |
| manual_medium | STRING | The manual campaign medium (utm_medium) that was collected with the event. Also includes parsed parameters from referral params, not just UTM values. |
| manual_term | STRING | The manual campaign keyword/term (utm_term) that was collected with the event. |
| manual_content | STRING | The additional manual campaign metadata (utm_content) that was collected with the event. |
| manual_creative_format | STRING | The manual campaign creative format (utm_creative_format) that was collected with the event. |
| manual_marketing_tactic | STRING | The manual campaign marketing tactic (utm_marketing_tactic) that was collected with the event. |
| manual_source_platform | STRING | The manual campaign source platform (utm_source_platform) that was collected with the event. |
| gclid | STRING | The Google click identifier that was collected with the event. |
| dclid | STRING | The DoubleClick Click Identifier for Display and Video 360 and Campaign Manager 360 that was collected with the event. |
| srsltid | STRING | The Google Merchant Center identifier that was collected with the event. | 

### session_traffic_source_last_click

The session_traffic_source_last_click RECORD contains the last-click attributed session traffic source data across Google ads and manual contexts, where available.

| Field Name | Data Type | Description |
|---|---|---|
| session_traffic_source_last_click. manual_campaign.campaign_id | STRING | The ID of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.campaign_name | STRING | The name of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.medium | STRING | The medium of the last clicked manual campaign (e.g., paid search, organic search, email) |
| session_traffic_source_last_click. manual_campaign.term | STRING | The keyword/search term of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.content | STRING | Additional metadata of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.source_platform | STRING | The platform of the last clicked manual campaign (e.g., search engine, social media) |
| session_traffic_source_last_click. manual_campaign.source | STRING | The specific source within the platform of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.creative_format | STRING | The format of the creative of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.marketing_tactic | STRING | The marketing tactic of the last clicked manual campaign |
| session_traffic_source_last_click. google_ads_campaign.customer_id | STRING | The customer ID associated with the Google Ads account |
| session_traffic_source_last_click. google_ads_campaign.account_name | STRING | The name of the Google Ads account |
| session_traffic_source_last_click. google_ads_campaign.campaign_id | STRING | The ID of the Google Ads campaign |
| session_traffic_source_last_click. google_ads_campaign.campaign_name | STRING | The name of the Google Ads campaign |
| session_traffic_source_last_click. google_ads_campaign.ad_group_id | STRING | The ID of the ad group within the Google Ads campaign |
| session_traffic_source_last_click. google_ads_campaign.ad_group_name | STRING | The name of the ad group within the Google Ads campaign | 

### traffic_source

The traffic_source RECORD contains information about the traffic source that first acquired the user. This record is not populated in intraday tables. Note: The traffic_source values do not change if the user interacts with subsequent campaigns after installation.

| Field name | Data type | Description |
|---|---|---|
| traffic_source.name | STRING | Name of the marketing campaign that first acquired the user. This field is not populated in intraday tables. |
| traffic_source.medium | STRING | Name of the medium (paid search, organic search, email, etc.) that first acquired the user. This field is not populated in intraday tables. |
| traffic_source.source | STRING | Name of the network that first acquired the user. This field is not populated in intraday tables. | 

### stream and platform

The stream and platform fields contain information about the stream and the app platform.

| Field name | Data type | Description |
|---|---|---|
| stream_id | STRING | The numeric ID of the data stream from which the event originated. |
| platform | STRING | The data stream platform (Web, IOS or Android) from which the event originated. | 

### ecommerce

This ecommerce RECORD contains information about any ecommerce events that have been setup on a website or app.

| Field name | Data type | Description |
|---|---|---|
| ecommerce.total_item_quantity | INTEGER | Total number of items in this event, which is the sum of items.quantity. |
| ecommerce.purchase_revenue_in_usd | FLOAT | Purchase revenue of this event, represented in USD with standard unit. Populated for purchase event only. |
| ecommerce.purchase_revenue | FLOAT | Purchase revenue of this event, represented in local currency with standard unit. Populated for purchase event only. |
| ecommerce.refund_value_in_usd | FLOAT | The amount of refund in this event, represented in USD with standard unit. Populated for refund event only. |
| ecommerce.refund_value | FLOAT | The amount of refund in this event, represented in local currency with standard unit. Populated for refund event only. |
| ecommerce.shipping_value_in_usd | FLOAT | The shipping cost in this event, represented in USD with standard unit. |
| ecommerce.shipping_value | FLOAT | The shipping cost in this event, represented in local currency. |
| ecommerce.tax_value_in_usd | FLOAT | The tax value in this event, represented in USD with standard unit. |
| ecommerce.tax_value | FLOAT | The tax value in this event, represented in local currency with standard unit. |
| ecommerce.transaction_id | STRING | The transaction ID of the ecommerce transaction. |
| ecommerce.unique_items | INTEGER | The number of unique items in this event, based on item_id, item_name, and item_brand. | 

### items

The items RECORD contains information about items included in an event. It is repeated for each item.

| Field name | Data type | Description |
|---|---|---|
| items.item_id | STRING | The ID of the item. |
| items.item_name | STRING | The name of the item. |
| items.item_brand | STRING | The brand of the item. |
| items.item_variant | STRING | The variant of the item. |
| items.item_category | STRING | The category of the item. |
| items.item_category2 | STRING | The sub category of the item. |
| items.item_category3 | STRING | The sub category of the item. |
| items.item_category4 | STRING | The sub category of the item. |
| items.item_category5 | STRING | The sub category of the item. |
| items.price_in_usd | FLOAT | The price of the item, in USD with standard unit. |
| items.price | FLOAT | The price of the item in local currency. |
| items.quantity | INTEGER | The quantity of the item. Quantity set to 1 if not specified. |
| items.item_revenue_in_usd | FLOAT | The revenue of this item, calculated as price_in_usd * quantity. It is populated for purchase events only, in USD with standard unit. |
| items.item_revenue | FLOAT | The revenue of this item, calculated as price * quantity. It is populated for purchase events only, in local currency with standard unit. |
| items.item_refund_in_usd | FLOAT | The refund value of this item, calculated as price_in_usd * quantity. It is populated for refund events only, in USD with standard unit. |
| items.item_refund | FLOAT | The refund value of this item, calculated as price * quantity. It is populated for refund events only, in local currency with standard unit. |
| items.coupon | STRING | Coupon code applied to this item. |
| items.affiliation | STRING | A product affiliation to designate a supplying company or brick and mortar store location. |
| items.location_id | STRING | The location associated with the item. |
| items.item_list_id | STRING | The ID of the list in which the item was presented to the user. |
| items.item_list_name | STRING | The name of the list in which the item was presented to the user. |
| Items.item_list_index | STRING | The position of the item in a list. |
| items.promotion_id | STRING | The ID of a product promotion. |
| items.promotion_name | STRING | The name of a product promotion. |
| items.creative_name | STRING | The name of a creative used in a promotional spot. |
| items.creative_slot | STRING | The name of a creative slot. |

#### item_params RECORD

The item_params RECORD stores the custom item parameters that you defined. Note that predefined item parameters like item_id, item_name etc, are not included here, instead they are exported as explicit fields. The set of parameters stored in the item_params RECORD is unique to each implementation. To learn more about ecommerce implementations and the Google Analytics 4 items array, see Measure ecommerce .

| Field name | Data type | Description |
|---|---|---|
| items.item_params.key | STRING | The name of the item parameter. |
| items.item_params.value | RECORD | A record containing the item parameter’s value. |
| items.item_params.value.string_value | STRING | If the item parameter is represented by a string, it is populated in this field. |
| items.item_params.value.int_value | INTEGER | If the item parameter is represented by an integer, it is populated in this field. |
| items.item_params.value.double_value | FLOAT | If the item parameter is represented by a double value, it is populated in this field. |
| items.item_params.value.float_value | FLOAT | If the item parameter is represented by a floating point value, it is populated in this field. | 

## Rows

Data for a single event may be represented in one or multiple rows, depending on whether it contains repeated RECORDS. A `page_view` event with multiple
`[event_params](https://support.google.com/analytics/answer/7029846?hl=en&ref_topic=9359001&sjid=16041154979191290935-EU#event_params)`,
for example, would look similar to the following table. The initial row contains the event name, date, timestamp and other non-repeated data items. The
`[event_params](https://support.google.com/analytics/answer/7029846?hl=en&ref_topic=9359001&sjid=16041154979191290935-EU#event_params)`
RECORD is repeated for each parameter associated with the event. These repeated RECORDS are populated in subsequent rows directly under the initial event row.

| event_date | event_timestamp | event_name | event_params.key | event_params_value.string_value |
|---|---|---|---|---|
| 20220222 | 1643673600483790 | page_view | page_location | https://example.com |
| - | - | - | page_title | Home |
| - | - | - | medium | referral |
| - | - | - | source | google |
| - | - | - | page_referrer | https://www.google.com |
| - | - | - | parameters... | values... |
The table structure information is ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'ga4_obfuscated_sample_ecommerce': ['events_20201101', 'events_20201102', 'events_20201103', 'events_20201104', 'events_20201105', 'events_20201106', 'events_20201107', 'events_20201108', 'events_20201109', 'events_20201110', 'events_20201111', 'events_20201112', 'events_20201113', 'events_20201114', 'events_20201115', 'events_20201116', 'events_20201117', 'events_20201118', 'events_20201119', 'events_20201120', 'events_20201121', 'events_20201122', 'events_20201123', 'events_20201124', 'events_20201125', 'events_20201126', 'events_20201127', 'events_20201128', 'events_20201129', 'events_20201130', 'events_20201201', 'events_20201202', 'events_20201203', 'events_20201204', 'events_20201205', 'events_20201206', 'events_20201207', 'events_20201208', 'events_20201209', 'events_20201210', 'events_20201211', 'events_20201212', 'events_20201213', 'events_20201214', 'events_20201215', 'events_20201216', 'events_20201217', 'events_20201218', 'events_20201219', 'events_20201220', 'events_20201221', 'events_20201222', 'events_20201223', 'events_20201224', 'events_20201225', 'events_20201226', 'events_20201227', 'events_20201228', 'events_20201229', 'events_20201230', 'events_20201231', 'events_20210101', 'events_20210102', 'events_20210103', 'events_20210104', 'events_20210105', 'events_20210106', 'events_20210107', 'events_20210108', 'events_20210109', 'events_20210110', 'events_20210111', 'events_20210112', 'events_20210113', 'events_20210114', 'events_20210115', 'events_20210116', 'events_20210117', 'events_20210118', 'events_20210119', 'events_20210120', 'events_20210121', 'events_20210122', 'events_20210123', 'events_20210124', 'events_20210125', 'events_20210126', 'events_20210127', 'events_20210128', 'events_20210129', 'events_20210130', 'events_20210131']}}
Begin Exploring Related Columns
**Columns and potential usage:**

- `user_pseudo_id`: Used to uniquely identify pseudo users.
- `event_date`: Used to filter events within specific date ranges.

**Conditions that may be used:**

- `event_date` between '20210101' and '20210105' to find users active in the last 7 days (excluding the last 2 days).
- `event_date` between '20210106' and '20210107' to find users active in the last 2 days.

---

**SQL Queries:**

```sql
-- 1. Get distinct user_pseudo_id from events on January 1, 2021
SELECT DISTINCT `user_pseudo_id`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
LIMIT 1000;

-- 2. Get distinct user_pseudo_id from events between January 1 and January 5, 2021
SELECT DISTINCT `user_pseudo_id`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210105'
LIMIT 1000;

-- 3. Get the count of events per event_date between January 1 and January 5, 2021
SELECT `event_date`, COUNT(*) AS event_count
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210105'
GROUP BY `event_date`
LIMIT 1000;

-- 4. List unique event_name values on January 1, 2021
SELECT DISTINCT `event_name`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
LIMIT 1000;

-- 5. Get the number of events per user_pseudo_id on January 1, 2021
SELECT `user_pseudo_id`, COUNT(*) AS event_count
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
GROUP BY `user_pseudo_id`
LIMIT 1000;

-- 6. Get distinct user_pseudo_id who had events on January 6, 2021
SELECT DISTINCT `user_pseudo_id`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210106`
LIMIT 1000;

-- 7. Get distinct user_pseudo_id who had events on January 7, 2021
SELECT DISTINCT `user_pseudo_id`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210107`
LIMIT 1000;

-- 8. Get the count of events per event_name on January 1, 2021
SELECT `event_name`, COUNT(*) AS event_count
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
GROUP BY `event_name`
LIMIT 1000;

-- 9. Get the earliest event_timestamp per user_pseudo_id on January 1, 2021
SELECT `user_pseudo_id`, MIN(`event_timestamp`) AS first_event_timestamp
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
GROUP BY `user_pseudo_id`
LIMIT 1000;

-- 10. Get the list of event_params keys on January 1, 2021
SELECT DISTINCT ep.key
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`,
UNNEST(`event_params`) AS ep
LIMIT 1000;

-- 11. Extract string_value from event_params where key is 'page_location' on January 1, 2021
SELECT ep.value.string_value
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101` AS t,
UNNEST(t.event_params) AS ep
WHERE LOWER(ep.key) = 'page_location'
LIMIT 1000;

-- 12. Get the number of users per day between January 1 and January 5, 2021
SELECT `event_date`, COUNT(DISTINCT `user_pseudo_id`) AS user_count
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210105'
GROUP BY `event_date`
LIMIT 1000;

-- 13. List distinct platforms used between January 1 and January 5, 2021
SELECT DISTINCT `platform`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210105'
LIMIT 1000;

-- 14. Get the count of events per device category on January 1, 2021
SELECT device.category, COUNT(*) AS event_count
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
GROUP BY device.category
LIMIT 1000;

-- 15. Get distinct user_pseudo_id active between January 1 and January 5, 2021 but not on January 6 and 7, 2021
SELECT DISTINCT `user_pseudo_id`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210105'
AND `user_pseudo_id` NOT IN (
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210106`
  UNION DISTINCT
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210107`
)
LIMIT 1000;

-- 16. Get distinct event_dates from events between January 1 and January 7, 2021
SELECT DISTINCT `event_date`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210107'
LIMIT 1000;

-- 17. Get the top 1000 user_pseudo_id with the most events on January 1, 2021
SELECT `user_pseudo_id`, COUNT(*) AS event_count
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
GROUP BY `user_pseudo_id`
ORDER BY event_count DESC
LIMIT 1000;

-- 18. Get distinct values of device.operating_system used on January 1, 2021
SELECT DISTINCT device.operating_system
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
LIMIT 1000;

-- 19. Get counts of events per country on January 1, 2021
SELECT geo.country, COUNT(*) AS event_count
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
GROUP BY geo.country
LIMIT 1000;

-- 20. Get distinct user_pseudo_id who had 'purchase' events between January 1 and January 5, 2021
SELECT DISTINCT `user_pseudo_id`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210105'
AND LOWER(`event_name`) = 'purchase'
LIMIT 1000;
```Query:
-- 1. Get distinct user_pseudo_id from events on January 1, 2021
SELECT DISTINCT `user_pseudo_id`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
LIMIT 1000
Answer:
Too long, hard cut:
user_pseudo_id
1003046.9452926974
1023282.4639847710
1026043.4481623879
1026409.1551860912
1032138.1796039159
1037928.9294661675
1045950.7099606829
1051288.9523352374
1054372.6755770068
1064574.6224708641
1066655.6240997015
1080064.0071613184
1082746.7285674512
1097358.9593491100
1104313.9641823605
1107198.5152483918
1112823.8475775772
1116587.1725520171
1127824.3503063268
1134825.6533092350
1138692.0103796281
1160488.2375923167
1164648.0319944302
1168297.2853699605
1170405.4925804370
1174066.6437027818
1178889.6850461952
1188134.8498680538
1205590.2516186397
1211099.8247563235
1213932.4846099850
1215465.1474478000
1218586.5350251990
1240786.8917310160
1246063.3665874179
1255322.2973246181
1259302.9069938124
1269423.6724500672
1275797.1936238018
1277765.6068129494
1296701.2382814729
1308776.9803994658
1318624.9067804638
1320187.6719997668
1326289.2331853598
1333091.0887566663
1352892.5937639189
1375005.2583322863
1382535.7283137323
1385112.5897617274
1396456.6482506733
1401649.9529464111
1422161.0871788362
1437260.5988606411
1448835.0934102497
1453555.6810069410
1453951.1387928223
1456890.1673716823
1459436.8826692932
1473136.1149103090
1485472.4390061373
1499810.5142637849
1501018.3808301483
1503421.5168556763
1515646.3111272928
1518831.1475327211
1519124.8641457524
1534689.9343310805
1539940.5253610440
1543004.7243225422
1550901.3980286554
1564015.6880680172
1575061.4789497906
1582390.8206269591
1616136.8949543878
1619900.3195973863
1620024.8966870933
1646722.0078157231
1674937.2501954408
1677450.9117017807
1680043.1145812114
1684301.4109152707
1688147.2939632391
1693134.9790437518
1694910.7733232660
1699037.5870634483
1707918.4797422153
1713530.3382800695
1719564.6333875501
1729803.5105688857
1734528.1974041204
1745072.0004799132
1745171.2191701968
1749246.8534368616
1759212.2216007988
1762263.6990880514
1765594.3047173009
1784794.0627143380
1804199.2014328535
1820733.6464417466
1829763.3860332334
1846974.0316175078
1859470.4546513665
1884090.9722372635
1886250.8920156183
1912537.7440240268
1958116.3750166429
1958256.0896241884
1961265.4757052307
1967725.7354072666
1990491.3893000361
1993768.0582544668
1999213.1832096854
2007362.2149327588
2007867.8957787066
2019465.0056495205
2029664.5317923957
2041235.3400307589
2044855.8624761839
2077981.6202330137
2084772.9471491241
2091407.8804833129
2102395.6721696580
2142722.9676010623
2150276.2168438227
2157133.5876722467
2159725.7481437355
2165252.0147518395
2167343.6164963557
2168528.2202958861
2194957.7885097322
2228172.7936687802
2244553.9738621373
2245992.8909040661
2247846.3358362547
2263288.5212004372
2264573.5209212671
2268837.3082004933
2272023.1096248377
2275476.3701234224
2290904.3176780756
2304235.4728947355
2311908.3797713386
2322051.0966144624
2327547.5435328629
2329161.7120010083
2340587.9439563847
2344300.8375944627
2362829.7919429820
2375215.3636092839
2376646.7974930863
2378480.6534474606
2382451.4611706340
2384902.1644296925
2411763.0850272555
2417078.3361324500
2432374.8482039518
2437853.8047077377
2438148.3441039719
2463849.3270043637
2484010.5620979211
2485922.5515109543
2486846.9299481244
2489685.1683265365
2492721.1881800375
2501661.0331987453
2506075.7314444580
2539661.0024435471
2560700.2802998477
2563982.7084295364
2578870.7901059159
2589245.5979068367
2599362.6005762632
2613632.7561400432
2627874.7977372146
2630765.5704087315
2648480.7456264429
2655279.4923479690
2681967.7844689964
2683925.9434937492
2687473.9692412289
2688110.9777730450
2691270.4995570828
2692657.2939750667
2694084.5852510731
2709449.6736747839
2712864.2294346749
2719657.8629194725
2739425.0432989823
2746195.3557509904
2748139.1358063966
2754697.4847843626
2755973.1582682668
2767600.1190297171
2776706.0228802998
2779137.7674526641
2781408.6267522276
2783014.3813479767
2795133.4288865632
2795240.3198638943
2796100.1284437751
2803851.7451929280
2810822.2085903402
2821509.2290888995
2838667.1045753224
2839647.6325562515
2842598.5931018472
2844832.0483599899
2849086.2703560041
2856545.1057637132
2873742.8991614203
2882177.0250975565
2885429.0157235569
2892944.4318946076
2893808.1269182675
2908071.3197159392
2910024.9071648144
2912682.3106786643
2913205.0530257308
2914301.0348640426
2916336.4829526738
2917194.9600461127
2917834.9881423689
2938826.3390148112
2952066.5004557428
2965622.6326568063
2973917.2072647263
2979122.8002670631
3001110.3208062401
3007601.9537396348
3017509.1296773380
3022409.8765357635
3024189.6101670146
3027107.9482352721
3028781.2091495833
3038064.1337656016
3053669.9263927930
3055314.8442482614
3058967.2730251282
3059739.3349984598
3067110.2430706696
3071174.0445612133
3071789.9352232891
3080224.3554853323
3080530.8466730500
3084839.1075146820
3085295.3644476516
3092109.1666656387
3134983.8555001541
3149868.5539413842
3158627.0434170250
3160960.1631301259
3168155.2539701733
3186081.3790394525
3193679.0282666132
3195953.1676635966
3203474.4486080556
3205524.3451816980
3213363.3651446553
3215534.5876119688
3218982.5426906645
3234944.4290037633
3237903
Query:
-- 2. Get distinct user_pseudo_id from events between January 1 and January 5, 2021
SELECT DISTINCT `user_pseudo_id`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210105'
LIMIT 1000
Answer:
Too long, hard cut:
user_pseudo_id
1008499.5928445086
1013760.9231029745
1014209.5295344253
1026137.2290719007
1028167.1226079449
1032092.5249707229
1053193.3273260382
1057066.6724870774
1057265.5844727802
1065673.0722289663
1067841.4647153954
1075223.2681702246
1081165.5314971225
1082690.0377265261
1103286.8251708796
1109836.9501901728
1113469.1950253831
1114181.7368629788
1121518.2859510925
1130810.6137694456
1134613.7634894426
1158637.0383647084
1164741.6860607634
1181674.5265741661
1185078.3105419781
1194575.2891034137
1214573.9183644653
1215389.2295507570
1222867.5284822262
1227012.8467411408
1238230.5582832258
1243221.1777211525
1252690.3944441209
1284535.4676055384
1288248.9113459714
1289319.0865612371
1297488.8153560940
1299487.6744511638
1307038.3688504236
1309149.1848587742
1312237.6155331000
1313329.6311058857
1314747.6066644573
1320284.3859724504
1325688.1519909745
1334969.6157017719
1339205.5397897099
1373324.8357357420
1385090.1246142947
1385662.1127085473
1401785.6584445113
1402228.3482241994
1403129.5580554677
1445737.4102905419
1450787.9898569840
1458803.4123039458
1466910.4554610435
1470241.3611852177
1471187.8226858001
1488009.3142808321
1493030.0825468207
1497130.5055593166
1500615.9964438412
1504953.0746977838
1509456.3177418451
1519189.6398973848
1522857.5896662267
1536105.5891820566
1544748.2905250855
1556885.1837167077
1560589.3791460585
1578948.0834575091
1586022.1800460720
1588332.2823326217
1588666.3949365829
1590652.6726149736
1590715.7165540392
1607100.0381093527
1622235.9923526878
1624884.8451928269
1629639.2044968342
1632927.1894987991
1634789.3752037441
1639296.9002795622
1648032.7331818100
1656975.3346712388
1659842.4321850950
1665661.9122532614
1668023.4150976276
1668416.2014466630
1672632.0859250572
1689794.6230455628
1690623.2302780540
1702019.9842929153
1702845.7520261284
1703253.2388947937
1707319.9934501562
1711048.6268268364
1711971.4968010332
1726993.2463217900
1730497.6226428479
1732811.6786855240
1745835.9106014489
1751599.1685077136
1754331.3157951821
1757510.5330787128
1765047.7773329261
1765130.1889939374
1770215.5966952525
1780294.0221405041
1787504.7670504282
1791921.4002592107
1795540.6156637931
1799135.7941835837
1806356.1249501454
1807394.6792147711
1808170.2762309629
1808232.5654454206
1824201.1380052029
1841613.4096590753
1842336.8436996882
1843227.1315168145
1855160.6431356491
1857518.5760998088
1859470.4546513665
1888732.5808117060
1891844.3029317015
1895574.3356492898
1901730.7277275021
1908860.5902672888
1922936.0279129669
1929434.4518118388
1930569.1007455155
1934857.9616833097
1945068.8887037343
1949104.1690663627
1950108.6469907871
1954953.0721200891
1966048.6599698958
1976029.4501496209
1979778.7331964605
1982815.8232892378
1983421.2936555498
1993697.9945930656
2002776.5976883193
2005618.5376901983
2014270.2546235318
2022577.6028076666
2049590.8596560881
2051318.3089832623
2055215.4967663939
2070480.7661066255
2079154.1476733507
2094642.2631508719
2096766.0019470232
2116278.5223204033
2121651.9176614852
2127898.5527858242
2131056.2525081023
2131509.8375213648
2147417.5961373356
2157825.0718936880
2164352.2670593278
2167317.9816236215
2172399.2091034226
2175416.5833910330
2177462.5220423724
2177957.7412962494
2192432.3542621657
2193948.2281082270
2194441.0544343537
2197864.5182472083
2200081.2420876058
2203449.4497261194
2204878.2541228096
2214606.8300190111
2245385.0615539791
2245567.3795914474
2248364.4469117960
2248754.7783173763
2250793.6313697017
2250953.6316204806
2258641.1629826733
2262724.6807963688
2263380.7170574283
2263420.2110121128
2265208.1282213045
2276075.8079921958
2277998.4131015438
2279457.7315196874
2284976.1899128869
2301413.0302404690
2303928.3507051479
2304235.4728947355
2327460.3641621424
2329707.0387773385
2331461.5841279593
2333408.5403558380
2346000.3226235037
2349749.6508625488
2374910.1217694068
2376240.8034284857
2376717.3509701603
2382234.3846802600
2382887.9214525018
2388941.9518774856
2392346.1836393196
2393556.1146578015
2399121.7379674359
2404535.1253227145
2415432.3160368774
2415788.3641983779
2415858.4972221670
2417805.0150005257
2418145.6199610855
2419732.5640450460
2422137.6877778640
2423973.9449466734
2425570.7323199738
2430886.9385533523
2438902.8824385354
2440353.3206892115
2445188.0327038206
2461015.7427876593
2465015.1494457724
2467393.7377682212
2491439.4728767719
2494301.6460508569
2501970.2707488768
2507894.1372177453
2526432.6035949356
2526912.7108743899
2536104.6818349493
2543445.6389301518
2543525.0285025760
2546017.5150907817
2548737.2552051276
2551167.3034654376
2551300.8505181236
2558365.7246265443
2568488.0444965897
2581316.7226811113
2587147.0479569634
2593151.6733146848
2599191.1809781484
2613533.4409425127
2613732.0466667239
2614498.1516604416
2618461.8300567593
2622647.6350409806
2624431.4002749857
2630262.0012746307
2632235.6933492055
2636673.7777856869
2637684.2664716834
2647065.8603961769
2649423.6413575526
2653272.4444281234
2656338.3348390425
2667484.7677953678
2676729.6526609799
2689361.0389768864
2691197
Query:
-- 3. Get the count of events per event_date between January 1 and January 5, 2021
SELECT `event_date`, COUNT(*) AS event_count
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210105'
GROUP BY `event_date`
LIMIT 1000
Answer:
event_date,event_count
20210101,22096
20210103,24743
20210105,42827
20210102,23599
20210104,31395
Query:
-- 4. List unique event_name values on January 1, 2021
SELECT DISTINCT `event_name`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
LIMIT 1000
Answer:
event_name
first_visit
page_view
session_start
user_engagement
scroll
view_item
add_shipping_info
view_promotion
add_payment_info
view_search_results
select_promotion
click
begin_checkout
select_item
purchase
add_to_cart
Query:
-- 5. Get the number of events per user_pseudo_id on January 1, 2021
SELECT `user_pseudo_id`, COUNT(*) AS event_count
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
GROUP BY `user_pseudo_id`
LIMIT 1000
Answer:
Too long, hard cut:
user_pseudo_id,event_count
1003046.9452926974,5
1023282.4639847710,77
1026043.4481623879,9
1026409.1551860912,8
1032138.1796039159,5
1037928.9294661675,5
1045950.7099606829,5
1051288.9523352374,6
1054372.6755770068,5
1064574.6224708641,5
1066655.6240997015,4
1080064.0071613184,9
1082746.7285674512,5
1097358.9593491100,2
1104313.9641823605,5
1107198.5152483918,6
1112823.8475775772,73
1116587.1725520171,5
1127824.3503063268,7
1134825.6533092350,5
1138692.0103796281,6
1160488.2375923167,427
1164648.0319944302,20
1168297.2853699605,5
1170405.4925804370,12
1174066.6437027818,5
1178889.6850461952,5
1188134.8498680538,114
1205590.2516186397,3
1211099.8247563235,25
1213932.4846099850,4
1215465.1474478000,11
1218586.5350251990,6
1240786.8917310160,5
1246063.3665874179,8
1255322.2973246181,3
1259302.9069938124,9
1269423.6724500672,10
1275797.1936238018,10
1277765.6068129494,5
1296701.2382814729,3
1308776.9803994658,7
1318624.9067804638,4
1320187.6719997668,5
1326289.2331853598,5
1333091.0887566663,5
1352892.5937639189,9
1375005.2583322863,6
1382535.7283137323,14
1385112.5897617274,4
1396456.6482506733,2
1401649.9529464111,5
1422161.0871788362,9
1437260.5988606411,6
1448835.0934102497,5
1453555.6810069410,3
1453951.1387928223,12
1456890.1673716823,5
1459436.8826692932,3
1473136.1149103090,17
1485472.4390061373,5
1499810.5142637849,4
1501018.3808301483,5
1503421.5168556763,12
1515646.3111272928,5
1518831.1475327211,6
1519124.8641457524,19
1534689.9343310805,4
1539940.5253610440,9
1543004.7243225422,5
1550901.3980286554,4
1564015.6880680172,4
1575061.4789497906,6
1582390.8206269591,5
1616136.8949543878,4
1619900.3195973863,5
1620024.8966870933,5
1646722.0078157231,48
1674937.2501954408,8
1677450.9117017807,8
1680043.1145812114,4
1684301.4109152707,38
1688147.2939632391,5
1693134.9790437518,5
1694910.7733232660,7
1699037.5870634483,3
1707918.4797422153,3
1713530.3382800695,9
1719564.6333875501,5
1729803.5105688857,4
1734528.1974041204,6
1745072.0004799132,4
1745171.2191701968,28
1749246.8534368616,13
1759212.2216007988,5
1762263.6990880514,6
1765594.3047173009,5
1784794.0627143380,5
1804199.2014328535,5
1820733.6464417466,8
1829763.3860332334,31
1846974.0316175078,10
1859470.4546513665,14
1884090.9722372635,12
1886250.8920156183,4
1912537.7440240268,1
1958116.3750166429,6
1958256.0896241884,5
1961265.4757052307,4
1967725.7354072666,5
1990491.3893000361,67
1993768.0582544668,5
1999213.1832096854,17
2007362.2149327588,4
2007867.8957787066,5
2019465.0056495205,5
2029664.5317923957,5
2041235.3400307589,5
2044855.8624761839,4
2077981.6202330137,5
2084772.9471491241,3
2091407.8804833129,9
2102395.6721696580,6
2142722.9676010623,27
2150276.2168438227,2
2157133.5876722467,18
2159725.7481437355,5
2165252.0147518395,5
2167343.6164963557,4
2168528.2202958861,4
2194957.7885097322,4
2228172.7936687802,6
2244553.9738621373,18
2245992.8909040661,5
2247846.3358362547,3
2263288.5212004372,15
2264573.5209212671,6
2268837.3082004933,5
2272023.1096248377,7
2275476.3701234224,5
2290904.3176780756,5
2304235.4728947355,6
2311908.3797713386,5
2322051.0966144624,9
2327547.5435328629,6
2329161.7120010083,7
2340587.9439563847,5
2344300.8375944627,5
2362829.7919429820,2
2375215.3636092839,5
2376646.7974930863,7
2378480.6534474606,4
2382451.4611706340,3
2384902.1644296925,3
2411763.0850272555,10
2417078.3361324500,4
2432374.8482039518,5
2437853.8047077377,7
2438148.3441039719,5
2463849.3270043637,4
2484010.5620979211,5
2485922.5515109543,6
2486846.9299481244,11
2489685.1683265365,5
2492721.1881800375,2
2501661.0331987453,5
2506075.7314444580,4
2539661.0024435471,6
2560700.2802998477,4
2563982.7084295364,3
2578870.7901059159,5
2589245.5979068367,5
2599362.6005762632,5
2613632.7561400432,5
2627874.7977372146,6
2630765.5704087315,6
2648480.7456264429,19
2655279.4923479690,5
2681967.7844689964,4
2683925.9434937492,4
2687473.9692412289,5
2688110.9777730450,29
2691270.4995570828,6
2692657.2939750667,6
2694084.5852510731,15
2709449.6736747839,5
2712864.2294346749,3
2719657.8629194725,19
2739425.0432989823,2
2746195.3557509904,13
2748139.1358063966,5
2754697.4847843626,10
2755973.1582682668,11
2767600.1190297171,3
2776706.0228802998,7
2779137.7674526641,31
2781408.6267522276,6
2783014.3813479767,318
2795133.4288865632,11
2795240.3198638943,3
2796100.1284437751,8
2803851.7451929280,9
2810822.2085903402,4
2821509.2290888995,28
2838667.1045753224,5
2839647.6325562515,6
2842598.5931018472,6
2844832.0483599899,3
2849086.2703560041,6
2856545.1057637132,61
2873742.8991614203,5
2882177.0250975565,5
2885429.0157235569,68
2892944.4318946076,8
2893808.1269182675,5
2908071.3197159392,6
2910024.9071648144,5
2912682.3106786643,5
2913205.0530257308,4
2914301.0348640426,15
2916336.4829526738,4
2917194.9600461127,4
2917834.9881423689,9
2938826.3390148112,29
2952066.5004557428,5
2965622.6326568063,5
2973917.2072647263,5
2979122.8002670631,5
3001110.3208062401,33
3007601.9537396348,4
3017509.1296773380,5
3022409.8765357635,8
3024189.6101670146,4
3027107.9482352721,5
3028781.2
Query:
-- 6. Get distinct user_pseudo_id who had events on January 6, 2021
SELECT DISTINCT `user_pseudo_id`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210106`
LIMIT 1000
Answer:
Too long, hard cut:
user_pseudo_id
1001303.4827739208
1014060.1100191558
1015239.8458513676
1023213.5350684501
1025773.0920505617
1033020.5841925327
1042140.6802444773
1045720.9269650087
1049106.9990499157
1049739.7909391395
1060274.1098179258
1065322.6541302193
1069165.2811408476
1069494.0113686800
1072513.2161702512
1075240.7394043586
1075333.9269112947
1078788.8328338285
1081165.5314971225
1083792.6034832516
1084471.2677471598
1086668.0925005810
1086843.9052907013
1087271.0550084610
1087808.3711873816
1095740.4839642689
1111626.7442894456
1114964.3576383224
1115377.5526866793
1118833.2974558782
1126378.6956818362
1128261.6033595713
1128289.3662024583
1130911.8567954377
1133313.1103337373
1133962.3740970739
1135774.0646413552
1141870.4386338572
1144150.5821344535
1144792.8191246270
1146837.4730107711
1148615.3691736909
1151687.1996189042
1153093.0119048067
1160488.2375923167
1163998.9977514528
1169456.0744217795
1170673.0496256889
1173439.7311015929
1175417.7164964556
1177018.6074439798
1180762.6954492448
1185502.9456478888
1185607.4529846208
1211099.8247563235
1213730.2023854144
1214408.9886831537
1214882.5762650867
1216128.7020381390
1218031.2772164166
1221611.6181416961
1223402.7111643409
1224512.5360000287
1230929.5891057900
1243180.2889994882
1245742.1517954276
1250075.3055872841
1251677.0033366371
1252675.9812778248
1253621.4143036992
1255130.2864074728
1256871.5825332697
1257670.9852008771
1259037.7018534149
1264306.5410019941
1270650.6052564575
1274840.8216292245
1278990.5126400811
1280885.4587684428
1282586.4517477452
1283422.3494279515
1285418.4651557245
1285421.1033375628
1291684.5715903210
1295893.9741062295
1304296.6040710271
1304588.7510213626
1304912.9788917690
1306493.1469289903
1311409.7691253264
1312237.6155331000
1314525.6769250991
1318199.4944291645
1324330.4963761152
1324723.7882312578
1325005.1519738149
1326729.2901375460
1328537.2795814770
1332716.7234827218
1357835.0893556888
1358070.7682863119
1362293.0058255347
1366045.3922534826
1368947.6948566343
1369631.9406198523
1372261.7721304420
1374353.8427076075
1376090.8119482339
1377886.1560338090
1380305.7377133735
1383476.9026182603
1387570.7927046510
1388300.4678602079
1390300.4796021112
1390701.8959589858
1395824.1622992884
1404107.6346981032
1408865.7005954025
1412724.1344589310
1418623.6541339375
1421329.8121000178
1421856.0079266060
1433324.7672312716
1436098.4730553026
1442352.3658130118
1451268.4257155324
1470631.9552326980
1474912.2146834138
1483107.7440546761
1484136.6530214500
1485221.2761545005
1493982.6183998464
1496913.8935875858
1498978.1889757995
1499057.4357872580
1506112.7265258752
1506439.0847364167
1506539.1639843846
1513363.4705791183
1519792.3976302972
1520786.0949644980
1522572.1753325266
1524322.6852456903
1529639.2751490138
1529746.2151935759
1532659.8332550859
1537642.0362746652
1538853.8027080230
1542686.8251143701
1544033.2704162362
1553110.3711752329
1555307.6654439904
1557094.4086790025
1563588.5377359390
1565944.2403531565
1568701.7618656061
1569105.7216127560
1572598.8364509193
1573704.7204978503
1584311.2852657177
1585108.8221353211
1595752.5739499079
1600662.6721143107
1604576.0477201832
1606972.7164816338
1607155.9736505928
1614669.6038310943
1624875.9469354174
1627852.3385542986
1630439.0167164545
1644962.0672937719
1646872.3600157379
1648356.6327707257
1665685.1962105106
1670772.8517777467
1671731.4079391358
1673366.1492700771
1677342.6525684271
1685163.0188672299
1689794.6230455628
1702808.4648640313
1706543.4300583809
1711666.5759989568
1715613.1015599605
1718443.9020745667
1722746.7723659310
1725092.2005673007
1732904.4615563462
1743359.6937438402
1745401.8622362849
1747990.3808984476
1750371.7249808647
1754006.0994834886
1754096.9892214658
1754101.5236470415
1760327.1126266238
1760559.6974224035
1762188.0255397483
1763814.8337938888
1770542.1482149599
1774229.1142302813
1775022.8326960466
1776940.9301836875
1780380.8421968556
1782989.8792867764
1783326.7767103110
1784447.2994788629
1786806.6734812198
1789084.1816233251
1799418.1299673128
1803057.3123311699
1805650.8119186851
1805776.0486916905
1806270.7453025738
1817739.9801196106
1818888.2177557064
1819801.1582224257
1830571.5765734358
1834580.5106619345
1836291.9546308099
1838865.5456804179
1846977.2831502963
1847031.8084425545
1859868.1531344106
1860348.3130044315
1861628.8947054439
1869265.9376251928
1869304.3628726117
1870216.8883543271
1873577.7239946701
1874542.7243615119
1883044.6747975892
1883551.8077158377
1888612.2074326083
1896441.1015330367
1896493.1437757849
1907873.7154851308
1909593.9396452170
1912970.3114085343
1913596.0640126840
1921439.1124554416
1924207.3030440131
1925677.0426697206
1944841.0469682976
1950108.6469907871
1957727.6241797745
1959950.1321560119
1960091.6138417827
1960911.8305711573
1964130.2983828831
1964725.4724709933
1969417.8912253448
1972864.8412235262
1978839.9916116541
1981966.9921552984
1984800.0163024441
1986651.2774699608
1988560.6872382890
1990765.0839533057
1990797.7990017528
1992389.4170917308
1994261.2967787637
1998551
Query:
-- 7. Get distinct user_pseudo_id who had events on January 7, 2021
SELECT DISTINCT `user_pseudo_id`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210107`
LIMIT 1000
Answer:
Too long, hard cut:
user_pseudo_id
1000557.2911835023
1002616.3660015684
1008726.7423030385
1009541.6887464068
1009676.4905193951
1016428.1065641732
1019574.8776308935
1020795.7432964012
1028144.2081628525
1030326.1353640844
1036021.1054561259
1043511.9901401232
1046404.1129546883
1056020.6709260931
1063386.3828577009
1066407.3757892113
1072012.7284818935
1073430.9059120582
1087808.3711873816
1091162.1989694199
1098584.0776604006
1099671.3398238118
1100949.9283905733
1104189.1961360907
1107549.5710254296
1109808.6106046131
1114216.0904812151
1116865.4647068394
1122146.8997157148
1124540.2333393152
1132479.2425986879
1132946.8730897471
1138520.5891734753
1144754.6830399719
1149393.9441120966
1150257.3416332583
1150418.5729329589
1151529.7874029554
1151687.1996189042
1163998.9977514528
1166484.2621554560
1168153.2069804316
1169660.2704170325
1172211.4577928962
1174920.8866835138
1177876.9777589683
1181141.8389731329
1182923.0909175622
1186421.2997808469
1194177.8166317724
1195966.3969559148
1196040.9501767394
1209023.5496836341
1224731.3666771048
1227321.4549113942
1231601.8963574336
1237924.3309856915
1242735.7779476738
1246241.1259892311
1247293.4194247843
1256871.5825332697
1263510.2346903431
1266942.9616912837
1272559.2391561764
1275281.1401174806
1276927.7607362138
1280885.4587684428
1283562.7271739130
1287483.1535140122
1289021.8467378906
1291324.6496937233
1295828.0586489111
1296777.6630043403
1299775.3014967415
1304171.0604038711
1309980.6522015685
1317681.8410322222
1320383.7530644264
1329436.8221805419
1332979.8914503740
1333728.0047687977
1342173.6511298548
1342397.5707081379
1357251.3765617872
1359026.8307338454
1362228.4966015575
1364505.7481550412
1366103.4269040146
1366281.7261580221
1366363.8080922440
1369023.5738995470
1374932.4478575733
1378696.4627477130
1385336.9757682390
1390701.8959589858
1403236.7518250436
1404246.6716592021
1404269.7082895339
1406007.4609789626
1406098.2272398299
1406568.6449738818
1408955.7264448085
1414085.4804386953
1417342.6523496808
1418203.9991889841
1421115.4433330025
1421856.0079266060
1425808.3063725064
1431033.2186997626
1434822.0221853225
1444536.6153824784
1444614.0381635975
1446850.8020489502
1447620.3308368044
1450600.6803049558
1457470.5940116605
1459124.3307795496
1459299.1013763792
1461952.0290351411
1478029.4552762559
1480795.6595718331
1493167.5512652590
1518981.1076172913
1528342.2635970316
1536093.8467158445
1544241.6807718255
1550391.0083775168
1554803.8279036598
1561122.7855918216
1565944.2403531565
1569852.5468689472
1572474.2624475475
1574288.0335442195
1581678.4089346605
1583993.1803418505
1590652.6726149736
1607408.4697646280
1613328.8113572519
1626366.8919067582
1627454.0430815452
1631724.2395953902
1650314.7806652804
1655338.7233343192
1658205.7748137560
1659496.8938806193
1667250.8018262205
1668595.1498499526
1673328.4452718162
1676773.5069362381
1677041.1501664616
1680148.7300106081
1683135.7204561691
1690932.7741713887
1701036.7762199410
1702434.1337833338
1704559.1277489943
1706199.7091522122
1709858.9795411204
1713143.1515270435
1713151.7799105629
1717170.7325581233
1724440.6442958003
1725560.3896736022
1730865.8857828441
1733914.0614743326
1736811.0099185946
1739185.6417988339
1749175.3153107842
1749326.0413550275
1750084.1602132369
1766211.8575237576
1767689.7108431002
1778635.2272822812
1788873.5659424922
1790461.4302221148
1799694.8972403574
1803816.2751642917
1804942.4304035440
1825800.9927595957
1832746.6709228981
1839358.0620214551
1842685.0275380592
1845803.4216408728
1852845.4335508679
1867222.1866677990
1881056.5708385955
1882891.1942887897
1883648.1654112367
1889430.9379107863
1894733.4475939447
1900950.0040962720
1904312.5578123224
1905669.9634464574
1907356.8098775960
1911613.9628018306
1915112.3520066455
1916232.2044487343
1927473.5473152507
1930951.1042348154
1933629.8612777946
1935706.2469501287
1945311.8072067111
1946103.9953128236
1947409.1939782091
1947449.4066998823
1947877.1109354712
1951926.5035164256
1952518.4421988208
1961376.9468264317
1961698.6630150303
1963150.5780975373
1974627.5712881901
1983135.0030940300
1988560.6872382890
1999407.6082240854
2007362.2149327588
2008350.4389402699
2014270.2546235318
2014307.3611842210
2014709.5760211511
2017764.9469389867
2022153.9480150932
2023738.5952852555
2023891.7979970018
2026636.6794570307
2034349.2195692243
2039179.7218079866
2039856.4057543029
2040396.6725159529
2040937.1385074889
2041967.3881226587
2058616.9904162015
2062713.4006549189
2065953.3629381605
2073032.0340382286
2075161.4907764275
2080579.7444739445
2081586.3480335058
2081705.9190983707
2085160.9959749082
2089325.3811990256
2094636.6332384800
2100577.0184610827
2114922.0239883768
2115494.9408930616
2120457.3441823493
2120886.9334260185
2122058.1405701047
2122058.3240988510
2124862.5704236333
2131645.7694171953
2134701.3583866208
2139949.2328161912
2141161.4863265805
2141191.6534652110
2144973.3156012424
2147461.4105185527
2155647.5373862902
2156834.4695745566
2162918.4684165034
2183579.4397252771
2184518.9171442290
2184597
Query:
-- 8. Get the count of events per event_name on January 1, 2021
SELECT `event_name`, COUNT(*) AS event_count
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
GROUP BY `event_name`
LIMIT 1000
Answer:
event_name,event_count
first_visit,1916
page_view,7906
session_start,2289
user_engagement,4618
scroll,2113
view_item,1498
add_shipping_info,54
view_promotion,798
add_payment_info,33
view_search_results,149
select_promotion,63
click,2
begin_checkout,162
select_item,186
purchase,14
add_to_cart,295
Query:
-- 9. Get the earliest event_timestamp per user_pseudo_id on January 1, 2021
SELECT `user_pseudo_id`, MIN(`event_timestamp`) AS first_event_timestamp
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
GROUP BY `user_pseudo_id`
LIMIT 1000
Answer:
Too long, hard cut:
user_pseudo_id,first_event_timestamp
1003046.9452926974,1609468318563156
1023282.4639847710,1609517731708459
1026043.4481623879,1609503951286460
1026409.1551860912,1609500452334474
1032138.1796039159,1609463888907142
1037928.9294661675,1609536627941932
1045950.7099606829,1609486796294418
1051288.9523352374,1609510180700715
1054372.6755770068,1609471951587116
1064574.6224708641,1609517222788319
1066655.6240997015,1609520932444301
1080064.0071613184,1609543703762831
1082746.7285674512,1609537501332616
1097358.9593491100,1609487255084735
1104313.9641823605,1609515676836928
1107198.5152483918,1609505191191174
1112823.8475775772,1609459269887298
1116587.1725520171,1609543575127001
1127824.3503063268,1609540679911144
1134825.6533092350,1609544895241143
1138692.0103796281,1609527091611025
1160488.2375923167,1609516740350459
1164648.0319944302,1609539245792692
1168297.2853699605,1609508029958900
1170405.4925804370,1609491347558878
1174066.6437027818,1609481865836692
1178889.6850461952,1609512721843186
1188134.8498680538,1609515861944180
1205590.2516186397,1609507381593819
1211099.8247563235,1609520701839174
1213932.4846099850,1609483109149665
1215465.1474478000,1609507437971468
1218586.5350251990,1609528994116594
1240786.8917310160,1609470394748238
1246063.3665874179,1609510258708884
1255322.2973246181,1609497619324582
1259302.9069938124,1609514700580283
1269423.6724500672,1609496072763210
1275797.1936238018,1609524704414532
1277765.6068129494,1609476651368503
1296701.2382814729,1609545586565432
1308776.9803994658,1609501545419396
1318624.9067804638,1609514308988462
1320187.6719997668,1609461107109749
1326289.2331853598,1609481222678787
1333091.0887566663,1609528856739447
1352892.5937639189,1609473895782775
1375005.2583322863,1609519286075951
1382535.7283137323,1609463551522446
1385112.5897617274,1609542663862793
1396456.6482506733,1609510193708003
1401649.9529464111,1609477396149869
1422161.0871788362,1609489445708768
1437260.5988606411,1609534203788651
1448835.0934102497,1609520262368722
1453555.6810069410,1609503081136044
1453951.1387928223,1609514715374283
1456890.1673716823,1609540737998188
1459436.8826692932,1609522620586340
1473136.1149103090,1609479185006287
1485472.4390061373,1609517233816411
1499810.5142637849,1609476696996002
1501018.3808301483,1609479221449123
1503421.5168556763,1609462586351297
1515646.3111272928,1609485447213479
1518831.1475327211,1609484862429444
1519124.8641457524,1609497086741971
1534689.9343310805,1609534131634732
1539940.5253610440,1609485151696037
1543004.7243225422,1609519696838965
1550901.3980286554,1609497885356266
1564015.6880680172,1609527262625521
1575061.4789497906,1609508307631647
1582390.8206269591,1609536480076063
1616136.8949543878,1609479015861580
1619900.3195973863,1609519419471283
1620024.8966870933,1609507296195272
1646722.0078157231,1609485358139411
1674937.2501954408,1609515719174609
1677450.9117017807,1609517616856478
1680043.1145812114,1609523488536285
1684301.4109152707,1609500611817910
1688147.2939632391,1609531760521458
1693134.9790437518,1609495675043365
1694910.7733232660,1609529942291141
1699037.5870634483,1609536090704453
1707918.4797422153,1609527122307230
1713530.3382800695,1609542838460456
1719564.6333875501,1609514638403253
1729803.5105688857,1609539916248324
1734528.1974041204,1609463195244478
1745072.0004799132,1609525781951180
1745171.2191701968,1609518712869487
1749246.8534368616,1609520325363961
1759212.2216007988,1609500920105878
1762263.6990880514,1609509002559235
1765594.3047173009,1609498352425015
1784794.0627143380,1609462318464280
1804199.2014328535,1609526421210996
1820733.6464417466,1609491323472771
1829763.3860332334,1609519211966573
1846974.0316175078,1609468726877761
1859470.4546513665,1609531938290875
1884090.9722372635,1609501712250623
1886250.8920156183,1609541430788979
1912537.7440240268,1609518518256358
1958116.3750166429,1609539098734456
1958256.0896241884,1609508111289141
1961265.4757052307,1609509217720779
1967725.7354072666,1609515080100530
1990491.3893000361,1609481036303667
1993768.0582544668,1609526422714120
1999213.1832096854,1609527336983944
2007362.2149327588,1609466082573216
2007867.8957787066,1609526682969574
2019465.0056495205,1609461954159434
2029664.5317923957,1609507056286374
2041235.3400307589,1609483880156829
2044855.8624761839,1609544485320464
2077981.6202330137,1609494715981777
2084772.9471491241,1609510721542687
2091407.8804833129,1609536000393896
2102395.6721696580,1609515976307123
2142722.9676010623,1609477963788908
2150276.2168438227,1609475171944849
2157133.5876722467,1609544029824624
2159725.7481437355,1609505443138279
2165252.0147518395,1609470441445127
2167343.6164963557,1609486088978160
2168528.2202958861,1609519813589863
2194957.7885097322,1609500544802649
2228172.7936687802,1609476456571596
2244553.9738621373,1609499351873919
2245992.8909040661,1609467871177487
2247846.3358362547,1609528076115859
2263288.5212004372,1609531293734109
2264573.5209212671,1609520640448866
2268837.3082004933,160953779974
Query:
-- 10. Get the list of event_params keys on January 1, 2021
SELECT DISTINCT ep.key
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`,
UNNEST(`event_params`) AS ep
LIMIT 1000
Answer:
key
ga_session_number
ga_session_id
page_referrer
page_location
page_title
session_engaged
engaged_session_event
entrances
medium
campaign
source
term
all_data
clean_event
debug_mode
engagement_time_msec
percent_scrolled
currency
gclid
gclsrc
dclid
unique_search_term
search_term
link_url
link_domain
outbound
payment_type
value
tax
promotion_name
coupon
shipping_tier
transaction_id
Query:
-- 11. Extract string_value from event_params where key is 'page_location' on January 1, 2021
SELECT ep.value.string_value
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101` AS t,
UNNEST(t.event_params) AS ep
WHERE LOWER(ep.key) = 'page_location'
LIMIT 1000
Answer:
Too long, hard cut:
string_value
https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee
https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee
https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee
https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee
https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee
https://shop.googlemerchandisestore.com/Google+Redesign/Campus+Collection/Google+Sunnyvale+Campus+Bottle
https://shop.googlemerchandisestore.com/Google+Redesign/Lifestyle/Fun/Malibu+Sunglasses.axd
https://shop.googlemerchandisestore.com/
https://shop.googlemerchandisestore.com/Google+Redesign/Accessories/Google+Clear+Framed+Yellow+Shades
https://shop.googlemerchandisestore.com/Google+Redesign/Campus+Collection/Google+Sunnyvale+Campus+Bottle
https://shop.googlemerchandisestore.com/basket.html
https://shop.googlemerchandisestore.com/Google+Redesign/Lifestyle/Fun/Malibu+Sunglasses.axd
https://shop.googlemerchandisestore.com/registersuccess.html
https://shop.googlemerchandisestore.com/yourinfo.html
https://shop.googlemerchandisestore.com/basket.html
https://shop.googlemerchandisestore.com/yourinfo.html
https://shop.googlemerchandisestore.com/Google+Redesign/Lifestyle/Fun/Malibu+Sunglasses.axd
https://shop.googlemerchandisestore.com/Google+Redesign/New
https://shop.googlemerchandisestore.com/
https://shop.googlemerchandisestore.com/store.html
https://shop.googlemerchandisestore.com/Google+Redesign/Shop+by+Brand/Google
https://shop.googlemerchandisestore.com/Google+Redesign/Lifestyle/Fun/Malibu+Sunglasses.axd
https://shop.googlemerchandisestore.com/store.html
https://shop.googlemerchandisestore.com/yourinfo.html
https://shop.googlemerchandisestore.com/registersuccess.html
https://shop.googlemerchandisestore.com/yourinfo.html
https://shop.googlemerchandisestore.com/basket.html
https://shop.googlemerchandisestore.com/
https://shop.googlemerchandisestore.com/Google+Redesign/Accessories/Google+Clear+Framed+Yellow+Shades
https://shop.googlemerchandisestore.com/basket.html
https://shop.googlemerchandisestore.com/Google+Redesign/Shop+by+Brand/Google
https://shop.googlemerchandisestore.com/Google+Redesign/Lifestyle/Google+Aluminum+Bottle+Red
https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/IamRemarkable+Unisex+T-Shirt
https://shop.googlemerchandisestore.com/basket.html
https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/IamRemarkable+Unisex+T-Shirt
https://shop.googlemerchandisestore.com/
https://shop.googlemerchandisestore.com/Google+Redesign/New
https://shop.googlemerchandisestore.com/yourinfo.html
https://shop.googlemerchandisestore.com/store.html
https://shop.googlemerchandisestore.com/
https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Mens
https://shop.googlemerchandisestore.com/Google+Redesign/Lifestyle/Google+Aluminum+Bottle+Red
https://shop.googlemerchandisestore.com/Google+Redesign/Campus+Collection/Google+Sunnyvale+Campus+Bottle
https://shop.googlemerchandisestore.com/store.html
https://shop.googlemerchandisestore.com/Google+Redesign/Lifestyle/Google+Aluminum+Bottle+Red
https://shop.googlemerchandisestore.com/Google+Redesign/Lifestyle/Google+Aluminum+Bottle+Red
https://shop.googlemerchandisestore.com/
https://shop.googlemerchandisestore.com/basket.html
https://shop.googlemerchandisestore.com/yourinfo.html
https://shop.googlemerchandisestore.com/basket.html
https://shop.googlemerchandisestore.com/Google+Redesign/Accessories/Google+Clear+Framed+Yellow+Shades
https://shop.googlemerchandisestore.com/basket.html
https://shop.googlemerchandisestore.com/Google+Redesign/Accessories/Google+Clear+Framed+Yellow+Shades
https://shop.googlemerchandisestore.com/store.html
https://shop.googlemerchandisestore.com/Google+Redesign/Campus+Collection/Google+Sunnyvale+Campus+Bottle
https://shop.googlemerchandisestore.com/basket.html
https://shop.googlemerchandisestore.com/basket.html
https://shop.googlemerchandisestore.com/yourinfo.html
https://shop.googlemerchandisestore.com/store.html
https://shop.googlemerchandisestore.com/basket.html
https://shop.googlemerchandisestore.com/signin.html
https://shop.googlemerchandisestore.com/Google+Redesign/New
https://shop.googlemerchandisestore.com/registersuccess.html
https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Mens
https://shop.googlemerchandisestore.com/signin.html
https://shop.googlemerchandisestore.com/Google+Redesign/Shop+by+Brand/YouTube
https://shop.googlemerchandisestore.com/Google+Redesign/Shop+by+Brand/YouTube
https://shop.googlemerchandisestore.com/Google+Redesign/Shop+by+Brand/YouTube
https://shop.googlemerchandisestore.com/Google+Redesign/Shop+by+Brand/YouTube
https://shop.googlemerchandisestore.com/Google+Redesign/New
https://shop.googlemerchandisestore.com/Google+Redesign/Shop+by+Brand/YouTube
https://shop.googlemerchandisestore.com/Google+Redesign/New
https://shop.googlemerchandisestore.c
Query:
-- 12. Get the number of users per day between January 1 and January 5, 2021
SELECT `event_date`, COUNT(DISTINCT `user_pseudo_id`) AS user_count
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210105'
GROUP BY `event_date`
LIMIT 1000
Answer:
event_date,user_count
20210104,3079
20210101,2160
20210102,2581
20210103,2579
20210105,4101
Query:
-- 13. List distinct platforms used between January 1 and January 5, 2021
SELECT DISTINCT `platform`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210105'
LIMIT 1000
Answer:
platform
WEB
Query:
-- 14. Get the count of events per device category on January 1, 2021
SELECT device.category, COUNT(*) AS event_count
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
GROUP BY device.category
LIMIT 1000
Answer:
category,event_count
desktop,13477
mobile,8152
tablet,467
Query:
-- 15. Get distinct user_pseudo_id active between January 1 and January 5, 2021 but not on January 6 and 7, 2021
SELECT DISTINCT `user_pseudo_id`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210105'
AND `user_pseudo_id` NOT IN (
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210106`
  UNION DISTINCT
  SELECT DISTINCT `user_pseudo_id`
  FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210107`
)
LIMIT 1000
Answer:
Too long, hard cut:
user_pseudo_id
1008499.5928445086
1013760.9231029745
1014209.5295344253
1026137.2290719007
1028167.1226079449
1032092.5249707229
1053193.3273260382
1057066.6724870774
1057265.5844727802
1065673.0722289663
1067841.4647153954
1075223.2681702246
1082690.0377265261
1103286.8251708796
1109836.9501901728
1113469.1950253831
1114181.7368629788
1121518.2859510925
1130810.6137694456
1134613.7634894426
1158637.0383647084
1164741.6860607634
1181674.5265741661
1185078.3105419781
1194575.2891034137
1214573.9183644653
1215389.2295507570
1222867.5284822262
1227012.8467411408
1238230.5582832258
1243221.1777211525
1252690.3944441209
1284535.4676055384
1288248.9113459714
1289319.0865612371
1297488.8153560940
1299487.6744511638
1307038.3688504236
1309149.1848587742
1313329.6311058857
1314747.6066644573
1320284.3859724504
1325688.1519909745
1334969.6157017719
1339205.5397897099
1373324.8357357420
1385090.1246142947
1385662.1127085473
1401785.6584445113
1402228.3482241994
1403129.5580554677
1445737.4102905419
1450787.9898569840
1458803.4123039458
1466910.4554610435
1470241.3611852177
1471187.8226858001
1488009.3142808321
1493030.0825468207
1497130.5055593166
1500615.9964438412
1504953.0746977838
1509456.3177418451
1519189.6398973848
1522857.5896662267
1536105.5891820566
1544748.2905250855
1556885.1837167077
1560589.3791460585
1578948.0834575091
1586022.1800460720
1588332.2823326217
1588666.3949365829
1590715.7165540392
1607100.0381093527
1622235.9923526878
1624884.8451928269
1629639.2044968342
1632927.1894987991
1634789.3752037441
1639296.9002795622
1648032.7331818100
1656975.3346712388
1659842.4321850950
1665661.9122532614
1668023.4150976276
1668416.2014466630
1672632.0859250572
1690623.2302780540
1702019.9842929153
1702845.7520261284
1703253.2388947937
1707319.9934501562
1711048.6268268364
1711971.4968010332
1726993.2463217900
1730497.6226428479
1732811.6786855240
1745835.9106014489
1751599.1685077136
1754331.3157951821
1757510.5330787128
1765047.7773329261
1765130.1889939374
1770215.5966952525
1780294.0221405041
1787504.7670504282
1791921.4002592107
1795540.6156637931
1799135.7941835837
1806356.1249501454
1807394.6792147711
1808170.2762309629
1808232.5654454206
1824201.1380052029
1841613.4096590753
1842336.8436996882
1843227.1315168145
1855160.6431356491
1857518.5760998088
1859470.4546513665
1888732.5808117060
1891844.3029317015
1895574.3356492898
1901730.7277275021
1908860.5902672888
1922936.0279129669
1929434.4518118388
1930569.1007455155
1934857.9616833097
1945068.8887037343
1949104.1690663627
1954953.0721200891
1966048.6599698958
1976029.4501496209
1979778.7331964605
1982815.8232892378
1983421.2936555498
1993697.9945930656
2002776.5976883193
2005618.5376901983
2022577.6028076666
2049590.8596560881
2051318.3089832623
2055215.4967663939
2070480.7661066255
2079154.1476733507
2094642.2631508719
2096766.0019470232
2116278.5223204033
2121651.9176614852
2127898.5527858242
2131056.2525081023
2131509.8375213648
2147417.5961373356
2157825.0718936880
2164352.2670593278
2167317.9816236215
2172399.2091034226
2175416.5833910330
2177462.5220423724
2177957.7412962494
2192432.3542621657
2193948.2281082270
2194441.0544343537
2197864.5182472083
2200081.2420876058
2203449.4497261194
2204878.2541228096
2214606.8300190111
2245385.0615539791
2245567.3795914474
2248364.4469117960
2248754.7783173763
2250793.6313697017
2250953.6316204806
2258641.1629826733
2262724.6807963688
2263380.7170574283
2263420.2110121128
2265208.1282213045
2276075.8079921958
2277998.4131015438
2279457.7315196874
2284976.1899128869
2301413.0302404690
2303928.3507051479
2304235.4728947355
2327460.3641621424
2329707.0387773385
2331461.5841279593
2333408.5403558380
2346000.3226235037
2349749.6508625488
2374910.1217694068
2376240.8034284857
2376717.3509701603
2382234.3846802600
2382887.9214525018
2388941.9518774856
2392346.1836393196
2393556.1146578015
2399121.7379674359
2415432.3160368774
2415788.3641983779
2415858.4972221670
2417805.0150005257
2418145.6199610855
2419732.5640450460
2422137.6877778640
2423973.9449466734
2425570.7323199738
2430886.9385533523
2438902.8824385354
2440353.3206892115
2445188.0327038206
2461015.7427876593
2465015.1494457724
2467393.7377682212
2491439.4728767719
2494301.6460508569
2501970.2707488768
2507894.1372177453
2526432.6035949356
2526912.7108743899
2536104.6818349493
2543445.6389301518
2543525.0285025760
2546017.5150907817
2548737.2552051276
2551167.3034654376
2551300.8505181236
2558365.7246265443
2568488.0444965897
2581316.7226811113
2587147.0479569634
2593151.6733146848
2599191.1809781484
2613533.4409425127
2613732.0466667239
2614498.1516604416
2618461.8300567593
2622647.6350409806
2624431.4002749857
2630262.0012746307
2632235.6933492055
2636673.7777856869
2637684.2664716834
2647065.8603961769
2649423.6413575526
2653272.4444281234
2656338.3348390425
2667484.7677953678
2676729.6526609799
2689361.0389768864
2691197.8600859055
2712259.6042351009
2727985.5499136556
2744671.5449509941
2747046.8475558839
2774416.5678558071
2780178.2000494406
2782541
Query:
-- 16. Get distinct event_dates from events between January 1 and January 7, 2021
SELECT DISTINCT `event_date`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210107'
LIMIT 1000
Answer:
event_date
20210104
20210102
20210106
20210105
20210101
20210107
20210103
Query:
-- 17. Get the top 1000 user_pseudo_id with the most events on January 1, 2021
SELECT `user_pseudo_id`, COUNT(*) AS event_count
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
GROUP BY `user_pseudo_id`
ORDER BY event_count DESC
LIMIT 1000
Answer:
Too long, hard cut:
user_pseudo_id,event_count
72522849.6381089738,1011
1160488.2375923167,427
2783014.3813479767,318
5563930.3593101391,203
53550354.6354713181,180
8186100.1619066340,171
59533896.5320638489,170
68546038.8820428933,163
87047667.1042912591,149
53104811.8176614311,148
17007406.8391181695,144
72065348.6852495696,133
7515221.4303230400,126
28134106.1591086954,121
81574425.5434958788,117
6867779.6634381231,115
1188134.8498680538,114
7105959.6709528403,110
50844046.9564028621,99
74953787.0199910547,94
3354006.4211651279,90
75073588.1859607099,88
6328102986.3137432902,85
15817556.8554808751,83
6101467.4740745406,80
10860969.8635427479,80
32537212.0554785312,77
1023282.4639847710,77
76975305.9969820299,76
62524109.3161787418,76
45942478.6625384752,76
6801661.0213744991,76
1112823.8475775772,73
2885429.0157235569,68
1990491.3893000361,67
40650638.8176789956,67
6772624.5257726160,67
4626089.7083106102,66
78839661.7033676134,65
29404827.7870928470,63
2856545.1057637132,61
82379049.4680589452,57
15047683.3025668953,57
5510821.7058149595,57
4107999736.9770670225,56
53067943.8636445638,55
18097479.9566775994,53
3351786.5083077372,52
42142866.3416900702,51
64527390.2197615970,50
6482353.8828196074,50
5393985456.0596119848,48
1646722.0078157231,48
10115718.4867090359,48
38359877.5815012009,47
61687008.5702070839,47
22288916.8827658539,46
43470418.6139420304,45
81213220.7958656808,43
4124604.0408794437,43
84760862.0017504152,42
15932166.2076268855,41
43120797.5731831365,41
13167690.2693949122,40
8903783.1803413789,40
12685424.3792504835,39
16910393.5498744454,38
83736385.8758161413,38
8813737.3153270447,38
5686154.7174932299,38
1684301.4109152707,38
63655374.9348413503,37
1566834642.5850724108,37
39447924.7392393021,36
5554878.0772348619,36
73990466.9253242963,36
28889932.1687420790,35
6351413.2459505432,35
16584748.2250156564,34
76874793.6611457255,34
48293850.3499088450,33
3001110.3208062401,33
34851780.6903374642,33
14801022.9686481759,33
4647802.5572043944,33
5337490.6328314089,33
87188220.6252432191,32
11116091.7897694184,32
12177989.5566440967,32
4289529.7500442979,31
2779137.7674526641,31
77052125.0799530822,31
52170675.5101121559,31
1829763.3860332334,31
5831980.2827657871,31
8858380583.2491355805,30
9221726.8946931934,30
50994991.7786921042,30
88839956.1260646312,30
11369626.1068446121,30
2938826.3390148112,29
38945261.7275220036,29
75446459.8381341234,29
8233454.3379625056,29
70983845.8602218235,29
2688110.9777730450,29
1745171.2191701968,28
26776431.5444855772,28
6029218.0603649355,28
22570371.0320972505,28
5952403.0699076194,28
2821509.2290888995,28
67810822.6213098903,28
2142722.9676010623,27
69334767.8799342738,27
18281634.0263286465,27
5289818.5896545465,26
70070907.4592712107,26
9312196.4289187337,25
67150059.7765111802,25
5347187.1888352330,25
34150985.5240340128,25
1211099.8247563235,25
3247861.1783343704,24
25416145.7738087776,24
43935941.0459126619,24
34072087.4412395298,24
8764903.2626750908,24
12788887.8477521144,24
69671491.4417832889,24
5750356.4517628504,24
13623777.5841147931,24
5548979.4220764515,24
39261888.9474046490,24
7032927.5986019681,24
7833748.1492120206,23
3071789.9352232891,23
44361810.7796476736,23
4283464.4359186905,23
46271071.0418171780,23
5912802.1253450499,23
71774034.9487849217,22
90921275.4472518914,22
29538782.9408059000,21
68925463.5109471243,21
44740556.1615757380,21
60240245.7553258615,21
13794922.5461387312,21
5041502.7430031385,21
73659823.6409998130,21
3058967.2730251282,21
17595259.0522072964,21
82637393.7261976432,20
55271319.4094534400,20
1164648.0319944302,20
3455843.2119554439,20
9119509.2051111066,20
7454049374.5278441084,20
4640627.4777157751,20
45643625.0853629614,20
4499992609.9764785594,20
26943693.0634894898,20
3213363.3651446553,19
1519124.8641457524,19
78966520.2065669153,19
68497028.9313100402,19
24045383.4229050363,19
41109914.2938114399,19
5298013.7728745800,19
2364299980.1335009029,19
6991038.3370387967,19
2648480.7456264429,19
2719657.8629194725,19
21178461.3856148059,19
3718127.6303284550,18
3629907.7037376784,18
39335113.7845260204,18
4651894.8591529595,18
2244553.9738621373,18
92148877.5188210051,18
7051044.8537597066,18
4919799.0376731086,18
31711736.9819763479,18
49489352.0130765941,18
5227994.9289134236,18
6624046.1953842551,18
2157133.5876722467,18
29231866.0237322031,18
4933916.6307767169,18
35236652.2780808698,18
4675955.3422475397,17
4015519.0757720765,17
1999213.1832096854,17
7666337.2408476627,17
40937229.1554544663,17
7360503433.8016450106,17
31031519.3989745669,17
1473136.1149103090,17
55488010.7772988908,17
8135575.4106679316,17
5418076.2283249355,17
6050239.7863062718,17
7758527183.2977733624,17
42640994.6788353590,17
53327798.6735383085,17
9059021.8769836340,17
56510630.8658074346,17
59304688.2503711410,17
6171633.2360869637,17
7278044.1489631971,17
46504832.4995127040,17
6014286.9848367129,17
5520916.2190904037,16
18205474.8354291393,16
39585017.1090292162,16
72820486.6411427594,16
75328790.8293830754,16
3977023.4474982984,16
27339915.97000
Query:
-- 18. Get distinct values of device.operating_system used on January 1, 2021
SELECT DISTINCT device.operating_system
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
LIMIT 1000
Answer:
operating_system
Windows
Web
Android
<Other>
iOS
Macintosh
Query:
-- 19. Get counts of events per country on January 1, 2021
SELECT geo.country, COUNT(*) AS event_count
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_20210101`
GROUP BY geo.country
LIMIT 1000
Answer:
country,event_count
France,335
India,2862
United States,9007
Canada,1779
Bangladesh,42
Kuwait,20
Indonesia,219
Brazil,491
Greece,24
China,475
Turkey,248
Japan,309
Portugal,451
Singapore,265
Saudi Arabia,47
Colombia,78
Israel,278
Egypt,108
Mexico,73
Ukraine,80
United Kingdom,816
Poland,175
Romania,110
South Korea,134
United Arab Emirates,76
Spain,398
Germany,203
South Africa,14
Cyprus,5
Thailand,49
Russia,153
Taiwan,263
Belarus,5
(not set),255
Azerbaijan,13
Jordan,40
Norway,60
Australia,100
Belgium,51
Ireland,51
Netherlands,185
Sweden,90
Argentina,29
Peru,110
New Zealand,21
Iceland,27
Finland,34
Vietnam,98
Austria,142
Switzerland,60
Venezuela,11
Chile,34
Albania,24
Hong Kong,97
Italy,148
Puerto Rico,12
Malaysia,32
Hungary,14
Pakistan,27
Algeria,99
Slovakia,11
Sri Lanka,48
Czechia,32
Morocco,45
Denmark,31
Philippines,200
Tunisia,9
Paraguay,4
Ecuador,4
Slovenia,13
Bolivia,5
Croatia,11
Iraq,26
Armenia,10
Lebanon,8
Nigeria,22
Bulgaria,22
North Macedonia,24
Estonia,15
Ghana,22
Uruguay,6
Latvia,6
Guatemala,50
Bahamas,6
El Salvador,3
Lithuania,4
Costa Rica,3
Query:
-- 20. Get distinct user_pseudo_id who had 'purchase' events between January 1 and January 5, 2021
SELECT DISTINCT `user_pseudo_id`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210105'
AND LOWER(`event_name`) = 'purchase'
LIMIT 1000
Answer:
user_pseudo_id
1055969.5872512303
3024189.6101670146
7296845.4997447007
42807215.0722008548
43382307.1290802082
51954044.7234105463
77052125.0799530822
22857919.0356368006
25040095.0670087088
80435974.9462183494
40569893.9835575904
78839661.7033676134
84647660.6681637188
85305313.7561330759
3048586.2373315420
5257023.2131424569
7634450.7489916014
7828968.5532093675
17494077.2658372366
22300841.9909876299
33280841.1628915296
47439165.5147551041
49456942.0436829148
2885429.0157235569
8894775.5253595050
62524109.3161787418
18161607.9002799024
24207018.3974015161
6097102.6516338254
68780200.6423809280
71568861.8035326636
72959035.2192369480
74650484.1255761858
6283343.2195449706
77327261.9614153178
78207562.9231433824
6363623135.4270133281
1158637.0383647084
46574324.9683380755
59643921.1694992453
44810382.7311730027
59487571.9263599382
88827381.9303945281
75571709.1157982540
2459937.2318206302
2637438.5895621403
2838161.4781702653
3056927.8375951035
3593045.4474754034
4181862.5710073931
5155655.8559554783
5963534.4700679023
6115983.2241878817
9220684.1553390889
19492128.7016911946
24377658.7213551870
28988900.6959315645
32591508.2385963314
39214432.1935349913
45529743.2756914140
74972717.1202590271
84389355.3658704825
84496993.3019099787
87431455.4720611025
6282998.3933758831
52461093.3056333183
73370809.3757379160
7312667.0266395141
41803452.7850037461
25712283.2548580985
61389953.5535318141
3351786.5083077372
40650638.8176789956
87047667.1042912591
68546038.8820428933
6101467.4740745406
15817556.8554808751
50844046.9564028621
53104811.8176614311
2783014.3813479767
3354006.4211651279
53550354.6354713181
1160488.2375923167
End Exploring Related Columns
Task: How many pseudo users were active in the last 7 days but inactive in the last 2 days as of January 7, 2021?

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: To determine the number of pseudo users who were active in the last 7 days but inactive in the last 2 days as of January 7, 2021, we:

1. Identified pseudo users (`user_pseudo_id`) who had events between **January 1, 2021** and **January 5, 2021**.
2. Excluded those who had any events on **January 6, 2021** or **January 7, 2021**.
3. Counted the unique pseudo users remaining.

The result is:

```csv
number_of_pseudo_users
50
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'ga4_obfuscated_sample_ecommerce': ['events_20201101', 'events_20201102', 'events_20201103', 'events_20201104', 'events_20201105', 'events_20201106', 'events_20201107', 'events_20201108', 'events_20201109', 'events_20201110', 'events_20201111', 'events_20201112', 'events_20201113', 'events_20201114', 'events_20201115', 'events_20201116', 'events_20201117', 'events_20201118', 'events_20201119', 'events_20201120', 'events_20201121', 'events_20201122', 'events_20201123', 'events_20201124', 'events_20201125', 'events_20201126', 'events_20201127', 'events_20201128', 'events_20201129', 'events_20201130', 'events_20201201', 'events_20201202', 'events_20201203', 'events_20201204', 'events_20201205', 'events_20201206', 'events_20201207', 'events_20201208', 'events_20201209', 'events_20201210', 'events_20201211', 'events_20201212', 'events_20201213', 'events_20201214', 'events_20201215', 'events_20201216', 'events_20201217', 'events_20201218', 'events_20201219', 'events_20201220', 'events_20201221', 'events_20201222', 'events_20201223', 'events_20201224', 'events_20201225', 'events_20201226', 'events_20201227', 'events_20201228', 'events_20201229', 'events_20201230', 'events_20201231', 'events_20210101', 'events_20210102', 'events_20210103', 'events_20210104', 'events_20210105', 'events_20210106', 'events_20210107', 'events_20210108', 'events_20210109', 'events_20210110', 'events_20210111', 'events_20210112', 'events_20210113', 'events_20210114', 'events_20210115', 'events_20210116', 'events_20210117', 'events_20210118', 'events_20210119', 'events_20210120', 'events_20210121', 'events_20210122', 'events_20210123', 'events_20210124', 'events_20210125', 'events_20210126', 'events_20210127', 'events_20210128', 'events_20210129', 'events_20210130', 'events_20210131']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-19 22:22:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 22:22:39 - root - INFO - To determine the number of pseudo users who were active in the last 7 days but inactive in the last 2 days as of January 7, 2021, we:

1. **Identified pseudo users (`user_pseudo_id`) who had events between January 1, 2021, and January 5, 2021.**

2. **Excluded those who had any events on January 6, 2021, or January 7, 2021.**

3. **Counted the unique pseudo users remaining.**

The SQL query is:

```sql
SELECT COUNT(DISTINCT `user_pseudo_id`) AS `number_of_pseudo_users`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210105'
  AND `user_pseudo_id` NOT IN (
    SELECT DISTINCT `user_pseudo_id`
    FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
    WHERE _TABLE_SUFFIX BETWEEN '20210106' AND '20210107'
  )
```
2025-01-19 22:22:42 - root - INFO - itercount: 1
2025-01-19 22:22:42 - root - INFO - 0
2025-01-19 22:22:42 - root - INFO - results: 
number_of_pseudo_users
13442


2025-01-19 22:22:42 - root - INFO - Please check the answer again by reviewing How many pseudo users were active in the last 7 days but inactive in the last 2 days as of January 7, 2021?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To determine the number of pseudo users who were active in the last 7 days but inactive in the last 2 days as of January 7, 2021, we:

1. Identified pseudo users (`user_pseudo_id`) who had events between **January 1, 2021** and **January 5, 2021**.
2. Excluded those who had any events on **January 6, 2021** or **January 7, 2021**.
3. Counted the unique pseudo users remaining.

The result is:

```csv
number_of_pseudo_users
50
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
number_of_pseudo_users
13442
Current sql:
SELECT COUNT(DISTINCT `user_pseudo_id`) AS `number_of_pseudo_users`
FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20210101' AND '20210105'
  AND `user_pseudo_id` NOT IN (
    SELECT DISTINCT `user_pseudo_id`
    FROM `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_*`
    WHERE _TABLE_SUFFIX BETWEEN '20210106' AND '20210107'
  )
