2025-01-20 11:16:16 - openai._base_client - INFO - Retrying request to /chat/completions in 0.417942 seconds
2025-01-20 11:17:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 11:17:23 - root - INFO - SQL:
SELECT DISTINCT `indicator_code`
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE LOWER(`indicator_name`) LIKE '%gdp%'
   LIMIT 1000;
Results:
indicator_code
BX.TRF.PWKR.DT.GD.ZS
PA.NUS.PPPC.RF
NE.TRD.GNFS.ZS
EN.ATM.CO2E.KD.GD
NY.GDP.COAL.RT.ZS
BN.CAB.XOKA.GD.ZS
NY.GDP.DISC.CN
FD.AST.PRVT.GD.ZS
SH.XPD.GHED.GD.ZS
NE.RSB.GNFS.ZS
NE.CON.TOTL.ZS
NY.GDP.FRST.RT.ZS
NY.GDP.MKTP.KN
NY.GDP.MKTP.CN
NY.GDP.PCAP.CN
NY.GDP.PCAP.KD.ZG
NE.CON.GOVT.ZS
NV.IND.TOTL.ZS
TG.VAL.TOTL.GD.ZS
MS.MIL.XPND.GD.ZS
NY.GDP.PETR.RT.ZS
FM.LBL.BMNY.GD.ZS
FS.AST.CGOV.GD.ZS
NY.GDP.MKTP.CD
NY.GDP.MKTP.KD.ZG
NY.GDP.MKTP.PP.CD
NV.IND.MANF.ZS
CM.MKT.LCAP.GD.ZS
FM.AST.PRVT.GD.ZS
NY.GDP.NGAS.RT.ZS
PA.NUS.PPP
GC.REV.XGRT.GD.ZS
BG.GSR.NFSV.GD.ZS
NY.GDP.MKTP.KD
NY.GDP.DEFL.ZS.AD
NY.GDP.PCAP.KD
FS.AST.PRVT.GD.ZS
NE.EXP.GNFS.ZS
BM.KLT.DINV.WD.GD.ZS
NY.GDP.DEFL.ZS
NY.GDP.PCAP.KN
SE.XPD.SECO.PC.ZS
NE.GDI.TOTL.ZS
NE.IMP.GNFS.ZS
NY.GDP.DEFL.KD.ZG
GC.AST.TOTL.GD.ZS
NV.SRV.TOTL.ZS
NY.GDP.DISC.KN
BX.KLT.DINV.WD.GD.ZS
NY.GDP.PCAP.PP.CD
SL.GDP.PCAP.EM.KD
EG.GDP.PUSE.KO.PP.KD
EG.GDP.PUSE.KO.PP
NE.GDI.FTOT.ZS
NY.GNS.ICTR.ZS
GC.LBL.TOTL.GD.ZS
GC.TAX.TOTL.GD.ZS
NY.GDP.TOTL.RT.ZS
NY.GDP.PCAP.CD
NE.DAB.TOTL.ZS
NY.GDP.MINR.RT.ZS
NV.AGR.TOTL.ZS
EN.ATM.CO2E.PP.GD
GC.XPN.TOTL.GD.ZS
SE.XPD.TERT.PC.ZS
NE.CON.PRVT.ZS
FS.AST.DOMO.GD.ZS
SH.XPD.CHEX.GD.ZS
FS.AST.DOMS.GD.ZS
EG.USE.COMM.GD.PP.KD
NY.GDS.TOTL.ZS
NE.GDI.FPRV.ZS
NY.GDP.MKTP.PP.KD
NY.GDP.DEFL.KD.ZG.AD
CM.MKT.TRAD.GD.ZS
GC.NLD.TOTL.GD.ZS
EN.ATM.CO2E.PP.GD.KD
EG.EGY.PRIM.PP.KD
NY.GDP.MKTP.CN.AD
SE.XPD.TOTL.GD.ZS
NY.GDP.PCAP.PP.KD
GB.XPD.RSDV.GD.ZS
SE.XPD.PRIM.PC.ZS
GC.NFN.TOTL.GD.ZS
ER.GDP.FWTL.M3.KD
GC.DOD.TOTL.GD.ZS

2025-01-20 11:17:26 - root - INFO - SQL:
SELECT DISTINCT `indicator_name`, `indicator_code`
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE `indicator_code` = 'NY.GDP.MKTP.KD'
   LIMIT 1000;
Results:
indicator_name,indicator_code
GDP (constant 2015 US$),NY.GDP.MKTP.KD

2025-01-20 11:18:41 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 11:18:41 - root - INFO - Apologies for the error in the SQL query. The issue was due to a mismatched quotation mark in the `WHERE` clause. Specifically, the string `'NY.GDP.MKTP.KD\`` had an opening single quote but a closing backtick, causing the unclosed string literal error.

**Corrected SQL Query:**

```sql
SELECT `country_name`, `country_code`, `value`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `indicator_code` = 'NY.GDP.MKTP.KD' AND `year` = 2019
LIMIT 1000;
```

This correction replaces the closing backtick with a single quote, properly enclosing the string and resolving the syntax error.

---

**Additional SQL Queries to Explore the Data:**

To better understand the data and answer the question, here are more SQL queries:

16. **Retrieve GDP Values and Regions for 2019:**

   ```sql
   SELECT id.`country_name`, id.`country_code`, cs.`region`, id.`value`
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
     ON id.`country_code` = cs.`country_code`
   WHERE id.`indicator_code` = 'NY.GDP.MKTP.KD' AND id.`year` = 2019
   LIMIT 1000;
   ```

17. **List All Regions:**

   ```sql
   SELECT DISTINCT `region`
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   LIMIT 1000;
   ```

18. **Find Countries Without a Region Assigned:**

   ```sql
   SELECT `country_code`, `short_name`
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   WHERE `region` IS NULL OR `region` = ''
   LIMIT 1000;
   ```

19. **Retrieve GDP Values Excluding Aggregates:**

   ```sql
   SELECT id.`country_name`, cs.`region`, id.`value`
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
     ON id.`country_code` = cs.`country_code`
   WHERE id.`indicator_code` = 'NY.GDP.MKTP.KD'
     AND id.`year` = 2019
     AND id.`value` IS NOT NULL
     AND cs.`region` NOT IN ('Aggregates', 'World', '')
   LIMIT 1000;
   ```

20. **Calculate Approximate Median GDP per Region:**

   ```sql
   SELECT cs.`region`, APPROX_QUANTILES(id.`value`, 2)[OFFSET(1)] AS `median_gdp`
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
     ON id.`country_code` = cs.`country_code`
   WHERE id.`indicator_code` = 'NY.GDP.MKTP.KD'
     AND id.`year` = 2019
     AND id.`value` IS NOT NULL
     AND cs.`region` NOT IN ('Aggregates', 'World', '')
   GROUP BY cs.`region`
   LIMIT 1000;
   ```

21. **List Countries in Each Region with Their GDP:**

   ```sql
   SELECT cs.`region`, id.`country_name`, id.`value`
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
     ON id.`country_code` = cs.`country_code`
   WHERE id.`indicator_code` = 'NY.GDP.MKTP.KD'
     AND id.`year` = 2019
     AND id.`value` IS NOT NULL
     AND cs.`region` NOT IN ('Aggregates', 'World', '')
   ORDER BY cs.`region`, id.`value` DESC
   LIMIT 1000;
   ```

22. **Find the Number of Countries per Region:**

   ```sql
   SELECT cs.`region`, COUNT(DISTINCT cs.`country_code`) AS `country_count`
   FROM `bigquery-public-data.world_bank_wdi.country_summary` AS cs
   WHERE cs.`region` NOT IN ('Aggregates', 'World', '')
   GROUP BY cs.`region`
   LIMIT 1000;
   ```

23. **Get GDP Statistics per Region:**

   ```sql
   SELECT cs.`region`,
          COUNT(id.`value`) AS `num_countries`,
          AVG(id.`value`) AS `average_gdp`,
          MIN(id.`value`) AS `min_gdp`,
          MAX(id.`value`) AS `max_gdp`
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
     ON id.`country_code` = cs.`country_code`
   WHERE id.`indicator_code` = 'NY.GDP.MKTP.KD'
     AND id.`year` = 2019
     AND id.`value` IS NOT NULL
     AND cs.`region` NOT IN ('Aggregates', 'World', '')
   GROUP BY cs.`region`
   LIMIT 1000;
   ```

24. **Identify Regions with Missing GDP Data:**

   ```sql
   SELECT cs.`region`, COUNT(*) AS `missing_gdp_count`
   FROM `bigquery-public-data.world_bank_wdi.country_summary` AS cs
   LEFT JOIN `bigquery-public-data.world_bank_wdi.indicators_data` AS id
     ON cs.`country_code` = id.`country_code`
     AND id.`indicator_code` = 'NY.GDP.MKTP.KD'
     AND id.`year` = 2019
   WHERE id.`value` IS NULL
     AND cs.`region` NOT IN ('Aggregates', 'World', '')
   GROUP BY cs.`region`
   LIMIT 1000;
   ```

25. **Retrieve GDP for Countries with Highest GDP in Each Region:**

   ```sql
   SELECT cs.`region`, id.`country_name`, id.`value`
   FROM (
     SELECT id.*, ROW_NUMBER() OVER (PARTITION BY cs.`region` ORDER BY id.`value` DESC) AS rn
     FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
     JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
       ON id.`country_code` = cs.`country_code`
     WHERE id.`indicator_code` = 'NY.GDP.MKTP.KD'
       AND id.`year` = 2019
       AND id.`value` IS NOT NULL
       AND cs.`region` NOT IN ('Aggregates', 'World', '')
   ) AS t
   WHERE t.rn = 1
   LIMIT 1000;
   ```

---

**Explanation of Queries:**

- **Queries 16-19:** Help retrieve GDP values along with region information, excluding aggregate entries to focus on individual countries.
- **Query 20:** Uses `APPROX_QUANTILES` to estimate the median GDP for each region, assisting in identifying the region with the highest median GDP.
- **Queries 21-25:** Provide additional insights into the GDP distribution per region, including statistical measures and handling of missing data.

---

**Conclusion:**

By analyzing the results of these queries, specifically the output of **Query 20**, we can determine the median GDP for each region. The region with the highest median GDP (constant 2015 US$) value is typically **North America**, as it includes countries with significantly high GDPs like the United States and Canada.

---

Please let me know if you need further assistance or have any questions about these queries or how to interpret the results.
2025-01-20 11:19:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 11:19:29 - root - INFO - SQL:
SELECT cs.`region`,
          COUNT(id.`value`) AS `num_countries`,
          AVG(id.`value`) AS `average_gdp`,
          MIN(id.`value`) AS `min_gdp`,
          MAX(id.`value`) AS `max_gdp`
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
     ON id.`country_code` = cs.`country_code`
   WHERE id.`indicator_code` = 'NY.GDP.MKTP.KD'
     AND id.`year` = 2019
     AND id.`value` IS NOT NULL
     AND cs.`region` NOT IN ('Aggregates', 'World', '')
   GROUP BY cs.`region`
   LIMIT 1000;
Results:
region,num_countries,average_gdp,min_gdp,max_gdp
Sub-Saharan Africa,46,39604795061.31859,359752972.346268,502942019447.736
East Asia & Pacific,34,754966404370.8977,42824596.8653884,14296238286985.1
Europe & Central Asia,54,413777989849.8653,1514041111.68851,3598891541091.34
Middle East & North Africa,20,167057963295.84705,3191833262.48686,678581100842.581
Latin America & Caribbean,37,143902774165.0307,568298267.854584,1823105452462.95
North America,3,7225849553024.16,6851270046.39601,19974534312000.0
South Asia,8,428933254078.4158,2470944511.92544,2695611314661.46

2025-01-20 11:19:31 - root - INFO - SQL:
SELECT DISTINCT `region`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
LIMIT 1000
Results:
region
""
Europe & Central Asia
North America
Latin America & Caribbean
East Asia & Pacific
Sub-Saharan Africa
Middle East & North Africa
South Asia

2025-01-20 11:19:32 - root - INFO - SQL:
SELECT `country_code`, `short_name`, `region`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
LIMIT 1000
Results:
country_code,short_name,region
AFE,Africa Eastern and Southern,
AFW,Africa Western and Central,
ARB,Arab World,
CEB,Central Europe and the Baltics,
CSS,Caribbean small states,
EAP,East Asia & Pacific (excluding high income),
EAR,Early-demographic dividend,
EAS,East Asia & Pacific,
ECA,Europe & Central Asia (excluding high income),
ECS,Europe & Central Asia,
EUU,European Union,
FCS,Fragile and conflict affected situations,
HIC,High income,
HPC,Heavily indebted poor countries (HIPC),
IBD,IBRD only,
IBT,IDA & IBRD total,
IDA,IDA total,
IDB,IDA blend,
IDX,IDA only,
LAC,Latin America & Caribbean (excluding high income),
LCN,Latin America & Caribbean,
LDC,Least developed countries: UN classification,
LIC,Low income,
LMC,Lower middle income,
LMY,Low & middle income,
LTE,Late-demographic dividend,
MEA,Middle East & North Africa,
MIC,Middle income,
MNA,Middle East & North Africa (excluding high income),
NAC,North America,
OED,OECD members,
OSS,Other small states,
PRE,Pre-demographic dividend,
PSS,Pacific island small states,
PST,Post-demographic dividend,
SAS,South Asia,
SSA,Sub-Saharan Africa (excluding high income),
SSF,Sub-Saharan Africa,
SST,Small states,
TEA,East Asia & Pacific (IDA & IBRD),
TEC,Europe & Central Asia (IDA & IBRD),
TLA,Latin America & Caribbean (IDA & IBRD),
TMN,Middle East & North Africa (IDA & IBRD),
TSA,South Asia (IDA & IBRD),
TSS,Sub-Saharan Africa (IDA & IBRD),
UMC,Upper middle income,
WLD,World,
AND,Andorra,Europe & Central Asia
BMU,Bermuda,North America
CHI,Channel Islands,Europe & Central Asia
CUW,Curaçao,Latin America & Caribbean
CYM,Cayman Islands,Latin America & Caribbean
FRO,Faroe Islands,Europe & Central Asia
GIB,Gibraltar,Europe & Central Asia
GRL,Greenland,Europe & Central Asia
GUM,Guam,East Asia & Pacific
IMN,Isle of Man,Europe & Central Asia
LIE,Liechtenstein,Europe & Central Asia
MAF,St. Martin (French part),Latin America & Caribbean
MCO,Monaco,Europe & Central Asia
MNP,Northern Mariana Islands,East Asia & Pacific

2025-01-20 11:19:34 - root - INFO - SQL:
SELECT `country_code`, `short_name`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
WHERE `region` IS NULL OR `region` = ''
LIMIT 1000
Results:
country_code,short_name
AFE,Africa Eastern and Southern
AFW,Africa Western and Central
ARB,Arab World
CEB,Central Europe and the Baltics
CSS,Caribbean small states
EAP,East Asia & Pacific (excluding high income)
EAR,Early-demographic dividend
EAS,East Asia & Pacific
ECA,Europe & Central Asia (excluding high income)
ECS,Europe & Central Asia
EUU,European Union
FCS,Fragile and conflict affected situations
HIC,High income
HPC,Heavily indebted poor countries (HIPC)
IBD,IBRD only
IBT,IDA & IBRD total
IDA,IDA total
IDB,IDA blend
IDX,IDA only
LAC,Latin America & Caribbean (excluding high income)
LCN,Latin America & Caribbean
LDC,Least developed countries: UN classification
LIC,Low income
LMC,Lower middle income
LMY,Low & middle income
LTE,Late-demographic dividend
MEA,Middle East & North Africa
MIC,Middle income
MNA,Middle East & North Africa (excluding high income)
NAC,North America
OED,OECD members
OSS,Other small states
PRE,Pre-demographic dividend
PSS,Pacific island small states
PST,Post-demographic dividend
SAS,South Asia
SSA,Sub-Saharan Africa (excluding high income)
SSF,Sub-Saharan Africa
SST,Small states
TEA,East Asia & Pacific (IDA & IBRD)
TEC,Europe & Central Asia (IDA & IBRD)
TLA,Latin America & Caribbean (IDA & IBRD)
TMN,Middle East & North Africa (IDA & IBRD)
TSA,South Asia (IDA & IBRD)
TSS,Sub-Saharan Africa (IDA & IBRD)
UMC,Upper middle income
WLD,World
EMU,Euro area

2025-01-20 11:19:36 - root - INFO - SQL:
SELECT DISTINCT `year`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `indicator_code` = 'NY.GDP.MKTP.KD'
ORDER BY `year`
LIMIT 1000
Results:
year
1960
1961
1962
1963
1964
1965
1966
1967
1968
1969
1970
1971
1972
1973
1974
1975
1976
1977
1978
1979
1980
1981
1982
1983
1984
1985
1986
1987
1988
1989
1990
1991
1992
1993
1994
1995
1996
1997
1998
1999
2000
2001
2002
2003
2004
2005
2006
2007
2008
2009
2010
2011
2012
2013
2014
2015
2016
2017
2018
2019
2020

2025-01-20 11:19:39 - root - INFO - SQL:
SELECT DISTINCT `indicator_name`, `indicator_code`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
LIMIT 1000
Results:
indicator_name,indicator_code
Net official development assistance and official aid received (constant 2018 US$),DT.ODA.ALLD.KD
Net official development assistance and official aid received (current US$),DT.ODA.ALLD.CD
Net official development assistance received (constant 2018 US$),DT.ODA.ODAT.KD
"Net official flows from UN agencies, ILO (current US$)",DT.NFL.ILOG.CD
"Net official flows from UN agencies, UNICEF (current US$)",DT.NFL.UNCF.CD
"Net official flows from UN agencies, WFP (current US$)",DT.NFL.WFPG.CD
"Net official flows from UN agencies, WHO (current US$)",DT.NFL.WHOL.CD
Newborns protected against tetanus (%),SH.VAC.TTNS.ZS
Nitrous oxide emissions (thousand metric tons of CO2 equivalent),EN.ATM.NOXE.KT.CE
Number of deaths ages 20-24 years,SH.DTH.2024
Number of deaths ages 5-9 years,SH.DTH.0509
Number of neonatal deaths,SH.DTH.NMRT
Ores and metals exports (% of merchandise exports),TX.VAL.MMTL.ZS.UN
Ores and metals imports (% of merchandise imports),TM.VAL.MMTL.ZS.UN
Other greenhouse gas emissions (% change from 1990),EN.ATM.GHGO.ZG
"Other greenhouse gas emissions, HFC, PFC and SF6 (thousand metric tons of CO2 equivalent)",EN.ATM.GHGO.KT.CE
Out-of-pocket expenditure (% of current health expenditure),SH.XPD.OOPC.CH.ZS
Out-of-pocket expenditure per capita (current US$),SH.XPD.OOPC.PC.CD
"Over-age students, primary, female (% of female enrollment)",SE.PRM.OENR.FE.ZS
People practicing open defecation (% of population),SH.STA.ODFC.ZS
"Persistence to last grade of primary, male (% of cohort)",SE.PRM.PRSL.MA.ZS
"Personal remittances, received (% of GDP)",BX.TRF.PWKR.DT.GD.ZS
"Personal transfers, receipts (BoP, current US$)",BX.TRF.PWKR.CD
"PNG, commercial banks and other creditors (NFL, current US$)",DT.NFL.PNGC.CD
Population ages 0-14 (% of total population),SP.POP.0014.TO.ZS
"Population ages 0-14, female",SP.POP.0014.FE.IN
"Population ages 05-09, female (% of female population)",SP.POP.0509.FE.5Y
"Population ages 05-09, male (% of male population)",SP.POP.0509.MA.5Y
"Population ages 10-14, male (% of male population)",SP.POP.1014.MA.5Y
"Population ages 15-19, male (% of male population)",SP.POP.1519.MA.5Y
"Population ages 15-64, male (% of male population)",SP.POP.1564.MA.ZS
"Population ages 20-24, male (% of male population)",SP.POP.2024.MA.5Y
"Population ages 25-29, male (% of male population)",SP.POP.2529.MA.5Y
"Population ages 30-34, male (% of male population)",SP.POP.3034.MA.5Y
"Population ages 35-39, female (% of female population)",SP.POP.3539.FE.5Y
"Population ages 35-39, male (% of male population)",SP.POP.3539.MA.5Y
"Population ages 40-44, male (% of male population)",SP.POP.4044.MA.5Y
"Population ages 55-59, male (% of male population)",SP.POP.5559.MA.5Y
"Population ages 60-64, female (% of female population)",SP.POP.6064.FE.5Y
Population ages 65 and above (% of total population),SP.POP.65UP.TO.ZS
"Population ages 65 and above, male (% of male population)",SP.POP.65UP.MA.ZS
"Population ages 65-69, female (% of female population)",SP.POP.6569.FE.5Y
"Population ages 70-74, female (% of female population)",SP.POP.7074.FE.5Y
"Population ages 75-79, male (% of male population)",SP.POP.7579.MA.5Y
"Population ages 80 and above, female (% of female population)",SP.POP.80UP.FE.5Y

2025-01-20 11:19:40 - root - INFO - SQL:
SELECT `short_name`, `region`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
LIMIT 1000
Results:
short_name,region
Africa Eastern and Southern,
Africa Western and Central,
Arab World,
Central Europe and the Baltics,
Caribbean small states,
East Asia & Pacific (excluding high income),
Early-demographic dividend,
East Asia & Pacific,
Europe & Central Asia (excluding high income),
Europe & Central Asia,
European Union,
Fragile and conflict affected situations,
High income,
Heavily indebted poor countries (HIPC),
IBRD only,
IDA & IBRD total,
IDA total,
IDA blend,
IDA only,
Latin America & Caribbean (excluding high income),
Latin America & Caribbean,
Least developed countries: UN classification,
Low income,
Lower middle income,
Low & middle income,
Late-demographic dividend,
Middle East & North Africa,
Middle income,
Middle East & North Africa (excluding high income),
North America,
OECD members,
Other small states,
Pre-demographic dividend,
Pacific island small states,
Post-demographic dividend,
South Asia,
Sub-Saharan Africa (excluding high income),
Sub-Saharan Africa,
Small states,
East Asia & Pacific (IDA & IBRD),
Europe & Central Asia (IDA & IBRD),
Latin America & Caribbean (IDA & IBRD),
Middle East & North Africa (IDA & IBRD),
South Asia (IDA & IBRD),
Sub-Saharan Africa (IDA & IBRD),
Upper middle income,
World,
Andorra,Europe & Central Asia
Bermuda,North America
Channel Islands,Europe & Central Asia
Curaçao,Latin America & Caribbean
Cayman Islands,Latin America & Caribbean
Faroe Islands,Europe & Central Asia
Gibraltar,Europe & Central Asia
Greenland,Europe & Central Asia
Guam,East Asia & Pacific
Isle of Man,Europe & Central Asia
Liechtenstein,Europe & Central Asia
St. Martin (French part),Latin America & Caribbean
Monaco,Europe & Central Asia
Northern Mariana Islands,East Asia & Pacific
New Caledonia,East Asia & Pacific
Nauru,East Asia & Pacific
New Zealand,East Asia & Pacific
Puerto Rico,Latin America & Caribbean
French Polynesia,East Asia & Pacific
Sint Maarten (Dutch part),Latin America & Caribbean
Turks and Caicos Islands,Latin America & Caribbean
British Virgin Islands,Latin America & Caribbean
Virgin Islands,Latin America & Caribbean
Eritrea,Sub-Saharan Africa
Dem. People's Rep. Korea,East Asia & Pacific
Somalia,Sub-Saharan Africa
South Sudan,Sub-Saharan Africa
American Samoa,East Asia & Pacific
Cuba,Latin America & Caribbean
Turkmenistan,Europe & Central Asia
Venezuela,Latin America & Caribbean
Aruba,Latin America & Caribbean
United Arab Emirates,Middle East & North Africa
Antigua and Barbuda,Latin America & Caribbean
Bahrain,Middle East & North Africa

2025-01-20 11:19:42 - root - INFO - SQL:
SELECT `year`, `value`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `indicator_code` = 'NY.GDP.MKTP.KD' AND `country_name` = 'United States'
ORDER BY `year`
LIMIT 1000
Results:
year,value
1960,3457188037625.69
1961,3536703362491.07
1962,3752442267603.03
1963,3917549727377.56
1964,4144767611565.47
1965,4410032738705.65
1966,4696684866721.53
1967,4814101988389.57
1968,5045178883832.25
1969,5201579429231.05
1970,5183548220000.0
1971,5354260691000.0
1972,5635836299000.0
1973,5954019981000.0
1974,5921835427000.0
1975,5909668657000.0
1976,6228089836000.0
1977,6516086243000.0
1978,6876771488000.0
1979,7094500066000.0
1980,7076284960000.0
1981,7255861209000.0
1982,7125046201000.0
1983,7451652146000.0
1984,7990900876000.0
1985,8324093971000.0
1986,8612327876000.0
1987,8910249999000.0
1988,9282436602000.0
1989,9623347839000.0
1990,9804840807000.0
1991,9794225617000.0
1992,10139221389000.0
1993,10418230561000.0
1994,10837959532000.0
1995,11128873914000.0
1996,11548717972000.0
1997,12054756829000.0
1998,12594979613000.0
1999,13193648716000.0
2000,13738214458000.0
2001,13875368657000.0
2002,14117035294000.0
2003,14520953428000.0
2004,15072588639000.0
2005,15602120903000.0
2006,16047557132000.0
2007,16348636818000.0
2008,16326307882000.0
2009,15912149113000.0
2010,16320099471000.0
2011,16573197368000.0
2012,16946019042000.0
2013,17258178451000.0
2014,17694115456000.0
2015,18238300569000.0
2016,18550435728000.0
2017,18983157920000.0
2018,19551981480000.0
2019,19974534312000.0
2020,19294483000000.0

2025-01-20 11:19:44 - root - INFO - SQL:
SELECT `short_name`, `income_group`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
LIMIT 1000
Results:
short_name,income_group
Africa Eastern and Southern,
Africa Western and Central,
Arab World,
Central Europe and the Baltics,
Caribbean small states,
East Asia & Pacific (excluding high income),
Early-demographic dividend,
East Asia & Pacific,
Europe & Central Asia (excluding high income),
Europe & Central Asia,
European Union,
Fragile and conflict affected situations,
High income,
Heavily indebted poor countries (HIPC),
IBRD only,
IDA & IBRD total,
IDA total,
IDA blend,
IDA only,
Latin America & Caribbean (excluding high income),
Latin America & Caribbean,
Least developed countries: UN classification,
Low income,
Lower middle income,
Low & middle income,
Late-demographic dividend,
Middle East & North Africa,
Middle income,
Middle East & North Africa (excluding high income),
North America,
OECD members,
Other small states,
Pre-demographic dividend,
Pacific island small states,
Post-demographic dividend,
South Asia,
Sub-Saharan Africa (excluding high income),
Sub-Saharan Africa,
Small states,
East Asia & Pacific (IDA & IBRD),
Europe & Central Asia (IDA & IBRD),
Latin America & Caribbean (IDA & IBRD),
Middle East & North Africa (IDA & IBRD),
South Asia (IDA & IBRD),
Sub-Saharan Africa (IDA & IBRD),
Upper middle income,
World,
Andorra,High income
Bermuda,High income
Channel Islands,High income
Curaçao,High income
Cayman Islands,High income
Faroe Islands,High income
Gibraltar,High income
Greenland,High income
Guam,High income
Isle of Man,High income
Liechtenstein,High income
St. Martin (French part),High income
Monaco,High income
Northern Mariana Islands,High income
New Caledonia,High income
Nauru,High income
New Zealand,High income
Puerto Rico,High income
French Polynesia,High income
Sint Maarten (Dutch part),High income
Turks and Caicos Islands,High income
British Virgin Islands,High income
Virgin Islands,High income
Eritrea,Low income
Dem. People's Rep. Korea,Low income
Somalia,Low income
South Sudan,Low income
American Samoa,Upper middle income
Cuba,Upper middle income
Turkmenistan,Upper middle income
Venezuela,
Aruba,High income
United Arab Emirates,High income

2025-01-20 11:20:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 11:20:21 - root - INFO - ```sql
SELECT `country_name`, `value`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `indicator_code` = 'NY.GDP.MKTP.KD' AND `year` = 2019
LIMIT 1000;
```
2025-01-20 11:20:51 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 11:20:51 - root - INFO - SQL:
SELECT `country_name`, `value`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `indicator_code` = 'NY.GDP.MKTP.KD' AND `year` = 2019
LIMIT 1000;
Results:
country_name,value
Gabon,15460241608.8257
Namibia,11240759011.0283
Angola,110072586683.261
Sudan,51312429477.3951
Middle East & North Africa (excluding high income),1538200834048.04
Africa Eastern and Southern,1006679813065.29
Tonga,486181549.588749
Turkmenistan,45710025776.6731
Early-demographic dividend,11703037495097.2
Qatar,167371229308.42
Europe & Central Asia (IDA & IBRD countries),4095463099662.97
Austria,414257026093.423
Nigeria,502942019447.736
Germany,3598891541091.34
Mozambique,18183590595.087
Lao PDR,18491845636.2733
Malta,13856372628.2222
Samoa,887495263.360233
Heavily indebted poor countries (HIPC),788661392496.297
Madagascar,13186360351.4331
Slovenia,50249892617.4104
Kazakhstan,211106972039.014
Portugal,222272974069.03
United Kingdom,3191493407624.4
North America,21677548659072.5
Arab World,2681441590769.14
Oman,83053174485.8283
Sub-Saharan Africa (IDA & IBRD countries),1834643244102.56
Latin America & Caribbean (excluding high income),4853709324043.9
Ethiopia,89640020508.4013
Czech Republic,215594735504.853
Turks and Caicos Islands,1095902844.26329
Guinea,12078653011.9638
Belize,1835056955.71673
Kuwait,114249382864.585
Myanmar,83686992015.6706
Latvia,30716038078.95
Azerbaijan,53612524527.3911
Uruguay,55513344382.0673
Luxembourg,67286460381.3888
Caribbean small states,74283427277.9706
Greece,203669187367.386
Cambodia,23760061873.2798
East Asia & Pacific (IDA & IBRD countries),16995303639412.5
Finland,254637296103.695
Low income,476617321590.818
Djibouti,3191833262.48686
Lithuania,48155059559.2863
Croatia,57190160216.5408
South Asia,3431466032627.32
South Asia (IDA & IBRD),3431466032627.32
Guinea-Bissau,1248729327.89726
Albania,12970913827.5704
Monaco,7080667991.59357
"Congo, Rep.",9643515879.79193
Georgia,17757903230.0709
Mongolia,14174566299.8985
Montenegro,4777636043.80572
Estonia,27068147756.8566
Europe & Central Asia (excluding high income),3468157804813.19
Trinidad and Tobago,22587789317.2434
Israel,353062816517.302
United States,19974534312000.0
Malawi,7477443338.32784
IDA only,1229224147182.17
Central African Republic,1984982171.73544
IDA blend,1121954012747.96
"Bahamas, The",12516819004.1803
Togo,5098275352.1552
Burundi,3209182941.33059
Syrian Arab Republic,16265870694.9063
Fiji,5223164712.00555
Barbados,4822013073.75235
Nicaragua,12991624156.9782
Ghana,62465709576.1815
Ukraine,101944109453.562
San Marino,1514041111.68851
Pre-demographic dividend,1450630111014.12
Poland,570115134633.24
Suriname,5252729241.66594
Italy,1915994931005.09
IDA total,2351178159930.13
Virgin Islands (U.S.),3835985859.12487
Sub-Saharan Africa,1834643244102.56

2025-01-20 11:20:53 - root - INFO - SQL:
SELECT `country_name`, `value`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `indicator_code` = 'NY.GDP.MKTP.KD' AND `year` = 2019 AND `value` IS NOT NULL
LIMIT 1000
Results:
country_name,value
Gabon,15460241608.8257
Namibia,11240759011.0283
Angola,110072586683.261
Sudan,51312429477.3951
Middle East & North Africa (excluding high income),1538200834048.04
Africa Eastern and Southern,1006679813065.29
Tonga,486181549.588749
Turkmenistan,45710025776.6731
Early-demographic dividend,11703037495097.2
Qatar,167371229308.42
Europe & Central Asia (IDA & IBRD countries),4095463099662.97
Austria,414257026093.423
Nigeria,502942019447.736
Germany,3598891541091.34
Mozambique,18183590595.087
Lao PDR,18491845636.2733
Malta,13856372628.2222
Samoa,887495263.360233
Heavily indebted poor countries (HIPC),788661392496.297
Madagascar,13186360351.4331
Slovenia,50249892617.4104
Kazakhstan,211106972039.014
Portugal,222272974069.03
United Kingdom,3191493407624.4
North America,21677548659072.5
Arab World,2681441590769.14
Oman,83053174485.8283
Sub-Saharan Africa (IDA & IBRD countries),1834643244102.56
Latin America & Caribbean (excluding high income),4853709324043.9
Ethiopia,89640020508.4013
Czech Republic,215594735504.853
Turks and Caicos Islands,1095902844.26329
Guinea,12078653011.9638
Belize,1835056955.71673
Kuwait,114249382864.585
Myanmar,83686992015.6706
Latvia,30716038078.95
Azerbaijan,53612524527.3911
Uruguay,55513344382.0673
Luxembourg,67286460381.3888
Caribbean small states,74283427277.9706
Greece,203669187367.386
Cambodia,23760061873.2798
East Asia & Pacific (IDA & IBRD countries),16995303639412.5
Finland,254637296103.695
Low income,476617321590.818
Djibouti,3191833262.48686
Lithuania,48155059559.2863
Croatia,57190160216.5408
South Asia,3431466032627.32
South Asia (IDA & IBRD),3431466032627.32
Guinea-Bissau,1248729327.89726
Albania,12970913827.5704
Monaco,7080667991.59357
"Congo, Rep.",9643515879.79193
Georgia,17757903230.0709
Mongolia,14174566299.8985
Montenegro,4777636043.80572
Estonia,27068147756.8566
Europe & Central Asia (excluding high income),3468157804813.19
Trinidad and Tobago,22587789317.2434
Israel,353062816517.302
United States,19974534312000.0
Malawi,7477443338.32784
IDA only,1229224147182.17
Central African Republic,1984982171.73544
IDA blend,1121954012747.96
"Bahamas, The",12516819004.1803
Togo,5098275352.1552
Burundi,3209182941.33059
Syrian Arab Republic,16265870694.9063
Fiji,5223164712.00555
Barbados,4822013073.75235
Nicaragua,12991624156.9782
Ghana,62465709576.1815
Ukraine,101944109453.562
San Marino,1514041111.68851
Pre-demographic dividend,1450630111014.12
Poland,570115134633.24
Suriname,5252729241.66594
Italy,1915994931005.09
IDA total,2351178159930.13
Virgin Islands (U.S.),3835985859.12487
Sub-Saharan Africa,1834643244102.56

2025-01-20 11:20:55 - root - INFO - SQL:
SELECT `year`, `value`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `indicator_code` = 'NY.GDP.MKTP.KD' AND `country_code` = 'USA'
ORDER BY `year`
LIMIT 1000
Results:
year,value
1960,3457188037625.69
1961,3536703362491.07
1962,3752442267603.03
1963,3917549727377.56
1964,4144767611565.47
1965,4410032738705.65
1966,4696684866721.53
1967,4814101988389.57
1968,5045178883832.25
1969,5201579429231.05
1970,5183548220000.0
1971,5354260691000.0
1972,5635836299000.0
1973,5954019981000.0
1974,5921835427000.0
1975,5909668657000.0
1976,6228089836000.0
1977,6516086243000.0
1978,6876771488000.0
1979,7094500066000.0
1980,7076284960000.0
1981,7255861209000.0
1982,7125046201000.0
1983,7451652146000.0
1984,7990900876000.0
1985,8324093971000.0
1986,8612327876000.0
1987,8910249999000.0
1988,9282436602000.0
1989,9623347839000.0
1990,9804840807000.0
1991,9794225617000.0
1992,10139221389000.0
1993,10418230561000.0
1994,10837959532000.0
1995,11128873914000.0
1996,11548717972000.0
1997,12054756829000.0
1998,12594979613000.0
1999,13193648716000.0
2000,13738214458000.0
2001,13875368657000.0
2002,14117035294000.0
2003,14520953428000.0
2004,15072588639000.0
2005,15602120903000.0
2006,16047557132000.0
2007,16348636818000.0
2008,16326307882000.0
2009,15912149113000.0
2010,16320099471000.0
2011,16573197368000.0
2012,16946019042000.0
2013,17258178451000.0
2014,17694115456000.0
2015,18238300569000.0
2016,18550435728000.0
2017,18983157920000.0
2018,19551981480000.0
2019,19974534312000.0
2020,19294483000000.0

2025-01-20 11:20:57 - root - INFO - SQL:
SELECT DISTINCT `country_name`, `country_code`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
LIMIT 1000
Results:
country_name,country_code
Mozambique,MOZ
Myanmar,MMR
Namibia,NAM
Nauru,NRU
Nepal,NPL
Netherlands,NLD
New Caledonia,NCL
New Zealand,NZL
Nicaragua,NIC
Niger,NER
Nigeria,NGA
British Virgin Islands,VGB
Brunei Darussalam,BRN
Bulgaria,BGR
Burkina Faso,BFA
Burundi,BDI
Cabo Verde,CPV
Cambodia,KHM
Canada,CAN
Latin America & Caribbean,LCN
Latin America & Caribbean (excluding high income),LAC
Latin America & the Caribbean (IDA & IBRD countries),TLA
Least developed countries: UN classification,LDC
Low & middle income,LMY
Low income,LIC
Lower middle income,LMC
Middle East & North Africa,MEA
Middle East & North Africa (excluding high income),MNA
Czech Republic,CZE
Denmark,DNK
Djibouti,DJI
Dominica,DMA
Equatorial Guinea,GNQ
Kuwait,KWT
Kyrgyz Republic,KGZ
Lao PDR,LAO
Latvia,LVA
Lebanon,LBN
Lesotho,LSO
Liberia,LBR
Libya,LBY
Liechtenstein,LIE
Lithuania,LTU
Luxembourg,LUX
"Macao SAR, China",MAC
Africa Eastern and Southern,AFE
Africa Western and Central,AFW
Arab World,ARB
Caribbean small states,CSS
Central Europe and the Baltics,CEB
Early-demographic dividend,EAR
East Asia & Pacific,EAS
East Asia & Pacific (excluding high income),EAP
East Asia & Pacific (IDA & IBRD countries),TEA
Russian Federation,RUS
Rwanda,RWA
Samoa,WSM
San Marino,SMR
Sao Tome and Principe,STP
Saudi Arabia,SAU
Serbia,SRB
Seychelles,SYC
Sierra Leone,SLE
Singapore,SGP
North Macedonia,MKD
Northern Mariana Islands,MNP
Norway,NOR
Oman,OMN
Palau,PLW
Papua New Guinea,PNG
Cayman Islands,CYM
Central African Republic,CAF
Chad,TCD
Channel Islands,CHI
China,CHN
Comoros,COM
"Congo, Dem. Rep.",COD
Upper middle income,UMC
World,WLD
Afghanistan,AFG
Albania,ALB
Algeria,DZA
American Samoa,ASM
Andorra,AND
Angola,AGO
Antigua and Barbuda,ATG
Armenia,ARM
Aruba,ABW

2025-01-20 11:20:57 - root - INFO - itercount: 0
2025-01-20 11:20:57 - root - INFO - Database Name: bigquery-public-data
Schema Name: world_bank_global_population
DDL describes table information.
,0
table_name,population_by_country
ddl,"CREATE TABLE `bigquery-public-data.world_bank_global_population.population_by_country`
(
  country STRING,
  country_code STRING,
  year_1960 INT64,
  year_1961 INT64,
  year_1962 INT64,
  year_1963 INT64,
  year_1964 INT64,
  year_1965 INT64,
  year_1966 INT64,
  year_1967 INT64,
  year_1968 INT64,
  year_1969 INT64,
  year_1970 INT64,
  year_1971 INT64,
  year_1972 INT64,
  year_1973 INT64,
  year_1974 INT64,
  year_1975 INT64,
  year_1976 INT64,
  year_1977 INT64,
  year_1978 INT64,
  year_1979 INT64,
  year_1980 INT64,
  year_1981 INT64,
  year_1982 INT64,
  year_1983 INT64,
  year_1984 INT64,
  year_1985 INT64,
  year_1986 INT64,
  year_1987 INT64,
  year_1988 INT64,
  year_1989 INT64,
  year_1990 INT64,
  year_1991 INT64,
  year_1992 INT64,
  year_1993 INT64,
  year_1994 INT64,
  year_1995 INT64,
  year_1996 INT64,
  year_1997 INT64,
  year_1998 INT64,
  year_1999 INT64,
  year_2000 INT64,
  year_2001 INT64,
  year_2002 INT64,
  year_2003 INT64,
  year_2004 INT64,
  year_2005 INT64,
  year_2006 INT64,
  year_2007 INT64,
  year_2008 INT64,
  year_2009 INT64,
  year_2010 INT64,
  year_2011 INT64,
  year_2012 INT64,
  year_2013 INT64,
  year_2014 INT64,
  year_2015 INT64,
  year_2016 INT64,
  year_2017 INT64,
  year_2018 INT64,
  year_2019 INT64
)
PARTITION BY DATE(_PARTITIONTIME);"

Database Name: bigquery-public-data
Schema Name: world_bank_health_population
DDL describes table information.
,0
table_name,series_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.series_summary`
(
  series_code STRING,
  topic STRING,
  indicator_name STRING,
  short_definition STRING,
  long_definition STRING,
  unit_of_measure STRING,
  periodicity STRING,
  base_period INT64,
  other_notes STRING,
  aggregation_method STRING,
  limitations_and_exceptions STRING,
  notes_from_original_source STRING,
  general_comments STRING,
  source STRING,
  statistical_concept_and_methodology STRING,
  development_relevance STRING,
  related_source_links STRING,
  other_web_links STRING,
  related_indicators STRING,
  license_type STRING
)
OPTIONS(
  description=""Series Summary table""
);"

,1
table_name,country_series_definitions
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.country_series_definitions`
(
  country_code STRING,
  series_code STRING,
  description STRING
)
OPTIONS(
  description=""Country Series Definition table""
);"

,2
table_name,series_times
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.series_times`
(
  series_code STRING,
  year INT64,
  description STRING
)
OPTIONS(
  description=""Series Times table""
);"

,3
table_name,country_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.country_summary`
(
  country_code STRING,
  short_name STRING,
  table_name STRING,
  long_name STRING,
  two_alpha_code STRING,
  currency_unit STRING,
  special_notes STRING,
  region STRING,
  income_group STRING,
  wb_2_code STRING,
  national_accounts_base_year STRING,
  national_accounts_reference_year STRING,
  sna_price_valuation STRING,
  lending_category STRING,
  other_groups STRING,
  system_of_national_accounts STRING,
  alternative_conversion_factor STRING,
  ppp_survey_year STRING,
  balance_of_payments_manual_in_use STRING,
  external_debt_reporting_status STRING,
  system_of_trade STRING,
  government_accounting_concept STRING,
  imf_data_dissemination_standard STRING,
  latest_population_census STRING,
  latest_household_survey STRING,
  source_of_most_recent_income_and_expenditure_data STRING,
  vital_registration_complete STRING,
  latest_agricultural_census STRING,
  latest_industrial_data INT64,
  latest_trade_data INT64
)
OPTIONS(
  description=""Country Summary table""
);"

,4
table_name,health_nutrition_population
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.health_nutrition_population`
(
  country_name STRING OPTIONS(description=""""),
  country_code STRING OPTIONS(description=""""),
  indicator_name STRING OPTIONS(description=""""),
  indicator_code STRING OPTIONS(description=""""),
  value FLOAT64 OPTIONS(description=""""),
  year INT64 OPTIONS(description="""")
);"

Database Name: bigquery-public-data
Schema Name: world_bank_intl_debt
DDL describes table information.
,0
table_name,series_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.series_summary`
(
  series_code STRING,
  topic STRING,
  indicator_name STRING,
  short_definition STRING,
  long_definition STRING,
  unit_of_measure STRING,
  periodicity STRING,
  base_period STRING,
  other_notes STRING,
  aggregation_method STRING,
  limitations_and_exceptions STRING,
  notes_from_original_source STRING,
  general_comments STRING,
  source STRING,
  statistical_concept_and_methodology STRING,
  development_relevance STRING,
  related_source_links STRING,
  other_web_links STRING,
  related_indicators STRING,
  license_type STRING
)
OPTIONS(
  description=""Series Summary table""
);"

,1
table_name,country_series_definitions
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.country_series_definitions`
(
  country_code STRING,
  series_code STRING,
  description STRING
)
OPTIONS(
  description=""Country Series Definition table""
);"

,2
table_name,series_times
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.series_times`
(
  series_code STRING,
  year INT64,
  description STRING
)
OPTIONS(
  description=""Series Times table""
);"

,3
table_name,country_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.country_summary`
(
  country_code STRING,
  short_name STRING,
  table_name STRING,
  long_name STRING,
  two_alpha_code STRING,
  currency_unit STRING,
  special_notes STRING,
  region STRING,
  income_group STRING,
  wb_2_code STRING,
  national_accounts_base_year STRING,
  national_accounts_reference_year STRING,
  sna_price_valuation STRING,
  lending_category STRING,
  other_groups STRING,
  system_of_national_accounts STRING,
  alternative_conversion_factor STRING,
  ppp_survey_year STRING,
  balance_of_payments_manual_in_use STRING,
  external_debt_reporting_status STRING,
  system_of_trade STRING,
  government_accounting_concept STRING,
  imf_data_dissemination_standard STRING,
  latest_population_census STRING,
  latest_household_survey STRING,
  source_of_most_recent_Income_and_expenditure_data STRING,
  vital_registration_complete STRING,
  latest_agricultural_census STRING,
  latest_industrial_data INT64,
  latest_trade_data INT64,
  latest_water_withdrawal_data STRING
)
OPTIONS(
  description=""Country Summary table""
);"

,4
table_name,international_debt
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.international_debt`
(
  country_name STRING OPTIONS(description=""""),
  country_code STRING OPTIONS(description=""""),
  indicator_name STRING OPTIONS(description=""""),
  indicator_code STRING OPTIONS(description=""""),
  value FLOAT64 OPTIONS(description=""""),
  year INT64 OPTIONS(description="""")
);"

Database Name: bigquery-public-data
Schema Name: world_bank_intl_education
DDL describes table information.
,0
table_name,series_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_education.series_summary`
(
  series_code STRING,
  topic STRING,
  indicator_name STRING,
  short_definition STRING,
  long_definition STRING,
  unit_of_measure STRING,
  periodicity STRING,
  base_period STRING,
  other_notes STRING,
  aggregation_method STRING,
  limitations_and_exceptions STRING,
  notes_from_original_source STRING,
  general_comments STRING,
  source STRING,
  statistical_concept_and_methodology STRING,
  development_relevance STRING,
  related_source_links STRING,
  other_web_links STRING,
  related_indicators STRING,
  license_type STRING
)
OPTIONS(
  description=""Series Summary table""
);"

,1
table_name,country_series_definitions
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_education.country_series_definitions`
(
  country_code STRING,
  series_code STRING,
  description STRING
)
OPTIONS(
  description=""Country Series Definition table""
);"

,2
table_name,international_education
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_education.international_education`
(
  country_name STRING OPTIONS(description=""""),
  country_code STRING OPTIONS(description=""""),
  indicator_name STRING OPTIONS(description=""""),
  indicator_code STRING OPTIONS(description=""""),
  value FLOAT64 OPTIONS(description=""""),
  year INT64 OPTIONS(description="""")
);"

,3
table_name,country_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_education.country_summary`
(
  country_code STRING,
  short_name STRING,
  table_name STRING,
  long_name STRING,
  two_alpha_code STRING,
  currency_unit STRING,
  special_notes STRING,
  region STRING,
  income_group STRING,
  wb_two_code STRING,
  national_accounts_base_year STRING,
  national_accounts_reference_year STRING,
  sna_price_valuation STRING,
  lending_category STRING,
  other_groups STRING,
  system_of_national_accounts STRING,
  alternative_conversion_factor STRING,
  ppp_survey_year STRING,
  balance_of_payments_manual_in_use STRING,
  external_debt_reporting_status STRING,
  system_of_trade STRING,
  government_accounting_concept STRING,
  imf_data_dissemination_standard STRING,
  latest_population_census STRING,
  latest_household_survey STRING,
  source_of_most_recent_income_and_expenditure_data STRING,
  vital_registration_complete STRING,
  latest_agricultural_census STRING,
  latest_industrial_data INT64,
  latest_trade_data INT64,
  latest_water_withdrawal_data STRING
)
OPTIONS(
  description=""Country Summary table""
);"

Database Name: bigquery-public-data
Schema Name: world_bank_wdi
DDL describes table information.
,0
table_name,series_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.series_summary`
(
  series_code STRING OPTIONS(description=""A number or a sequence of related statistical units arranged or occurring in temporal spatial or other order or succession. WDI carries mostly time series.""),
  topic STRING OPTIONS(description=""The matter dealt with in the context discourse or subject related to the series.""),
  indicator_name STRING OPTIONS(description=""Given name of a series.""),
  short_definition STRING OPTIONS(description=""Short statement of the exact meaning of a series.""),
  long_definition STRING OPTIONS(description=""Extended statement of the exact meaning of a series.""),
  unit_of_measure STRING OPTIONS(description=""A quantity used as a standard of measurement. Example: Units of time are second minute hour day week month year and decade.""),
  periodicity STRING OPTIONS(description=""Applies to series recurring at regular intervals. Most of the time this term denotes that interval of recurrence.""),
  base_period STRING OPTIONS(description=""Base period is the period of time for which data is used as the base of an index number or other ratio have been collected. This period is frequently one of a year but it may be as short as one day or as long as the average of a group of years.""),
  other_notes STRING OPTIONS(description=""A brief record of facts topics or thoughts written down and used to contextualize the series definition values and other characteristics.""),
  aggregation_method STRING OPTIONS(description=""Aggregation methods are types of calculations used to group attribute values into a metric for each dimension value. For example for each region one may retrieve the total value of country entries (the sum of the series value for countries belonging to the region).""),
  limitations_and_exceptions STRING OPTIONS(description=""A limiting rule or circumstance that applies to usage of the series such as the scope of the survey collecting the data or missing years and countries.  It should also note when data are imputed or estimated""),
  notes_from_original_source STRING OPTIONS(description=""A brief record of facts topics or thoughts written down and used to contextualize the series definition values and other characteristics.""),
  general_comments STRING OPTIONS(description=""Other notes regarding the series which do not appear in Development relevance or Limitations or exceptions""),
  source STRING OPTIONS(description=""A place person or organization from which the series comes or can be obtained.""),
  statistical_concept_and_methodology STRING OPTIONS(description=""The abstract idea general statistical notions or a system of methods used to generate the series.""),
  development_relevance STRING OPTIONS(description=""The relevance of a series refers to how the indicator’s data may be used to monitor particular aspects of development goals and programs for example the Sustainable Development Goals. The indicator may conclusively measure progress towards a particular objective or may act as a proxy or interpretation of a development aim.""),
  related_source_links STRING OPTIONS(description=""Internet address of related source page tool or knowledge base.""),
  other_web_links STRING OPTIONS(description=""Internet addresses of related pages tools or knowledge bases.""),
  related_indicators STRING OPTIONS(description=""In general indicator that are of interest and related to the specific series.""),
  license_type STRING OPTIONS(description=""Explains the rights conferred and restrictions imposed by the owner to the users of a series"")
);"

,1
table_name,country_series_definitions
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.country_series_definitions`
(
  country_code STRING OPTIONS(description=""""),
  series_code STRING OPTIONS(description=""""),
  description STRING OPTIONS(description="""")
);"

,2
table_name,footnotes
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.footnotes`
(
  country_code STRING OPTIONS(description=""""),
  series_code STRING OPTIONS(description=""""),
  year STRING OPTIONS(description=""""),
  description STRING OPTIONS(description="""")
);"

,3
table_name,series_time
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.series_time`
(
  series_code STRING OPTIONS(description=""""),
  year INT64 OPTIONS(description=""""),
  description STRING OPTIONS(description="""")
);"

,4
table_name,indicators_data
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.indicators_data`
(
  country_name STRING OPTIONS(description=""""),
  country_code STRING OPTIONS(description=""""),
  indicator_name STRING OPTIONS(description=""""),
  indicator_code STRING OPTIONS(description=""""),
  value FLOAT64 OPTIONS(description=""""),
  year INT64 OPTIONS(description="""")
);"

,5
table_name,country_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.country_summary`
(
  country_code STRING OPTIONS(description=""A short alphabetic or numeric geographical code representing a specific country or area. In April 2016 WDI has adopted the three digit ISO code to identify countries in its databases.""),
  short_name STRING OPTIONS(description=""Country name the country's official name as approved by the relevant body (Italy is used as an example): conventional short form (Italy).""),
  table_name STRING OPTIONS(description=""Country name the country's name as approved by the relevant body (Italy is used as an example): conventional short form (Republic of Italy).""),
  long_name STRING OPTIONS(description=""Country name the country's name as approved by the relevant body (Italy is used as an example): conventional long form (Republic of Italy).""),
  two_alpha_code STRING OPTIONS(description=""ISO-2 digit alpha code value of the country. Re: www.iso.org""),
  currency_unit STRING OPTIONS(description=""Currency unit (such as the dollar euro peso rupee) issued as a coin or banknote a standard unit of value and a unit of account.""),
  special_notes STRING OPTIONS(description=""Country special notes for data and metadata users.""),
  region STRING OPTIONS(description=""World Bank region to which a country belongs.""),
  income_group STRING OPTIONS(description=""World Bank income group to which a country belongs after the country classification is completed every year.""),
  wb_2_code STRING OPTIONS(description=""World Bank 2 digit code value of the country.""),
  national_accounts_base_year STRING OPTIONS(description=""Base year is the base or pricing period used for constant price calculations in the country’s national accounts. Price indexes derived from national accounts aggregates such as the implicit deflator for gross domestic product (GDP) express the price level relative to base year prices.""),
  national_accounts_reference_year STRING OPTIONS(description=""Reference year is the year in which the local currency constant price series of a country is valued. The reference year is usually the same as the base year used to report the constant price series. However when the constant price data are chain linked the base year is changed annually so the data are rescaled to a specific reference year to provide a consistent time series. When the country has not rescaled following a change in base year World Bank staff rescale the data to maintain a longer historical series. To allow for cross-country comparison and data aggregation constant price data reported in World Development Indicators are rescaled to a common reference year (2010) and currency (U.S. dollars).""),
  sna_price_valuation STRING OPTIONS(description=""SNA price valuation shows whether value added in the national accounts is reported at basic prices (B) or producer prices (P). Producer prices include taxes paid by producers and thus tend to overstate the actual value added in production. However value added can be higher at basic prices than at producer prices in countries with high agricultural subsidies.""),
  lending_category STRING OPTIONS(description=""World Bank lending category to which a country belongs after the operational guidelines are completed every year.""),
  other_groups STRING OPTIONS(description=""Other types of grouping approved by the WDI team.""),
  system_of_national_accounts STRING OPTIONS(description=""System of National Accounts identifies whether a country uses the 1968 1993 or 2008 System of National Accounts (SNA). The 2008 SNA is an update of the 1993 SNA and retains its basic theoretical framework.""),
  alternative_conversion_factor STRING OPTIONS(description=""Alternative conversion factor identifies the countries and years for which a World Bank–estimated conversion factor has been used in place of the official exchange rate (line rf in the International Monetary Fund’s [IMF] International Financial Statistics). See later in Sources and methods for further discussion of alternative conversion factors.""),
  ppp_survey_year STRING OPTIONS(description=""Purchasing power parity (PPP) survey year is the latest available survey year for the International Comparison Program’s estimates of PPPs.""),
  balance_of_payments_manual_in_use STRING OPTIONS(description=""Balance of Payments Manual in use refers to the classification system used to compile and report data on balance of payments. 6 refers to the 6th edition of the IMF’s Balance of Payments Manual (2009).""),
  external_debt_reporting_status STRING OPTIONS(description=""External debt shows debt reporting status for 2016 data. A indicates that data are as reported P that data are based on reported or collected information but include an element of staff estimation and E that data are World Bank staff estimates.""),
  system_of_trade STRING OPTIONS(description=""System of trade refers to the United Nations general trade system (G) or special trade system (S). Under the general trade system goods entering directly for domestic consumption and goods entered into customs storage are recorded as imports at arrival. Under the special trade system goods are recorded as imports when declared for domestic consumption whether at time of entry or on withdrawal from customs storage.""),
  government_accounting_concept STRING OPTIONS(description=""Government finance accounting concept is the accounting basis for reporting central government financial data. For most countries government finance data have been consolidated (C) into one set of accounts capturing all central government fiscal activities. Budgetary central government accounts (B) exclude some central government units.""),
  imf_data_dissemination_standard STRING OPTIONS(description=""IMF data dissemination standard shows the countries that subscribe to the IMF’s Special Data Dissemination Standard (S) or Enhanced General Data Dissemination System (e-GDDS). S refers to countries that subscribe to the SDDS and have posted data on the Dissemination Standards Bulletin Board at http://dsbb.imf.org. S+ countries must observe additional coverage periodicity and timeliness requirements. e-G refers to countries that subscribe to the e-GDDS.""),
  latest_population_census STRING OPTIONS(description=""Latest population census shows the most recent year in which a census was conducted and in which at least preliminary results have been released. The preliminary results from the very recent censuses could be reflected in timely revisions if basic data are available such as population by age and sex as well as the detailed definition of counting coverage and completeness.""),
  latest_household_survey STRING OPTIONS(description=""Latest demographic education or health household survey indicates the household surveys used to compile the demographic education and health data. Detailed information on each survey is provided through the following links:  AIDS Indicator Survey Demographic and Health Survey Health Issues Survey and Malaria Indicator Survey - www.dhsprogram.com; Living Standards Measurement Study -  www.worldbank.org/lsms; Multiple Indicator Cluster Survey - http://mics.unicef.org; Reproductive Health Survey -  www.cdc.gov/reproductivehealth; World Health Survey is available at - www.who.int/healthinfo/survey/en.""),
  source_of_most_recent_income_and_expenditure_data STRING OPTIONS(description=""Source of most recent income and expenditure data shows household surveys that collect income and expenditure data. Names and detailed information on household surveys can be found on the website of the International Household Survey Network (www.surveynetwork.org). Core Welfare Indicator Questionnaire Surveys (CWIQ) developed by the World Bank measure changes in key social indicators for different population groups—specifically indicators of access utilization and satisfaction with core social and economic services. Expenditure survey/budget surveys (ES/BS) collect detailed information on household consumption as well as on general demographic social and economic characteristics. Integrated household surveys (IHS) collect detailed information on a wide variety of topics including health education economic activities housing and utilities.""),
  vital_registration_complete STRING OPTIONS(description=""Vital registration complete identifies countries that report at least 90 percent complete registries of vital (birth and death) statistics to the United Nations Statistics Division and are reported in its Population and Vital Statistics Reports. Countries with complete vital statistics registries may have more accurate and more timely demographic indicators than other countries.""),
  latest_agricultural_census STRING OPTIONS(description=""Latest agricultural census shows the most recent year in which an agricultural census was conducted or planned to be conducted as reported to the Food and Agriculture Organization.""),
  latest_industrial_data STRING OPTIONS(description=""Latest industrial data show the most recent year for which manufacturing value added data at the three-digit level of the International Standard Industrial Classification (revision 2 or 3) are available in the United Nations Industrial Development Organization database.""),
  latest_trade_data STRING OPTIONS(description=""Latest trade data show the most recent year for which structure of merchandise trade data from the United Nations Statistics Division’s Commodity Trade (Comtrade) database are available."")
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'world_bank_global_population': ['population_by_country'], 'world_bank_health_population': ['country_series_definitions', 'country_summary', 'health_nutrition_population', 'series_summary', 'series_times'], 'world_bank_intl_debt': ['country_series_definitions', 'country_summary', 'international_debt', 'series_summary', 'series_times'], 'world_bank_intl_education': ['country_series_definitions', 'country_summary', 'international_education', 'series_summary'], 'world_bank_wdi': ['country_series_definitions', 'country_summary', 'footnotes', 'indicators_data', 'series_summary', 'series_time']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **Table:** `bigquery-public-data.world_bank_wdi.indicators_data`
   - **`indicator_code`**: Used to filter for the GDP (constant 2015 US$) indicator. Specifically, we can use the code `'NY.GDP.MKTP.KD'`.
   - **`indicator_name`**: To identify and verify the correct GDP indicator.
   - **`value`**: Contains the GDP values (in constant 2015 US$) for each country and year.
   - **`year`**: The year for which the GDP value is recorded.
   - **`country_code`**: Used to link to the `country_summary` table to obtain the region information.
   - **`country_name`**: Name of the country corresponding to the GDP value.

2. **Table:** `bigquery-public-data.world_bank_wdi.country_summary`
   - **`country_code`**: Used to link to the `indicators_data` table.
   - **`region`**: Provides the region of each country, which is necessary to group GDP values by region.
   - **`short_name`**: The standard name of the country.

**Conditions That May Be Used:**

- **Filtering by Indicator Code**: Using `indicator_code = 'NY.GDP.MKTP.KD'` to select GDP (constant 2015 US$) data.
- **Filtering by Year**: Selecting data for specific years, such as the most recent year available.
- **Handling Missing Values**: Excluding records where `value` is `NULL` or missing.
- **Excluding Aggregates or Non-Country Entities**: Ignoring entries that are not individual countries (e.g., regions like "World", "High income").

---

**Sample SQL Queries:**

1. **Retrieve Distinct GDP Indicator Codes:**

   ```sql
   SELECT DISTINCT `indicator_code`
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE LOWER(`indicator_name`) LIKE '%gdp%'
   LIMIT 1000;
   ```

2. **Retrieve the GDP Indicator Name and Code:**

   ```sql
   SELECT DISTINCT `indicator_name`, `indicator_code`
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE `indicator_code` = 'NY.GDP.MKTP.KD'
   LIMIT 1000;
   ```

3. **Get GDP Values for All Countries in 2019:**

   ```sql
   SELECT `country_name`, `country_code`, `value`
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE `indicator_code` = 'NY.GDP.MKTP.KD` AND `year` = 2019
   LIMIT 1000;
   ```

4. **List Distinct Regions from Country Summary:**

   ```sql
   SELECT DISTINCT `region`
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   LIMIT 1000;
   ```

5. **Retrieve Country Codes and Their Regions:**

   ```sql
   SELECT `country_code`, `short_name`, `region`
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   LIMIT 1000;
   ```

6. **Find Countries with Missing or Null Region Values:**

   ```sql
   SELECT `country_code`, `short_name`
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   WHERE `region` IS NULL OR `region` = ''
   LIMIT 1000;
   ```

7. **List All Available Years for GDP Data:**

   ```sql
   SELECT DISTINCT `year`
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE `indicator_code` = 'NY.GDP.MKTP.KD'
   ORDER BY `year`
   LIMIT 1000;
   ```

8. **Retrieve Sample Indicator Names and Codes:**

   ```sql
   SELECT DISTINCT `indicator_name`, `indicator_code`
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   LIMIT 1000;
   ```

9. **Get Country Names and Regions from Country Summary:**

   ```sql
   SELECT `short_name`, `region`
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   LIMIT 1000;
   ```

10. **Get GDP Values for the United States Over the Years:**

    ```sql
    SELECT `year`, `value`
    FROM `bigquery-public-data.world_bank_wdi.indicators_data`
    WHERE `indicator_code` = 'NY.GDP.MKTP.KD' AND `country_name` = 'United States'
    ORDER BY `year`
    LIMIT 1000;
    ```

11. **List Countries and Their Income Groups:**

    ```sql
    SELECT `short_name`, `income_group`
    FROM `bigquery-public-data.world_bank_wdi.country_summary`
    LIMIT 1000;
    ```

12. **Find Countries Missing GDP Data in 2019:**

    ```sql
    SELECT `country_name`
    FROM `bigquery-public-data.world_bank_wdi.indicators_data`
    WHERE `indicator_code` = 'NY.GDP.MKTP.KD' AND `year` = 2019 AND `value` IS NULL
    LIMIT 1000;
    ```

13. **Retrieve GDP Values for Countries in 2019 (Where GDP is Available):**

    ```sql
    SELECT `country_name`, `value`
    FROM `bigquery-public-data.world_bank_wdi.indicators_data`
    WHERE `indicator_code` = 'NY.GDP.MKTP.KD' AND `year` = 2019 AND `value` IS NOT NULL
    LIMIT 1000;
    ```

14. **List GDP Values for All Years for a Specific Country Code (e.g., 'USA'):**

    ```sql
    SELECT `year`, `value`
    FROM `bigquery-public-data.world_bank_wdi.indicators_data`
    WHERE `indicator_code` = 'NY.GDP.MKTP.KD' AND `country_code` = 'USA'
    ORDER BY `year`
    LIMIT 1000;
    ```

15. **Retrieve Country Names with Their Corresponding Country Codes:**

    ```sql
    SELECT DISTINCT `country_name`, `country_code`
    FROM `bigquery-public-data.world_bank_wdi.indicators_data`
    LIMIT 1000;
    ```

These queries allow us to explore the relevant data needed to determine which region has the highest median GDP (constant 2015 US$) value by:

- Identifying the correct GDP indicator code.
- Checking the availability and consistency of GDP data across countries and years.
- Understanding the mapping between countries and regions.
- Ensuring that data used excludes aggregates or entries that are not individual countries.
- Looking for any missing values that might affect the calculation of the median GDP.

By analyzing the output of these queries, we can proceed to calculate the median GDP for each region and find the region with the highest median GDP value.Query:
SELECT DISTINCT `indicator_code`
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE LOWER(`indicator_name`) LIKE '%gdp%'
   LIMIT 1000;
Answer:
indicator_code
BX.TRF.PWKR.DT.GD.ZS
PA.NUS.PPPC.RF
NE.TRD.GNFS.ZS
EN.ATM.CO2E.KD.GD
NY.GDP.COAL.RT.ZS
BN.CAB.XOKA.GD.ZS
NY.GDP.DISC.CN
FD.AST.PRVT.GD.ZS
SH.XPD.GHED.GD.ZS
NE.RSB.GNFS.ZS
NE.CON.TOTL.ZS
NY.GDP.FRST.RT.ZS
NY.GDP.MKTP.KN
NY.GDP.MKTP.CN
NY.GDP.PCAP.CN
NY.GDP.PCAP.KD.ZG
NE.CON.GOVT.ZS
NV.IND.TOTL.ZS
TG.VAL.TOTL.GD.ZS
MS.MIL.XPND.GD.ZS
NY.GDP.PETR.RT.ZS
FM.LBL.BMNY.GD.ZS
FS.AST.CGOV.GD.ZS
NY.GDP.MKTP.CD
NY.GDP.MKTP.KD.ZG
NY.GDP.MKTP.PP.CD
NV.IND.MANF.ZS
CM.MKT.LCAP.GD.ZS
FM.AST.PRVT.GD.ZS
NY.GDP.NGAS.RT.ZS
PA.NUS.PPP
GC.REV.XGRT.GD.ZS
BG.GSR.NFSV.GD.ZS
NY.GDP.MKTP.KD
NY.GDP.DEFL.ZS.AD
NY.GDP.PCAP.KD
FS.AST.PRVT.GD.ZS
NE.EXP.GNFS.ZS
BM.KLT.DINV.WD.GD.ZS
NY.GDP.DEFL.ZS
NY.GDP.PCAP.KN
SE.XPD.SECO.PC.ZS
NE.GDI.TOTL.ZS
NE.IMP.GNFS.ZS
NY.GDP.DEFL.KD.ZG
GC.AST.TOTL.GD.ZS
NV.SRV.TOTL.ZS
NY.GDP.DISC.KN
BX.KLT.DINV.WD.GD.ZS
NY.GDP.PCAP.PP.CD
SL.GDP.PCAP.EM.KD
EG.GDP.PUSE.KO.PP.KD
EG.GDP.PUSE.KO.PP
NE.GDI.FTOT.ZS
NY.GNS.ICTR.ZS
GC.LBL.TOTL.GD.ZS
GC.TAX.TOTL.GD.ZS
NY.GDP.TOTL.RT.ZS
NY.GDP.PCAP.CD
NE.DAB.TOTL.ZS
NY.GDP.MINR.RT.ZS
NV.AGR.TOTL.ZS
EN.ATM.CO2E.PP.GD
GC.XPN.TOTL.GD.ZS
SE.XPD.TERT.PC.ZS
NE.CON.PRVT.ZS
FS.AST.DOMO.GD.ZS
SH.XPD.CHEX.GD.ZS
FS.AST.DOMS.GD.ZS
EG.USE.COMM.GD.PP.KD
NY.GDS.TOTL.ZS
NE.GDI.FPRV.ZS
NY.GDP.MKTP.PP.KD
NY.GDP.DEFL.KD.ZG.AD
CM.MKT.TRAD.GD.ZS
GC.NLD.TOTL.GD.ZS
EN.ATM.CO2E.PP.GD.KD
EG.EGY.PRIM.PP.KD
NY.GDP.MKTP.CN.AD
SE.XPD.TOTL.GD.ZS
NY.GDP.PCAP.PP.KD
GB.XPD.RSDV.GD.ZS
SE.XPD.PRIM.PC.ZS
GC.NFN.TOTL.GD.ZS
ER.GDP.FWTL.M3.KD
GC.DOD.TOTL.GD.ZS
Query:
SELECT DISTINCT `indicator_name`, `indicator_code`
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE `indicator_code` = 'NY.GDP.MKTP.KD'
   LIMIT 1000;
Answer:
indicator_name,indicator_code
GDP (constant 2015 US$),NY.GDP.MKTP.KD
Query:
SELECT cs.`region`,
          COUNT(id.`value`) AS `num_countries`,
          AVG(id.`value`) AS `average_gdp`,
          MIN(id.`value`) AS `min_gdp`,
          MAX(id.`value`) AS `max_gdp`
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
     ON id.`country_code` = cs.`country_code`
   WHERE id.`indicator_code` = 'NY.GDP.MKTP.KD'
     AND id.`year` = 2019
     AND id.`value` IS NOT NULL
     AND cs.`region` NOT IN ('Aggregates', 'World', '')
   GROUP BY cs.`region`
   LIMIT 1000;
Answer:
region,num_countries,average_gdp,min_gdp,max_gdp
Sub-Saharan Africa,46,39604795061.31859,359752972.346268,502942019447.736
East Asia & Pacific,34,754966404370.8977,42824596.8653884,14296238286985.1
Europe & Central Asia,54,413777989849.8653,1514041111.68851,3598891541091.34
Middle East & North Africa,20,167057963295.84705,3191833262.48686,678581100842.581
Latin America & Caribbean,37,143902774165.0307,568298267.854584,1823105452462.95
North America,3,7225849553024.16,6851270046.39601,19974534312000.0
South Asia,8,428933254078.4158,2470944511.92544,2695611314661.46
Query:
SELECT DISTINCT `region`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
LIMIT 1000
Answer:
region
""
Europe & Central Asia
North America
Latin America & Caribbean
East Asia & Pacific
Sub-Saharan Africa
Middle East & North Africa
South Asia
Query:
SELECT `country_code`, `short_name`, `region`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
LIMIT 1000
Answer:
country_code,short_name,region
AFE,Africa Eastern and Southern,
AFW,Africa Western and Central,
ARB,Arab World,
CEB,Central Europe and the Baltics,
CSS,Caribbean small states,
EAP,East Asia & Pacific (excluding high income),
EAR,Early-demographic dividend,
EAS,East Asia & Pacific,
ECA,Europe & Central Asia (excluding high income),
ECS,Europe & Central Asia,
EUU,European Union,
FCS,Fragile and conflict affected situations,
HIC,High income,
HPC,Heavily indebted poor countries (HIPC),
IBD,IBRD only,
IBT,IDA & IBRD total,
IDA,IDA total,
IDB,IDA blend,
IDX,IDA only,
LAC,Latin America & Caribbean (excluding high income),
LCN,Latin America & Caribbean,
LDC,Least developed countries: UN classification,
LIC,Low income,
LMC,Lower middle income,
LMY,Low & middle income,
LTE,Late-demographic dividend,
MEA,Middle East & North Africa,
MIC,Middle income,
MNA,Middle East & North Africa (excluding high income),
NAC,North America,
OED,OECD members,
OSS,Other small states,
PRE,Pre-demographic dividend,
PSS,Pacific island small states,
PST,Post-demographic dividend,
SAS,South Asia,
SSA,Sub-Saharan Africa (excluding high income),
SSF,Sub-Saharan Africa,
SST,Small states,
TEA,East Asia & Pacific (IDA & IBRD),
TEC,Europe & Central Asia (IDA & IBRD),
TLA,Latin America & Caribbean (IDA & IBRD),
TMN,Middle East & North Africa (IDA & IBRD),
TSA,South Asia (IDA & IBRD),
TSS,Sub-Saharan Africa (IDA & IBRD),
UMC,Upper middle income,
WLD,World,
AND,Andorra,Europe & Central Asia
BMU,Bermuda,North America
CHI,Channel Islands,Europe & Central Asia
CUW,Curaçao,Latin America & Caribbean
CYM,Cayman Islands,Latin America & Caribbean
FRO,Faroe Islands,Europe & Central Asia
GIB,Gibraltar,Europe & Central Asia
GRL,Greenland,Europe & Central Asia
GUM,Guam,East Asia & Pacific
IMN,Isle of Man,Europe & Central Asia
LIE,Liechtenstein,Europe & Central Asia
MAF,St. Martin (French part),Latin America & Caribbean
MCO,Monaco,Europe & Central Asia
MNP,Northern Mariana Islands,East Asia & Pacific
Query:
SELECT `country_code`, `short_name`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
WHERE `region` IS NULL OR `region` = ''
LIMIT 1000
Answer:
country_code,short_name
AFE,Africa Eastern and Southern
AFW,Africa Western and Central
ARB,Arab World
CEB,Central Europe and the Baltics
CSS,Caribbean small states
EAP,East Asia & Pacific (excluding high income)
EAR,Early-demographic dividend
EAS,East Asia & Pacific
ECA,Europe & Central Asia (excluding high income)
ECS,Europe & Central Asia
EUU,European Union
FCS,Fragile and conflict affected situations
HIC,High income
HPC,Heavily indebted poor countries (HIPC)
IBD,IBRD only
IBT,IDA & IBRD total
IDA,IDA total
IDB,IDA blend
IDX,IDA only
LAC,Latin America & Caribbean (excluding high income)
LCN,Latin America & Caribbean
LDC,Least developed countries: UN classification
LIC,Low income
LMC,Lower middle income
LMY,Low & middle income
LTE,Late-demographic dividend
MEA,Middle East & North Africa
MIC,Middle income
MNA,Middle East & North Africa (excluding high income)
NAC,North America
OED,OECD members
OSS,Other small states
PRE,Pre-demographic dividend
PSS,Pacific island small states
PST,Post-demographic dividend
SAS,South Asia
SSA,Sub-Saharan Africa (excluding high income)
SSF,Sub-Saharan Africa
SST,Small states
TEA,East Asia & Pacific (IDA & IBRD)
TEC,Europe & Central Asia (IDA & IBRD)
TLA,Latin America & Caribbean (IDA & IBRD)
TMN,Middle East & North Africa (IDA & IBRD)
TSA,South Asia (IDA & IBRD)
TSS,Sub-Saharan Africa (IDA & IBRD)
UMC,Upper middle income
WLD,World
EMU,Euro area
Query:
SELECT DISTINCT `year`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `indicator_code` = 'NY.GDP.MKTP.KD'
ORDER BY `year`
LIMIT 1000
Answer:
year
1960
1961
1962
1963
1964
1965
1966
1967
1968
1969
1970
1971
1972
1973
1974
1975
1976
1977
1978
1979
1980
1981
1982
1983
1984
1985
1986
1987
1988
1989
1990
1991
1992
1993
1994
1995
1996
1997
1998
1999
2000
2001
2002
2003
2004
2005
2006
2007
2008
2009
2010
2011
2012
2013
2014
2015
2016
2017
2018
2019
2020
Query:
SELECT DISTINCT `indicator_name`, `indicator_code`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
LIMIT 1000
Answer:
indicator_name,indicator_code
Net official development assistance and official aid received (constant 2018 US$),DT.ODA.ALLD.KD
Net official development assistance and official aid received (current US$),DT.ODA.ALLD.CD
Net official development assistance received (constant 2018 US$),DT.ODA.ODAT.KD
"Net official flows from UN agencies, ILO (current US$)",DT.NFL.ILOG.CD
"Net official flows from UN agencies, UNICEF (current US$)",DT.NFL.UNCF.CD
"Net official flows from UN agencies, WFP (current US$)",DT.NFL.WFPG.CD
"Net official flows from UN agencies, WHO (current US$)",DT.NFL.WHOL.CD
Newborns protected against tetanus (%),SH.VAC.TTNS.ZS
Nitrous oxide emissions (thousand metric tons of CO2 equivalent),EN.ATM.NOXE.KT.CE
Number of deaths ages 20-24 years,SH.DTH.2024
Number of deaths ages 5-9 years,SH.DTH.0509
Number of neonatal deaths,SH.DTH.NMRT
Ores and metals exports (% of merchandise exports),TX.VAL.MMTL.ZS.UN
Ores and metals imports (% of merchandise imports),TM.VAL.MMTL.ZS.UN
Other greenhouse gas emissions (% change from 1990),EN.ATM.GHGO.ZG
"Other greenhouse gas emissions, HFC, PFC and SF6 (thousand metric tons of CO2 equivalent)",EN.ATM.GHGO.KT.CE
Out-of-pocket expenditure (% of current health expenditure),SH.XPD.OOPC.CH.ZS
Out-of-pocket expenditure per capita (current US$),SH.XPD.OOPC.PC.CD
"Over-age students, primary, female (% of female enrollment)",SE.PRM.OENR.FE.ZS
People practicing open defecation (% of population),SH.STA.ODFC.ZS
"Persistence to last grade of primary, male (% of cohort)",SE.PRM.PRSL.MA.ZS
"Personal remittances, received (% of GDP)",BX.TRF.PWKR.DT.GD.ZS
"Personal transfers, receipts (BoP, current US$)",BX.TRF.PWKR.CD
"PNG, commercial banks and other creditors (NFL, current US$)",DT.NFL.PNGC.CD
Population ages 0-14 (% of total population),SP.POP.0014.TO.ZS
"Population ages 0-14, female",SP.POP.0014.FE.IN
"Population ages 05-09, female (% of female population)",SP.POP.0509.FE.5Y
"Population ages 05-09, male (% of male population)",SP.POP.0509.MA.5Y
"Population ages 10-14, male (% of male population)",SP.POP.1014.MA.5Y
"Population ages 15-19, male (% of male population)",SP.POP.1519.MA.5Y
"Population ages 15-64, male (% of male population)",SP.POP.1564.MA.ZS
"Population ages 20-24, male (% of male population)",SP.POP.2024.MA.5Y
"Population ages 25-29, male (% of male population)",SP.POP.2529.MA.5Y
"Population ages 30-34, male (% of male population)",SP.POP.3034.MA.5Y
"Population ages 35-39, female (% of female population)",SP.POP.3539.FE.5Y
"Population ages 35-39, male (% of male population)",SP.POP.3539.MA.5Y
"Population ages 40-44, male (% of male population)",SP.POP.4044.MA.5Y
"Population ages 55-59, male (% of male population)",SP.POP.5559.MA.5Y
"Population ages 60-64, female (% of female population)",SP.POP.6064.FE.5Y
Population ages 65 and above (% of total population),SP.POP.65UP.TO.ZS
"Population ages 65 and above, male (% of male population)",SP.POP.65UP.MA.ZS
"Population ages 65-69, female (% of female population)",SP.POP.6569.FE.5Y
"Population ages 70-74, female (% of female population)",SP.POP.7074.FE.5Y
"Population ages 75-79, male (% of male population)",SP.POP.7579.MA.5Y
"Population ages 80 and above, female (% of female population)",SP.POP.80UP.FE.5Y
Query:
SELECT `short_name`, `region`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
LIMIT 1000
Answer:
short_name,region
Africa Eastern and Southern,
Africa Western and Central,
Arab World,
Central Europe and the Baltics,
Caribbean small states,
East Asia & Pacific (excluding high income),
Early-demographic dividend,
East Asia & Pacific,
Europe & Central Asia (excluding high income),
Europe & Central Asia,
European Union,
Fragile and conflict affected situations,
High income,
Heavily indebted poor countries (HIPC),
IBRD only,
IDA & IBRD total,
IDA total,
IDA blend,
IDA only,
Latin America & Caribbean (excluding high income),
Latin America & Caribbean,
Least developed countries: UN classification,
Low income,
Lower middle income,
Low & middle income,
Late-demographic dividend,
Middle East & North Africa,
Middle income,
Middle East & North Africa (excluding high income),
North America,
OECD members,
Other small states,
Pre-demographic dividend,
Pacific island small states,
Post-demographic dividend,
South Asia,
Sub-Saharan Africa (excluding high income),
Sub-Saharan Africa,
Small states,
East Asia & Pacific (IDA & IBRD),
Europe & Central Asia (IDA & IBRD),
Latin America & Caribbean (IDA & IBRD),
Middle East & North Africa (IDA & IBRD),
South Asia (IDA & IBRD),
Sub-Saharan Africa (IDA & IBRD),
Upper middle income,
World,
Andorra,Europe & Central Asia
Bermuda,North America
Channel Islands,Europe & Central Asia
Curaçao,Latin America & Caribbean
Cayman Islands,Latin America & Caribbean
Faroe Islands,Europe & Central Asia
Gibraltar,Europe & Central Asia
Greenland,Europe & Central Asia
Guam,East Asia & Pacific
Isle of Man,Europe & Central Asia
Liechtenstein,Europe & Central Asia
St. Martin (French part),Latin America & Caribbean
Monaco,Europe & Central Asia
Northern Mariana Islands,East Asia & Pacific
New Caledonia,East Asia & Pacific
Nauru,East Asia & Pacific
New Zealand,East Asia & Pacific
Puerto Rico,Latin America & Caribbean
French Polynesia,East Asia & Pacific
Sint Maarten (Dutch part),Latin America & Caribbean
Turks and Caicos Islands,Latin America & Caribbean
British Virgin Islands,Latin America & Caribbean
Virgin Islands,Latin America & Caribbean
Eritrea,Sub-Saharan Africa
Dem. People's Rep. Korea,East Asia & Pacific
Somalia,Sub-Saharan Africa
South Sudan,Sub-Saharan Africa
American Samoa,East Asia & Pacific
Cuba,Latin America & Caribbean
Turkmenistan,Europe & Central Asia
Venezuela,Latin America & Caribbean
Aruba,Latin America & Caribbean
United Arab Emirates,Middle East & North Africa
Antigua and Barbuda,Latin America & Caribbean
Bahrain,Middle East & North Africa
Query:
SELECT `year`, `value`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `indicator_code` = 'NY.GDP.MKTP.KD' AND `country_name` = 'United States'
ORDER BY `year`
LIMIT 1000
Answer:
year,value
1960,3457188037625.69
1961,3536703362491.07
1962,3752442267603.03
1963,3917549727377.56
1964,4144767611565.47
1965,4410032738705.65
1966,4696684866721.53
1967,4814101988389.57
1968,5045178883832.25
1969,5201579429231.05
1970,5183548220000.0
1971,5354260691000.0
1972,5635836299000.0
1973,5954019981000.0
1974,5921835427000.0
1975,5909668657000.0
1976,6228089836000.0
1977,6516086243000.0
1978,6876771488000.0
1979,7094500066000.0
1980,7076284960000.0
1981,7255861209000.0
1982,7125046201000.0
1983,7451652146000.0
1984,7990900876000.0
1985,8324093971000.0
1986,8612327876000.0
1987,8910249999000.0
1988,9282436602000.0
1989,9623347839000.0
1990,9804840807000.0
1991,9794225617000.0
1992,10139221389000.0
1993,10418230561000.0
1994,10837959532000.0
1995,11128873914000.0
1996,11548717972000.0
1997,12054756829000.0
1998,12594979613000.0
1999,13193648716000.0
2000,13738214458000.0
2001,13875368657000.0
2002,14117035294000.0
2003,14520953428000.0
2004,15072588639000.0
2005,15602120903000.0
2006,16047557132000.0
2007,16348636818000.0
2008,16326307882000.0
2009,15912149113000.0
2010,16320099471000.0
2011,16573197368000.0
2012,16946019042000.0
2013,17258178451000.0
2014,17694115456000.0
2015,18238300569000.0
2016,18550435728000.0
2017,18983157920000.0
2018,19551981480000.0
2019,19974534312000.0
2020,19294483000000.0
Query:
SELECT `short_name`, `income_group`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
LIMIT 1000
Answer:
short_name,income_group
Africa Eastern and Southern,
Africa Western and Central,
Arab World,
Central Europe and the Baltics,
Caribbean small states,
East Asia & Pacific (excluding high income),
Early-demographic dividend,
East Asia & Pacific,
Europe & Central Asia (excluding high income),
Europe & Central Asia,
European Union,
Fragile and conflict affected situations,
High income,
Heavily indebted poor countries (HIPC),
IBRD only,
IDA & IBRD total,
IDA total,
IDA blend,
IDA only,
Latin America & Caribbean (excluding high income),
Latin America & Caribbean,
Least developed countries: UN classification,
Low income,
Lower middle income,
Low & middle income,
Late-demographic dividend,
Middle East & North Africa,
Middle income,
Middle East & North Africa (excluding high income),
North America,
OECD members,
Other small states,
Pre-demographic dividend,
Pacific island small states,
Post-demographic dividend,
South Asia,
Sub-Saharan Africa (excluding high income),
Sub-Saharan Africa,
Small states,
East Asia & Pacific (IDA & IBRD),
Europe & Central Asia (IDA & IBRD),
Latin America & Caribbean (IDA & IBRD),
Middle East & North Africa (IDA & IBRD),
South Asia (IDA & IBRD),
Sub-Saharan Africa (IDA & IBRD),
Upper middle income,
World,
Andorra,High income
Bermuda,High income
Channel Islands,High income
Curaçao,High income
Cayman Islands,High income
Faroe Islands,High income
Gibraltar,High income
Greenland,High income
Guam,High income
Isle of Man,High income
Liechtenstein,High income
St. Martin (French part),High income
Monaco,High income
Northern Mariana Islands,High income
New Caledonia,High income
Nauru,High income
New Zealand,High income
Puerto Rico,High income
French Polynesia,High income
Sint Maarten (Dutch part),High income
Turks and Caicos Islands,High income
British Virgin Islands,High income
Virgin Islands,High income
Eritrea,Low income
Dem. People's Rep. Korea,Low income
Somalia,Low income
South Sudan,Low income
American Samoa,Upper middle income
Cuba,Upper middle income
Turkmenistan,Upper middle income
Venezuela,
Aruba,High income
United Arab Emirates,High income
Query:
SELECT `country_name`, `value`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `indicator_code` = 'NY.GDP.MKTP.KD' AND `year` = 2019
LIMIT 1000;
Answer:
country_name,value
Gabon,15460241608.8257
Namibia,11240759011.0283
Angola,110072586683.261
Sudan,51312429477.3951
Middle East & North Africa (excluding high income),1538200834048.04
Africa Eastern and Southern,1006679813065.29
Tonga,486181549.588749
Turkmenistan,45710025776.6731
Early-demographic dividend,11703037495097.2
Qatar,167371229308.42
Europe & Central Asia (IDA & IBRD countries),4095463099662.97
Austria,414257026093.423
Nigeria,502942019447.736
Germany,3598891541091.34
Mozambique,18183590595.087
Lao PDR,18491845636.2733
Malta,13856372628.2222
Samoa,887495263.360233
Heavily indebted poor countries (HIPC),788661392496.297
Madagascar,13186360351.4331
Slovenia,50249892617.4104
Kazakhstan,211106972039.014
Portugal,222272974069.03
United Kingdom,3191493407624.4
North America,21677548659072.5
Arab World,2681441590769.14
Oman,83053174485.8283
Sub-Saharan Africa (IDA & IBRD countries),1834643244102.56
Latin America & Caribbean (excluding high income),4853709324043.9
Ethiopia,89640020508.4013
Czech Republic,215594735504.853
Turks and Caicos Islands,1095902844.26329
Guinea,12078653011.9638
Belize,1835056955.71673
Kuwait,114249382864.585
Myanmar,83686992015.6706
Latvia,30716038078.95
Azerbaijan,53612524527.3911
Uruguay,55513344382.0673
Luxembourg,67286460381.3888
Caribbean small states,74283427277.9706
Greece,203669187367.386
Cambodia,23760061873.2798
East Asia & Pacific (IDA & IBRD countries),16995303639412.5
Finland,254637296103.695
Low income,476617321590.818
Djibouti,3191833262.48686
Lithuania,48155059559.2863
Croatia,57190160216.5408
South Asia,3431466032627.32
South Asia (IDA & IBRD),3431466032627.32
Guinea-Bissau,1248729327.89726
Albania,12970913827.5704
Monaco,7080667991.59357
"Congo, Rep.",9643515879.79193
Georgia,17757903230.0709
Mongolia,14174566299.8985
Montenegro,4777636043.80572
Estonia,27068147756.8566
Europe & Central Asia (excluding high income),3468157804813.19
Trinidad and Tobago,22587789317.2434
Israel,353062816517.302
United States,19974534312000.0
Malawi,7477443338.32784
IDA only,1229224147182.17
Central African Republic,1984982171.73544
IDA blend,1121954012747.96
"Bahamas, The",12516819004.1803
Togo,5098275352.1552
Burundi,3209182941.33059
Syrian Arab Republic,16265870694.9063
Fiji,5223164712.00555
Barbados,4822013073.75235
Nicaragua,12991624156.9782
Ghana,62465709576.1815
Ukraine,101944109453.562
San Marino,1514041111.68851
Pre-demographic dividend,1450630111014.12
Poland,570115134633.24
Suriname,5252729241.66594
Italy,1915994931005.09
IDA total,2351178159930.13
Virgin Islands (U.S.),3835985859.12487
Sub-Saharan Africa,1834643244102.56
Query:
SELECT `country_name`, `value`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `indicator_code` = 'NY.GDP.MKTP.KD' AND `year` = 2019 AND `value` IS NOT NULL
LIMIT 1000
Answer:
country_name,value
Gabon,15460241608.8257
Namibia,11240759011.0283
Angola,110072586683.261
Sudan,51312429477.3951
Middle East & North Africa (excluding high income),1538200834048.04
Africa Eastern and Southern,1006679813065.29
Tonga,486181549.588749
Turkmenistan,45710025776.6731
Early-demographic dividend,11703037495097.2
Qatar,167371229308.42
Europe & Central Asia (IDA & IBRD countries),4095463099662.97
Austria,414257026093.423
Nigeria,502942019447.736
Germany,3598891541091.34
Mozambique,18183590595.087
Lao PDR,18491845636.2733
Malta,13856372628.2222
Samoa,887495263.360233
Heavily indebted poor countries (HIPC),788661392496.297
Madagascar,13186360351.4331
Slovenia,50249892617.4104
Kazakhstan,211106972039.014
Portugal,222272974069.03
United Kingdom,3191493407624.4
North America,21677548659072.5
Arab World,2681441590769.14
Oman,83053174485.8283
Sub-Saharan Africa (IDA & IBRD countries),1834643244102.56
Latin America & Caribbean (excluding high income),4853709324043.9
Ethiopia,89640020508.4013
Czech Republic,215594735504.853
Turks and Caicos Islands,1095902844.26329
Guinea,12078653011.9638
Belize,1835056955.71673
Kuwait,114249382864.585
Myanmar,83686992015.6706
Latvia,30716038078.95
Azerbaijan,53612524527.3911
Uruguay,55513344382.0673
Luxembourg,67286460381.3888
Caribbean small states,74283427277.9706
Greece,203669187367.386
Cambodia,23760061873.2798
East Asia & Pacific (IDA & IBRD countries),16995303639412.5
Finland,254637296103.695
Low income,476617321590.818
Djibouti,3191833262.48686
Lithuania,48155059559.2863
Croatia,57190160216.5408
South Asia,3431466032627.32
South Asia (IDA & IBRD),3431466032627.32
Guinea-Bissau,1248729327.89726
Albania,12970913827.5704
Monaco,7080667991.59357
"Congo, Rep.",9643515879.79193
Georgia,17757903230.0709
Mongolia,14174566299.8985
Montenegro,4777636043.80572
Estonia,27068147756.8566
Europe & Central Asia (excluding high income),3468157804813.19
Trinidad and Tobago,22587789317.2434
Israel,353062816517.302
United States,19974534312000.0
Malawi,7477443338.32784
IDA only,1229224147182.17
Central African Republic,1984982171.73544
IDA blend,1121954012747.96
"Bahamas, The",12516819004.1803
Togo,5098275352.1552
Burundi,3209182941.33059
Syrian Arab Republic,16265870694.9063
Fiji,5223164712.00555
Barbados,4822013073.75235
Nicaragua,12991624156.9782
Ghana,62465709576.1815
Ukraine,101944109453.562
San Marino,1514041111.68851
Pre-demographic dividend,1450630111014.12
Poland,570115134633.24
Suriname,5252729241.66594
Italy,1915994931005.09
IDA total,2351178159930.13
Virgin Islands (U.S.),3835985859.12487
Sub-Saharan Africa,1834643244102.56
Query:
SELECT `year`, `value`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `indicator_code` = 'NY.GDP.MKTP.KD' AND `country_code` = 'USA'
ORDER BY `year`
LIMIT 1000
Answer:
year,value
1960,3457188037625.69
1961,3536703362491.07
1962,3752442267603.03
1963,3917549727377.56
1964,4144767611565.47
1965,4410032738705.65
1966,4696684866721.53
1967,4814101988389.57
1968,5045178883832.25
1969,5201579429231.05
1970,5183548220000.0
1971,5354260691000.0
1972,5635836299000.0
1973,5954019981000.0
1974,5921835427000.0
1975,5909668657000.0
1976,6228089836000.0
1977,6516086243000.0
1978,6876771488000.0
1979,7094500066000.0
1980,7076284960000.0
1981,7255861209000.0
1982,7125046201000.0
1983,7451652146000.0
1984,7990900876000.0
1985,8324093971000.0
1986,8612327876000.0
1987,8910249999000.0
1988,9282436602000.0
1989,9623347839000.0
1990,9804840807000.0
1991,9794225617000.0
1992,10139221389000.0
1993,10418230561000.0
1994,10837959532000.0
1995,11128873914000.0
1996,11548717972000.0
1997,12054756829000.0
1998,12594979613000.0
1999,13193648716000.0
2000,13738214458000.0
2001,13875368657000.0
2002,14117035294000.0
2003,14520953428000.0
2004,15072588639000.0
2005,15602120903000.0
2006,16047557132000.0
2007,16348636818000.0
2008,16326307882000.0
2009,15912149113000.0
2010,16320099471000.0
2011,16573197368000.0
2012,16946019042000.0
2013,17258178451000.0
2014,17694115456000.0
2015,18238300569000.0
2016,18550435728000.0
2017,18983157920000.0
2018,19551981480000.0
2019,19974534312000.0
2020,19294483000000.0
Query:
SELECT DISTINCT `country_name`, `country_code`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
LIMIT 1000
Answer:
country_name,country_code
Mozambique,MOZ
Myanmar,MMR
Namibia,NAM
Nauru,NRU
Nepal,NPL
Netherlands,NLD
New Caledonia,NCL
New Zealand,NZL
Nicaragua,NIC
Niger,NER
Nigeria,NGA
British Virgin Islands,VGB
Brunei Darussalam,BRN
Bulgaria,BGR
Burkina Faso,BFA
Burundi,BDI
Cabo Verde,CPV
Cambodia,KHM
Canada,CAN
Latin America & Caribbean,LCN
Latin America & Caribbean (excluding high income),LAC
Latin America & the Caribbean (IDA & IBRD countries),TLA
Least developed countries: UN classification,LDC
Low & middle income,LMY
Low income,LIC
Lower middle income,LMC
Middle East & North Africa,MEA
Middle East & North Africa (excluding high income),MNA
Czech Republic,CZE
Denmark,DNK
Djibouti,DJI
Dominica,DMA
Equatorial Guinea,GNQ
Kuwait,KWT
Kyrgyz Republic,KGZ
Lao PDR,LAO
Latvia,LVA
Lebanon,LBN
Lesotho,LSO
Liberia,LBR
Libya,LBY
Liechtenstein,LIE
Lithuania,LTU
Luxembourg,LUX
"Macao SAR, China",MAC
Africa Eastern and Southern,AFE
Africa Western and Central,AFW
Arab World,ARB
Caribbean small states,CSS
Central Europe and the Baltics,CEB
Early-demographic dividend,EAR
East Asia & Pacific,EAS
East Asia & Pacific (excluding high income),EAP
East Asia & Pacific (IDA & IBRD countries),TEA
Russian Federation,RUS
Rwanda,RWA
Samoa,WSM
San Marino,SMR
Sao Tome and Principe,STP
Saudi Arabia,SAU
Serbia,SRB
Seychelles,SYC
Sierra Leone,SLE
Singapore,SGP
North Macedonia,MKD
Northern Mariana Islands,MNP
Norway,NOR
Oman,OMN
Palau,PLW
Papua New Guinea,PNG
Cayman Islands,CYM
Central African Republic,CAF
Chad,TCD
Channel Islands,CHI
China,CHN
Comoros,COM
"Congo, Dem. Rep.",COD
Upper middle income,UMC
World,WLD
Afghanistan,AFG
Albania,ALB
Algeria,DZA
American Samoa,ASM
Andorra,AND
Angola,AGO
Antigua and Barbuda,ATG
Armenia,ARM
Aruba,ABW
End Exploring Related Columns
Task: Which region has the highest median GDP (constant 2015 US$) value?

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
Region,Median_GDP
North America,median_gdp_value:float (Attention: answer in one row)
```

To determine which region has the highest median GDP (constant 2015 US$) value, we analyze the `indicators_data` table from the `world_bank_wdi` schema, focusing on the GDP indicator for each country. We then join this data with the `country_summary` table to associate each country with its respective region. After calculating the median GDP for each region, we find that **North America** has the highest median GDP value..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'world_bank_global_population': ['population_by_country'], 'world_bank_health_population': ['country_series_definitions', 'country_summary', 'health_nutrition_population', 'series_summary', 'series_times'], 'world_bank_intl_debt': ['country_series_definitions', 'country_summary', 'international_debt', 'series_summary', 'series_times'], 'world_bank_intl_education': ['country_series_definitions', 'country_summary', 'international_education', 'series_summary'], 'world_bank_wdi': ['country_series_definitions', 'country_summary', 'footnotes', 'indicators_data', 'series_summary', 'series_time']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-20 11:21:45 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 11:21:45 - root - INFO - ```sql
WITH gdp_data AS (
  SELECT
    cs.region,
    id.value AS gdp
  FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
  JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
    ON id.country_code = cs.country_code
  WHERE id.indicator_code = 'NY.GDP.MKTP.KD'
    AND id.year = 2019
    AND id.value IS NOT NULL
    AND cs.region NOT IN ('Aggregates', 'World', '')
    AND cs.region IS NOT NULL
),
median_gdp_per_region AS (
  SELECT
    region,
    IF(
      MOD(COUNT(*), 2) = 1,
      -- Odd number of countries: pick the middle value
      ARRAY_AGG(gdp ORDER BY gdp ASC)[OFFSET(DIV(COUNT(*), 2))],
      -- Even number of countries: average the two middle values
      (
        ARRAY_AGG(gdp ORDER BY gdp ASC)[OFFSET(DIV(COUNT(*), 2) - 1)] +
        ARRAY_AGG(gdp ORDER BY gdp ASC)[OFFSET(DIV(COUNT(*), 2))]
      ) / 2
    ) AS median_gdp
  FROM gdp_data
  GROUP BY region
)

SELECT
  region,
  ROUND(median_gdp, 4) AS median_gdp
FROM median_gdp_per_region
ORDER BY median_gdp DESC
LIMIT 1;
```
2025-01-20 11:21:48 - root - INFO - itercount: 1
2025-01-20 11:21:48 - root - INFO - 0
2025-01-20 11:21:48 - root - INFO - results: 
region,median_gdp
North America,1696163077026.08


2025-01-20 11:21:48 - root - INFO - Please check the answer again by reviewing Which region has the highest median GDP (constant 2015 US$) value?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Region,Median_GDP
North America,median_gdp_value:float (Attention: answer in one row)
```

To determine which region has the highest median GDP (constant 2015 US$) value, we analyze the `indicators_data` table from the `world_bank_wdi` schema, focusing on the GDP indicator for each country. We then join this data with the `country_summary` table to associate each country with its respective region. After calculating the median GDP for each region, we find that **North America** has the highest median GDP value. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
region,median_gdp
North America,1696163077026.08
Current sql:
WITH gdp_data AS (
  SELECT
    cs.region,
    id.value AS gdp
  FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
  JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
    ON id.country_code = cs.country_code
  WHERE id.indicator_code = 'NY.GDP.MKTP.KD'
    AND id.year = 2019
    AND id.value IS NOT NULL
    AND cs.region NOT IN ('Aggregates', 'World', '')
    AND cs.region IS NOT NULL
),
median_gdp_per_region AS (
  SELECT
    region,
    IF(
      MOD(COUNT(*), 2) = 1,
      -- Odd number of countries: pick the middle value
      ARRAY_AGG(gdp ORDER BY gdp ASC)[OFFSET(DIV(COUNT(*), 2))],
      -- Even number of countries: average the two middle values
      (
        ARRAY_AGG(gdp ORDER BY gdp ASC)[OFFSET(DIV(COUNT(*), 2) - 1)] +
        ARRAY_AGG(gdp ORDER BY gdp ASC)[OFFSET(DIV(COUNT(*), 2))]
      ) / 2
    ) AS median_gdp
  FROM gdp_data
  GROUP BY region
)

SELECT
  region,
  ROUND(median_gdp, 4) AS median_gdp
FROM median_gdp_per_region
ORDER BY median_gdp DESC
LIMIT 1;Usage of ST_INTERSECTS: ST_INTERSECTS(geometry1, ST_GEOGFROMWKB(geometry2)) This function checks if the two geometries intersect. The first argument, geometry1, is compared with the second argument, geometry2, which is converted from its WKB (Well-Known Binary) representation to a geography type using ST_GEOGFROMWKB. If the two geometries share any portion of space, the function returns TRUE; otherwise, it returns FALSE. Usage of ST_CONTAINS: ST_CONTAINS(r1.geometry, r2.geometry) This function checks if the geometry r1.geometry completely contains the geometry r2.geometry. It returns TRUE if all points of r2.geometry are within r1.geometry and FALSE otherwise. This is useful for spatial containment queries, such as verifying whether one region is entirely within another. ARRAY_INTERSECTION(nodes1, nodes2): This function computes the intersection of the two arrays, returning a new array containing only the elements that are present in both nodes1 and nodes2. ARRAY_SIZE(...): This function then determines the size (or number of elements) in the resulting array from the intersection.

2025-01-20 11:22:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 11:22:14 - root - INFO - ```sql
WITH gdp_data AS (
  SELECT
    cs.region AS Region,
    id.value AS gdp
  FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
  JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
    ON id.country_code = cs.country_code
  WHERE id.indicator_code = 'NY.GDP.MKTP.KD'
    AND id.year = 2019
    AND id.value IS NOT NULL
    AND cs.region NOT IN ('Aggregates', 'World', '')
    AND cs.region IS NOT NULL
),
median_gdp_per_region AS (
  SELECT
    Region,
    IF(
      MOD(COUNT(*), 2) = 1,
      ARRAY_AGG(gdp ORDER BY gdp ASC)[OFFSET(DIV(COUNT(*), 2))],
      (
        ARRAY_AGG(gdp ORDER BY gdp ASC)[OFFSET(DIV(COUNT(*), 2) - 1)] +
        ARRAY_AGG(gdp ORDER BY gdp ASC)[OFFSET(DIV(COUNT(*), 2))]
      ) / 2
    ) AS median_gdp
  FROM gdp_data
  GROUP BY Region
)

SELECT
  Region,
  ROUND(median_gdp, 4) AS Median_GDP
FROM median_gdp_per_region
ORDER BY median_gdp DESC
LIMIT 1;
```
2025-01-20 11:22:16 - root - INFO - itercount: 2
2025-01-20 11:22:16 - root - INFO - 0
2025-01-20 11:22:16 - root - INFO - Total iteration counts: 2
