2025-01-20 11:16:16 - openai._base_client - INFO - Retrying request to /chat/completions in 0.397538 seconds
2025-01-20 11:17:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 11:17:34 - root - INFO - SQL:
SELECT DISTINCT indicator_name
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE LOWER(indicator_name) LIKE '%gdp%'
   LIMIT 1000;
Results:
indicator_name
"Personal remittances, received (% of GDP)"
Price level ratio of PPP conversion factor (GDP) to market exchange rate
Trade (% of GDP)
CO2 emissions (kg per 2015 US$ of GDP)
Coal rents (% of GDP)
Current account balance (% of GDP)
Discrepancy in expenditure estimate of GDP (current LCU)
Domestic credit to private sector by banks (% of GDP)
Domestic general government health expenditure (% of GDP)
External balance on goods and services (% of GDP)
Final consumption expenditure (% of GDP)
Forest rents (% of GDP)
GDP (constant LCU)
GDP (current LCU)
GDP per capita (current LCU)
GDP per capita growth (annual %)
General government final consumption expenditure (% of GDP)
"Industry (including construction), value added (% of GDP)"
Merchandise trade (% of GDP)
Military expenditure (% of GDP)
Oil rents (% of GDP)
Broad money (% of GDP)
"Claims on central government, etc. (% GDP)"
GDP (current US$)
GDP growth (annual %)
"GDP, PPP (current international $)"
"Manufacturing, value added (% of GDP)"
Market capitalization of listed domestic companies (% of GDP)
Monetary Sector credit to private sector (% GDP)
Natural gas rents (% of GDP)
"PPP conversion factor, GDP (LCU per international $)"
"Revenue, excluding grants (% of GDP)"
Trade in services (% of GDP)
GDP (constant 2015 US$)
GDP deflator: linked series (base year varies by country)
GDP per capita (constant 2015 US$)
Domestic credit to private sector (% of GDP)
Exports of goods and services (% of GDP)
"Foreign direct investment, net outflows (% of GDP)"
GDP deflator (base year varies by country)
GDP per capita (constant LCU)
"Government expenditure per student, secondary (% of GDP per capita)"
Gross capital formation (% of GDP)
Imports of goods and services (% of GDP)
"Inflation, GDP deflator (annual %)"
Net acquisition of financial assets (% of GDP)
"Services, value added (% of GDP)"
Discrepancy in expenditure estimate of GDP (constant LCU)
"Foreign direct investment, net inflows (% of GDP)"
"GDP per capita, PPP (current international $)"
GDP per person employed (constant 2017 PPP $)
GDP per unit of energy use (constant 2017 PPP $ per kg of oil equivalent)
GDP per unit of energy use (PPP $ per kg of oil equivalent)
Gross fixed capital formation (% of GDP)
Gross savings (% of GDP)
"Net incurrence of liabilities, total (% of GDP)"
Tax revenue (% of GDP)
Total natural resources rents (% of GDP)
GDP per capita (current US$)
Gross national expenditure (% of GDP)
Mineral rents (% of GDP)
"Agriculture, forestry, and fishing, value added (% of GDP)"
CO2 emissions (kg per PPP $ of GDP)
Expense (% of GDP)
"Government expenditure per student, tertiary (% of GDP per capita)"
Households and NPISHs final consumption expenditure (% of GDP)
Claims on other sectors of the domestic economy (% of GDP)
Current health expenditure (% of GDP)
Domestic credit provided by financial sector (% of GDP)
"Energy use (kg of oil equivalent) per $1,000 GDP (constant 2017 PPP)"
Gross domestic savings (% of GDP)
"Gross fixed capital formation, private sector (% of GDP)"
"GDP, PPP (constant 2017 international $)"
"Inflation, GDP deflator: linked series (annual %)"
"Stocks traded, total value (% of GDP)"
Net lending (+) / net borrowing (-) (% of GDP)
CO2 emissions (kg per 2017 PPP $ of GDP)
Energy intensity level of primary energy (MJ/$2011 PPP GDP)
GDP: linked series (current LCU)
"Government expenditure on education, total (% of GDP)"

2025-01-20 11:17:36 - root - INFO - SQL:
SELECT DISTINCT indicator_code
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE indicator_name = 'GDP (constant 2015 US$)'
   LIMIT 1000;
Results:
indicator_code
NY.GDP.MKTP.KD

2025-01-20 11:17:38 - root - INFO - SQL:
SELECT DISTINCT country_code, country_name
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   LIMIT 1000;
Results:
country_code,country_name
MOZ,Mozambique
MMR,Myanmar
NAM,Namibia
NRU,Nauru
NPL,Nepal
NLD,Netherlands
NCL,New Caledonia
NZL,New Zealand
NIC,Nicaragua
NER,Niger
NGA,Nigeria
VGB,British Virgin Islands
BRN,Brunei Darussalam
BGR,Bulgaria
BFA,Burkina Faso
BDI,Burundi
CPV,Cabo Verde
KHM,Cambodia
CAN,Canada
LCN,Latin America & Caribbean
LAC,Latin America & Caribbean (excluding high income)
TLA,Latin America & the Caribbean (IDA & IBRD countries)
LDC,Least developed countries: UN classification
LMY,Low & middle income
LIC,Low income
LMC,Lower middle income
MEA,Middle East & North Africa
MNA,Middle East & North Africa (excluding high income)
CZE,Czech Republic
DNK,Denmark
DJI,Djibouti
DMA,Dominica
GNQ,Equatorial Guinea
KWT,Kuwait
KGZ,Kyrgyz Republic
LAO,Lao PDR
LVA,Latvia
LBN,Lebanon
LSO,Lesotho
LBR,Liberia
LBY,Libya
LIE,Liechtenstein
LTU,Lithuania
LUX,Luxembourg
MAC,"Macao SAR, China"
AFE,Africa Eastern and Southern
AFW,Africa Western and Central
ARB,Arab World
CSS,Caribbean small states
CEB,Central Europe and the Baltics
EAR,Early-demographic dividend
EAS,East Asia & Pacific
EAP,East Asia & Pacific (excluding high income)
TEA,East Asia & Pacific (IDA & IBRD countries)
RUS,Russian Federation
RWA,Rwanda
WSM,Samoa
SMR,San Marino
STP,Sao Tome and Principe
SAU,Saudi Arabia
SRB,Serbia
SYC,Seychelles
SLE,Sierra Leone
SGP,Singapore
MKD,North Macedonia
MNP,Northern Mariana Islands
NOR,Norway
OMN,Oman
PLW,Palau
PNG,Papua New Guinea
CYM,Cayman Islands
CAF,Central African Republic
TCD,Chad
CHI,Channel Islands
CHN,China
COM,Comoros
COD,"Congo, Dem. Rep."
UMC,Upper middle income
WLD,World
AFG,Afghanistan
ALB,Albania
DZA,Algeria
ASM,American Samoa
AND,Andorra
AGO,Angola
ATG,Antigua and Barbuda
ARM,Armenia
ABW,Aruba

2025-01-20 11:17:40 - root - INFO - SQL:
SELECT country_code, short_name AS country_name, region
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   LIMIT 1000;
Results:
country_code,country_name,region
AFE,Africa Eastern and Southern,
AFW,Africa Western and Central,
ARB,Arab World,
CEB,Central Europe and the Baltics,
CSS,Caribbean small states,
EAP,East Asia & Pacific (excluding high income),
EAR,Early-demographic dividend,
EAS,East Asia & Pacific,
ECA,Europe & Central Asia (excluding high income),
ECS,Europe & Central Asia,
EUU,European Union,
FCS,Fragile and conflict affected situations,
HIC,High income,
HPC,Heavily indebted poor countries (HIPC),
IBD,IBRD only,
IBT,IDA & IBRD total,
IDA,IDA total,
IDB,IDA blend,
IDX,IDA only,
LAC,Latin America & Caribbean (excluding high income),
LCN,Latin America & Caribbean,
LDC,Least developed countries: UN classification,
LIC,Low income,
LMC,Lower middle income,
LMY,Low & middle income,
LTE,Late-demographic dividend,
MEA,Middle East & North Africa,
MIC,Middle income,
MNA,Middle East & North Africa (excluding high income),
NAC,North America,
OED,OECD members,
OSS,Other small states,
PRE,Pre-demographic dividend,
PSS,Pacific island small states,
PST,Post-demographic dividend,
SAS,South Asia,
SSA,Sub-Saharan Africa (excluding high income),
SSF,Sub-Saharan Africa,
SST,Small states,
TEA,East Asia & Pacific (IDA & IBRD),
TEC,Europe & Central Asia (IDA & IBRD),
TLA,Latin America & Caribbean (IDA & IBRD),
TMN,Middle East & North Africa (IDA & IBRD),
TSA,South Asia (IDA & IBRD),
TSS,Sub-Saharan Africa (IDA & IBRD),
UMC,Upper middle income,
WLD,World,
AND,Andorra,Europe & Central Asia
BMU,Bermuda,North America
CHI,Channel Islands,Europe & Central Asia
CUW,Curaçao,Latin America & Caribbean
CYM,Cayman Islands,Latin America & Caribbean
FRO,Faroe Islands,Europe & Central Asia
GIB,Gibraltar,Europe & Central Asia
GRL,Greenland,Europe & Central Asia
GUM,Guam,East Asia & Pacific
IMN,Isle of Man,Europe & Central Asia
LIE,Liechtenstein,Europe & Central Asia
MAF,St. Martin (French part),Latin America & Caribbean
MCO,Monaco,Europe & Central Asia

2025-01-20 11:17:42 - root - INFO - SQL:
SELECT DISTINCT year
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE indicator_name = 'GDP (constant 2015 US$)'
   ORDER BY year DESC
   LIMIT 1000;
Results:
year
2020
2019
2018
2017
2016
2015
2014
2013
2012
2011
2010
2009
2008
2007
2006
2005
2004
2003
2002
2001
2000
1999
1998
1997
1996
1995
1994
1993
1992
1991
1990
1989
1988
1987
1986
1985
1984
1983
1982
1981
1980
1979
1978
1977
1976
1975
1974
1973
1972
1971
1970
1969
1968
1967
1966
1965
1964
1963
1962
1961
1960

2025-01-20 11:17:43 - root - INFO - SQL:
SELECT country_code, country_name, value AS gdp
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE indicator_name = 'GDP (constant 2015 US$)' AND year = 2019
   LIMIT 1000;
Results:
country_code,country_name,gdp
GAB,Gabon,15460241608.8257
NAM,Namibia,11240759011.0283
AGO,Angola,110072586683.261
SDN,Sudan,51312429477.3951
MNA,Middle East & North Africa (excluding high income),1538200834048.04
AFE,Africa Eastern and Southern,1006679813065.29
TON,Tonga,486181549.588749
TKM,Turkmenistan,45710025776.6731
EAR,Early-demographic dividend,11703037495097.2
QAT,Qatar,167371229308.42
TEC,Europe & Central Asia (IDA & IBRD countries),4095463099662.97
AUT,Austria,414257026093.423
NGA,Nigeria,502942019447.736
DEU,Germany,3598891541091.34
MOZ,Mozambique,18183590595.087
LAO,Lao PDR,18491845636.2733
MLT,Malta,13856372628.2222
WSM,Samoa,887495263.360233
HPC,Heavily indebted poor countries (HIPC),788661392496.297
MDG,Madagascar,13186360351.4331
SVN,Slovenia,50249892617.4104
KAZ,Kazakhstan,211106972039.014
PRT,Portugal,222272974069.03
GBR,United Kingdom,3191493407624.4
NAC,North America,21677548659072.5
ARB,Arab World,2681441590769.14
OMN,Oman,83053174485.8283
TSS,Sub-Saharan Africa (IDA & IBRD countries),1834643244102.56
LAC,Latin America & Caribbean (excluding high income),4853709324043.9
ETH,Ethiopia,89640020508.4013
CZE,Czech Republic,215594735504.853
TCA,Turks and Caicos Islands,1095902844.26329
GIN,Guinea,12078653011.9638
BLZ,Belize,1835056955.71673
KWT,Kuwait,114249382864.585
MMR,Myanmar,83686992015.6706
LVA,Latvia,30716038078.95
AZE,Azerbaijan,53612524527.3911
URY,Uruguay,55513344382.0673
LUX,Luxembourg,67286460381.3888
CSS,Caribbean small states,74283427277.9706
GRC,Greece,203669187367.386
KHM,Cambodia,23760061873.2798
TEA,East Asia & Pacific (IDA & IBRD countries),16995303639412.5
FIN,Finland,254637296103.695
LIC,Low income,476617321590.818
DJI,Djibouti,3191833262.48686
LTU,Lithuania,48155059559.2863
HRV,Croatia,57190160216.5408
SAS,South Asia,3431466032627.32
TSA,South Asia (IDA & IBRD),3431466032627.32
GNB,Guinea-Bissau,1248729327.89726
ALB,Albania,12970913827.5704
MCO,Monaco,7080667991.59357
COG,"Congo, Rep.",9643515879.79193
GEO,Georgia,17757903230.0709
MNG,Mongolia,14174566299.8985
MNE,Montenegro,4777636043.80572
EST,Estonia,27068147756.8566
ECA,Europe & Central Asia (excluding high income),3468157804813.19
TTO,Trinidad and Tobago,22587789317.2434
ISR,Israel,353062816517.302

2025-01-20 11:17:45 - root - INFO - SQL:
SELECT region, COUNT(*) AS country_count
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   GROUP BY region
   LIMIT 1000;
Results:
region,country_count
,48
Europe & Central Asia,58
North America,3
Latin America & Caribbean,42
East Asia & Pacific,37
Sub-Saharan Africa,48
Middle East & North Africa,21
South Asia,8

2025-01-20 11:17:47 - root - INFO - SQL:
SELECT id.country_code, id.country_name, cs.region, id.value AS gdp, id.year
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
   ON id.country_code = cs.country_code
   WHERE indicator_name = 'GDP (constant 2015 US$)'
   LIMIT 1000;
Results:
country_code,country_name,region,gdp,year
NRU,Nauru,East Asia & Pacific,65927361.0434273,2013
NZL,New Zealand,East Asia & Pacific,108891705224.987,1997
NIC,Nicaragua,Latin America & Caribbean,3939117486.81316,1963
NIC,Nicaragua,Latin America & Caribbean,7456675372.13516,1974
NIC,Nicaragua,Latin America & Caribbean,13487252998.9628,2018
NER,Niger,Sub-Saharan Africa,3876950075.132,1980
NER,Niger,Sub-Saharan Africa,9683867893.68343,2015
CPV,Cabo Verde,Sub-Saharan Africa,218190594.824461,1984
CPV,Cabo Verde,Sub-Saharan Africa,947482014.985927,2003
CPV,Cabo Verde,Sub-Saharan Africa,1671942379.49743,2016
LAC,Latin America & Caribbean (excluding high income),,995869499214.758,1969
LAC,Latin America & Caribbean (excluding high income),,3964059386067.38,2008
TLA,Latin America & the Caribbean (IDA & IBRD countries),,1162822337717.13,1970
LMY,Low & middle income,,8662109953755.54,1994
LIC,Low income,,227952991433.546,1999
GNQ,Equatorial Guinea,Sub-Saharan Africa,12012844403.0027,2007
KGZ,Kyrgyz Republic,Europe & Central Asia,3518703669.32844,2000
KGZ,Kyrgyz Republic,Europe & Central Asia,5577000617.04261,2011
LAO,Lao PDR,East Asia & Pacific,3012256767.69759,1992
LBN,Lebanon,Middle East & North Africa,49776391957.7016,2014
LSO,Lesotho,Sub-Saharan Africa,651827763.249178,1981
LBR,Liberia,Sub-Saharan Africa,2360440981.31983,2002
LBR,Liberia,Sub-Saharan Africa,3254893758.73415,2017
LBY,Libya,Middle East & North Africa,40560602832.7856,2004
AFE,Africa Eastern and Southern,,442342732156.009,1996
ARB,Arab World,,2077172086641.65,2010
CSS,Caribbean small states,,59293536367.7269,2003
EAR,Early-demographic dividend,,1277296043414.66,1964
EAS,East Asia & Pacific,,1616709469640.92,1965
TEA,East Asia & Pacific (IDA & IBRD countries),,3531793950846.35,1999
TEA,East Asia & Pacific (IDA & IBRD countries),,12433240724383.0,2014
RUS,Russian Federation,Europe & Central Asia,1416124431328.3,2020
WSM,Samoa,East Asia & Pacific,448576508.285271,1990
STP,Sao Tome and Principe,Sub-Saharan Africa,341901474.463989,2017
SAU,Saudi Arabia,Middle East & North Africa,334230179965.594,1993
SYC,Seychelles,Sub-Saharan Africa,1184796354.18336,2012
NGA,Nigeria,Sub-Saharan Africa,76930009900.9302,1964
MKD,North Macedonia,Europe & Central Asia,7334617663.50844,2005
MKD,North Macedonia,Europe & Central Asia,10064515432.0265,2015
NOR,Norway,Europe & Central Asia,81598233089.8432,1964

2025-01-20 11:17:49 - root - INFO - SQL:
SELECT id.country_code, id.country_name, id.value AS gdp
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
   ON id.country_code = cs.country_code
   WHERE indicator_name = 'GDP (constant 2015 US$)' AND year = 2019 AND cs.region = 'Europe & Central Asia'
   LIMIT 1000;
Results:
country_code,country_name,gdp
TKM,Turkmenistan,45710025776.6731
AUT,Austria,414257026093.423
DEU,Germany,3598891541091.34
SVN,Slovenia,50249892617.4104
KAZ,Kazakhstan,211106972039.014
PRT,Portugal,222272974069.03
GBR,United Kingdom,3191493407624.4
CZE,Czech Republic,215594735504.853
LVA,Latvia,30716038078.95
AZE,Azerbaijan,53612524527.3911
LUX,Luxembourg,67286460381.3888
GRC,Greece,203669187367.386
FIN,Finland,254637296103.695
LTU,Lithuania,48155059559.2863
HRV,Croatia,57190160216.5408
ALB,Albania,12970913827.5704
MCO,Monaco,7080667991.59357
GEO,Georgia,17757903230.0709
MNE,Montenegro,4777636043.80572
EST,Estonia,27068147756.8566
UKR,Ukraine,101944109453.562
SMR,San Marino,1514041111.68851
POL,Poland,570115134633.24
ITA,Italy,1915994931005.09
ROU,Romania,217382984916.126
BLR,Belarus,59013474192.6442
MDA,Moldova,9155458065.71175
ESP,Spain,1324028319783.9
XKX,Kosovo,7547420630.10043
NLD,Netherlands,839912581383.842
TUR,Turkey,997437115405.82
TJK,Tajikistan,10943735892.3235
GRL,Greenland,2710570656.36234
CYP,Cyprus,24880804888.1512
NOR,Norway,406468037614.963
BGR,Bulgaria,57443866470.1882
ARM,Armenia,12867495686.1153
BIH,Bosnia and Herzegovina,18413845946.1771
ISL,Iceland,20847341424.8856
SRB,Serbia,45615675379.6018
UZB,Uzbekistan,106161435002.412
DNK,Denmark,334638192450.446
BEL,Belgium,494644115983.888
HUN,Hungary,146968695014.007
RUS,Russian Federation,1459189098326.43
SVK,Slovak Republic,99048285215.7697
KGZ,Kyrgyz Republic,7920624102.90056
CHE,Switzerland,758167874591.909
MKD,North Macedonia,11185489898.549
FRA,France,2615760319962.67
IRL,Ireland,370632118369.555
IMN,Isle of Man,8129451489.68678
AND,Andorra,3008955096.59511
SWE,Sweden,549821281946.735

2025-01-20 11:18:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 11:18:21 - root - INFO - ```sql
SELECT id.country_code, id.country_name, id.value AS gdp
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
ON id.country_code = cs.country_code
WHERE id.indicator_code = 'NY.GDP.MKTP.KD' AND id.year = 2019 AND cs.region = 'Europe & Central Asia'
LIMIT 1000;
```
2025-01-20 11:19:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 11:19:22 - root - INFO - SQL:
SELECT id.country_code, id.country_name, id.value AS gdp
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
ON id.country_code = cs.country_code
WHERE id.indicator_code = 'NY.GDP.MKTP.KD' AND id.year = 2019 AND cs.region = 'Europe & Central Asia'
LIMIT 1000;
Results:
country_code,country_name,gdp
TKM,Turkmenistan,45710025776.6731
AUT,Austria,414257026093.423
DEU,Germany,3598891541091.34
SVN,Slovenia,50249892617.4104
KAZ,Kazakhstan,211106972039.014
PRT,Portugal,222272974069.03
GBR,United Kingdom,3191493407624.4
CZE,Czech Republic,215594735504.853
LVA,Latvia,30716038078.95
AZE,Azerbaijan,53612524527.3911
LUX,Luxembourg,67286460381.3888
GRC,Greece,203669187367.386
FIN,Finland,254637296103.695
LTU,Lithuania,48155059559.2863
HRV,Croatia,57190160216.5408
ALB,Albania,12970913827.5704
MCO,Monaco,7080667991.59357
GEO,Georgia,17757903230.0709
MNE,Montenegro,4777636043.80572
EST,Estonia,27068147756.8566
UKR,Ukraine,101944109453.562
SMR,San Marino,1514041111.68851
POL,Poland,570115134633.24
ITA,Italy,1915994931005.09
ROU,Romania,217382984916.126
BLR,Belarus,59013474192.6442
MDA,Moldova,9155458065.71175
ESP,Spain,1324028319783.9
XKX,Kosovo,7547420630.10043
NLD,Netherlands,839912581383.842
TUR,Turkey,997437115405.82
TJK,Tajikistan,10943735892.3235
GRL,Greenland,2710570656.36234
CYP,Cyprus,24880804888.1512
NOR,Norway,406468037614.963
BGR,Bulgaria,57443866470.1882
ARM,Armenia,12867495686.1153
BIH,Bosnia and Herzegovina,18413845946.1771
ISL,Iceland,20847341424.8856
SRB,Serbia,45615675379.6018
UZB,Uzbekistan,106161435002.412
DNK,Denmark,334638192450.446
BEL,Belgium,494644115983.888
HUN,Hungary,146968695014.007
RUS,Russian Federation,1459189098326.43
SVK,Slovak Republic,99048285215.7697
KGZ,Kyrgyz Republic,7920624102.90056
CHE,Switzerland,758167874591.909
MKD,North Macedonia,11185489898.549
FRA,France,2615760319962.67
IRL,Ireland,370632118369.555
IMN,Isle of Man,8129451489.68678
AND,Andorra,3008955096.59511
SWE,Sweden,549821281946.735

2025-01-20 11:19:24 - root - INFO - SQL:
SELECT country_code, country_name, value AS gdp
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE indicator_code = 'NY.GDP.MKTP.KD' AND year = 2019
ORDER BY gdp DESC
LIMIT 10
Results:
country_code,country_name,gdp
WLD,World,84612027798062.6
HIC,High income,52180038375130.5
OED,OECD members,51615069476329.7
PST,Post-demographic dividend,48381584694878.9
IBT,IDA & IBRD total,33299134680470.5
LMY,Low & middle income,32139450441501.1
MIC,Middle income,31663365601529.3
IBD,IBRD only,30947573002709.4
EAS,East Asia & Pacific,26302619575881.9
UMC,Upper middle income,23866821838887.8

2025-01-20 11:19:26 - root - INFO - SQL:
SELECT year, value AS gdp
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE indicator_code = 'NY.GDP.MKTP.KD' AND country_name = 'United States'
ORDER BY year ASC
LIMIT 1000
Results:
year,gdp
1960,3457188037625.69
1961,3536703362491.07
1962,3752442267603.03
1963,3917549727377.56
1964,4144767611565.47
1965,4410032738705.65
1966,4696684866721.53
1967,4814101988389.57
1968,5045178883832.25
1969,5201579429231.05
1970,5183548220000.0
1971,5354260691000.0
1972,5635836299000.0
1973,5954019981000.0
1974,5921835427000.0
1975,5909668657000.0
1976,6228089836000.0
1977,6516086243000.0
1978,6876771488000.0
1979,7094500066000.0
1980,7076284960000.0
1981,7255861209000.0
1982,7125046201000.0
1983,7451652146000.0
1984,7990900876000.0
1985,8324093971000.0
1986,8612327876000.0
1987,8910249999000.0
1988,9282436602000.0
1989,9623347839000.0
1990,9804840807000.0
1991,9794225617000.0
1992,10139221389000.0
1993,10418230561000.0
1994,10837959532000.0
1995,11128873914000.0
1996,11548717972000.0
1997,12054756829000.0
1998,12594979613000.0
1999,13193648716000.0
2000,13738214458000.0
2001,13875368657000.0
2002,14117035294000.0
2003,14520953428000.0
2004,15072588639000.0
2005,15602120903000.0
2006,16047557132000.0
2007,16348636818000.0
2008,16326307882000.0
2009,15912149113000.0
2010,16320099471000.0
2011,16573197368000.0
2012,16946019042000.0
2013,17258178451000.0
2014,17694115456000.0
2015,18238300569000.0
2016,18550435728000.0
2017,18983157920000.0
2018,19551981480000.0
2019,19974534312000.0
2020,19294483000000.0

2025-01-20 11:19:27 - root - INFO - SQL:
SELECT DISTINCT region
FROM `bigquery-public-data.world_bank_wdi.country_summary`
LIMIT 1000
Results:
region
""
Europe & Central Asia
North America
Latin America & Caribbean
East Asia & Pacific
Sub-Saharan Africa
Middle East & North Africa
South Asia

2025-01-20 11:19:30 - root - INFO - SQL:
SELECT cs.region, AVG(id.value) AS average_gdp
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
ON id.country_code = cs.country_code
WHERE id.indicator_code = 'NY.GDP.MKTP.KD' AND id.year = 2019
GROUP BY cs.region
LIMIT 1000
Results:
region,average_gdp
,12954727604440.113
East Asia & Pacific,754966404370.8977
Sub-Saharan Africa,39604795061.31859
Latin America & Caribbean,143902774165.0307
Europe & Central Asia,413777989849.8653
South Asia,428933254078.4158
North America,7225849553024.158
Middle East & North Africa,167057963295.84705

2025-01-20 11:19:32 - root - INFO - SQL:
SELECT country_code, country_name, value AS gdp
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE indicator_code = 'NY.GDP.MKTP.KD' AND year = 2019 AND value > 1000000000000
LIMIT 1000
Results:
country_code,country_name,gdp
MNA,Middle East & North Africa (excluding high income),1538200834048.04
AFE,Africa Eastern and Southern,1006679813065.29
EAR,Early-demographic dividend,11703037495097.2
TEC,Europe & Central Asia (IDA & IBRD countries),4095463099662.97
DEU,Germany,3598891541091.34
GBR,United Kingdom,3191493407624.4
NAC,North America,21677548659072.5
ARB,Arab World,2681441590769.14
TSS,Sub-Saharan Africa (IDA & IBRD countries),1834643244102.56
LAC,Latin America & Caribbean (excluding high income),4853709324043.9
TEA,East Asia & Pacific (IDA & IBRD countries),16995303639412.5
SAS,South Asia,3431466032627.32
TSA,South Asia (IDA & IBRD),3431466032627.32
ECA,Europe & Central Asia (excluding high income),3468157804813.19
USA,United States,19974534312000.0
IDX,IDA only,1229224147182.17
IDB,IDA blend,1121954012747.96
PRE,Pre-demographic dividend,1450630111014.12
ITA,Italy,1915994931005.09
IDA,IDA total,2351178159930.13
SSF,Sub-Saharan Africa,1834643244102.56
OED,OECD members,51615069476329.7
LTE,Late-demographic dividend,22419881460422.2
UMC,Upper middle income,23866821838887.8
LDC,Least developed countries: UN classification,1126602114779.77
ESP,Spain,1324028319783.9
IDN,Indonesia,1049318966508.58
IND,India,2695611314661.46
MEX,Mexico,1252848919131.02
EUU,European Union,14765116523492.0
TMN,Middle East & North Africa (IDA & IBRD countries),1522371834048.04
EAP,East Asia & Pacific (excluding high income),17016933263759.9
CAN,Canada,1696163077026.08
JPN,Japan,4591290538384.75
EAS,East Asia & Pacific,26302619575881.9
HIC,High income,52180038375130.5
TLA,Latin America & the Caribbean (IDA & IBRD countries),5369907031287.5
WLD,World,84612027798062.6
FCS,Fragile and conflict affected situations,1720631743301.35
CEB,Central Europe and the Baltics,1519932999983.23
RUS,Russian Federation,1459189098326.43
MIC,Middle income,31663365601529.3
LCN,Latin America & Caribbean,5596468714863.74
IBT,IDA & IBRD total,33299134680470.5
CHN,China,14296238286985.1
ECS,Europe & Central Asia,22365520285914.6
PST,Post-demographic dividend,48381584694878.9
FRA,France,2615760319962.67
SSA,Sub-Saharan Africa (excluding high income),1833089644759.92
EMU,Euro area,12615961472339.9
MEA,Middle East & North Africa,3378463990503.43
IBD,IBRD only,30947573002709.4
LMY,Low & middle income,32139450441501.1
LMC,Lower middle income,7796543762641.46
AUS,Australia,1491025040336.15
BRA,Brazil,1823105452462.95
KOR,"Korea, Rep.",1637850078348.95

2025-01-20 11:19:33 - root - INFO - SQL:
SELECT id.country_code, id.country_name, cs.region
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
ON id.country_code = cs.country_code
WHERE id.indicator_code = 'NY.GDP.MKTP.KD' AND id.year = 2019
LIMIT 1000
Results:
country_code,country_name,region
GAB,Gabon,Sub-Saharan Africa
NAM,Namibia,Sub-Saharan Africa
AGO,Angola,Sub-Saharan Africa
SDN,Sudan,Sub-Saharan Africa
MNA,Middle East & North Africa (excluding high income),
AFE,Africa Eastern and Southern,
TON,Tonga,East Asia & Pacific
TKM,Turkmenistan,Europe & Central Asia
EAR,Early-demographic dividend,
QAT,Qatar,Middle East & North Africa
TEC,Europe & Central Asia (IDA & IBRD countries),
AUT,Austria,Europe & Central Asia
NGA,Nigeria,Sub-Saharan Africa
DEU,Germany,Europe & Central Asia
MOZ,Mozambique,Sub-Saharan Africa
LAO,Lao PDR,East Asia & Pacific
MLT,Malta,Middle East & North Africa
WSM,Samoa,East Asia & Pacific
HPC,Heavily indebted poor countries (HIPC),
MDG,Madagascar,Sub-Saharan Africa
SVN,Slovenia,Europe & Central Asia
KAZ,Kazakhstan,Europe & Central Asia
PRT,Portugal,Europe & Central Asia
GBR,United Kingdom,Europe & Central Asia
NAC,North America,
ARB,Arab World,
OMN,Oman,Middle East & North Africa
TSS,Sub-Saharan Africa (IDA & IBRD countries),
LAC,Latin America & Caribbean (excluding high income),
ETH,Ethiopia,Sub-Saharan Africa
CZE,Czech Republic,Europe & Central Asia
TCA,Turks and Caicos Islands,Latin America & Caribbean
GIN,Guinea,Sub-Saharan Africa
BLZ,Belize,Latin America & Caribbean
KWT,Kuwait,Middle East & North Africa
MMR,Myanmar,East Asia & Pacific
LVA,Latvia,Europe & Central Asia
AZE,Azerbaijan,Europe & Central Asia
URY,Uruguay,Latin America & Caribbean
LUX,Luxembourg,Europe & Central Asia
CSS,Caribbean small states,
GRC,Greece,Europe & Central Asia
KHM,Cambodia,East Asia & Pacific
TEA,East Asia & Pacific (IDA & IBRD countries),
FIN,Finland,Europe & Central Asia
LIC,Low income,
DJI,Djibouti,Middle East & North Africa
LTU,Lithuania,Europe & Central Asia
HRV,Croatia,Europe & Central Asia
SAS,South Asia,
TSA,South Asia (IDA & IBRD),
GNB,Guinea-Bissau,Sub-Saharan Africa
ALB,Albania,Europe & Central Asia
MCO,Monaco,Europe & Central Asia
COG,"Congo, Rep.",Sub-Saharan Africa
GEO,Georgia,Europe & Central Asia
MNG,Mongolia,East Asia & Pacific
MNE,Montenegro,Europe & Central Asia

2025-01-20 11:19:35 - root - INFO - SQL:
SELECT cs.region, MIN(id.value) AS min_gdp, MAX(id.value) AS max_gdp
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
ON id.country_code = cs.country_code
WHERE id.indicator_code = 'NY.GDP.MKTP.KD' AND id.year = 2019
GROUP BY cs.region
LIMIT 1000
Results:
region,min_gdp,max_gdp
,10138908192.4612,84612027798062.6
East Asia & Pacific,42824596.8653884,14296238286985.1
Sub-Saharan Africa,359752972.346268,502942019447.736
Latin America & Caribbean,568298267.854584,1823105452462.95
Europe & Central Asia,1514041111.68851,3598891541091.34
South Asia,2470944511.92544,2695611314661.46
North America,6851270046.39601,19974534312000.0
Middle East & North Africa,3191833262.48686,678581100842.581

2025-01-20 11:19:38 - root - INFO - SQL:
SELECT cs.region, COUNT(id.country_code) AS countries_with_gdp
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
ON id.country_code = cs.country_code
WHERE id.indicator_code = 'NY.GDP.MKTP.KD' AND id.year = 2019 AND id.value IS NOT NULL
GROUP BY cs.region
LIMIT 1000
Results:
region,countries_with_gdp
,48
East Asia & Pacific,34
Sub-Saharan Africa,46
Latin America & Caribbean,37
Europe & Central Asia,54
South Asia,8
North America,3
Middle East & North Africa,20

2025-01-20 11:19:40 - root - INFO - SQL:
SELECT country_code, country_name, value AS gdp
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE indicator_code = 'NY.GDP.MKTP.KD' AND year = 2019 AND value < 10000000000
LIMIT 1000
Results:
country_code,country_name,gdp
TON,Tonga,486181549.588749
WSM,Samoa,887495263.360233
TCA,Turks and Caicos Islands,1095902844.26329
BLZ,Belize,1835056955.71673
DJI,Djibouti,3191833262.48686
GNB,Guinea-Bissau,1248729327.89726
MCO,Monaco,7080667991.59357
COG,"Congo, Rep.",9643515879.79193
MNE,Montenegro,4777636043.80572
MWI,Malawi,7477443338.32784
CAF,Central African Republic,1984982171.73544
TGO,Togo,5098275352.1552
BDI,Burundi,3209182941.33059
FJI,Fiji,5223164712.00555
BRB,Barbados,4822013073.75235
SMR,San Marino,1514041111.68851
SUR,Suriname,5252729241.66594
VIR,Virgin Islands (U.S.),3835985859.12487
MDA,Moldova,9155458065.71175
VUT,Vanuatu,869804185.719708
BTN,Bhutan,2470944511.92544
XKX,Kosovo,7547420630.10043
VCT,St. Vincent and the Grenadines,798469518.407039
GRL,Greenland,2710570656.36234
LSO,Lesotho,2329753748.89367
MDV,Maldives,5414217823.03808
PLW,Palau,265597626.615969
MHL,Marshall Islands,212388500.0
NRU,Nauru,89620006.418409
GNQ,Equatorial Guinea,9998462337.55955
SOM,Somalia,6900727625.84454
ATG,Antigua and Barbuda,1630215842.3024
SLB,Solomon Islands,1533613348.9277
GUM,Guam,5966796360.32757
MNP,Northern Mariana Islands,1037951515.15152
GMB,"Gambia, The",1676447055.8329
TUV,Tuvalu,42824596.8653884
MRT,Mauritania,7336133809.76738
CYM,Cayman Islands,5425515180.60722
KGZ,Kyrgyz Republic,7920624102.90056
KIR,Kiribati,195759870.68938
ASM,American Samoa,628818320.610687
GUY,Guyana,5071041645.23612
COM,Comoros,1092787840.36505
FSM,"Micronesia, Fed. Sts.",332458532.270118
STP,Sao Tome and Principe,359752972.346268
KNA,St. Kitts and Nevis,1136818536.07058
BMU,Bermuda,6851270046.39601
CUW,Curacao,2898092042.62992
DMA,Dominica,568298267.854584
LBR,Liberia,3211334057.92828
LCA,St. Lucia,1995116519.64915
SLE,Sierra Leone,5076711739.04284
TLS,Timor-Leste,1896767581.03646
IMN,Isle of Man,8129451489.68678
CPV,Cabo Verde,1915123782.86887
SYC,Seychelles,1553599342.64266
SWZ,Eswatini,4401077165.65255
AND,Andorra,3008955096.59511
GRD,Grenada,1134931073.15504

2025-01-20 11:19:42 - root - INFO - SQL:
SELECT id.country_code, id.country_name, MAX(id.year) AS latest_year, id.value AS gdp
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
WHERE id.indicator_code = 'NY.GDP.MKTP.KD'
GROUP BY id.country_code, id.country_name, id.value
LIMIT 1000
Results:
country_code,country_name,latest_year,gdp
MMR,Myanmar,1968,3766485577.12378
NAM,Namibia,1998,5242128224.00169
NPL,Nepal,1962,3447314854.82201
NPL,Nepal,2006,16439932516.5831
BRN,Brunei Darussalam,2009,12665627056.3659
BGR,Bulgaria,1985,35814094910.805
BGR,Bulgaria,1987,39580615170.2135
BDI,Burundi,1982,1712247647.29676
LAC,Latin America & Caribbean (excluding high income),1997,2846009420300.99
LMY,Low & middle income,2007,17586878384858.0
LMC,Lower middle income,1965,771275616651.188
LMC,Lower middle income,1990,2122313482158.37
LMC,Lower middle income,2002,3194038992245.53
MEA,Middle East & North Africa,2020,3243739545284.98
MNA,Middle East & North Africa (excluding high income),1980,419562499542.787
DMA,Dominica,1978,234352173.555526
LVA,Latvia,2007,29002363545.9676
LSO,Lesotho,2004,1612096000.49548
WSM,Samoa,1982,409723388.389005
OMN,Oman,1983,18925617927.7435
CAF,Central African Republic,1965,1013697584.80447
COM,Comoros,1997,563886119.709676
WLD,World,2000,48146683077384.4
DZA,Algeria,1961,20733849882.3774
DZA,Algeria,2006,126495413069.533
TMN,Middle East & North Africa (IDA & IBRD countries),2004,992580883046.924
NAC,North America,1992,10929544482336.9
PSS,Pacific island small states,2005,7231294470.42854
PST,Post-demographic dividend,1963,9889377686297.1
FIN,Finland,1960,50589519083.7226
FIN,Finland,1987,140069588805.624
FIN,Finland,2002,204568476382.962
FRA,France,1976,1148593347439.08
FRA,France,1990,1660423065362.52
GAB,Gabon,2019,15460241608.8257
EMU,Euro area,1997,9036375850461.54
EMU,Euro area,2009,10965349872015.8
HIC,High income,1978,19407887392109.1
HIC,High income,1985,23196833368009.8
MDG,Madagascar,2018,12629254614.1071
MLT,Malta,1985,2646361034.06191
MHL,Marshall Islands,2007,175092500.0
MRT,Mauritania,1963,1051184411.5989
MRT,Mauritania,1985,2488366451.23844
SGP,Singapore,1962,6911841722.43236
SXM,Sint Maarten (Dutch part),2018,1108000824.03352
ESP,Spain,2010,1196670854394.8
PRI,Puerto Rico,1986,58362843987.8155
COG,"Congo, Rep.",1964,1423661535.42456

2025-01-20 11:19:42 - root - INFO - itercount: 0
2025-01-20 11:19:42 - root - INFO - Database Name: bigquery-public-data
Schema Name: world_bank_global_population
DDL describes table information.
,0
table_name,population_by_country
ddl,"CREATE TABLE `bigquery-public-data.world_bank_global_population.population_by_country`
(
  country STRING,
  country_code STRING,
  year_1960 INT64,
  year_1961 INT64,
  year_1962 INT64,
  year_1963 INT64,
  year_1964 INT64,
  year_1965 INT64,
  year_1966 INT64,
  year_1967 INT64,
  year_1968 INT64,
  year_1969 INT64,
  year_1970 INT64,
  year_1971 INT64,
  year_1972 INT64,
  year_1973 INT64,
  year_1974 INT64,
  year_1975 INT64,
  year_1976 INT64,
  year_1977 INT64,
  year_1978 INT64,
  year_1979 INT64,
  year_1980 INT64,
  year_1981 INT64,
  year_1982 INT64,
  year_1983 INT64,
  year_1984 INT64,
  year_1985 INT64,
  year_1986 INT64,
  year_1987 INT64,
  year_1988 INT64,
  year_1989 INT64,
  year_1990 INT64,
  year_1991 INT64,
  year_1992 INT64,
  year_1993 INT64,
  year_1994 INT64,
  year_1995 INT64,
  year_1996 INT64,
  year_1997 INT64,
  year_1998 INT64,
  year_1999 INT64,
  year_2000 INT64,
  year_2001 INT64,
  year_2002 INT64,
  year_2003 INT64,
  year_2004 INT64,
  year_2005 INT64,
  year_2006 INT64,
  year_2007 INT64,
  year_2008 INT64,
  year_2009 INT64,
  year_2010 INT64,
  year_2011 INT64,
  year_2012 INT64,
  year_2013 INT64,
  year_2014 INT64,
  year_2015 INT64,
  year_2016 INT64,
  year_2017 INT64,
  year_2018 INT64,
  year_2019 INT64
)
PARTITION BY DATE(_PARTITIONTIME);"

Database Name: bigquery-public-data
Schema Name: world_bank_health_population
DDL describes table information.
,0
table_name,series_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.series_summary`
(
  series_code STRING,
  topic STRING,
  indicator_name STRING,
  short_definition STRING,
  long_definition STRING,
  unit_of_measure STRING,
  periodicity STRING,
  base_period INT64,
  other_notes STRING,
  aggregation_method STRING,
  limitations_and_exceptions STRING,
  notes_from_original_source STRING,
  general_comments STRING,
  source STRING,
  statistical_concept_and_methodology STRING,
  development_relevance STRING,
  related_source_links STRING,
  other_web_links STRING,
  related_indicators STRING,
  license_type STRING
)
OPTIONS(
  description=""Series Summary table""
);"

,1
table_name,country_series_definitions
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.country_series_definitions`
(
  country_code STRING,
  series_code STRING,
  description STRING
)
OPTIONS(
  description=""Country Series Definition table""
);"

,2
table_name,series_times
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.series_times`
(
  series_code STRING,
  year INT64,
  description STRING
)
OPTIONS(
  description=""Series Times table""
);"

,3
table_name,country_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.country_summary`
(
  country_code STRING,
  short_name STRING,
  table_name STRING,
  long_name STRING,
  two_alpha_code STRING,
  currency_unit STRING,
  special_notes STRING,
  region STRING,
  income_group STRING,
  wb_2_code STRING,
  national_accounts_base_year STRING,
  national_accounts_reference_year STRING,
  sna_price_valuation STRING,
  lending_category STRING,
  other_groups STRING,
  system_of_national_accounts STRING,
  alternative_conversion_factor STRING,
  ppp_survey_year STRING,
  balance_of_payments_manual_in_use STRING,
  external_debt_reporting_status STRING,
  system_of_trade STRING,
  government_accounting_concept STRING,
  imf_data_dissemination_standard STRING,
  latest_population_census STRING,
  latest_household_survey STRING,
  source_of_most_recent_income_and_expenditure_data STRING,
  vital_registration_complete STRING,
  latest_agricultural_census STRING,
  latest_industrial_data INT64,
  latest_trade_data INT64
)
OPTIONS(
  description=""Country Summary table""
);"

,4
table_name,health_nutrition_population
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.health_nutrition_population`
(
  country_name STRING OPTIONS(description=""""),
  country_code STRING OPTIONS(description=""""),
  indicator_name STRING OPTIONS(description=""""),
  indicator_code STRING OPTIONS(description=""""),
  value FLOAT64 OPTIONS(description=""""),
  year INT64 OPTIONS(description="""")
);"

Database Name: bigquery-public-data
Schema Name: world_bank_intl_debt
DDL describes table information.
,0
table_name,series_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.series_summary`
(
  series_code STRING,
  topic STRING,
  indicator_name STRING,
  short_definition STRING,
  long_definition STRING,
  unit_of_measure STRING,
  periodicity STRING,
  base_period STRING,
  other_notes STRING,
  aggregation_method STRING,
  limitations_and_exceptions STRING,
  notes_from_original_source STRING,
  general_comments STRING,
  source STRING,
  statistical_concept_and_methodology STRING,
  development_relevance STRING,
  related_source_links STRING,
  other_web_links STRING,
  related_indicators STRING,
  license_type STRING
)
OPTIONS(
  description=""Series Summary table""
);"

,1
table_name,country_series_definitions
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.country_series_definitions`
(
  country_code STRING,
  series_code STRING,
  description STRING
)
OPTIONS(
  description=""Country Series Definition table""
);"

,2
table_name,series_times
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.series_times`
(
  series_code STRING,
  year INT64,
  description STRING
)
OPTIONS(
  description=""Series Times table""
);"

,3
table_name,country_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.country_summary`
(
  country_code STRING,
  short_name STRING,
  table_name STRING,
  long_name STRING,
  two_alpha_code STRING,
  currency_unit STRING,
  special_notes STRING,
  region STRING,
  income_group STRING,
  wb_2_code STRING,
  national_accounts_base_year STRING,
  national_accounts_reference_year STRING,
  sna_price_valuation STRING,
  lending_category STRING,
  other_groups STRING,
  system_of_national_accounts STRING,
  alternative_conversion_factor STRING,
  ppp_survey_year STRING,
  balance_of_payments_manual_in_use STRING,
  external_debt_reporting_status STRING,
  system_of_trade STRING,
  government_accounting_concept STRING,
  imf_data_dissemination_standard STRING,
  latest_population_census STRING,
  latest_household_survey STRING,
  source_of_most_recent_Income_and_expenditure_data STRING,
  vital_registration_complete STRING,
  latest_agricultural_census STRING,
  latest_industrial_data INT64,
  latest_trade_data INT64,
  latest_water_withdrawal_data STRING
)
OPTIONS(
  description=""Country Summary table""
);"

,4
table_name,international_debt
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.international_debt`
(
  country_name STRING OPTIONS(description=""""),
  country_code STRING OPTIONS(description=""""),
  indicator_name STRING OPTIONS(description=""""),
  indicator_code STRING OPTIONS(description=""""),
  value FLOAT64 OPTIONS(description=""""),
  year INT64 OPTIONS(description="""")
);"

Database Name: bigquery-public-data
Schema Name: world_bank_intl_education
DDL describes table information.
,0
table_name,series_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_education.series_summary`
(
  series_code STRING,
  topic STRING,
  indicator_name STRING,
  short_definition STRING,
  long_definition STRING,
  unit_of_measure STRING,
  periodicity STRING,
  base_period STRING,
  other_notes STRING,
  aggregation_method STRING,
  limitations_and_exceptions STRING,
  notes_from_original_source STRING,
  general_comments STRING,
  source STRING,
  statistical_concept_and_methodology STRING,
  development_relevance STRING,
  related_source_links STRING,
  other_web_links STRING,
  related_indicators STRING,
  license_type STRING
)
OPTIONS(
  description=""Series Summary table""
);"

,1
table_name,country_series_definitions
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_education.country_series_definitions`
(
  country_code STRING,
  series_code STRING,
  description STRING
)
OPTIONS(
  description=""Country Series Definition table""
);"

,2
table_name,international_education
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_education.international_education`
(
  country_name STRING OPTIONS(description=""""),
  country_code STRING OPTIONS(description=""""),
  indicator_name STRING OPTIONS(description=""""),
  indicator_code STRING OPTIONS(description=""""),
  value FLOAT64 OPTIONS(description=""""),
  year INT64 OPTIONS(description="""")
);"

,3
table_name,country_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_education.country_summary`
(
  country_code STRING,
  short_name STRING,
  table_name STRING,
  long_name STRING,
  two_alpha_code STRING,
  currency_unit STRING,
  special_notes STRING,
  region STRING,
  income_group STRING,
  wb_two_code STRING,
  national_accounts_base_year STRING,
  national_accounts_reference_year STRING,
  sna_price_valuation STRING,
  lending_category STRING,
  other_groups STRING,
  system_of_national_accounts STRING,
  alternative_conversion_factor STRING,
  ppp_survey_year STRING,
  balance_of_payments_manual_in_use STRING,
  external_debt_reporting_status STRING,
  system_of_trade STRING,
  government_accounting_concept STRING,
  imf_data_dissemination_standard STRING,
  latest_population_census STRING,
  latest_household_survey STRING,
  source_of_most_recent_income_and_expenditure_data STRING,
  vital_registration_complete STRING,
  latest_agricultural_census STRING,
  latest_industrial_data INT64,
  latest_trade_data INT64,
  latest_water_withdrawal_data STRING
)
OPTIONS(
  description=""Country Summary table""
);"

Database Name: bigquery-public-data
Schema Name: world_bank_wdi
DDL describes table information.
,0
table_name,series_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.series_summary`
(
  series_code STRING OPTIONS(description=""A number or a sequence of related statistical units arranged or occurring in temporal spatial or other order or succession. WDI carries mostly time series.""),
  topic STRING OPTIONS(description=""The matter dealt with in the context discourse or subject related to the series.""),
  indicator_name STRING OPTIONS(description=""Given name of a series.""),
  short_definition STRING OPTIONS(description=""Short statement of the exact meaning of a series.""),
  long_definition STRING OPTIONS(description=""Extended statement of the exact meaning of a series.""),
  unit_of_measure STRING OPTIONS(description=""A quantity used as a standard of measurement. Example: Units of time are second minute hour day week month year and decade.""),
  periodicity STRING OPTIONS(description=""Applies to series recurring at regular intervals. Most of the time this term denotes that interval of recurrence.""),
  base_period STRING OPTIONS(description=""Base period is the period of time for which data is used as the base of an index number or other ratio have been collected. This period is frequently one of a year but it may be as short as one day or as long as the average of a group of years.""),
  other_notes STRING OPTIONS(description=""A brief record of facts topics or thoughts written down and used to contextualize the series definition values and other characteristics.""),
  aggregation_method STRING OPTIONS(description=""Aggregation methods are types of calculations used to group attribute values into a metric for each dimension value. For example for each region one may retrieve the total value of country entries (the sum of the series value for countries belonging to the region).""),
  limitations_and_exceptions STRING OPTIONS(description=""A limiting rule or circumstance that applies to usage of the series such as the scope of the survey collecting the data or missing years and countries.  It should also note when data are imputed or estimated""),
  notes_from_original_source STRING OPTIONS(description=""A brief record of facts topics or thoughts written down and used to contextualize the series definition values and other characteristics.""),
  general_comments STRING OPTIONS(description=""Other notes regarding the series which do not appear in Development relevance or Limitations or exceptions""),
  source STRING OPTIONS(description=""A place person or organization from which the series comes or can be obtained.""),
  statistical_concept_and_methodology STRING OPTIONS(description=""The abstract idea general statistical notions or a system of methods used to generate the series.""),
  development_relevance STRING OPTIONS(description=""The relevance of a series refers to how the indicator’s data may be used to monitor particular aspects of development goals and programs for example the Sustainable Development Goals. The indicator may conclusively measure progress towards a particular objective or may act as a proxy or interpretation of a development aim.""),
  related_source_links STRING OPTIONS(description=""Internet address of related source page tool or knowledge base.""),
  other_web_links STRING OPTIONS(description=""Internet addresses of related pages tools or knowledge bases.""),
  related_indicators STRING OPTIONS(description=""In general indicator that are of interest and related to the specific series.""),
  license_type STRING OPTIONS(description=""Explains the rights conferred and restrictions imposed by the owner to the users of a series"")
);"

,1
table_name,country_series_definitions
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.country_series_definitions`
(
  country_code STRING OPTIONS(description=""""),
  series_code STRING OPTIONS(description=""""),
  description STRING OPTIONS(description="""")
);"

,2
table_name,footnotes
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.footnotes`
(
  country_code STRING OPTIONS(description=""""),
  series_code STRING OPTIONS(description=""""),
  year STRING OPTIONS(description=""""),
  description STRING OPTIONS(description="""")
);"

,3
table_name,series_time
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.series_time`
(
  series_code STRING OPTIONS(description=""""),
  year INT64 OPTIONS(description=""""),
  description STRING OPTIONS(description="""")
);"

,4
table_name,indicators_data
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.indicators_data`
(
  country_name STRING OPTIONS(description=""""),
  country_code STRING OPTIONS(description=""""),
  indicator_name STRING OPTIONS(description=""""),
  indicator_code STRING OPTIONS(description=""""),
  value FLOAT64 OPTIONS(description=""""),
  year INT64 OPTIONS(description="""")
);"

,5
table_name,country_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.country_summary`
(
  country_code STRING OPTIONS(description=""A short alphabetic or numeric geographical code representing a specific country or area. In April 2016 WDI has adopted the three digit ISO code to identify countries in its databases.""),
  short_name STRING OPTIONS(description=""Country name the country's official name as approved by the relevant body (Italy is used as an example): conventional short form (Italy).""),
  table_name STRING OPTIONS(description=""Country name the country's name as approved by the relevant body (Italy is used as an example): conventional short form (Republic of Italy).""),
  long_name STRING OPTIONS(description=""Country name the country's name as approved by the relevant body (Italy is used as an example): conventional long form (Republic of Italy).""),
  two_alpha_code STRING OPTIONS(description=""ISO-2 digit alpha code value of the country. Re: www.iso.org""),
  currency_unit STRING OPTIONS(description=""Currency unit (such as the dollar euro peso rupee) issued as a coin or banknote a standard unit of value and a unit of account.""),
  special_notes STRING OPTIONS(description=""Country special notes for data and metadata users.""),
  region STRING OPTIONS(description=""World Bank region to which a country belongs.""),
  income_group STRING OPTIONS(description=""World Bank income group to which a country belongs after the country classification is completed every year.""),
  wb_2_code STRING OPTIONS(description=""World Bank 2 digit code value of the country.""),
  national_accounts_base_year STRING OPTIONS(description=""Base year is the base or pricing period used for constant price calculations in the country’s national accounts. Price indexes derived from national accounts aggregates such as the implicit deflator for gross domestic product (GDP) express the price level relative to base year prices.""),
  national_accounts_reference_year STRING OPTIONS(description=""Reference year is the year in which the local currency constant price series of a country is valued. The reference year is usually the same as the base year used to report the constant price series. However when the constant price data are chain linked the base year is changed annually so the data are rescaled to a specific reference year to provide a consistent time series. When the country has not rescaled following a change in base year World Bank staff rescale the data to maintain a longer historical series. To allow for cross-country comparison and data aggregation constant price data reported in World Development Indicators are rescaled to a common reference year (2010) and currency (U.S. dollars).""),
  sna_price_valuation STRING OPTIONS(description=""SNA price valuation shows whether value added in the national accounts is reported at basic prices (B) or producer prices (P). Producer prices include taxes paid by producers and thus tend to overstate the actual value added in production. However value added can be higher at basic prices than at producer prices in countries with high agricultural subsidies.""),
  lending_category STRING OPTIONS(description=""World Bank lending category to which a country belongs after the operational guidelines are completed every year.""),
  other_groups STRING OPTIONS(description=""Other types of grouping approved by the WDI team.""),
  system_of_national_accounts STRING OPTIONS(description=""System of National Accounts identifies whether a country uses the 1968 1993 or 2008 System of National Accounts (SNA). The 2008 SNA is an update of the 1993 SNA and retains its basic theoretical framework.""),
  alternative_conversion_factor STRING OPTIONS(description=""Alternative conversion factor identifies the countries and years for which a World Bank–estimated conversion factor has been used in place of the official exchange rate (line rf in the International Monetary Fund’s [IMF] International Financial Statistics). See later in Sources and methods for further discussion of alternative conversion factors.""),
  ppp_survey_year STRING OPTIONS(description=""Purchasing power parity (PPP) survey year is the latest available survey year for the International Comparison Program’s estimates of PPPs.""),
  balance_of_payments_manual_in_use STRING OPTIONS(description=""Balance of Payments Manual in use refers to the classification system used to compile and report data on balance of payments. 6 refers to the 6th edition of the IMF’s Balance of Payments Manual (2009).""),
  external_debt_reporting_status STRING OPTIONS(description=""External debt shows debt reporting status for 2016 data. A indicates that data are as reported P that data are based on reported or collected information but include an element of staff estimation and E that data are World Bank staff estimates.""),
  system_of_trade STRING OPTIONS(description=""System of trade refers to the United Nations general trade system (G) or special trade system (S). Under the general trade system goods entering directly for domestic consumption and goods entered into customs storage are recorded as imports at arrival. Under the special trade system goods are recorded as imports when declared for domestic consumption whether at time of entry or on withdrawal from customs storage.""),
  government_accounting_concept STRING OPTIONS(description=""Government finance accounting concept is the accounting basis for reporting central government financial data. For most countries government finance data have been consolidated (C) into one set of accounts capturing all central government fiscal activities. Budgetary central government accounts (B) exclude some central government units.""),
  imf_data_dissemination_standard STRING OPTIONS(description=""IMF data dissemination standard shows the countries that subscribe to the IMF’s Special Data Dissemination Standard (S) or Enhanced General Data Dissemination System (e-GDDS). S refers to countries that subscribe to the SDDS and have posted data on the Dissemination Standards Bulletin Board at http://dsbb.imf.org. S+ countries must observe additional coverage periodicity and timeliness requirements. e-G refers to countries that subscribe to the e-GDDS.""),
  latest_population_census STRING OPTIONS(description=""Latest population census shows the most recent year in which a census was conducted and in which at least preliminary results have been released. The preliminary results from the very recent censuses could be reflected in timely revisions if basic data are available such as population by age and sex as well as the detailed definition of counting coverage and completeness.""),
  latest_household_survey STRING OPTIONS(description=""Latest demographic education or health household survey indicates the household surveys used to compile the demographic education and health data. Detailed information on each survey is provided through the following links:  AIDS Indicator Survey Demographic and Health Survey Health Issues Survey and Malaria Indicator Survey - www.dhsprogram.com; Living Standards Measurement Study -  www.worldbank.org/lsms; Multiple Indicator Cluster Survey - http://mics.unicef.org; Reproductive Health Survey -  www.cdc.gov/reproductivehealth; World Health Survey is available at - www.who.int/healthinfo/survey/en.""),
  source_of_most_recent_income_and_expenditure_data STRING OPTIONS(description=""Source of most recent income and expenditure data shows household surveys that collect income and expenditure data. Names and detailed information on household surveys can be found on the website of the International Household Survey Network (www.surveynetwork.org). Core Welfare Indicator Questionnaire Surveys (CWIQ) developed by the World Bank measure changes in key social indicators for different population groups—specifically indicators of access utilization and satisfaction with core social and economic services. Expenditure survey/budget surveys (ES/BS) collect detailed information on household consumption as well as on general demographic social and economic characteristics. Integrated household surveys (IHS) collect detailed information on a wide variety of topics including health education economic activities housing and utilities.""),
  vital_registration_complete STRING OPTIONS(description=""Vital registration complete identifies countries that report at least 90 percent complete registries of vital (birth and death) statistics to the United Nations Statistics Division and are reported in its Population and Vital Statistics Reports. Countries with complete vital statistics registries may have more accurate and more timely demographic indicators than other countries.""),
  latest_agricultural_census STRING OPTIONS(description=""Latest agricultural census shows the most recent year in which an agricultural census was conducted or planned to be conducted as reported to the Food and Agriculture Organization.""),
  latest_industrial_data STRING OPTIONS(description=""Latest industrial data show the most recent year for which manufacturing value added data at the three-digit level of the International Standard Industrial Classification (revision 2 or 3) are available in the United Nations Industrial Development Organization database.""),
  latest_trade_data STRING OPTIONS(description=""Latest trade data show the most recent year for which structure of merchandise trade data from the United Nations Statistics Division’s Commodity Trade (Comtrade) database are available."")
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'world_bank_global_population': ['population_by_country'], 'world_bank_health_population': ['country_series_definitions', 'country_summary', 'health_nutrition_population', 'series_summary', 'series_times'], 'world_bank_intl_debt': ['country_series_definitions', 'country_summary', 'international_debt', 'series_summary', 'series_times'], 'world_bank_intl_education': ['country_series_definitions', 'country_summary', 'international_education', 'series_summary'], 'world_bank_wdi': ['country_series_definitions', 'country_summary', 'footnotes', 'indicators_data', 'series_summary', 'series_time']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **Table:** `bigquery-public-data.world_bank_wdi.indicators_data`
   - **`indicator_name`**: Used to identify the GDP (constant 2015 US$) indicator.
   - **`indicator_code`**: Code corresponding to each indicator; helpful for precise filtering.
   - **`country_code`**: Country code to link with country details.
   - **`country_name`**: Name of the country.
   - **`value`**: The GDP value for each country and year.
   - **`year`**: The year of the GDP data.

2. **Table:** `bigquery-public-data.world_bank_wdi.country_summary`
   - **`country_code`**: To join with `indicators_data` on `country_code`.
   - **`region`**: Provides the region for each country; essential for grouping.
   - **`short_name`**: Short name of the country.

**Conditions that may be used:**

- Filter `indicator_name` or `indicator_code` to select "GDP (constant 2015 US$)".
- Use `year` to select the latest or specific year of interest (e.g., 2019).
- Join `indicators_data` and `country_summary` on `country_code` to associate GDP values with regions.

---

**SQL Queries:**

1. **List distinct indicator names containing 'GDP':**
   ```sql
   SELECT DISTINCT indicator_name
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE LOWER(indicator_name) LIKE '%gdp%'
   LIMIT 1000;
   ```

2. **Find the indicator code for 'GDP (constant 2015 US$)':**
   ```sql
   SELECT DISTINCT indicator_code
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE indicator_name = 'GDP (constant 2015 US$)'
   LIMIT 1000;
   ```

3. **Retrieve all country codes and names:**
   ```sql
   SELECT DISTINCT country_code, country_name
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   LIMIT 1000;
   ```

4. **Get the list of regions and their countries:**
   ```sql
   SELECT country_code, short_name AS country_name, region
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   LIMIT 1000;
   ```

5. **List all available years for the GDP indicator:**
   ```sql
   SELECT DISTINCT year
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE indicator_name = 'GDP (constant 2015 US$)'
   ORDER BY year DESC
   LIMIT 1000;
   ```

6. **Retrieve GDP values for all countries in the latest year (e.g., 2019):**
   ```sql
   SELECT country_code, country_name, value AS gdp
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE indicator_name = 'GDP (constant 2015 US$)' AND year = 2019
   LIMIT 1000;
   ```

7. **Find regions with the number of countries in each:**
   ```sql
   SELECT region, COUNT(*) AS country_count
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   GROUP BY region
   LIMIT 1000;
   ```

8. **Retrieve GDP data along with region information:**
   ```sql
   SELECT id.country_code, id.country_name, cs.region, id.value AS gdp, id.year
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
   ON id.country_code = cs.country_code
   WHERE indicator_name = 'GDP (constant 2015 US$)'
   LIMIT 1000;
   ```

9. **List GDP values for countries in a specific region (e.g., 'Europe & Central Asia') for 2019:**
   ```sql
   SELECT id.country_code, id.country_name, id.value AS gdp
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
   ON id.country_code = cs.country_code
   WHERE indicator_name = 'GDP (constant 2015 US$)' AND year = 2019 AND cs.region = 'Europe & Central Asia'
   LIMIT 1000;
   ```

10. **Identify countries with missing GDP data in 2019:**
    ```sql
    SELECT id.country_code, id.country_name
    FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
    WHERE indicator_name = 'GDP (constant 2015 US$)' AND year = 2019 AND id.value IS NULL
    LIMIT 1000;
    ```

11. **Get the top 10 countries by GDP in 2019:**
    ```sql
    SELECT country_code, country_name, value AS gdp
    FROM `bigquery-public-data.world_bank_wdi.indicators_data`
    WHERE indicator_name = 'GDP (constant 2015 US$)' AND year = 2019
    ORDER BY gdp DESC
    LIMIT 10;
    ```

12. **Retrieve GDP trends for a specific country over the years (e.g., 'United States'):**
    ```sql
    SELECT year, value AS gdp
    FROM `bigquery-public-data.world_bank_wdi.indicators_data`
    WHERE indicator_name = 'GDP (constant 2015 US$)' AND country_name = 'United States'
    ORDER BY year ASC
    LIMIT 1000;
    ```

13. **List all regions available in the dataset:**
    ```sql
    SELECT DISTINCT region
    FROM `bigquery-public-data.world_bank_wdi.country_summary`
    LIMIT 1000;
    ```

14. **Find the average GDP of countries in each region for 2019:**
    ```sql
    SELECT cs.region, AVG(id.value) AS average_gdp
    FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
    JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
    ON id.country_code = cs.country_code
    WHERE indicator_name = 'GDP (constant 2015 US$)' AND year = 2019
    GROUP BY cs.region
    LIMIT 1000;
    ```

15. **Get GDP data for countries with GDP greater than 1 trillion USD in 2019:**
    ```sql
    SELECT country_code, country_name, value AS gdp
    FROM `bigquery-public-data.world_bank_wdi.indicators_data`
    WHERE indicator_name = 'GDP (constant 2015 US$)' AND year = 2019 AND value > 1000000000000
    LIMIT 1000;
    ```

16. **List countries and their regions where GDP data is available for 2019:**
    ```sql
    SELECT id.country_code, id.country_name, cs.region
    FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
    JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
    ON id.country_code = cs.country_code
    WHERE indicator_name = 'GDP (constant 2015 US$)' AND year = 2019
    LIMIT 1000;
    ```

17. **Find the minimum and maximum GDP values in each region for 2019:**
    ```sql
    SELECT cs.region, MIN(id.value) AS min_gdp, MAX(id.value) AS max_gdp
    FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
    JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
    ON id.country_code = cs.country_code
    WHERE indicator_name = 'GDP (constant 2015 US$)' AND year = 2019
    GROUP BY cs.region
    LIMIT 1000;
    ```

18. **Get the number of countries with GDP data available for each region in 2019:**
    ```sql
    SELECT cs.region, COUNT(id.country_code) AS countries_with_gdp
    FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
    JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
    ON id.country_code = cs.country_code
    WHERE indicator_name = 'GDP (constant 2015 US$)' AND year = 2019 AND id.value IS NOT NULL
    GROUP BY cs.region
    LIMIT 1000;
    ```

19. **List GDP data for small economies (GDP less than 10 billion USD) in 2019:**
    ```sql
    SELECT country_code, country_name, value AS gdp
    FROM `bigquery-public-data.world_bank_wdi.indicators_data`
    WHERE indicator_name = 'GDP (constant 2015 US$)' AND year = 2019 AND value < 10000000000
    LIMIT 1000;
    ```

20. **Retrieve the latest available GDP data for each country:**
    ```sql
    SELECT id.country_code, id.country_name, MAX(id.year) AS latest_year, id.value AS gdp
    FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
    WHERE indicator_name = 'GDP (constant 2015 US$)'
    GROUP BY id.country_code, id.country_name, id.value
    LIMIT 1000;
    ```

These queries help in exploring the dataset to understand how GDP values are distributed across countries and regions, which is essential for determining which region has the highest median GDP (constant 2015 US$) value.Query:
SELECT DISTINCT indicator_name
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE LOWER(indicator_name) LIKE '%gdp%'
   LIMIT 1000;
Answer:
indicator_name
"Personal remittances, received (% of GDP)"
Price level ratio of PPP conversion factor (GDP) to market exchange rate
Trade (% of GDP)
CO2 emissions (kg per 2015 US$ of GDP)
Coal rents (% of GDP)
Current account balance (% of GDP)
Discrepancy in expenditure estimate of GDP (current LCU)
Domestic credit to private sector by banks (% of GDP)
Domestic general government health expenditure (% of GDP)
External balance on goods and services (% of GDP)
Final consumption expenditure (% of GDP)
Forest rents (% of GDP)
GDP (constant LCU)
GDP (current LCU)
GDP per capita (current LCU)
GDP per capita growth (annual %)
General government final consumption expenditure (% of GDP)
"Industry (including construction), value added (% of GDP)"
Merchandise trade (% of GDP)
Military expenditure (% of GDP)
Oil rents (% of GDP)
Broad money (% of GDP)
"Claims on central government, etc. (% GDP)"
GDP (current US$)
GDP growth (annual %)
"GDP, PPP (current international $)"
"Manufacturing, value added (% of GDP)"
Market capitalization of listed domestic companies (% of GDP)
Monetary Sector credit to private sector (% GDP)
Natural gas rents (% of GDP)
"PPP conversion factor, GDP (LCU per international $)"
"Revenue, excluding grants (% of GDP)"
Trade in services (% of GDP)
GDP (constant 2015 US$)
GDP deflator: linked series (base year varies by country)
GDP per capita (constant 2015 US$)
Domestic credit to private sector (% of GDP)
Exports of goods and services (% of GDP)
"Foreign direct investment, net outflows (% of GDP)"
GDP deflator (base year varies by country)
GDP per capita (constant LCU)
"Government expenditure per student, secondary (% of GDP per capita)"
Gross capital formation (% of GDP)
Imports of goods and services (% of GDP)
"Inflation, GDP deflator (annual %)"
Net acquisition of financial assets (% of GDP)
"Services, value added (% of GDP)"
Discrepancy in expenditure estimate of GDP (constant LCU)
"Foreign direct investment, net inflows (% of GDP)"
"GDP per capita, PPP (current international $)"
GDP per person employed (constant 2017 PPP $)
GDP per unit of energy use (constant 2017 PPP $ per kg of oil equivalent)
GDP per unit of energy use (PPP $ per kg of oil equivalent)
Gross fixed capital formation (% of GDP)
Gross savings (% of GDP)
"Net incurrence of liabilities, total (% of GDP)"
Tax revenue (% of GDP)
Total natural resources rents (% of GDP)
GDP per capita (current US$)
Gross national expenditure (% of GDP)
Mineral rents (% of GDP)
"Agriculture, forestry, and fishing, value added (% of GDP)"
CO2 emissions (kg per PPP $ of GDP)
Expense (% of GDP)
"Government expenditure per student, tertiary (% of GDP per capita)"
Households and NPISHs final consumption expenditure (% of GDP)
Claims on other sectors of the domestic economy (% of GDP)
Current health expenditure (% of GDP)
Domestic credit provided by financial sector (% of GDP)
"Energy use (kg of oil equivalent) per $1,000 GDP (constant 2017 PPP)"
Gross domestic savings (% of GDP)
"Gross fixed capital formation, private sector (% of GDP)"
"GDP, PPP (constant 2017 international $)"
"Inflation, GDP deflator: linked series (annual %)"
"Stocks traded, total value (% of GDP)"
Net lending (+) / net borrowing (-) (% of GDP)
CO2 emissions (kg per 2017 PPP $ of GDP)
Energy intensity level of primary energy (MJ/$2011 PPP GDP)
GDP: linked series (current LCU)
"Government expenditure on education, total (% of GDP)"
Query:
SELECT DISTINCT indicator_code
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE indicator_name = 'GDP (constant 2015 US$)'
   LIMIT 1000;
Answer:
indicator_code
NY.GDP.MKTP.KD
Query:
SELECT DISTINCT country_code, country_name
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   LIMIT 1000;
Answer:
country_code,country_name
MOZ,Mozambique
MMR,Myanmar
NAM,Namibia
NRU,Nauru
NPL,Nepal
NLD,Netherlands
NCL,New Caledonia
NZL,New Zealand
NIC,Nicaragua
NER,Niger
NGA,Nigeria
VGB,British Virgin Islands
BRN,Brunei Darussalam
BGR,Bulgaria
BFA,Burkina Faso
BDI,Burundi
CPV,Cabo Verde
KHM,Cambodia
CAN,Canada
LCN,Latin America & Caribbean
LAC,Latin America & Caribbean (excluding high income)
TLA,Latin America & the Caribbean (IDA & IBRD countries)
LDC,Least developed countries: UN classification
LMY,Low & middle income
LIC,Low income
LMC,Lower middle income
MEA,Middle East & North Africa
MNA,Middle East & North Africa (excluding high income)
CZE,Czech Republic
DNK,Denmark
DJI,Djibouti
DMA,Dominica
GNQ,Equatorial Guinea
KWT,Kuwait
KGZ,Kyrgyz Republic
LAO,Lao PDR
LVA,Latvia
LBN,Lebanon
LSO,Lesotho
LBR,Liberia
LBY,Libya
LIE,Liechtenstein
LTU,Lithuania
LUX,Luxembourg
MAC,"Macao SAR, China"
AFE,Africa Eastern and Southern
AFW,Africa Western and Central
ARB,Arab World
CSS,Caribbean small states
CEB,Central Europe and the Baltics
EAR,Early-demographic dividend
EAS,East Asia & Pacific
EAP,East Asia & Pacific (excluding high income)
TEA,East Asia & Pacific (IDA & IBRD countries)
RUS,Russian Federation
RWA,Rwanda
WSM,Samoa
SMR,San Marino
STP,Sao Tome and Principe
SAU,Saudi Arabia
SRB,Serbia
SYC,Seychelles
SLE,Sierra Leone
SGP,Singapore
MKD,North Macedonia
MNP,Northern Mariana Islands
NOR,Norway
OMN,Oman
PLW,Palau
PNG,Papua New Guinea
CYM,Cayman Islands
CAF,Central African Republic
TCD,Chad
CHI,Channel Islands
CHN,China
COM,Comoros
COD,"Congo, Dem. Rep."
UMC,Upper middle income
WLD,World
AFG,Afghanistan
ALB,Albania
DZA,Algeria
ASM,American Samoa
AND,Andorra
AGO,Angola
ATG,Antigua and Barbuda
ARM,Armenia
ABW,Aruba
Query:
SELECT country_code, short_name AS country_name, region
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   LIMIT 1000;
Answer:
country_code,country_name,region
AFE,Africa Eastern and Southern,
AFW,Africa Western and Central,
ARB,Arab World,
CEB,Central Europe and the Baltics,
CSS,Caribbean small states,
EAP,East Asia & Pacific (excluding high income),
EAR,Early-demographic dividend,
EAS,East Asia & Pacific,
ECA,Europe & Central Asia (excluding high income),
ECS,Europe & Central Asia,
EUU,European Union,
FCS,Fragile and conflict affected situations,
HIC,High income,
HPC,Heavily indebted poor countries (HIPC),
IBD,IBRD only,
IBT,IDA & IBRD total,
IDA,IDA total,
IDB,IDA blend,
IDX,IDA only,
LAC,Latin America & Caribbean (excluding high income),
LCN,Latin America & Caribbean,
LDC,Least developed countries: UN classification,
LIC,Low income,
LMC,Lower middle income,
LMY,Low & middle income,
LTE,Late-demographic dividend,
MEA,Middle East & North Africa,
MIC,Middle income,
MNA,Middle East & North Africa (excluding high income),
NAC,North America,
OED,OECD members,
OSS,Other small states,
PRE,Pre-demographic dividend,
PSS,Pacific island small states,
PST,Post-demographic dividend,
SAS,South Asia,
SSA,Sub-Saharan Africa (excluding high income),
SSF,Sub-Saharan Africa,
SST,Small states,
TEA,East Asia & Pacific (IDA & IBRD),
TEC,Europe & Central Asia (IDA & IBRD),
TLA,Latin America & Caribbean (IDA & IBRD),
TMN,Middle East & North Africa (IDA & IBRD),
TSA,South Asia (IDA & IBRD),
TSS,Sub-Saharan Africa (IDA & IBRD),
UMC,Upper middle income,
WLD,World,
AND,Andorra,Europe & Central Asia
BMU,Bermuda,North America
CHI,Channel Islands,Europe & Central Asia
CUW,Curaçao,Latin America & Caribbean
CYM,Cayman Islands,Latin America & Caribbean
FRO,Faroe Islands,Europe & Central Asia
GIB,Gibraltar,Europe & Central Asia
GRL,Greenland,Europe & Central Asia
GUM,Guam,East Asia & Pacific
IMN,Isle of Man,Europe & Central Asia
LIE,Liechtenstein,Europe & Central Asia
MAF,St. Martin (French part),Latin America & Caribbean
MCO,Monaco,Europe & Central Asia
Query:
SELECT DISTINCT year
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE indicator_name = 'GDP (constant 2015 US$)'
   ORDER BY year DESC
   LIMIT 1000;
Answer:
year
2020
2019
2018
2017
2016
2015
2014
2013
2012
2011
2010
2009
2008
2007
2006
2005
2004
2003
2002
2001
2000
1999
1998
1997
1996
1995
1994
1993
1992
1991
1990
1989
1988
1987
1986
1985
1984
1983
1982
1981
1980
1979
1978
1977
1976
1975
1974
1973
1972
1971
1970
1969
1968
1967
1966
1965
1964
1963
1962
1961
1960
Query:
SELECT country_code, country_name, value AS gdp
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE indicator_name = 'GDP (constant 2015 US$)' AND year = 2019
   LIMIT 1000;
Answer:
country_code,country_name,gdp
GAB,Gabon,15460241608.8257
NAM,Namibia,11240759011.0283
AGO,Angola,110072586683.261
SDN,Sudan,51312429477.3951
MNA,Middle East & North Africa (excluding high income),1538200834048.04
AFE,Africa Eastern and Southern,1006679813065.29
TON,Tonga,486181549.588749
TKM,Turkmenistan,45710025776.6731
EAR,Early-demographic dividend,11703037495097.2
QAT,Qatar,167371229308.42
TEC,Europe & Central Asia (IDA & IBRD countries),4095463099662.97
AUT,Austria,414257026093.423
NGA,Nigeria,502942019447.736
DEU,Germany,3598891541091.34
MOZ,Mozambique,18183590595.087
LAO,Lao PDR,18491845636.2733
MLT,Malta,13856372628.2222
WSM,Samoa,887495263.360233
HPC,Heavily indebted poor countries (HIPC),788661392496.297
MDG,Madagascar,13186360351.4331
SVN,Slovenia,50249892617.4104
KAZ,Kazakhstan,211106972039.014
PRT,Portugal,222272974069.03
GBR,United Kingdom,3191493407624.4
NAC,North America,21677548659072.5
ARB,Arab World,2681441590769.14
OMN,Oman,83053174485.8283
TSS,Sub-Saharan Africa (IDA & IBRD countries),1834643244102.56
LAC,Latin America & Caribbean (excluding high income),4853709324043.9
ETH,Ethiopia,89640020508.4013
CZE,Czech Republic,215594735504.853
TCA,Turks and Caicos Islands,1095902844.26329
GIN,Guinea,12078653011.9638
BLZ,Belize,1835056955.71673
KWT,Kuwait,114249382864.585
MMR,Myanmar,83686992015.6706
LVA,Latvia,30716038078.95
AZE,Azerbaijan,53612524527.3911
URY,Uruguay,55513344382.0673
LUX,Luxembourg,67286460381.3888
CSS,Caribbean small states,74283427277.9706
GRC,Greece,203669187367.386
KHM,Cambodia,23760061873.2798
TEA,East Asia & Pacific (IDA & IBRD countries),16995303639412.5
FIN,Finland,254637296103.695
LIC,Low income,476617321590.818
DJI,Djibouti,3191833262.48686
LTU,Lithuania,48155059559.2863
HRV,Croatia,57190160216.5408
SAS,South Asia,3431466032627.32
TSA,South Asia (IDA & IBRD),3431466032627.32
GNB,Guinea-Bissau,1248729327.89726
ALB,Albania,12970913827.5704
MCO,Monaco,7080667991.59357
COG,"Congo, Rep.",9643515879.79193
GEO,Georgia,17757903230.0709
MNG,Mongolia,14174566299.8985
MNE,Montenegro,4777636043.80572
EST,Estonia,27068147756.8566
ECA,Europe & Central Asia (excluding high income),3468157804813.19
TTO,Trinidad and Tobago,22587789317.2434
ISR,Israel,353062816517.302
Query:
SELECT region, COUNT(*) AS country_count
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   GROUP BY region
   LIMIT 1000;
Answer:
region,country_count
,48
Europe & Central Asia,58
North America,3
Latin America & Caribbean,42
East Asia & Pacific,37
Sub-Saharan Africa,48
Middle East & North Africa,21
South Asia,8
Query:
SELECT id.country_code, id.country_name, cs.region, id.value AS gdp, id.year
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
   ON id.country_code = cs.country_code
   WHERE indicator_name = 'GDP (constant 2015 US$)'
   LIMIT 1000;
Answer:
country_code,country_name,region,gdp,year
NRU,Nauru,East Asia & Pacific,65927361.0434273,2013
NZL,New Zealand,East Asia & Pacific,108891705224.987,1997
NIC,Nicaragua,Latin America & Caribbean,3939117486.81316,1963
NIC,Nicaragua,Latin America & Caribbean,7456675372.13516,1974
NIC,Nicaragua,Latin America & Caribbean,13487252998.9628,2018
NER,Niger,Sub-Saharan Africa,3876950075.132,1980
NER,Niger,Sub-Saharan Africa,9683867893.68343,2015
CPV,Cabo Verde,Sub-Saharan Africa,218190594.824461,1984
CPV,Cabo Verde,Sub-Saharan Africa,947482014.985927,2003
CPV,Cabo Verde,Sub-Saharan Africa,1671942379.49743,2016
LAC,Latin America & Caribbean (excluding high income),,995869499214.758,1969
LAC,Latin America & Caribbean (excluding high income),,3964059386067.38,2008
TLA,Latin America & the Caribbean (IDA & IBRD countries),,1162822337717.13,1970
LMY,Low & middle income,,8662109953755.54,1994
LIC,Low income,,227952991433.546,1999
GNQ,Equatorial Guinea,Sub-Saharan Africa,12012844403.0027,2007
KGZ,Kyrgyz Republic,Europe & Central Asia,3518703669.32844,2000
KGZ,Kyrgyz Republic,Europe & Central Asia,5577000617.04261,2011
LAO,Lao PDR,East Asia & Pacific,3012256767.69759,1992
LBN,Lebanon,Middle East & North Africa,49776391957.7016,2014
LSO,Lesotho,Sub-Saharan Africa,651827763.249178,1981
LBR,Liberia,Sub-Saharan Africa,2360440981.31983,2002
LBR,Liberia,Sub-Saharan Africa,3254893758.73415,2017
LBY,Libya,Middle East & North Africa,40560602832.7856,2004
AFE,Africa Eastern and Southern,,442342732156.009,1996
ARB,Arab World,,2077172086641.65,2010
CSS,Caribbean small states,,59293536367.7269,2003
EAR,Early-demographic dividend,,1277296043414.66,1964
EAS,East Asia & Pacific,,1616709469640.92,1965
TEA,East Asia & Pacific (IDA & IBRD countries),,3531793950846.35,1999
TEA,East Asia & Pacific (IDA & IBRD countries),,12433240724383.0,2014
RUS,Russian Federation,Europe & Central Asia,1416124431328.3,2020
WSM,Samoa,East Asia & Pacific,448576508.285271,1990
STP,Sao Tome and Principe,Sub-Saharan Africa,341901474.463989,2017
SAU,Saudi Arabia,Middle East & North Africa,334230179965.594,1993
SYC,Seychelles,Sub-Saharan Africa,1184796354.18336,2012
NGA,Nigeria,Sub-Saharan Africa,76930009900.9302,1964
MKD,North Macedonia,Europe & Central Asia,7334617663.50844,2005
MKD,North Macedonia,Europe & Central Asia,10064515432.0265,2015
NOR,Norway,Europe & Central Asia,81598233089.8432,1964
Query:
SELECT id.country_code, id.country_name, id.value AS gdp
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
   ON id.country_code = cs.country_code
   WHERE indicator_name = 'GDP (constant 2015 US$)' AND year = 2019 AND cs.region = 'Europe & Central Asia'
   LIMIT 1000;
Answer:
country_code,country_name,gdp
TKM,Turkmenistan,45710025776.6731
AUT,Austria,414257026093.423
DEU,Germany,3598891541091.34
SVN,Slovenia,50249892617.4104
KAZ,Kazakhstan,211106972039.014
PRT,Portugal,222272974069.03
GBR,United Kingdom,3191493407624.4
CZE,Czech Republic,215594735504.853
LVA,Latvia,30716038078.95
AZE,Azerbaijan,53612524527.3911
LUX,Luxembourg,67286460381.3888
GRC,Greece,203669187367.386
FIN,Finland,254637296103.695
LTU,Lithuania,48155059559.2863
HRV,Croatia,57190160216.5408
ALB,Albania,12970913827.5704
MCO,Monaco,7080667991.59357
GEO,Georgia,17757903230.0709
MNE,Montenegro,4777636043.80572
EST,Estonia,27068147756.8566
UKR,Ukraine,101944109453.562
SMR,San Marino,1514041111.68851
POL,Poland,570115134633.24
ITA,Italy,1915994931005.09
ROU,Romania,217382984916.126
BLR,Belarus,59013474192.6442
MDA,Moldova,9155458065.71175
ESP,Spain,1324028319783.9
XKX,Kosovo,7547420630.10043
NLD,Netherlands,839912581383.842
TUR,Turkey,997437115405.82
TJK,Tajikistan,10943735892.3235
GRL,Greenland,2710570656.36234
CYP,Cyprus,24880804888.1512
NOR,Norway,406468037614.963
BGR,Bulgaria,57443866470.1882
ARM,Armenia,12867495686.1153
BIH,Bosnia and Herzegovina,18413845946.1771
ISL,Iceland,20847341424.8856
SRB,Serbia,45615675379.6018
UZB,Uzbekistan,106161435002.412
DNK,Denmark,334638192450.446
BEL,Belgium,494644115983.888
HUN,Hungary,146968695014.007
RUS,Russian Federation,1459189098326.43
SVK,Slovak Republic,99048285215.7697
KGZ,Kyrgyz Republic,7920624102.90056
CHE,Switzerland,758167874591.909
MKD,North Macedonia,11185489898.549
FRA,France,2615760319962.67
IRL,Ireland,370632118369.555
IMN,Isle of Man,8129451489.68678
AND,Andorra,3008955096.59511
SWE,Sweden,549821281946.735
Query:
SELECT id.country_code, id.country_name, id.value AS gdp
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
ON id.country_code = cs.country_code
WHERE id.indicator_code = 'NY.GDP.MKTP.KD' AND id.year = 2019 AND cs.region = 'Europe & Central Asia'
LIMIT 1000;
Answer:
country_code,country_name,gdp
TKM,Turkmenistan,45710025776.6731
AUT,Austria,414257026093.423
DEU,Germany,3598891541091.34
SVN,Slovenia,50249892617.4104
KAZ,Kazakhstan,211106972039.014
PRT,Portugal,222272974069.03
GBR,United Kingdom,3191493407624.4
CZE,Czech Republic,215594735504.853
LVA,Latvia,30716038078.95
AZE,Azerbaijan,53612524527.3911
LUX,Luxembourg,67286460381.3888
GRC,Greece,203669187367.386
FIN,Finland,254637296103.695
LTU,Lithuania,48155059559.2863
HRV,Croatia,57190160216.5408
ALB,Albania,12970913827.5704
MCO,Monaco,7080667991.59357
GEO,Georgia,17757903230.0709
MNE,Montenegro,4777636043.80572
EST,Estonia,27068147756.8566
UKR,Ukraine,101944109453.562
SMR,San Marino,1514041111.68851
POL,Poland,570115134633.24
ITA,Italy,1915994931005.09
ROU,Romania,217382984916.126
BLR,Belarus,59013474192.6442
MDA,Moldova,9155458065.71175
ESP,Spain,1324028319783.9
XKX,Kosovo,7547420630.10043
NLD,Netherlands,839912581383.842
TUR,Turkey,997437115405.82
TJK,Tajikistan,10943735892.3235
GRL,Greenland,2710570656.36234
CYP,Cyprus,24880804888.1512
NOR,Norway,406468037614.963
BGR,Bulgaria,57443866470.1882
ARM,Armenia,12867495686.1153
BIH,Bosnia and Herzegovina,18413845946.1771
ISL,Iceland,20847341424.8856
SRB,Serbia,45615675379.6018
UZB,Uzbekistan,106161435002.412
DNK,Denmark,334638192450.446
BEL,Belgium,494644115983.888
HUN,Hungary,146968695014.007
RUS,Russian Federation,1459189098326.43
SVK,Slovak Republic,99048285215.7697
KGZ,Kyrgyz Republic,7920624102.90056
CHE,Switzerland,758167874591.909
MKD,North Macedonia,11185489898.549
FRA,France,2615760319962.67
IRL,Ireland,370632118369.555
IMN,Isle of Man,8129451489.68678
AND,Andorra,3008955096.59511
SWE,Sweden,549821281946.735
Query:
SELECT country_code, country_name, value AS gdp
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE indicator_code = 'NY.GDP.MKTP.KD' AND year = 2019
ORDER BY gdp DESC
LIMIT 10
Answer:
country_code,country_name,gdp
WLD,World,84612027798062.6
HIC,High income,52180038375130.5
OED,OECD members,51615069476329.7
PST,Post-demographic dividend,48381584694878.9
IBT,IDA & IBRD total,33299134680470.5
LMY,Low & middle income,32139450441501.1
MIC,Middle income,31663365601529.3
IBD,IBRD only,30947573002709.4
EAS,East Asia & Pacific,26302619575881.9
UMC,Upper middle income,23866821838887.8
Query:
SELECT year, value AS gdp
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE indicator_code = 'NY.GDP.MKTP.KD' AND country_name = 'United States'
ORDER BY year ASC
LIMIT 1000
Answer:
year,gdp
1960,3457188037625.69
1961,3536703362491.07
1962,3752442267603.03
1963,3917549727377.56
1964,4144767611565.47
1965,4410032738705.65
1966,4696684866721.53
1967,4814101988389.57
1968,5045178883832.25
1969,5201579429231.05
1970,5183548220000.0
1971,5354260691000.0
1972,5635836299000.0
1973,5954019981000.0
1974,5921835427000.0
1975,5909668657000.0
1976,6228089836000.0
1977,6516086243000.0
1978,6876771488000.0
1979,7094500066000.0
1980,7076284960000.0
1981,7255861209000.0
1982,7125046201000.0
1983,7451652146000.0
1984,7990900876000.0
1985,8324093971000.0
1986,8612327876000.0
1987,8910249999000.0
1988,9282436602000.0
1989,9623347839000.0
1990,9804840807000.0
1991,9794225617000.0
1992,10139221389000.0
1993,10418230561000.0
1994,10837959532000.0
1995,11128873914000.0
1996,11548717972000.0
1997,12054756829000.0
1998,12594979613000.0
1999,13193648716000.0
2000,13738214458000.0
2001,13875368657000.0
2002,14117035294000.0
2003,14520953428000.0
2004,15072588639000.0
2005,15602120903000.0
2006,16047557132000.0
2007,16348636818000.0
2008,16326307882000.0
2009,15912149113000.0
2010,16320099471000.0
2011,16573197368000.0
2012,16946019042000.0
2013,17258178451000.0
2014,17694115456000.0
2015,18238300569000.0
2016,18550435728000.0
2017,18983157920000.0
2018,19551981480000.0
2019,19974534312000.0
2020,19294483000000.0
Query:
SELECT DISTINCT region
FROM `bigquery-public-data.world_bank_wdi.country_summary`
LIMIT 1000
Answer:
region
""
Europe & Central Asia
North America
Latin America & Caribbean
East Asia & Pacific
Sub-Saharan Africa
Middle East & North Africa
South Asia
Query:
SELECT cs.region, AVG(id.value) AS average_gdp
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
ON id.country_code = cs.country_code
WHERE id.indicator_code = 'NY.GDP.MKTP.KD' AND id.year = 2019
GROUP BY cs.region
LIMIT 1000
Answer:
region,average_gdp
,12954727604440.113
East Asia & Pacific,754966404370.8977
Sub-Saharan Africa,39604795061.31859
Latin America & Caribbean,143902774165.0307
Europe & Central Asia,413777989849.8653
South Asia,428933254078.4158
North America,7225849553024.158
Middle East & North Africa,167057963295.84705
Query:
SELECT country_code, country_name, value AS gdp
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE indicator_code = 'NY.GDP.MKTP.KD' AND year = 2019 AND value > 1000000000000
LIMIT 1000
Answer:
country_code,country_name,gdp
MNA,Middle East & North Africa (excluding high income),1538200834048.04
AFE,Africa Eastern and Southern,1006679813065.29
EAR,Early-demographic dividend,11703037495097.2
TEC,Europe & Central Asia (IDA & IBRD countries),4095463099662.97
DEU,Germany,3598891541091.34
GBR,United Kingdom,3191493407624.4
NAC,North America,21677548659072.5
ARB,Arab World,2681441590769.14
TSS,Sub-Saharan Africa (IDA & IBRD countries),1834643244102.56
LAC,Latin America & Caribbean (excluding high income),4853709324043.9
TEA,East Asia & Pacific (IDA & IBRD countries),16995303639412.5
SAS,South Asia,3431466032627.32
TSA,South Asia (IDA & IBRD),3431466032627.32
ECA,Europe & Central Asia (excluding high income),3468157804813.19
USA,United States,19974534312000.0
IDX,IDA only,1229224147182.17
IDB,IDA blend,1121954012747.96
PRE,Pre-demographic dividend,1450630111014.12
ITA,Italy,1915994931005.09
IDA,IDA total,2351178159930.13
SSF,Sub-Saharan Africa,1834643244102.56
OED,OECD members,51615069476329.7
LTE,Late-demographic dividend,22419881460422.2
UMC,Upper middle income,23866821838887.8
LDC,Least developed countries: UN classification,1126602114779.77
ESP,Spain,1324028319783.9
IDN,Indonesia,1049318966508.58
IND,India,2695611314661.46
MEX,Mexico,1252848919131.02
EUU,European Union,14765116523492.0
TMN,Middle East & North Africa (IDA & IBRD countries),1522371834048.04
EAP,East Asia & Pacific (excluding high income),17016933263759.9
CAN,Canada,1696163077026.08
JPN,Japan,4591290538384.75
EAS,East Asia & Pacific,26302619575881.9
HIC,High income,52180038375130.5
TLA,Latin America & the Caribbean (IDA & IBRD countries),5369907031287.5
WLD,World,84612027798062.6
FCS,Fragile and conflict affected situations,1720631743301.35
CEB,Central Europe and the Baltics,1519932999983.23
RUS,Russian Federation,1459189098326.43
MIC,Middle income,31663365601529.3
LCN,Latin America & Caribbean,5596468714863.74
IBT,IDA & IBRD total,33299134680470.5
CHN,China,14296238286985.1
ECS,Europe & Central Asia,22365520285914.6
PST,Post-demographic dividend,48381584694878.9
FRA,France,2615760319962.67
SSA,Sub-Saharan Africa (excluding high income),1833089644759.92
EMU,Euro area,12615961472339.9
MEA,Middle East & North Africa,3378463990503.43
IBD,IBRD only,30947573002709.4
LMY,Low & middle income,32139450441501.1
LMC,Lower middle income,7796543762641.46
AUS,Australia,1491025040336.15
BRA,Brazil,1823105452462.95
KOR,"Korea, Rep.",1637850078348.95
Query:
SELECT id.country_code, id.country_name, cs.region
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
ON id.country_code = cs.country_code
WHERE id.indicator_code = 'NY.GDP.MKTP.KD' AND id.year = 2019
LIMIT 1000
Answer:
country_code,country_name,region
GAB,Gabon,Sub-Saharan Africa
NAM,Namibia,Sub-Saharan Africa
AGO,Angola,Sub-Saharan Africa
SDN,Sudan,Sub-Saharan Africa
MNA,Middle East & North Africa (excluding high income),
AFE,Africa Eastern and Southern,
TON,Tonga,East Asia & Pacific
TKM,Turkmenistan,Europe & Central Asia
EAR,Early-demographic dividend,
QAT,Qatar,Middle East & North Africa
TEC,Europe & Central Asia (IDA & IBRD countries),
AUT,Austria,Europe & Central Asia
NGA,Nigeria,Sub-Saharan Africa
DEU,Germany,Europe & Central Asia
MOZ,Mozambique,Sub-Saharan Africa
LAO,Lao PDR,East Asia & Pacific
MLT,Malta,Middle East & North Africa
WSM,Samoa,East Asia & Pacific
HPC,Heavily indebted poor countries (HIPC),
MDG,Madagascar,Sub-Saharan Africa
SVN,Slovenia,Europe & Central Asia
KAZ,Kazakhstan,Europe & Central Asia
PRT,Portugal,Europe & Central Asia
GBR,United Kingdom,Europe & Central Asia
NAC,North America,
ARB,Arab World,
OMN,Oman,Middle East & North Africa
TSS,Sub-Saharan Africa (IDA & IBRD countries),
LAC,Latin America & Caribbean (excluding high income),
ETH,Ethiopia,Sub-Saharan Africa
CZE,Czech Republic,Europe & Central Asia
TCA,Turks and Caicos Islands,Latin America & Caribbean
GIN,Guinea,Sub-Saharan Africa
BLZ,Belize,Latin America & Caribbean
KWT,Kuwait,Middle East & North Africa
MMR,Myanmar,East Asia & Pacific
LVA,Latvia,Europe & Central Asia
AZE,Azerbaijan,Europe & Central Asia
URY,Uruguay,Latin America & Caribbean
LUX,Luxembourg,Europe & Central Asia
CSS,Caribbean small states,
GRC,Greece,Europe & Central Asia
KHM,Cambodia,East Asia & Pacific
TEA,East Asia & Pacific (IDA & IBRD countries),
FIN,Finland,Europe & Central Asia
LIC,Low income,
DJI,Djibouti,Middle East & North Africa
LTU,Lithuania,Europe & Central Asia
HRV,Croatia,Europe & Central Asia
SAS,South Asia,
TSA,South Asia (IDA & IBRD),
GNB,Guinea-Bissau,Sub-Saharan Africa
ALB,Albania,Europe & Central Asia
MCO,Monaco,Europe & Central Asia
COG,"Congo, Rep.",Sub-Saharan Africa
GEO,Georgia,Europe & Central Asia
MNG,Mongolia,East Asia & Pacific
MNE,Montenegro,Europe & Central Asia
Query:
SELECT cs.region, MIN(id.value) AS min_gdp, MAX(id.value) AS max_gdp
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
ON id.country_code = cs.country_code
WHERE id.indicator_code = 'NY.GDP.MKTP.KD' AND id.year = 2019
GROUP BY cs.region
LIMIT 1000
Answer:
region,min_gdp,max_gdp
,10138908192.4612,84612027798062.6
East Asia & Pacific,42824596.8653884,14296238286985.1
Sub-Saharan Africa,359752972.346268,502942019447.736
Latin America & Caribbean,568298267.854584,1823105452462.95
Europe & Central Asia,1514041111.68851,3598891541091.34
South Asia,2470944511.92544,2695611314661.46
North America,6851270046.39601,19974534312000.0
Middle East & North Africa,3191833262.48686,678581100842.581
Query:
SELECT cs.region, COUNT(id.country_code) AS countries_with_gdp
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
ON id.country_code = cs.country_code
WHERE id.indicator_code = 'NY.GDP.MKTP.KD' AND id.year = 2019 AND id.value IS NOT NULL
GROUP BY cs.region
LIMIT 1000
Answer:
region,countries_with_gdp
,48
East Asia & Pacific,34
Sub-Saharan Africa,46
Latin America & Caribbean,37
Europe & Central Asia,54
South Asia,8
North America,3
Middle East & North Africa,20
Query:
SELECT country_code, country_name, value AS gdp
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE indicator_code = 'NY.GDP.MKTP.KD' AND year = 2019 AND value < 10000000000
LIMIT 1000
Answer:
country_code,country_name,gdp
TON,Tonga,486181549.588749
WSM,Samoa,887495263.360233
TCA,Turks and Caicos Islands,1095902844.26329
BLZ,Belize,1835056955.71673
DJI,Djibouti,3191833262.48686
GNB,Guinea-Bissau,1248729327.89726
MCO,Monaco,7080667991.59357
COG,"Congo, Rep.",9643515879.79193
MNE,Montenegro,4777636043.80572
MWI,Malawi,7477443338.32784
CAF,Central African Republic,1984982171.73544
TGO,Togo,5098275352.1552
BDI,Burundi,3209182941.33059
FJI,Fiji,5223164712.00555
BRB,Barbados,4822013073.75235
SMR,San Marino,1514041111.68851
SUR,Suriname,5252729241.66594
VIR,Virgin Islands (U.S.),3835985859.12487
MDA,Moldova,9155458065.71175
VUT,Vanuatu,869804185.719708
BTN,Bhutan,2470944511.92544
XKX,Kosovo,7547420630.10043
VCT,St. Vincent and the Grenadines,798469518.407039
GRL,Greenland,2710570656.36234
LSO,Lesotho,2329753748.89367
MDV,Maldives,5414217823.03808
PLW,Palau,265597626.615969
MHL,Marshall Islands,212388500.0
NRU,Nauru,89620006.418409
GNQ,Equatorial Guinea,9998462337.55955
SOM,Somalia,6900727625.84454
ATG,Antigua and Barbuda,1630215842.3024
SLB,Solomon Islands,1533613348.9277
GUM,Guam,5966796360.32757
MNP,Northern Mariana Islands,1037951515.15152
GMB,"Gambia, The",1676447055.8329
TUV,Tuvalu,42824596.8653884
MRT,Mauritania,7336133809.76738
CYM,Cayman Islands,5425515180.60722
KGZ,Kyrgyz Republic,7920624102.90056
KIR,Kiribati,195759870.68938
ASM,American Samoa,628818320.610687
GUY,Guyana,5071041645.23612
COM,Comoros,1092787840.36505
FSM,"Micronesia, Fed. Sts.",332458532.270118
STP,Sao Tome and Principe,359752972.346268
KNA,St. Kitts and Nevis,1136818536.07058
BMU,Bermuda,6851270046.39601
CUW,Curacao,2898092042.62992
DMA,Dominica,568298267.854584
LBR,Liberia,3211334057.92828
LCA,St. Lucia,1995116519.64915
SLE,Sierra Leone,5076711739.04284
TLS,Timor-Leste,1896767581.03646
IMN,Isle of Man,8129451489.68678
CPV,Cabo Verde,1915123782.86887
SYC,Seychelles,1553599342.64266
SWZ,Eswatini,4401077165.65255
AND,Andorra,3008955096.59511
GRD,Grenada,1134931073.15504
Query:
SELECT id.country_code, id.country_name, MAX(id.year) AS latest_year, id.value AS gdp
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
WHERE id.indicator_code = 'NY.GDP.MKTP.KD'
GROUP BY id.country_code, id.country_name, id.value
LIMIT 1000
Answer:
country_code,country_name,latest_year,gdp
MMR,Myanmar,1968,3766485577.12378
NAM,Namibia,1998,5242128224.00169
NPL,Nepal,1962,3447314854.82201
NPL,Nepal,2006,16439932516.5831
BRN,Brunei Darussalam,2009,12665627056.3659
BGR,Bulgaria,1985,35814094910.805
BGR,Bulgaria,1987,39580615170.2135
BDI,Burundi,1982,1712247647.29676
LAC,Latin America & Caribbean (excluding high income),1997,2846009420300.99
LMY,Low & middle income,2007,17586878384858.0
LMC,Lower middle income,1965,771275616651.188
LMC,Lower middle income,1990,2122313482158.37
LMC,Lower middle income,2002,3194038992245.53
MEA,Middle East & North Africa,2020,3243739545284.98
MNA,Middle East & North Africa (excluding high income),1980,419562499542.787
DMA,Dominica,1978,234352173.555526
LVA,Latvia,2007,29002363545.9676
LSO,Lesotho,2004,1612096000.49548
WSM,Samoa,1982,409723388.389005
OMN,Oman,1983,18925617927.7435
CAF,Central African Republic,1965,1013697584.80447
COM,Comoros,1997,563886119.709676
WLD,World,2000,48146683077384.4
DZA,Algeria,1961,20733849882.3774
DZA,Algeria,2006,126495413069.533
TMN,Middle East & North Africa (IDA & IBRD countries),2004,992580883046.924
NAC,North America,1992,10929544482336.9
PSS,Pacific island small states,2005,7231294470.42854
PST,Post-demographic dividend,1963,9889377686297.1
FIN,Finland,1960,50589519083.7226
FIN,Finland,1987,140069588805.624
FIN,Finland,2002,204568476382.962
FRA,France,1976,1148593347439.08
FRA,France,1990,1660423065362.52
GAB,Gabon,2019,15460241608.8257
EMU,Euro area,1997,9036375850461.54
EMU,Euro area,2009,10965349872015.8
HIC,High income,1978,19407887392109.1
HIC,High income,1985,23196833368009.8
MDG,Madagascar,2018,12629254614.1071
MLT,Malta,1985,2646361034.06191
MHL,Marshall Islands,2007,175092500.0
MRT,Mauritania,1963,1051184411.5989
MRT,Mauritania,1985,2488366451.23844
SGP,Singapore,1962,6911841722.43236
SXM,Sint Maarten (Dutch part),2018,1108000824.03352
ESP,Spain,2010,1196670854394.8
PRI,Puerto Rico,1986,58362843987.8155
COG,"Congo, Rep.",1964,1423661535.42456
End Exploring Related Columns
Task: Which region has the highest median GDP (constant 2015 US$) value?

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
Region,Median_GDP
North America,median_gdp_value:float (Attention: answer in one row)
```

To determine which region has the highest median GDP (constant 2015 US$) value, we analyze the `indicators_data` table from the `world_bank_wdi` schema, focusing on the GDP indicator for each country. We then join this data with the `country_summary` table to associate each country with its respective region. After calculating the median GDP for each region, we find that **North America** has the highest median GDP value..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'world_bank_global_population': ['population_by_country'], 'world_bank_health_population': ['country_series_definitions', 'country_summary', 'health_nutrition_population', 'series_summary', 'series_times'], 'world_bank_intl_debt': ['country_series_definitions', 'country_summary', 'international_debt', 'series_summary', 'series_times'], 'world_bank_intl_education': ['country_series_definitions', 'country_summary', 'international_education', 'series_summary'], 'world_bank_wdi': ['country_series_definitions', 'country_summary', 'footnotes', 'indicators_data', 'series_summary', 'series_time']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-20 11:20:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 11:20:21 - root - INFO - ```sql
SELECT region,
       ROUND(
         IF(MOD(COUNT(*), 2) = 1,
           ARRAY_AGG(gdp ORDER BY gdp)[OFFSET(DIV(COUNT(*), 2))],
           (ARRAY_AGG(gdp ORDER BY gdp)[OFFSET(DIV(COUNT(*), 2) - 1)] +
            ARRAY_AGG(gdp ORDER BY gdp)[OFFSET(DIV(COUNT(*), 2))]) / 2
         ), 4) AS median_gdp
FROM (
  SELECT cs.region, id.value AS gdp
  FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
  JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
  ON id.country_code = cs.country_code
  WHERE id.indicator_code = 'NY.GDP.MKTP.KD'
    AND id.year = 2019
    AND id.value IS NOT NULL
)
GROUP BY region
ORDER BY median_gdp DESC
LIMIT 1;
```

```csv
Region,Median_GDP
North America,1696163077026.08
```
2025-01-20 11:20:23 - root - INFO - itercount: 1
2025-01-20 11:20:23 - root - INFO - 0
2025-01-20 11:20:23 - root - INFO - results: 
region,median_gdp
,3449811918720.255


2025-01-20 11:20:23 - root - INFO - Please check the answer again by reviewing Which region has the highest median GDP (constant 2015 US$) value?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Region,Median_GDP
North America,median_gdp_value:float (Attention: answer in one row)
```

To determine which region has the highest median GDP (constant 2015 US$) value, we analyze the `indicators_data` table from the `world_bank_wdi` schema, focusing on the GDP indicator for each country. We then join this data with the `country_summary` table to associate each country with its respective region. After calculating the median GDP for each region, we find that **North America** has the highest median GDP value. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
region,median_gdp
,3449811918720.255
Current sql:
SELECT region,
       ROUND(
         IF(MOD(COUNT(*), 2) = 1,
           ARRAY_AGG(gdp ORDER BY gdp)[OFFSET(DIV(COUNT(*), 2))],
           (ARRAY_AGG(gdp ORDER BY gdp)[OFFSET(DIV(COUNT(*), 2) - 1)] +
            ARRAY_AGG(gdp ORDER BY gdp)[OFFSET(DIV(COUNT(*), 2))]) / 2
         ), 4) AS median_gdp
FROM (
  SELECT cs.region, id.value AS gdp
  FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
  JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
  ON id.country_code = cs.country_code
  WHERE id.indicator_code = 'NY.GDP.MKTP.KD'
    AND id.year = 2019
    AND id.value IS NOT NULL
)
GROUP BY region
ORDER BY median_gdp DESC
LIMIT 1;Empty results in Column ['region']. Please correct them.
Usage of ST_INTERSECTS: ST_INTERSECTS(geometry1, ST_GEOGFROMWKB(geometry2)) This function checks if the two geometries intersect. The first argument, geometry1, is compared with the second argument, geometry2, which is converted from its WKB (Well-Known Binary) representation to a geography type using ST_GEOGFROMWKB. If the two geometries share any portion of space, the function returns TRUE; otherwise, it returns FALSE. Usage of ST_CONTAINS: ST_CONTAINS(r1.geometry, r2.geometry) This function checks if the geometry r1.geometry completely contains the geometry r2.geometry. It returns TRUE if all points of r2.geometry are within r1.geometry and FALSE otherwise. This is useful for spatial containment queries, such as verifying whether one region is entirely within another. ARRAY_INTERSECTION(nodes1, nodes2): This function computes the intersection of the two arrays, returning a new array containing only the elements that are present in both nodes1 and nodes2. ARRAY_SIZE(...): This function then determines the size (or number of elements) in the resulting array from the intersection.

2025-01-20 11:21:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 11:21:17 - root - INFO - ```sql
SELECT region,
       ROUND(
         IF(MOD(COUNT(*), 2) = 1,
           ARRAY_AGG(gdp ORDER BY gdp)[OFFSET(DIV(COUNT(*), 2))],
           (ARRAY_AGG(gdp ORDER BY gdp)[OFFSET(DIV(COUNT(*), 2) - 1)] +
            ARRAY_AGG(gdp ORDER BY gdp)[OFFSET(DIV(COUNT(*), 2))]) / 2
         ), 4) AS median_gdp
FROM (
  SELECT cs.region, id.value AS gdp
  FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
  JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
  ON id.country_code = cs.country_code
  WHERE id.indicator_code = 'NY.GDP.MKTP.KD'
    AND id.year = 2019
    AND id.value IS NOT NULL
    AND cs.region IS NOT NULL
    AND cs.region != ''
)
GROUP BY region
ORDER BY median_gdp DESC
LIMIT 1;
```

```csv
Region,Median_GDP
North America,1696163077026.08
```
2025-01-20 11:21:19 - root - INFO - itercount: 2
2025-01-20 11:21:19 - root - INFO - 0
2025-01-20 11:21:19 - root - INFO - results: 
region,median_gdp
North America,1696163077026.08


2025-01-20 11:21:19 - root - INFO - Please check the answer again by reviewing Which region has the highest median GDP (constant 2015 US$) value?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Region,Median_GDP
North America,median_gdp_value:float (Attention: answer in one row)
```

To determine which region has the highest median GDP (constant 2015 US$) value, we analyze the `indicators_data` table from the `world_bank_wdi` schema, focusing on the GDP indicator for each country. We then join this data with the `country_summary` table to associate each country with its respective region. After calculating the median GDP for each region, we find that **North America** has the highest median GDP value. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
region,median_gdp
North America,1696163077026.08
Current sql:
SELECT region,
       ROUND(
         IF(MOD(COUNT(*), 2) = 1,
           ARRAY_AGG(gdp ORDER BY gdp)[OFFSET(DIV(COUNT(*), 2))],
           (ARRAY_AGG(gdp ORDER BY gdp)[OFFSET(DIV(COUNT(*), 2) - 1)] +
            ARRAY_AGG(gdp ORDER BY gdp)[OFFSET(DIV(COUNT(*), 2))]) / 2
         ), 4) AS median_gdp
FROM (
  SELECT cs.region, id.value AS gdp
  FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
  JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
  ON id.country_code = cs.country_code
  WHERE id.indicator_code = 'NY.GDP.MKTP.KD'
    AND id.year = 2019
    AND id.value IS NOT NULL
    AND cs.region IS NOT NULL
    AND cs.region != ''
)
GROUP BY region
ORDER BY median_gdp DESC
LIMIT 1;Usage of ST_INTERSECTS: ST_INTERSECTS(geometry1, ST_GEOGFROMWKB(geometry2)) This function checks if the two geometries intersect. The first argument, geometry1, is compared with the second argument, geometry2, which is converted from its WKB (Well-Known Binary) representation to a geography type using ST_GEOGFROMWKB. If the two geometries share any portion of space, the function returns TRUE; otherwise, it returns FALSE. Usage of ST_CONTAINS: ST_CONTAINS(r1.geometry, r2.geometry) This function checks if the geometry r1.geometry completely contains the geometry r2.geometry. It returns TRUE if all points of r2.geometry are within r1.geometry and FALSE otherwise. This is useful for spatial containment queries, such as verifying whether one region is entirely within another. ARRAY_INTERSECTION(nodes1, nodes2): This function computes the intersection of the two arrays, returning a new array containing only the elements that are present in both nodes1 and nodes2. ARRAY_SIZE(...): This function then determines the size (or number of elements) in the resulting array from the intersection.

2025-01-20 11:22:07 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 11:22:07 - root - INFO - ```sql
SELECT region,
       ROUND(
         IF(MOD(COUNT(*), 2) = 1,
           ARRAY_AGG(gdp ORDER BY gdp)[OFFSET(DIV(COUNT(*), 2))],
           (ARRAY_AGG(gdp ORDER BY gdp)[OFFSET(DIV(COUNT(*), 2) - 1)] +
            ARRAY_AGG(gdp ORDER BY gdp)[OFFSET(DIV(COUNT(*), 2))]) / 2
         ), 4) AS median_gdp
FROM (
  SELECT cs.region, id.value AS gdp
  FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS id
  JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
  ON id.country_code = cs.country_code
  WHERE id.indicator_code = 'NY.GDP.MKTP.KD'
    AND id.year = 2019
    AND id.value IS NOT NULL
    AND cs.region IS NOT NULL
    AND cs.region != ''
    AND LENGTH(cs.country_code) = 3  -- Include only actual countries
)
GROUP BY region
ORDER BY median_gdp DESC
LIMIT 1;
```

```csv
Region,Median_GDP
North America,1696163077026.08
```
2025-01-20 11:22:09 - root - INFO - itercount: 3
2025-01-20 11:22:09 - root - INFO - 0
2025-01-20 11:22:09 - root - INFO - Total iteration counts: 3
