2025-01-20 17:30:16 - openai._base_client - INFO - Retrying request to /chat/completions in 0.451479 seconds
2025-01-20 17:31:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 17:31:44 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 17:31:44 - root - INFO - I apologize for the confusion. The error occurred because the column `indicator_code` does not exist in the `series_summary` table. Instead, the correct column name is `series_code`. The `series_code` in `series_summary` corresponds to the `indicator_code` in `indicators_data`.

Let me correct the SQL query:

```sql
SELECT DISTINCT series_code, indicator_name
FROM `bigquery-public-data.world_bank_wdi.series_summary`
WHERE LOWER(indicator_name) LIKE '%crude birth rate%'
LIMIT 1000;
```

---

**Updated Relevant Columns and Their Potential Usage:**

- **`indicators_data.indicator_code`**: Contains codes for indicators, such as "Crude birth rate".
- **`indicators_data.value`**: Crude birth rate values.
- **`indicators_data.year`**: Years for the data, to filter the 1980s (1980-1989).
- **`country_summary.country_code`**: To join with `indicators_data` on country code.
- **`country_summary.income_group`**: To filter for "High income" countries.
- **`country_summary.region`**: To identify the region associated with each country.
- **`series_summary.series_code`**: To find the correct `indicator_code` for "Crude birth rate".

**Conditions That May Be Used:**

- **Filter by `indicator_code`** matching the code for "Crude birth rate".
- **Filter by `year`** between 1980 and 1989.
- **Filter by `income_group`** equal to "High income".

---

**Corrected and Updated SQL Queries:**

1. **Find the indicator codes related to crude birth rate:**

   ```sql
   SELECT DISTINCT series_code, indicator_name
   FROM `bigquery-public-data.world_bank_wdi.series_summary`
   WHERE LOWER(indicator_name) LIKE '%crude birth rate%'
   LIMIT 1000;
   ```

2. **List all income groups available:**

   ```sql
   SELECT DISTINCT income_group
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   LIMIT 1000;
   ```

3. **List all regions available:**

   ```sql
   SELECT DISTINCT region
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   LIMIT 1000;
   ```

4. **Get country codes and names of high-income countries:**

   ```sql
   SELECT country_code, short_name
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   WHERE income_group = 'High income'
   LIMIT 1000;
   ```

5. **Retrieve crude birth rate data for the 1980s:**

   ```sql
   SELECT country_code, year, value
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE indicator_code = 'SP.DYN.CBRT.IN'
     AND year BETWEEN 1980 AND 1989
   LIMIT 1000;
   ```

6. **Get crude birth rate values for high-income countries in the 1980s:**

   ```sql
   SELECT ind.country_code, ind.year, ind.value
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS ind
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
     ON ind.country_code = cs.country_code
   WHERE ind.indicator_code = 'SP.DYN.CBRT.IN'
     AND ind.year BETWEEN 1980 AND 1989
     AND cs.income_group = 'High income'
   LIMIT 1000;
   ```

7. **Calculate the average crude birth rate for each country in the 1980s:**

   ```sql
   SELECT country_code, AVG(value) AS avg_birth_rate
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE indicator_code = 'SP.DYN.CBRT.IN'
     AND year BETWEEN 1980 AND 1989
   GROUP BY country_code
   LIMIT 1000;
   ```

8. **List regions associated with high-income countries:**

   ```sql
   SELECT DISTINCT region, short_name
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   WHERE income_group = 'High income'
   LIMIT 1000;
   ```

9. **Find the average crude birth rate for high-income countries with country names:**

   ```sql
   SELECT ind.country_code, cs.short_name, AVG(ind.value) AS avg_birth_rate
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS ind
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
     ON ind.country_code = cs.country_code
   WHERE ind.indicator_code = 'SP.DYN.CBRT.IN'
     AND ind.year BETWEEN 1980 AND 1989
     AND cs.income_group = 'High income'
   GROUP BY ind.country_code, cs.short_name
   LIMIT 1000;
   ```

10. **List the regions and their corresponding high-income countries:**

    ```sql
    SELECT cs.region, cs.country_code, cs.short_name
    FROM `bigquery-public-data.world_bank_wdi.country_summary` AS cs
    WHERE cs.income_group = 'High income'
    LIMIT 1000;
    ```

11. **Identify all indicators related to 'birth rate':**

    ```sql
    SELECT DISTINCT series_code, indicator_name
    FROM `bigquery-public-data.world_bank_wdi.series_summary`
    WHERE LOWER(indicator_name) LIKE '%birth rate%'
    LIMIT 1000;
    ```

12. **Retrieve all years available for crude birth rate data:**

    ```sql
    SELECT DISTINCT year
    FROM `bigquery-public-data.world_bank_wdi.indicators_data`
    WHERE indicator_code = 'SP.DYN.CBRT.IN'
    ORDER BY year
    LIMIT 1000;
    ```

13. **List high-income countries with their regions and income groups:**

    ```sql
    SELECT country_code, short_name, region, income_group
    FROM `bigquery-public-data.world_bank_wdi.country_summary`
    WHERE income_group = 'High income'
    LIMIT 1000;
    ```

14. **Find the maximum crude birth rate value for each high-income country in the 1980s:**

    ```sql
    SELECT ind.country_code, MAX(ind.value) AS max_birth_rate_1980s
    FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS ind
    JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
      ON ind.country_code = cs.country_code
    WHERE ind.indicator_code = 'SP.DYN.CBRT.IN'
      AND ind.year BETWEEN 1980 AND 1989
      AND cs.income_group = 'High income'
    GROUP BY ind.country_code
    LIMIT 1000;
    ```

15. **Get the list of countries and their average crude birth rate across all years:**

    ```sql
    SELECT country_code, AVG(value) AS avg_birth_rate_all_years
    FROM `bigquery-public-data.world_bank_wdi.indicators_data`
    WHERE indicator_code = 'SP.DYN.CBRT.IN'
    GROUP BY country_code
    LIMIT 1000;
    ```

---

**Explanation and Corrections:**

- **Column Name Adjustments:**
  - In the `series_summary` table, the correct column name is `series_code` instead of `indicator_code`.
  - The `series_code` in `series_summary` corresponds to `indicator_code` in `indicators_data`.

- **Consistent Aliases:**
  - Used table aliases (`ind` for `indicators_data` and `cs` for `country_summary`) to simplify queries.

- **Join Conditions Updated:**
  - Ensured that joins between `indicators_data` and `country_summary` are correctly using `country_code`.

- **Indicator Code for Crude Birth Rate:**
  - The code `SP.DYN.CBRT.IN` is commonly used for "Crude birth rate (per 1,000 people)".

---

By correcting the column names and ensuring that the queries align with the actual table schemas, these adjusted SQL queries should run without errors. You can use these queries to explore the data and proceed with the task of identifying which high-income country had the highest average crude birth rate in each region during the 1980s.

If you encounter any further issues or have questions about the data, feel free to ask!
2025-01-20 17:32:58 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 17:32:58 - root - INFO - SQL:
SELECT ind.country_code, cs.short_name, AVG(ind.value) AS avg_birth_rate
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS ind
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
     ON ind.country_code = cs.country_code
   WHERE ind.indicator_code = 'SP.DYN.CBRT.IN'
     AND ind.year BETWEEN 1980 AND 1989
     AND cs.income_group = 'High income'
   GROUP BY ind.country_code, cs.short_name
   LIMIT 1000;
Results:
country_code,short_name,avg_birth_rate
FIN,Finland,13.0
SVN,Slovenia,13.739999999999998
ESP,Spain,12.350000000000001
CYP,Cyprus,20.0695
DEU,Germany,10.93
TTO,Trinidad and Tobago,26.4283
URY,Uruguay,18.429100000000002
CHI,Channel Islands,11.834700000000002
EST,Estonia,15.67
CZE,Czech Republic,13.31
CHE,Switzerland,11.739999999999998
BMU,Bermuda,15.066666666666666
NCL,New Caledonia,25.310000000000002
BRN,Brunei,30.5327
MAC,"Macao SAR, China",20.7301
POL,Poland,17.880000000000003
PRT,Portugal,13.75
BEL,Belgium,12.07
IRL,Ireland,18.19
LTU,Lithuania,15.889999999999999
LIE,Liechtenstein,14.09
FRA,France,14.05
ROU,Romania,16.160000000000004
CAN,Canada,14.899999999999999
SGP,Singapore,17.08
PRI,Puerto Rico,20.200000000000003
ISR,Israel,23.38
KWT,Kuwait,32.1141
HKG,"Hong Kong SAR, China",14.55
AUT,Austria,11.83
KNA,St. Kitts and Nevis,24.45
LVA,Latvia,15.26
FRO,Faroe Islands,16.97
GRL,Greenland,20.66
OMN,Oman,45.970200000000006
PYF,French Polynesia,30.2622
MLT,Malta,16.5
HRV,Croatia,13.440000000000001
ITA,Italy,10.389999999999999
HUN,Hungary,12.31
GRC,Greece,12.45
JPN,Japan,11.99
GBR,United Kingdom,13.260000000000002
VIR,Virgin Islands,24.009999999999998
SAU,Saudi Arabia,41.0283
MAF,St. Martin (French part),24.299999999999997
LUX,Luxembourg,11.72
SYC,Seychelles,25.779999999999998
ABW,Aruba,21.619100000000003
USA,United States,15.83
DNK,Denmark,10.77
QAT,Qatar,29.6878
GUM,Guam,27.2331
ATG,Antigua and Barbuda,18.3937
SVK,Slovak Republic,17.330000000000002
ISL,Iceland,17.84
BRB,Barbados,17.069700000000005
ARE,United Arab Emirates,29.4277
AUS,Australia,15.35
NZL,New Zealand,16.38
BHR,Bahrain,32.166199999999996
CYM,Cayman Islands,16.84

2025-01-20 17:32:59 - root - INFO - SQL:
-- Query 1: List all income groups available
SELECT DISTINCT income_group
FROM `bigquery-public-data.world_bank_wdi.country_summary`
LIMIT 1000
Results:
income_group
""
High income
Low income
Upper middle income
Lower middle income

2025-01-20 17:33:01 - root - INFO - SQL:
-- Query 2: List all regions available
SELECT DISTINCT region
FROM `bigquery-public-data.world_bank_wdi.country_summary`
LIMIT 1000
Results:
region
""
Europe & Central Asia
North America
Latin America & Caribbean
East Asia & Pacific
Sub-Saharan Africa
Middle East & North Africa
South Asia

2025-01-20 17:33:03 - root - INFO - SQL:
-- Query 3: Get country codes and names of high-income countries
SELECT country_code, short_name
FROM `bigquery-public-data.world_bank_wdi.country_summary`
WHERE income_group = 'High income'
LIMIT 1000
Results:
country_code,short_name
AND,Andorra
BMU,Bermuda
CHI,Channel Islands
CUW,Curaçao
CYM,Cayman Islands
FRO,Faroe Islands
GIB,Gibraltar
GRL,Greenland
GUM,Guam
IMN,Isle of Man
LIE,Liechtenstein
MAF,St. Martin (French part)
MCO,Monaco
MNP,Northern Mariana Islands
NCL,New Caledonia
NRU,Nauru
NZL,New Zealand
PRI,Puerto Rico
PYF,French Polynesia
SXM,Sint Maarten (Dutch part)
TCA,Turks and Caicos Islands
VGB,British Virgin Islands
VIR,Virgin Islands
ABW,Aruba
ARE,United Arab Emirates
ATG,Antigua and Barbuda
BHR,Bahrain
BHS,The Bahamas
BRB,Barbados
BRN,Brunei
KNA,St. Kitts and Nevis
KWT,Kuwait
MAC,"Macao SAR, China"
OMN,Oman
PAN,Panama
QAT,Qatar
SMR,San Marino
TTO,Trinidad and Tobago
AUS,Australia
BEL,Belgium
CHE,Switzerland
CYP,Cyprus
EST,Estonia
GBR,United Kingdom
GRC,Greece
HKG,"Hong Kong SAR, China"
HRV,Croatia
HUN,Hungary
IRL,Ireland
ISL,Iceland
ISR,Israel
KOR,Korea
MLT,Malta
NOR,Norway
POL,Poland
SAU,Saudi Arabia
SGP,Singapore
SYC,Seychelles
URY,Uruguay
AUT,Austria
CAN,Canada
CHL,Chile
CZE,Czech Republic
DEU,Germany
DNK,Denmark
ESP,Spain
FIN,Finland
FRA,France
ITA,Italy
JPN,Japan
LTU,Lithuania
LUX,Luxembourg
LVA,Latvia
NLD,Netherlands
PRT,Portugal
ROU,Romania
SVK,Slovak Republic
SVN,Slovenia
SWE,Sweden
USA,United States

2025-01-20 17:33:04 - root - INFO - SQL:
-- Query 4: Retrieve crude birth rate data for the 1980s
SELECT country_code, year, value
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE indicator_code = 'SP.DYN.CBRT.IN'
  AND year BETWEEN 1980 AND 1989
LIMIT 1000
Results:
country_code,year,value
BDI,1988,50.961
TLA,1988,28.349434569775
MNA,1981,41.1889494231624
EAR,1984,35.90671608227
EAP,1986,24.4306614211465
SYC,1980,28.9
OMN,1985,46.163
ABW,1987,21.008
OSS,1988,33.4464059193206
PRE,1984,46.5906908668772
MLI,1988,48.746
SGP,1983,16.3
SLB,1986,41.331
CZE,1984,13.3
HTI,1981,42.401
TSA,1981,37.2033506788069
LCA,1988,29.804
SYR,1981,44.064
IRQ,1983,38.969
VEN,1987,30.205
VNM,1981,31.68
NLD,1981,12.5
NCL,1986,24.9
NZL,1983,15.8
NER,1986,56.178
LAC,1981,32.1233804270661
LBR,1981,48.555
EAS,1981,23.0637636998303
SYC,1981,28.1
PNG,1981,39.016
FCS,1981,44.1926831101688
HIC,1987,14.1807644876801
GUY,1981,30.926
HKG,1981,16.8
BHR,1980,32.931
BRB,1988,16.407
KNA,1983,24.1
KNA,1985,23.1
MNE,1988,17.089
NER,1983,56.634
MNA,1982,40.855130241805
DNK,1982,10.3
LVA,1983,15.9
WSM,1983,36.047
CAF,1981,42.163
AFG,1982,50.098
AGO,1985,50.663
EST,1987,16.2
EUU,1980,13.9675011570752
MRT,1983,42.492
PRT,1981,15.4
GNB,1980,48.73
HTI,1983,42.429
BHS,1985,25.819
BLR,1985,16.5
KNA,1980,26.8
SUR,1989,28.295
IBT,1984,30.3249708951953
IDX,1986,43.4844843508447
TTO,1988,23.181
UZB,1984,36.3
MMR,1989,28.222
CAN,1983,15.0
LAC,1985,29.9974830347845
LIC,1980,46.2294380010898
LMC,1983,36.5338248511245
DMA,1982,23.3
AFE,1980,46.1453277375565
ALB,1983,26.528
FRA,1984,14.3
SLB,1984,41.954
CYP,1981,20.168
TSA,1984,36.1731485377014
MAF,1988,25.5
IBT,1988,29.6891660619559
IRN,1980,44.108
ZMB,1983,47.053
BGR,1985,13.3
TLA,1985,30.0353211355085
DJI,1989,39.979
RWA,1984,52.454
NOR,1983,12.1
COD,1980,46.296
ATG,1989,18.587
SWZ,1983,47.211
SWZ,1989,39.87
ETH,1986,48.712
EUU,1981,13.5934870018468
ROU,1982,15.3
HUN,1983,11.9

2025-01-20 17:33:06 - root - INFO - SQL:
-- Query 5: Get crude birth rate values for high-income countries in the 1980s
SELECT ind.country_code, ind.year, ind.value
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS ind
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
  ON ind.country_code = cs.country_code
WHERE ind.indicator_code = 'SP.DYN.CBRT.IN'
  AND ind.year BETWEEN 1980 AND 1989
  AND cs.income_group = 'High income'
LIMIT 1000
Results:
country_code,year,value
FIN,1987,12.1
SVN,1982,15.1
ESP,1980,15.2
CYP,1985,20.34
DEU,1989,11.2
TTO,1981,28.788
URY,1983,18.368
CHI,1980,11.531
EST,1988,16.0
CZE,1989,12.4
CHE,1984,11.6
BMU,1984,15.1
NCL,1982,26.3
BRN,1986,30.121
MAC,1987,22.33
POL,1982,19.5
PRT,1986,12.6
BEL,1984,11.7
IRL,1984,18.1
BRN,1980,31.899
LTU,1988,15.5
BEL,1981,12.6
IRL,1982,20.3
LIE,1988,14.9
CHI,1989,12.401
FRA,1987,14.0
ROU,1981,17.0
IRL,1988,15.5
CAN,1982,15.1
CZE,1988,12.8
IRL,1989,14.8
BRN,1983,30.677
SGP,1988,19.8
PRI,1984,19.3
PRI,1989,19.1
ISR,1980,24.3
ISR,1989,22.3
KWT,1985,32.161
LTU,1984,16.4
HKG,1989,12.3
AUT,1987,11.4
ESP,1981,14.1
CZE,1983,13.3
KNA,1987,23.6
DEU,1988,11.4
URY,1986,18.155
LVA,1981,14.2
LTU,1986,16.7
FRO,1985,16.3
CHE,1982,11.7
CHE,1986,11.7
GRL,1980,20.6
CAN,1989,14.9
LVA,1989,14.6
OMN,1981,49.322
PYF,1980,30.789
MLT,1981,16.6
MLT,1986,15.3
PRT,1980,16.2
HRV,1984,13.9
KNA,1982,29.1
KNA,1986,23.0
ITA,1986,9.8
LIE,1985,13.9
EST,1980,15.0
PRI,1982,21.05
HUN,1980,13.9
BEL,1985,11.6
GRC,1984,12.7
JPN,1980,13.5
POL,1988,15.6
GBR,1980,13.4
VIR,1986,23.65
SAU,1989,36.82
FIN,1986,12.3
MAC,1985,22.901
MAF,1986,23.9
GRL,1983,19.1
LIE,1980,15.4
LUX,1985,11.2
SYC,1983,25.8
ABW,1985,21.726
EST,1981,15.4
EST,1983,16.0
FRO,1981,17.2
MLT,1982,18.1
PRT,1989,11.8
GRC,1983,13.5
ITA,1981,11.0
USA,1985,15.8
DNK,1985,10.5
LUX,1983,11.4
QAT,1982,33.485
DEU,1985,10.5
GUM,1984,27.22
USA,1988,16.0

2025-01-20 17:33:08 - root - INFO - SQL:
-- Query 6: Calculate the average crude birth rate for each country in the 1980s
SELECT country_code, AVG(value) AS avg_birth_rate
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE indicator_code = 'SP.DYN.CBRT.IN'
  AND year BETWEEN 1980 AND 1989
GROUP BY country_code
LIMIT 1000
Results:
country_code,avg_birth_rate
BDI,51.3044
TLA,30.27478644193387
MNA,38.90497580367373
EAR,35.44338867101696
EAP,23.77923550301364
SYC,25.779999999999998
OMN,45.970200000000006
ABW,21.619100000000003
OSS,34.337881483810925
PRE,46.44554769910849
MLI,49.1053
SGP,17.08
SLB,42.008300000000006
CZE,13.31
HTI,41.0126
TSA,35.748496308582276
LCA,32.271100000000004
SYR,41.164300000000004
IRQ,38.7932
VEN,31.0263
VNM,30.669600000000003
NLD,12.42
NCL,25.310000000000002
NZL,16.38
NER,56.31139999999999
LAC,30.22609245479991
LBR,47.5794
EAS,22.60836527876417
PNG,37.1993
FCS,43.25660731556301
HIC,14.68225985890935
GUY,29.8218
HKG,14.55
BHR,32.166199999999996
BRB,17.069700000000005
KNA,24.45
MNE,17.923299999999998
DNK,10.77
LVA,15.26
WSM,35.4043
CAF,42.3932
AFG,49.7501
AGO,50.497099999999996
EST,15.67
EUU,13.00519829305529
MRT,42.0237
PRT,13.75
GNB,48.9168
BHS,25.617099999999997
BLR,16.4277
SUR,29.2968
IBT,30.387631580650208
IDX,43.91645773871377
TTO,26.4283
UZB,35.68000000000001
MMR,32.0205
CAN,14.899999999999999
LIC,45.811379889569125
LMC,35.66439327704011
DMA,23.216666666666665
AFE,45.22247374583799
ALB,26.3149
FRA,14.05
CYP,20.0695
MAF,24.299999999999997
IRN,41.334399999999995
ZMB,46.7965
BGR,13.52
DJI,40.53260000000001
RWA,51.6686
NOR,12.709999999999999
COD,46.183499999999995
ATG,18.3937
SWZ,45.0718
ETH,48.7467
ROU,16.160000000000004
HUN,12.31
AUT,11.83
BEL,12.07
TGO,44.9041
IMN,11.625
JAM,27.5404
VUT,37.6992
NAM,40.1592
LDC,44.39129228151326
LSO,39.406099999999995
MKD,19.8519
CHN,21.224000000000004
FRO,16.97
SOM,45.5933
SST,32.652219999619874
SDN,43.438300000000005

2025-01-20 17:33:10 - root - INFO - SQL:
-- Query 7: List regions associated with high-income countries
SELECT DISTINCT region, short_name
FROM `bigquery-public-data.world_bank_wdi.country_summary`
WHERE income_group = 'High income'
LIMIT 1000
Results:
region,short_name
Europe & Central Asia,Andorra
North America,Bermuda
Europe & Central Asia,Channel Islands
Latin America & Caribbean,Curaçao
Latin America & Caribbean,Cayman Islands
Europe & Central Asia,Faroe Islands
Europe & Central Asia,Gibraltar
Europe & Central Asia,Greenland
East Asia & Pacific,Guam
Europe & Central Asia,Isle of Man
Europe & Central Asia,Liechtenstein
Latin America & Caribbean,St. Martin (French part)
Europe & Central Asia,Monaco
East Asia & Pacific,Northern Mariana Islands
East Asia & Pacific,New Caledonia
East Asia & Pacific,Nauru
East Asia & Pacific,New Zealand
Latin America & Caribbean,Puerto Rico
East Asia & Pacific,French Polynesia
Latin America & Caribbean,Sint Maarten (Dutch part)
Latin America & Caribbean,Turks and Caicos Islands
Latin America & Caribbean,British Virgin Islands
Latin America & Caribbean,Virgin Islands
Latin America & Caribbean,Aruba
Middle East & North Africa,United Arab Emirates
Latin America & Caribbean,Antigua and Barbuda
Middle East & North Africa,Bahrain
Latin America & Caribbean,The Bahamas
Latin America & Caribbean,Barbados
East Asia & Pacific,Brunei
Latin America & Caribbean,St. Kitts and Nevis
Middle East & North Africa,Kuwait
East Asia & Pacific,"Macao SAR, China"
Middle East & North Africa,Oman
Latin America & Caribbean,Panama
Middle East & North Africa,Qatar
Europe & Central Asia,San Marino
Latin America & Caribbean,Trinidad and Tobago
East Asia & Pacific,Australia
Europe & Central Asia,Belgium
Europe & Central Asia,Switzerland
Europe & Central Asia,Cyprus
Europe & Central Asia,Estonia
Europe & Central Asia,United Kingdom
Europe & Central Asia,Greece
East Asia & Pacific,"Hong Kong SAR, China"
Europe & Central Asia,Croatia
Europe & Central Asia,Hungary
Europe & Central Asia,Ireland
Europe & Central Asia,Iceland
Middle East & North Africa,Israel
East Asia & Pacific,Korea
Middle East & North Africa,Malta
Europe & Central Asia,Norway
Europe & Central Asia,Poland
Middle East & North Africa,Saudi Arabia
East Asia & Pacific,Singapore
Sub-Saharan Africa,Seychelles
Latin America & Caribbean,Uruguay
Europe & Central Asia,Austria
North America,Canada
Latin America & Caribbean,Chile
Europe & Central Asia,Czech Republic
Europe & Central Asia,Germany
Europe & Central Asia,Denmark
Europe & Central Asia,Spain
Europe & Central Asia,Finland
Europe & Central Asia,France
Europe & Central Asia,Italy
East Asia & Pacific,Japan
Europe & Central Asia,Lithuania
Europe & Central Asia,Luxembourg
Europe & Central Asia,Latvia
Europe & Central Asia,Netherlands
Europe & Central Asia,Portugal
Europe & Central Asia,Romania
Europe & Central Asia,Slovak Republic
Europe & Central Asia,Slovenia
Europe & Central Asia,Sweden

2025-01-20 17:33:12 - root - INFO - SQL:
-- Query 8: Find the average crude birth rate for high-income countries with country names
SELECT ind.country_code, cs.short_name, AVG(ind.value) AS avg_birth_rate
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS ind
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
  ON ind.country_code = cs.country_code
WHERE ind.indicator_code = 'SP.DYN.CBRT.IN'
  AND ind.year BETWEEN 1980 AND 1989
  AND cs.income_group = 'High income'
GROUP BY ind.country_code, cs.short_name
LIMIT 1000
Results:
country_code,short_name,avg_birth_rate
SYC,Seychelles,25.779999999999998
OMN,Oman,45.970200000000006
ABW,Aruba,21.619100000000003
SGP,Singapore,17.08
CZE,Czech Republic,13.31
NLD,Netherlands,12.42
NCL,New Caledonia,25.310000000000002
NZL,New Zealand,16.38
HKG,"Hong Kong SAR, China",14.55
BHR,Bahrain,32.166199999999996
BRB,Barbados,17.069700000000005
KNA,St. Kitts and Nevis,24.45
DNK,Denmark,10.77
LVA,Latvia,15.26
EST,Estonia,15.67
PRT,Portugal,13.75
BHS,The Bahamas,25.617099999999997
TTO,Trinidad and Tobago,26.4283
CAN,Canada,14.899999999999999
FRA,France,14.05
CYP,Cyprus,20.0695
MAF,St. Martin (French part),24.299999999999997
NOR,Norway,12.709999999999999
ATG,Antigua and Barbuda,18.3937
ROU,Romania,16.160000000000004
HUN,Hungary,12.31
AUT,Austria,11.83
BEL,Belgium,12.07
IMN,Isle of Man,11.625
FRO,Faroe Islands,16.97
DEU,Germany,10.93
IRL,Ireland,18.19
KWT,Kuwait,32.1141
LTU,Lithuania,15.889999999999999
SAU,Saudi Arabia,41.0283
ITA,Italy,10.389999999999999
BRN,Brunei,30.5327
ESP,Spain,12.350000000000001
CHE,Switzerland,11.739999999999998
VIR,Virgin Islands,24.009999999999998
AND,Andorra,11.75
JPN,Japan,11.99
GRC,Greece,12.45
ISR,Israel,23.38
USA,United States,15.83
ARE,United Arab Emirates,29.4277
PRI,Puerto Rico,20.200000000000003
POL,Poland,17.880000000000003
QAT,Qatar,29.6878
ISL,Iceland,17.84
FIN,Finland,13.0
PYF,French Polynesia,30.2622
SVK,Slovak Republic,17.330000000000002
MLT,Malta,16.5
GBR,United Kingdom,13.260000000000002
GUM,Guam,27.2331
LIE,Liechtenstein,14.09
CYM,Cayman Islands,16.84
CHI,Channel Islands,11.834700000000002
HRV,Croatia,13.440000000000001
AUS,Australia,15.35
GRL,Greenland,20.66

2025-01-20 17:33:14 - root - INFO - SQL:
-- Query 9: List the regions and their corresponding high-income countries
SELECT cs.region, cs.country_code, cs.short_name
FROM `bigquery-public-data.world_bank_wdi.country_summary` AS cs
WHERE cs.income_group = 'High income'
LIMIT 1000
Results:
region,country_code,short_name
Europe & Central Asia,AND,Andorra
North America,BMU,Bermuda
Europe & Central Asia,CHI,Channel Islands
Latin America & Caribbean,CUW,Curaçao
Latin America & Caribbean,CYM,Cayman Islands
Europe & Central Asia,FRO,Faroe Islands
Europe & Central Asia,GIB,Gibraltar
Europe & Central Asia,GRL,Greenland
East Asia & Pacific,GUM,Guam
Europe & Central Asia,IMN,Isle of Man
Europe & Central Asia,LIE,Liechtenstein
Latin America & Caribbean,MAF,St. Martin (French part)
Europe & Central Asia,MCO,Monaco
East Asia & Pacific,MNP,Northern Mariana Islands
East Asia & Pacific,NCL,New Caledonia
East Asia & Pacific,NRU,Nauru
East Asia & Pacific,NZL,New Zealand
Latin America & Caribbean,PRI,Puerto Rico
East Asia & Pacific,PYF,French Polynesia
Latin America & Caribbean,SXM,Sint Maarten (Dutch part)
Latin America & Caribbean,TCA,Turks and Caicos Islands
Latin America & Caribbean,VGB,British Virgin Islands
Latin America & Caribbean,VIR,Virgin Islands
Latin America & Caribbean,ABW,Aruba
Middle East & North Africa,ARE,United Arab Emirates
Latin America & Caribbean,ATG,Antigua and Barbuda
Middle East & North Africa,BHR,Bahrain
Latin America & Caribbean,BHS,The Bahamas
Latin America & Caribbean,BRB,Barbados
East Asia & Pacific,BRN,Brunei
Latin America & Caribbean,KNA,St. Kitts and Nevis
Middle East & North Africa,KWT,Kuwait
East Asia & Pacific,MAC,"Macao SAR, China"
Middle East & North Africa,OMN,Oman
Latin America & Caribbean,PAN,Panama
Middle East & North Africa,QAT,Qatar
Europe & Central Asia,SMR,San Marino
Latin America & Caribbean,TTO,Trinidad and Tobago
East Asia & Pacific,AUS,Australia
Europe & Central Asia,BEL,Belgium
Europe & Central Asia,CHE,Switzerland
Europe & Central Asia,CYP,Cyprus
Europe & Central Asia,EST,Estonia
Europe & Central Asia,GBR,United Kingdom
Europe & Central Asia,GRC,Greece
East Asia & Pacific,HKG,"Hong Kong SAR, China"
Europe & Central Asia,HRV,Croatia
Europe & Central Asia,HUN,Hungary
Europe & Central Asia,IRL,Ireland
Europe & Central Asia,ISL,Iceland
Middle East & North Africa,ISR,Israel
East Asia & Pacific,KOR,Korea
Middle East & North Africa,MLT,Malta
Europe & Central Asia,NOR,Norway
Europe & Central Asia,POL,Poland
Middle East & North Africa,SAU,Saudi Arabia
East Asia & Pacific,SGP,Singapore

2025-01-20 17:33:15 - root - INFO - SQL:
-- Query 10: Identify all indicators related to 'birth rate' (corrected)
SELECT DISTINCT series_code, indicator_name
FROM `bigquery-public-data.world_bank_wdi.series_summary`
WHERE LOWER(indicator_name) LIKE '%birth rate%'
LIMIT 1000
Results:
series_code,indicator_name
SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)"

2025-01-20 17:33:17 - root - INFO - SQL:
-- Query 11: Retrieve all years available for crude birth rate data
SELECT DISTINCT year
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE indicator_code = 'SP.DYN.CBRT.IN'
ORDER BY year
LIMIT 1000
Results:
year
1960
1961
1962
1963
1964
1965
1966
1967
1968
1969
1970
1971
1972
1973
1974
1975
1976
1977
1978
1979
1980
1981
1982
1983
1984
1985
1986
1987
1988
1989
1990
1991
1992
1993
1994
1995
1996
1997
1998
1999
2000
2001
2002
2003
2004
2005
2006
2007
2008
2009
2010
2011
2012
2013
2014
2015
2016
2017
2018
2019

2025-01-20 17:33:19 - root - INFO - SQL:
-- Query 12: List high-income countries with their regions and income groups
SELECT country_code, short_name, region, income_group
FROM `bigquery-public-data.world_bank_wdi.country_summary`
WHERE income_group = 'High income'
LIMIT 1000
Results:
country_code,short_name,region,income_group
AND,Andorra,Europe & Central Asia,High income
BMU,Bermuda,North America,High income
CHI,Channel Islands,Europe & Central Asia,High income
CUW,Curaçao,Latin America & Caribbean,High income
CYM,Cayman Islands,Latin America & Caribbean,High income
FRO,Faroe Islands,Europe & Central Asia,High income
GIB,Gibraltar,Europe & Central Asia,High income
GRL,Greenland,Europe & Central Asia,High income
GUM,Guam,East Asia & Pacific,High income
IMN,Isle of Man,Europe & Central Asia,High income
LIE,Liechtenstein,Europe & Central Asia,High income
MAF,St. Martin (French part),Latin America & Caribbean,High income
MCO,Monaco,Europe & Central Asia,High income
MNP,Northern Mariana Islands,East Asia & Pacific,High income
NCL,New Caledonia,East Asia & Pacific,High income
NRU,Nauru,East Asia & Pacific,High income
NZL,New Zealand,East Asia & Pacific,High income
PRI,Puerto Rico,Latin America & Caribbean,High income
PYF,French Polynesia,East Asia & Pacific,High income
SXM,Sint Maarten (Dutch part),Latin America & Caribbean,High income
TCA,Turks and Caicos Islands,Latin America & Caribbean,High income
VGB,British Virgin Islands,Latin America & Caribbean,High income
VIR,Virgin Islands,Latin America & Caribbean,High income
ABW,Aruba,Latin America & Caribbean,High income
ARE,United Arab Emirates,Middle East & North Africa,High income
ATG,Antigua and Barbuda,Latin America & Caribbean,High income
BHR,Bahrain,Middle East & North Africa,High income
BHS,The Bahamas,Latin America & Caribbean,High income
BRB,Barbados,Latin America & Caribbean,High income
BRN,Brunei,East Asia & Pacific,High income
KNA,St. Kitts and Nevis,Latin America & Caribbean,High income
KWT,Kuwait,Middle East & North Africa,High income
MAC,"Macao SAR, China",East Asia & Pacific,High income
OMN,Oman,Middle East & North Africa,High income
PAN,Panama,Latin America & Caribbean,High income
QAT,Qatar,Middle East & North Africa,High income
SMR,San Marino,Europe & Central Asia,High income
TTO,Trinidad and Tobago,Latin America & Caribbean,High income
AUS,Australia,East Asia & Pacific,High income
BEL,Belgium,Europe & Central Asia,High income
CHE,Switzerland,Europe & Central Asia,High income
CYP,Cyprus,Europe & Central Asia,High income

2025-01-20 17:33:21 - root - INFO - SQL:
-- Query 13: Find the maximum crude birth rate value for each high-income country in the 1980s
SELECT ind.country_code, MAX(ind.value) AS max_birth_rate_1980s
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS ind
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
  ON ind.country_code = cs.country_code
WHERE ind.indicator_code = 'SP.DYN.CBRT.IN'
  AND ind.year BETWEEN 1980 AND 1989
  AND cs.income_group = 'High income'
GROUP BY ind.country_code
LIMIT 1000
Results:
country_code,max_birth_rate_1980s
SYC,28.9
OMN,49.744
ABW,22.472
SGP,19.8
CZE,14.9
NLD,12.8
NCL,27.7
NZL,17.5
HKG,17.0
BHR,32.938
BRB,17.698
KNA,29.1
DNK,12.0
LVA,16.1
EST,16.2
PRT,16.2
BHS,26.562
TTO,28.788
CAN,15.4
FRA,14.3
CYP,20.483
MAF,26.1
NOR,14.0
ATG,18.587
ROU,18.0
HUN,13.9
AUT,12.5
BEL,12.6
IMN,12.1
FRO,19.5
DEU,11.4
IRL,21.7
KWT,37.416
LTU,16.7
SAU,44.116
ITA,11.3
BRN,31.899
ESP,15.2
CHE,12.2
VIR,25.8
AND,12.5
JPN,13.5
GRC,15.4
ISR,24.3
USA,16.4
ARE,30.343
PRI,22.8
POL,19.8
QAT,35.107
ISL,19.8
FIN,13.8
PYF,30.789
SVK,19.1
MLT,18.1
GBR,13.8
GUM,28.432
LIE,15.4
CYM,17.6
CHI,12.401
HRV,14.8
AUS,15.8
GRL,22.1
LUX,12.4
SVN,15.7
BMU,15.2
MAC,22.901
CHL,23.555
KOR,22.6
PAN,30.898
SWE,13.7
URY,19.213

2025-01-20 17:33:23 - root - INFO - SQL:
-- Query 14: Get the list of countries and their average crude birth rate across all years
SELECT country_code, AVG(value) AS avg_birth_rate_all_years
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE indicator_code = 'SP.DYN.CBRT.IN'
GROUP BY country_code
LIMIT 1000
Results:
country_code,avg_birth_rate_all_years
MMR,29.78926666666667
NCL,24.564166666666665
NZL,17.22866666666667
NIC,35.691199999999995
NER,54.191649999999996
BRN,28.107916666666668
BGR,12.353333333333333
BDI,46.4368
CPV,34.771100000000004
TLA,27.9558784432641
MNA,34.22670957223581
GNQ,40.463750000000005
KGZ,28.963316666666664
LAO,36.97171666666667
LVA,12.371666666666666
LBN,25.858883333333335
LSO,36.23506666666666
LBR,44.04075000000001
LIE,13.951666666666668
AFW,44.24872749197753
ARB,35.856308956038326
EAR,32.10395486584463
EAS,21.63560707226378
EAP,22.64351816357921
RWA,44.55743333333334
STP,39.79259999999999
SYC,22.222448979591835
SLE,44.259283333333336
NGA,44.081300000000006
OMN,36.28351666666667
TCD,48.202666666666666
CHI,12.540350000000002
COM,41.17566666666667
COD,45.6777
WLD,25.627091395808396
AGO,48.294233333333345
ATG,20.8333
ABW,19.259666666666664
OSS,31.18727590746462
PST,13.876261480410536
PRE,44.52719536166528
EST,12.985000000000003
SWZ,39.82679999999999
FRA,14.246666666666666
GAB,35.29536666666667
GMB,44.86923333333334
ECA,18.188918099032442
TEC,17.78405147678176
FCS,41.32890594892337
HPC,44.12131215103699
HIC,14.545777071593552
MDV,35.93281666666667
MLI,48.355199999999996
MLT,14.548333333333334
MRT,41.09045
MUS,21.486800000000002
SGP,17.08166666666667
SVK,14.943333333333333
SVN,12.856666666666667
SLB,39.36725
ESP,13.506666666666664
PRT,14.463333333333335
PRI,18.839666666666666
QAT,25.218949999999996
HRV,12.379883333333334
CUB,18.350450000000002
CZE,12.681666666666668
GUY,28.997349999999997
HTI,35.52958333333333
HUN,11.996666666666666
TSA,32.13903336144867
SSF,43.30664133679629

2025-01-20 17:33:23 - root - INFO - itercount: 0
2025-01-20 17:33:23 - root - INFO - Database Name: bigquery-public-data
Schema Name: world_bank_global_population
DDL describes table information.
,0
table_name,population_by_country
ddl,"CREATE TABLE `bigquery-public-data.world_bank_global_population.population_by_country`
(
  country STRING,
  country_code STRING,
  year_1960 INT64,
  year_1961 INT64,
  year_1962 INT64,
  year_1963 INT64,
  year_1964 INT64,
  year_1965 INT64,
  year_1966 INT64,
  year_1967 INT64,
  year_1968 INT64,
  year_1969 INT64,
  year_1970 INT64,
  year_1971 INT64,
  year_1972 INT64,
  year_1973 INT64,
  year_1974 INT64,
  year_1975 INT64,
  year_1976 INT64,
  year_1977 INT64,
  year_1978 INT64,
  year_1979 INT64,
  year_1980 INT64,
  year_1981 INT64,
  year_1982 INT64,
  year_1983 INT64,
  year_1984 INT64,
  year_1985 INT64,
  year_1986 INT64,
  year_1987 INT64,
  year_1988 INT64,
  year_1989 INT64,
  year_1990 INT64,
  year_1991 INT64,
  year_1992 INT64,
  year_1993 INT64,
  year_1994 INT64,
  year_1995 INT64,
  year_1996 INT64,
  year_1997 INT64,
  year_1998 INT64,
  year_1999 INT64,
  year_2000 INT64,
  year_2001 INT64,
  year_2002 INT64,
  year_2003 INT64,
  year_2004 INT64,
  year_2005 INT64,
  year_2006 INT64,
  year_2007 INT64,
  year_2008 INT64,
  year_2009 INT64,
  year_2010 INT64,
  year_2011 INT64,
  year_2012 INT64,
  year_2013 INT64,
  year_2014 INT64,
  year_2015 INT64,
  year_2016 INT64,
  year_2017 INT64,
  year_2018 INT64,
  year_2019 INT64
)
PARTITION BY DATE(_PARTITIONTIME);"

Database Name: bigquery-public-data
Schema Name: world_bank_health_population
DDL describes table information.
,0
table_name,series_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.series_summary`
(
  series_code STRING,
  topic STRING,
  indicator_name STRING,
  short_definition STRING,
  long_definition STRING,
  unit_of_measure STRING,
  periodicity STRING,
  base_period INT64,
  other_notes STRING,
  aggregation_method STRING,
  limitations_and_exceptions STRING,
  notes_from_original_source STRING,
  general_comments STRING,
  source STRING,
  statistical_concept_and_methodology STRING,
  development_relevance STRING,
  related_source_links STRING,
  other_web_links STRING,
  related_indicators STRING,
  license_type STRING
)
OPTIONS(
  description=""Series Summary table""
);"

,1
table_name,country_series_definitions
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.country_series_definitions`
(
  country_code STRING,
  series_code STRING,
  description STRING
)
OPTIONS(
  description=""Country Series Definition table""
);"

,2
table_name,series_times
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.series_times`
(
  series_code STRING,
  year INT64,
  description STRING
)
OPTIONS(
  description=""Series Times table""
);"

,3
table_name,country_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.country_summary`
(
  country_code STRING,
  short_name STRING,
  table_name STRING,
  long_name STRING,
  two_alpha_code STRING,
  currency_unit STRING,
  special_notes STRING,
  region STRING,
  income_group STRING,
  wb_2_code STRING,
  national_accounts_base_year STRING,
  national_accounts_reference_year STRING,
  sna_price_valuation STRING,
  lending_category STRING,
  other_groups STRING,
  system_of_national_accounts STRING,
  alternative_conversion_factor STRING,
  ppp_survey_year STRING,
  balance_of_payments_manual_in_use STRING,
  external_debt_reporting_status STRING,
  system_of_trade STRING,
  government_accounting_concept STRING,
  imf_data_dissemination_standard STRING,
  latest_population_census STRING,
  latest_household_survey STRING,
  source_of_most_recent_income_and_expenditure_data STRING,
  vital_registration_complete STRING,
  latest_agricultural_census STRING,
  latest_industrial_data INT64,
  latest_trade_data INT64
)
OPTIONS(
  description=""Country Summary table""
);"

,4
table_name,health_nutrition_population
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.health_nutrition_population`
(
  country_name STRING OPTIONS(description=""""),
  country_code STRING OPTIONS(description=""""),
  indicator_name STRING OPTIONS(description=""""),
  indicator_code STRING OPTIONS(description=""""),
  value FLOAT64 OPTIONS(description=""""),
  year INT64 OPTIONS(description="""")
);"

Database Name: bigquery-public-data
Schema Name: world_bank_intl_debt
DDL describes table information.
,0
table_name,series_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.series_summary`
(
  series_code STRING,
  topic STRING,
  indicator_name STRING,
  short_definition STRING,
  long_definition STRING,
  unit_of_measure STRING,
  periodicity STRING,
  base_period STRING,
  other_notes STRING,
  aggregation_method STRING,
  limitations_and_exceptions STRING,
  notes_from_original_source STRING,
  general_comments STRING,
  source STRING,
  statistical_concept_and_methodology STRING,
  development_relevance STRING,
  related_source_links STRING,
  other_web_links STRING,
  related_indicators STRING,
  license_type STRING
)
OPTIONS(
  description=""Series Summary table""
);"

,1
table_name,country_series_definitions
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.country_series_definitions`
(
  country_code STRING,
  series_code STRING,
  description STRING
)
OPTIONS(
  description=""Country Series Definition table""
);"

,2
table_name,series_times
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.series_times`
(
  series_code STRING,
  year INT64,
  description STRING
)
OPTIONS(
  description=""Series Times table""
);"

,3
table_name,country_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.country_summary`
(
  country_code STRING,
  short_name STRING,
  table_name STRING,
  long_name STRING,
  two_alpha_code STRING,
  currency_unit STRING,
  special_notes STRING,
  region STRING,
  income_group STRING,
  wb_2_code STRING,
  national_accounts_base_year STRING,
  national_accounts_reference_year STRING,
  sna_price_valuation STRING,
  lending_category STRING,
  other_groups STRING,
  system_of_national_accounts STRING,
  alternative_conversion_factor STRING,
  ppp_survey_year STRING,
  balance_of_payments_manual_in_use STRING,
  external_debt_reporting_status STRING,
  system_of_trade STRING,
  government_accounting_concept STRING,
  imf_data_dissemination_standard STRING,
  latest_population_census STRING,
  latest_household_survey STRING,
  source_of_most_recent_Income_and_expenditure_data STRING,
  vital_registration_complete STRING,
  latest_agricultural_census STRING,
  latest_industrial_data INT64,
  latest_trade_data INT64,
  latest_water_withdrawal_data STRING
)
OPTIONS(
  description=""Country Summary table""
);"

,4
table_name,international_debt
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.international_debt`
(
  country_name STRING OPTIONS(description=""""),
  country_code STRING OPTIONS(description=""""),
  indicator_name STRING OPTIONS(description=""""),
  indicator_code STRING OPTIONS(description=""""),
  value FLOAT64 OPTIONS(description=""""),
  year INT64 OPTIONS(description="""")
);"

Database Name: bigquery-public-data
Schema Name: world_bank_intl_education
DDL describes table information.
,0
table_name,series_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_education.series_summary`
(
  series_code STRING,
  topic STRING,
  indicator_name STRING,
  short_definition STRING,
  long_definition STRING,
  unit_of_measure STRING,
  periodicity STRING,
  base_period STRING,
  other_notes STRING,
  aggregation_method STRING,
  limitations_and_exceptions STRING,
  notes_from_original_source STRING,
  general_comments STRING,
  source STRING,
  statistical_concept_and_methodology STRING,
  development_relevance STRING,
  related_source_links STRING,
  other_web_links STRING,
  related_indicators STRING,
  license_type STRING
)
OPTIONS(
  description=""Series Summary table""
);"

,1
table_name,country_series_definitions
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_education.country_series_definitions`
(
  country_code STRING,
  series_code STRING,
  description STRING
)
OPTIONS(
  description=""Country Series Definition table""
);"

,2
table_name,international_education
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_education.international_education`
(
  country_name STRING OPTIONS(description=""""),
  country_code STRING OPTIONS(description=""""),
  indicator_name STRING OPTIONS(description=""""),
  indicator_code STRING OPTIONS(description=""""),
  value FLOAT64 OPTIONS(description=""""),
  year INT64 OPTIONS(description="""")
);"

,3
table_name,country_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_education.country_summary`
(
  country_code STRING,
  short_name STRING,
  table_name STRING,
  long_name STRING,
  two_alpha_code STRING,
  currency_unit STRING,
  special_notes STRING,
  region STRING,
  income_group STRING,
  wb_two_code STRING,
  national_accounts_base_year STRING,
  national_accounts_reference_year STRING,
  sna_price_valuation STRING,
  lending_category STRING,
  other_groups STRING,
  system_of_national_accounts STRING,
  alternative_conversion_factor STRING,
  ppp_survey_year STRING,
  balance_of_payments_manual_in_use STRING,
  external_debt_reporting_status STRING,
  system_of_trade STRING,
  government_accounting_concept STRING,
  imf_data_dissemination_standard STRING,
  latest_population_census STRING,
  latest_household_survey STRING,
  source_of_most_recent_income_and_expenditure_data STRING,
  vital_registration_complete STRING,
  latest_agricultural_census STRING,
  latest_industrial_data INT64,
  latest_trade_data INT64,
  latest_water_withdrawal_data STRING
)
OPTIONS(
  description=""Country Summary table""
);"

Database Name: bigquery-public-data
Schema Name: world_bank_wdi
DDL describes table information.
,0
table_name,series_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.series_summary`
(
  series_code STRING OPTIONS(description=""A number or a sequence of related statistical units arranged or occurring in temporal spatial or other order or succession. WDI carries mostly time series.""),
  topic STRING OPTIONS(description=""The matter dealt with in the context discourse or subject related to the series.""),
  indicator_name STRING OPTIONS(description=""Given name of a series.""),
  short_definition STRING OPTIONS(description=""Short statement of the exact meaning of a series.""),
  long_definition STRING OPTIONS(description=""Extended statement of the exact meaning of a series.""),
  unit_of_measure STRING OPTIONS(description=""A quantity used as a standard of measurement. Example: Units of time are second minute hour day week month year and decade.""),
  periodicity STRING OPTIONS(description=""Applies to series recurring at regular intervals. Most of the time this term denotes that interval of recurrence.""),
  base_period STRING OPTIONS(description=""Base period is the period of time for which data is used as the base of an index number or other ratio have been collected. This period is frequently one of a year but it may be as short as one day or as long as the average of a group of years.""),
  other_notes STRING OPTIONS(description=""A brief record of facts topics or thoughts written down and used to contextualize the series definition values and other characteristics.""),
  aggregation_method STRING OPTIONS(description=""Aggregation methods are types of calculations used to group attribute values into a metric for each dimension value. For example for each region one may retrieve the total value of country entries (the sum of the series value for countries belonging to the region).""),
  limitations_and_exceptions STRING OPTIONS(description=""A limiting rule or circumstance that applies to usage of the series such as the scope of the survey collecting the data or missing years and countries.  It should also note when data are imputed or estimated""),
  notes_from_original_source STRING OPTIONS(description=""A brief record of facts topics or thoughts written down and used to contextualize the series definition values and other characteristics.""),
  general_comments STRING OPTIONS(description=""Other notes regarding the series which do not appear in Development relevance or Limitations or exceptions""),
  source STRING OPTIONS(description=""A place person or organization from which the series comes or can be obtained.""),
  statistical_concept_and_methodology STRING OPTIONS(description=""The abstract idea general statistical notions or a system of methods used to generate the series.""),
  development_relevance STRING OPTIONS(description=""The relevance of a series refers to how the indicator’s data may be used to monitor particular aspects of development goals and programs for example the Sustainable Development Goals. The indicator may conclusively measure progress towards a particular objective or may act as a proxy or interpretation of a development aim.""),
  related_source_links STRING OPTIONS(description=""Internet address of related source page tool or knowledge base.""),
  other_web_links STRING OPTIONS(description=""Internet addresses of related pages tools or knowledge bases.""),
  related_indicators STRING OPTIONS(description=""In general indicator that are of interest and related to the specific series.""),
  license_type STRING OPTIONS(description=""Explains the rights conferred and restrictions imposed by the owner to the users of a series"")
);"

,1
table_name,country_series_definitions
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.country_series_definitions`
(
  country_code STRING OPTIONS(description=""""),
  series_code STRING OPTIONS(description=""""),
  description STRING OPTIONS(description="""")
);"

,2
table_name,footnotes
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.footnotes`
(
  country_code STRING OPTIONS(description=""""),
  series_code STRING OPTIONS(description=""""),
  year STRING OPTIONS(description=""""),
  description STRING OPTIONS(description="""")
);"

,3
table_name,series_time
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.series_time`
(
  series_code STRING OPTIONS(description=""""),
  year INT64 OPTIONS(description=""""),
  description STRING OPTIONS(description="""")
);"

,4
table_name,indicators_data
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.indicators_data`
(
  country_name STRING OPTIONS(description=""""),
  country_code STRING OPTIONS(description=""""),
  indicator_name STRING OPTIONS(description=""""),
  indicator_code STRING OPTIONS(description=""""),
  value FLOAT64 OPTIONS(description=""""),
  year INT64 OPTIONS(description="""")
);"

,5
table_name,country_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.country_summary`
(
  country_code STRING OPTIONS(description=""A short alphabetic or numeric geographical code representing a specific country or area. In April 2016 WDI has adopted the three digit ISO code to identify countries in its databases.""),
  short_name STRING OPTIONS(description=""Country name the country's official name as approved by the relevant body (Italy is used as an example): conventional short form (Italy).""),
  table_name STRING OPTIONS(description=""Country name the country's name as approved by the relevant body (Italy is used as an example): conventional short form (Republic of Italy).""),
  long_name STRING OPTIONS(description=""Country name the country's name as approved by the relevant body (Italy is used as an example): conventional long form (Republic of Italy).""),
  two_alpha_code STRING OPTIONS(description=""ISO-2 digit alpha code value of the country. Re: www.iso.org""),
  currency_unit STRING OPTIONS(description=""Currency unit (such as the dollar euro peso rupee) issued as a coin or banknote a standard unit of value and a unit of account.""),
  special_notes STRING OPTIONS(description=""Country special notes for data and metadata users.""),
  region STRING OPTIONS(description=""World Bank region to which a country belongs.""),
  income_group STRING OPTIONS(description=""World Bank income group to which a country belongs after the country classification is completed every year.""),
  wb_2_code STRING OPTIONS(description=""World Bank 2 digit code value of the country.""),
  national_accounts_base_year STRING OPTIONS(description=""Base year is the base or pricing period used for constant price calculations in the country’s national accounts. Price indexes derived from national accounts aggregates such as the implicit deflator for gross domestic product (GDP) express the price level relative to base year prices.""),
  national_accounts_reference_year STRING OPTIONS(description=""Reference year is the year in which the local currency constant price series of a country is valued. The reference year is usually the same as the base year used to report the constant price series. However when the constant price data are chain linked the base year is changed annually so the data are rescaled to a specific reference year to provide a consistent time series. When the country has not rescaled following a change in base year World Bank staff rescale the data to maintain a longer historical series. To allow for cross-country comparison and data aggregation constant price data reported in World Development Indicators are rescaled to a common reference year (2010) and currency (U.S. dollars).""),
  sna_price_valuation STRING OPTIONS(description=""SNA price valuation shows whether value added in the national accounts is reported at basic prices (B) or producer prices (P). Producer prices include taxes paid by producers and thus tend to overstate the actual value added in production. However value added can be higher at basic prices than at producer prices in countries with high agricultural subsidies.""),
  lending_category STRING OPTIONS(description=""World Bank lending category to which a country belongs after the operational guidelines are completed every year.""),
  other_groups STRING OPTIONS(description=""Other types of grouping approved by the WDI team.""),
  system_of_national_accounts STRING OPTIONS(description=""System of National Accounts identifies whether a country uses the 1968 1993 or 2008 System of National Accounts (SNA). The 2008 SNA is an update of the 1993 SNA and retains its basic theoretical framework.""),
  alternative_conversion_factor STRING OPTIONS(description=""Alternative conversion factor identifies the countries and years for which a World Bank–estimated conversion factor has been used in place of the official exchange rate (line rf in the International Monetary Fund’s [IMF] International Financial Statistics). See later in Sources and methods for further discussion of alternative conversion factors.""),
  ppp_survey_year STRING OPTIONS(description=""Purchasing power parity (PPP) survey year is the latest available survey year for the International Comparison Program’s estimates of PPPs.""),
  balance_of_payments_manual_in_use STRING OPTIONS(description=""Balance of Payments Manual in use refers to the classification system used to compile and report data on balance of payments. 6 refers to the 6th edition of the IMF’s Balance of Payments Manual (2009).""),
  external_debt_reporting_status STRING OPTIONS(description=""External debt shows debt reporting status for 2016 data. A indicates that data are as reported P that data are based on reported or collected information but include an element of staff estimation and E that data are World Bank staff estimates.""),
  system_of_trade STRING OPTIONS(description=""System of trade refers to the United Nations general trade system (G) or special trade system (S). Under the general trade system goods entering directly for domestic consumption and goods entered into customs storage are recorded as imports at arrival. Under the special trade system goods are recorded as imports when declared for domestic consumption whether at time of entry or on withdrawal from customs storage.""),
  government_accounting_concept STRING OPTIONS(description=""Government finance accounting concept is the accounting basis for reporting central government financial data. For most countries government finance data have been consolidated (C) into one set of accounts capturing all central government fiscal activities. Budgetary central government accounts (B) exclude some central government units.""),
  imf_data_dissemination_standard STRING OPTIONS(description=""IMF data dissemination standard shows the countries that subscribe to the IMF’s Special Data Dissemination Standard (S) or Enhanced General Data Dissemination System (e-GDDS). S refers to countries that subscribe to the SDDS and have posted data on the Dissemination Standards Bulletin Board at http://dsbb.imf.org. S+ countries must observe additional coverage periodicity and timeliness requirements. e-G refers to countries that subscribe to the e-GDDS.""),
  latest_population_census STRING OPTIONS(description=""Latest population census shows the most recent year in which a census was conducted and in which at least preliminary results have been released. The preliminary results from the very recent censuses could be reflected in timely revisions if basic data are available such as population by age and sex as well as the detailed definition of counting coverage and completeness.""),
  latest_household_survey STRING OPTIONS(description=""Latest demographic education or health household survey indicates the household surveys used to compile the demographic education and health data. Detailed information on each survey is provided through the following links:  AIDS Indicator Survey Demographic and Health Survey Health Issues Survey and Malaria Indicator Survey - www.dhsprogram.com; Living Standards Measurement Study -  www.worldbank.org/lsms; Multiple Indicator Cluster Survey - http://mics.unicef.org; Reproductive Health Survey -  www.cdc.gov/reproductivehealth; World Health Survey is available at - www.who.int/healthinfo/survey/en.""),
  source_of_most_recent_income_and_expenditure_data STRING OPTIONS(description=""Source of most recent income and expenditure data shows household surveys that collect income and expenditure data. Names and detailed information on household surveys can be found on the website of the International Household Survey Network (www.surveynetwork.org). Core Welfare Indicator Questionnaire Surveys (CWIQ) developed by the World Bank measure changes in key social indicators for different population groups—specifically indicators of access utilization and satisfaction with core social and economic services. Expenditure survey/budget surveys (ES/BS) collect detailed information on household consumption as well as on general demographic social and economic characteristics. Integrated household surveys (IHS) collect detailed information on a wide variety of topics including health education economic activities housing and utilities.""),
  vital_registration_complete STRING OPTIONS(description=""Vital registration complete identifies countries that report at least 90 percent complete registries of vital (birth and death) statistics to the United Nations Statistics Division and are reported in its Population and Vital Statistics Reports. Countries with complete vital statistics registries may have more accurate and more timely demographic indicators than other countries.""),
  latest_agricultural_census STRING OPTIONS(description=""Latest agricultural census shows the most recent year in which an agricultural census was conducted or planned to be conducted as reported to the Food and Agriculture Organization.""),
  latest_industrial_data STRING OPTIONS(description=""Latest industrial data show the most recent year for which manufacturing value added data at the three-digit level of the International Standard Industrial Classification (revision 2 or 3) are available in the United Nations Industrial Development Organization database.""),
  latest_trade_data STRING OPTIONS(description=""Latest trade data show the most recent year for which structure of merchandise trade data from the United Nations Statistics Division’s Commodity Trade (Comtrade) database are available."")
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'world_bank_global_population': ['population_by_country'], 'world_bank_health_population': ['country_series_definitions', 'country_summary', 'health_nutrition_population', 'series_summary', 'series_times'], 'world_bank_intl_debt': ['country_series_definitions', 'country_summary', 'international_debt', 'series_summary', 'series_times'], 'world_bank_intl_education': ['country_series_definitions', 'country_summary', 'international_education', 'series_summary'], 'world_bank_wdi': ['country_series_definitions', 'country_summary', 'footnotes', 'indicators_data', 'series_summary', 'series_time']}}
Begin Exploring Related Columns
**Relevant columns and their potential usage:**

- **`indicators_data.indicator_code`**: To select data specifically for "Crude birth rate".
- **`indicators_data.value`**: Contains the crude birth rate values.
- **`indicators_data.year`**: To filter data for the years in the 1980s (1980-1989).
- **`country_summary.country_code`**: Used to join with `indicators_data` on country code.
- **`country_summary.income_group`**: To filter for "High income" countries.
- **`country_summary.region`**: To get the region associated with each country.

**Conditions that may be used:**

- **Filter by `indicator_code`** matching the code for "Crude birth rate".
- **Filter by `year`** between 1980 and 1989 to focus on the 1980s.
- **Filter by `income_group`** equal to "High income" to select high-income countries.

---

**SQL Queries:**

1. **Find the indicator codes related to crude birth rate:**
   ```sql
   SELECT DISTINCT indicator_code, indicator_name
   FROM `bigquery-public-data.world_bank_wdi.series_summary`
   WHERE LOWER(indicator_name) LIKE '%crude birth rate%'
   LIMIT 1000;
   ```

2. **List all income groups available:**
   ```sql
   SELECT DISTINCT income_group
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   LIMIT 1000;
   ```

3. **List all regions available:**
   ```sql
   SELECT DISTINCT region
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   LIMIT 1000;
   ```

4. **Get country codes and names of high-income countries:**
   ```sql
   SELECT country_code, short_name
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   WHERE income_group = 'High income'
   LIMIT 1000;
   ```

5. **Retrieve crude birth rate data for the 1980s:**
   ```sql
   SELECT country_code, year, value
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE indicator_code = 'SP.DYN.CBRT.IN'
     AND year BETWEEN 1980 AND 1989
   LIMIT 1000;
   ```

6. **Get crude birth rate values for high-income countries in the 1980s:**
   ```sql
   SELECT indicators_data.country_code, indicators_data.year, indicators_data.value
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS indicators_data
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS country_summary
     ON indicators_data.country_code = country_summary.country_code
   WHERE indicators_data.indicator_code = 'SP.DYN.CBRT.IN'
     AND indicators_data.year BETWEEN 1980 AND 1989
     AND country_summary.income_group = 'High income'
   LIMIT 1000;
   ```

7. **Calculate the average crude birth rate for each country in the 1980s:**
   ```sql
   SELECT country_code, AVG(value) AS avg_birth_rate
   FROM `bigquery-public-data.world_bank_wdi.indicators_data`
   WHERE indicator_code = 'SP.DYN.CBRT.IN'
     AND year BETWEEN 1980 AND 1989
   GROUP BY country_code
   LIMIT 1000;
   ```

8. **List regions associated with high-income countries:**
   ```sql
   SELECT DISTINCT region, short_name
   FROM `bigquery-public-data.world_bank_wdi.country_summary`
   WHERE income_group = 'High income'
   LIMIT 1000;
   ```

9. **Find the average crude birth rate for high-income countries with country names:**
   ```sql
   SELECT indicators_data.country_code, country_summary.short_name, AVG(indicators_data.value) AS avg_birth_rate
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS indicators_data
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS country_summary
     ON indicators_data.country_code = country_summary.country_code
   WHERE indicators_data.indicator_code = 'SP.DYN.CBRT.IN'
     AND indicators_data.year BETWEEN 1980 AND 1989
     AND country_summary.income_group = 'High income'
   GROUP BY indicators_data.country_code, country_summary.short_name
   LIMIT 1000;
   ```

10. **List the regions and their corresponding high-income countries:**
    ```sql
    SELECT country_summary.region, country_summary.country_code, country_summary.short_name
    FROM `bigquery-public-data.world_bank_wdi.country_summary`
    WHERE income_group = 'High income'
    LIMIT 1000;
    ```

11. **Identify all indicators related to 'birth rate':**
    ```sql
    SELECT DISTINCT indicator_code, indicator_name
    FROM `bigquery-public-data.world_bank_wdi.indicators_data`
    WHERE LOWER(indicator_name) LIKE '%birth rate%'
    LIMIT 1000;
    ```

12. **Retrieve all years available for crude birth rate data:**
    ```sql
    SELECT DISTINCT year
    FROM `bigquery-public-data.world_bank_wdi.indicators_data`
    WHERE indicator_code = 'SP.DYN.CBRT.IN'
    ORDER BY year
    LIMIT 1000;
    ```

13. **List high-income countries with their regions and income groups:**
    ```sql
    SELECT country_code, short_name, region, income_group
    FROM `bigquery-public-data.world_bank_wdi.country_summary`
    WHERE income_group = 'High income'
    LIMIT 1000;
    ```

14. **Find the maximum crude birth rate value for each high-income country in the 1980s:**
    ```sql
    SELECT country_code, MAX(value) AS max_birth_rate_1980s
    FROM `bigquery-public-data.world_bank_wdi.indicators_data`
    WHERE indicator_code = 'SP.DYN.CBRT.IN'
      AND year BETWEEN 1980 AND 1989
    GROUP BY country_code
    LIMIT 1000;
    ```

15. **Get the list of countries and their average crude birth rate across all years:**
    ```sql
    SELECT country_code, AVG(value) AS avg_birth_rate_all_years
    FROM `bigquery-public-data.world_bank_wdi.indicators_data`
    WHERE indicator_code = 'SP.DYN.CBRT.IN'
    GROUP BY country_code
    LIMIT 1000;
    ```

These queries will help in understanding the values in related columns and retrieving data necessary to determine which high-income country had the highest average crude birth rate in each region during the 1980s.Query:
SELECT ind.country_code, cs.short_name, AVG(ind.value) AS avg_birth_rate
   FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS ind
   JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
     ON ind.country_code = cs.country_code
   WHERE ind.indicator_code = 'SP.DYN.CBRT.IN'
     AND ind.year BETWEEN 1980 AND 1989
     AND cs.income_group = 'High income'
   GROUP BY ind.country_code, cs.short_name
   LIMIT 1000;
Answer:
country_code,short_name,avg_birth_rate
FIN,Finland,13.0
SVN,Slovenia,13.739999999999998
ESP,Spain,12.350000000000001
CYP,Cyprus,20.0695
DEU,Germany,10.93
TTO,Trinidad and Tobago,26.4283
URY,Uruguay,18.429100000000002
CHI,Channel Islands,11.834700000000002
EST,Estonia,15.67
CZE,Czech Republic,13.31
CHE,Switzerland,11.739999999999998
BMU,Bermuda,15.066666666666666
NCL,New Caledonia,25.310000000000002
BRN,Brunei,30.5327
MAC,"Macao SAR, China",20.7301
POL,Poland,17.880000000000003
PRT,Portugal,13.75
BEL,Belgium,12.07
IRL,Ireland,18.19
LTU,Lithuania,15.889999999999999
LIE,Liechtenstein,14.09
FRA,France,14.05
ROU,Romania,16.160000000000004
CAN,Canada,14.899999999999999
SGP,Singapore,17.08
PRI,Puerto Rico,20.200000000000003
ISR,Israel,23.38
KWT,Kuwait,32.1141
HKG,"Hong Kong SAR, China",14.55
AUT,Austria,11.83
KNA,St. Kitts and Nevis,24.45
LVA,Latvia,15.26
FRO,Faroe Islands,16.97
GRL,Greenland,20.66
OMN,Oman,45.970200000000006
PYF,French Polynesia,30.2622
MLT,Malta,16.5
HRV,Croatia,13.440000000000001
ITA,Italy,10.389999999999999
HUN,Hungary,12.31
GRC,Greece,12.45
JPN,Japan,11.99
GBR,United Kingdom,13.260000000000002
VIR,Virgin Islands,24.009999999999998
SAU,Saudi Arabia,41.0283
MAF,St. Martin (French part),24.299999999999997
LUX,Luxembourg,11.72
SYC,Seychelles,25.779999999999998
ABW,Aruba,21.619100000000003
USA,United States,15.83
DNK,Denmark,10.77
QAT,Qatar,29.6878
GUM,Guam,27.2331
ATG,Antigua and Barbuda,18.3937
SVK,Slovak Republic,17.330000000000002
ISL,Iceland,17.84
BRB,Barbados,17.069700000000005
ARE,United Arab Emirates,29.4277
AUS,Australia,15.35
NZL,New Zealand,16.38
BHR,Bahrain,32.166199999999996
CYM,Cayman Islands,16.84
Query:
-- Query 1: List all income groups available
SELECT DISTINCT income_group
FROM `bigquery-public-data.world_bank_wdi.country_summary`
LIMIT 1000
Answer:
income_group
""
High income
Low income
Upper middle income
Lower middle income
Query:
-- Query 2: List all regions available
SELECT DISTINCT region
FROM `bigquery-public-data.world_bank_wdi.country_summary`
LIMIT 1000
Answer:
region
""
Europe & Central Asia
North America
Latin America & Caribbean
East Asia & Pacific
Sub-Saharan Africa
Middle East & North Africa
South Asia
Query:
-- Query 3: Get country codes and names of high-income countries
SELECT country_code, short_name
FROM `bigquery-public-data.world_bank_wdi.country_summary`
WHERE income_group = 'High income'
LIMIT 1000
Answer:
country_code,short_name
AND,Andorra
BMU,Bermuda
CHI,Channel Islands
CUW,Curaçao
CYM,Cayman Islands
FRO,Faroe Islands
GIB,Gibraltar
GRL,Greenland
GUM,Guam
IMN,Isle of Man
LIE,Liechtenstein
MAF,St. Martin (French part)
MCO,Monaco
MNP,Northern Mariana Islands
NCL,New Caledonia
NRU,Nauru
NZL,New Zealand
PRI,Puerto Rico
PYF,French Polynesia
SXM,Sint Maarten (Dutch part)
TCA,Turks and Caicos Islands
VGB,British Virgin Islands
VIR,Virgin Islands
ABW,Aruba
ARE,United Arab Emirates
ATG,Antigua and Barbuda
BHR,Bahrain
BHS,The Bahamas
BRB,Barbados
BRN,Brunei
KNA,St. Kitts and Nevis
KWT,Kuwait
MAC,"Macao SAR, China"
OMN,Oman
PAN,Panama
QAT,Qatar
SMR,San Marino
TTO,Trinidad and Tobago
AUS,Australia
BEL,Belgium
CHE,Switzerland
CYP,Cyprus
EST,Estonia
GBR,United Kingdom
GRC,Greece
HKG,"Hong Kong SAR, China"
HRV,Croatia
HUN,Hungary
IRL,Ireland
ISL,Iceland
ISR,Israel
KOR,Korea
MLT,Malta
NOR,Norway
POL,Poland
SAU,Saudi Arabia
SGP,Singapore
SYC,Seychelles
URY,Uruguay
AUT,Austria
CAN,Canada
CHL,Chile
CZE,Czech Republic
DEU,Germany
DNK,Denmark
ESP,Spain
FIN,Finland
FRA,France
ITA,Italy
JPN,Japan
LTU,Lithuania
LUX,Luxembourg
LVA,Latvia
NLD,Netherlands
PRT,Portugal
ROU,Romania
SVK,Slovak Republic
SVN,Slovenia
SWE,Sweden
USA,United States
Query:
-- Query 4: Retrieve crude birth rate data for the 1980s
SELECT country_code, year, value
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE indicator_code = 'SP.DYN.CBRT.IN'
  AND year BETWEEN 1980 AND 1989
LIMIT 1000
Answer:
country_code,year,value
BDI,1988,50.961
TLA,1988,28.349434569775
MNA,1981,41.1889494231624
EAR,1984,35.90671608227
EAP,1986,24.4306614211465
SYC,1980,28.9
OMN,1985,46.163
ABW,1987,21.008
OSS,1988,33.4464059193206
PRE,1984,46.5906908668772
MLI,1988,48.746
SGP,1983,16.3
SLB,1986,41.331
CZE,1984,13.3
HTI,1981,42.401
TSA,1981,37.2033506788069
LCA,1988,29.804
SYR,1981,44.064
IRQ,1983,38.969
VEN,1987,30.205
VNM,1981,31.68
NLD,1981,12.5
NCL,1986,24.9
NZL,1983,15.8
NER,1986,56.178
LAC,1981,32.1233804270661
LBR,1981,48.555
EAS,1981,23.0637636998303
SYC,1981,28.1
PNG,1981,39.016
FCS,1981,44.1926831101688
HIC,1987,14.1807644876801
GUY,1981,30.926
HKG,1981,16.8
BHR,1980,32.931
BRB,1988,16.407
KNA,1983,24.1
KNA,1985,23.1
MNE,1988,17.089
NER,1983,56.634
MNA,1982,40.855130241805
DNK,1982,10.3
LVA,1983,15.9
WSM,1983,36.047
CAF,1981,42.163
AFG,1982,50.098
AGO,1985,50.663
EST,1987,16.2
EUU,1980,13.9675011570752
MRT,1983,42.492
PRT,1981,15.4
GNB,1980,48.73
HTI,1983,42.429
BHS,1985,25.819
BLR,1985,16.5
KNA,1980,26.8
SUR,1989,28.295
IBT,1984,30.3249708951953
IDX,1986,43.4844843508447
TTO,1988,23.181
UZB,1984,36.3
MMR,1989,28.222
CAN,1983,15.0
LAC,1985,29.9974830347845
LIC,1980,46.2294380010898
LMC,1983,36.5338248511245
DMA,1982,23.3
AFE,1980,46.1453277375565
ALB,1983,26.528
FRA,1984,14.3
SLB,1984,41.954
CYP,1981,20.168
TSA,1984,36.1731485377014
MAF,1988,25.5
IBT,1988,29.6891660619559
IRN,1980,44.108
ZMB,1983,47.053
BGR,1985,13.3
TLA,1985,30.0353211355085
DJI,1989,39.979
RWA,1984,52.454
NOR,1983,12.1
COD,1980,46.296
ATG,1989,18.587
SWZ,1983,47.211
SWZ,1989,39.87
ETH,1986,48.712
EUU,1981,13.5934870018468
ROU,1982,15.3
HUN,1983,11.9
Query:
-- Query 5: Get crude birth rate values for high-income countries in the 1980s
SELECT ind.country_code, ind.year, ind.value
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS ind
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
  ON ind.country_code = cs.country_code
WHERE ind.indicator_code = 'SP.DYN.CBRT.IN'
  AND ind.year BETWEEN 1980 AND 1989
  AND cs.income_group = 'High income'
LIMIT 1000
Answer:
country_code,year,value
FIN,1987,12.1
SVN,1982,15.1
ESP,1980,15.2
CYP,1985,20.34
DEU,1989,11.2
TTO,1981,28.788
URY,1983,18.368
CHI,1980,11.531
EST,1988,16.0
CZE,1989,12.4
CHE,1984,11.6
BMU,1984,15.1
NCL,1982,26.3
BRN,1986,30.121
MAC,1987,22.33
POL,1982,19.5
PRT,1986,12.6
BEL,1984,11.7
IRL,1984,18.1
BRN,1980,31.899
LTU,1988,15.5
BEL,1981,12.6
IRL,1982,20.3
LIE,1988,14.9
CHI,1989,12.401
FRA,1987,14.0
ROU,1981,17.0
IRL,1988,15.5
CAN,1982,15.1
CZE,1988,12.8
IRL,1989,14.8
BRN,1983,30.677
SGP,1988,19.8
PRI,1984,19.3
PRI,1989,19.1
ISR,1980,24.3
ISR,1989,22.3
KWT,1985,32.161
LTU,1984,16.4
HKG,1989,12.3
AUT,1987,11.4
ESP,1981,14.1
CZE,1983,13.3
KNA,1987,23.6
DEU,1988,11.4
URY,1986,18.155
LVA,1981,14.2
LTU,1986,16.7
FRO,1985,16.3
CHE,1982,11.7
CHE,1986,11.7
GRL,1980,20.6
CAN,1989,14.9
LVA,1989,14.6
OMN,1981,49.322
PYF,1980,30.789
MLT,1981,16.6
MLT,1986,15.3
PRT,1980,16.2
HRV,1984,13.9
KNA,1982,29.1
KNA,1986,23.0
ITA,1986,9.8
LIE,1985,13.9
EST,1980,15.0
PRI,1982,21.05
HUN,1980,13.9
BEL,1985,11.6
GRC,1984,12.7
JPN,1980,13.5
POL,1988,15.6
GBR,1980,13.4
VIR,1986,23.65
SAU,1989,36.82
FIN,1986,12.3
MAC,1985,22.901
MAF,1986,23.9
GRL,1983,19.1
LIE,1980,15.4
LUX,1985,11.2
SYC,1983,25.8
ABW,1985,21.726
EST,1981,15.4
EST,1983,16.0
FRO,1981,17.2
MLT,1982,18.1
PRT,1989,11.8
GRC,1983,13.5
ITA,1981,11.0
USA,1985,15.8
DNK,1985,10.5
LUX,1983,11.4
QAT,1982,33.485
DEU,1985,10.5
GUM,1984,27.22
USA,1988,16.0
Query:
-- Query 6: Calculate the average crude birth rate for each country in the 1980s
SELECT country_code, AVG(value) AS avg_birth_rate
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE indicator_code = 'SP.DYN.CBRT.IN'
  AND year BETWEEN 1980 AND 1989
GROUP BY country_code
LIMIT 1000
Answer:
country_code,avg_birth_rate
BDI,51.3044
TLA,30.27478644193387
MNA,38.90497580367373
EAR,35.44338867101696
EAP,23.77923550301364
SYC,25.779999999999998
OMN,45.970200000000006
ABW,21.619100000000003
OSS,34.337881483810925
PRE,46.44554769910849
MLI,49.1053
SGP,17.08
SLB,42.008300000000006
CZE,13.31
HTI,41.0126
TSA,35.748496308582276
LCA,32.271100000000004
SYR,41.164300000000004
IRQ,38.7932
VEN,31.0263
VNM,30.669600000000003
NLD,12.42
NCL,25.310000000000002
NZL,16.38
NER,56.31139999999999
LAC,30.22609245479991
LBR,47.5794
EAS,22.60836527876417
PNG,37.1993
FCS,43.25660731556301
HIC,14.68225985890935
GUY,29.8218
HKG,14.55
BHR,32.166199999999996
BRB,17.069700000000005
KNA,24.45
MNE,17.923299999999998
DNK,10.77
LVA,15.26
WSM,35.4043
CAF,42.3932
AFG,49.7501
AGO,50.497099999999996
EST,15.67
EUU,13.00519829305529
MRT,42.0237
PRT,13.75
GNB,48.9168
BHS,25.617099999999997
BLR,16.4277
SUR,29.2968
IBT,30.387631580650208
IDX,43.91645773871377
TTO,26.4283
UZB,35.68000000000001
MMR,32.0205
CAN,14.899999999999999
LIC,45.811379889569125
LMC,35.66439327704011
DMA,23.216666666666665
AFE,45.22247374583799
ALB,26.3149
FRA,14.05
CYP,20.0695
MAF,24.299999999999997
IRN,41.334399999999995
ZMB,46.7965
BGR,13.52
DJI,40.53260000000001
RWA,51.6686
NOR,12.709999999999999
COD,46.183499999999995
ATG,18.3937
SWZ,45.0718
ETH,48.7467
ROU,16.160000000000004
HUN,12.31
AUT,11.83
BEL,12.07
TGO,44.9041
IMN,11.625
JAM,27.5404
VUT,37.6992
NAM,40.1592
LDC,44.39129228151326
LSO,39.406099999999995
MKD,19.8519
CHN,21.224000000000004
FRO,16.97
SOM,45.5933
SST,32.652219999619874
SDN,43.438300000000005
Query:
-- Query 7: List regions associated with high-income countries
SELECT DISTINCT region, short_name
FROM `bigquery-public-data.world_bank_wdi.country_summary`
WHERE income_group = 'High income'
LIMIT 1000
Answer:
region,short_name
Europe & Central Asia,Andorra
North America,Bermuda
Europe & Central Asia,Channel Islands
Latin America & Caribbean,Curaçao
Latin America & Caribbean,Cayman Islands
Europe & Central Asia,Faroe Islands
Europe & Central Asia,Gibraltar
Europe & Central Asia,Greenland
East Asia & Pacific,Guam
Europe & Central Asia,Isle of Man
Europe & Central Asia,Liechtenstein
Latin America & Caribbean,St. Martin (French part)
Europe & Central Asia,Monaco
East Asia & Pacific,Northern Mariana Islands
East Asia & Pacific,New Caledonia
East Asia & Pacific,Nauru
East Asia & Pacific,New Zealand
Latin America & Caribbean,Puerto Rico
East Asia & Pacific,French Polynesia
Latin America & Caribbean,Sint Maarten (Dutch part)
Latin America & Caribbean,Turks and Caicos Islands
Latin America & Caribbean,British Virgin Islands
Latin America & Caribbean,Virgin Islands
Latin America & Caribbean,Aruba
Middle East & North Africa,United Arab Emirates
Latin America & Caribbean,Antigua and Barbuda
Middle East & North Africa,Bahrain
Latin America & Caribbean,The Bahamas
Latin America & Caribbean,Barbados
East Asia & Pacific,Brunei
Latin America & Caribbean,St. Kitts and Nevis
Middle East & North Africa,Kuwait
East Asia & Pacific,"Macao SAR, China"
Middle East & North Africa,Oman
Latin America & Caribbean,Panama
Middle East & North Africa,Qatar
Europe & Central Asia,San Marino
Latin America & Caribbean,Trinidad and Tobago
East Asia & Pacific,Australia
Europe & Central Asia,Belgium
Europe & Central Asia,Switzerland
Europe & Central Asia,Cyprus
Europe & Central Asia,Estonia
Europe & Central Asia,United Kingdom
Europe & Central Asia,Greece
East Asia & Pacific,"Hong Kong SAR, China"
Europe & Central Asia,Croatia
Europe & Central Asia,Hungary
Europe & Central Asia,Ireland
Europe & Central Asia,Iceland
Middle East & North Africa,Israel
East Asia & Pacific,Korea
Middle East & North Africa,Malta
Europe & Central Asia,Norway
Europe & Central Asia,Poland
Middle East & North Africa,Saudi Arabia
East Asia & Pacific,Singapore
Sub-Saharan Africa,Seychelles
Latin America & Caribbean,Uruguay
Europe & Central Asia,Austria
North America,Canada
Latin America & Caribbean,Chile
Europe & Central Asia,Czech Republic
Europe & Central Asia,Germany
Europe & Central Asia,Denmark
Europe & Central Asia,Spain
Europe & Central Asia,Finland
Europe & Central Asia,France
Europe & Central Asia,Italy
East Asia & Pacific,Japan
Europe & Central Asia,Lithuania
Europe & Central Asia,Luxembourg
Europe & Central Asia,Latvia
Europe & Central Asia,Netherlands
Europe & Central Asia,Portugal
Europe & Central Asia,Romania
Europe & Central Asia,Slovak Republic
Europe & Central Asia,Slovenia
Europe & Central Asia,Sweden
Query:
-- Query 8: Find the average crude birth rate for high-income countries with country names
SELECT ind.country_code, cs.short_name, AVG(ind.value) AS avg_birth_rate
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS ind
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
  ON ind.country_code = cs.country_code
WHERE ind.indicator_code = 'SP.DYN.CBRT.IN'
  AND ind.year BETWEEN 1980 AND 1989
  AND cs.income_group = 'High income'
GROUP BY ind.country_code, cs.short_name
LIMIT 1000
Answer:
country_code,short_name,avg_birth_rate
SYC,Seychelles,25.779999999999998
OMN,Oman,45.970200000000006
ABW,Aruba,21.619100000000003
SGP,Singapore,17.08
CZE,Czech Republic,13.31
NLD,Netherlands,12.42
NCL,New Caledonia,25.310000000000002
NZL,New Zealand,16.38
HKG,"Hong Kong SAR, China",14.55
BHR,Bahrain,32.166199999999996
BRB,Barbados,17.069700000000005
KNA,St. Kitts and Nevis,24.45
DNK,Denmark,10.77
LVA,Latvia,15.26
EST,Estonia,15.67
PRT,Portugal,13.75
BHS,The Bahamas,25.617099999999997
TTO,Trinidad and Tobago,26.4283
CAN,Canada,14.899999999999999
FRA,France,14.05
CYP,Cyprus,20.0695
MAF,St. Martin (French part),24.299999999999997
NOR,Norway,12.709999999999999
ATG,Antigua and Barbuda,18.3937
ROU,Romania,16.160000000000004
HUN,Hungary,12.31
AUT,Austria,11.83
BEL,Belgium,12.07
IMN,Isle of Man,11.625
FRO,Faroe Islands,16.97
DEU,Germany,10.93
IRL,Ireland,18.19
KWT,Kuwait,32.1141
LTU,Lithuania,15.889999999999999
SAU,Saudi Arabia,41.0283
ITA,Italy,10.389999999999999
BRN,Brunei,30.5327
ESP,Spain,12.350000000000001
CHE,Switzerland,11.739999999999998
VIR,Virgin Islands,24.009999999999998
AND,Andorra,11.75
JPN,Japan,11.99
GRC,Greece,12.45
ISR,Israel,23.38
USA,United States,15.83
ARE,United Arab Emirates,29.4277
PRI,Puerto Rico,20.200000000000003
POL,Poland,17.880000000000003
QAT,Qatar,29.6878
ISL,Iceland,17.84
FIN,Finland,13.0
PYF,French Polynesia,30.2622
SVK,Slovak Republic,17.330000000000002
MLT,Malta,16.5
GBR,United Kingdom,13.260000000000002
GUM,Guam,27.2331
LIE,Liechtenstein,14.09
CYM,Cayman Islands,16.84
CHI,Channel Islands,11.834700000000002
HRV,Croatia,13.440000000000001
AUS,Australia,15.35
GRL,Greenland,20.66
Query:
-- Query 9: List the regions and their corresponding high-income countries
SELECT cs.region, cs.country_code, cs.short_name
FROM `bigquery-public-data.world_bank_wdi.country_summary` AS cs
WHERE cs.income_group = 'High income'
LIMIT 1000
Answer:
region,country_code,short_name
Europe & Central Asia,AND,Andorra
North America,BMU,Bermuda
Europe & Central Asia,CHI,Channel Islands
Latin America & Caribbean,CUW,Curaçao
Latin America & Caribbean,CYM,Cayman Islands
Europe & Central Asia,FRO,Faroe Islands
Europe & Central Asia,GIB,Gibraltar
Europe & Central Asia,GRL,Greenland
East Asia & Pacific,GUM,Guam
Europe & Central Asia,IMN,Isle of Man
Europe & Central Asia,LIE,Liechtenstein
Latin America & Caribbean,MAF,St. Martin (French part)
Europe & Central Asia,MCO,Monaco
East Asia & Pacific,MNP,Northern Mariana Islands
East Asia & Pacific,NCL,New Caledonia
East Asia & Pacific,NRU,Nauru
East Asia & Pacific,NZL,New Zealand
Latin America & Caribbean,PRI,Puerto Rico
East Asia & Pacific,PYF,French Polynesia
Latin America & Caribbean,SXM,Sint Maarten (Dutch part)
Latin America & Caribbean,TCA,Turks and Caicos Islands
Latin America & Caribbean,VGB,British Virgin Islands
Latin America & Caribbean,VIR,Virgin Islands
Latin America & Caribbean,ABW,Aruba
Middle East & North Africa,ARE,United Arab Emirates
Latin America & Caribbean,ATG,Antigua and Barbuda
Middle East & North Africa,BHR,Bahrain
Latin America & Caribbean,BHS,The Bahamas
Latin America & Caribbean,BRB,Barbados
East Asia & Pacific,BRN,Brunei
Latin America & Caribbean,KNA,St. Kitts and Nevis
Middle East & North Africa,KWT,Kuwait
East Asia & Pacific,MAC,"Macao SAR, China"
Middle East & North Africa,OMN,Oman
Latin America & Caribbean,PAN,Panama
Middle East & North Africa,QAT,Qatar
Europe & Central Asia,SMR,San Marino
Latin America & Caribbean,TTO,Trinidad and Tobago
East Asia & Pacific,AUS,Australia
Europe & Central Asia,BEL,Belgium
Europe & Central Asia,CHE,Switzerland
Europe & Central Asia,CYP,Cyprus
Europe & Central Asia,EST,Estonia
Europe & Central Asia,GBR,United Kingdom
Europe & Central Asia,GRC,Greece
East Asia & Pacific,HKG,"Hong Kong SAR, China"
Europe & Central Asia,HRV,Croatia
Europe & Central Asia,HUN,Hungary
Europe & Central Asia,IRL,Ireland
Europe & Central Asia,ISL,Iceland
Middle East & North Africa,ISR,Israel
East Asia & Pacific,KOR,Korea
Middle East & North Africa,MLT,Malta
Europe & Central Asia,NOR,Norway
Europe & Central Asia,POL,Poland
Middle East & North Africa,SAU,Saudi Arabia
East Asia & Pacific,SGP,Singapore
Query:
-- Query 10: Identify all indicators related to 'birth rate' (corrected)
SELECT DISTINCT series_code, indicator_name
FROM `bigquery-public-data.world_bank_wdi.series_summary`
WHERE LOWER(indicator_name) LIKE '%birth rate%'
LIMIT 1000
Answer:
series_code,indicator_name
SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)"
Query:
-- Query 11: Retrieve all years available for crude birth rate data
SELECT DISTINCT year
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE indicator_code = 'SP.DYN.CBRT.IN'
ORDER BY year
LIMIT 1000
Answer:
year
1960
1961
1962
1963
1964
1965
1966
1967
1968
1969
1970
1971
1972
1973
1974
1975
1976
1977
1978
1979
1980
1981
1982
1983
1984
1985
1986
1987
1988
1989
1990
1991
1992
1993
1994
1995
1996
1997
1998
1999
2000
2001
2002
2003
2004
2005
2006
2007
2008
2009
2010
2011
2012
2013
2014
2015
2016
2017
2018
2019
Query:
-- Query 12: List high-income countries with their regions and income groups
SELECT country_code, short_name, region, income_group
FROM `bigquery-public-data.world_bank_wdi.country_summary`
WHERE income_group = 'High income'
LIMIT 1000
Answer:
country_code,short_name,region,income_group
AND,Andorra,Europe & Central Asia,High income
BMU,Bermuda,North America,High income
CHI,Channel Islands,Europe & Central Asia,High income
CUW,Curaçao,Latin America & Caribbean,High income
CYM,Cayman Islands,Latin America & Caribbean,High income
FRO,Faroe Islands,Europe & Central Asia,High income
GIB,Gibraltar,Europe & Central Asia,High income
GRL,Greenland,Europe & Central Asia,High income
GUM,Guam,East Asia & Pacific,High income
IMN,Isle of Man,Europe & Central Asia,High income
LIE,Liechtenstein,Europe & Central Asia,High income
MAF,St. Martin (French part),Latin America & Caribbean,High income
MCO,Monaco,Europe & Central Asia,High income
MNP,Northern Mariana Islands,East Asia & Pacific,High income
NCL,New Caledonia,East Asia & Pacific,High income
NRU,Nauru,East Asia & Pacific,High income
NZL,New Zealand,East Asia & Pacific,High income
PRI,Puerto Rico,Latin America & Caribbean,High income
PYF,French Polynesia,East Asia & Pacific,High income
SXM,Sint Maarten (Dutch part),Latin America & Caribbean,High income
TCA,Turks and Caicos Islands,Latin America & Caribbean,High income
VGB,British Virgin Islands,Latin America & Caribbean,High income
VIR,Virgin Islands,Latin America & Caribbean,High income
ABW,Aruba,Latin America & Caribbean,High income
ARE,United Arab Emirates,Middle East & North Africa,High income
ATG,Antigua and Barbuda,Latin America & Caribbean,High income
BHR,Bahrain,Middle East & North Africa,High income
BHS,The Bahamas,Latin America & Caribbean,High income
BRB,Barbados,Latin America & Caribbean,High income
BRN,Brunei,East Asia & Pacific,High income
KNA,St. Kitts and Nevis,Latin America & Caribbean,High income
KWT,Kuwait,Middle East & North Africa,High income
MAC,"Macao SAR, China",East Asia & Pacific,High income
OMN,Oman,Middle East & North Africa,High income
PAN,Panama,Latin America & Caribbean,High income
QAT,Qatar,Middle East & North Africa,High income
SMR,San Marino,Europe & Central Asia,High income
TTO,Trinidad and Tobago,Latin America & Caribbean,High income
AUS,Australia,East Asia & Pacific,High income
BEL,Belgium,Europe & Central Asia,High income
CHE,Switzerland,Europe & Central Asia,High income
CYP,Cyprus,Europe & Central Asia,High income
Query:
-- Query 13: Find the maximum crude birth rate value for each high-income country in the 1980s
SELECT ind.country_code, MAX(ind.value) AS max_birth_rate_1980s
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS ind
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
  ON ind.country_code = cs.country_code
WHERE ind.indicator_code = 'SP.DYN.CBRT.IN'
  AND ind.year BETWEEN 1980 AND 1989
  AND cs.income_group = 'High income'
GROUP BY ind.country_code
LIMIT 1000
Answer:
country_code,max_birth_rate_1980s
SYC,28.9
OMN,49.744
ABW,22.472
SGP,19.8
CZE,14.9
NLD,12.8
NCL,27.7
NZL,17.5
HKG,17.0
BHR,32.938
BRB,17.698
KNA,29.1
DNK,12.0
LVA,16.1
EST,16.2
PRT,16.2
BHS,26.562
TTO,28.788
CAN,15.4
FRA,14.3
CYP,20.483
MAF,26.1
NOR,14.0
ATG,18.587
ROU,18.0
HUN,13.9
AUT,12.5
BEL,12.6
IMN,12.1
FRO,19.5
DEU,11.4
IRL,21.7
KWT,37.416
LTU,16.7
SAU,44.116
ITA,11.3
BRN,31.899
ESP,15.2
CHE,12.2
VIR,25.8
AND,12.5
JPN,13.5
GRC,15.4
ISR,24.3
USA,16.4
ARE,30.343
PRI,22.8
POL,19.8
QAT,35.107
ISL,19.8
FIN,13.8
PYF,30.789
SVK,19.1
MLT,18.1
GBR,13.8
GUM,28.432
LIE,15.4
CYM,17.6
CHI,12.401
HRV,14.8
AUS,15.8
GRL,22.1
LUX,12.4
SVN,15.7
BMU,15.2
MAC,22.901
CHL,23.555
KOR,22.6
PAN,30.898
SWE,13.7
URY,19.213
Query:
-- Query 14: Get the list of countries and their average crude birth rate across all years
SELECT country_code, AVG(value) AS avg_birth_rate_all_years
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE indicator_code = 'SP.DYN.CBRT.IN'
GROUP BY country_code
LIMIT 1000
Answer:
country_code,avg_birth_rate_all_years
MMR,29.78926666666667
NCL,24.564166666666665
NZL,17.22866666666667
NIC,35.691199999999995
NER,54.191649999999996
BRN,28.107916666666668
BGR,12.353333333333333
BDI,46.4368
CPV,34.771100000000004
TLA,27.9558784432641
MNA,34.22670957223581
GNQ,40.463750000000005
KGZ,28.963316666666664
LAO,36.97171666666667
LVA,12.371666666666666
LBN,25.858883333333335
LSO,36.23506666666666
LBR,44.04075000000001
LIE,13.951666666666668
AFW,44.24872749197753
ARB,35.856308956038326
EAR,32.10395486584463
EAS,21.63560707226378
EAP,22.64351816357921
RWA,44.55743333333334
STP,39.79259999999999
SYC,22.222448979591835
SLE,44.259283333333336
NGA,44.081300000000006
OMN,36.28351666666667
TCD,48.202666666666666
CHI,12.540350000000002
COM,41.17566666666667
COD,45.6777
WLD,25.627091395808396
AGO,48.294233333333345
ATG,20.8333
ABW,19.259666666666664
OSS,31.18727590746462
PST,13.876261480410536
PRE,44.52719536166528
EST,12.985000000000003
SWZ,39.82679999999999
FRA,14.246666666666666
GAB,35.29536666666667
GMB,44.86923333333334
ECA,18.188918099032442
TEC,17.78405147678176
FCS,41.32890594892337
HPC,44.12131215103699
HIC,14.545777071593552
MDV,35.93281666666667
MLI,48.355199999999996
MLT,14.548333333333334
MRT,41.09045
MUS,21.486800000000002
SGP,17.08166666666667
SVK,14.943333333333333
SVN,12.856666666666667
SLB,39.36725
ESP,13.506666666666664
PRT,14.463333333333335
PRI,18.839666666666666
QAT,25.218949999999996
HRV,12.379883333333334
CUB,18.350450000000002
CZE,12.681666666666668
GUY,28.997349999999997
HTI,35.52958333333333
HUN,11.996666666666666
TSA,32.13903336144867
SSF,43.30664133679629
End Exploring Related Columns
Task: Which high-income country had the highest average crude birth rate respectively in each region, and what are their corresponding average birth rate, during the 1980s?

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
Country,Region,Average_Crude_Birth_Rate
Kuwait,Middle East & North Africa,35
Bahamas,Latin America & Caribbean,20
Ireland,Europe & Central Asia,17
New Zealand,East Asia & Pacific,16
United States,North America,15
```

These are the high-income countries with the highest average crude birth rates in their respective regions during the 1980s..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'world_bank_global_population': ['population_by_country'], 'world_bank_health_population': ['country_series_definitions', 'country_summary', 'health_nutrition_population', 'series_summary', 'series_times'], 'world_bank_intl_debt': ['country_series_definitions', 'country_summary', 'international_debt', 'series_summary', 'series_times'], 'world_bank_intl_education': ['country_series_definitions', 'country_summary', 'international_education', 'series_summary'], 'world_bank_wdi': ['country_series_definitions', 'country_summary', 'footnotes', 'indicators_data', 'series_summary', 'series_time']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-20 17:33:48 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 17:33:48 - root - INFO - ```sql
WITH avg_birth_rates AS (
  SELECT 
    ind.country_code,
    cs.short_name AS Country,
    cs.region AS Region,
    AVG(ind.value) AS avg_birth_rate
  FROM 
    `bigquery-public-data.world_bank_wdi.indicators_data` AS ind
  JOIN 
    `bigquery-public-data.world_bank_wdi.country_summary` AS cs
    ON ind.country_code = cs.country_code
  WHERE 
    ind.indicator_code = 'SP.DYN.CBRT.IN'
    AND ind.year BETWEEN 1980 AND 1989
    AND cs.income_group = 'High income'
    AND cs.region != ''
  GROUP BY 
    ind.country_code, cs.short_name, cs.region
)
SELECT 
  Country, 
  Region, 
  ROUND(avg_birth_rate, 4) AS Average_Crude_Birth_Rate
FROM avg_birth_rates
QUALIFY ROW_NUMBER() OVER (
  PARTITION BY Region 
  ORDER BY avg_birth_rate DESC, Country ASC
) = 1
ORDER BY Region;
```
2025-01-20 17:33:51 - root - INFO - itercount: 1
2025-01-20 17:33:51 - root - INFO - 0
2025-01-20 17:33:51 - root - INFO - results: 
Country,Region,Average_Crude_Birth_Rate
Brunei,East Asia & Pacific,30.5327
Greenland,Europe & Central Asia,20.66
Panama,Latin America & Caribbean,28.6437
Oman,Middle East & North Africa,45.9702
United States,North America,15.83
Seychelles,Sub-Saharan Africa,25.78


2025-01-20 17:33:51 - root - INFO - Please check the answer again by reviewing Which high-income country had the highest average crude birth rate respectively in each region, and what are their corresponding average birth rate, during the 1980s?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Country,Region,Average_Crude_Birth_Rate
Kuwait,Middle East & North Africa,35
Bahamas,Latin America & Caribbean,20
Ireland,Europe & Central Asia,17
New Zealand,East Asia & Pacific,16
United States,North America,15
```

These are the high-income countries with the highest average crude birth rates in their respective regions during the 1980s. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Country,Region,Average_Crude_Birth_Rate
Brunei,East Asia & Pacific,30.5327
Greenland,Europe & Central Asia,20.66
Panama,Latin America & Caribbean,28.6437
Oman,Middle East & North Africa,45.9702
United States,North America,15.83
Seychelles,Sub-Saharan Africa,25.78
Current sql:
WITH avg_birth_rates AS (
  SELECT 
    ind.country_code,
    cs.short_name AS Country,
    cs.region AS Region,
    AVG(ind.value) AS avg_birth_rate
  FROM 
    `bigquery-public-data.world_bank_wdi.indicators_data` AS ind
  JOIN 
    `bigquery-public-data.world_bank_wdi.country_summary` AS cs
    ON ind.country_code = cs.country_code
  WHERE 
    ind.indicator_code = 'SP.DYN.CBRT.IN'
    AND ind.year BETWEEN 1980 AND 1989
    AND cs.income_group = 'High income'
    AND cs.region != ''
  GROUP BY 
    ind.country_code, cs.short_name, cs.region
)
SELECT 
  Country, 
  Region, 
  ROUND(avg_birth_rate, 4) AS Average_Crude_Birth_Rate
FROM avg_birth_rates
QUALIFY ROW_NUMBER() OVER (
  PARTITION BY Region 
  ORDER BY avg_birth_rate DESC, Country ASC
) = 1
ORDER BY Region;
2025-01-20 17:34:36 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 17:34:36 - root - INFO - ```sql
WITH avg_birth_rates AS (
  SELECT 
    ind.country_code,
    cs.short_name AS Country,
    cs.region AS Region,
    AVG(ind.value) AS avg_birth_rate
  FROM 
    `bigquery-public-data.world_bank_wdi.indicators_data` AS ind
  JOIN 
    `bigquery-public-data.world_bank_wdi.country_summary` AS cs
    ON ind.country_code = cs.country_code
  WHERE 
    ind.indicator_code = 'SP.DYN.CBRT.IN'
    AND ind.year BETWEEN 1980 AND 1989
    AND cs.income_group = 'High income'
    AND cs.region != ''
  GROUP BY 
    ind.country_code, cs.short_name, cs.region
)
SELECT 
  Country, 
  Region, 
  ROUND(avg_birth_rate, 4) AS Average_Crude_Birth_Rate
FROM avg_birth_rates
QUALIFY ROW_NUMBER() OVER (
  PARTITION BY Region 
  ORDER BY avg_birth_rate DESC, Country ASC
) = 1
ORDER BY Region;
```
2025-01-20 17:34:37 - root - INFO - itercount: 2
2025-01-20 17:34:37 - root - INFO - 0
2025-01-20 17:34:37 - root - INFO - Total iteration counts: 2
