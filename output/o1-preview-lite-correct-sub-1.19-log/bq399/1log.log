2025-01-20 17:30:16 - openai._base_client - INFO - Retrying request to /chat/completions in 0.438239 seconds
2025-01-20 17:31:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 17:31:19 - root - INFO - SQL:
SELECT DISTINCT `indicator_name`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE LOWER(`indicator_name`) LIKE '%birth rate%'
LIMIT 1000;
Results:
indicator_name
"Birth rate, crude (per 1,000 people)"

2025-01-20 17:31:45 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 17:31:45 - root - INFO - ```sql
SELECT `country_name`, `year`, `value`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `indicator_name` = 'Birth rate, crude (per 1,000 people)'
LIMIT 1000;
```
2025-01-20 17:32:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 17:32:32 - root - INFO - SQL:
SELECT `country_name`, `year`, `value`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `indicator_name` = 'Birth rate, crude (per 1,000 people)'
LIMIT 1000;
Results:
country_name,year,value
Myanmar,1965,41.826
Myanmar,2006,22.16
Nepal,2003,28.105
Niger,1971,56.733
Niger,2002,52.915
Canada,2007,11.2
Low & middle income,2016,20.503820656322
Middle East & North Africa (excluding high income),1989,34.8137044435591
Djibouti,1979,41.574
Lao PDR,1976,42.849
Liberia,2005,40.213
Africa Western and Central,1986,45.9638810057394
Africa Western and Central,2017,37.6041829377417
East Asia & Pacific,2017,13.5804384508057
East Asia & Pacific (IDA & IBRD countries),1961,24.4310592706922
Russian Federation,1976,15.641
Russian Federation,1979,15.8
Rwanda,2016,32.353
Saudi Arabia,1976,45.184
Seychelles,1977,25.9
Sierra Leone,1966,47.731
Sierra Leone,2014,35.677
Palau,2014,13.7
Papua New Guinea,1961,42.311
Channel Islands,1996,13.036
"Congo, Dem. Rep.",2001,45.931
Afghanistan,1967,51.65
Algeria,2014,25.538
Middle East & North Africa (IDA & IBRD countries),2006,24.0073473875192
North America,1985,15.7118237598039
OECD members,2001,13.4616995249281
Post-demographic dividend,1972,16.6215708377035
Post-demographic dividend,1998,11.6439718984765
Post-demographic dividend,2010,11.1464998406049
Pre-demographic dividend,1980,47.3217027778867
Pre-demographic dividend,2013,39.1123002300184
Estonia,1967,14.2
Estonia,1969,15.4
Estonia,1972,15.6
Eswatini,1974,50.468
Ethiopia,1967,47.725
Ethiopia,1973,48.482
Faroe Islands,1998,14.0
Fiji,1974,33.114
Finland,1987,12.1
France,1996,12.8
Gabon,1978,38.0
"Gambia, The",1985,46.844
Europe & Central Asia,1995,12.5104388271239
Europe & Central Asia,1999,11.6264867807958
Europe & Central Asia (IDA & IBRD countries),1978,20.6762952508709
Europe & Central Asia (IDA & IBRD countries),2003,13.209619069296
Europe & Central Asia (IDA & IBRD countries),2017,13.802397920582
Heavily indebted poor countries (HIPC),1961,48.0648018637456
Heavily indebted poor countries (HIPC),1987,46.1024984231831
"Macao SAR, China",1971,10.869
"Macao SAR, China",2008,9.06
Malta,1990,15.2
Malta,1994,12.9
Mauritania,1969,46.552
Mauritius,1984,20.1
Mauritius,2005,15.3
Singapore,2013,9.3
Slovenia,1982,15.1
Somalia,1977,44.373
South Sudan,2012,37.34
Spain,1980,15.2
Romania,1991,12.0
Cote d'Ivoire,1990,43.224
Croatia,1976,14.8
Cyprus,1985,20.34
Czech Republic,1975,19.1
Guinea-Bissau,1976,45.55
Small states,2013,23.2299873677062

2025-01-20 17:32:33 - root - INFO - SQL:
-- Corrected Query 1
SELECT `country_code`, `short_name`, `region`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
WHERE `income_group` LIKE 'High income%'
LIMIT 1000
Results:
country_code,short_name,region
AND,Andorra,Europe & Central Asia
BMU,Bermuda,North America
CHI,Channel Islands,Europe & Central Asia
CUW,Cura√ßao,Latin America & Caribbean
CYM,Cayman Islands,Latin America & Caribbean
FRO,Faroe Islands,Europe & Central Asia
GIB,Gibraltar,Europe & Central Asia
GRL,Greenland,Europe & Central Asia
GUM,Guam,East Asia & Pacific
IMN,Isle of Man,Europe & Central Asia
LIE,Liechtenstein,Europe & Central Asia
MAF,St. Martin (French part),Latin America & Caribbean
MCO,Monaco,Europe & Central Asia
MNP,Northern Mariana Islands,East Asia & Pacific
NCL,New Caledonia,East Asia & Pacific
NRU,Nauru,East Asia & Pacific
NZL,New Zealand,East Asia & Pacific
PRI,Puerto Rico,Latin America & Caribbean
PYF,French Polynesia,East Asia & Pacific
SXM,Sint Maarten (Dutch part),Latin America & Caribbean
TCA,Turks and Caicos Islands,Latin America & Caribbean
VGB,British Virgin Islands,Latin America & Caribbean
VIR,Virgin Islands,Latin America & Caribbean
ABW,Aruba,Latin America & Caribbean
ARE,United Arab Emirates,Middle East & North Africa
ATG,Antigua and Barbuda,Latin America & Caribbean
BHR,Bahrain,Middle East & North Africa
BHS,The Bahamas,Latin America & Caribbean
BRB,Barbados,Latin America & Caribbean
BRN,Brunei,East Asia & Pacific
KNA,St. Kitts and Nevis,Latin America & Caribbean
KWT,Kuwait,Middle East & North Africa
MAC,"Macao SAR, China",East Asia & Pacific
OMN,Oman,Middle East & North Africa
PAN,Panama,Latin America & Caribbean
QAT,Qatar,Middle East & North Africa
SMR,San Marino,Europe & Central Asia
TTO,Trinidad and Tobago,Latin America & Caribbean
AUS,Australia,East Asia & Pacific
BEL,Belgium,Europe & Central Asia
CHE,Switzerland,Europe & Central Asia
CYP,Cyprus,Europe & Central Asia
EST,Estonia,Europe & Central Asia
GBR,United Kingdom,Europe & Central Asia
GRC,Greece,Europe & Central Asia
HKG,"Hong Kong SAR, China",East Asia & Pacific
HRV,Croatia,Europe & Central Asia
HUN,Hungary,Europe & Central Asia
IRL,Ireland,Europe & Central Asia
ISL,Iceland,Europe & Central Asia
ISR,Israel,Middle East & North Africa
KOR,Korea,East Asia & Pacific
MLT,Malta,Middle East & North Africa
NOR,Norway,Europe & Central Asia
POL,Poland,Europe & Central Asia
SAU,Saudi Arabia,Middle East & North Africa
SGP,Singapore,East Asia & Pacific

2025-01-20 17:32:35 - root - INFO - SQL:
-- Corrected Query 2
SELECT `country_code`, `year`, `value`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `indicator_code` = 'SP.DYN.CBRT.IN' AND `year` BETWEEN 1980 AND 1989
LIMIT 1000
Results:
country_code,year,value
BDI,1988,50.961
TLA,1988,28.349434569775
MNA,1981,41.1889494231624
EAR,1984,35.90671608227
EAP,1986,24.4306614211465
SYC,1980,28.9
OMN,1985,46.163
ABW,1987,21.008
OSS,1988,33.4464059193206
PRE,1984,46.5906908668772
MLI,1988,48.746
SGP,1983,16.3
SLB,1986,41.331
CZE,1984,13.3
HTI,1981,42.401
TSA,1981,37.2033506788069
LCA,1988,29.804
SYR,1981,44.064
IRQ,1983,38.969
VEN,1987,30.205
VNM,1981,31.68
NLD,1981,12.5
NCL,1986,24.9
NZL,1983,15.8
NER,1986,56.178
LAC,1981,32.1233804270661
LBR,1981,48.555
EAS,1981,23.0637636998303
SYC,1981,28.1
PNG,1981,39.016
FCS,1981,44.1926831101688
HIC,1987,14.1807644876801
GUY,1981,30.926
HKG,1981,16.8
BHR,1980,32.931
BRB,1988,16.407
KNA,1983,24.1
KNA,1985,23.1
MNE,1988,17.089
NER,1983,56.634
MNA,1982,40.855130241805
DNK,1982,10.3
LVA,1983,15.9
WSM,1983,36.047
CAF,1981,42.163
AFG,1982,50.098
AGO,1985,50.663
EST,1987,16.2
EUU,1980,13.9675011570752
MRT,1983,42.492
PRT,1981,15.4
GNB,1980,48.73
HTI,1983,42.429
BHS,1985,25.819
BLR,1985,16.5
KNA,1980,26.8
SUR,1989,28.295
IBT,1984,30.3249708951953
IDX,1986,43.4844843508447
TTO,1988,23.181
UZB,1984,36.3
MMR,1989,28.222
CAN,1983,15.0
LAC,1985,29.9974830347845
LIC,1980,46.2294380010898
LMC,1983,36.5338248511245
DMA,1982,23.3
AFE,1980,46.1453277375565
ALB,1983,26.528
FRA,1984,14.3
SLB,1984,41.954
CYP,1981,20.168
TSA,1984,36.1731485377014
MAF,1988,25.5
IBT,1988,29.6891660619559
IRN,1980,44.108
ZMB,1983,47.053
BGR,1985,13.3
TLA,1985,30.0353211355085
DJI,1989,39.979
RWA,1984,52.454
NOR,1983,12.1
COD,1980,46.296
ATG,1989,18.587
SWZ,1983,47.211
SWZ,1989,39.87
ETH,1986,48.712
EUU,1981,13.5934870018468
ROU,1982,15.3
HUN,1983,11.9

2025-01-20 17:32:37 - root - INFO - SQL:
-- Query 3 (No correction needed)
SELECT DISTINCT `region`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
LIMIT 1000
Results:
region
""
Europe & Central Asia
North America
Latin America & Caribbean
East Asia & Pacific
Sub-Saharan Africa
Middle East & North Africa
South Asia

2025-01-20 17:32:39 - root - INFO - SQL:
-- Query 4 (No correction needed)
SELECT DISTINCT `year`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `indicator_code` = 'SP.DYN.CBRT.IN'
LIMIT 1000
Results:
year
1965
2006
2003
1971
2002
2007
2016
1989
1979
1976
2005
1986
2017
1961
1977
1966
2014
1996
2001
1967
1985
1972
1998
2010
1980
2013
1969
1974
1973
1987
1978
1995
1999
2008
1990
1994
1984
1982
2012
1991
1975
1963
2004
1968
1992
1997
1964
1981
2009
2000
2011
2019
1983
2015
1970
1993
1988
2018
1962
1960

2025-01-20 17:32:41 - root - INFO - SQL:
-- Corrected Query 5
SELECT `country_code`, AVG(`value`) AS avg_birth_rate
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `indicator_code` = 'SP.DYN.CBRT.IN' AND `year` BETWEEN 1980 AND 1989
GROUP BY `country_code`
LIMIT 1000
Results:
country_code,avg_birth_rate
MNA,38.90497580367373
AFW,46.297966596779645
NAC,15.73848700906143
PRE,46.44554769910849
FIN,13.0
GMB,46.9401
HPC,46.58286755898328
MUS,21.419999999999998
SVN,13.739999999999998
ESP,12.350000000000001
CYP,20.0695
GEO,18.5041
DEU,10.93
TTO,26.4283
URY,18.429100000000002
KAZ,24.69
KGZ,31.4
ARB,39.02714036733985
TCD,50.2463
CHI,11.834700000000002
CHN,21.224000000000004
COD,46.183499999999995
MIC,29.392565448048188
EST,15.67
ETH,48.7467
SSD,47.773399999999995
CUB,16.885799999999996
CZE,13.31
GIN,48.5351
AZE,26.459100000000003
BGD,39.873999999999995
CHE,11.739999999999998
IBT,30.387631580650208
MOZ,45.614599999999996
BMU,15.066666666666666
TKM,36.3478
PRK,20.8603
NCL,25.310000000000002
BRN,30.5327
CPV,42.103199999999994
GNQ,43.03
LSO,39.406099999999995
CSS,27.529797280576627
PSS,35.11662699860514
ECS,16.253794753659193
MAC,20.7301
SLB,42.008300000000006
POL,17.880000000000003
PRT,13.75
CIV,45.8676
BEL,12.07
IRL,18.19
VNM,30.669600000000003
KIR,37.016999999999996
LTU,15.889999999999999
EAR,35.44338867101696
MKD,19.8519
AGO,50.497099999999996
TSA,35.748496308582276
SYR,41.164300000000004
IRQ,38.7932
ZMB,46.7965
BFA,48.4748
LIE,14.09
AFE,45.22247374583799
RWA,51.6686
OED,16.515610379433454
FRA,14.05
FCS,43.25660731556301
ROU,16.160000000000004
VCT,27.8353
GRD,31.8155
BLZ,38.890299999999996
BGR,13.52
CAN,14.899999999999999
EAP,23.77923550301364
ARM,23.951500000000003
PST,13.807382489286258
GAB,38.1974
GUY,29.8218
SUR,29.2968
TEA,23.81699023563197
CAF,42.3932
OSS,34.337881483810925
ERI,44.6254
SGP,17.08
PRI,20.200000000000003
SST,32.652219999619874
IBD,27.34765304308288
LTE,22.285028992039802

2025-01-20 17:32:42 - root - INFO - SQL:
-- Query 6 (No correction needed)
SELECT DISTINCT `income_group`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
LIMIT 1000
Results:
income_group
""
High income
Low income
Upper middle income
Lower middle income

2025-01-20 17:32:44 - root - INFO - SQL:
-- Query 7 (No correction needed)
SELECT `country_code`, `short_name`, `income_group`, `region`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
LIMIT 1000
Results:
country_code,short_name,income_group,region
AFE,Africa Eastern and Southern,,
AFW,Africa Western and Central,,
ARB,Arab World,,
CEB,Central Europe and the Baltics,,
CSS,Caribbean small states,,
EAP,East Asia & Pacific (excluding high income),,
EAR,Early-demographic dividend,,
EAS,East Asia & Pacific,,
ECA,Europe & Central Asia (excluding high income),,
ECS,Europe & Central Asia,,
EUU,European Union,,
FCS,Fragile and conflict affected situations,,
HIC,High income,,
HPC,Heavily indebted poor countries (HIPC),,
IBD,IBRD only,,
IBT,IDA & IBRD total,,
IDA,IDA total,,
IDB,IDA blend,,
IDX,IDA only,,
LAC,Latin America & Caribbean (excluding high income),,
LCN,Latin America & Caribbean,,
LDC,Least developed countries: UN classification,,
LIC,Low income,,
LMC,Lower middle income,,
LMY,Low & middle income,,
LTE,Late-demographic dividend,,
MEA,Middle East & North Africa,,
MIC,Middle income,,
MNA,Middle East & North Africa (excluding high income),,
NAC,North America,,
OED,OECD members,,
OSS,Other small states,,
PRE,Pre-demographic dividend,,
PSS,Pacific island small states,,
PST,Post-demographic dividend,,
SAS,South Asia,,
SSA,Sub-Saharan Africa (excluding high income),,
SSF,Sub-Saharan Africa,,
SST,Small states,,
TEA,East Asia & Pacific (IDA & IBRD),,
TEC,Europe & Central Asia (IDA & IBRD),,
TLA,Latin America & Caribbean (IDA & IBRD),,
TMN,Middle East & North Africa (IDA & IBRD),,
TSA,South Asia (IDA & IBRD),,
TSS,Sub-Saharan Africa (IDA & IBRD),,
UMC,Upper middle income,,
WLD,World,,
AND,Andorra,High income,Europe & Central Asia
BMU,Bermuda,High income,North America

2025-01-20 17:32:46 - root - INFO - SQL:
-- Query 8 (No correction needed)
SELECT `year`, `value`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `country_code` = 'USA' AND `indicator_code` = 'SP.DYN.CBRT.IN' AND `year` BETWEEN 1980 AND 1989
ORDER BY `year`
LIMIT 1000
Results:
year,value
1980,15.9
1981,15.8
1982,15.9
1983,15.6
1984,15.6
1985,15.8
1986,15.6
1987,15.7
1988,16.0
1989,16.4

2025-01-20 17:32:47 - root - INFO - SQL:
-- Query 9 (No correction needed)
SELECT `country_code`, `short_name`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
WHERE `region` = 'Europe & Central Asia'
LIMIT 1000
Results:
country_code,short_name
AND,Andorra
CHI,Channel Islands
FRO,Faroe Islands
GIB,Gibraltar
GRL,Greenland
IMN,Isle of Man
LIE,Liechtenstein
MCO,Monaco
TKM,Turkmenistan
SMR,San Marino
TJK,Tajikistan
UZB,Uzbekistan
ALB,Albania
AZE,Azerbaijan
BIH,Bosnia and Herzegovina
MNE,Montenegro
SRB,Serbia
XKX,Kosovo
BEL,Belgium
CHE,Switzerland
CYP,Cyprus
EST,Estonia
GBR,United Kingdom
GRC,Greece
HRV,Croatia
HUN,Hungary
IRL,Ireland
ISL,Iceland
NOR,Norway
POL,Poland
KGZ,Kyrgyz Republic
UKR,Ukraine
ARM,Armenia
BLR,Belarus
GEO,Georgia
KAZ,Kazakhstan
MDA,Moldova
RUS,Russia
TUR,T√ºrkiye
AUT,Austria
CZE,Czech Republic
DEU,Germany
DNK,Denmark
ESP,Spain
FIN,Finland
FRA,France
ITA,Italy
LTU,Lithuania
LUX,Luxembourg
LVA,Latvia
NLD,Netherlands
PRT,Portugal
ROU,Romania
SVK,Slovak Republic
SVN,Slovenia
SWE,Sweden
BGR,Bulgaria
MKD,North Macedonia

2025-01-20 17:32:49 - root - INFO - SQL:
-- Corrected Query 10
SELECT `country_code`, `short_name`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
WHERE `region` = 'Latin America & Caribbean' AND `income_group` LIKE 'High income%'
LIMIT 1000
Results:
country_code,short_name
CUW,Cura√ßao
CYM,Cayman Islands
MAF,St. Martin (French part)
PRI,Puerto Rico
SXM,Sint Maarten (Dutch part)
TCA,Turks and Caicos Islands
VGB,British Virgin Islands
VIR,Virgin Islands
ABW,Aruba
ATG,Antigua and Barbuda
BHS,The Bahamas
BRB,Barbados
KNA,St. Kitts and Nevis
PAN,Panama
TTO,Trinidad and Tobago
URY,Uruguay
CHL,Chile

2025-01-20 17:32:51 - root - INFO - SQL:
-- Corrected Query 11
SELECT DISTINCT ind.`year`
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS ind
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
ON ind.`country_code` = cs.`country_code`
WHERE ind.`indicator_code` = 'SP.DYN.CBRT.IN' AND cs.`income_group` LIKE 'High income%'
LIMIT 1000
Results:
year
2007
1976
1977
1996
1967
1969
1972
1998
1987
1971
2008
1990
1994
2013
1982
1980
1991
1985
1975
2005
1979
1989
1997
1981
2000
2011
1966
1983
1978
2002
1963
2003
2009
1999
1988
2014
2016
1962
1974
1960
1984
1970
1961
1986
2018
2004
2019
2012
1992
1995
2017
1965
1973
2010
1968
1993
2006
2015
2001
1964

2025-01-20 17:32:53 - root - INFO - SQL:
-- Query 12 (No correction needed)
SELECT `year`, `value`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `country_code` = 'IRL' AND `indicator_code` = 'SP.DYN.CBRT.IN' AND `year` BETWEEN 1980 AND 1989
ORDER BY `year`
LIMIT 1000
Results:
year,value
1980,21.7
1981,20.9
1982,20.3
1983,19.1
1984,18.1
1985,17.6
1986,17.4
1987,16.5
1988,15.5
1989,14.8

2025-01-20 17:32:55 - root - INFO - SQL:
-- Query 13 (No correction needed)
SELECT DISTINCT `indicator_code`, `indicator_name`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE LOWER(`indicator_name`) LIKE '%birth%'
LIMIT 1000
Results:
indicator_code,indicator_name
SP.ADO.TFRT,"Adolescent fertility rate (births per 1,000 women ages 15-19)"
SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)"
SP.DYN.TFRT.IN,"Fertility rate, total (births per woman)"
SP.DYN.LE00.FE.IN,"Life expectancy at birth, female (years)"
SP.DYN.IMRT.MA.IN,"Mortality rate, infant, male (per 1,000 live births)"
SH.DYN.MORT,"Mortality rate, under-5 (per 1,000 live births)"
SP.REG.BRTH.ZS,Completeness of birth registration (%)
SP.DYN.LE00.IN,"Life expectancy at birth, total (years)"
SP.DYN.IMRT.IN,"Mortality rate, infant (per 1,000 live births)"
SH.DYN.NMRT,"Mortality rate, neonatal (per 1,000 live births)"
SH.DYN.MORT.MA,"Mortality rate, under-5, male (per 1,000 live births)"
SP.DYN.LE00.MA.IN,"Life expectancy at birth, male (years)"
SH.STA.BRTW.ZS,Low-birthweight babies (% of births)
SH.STA.MMRT,"Maternal mortality ratio (modeled estimate, per 100,000 live births)"
SH.DYN.MORT.FE,"Mortality rate, under-5, female (per 1,000 live births)"
SP.DYN.IMRT.FE.IN,"Mortality rate, infant, female (per 1,000 live births)"
SP.REG.BRTH.FE.ZS,"Completeness of birth registration, female (%)"
SP.POP.BRTH.MF,Sex ratio at birth (male births per female births)
SH.STA.BRTC.ZS,Births attended by skilled health staff (% of total)
SH.STA.MMRT.NE,"Maternal mortality ratio (national estimate, per 100,000 live births)"
SP.REG.BRTH.UR.ZS,"Completeness of birth registration, urban (%)"
SP.REG.BRTH.MA.ZS,"Completeness of birth registration, male (%)"
SP.DYN.WFRT,Wanted fertility rate (births per woman)
SP.REG.BRTH.RU.ZS,"Completeness of birth registration, rural (%)"

2025-01-20 17:32:55 - root - INFO - itercount: 0
2025-01-20 17:32:55 - root - INFO - Database Name: bigquery-public-data
Schema Name: world_bank_global_population
DDL describes table information.
,0
table_name,population_by_country
ddl,"CREATE TABLE `bigquery-public-data.world_bank_global_population.population_by_country`
(
  country STRING,
  country_code STRING,
  year_1960 INT64,
  year_1961 INT64,
  year_1962 INT64,
  year_1963 INT64,
  year_1964 INT64,
  year_1965 INT64,
  year_1966 INT64,
  year_1967 INT64,
  year_1968 INT64,
  year_1969 INT64,
  year_1970 INT64,
  year_1971 INT64,
  year_1972 INT64,
  year_1973 INT64,
  year_1974 INT64,
  year_1975 INT64,
  year_1976 INT64,
  year_1977 INT64,
  year_1978 INT64,
  year_1979 INT64,
  year_1980 INT64,
  year_1981 INT64,
  year_1982 INT64,
  year_1983 INT64,
  year_1984 INT64,
  year_1985 INT64,
  year_1986 INT64,
  year_1987 INT64,
  year_1988 INT64,
  year_1989 INT64,
  year_1990 INT64,
  year_1991 INT64,
  year_1992 INT64,
  year_1993 INT64,
  year_1994 INT64,
  year_1995 INT64,
  year_1996 INT64,
  year_1997 INT64,
  year_1998 INT64,
  year_1999 INT64,
  year_2000 INT64,
  year_2001 INT64,
  year_2002 INT64,
  year_2003 INT64,
  year_2004 INT64,
  year_2005 INT64,
  year_2006 INT64,
  year_2007 INT64,
  year_2008 INT64,
  year_2009 INT64,
  year_2010 INT64,
  year_2011 INT64,
  year_2012 INT64,
  year_2013 INT64,
  year_2014 INT64,
  year_2015 INT64,
  year_2016 INT64,
  year_2017 INT64,
  year_2018 INT64,
  year_2019 INT64
)
PARTITION BY DATE(_PARTITIONTIME);"

Database Name: bigquery-public-data
Schema Name: world_bank_health_population
DDL describes table information.
,0
table_name,series_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.series_summary`
(
  series_code STRING,
  topic STRING,
  indicator_name STRING,
  short_definition STRING,
  long_definition STRING,
  unit_of_measure STRING,
  periodicity STRING,
  base_period INT64,
  other_notes STRING,
  aggregation_method STRING,
  limitations_and_exceptions STRING,
  notes_from_original_source STRING,
  general_comments STRING,
  source STRING,
  statistical_concept_and_methodology STRING,
  development_relevance STRING,
  related_source_links STRING,
  other_web_links STRING,
  related_indicators STRING,
  license_type STRING
)
OPTIONS(
  description=""Series Summary table""
);"

,1
table_name,country_series_definitions
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.country_series_definitions`
(
  country_code STRING,
  series_code STRING,
  description STRING
)
OPTIONS(
  description=""Country Series Definition table""
);"

,2
table_name,series_times
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.series_times`
(
  series_code STRING,
  year INT64,
  description STRING
)
OPTIONS(
  description=""Series Times table""
);"

,3
table_name,country_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.country_summary`
(
  country_code STRING,
  short_name STRING,
  table_name STRING,
  long_name STRING,
  two_alpha_code STRING,
  currency_unit STRING,
  special_notes STRING,
  region STRING,
  income_group STRING,
  wb_2_code STRING,
  national_accounts_base_year STRING,
  national_accounts_reference_year STRING,
  sna_price_valuation STRING,
  lending_category STRING,
  other_groups STRING,
  system_of_national_accounts STRING,
  alternative_conversion_factor STRING,
  ppp_survey_year STRING,
  balance_of_payments_manual_in_use STRING,
  external_debt_reporting_status STRING,
  system_of_trade STRING,
  government_accounting_concept STRING,
  imf_data_dissemination_standard STRING,
  latest_population_census STRING,
  latest_household_survey STRING,
  source_of_most_recent_income_and_expenditure_data STRING,
  vital_registration_complete STRING,
  latest_agricultural_census STRING,
  latest_industrial_data INT64,
  latest_trade_data INT64
)
OPTIONS(
  description=""Country Summary table""
);"

,4
table_name,health_nutrition_population
ddl,"CREATE TABLE `bigquery-public-data.world_bank_health_population.health_nutrition_population`
(
  country_name STRING OPTIONS(description=""""),
  country_code STRING OPTIONS(description=""""),
  indicator_name STRING OPTIONS(description=""""),
  indicator_code STRING OPTIONS(description=""""),
  value FLOAT64 OPTIONS(description=""""),
  year INT64 OPTIONS(description="""")
);"

Database Name: bigquery-public-data
Schema Name: world_bank_intl_debt
DDL describes table information.
,0
table_name,series_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.series_summary`
(
  series_code STRING,
  topic STRING,
  indicator_name STRING,
  short_definition STRING,
  long_definition STRING,
  unit_of_measure STRING,
  periodicity STRING,
  base_period STRING,
  other_notes STRING,
  aggregation_method STRING,
  limitations_and_exceptions STRING,
  notes_from_original_source STRING,
  general_comments STRING,
  source STRING,
  statistical_concept_and_methodology STRING,
  development_relevance STRING,
  related_source_links STRING,
  other_web_links STRING,
  related_indicators STRING,
  license_type STRING
)
OPTIONS(
  description=""Series Summary table""
);"

,1
table_name,country_series_definitions
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.country_series_definitions`
(
  country_code STRING,
  series_code STRING,
  description STRING
)
OPTIONS(
  description=""Country Series Definition table""
);"

,2
table_name,series_times
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.series_times`
(
  series_code STRING,
  year INT64,
  description STRING
)
OPTIONS(
  description=""Series Times table""
);"

,3
table_name,country_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.country_summary`
(
  country_code STRING,
  short_name STRING,
  table_name STRING,
  long_name STRING,
  two_alpha_code STRING,
  currency_unit STRING,
  special_notes STRING,
  region STRING,
  income_group STRING,
  wb_2_code STRING,
  national_accounts_base_year STRING,
  national_accounts_reference_year STRING,
  sna_price_valuation STRING,
  lending_category STRING,
  other_groups STRING,
  system_of_national_accounts STRING,
  alternative_conversion_factor STRING,
  ppp_survey_year STRING,
  balance_of_payments_manual_in_use STRING,
  external_debt_reporting_status STRING,
  system_of_trade STRING,
  government_accounting_concept STRING,
  imf_data_dissemination_standard STRING,
  latest_population_census STRING,
  latest_household_survey STRING,
  source_of_most_recent_Income_and_expenditure_data STRING,
  vital_registration_complete STRING,
  latest_agricultural_census STRING,
  latest_industrial_data INT64,
  latest_trade_data INT64,
  latest_water_withdrawal_data STRING
)
OPTIONS(
  description=""Country Summary table""
);"

,4
table_name,international_debt
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_debt.international_debt`
(
  country_name STRING OPTIONS(description=""""),
  country_code STRING OPTIONS(description=""""),
  indicator_name STRING OPTIONS(description=""""),
  indicator_code STRING OPTIONS(description=""""),
  value FLOAT64 OPTIONS(description=""""),
  year INT64 OPTIONS(description="""")
);"

Database Name: bigquery-public-data
Schema Name: world_bank_intl_education
DDL describes table information.
,0
table_name,series_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_education.series_summary`
(
  series_code STRING,
  topic STRING,
  indicator_name STRING,
  short_definition STRING,
  long_definition STRING,
  unit_of_measure STRING,
  periodicity STRING,
  base_period STRING,
  other_notes STRING,
  aggregation_method STRING,
  limitations_and_exceptions STRING,
  notes_from_original_source STRING,
  general_comments STRING,
  source STRING,
  statistical_concept_and_methodology STRING,
  development_relevance STRING,
  related_source_links STRING,
  other_web_links STRING,
  related_indicators STRING,
  license_type STRING
)
OPTIONS(
  description=""Series Summary table""
);"

,1
table_name,country_series_definitions
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_education.country_series_definitions`
(
  country_code STRING,
  series_code STRING,
  description STRING
)
OPTIONS(
  description=""Country Series Definition table""
);"

,2
table_name,international_education
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_education.international_education`
(
  country_name STRING OPTIONS(description=""""),
  country_code STRING OPTIONS(description=""""),
  indicator_name STRING OPTIONS(description=""""),
  indicator_code STRING OPTIONS(description=""""),
  value FLOAT64 OPTIONS(description=""""),
  year INT64 OPTIONS(description="""")
);"

,3
table_name,country_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_intl_education.country_summary`
(
  country_code STRING,
  short_name STRING,
  table_name STRING,
  long_name STRING,
  two_alpha_code STRING,
  currency_unit STRING,
  special_notes STRING,
  region STRING,
  income_group STRING,
  wb_two_code STRING,
  national_accounts_base_year STRING,
  national_accounts_reference_year STRING,
  sna_price_valuation STRING,
  lending_category STRING,
  other_groups STRING,
  system_of_national_accounts STRING,
  alternative_conversion_factor STRING,
  ppp_survey_year STRING,
  balance_of_payments_manual_in_use STRING,
  external_debt_reporting_status STRING,
  system_of_trade STRING,
  government_accounting_concept STRING,
  imf_data_dissemination_standard STRING,
  latest_population_census STRING,
  latest_household_survey STRING,
  source_of_most_recent_income_and_expenditure_data STRING,
  vital_registration_complete STRING,
  latest_agricultural_census STRING,
  latest_industrial_data INT64,
  latest_trade_data INT64,
  latest_water_withdrawal_data STRING
)
OPTIONS(
  description=""Country Summary table""
);"

Database Name: bigquery-public-data
Schema Name: world_bank_wdi
DDL describes table information.
,0
table_name,series_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.series_summary`
(
  series_code STRING OPTIONS(description=""A number or a sequence of related statistical units arranged or occurring in temporal spatial or other order or succession. WDI carries mostly time series.""),
  topic STRING OPTIONS(description=""The matter dealt with in the context discourse or subject related to the series.""),
  indicator_name STRING OPTIONS(description=""Given name of a series.""),
  short_definition STRING OPTIONS(description=""Short statement of the exact meaning of a series.""),
  long_definition STRING OPTIONS(description=""Extended statement of the exact meaning of a series.""),
  unit_of_measure STRING OPTIONS(description=""A quantity used as a standard of measurement. Example: Units of time are second minute hour day week month year and decade.""),
  periodicity STRING OPTIONS(description=""Applies to series recurring at regular intervals. Most of the time this term denotes that interval of recurrence.""),
  base_period STRING OPTIONS(description=""Base period is the period of time for which data is used as the base of an index number or other ratio have been collected. This period is frequently one of a year but it may be as short as one day or as long as the average of a group of years.""),
  other_notes STRING OPTIONS(description=""A brief record of facts topics or thoughts written down and used to contextualize the series definition values and other characteristics.""),
  aggregation_method STRING OPTIONS(description=""Aggregation methods are types of calculations used to group attribute values into a metric for each dimension value. For example for each region one may retrieve the total value of country entries (the sum of the series value for countries belonging to the region).""),
  limitations_and_exceptions STRING OPTIONS(description=""A limiting rule or circumstance that applies to usage of the series such as the scope of the survey collecting the data or missing years and countries.  It should also note when data are imputed or estimated""),
  notes_from_original_source STRING OPTIONS(description=""A brief record of facts topics or thoughts written down and used to contextualize the series definition values and other characteristics.""),
  general_comments STRING OPTIONS(description=""Other notes regarding the series which do not appear in Development relevance or Limitations or exceptions""),
  source STRING OPTIONS(description=""A place person or organization from which the series comes or can be obtained.""),
  statistical_concept_and_methodology STRING OPTIONS(description=""The abstract idea general statistical notions or a system of methods used to generate the series.""),
  development_relevance STRING OPTIONS(description=""The relevance of a series refers to how the indicator‚Äôs data may be used to monitor particular aspects of development goals and programs for example the Sustainable Development Goals. The indicator may conclusively measure progress towards a particular objective or may act as a proxy or interpretation of a development aim.""),
  related_source_links STRING OPTIONS(description=""Internet address of related source page tool or knowledge base.""),
  other_web_links STRING OPTIONS(description=""Internet addresses of related pages tools or knowledge bases.""),
  related_indicators STRING OPTIONS(description=""In general indicator that are of interest and related to the specific series.""),
  license_type STRING OPTIONS(description=""Explains the rights conferred and restrictions imposed by the owner to the users of a series"")
);"

,1
table_name,country_series_definitions
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.country_series_definitions`
(
  country_code STRING OPTIONS(description=""""),
  series_code STRING OPTIONS(description=""""),
  description STRING OPTIONS(description="""")
);"

,2
table_name,footnotes
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.footnotes`
(
  country_code STRING OPTIONS(description=""""),
  series_code STRING OPTIONS(description=""""),
  year STRING OPTIONS(description=""""),
  description STRING OPTIONS(description="""")
);"

,3
table_name,series_time
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.series_time`
(
  series_code STRING OPTIONS(description=""""),
  year INT64 OPTIONS(description=""""),
  description STRING OPTIONS(description="""")
);"

,4
table_name,indicators_data
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.indicators_data`
(
  country_name STRING OPTIONS(description=""""),
  country_code STRING OPTIONS(description=""""),
  indicator_name STRING OPTIONS(description=""""),
  indicator_code STRING OPTIONS(description=""""),
  value FLOAT64 OPTIONS(description=""""),
  year INT64 OPTIONS(description="""")
);"

,5
table_name,country_summary
ddl,"CREATE TABLE `bigquery-public-data.world_bank_wdi.country_summary`
(
  country_code STRING OPTIONS(description=""A short alphabetic or numeric geographical code representing a specific country or area. In April 2016 WDI has adopted the three digit ISO code to identify countries in its databases.""),
  short_name STRING OPTIONS(description=""Country name the country's official name as approved by the relevant body (Italy is used as an example): conventional short form (Italy).""),
  table_name STRING OPTIONS(description=""Country name the country's name as approved by the relevant body (Italy is used as an example): conventional short form (Republic of Italy).""),
  long_name STRING OPTIONS(description=""Country name the country's name as approved by the relevant body (Italy is used as an example): conventional long form (Republic of Italy).""),
  two_alpha_code STRING OPTIONS(description=""ISO-2 digit alpha code value of the country. Re: www.iso.org""),
  currency_unit STRING OPTIONS(description=""Currency unit (such as the dollar euro peso rupee) issued as a coin or banknote a standard unit of value and a unit of account.""),
  special_notes STRING OPTIONS(description=""Country special notes for data and metadata users.""),
  region STRING OPTIONS(description=""World Bank region to which a country belongs.""),
  income_group STRING OPTIONS(description=""World Bank income group to which a country belongs after the country classification is completed every year.""),
  wb_2_code STRING OPTIONS(description=""World Bank 2 digit code value of the country.""),
  national_accounts_base_year STRING OPTIONS(description=""Base year is the base or pricing period used for constant price calculations in the country‚Äôs national accounts. Price indexes derived from national accounts aggregates such as the implicit deflator for gross domestic product (GDP) express the price level relative to base year prices.""),
  national_accounts_reference_year STRING OPTIONS(description=""Reference year is the year in which the local currency constant price series of a country is valued. The reference year is usually the same as the base year used to report the constant price series. However when the constant price data are chain linked the base year is changed annually so the data are rescaled to a specific reference year to provide a consistent time series. When the country has not rescaled following a change in base year World Bank staff rescale the data to maintain a longer historical series. To allow for cross-country comparison and data aggregation constant price data reported in World Development Indicators are rescaled to a common reference year (2010) and currency (U.S. dollars).""),
  sna_price_valuation STRING OPTIONS(description=""SNA price valuation shows whether value added in the national accounts is reported at basic prices (B) or producer prices (P). Producer prices include taxes paid by producers and thus tend to overstate the actual value added in production. However value added can be higher at basic prices than at producer prices in countries with high agricultural subsidies.""),
  lending_category STRING OPTIONS(description=""World Bank lending category to which a country belongs after the operational guidelines are completed every year.""),
  other_groups STRING OPTIONS(description=""Other types of grouping approved by the WDI team.""),
  system_of_national_accounts STRING OPTIONS(description=""System of National Accounts identifies whether a country uses the 1968 1993 or 2008 System of National Accounts (SNA). The 2008 SNA is an update of the 1993 SNA and retains its basic theoretical framework.""),
  alternative_conversion_factor STRING OPTIONS(description=""Alternative conversion factor identifies the countries and years for which a World Bank‚Äìestimated conversion factor has been used in place of the official exchange rate (line rf in the International Monetary Fund‚Äôs [IMF] International Financial Statistics). See later in Sources and methods for further discussion of alternative conversion factors.""),
  ppp_survey_year STRING OPTIONS(description=""Purchasing power parity (PPP) survey year is the latest available survey year for the International Comparison Program‚Äôs estimates of PPPs.""),
  balance_of_payments_manual_in_use STRING OPTIONS(description=""Balance of Payments Manual in use refers to the classification system used to compile and report data on balance of payments. 6 refers to the 6th edition of the IMF‚Äôs Balance of Payments Manual (2009).""),
  external_debt_reporting_status STRING OPTIONS(description=""External debt shows debt reporting status for 2016 data. A indicates that data are as reported P that data are based on reported or collected information but include an element of staff estimation and E that data are World Bank staff estimates.""),
  system_of_trade STRING OPTIONS(description=""System of trade refers to the United Nations general trade system (G) or special trade system (S). Under the general trade system goods entering directly for domestic consumption and goods entered into customs storage are recorded as imports at arrival. Under the special trade system goods are recorded as imports when declared for domestic consumption whether at time of entry or on withdrawal from customs storage.""),
  government_accounting_concept STRING OPTIONS(description=""Government finance accounting concept is the accounting basis for reporting central government financial data. For most countries government finance data have been consolidated (C) into one set of accounts capturing all central government fiscal activities. Budgetary central government accounts (B) exclude some central government units.""),
  imf_data_dissemination_standard STRING OPTIONS(description=""IMF data dissemination standard shows the countries that subscribe to the IMF‚Äôs Special Data Dissemination Standard (S) or Enhanced General Data Dissemination System (e-GDDS). S refers to countries that subscribe to the SDDS and have posted data on the Dissemination Standards Bulletin Board at http://dsbb.imf.org. S+ countries must observe additional coverage periodicity and timeliness requirements. e-G refers to countries that subscribe to the e-GDDS.""),
  latest_population_census STRING OPTIONS(description=""Latest population census shows the most recent year in which a census was conducted and in which at least preliminary results have been released. The preliminary results from the very recent censuses could be reflected in timely revisions if basic data are available such as population by age and sex as well as the detailed definition of counting coverage and completeness.""),
  latest_household_survey STRING OPTIONS(description=""Latest demographic education or health household survey indicates the household surveys used to compile the demographic education and health data. Detailed information on each survey is provided through the following links:  AIDS Indicator Survey Demographic and Health Survey Health Issues Survey and Malaria Indicator Survey - www.dhsprogram.com; Living Standards Measurement Study -  www.worldbank.org/lsms; Multiple Indicator Cluster Survey - http://mics.unicef.org; Reproductive Health Survey -  www.cdc.gov/reproductivehealth; World Health Survey is available at - www.who.int/healthinfo/survey/en.""),
  source_of_most_recent_income_and_expenditure_data STRING OPTIONS(description=""Source of most recent income and expenditure data shows household surveys that collect income and expenditure data. Names and detailed information on household surveys can be found on the website of the International Household Survey Network (www.surveynetwork.org). Core Welfare Indicator Questionnaire Surveys (CWIQ) developed by the World Bank measure changes in key social indicators for different population groups‚Äîspecifically indicators of access utilization and satisfaction with core social and economic services. Expenditure survey/budget surveys (ES/BS) collect detailed information on household consumption as well as on general demographic social and economic characteristics. Integrated household surveys (IHS) collect detailed information on a wide variety of topics including health education economic activities housing and utilities.""),
  vital_registration_complete STRING OPTIONS(description=""Vital registration complete identifies countries that report at least 90 percent complete registries of vital (birth and death) statistics to the United Nations Statistics Division and are reported in its Population and Vital Statistics Reports. Countries with complete vital statistics registries may have more accurate and more timely demographic indicators than other countries.""),
  latest_agricultural_census STRING OPTIONS(description=""Latest agricultural census shows the most recent year in which an agricultural census was conducted or planned to be conducted as reported to the Food and Agriculture Organization.""),
  latest_industrial_data STRING OPTIONS(description=""Latest industrial data show the most recent year for which manufacturing value added data at the three-digit level of the International Standard Industrial Classification (revision 2 or 3) are available in the United Nations Industrial Development Organization database.""),
  latest_trade_data STRING OPTIONS(description=""Latest trade data show the most recent year for which structure of merchandise trade data from the United Nations Statistics Division‚Äôs Commodity Trade (Comtrade) database are available."")
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'world_bank_global_population': ['population_by_country'], 'world_bank_health_population': ['country_series_definitions', 'country_summary', 'health_nutrition_population', 'series_summary', 'series_times'], 'world_bank_intl_debt': ['country_series_definitions', 'country_summary', 'international_debt', 'series_summary', 'series_times'], 'world_bank_intl_education': ['country_series_definitions', 'country_summary', 'international_education', 'series_summary'], 'world_bank_wdi': ['country_series_definitions', 'country_summary', 'footnotes', 'indicators_data', 'series_summary', 'series_time']}}
Begin Exploring Related Columns
Columns and Potential Usage:

- `indicators_data.indicator_name`: To identify and filter for the crude birth rate indicator.
- `indicators_data.indicator_code`: To find the code associated with the crude birth rate indicator.
- `indicators_data.value`: Contains the crude birth rate values per country per year.
- `indicators_data.year`: To filter data for the 1980s (1980-1989).
- `indicators_data.country_code`: To join with `country_summary` table on country codes.
- `country_summary.country_code`: To join with `indicators_data` table.
- `country_summary.income_group`: To filter for high-income countries.
- `country_summary.region`: To obtain the region each country belongs to.

Conditions that may be used:

- `indicators_data.indicator_code = 'SP.DYN.CBRT.IN'` (assuming this is the code for crude birth rate per 1,000 people).
- `indicators_data.year BETWEEN 1980 AND 1989` to select data from the 1980s.
- `country_summary.income_group = 'High income'` to filter high-income countries.

SQL Queries:

1. Find all distinct indicator names containing 'birth rate':

```sql
SELECT DISTINCT `indicator_name`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE LOWER(`indicator_name`) LIKE '%birth rate%'
LIMIT 1000;
```

2. Retrieve indicator codes and names for 'crude birth rate':

```sql
SELECT DISTINCT `indicator_code`, `indicator_name`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE LOWER(`indicator_name`) LIKE '%crude birth rate%'
LIMIT 1000;
```

3. List high-income countries with their regions:

```sql
SELECT `country_code`, `short_name`, `region`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
WHERE `income_group` = 'High income'
LIMIT 1000;
```

4. Get crude birth rate values for all countries during the 1980s:

```sql
SELECT `country_code`, `year`, `value`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `indicator_code` = 'SP.DYN.CBRT.IN` AND `year` BETWEEN 1980 AND 1989
LIMIT 1000;
```

5. List all regions available in the dataset:

```sql
SELECT DISTINCT `region`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
LIMIT 1000;
```

6. Find all years for which crude birth rate data is available:

```sql
SELECT DISTINCT `year`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `indicator_code` = 'SP.DYN.CBRT.IN'
LIMIT 1000;
```

7. Get average crude birth rate per country during the 1980s:

```sql
SELECT `country_code`, AVG(`value`) AS avg_birth_rate
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `indicator_code` = 'SP.DYN.CBRT.IN` AND `year` BETWEEN 1980 AND 1989
GROUP BY `country_code`
LIMIT 1000;
```

8. Retrieve all distinct income groups:

```sql
SELECT DISTINCT `income_group`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
LIMIT 1000;
```

9. List countries with their income group and region:

```sql
SELECT `country_code`, `short_name`, `income_group`, `region`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
LIMIT 1000;
```

10. Get crude birth rate data for the United States during the 1980s:

```sql
SELECT `year`, `value`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `country_code` = 'USA' AND `indicator_code` = 'SP.DYN.CBRT.IN' AND `year` BETWEEN 1980 AND 1989
ORDER BY `year`
LIMIT 1000;
```

11. Find country codes and names in the 'Europe & Central Asia' region:

```sql
SELECT `country_code`, `short_name`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
WHERE `region` = 'Europe & Central Asia'
LIMIT 1000;
```

12. List high-income countries in the 'Latin America & Caribbean' region:

```sql
SELECT `country_code`, `short_name`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
WHERE `region` = 'Latin America & Caribbean' AND `income_group` = 'High income'
LIMIT 1000;
```

13. Identify years with crude birth rate data for high-income countries:

```sql
SELECT DISTINCT `year`
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS ind
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
ON ind.`country_code` = cs.`country_code`
WHERE ind.`indicator_code` = 'SP.DYN.CBRT.IN' AND cs.`income_group` = 'High income'
LIMIT 1000;
```

14. Fetch crude birth rate values for Ireland during the 1980s:

```sql
SELECT `year`, `value`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `country_code` = 'IRL' AND `indicator_code` = 'SP.DYN.CBRT.IN' AND `year` BETWEEN 1980 AND 1989
ORDER BY `year`
LIMIT 1000;
```

15. Find indicator codes and names related to 'birth':

```sql
SELECT DISTINCT `indicator_code`, `indicator_name`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE LOWER(`indicator_name`) LIKE '%birth%'
LIMIT 1000;
```Query:
SELECT DISTINCT `indicator_name`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE LOWER(`indicator_name`) LIKE '%birth rate%'
LIMIT 1000;
Answer:
indicator_name
"Birth rate, crude (per 1,000 people)"
Query:
SELECT `country_name`, `year`, `value`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `indicator_name` = 'Birth rate, crude (per 1,000 people)'
LIMIT 1000;
Answer:
country_name,year,value
Myanmar,1965,41.826
Myanmar,2006,22.16
Nepal,2003,28.105
Niger,1971,56.733
Niger,2002,52.915
Canada,2007,11.2
Low & middle income,2016,20.503820656322
Middle East & North Africa (excluding high income),1989,34.8137044435591
Djibouti,1979,41.574
Lao PDR,1976,42.849
Liberia,2005,40.213
Africa Western and Central,1986,45.9638810057394
Africa Western and Central,2017,37.6041829377417
East Asia & Pacific,2017,13.5804384508057
East Asia & Pacific (IDA & IBRD countries),1961,24.4310592706922
Russian Federation,1976,15.641
Russian Federation,1979,15.8
Rwanda,2016,32.353
Saudi Arabia,1976,45.184
Seychelles,1977,25.9
Sierra Leone,1966,47.731
Sierra Leone,2014,35.677
Palau,2014,13.7
Papua New Guinea,1961,42.311
Channel Islands,1996,13.036
"Congo, Dem. Rep.",2001,45.931
Afghanistan,1967,51.65
Algeria,2014,25.538
Middle East & North Africa (IDA & IBRD countries),2006,24.0073473875192
North America,1985,15.7118237598039
OECD members,2001,13.4616995249281
Post-demographic dividend,1972,16.6215708377035
Post-demographic dividend,1998,11.6439718984765
Post-demographic dividend,2010,11.1464998406049
Pre-demographic dividend,1980,47.3217027778867
Pre-demographic dividend,2013,39.1123002300184
Estonia,1967,14.2
Estonia,1969,15.4
Estonia,1972,15.6
Eswatini,1974,50.468
Ethiopia,1967,47.725
Ethiopia,1973,48.482
Faroe Islands,1998,14.0
Fiji,1974,33.114
Finland,1987,12.1
France,1996,12.8
Gabon,1978,38.0
"Gambia, The",1985,46.844
Europe & Central Asia,1995,12.5104388271239
Europe & Central Asia,1999,11.6264867807958
Europe & Central Asia (IDA & IBRD countries),1978,20.6762952508709
Europe & Central Asia (IDA & IBRD countries),2003,13.209619069296
Europe & Central Asia (IDA & IBRD countries),2017,13.802397920582
Heavily indebted poor countries (HIPC),1961,48.0648018637456
Heavily indebted poor countries (HIPC),1987,46.1024984231831
"Macao SAR, China",1971,10.869
"Macao SAR, China",2008,9.06
Malta,1990,15.2
Malta,1994,12.9
Mauritania,1969,46.552
Mauritius,1984,20.1
Mauritius,2005,15.3
Singapore,2013,9.3
Slovenia,1982,15.1
Somalia,1977,44.373
South Sudan,2012,37.34
Spain,1980,15.2
Romania,1991,12.0
Cote d'Ivoire,1990,43.224
Croatia,1976,14.8
Cyprus,1985,20.34
Czech Republic,1975,19.1
Guinea-Bissau,1976,45.55
Small states,2013,23.2299873677062
Query:
-- Corrected Query 1
SELECT `country_code`, `short_name`, `region`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
WHERE `income_group` LIKE 'High income%'
LIMIT 1000
Answer:
country_code,short_name,region
AND,Andorra,Europe & Central Asia
BMU,Bermuda,North America
CHI,Channel Islands,Europe & Central Asia
CUW,Cura√ßao,Latin America & Caribbean
CYM,Cayman Islands,Latin America & Caribbean
FRO,Faroe Islands,Europe & Central Asia
GIB,Gibraltar,Europe & Central Asia
GRL,Greenland,Europe & Central Asia
GUM,Guam,East Asia & Pacific
IMN,Isle of Man,Europe & Central Asia
LIE,Liechtenstein,Europe & Central Asia
MAF,St. Martin (French part),Latin America & Caribbean
MCO,Monaco,Europe & Central Asia
MNP,Northern Mariana Islands,East Asia & Pacific
NCL,New Caledonia,East Asia & Pacific
NRU,Nauru,East Asia & Pacific
NZL,New Zealand,East Asia & Pacific
PRI,Puerto Rico,Latin America & Caribbean
PYF,French Polynesia,East Asia & Pacific
SXM,Sint Maarten (Dutch part),Latin America & Caribbean
TCA,Turks and Caicos Islands,Latin America & Caribbean
VGB,British Virgin Islands,Latin America & Caribbean
VIR,Virgin Islands,Latin America & Caribbean
ABW,Aruba,Latin America & Caribbean
ARE,United Arab Emirates,Middle East & North Africa
ATG,Antigua and Barbuda,Latin America & Caribbean
BHR,Bahrain,Middle East & North Africa
BHS,The Bahamas,Latin America & Caribbean
BRB,Barbados,Latin America & Caribbean
BRN,Brunei,East Asia & Pacific
KNA,St. Kitts and Nevis,Latin America & Caribbean
KWT,Kuwait,Middle East & North Africa
MAC,"Macao SAR, China",East Asia & Pacific
OMN,Oman,Middle East & North Africa
PAN,Panama,Latin America & Caribbean
QAT,Qatar,Middle East & North Africa
SMR,San Marino,Europe & Central Asia
TTO,Trinidad and Tobago,Latin America & Caribbean
AUS,Australia,East Asia & Pacific
BEL,Belgium,Europe & Central Asia
CHE,Switzerland,Europe & Central Asia
CYP,Cyprus,Europe & Central Asia
EST,Estonia,Europe & Central Asia
GBR,United Kingdom,Europe & Central Asia
GRC,Greece,Europe & Central Asia
HKG,"Hong Kong SAR, China",East Asia & Pacific
HRV,Croatia,Europe & Central Asia
HUN,Hungary,Europe & Central Asia
IRL,Ireland,Europe & Central Asia
ISL,Iceland,Europe & Central Asia
ISR,Israel,Middle East & North Africa
KOR,Korea,East Asia & Pacific
MLT,Malta,Middle East & North Africa
NOR,Norway,Europe & Central Asia
POL,Poland,Europe & Central Asia
SAU,Saudi Arabia,Middle East & North Africa
SGP,Singapore,East Asia & Pacific
Query:
-- Corrected Query 2
SELECT `country_code`, `year`, `value`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `indicator_code` = 'SP.DYN.CBRT.IN' AND `year` BETWEEN 1980 AND 1989
LIMIT 1000
Answer:
country_code,year,value
BDI,1988,50.961
TLA,1988,28.349434569775
MNA,1981,41.1889494231624
EAR,1984,35.90671608227
EAP,1986,24.4306614211465
SYC,1980,28.9
OMN,1985,46.163
ABW,1987,21.008
OSS,1988,33.4464059193206
PRE,1984,46.5906908668772
MLI,1988,48.746
SGP,1983,16.3
SLB,1986,41.331
CZE,1984,13.3
HTI,1981,42.401
TSA,1981,37.2033506788069
LCA,1988,29.804
SYR,1981,44.064
IRQ,1983,38.969
VEN,1987,30.205
VNM,1981,31.68
NLD,1981,12.5
NCL,1986,24.9
NZL,1983,15.8
NER,1986,56.178
LAC,1981,32.1233804270661
LBR,1981,48.555
EAS,1981,23.0637636998303
SYC,1981,28.1
PNG,1981,39.016
FCS,1981,44.1926831101688
HIC,1987,14.1807644876801
GUY,1981,30.926
HKG,1981,16.8
BHR,1980,32.931
BRB,1988,16.407
KNA,1983,24.1
KNA,1985,23.1
MNE,1988,17.089
NER,1983,56.634
MNA,1982,40.855130241805
DNK,1982,10.3
LVA,1983,15.9
WSM,1983,36.047
CAF,1981,42.163
AFG,1982,50.098
AGO,1985,50.663
EST,1987,16.2
EUU,1980,13.9675011570752
MRT,1983,42.492
PRT,1981,15.4
GNB,1980,48.73
HTI,1983,42.429
BHS,1985,25.819
BLR,1985,16.5
KNA,1980,26.8
SUR,1989,28.295
IBT,1984,30.3249708951953
IDX,1986,43.4844843508447
TTO,1988,23.181
UZB,1984,36.3
MMR,1989,28.222
CAN,1983,15.0
LAC,1985,29.9974830347845
LIC,1980,46.2294380010898
LMC,1983,36.5338248511245
DMA,1982,23.3
AFE,1980,46.1453277375565
ALB,1983,26.528
FRA,1984,14.3
SLB,1984,41.954
CYP,1981,20.168
TSA,1984,36.1731485377014
MAF,1988,25.5
IBT,1988,29.6891660619559
IRN,1980,44.108
ZMB,1983,47.053
BGR,1985,13.3
TLA,1985,30.0353211355085
DJI,1989,39.979
RWA,1984,52.454
NOR,1983,12.1
COD,1980,46.296
ATG,1989,18.587
SWZ,1983,47.211
SWZ,1989,39.87
ETH,1986,48.712
EUU,1981,13.5934870018468
ROU,1982,15.3
HUN,1983,11.9
Query:
-- Query 3 (No correction needed)
SELECT DISTINCT `region`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
LIMIT 1000
Answer:
region
""
Europe & Central Asia
North America
Latin America & Caribbean
East Asia & Pacific
Sub-Saharan Africa
Middle East & North Africa
South Asia
Query:
-- Query 4 (No correction needed)
SELECT DISTINCT `year`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `indicator_code` = 'SP.DYN.CBRT.IN'
LIMIT 1000
Answer:
year
1965
2006
2003
1971
2002
2007
2016
1989
1979
1976
2005
1986
2017
1961
1977
1966
2014
1996
2001
1967
1985
1972
1998
2010
1980
2013
1969
1974
1973
1987
1978
1995
1999
2008
1990
1994
1984
1982
2012
1991
1975
1963
2004
1968
1992
1997
1964
1981
2009
2000
2011
2019
1983
2015
1970
1993
1988
2018
1962
1960
Query:
-- Corrected Query 5
SELECT `country_code`, AVG(`value`) AS avg_birth_rate
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `indicator_code` = 'SP.DYN.CBRT.IN' AND `year` BETWEEN 1980 AND 1989
GROUP BY `country_code`
LIMIT 1000
Answer:
country_code,avg_birth_rate
MNA,38.90497580367373
AFW,46.297966596779645
NAC,15.73848700906143
PRE,46.44554769910849
FIN,13.0
GMB,46.9401
HPC,46.58286755898328
MUS,21.419999999999998
SVN,13.739999999999998
ESP,12.350000000000001
CYP,20.0695
GEO,18.5041
DEU,10.93
TTO,26.4283
URY,18.429100000000002
KAZ,24.69
KGZ,31.4
ARB,39.02714036733985
TCD,50.2463
CHI,11.834700000000002
CHN,21.224000000000004
COD,46.183499999999995
MIC,29.392565448048188
EST,15.67
ETH,48.7467
SSD,47.773399999999995
CUB,16.885799999999996
CZE,13.31
GIN,48.5351
AZE,26.459100000000003
BGD,39.873999999999995
CHE,11.739999999999998
IBT,30.387631580650208
MOZ,45.614599999999996
BMU,15.066666666666666
TKM,36.3478
PRK,20.8603
NCL,25.310000000000002
BRN,30.5327
CPV,42.103199999999994
GNQ,43.03
LSO,39.406099999999995
CSS,27.529797280576627
PSS,35.11662699860514
ECS,16.253794753659193
MAC,20.7301
SLB,42.008300000000006
POL,17.880000000000003
PRT,13.75
CIV,45.8676
BEL,12.07
IRL,18.19
VNM,30.669600000000003
KIR,37.016999999999996
LTU,15.889999999999999
EAR,35.44338867101696
MKD,19.8519
AGO,50.497099999999996
TSA,35.748496308582276
SYR,41.164300000000004
IRQ,38.7932
ZMB,46.7965
BFA,48.4748
LIE,14.09
AFE,45.22247374583799
RWA,51.6686
OED,16.515610379433454
FRA,14.05
FCS,43.25660731556301
ROU,16.160000000000004
VCT,27.8353
GRD,31.8155
BLZ,38.890299999999996
BGR,13.52
CAN,14.899999999999999
EAP,23.77923550301364
ARM,23.951500000000003
PST,13.807382489286258
GAB,38.1974
GUY,29.8218
SUR,29.2968
TEA,23.81699023563197
CAF,42.3932
OSS,34.337881483810925
ERI,44.6254
SGP,17.08
PRI,20.200000000000003
SST,32.652219999619874
IBD,27.34765304308288
LTE,22.285028992039802
Query:
-- Query 6 (No correction needed)
SELECT DISTINCT `income_group`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
LIMIT 1000
Answer:
income_group
""
High income
Low income
Upper middle income
Lower middle income
Query:
-- Query 7 (No correction needed)
SELECT `country_code`, `short_name`, `income_group`, `region`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
LIMIT 1000
Answer:
country_code,short_name,income_group,region
AFE,Africa Eastern and Southern,,
AFW,Africa Western and Central,,
ARB,Arab World,,
CEB,Central Europe and the Baltics,,
CSS,Caribbean small states,,
EAP,East Asia & Pacific (excluding high income),,
EAR,Early-demographic dividend,,
EAS,East Asia & Pacific,,
ECA,Europe & Central Asia (excluding high income),,
ECS,Europe & Central Asia,,
EUU,European Union,,
FCS,Fragile and conflict affected situations,,
HIC,High income,,
HPC,Heavily indebted poor countries (HIPC),,
IBD,IBRD only,,
IBT,IDA & IBRD total,,
IDA,IDA total,,
IDB,IDA blend,,
IDX,IDA only,,
LAC,Latin America & Caribbean (excluding high income),,
LCN,Latin America & Caribbean,,
LDC,Least developed countries: UN classification,,
LIC,Low income,,
LMC,Lower middle income,,
LMY,Low & middle income,,
LTE,Late-demographic dividend,,
MEA,Middle East & North Africa,,
MIC,Middle income,,
MNA,Middle East & North Africa (excluding high income),,
NAC,North America,,
OED,OECD members,,
OSS,Other small states,,
PRE,Pre-demographic dividend,,
PSS,Pacific island small states,,
PST,Post-demographic dividend,,
SAS,South Asia,,
SSA,Sub-Saharan Africa (excluding high income),,
SSF,Sub-Saharan Africa,,
SST,Small states,,
TEA,East Asia & Pacific (IDA & IBRD),,
TEC,Europe & Central Asia (IDA & IBRD),,
TLA,Latin America & Caribbean (IDA & IBRD),,
TMN,Middle East & North Africa (IDA & IBRD),,
TSA,South Asia (IDA & IBRD),,
TSS,Sub-Saharan Africa (IDA & IBRD),,
UMC,Upper middle income,,
WLD,World,,
AND,Andorra,High income,Europe & Central Asia
BMU,Bermuda,High income,North America
Query:
-- Query 8 (No correction needed)
SELECT `year`, `value`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `country_code` = 'USA' AND `indicator_code` = 'SP.DYN.CBRT.IN' AND `year` BETWEEN 1980 AND 1989
ORDER BY `year`
LIMIT 1000
Answer:
year,value
1980,15.9
1981,15.8
1982,15.9
1983,15.6
1984,15.6
1985,15.8
1986,15.6
1987,15.7
1988,16.0
1989,16.4
Query:
-- Query 9 (No correction needed)
SELECT `country_code`, `short_name`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
WHERE `region` = 'Europe & Central Asia'
LIMIT 1000
Answer:
country_code,short_name
AND,Andorra
CHI,Channel Islands
FRO,Faroe Islands
GIB,Gibraltar
GRL,Greenland
IMN,Isle of Man
LIE,Liechtenstein
MCO,Monaco
TKM,Turkmenistan
SMR,San Marino
TJK,Tajikistan
UZB,Uzbekistan
ALB,Albania
AZE,Azerbaijan
BIH,Bosnia and Herzegovina
MNE,Montenegro
SRB,Serbia
XKX,Kosovo
BEL,Belgium
CHE,Switzerland
CYP,Cyprus
EST,Estonia
GBR,United Kingdom
GRC,Greece
HRV,Croatia
HUN,Hungary
IRL,Ireland
ISL,Iceland
NOR,Norway
POL,Poland
KGZ,Kyrgyz Republic
UKR,Ukraine
ARM,Armenia
BLR,Belarus
GEO,Georgia
KAZ,Kazakhstan
MDA,Moldova
RUS,Russia
TUR,T√ºrkiye
AUT,Austria
CZE,Czech Republic
DEU,Germany
DNK,Denmark
ESP,Spain
FIN,Finland
FRA,France
ITA,Italy
LTU,Lithuania
LUX,Luxembourg
LVA,Latvia
NLD,Netherlands
PRT,Portugal
ROU,Romania
SVK,Slovak Republic
SVN,Slovenia
SWE,Sweden
BGR,Bulgaria
MKD,North Macedonia
Query:
-- Corrected Query 10
SELECT `country_code`, `short_name`
FROM `bigquery-public-data.world_bank_wdi.country_summary`
WHERE `region` = 'Latin America & Caribbean' AND `income_group` LIKE 'High income%'
LIMIT 1000
Answer:
country_code,short_name
CUW,Cura√ßao
CYM,Cayman Islands
MAF,St. Martin (French part)
PRI,Puerto Rico
SXM,Sint Maarten (Dutch part)
TCA,Turks and Caicos Islands
VGB,British Virgin Islands
VIR,Virgin Islands
ABW,Aruba
ATG,Antigua and Barbuda
BHS,The Bahamas
BRB,Barbados
KNA,St. Kitts and Nevis
PAN,Panama
TTO,Trinidad and Tobago
URY,Uruguay
CHL,Chile
Query:
-- Corrected Query 11
SELECT DISTINCT ind.`year`
FROM `bigquery-public-data.world_bank_wdi.indicators_data` AS ind
JOIN `bigquery-public-data.world_bank_wdi.country_summary` AS cs
ON ind.`country_code` = cs.`country_code`
WHERE ind.`indicator_code` = 'SP.DYN.CBRT.IN' AND cs.`income_group` LIKE 'High income%'
LIMIT 1000
Answer:
year
2007
1976
1977
1996
1967
1969
1972
1998
1987
1971
2008
1990
1994
2013
1982
1980
1991
1985
1975
2005
1979
1989
1997
1981
2000
2011
1966
1983
1978
2002
1963
2003
2009
1999
1988
2014
2016
1962
1974
1960
1984
1970
1961
1986
2018
2004
2019
2012
1992
1995
2017
1965
1973
2010
1968
1993
2006
2015
2001
1964
Query:
-- Query 12 (No correction needed)
SELECT `year`, `value`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE `country_code` = 'IRL' AND `indicator_code` = 'SP.DYN.CBRT.IN' AND `year` BETWEEN 1980 AND 1989
ORDER BY `year`
LIMIT 1000
Answer:
year,value
1980,21.7
1981,20.9
1982,20.3
1983,19.1
1984,18.1
1985,17.6
1986,17.4
1987,16.5
1988,15.5
1989,14.8
Query:
-- Query 13 (No correction needed)
SELECT DISTINCT `indicator_code`, `indicator_name`
FROM `bigquery-public-data.world_bank_wdi.indicators_data`
WHERE LOWER(`indicator_name`) LIKE '%birth%'
LIMIT 1000
Answer:
indicator_code,indicator_name
SP.ADO.TFRT,"Adolescent fertility rate (births per 1,000 women ages 15-19)"
SP.DYN.CBRT.IN,"Birth rate, crude (per 1,000 people)"
SP.DYN.TFRT.IN,"Fertility rate, total (births per woman)"
SP.DYN.LE00.FE.IN,"Life expectancy at birth, female (years)"
SP.DYN.IMRT.MA.IN,"Mortality rate, infant, male (per 1,000 live births)"
SH.DYN.MORT,"Mortality rate, under-5 (per 1,000 live births)"
SP.REG.BRTH.ZS,Completeness of birth registration (%)
SP.DYN.LE00.IN,"Life expectancy at birth, total (years)"
SP.DYN.IMRT.IN,"Mortality rate, infant (per 1,000 live births)"
SH.DYN.NMRT,"Mortality rate, neonatal (per 1,000 live births)"
SH.DYN.MORT.MA,"Mortality rate, under-5, male (per 1,000 live births)"
SP.DYN.LE00.MA.IN,"Life expectancy at birth, male (years)"
SH.STA.BRTW.ZS,Low-birthweight babies (% of births)
SH.STA.MMRT,"Maternal mortality ratio (modeled estimate, per 100,000 live births)"
SH.DYN.MORT.FE,"Mortality rate, under-5, female (per 1,000 live births)"
SP.DYN.IMRT.FE.IN,"Mortality rate, infant, female (per 1,000 live births)"
SP.REG.BRTH.FE.ZS,"Completeness of birth registration, female (%)"
SP.POP.BRTH.MF,Sex ratio at birth (male births per female births)
SH.STA.BRTC.ZS,Births attended by skilled health staff (% of total)
SH.STA.MMRT.NE,"Maternal mortality ratio (national estimate, per 100,000 live births)"
SP.REG.BRTH.UR.ZS,"Completeness of birth registration, urban (%)"
SP.REG.BRTH.MA.ZS,"Completeness of birth registration, male (%)"
SP.DYN.WFRT,Wanted fertility rate (births per woman)
SP.REG.BRTH.RU.ZS,"Completeness of birth registration, rural (%)"
End Exploring Related Columns
Task: Which high-income country had the highest average crude birth rate respectively in each region, and what are their corresponding average birth rate, during the 1980s?

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
Country,Region,Average_Crude_Birth_Rate
Kuwait,Middle East & North Africa,35
Bahamas,Latin America & Caribbean,20
Ireland,Europe & Central Asia,17
New Zealand,East Asia & Pacific,16
United States,North America,15
```

These are the high-income countries with the highest average crude birth rates in their respective regions during the 1980s..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'world_bank_global_population': ['population_by_country'], 'world_bank_health_population': ['country_series_definitions', 'country_summary', 'health_nutrition_population', 'series_summary', 'series_times'], 'world_bank_intl_debt': ['country_series_definitions', 'country_summary', 'international_debt', 'series_summary', 'series_times'], 'world_bank_intl_education': ['country_series_definitions', 'country_summary', 'international_education', 'series_summary'], 'world_bank_wdi': ['country_series_definitions', 'country_summary', 'footnotes', 'indicators_data', 'series_summary', 'series_time']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-20 17:33:26 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 17:33:26 - root - INFO - ```sql
WITH high_income_countries AS (
  SELECT `country_code`, `short_name` AS `country`, `region`
  FROM `bigquery-public-data.world_bank_wdi.country_summary`
  WHERE `income_group` LIKE 'High income%'
),
birth_rate_80s AS (
  SELECT `country_code`, `year`, `value`
  FROM `bigquery-public-data.world_bank_wdi.indicators_data`
  WHERE `indicator_code` = 'SP.DYN.CBRT.IN'
    AND `year` BETWEEN 1980 AND 1989
),
avg_birth_rate AS (
  SELECT `country_code`, AVG(`value`) AS `avg_crude_birth_rate`
  FROM birth_rate_80s
  GROUP BY `country_code`
),
high_income_birth_rate AS (
  SELECT hi.`country_code`, hi.`country`, hi.`region`, ab.`avg_crude_birth_rate`
  FROM high_income_countries hi
  JOIN avg_birth_rate ab
    ON hi.`country_code` = ab.`country_code`
),
ranked_birth_rate AS (
  SELECT hib.`region`, hib.`country_code`, hib.`country`, hib.`avg_crude_birth_rate`,
         ROW_NUMBER() OVER (PARTITION BY hib.`region` ORDER BY hib.`avg_crude_birth_rate` DESC) AS `rn`
  FROM high_income_birth_rate hib
)
SELECT `country`, `region`, ROUND(`avg_crude_birth_rate`,4) AS `Average_Crude_Birth_Rate`
FROM ranked_birth_rate
WHERE `rn` = 1
```
2025-01-20 17:33:28 - root - INFO - itercount: 1
2025-01-20 17:33:28 - root - INFO - 0
2025-01-20 17:33:28 - root - INFO - results: 
country,region,Average_Crude_Birth_Rate
Brunei,East Asia & Pacific,30.5327
Seychelles,Sub-Saharan Africa,25.78
Panama,Latin America & Caribbean,28.6437
Greenland,Europe & Central Asia,20.66
United States,North America,15.83
Oman,Middle East & North Africa,45.9702


2025-01-20 17:33:28 - root - INFO - Please check the answer again by reviewing Which high-income country had the highest average crude birth rate respectively in each region, and what are their corresponding average birth rate, during the 1980s?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Country,Region,Average_Crude_Birth_Rate
Kuwait,Middle East & North Africa,35
Bahamas,Latin America & Caribbean,20
Ireland,Europe & Central Asia,17
New Zealand,East Asia & Pacific,16
United States,North America,15
```

These are the high-income countries with the highest average crude birth rates in their respective regions during the 1980s. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
country,region,Average_Crude_Birth_Rate
Brunei,East Asia & Pacific,30.5327
Seychelles,Sub-Saharan Africa,25.78
Panama,Latin America & Caribbean,28.6437
Greenland,Europe & Central Asia,20.66
United States,North America,15.83
Oman,Middle East & North Africa,45.9702
Current sql:
WITH high_income_countries AS (
  SELECT `country_code`, `short_name` AS `country`, `region`
  FROM `bigquery-public-data.world_bank_wdi.country_summary`
  WHERE `income_group` LIKE 'High income%'
),
birth_rate_80s AS (
  SELECT `country_code`, `year`, `value`
  FROM `bigquery-public-data.world_bank_wdi.indicators_data`
  WHERE `indicator_code` = 'SP.DYN.CBRT.IN'
    AND `year` BETWEEN 1980 AND 1989
),
avg_birth_rate AS (
  SELECT `country_code`, AVG(`value`) AS `avg_crude_birth_rate`
  FROM birth_rate_80s
  GROUP BY `country_code`
),
high_income_birth_rate AS (
  SELECT hi.`country_code`, hi.`country`, hi.`region`, ab.`avg_crude_birth_rate`
  FROM high_income_countries hi
  JOIN avg_birth_rate ab
    ON hi.`country_code` = ab.`country_code`
),
ranked_birth_rate AS (
  SELECT hib.`region`, hib.`country_code`, hib.`country`, hib.`avg_crude_birth_rate`,
         ROW_NUMBER() OVER (PARTITION BY hib.`region` ORDER BY hib.`avg_crude_birth_rate` DESC) AS `rn`
  FROM high_income_birth_rate hib
)
SELECT `country`, `region`, ROUND(`avg_crude_birth_rate`,4) AS `Average_Crude_Birth_Rate`
FROM ranked_birth_rate
WHERE `rn` = 1
2025-01-20 17:34:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 17:34:01 - root - INFO - ```sql
WITH high_income_countries AS (
  SELECT `country_code`, `short_name` AS `country`, `region`
  FROM `bigquery-public-data.world_bank_wdi.country_summary`
  WHERE `income_group` LIKE 'High income%'
),
birth_rate_80s AS (
  SELECT `country_code`, `year`, `value`
  FROM `bigquery-public-data.world_bank_wdi.indicators_data`
  WHERE `indicator_code` = 'SP.DYN.CBRT.IN'
    AND `year` BETWEEN 1980 AND 1989
),
avg_birth_rate AS (
  SELECT `country_code`, AVG(`value`) AS `avg_crude_birth_rate`
  FROM birth_rate_80s
  GROUP BY `country_code`
),
high_income_birth_rate AS (
  SELECT hi.`country_code`, hi.`country`, hi.`region`, ab.`avg_crude_birth_rate`
  FROM high_income_countries hi
  JOIN avg_birth_rate ab
    ON hi.`country_code` = ab.`country_code`
),
ranked_birth_rate AS (
  SELECT hib.`region`, hib.`country_code`, hib.`country`, hib.`avg_crude_birth_rate`,
         ROW_NUMBER() OVER (PARTITION BY hib.`region` ORDER BY hib.`avg_crude_birth_rate` DESC) AS `rn`
  FROM high_income_birth_rate hib
)
SELECT `country`, `region`, ROUND(`avg_crude_birth_rate`,4) AS `Average_Crude_Birth_Rate`
FROM ranked_birth_rate
WHERE `rn` = 1
```
2025-01-20 17:34:03 - root - INFO - itercount: 2
2025-01-20 17:34:03 - root - INFO - 0
2025-01-20 17:34:03 - root - INFO - Total iteration counts: 2
