2025-01-20 13:03:11 - openai._base_client - INFO - Retrying request to /chat/completions in 0.495696 seconds
2025-01-20 13:04:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 13:04:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:04:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:04:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:04:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7
2025-01-20 13:04:41 - snowflake.connector.connection - INFO - closed
2025-01-20 13:04:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:04:41 - root - INFO - SQL:
-- 1. Get distinct values of "day_of_week".
SELECT DISTINCT "day_of_week"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
LIMIT 1000
Results:
day_of_week
7
6
4
1
5
2
3

2025-01-20 13:04:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:04:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:04:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:04:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7
2025-01-20 13:04:43 - snowflake.connector.connection - INFO - closed
2025-01-20 13:04:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:04:43 - root - INFO - SQL:
-- 2. Count of accidents per "day_of_week".
SELECT "day_of_week", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
GROUP BY "day_of_week"
LIMIT 1000
Results:
day_of_week,num_accidents
7,6159
6,5397
4,4439
1,5353
5,4706
2,4537
3,4157

2025-01-20 13:04:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:04:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:04:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:04:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 13
2025-01-20 13:04:44 - snowflake.connector.connection - INFO - closed
2025-01-20 13:04:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:04:45 - root - INFO - SQL:
-- 3. Get distinct weather conditions in "atmospheric_conditions_1_name".
SELECT DISTINCT "atmospheric_conditions_1_name"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
LIMIT 1000
Results:
atmospheric_conditions_1_name
"Sleet, Hail"
Severe Crosswinds
Other
"Blowing Sand, Soil, Dirt"
Blowing Snow
Freezing Rain or Drizzle
Unknown
Clear
Rain
"Fog, Smog, Smoke"
Cloudy
Snow
Not Reported

2025-01-20 13:04:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:04:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:04:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:04:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 13
2025-01-20 13:04:46 - snowflake.connector.connection - INFO - closed
2025-01-20 13:04:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:04:46 - root - INFO - SQL:
-- 4. Count of accidents per "atmospheric_conditions_1_name".
SELECT "atmospheric_conditions_1_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
GROUP BY "atmospheric_conditions_1_name"
LIMIT 1000
Results:
atmospheric_conditions_1_name,num_accidents
"Sleet, Hail",65
Severe Crosswinds,42
Other,48
"Blowing Sand, Soil, Dirt",20
Blowing Snow,10
Freezing Rain or Drizzle,17
Unknown,146
Clear,24956
Rain,2107
"Fog, Smog, Smoke",329
Cloudy,5126
Snow,328
Not Reported,1554

2025-01-20 13:04:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:04:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:04:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:04:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 51
2025-01-20 13:04:48 - snowflake.connector.connection - INFO - closed
2025-01-20 13:04:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:04:48 - root - INFO - SQL:
-- 5. Count of accidents per "state_name".
SELECT "state_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
GROUP BY "state_name"
LIMIT 1000
Results:
state_name,num_accidents
Idaho,232
Maryland,484
Nebraska,194
Ohio,1053
Kansas,381
New Mexico,361
Utah,259
Indiana,776
Arkansas,504
Minnesota,357
Georgia,1424
Louisiana,704
Vermont,57
New Jersey,570
Wisconsin,544
Colorado,558
New York,981
West Virginia,250
Alaska,78
Virginia,722
Florida,2935
Kentucky,763
District of Columbia,26
New Hampshire,130
Wyoming,100
North Carolina,1348
Tennessee,962
Arizona,856
Oregon,448
Pennsylvania,1088
Connecticut,292
Nevada,304
California,3540
Illinois,1000
South Carolina,941
Texas,3427
Mississippi,625
Michigan,981
Alabama,979
Missouri,872
Iowa,355
Hawaii,109
Massachusetts,356
Delaware,116
Maine,150
Oklahoma,628
North Dakota,102
South Dakota,103
Rhode Island,48
Montana,171
Washington,504

2025-01-20 13:04:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:04:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:04:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:04:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 51
2025-01-20 13:04:49 - snowflake.connector.connection - INFO - closed
2025-01-20 13:04:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:04:50 - root - INFO - SQL:
-- 6. Get distinct "state_name" and corresponding "state_number".
SELECT DISTINCT "state_name", "state_number"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
LIMIT 1000
Results:
state_name,state_number
Idaho,16
Maryland,24
North Carolina,37
Ohio,39
California,6
Kansas,20
New Mexico,35
Utah,49
Missouri,29
Maine,23
Indiana,18
Iowa,19
Arkansas,5
Minnesota,27
Georgia,13
Tennessee,47
Vermont,50
Alabama,1
Montana,30
Oklahoma,40
Washington,53
New Jersey,34
Pennsylvania,42
West Virginia,54
South Carolina,45
Alaska,2
Florida,12
Hawaii,15
Wisconsin,55
Colorado,8
Texas,48
North Dakota,38
Kentucky,21
Nevada,32
New Hampshire,33
Rhode Island,44
Delaware,10
Nebraska,31
Illinois,17
Arizona,4
Louisiana,22
Oregon,41
Connecticut,9
Mississippi,28
Massachusetts,25
New York,36
South Dakota,46
District of Columbia,11
Michigan,26
Wyoming,56
Virginia,51

2025-01-20 13:04:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:04:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:04:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:04:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 13:04:51 - snowflake.connector.connection - INFO - closed
2025-01-20 13:04:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:04:51 - root - INFO - SQL:
-- 7. Count of weekend accidents in a specific state (e.g., 'Texas').
SELECT COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "state_name" = 'Texas' AND "day_of_week" IN (1, 7)
LIMIT 1000
Results:
num_accidents
1202

2025-01-20 13:04:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:04:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:04:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:04:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 51
2025-01-20 13:04:53 - snowflake.connector.connection - INFO - closed
2025-01-20 13:04:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:04:53 - root - INFO - SQL:
-- 8. Count of weekend accidents per "state_name".
SELECT "state_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7)
GROUP BY "state_name"
LIMIT 1000
Results:
state_name,num_accidents
Idaho,61
Maryland,165
Ohio,347
California,1210
Kansas,119
Maine,48
Missouri,287
Arkansas,151
Georgia,467
North Carolina,425
Montana,65
Oklahoma,206
Washington,170
Wisconsin,192
South Carolina,325
Iowa,115
Virginia,249
South Dakota,35
Arizona,273
North Dakota,39
District of Columbia,8
Michigan,321
Delaware,38
New Mexico,111
Tennessee,341
Illinois,368
Minnesota,109
New Hampshire,34
Vermont,17
Hawaii,44
Nevada,98
Massachusetts,116
Indiana,244
Texas,1202
West Virginia,68
Pennsylvania,329
Kentucky,235
New York,303
Florida,1002
Rhode Island,10
Utah,78
Connecticut,90
Wyoming,29
Louisiana,244
New Jersey,187
Oregon,135
Alabama,329
Mississippi,213
Alaska,23
Colorado,168
Nebraska,69

2025-01-20 13:04:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:04:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:04:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:04:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 13
2025-01-20 13:04:55 - snowflake.connector.connection - INFO - closed
2025-01-20 13:04:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:04:55 - root - INFO - SQL:
-- 9. Count of weekend accidents per weather condition.
SELECT "atmospheric_conditions_1_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7)
GROUP BY "atmospheric_conditions_1_name"
LIMIT 1000
Results:
atmospheric_conditions_1_name,num_accidents
"Sleet, Hail",23
Severe Crosswinds,15
Other,13
Unknown,56
Blowing Snow,4
Freezing Rain or Drizzle,6
"Blowing Sand, Soil, Dirt",4
Clear,8411
Rain,672
Snow,109
Not Reported,489
"Fog, Smog, Smoke",102
Cloudy,1608

2025-01-20 13:04:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:04:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:04:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:04:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 296
2025-01-20 13:04:56 - snowflake.connector.connection - INFO - closed
2025-01-20 13:04:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:04:57 - root - INFO - SQL:
-- 10. Count of weekend accidents per "state_name" and weather condition.
SELECT "state_name", "atmospheric_conditions_1_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7)
GROUP BY "state_name", "atmospheric_conditions_1_name"
LIMIT 1000
Results:
Too long, hard cut:
state_name,atmospheric_conditions_1_name,num_accidents
Idaho,"Sleet, Hail",1
Maryland,"Sleet, Hail",2
Ohio,"Sleet, Hail",1
California,Severe Crosswinds,2
Kansas,Severe Crosswinds,4
New Mexico,Severe Crosswinds,1
Missouri,Other,2
New Mexico,Other,2
Arkansas,Unknown,2
Tennessee,"Sleet, Hail",6
North Carolina,Severe Crosswinds,2
Missouri,Unknown,2
Montana,Unknown,2
Oklahoma,Unknown,2
South Carolina,Blowing Snow,1
Iowa,Unknown,2
Virginia,"Sleet, Hail",1
Illinois,"Sleet, Hail",1
North Carolina,Freezing Rain or Drizzle,3
Tennessee,Unknown,6
Arkansas,Other,1
Texas,"Sleet, Hail",1
West Virginia,"Sleet, Hail",1
Arkansas,Severe Crosswinds,1
Kentucky,Severe Crosswinds,1
Indiana,"Sleet, Hail",1
Ohio,Unknown,1
Wisconsin,Severe Crosswinds,1
Kansas,Unknown,2
North Carolina,Other,1
Pennsylvania,Freezing Rain or Drizzle,1
Missouri,Clear,218
Tennessee,Clear,275
Minnesota,Clear,74
Rhode Island,Clear,8
Maryland,Rain,10
Iowa,Snow,4
Arkansas,Cloudy,17
Georgia,Unknown,4
Washington,Unknown,3
California,Unknown,1
South Dakota,Blowing Snow,1
Minnesota,Blowing Snow,1
New York,"Sleet, Hail",1
Arizona,Unknown,5
Florida,Other,2
South Carolina,Clear,285
Nebraska,Clear,52
Pennsylvania,Clear,282
South Dakota,Clear,32
Hawaii,Clear,34
Massachusetts,Clear,81
West Virginia,Rain,9
Oklahoma,Rain,12
West Virginia,Snow,1
Idaho,Snow,2
Virginia,"Fog, Smog, Smoke",5
Oregon,"Fog, Smog, Smoke",4
New York,Cloudy,74
Ohio,Rain,19
Iowa,"Fog, Smog, Smoke",2
Oklahoma,Not Reported,2
Oklahoma,Cloudy,58
Maine,Other,1
Indiana,Severe Crosswinds,1
Wisconsin,Unknown,5
Illinois,Unknown,3
Pennsylvania,"Sleet, Hail",2
Iowa,"Blowing Sand, Soil, Dirt",3
Kentucky,"Blowing Sand, Soil, Dirt",1
New Jersey,Freezing Rain or Drizzle,1
Hawaii,Unknown,1
Minnesota,Unknown,1
Connecticut,Other,1
North Dakota,Unknown,1
North Carolina,"Sleet, Hail",1
North Carolina,Clear,328
California,Clear,979
New Mexico,Clear,96
West Virginia,Clear,50
Arkansas,Rain,11
Montana,Rain,3
Pennsylvania,Rain,19
Tennessee,Rain,29
Indiana,"Fog, Smog, Smoke",4
Missouri,"Fog, Smog, Smoke",5
Georgia,Cloudy,77
South Dakota,Cloudy,1
Utah,Severe Crosswinds,1
Indiana,Freezing Rain or Drizzle,1
Pennsylvania,Other,2
Massachusetts,Unknown,1
District of Columbia,Unknown,1
Michigan,"Sleet, Hail",1
Michigan,Unknown,4
Indiana,Clear,170
North Dakota,Clear,31
Louisiana,Clear,199
Alabama,Clear,251
Colorado,Clear,16
Connecticut,Clear,80
Georgia,Clear,360
Illinois,Clear,326
Mississippi,Clear,170
Utah,Clear,52
Delaware,Clear,30
District of Columbia,Clear,7
Maine,Rain,4
Texas,Rain,68
Washington,Rain,24
California,Rain,55
Kentucky,Rain,27
Wyoming,Rain,2
Minnesota,Snow,1
Missouri,Snow,2
Illinois,Snow,8
Virginia,Snow,3
Oklahoma,Snow,1
Florida,"Fog, Smog, Smoke",8
California,"Fog, Smog, Smoke",7
New Mexico,"Fog, Smog, Smoke",1
Mississippi,Cloudy,29
Vermont,Cloudy,5
Pennsylvania,Not Reported,9
South Carolina,Not Reported,3
Arizona,"Sleet, Hail",1
Louisiana,Unknown,1
Alabama,Unknown,1
Kansas,Clear,33
Kentucky,Clear,161
New York,Clear,196
Oklahoma,Clear,131
Texas,Clear,895
Wisconsin,Clear,121
Louisiana,Rain,14
Oregon,Rain,16
Wisconsin,Rain,4
Iowa,Rain,4
Delaware,Rain,2
Michigan,Rain,21
Hawaii,Rain,5
Connecticut,Rain,2
Wisconsin,Snow,7
Ohio,Snow,8
Washington,Snow,2
Alaska,Snow,2
New Hampshire,Snow,1
Wisconsin,"Fog, Smog, Smoke",2
Pennsylvania,"Fog, Smog, Smoke",6
New Hampshire,"Fog, Smog, Smoke",1
Kansas,"Fog, Smog, Smoke",3
Connecticut,"Fog, Smog, Smoke",1
Kentucky,Cloudy,42
Montana,Cloudy,20
West Virginia,Cloudy,7
Alaska,Cloudy,5
Kansas,Cloudy,1
New Mexico,Cloudy,2
New Mexico,Not Reported,2
Mississippi,Rain,12
California,Snow,1
Maryland,Cloudy,14
Maine,Snow,1
Washington,Clear,113
Oregon,"Sleet, Hail",1
Maryland,Other,1
Utah,Unknown,2
Connecticut,Blowing Snow,1
Texas,Severe Crosswinds,1
Ohio,Clear,219
Arkansas,Clear,116
Idaho,Clear,42
Iowa,Clear,79
Maryland,Clear,127
Montana,Clear,38
New Jersey,Clear,158
Oregon,Clear,76
Florida,Rain,49
Indiana,Rain,20
North Carolina,Rain,33
New York,Rain,23
Alaska,Rain,5
Georgia,Rain,25
New Mexico,Rain,3
Missouri,Rain,8
Idaho,Rain,2
Colorado,Snow,1
Utah,Snow,4
Wyoming,Snow,4
Oregon,Snow,2
New Jersey,Snow,1
Arkansas,"Fog, Smog, Smoke",3
Kentucky,"Fog, Smog, Smoke",2
Louisiana,"Fog, Smog, Smoke",3
Massachusetts,"Fog, Smog, Smoke",2
Illinois,"Fog, Smog, Smoke",7
North Carolina,"Fog, Smog, Smoke",1
New York,"Fog, Smog, Smoke",2
Indiana,Cloudy,44
Michigan,Cloudy,59
Missouri,Cloudy,50
Texas,Cloudy,224
Iowa,Cloudy,21
North Dakota,Cloudy,5
Kansas,Not Reported,69
Oregon,Not Reported,4
Kansas,"Sleet, Hail",1
Texas,Unknown,3
Arizona,Clear,226
Florida,Clear,799
Maine,Clear,36
Michigan,Clear,210
Nevada,Clear,81
New Hampshire,Clear,23
Wyoming,Clear,23
Alaska,Clear,11
Illinois,Rain,17
Kansas,Rain,5
Nevada,Rain,2
Virginia,Rain,18
Utah,Rain,3
Massachusetts,Rain,9
Minnesota,Rain,6
Nebraska,Rain,5
New Hampshire,Rain,1
Michigan,Snow,23
New York,Snow,6
Montana,Snow,2
Pennsylvania,Snow,8
Indiana,Snow,3
New Mexico,Snow,4
Kansas,Snow,1
North Dakota,Snow,1
South Dakota,Snow,1
Maryland,Snow,1
Nevada,Snow,1
Minnesota,"Fog, Smog

2025-01-20 13:04:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:04:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:04:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:04:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 13:04:58 - snowflake.connector.connection - INFO - closed
2025-01-20 13:04:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:04:58 - root - INFO - SQL:
-- 11. Get distinct years in "year_of_crash" to confirm data is from 2016.
SELECT DISTINCT "year_of_crash"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
LIMIT 1000
Results:
year_of_crash
2016

2025-01-20 13:04:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:04:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:04:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:05:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 13:05:00 - snowflake.connector.connection - INFO - closed
2025-01-20 13:05:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:05:00 - root - INFO - SQL:
-- 12. Sample date information to understand "day_of_week" values.
SELECT "day_of_week", "day_of_crash", "month_of_crash", "year_of_crash"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
LIMIT 1000
Results:
Too long, hard cut:
day_of_week,day_of_crash,month_of_crash,year_of_crash
7,21,5,2016
7,16,1,2016
6,16,12,2016
6,22,1,2016
7,17,12,2016
6,22,1,2016
7,3,12,2016
4,6,7,2016
6,16,12,2016
7,17,12,2016
1,3,4,2016
7,23,4,2016
6,22,4,2016
5,18,2,2016
7,2,1,2016
1,13,11,2016
7,19,3,2016
2,8,2,2016
3,6,12,2016
6,16,12,2016
1,31,7,2016
2,27,6,2016
2,22,8,2016
4,3,8,2016
2,16,5,2016
1,16,10,2016
4,14,9,2016
1,14,2,2016
1,14,2,2016
6,15,1,2016
7,2,4,2016
1,3,4,2016
2,9,5,2016
7,3,9,2016
4,10,8,2016
5,15,12,2016
3,12,1,2016
2,5,12,2016
5,21,1,2016
3,29,11,2016
3,29,3,2016
7,17,9,2016
7,4,6,2016
1,26,6,2016
7,9,4,2016
6,4,3,2016
4,16,11,2016
6,18,11,2016
1,1,5,2016
3,28,6,2016
7,12,3,2016
3,12,4,2016
2,7,3,2016
6,16,12,2016
3,26,1,2016
6,16,12,2016
1,14,2,2016
1,14,2,2016
2,15,2,2016
2,4,7,2016
6,28,10,2016
6,15,4,2016
4,6,4,2016
4,25,5,2016
6,16,12,2016
1,17,1,2016
6,8,1,2016
5,11,2,2016
7,23,1,2016
2,3,10,2016
2,1,8,2016
3,1,3,2016
7,24,9,2016
2,4,1,2016
7,21,5,2016
3,23,8,2016
3,26,1,2016
7,2,4,2016
7,6,2,2016
3,22,11,2016
3,2,8,2016
5,25,2,2016
5,25,8,2016
4,2,3,2016
3,24,5,2016
7,17,12,2016
7,17,12,2016
1,1,5,2016
6,19,2,2016
5,28,7,2016
7,17,12,2016
5,15,12,2016
5,11,8,2016
6,15,7,2016
1,14,8,2016
4,16,3,2016
6,12,2,2016
7,19,11,2016
5,31,3,2016
6,15,4,2016
6,2,9,2016
3,2,8,2016
7,20,2,2016
6,16,12,2016
7,13,2,2016
3,21,6,2016
2,29,2,2016
1,26,6,2016
4,13,1,2016
1,27,3,2016
7,17,12,2016
5,1,12,2016
5,21,7,2016
5,2,6,2016
7,15,10,2016
1,10,1,2016
6,4,11,2016
6,16,12,2016
6,8,1,2016
7,17,12,2016
7,19,3,2016
2,18,4,2016
1,18,12,2016
4,7,12,2016
1,4,9,2016
1,27,11,2016
3,4,10,2016
7,19,11,2016
3,6,9,2016
4,17,8,2016
1,31,7,2016
2,6,6,2016
6,19,2,2016
7,10,12,2016
2,15,8,2016
4,15,6,2016
4,10,2,2016
4,20,1,2016
6,8,1,2016
1,10,4,2016
5,29,12,2016
5,21,1,2016
7,2,4,2016
3,13,12,2016
2,8,2,2016
6,1,1,2016
6,16,9,2016
2,14,3,2016
4,6,1,2016
3,12,1,2016
4,10,2,2016
7,2,1,2016
1,7,2,2016
2,15,2,2016
7,10,12,2016
2,15,2,2016
5,24,3,2016
6,16,12,2016
5,18,2,2016
7,17,12,2016
1,3,1,2016
6,22,4,2016
6,22,1,2016
6,4,3,2016
3,18,10,2016
3,19,1,2016
5,17,11,2016
5,15,12,2016
2,15,2,2016
5,17,11,2016
5,8,12,2016
1,14,2,2016
6,22,1,2016
7,5,11,2016
6,29,4,2016
7,7,5,2016
1,4,9,2016
3,19,1,2016
4,27,1,2016
2,11,1,2016
1,7,2,2016
3,16,2,2016
3,16,2,2016
6,16,12,2016
7,17,12,2016
4,24,2,2016
6,16,12,2016
7,17,12,2016
4,6,4,2016
3,12,1,2016
4,30,3,2016
7,17,12,2016
5,28,4,2016
2,1,8,2016
4,15,6,2016
3,2,2,2016
2,4,4,2016
3,4,10,2016
1,11,12,2016
5,13,10,2016
3,3,5,2016
4,7,12,2016
2,23,5,2016
6,11,11,2016
7,7,5,2016
2,15,8,2016
7,7,5,2016
6,23,12,2016
7,29,10,2016
2,6,6,2016
1,28,8,2016
2,29,8,2016
7,17,12,2016
6,12,2,2016
5,4,8,2016
7,9,4,2016
6,7,10,2016
7,6,2,2016
3,22,11,2016
1,3,4,2016
5,28,1,2016
6,30,9,2016
6,11,3,2016
5,24,3,2016
2,26,12,2016
7,19,11,2016
5,14,4,2016
5,29,12,2016
6,12,8,2016
7,12,11,2016
7,19,3,2016
7,23,7,2016
5,10,11,2016
7,2,7,2016
1,12,6,2016
5,7,1,2016
4,3,2,2016
6,25,3,2016
7,23,1,2016
2,4,1,2016
7,19,11,2016
1,28,2,2016
2,21,11,2016
7,17,12,2016
2,7,3,2016
3,19,7,2016
7,30,1,2016
2,28,11,2016
5,20,10,2016
1,15,5,2016
5,7,7,2016
7,24,12,2016
6,1,1,2016
7,17,12,2016
1,13,3,2016
5,23,6,2016
6,11,3,2016
1,10,7,2016
3,27,9,2016
1,4,9,2016
3,8,11,2016
2,30,5,2016
4,3,2,2016
1,17,1,2016
1,2,10,2016
2,14,11,2016
4,20,1,2016
6,15,4,2016
2,17,10,2016
2,14,3,2016
3,9,2,2016
6,25,3,2016
6,8,1,2016
2,7,3,2016
6,22,4,2016
3,3,5,2016
7,3,9,2016
4,17,2,2016
3,9,8,2016
4,27,4,2016
4,10,2,2016
2,21,11,2016
3,2,8,2016
7,24,12,2016
4,27,7,2016
3,16,8,2016
4,10,2,2016
6,1,7,2016
7,14,5,2016
4,3,2,2016
5,26,5,2016
7,10,12,2016
3,19,1,2016
4,2,3,2016
5,11,8,2016
1,18,9,2016
1,18,9,2016
2,8,2,2016
6,8,1,2016
7,21,5,2016
3,22,3,2016
6,20,5,2016
1,3,7,2016
7,26,11,2016
7,9,7,2016
4,9,3,2016
6,19,2,2016
6,4,3,2016
5,27,10,2016
7,5,3,2016
6,26,8,2016
3,12,1,2016
2,15,2,2016
6,1,4,2016
2,15,2,2016
7,18,6,2016
6,22,1,2016
4,4,5,2016
1,10,4,2016
5,24,3,2016
4,16,3,2016
7,9,4,2016
6,10,6,2016
7,25,6,2016
1,10,7,2016
1,17,7,2016
6,22,4,2016
5,15,9,2016
5,12,5,2016
1,15,5,2016
3,26,7,2016
7,17,12,2016
7,3,9,2016
6,1,4,2016
4,19,10,2016
7,8,10,2016
1,29,5,2016
2,15,2,2016
2,15,2,2016
7,10,9,2016
2,6,6,2016
6,12,2,2016
2,28,3,2016
3,11,10,2016
1,20,11,2016
7,9,1,2016
5,11,8,2016
1,18,12,2016
1,21,2,2016
7,16,1,2016
3,27,12,2016
6,27,5,2016
7,28,5,2016
1,17,4,2016
5,17,11,2016
5,17,3,2016
1,26,6,2016
2,26,9,2016
1,11,9,2016
3,29,11,2016
5,15,12,2016
7,15,10,2016
5,6,10,2016
1,2,10,2016
5,1,12,2016
5,17,3,2016
6,10,6,2016
4,17,2,2016
7,28,5,2016
2,5,12,2016
3,29,3,2016
2,12,9,2016
4,30,3,2016
7,2,4,2016
7,25,6,2016
6,6,5,2016
1,20,11,2016
1,12,6,2016
6,9,9,2016
7,10,12,2016
2,4,4,2016
3,18,10,2016
3,10,5,2016
2,11,1,2016
2,22,8,2016
1,7,8,2016
3,22,11,2016
3,31,5,2016
7,20,2,2016
7,29,10,2016
1,14,8,2016
1,21,8,2016
1,21,8,2016
6,8,7,2016
7,26,3,2016
5,14,7,2016
2,4,7,2016
3,4,10,2016
7,26,11,2016
6,25,11,2016
3,6,9,2016
3,26,7,2016
5,24,3,2016
5,26,5,2016
5,1,9,2016
5,7,7,2016
1,23,10,2016
7,9,1,2016
6,30,9,2016
6,19,2,2016
1,7,8,2016
3,17,5,2016
1,3,1,2016
2,25

2025-01-20 13:05:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:05:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:05:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:05:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 13:05:01 - snowflake.connector.connection - INFO - closed
2025-01-20 13:05:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:05:02 - root - INFO - SQL:
-- 13. Mapping between "atmospheric_conditions_1" and "atmospheric_conditions_1_name".
SELECT "atmospheric_conditions_1", "atmospheric_conditions_1_name"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
LIMIT 1000
Results:
Too long, hard cut:
atmospheric_conditions_1,atmospheric_conditions_1_name
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
6,Severe Crosswinds
6,Severe Crosswinds
6,Severe Crosswinds
6,Severe Crosswinds
6,Severe Crosswinds
6,Severe Crosswinds
6,Severe Crosswinds
6,Severe Crosswinds
8,Other
8,Other
8,Other
7,"Blowing Sand, Soil, Dirt"
11,Blowing Snow
12,Freezing Rain or Drizzle
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
6,Severe Crosswinds
6,Severe Crosswinds
6,Severe Crosswinds
6,Severe Crosswinds
7,"Blowing Sand, Soil, Dirt"
8,Other
8,Other
8,Other
12,Freezing Rain or Drizzle
12,Freezing Rain or Drizzle
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
6,Severe Crosswinds
6,Severe Crosswinds
6,Severe Crosswinds
6,Severe Crosswinds
6,Severe Crosswinds
8,Other
8,Other
8,Other
8,Other
11,Blowing Snow
12,Freezing Rain or Drizzle
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
6,Severe Crosswinds
99,Unknown
3,"Sleet, Hail"
3,"Sleet, Hail"
6,Severe Crosswinds
8,Other
8,Other
12,Freezing Rain or Drizzle
12,Freezing Rain or Drizzle
99,Unknown
99,Unknown
99,Unknown
6,Severe Crosswinds
8,Other
3,"Sleet, Hail"
3,"Sleet, Hail"
6,Severe Crosswinds
6,Severe Crosswinds
7,"Blowing Sand, Soil, Dirt"
8,Other
12,Freezing Rain or Drizzle
99,Unknown
99,Unknown
99,Unknown
99,Unknown
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
99,Unknown
8,Other
99,Unknown
99,Unknown
12,Freezing Rain or Drizzle
99,Unknown
3,"Sleet, Hail"
8,Other
12,Freezing Rain or Drizzle
99,Unknown
99,Unknown
3,"Sleet, Hail"
12,Freezing Rain or Drizzle
99,Unknown
99,Unknown
99,Unknown
3,"Sleet, Hail"
8,Other
99,Unknown
8,Other
7,"Blowing Sand, Soil, Dirt"
6,Severe Crosswinds
7,"Blowing Sand, Soil, Dirt"
7,"Blowing Sand, Soil, Dirt"
7,"Blowing Sand, Soil, Dirt"
8,Other
3,"Sleet, Hail"
3,"Sleet, Hail"
6,Severe Crosswinds
6,Severe Crosswinds
8,Other
6,Severe Crosswinds
7,"Blowing Sand, Soil, Dirt"
7,"Blowing Sand, Soil, Dirt"
99,Unknown
99,Unknown
3,"Sleet, Hail"
3,"Sleet, Hail"
7,"Blowing Sand, Soil, Dirt"
11,Blowing Snow
7,"Blowing Sand, Soil, Dirt"
11,Blowing Snow
3,"Sleet, Hail"
7,"Blowing Sand, Soil, Dirt"
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
11,Blowing Snow
3,"Sleet, Hail"
3,"Sleet, Hail"
6,Severe Crosswinds
11,Blowing Snow
11,Blowing Snow
99,Unknown
12,Freezing Rain or Drizzle
6,Severe Crosswinds
12,Freezing Rain or Drizzle
3,"Sleet, Hail"
99,Unknown
3,"Sleet, Hail"
11,Blowing Snow
8,Other
8,Other
8,Other
3,"Sleet, Hail"
6,Severe Crosswinds
6,Severe Crosswinds
8,Other
3,"Sleet, Hail"
6,Severe Crosswinds
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
8,Other
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
6,Severe Crosswinds
6,Severe Crosswinds
6,Severe Crosswinds
7,"Blowing Sand, Soil, Dirt"
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
12,Freezing Rain or Drizzle
8,Other
99,Unknown
99,Unknown
99,Unknown
99,Unknown
3,"Sleet, Hail"
99,Unknown
11,Blowing Snow
99,Unknown
7,"Blowing Sand, Soil, Dirt"
3,"Sleet, Hail"
7,"Blowing Sand, Soil, Dirt"
6,Severe Crosswinds
6,Severe Crosswinds
8,Other
8,Other
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
3,"Sleet, Hail"
3,"Sleet, Hail"
11,Blowing Snow
99,Unknown
3,"Sleet, Hail"
99,Unknown
3,"Sleet, Hail"
3,"Sleet, Hail"
6,Severe Crosswinds
8,Other
99,Unknown
99,Unknown
99,Unknown
99,Unknown
7,"Blowing Sand, Soil, Dirt"
8,Other
8,Other
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
3,"Sleet, Hail"
7,"Blowing Sand, Soil, Dirt"
7,"Blowing Sand, Soil, Dirt"
8,Other
8,Other
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
6,Severe Crosswinds
3,"Sleet, Hail"
8,Other
99,Unknown
99,Unknown
8,Other
8,Other
99,Unknown
8,Other
8,Other
8,Other
8,Other
8,Other
12,Freezing Rain or Drizzle
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
8,Other
99,Unknown
7,"Blowing Sand, Soil, Dirt"
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
8,Other
12,Freezing Rain or Drizzle
3,"Sleet, Hail"
99,Unknown
7,"Blowing Sand, Soil, Dirt"
3,"Sleet, Hail"
6,Severe Crosswinds
99,Unknown
8,Other
8,Other
99,Unknown
3,"Sleet, Hail"
3,"Sleet, Hail"
6,Severe Crosswinds
6,Severe Crosswinds
8,Other
99,Unknown
99,Unknown
6,Severe Crosswinds
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
12,Freezing Rain or Drizzle
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
3,"Sleet, H

2025-01-20 13:05:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:05:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:05:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:05:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 13
2025-01-20 13:05:03 - snowflake.connector.connection - INFO - closed
2025-01-20 13:05:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:05:03 - root - INFO - SQL:
-- 14. Count of weekend accidents by weather condition.
SELECT "atmospheric_conditions_1_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7)
GROUP BY "atmospheric_conditions_1_name"
LIMIT 1000
Results:
atmospheric_conditions_1_name,num_accidents
"Sleet, Hail",23
Severe Crosswinds,15
Other,13
Unknown,56
Blowing Snow,4
Freezing Rain or Drizzle,6
"Blowing Sand, Soil, Dirt",4
Clear,8411
Rain,672
Snow,109
Not Reported,489
"Fog, Smog, Smoke",102
Cloudy,1608

2025-01-20 13:05:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:05:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:05:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:05:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 46
2025-01-20 13:05:05 - snowflake.connector.connection - INFO - closed
2025-01-20 13:05:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:05:05 - root - INFO - SQL:
-- 15. Count of weekend accidents per "state_name" with 'Rain' weather.
SELECT "state_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7) AND "atmospheric_conditions_1_name" = 'Rain'
GROUP BY "state_name"
LIMIT 1000
Results:
state_name,num_accidents
Alabama,26
Arizona,6
Arkansas,11
Florida,49
Illinois,17
Mississippi,12
North Carolina,33
South Carolina,18
Texas,68
Washington,24
Kansas,5
California,55
Louisiana,14
Maryland,10
Ohio,19
Virginia,18
Alaska,5
Delaware,2
Michigan,21
Nevada,2
Montana,3
Missouri,8
New Hampshire,1
New Mexico,3
Massachusetts,9
Tennessee,29
Minnesota,6
Connecticut,2
Hawaii,5
Indiana,20
Kentucky,27
New York,23
West Virginia,9
Georgia,25
Pennsylvania,19
Oklahoma,12
Idaho,2
Utah,3
Iowa,4
Maine,4
New Jersey,14
Oregon,16
Wyoming,2
Wisconsin,4
Nebraska,5
Colorado,2

2025-01-20 13:05:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:05:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:05:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:05:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 50
2025-01-20 13:05:06 - snowflake.connector.connection - INFO - closed
2025-01-20 13:05:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:05:07 - root - INFO - SQL:
-- 16. Count of weekend accidents per "state_name" with 'Clear' weather.
SELECT "state_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7) AND "atmospheric_conditions_1_name" = 'Clear'
GROUP BY "state_name"
LIMIT 1000
Results:
state_name,num_accidents
Indiana,170
North Carolina,328
North Dakota,31
Ohio,219
South Carolina,285
California,979
Louisiana,199
Arizona,226
Arkansas,116
Florida,799
Idaho,42
Illinois,326
Iowa,79
Kentucky,161
Maryland,127
Michigan,210
Oklahoma,131
Delaware,30
District of Columbia,7
Kansas,33
Missouri,218
Montana,38
New Hampshire,23
New Mexico,96
South Dakota,32
Tennessee,275
Minnesota,74
Nevada,81
Vermont,11
Hawaii,34
Massachusetts,81
Alabama,251
Colorado,16
Connecticut,80
Georgia,360
New York,196
Oregon,76
Pennsylvania,282
Texas,895
Rhode Island,8
Utah,52
Wyoming,23
Maine,36
New Jersey,158
Washington,113
Mississippi,170
Alaska,11
Nebraska,52
Wisconsin,121
West Virginia,50

2025-01-20 13:05:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:05:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:05:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:05:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 200
2025-01-20 13:05:08 - snowflake.connector.connection - INFO - closed
2025-01-20 13:05:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:05:09 - root - INFO - SQL:
-- 17. Weekend accidents with weather conditions other than 'Rain' or 'Clear'.
SELECT "state_name", "atmospheric_conditions_1_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7) AND "atmospheric_conditions_1_name" NOT IN ('Rain', 'Clear')
GROUP BY "state_name", "atmospheric_conditions_1_name"
LIMIT 1000
Results:
state_name,atmospheric_conditions_1_name,num_accidents
Idaho,"Sleet, Hail",1
Maryland,"Sleet, Hail",2
Ohio,"Sleet, Hail",1
California,Severe Crosswinds,2
Kansas,Severe Crosswinds,4
New Mexico,Severe Crosswinds,1
Missouri,Other,2
New Mexico,Other,2
Arkansas,Unknown,2
Tennessee,"Sleet, Hail",6
North Carolina,Severe Crosswinds,2
Missouri,Unknown,2
Montana,Unknown,2
Oklahoma,Unknown,2
South Carolina,Blowing Snow,1
Iowa,Unknown,2
Virginia,"Sleet, Hail",1
Illinois,"Sleet, Hail",1
North Carolina,Freezing Rain or Drizzle,3
Tennessee,Unknown,6
Arkansas,Other,1
Texas,"Sleet, Hail",1
West Virginia,"Sleet, Hail",1
Arkansas,Severe Crosswinds,1
Kentucky,Severe Crosswinds,1
Indiana,"Sleet, Hail",1
Ohio,Unknown,1
Wisconsin,Severe Crosswinds,1
Kansas,Unknown,2
North Carolina,Other,1
Pennsylvania,Freezing Rain or Drizzle,1
West Virginia,Snow,1
New Mexico,Snow,4
Iowa,Snow,4
Missouri,"Fog, Smog, Smoke",5
New York,Cloudy,74
Arkansas,Cloudy,17
Georgia,Unknown,4
Washington,Unknown,3
California,Unknown,1
South Dakota,Blowing Snow,1
Minnesota,Blowing Snow,1
New York,"Sleet, Hail",1
Arizona,Unknown,5
Florida,Other,2
Colorado,Snow,1
Wisconsin,Snow,7
Alaska,Snow,2
Idaho,Snow,2
Oregon,"Fog, Smog, Smoke",4
Pennsylvania,"Fog, Smog, Smoke",6
North Carolina,"Fog, Smog, Smoke",1
Connecticut,"Fog, Smog, Smoke",1
California,Cloudy,164
West Virginia,Cloudy,7
Delaware,Cloudy,6
Kansas,Cloudy,1
Oklahoma,Not Reported,2
Montana,Cloudy,20
Oklahoma,Cloudy,58
Maine,Other,1
Indiana,Severe Crosswinds,1
Wisconsin,Unknown,5
Illinois,Unknown,3
Pennsylvania,"Sleet, Hail",2
Iowa,"Blowing Sand, Soil, Dirt",3
Kentucky,"Blowing Sand, Soil, Dirt",1
New Jersey,Freezing Rain or Drizzle,1
Hawaii,Unknown,1
Minnesota,Unknown,1
Connecticut,Other,1
North Dakota,Unknown,1
North Carolina,"Sleet, Hail",1
Minnesota,Snow,1
Indiana,"Fog, Smog, Smoke",4
California,"Fog, Smog, Smoke",7
New York,"Fog, Smog, Smoke",2
Georgia,Cloudy,77
South Dakota,Cloudy,1
South Carolina,Not Reported,3
Utah,Severe Crosswinds,1
Indiana,Freezing Rain or Drizzle,1
Pennsylvania,Other,2
Maryland,Other,1
Massachusetts,Unknown,1
District of Columbia,Unknown,1
Michigan,"Sleet, Hail",1
Michigan,Unknown,4
Michigan,Snow,23
New York,Snow,6
Utah,Snow,4
Missouri,Snow,2
Ohio,Snow,8
Illinois,Snow,8
New Hampshire,Snow,1
Oklahoma,Snow,1
Maine,Snow,1
Florida,"Fog, Smog, Smoke",8
Virginia,"Fog, Smog, Smoke",5
Kentucky,"Fog, Smog, Smoke",2
Louisiana,"Fog, Smog, Smoke",3
Massachusetts,"Fog, Smog, Smoke",2
Texas,"Fog, Smog, Smoke",10
New Mexico,"Fog, Smog, Smoke",1
Kansas,"Fog, Smog, Smoke",3
North Dakota,"Fog, Smog, Smoke",1
Ohio,Cloudy,98
Florida,Cloudy,143
Mississippi,Cloudy,29
Nebraska,Cloudy,11
Vermont,Cloudy,5
Massachusetts,Cloudy,21
Kansas,Not Reported,69
Massachusetts,Not Reported,1
Pennsylvania,Not Reported,9
Arizona,"Sleet, Hail",1
Montana,Snow,2
Pennsylvania,Snow,8
Washington,Snow,2
California,Snow,1
North Dakota,Snow,1
Nevada,Snow,1
Wisconsin,"Fog, Smog, Smoke",2
Iowa,"Fog, Smog, Smoke",2
Vermont,"Fog, Smog, Smoke",1
Michigan,"Fog, Smog, Smoke",3
Kentucky,Cloudy,42
Maine,Cloudy,6
Alabama,Cloudy,49
Alaska,Cloudy,5
Washington,Cloudy,26
New Mexico,Cloudy,2
Colorado,Not Reported,148
New Mexico,Not Reported,2
New Jersey,Not Reported,2
Washington,Not Reported,2
Maryland,Cloudy,14
Rhode Island,Cloudy,1
Oregon,Snow,2
South Dakota,Snow,1
New Jersey,Snow,1
Massachusetts,Snow,1
Idaho,Cloudy,14
Oregon,"Sleet, Hail",1
Utah,Unknown,2
Connecticut,Blowing Snow,1
Texas,Severe Crosswinds,1
Wyoming,Snow,4
Virginia,Snow,3
Kansas,Snow,1
Kentucky,Snow,1
Minnesota,"Fog, Smog, Smoke",2
Arkansas,"Fog, Smog, Smoke",3
Illinois,"Fog, Smog, Smoke",7
South Carolina,"Fog, Smog, Smoke",1
Mississippi,"Fog, Smog, Smoke",2
Nebraska,"Fog, Smog, Smoke",1
Maryland,"Fog, Smog, Smoke",2
Indiana,Cloudy,44
Arizona,Cloudy,22
Michigan,Cloudy,59
Missouri,Cloudy,50
Texas,Cloudy,224
Tennessee,Cloudy,25
Iowa,Cloudy,21
North Dakota,Cloudy,5
Connecticut,Cloudy,5
Oregon,Not Reported,4
Florida,Not Reported,1
Louisiana,Unknown,1
Kansas,"Sleet, Hail",1
Alabama,Unknown,1
Indiana,Snow,3
Maryland,Snow,1
Alabama,"Fog, Smog, Smoke",2
New Hampshire,"Fog, Smog, Smoke",1
Arizona,"Fog, Smog, Smoke",1
New Jersey,"Fog, Smog, Smoke",6
Rhode Island,"Fog, Smog, Smoke",1
New Hampshire,Cloudy,8
Utah,Cloudy,16
Wisconsin,Cloudy,52
South Carolina,Cloudy,17
Nevada,Cloudy,14
Hawaii,Cloudy,4
New Jersey,Cloudy,5
Colorado,Cloudy,1
Virginia,Not Reported,222
Arizona,Not Reported,12
Ohio,Not Reported,1
Maryland,Not Reported,8
Georgia,Not Reported,1
New York,Not Reported,1
Illinois,Cloudy,6
California,Not Reported,1
Texas,Unknown,3
Minnesota,Cloudy,24
North Carolina,Cloudy,56
Louisiana,Cloudy,27
Oregon,Cloudy,32

2025-01-20 13:05:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:05:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:05:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:05:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 51
2025-01-20 13:05:10 - snowflake.connector.connection - INFO - closed
2025-01-20 13:05:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:05:11 - root - INFO - SQL:
-- 18. Total weekend accidents per "state_name" regardless of weather.
SELECT "state_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7)
GROUP BY "state_name"
LIMIT 1000
Results:
state_name,num_accidents
Idaho,61
Maryland,165
Ohio,347
California,1210
Kansas,119
Maine,48
Missouri,287
Arkansas,151
Georgia,467
North Carolina,425
Montana,65
Oklahoma,206
Washington,170
Wisconsin,192
South Carolina,325
Iowa,115
Virginia,249
South Dakota,35
Arizona,273
North Dakota,39
District of Columbia,8
Michigan,321
Delaware,38
New Mexico,111
Tennessee,341
Illinois,368
Minnesota,109
New Hampshire,34
Vermont,17
Hawaii,44
Nevada,98
Massachusetts,116
Indiana,244
Texas,1202
West Virginia,68
Pennsylvania,329
Kentucky,235
New York,303
Florida,1002
Rhode Island,10
Utah,78
Connecticut,90
Wyoming,29
Louisiana,244
New Jersey,187
Oregon,135
Alabama,329
Mississippi,213
Alaska,23
Colorado,168
Nebraska,69

2025-01-20 13:05:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:05:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:05:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:05:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 89
2025-01-20 13:05:12 - snowflake.connector.connection - INFO - closed
2025-01-20 13:05:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:05:12 - root - INFO - SQL:
-- 19. Count of accidents per "day_of_week" and weather condition.
SELECT "day_of_week", "atmospheric_conditions_1_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
GROUP BY "day_of_week", "atmospheric_conditions_1_name"
LIMIT 1000
Results:
day_of_week,atmospheric_conditions_1_name,num_accidents
7,"Sleet, Hail",14
6,"Sleet, Hail",13
4,Severe Crosswinds,9
6,Severe Crosswinds,9
1,Severe Crosswinds,7
5,Severe Crosswinds,4
7,Other,10
1,Other,3
2,"Blowing Sand, Soil, Dirt",6
3,Blowing Snow,1
6,Freezing Rain or Drizzle,2
1,Unknown,25
2,Unknown,21
4,"Sleet, Hail",8
1,"Sleet, Hail",9
2,Severe Crosswinds,3
5,Other,7
2,Other,4
5,Freezing Rain or Drizzle,4
3,Freezing Rain or Drizzle,3
7,Unknown,31
6,Unknown,19
7,Freezing Rain or Drizzle,4
3,"Blowing Sand, Soil, Dirt",5
4,Blowing Snow,1
1,Blowing Snow,2
3,Severe Crosswinds,2
6,"Blowing Sand, Soil, Dirt",2
4,"Blowing Sand, Soil, Dirt",2
1,Freezing Rain or Drizzle,2
4,Freezing Rain or Drizzle,1
7,"Blowing Sand, Soil, Dirt",4
5,Blowing Snow,2
5,"Blowing Sand, Soil, Dirt",1
6,Rain,340
7,Rain,362
1,Rain,310
3,Snow,38
5,Snow,52
7,"Fog, Smog, Smoke",58
4,"Fog, Smog, Smoke",40
3,"Fog, Smog, Smoke",55
1,"Fog, Smog, Smoke",44
2,Cloudy,709
5,Cloudy,735
4,Cloudy,663
5,Not Reported,218
4,Not Reported,205
3,Unknown,21
2,"Sleet, Hail",11
6,Other,15
7,Blowing Snow,2
5,Unknown,17
4,Other,4
7,Severe Crosswinds,8
4,Unknown,12
3,Other,5
3,"Sleet, Hail",5
2,Freezing Rain or Drizzle,1
5,"Sleet, Hail",5
6,Blowing Snow,2
1,Clear,3910
7,Clear,4501
3,Clear,3008
6,Clear,3806
5,Clear,3318
4,Clear,3195
5,Rain,313
3,Rain,240
4,Rain,259
2,Snow,36
6,Snow,53
4,Snow,40
6,"Fog, Smog, Smoke",58
2,"Fog, Smog, Smoke",44
6,Cloudy,823
5,"Fog, Smog, Smoke",30
6,Not Reported,255
1,Not Reported,227
3,Not Reported,186
2,Clear,3218
2,Rain,283
1,Snow,48
7,Snow,61
7,Cloudy,842
1,Cloudy,766
3,Cloudy,588
2,Not Reported,201
7,Not Reported,262

2025-01-20 13:05:12 - root - INFO - itercount: 0
2025-01-20 13:05:12 - root - INFO - Database Name: NHTSA_TRAFFIC_FATALITIES
Schema Name: NHTSA_TRAFFIC_FATALITIES
DDL describes table information.
,0
table_name,ACCIDENT_2016
description,
DDL,"create or replace TABLE ACCIDENT_2016 (
	""state_number"" NUMBER(38,0),
	""state_name"" VARCHAR(16777216),
	""consecutive_number"" NUMBER(38,0),
	""number_of_vehicle_forms_submitted_all"" NUMBER(38,0),
	""number_of_motor_vehicles_in_transport_mvit"" NUMBER(38,0),
	""number_of_parked_working_vehicles"" NUMBER(38,0),
	""number_of_forms_submitted_for_persons_not_in_motor_vehicles"" NUMBER(38,0),
	""number_of_persons_not_in_motor_vehicles_in_transport_mvit"" NUMBER(38,0),
	""number_of_persons_in_motor_vehicles_in_transport_mvit"" NUMBER(38,0),
	""number_of_forms_submitted_for_persons_in_motor_vehicles"" NUMBER(38,0),
	""county"" NUMBER(38,0),
	""city"" NUMBER(38,0),
	""day_of_crash"" NUMBER(38,0),
	""month_of_crash"" NUMBER(38,0),
	""year_of_crash"" NUMBER(38,0),
	""day_of_week"" NUMBER(38,0),
	""hour_of_crash"" NUMBER(38,0),
	""minute_of_crash"" NUMBER(38,0),
	""national_highway_system"" NUMBER(38,0),
	""land_use"" NUMBER(38,0),
	""land_use_name"" VARCHAR(16777216),
	""functional_system"" NUMBER(38,0),
	""functional_system_name"" VARCHAR(16777216),
	""ownership"" NUMBER(38,0),
	""ownership_name"" VARCHAR(16777216),
	""route_signing"" NUMBER(38,0),
	""route_signing_name"" VARCHAR(16777216),
	""trafficway_identifier"" VARCHAR(16777216),
	""trafficway_identifier_2"" VARCHAR(16777216),
	""milepoint"" NUMBER(38,0),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""special_jurisdiction"" NUMBER(38,0),
	""special_jurisdiction_name"" VARCHAR(16777216),
	""first_harmful_event"" NUMBER(38,0),
	""first_harmful_event_name"" VARCHAR(16777216),
	""manner_of_collision"" NUMBER(38,0),
	""manner_of_collision_name"" VARCHAR(16777216),
	""relation_to_junction_within_interchange_area"" VARCHAR(16777216),
	""relation_to_junction_specific_location"" NUMBER(38,0),
	""relation_to_junction_specific_location_name"" VARCHAR(16777216),
	""type_of_intersection"" VARCHAR(16777216),
	""work_zone"" VARCHAR(16777216),
	""relation_to_trafficway"" NUMBER(38,0),
	""relation_to_trafficway_name"" VARCHAR(16777216),
	""light_condition"" NUMBER(38,0),
	""light_condition_name"" VARCHAR(16777216),
	""atmospheric_conditions_1"" NUMBER(38,0),
	""atmospheric_conditions_1_name"" VARCHAR(16777216),
	""atmospheric_conditions_2"" NUMBER(38,0),
	""atmospheric_conditions_2_name"" VARCHAR(16777216),
	""atmospheric_conditions"" NUMBER(38,0),
	""atmospheric_conditions_name"" VARCHAR(16777216),
	""school_bus_related"" VARCHAR(16777216),
	""rail_grade_crossing_identifier"" VARCHAR(16777216),
	""hour_of_notification"" NUMBER(38,0),
	""minute_of_notification"" NUMBER(38,0),
	""hour_of_arrival_at_scene"" NUMBER(38,0),
	""minute_of_arrival_at_scene"" NUMBER(38,0),
	""hour_of_ems_arrival_at_hospital"" NUMBER(38,0),
	""minute_of_ems_arrival_at_hospital"" NUMBER(38,0),
	""related_factors_crash_level_1"" NUMBER(38,0),
	""related_factors_crash_level_1_name"" VARCHAR(16777216),
	""related_factors_crash_level_2"" NUMBER(38,0),
	""related_factors_crash_level_2_name"" VARCHAR(16777216),
	""related_factors_crash_level_3"" NUMBER(38,0),
	""related_factors_crash_level_3_name"" VARCHAR(16777216),
	""number_of_fatalities"" NUMBER(38,0),
	""number_of_drunk_drivers"" NUMBER(38,0),
	""timestamp_of_crash"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['ACCIDENT_2016', 'ACCIDENT_2020', 'ACCIDENT_2015', 'ACCIDENT_2018', 'ACCIDENT_2019', 'ACCIDENT_2017']
,1
table_name,CEVENT_2020
description,
DDL,"create or replace TABLE CEVENT_2020 (
	""state_number"" NUMBER(38,0),
	""state_name"" VARCHAR(16777216),
	""consecutive_number"" NUMBER(38,0),
	""event_number"" NUMBER(38,0),
	""vehicle_number_this_vehicle"" NUMBER(38,0),
	""area_of_impact_this_vehicle"" NUMBER(38,0),
	""area_of_impact_this_vehicle_name"" VARCHAR(16777216),
	""sequence_of_events"" NUMBER(38,0),
	""sequence_of_events_name"" VARCHAR(16777216),
	""vehicle_number_other_vehicle"" NUMBER(38,0),
	""vehicle_number_other_vehicle_name"" VARCHAR(16777216),
	""area_of_impact_other_vehicle"" VARCHAR(16777216),
	""area_of_impact_other_vehicle_name"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['CEVENT_2020', 'CEVENT_2015', 'CEVENT_2017', 'CEVENT_2016', 'CEVENT_2018', 'CEVENT_2019']
,2
table_name,DISTRACT_2015
description,
DDL,"create or replace TABLE DISTRACT_2015 (
	""state_number"" NUMBER(38,0),
	""consecutive_number"" NUMBER(38,0),
	""vehicle_number"" NUMBER(38,0),
	""driver_distracted_by"" NUMBER(38,0),
	""driver_distracted_by_name"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['DISTRACT_2015', 'DISTRACT_2016', 'DISTRACT_2017', 'DISTRACT_2018', 'DISTRACT_2019', 'DISTRACT_2020']
,3
table_name,DRIMPAIR_2020
description,
DDL,"create or replace TABLE DRIMPAIR_2020 (
	""state_number"" NUMBER(38,0),
	""state_name"" VARCHAR(16777216),
	""consecutive_number"" NUMBER(38,0),
	""vehicle_number"" NUMBER(38,0),
	""condition_impairment_at_time_of_crash_driver"" NUMBER(38,0),
	""condition_impairment_at_time_of_crash_driver_name"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['DRIMPAIR_2020', 'DRIMPAIR_2017', 'DRIMPAIR_2019', 'DRIMPAIR_2016', 'DRIMPAIR_2015', 'DRIMPAIR_2018']
,4
table_name,NMPRIOR_2019
description,
DDL,"create or replace TABLE NMPRIOR_2019 (
	""state_number"" NUMBER(38,0),
	""state_name"" VARCHAR(16777216),
	""consecutive_number"" NUMBER(38,0),
	""vehicle_number"" NUMBER(38,0),
	""person_number"" NUMBER(38,0),
	""non_motorist_action_circumstances"" NUMBER(38,0),
	""non_motorist_action_circumstances_name"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['NMPRIOR_2019', 'NMPRIOR_2017', 'NMPRIOR_2016', 'NMPRIOR_2020', 'NMPRIOR_2015', 'NMPRIOR_2018']
,5
table_name,PARKWORK_2018
description,
DDL,"create or replace TABLE PARKWORK_2018 (
	""state_number"" NUMBER(38,0),
	""state_name"" VARCHAR(16777216),
	""consecutive_number"" NUMBER(38,0),
	""vehicle_number"" NUMBER(38,0),
	""number_of_motor_vehicles_in_transport_mvit"" NUMBER(38,0),
	""number_of_occupants"" NUMBER(38,0),
	""number_of_occupants_name"" VARCHAR(16777216),
	""day_of_crash"" NUMBER(38,0),
	""day_of_crash_name"" VARCHAR(16777216),
	""month_of_crash"" NUMBER(38,0),
	""month_of_crash_name"" VARCHAR(16777216),
	""hour_of_crash"" NUMBER(38,0),
	""hour_of_crash_name"" VARCHAR(16777216),
	""minute_of_crash"" NUMBER(38,0),
	""minute_of_crash_name"" VARCHAR(16777216),
	""first_harmful_event"" NUMBER(38,0),
	""first_harmful_event_name"" VARCHAR(16777216),
	""manner_of_collision"" NUMBER(38,0),
	""manner_of_collision_name"" VARCHAR(16777216),
	""unit_type"" NUMBER(38,0),
	""unit_type_name"" VARCHAR(16777216),
	""hit_and_run"" NUMBER(38,0),
	""hit_and_run_name"" VARCHAR(16777216),
	""registration_state"" NUMBER(38,0),
	""registration_state_name"" VARCHAR(16777216),
	""registered_vehicle_owner"" NUMBER(38,0),
	""registered_vehicle_owner_name"" VARCHAR(16777216),
	""vehicle_make"" NUMBER(38,0),
	""vehicle_make_name"" VARCHAR(16777216),
	""vehicle_model"" NUMBER(38,0),
	""make_model_combined"" VARCHAR(16777216),
	""make_model_combined_name"" VARCHAR(16777216),
	""body_type"" NUMBER(38,0),
	""body_type_name"" VARCHAR(16777216),
	""vehicle_model_year"" NUMBER(38,0),
	""vehicle_model_year_name"" VARCHAR(16777216),
	""vehicle_identification_number_vin"" VARCHAR(16777216),
	""vehicle_identification_number_vin_name"" VARCHAR(16777216),
	""vin_character_1"" VARCHAR(16777216),
	""vin_character_2"" VARCHAR(16777216),
	""vin_character_3"" VARCHAR(16777216),
	""vin_character_4"" VARCHAR(16777216),
	""vin_character_5"" VARCHAR(16777216),
	""vin_character_6"" VARCHAR(16777216),
	""vin_character_7"" VARCHAR(16777216),
	""vin_character_8"" VARCHAR(16777216),
	""vin_character_9"" VARCHAR(16777216),
	""vin_character_10"" VARCHAR(16777216),
	""vin_character_11"" VARCHAR(16777216),
	""vin_character_12"" VARCHAR(16777216),
	""vehicle_trailing"" NUMBER(38,0),
	""vehicle_trailing_name"" VARCHAR(16777216),
	""mcid_issuing_authority"" NUMBER(38,0),
	""mcid_issuing_authority_name"" VARCHAR(16777216),
	""mcid_identification_number"" VARCHAR(16777216),
	""mcid_identification_number_name"" VARCHAR(16777216),
	""motor_carrier_identification_number"" VARCHAR(16777216),
	""motor_carrier_identification_number_name"" VARCHAR(16777216),
	""gross_vehicle_weight_rating"" NUMBER(38,0),
	""gross_vehicle_weight_rating_name"" VARCHAR(16777216),
	""vehicle_configuration"" NUMBER(38,0),
	""vehicle_configuration_name"" VARCHAR(16777216),
	""cargo_body_type"" NUMBER(38,0),
	""cargo_body_type_name"" VARCHAR(16777216),
	""hazardous_material_involvement"" NUMBER(38,0),
	""hazardous_material_involvement_name"" VARCHAR(16777216),
	""hazardous_material_placard"" NUMBER(38,0),
	""hazardous_material_placard_name"" VARCHAR(16777216),
	""hazardous_material_identification_number"" NUMBER(38,0),
	""hazardous_material_identification_number_name"" VARCHAR(16777216),
	""hazardous_material_class_number"" NUMBER(38,0),
	""hazardous_material_class_number_name"" VARCHAR(16777216),
	""release_of_hazardous_material_from_the_cargo_compartment"" NUMBER(38,0),
	""release_of_hazardous_material_from_the_cargo_compartment_name"" VARCHAR(16777216),
	""bus_use"" NUMBER(38,0),
	""bus_use_name"" VARCHAR(16777216),
	""special_use"" NUMBER(38,0),
	""special_use_name"" VARCHAR(16777216),
	""emergency_motor_vehicle_use"" NUMBER(38,0),
	""emergency_motor_vehicle_use_name"" VARCHAR(16777216),
	""underride_override"" NUMBER(38,0),
	""underride_override_name"" VARCHAR(16777216),
	""initial_contact_point"" NUMBER(38,0),
	""initial_contact_point_name"" VARCHAR(16777216),
	""extent_of_damage"" NUMBER(38,0),
	""extent_of_damage_name"" VARCHAR(16777216),
	""vehicle_removal"" NUMBER(38,0),
	""vehicle_removal_name"" VARCHAR(16777216),
	""most_harmful_event"" NUMBER(38,0),
	""most_harmful_event_name"" VARCHAR(16777216),
	""related_factors_vehicle_level1"" NUMBER(38,0),
	""related_factors_vehicle_level1_name"" VARCHAR(16777216),
	""related_factors_vehicle_level2"" NUMBER(38,0),
	""related_factors_vehicle_level2_name"" VARCHAR(16777216),
	""fire_occurrence"" NUMBER(38,0),
	""fire_occurrence_name"" VARCHAR(16777216),
	""fatalities_in_vehicle"" NUMBER(38,0),
	""ptrlr1vin"" VARCHAR(16777216),
	""ptrlr1vinname"" VARCHAR(16777216),
	""ptrlr2vin"" VARCHAR(16777216),
	""ptrlr2vinname"" VARCHAR(16777216),
	""ptrlr3vin"" VARCHAR(16777216),
	""ptrlr3vinname"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['PARKWORK_2018', 'PARKWORK_2019', 'PARKWORK_2015', 'PARKWORK_2016', 'PARKWORK_2017', 'PARKWORK_2020']
,6
table_name,SAFETYEQ_2015
description,
DDL,"create or replace TABLE SAFETYEQ_2015 (
	""state_number"" NUMBER(38,0),
	""consecutive_number"" NUMBER(38,0),
	""vehicle_number"" NUMBER(38,0),
	""person_number"" NUMBER(38,0),
	""non_motorist_safety_equipment_use"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['SAFETYEQ_2015', 'SAFETYEQ_2017', 'SAFETYEQ_2018', 'SAFETYEQ_2019', 'SAFETYEQ_2016', 'SAFETYEQ_2020']
,7
table_name,VEVENT_2015
description,
DDL,"create or replace TABLE VEVENT_2015 (
	""state_number"" NUMBER(38,0),
	""consecutive_number"" NUMBER(38,0),
	""event_number"" NUMBER(38,0),
	""vehicle_number"" NUMBER(38,0),
	""vehicle_event_number"" NUMBER(38,0),
	""vehicle_number_this_vehicle"" NUMBER(38,0),
	""area_of_impact_this_vehicle"" NUMBER(38,0),
	""area_of_impact_this_vehicle_name"" VARCHAR(16777216),
	""sequence_of_events"" NUMBER(38,0),
	""sequence_of_events_name"" VARCHAR(16777216),
	""vehicle_number_other_vehicle"" NUMBER(38,0),
	""area_of_impact_other_vehicle"" NUMBER(38,0),
	""area_of_impact_other_vehicle_name"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['VEVENT_2015', 'VEVENT_2019', 'VEVENT_2017', 'VEVENT_2016', 'VEVENT_2020', 'VEVENT_2018']
,8
table_name,DAMAGE_2017
description,
DDL,"create or replace TABLE DAMAGE_2017 (
	""state_number"" NUMBER(38,0),
	""state_name"" VARCHAR(16777216),
	""consecutive_number"" NUMBER(38,0),
	""vehicle_number"" NUMBER(38,0),
	""damaged_areas"" NUMBER(38,0),
	""damaged_areas_name"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['DAMAGE_2017', 'DAMAGE_2020', 'DAMAGE_2015', 'DAMAGE_2018', 'DAMAGE_2019', 'DAMAGE_2016']
,9
table_name,FACTOR_2020
description,
DDL,"create or replace TABLE FACTOR_2020 (
	""state_number"" NUMBER(38,0),
	""state_name"" VARCHAR(16777216),
	""consecutive_number"" NUMBER(38,0),
	""vehicle_number"" NUMBER(38,0),
	""contributing_circumstances_motor_vehicle"" NUMBER(38,0),
	""contributing_circumstances_motor_vehicle_name"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['FACTOR_2020', 'FACTOR_2019', 'FACTOR_2017', 'FACTOR_2015', 'FACTOR_2018', 'FACTOR_2016']
,10
table_name,NMCRASH_2020
description,
DDL,"create or replace TABLE NMCRASH_2020 (
	""state_number"" NUMBER(38,0),
	""state_name"" VARCHAR(16777216),
	""consecutive_number"" NUMBER(38,0),
	""vehicle_number"" NUMBER(38,0),
	""person_number"" NUMBER(38,0),
	""non_motorist_contributing_circumstances"" NUMBER(38,0),
	""non_motorist_contributing_circumstances_name"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['NMCRASH_2020', 'NMCRASH_2017', 'NMCRASH_2019', 'NMCRASH_2015', 'NMCRASH_2018', 'NMCRASH_2016']
,11
table_name,VINDECODE_2016
description,
DDL,"create or replace TABLE VINDECODE_2016 (
	""state_number"" NUMBER(38,0),
	""consecutive_number"" NUMBER(38,0),
	""vehicle_number"" NUMBER(38,0),
	""vehicle_make"" VARCHAR(16777216),
	""marketing_year"" NUMBER(38,0),
	""vehicle_type_code"" VARCHAR(16777216),
	""vehicle_type"" VARCHAR(16777216),
	""make_name"" VARCHAR(16777216),
	""model_code"" VARCHAR(16777216),
	""vehicle_trim"" VARCHAR(16777216),
	""vehicle_trim_1"" VARCHAR(16777216),
	""vehicle_trim_2"" VARCHAR(16777216),
	""vehicle_trim_3"" VARCHAR(16777216),
	""vehicle_trim_4"" VARCHAR(16777216),
	""body_style_code"" VARCHAR(16777216),
	""body_style"" VARCHAR(16777216),
	""num_of_doors"" NUMBER(38,0),
	""number_of_wheels"" NUMBER(38,0),
	""num_of_wheels_by_power_train"" NUMBER(38,0),
	""vehicle_manufacturer_code"" VARCHAR(16777216),
	""vehicle_manufacturer_name"" VARCHAR(16777216),
	""displacement_cid"" NUMBER(38,0),
	""displacement_cc"" NUMBER(38,0),
	""cylinder_count_code"" VARCHAR(16777216),
	""cycle_count"" NUMBER(38,0),
	""fuel_code"" VARCHAR(16777216),
	""fuel"" VARCHAR(16777216),
	""type_of_fuel_code"" VARCHAR(16777216),
	""type_of_fuel"" VARCHAR(16777216),
	""carburetion_types_code"" VARCHAR(16777216),
	""carburetion_types"" VARCHAR(16777216),
	""num_of_barrels"" VARCHAR(16777216),
	""gross_vehicle_weights_range_code"" NUMBER(38,0),
	""gross_vehicle_weights_range"" VARCHAR(16777216),
	""distance_between_axles_for_base_model"" FLOAT,
	""distance_between_axles_for_particular_series"" VARCHAR(16777216),
	""front_tire"" NUMBER(38,0),
	""front_tire_pressure"" NUMBER(38,0),
	""front_tire_size_code"" VARCHAR(16777216),
	""front_tire_size"" VARCHAR(16777216),
	""rear_tire"" NUMBER(38,0),
	""rear_tire_pressure"" NUMBER(38,0),
	""rear_tire_size_code"" VARCHAR(16777216),
	""rear_tire_size"" VARCHAR(16777216),
	""tonnage_rating"" VARCHAR(16777216),
	""shipping_weight"" NUMBER(38,0),
	""base_price"" VARCHAR(16777216),
	""drive_type_1"" VARCHAR(16777216),
	""drive_type_2"" VARCHAR(16777216),
	""country_sold_code"" VARCHAR(16777216),
	""country_sold"" VARCHAR(16777216),
	""brakes_abs_code"" VARCHAR(16777216),
	""brakes_abs_description"" VARCHAR(16777216),
	""security_type_code"" VARCHAR(16777216),
	""security_type"" VARCHAR(16777216),
	""daytime_running_lights_1"" VARCHAR(16777216),
	""daytime_running_lights_2"" VARCHAR(16777216),
	""restraint_type_code"" VARCHAR(16777216),
	""restraint_type"" VARCHAR(16777216),
	""cab_configuration_code"" VARCHAR(16777216),
	""cab_configuration"" VARCHAR(16777216),
	""axle_type_front_axle_code"" VARCHAR(16777216),
	""axle_type_front_axle"" VARCHAR(16777216),
	""axle_type_rear_axle_code"" VARCHAR(16777216),
	""axle_type_rear_axle"" VARCHAR(16777216),
	""brake_type_code"" VARCHAR(16777216),
	""brake_type"" VARCHAR(16777216),
	""engine_manufacture_code"" VARCHAR(16777216),
	""engine_manufacture"" VARCHAR(16777216),
	""engine_model"" VARCHAR(16777216),
	""duty_type_code"" VARCHAR(16777216),
	""duty_type"" VARCHAR(16777216),
	""bed_length_code"" VARCHAR(16777216),
	""bed_length"" VARCHAR(16777216),
	""standard_segmentation_code"" VARCHAR(16777216),
	""standard_segmentation"" VARCHAR(16777216),
	""plant_code"" VARCHAR(16777216),
	""plant_country"" VARCHAR(16777216),
	""plant_city"" VARCHAR(16777216),
	""plant_country_code"" VARCHAR(16777216),
	""plant_state_code"" VARCHAR(16777216),
	""plant_state"" VARCHAR(16777216),
	""origin_code"" VARCHAR(16777216),
	""origin"" VARCHAR(16777216),
	""displacement_liters"" FLOAT,
	""block_type"" VARCHAR(16777216),
	""head_configuration_1"" VARCHAR(16777216),
	""head_configuration_2"" VARCHAR(16777216),
	""valves_per_cylinder"" NUMBER(38,0),
	""valves_total"" NUMBER(38,0),
	""engine_code"" VARCHAR(16777216),
	""is_incomplete"" VARCHAR(16777216),
	""battery_type_code"" VARCHAR(16777216),
	""battery_type"" VARCHAR(16777216),
	""total_battery_power"" VARCHAR(16777216),
	""battery_voltage"" VARCHAR(16777216),
	""supercharge_flag"" VARCHAR(16777216),
	""supercharge_flag_description"" VARCHAR(16777216),
	""turbocharger_flag"" VARCHAR(16777216),
	""turbocharger_flag_description"" VARCHAR(16777216),
	""variable_valve_timing_flag"" VARCHAR(16777216),
	""motorcycles_body_style_code"" VARCHAR(16777216),
	""motorcycles_body_style"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['VINDECODE_2016', 'VINDECODE_2015']
,12
table_name,VIOLATN_2015
description,
DDL,"create or replace TABLE VIOLATN_2015 (
	""state_number"" NUMBER(38,0),
	""consecutive_number"" NUMBER(38,0),
	""vehicle_number"" NUMBER(38,0),
	""violations_charged"" VARCHAR(16777216),
	""violations_charged_name"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['VIOLATN_2015', 'VIOLATN_2017', 'VIOLATN_2018', 'VIOLATN_2016', 'VIOLATN_2019', 'VIOLATN_2020']
,13
table_name,VISION_2018
description,
DDL,"create or replace TABLE VISION_2018 (
	""state_number"" NUMBER(38,0),
	""state_name"" VARCHAR(16777216),
	""consecutive_number"" NUMBER(38,0),
	""vehicle_number"" NUMBER(38,0),
	""drivers_vision_obscured_by"" NUMBER(38,0),
	""drivers_vision_obscured_by_name"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['VISION_2018', 'VISION_2019', 'VISION_2020', 'VISION_2016', 'VISION_2017', 'VISION_2015']
,14
table_name,VSOE_2015
description,
DDL,"create or replace TABLE VSOE_2015 (
	""state_number"" NUMBER(38,0),
	""consecutive_number"" NUMBER(38,0),
	""vehicle_number"" NUMBER(38,0),
	""vehicle_event_number"" NUMBER(38,0),
	""sequence_of_events"" NUMBER(38,0),
	""sequence_of_events_name"" VARCHAR(16777216),
	""area_of_Impact_associated_with_the_event"" NUMBER(38,0),
	""area_of_Impact_associated_with_the_event_name"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['VSOE_2015', 'VSOE_2020', 'VSOE_2016', 'VSOE_2019', 'VSOE_2018', 'VSOE_2017']
,15
table_name,MANEUVER_2016
description,
DDL,"create or replace TABLE MANEUVER_2016 (
	""state_number"" NUMBER(38,0),
	""consecutive_number"" NUMBER(38,0),
	""vehicle_number"" NUMBER(38,0),
	""driver_maneuvered_to_avoid"" NUMBER(38,0),
	""driver_maneuvered_to_avoid_name"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['MANEUVER_2016', 'MANEUVER_2015', 'MANEUVER_2018', 'MANEUVER_2020', 'MANEUVER_2017', 'MANEUVER_2019']
,16
table_name,PERSON_2016
description,
DDL,"create or replace TABLE PERSON_2016 (
	""state_number"" NUMBER(38,0),
	""consecutive_number"" NUMBER(38,0),
	""number_of_motor_vehicles_in_transport_mvit"" NUMBER(38,0),
	""vehicle_number"" NUMBER(38,0),
	""person_number"" NUMBER(38,0),
	""number_of_motor_vehicle_striking_non_motorist"" NUMBER(38,0),
	""county"" NUMBER(38,0),
	""day_of_crash"" NUMBER(38,0),
	""month_of_crash"" NUMBER(38,0),
	""hour_of_crash"" NUMBER(38,0),
	""minute_of_crash"" NUMBER(38,0),
	""land_use"" VARCHAR(16777216),
	""land_use_name"" VARCHAR(16777216),
	""functional_system"" VARCHAR(16777216),
	""functional_system_name"" VARCHAR(16777216),
	""first_harmful_event"" NUMBER(38,0),
	""first_harmful_event_name"" VARCHAR(16777216),
	""manner_of_collision"" NUMBER(38,0),
	""manner_of_collision_name"" VARCHAR(16777216),
	""school_bus_related"" VARCHAR(16777216),
	""vehicle_make"" NUMBER(38,0),
	""vehicle_make_name"" VARCHAR(16777216),
	""make_model_combined"" NUMBER(38,0),
	""body_type"" NUMBER(38,0),
	""body_type_name"" VARCHAR(16777216),
	""vehicle_trailing"" VARCHAR(16777216),
	""special_use"" NUMBER(38,0),
	""special_use_name"" VARCHAR(16777216),
	""emergency_motor_vehicle_use"" VARCHAR(16777216),
	""rollover"" VARCHAR(16777216),
	""initial_contact_point"" NUMBER(38,0),
	""initial_contact_point_name"" VARCHAR(16777216),
	""fire_occurrence"" VARCHAR(16777216),
	""age"" NUMBER(38,0),
	""sex"" VARCHAR(16777216),
	""person_type"" NUMBER(38,0),
	""person_type_name"" VARCHAR(16777216),
	""injury_severity"" NUMBER(38,0),
	""injury_severity_name"" VARCHAR(16777216),
	""seating_position"" NUMBER(38,0),
	""seating_position_name"" VARCHAR(16777216),
	""restraint_system_helmet_use"" NUMBER(38,0),
	""restraint_system_helmet_use_name"" VARCHAR(16777216),
	""indication_of_misuse_of_restraint_system_helmet"" VARCHAR(16777216),
	""air_bag_deployed"" NUMBER(38,0),
	""air_bag_deployed_name"" VARCHAR(16777216),
	""ejection"" NUMBER(38,0),
	""ejection_name"" VARCHAR(16777216),
	""ejection_path"" NUMBER(38,0),
	""ejection_path_name"" VARCHAR(16777216),
	""extrication"" VARCHAR(16777216),
	""police_reported_alcohol_involvement"" VARCHAR(16777216),
	""method_of_alcohol_determination_by_police"" VARCHAR(16777216),
	""alcohol_test_status1"" VARCHAR(16777216),
	""alcohol_test_status2"" VARCHAR(16777216),
	""alcohol_test_status3"" VARCHAR(16777216),
	""alcohol_test_status3_name"" VARCHAR(16777216),
	""police_reported_drug_involvement"" VARCHAR(16777216),
	""method_of_drug_determination_by_police"" VARCHAR(16777216),
	""drug_test_status"" VARCHAR(16777216),
	""drug_test_type1"" VARCHAR(16777216),
	""drug_test_type2"" VARCHAR(16777216),
	""drug_test_type3"" VARCHAR(16777216),
	""drug_test_type4"" NUMBER(38,0),
	""drug_test_type4_name"" VARCHAR(16777216),
	""drug_test_type5"" NUMBER(38,0),
	""drug_test_type5_name"" VARCHAR(16777216),
	""drug_test_type6"" NUMBER(38,0),
	""drug_test_type6_name"" VARCHAR(16777216),
	""transported_to_first_treatment_facility"" NUMBER(38,0),
	""transported_to_first_treatment_facility_name"" VARCHAR(16777216),
	""died_at_scene_en_route"" VARCHAR(16777216),
	""day_of_death"" NUMBER(38,0),
	""month_of_death"" NUMBER(38,0),
	""year_of_death"" NUMBER(38,0),
	""hour_of_death"" NUMBER(38,0),
	""minute_of_death"" NUMBER(38,0),
	""death_time"" NUMBER(38,0),
	""lag_hours"" NUMBER(38,0),
	""lag_minutes"" NUMBER(38,0),
	""related_factors_person_level1"" NUMBER(38,0),
	""related_factors_person_level2"" NUMBER(38,0),
	""related_factors_person_level3"" NUMBER(38,0),
	""fatal_injury_at_work"" VARCHAR(16777216),
	""hispanic_origin"" NUMBER(38,0),
	""hispanic_origin_name"" VARCHAR(16777216),
	""race"" NUMBER(38,0),
	""race_name"" VARCHAR(16777216),
	""non_motorist_location_at_time_of_crash"" NUMBER(38,0),
	""non_motorist_location_at_time_of_crash_name"" VARCHAR(16777216),
	""timestamp_of_crash"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['PERSON_2016', 'PERSON_2015']
,17
table_name,NMIMPAIR_2019
description,
DDL,"create or replace TABLE NMIMPAIR_2019 (
	""state_number"" NUMBER(38,0),
	""state_name"" VARCHAR(16777216),
	""consecutive_number"" NUMBER(38,0),
	""vehicle_number"" NUMBER(38,0),
	""person_number"" NUMBER(38,0),
	""condition_impairment_at_time_of_crash_non_motorist"" NUMBER(38,0),
	""condition_impairment_at_time_of_crash_non_motorist_name"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['NMIMPAIR_2019', 'NMIMPAIR_2017', 'NMIMPAIR_2020', 'NMIMPAIR_2015', 'NMIMPAIR_2018', 'NMIMPAIR_2016']
,18
table_name,PBTYPE_2015
description,
DDL,"create or replace TABLE PBTYPE_2015 (
	""state_number"" NUMBER(38,0),
	""consecutive_number"" NUMBER(38,0),
	""vehicle_number"" NUMBER(38,0),
	""person_number"" NUMBER(38,0),
	""person_type"" NUMBER(38,0),
	""person_type_name"" VARCHAR(16777216),
	""age"" NUMBER(38,0),
	""sex"" VARCHAR(16777216),
	""marked_crosswalk_present"" VARCHAR(16777216),
	""sidewalk_present"" VARCHAR(16777216),
	""school_zone"" VARCHAR(16777216),
	""crash_type_pedestrian"" NUMBER(38,0),
	""crash_type_pedestrian_name"" VARCHAR(16777216),
	""crash_type_bicycle"" NUMBER(38,0),
	""crash_type_bicycle_name"" VARCHAR(16777216),
	""crash_location_pedestrian"" VARCHAR(16777216),
	""crash_location_bicycle"" VARCHAR(16777216),
	""pedestrian_position"" VARCHAR(16777216),
	""bicyclist_position"" VARCHAR(16777216),
	""pedestrian_initial_direction_of_travel"" VARCHAR(16777216),
	""bicyclist_initial_direction_of_travel"" VARCHAR(16777216),
	""motorist_initial_direction_of_travel"" VARCHAR(16777216),
	""motorist_maneuver"" VARCHAR(16777216),
	""intersection_leg"" VARCHAR(16777216),
	""pedestrian_scenario"" VARCHAR(16777216),
	""pedestrian_scenario_name"" VARCHAR(16777216),
	""crash_group_pedestrian"" NUMBER(38,0),
	""crash_group_pedestrian_name"" VARCHAR(16777216),
	""crash_group_bicycle"" NUMBER(38,0),
	""crash_group_bicycle_name"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['PBTYPE_2015', 'PBTYPE_2020', 'PBTYPE_2017', 'PBTYPE_2019', 'PBTYPE_2016', 'PBTYPE_2018']
,19
table_name,VEHICLE_2015
description,
DDL,"create or replace TABLE VEHICLE_2015 (
	""state_number"" NUMBER(38,0),
	""consecutive_number"" NUMBER(38,0),
	""vehicle_number"" NUMBER(38,0),
	""number_of_motor_vehicles_in_transport_mvit"" NUMBER(38,0),
	""number_of_occupants"" NUMBER(38,0),
	""day_of_crash"" NUMBER(38,0),
	""month_of_crash"" NUMBER(38,0),
	""hour_of_crash"" NUMBER(38,0),
	""minute_of_crash"" NUMBER(38,0),
	""first_harmful_event"" NUMBER(38,0),
	""first_harmful_event_name"" VARCHAR(16777216),
	""manner_of_collision"" NUMBER(38,0),
	""unit_type"" VARCHAR(16777216),
	""hit_and_run"" VARCHAR(16777216),
	""registration_state"" NUMBER(38,0),
	""registration_state_name"" VARCHAR(16777216),
	""registered_vehicle_owner"" NUMBER(38,0),
	""registered_vehicle_owner_name"" VARCHAR(16777216),
	""vehicle_make"" NUMBER(38,0),
	""vehicle_make_name"" VARCHAR(16777216),
	""vehicle_model"" NUMBER(38,0),
	""make_model_combined"" NUMBER(38,0),
	""body_type"" NUMBER(38,0),
	""body_type_name"" VARCHAR(16777216),
	""vehicle_model_year"" NUMBER(38,0),
	""vehicle_identification_number_vin"" VARCHAR(16777216),
	""vin_character_1"" VARCHAR(16777216),
	""vin_character_2"" VARCHAR(16777216),
	""vin_character_3"" VARCHAR(16777216),
	""vin_character_4"" VARCHAR(16777216),
	""vin_character_5"" VARCHAR(16777216),
	""vin_character_6"" VARCHAR(16777216),
	""vin_character_7"" VARCHAR(16777216),
	""vin_character_8"" VARCHAR(16777216),
	""vin_character_9"" VARCHAR(16777216),
	""vin_character_10"" VARCHAR(16777216),
	""vin_character_11"" VARCHAR(16777216),
	""vin_character_12"" VARCHAR(16777216),
	""vehicle_trailing"" VARCHAR(16777216),
	""jackknife"" VARCHAR(16777216),
	""mcid_issuing_authority"" NUMBER(38,0),
	""mcid_identification_number"" VARCHAR(16777216),
	""motor_carrier_identification_number_mcid"" VARCHAR(16777216),
	""gross_vehicle_weight_rating"" VARCHAR(16777216),
	""vehicle_configuration"" NUMBER(38,0),
	""vehicle_configuration_name"" VARCHAR(16777216),
	""cargo_body_type"" NUMBER(38,0),
	""cargo_body_type_name"" VARCHAR(16777216),
	""hazardous_material_involvement"" VARCHAR(16777216),
	""hazardous_material_placard"" NUMBER(38,0),
	""hazardous_material_identification_number"" NUMBER(38,0),
	""hazardous_material_class_number"" NUMBER(38,0),
	""release_of_hazardous_material_from_the_cargo_compartment"" VARCHAR(16777216),
	""bus_use"" VARCHAR(16777216),
	""special_use"" NUMBER(38,0),
	""special_use_name"" VARCHAR(16777216),
	""emergency_motor_vehicle_use"" VARCHAR(16777216),
	""travel_speed"" NUMBER(38,0),
	""underride_override"" NUMBER(38,0),
	""rollover"" VARCHAR(16777216),
	""location_of_rollover"" VARCHAR(16777216),
	""initial_contact_point"" NUMBER(38,0),
	""extent_of_damage"" VARCHAR(16777216),
	""vehicle_removal"" VARCHAR(16777216),
	""most_harmful_event"" NUMBER(38,0),
	""related_factors_vehicle_level_1"" NUMBER(38,0),
	""related_factors_vehicle_level_2"" NUMBER(38,0),
	""fire_occurrence"" VARCHAR(16777216),
	""driver_presence"" VARCHAR(16777216),
	""drivers_license_state"" NUMBER(38,0),
	""drivers_zip_code"" NUMBER(38,0),
	""non_cdl_license_status"" NUMBER(38,0),
	""non_cdl_license_type"" VARCHAR(16777216),
	""commercial_motor_vehicle_license_status"" NUMBER(38,0),
	""compliance_with_cdl_endorsements"" VARCHAR(16777216),
	""license_compliance_with_class_of_vehicle"" VARCHAR(16777216),
	""compliance_with_license_restrictions"" NUMBER(38,0),
	""driver_height"" NUMBER(38,0),
	""driver_weight"" NUMBER(38,0),
	""previous_recorded_crashes"" NUMBER(38,0),
	""previous_recorded_suspensions_and_revocations"" NUMBER(38,0),
	""previous_dwi_convictions"" NUMBER(38,0),
	""previous_speeding_convictions"" NUMBER(38,0),
	""previous_other_moving_violation_convictions"" NUMBER(38,0),
	""month_of_first_crash_suspension_or_conviction"" NUMBER(38,0),
	""year_of_first_crash_suspension_or_conviction"" NUMBER(38,0),
	""month_of_last_crash_suspension_or_conviction"" NUMBER(38,0),
	""year_of_last_crash_suspension_or_conviction"" NUMBER(38,0),
	""speeding_related"" VARCHAR(16777216),
	""related_factors_driver_level_1"" NUMBER(38,0),
	""related_factors_driver_level_2"" NUMBER(38,0),
	""related_factors_driver_level_3"" NUMBER(38,0),
	""related_factors_driver_level_4"" NUMBER(38,0),
	""trafficway_description"" VARCHAR(16777216),
	""total_lanes_in_roadway"" NUMBER(38,0),
	""speed_limit"" NUMBER(38,0),
	""roadway_alignment"" VARCHAR(16777216),
	""roadway_grade"" VARCHAR(16777216),
	""roadway_surface_type"" VARCHAR(16777216),
	""roadway_surface_condition"" NUMBER(38,0),
	""roadway_surface_condition_name"" VARCHAR(16777216),
	""traffic_control_device"" NUMBER(38,0),
	""traffic_control_device_functioning"" VARCHAR(16777216),
	""pre_event_movement_prior_to_recognition_of_critical_event"" NUMBER(38,0),
	""critical_event_precrash"" NUMBER(38,0),
	""critical_event_precrash_name"" VARCHAR(16777216),
	""attempted_avoidance_maneuver"" NUMBER(38,0),
	""attempted_avoidance_maneuver_name"" VARCHAR(16777216),
	""pre_impact_stability"" VARCHAR(16777216),
	""pre_impact_location"" NUMBER(38,0),
	""crash_type"" NUMBER(38,0),
	""crash_type_name"" VARCHAR(16777216),
	""fatalities_in_vehicle"" NUMBER(38,0),
	""driver_drinking"" VARCHAR(16777216),
	""timestamp_of_crash"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['VEHICLE_2015', 'VEHICLE_2016']
External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'NHTSA_TRAFFIC_FATALITIES': {'NHTSA_TRAFFIC_FATALITIES': ['ACCIDENT_2015', 'ACCIDENT_2016', 'ACCIDENT_2017', 'ACCIDENT_2018', 'ACCIDENT_2019', 'ACCIDENT_2020', 'CEVENT_2015', 'CEVENT_2016', 'CEVENT_2017', 'CEVENT_2018', 'CEVENT_2019', 'CEVENT_2020', 'DAMAGE_2015', 'DAMAGE_2016', 'DAMAGE_2017', 'DAMAGE_2018', 'DAMAGE_2019', 'DAMAGE_2020', 'DISTRACT_2015', 'DISTRACT_2016', 'DISTRACT_2017', 'DISTRACT_2018', 'DISTRACT_2019', 'DISTRACT_2020', 'DRIMPAIR_2015', 'DRIMPAIR_2016', 'DRIMPAIR_2017', 'DRIMPAIR_2018', 'DRIMPAIR_2019', 'DRIMPAIR_2020', 'FACTOR_2015', 'FACTOR_2016', 'FACTOR_2017', 'FACTOR_2018', 'FACTOR_2019', 'FACTOR_2020', 'MANEUVER_2015', 'MANEUVER_2016', 'MANEUVER_2017', 'MANEUVER_2018', 'MANEUVER_2019', 'MANEUVER_2020', 'NMCRASH_2015', 'NMCRASH_2016', 'NMCRASH_2017', 'NMCRASH_2018', 'NMCRASH_2019', 'NMCRASH_2020', 'NMIMPAIR_2015', 'NMIMPAIR_2016', 'NMIMPAIR_2017', 'NMIMPAIR_2018', 'NMIMPAIR_2019', 'NMIMPAIR_2020', 'NMPRIOR_2015', 'NMPRIOR_2016', 'NMPRIOR_2017', 'NMPRIOR_2018', 'NMPRIOR_2019', 'NMPRIOR_2020', 'PARKWORK_2015', 'PARKWORK_2016', 'PARKWORK_2017', 'PARKWORK_2018', 'PARKWORK_2019', 'PARKWORK_2020', 'PBTYPE_2015', 'PBTYPE_2016', 'PBTYPE_2017', 'PBTYPE_2018', 'PBTYPE_2019', 'PBTYPE_2020', 'PERSON_2015', 'PERSON_2016', 'SAFETYEQ_2015', 'SAFETYEQ_2016', 'SAFETYEQ_2017', 'SAFETYEQ_2018', 'SAFETYEQ_2019', 'SAFETYEQ_2020', 'VEHICLE_2015', 'VEHICLE_2016', 'VEVENT_2015', 'VEVENT_2016', 'VEVENT_2017', 'VEVENT_2018', 'VEVENT_2019', 'VEVENT_2020', 'VINDECODE_2015', 'VINDECODE_2016', 'VIOLATN_2015', 'VIOLATN_2016', 'VIOLATN_2017', 'VIOLATN_2018', 'VIOLATN_2019', 'VIOLATN_2020', 'VISION_2015', 'VISION_2016', 'VISION_2017', 'VISION_2018', 'VISION_2019', 'VISION_2020', 'VSOE_2015', 'VSOE_2016', 'VSOE_2017', 'VSOE_2018', 'VSOE_2019', 'VSOE_2020']}}
Begin Exploring Related Columns
**Relevant Table:**

- `ACCIDENT_2016`

**Relevant Columns and Potential Usage:**

- `"state_name"`: Used to identify and group accidents by state.
- `"day_of_week"`: Used to filter accidents that occurred during weekends.
- `"atmospheric_conditions_1_name"`: Used to identify weather conditions ('Rain' or 'Clear') during accidents.
- `"consecutive_number"`: Unique identifier for each accident; could be used to count accidents.
- `"year_of_crash"`: Confirms the year of the accident (should be 2016 for this table).
- `"day_of_crash"` and `"month_of_crash"`: Additional date information if needed.

**Conditions That May Be Used:**

- `"day_of_week"` IN (1, 7): To filter for weekends (assuming 1 = Sunday and 7 = Saturday).
- `"atmospheric_conditions_1_name"` = 'Rain' or 'Clear': To filter by specific weather conditions.
- `"year_of_crash"` = 2016: To ensure the data is from the correct year (though the table is specific to 2016).

---

**SQL Queries:**

```sql
-- 1. Get distinct values of "day_of_week".
SELECT DISTINCT "day_of_week"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
LIMIT 1000;

-- 2. Count of accidents per "day_of_week".
SELECT "day_of_week", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
GROUP BY "day_of_week"
LIMIT 1000;

-- 3. Get distinct weather conditions in "atmospheric_conditions_1_name".
SELECT DISTINCT "atmospheric_conditions_1_name"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
LIMIT 1000;

-- 4. Count of accidents per "atmospheric_conditions_1_name".
SELECT "atmospheric_conditions_1_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
GROUP BY "atmospheric_conditions_1_name"
LIMIT 1000;

-- 5. Count of accidents per "state_name".
SELECT "state_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
GROUP BY "state_name"
LIMIT 1000;

-- 6. Get distinct "state_name" and corresponding "state_number".
SELECT DISTINCT "state_name", "state_number"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
LIMIT 1000;

-- 7. Count of weekend accidents in a specific state (e.g., 'Texas').
SELECT COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "state_name" = 'Texas' AND "day_of_week" IN (1, 7)
LIMIT 1000;

-- 8. Count of weekend accidents per "state_name".
SELECT "state_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7)
GROUP BY "state_name"
LIMIT 1000;

-- 9. Count of weekend accidents per weather condition.
SELECT "atmospheric_conditions_1_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7)
GROUP BY "atmospheric_conditions_1_name"
LIMIT 1000;

-- 10. Count of weekend accidents per "state_name" and weather condition.
SELECT "state_name", "atmospheric_conditions_1_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7)
GROUP BY "state_name", "atmospheric_conditions_1_name"
LIMIT 1000;

-- 11. Get distinct years in "year_of_crash" to confirm data is from 2016.
SELECT DISTINCT "year_of_crash"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
LIMIT 1000;

-- 12. Sample date information to understand "day_of_week" values.
SELECT "day_of_week", "day_of_crash", "month_of_crash", "year_of_crash"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
LIMIT 1000;

-- 13. Mapping between "atmospheric_conditions_1" and "atmospheric_conditions_1_name".
SELECT "atmospheric_conditions_1", "atmospheric_conditions_1_name"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
LIMIT 1000;

-- 14. Count of weekend accidents by weather condition.
SELECT "atmospheric_conditions_1_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7)
GROUP BY "atmospheric_conditions_1_name"
LIMIT 1000;

-- 15. Count of weekend accidents per "state_name" with 'Rain' weather.
SELECT "state_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7) AND "atmospheric_conditions_1_name" = 'Rain'
GROUP BY "state_name"
LIMIT 1000;

-- 16. Count of weekend accidents per "state_name" with 'Clear' weather.
SELECT "state_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7) AND "atmospheric_conditions_1_name" = 'Clear'
GROUP BY "state_name"
LIMIT 1000;

-- 17. Weekend accidents with weather conditions other than 'Rain' or 'Clear'.
SELECT "state_name", "atmospheric_conditions_1_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7) AND "atmospheric_conditions_1_name" NOT IN ('Rain', 'Clear')
GROUP BY "state_name", "atmospheric_conditions_1_name"
LIMIT 1000;

-- 18. Total weekend accidents per "state_name" regardless of weather.
SELECT "state_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7)
GROUP BY "state_name"
LIMIT 1000;

-- 19. Count of accidents per "day_of_week" and weather condition.
SELECT "day_of_week", "atmospheric_conditions_1_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
GROUP BY "day_of_week", "atmospheric_conditions_1_name"
LIMIT 1000;
```Query:
-- 1. Get distinct values of "day_of_week".
SELECT DISTINCT "day_of_week"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
LIMIT 1000
Answer:
day_of_week
7
6
4
1
5
2
3
Query:
-- 2. Count of accidents per "day_of_week".
SELECT "day_of_week", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
GROUP BY "day_of_week"
LIMIT 1000
Answer:
day_of_week,num_accidents
7,6159
6,5397
4,4439
1,5353
5,4706
2,4537
3,4157
Query:
-- 3. Get distinct weather conditions in "atmospheric_conditions_1_name".
SELECT DISTINCT "atmospheric_conditions_1_name"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
LIMIT 1000
Answer:
atmospheric_conditions_1_name
"Sleet, Hail"
Severe Crosswinds
Other
"Blowing Sand, Soil, Dirt"
Blowing Snow
Freezing Rain or Drizzle
Unknown
Clear
Rain
"Fog, Smog, Smoke"
Cloudy
Snow
Not Reported
Query:
-- 4. Count of accidents per "atmospheric_conditions_1_name".
SELECT "atmospheric_conditions_1_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
GROUP BY "atmospheric_conditions_1_name"
LIMIT 1000
Answer:
atmospheric_conditions_1_name,num_accidents
"Sleet, Hail",65
Severe Crosswinds,42
Other,48
"Blowing Sand, Soil, Dirt",20
Blowing Snow,10
Freezing Rain or Drizzle,17
Unknown,146
Clear,24956
Rain,2107
"Fog, Smog, Smoke",329
Cloudy,5126
Snow,328
Not Reported,1554
Query:
-- 5. Count of accidents per "state_name".
SELECT "state_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
GROUP BY "state_name"
LIMIT 1000
Answer:
state_name,num_accidents
Idaho,232
Maryland,484
Nebraska,194
Ohio,1053
Kansas,381
New Mexico,361
Utah,259
Indiana,776
Arkansas,504
Minnesota,357
Georgia,1424
Louisiana,704
Vermont,57
New Jersey,570
Wisconsin,544
Colorado,558
New York,981
West Virginia,250
Alaska,78
Virginia,722
Florida,2935
Kentucky,763
District of Columbia,26
New Hampshire,130
Wyoming,100
North Carolina,1348
Tennessee,962
Arizona,856
Oregon,448
Pennsylvania,1088
Connecticut,292
Nevada,304
California,3540
Illinois,1000
South Carolina,941
Texas,3427
Mississippi,625
Michigan,981
Alabama,979
Missouri,872
Iowa,355
Hawaii,109
Massachusetts,356
Delaware,116
Maine,150
Oklahoma,628
North Dakota,102
South Dakota,103
Rhode Island,48
Montana,171
Washington,504
Query:
-- 6. Get distinct "state_name" and corresponding "state_number".
SELECT DISTINCT "state_name", "state_number"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
LIMIT 1000
Answer:
state_name,state_number
Idaho,16
Maryland,24
North Carolina,37
Ohio,39
California,6
Kansas,20
New Mexico,35
Utah,49
Missouri,29
Maine,23
Indiana,18
Iowa,19
Arkansas,5
Minnesota,27
Georgia,13
Tennessee,47
Vermont,50
Alabama,1
Montana,30
Oklahoma,40
Washington,53
New Jersey,34
Pennsylvania,42
West Virginia,54
South Carolina,45
Alaska,2
Florida,12
Hawaii,15
Wisconsin,55
Colorado,8
Texas,48
North Dakota,38
Kentucky,21
Nevada,32
New Hampshire,33
Rhode Island,44
Delaware,10
Nebraska,31
Illinois,17
Arizona,4
Louisiana,22
Oregon,41
Connecticut,9
Mississippi,28
Massachusetts,25
New York,36
South Dakota,46
District of Columbia,11
Michigan,26
Wyoming,56
Virginia,51
Query:
-- 7. Count of weekend accidents in a specific state (e.g., 'Texas').
SELECT COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "state_name" = 'Texas' AND "day_of_week" IN (1, 7)
LIMIT 1000
Answer:
num_accidents
1202
Query:
-- 8. Count of weekend accidents per "state_name".
SELECT "state_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7)
GROUP BY "state_name"
LIMIT 1000
Answer:
state_name,num_accidents
Idaho,61
Maryland,165
Ohio,347
California,1210
Kansas,119
Maine,48
Missouri,287
Arkansas,151
Georgia,467
North Carolina,425
Montana,65
Oklahoma,206
Washington,170
Wisconsin,192
South Carolina,325
Iowa,115
Virginia,249
South Dakota,35
Arizona,273
North Dakota,39
District of Columbia,8
Michigan,321
Delaware,38
New Mexico,111
Tennessee,341
Illinois,368
Minnesota,109
New Hampshire,34
Vermont,17
Hawaii,44
Nevada,98
Massachusetts,116
Indiana,244
Texas,1202
West Virginia,68
Pennsylvania,329
Kentucky,235
New York,303
Florida,1002
Rhode Island,10
Utah,78
Connecticut,90
Wyoming,29
Louisiana,244
New Jersey,187
Oregon,135
Alabama,329
Mississippi,213
Alaska,23
Colorado,168
Nebraska,69
Query:
-- 9. Count of weekend accidents per weather condition.
SELECT "atmospheric_conditions_1_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7)
GROUP BY "atmospheric_conditions_1_name"
LIMIT 1000
Answer:
atmospheric_conditions_1_name,num_accidents
"Sleet, Hail",23
Severe Crosswinds,15
Other,13
Unknown,56
Blowing Snow,4
Freezing Rain or Drizzle,6
"Blowing Sand, Soil, Dirt",4
Clear,8411
Rain,672
Snow,109
Not Reported,489
"Fog, Smog, Smoke",102
Cloudy,1608
Query:
-- 10. Count of weekend accidents per "state_name" and weather condition.
SELECT "state_name", "atmospheric_conditions_1_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7)
GROUP BY "state_name", "atmospheric_conditions_1_name"
LIMIT 1000
Answer:
Too long, hard cut:
state_name,atmospheric_conditions_1_name,num_accidents
Idaho,"Sleet, Hail",1
Maryland,"Sleet, Hail",2
Ohio,"Sleet, Hail",1
California,Severe Crosswinds,2
Kansas,Severe Crosswinds,4
New Mexico,Severe Crosswinds,1
Missouri,Other,2
New Mexico,Other,2
Arkansas,Unknown,2
Tennessee,"Sleet, Hail",6
North Carolina,Severe Crosswinds,2
Missouri,Unknown,2
Montana,Unknown,2
Oklahoma,Unknown,2
South Carolina,Blowing Snow,1
Iowa,Unknown,2
Virginia,"Sleet, Hail",1
Illinois,"Sleet, Hail",1
North Carolina,Freezing Rain or Drizzle,3
Tennessee,Unknown,6
Arkansas,Other,1
Texas,"Sleet, Hail",1
West Virginia,"Sleet, Hail",1
Arkansas,Severe Crosswinds,1
Kentucky,Severe Crosswinds,1
Indiana,"Sleet, Hail",1
Ohio,Unknown,1
Wisconsin,Severe Crosswinds,1
Kansas,Unknown,2
North Carolina,Other,1
Pennsylvania,Freezing Rain or Drizzle,1
Missouri,Clear,218
Tennessee,Clear,275
Minnesota,Clear,74
Rhode Island,Clear,8
Maryland,Rain,10
Iowa,Snow,4
Arkansas,Cloudy,17
Georgia,Unknown,4
Washington,Unknown,3
California,Unknown,1
South Dakota,Blowing Snow,1
Minnesota,Blowing Snow,1
New York,"Sleet, Hail",1
Arizona,Unknown,5
Florida,Other,2
South Carolina,Clear,285
Nebraska,Clear,52
Pennsylvania,Clear,282
South Dakota,Clear,32
Hawaii,Clear,34
Massachusetts,Clear,81
West Virginia,Rain,9
Oklahoma,Rain,12
West Virginia,Snow,1
Idaho,Snow,2
Virginia,"Fog, Smog, Smoke",5
Oregon,"Fog, Smog, Smoke",4
New York,Cloudy,74
Ohio,Rain,19
Iowa,"Fog, Smog, Smoke",2
Oklahoma,Not Reported,2
Oklahoma,Cloudy,58
Maine,Other,1
Indiana,Severe Crosswinds,1
Wisconsin,Unknown,5
Illinois,Unknown,3
Pennsylvania,"Sleet, Hail",2
Iowa,"Blowing Sand, Soil, Dirt",3
Kentucky,"Blowing Sand, Soil, Dirt",1
New Jersey,Freezing Rain or Drizzle,1
Hawaii,Unknown,1
Minnesota,Unknown,1
Connecticut,Other,1
North Dakota,Unknown,1
North Carolina,"Sleet, Hail",1
North Carolina,Clear,328
California,Clear,979
New Mexico,Clear,96
West Virginia,Clear,50
Arkansas,Rain,11
Montana,Rain,3
Pennsylvania,Rain,19
Tennessee,Rain,29
Indiana,"Fog, Smog, Smoke",4
Missouri,"Fog, Smog, Smoke",5
Georgia,Cloudy,77
South Dakota,Cloudy,1
Utah,Severe Crosswinds,1
Indiana,Freezing Rain or Drizzle,1
Pennsylvania,Other,2
Massachusetts,Unknown,1
District of Columbia,Unknown,1
Michigan,"Sleet, Hail",1
Michigan,Unknown,4
Indiana,Clear,170
North Dakota,Clear,31
Louisiana,Clear,199
Alabama,Clear,251
Colorado,Clear,16
Connecticut,Clear,80
Georgia,Clear,360
Illinois,Clear,326
Mississippi,Clear,170
Utah,Clear,52
Delaware,Clear,30
District of Columbia,Clear,7
Maine,Rain,4
Texas,Rain,68
Washington,Rain,24
California,Rain,55
Kentucky,Rain,27
Wyoming,Rain,2
Minnesota,Snow,1
Missouri,Snow,2
Illinois,Snow,8
Virginia,Snow,3
Oklahoma,Snow,1
Florida,"Fog, Smog, Smoke",8
California,"Fog, Smog, Smoke",7
New Mexico,"Fog, Smog, Smoke",1
Mississippi,Cloudy,29
Vermont,Cloudy,5
Pennsylvania,Not Reported,9
South Carolina,Not Reported,3
Arizona,"Sleet, Hail",1
Louisiana,Unknown,1
Alabama,Unknown,1
Kansas,Clear,33
Kentucky,Clear,161
New York,Clear,196
Oklahoma,Clear,131
Texas,Clear,895
Wisconsin,Clear,121
Louisiana,Rain,14
Oregon,Rain,16
Wisconsin,Rain,4
Iowa,Rain,4
Delaware,Rain,2
Michigan,Rain,21
Hawaii,Rain,5
Connecticut,Rain,2
Wisconsin,Snow,7
Ohio,Snow,8
Washington,Snow,2
Alaska,Snow,2
New Hampshire,Snow,1
Wisconsin,"Fog, Smog, Smoke",2
Pennsylvania,"Fog, Smog, Smoke",6
New Hampshire,"Fog, Smog, Smoke",1
Kansas,"Fog, Smog, Smoke",3
Connecticut,"Fog, Smog, Smoke",1
Kentucky,Cloudy,42
Montana,Cloudy,20
West Virginia,Cloudy,7
Alaska,Cloudy,5
Kansas,Cloudy,1
New Mexico,Cloudy,2
New Mexico,Not Reported,2
Mississippi,Rain,12
California,Snow,1
Maryland,Cloudy,14
Maine,Snow,1
Washington,Clear,113
Oregon,"Sleet, Hail",1
Maryland,Other,1
Utah,Unknown,2
Connecticut,Blowing Snow,1
Texas,Severe Crosswinds,1
Ohio,Clear,219
Arkansas,Clear,116
Idaho,Clear,42
Iowa,Clear,79
Maryland,Clear,127
Montana,Clear,38
New Jersey,Clear,158
Oregon,Clear,76
Florida,Rain,49
Indiana,Rain,20
North Carolina,Rain,33
New York,Rain,23
Alaska,Rain,5
Georgia,Rain,25
New Mexico,Rain,3
Missouri,Rain,8
Idaho,Rain,2
Colorado,Snow,1
Utah,Snow,4
Wyoming,Snow,4
Oregon,Snow,2
New Jersey,Snow,1
Arkansas,"Fog, Smog, Smoke",3
Kentucky,"Fog, Smog, Smoke",2
Louisiana,"Fog, Smog, Smoke",3
Massachusetts,"Fog, Smog, Smoke",2
Illinois,"Fog, Smog, Smoke",7
North Carolina,"Fog, Smog, Smoke",1
New York,"Fog, Smog, Smoke",2
Indiana,Cloudy,44
Michigan,Cloudy,59
Missouri,Cloudy,50
Texas,Cloudy,224
Iowa,Cloudy,21
North Dakota,Cloudy,5
Kansas,Not Reported,69
Oregon,Not Reported,4
Kansas,"Sleet, Hail",1
Texas,Unknown,3
Arizona,Clear,226
Florida,Clear,799
Maine,Clear,36
Michigan,Clear,210
Nevada,Clear,81
New Hampshire,Clear,23
Wyoming,Clear,23
Alaska,Clear,11
Illinois,Rain,17
Kansas,Rain,5
Nevada,Rain,2
Virginia,Rain,18
Utah,Rain,3
Massachusetts,Rain,9
Minnesota,Rain,6
Nebraska,Rain,5
New Hampshire,Rain,1
Michigan,Snow,23
New York,Snow,6
Montana,Snow,2
Pennsylvania,Snow,8
Indiana,Snow,3
New Mexico,Snow,4
Kansas,Snow,1
North Dakota,Snow,1
South Dakota,Snow,1
Maryland,Snow,1
Nevada,Snow,1
Minnesota,"Fog, Smog
Query:
-- 11. Get distinct years in "year_of_crash" to confirm data is from 2016.
SELECT DISTINCT "year_of_crash"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
LIMIT 1000
Answer:
year_of_crash
2016
Query:
-- 12. Sample date information to understand "day_of_week" values.
SELECT "day_of_week", "day_of_crash", "month_of_crash", "year_of_crash"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
LIMIT 1000
Answer:
Too long, hard cut:
day_of_week,day_of_crash,month_of_crash,year_of_crash
7,21,5,2016
7,16,1,2016
6,16,12,2016
6,22,1,2016
7,17,12,2016
6,22,1,2016
7,3,12,2016
4,6,7,2016
6,16,12,2016
7,17,12,2016
1,3,4,2016
7,23,4,2016
6,22,4,2016
5,18,2,2016
7,2,1,2016
1,13,11,2016
7,19,3,2016
2,8,2,2016
3,6,12,2016
6,16,12,2016
1,31,7,2016
2,27,6,2016
2,22,8,2016
4,3,8,2016
2,16,5,2016
1,16,10,2016
4,14,9,2016
1,14,2,2016
1,14,2,2016
6,15,1,2016
7,2,4,2016
1,3,4,2016
2,9,5,2016
7,3,9,2016
4,10,8,2016
5,15,12,2016
3,12,1,2016
2,5,12,2016
5,21,1,2016
3,29,11,2016
3,29,3,2016
7,17,9,2016
7,4,6,2016
1,26,6,2016
7,9,4,2016
6,4,3,2016
4,16,11,2016
6,18,11,2016
1,1,5,2016
3,28,6,2016
7,12,3,2016
3,12,4,2016
2,7,3,2016
6,16,12,2016
3,26,1,2016
6,16,12,2016
1,14,2,2016
1,14,2,2016
2,15,2,2016
2,4,7,2016
6,28,10,2016
6,15,4,2016
4,6,4,2016
4,25,5,2016
6,16,12,2016
1,17,1,2016
6,8,1,2016
5,11,2,2016
7,23,1,2016
2,3,10,2016
2,1,8,2016
3,1,3,2016
7,24,9,2016
2,4,1,2016
7,21,5,2016
3,23,8,2016
3,26,1,2016
7,2,4,2016
7,6,2,2016
3,22,11,2016
3,2,8,2016
5,25,2,2016
5,25,8,2016
4,2,3,2016
3,24,5,2016
7,17,12,2016
7,17,12,2016
1,1,5,2016
6,19,2,2016
5,28,7,2016
7,17,12,2016
5,15,12,2016
5,11,8,2016
6,15,7,2016
1,14,8,2016
4,16,3,2016
6,12,2,2016
7,19,11,2016
5,31,3,2016
6,15,4,2016
6,2,9,2016
3,2,8,2016
7,20,2,2016
6,16,12,2016
7,13,2,2016
3,21,6,2016
2,29,2,2016
1,26,6,2016
4,13,1,2016
1,27,3,2016
7,17,12,2016
5,1,12,2016
5,21,7,2016
5,2,6,2016
7,15,10,2016
1,10,1,2016
6,4,11,2016
6,16,12,2016
6,8,1,2016
7,17,12,2016
7,19,3,2016
2,18,4,2016
1,18,12,2016
4,7,12,2016
1,4,9,2016
1,27,11,2016
3,4,10,2016
7,19,11,2016
3,6,9,2016
4,17,8,2016
1,31,7,2016
2,6,6,2016
6,19,2,2016
7,10,12,2016
2,15,8,2016
4,15,6,2016
4,10,2,2016
4,20,1,2016
6,8,1,2016
1,10,4,2016
5,29,12,2016
5,21,1,2016
7,2,4,2016
3,13,12,2016
2,8,2,2016
6,1,1,2016
6,16,9,2016
2,14,3,2016
4,6,1,2016
3,12,1,2016
4,10,2,2016
7,2,1,2016
1,7,2,2016
2,15,2,2016
7,10,12,2016
2,15,2,2016
5,24,3,2016
6,16,12,2016
5,18,2,2016
7,17,12,2016
1,3,1,2016
6,22,4,2016
6,22,1,2016
6,4,3,2016
3,18,10,2016
3,19,1,2016
5,17,11,2016
5,15,12,2016
2,15,2,2016
5,17,11,2016
5,8,12,2016
1,14,2,2016
6,22,1,2016
7,5,11,2016
6,29,4,2016
7,7,5,2016
1,4,9,2016
3,19,1,2016
4,27,1,2016
2,11,1,2016
1,7,2,2016
3,16,2,2016
3,16,2,2016
6,16,12,2016
7,17,12,2016
4,24,2,2016
6,16,12,2016
7,17,12,2016
4,6,4,2016
3,12,1,2016
4,30,3,2016
7,17,12,2016
5,28,4,2016
2,1,8,2016
4,15,6,2016
3,2,2,2016
2,4,4,2016
3,4,10,2016
1,11,12,2016
5,13,10,2016
3,3,5,2016
4,7,12,2016
2,23,5,2016
6,11,11,2016
7,7,5,2016
2,15,8,2016
7,7,5,2016
6,23,12,2016
7,29,10,2016
2,6,6,2016
1,28,8,2016
2,29,8,2016
7,17,12,2016
6,12,2,2016
5,4,8,2016
7,9,4,2016
6,7,10,2016
7,6,2,2016
3,22,11,2016
1,3,4,2016
5,28,1,2016
6,30,9,2016
6,11,3,2016
5,24,3,2016
2,26,12,2016
7,19,11,2016
5,14,4,2016
5,29,12,2016
6,12,8,2016
7,12,11,2016
7,19,3,2016
7,23,7,2016
5,10,11,2016
7,2,7,2016
1,12,6,2016
5,7,1,2016
4,3,2,2016
6,25,3,2016
7,23,1,2016
2,4,1,2016
7,19,11,2016
1,28,2,2016
2,21,11,2016
7,17,12,2016
2,7,3,2016
3,19,7,2016
7,30,1,2016
2,28,11,2016
5,20,10,2016
1,15,5,2016
5,7,7,2016
7,24,12,2016
6,1,1,2016
7,17,12,2016
1,13,3,2016
5,23,6,2016
6,11,3,2016
1,10,7,2016
3,27,9,2016
1,4,9,2016
3,8,11,2016
2,30,5,2016
4,3,2,2016
1,17,1,2016
1,2,10,2016
2,14,11,2016
4,20,1,2016
6,15,4,2016
2,17,10,2016
2,14,3,2016
3,9,2,2016
6,25,3,2016
6,8,1,2016
2,7,3,2016
6,22,4,2016
3,3,5,2016
7,3,9,2016
4,17,2,2016
3,9,8,2016
4,27,4,2016
4,10,2,2016
2,21,11,2016
3,2,8,2016
7,24,12,2016
4,27,7,2016
3,16,8,2016
4,10,2,2016
6,1,7,2016
7,14,5,2016
4,3,2,2016
5,26,5,2016
7,10,12,2016
3,19,1,2016
4,2,3,2016
5,11,8,2016
1,18,9,2016
1,18,9,2016
2,8,2,2016
6,8,1,2016
7,21,5,2016
3,22,3,2016
6,20,5,2016
1,3,7,2016
7,26,11,2016
7,9,7,2016
4,9,3,2016
6,19,2,2016
6,4,3,2016
5,27,10,2016
7,5,3,2016
6,26,8,2016
3,12,1,2016
2,15,2,2016
6,1,4,2016
2,15,2,2016
7,18,6,2016
6,22,1,2016
4,4,5,2016
1,10,4,2016
5,24,3,2016
4,16,3,2016
7,9,4,2016
6,10,6,2016
7,25,6,2016
1,10,7,2016
1,17,7,2016
6,22,4,2016
5,15,9,2016
5,12,5,2016
1,15,5,2016
3,26,7,2016
7,17,12,2016
7,3,9,2016
6,1,4,2016
4,19,10,2016
7,8,10,2016
1,29,5,2016
2,15,2,2016
2,15,2,2016
7,10,9,2016
2,6,6,2016
6,12,2,2016
2,28,3,2016
3,11,10,2016
1,20,11,2016
7,9,1,2016
5,11,8,2016
1,18,12,2016
1,21,2,2016
7,16,1,2016
3,27,12,2016
6,27,5,2016
7,28,5,2016
1,17,4,2016
5,17,11,2016
5,17,3,2016
1,26,6,2016
2,26,9,2016
1,11,9,2016
3,29,11,2016
5,15,12,2016
7,15,10,2016
5,6,10,2016
1,2,10,2016
5,1,12,2016
5,17,3,2016
6,10,6,2016
4,17,2,2016
7,28,5,2016
2,5,12,2016
3,29,3,2016
2,12,9,2016
4,30,3,2016
7,2,4,2016
7,25,6,2016
6,6,5,2016
1,20,11,2016
1,12,6,2016
6,9,9,2016
7,10,12,2016
2,4,4,2016
3,18,10,2016
3,10,5,2016
2,11,1,2016
2,22,8,2016
1,7,8,2016
3,22,11,2016
3,31,5,2016
7,20,2,2016
7,29,10,2016
1,14,8,2016
1,21,8,2016
1,21,8,2016
6,8,7,2016
7,26,3,2016
5,14,7,2016
2,4,7,2016
3,4,10,2016
7,26,11,2016
6,25,11,2016
3,6,9,2016
3,26,7,2016
5,24,3,2016
5,26,5,2016
5,1,9,2016
5,7,7,2016
1,23,10,2016
7,9,1,2016
6,30,9,2016
6,19,2,2016
1,7,8,2016
3,17,5,2016
1,3,1,2016
2,25
Query:
-- 13. Mapping between "atmospheric_conditions_1" and "atmospheric_conditions_1_name".
SELECT "atmospheric_conditions_1", "atmospheric_conditions_1_name"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
LIMIT 1000
Answer:
Too long, hard cut:
atmospheric_conditions_1,atmospheric_conditions_1_name
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
6,Severe Crosswinds
6,Severe Crosswinds
6,Severe Crosswinds
6,Severe Crosswinds
6,Severe Crosswinds
6,Severe Crosswinds
6,Severe Crosswinds
6,Severe Crosswinds
8,Other
8,Other
8,Other
7,"Blowing Sand, Soil, Dirt"
11,Blowing Snow
12,Freezing Rain or Drizzle
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
6,Severe Crosswinds
6,Severe Crosswinds
6,Severe Crosswinds
6,Severe Crosswinds
7,"Blowing Sand, Soil, Dirt"
8,Other
8,Other
8,Other
12,Freezing Rain or Drizzle
12,Freezing Rain or Drizzle
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
6,Severe Crosswinds
6,Severe Crosswinds
6,Severe Crosswinds
6,Severe Crosswinds
6,Severe Crosswinds
8,Other
8,Other
8,Other
8,Other
11,Blowing Snow
12,Freezing Rain or Drizzle
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
6,Severe Crosswinds
99,Unknown
3,"Sleet, Hail"
3,"Sleet, Hail"
6,Severe Crosswinds
8,Other
8,Other
12,Freezing Rain or Drizzle
12,Freezing Rain or Drizzle
99,Unknown
99,Unknown
99,Unknown
6,Severe Crosswinds
8,Other
3,"Sleet, Hail"
3,"Sleet, Hail"
6,Severe Crosswinds
6,Severe Crosswinds
7,"Blowing Sand, Soil, Dirt"
8,Other
12,Freezing Rain or Drizzle
99,Unknown
99,Unknown
99,Unknown
99,Unknown
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
99,Unknown
8,Other
99,Unknown
99,Unknown
12,Freezing Rain or Drizzle
99,Unknown
3,"Sleet, Hail"
8,Other
12,Freezing Rain or Drizzle
99,Unknown
99,Unknown
3,"Sleet, Hail"
12,Freezing Rain or Drizzle
99,Unknown
99,Unknown
99,Unknown
3,"Sleet, Hail"
8,Other
99,Unknown
8,Other
7,"Blowing Sand, Soil, Dirt"
6,Severe Crosswinds
7,"Blowing Sand, Soil, Dirt"
7,"Blowing Sand, Soil, Dirt"
7,"Blowing Sand, Soil, Dirt"
8,Other
3,"Sleet, Hail"
3,"Sleet, Hail"
6,Severe Crosswinds
6,Severe Crosswinds
8,Other
6,Severe Crosswinds
7,"Blowing Sand, Soil, Dirt"
7,"Blowing Sand, Soil, Dirt"
99,Unknown
99,Unknown
3,"Sleet, Hail"
3,"Sleet, Hail"
7,"Blowing Sand, Soil, Dirt"
11,Blowing Snow
7,"Blowing Sand, Soil, Dirt"
11,Blowing Snow
3,"Sleet, Hail"
7,"Blowing Sand, Soil, Dirt"
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
11,Blowing Snow
3,"Sleet, Hail"
3,"Sleet, Hail"
6,Severe Crosswinds
11,Blowing Snow
11,Blowing Snow
99,Unknown
12,Freezing Rain or Drizzle
6,Severe Crosswinds
12,Freezing Rain or Drizzle
3,"Sleet, Hail"
99,Unknown
3,"Sleet, Hail"
11,Blowing Snow
8,Other
8,Other
8,Other
3,"Sleet, Hail"
6,Severe Crosswinds
6,Severe Crosswinds
8,Other
3,"Sleet, Hail"
6,Severe Crosswinds
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
8,Other
3,"Sleet, Hail"
3,"Sleet, Hail"
3,"Sleet, Hail"
6,Severe Crosswinds
6,Severe Crosswinds
6,Severe Crosswinds
7,"Blowing Sand, Soil, Dirt"
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
12,Freezing Rain or Drizzle
8,Other
99,Unknown
99,Unknown
99,Unknown
99,Unknown
3,"Sleet, Hail"
99,Unknown
11,Blowing Snow
99,Unknown
7,"Blowing Sand, Soil, Dirt"
3,"Sleet, Hail"
7,"Blowing Sand, Soil, Dirt"
6,Severe Crosswinds
6,Severe Crosswinds
8,Other
8,Other
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
3,"Sleet, Hail"
3,"Sleet, Hail"
11,Blowing Snow
99,Unknown
3,"Sleet, Hail"
99,Unknown
3,"Sleet, Hail"
3,"Sleet, Hail"
6,Severe Crosswinds
8,Other
99,Unknown
99,Unknown
99,Unknown
99,Unknown
7,"Blowing Sand, Soil, Dirt"
8,Other
8,Other
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
3,"Sleet, Hail"
7,"Blowing Sand, Soil, Dirt"
7,"Blowing Sand, Soil, Dirt"
8,Other
8,Other
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
6,Severe Crosswinds
3,"Sleet, Hail"
8,Other
99,Unknown
99,Unknown
8,Other
8,Other
99,Unknown
8,Other
8,Other
8,Other
8,Other
8,Other
12,Freezing Rain or Drizzle
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
8,Other
99,Unknown
7,"Blowing Sand, Soil, Dirt"
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
8,Other
12,Freezing Rain or Drizzle
3,"Sleet, Hail"
99,Unknown
7,"Blowing Sand, Soil, Dirt"
3,"Sleet, Hail"
6,Severe Crosswinds
99,Unknown
8,Other
8,Other
99,Unknown
3,"Sleet, Hail"
3,"Sleet, Hail"
6,Severe Crosswinds
6,Severe Crosswinds
8,Other
99,Unknown
99,Unknown
6,Severe Crosswinds
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
12,Freezing Rain or Drizzle
99,Unknown
99,Unknown
99,Unknown
99,Unknown
99,Unknown
3,"Sleet, H
Query:
-- 14. Count of weekend accidents by weather condition.
SELECT "atmospheric_conditions_1_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7)
GROUP BY "atmospheric_conditions_1_name"
LIMIT 1000
Answer:
atmospheric_conditions_1_name,num_accidents
"Sleet, Hail",23
Severe Crosswinds,15
Other,13
Unknown,56
Blowing Snow,4
Freezing Rain or Drizzle,6
"Blowing Sand, Soil, Dirt",4
Clear,8411
Rain,672
Snow,109
Not Reported,489
"Fog, Smog, Smoke",102
Cloudy,1608
Query:
-- 15. Count of weekend accidents per "state_name" with 'Rain' weather.
SELECT "state_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7) AND "atmospheric_conditions_1_name" = 'Rain'
GROUP BY "state_name"
LIMIT 1000
Answer:
state_name,num_accidents
Alabama,26
Arizona,6
Arkansas,11
Florida,49
Illinois,17
Mississippi,12
North Carolina,33
South Carolina,18
Texas,68
Washington,24
Kansas,5
California,55
Louisiana,14
Maryland,10
Ohio,19
Virginia,18
Alaska,5
Delaware,2
Michigan,21
Nevada,2
Montana,3
Missouri,8
New Hampshire,1
New Mexico,3
Massachusetts,9
Tennessee,29
Minnesota,6
Connecticut,2
Hawaii,5
Indiana,20
Kentucky,27
New York,23
West Virginia,9
Georgia,25
Pennsylvania,19
Oklahoma,12
Idaho,2
Utah,3
Iowa,4
Maine,4
New Jersey,14
Oregon,16
Wyoming,2
Wisconsin,4
Nebraska,5
Colorado,2
Query:
-- 16. Count of weekend accidents per "state_name" with 'Clear' weather.
SELECT "state_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7) AND "atmospheric_conditions_1_name" = 'Clear'
GROUP BY "state_name"
LIMIT 1000
Answer:
state_name,num_accidents
Indiana,170
North Carolina,328
North Dakota,31
Ohio,219
South Carolina,285
California,979
Louisiana,199
Arizona,226
Arkansas,116
Florida,799
Idaho,42
Illinois,326
Iowa,79
Kentucky,161
Maryland,127
Michigan,210
Oklahoma,131
Delaware,30
District of Columbia,7
Kansas,33
Missouri,218
Montana,38
New Hampshire,23
New Mexico,96
South Dakota,32
Tennessee,275
Minnesota,74
Nevada,81
Vermont,11
Hawaii,34
Massachusetts,81
Alabama,251
Colorado,16
Connecticut,80
Georgia,360
New York,196
Oregon,76
Pennsylvania,282
Texas,895
Rhode Island,8
Utah,52
Wyoming,23
Maine,36
New Jersey,158
Washington,113
Mississippi,170
Alaska,11
Nebraska,52
Wisconsin,121
West Virginia,50
Query:
-- 17. Weekend accidents with weather conditions other than 'Rain' or 'Clear'.
SELECT "state_name", "atmospheric_conditions_1_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7) AND "atmospheric_conditions_1_name" NOT IN ('Rain', 'Clear')
GROUP BY "state_name", "atmospheric_conditions_1_name"
LIMIT 1000
Answer:
state_name,atmospheric_conditions_1_name,num_accidents
Idaho,"Sleet, Hail",1
Maryland,"Sleet, Hail",2
Ohio,"Sleet, Hail",1
California,Severe Crosswinds,2
Kansas,Severe Crosswinds,4
New Mexico,Severe Crosswinds,1
Missouri,Other,2
New Mexico,Other,2
Arkansas,Unknown,2
Tennessee,"Sleet, Hail",6
North Carolina,Severe Crosswinds,2
Missouri,Unknown,2
Montana,Unknown,2
Oklahoma,Unknown,2
South Carolina,Blowing Snow,1
Iowa,Unknown,2
Virginia,"Sleet, Hail",1
Illinois,"Sleet, Hail",1
North Carolina,Freezing Rain or Drizzle,3
Tennessee,Unknown,6
Arkansas,Other,1
Texas,"Sleet, Hail",1
West Virginia,"Sleet, Hail",1
Arkansas,Severe Crosswinds,1
Kentucky,Severe Crosswinds,1
Indiana,"Sleet, Hail",1
Ohio,Unknown,1
Wisconsin,Severe Crosswinds,1
Kansas,Unknown,2
North Carolina,Other,1
Pennsylvania,Freezing Rain or Drizzle,1
West Virginia,Snow,1
New Mexico,Snow,4
Iowa,Snow,4
Missouri,"Fog, Smog, Smoke",5
New York,Cloudy,74
Arkansas,Cloudy,17
Georgia,Unknown,4
Washington,Unknown,3
California,Unknown,1
South Dakota,Blowing Snow,1
Minnesota,Blowing Snow,1
New York,"Sleet, Hail",1
Arizona,Unknown,5
Florida,Other,2
Colorado,Snow,1
Wisconsin,Snow,7
Alaska,Snow,2
Idaho,Snow,2
Oregon,"Fog, Smog, Smoke",4
Pennsylvania,"Fog, Smog, Smoke",6
North Carolina,"Fog, Smog, Smoke",1
Connecticut,"Fog, Smog, Smoke",1
California,Cloudy,164
West Virginia,Cloudy,7
Delaware,Cloudy,6
Kansas,Cloudy,1
Oklahoma,Not Reported,2
Montana,Cloudy,20
Oklahoma,Cloudy,58
Maine,Other,1
Indiana,Severe Crosswinds,1
Wisconsin,Unknown,5
Illinois,Unknown,3
Pennsylvania,"Sleet, Hail",2
Iowa,"Blowing Sand, Soil, Dirt",3
Kentucky,"Blowing Sand, Soil, Dirt",1
New Jersey,Freezing Rain or Drizzle,1
Hawaii,Unknown,1
Minnesota,Unknown,1
Connecticut,Other,1
North Dakota,Unknown,1
North Carolina,"Sleet, Hail",1
Minnesota,Snow,1
Indiana,"Fog, Smog, Smoke",4
California,"Fog, Smog, Smoke",7
New York,"Fog, Smog, Smoke",2
Georgia,Cloudy,77
South Dakota,Cloudy,1
South Carolina,Not Reported,3
Utah,Severe Crosswinds,1
Indiana,Freezing Rain or Drizzle,1
Pennsylvania,Other,2
Maryland,Other,1
Massachusetts,Unknown,1
District of Columbia,Unknown,1
Michigan,"Sleet, Hail",1
Michigan,Unknown,4
Michigan,Snow,23
New York,Snow,6
Utah,Snow,4
Missouri,Snow,2
Ohio,Snow,8
Illinois,Snow,8
New Hampshire,Snow,1
Oklahoma,Snow,1
Maine,Snow,1
Florida,"Fog, Smog, Smoke",8
Virginia,"Fog, Smog, Smoke",5
Kentucky,"Fog, Smog, Smoke",2
Louisiana,"Fog, Smog, Smoke",3
Massachusetts,"Fog, Smog, Smoke",2
Texas,"Fog, Smog, Smoke",10
New Mexico,"Fog, Smog, Smoke",1
Kansas,"Fog, Smog, Smoke",3
North Dakota,"Fog, Smog, Smoke",1
Ohio,Cloudy,98
Florida,Cloudy,143
Mississippi,Cloudy,29
Nebraska,Cloudy,11
Vermont,Cloudy,5
Massachusetts,Cloudy,21
Kansas,Not Reported,69
Massachusetts,Not Reported,1
Pennsylvania,Not Reported,9
Arizona,"Sleet, Hail",1
Montana,Snow,2
Pennsylvania,Snow,8
Washington,Snow,2
California,Snow,1
North Dakota,Snow,1
Nevada,Snow,1
Wisconsin,"Fog, Smog, Smoke",2
Iowa,"Fog, Smog, Smoke",2
Vermont,"Fog, Smog, Smoke",1
Michigan,"Fog, Smog, Smoke",3
Kentucky,Cloudy,42
Maine,Cloudy,6
Alabama,Cloudy,49
Alaska,Cloudy,5
Washington,Cloudy,26
New Mexico,Cloudy,2
Colorado,Not Reported,148
New Mexico,Not Reported,2
New Jersey,Not Reported,2
Washington,Not Reported,2
Maryland,Cloudy,14
Rhode Island,Cloudy,1
Oregon,Snow,2
South Dakota,Snow,1
New Jersey,Snow,1
Massachusetts,Snow,1
Idaho,Cloudy,14
Oregon,"Sleet, Hail",1
Utah,Unknown,2
Connecticut,Blowing Snow,1
Texas,Severe Crosswinds,1
Wyoming,Snow,4
Virginia,Snow,3
Kansas,Snow,1
Kentucky,Snow,1
Minnesota,"Fog, Smog, Smoke",2
Arkansas,"Fog, Smog, Smoke",3
Illinois,"Fog, Smog, Smoke",7
South Carolina,"Fog, Smog, Smoke",1
Mississippi,"Fog, Smog, Smoke",2
Nebraska,"Fog, Smog, Smoke",1
Maryland,"Fog, Smog, Smoke",2
Indiana,Cloudy,44
Arizona,Cloudy,22
Michigan,Cloudy,59
Missouri,Cloudy,50
Texas,Cloudy,224
Tennessee,Cloudy,25
Iowa,Cloudy,21
North Dakota,Cloudy,5
Connecticut,Cloudy,5
Oregon,Not Reported,4
Florida,Not Reported,1
Louisiana,Unknown,1
Kansas,"Sleet, Hail",1
Alabama,Unknown,1
Indiana,Snow,3
Maryland,Snow,1
Alabama,"Fog, Smog, Smoke",2
New Hampshire,"Fog, Smog, Smoke",1
Arizona,"Fog, Smog, Smoke",1
New Jersey,"Fog, Smog, Smoke",6
Rhode Island,"Fog, Smog, Smoke",1
New Hampshire,Cloudy,8
Utah,Cloudy,16
Wisconsin,Cloudy,52
South Carolina,Cloudy,17
Nevada,Cloudy,14
Hawaii,Cloudy,4
New Jersey,Cloudy,5
Colorado,Cloudy,1
Virginia,Not Reported,222
Arizona,Not Reported,12
Ohio,Not Reported,1
Maryland,Not Reported,8
Georgia,Not Reported,1
New York,Not Reported,1
Illinois,Cloudy,6
California,Not Reported,1
Texas,Unknown,3
Minnesota,Cloudy,24
North Carolina,Cloudy,56
Louisiana,Cloudy,27
Oregon,Cloudy,32
Query:
-- 18. Total weekend accidents per "state_name" regardless of weather.
SELECT "state_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7)
GROUP BY "state_name"
LIMIT 1000
Answer:
state_name,num_accidents
Idaho,61
Maryland,165
Ohio,347
California,1210
Kansas,119
Maine,48
Missouri,287
Arkansas,151
Georgia,467
North Carolina,425
Montana,65
Oklahoma,206
Washington,170
Wisconsin,192
South Carolina,325
Iowa,115
Virginia,249
South Dakota,35
Arizona,273
North Dakota,39
District of Columbia,8
Michigan,321
Delaware,38
New Mexico,111
Tennessee,341
Illinois,368
Minnesota,109
New Hampshire,34
Vermont,17
Hawaii,44
Nevada,98
Massachusetts,116
Indiana,244
Texas,1202
West Virginia,68
Pennsylvania,329
Kentucky,235
New York,303
Florida,1002
Rhode Island,10
Utah,78
Connecticut,90
Wyoming,29
Louisiana,244
New Jersey,187
Oregon,135
Alabama,329
Mississippi,213
Alaska,23
Colorado,168
Nebraska,69
Query:
-- 19. Count of accidents per "day_of_week" and weather condition.
SELECT "day_of_week", "atmospheric_conditions_1_name", COUNT(*) AS "num_accidents"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
GROUP BY "day_of_week", "atmospheric_conditions_1_name"
LIMIT 1000
Answer:
day_of_week,atmospheric_conditions_1_name,num_accidents
7,"Sleet, Hail",14
6,"Sleet, Hail",13
4,Severe Crosswinds,9
6,Severe Crosswinds,9
1,Severe Crosswinds,7
5,Severe Crosswinds,4
7,Other,10
1,Other,3
2,"Blowing Sand, Soil, Dirt",6
3,Blowing Snow,1
6,Freezing Rain or Drizzle,2
1,Unknown,25
2,Unknown,21
4,"Sleet, Hail",8
1,"Sleet, Hail",9
2,Severe Crosswinds,3
5,Other,7
2,Other,4
5,Freezing Rain or Drizzle,4
3,Freezing Rain or Drizzle,3
7,Unknown,31
6,Unknown,19
7,Freezing Rain or Drizzle,4
3,"Blowing Sand, Soil, Dirt",5
4,Blowing Snow,1
1,Blowing Snow,2
3,Severe Crosswinds,2
6,"Blowing Sand, Soil, Dirt",2
4,"Blowing Sand, Soil, Dirt",2
1,Freezing Rain or Drizzle,2
4,Freezing Rain or Drizzle,1
7,"Blowing Sand, Soil, Dirt",4
5,Blowing Snow,2
5,"Blowing Sand, Soil, Dirt",1
6,Rain,340
7,Rain,362
1,Rain,310
3,Snow,38
5,Snow,52
7,"Fog, Smog, Smoke",58
4,"Fog, Smog, Smoke",40
3,"Fog, Smog, Smoke",55
1,"Fog, Smog, Smoke",44
2,Cloudy,709
5,Cloudy,735
4,Cloudy,663
5,Not Reported,218
4,Not Reported,205
3,Unknown,21
2,"Sleet, Hail",11
6,Other,15
7,Blowing Snow,2
5,Unknown,17
4,Other,4
7,Severe Crosswinds,8
4,Unknown,12
3,Other,5
3,"Sleet, Hail",5
2,Freezing Rain or Drizzle,1
5,"Sleet, Hail",5
6,Blowing Snow,2
1,Clear,3910
7,Clear,4501
3,Clear,3008
6,Clear,3806
5,Clear,3318
4,Clear,3195
5,Rain,313
3,Rain,240
4,Rain,259
2,Snow,36
6,Snow,53
4,Snow,40
6,"Fog, Smog, Smoke",58
2,"Fog, Smog, Smoke",44
6,Cloudy,823
5,"Fog, Smog, Smoke",30
6,Not Reported,255
1,Not Reported,227
3,Not Reported,186
2,Clear,3218
2,Rain,283
1,Snow,48
7,Snow,61
7,Cloudy,842
1,Cloudy,766
3,Cloudy,588
2,Not Reported,201
7,Not Reported,262
End Exploring Related Columns
Task: Which top 3 states had the largest differences in the number of traffic accidents between rainy and clear weather during weekends in 2016? Please also provide the respective differences for each state.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To determine the top 3 states with the largest differences in the number of traffic accidents between rainy and clear weather during weekends in 2016, we need to analyze the `ACCIDENT_2016` table. The process involves the following steps:

1. **Filter for Weekends**: Select records where `day_of_week` is **1** (Sunday) or **7** (Saturday).
2. **Identify Weather Conditions**: Use the `atmospheric_conditions_1_name` column to filter accidents that occurred under 'Rain' and 'Clear' weather conditions.
3. **Count Accidents per State**:
   - For each state, count the number of accidents during weekends under 'Rain' conditions.
   - For each state, count the number of accidents during weekends under 'Clear' conditions.
4. **Calculate Differences**: Compute the absolute difference between the two counts for each state.
5. **Select Top 3 States**: Identify the top three states with the largest differences.

**Expected Output Format:**

```csv
State_name,Difference
state_name1:str,difference1:int
state_name2:str,difference2:int
state_name3:str,difference3:int
```

**Explanation:**

- **State_name**: The name of the state (e.g., 'Texas').
- **Difference**: The absolute difference in the number of traffic accidents between rainy and clear weather during weekends in 2016 for that state.

*Note: Specific data values are not provided as the actual data is unavailable.*.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'NHTSA_TRAFFIC_FATALITIES': {'NHTSA_TRAFFIC_FATALITIES': ['ACCIDENT_2015', 'ACCIDENT_2016', 'ACCIDENT_2017', 'ACCIDENT_2018', 'ACCIDENT_2019', 'ACCIDENT_2020', 'CEVENT_2015', 'CEVENT_2016', 'CEVENT_2017', 'CEVENT_2018', 'CEVENT_2019', 'CEVENT_2020', 'DAMAGE_2015', 'DAMAGE_2016', 'DAMAGE_2017', 'DAMAGE_2018', 'DAMAGE_2019', 'DAMAGE_2020', 'DISTRACT_2015', 'DISTRACT_2016', 'DISTRACT_2017', 'DISTRACT_2018', 'DISTRACT_2019', 'DISTRACT_2020', 'DRIMPAIR_2015', 'DRIMPAIR_2016', 'DRIMPAIR_2017', 'DRIMPAIR_2018', 'DRIMPAIR_2019', 'DRIMPAIR_2020', 'FACTOR_2015', 'FACTOR_2016', 'FACTOR_2017', 'FACTOR_2018', 'FACTOR_2019', 'FACTOR_2020', 'MANEUVER_2015', 'MANEUVER_2016', 'MANEUVER_2017', 'MANEUVER_2018', 'MANEUVER_2019', 'MANEUVER_2020', 'NMCRASH_2015', 'NMCRASH_2016', 'NMCRASH_2017', 'NMCRASH_2018', 'NMCRASH_2019', 'NMCRASH_2020', 'NMIMPAIR_2015', 'NMIMPAIR_2016', 'NMIMPAIR_2017', 'NMIMPAIR_2018', 'NMIMPAIR_2019', 'NMIMPAIR_2020', 'NMPRIOR_2015', 'NMPRIOR_2016', 'NMPRIOR_2017', 'NMPRIOR_2018', 'NMPRIOR_2019', 'NMPRIOR_2020', 'PARKWORK_2015', 'PARKWORK_2016', 'PARKWORK_2017', 'PARKWORK_2018', 'PARKWORK_2019', 'PARKWORK_2020', 'PBTYPE_2015', 'PBTYPE_2016', 'PBTYPE_2017', 'PBTYPE_2018', 'PBTYPE_2019', 'PBTYPE_2020', 'PERSON_2015', 'PERSON_2016', 'SAFETYEQ_2015', 'SAFETYEQ_2016', 'SAFETYEQ_2017', 'SAFETYEQ_2018', 'SAFETYEQ_2019', 'SAFETYEQ_2020', 'VEHICLE_2015', 'VEHICLE_2016', 'VEVENT_2015', 'VEVENT_2016', 'VEVENT_2017', 'VEVENT_2018', 'VEVENT_2019', 'VEVENT_2020', 'VINDECODE_2015', 'VINDECODE_2016', 'VIOLATN_2015', 'VIOLATN_2016', 'VIOLATN_2017', 'VIOLATN_2018', 'VIOLATN_2019', 'VIOLATN_2020', 'VISION_2015', 'VISION_2016', 'VISION_2017', 'VISION_2018', 'VISION_2019', 'VISION_2020', 'VSOE_2015', 'VSOE_2016', 'VSOE_2017', 'VSOE_2018', 'VSOE_2019', 'VSOE_2020']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-20 13:05:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 13:05:33 - root - INFO - ```sql
SELECT
    "state_name",
    ABS(
        SUM(CASE WHEN "atmospheric_conditions_1_name" = 'Rain' THEN 1 ELSE 0 END) -
        SUM(CASE WHEN "atmospheric_conditions_1_name" = 'Clear' THEN 1 ELSE 0 END)
    ) AS "Difference"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7)
  AND "atmospheric_conditions_1_name" IN ('Rain', 'Clear')
GROUP BY "state_name"
ORDER BY "Difference" DESC NULLS LAST
LIMIT 3;
```
2025-01-20 13:05:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:05:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:05:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:05:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-20 13:05:35 - snowflake.connector.connection - INFO - closed
2025-01-20 13:05:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:05:35 - root - INFO - itercount: 1
2025-01-20 13:05:35 - root - INFO - 0
2025-01-20 13:05:35 - root - INFO - results: 
state_name,Difference
California,924
Texas,827
Florida,750


2025-01-20 13:05:35 - root - INFO - Please check the answer again by reviewing Which top 3 states had the largest differences in the number of traffic accidents between rainy and clear weather during weekends in 2016? Please also provide the respective differences for each state., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To determine the top 3 states with the largest differences in the number of traffic accidents between rainy and clear weather during weekends in 2016, we need to analyze the `ACCIDENT_2016` table. The process involves the following steps:

1. **Filter for Weekends**: Select records where `day_of_week` is **1** (Sunday) or **7** (Saturday).
2. **Identify Weather Conditions**: Use the `atmospheric_conditions_1_name` column to filter accidents that occurred under 'Rain' and 'Clear' weather conditions.
3. **Count Accidents per State**:
   - For each state, count the number of accidents during weekends under 'Rain' conditions.
   - For each state, count the number of accidents during weekends under 'Clear' conditions.
4. **Calculate Differences**: Compute the absolute difference between the two counts for each state.
5. **Select Top 3 States**: Identify the top three states with the largest differences.

**Expected Output Format:**

```csv
State_name,Difference
state_name1:str,difference1:int
state_name2:str,difference2:int
state_name3:str,difference3:int
```

**Explanation:**

- **State_name**: The name of the state (e.g., 'Texas').
- **Difference**: The absolute difference in the number of traffic accidents between rainy and clear weather during weekends in 2016 for that state.

*Note: Specific data values are not provided as the actual data is unavailable.* The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
state_name,Difference
California,924
Texas,827
Florida,750
Current sql:
SELECT
    "state_name",
    ABS(
        SUM(CASE WHEN "atmospheric_conditions_1_name" = 'Rain' THEN 1 ELSE 0 END) -
        SUM(CASE WHEN "atmospheric_conditions_1_name" = 'Clear' THEN 1 ELSE 0 END)
    ) AS "Difference"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7)
  AND "atmospheric_conditions_1_name" IN ('Rain', 'Clear')
GROUP BY "state_name"
ORDER BY "Difference" DESC NULLS LAST
LIMIT 3;For day_of_week, 1=Sunday and 7=Saturday.

2025-01-20 13:06:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 13:06:01 - root - INFO - To determine the top 3 states with the largest differences in the number of traffic accidents between rainy and clear weather during weekends in 2016, we need to analyze the `ACCIDENT_2016` table. The process involves the following steps:

1. **Filter for Weekends**: Select records where `day_of_week` is **1** (Sunday) or **7** (Saturday).
2. **Identify Weather Conditions**: Use the `atmospheric_conditions_1_name` column to filter accidents that occurred under 'Rain' and 'Clear' weather conditions.
3. **Count Accidents per State**:
   - For each state, count the number of accidents during weekends under 'Rain' conditions.
   - For each state, count the number of accidents during weekends under 'Clear' conditions.
4. **Calculate Differences**: Compute the absolute difference between the two counts for each state.
5. **Select Top 3 States**: Identify the top three states with the largest differences.

**Expected Output Format:**

```csv
State_name,Difference
state_name1:str,difference1:int
state_name2:str,difference2:int
state_name3:str,difference3:int
```

**Explanation:**

- **State_name**: The name of the state (e.g., 'Texas').
- **Difference**: The absolute difference in the number of traffic accidents between rainy and clear weather during weekends in 2016 for that state.

*Note: Specific data values are not provided as the actual data is unavailable.*

**SQL Query:**

```sql
SELECT
    "state_name",
    ABS(
        SUM(CASE WHEN "atmospheric_conditions_1_name" = 'Rain' THEN 1 ELSE 0 END) -
        SUM(CASE WHEN "atmospheric_conditions_1_name" = 'Clear' THEN 1 ELSE 0 END)
    ) AS "Difference"
FROM NHTSA_TRAFFIC_FATALITIES.NHTSA_TRAFFIC_FATALITIES."ACCIDENT_2016"
WHERE "day_of_week" IN (1, 7)
  AND "atmospheric_conditions_1_name" IN ('Rain', 'Clear')
GROUP BY "state_name"
ORDER BY "Difference" DESC NULLS LAST
LIMIT 3;
```
2025-01-20 13:06:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:06:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:06:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:06:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-20 13:06:03 - snowflake.connector.connection - INFO - closed
2025-01-20 13:06:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:06:03 - root - INFO - itercount: 2
2025-01-20 13:06:03 - root - INFO - 0
2025-01-20 13:06:03 - root - INFO - Total iteration counts: 2
