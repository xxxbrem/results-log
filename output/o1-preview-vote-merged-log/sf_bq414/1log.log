2025-01-20 13:43:41 - openai._base_client - INFO - Retrying request to /chat/completions in 0.453547 seconds
2025-01-20 13:44:49 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 13:44:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:44:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:44:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:44:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-01-20 13:44:50 - snowflake.connector.connection - INFO - closed
2025-01-20 13:44:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:44:51 - root - INFO - SQL:
-- 1. Select distinct departments from the OBJECTS table.
SELECT DISTINCT "department"
FROM THE_MET.THE_MET."OBJECTS"
LIMIT 1000
Results:
department
Asian Art
Islamic Art
Photographs
Medieval Art
The Cloisters
The Libraries
Arms and Armor
Costume Institute
European Paintings
Drawings and Prints
Greek and Roman Art
Musical Instruments
Ancient Near Eastern Art
Robert Lehman Collection
Modern and Contemporary Art
American Paintings and Sculpture
"Arts of Africa, Oceania, and the Americas"
American Decorative Arts
European Sculpture and Decorative Arts
Egyptian Art

2025-01-20 13:44:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:44:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:44:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:44:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 13:44:53 - snowflake.connector.connection - INFO - closed
2025-01-20 13:44:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:44:53 - root - INFO - SQL:
-- 2. Select object IDs and titles where the title contains 'book'.
SELECT "object_id", "title"
FROM THE_MET.THE_MET."OBJECTS"
WHERE "title" ILIKE '%book%'
LIMIT 1000
Results:
Too long, hard cut:
object_id,title
39483,明     郭詡     稱書圖     軸|Weighing Books
39667,明     杜堇     伏生授經圖   軸|The Scholar Fu Sheng Transmitting the Book of Documents
57754,画本宝能縷|Picture Book of Brocades with Precious Threads (Ehon takara no itosuji)
78593,絵本松のしらべ|Picture Book on the Music of the Pine Trees (Ehon matsu no shirabe)
78688,『和国諸職絵尽　諸織 絵本鏡』|A Picture Book Mirror of Various Occupations (Wakoku shoshoku ezukushi)
53815,Ehon Asakayama|絵本浅香山|Picture Book: Mount Asaka (Ehon Asakayama)
45062,"絵本末摘花|Picture Book: Flowers Yet to be Picked, Vol. 1"
57842,Ehon Ogurayama|絵本小倉山|Picture Book: Ogura Hill (Ehon Ogurayama)
57858,Ehon Himetsubaki|繪本女貞木|Picture Book: Camellia (Ehon Himetsubaki)
78723,『繪本常盤草』|Picture Book of the Evergreens (Ehon tokiwagusa)
78728,『繪本小倉山』|Picture Book of Ogura Hill (Ehon ogurayama)
78729,『繪本小松原』|Picture Book of Komatsubara (Ehon komatsubara)
78722,絵本常盤草　上・中・下|Picture Book of the Evergreens (Ehon tokiwagusa)
78585,『寫山樓畫本』|Shazanrō (Bunchō) Picture Book (Shazanrō ehon)
78739,『絵本時世粧』|Picture Book of Modern Figures of Fashion (Ehon imayō sugata)
78597,艶本 婦慈のゆき|An Erotic Picture Book of Snow on Fuji (Enpon fuji no yuki)
45273,絵本吾妻遊|Ehon Azuma asobi|Picture Book of Amusements of the Eastern Capital (Ehon Azuma asobi)
57568,Ehon Momochidori Kyōka-awase|百千鳥狂歌合|Myriad Birds: Picture Book of Playful Verse (Momo chidori kyōka-awase)
57605,絵本和歌夷 「龢謌夷」|Picture Book with Playful Poems for the Young God Ebisu
57648,潮干のつと|Gifts from the Ebb Tide (The Shell Book) (Shiohi no tsuto)
57569,画本虫撰|Picture Book of Crawling Creatures (The Insect Book) (Ehon mushi erami)
57570,画本虫撰|Picture Book of Crawling Creatures (The Insect Book) (Ehon mushi erami)
45322,繪本四季花|Picture Book of Flowers of the Four Seasons (Ehon shiki no hana)
78746,『青楼繪本年中行事』|Yoshiwara Picture Book of New Year’s Festivities (Seirō ehon nenjū gyōji)
78758,（榎木新右衛門）画 『雛形伊勢乃海』|Book of Kosode Patterns (Hiinagata Ise no umi)
45444,Ehon Musashi no Abumi|A Picture Book of Japanese Warriors
78635,『画本狂歌山満多山』|Picture Book of Kyōka Poems: Mountains upon Mountains (Ehon kyōka yama mata yama)
78771,"繪本彩色通　初編|Picture Book on the Use of Coloring, first volume (Ehon saishikitsū shohen)"
78772,『絵本和漢誉』|Picture Book on Heroes of China and Japan (Ehon wakan no homare)
78667,『暁斎漫画』|Kyōsai Sketchbook (Kyōsai manga)
55597,"『閨の雛形』　正月|Plate from the Erotic Book Mounds of Dyed Colors: A Pattern Book for the Boudoir (Someiro no yama neya no hinagata), First Month"
37283,"『画本虫撰』  「蜂」「毛虫」|Paper Wasp (Hachi); Hairy Caterpillar (Kemushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37284,"『画本虫撰』   「馬追虫」「むかて」|Katydid (Umaoi-mushi); Centipede, (Mukade), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37285,"『画本虫撰』   「けら」「はさみむし」|Mole Cricket (Kera); Earwig, (Hasami-mushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37286,"『画本虫撰』   「蝶」「蜻蛉」|Butterfly (Chō); Dragonfly (Kagerō or Tonbo), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37287,"『画本虫撰』  「虻」「芋虫」|Horsefly (abu); Green Caterpillar, imomushi, from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37288,"『画本虫撰』   「松虫」「虫蛍」|Tree cricket (Matsumushi); Firefly (Hotaru), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37289,"画本虫撰　バッタと蟷螂|Cone-headed Grasshopper or Locust, (batta); Praying Mantis (Tōrō or Kamakiri), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37290,"『画本虫撰』 「ひくらし」「くも」|Evening Cicada, Higurashi; Spider, Kumo, from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37291,"『画本虫撰』「赤蜻蛉」「いなこ」|Red Dragonfly (Akatonbo); Locust (Inago), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37292,"『画本虫撰』「虵」「とかけ」|Rat Snake (Hebi); Lizard or Skink (Tokage), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37293,"『画本虫撰』「蓑虫」「兜虫」|Bagworm (Minomushi); Horned Scarab Beetle (Kabutomushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37294,"『画本虫撰』「蝸牛」「轡虫」|Land Snail (Katatsumuri); Giant Katydid (Kutsuwamushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37295,"『画本虫撰』「きりきりす」「蝉」|Grasshopper (Kirigirisu); Cicada (Semi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37296,"『画本虫撰』「蚓」「こうろき」|Earthworm (Mimizu); Cricket (Kōrogi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37306,"四季の花|The Coming Thunderstorm, from the illustrated book Flowers of the Four Seasons"
37307,"四季の花|Women on a Bridge, from the illustrated book Flowers of the Four Seasons"
37308,"四季の花|A Child Lighting Fireworks, from the illustrated book Flowers of the Four Seasons"
37309,"四季の花|Girls Getting on Board a Boat, from the illustrated book Flowers of the Four Seasons"
37310,"四季の花|Girls Picking Green Leaves, from the illustrated book Flowers of the Four Seasons"
37311,"四季の花|New Year's Games, from the printed book Flowers of the Four Seasons (Shiki no hana)"
37312,"四季の花|Girls Entertained by Performers, from the illustrated book Flowers of the Four Seasons"
37313,"四季の花

2025-01-20 13:44:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:44:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:44:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:44:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 120
2025-01-20 13:44:54 - snowflake.connector.connection - INFO - closed
2025-01-20 13:44:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:44:55 - root - INFO - SQL:
-- 3. Select object IDs and metadata dates from OBJECTS where department is 'The Libraries'.
SELECT "object_id", "metadata_date"
FROM THE_MET.THE_MET."OBJECTS"
WHERE "department" = 'The Libraries'
LIMIT 1000
Results:
object_id,metadata_date
682011,1486368016000000
681546,1486368016000000
681534,1486368016000000
681389,1486368016000000
591832,1486368016000000
591860,1486368016000000
591831,1486368016000000
591865,1486368016000000
591848,1486368016000000
591863,1486368016000000
681573,1486368016000000
682013,1486368016000000
681149,1486368016000000
681556,1486368016000000
681388,1486368016000000
680835,1486368016000000
681547,1486368016000000
681545,1486368016000000
682014,1486368016000000
681128,1486368016000000
682012,1486368016000000
681563,1486368016000000
716648,1486368016000000
705290,1486368016000000
715005,1486368016000000
739504,1486368016000000
726677,1486368016000000
716639,1486368016000000
699505,1486368016000000
697348,1486368016000000
681349,1486368016000000
591837,1486368016000000
591862,1486368016000000
591836,1486368016000000
700238,1486368016000000
738466,1486368016000000
700032,1486368016000000
700050,1486368016000000
738463,1486368016000000
704714,1486368016000000
700240,1486368016000000
738758,1486368016000000
700232,1486368016000000
700091,1486368016000000
738765,1486368016000000
682010,1486368016000000
681259,1486368016000000
726717,1486368016000000
707455,1486368016000000
726673,1486368016000000
726669,1486368016000000
681246,1486368016000000
679732,1486368016000000
726678,1486368016000000
591835,1486368016000000
681559,1486368016000000
591839,1486368016000000
681502,1486368016000000
680708,1486368016000000
682015,1486368016000000
681386,1486368016000000
679476,1486368016000000
681551,1486368016000000
680818,1486368016000000
680752,1486368016000000
591844,1486368016000000
591849,1486368016000000
591830,1486368016000000
591824,1486368016000000
591834,1486368016000000
591854,1486368016000000
591840,1486368016000000
591864,1486368016000000
591841,1486368016000000
591855,1486368016000000
591842,1486368016000000
681372,1486368016000000
591845,1486368016000000
591847,1486368016000000
591829,1486368016000000
591828,1486368016000000
591825,1486368016000000
591827,1486368016000000
681554,1486368016000000
591857,1486368016000000
591850,1486368016000000
591852,1486368016000000
591853,1486368016000000
591859,1486368016000000
591858,1486368016000000
591861,1486368016000000
591843,1486368016000000
681357,1486368016000000
680832,1486368016000000
679629,1486368016000000
679465,1486368016000000
724625,1486368016000000
591826,1486368016000000
591838,1486368016000000
591833,1486368016000000
705638,1486368016000000
681274,1486368016000000
681504,1486368016000000
678732,1486368016000000
680821,1486368016000000
682098,1486368016000000
680318,1486368016000000
591856,1486368016000000
681384,1486368016000000
591851,1486368016000000
591846,1486368016000000
591868,1486368016000000
734108,1486368016000000
734109,1486368016000000
734110,1486368016000000
734111,1486368016000000
738516,1486368016000000
680819,1486368016000000
679638,1486368016000000
681269,1486368016000000

2025-01-20 13:44:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:44:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:44:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:44:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 13:44:56 - snowflake.connector.connection - INFO - closed
2025-01-20 13:44:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:44:56 - root - INFO - SQL:
-- 4. Select object IDs and departments where the title contains 'book'.
SELECT "object_id", "department"
FROM THE_MET.THE_MET."OBJECTS"
WHERE "title" ILIKE '%book%'
LIMIT 1000
Results:
Too long, hard cut:
object_id,department
39483,Asian Art
39667,Asian Art
57754,Asian Art
78593,Asian Art
78688,Asian Art
53815,Asian Art
45062,Asian Art
57842,Asian Art
57858,Asian Art
78723,Asian Art
78728,Asian Art
78729,Asian Art
78722,Asian Art
78585,Asian Art
78739,Asian Art
78597,Asian Art
45273,Asian Art
57568,Asian Art
57605,Asian Art
57648,Asian Art
57569,Asian Art
57570,Asian Art
45322,Asian Art
78746,Asian Art
78758,Asian Art
45444,Asian Art
78635,Asian Art
78771,Asian Art
78772,Asian Art
78667,Asian Art
55597,Asian Art
37283,Asian Art
37284,Asian Art
37285,Asian Art
37286,Asian Art
37287,Asian Art
37288,Asian Art
37289,Asian Art
37290,Asian Art
37291,Asian Art
37292,Asian Art
37293,Asian Art
37294,Asian Art
37295,Asian Art
37296,Asian Art
37306,Asian Art
37307,Asian Art
37308,Asian Art
37309,Asian Art
37310,Asian Art
37311,Asian Art
37312,Asian Art
37313,Asian Art
37297,Asian Art
54180,Asian Art
37147,Asian Art
55944,Asian Art
51996,Asian Art
56776,Asian Art
56777,Asian Art
57101,Asian Art
55596,Asian Art
50915,Asian Art
283195,Photographs
286128,Photographs
296355,Photographs
288310,Photographs
271512,Photographs
684347,Photographs
291811,Photographs
265780,Photographs
291817,Photographs
282767,Photographs
267551,Photographs
267566,Photographs
267777,Photographs
467415,Medieval Art
466677,Medieval Art
591860,The Libraries
700238,The Libraries
700232,The Libraries
591861,The Libraries
35148,Arms and Armor
437030,European Paintings
353372,Drawings and Prints
352518,Drawings and Prints
359185,Drawings and Prints
338275,Drawings and Prints
357159,Drawings and Prints
349141,Drawings and Prints
352787,Drawings and Prints
347880,Drawings and Prints
344959,Drawings and Prints
347878,Drawings and Prints
357281,Drawings and Prints
344334,Drawings and Prints
348387,Drawings and Prints
346441,Drawings and Prints
355064,Drawings and Prints
353133,Drawings and Prints
346498,Drawings and Prints
346493,Drawings and Prints
348343,Drawings and Prints
358573,Drawings and Prints
355046,Drawings and Prints
355616,Drawings and Prints
337788,Drawings and Prints
334159,Drawings and Prints
339135,Drawings and Prints
349013,Drawings and Prints
339888,Drawings and Prints
334265,Drawings and Prints
356961,Drawings and Prints
407165,Drawings and Prints
348912,Drawings and Prints
356036,Drawings and Prints
397628,Drawings and Prints
377013,Drawings and Prints
399255,Drawings and Prints
399270,Drawings and Prints
382949,Drawings and Prints
383021,Drawings and Prints
377455,Drawings and Prints
670577,Drawings and Prints
392587,Drawings and Prints
390160,Drawings and Prints
659683,Drawings and Prints
341445,Drawings and Prints
343597,Drawings and Prints
416896,Drawings and Prints
392954,Drawings and Prints
341455,Drawings and Prints
670559,Drawings and Prints
357597,Drawings and Prints
394223,Drawings and Prints
394224,Drawings and Prints
394225,Drawings and Prints
413962,Drawings and Prints
413981,Drawings and Prints
413931,Drawings and Prints
413961,Drawings and Prints
413980,Drawings and Prints
394665,Drawings and Prints
397456,Drawings and Prints
397461,Drawings and Prints
397463,Drawings and Prints
394050,Drawings and Prints
394049,Drawings and Prints
414091,Drawings and Prints
414086,Drawings and Prints
414087,Drawings and Prints
414088,Drawings and Prints
414089,Drawings and Prints
414090,Drawings and Prints
412622,Drawings and Prints
412643,Drawings and Prints
371685,Drawings and Prints
381807,Drawings and Prints
335709,Drawings and Prints
335708,Drawings and Prints
344023,Drawings and Prints
335331,Drawings and Prints
336891,Drawings and Prints
336880,Drawings and Prints
384117,Drawings and Prints
335817,Drawings and Prints
364054,Drawings and Prints
397985,Drawings and Prints
389361,Drawings and Prints
336710,Drawings and Prints
343431,Drawings and Prints
339774,Drawings and Prints
336604,Drawings and Prints
335706,Drawings and Prints
335720,Drawings and Prints
335719,Drawings and Prints
335705,Drawings and Prints
370936,Drawings and Prints
629783,Drawings and Prints
670019,Drawings and Prints
651010,Drawings and Prints
650913,Drawings and Prints
386345,Drawings and Prints
383882,Drawings and Prints
407351,Drawings and Prints
398772,Drawings and Prints
650984,Drawings and Prints
340595,Drawings and Prints
371142,Drawings and Prints
383466,Drawings and Prints
383467,Drawings and Prints
383460,Drawings and Prints
383457,Drawings and Prints
383458,Drawings and Prints
383459,Drawings and Prints
383456,Drawings and Prints
383455,Drawings and Prints
383451,Drawings and Prints
383290,Drawings and Prints
383453,Drawings and Prints
383464,Drawings and Prints
371141,Drawings and Prints
383509,Drawings and Prints
383508,Drawings and Prints
383507,Drawings and Prints
383506,Drawings and Prints
383470,Drawings and Prints
383469,Drawings and Prints
383468,Drawings and Prints
383462,Drawings and Prints
396210,Drawings and Prints
377016,Drawings and Prints
377018,Drawings and Prints
377019,Drawings and Prints
377017,Drawings and Prints
377020,Drawings 

2025-01-20 13:44:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:44:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:44:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:44:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 13:44:58 - snowflake.connector.connection - INFO - closed
2025-01-20 13:44:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:44:59 - root - INFO - SQL:
-- 5. Select object IDs from VISION_API_DATA where cropHintsAnnotation is not null.
SELECT "object_id"
FROM THE_MET.THE_MET."VISION_API_DATA"
WHERE "cropHintsAnnotation" IS NOT NULL
LIMIT 1000
Results:
Too long, hard cut:
object_id
395469
342852
717610
400806
398754
436661
650943
193649
308544
37881
371350
480520
469947
291865
391445
339498
342882
342608
352216
306752
271733
73626
372777
365590
10791
364281
365693
10928
387577
370771
37186
393209
337266
388957
394628
339515
414492
383921
410182
338422
369156
348596
678732
203203
340976
261016
410050
400836
467466
467935
409982
414746
334626
254207
4249
4199
4209
4241
435719
11603
56748
403635
340262
15089
685801
397498
472322
471962
460419
260285
726543
366993
55968
285781
544689
544693
394436
50799
345808
208998
189298
623053
391175
53926
435834
246992
322367
412823
387572
73555
339492
357054
414695
391517
392595
428774
10466
335405
371555
368343
261801
54624
394340
285465
54870
194110
428755
196160
15025
549533
263193
242193
343111
189551
465955
737547
363904
364069
54499
470282
288515
337263
45241
645240
416247
348790
339554
250968
206819
543873
471055
623067
471557
459205
12563
261590
198277
337168
506089
374026
36607
467941
341201
349127
437866
206049
242318
633310
10961
343310
252916
288159
205109
38481
55320
11842
193822
11408
348978
670559
395879
38646
55397
436190
207814
255899
367190
54819
470265
250655
206873
10970
459399
359089
11489
435709
53181
254915
406441
56602
103035
633569
11512
646609
242375
192720
385670
45493
288528
231788
207397
45494
204169
335536
469877
12707
54678
469719
403218
548343
436205
251493
358785
436912
205413
406435
205461
452121
428022
191486
39249
61627
11791
42724
436179
384063
261480
437363
369411
11175
343748
437425
441234
436522
11742
358365
81550
369805
200939
334871
436581
264366
682875
436583
11249
337062
11699
437678
437365
38335
38328
623036
45223
436423
261347
11112
338743
44799
41328
318990
448463
195644
13046
55716
333811
437325
436240
204109
436297
436877
389958
547751
408997
19232
13338
251799
338426
268330
437803
291844
189351
236189
291939
187146
200018
335751
414312
738805
291912
393587
735991
188886
51832
906
348997
418092
198199
291850
368857
736681
199327
246588
685841
291759
386402
203577
384069
209526
388394
369166
291945
632896
736576
203418
197997
187145
692328
377079
392753
671454
64852
73547
114731
195738
463772
15074
13784
203574
203576
471964
633372
398655
195317
388733
207157
207401
463889
467523
203221
468684
210006
436932
362159
199273
193974
392476
59963
342594
200901
194167
692345
203378
201735
436461
376604
436483
346326
195345
59964
191883
470146
198066
12959
59156
382486
55626
357710
291889
662899
737704
468692
468320
362191
337261
342593
393439
195341
285443
391816
37334
437060
463681
197214
530
250825
42492
32831
288611
464268
467939
196415
197075
342534
415389
468266
197053
189699
463824
194349
18958
659991
385068
385968
51771
401174
342535
268458
73515
392721
195118
385696
389031
461448
73406
380479
383686
435302
260112
417855
463397
645329
188884
344098
367042
349097
396160
336046
193343
227725
392843
51996
264597
467997
10966
438850
460166
364035
435621
76971
467594
458994
436987
435641
459046
10240
464588
38822
436951
54782
73443
206575
288154
399211
283160
366658
248730
291873
698512
57134
248580
459068
336871
446180
642926
452680
205315
254590
398594
106068
355542
271737
73417
338709
198644
435682
73474
10878
437539
437865
459090
436871
17187
436078
471918
436570
435868
13533
437181
391788
437062
726258
190635
37865
57091
73511
219476
209266
291879
386151
397749
267997
356888
291869
638762
73459
356494
45580
367347
285472
369299
361790
458981
357998
73625
366984
36687
453210
670999
55471
414398
52000
38304
626352
471840
282051
248139
436907
246592
11417
437578
337399
436687
459129
438848
466799
459202
337327
368033
428633
437927
54834
453107
400424
260178
645094
396200
260114
205194
647645
55443
736722
349033
362018
469891
261383
428328
384809
387496
54581
16496
264575
383917
459292
338316
217908
268553
393369
464269
221529
54505
344147
383901
390698
336915
55549
464365
471966
200872
736611
460077
436979
736748
198995
464154
268026
367533
54854
400007
343604
334306
156572
194141
625313
466086
44893
334884
360376
367463
384489
386153
437258
335843
633672
383804
364998
366088
53596
288543
436625
463037
466685
367006
437144
467992
435585
435908
283200
435809
386304
265091
459136
199706
269875
335654
441965
436261
381537
199056
10405
13051
437969
652270
667918
716365
36939
291868
285466
360619
337670
623626
342539
414803
37303
226956
371462
342668
55944
284817
55402
269851
392618
291117
436918
437826
386578
387578
436990
437841
435765
437403
437414
288511
435693
437871
435722
702752
11525
435851
202639
392791
389793
342666
418745
698737
361707
708058
364248
21186
268557
268108
56757
357164
475385
56742
196743
340893
464596
392158
263859
287965
55891
44698
203631
459304
392926
353833
659877
359967
291890
37141
196591
269651
421492
271736
291895
464118
365694
342578
467933
436062
339524
335848
12822
333879
255881
435899
10832
285444
205267
468441
386400
437555
386451
467778
416094
452014
78060
8541
201454
286348
363545
57756
286620
193978
736719
736059
197077
366225
268809
484464
384963
436493
20162

2025-01-20 13:44:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:44:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:44:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:45:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 13:45:00 - snowflake.connector.connection - INFO - closed
2025-01-20 13:45:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:45:00 - root - INFO - SQL:
-- 6. Extract cropConfidence values from VISION_API_DATA.
SELECT t."object_id", f.value:"confidence"::FLOAT AS "cropConfidence"
FROM THE_MET.THE_MET."VISION_API_DATA" t, LATERAL FLATTEN(input => t."cropHintsAnnotation":"cropHints") f
LIMIT 1000
Results:
Too long, hard cut:
object_id,cropConfidence
463536,1.0
286038,1.0
467486,1.0
386444,1.0
343968,1.0
288535,1.0
17449,1.0
343402,1.0
261387,1.0
342591,1.0
263135,1.0
361703,1.0
729624,1.0
385957,1.0
659124,1.0
345721,1.0
196356,1.0
339707,1.0
367415,1.0
398595,1.0
55574,1.0
197750,1.0
229095,1.0
471848,1.0
436731,1.0
198587,1.0
340058,1.0
349162,1.0
452670,1.0
342501,1.0
37895,1.0
399212,1.0
54652,1.0
11777,1.0
459002,1.0
11372,1.0
397694,1.0
206589,1.0
338515,1.0
364382,1.0
436770,1.0
10401,1.0
64534,1.0
471995,1.0
385089,1.0
342748,1.0
436911,1.0
102243,1.0
11798,1.0
11707,1.0
437490,1.0
438820,1.0
437703,1.0
475487,1.0
459040,1.0
291887,1.0
436664,1.0
463545,1.0
191777,1.0
349309,1.0
467808,1.0
205239,1.0
58026,1.0
269254,1.0
428639,1.0
260058,1.0
237070,1.0
260182,1.0
237754,1.0
45445,1.0
60060,1.0
403086,1.0
700206,1.0
371456,1.0
464151,1.0
187761,1.0
188903,1.0
398499,1.0
204625,1.0
206168,1.0
434111,1.0
393331,1.0
362267,1.0
16665,1.0
288561,1.0
250549,1.0
343201,1.0
1683,1.0
387537,1.0
391793,1.0
399237,1.0
14942,1.0
55423,1.0
195760,1.0
260113,1.0
37125,1.0
364839,1.0
366887,1.0
463765,1.0
451972,1.0
189163,1.0
56753,1.0
203111,1.0
190623,1.0
360642,1.0
202343,1.0
36707,1.0
189644,1.0
382454,1.0
56027,1.0
390689,1.0
59185,1.0
189700,1.0
194324,1.0
386145,1.0
642888,1.0
431358,1.0
302131,1.0
46445,1.0
268128,1.0
51416,1.0
286615,1.0
387541,1.0
367468,1.0
392932,1.0
434603,1.0
260140,1.0
269271,1.0
437069,1.0
460208,1.0
473465,1.0
156808,1.0
464299,1.0
204722,1.0
454344,1.0
36654,1.0
41933,1.0
438026,1.0
11274,1.0
189712,1.0
383935,1.0
63832,1.0
399691,1.0
442749,1.0
625354,1.0
38582,1.0
339119,1.0
55199,1.0
342463,1.0
227026,1.0
407167,1.0
704827,1.0
435691,1.0
436738,1.0
337665,1.0
377467,1.0
459019,1.0
271746,1.0
631422,1.0
436759,1.0
365816,1.0
12731,1.0
451283,1.0
208809,1.0
399545,1.0
249164,1.0
435766,1.0
73439,1.0
339543,1.0
10337,1.0
459015,1.0
437422,1.0
667926,1.0
459023,1.0
249232,1.0
435702,1.0
467508,1.0
435754,1.0
391053,1.0
350970,1.0
369533,1.0
453683,1.0
356476,1.0
436103,1.0
488733,1.0
10389,1.0
58263,1.0
13050,0.29999998211860657
37993,1.0
436892,1.0
656826,1.0
392687,1.0
359151,1.0
337761,1.0
361613,1.0
730790,1.0
286173,1.0
269253,1.0
344140,1.0
260348,1.0
388833,1.0
712946,1.0
260126,1.0
436900,1.0
339559,1.0
342502,1.0
54660,1.0
437004,1.0
194541,1.0
260175,0.5999999642372131
363737,1.0
2783,1.0
452125,1.0
199486,1.0
716639,1.0
54849,1.0
310365,1.0
37807,1.0
436802,1.0
389888,1.0
551108,1.0
435653,1.0
471218,1.0
435763,1.0
436835,1.0
266256,1.0
437268,1.0
436850,1.0
12552,1.0
200564,1.0
260352,1.0
198903,1.0
190119,1.0
335497,1.0
294508,1.0
461549,1.0
206726,1.0
386450,1.0
464286,1.0
471559,1.0
679466,1.0
189944,1.0
471122,1.0
193428,1.0
203376,1.0
187556,1.0
5207,1.0
446583,1.0
11471,1.0
44377,1.0
44384,1.0
682991,1.0
396179,1.0
55419,1.0
44365,1.0
56024,1.0
900,1.0
460148,1.0
364208,1.0
44373,1.0
198315,1.0
396434,1.0
38345,1.0
467475,1.0
271844,1.0
63835,1.0
656030,1.0
56534,1.0
58205,1.0
447804,1.0
400533,1.0
58256,1.0
11592,1.0
55268,1.0
288214,1.0
408994,1.0
428411,1.0
403228,1.0
286502,1.0
633712,1.0
15917,1.0
260119,1.0
437925,1.0
435716,1.0
13763,1.0
436793,1.0
186800,1.0
186826,1.0
57074,1.0
259609,1.0
386355,1.0
726237,1.0
285708,1.0
55887,1.0
368544,1.0
623329,1.0
471560,1.0
398521,1.0
221533,1.0
392427,1.0
10241,1.0
55183,1.0
464306,1.0
436118,1.0
55182,1.0
463649,1.0
436840,1.0
437593,1.0
436048,1.0
438821,1.0
284452,1.0
436502,1.0
437819,1.0
291872,1.0
285881,1.0
436230,1.0
73414,1.0
17652,1.0
459197,1.0
438025,1.0
437755,1.0
435714,1.0
44367,1.0
44366,1.0
44378,1.0
337450,1.0
209424,1.0
467378,1.0
386090,1.0
369331,1.0
203238,1.0
428608,1.0
469932,1.0
236779,1.0
193700,1.0
193450,1.0
392668,1.0
197483,1.0
44380,1.0
463697,1.0
471233,1.0
219919,1.0
396429,1.0
359431,1.0
367700,1.0
366523,1.0
386457,1.0
461128,1.0
475490,1.0
53924,1.0
390373,1.0
414259,1.0
286442,1.0
56070,1.0
467722,1.0
359618,1.0
209042,1.0
464450,1.0
446265,1.0
19732,1.0
10184,1.0
436097,1.0
186816,1.0
186825,1.0
403245,1.0
435607,1.0
446566,0.29999998211860657
388654,1.0
339882,1.0
187154,1.0
670103,1.0
438466,1.0
458984,1.0
12749,1.0
436797,1.0
338711,1.0
543901,1.0
55237,1.0
437038,1.0
186815,1.0
186803,1.0
342849,1.0
682101,1.0
661968,1.0
156804,1.0
384486,1.0
339941,1.0
471112,1.0
437775,1.0
232212,1.0
288533,1.0
437674,1.0
436603,1.0
436838,1.0
435739,1.0
458982,1.0
464048,1.0
438617,1.0
194211,1.0
460602,1.0
367745,1.0
684712,1.0
206568,1.0
246809,1.0
191947,1.0
246813,1.0
464263,1.0
191612,1.0
60213,1.0
226955,1.0
291838,1.0
195319,1.0
13025,1.0
264576,1.0
294512,1.0
387951,1.0
463825,1.0
383998,1.0
470900,1.0
288164,1.0
392523,1.0
645760,1.0
287799,1.0
349133,1.0
383358,1.0
365615,1.0
455024,1.0
436989,1.0
651672,1.0
677492,1.0
707925,1.0
439553,1.0
341760,1.0
448555,1.0
45260,1.0
36662,1.0
460189,1.0
202330,1.0
435755,1.0
437342,1.0
435832,1.0
459043,1.0
363309,1.0
452017,1.0
55746,1.0
383926,1.0
367699,1.0
396359,1.0
227931,1.0
367702,1.0
195300,1.0
438605,1.0
437261,1.0
13198,1.0
386456,1.0
435602,1.0


2025-01-20 13:45:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:45:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:45:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:45:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-20 13:45:02 - snowflake.connector.connection - INFO - closed
2025-01-20 13:45:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:45:02 - root - INFO - SQL:
-- 7. Select object IDs and titles where department is 'The Libraries' and title contains 'book'.
SELECT "object_id", "title"
FROM THE_MET.THE_MET."OBJECTS"
WHERE "department" = 'The Libraries' AND "title" ILIKE '%book%'
LIMIT 1000
Results:
object_id,title
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found"
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts"
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work"
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc."

2025-01-20 13:45:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:45:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:45:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:45:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 13:45:03 - snowflake.connector.connection - INFO - closed
2025-01-20 13:45:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:45:04 - root - INFO - SQL:
-- 8. Extract and filter cropConfidence values greater than 0.5.
SELECT t."object_id", f.value:"confidence"::FLOAT AS "cropConfidence"
FROM THE_MET.THE_MET."VISION_API_DATA" t, LATERAL FLATTEN(input => t."cropHintsAnnotation":"cropHints") f
WHERE f.value:"confidence"::FLOAT > 0.5
LIMIT 1000
Results:
Too long, hard cut:
object_id,cropConfidence
437177,1.0
437564,1.0
201929,1.0
397271,1.0
355599,1.0
412502,1.0
337337,1.0
209969,1.0
6039,1.0
53710,1.0
377454,1.0
196587,1.0
336772,1.0
558364,1.0
399542,1.0
390002,1.0
693798,1.0
367538,1.0
369073,1.0
37169,1.0
339833,1.0
201428,1.0
209272,1.0
416888,1.0
347688,1.0
397692,1.0
335839,1.0
471067,1.0
435595,1.0
204626,1.0
56835,1.0
209244,1.0
282028,1.0
398504,1.0
446546,1.0
194520,1.0
436509,1.0
464160,1.0
266259,1.0
438385,1.0
435852,1.0
459093,1.0
11712,1.0
467724,1.0
458979,1.0
436015,1.0
435768,1.0
338317,1.0
739395,1.0
679157,1.0
191783,1.0
202700,1.0
13661,1.0
370485,1.0
188969,1.0
291800,1.0
645771,1.0
193972,1.0
198996,1.0
64872,1.0
739029,1.0
464254,1.0
464124,1.0
463826,1.0
437928,1.0
36612,1.0
471117,1.0
199973,1.0
382755,1.0
288184,1.0
286009,1.0
645766,1.0
464293,1.0
463742,1.0
505616,1.0
386449,1.0
369562,1.0
646460,1.0
228882,1.0
207530,1.0
387497,1.0
44369,1.0
44381,1.0
198770,1.0
367300,1.0
437008,1.0
436760,1.0
198906,1.0
44375,1.0
354035,1.0
463551,1.0
56038,1.0
44363,1.0
736066,1.0
56840,1.0
437632,1.0
56515,1.0
37943,1.0
55361,1.0
286647,1.0
386928,1.0
436200,1.0
361830,1.0
392927,1.0
55273,1.0
199485,1.0
156575,1.0
200656,1.0
466107,1.0
437895,1.0
448461,1.0
436346,1.0
436692,1.0
186822,1.0
186821,1.0
63874,1.0
707799,1.0
383944,1.0
396189,1.0
668089,1.0
58031,1.0
468318,1.0
470919,1.0
191180,1.0
463602,1.0
467471,1.0
449008,1.0
437021,1.0
44510,1.0
463189,1.0
10967,1.0
11046,1.0
186812,1.0
404836,1.0
397263,1.0
389200,1.0
416042,1.0
459042,1.0
388772,1.0
338919,1.0
466353,1.0
435863,1.0
54569,1.0
353162,1.0
400609,1.0
450587,1.0
299311,1.0
436685,1.0
227304,1.0
259797,1.0
462886,1.0
44382,1.0
192751,1.0
193425,1.0
342487,1.0
386096,1.0
288300,1.0
368543,1.0
459064,1.0
464169,1.0
384498,1.0
739318,1.0
288015,1.0
287687,1.0
199487,1.0
469940,1.0
390083,1.0
335840,1.0
436481,1.0
208764,1.0
12917,1.0
189297,1.0
56927,1.0
729662,1.0
692282,1.0
471953,1.0
338480,1.0
399987,1.0
56750,1.0
437354,1.0
460220,1.0
437791,1.0
635384,1.0
283086,1.0
458977,1.0
436207,1.0
436950,1.0
288505,1.0
435594,1.0
186811,1.0
186818,1.0
186804,1.0
186798,1.0
467782,1.0
367762,1.0
349141,1.0
268069,1.0
355100,1.0
55511,1.0
55871,1.0
197732,1.0
288537,1.0
399213,1.0
386317,1.0
465972,1.0
381860,1.0
260117,1.0
437023,1.0
435616,1.0
437239,1.0
459128,1.0
246808,1.0
246810,1.0
60164,1.0
287766,1.0
246815,1.0
246811,1.0
715027,1.0
191611,1.0
78642,1.0
291867,1.0
194162,1.0
246807,1.0
207701,1.0
346872,1.0
268134,1.0
197117,1.0
73466,1.0
392114,1.0
185893,1.0
698815,1.0
283173,1.0
288165,1.0
467784,1.0
264583,1.0
55613,1.0
55865,1.0
287646,1.0
56510,1.0
55500,1.0
220126,1.0
701263,1.0
286280,1.0
437509,1.0
13043,1.0
436909,1.0
442761,1.0
435669,1.0
44358,1.0
437798,1.0
11258,1.0
436335,1.0
55325,1.0
44360,1.0
463040,1.0
463536,1.0
286038,1.0
467486,1.0
386444,1.0
343968,1.0
288535,1.0
17449,1.0
343402,1.0
261387,1.0
342591,1.0
263135,1.0
361703,1.0
729624,1.0
385957,1.0
659124,1.0
345721,1.0
196356,1.0
339707,1.0
367415,1.0
398595,1.0
55574,1.0
197750,1.0
229095,1.0
471848,1.0
436731,1.0
198587,1.0
340058,1.0
349162,1.0
452670,1.0
342501,1.0
37895,1.0
399212,1.0
54652,1.0
11777,1.0
459002,1.0
11372,1.0
397694,1.0
206589,1.0
338515,1.0
364382,1.0
436770,1.0
10401,1.0
64534,1.0
471995,1.0
385089,1.0
342748,1.0
436911,1.0
102243,1.0
11798,1.0
11707,1.0
437490,1.0
438820,1.0
437703,1.0
475487,1.0
459040,1.0
291887,1.0
436664,1.0
463545,1.0
191777,1.0
349309,1.0
467808,1.0
205239,1.0
58026,1.0
269254,1.0
428639,1.0
260058,1.0
237070,1.0
260182,1.0
237754,1.0
45445,1.0
60060,1.0
403086,1.0
700206,1.0
371456,1.0
464151,1.0
187761,1.0
188903,1.0
398499,1.0
204625,1.0
206168,1.0
434111,1.0
393331,1.0
362267,1.0
16665,1.0
288561,1.0
250549,1.0
343201,1.0
1683,1.0
387537,1.0
391793,1.0
399237,1.0
14942,1.0
55423,1.0
195760,1.0
260113,1.0
37125,1.0
364839,1.0
366887,1.0
463765,1.0
451972,1.0
189163,1.0
56753,1.0
203111,1.0
190623,1.0
360642,1.0
202343,1.0
36707,1.0
189644,1.0
382454,1.0
56027,1.0
390689,1.0
59185,1.0
189700,1.0
194324,1.0
386145,1.0
642888,1.0
431358,1.0
302131,1.0
46445,1.0
268128,1.0
51416,1.0
286615,1.0
387541,1.0
367468,1.0
392932,1.0
434603,1.0
260140,1.0
269271,1.0
437069,1.0
460208,1.0
473465,1.0
156808,1.0
464299,1.0
204722,1.0
454344,1.0
36654,1.0
41933,1.0
438026,1.0
11274,1.0
189712,1.0
383935,1.0
63832,1.0
399691,1.0
442749,1.0
625354,1.0
38582,1.0
339119,1.0
55199,1.0
342463,1.0
227026,1.0
407167,1.0
704827,1.0
435691,1.0
436738,1.0
337665,1.0
377467,1.0
459019,1.0
271746,1.0
631422,1.0
436759,1.0
365816,1.0
12731,1.0
451283,1.0
208809,1.0
399545,1.0
249164,1.0
435766,1.0
73439,1.0
339543,1.0
10337,1.0
459015,1.0
437422,1.0
667926,1.0
459023,1.0
249232,1.0
435702,1.0
467508,1.0
435754,1.0
391053,1.0
350970,1.0
369533,1.0
453683,1.0
356476,1.0
436103,1.0
488733,1.0
10389,1.0
58263,1.0
37993,1.0
436892,1.0
656826,1.0
392687,1.0
359151,1.0
337761,1.0
361613,1.0
730790,1.0
286173,1.0
269253,1.0
344140,1.0
260348,1.0
388833,1.0
712946,1.0
260126,1.0
436900,1.0
339559,1.0
342502

2025-01-20 13:45:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:45:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:45:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:45:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 13:45:05 - snowflake.connector.connection - INFO - closed
2025-01-20 13:45:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:45:06 - root - INFO - SQL:
-- 9. Select object IDs where metadata_date is not null.
SELECT "object_id"
FROM THE_MET.THE_MET."OBJECTS"
WHERE "metadata_date" IS NOT NULL
LIMIT 1000
Results:
Too long, hard cut:
object_id
646996
77916
38009
37988
74660
74674
74675
74677
74685
65595
73261
38042
39894
64891
65590
65594
40445
45063
40069
40070
37964
75084
75085
75086
75087
75088
75089
75090
75091
75092
75093
75094
75095
75096
75097
75098
75099
75100
75101
75102
75103
75104
75105
75106
75107
75108
75109
75110
75111
75112
75113
75114
75115
75116
75117
75118
75119
75120
75121
75122
75123
75124
75125
75126
75127
75128
75129
75130
75131
75132
75133
75134
75135
75136
75137
75138
75139
75140
75141
75142
75143
75145
75146
75147
75148
75149
75150
75151
75152
75153
54912
38448
40429
40432
73188
74683
72589
74656
64046
39899
36145
49665
36130
36435
36036
36072
49133
65620
40021
49453
49134
65075
41468
40507
40052
35995
35999
36003
45786
73669
49179
49226
51727
51705
51528
51656
51644
36129
51770
64029
60764
51902
64045
36439
40285
40107
40180
40194
40060
40058
45684
45746
39766
45749
44574
45775
45780
51865
77914
48875
48955
48954
49025
49029
56553
41780
39625
48931
48928
48959
49129
49146
49147
49163
51894
36132
51900
75814
54308
55495
49473
35987
44570
40105
40509
42329
39918
39919
40103
40104
41777
41860
40018
41778
41782
63196
63185
49047
50549
53924
53925
53926
53927
53928
53929
42323
36236
36098
72711
72712
36201
44567
49617
36208
36205
36206
36211
36210
36216
49629
49630
41504
49603
49604
49605
49607
36202
49608
49606
49614
49615
49663
49664
49626
49627
36222
36224
49623
40311
45652
39901
39959
51762
40062
40057
40094
36052
40053
36055
44506
44507
44508
44509
44510
40278
41479
45661
41478
44699
44590
45675
36123
45683
45682
39483
36093
45752
45779
44601
45776
39654
45802
45797
44606
45815
36135
45032
48934
48932
36070
48949
48952
48953
48951
41480
48950
48969
35988
39713
49019
49021
39717
49074
41470
39558
44759
37395
35998
35990
48948
36022
36021
36067
75250
48901
45676
51375
39554
36094
36080
48947
35994
48902
49095
48966
51871
39667
44703
36024
48910
36436
65013
45670
35989
41191
45655
39553
36081
36082
39552
45680
36058
36095
35992
45671
45659
51621
49030
44626
40019
49106
65555
36089
49080
40020
39557
75745
49132
41483
36131
51864
41488
51769
36453
37394
39540
49143
49144
41491
49145
49149
49151
51483
49157
49156
49150
49154
49158
36025
77870
41486
49162
49181
41492
49177
49178
49172
49170
49183
49171
49175
36018
49176
49173
49187
62743
41487
49185
49186
36015
49239
49237
36027
36047
49240
39767
49243
36432
39764
49244
44620
49247
49253
73161
49254
39765
41494
36017
36160
36155
49449
49451
49434
49458
36157
49454
49468
49469
36161
49452
36187
49474
49476
49460
49461
49464
44566
37393
49463
39715
49462
49475
36181
36179
49602
41905
36194
49594
36156
36171
49241
36167
39714
49227
44581
72263
49131
74818
49234
36105
36106
73159
36100
36186
59025
36091
44720
48946
36090
44521
36001
73646
65640
49250
49251
41493
36133
40454
36459
40456
40508
40511
41462
39547
39546
45636
45635
41154
41185
40515
41195
40134
41194
39550
41451
41193
36430
36431
44701
40514
40513
42260
41146
40309
40081
41476
40393
42261
45647
35970
44702
39895
39668
39936
39915
40007
40284
40054
40051
36037
40086
44638
36005
40133
39937
40090
36019
49017
45658
45650
65385
44873
45637
39488
48837
40185
40187
40188
40061
49006
49009
48944
45660
45747
45748
42683
45795
45763
45764
53796
45777
45783
45804
45812
48876
48874
48877
48879
35993
48904
48905
48915
48917
48926
48927
48935
48943
45384
48956
48957
48958
48963
48960
48961
48962
48964
48970
49043
49044
49097
49015
35997
48909
48930
48897
48965
49169
49174
49219
51901
36122
51807
51379
39534
42158
49033
45657
43294
63331
63216
63351
63230
63218
63336
63325
63204
63219
63338
63201
63213
63345
63337
63215
63339
63341
63212
63214
63217
63327
63348
63209
63226
63203
63078
51548
39920
45685
45793
45773
45772
36062
44573
45756
45760
36103
45821
48873
49256
51872
48968
49077
36099
39628
50168
45810
45807
36138
49013
64972
36050
51285
36013
36051
48942
36023
50167
35996
36136
41471
39551
36030
36002
36000
36188
49130
39931
36134
51803
49148
41485
49165
36016
52225
49164
36120
49182
49180
49238
36102
36096
52946
51790
44527
36026
42559
36147
49457
49433
49455
49456
36184
49472
36172
49471
49242
49459
41484
49236
36014
36139
35981
51484
40080
39549
39545
35977
51763
40087
35986
51639
51856
51858
53601
53602
53603
42187
51850
51640
51768
51546
49055
51604
35978
36035
51584
44592
44593
36084
44612
51816
44591
49167
49168
36124
40017
42324
49166
44294
49432
49448
36154
49447
49467
36170
36075
36168
51898
40059
48912
35982
35985
45784
35980
35976
51859
36066
49252
51657
40003
40106
36033
40004
40002
40196
40078
39935
45781
48933
49020
51873
48888
44451
39556
48884
35974
42560
49127
51887
35971
35972
35975
49152
49153
53552
51369
49188
39913
51896
35973
41481
49113
36433
51567
36041
51668
40088
36141
40987
51378
51490
40422
51535
51293
48945
48941
37396
45814
35983
48903
40510
51870
51869
48906
35991
63220
63225
63205
63206
63208
63228
40102
39917
51396
51540
51746
45754
45774
48872
51664
51679
51678
45677
35984
51498
51428
51500
51515
49159
49160
51427
51284
51527
51519
51574
51499
51701
51637
51425
50360
51687
51654
513

2025-01-20 13:45:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:45:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:45:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:45:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 13:45:07 - snowflake.connector.connection - INFO - closed
2025-01-20 13:45:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:45:07 - root - INFO - SQL:
-- 10. Select metadata_date from OBJECTS to examine date formats.
SELECT "metadata_date"
FROM THE_MET.THE_MET."OBJECTS"
LIMIT 1000
Results:
Too long, hard cut:
metadata_date
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
14863

2025-01-20 13:45:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:45:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:45:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:45:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 13:45:09 - snowflake.connector.connection - INFO - closed
2025-01-20 13:45:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:45:09 - root - INFO - SQL:
-- 11. Select object IDs and titles with metadata dates after a specific date.
SELECT "object_id", "title"
FROM THE_MET.THE_MET."OBJECTS"
WHERE "metadata_date" > 20200101
LIMIT 1000
Results:
Too long, hard cut:
object_id,title
646996,전(傳) 오원 장승업 (1843–1897) 청동기와 화초가 있는 정물화 조선|傳 吾園 張承業 器皿折枝圖 朝鮮|Still life with bronze vessels and flowering plants
77916,석지 채용신    학자 초상|石芝 蔡龍臣 學者肖像|Portrait of a scholar
38009,
37988,
74660,
74674,
74675,
74677,
74685,
65595,
73261,
38042,
39894,
64891,
65590,
65594,
40445,"이유원, 매화도  조선|李裕元 梅花圖  朝鮮|Plum Branch"
45063,
40069,
40070,
37964,
75084,
75085,
75086,
75087,
75088,
75089,
75090,
75091,
75092,
75093,
75094,
75095,
75096,
75097,
75098,
75099,
75100,
75101,
75102,
75103,
75104,
75105,
75106,
75107,
75108,
75109,
75110,
75111,
75112,
75113,
75114,
75115,
75116,
75117,
75118,
75119,
75120,
75121,
75122,
75123,
75124,
75125,
75126,
75127,
75128,
75129,
75130,
75131,
75132,
75133,
75134,
75135,
75136,
75137,
75138,
75139,
75140,
75141,
75142,
75143,
75145,
75146,
75147,
75148,
75149,
75150,
75151,
75152,
75153,
54912,
38448,
40429,
40432,
73188,
74683,
72589,
74656,
64046,張旭 「肚痛帖」; 懷素 「寄邊衣」詩|Ji bianyi|Letter about a Stomachache (Du tong tie)
39899,東晉 王羲之 十七日帖 十三世紀拓本|On the Seventeenth Day
36145,
49665,近代  丁輔之  荔枝  扇面|Lychees
36130,清  倣龔賢  十二月令山水圖  冊|Landscapes of the Twelve Months
36435,
36036,
36072,清  程正揆  江山臥遊圖  卷|Dream Landscape
49133,清  倣龔賢  雲山隱居圖  軸|Dwelling among Mountains and Clouds
65620,清  倣龔賢  山水圖  冊|Landscapes
40021,清 王翬 倣李成雪霽圖 軸 紙本|Snow Clearing: Landscape after Li Cheng
49453,清  王緣  趙之謙肖像  軸|Portrait of Zhao Zhiqian
49134,清  柳堉  溪山行旅圖  卷|Traveling Amid Streams and Mountains
65075,王翬、楊晉、顧昉、王雲、徐玫 仿古山水圖 冊 紙本|Landscapes after old masters
41468,元  吳鎮  蘆灘釣艇圖  卷|Fisherman
40507,元   趙孟頫   趙雍   趙麟   吳興趙氏三世人馬圖   卷|Grooms and Horses
40052,"南宋 馬和之 詩經小雅鴻雁之什六篇圖 卷|Courtly Odes, Beginning with ""Wild Geese"""
35995,
35999,
36003,
45786,
73669,清  查昇  行書七律詩  軸|Poem
49179,清  石濤(朱若極)  山水圖  冊|Searching for Immortals
49226,
51727,
51705,
51528,
51656,
51644,
36129,
51770,
64029,唐 颜真卿 顏家廟碑 現代拓片 紙本|Yan Family Temple Stele
60764,太平山水圖|Landscapes of Taiping Prefecture (Taiping shanshui tu)
51902,
64045,
36439,唐 傳鍾紹京 楷書靈飛經 冊|Spiritual Flight Sutra
40285,南宋  趙孟堅  行書梅竹詩譜  卷|Poems on Painting Plum Blossoms and Bamboo
40107,南宋   理宗趙昀  行書北宋梅堯臣 依韻和資政侍郎雪後登看山亭詩   團扇|Quatrain on Snow-covered West Lake
40180,
40194,南宋 理宗 趙昀 楷書韓翊 《 潮聲山翠》 聯句 團扇|Couplet from a Poem by Han Hong
40060,南宋  孝宗  行楷書池上水邊聯句  團扇|Couplet on pond scenery
40058,南宋   高宗   草書天山陰雨七絕詩   團扇|Quatrain on Heavenly Mountain
45684,
45746,
39766,明  王鏊  贈別詩  軸|Farewell Poem
45749,
44574,
45775,"明  文徵明  致丈人吳愈書  冊頁|Letter to the Artist's Father-in-law, Wu Yu"
45780,
51865,
77914,文彭  行草七律  水墨絹本  鏡框|Poem on Promulgating the Almanac at New Year’s
48875,
48955,
48954,
49025,
49029,明/清  王鐸  行草書日暮孤亭五律詩  軸|Poem on a Riverside Pavilion
56553,
41780,
39625,晚明  張希黃 留青竹刻 《醉翁亭記》 詩意圖筆筒|Brush holder with “Ode to the Pavilion of the Inebriated Old Man”
48931,
48928,
48959,
49129,清  法若真  行草書畫說  卷|Discourse on Painting
49146,清  朱耷 (八大山人)  李治書  扇頁|Letter by Li Zhi
49147,明/清 朱耷（八大山人） 致方士琯書 冊 紙本|Letters to Fang Shiguan
49163,
51894,"清   金農   論畫雜詩   冊|Poems on Paintings, Written for Ma Yueguan"
36132,
51900,
75814,吳煕載  篆書詩經南山有臺|Nutgrass Grows on the Southern Hills
54308,清  趙之謙  隸書引首  卷|The Lingshouhua Studio
55495,清  趙之謙  篆書五言  對聯|Couplet
49473,清  翁同龢  軸|Tiger Calligraphy
35987,
44570,
40105,元 耶律楚材 行書贈別劉滿詩 卷|Poem of Farewell to Liu Man
40509,元  趙孟頫  行書右軍四事  卷|Four anecdotes from the life of Wang Xizhi
42329,元  鄭元祐  楷書師孺齋記  卷|Record of the Following One's Ancestor Studio
39918,北宋 黃庭堅 草書廉頗藺相如傳 卷|Biographies of Lian Po and Lin Xiangru
39919,北宋  米芾  草書吳江舟中詩  卷|Poem Written in a Boat on the Wu River
40103,南宋 楊皇后 楷書薄薄殘妝七絕 團扇冊頁 絹本|Quatrain on spring’s radiance
40104,南宋  楊皇后  楷書瀹雪凝酥七絕  團扇|Quatrain on yellow roses
41777,
41860,
40018,
41778,
41782,
63196,
63185,芥子園畫傳|Mountainside View: Page from The Mustard Seed Garden Manual of Painting
49047,
50549,
53924,
53925,
53926,
53927,
53928,
53929,
42323,
36236,近代  張善子  黃山奇松圖  扇頁|Strange Pine in the Yellow Mountain
36098,
72711,清  湯貽汾  墨梅  四冊頁|Blossoming Plum
72712,清  胡遠  山水  四軸|Landscapes of the Four Seasons
36201,近代  王振聲  友梅圖  扇面|Still-life with Plum
44567,近代  吳昌碩  仙芝天竹圖  軸|Spring Offerings
49617,近代  吳昌碩  烹茶圖  橫軸|Brewing Tea
36208,近代  吳昌碩  蘭花  扇面|Orchid
36205,近代  林紓  合掌峰  扇面|Hezhang Peak
36206,近代  林紓  詩廬圖  卷|The Poetry Cottage
36211,近代  吳觀岱  山水人物  扇面|Landscape and Figure
36210,近代  楊逸  青松  扇面|Pine
36216,近代  顧麟士  臨溪亭子圖  扇面|Pavilion Beside a Rock Garden and Stream
49629,近代  王震  山羊  軸|Two Goats
49630,近代  王震  漁翁圖  軸|Returning Fisherman
41504,近代  王震  佛祖圖  軸|Buddhist Sage
49603,近代  陳衡恪  臨水書閣  冊頁|Studio by the Water
49604,近代  陳衡恪  水仙蘭花  扇面|Narcissus and Orchid
49605,近代  陳衡恪  秋山蕭寺  扇面|Remote Temple on the Autumn Mountain
49607,近代  陳衡恪  玉簪花  冊頁|Plantain Lily
36202,近代  陳衡恪  梅花  冊頁|Plum
49608,近代  陳衡恪  梨花  軸|Pear-blossoms
49606,近代  陳衡恪  山水  扇面兩幀|Landscapes
49614,近代  金城  山水  扇面|Landscape
49615,近代  金城  牡丹  扇面|Peony
49663,近代  丁輔之  雜果圖  冊頁|Fruit
49664,近代  丁輔之  冰盤進夏圖  冊頁|Dish of Iced Summer Fruit
49626,近代  俞明  桐窗仕女  扇面|A Beauty at the Window by a Wutong Tree
49627,近代  俞明  絲路行旅圖  扇面|Travel on the Silk Road
36222,近代  俞明  堆雪獅子圖  冊頁|Making a Snow-lion
3622

2025-01-20 13:45:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:45:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:45:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:45:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 13:45:11 - snowflake.connector.connection - INFO - closed
2025-01-20 13:45:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:45:11 - root - INFO - SQL:
-- 12. Select object IDs and descriptions from labelAnnotations in VISION_API_DATA.
SELECT t."object_id", f.value:"description"::STRING AS "labelDescription"
FROM THE_MET.THE_MET."VISION_API_DATA" t, LATERAL FLATTEN(input => t."labelAnnotations") f
LIMIT 1000
Results:
Too long, hard cut:
object_id,labelDescription
437177,painting
437177,impressionist
437177,mythology
437177,illustration
437177,portrait
437564,photograph
437564,black and white
437564,art
437564,painting
437564,sketch
201929,white
201929,black and white
201929,picture frame
201929,fireplace
201929,architecture
397271,cartoon
397271,sketch
397271,drawing
397271,illustration
397271,pattern
355599,sketch
355599,ancient history
355599,painting
355599,drawing
355599,tapestry
412502,painting
412502,tapestry
412502,sketch
412502,ancient history
412502,textile
337337,sketch
337337,drawing
337337,painting
337337,illustration
337337,pattern
209969,modern art
209969,sketch
209969,art
209969,drawing
209969,shape
6039,black and white
6039,platter
6039,plate
6039,tableware
6039,dishware
53710,color
53710,painting
53710,art
53710,mural
53710,modern art
377454,sketch
377454,drawing
377454,figure drawing
377454,portrait
377454,illustration
196587,black and white
196587,photograph
196587,human positions
196587,photography
196587,monochrome photography
336772,painting
336772,picture frame
336772,relief
336772,art
336772,carving
558364,sculpture
558364,stone carving
558364,art
558364,statue
558364,carving
399542,painting
399542,art
399542,ancient history
399542,picture frame
399542,sketch
390002,relief
390002,art
390002,picture frame
390002,sketch
390002,drawing
693798,sketch
693798,drawing
693798,art
693798,pattern
693798,design
367538,cartoon
367538,art
367538,sketch
367538,drawing
367538,ancient history
369073,painting
369073,art
369073,ancient history
369073,sketch
369073,drawing
37169,woman
37169,cartoon
37169,sketch
37169,comics
37169,comic book
339833,postage stamp
339833,banknote
339833,currency
339833,paper
339833,sketch
201428,stained glass
201428,window
201428,glass
201428,art
201428,material
209272,sculpture
209272,art
209272,relief
209272,drawing
209272,sketch
416888,cartoon
416888,sketch
416888,drawing
416888,art
416888,figure drawing
347688,painting
347688,art
347688,ancient history
347688,modern art
347688,tapestry
397692,relief
397692,sketch
397692,art
397692,drawing
397692,figure drawing
335839,art
335839,picture frame
335839,tapestry
335839,pattern
335839,textile
471067,cartoon
471067,window
471067,stained glass
471067,glass
471067,art
435595,red
435595,person
435595,image
435595,child
435595,romance
204626,relief
204626,stone carving
204626,art
204626,statue
204626,dishware
56835,person
56835,woman
56835,geisha
56835,profession
56835,costume design
209244,furniture
209244,altar
209244,throne
209244,table
209244,carving
282028,photograph
282028,image
282028,album cover
282028,history
282028,infantry
398504,art
398504,painting
398504,pattern
398504,sketch
398504,illustration
446546,art
446546,painting
446546,tapestry
446546,textile
446546,needlework
194520,black and white
194520,human positions
194520,statue
194520,art
194520,sculpture
436509,painting
436509,impressionist
436509,art
436509,ancient history
436509,middle ages
464160,statue
464160,sculpture
464160,monument
464160,stone carving
464160,art
266259,photograph
266259,picture frame
266259,portrait
266259,painting
266259,sketch
438385,painting
438385,art
438385,middle ages
438385,tapestry
438385,illustration
435852,image
435852,painting
435852,human positions
435852,child
435852,portrait
459093,painting
459093,art
459093,jungle
459093,mythology
459093,modern art
11712,photograph
11712,image
11712,painting
11712,portrait
11712,art
467724,statue
467724,monument
467724,figurine
467724,sculpture
467724,art
458979,painting
458979,art
458979,relief
458979,picture frame
458979,carving
436015,person
436015,painting
436015,art
436015,ancient history
436015,middle ages
435768,painting
435768,modern art
435768,art
435768,portrait
435768,illustration
338317,painting
338317,sketch
338317,figure drawing
338317,art
338317,drawing
739395,painting
739395,picture frame
739395,modern art
739395,art
739395,sketch
679157,pattern
679157,art
679157,design
679157,drawing
679157,sketch
191783,black and white
191783,human positions
191783,statue
191783,monochrome photography
191783,monument
202700,window
202700,altar
202700,art
202700,glass
202700,stained glass
13661,cartoon
13661,art
13661,sketch
13661,comics
13661,ancient history
370485,picture frame
370485,sketch
370485,drawing
370485,illustration
370485,design
188969,photograph
188969,black and white
188969,black
188969,monochrome
188969,monochrome photography
291800,picture frame
291800,art
291800,wood
291800,antique
291800,painting
645771,ancient history
645771,art
645771,sketch
645771,painting
645771,drawing
193972,black and white
193972,picture frame
193972,art
193972,monochrome photography
193972,sketch
198996,stained glass
198996,glass
198996,window
198996,art
198996,material
64872,painting
64872,mural
64872,art
64872,modern art
64872,ancient history
739029,painting
739029,art
739029,sketch
739029,modern art
739029,drawing
464254,relief
464254,stone carving
464254,carving
464254,art
464254,wood
464124,relief
464124,carving
464124,wood
4

2025-01-20 13:45:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:45:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:45:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:45:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 930
2025-01-20 13:45:13 - snowflake.connector.connection - INFO - closed
2025-01-20 13:45:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:45:13 - root - INFO - SQL:
-- 13. Select object IDs from VISION_API_DATA where labelAnnotations contain 'book'.
SELECT t."object_id"
FROM THE_MET.THE_MET."VISION_API_DATA" t, LATERAL FLATTEN(input => t."labelAnnotations") f
WHERE f.value:"description"::STRING ILIKE '%book%'
LIMIT 1000
Results:
Too long, hard cut:
object_id
56753
55199
339543
339559
392668
202330
73582
37185
37169
56038
56840
346872
55613
12727
333993
415967
339551
76575
339074
335408
73429
73473
77013
478997
352198
56756
343470
451315
339498
387577
37186
339515
339492
368343
45241
55397
45494
737704
435302
392843
364035
73443
73474
36687
625313
387578
353833
339524
56509
54878
57089
682992
55262
459061
435727
407577
422630
407463
76608
710996
407461
717487
699969
649902
649902
339550
391832
339503
436794
407488
625962
669267
407561
466588
211382
345008
670701
45051
219482
70035
341428
45565
407590
666029
357398
55501
352199
683005
396949
45227
36795
54511
693783
666034
428714
341426
727857
372509
383745
388023
682947
388781
382057
343422
430671
58003
623629
387788
387792
55181
63371
416540
55715
396307
384335
435303
387425
699916
649916
387434
623895
666001
37262
58054
667987
687397
36908
54667
365280
667996
387740
387433
387424
339463
429650
434547
435314
399047
341427
649914
384067
388150
387611
339566
339534
587682
397054
56062
54666
397144
54487
388067
350341
54396
388786
339460
339532
387429
339454
336215
397138
387379
416648
381466
739485
388783
388381
7503
407449
366326
56063
36892
726677
647649
649924
55717
339200
339200
339244
339244
55719
435311
399775
343101
430704
416666
37248
56107
649903
335087
37266
339028
387420
397703
400998
391570
387555
342598
382400
428394
388070
477362
192737
76574
367490
430629
76576
36675
397434
56760
36756
397333
416622
387376
362341
648485
734110
391397
416631
435307
384662
387781
649897
485752
392468
388466
55543
345033
667707
388051
669850
54507
434533
625298
387585
383749
388154
368330
416800
388158
367565
373157
361648
56719
397142
336216
58213
416683
207712
710934
58237
362339
339545
56828
73390
355316
58062
56728
339210
680839
387448
364735
339561
339489
339489
339219
339219
339495
410924
390001
339245
397139
388802
58061
54653
339071
710913
430696
347102
339560
55485
55038
55728
339491
339215
407593
407592
684134
360405
648576
36890
286316
710955
633065
407860
37263
56818
36638
76611
335490
649608
649608
737853
382139
362313
76609
371529
665999
452752
229239
75963
339329
73574
407594
407594
670725
336238
670702
389168
669031
415971
55598
346200
407448
407448
382093
63918
371758
387786
387568
434478
665376
388021
362032
397055
387455
388823
58029
361955
415970
55581
405346
36640
341529
728005
55192
668126
687861
58015
416039
649920
387783
373152
387421
388591
387563
387554
387430
37111
388590
359765
692294
368437
55770
36860
55341
665992
666121
36898
388025
362406
37239
680845
54662
435283
337882
428353
429649
362022
57987
388799
58006
55762
383718
367759
388057
45216
55714
625285
363983
388483
374014
55788
44990
333990
333990
388094
36814
364727
387606
387454
387375
340229
367504
387734
428047
388874
56538
202468
36904
398181
362740
36702
429908
386237
387791
57097
428319
388052
341498
404782
666051
471999
388388
387381
416066
370519
341874
36606
360402
73477
390385
76563
56119
37113
667957
56014
415964
60930
666030
56808
646706
363200
388061
649915
387461
396946
73596
398478
416267
54563
55956
36911
392799
36604
397255
387729
387873
52001
387580
366995
437794
392771
391348
336306
54506
336242
391134
56676
54820
338259
369588
435300
334925
58027
375912
387431
343298
36773
63803
376445
362384
57998
73611
384240
55725
465954
339490
37002
386164
367041
406562
55786
36815
397252
221531
55722
387730
387598
73585
359981
339567
76596
76625
647996
67572
407525
76614
339262
407497
407493
401511
680855
389508
623947
55578
682993
665281
36779
370668
629783
226563
76610
651982
738090
407328
407328
670691
56008
387757
37174
337850
361854
76578
405311
416632
388039
339457
623823
391253
388411
339494
391569
387417
56802
339512
415972
386159
36676
665571
57290
58373
36648
55326
343852
624946
388024
367067
339500
434493
416620
416040
387561
73490
36824
37317
416776
55771
55524
56177
435264
56681
339496
345100
36473
56780
58009
342720
434474
387883
397048
362513
362513
56536
339585
55352
339508
358129
37329
336204
387418
397137
387426
388481
373018
56035
451417
416364
387608
400074
343585
388060
387392
37191
453093
37135
56721
388029
360117
363263
339502
387574
447071
229112
56732
57100
362643
2269
643791
382448
55270
337379
388134
468153
398429
395998
387584
55545
51089
397256
339459
427105
666123
435316
36482
360179
408616
404509
387727
687793
666008
649613
398531
407578
37139
391078
680847
649901
56603
420968
388063
55523
55523
362520
339184
339184
388595
649895
415314
339225
54591
416668
430728
387790
54498
387782
622945
56615
388824
388828
388152
361876
387458
388889
387390
73536
388066
38010
416664
58001
416796
368340
360063
55597
398479
55132
431135
412311
395044
73507
430802
54007
339533
58229
710906
58067
376444
717147
388770
73545
384173
55121
36625
57080
463648
56604
700212
339075
354833
55118
339569
56754
399750
680740
37173
387391
339349
339349
336164
58255
396169
339514
397141
339528
339552
396170
422621
710931
643772
396637
362407
451828
38000
55053
339131
416719
76612
56734
362739
55538
670578
624248
40

2025-01-20 13:45:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:45:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:45:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:45:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 229
2025-01-20 13:45:16 - snowflake.connector.connection - INFO - closed
2025-01-20 13:45:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:45:16 - root - INFO - SQL:
-- 14. Select object IDs and cropHintsAnnotation data.
SELECT "object_id", "cropHintsAnnotation"
FROM THE_MET.THE_MET."VISION_API_DATA"
LIMIT 1000
Results:
Too long, hard cut:
object_id,cropHintsAnnotation
463536,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2158,
            ""y"": 0
          },
          {
            ""x"": 2158,
            ""y"": 2871
          },
          {
            ""x"": 0,
            ""y"": 2871
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.700000047683716e-01
    }
  ]
}"
286038,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2490,
            ""y"": 0
          },
          {
            ""x"": 2490,
            ""y"": 3340
          },
          {
            ""x"": 0,
            ""y"": 3340
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 1.100000023841858e+00
    }
  ]
}"
467486,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 1455,
            ""y"": 0
          },
          {
            ""x"": 1455,
            ""y"": 1899
          },
          {
            ""x"": 0,
            ""y"": 1899
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.700000047683716e-01
    }
  ]
}"
386444,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2843,
            ""y"": 0
          },
          {
            ""x"": 2843,
            ""y"": 3734
          },
          {
            ""x"": 0,
            ""y"": 3734
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.799999952316284e-01
    }
  ]
}"
343968,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2873,
            ""y"": 0
          },
          {
            ""x"": 2873,
            ""y"": 3982
          },
          {
            ""x"": 0,
            ""y"": 3982
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.599999845027924e-01
    }
  ]
}"
288535,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2026,
            ""y"": 0
          },
          {
            ""x"": 2026,
            ""y"": 2555
          },
          {
            ""x"": 0,
            ""y"": 2555
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 5.000000000000000e-01
    }
  ]
}"
17449,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2634,
            ""y"": 0
          },
          {
            ""x"": 2634,
            ""y"": 3999
          },
          {
            ""x"": 0,
            ""y"": 3999
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.700000047683716e-01
    }
  ]
}"
343402,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2821,
            ""y"": 0
          },
          {
            ""x"": 2821,
            ""y"": 3718
          },
          {
            ""x"": 0,
            ""y"": 3718
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.700000047683716e-01
    }
  ]
}"
261387,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2484,
            ""y"": 0
          },
          {
            ""x"": 2484,
            ""y"": 2943
          },
          {
            ""x"": 0,
            ""y"": 2943
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.499999940395355e-01
    }
  ]
}"
342591,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2614,
            ""y"": 0
          },
          {
            ""x"": 2614,
            ""y"": 3530
          },
          {
            ""x"": 0,
            ""y"": 3530
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.899999856948853e-01
    }
  ]
}"
2

2025-01-20 13:45:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:45:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:45:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:45:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 120
2025-01-20 13:45:18 - snowflake.connector.connection - INFO - closed
2025-01-20 13:45:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:45:18 - root - INFO - SQL:
-- 15. Select object IDs and titles from OBJECTS where department is 'The Libraries' and metadata_date is not null.
SELECT "object_id", "title"
FROM THE_MET.THE_MET."OBJECTS"
WHERE "department" = 'The Libraries' AND "metadata_date" IS NOT NULL
LIMIT 1000
Results:
Too long, hard cut:
object_id,title
682011,Dialogo sobre hua nova obra no Rio Tejo ...
681546,De' ragguagli di Parnaso: Centuria prima-seconda
681534,"Contes et nouvelles de Bocace florentin : traduction libre, accommodée au gout de ce temps, & enrichie de figures en taille-douce gravées par Mr. Romain de Hooge"
681389,"Uffizio della Settimana Santa : colle rubriche volgari, argomenti de' Salmi, spiegazione delle cerimonie e misterj, con osservazioni, e riflessioni divote dell'abate Alessandro Mazzinelli"
591832,"Academie de l'espee; ou se domonstrent par reigles mathématiques sur le fondement d'un cercle mystérieux, la théorie et pratique des vrais . . ."
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans
591831,"Descriptio pbvlicae gratvlationis, spectacvlorvm et lvdorvm, in aventv sereniss: Principis Ernesti Archidvcis Avstriae Dvcis Vrgvndiae"
591865,Morte d'Arthur
591848,"The Holy Land, Syria, Idumea, Arabia, Egypt & Nubia"
591863,"Catalogue of the Collection of Jewels and Precious Works of Art, the Property of  J. Pierpont Morgan"
681573,"Les oeuvres morales de Mr. Diderot : contenant son traité De l'amitié, et celui Des passions"
682013,L'eschole de Salerne en vers burlesques & duo poemata macaronica: de bello huguenotico: et De gestis magnanimi & prudentissimi Baldi
681149,Bibliorum Sacrorum Vulgatae versionis
681556,Mémoires du Comte de Grammont : histoire amoureuse de la cour d'Angleterre sous Charles II / par Antoine Hamilton ; préface et notes par Benjamin Pifteau
681388,"Traité de Plutarque, sur la manière de discerner un flatteur d'avec un ami et Le banquet des sept sages: dialogue du même auteur revu & corrigé sur des manuscrits de la Bibliothèque du roi; avec une version françoise & des notes"
680835,"L'art de former les jardins modernes, ou, L'art des jardins anglois : traduit de l'anglois : à quoi le traducteur a ajouté un discours préliminaire sur l'origine de l'art, des notes sur le texte, & une description détaillée des jardins de Stowe, accompagnée du plan"
681547,"De l'imitation de Jesus-Christ, traduction nouvelle ; ornée de figures en taille-douce"
681545,Contes et nouvelles en vers par Jean de la Fontaine
682014,Figures françoises et comiques nouvellement inventées par M. Watteau; Figures de modes dessinées et gravées à l'eau forte par Watteau; a terminées au buin par Thomassin le fils
681128,"Les aventures de Télémaque, fils d'Ulysse par M. de Fénélon ; avec figures en taille-douce, dessinées par MM. Cochin et Moreau le jeune"
682012,Epistole eroiche di P. Ovidio Nasone
681563,"Oeuvres de Moliere : avec des remarques grammaticales, des avertissemens et des observations sur chaque piéce, par M. Bret"
716648,"Planches pour l'Encyclopédie, ou pour le Dictionaire raisonné des sciences, des arts libéraux, et des arts méchaniques, avec leur explication"
705290,博古圖錄
715005,三禮圖
739504,Examples of Chinese ornament selected from objects in the South Kensington Museum and other collections
726677,"The sunshade, the glove, the muff"
716639,"Encyclopédie, ou Dictionnaire raisonné des sciences, des arts et des métiers, par une société de gens de lettres"
699505,"Dialogos de la pintvra : sv defensa, origen, essecia, definicion, modos y diferencias"
697348,Der aller durchleuchtigisten und grosmächtigen Kayser ... Königen ... Herren vom Adel ... Bildtnussen und kurtz Beschreibungen ihrer so wol in Fridts- als Kriegszzeiten verrichten fürnembsten Thaten und Handlungen : deren Waffen und Rüstungen ... auss allen Landen der Welt ... in dem Schloss Ombrass ... zu ewiger Gedächtnuss auffbehalten werden ...
681349,"Calendrier belgique, curieux et utile, contenant les evenemens historiques sur les jours de l'an, et les travaux à faire dans les jardins en chaque mois de l'année, la description des tableaux remarquables, que l'on trouve dans la ville de Gand, avec les noms des peintres pour l'annėe MDCCLXXII"
591837,Le pitture e sculture di Brescia che sono esposte al pubblico con un' appendice di alcune private gallerie
591862,"Edwin Davis French, A Memorial: His Life, His Art"
591836,Il Ritratto di Venezia
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found"
738466,Modern chromatics : with applications to art and industry
700032,Petri Gyllii De Bosporo thracio libri III ; Petri Gyllii De topographia Constantinopoleos
700050,"Traité de l'horlogerie, méchanique et pratique, approuvé par l'Academie royale des sciences"
738463,"The principles of harmony and contrast of colours, and their applications to the arts"
704714,Mr. Vanderbilt's house and collection
700240,"The cabinet-maker and upholsterer's guide, or, Repository of designs for every article of household furniture, in the newest and most approved taste : displaying a great variety of patterns for chairs, stools ... in the plainest and most enriched styles : with a scale to each, and an e

2025-01-20 13:45:18 - root - INFO - itercount: 0
2025-01-20 13:45:18 - root - INFO - Database Name: THE_MET
Schema Name: THE_MET
DDL describes table information.
,0
table_name,VISION_API_DATA
description,
DDL,"create or replace TABLE VISION_API_DATA (
	""object_id"" NUMBER(38,0),
	""faceAnnotations"" VARIANT,
	""landmarkAnnotations"" VARIANT,
	""cropHintsAnnotation"" VARIANT,
	""logoAnnotations"" VARIANT,
	""labelAnnotations"" VARIANT,
	""textAnnotations"" VARIANT,
	""fullTextAnnotation"" VARCHAR(16777216),
	""imagePropertiesAnnotation"" VARIANT,
	""safeSearchAnnotation"" VARCHAR(16777216),
	""webDetection"" VARIANT
);"

,1
table_name,IMAGES
description,
DDL,"create or replace TABLE IMAGES (
	""object_id"" NUMBER(38,0),
	""public_caption"" VARCHAR(16777216),
	""title"" VARCHAR(16777216),
	""original_image_url"" VARCHAR(16777216),
	""caption"" VARCHAR(16777216),
	""is_oasc"" BOOLEAN,
	""gcs_url"" VARCHAR(16777216)
);"

,2
table_name,OBJECTS
description,
DDL,"create or replace TABLE OBJECTS (
	""object_number"" VARCHAR(16777216),
	""is_highlight"" BOOLEAN,
	""is_public_domain"" BOOLEAN,
	""object_id"" NUMBER(38,0),
	""department"" VARCHAR(16777216),
	""object_name"" VARCHAR(16777216),
	""title"" VARCHAR(16777216),
	""culture"" VARCHAR(16777216),
	""period"" VARCHAR(16777216),
	""dynasty"" VARCHAR(16777216),
	""reign"" VARCHAR(16777216),
	""portfolio"" VARCHAR(16777216),
	""artist_role"" VARCHAR(16777216),
	""artist_prefix"" VARCHAR(16777216),
	""artist_display_name"" VARCHAR(16777216),
	""artist_display_bio"" VARCHAR(16777216),
	""artist_suffix"" VARCHAR(16777216),
	""artist_alpha_sort"" VARCHAR(16777216),
	""artist_nationality"" VARCHAR(16777216),
	""artist_begin_date"" VARCHAR(16777216),
	""artist_end_date"" VARCHAR(16777216),
	""object_date"" VARCHAR(16777216),
	""object_begin_date"" NUMBER(38,0),
	""object_end_date"" NUMBER(38,0),
	""medium"" VARCHAR(16777216),
	""dimensions"" VARCHAR(16777216),
	""credit_line"" VARCHAR(16777216),
	""geography_type"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""subregion"" VARCHAR(16777216),
	""locale"" VARCHAR(16777216),
	""locus"" VARCHAR(16777216),
	""excavation"" VARCHAR(16777216),
	""river"" VARCHAR(16777216),
	""classification"" VARCHAR(16777216),
	""rights_and_reproduction"" VARCHAR(16777216),
	""link_resource"" VARCHAR(16777216),
	""metadata_date"" NUMBER(38,0),
	""repository"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'THE_MET': {'THE_MET': ['IMAGES', 'OBJECTS', 'VISION_API_DATA']}}
Begin Exploring Related Columns
Here are the relevant tables and columns for the task:

**From `OBJECTS` table:**
- **"object_id"**: Used to identify objects and join with `VISION_API_DATA`.
- **"title"**: To retrieve the object's title and filter titles containing the word "book".
- **"metadata_date"**: To retrieve and format as a string in 'YYYY-MM-DD' format.
- **"department"**: To filter objects that belong to "The Libraries" department.

**From `VISION_API_DATA` table:**
- **"object_id"**: Used to join with `OBJECTS`.
- **"cropHintsAnnotation"**: To extract the `cropConfidence` value.

**Possible conditions that may be used:**
- **Objects where "department" = 'The Libraries'**.
- **Objects where "title" ILIKE '%book%'** (case-insensitive search for 'book' in the title).
- **Records where extracted "cropConfidence" > 0.5**.

Below are at least 10 simple, short, non-nested SQL queries to explore the values in the related columns. Each query is different and follows the guidelines provided.

```sql
-- 1. Select distinct departments from the OBJECTS table.
SELECT DISTINCT "department"
FROM THE_MET.THE_MET."OBJECTS"
LIMIT 1000;

-- 2. Select object IDs and titles where the title contains 'book'.
SELECT "object_id", "title"
FROM THE_MET.THE_MET."OBJECTS"
WHERE "title" ILIKE '%book%'
LIMIT 1000;

-- 3. Select object IDs and metadata dates from OBJECTS where department is 'The Libraries'.
SELECT "object_id", "metadata_date"
FROM THE_MET.THE_MET."OBJECTS"
WHERE "department" = 'The Libraries'
LIMIT 1000;

-- 4. Select object IDs and departments where the title contains 'book'.
SELECT "object_id", "department"
FROM THE_MET.THE_MET."OBJECTS"
WHERE "title" ILIKE '%book%'
LIMIT 1000;

-- 5. Select object IDs from VISION_API_DATA where cropHintsAnnotation is not null.
SELECT "object_id"
FROM THE_MET.THE_MET."VISION_API_DATA"
WHERE "cropHintsAnnotation" IS NOT NULL
LIMIT 1000;

-- 6. Extract cropConfidence values from VISION_API_DATA.
SELECT t."object_id", f.value:"confidence"::FLOAT AS "cropConfidence"
FROM THE_MET.THE_MET."VISION_API_DATA" t, LATERAL FLATTEN(input => t."cropHintsAnnotation":"cropHints") f
LIMIT 1000;

-- 7. Select object IDs and titles where department is 'The Libraries' and title contains 'book'.
SELECT "object_id", "title"
FROM THE_MET.THE_MET."OBJECTS"
WHERE "department" = 'The Libraries' AND "title" ILIKE '%book%'
LIMIT 1000;

-- 8. Extract and filter cropConfidence values greater than 0.5.
SELECT t."object_id", f.value:"confidence"::FLOAT AS "cropConfidence"
FROM THE_MET.THE_MET."VISION_API_DATA" t, LATERAL FLATTEN(input => t."cropHintsAnnotation":"cropHints") f
WHERE f.value:"confidence"::FLOAT > 0.5
LIMIT 1000;

-- 9. Select object IDs where metadata_date is not null.
SELECT "object_id"
FROM THE_MET.THE_MET."OBJECTS"
WHERE "metadata_date" IS NOT NULL
LIMIT 1000;

-- 10. Select metadata_date from OBJECTS to examine date formats.
SELECT "metadata_date"
FROM THE_MET.THE_MET."OBJECTS"
LIMIT 1000;

-- 11. Select object IDs and titles with metadata dates after a specific date.
SELECT "object_id", "title"
FROM THE_MET.THE_MET."OBJECTS"
WHERE "metadata_date" > 20200101
LIMIT 1000;

-- 12. Select object IDs and descriptions from labelAnnotations in VISION_API_DATA.
SELECT t."object_id", f.value:"description"::STRING AS "labelDescription"
FROM THE_MET.THE_MET."VISION_API_DATA" t, LATERAL FLATTEN(input => t."labelAnnotations") f
LIMIT 1000;

-- 13. Select object IDs from VISION_API_DATA where labelAnnotations contain 'book'.
SELECT t."object_id"
FROM THE_MET.THE_MET."VISION_API_DATA" t, LATERAL FLATTEN(input => t."labelAnnotations") f
WHERE f.value:"description"::STRING ILIKE '%book%'
LIMIT 1000;

-- 14. Select object IDs and cropHintsAnnotation data.
SELECT "object_id", "cropHintsAnnotation"
FROM THE_MET.THE_MET."VISION_API_DATA"
LIMIT 1000;

-- 15. Select object IDs and titles from OBJECTS where department is 'The Libraries' and metadata_date is not null.
SELECT "object_id", "title"
FROM THE_MET.THE_MET."OBJECTS"
WHERE "department" = 'The Libraries' AND "metadata_date" IS NOT NULL
LIMIT 1000;
```

These queries help in understanding the data in the relevant columns and how they might be used to achieve the final task. They cover different aspects such as filtering by department, title, exploring nested JSON structures, and extracting specific values from the variant columns.Query:
-- 1. Select distinct departments from the OBJECTS table.
SELECT DISTINCT "department"
FROM THE_MET.THE_MET."OBJECTS"
LIMIT 1000
Answer:
department
Asian Art
Islamic Art
Photographs
Medieval Art
The Cloisters
The Libraries
Arms and Armor
Costume Institute
European Paintings
Drawings and Prints
Greek and Roman Art
Musical Instruments
Ancient Near Eastern Art
Robert Lehman Collection
Modern and Contemporary Art
American Paintings and Sculpture
"Arts of Africa, Oceania, and the Americas"
American Decorative Arts
European Sculpture and Decorative Arts
Egyptian Art
Query:
-- 2. Select object IDs and titles where the title contains 'book'.
SELECT "object_id", "title"
FROM THE_MET.THE_MET."OBJECTS"
WHERE "title" ILIKE '%book%'
LIMIT 1000
Answer:
Too long, hard cut:
object_id,title
39483,明     郭詡     稱書圖     軸|Weighing Books
39667,明     杜堇     伏生授經圖   軸|The Scholar Fu Sheng Transmitting the Book of Documents
57754,画本宝能縷|Picture Book of Brocades with Precious Threads (Ehon takara no itosuji)
78593,絵本松のしらべ|Picture Book on the Music of the Pine Trees (Ehon matsu no shirabe)
78688,『和国諸職絵尽　諸織 絵本鏡』|A Picture Book Mirror of Various Occupations (Wakoku shoshoku ezukushi)
53815,Ehon Asakayama|絵本浅香山|Picture Book: Mount Asaka (Ehon Asakayama)
45062,"絵本末摘花|Picture Book: Flowers Yet to be Picked, Vol. 1"
57842,Ehon Ogurayama|絵本小倉山|Picture Book: Ogura Hill (Ehon Ogurayama)
57858,Ehon Himetsubaki|繪本女貞木|Picture Book: Camellia (Ehon Himetsubaki)
78723,『繪本常盤草』|Picture Book of the Evergreens (Ehon tokiwagusa)
78728,『繪本小倉山』|Picture Book of Ogura Hill (Ehon ogurayama)
78729,『繪本小松原』|Picture Book of Komatsubara (Ehon komatsubara)
78722,絵本常盤草　上・中・下|Picture Book of the Evergreens (Ehon tokiwagusa)
78585,『寫山樓畫本』|Shazanrō (Bunchō) Picture Book (Shazanrō ehon)
78739,『絵本時世粧』|Picture Book of Modern Figures of Fashion (Ehon imayō sugata)
78597,艶本 婦慈のゆき|An Erotic Picture Book of Snow on Fuji (Enpon fuji no yuki)
45273,絵本吾妻遊|Ehon Azuma asobi|Picture Book of Amusements of the Eastern Capital (Ehon Azuma asobi)
57568,Ehon Momochidori Kyōka-awase|百千鳥狂歌合|Myriad Birds: Picture Book of Playful Verse (Momo chidori kyōka-awase)
57605,絵本和歌夷 「龢謌夷」|Picture Book with Playful Poems for the Young God Ebisu
57648,潮干のつと|Gifts from the Ebb Tide (The Shell Book) (Shiohi no tsuto)
57569,画本虫撰|Picture Book of Crawling Creatures (The Insect Book) (Ehon mushi erami)
57570,画本虫撰|Picture Book of Crawling Creatures (The Insect Book) (Ehon mushi erami)
45322,繪本四季花|Picture Book of Flowers of the Four Seasons (Ehon shiki no hana)
78746,『青楼繪本年中行事』|Yoshiwara Picture Book of New Year’s Festivities (Seirō ehon nenjū gyōji)
78758,（榎木新右衛門）画 『雛形伊勢乃海』|Book of Kosode Patterns (Hiinagata Ise no umi)
45444,Ehon Musashi no Abumi|A Picture Book of Japanese Warriors
78635,『画本狂歌山満多山』|Picture Book of Kyōka Poems: Mountains upon Mountains (Ehon kyōka yama mata yama)
78771,"繪本彩色通　初編|Picture Book on the Use of Coloring, first volume (Ehon saishikitsū shohen)"
78772,『絵本和漢誉』|Picture Book on Heroes of China and Japan (Ehon wakan no homare)
78667,『暁斎漫画』|Kyōsai Sketchbook (Kyōsai manga)
55597,"『閨の雛形』　正月|Plate from the Erotic Book Mounds of Dyed Colors: A Pattern Book for the Boudoir (Someiro no yama neya no hinagata), First Month"
37283,"『画本虫撰』  「蜂」「毛虫」|Paper Wasp (Hachi); Hairy Caterpillar (Kemushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37284,"『画本虫撰』   「馬追虫」「むかて」|Katydid (Umaoi-mushi); Centipede, (Mukade), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37285,"『画本虫撰』   「けら」「はさみむし」|Mole Cricket (Kera); Earwig, (Hasami-mushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37286,"『画本虫撰』   「蝶」「蜻蛉」|Butterfly (Chō); Dragonfly (Kagerō or Tonbo), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37287,"『画本虫撰』  「虻」「芋虫」|Horsefly (abu); Green Caterpillar, imomushi, from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37288,"『画本虫撰』   「松虫」「虫蛍」|Tree cricket (Matsumushi); Firefly (Hotaru), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37289,"画本虫撰　バッタと蟷螂|Cone-headed Grasshopper or Locust, (batta); Praying Mantis (Tōrō or Kamakiri), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37290,"『画本虫撰』 「ひくらし」「くも」|Evening Cicada, Higurashi; Spider, Kumo, from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37291,"『画本虫撰』「赤蜻蛉」「いなこ」|Red Dragonfly (Akatonbo); Locust (Inago), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37292,"『画本虫撰』「虵」「とかけ」|Rat Snake (Hebi); Lizard or Skink (Tokage), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37293,"『画本虫撰』「蓑虫」「兜虫」|Bagworm (Minomushi); Horned Scarab Beetle (Kabutomushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37294,"『画本虫撰』「蝸牛」「轡虫」|Land Snail (Katatsumuri); Giant Katydid (Kutsuwamushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37295,"『画本虫撰』「きりきりす」「蝉」|Grasshopper (Kirigirisu); Cicada (Semi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37296,"『画本虫撰』「蚓」「こうろき」|Earthworm (Mimizu); Cricket (Kōrogi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37306,"四季の花|The Coming Thunderstorm, from the illustrated book Flowers of the Four Seasons"
37307,"四季の花|Women on a Bridge, from the illustrated book Flowers of the Four Seasons"
37308,"四季の花|A Child Lighting Fireworks, from the illustrated book Flowers of the Four Seasons"
37309,"四季の花|Girls Getting on Board a Boat, from the illustrated book Flowers of the Four Seasons"
37310,"四季の花|Girls Picking Green Leaves, from the illustrated book Flowers of the Four Seasons"
37311,"四季の花|New Year's Games, from the printed book Flowers of the Four Seasons (Shiki no hana)"
37312,"四季の花|Girls Entertained by Performers, from the illustrated book Flowers of the Four Seasons"
37313,"四季の花
Query:
-- 3. Select object IDs and metadata dates from OBJECTS where department is 'The Libraries'.
SELECT "object_id", "metadata_date"
FROM THE_MET.THE_MET."OBJECTS"
WHERE "department" = 'The Libraries'
LIMIT 1000
Answer:
object_id,metadata_date
682011,1486368016000000
681546,1486368016000000
681534,1486368016000000
681389,1486368016000000
591832,1486368016000000
591860,1486368016000000
591831,1486368016000000
591865,1486368016000000
591848,1486368016000000
591863,1486368016000000
681573,1486368016000000
682013,1486368016000000
681149,1486368016000000
681556,1486368016000000
681388,1486368016000000
680835,1486368016000000
681547,1486368016000000
681545,1486368016000000
682014,1486368016000000
681128,1486368016000000
682012,1486368016000000
681563,1486368016000000
716648,1486368016000000
705290,1486368016000000
715005,1486368016000000
739504,1486368016000000
726677,1486368016000000
716639,1486368016000000
699505,1486368016000000
697348,1486368016000000
681349,1486368016000000
591837,1486368016000000
591862,1486368016000000
591836,1486368016000000
700238,1486368016000000
738466,1486368016000000
700032,1486368016000000
700050,1486368016000000
738463,1486368016000000
704714,1486368016000000
700240,1486368016000000
738758,1486368016000000
700232,1486368016000000
700091,1486368016000000
738765,1486368016000000
682010,1486368016000000
681259,1486368016000000
726717,1486368016000000
707455,1486368016000000
726673,1486368016000000
726669,1486368016000000
681246,1486368016000000
679732,1486368016000000
726678,1486368016000000
591835,1486368016000000
681559,1486368016000000
591839,1486368016000000
681502,1486368016000000
680708,1486368016000000
682015,1486368016000000
681386,1486368016000000
679476,1486368016000000
681551,1486368016000000
680818,1486368016000000
680752,1486368016000000
591844,1486368016000000
591849,1486368016000000
591830,1486368016000000
591824,1486368016000000
591834,1486368016000000
591854,1486368016000000
591840,1486368016000000
591864,1486368016000000
591841,1486368016000000
591855,1486368016000000
591842,1486368016000000
681372,1486368016000000
591845,1486368016000000
591847,1486368016000000
591829,1486368016000000
591828,1486368016000000
591825,1486368016000000
591827,1486368016000000
681554,1486368016000000
591857,1486368016000000
591850,1486368016000000
591852,1486368016000000
591853,1486368016000000
591859,1486368016000000
591858,1486368016000000
591861,1486368016000000
591843,1486368016000000
681357,1486368016000000
680832,1486368016000000
679629,1486368016000000
679465,1486368016000000
724625,1486368016000000
591826,1486368016000000
591838,1486368016000000
591833,1486368016000000
705638,1486368016000000
681274,1486368016000000
681504,1486368016000000
678732,1486368016000000
680821,1486368016000000
682098,1486368016000000
680318,1486368016000000
591856,1486368016000000
681384,1486368016000000
591851,1486368016000000
591846,1486368016000000
591868,1486368016000000
734108,1486368016000000
734109,1486368016000000
734110,1486368016000000
734111,1486368016000000
738516,1486368016000000
680819,1486368016000000
679638,1486368016000000
681269,1486368016000000
Query:
-- 4. Select object IDs and departments where the title contains 'book'.
SELECT "object_id", "department"
FROM THE_MET.THE_MET."OBJECTS"
WHERE "title" ILIKE '%book%'
LIMIT 1000
Answer:
Too long, hard cut:
object_id,department
39483,Asian Art
39667,Asian Art
57754,Asian Art
78593,Asian Art
78688,Asian Art
53815,Asian Art
45062,Asian Art
57842,Asian Art
57858,Asian Art
78723,Asian Art
78728,Asian Art
78729,Asian Art
78722,Asian Art
78585,Asian Art
78739,Asian Art
78597,Asian Art
45273,Asian Art
57568,Asian Art
57605,Asian Art
57648,Asian Art
57569,Asian Art
57570,Asian Art
45322,Asian Art
78746,Asian Art
78758,Asian Art
45444,Asian Art
78635,Asian Art
78771,Asian Art
78772,Asian Art
78667,Asian Art
55597,Asian Art
37283,Asian Art
37284,Asian Art
37285,Asian Art
37286,Asian Art
37287,Asian Art
37288,Asian Art
37289,Asian Art
37290,Asian Art
37291,Asian Art
37292,Asian Art
37293,Asian Art
37294,Asian Art
37295,Asian Art
37296,Asian Art
37306,Asian Art
37307,Asian Art
37308,Asian Art
37309,Asian Art
37310,Asian Art
37311,Asian Art
37312,Asian Art
37313,Asian Art
37297,Asian Art
54180,Asian Art
37147,Asian Art
55944,Asian Art
51996,Asian Art
56776,Asian Art
56777,Asian Art
57101,Asian Art
55596,Asian Art
50915,Asian Art
283195,Photographs
286128,Photographs
296355,Photographs
288310,Photographs
271512,Photographs
684347,Photographs
291811,Photographs
265780,Photographs
291817,Photographs
282767,Photographs
267551,Photographs
267566,Photographs
267777,Photographs
467415,Medieval Art
466677,Medieval Art
591860,The Libraries
700238,The Libraries
700232,The Libraries
591861,The Libraries
35148,Arms and Armor
437030,European Paintings
353372,Drawings and Prints
352518,Drawings and Prints
359185,Drawings and Prints
338275,Drawings and Prints
357159,Drawings and Prints
349141,Drawings and Prints
352787,Drawings and Prints
347880,Drawings and Prints
344959,Drawings and Prints
347878,Drawings and Prints
357281,Drawings and Prints
344334,Drawings and Prints
348387,Drawings and Prints
346441,Drawings and Prints
355064,Drawings and Prints
353133,Drawings and Prints
346498,Drawings and Prints
346493,Drawings and Prints
348343,Drawings and Prints
358573,Drawings and Prints
355046,Drawings and Prints
355616,Drawings and Prints
337788,Drawings and Prints
334159,Drawings and Prints
339135,Drawings and Prints
349013,Drawings and Prints
339888,Drawings and Prints
334265,Drawings and Prints
356961,Drawings and Prints
407165,Drawings and Prints
348912,Drawings and Prints
356036,Drawings and Prints
397628,Drawings and Prints
377013,Drawings and Prints
399255,Drawings and Prints
399270,Drawings and Prints
382949,Drawings and Prints
383021,Drawings and Prints
377455,Drawings and Prints
670577,Drawings and Prints
392587,Drawings and Prints
390160,Drawings and Prints
659683,Drawings and Prints
341445,Drawings and Prints
343597,Drawings and Prints
416896,Drawings and Prints
392954,Drawings and Prints
341455,Drawings and Prints
670559,Drawings and Prints
357597,Drawings and Prints
394223,Drawings and Prints
394224,Drawings and Prints
394225,Drawings and Prints
413962,Drawings and Prints
413981,Drawings and Prints
413931,Drawings and Prints
413961,Drawings and Prints
413980,Drawings and Prints
394665,Drawings and Prints
397456,Drawings and Prints
397461,Drawings and Prints
397463,Drawings and Prints
394050,Drawings and Prints
394049,Drawings and Prints
414091,Drawings and Prints
414086,Drawings and Prints
414087,Drawings and Prints
414088,Drawings and Prints
414089,Drawings and Prints
414090,Drawings and Prints
412622,Drawings and Prints
412643,Drawings and Prints
371685,Drawings and Prints
381807,Drawings and Prints
335709,Drawings and Prints
335708,Drawings and Prints
344023,Drawings and Prints
335331,Drawings and Prints
336891,Drawings and Prints
336880,Drawings and Prints
384117,Drawings and Prints
335817,Drawings and Prints
364054,Drawings and Prints
397985,Drawings and Prints
389361,Drawings and Prints
336710,Drawings and Prints
343431,Drawings and Prints
339774,Drawings and Prints
336604,Drawings and Prints
335706,Drawings and Prints
335720,Drawings and Prints
335719,Drawings and Prints
335705,Drawings and Prints
370936,Drawings and Prints
629783,Drawings and Prints
670019,Drawings and Prints
651010,Drawings and Prints
650913,Drawings and Prints
386345,Drawings and Prints
383882,Drawings and Prints
407351,Drawings and Prints
398772,Drawings and Prints
650984,Drawings and Prints
340595,Drawings and Prints
371142,Drawings and Prints
383466,Drawings and Prints
383467,Drawings and Prints
383460,Drawings and Prints
383457,Drawings and Prints
383458,Drawings and Prints
383459,Drawings and Prints
383456,Drawings and Prints
383455,Drawings and Prints
383451,Drawings and Prints
383290,Drawings and Prints
383453,Drawings and Prints
383464,Drawings and Prints
371141,Drawings and Prints
383509,Drawings and Prints
383508,Drawings and Prints
383507,Drawings and Prints
383506,Drawings and Prints
383470,Drawings and Prints
383469,Drawings and Prints
383468,Drawings and Prints
383462,Drawings and Prints
396210,Drawings and Prints
377016,Drawings and Prints
377018,Drawings and Prints
377019,Drawings and Prints
377017,Drawings and Prints
377020,Drawings 
Query:
-- 5. Select object IDs from VISION_API_DATA where cropHintsAnnotation is not null.
SELECT "object_id"
FROM THE_MET.THE_MET."VISION_API_DATA"
WHERE "cropHintsAnnotation" IS NOT NULL
LIMIT 1000
Answer:
Too long, hard cut:
object_id
395469
342852
717610
400806
398754
436661
650943
193649
308544
37881
371350
480520
469947
291865
391445
339498
342882
342608
352216
306752
271733
73626
372777
365590
10791
364281
365693
10928
387577
370771
37186
393209
337266
388957
394628
339515
414492
383921
410182
338422
369156
348596
678732
203203
340976
261016
410050
400836
467466
467935
409982
414746
334626
254207
4249
4199
4209
4241
435719
11603
56748
403635
340262
15089
685801
397498
472322
471962
460419
260285
726543
366993
55968
285781
544689
544693
394436
50799
345808
208998
189298
623053
391175
53926
435834
246992
322367
412823
387572
73555
339492
357054
414695
391517
392595
428774
10466
335405
371555
368343
261801
54624
394340
285465
54870
194110
428755
196160
15025
549533
263193
242193
343111
189551
465955
737547
363904
364069
54499
470282
288515
337263
45241
645240
416247
348790
339554
250968
206819
543873
471055
623067
471557
459205
12563
261590
198277
337168
506089
374026
36607
467941
341201
349127
437866
206049
242318
633310
10961
343310
252916
288159
205109
38481
55320
11842
193822
11408
348978
670559
395879
38646
55397
436190
207814
255899
367190
54819
470265
250655
206873
10970
459399
359089
11489
435709
53181
254915
406441
56602
103035
633569
11512
646609
242375
192720
385670
45493
288528
231788
207397
45494
204169
335536
469877
12707
54678
469719
403218
548343
436205
251493
358785
436912
205413
406435
205461
452121
428022
191486
39249
61627
11791
42724
436179
384063
261480
437363
369411
11175
343748
437425
441234
436522
11742
358365
81550
369805
200939
334871
436581
264366
682875
436583
11249
337062
11699
437678
437365
38335
38328
623036
45223
436423
261347
11112
338743
44799
41328
318990
448463
195644
13046
55716
333811
437325
436240
204109
436297
436877
389958
547751
408997
19232
13338
251799
338426
268330
437803
291844
189351
236189
291939
187146
200018
335751
414312
738805
291912
393587
735991
188886
51832
906
348997
418092
198199
291850
368857
736681
199327
246588
685841
291759
386402
203577
384069
209526
388394
369166
291945
632896
736576
203418
197997
187145
692328
377079
392753
671454
64852
73547
114731
195738
463772
15074
13784
203574
203576
471964
633372
398655
195317
388733
207157
207401
463889
467523
203221
468684
210006
436932
362159
199273
193974
392476
59963
342594
200901
194167
692345
203378
201735
436461
376604
436483
346326
195345
59964
191883
470146
198066
12959
59156
382486
55626
357710
291889
662899
737704
468692
468320
362191
337261
342593
393439
195341
285443
391816
37334
437060
463681
197214
530
250825
42492
32831
288611
464268
467939
196415
197075
342534
415389
468266
197053
189699
463824
194349
18958
659991
385068
385968
51771
401174
342535
268458
73515
392721
195118
385696
389031
461448
73406
380479
383686
435302
260112
417855
463397
645329
188884
344098
367042
349097
396160
336046
193343
227725
392843
51996
264597
467997
10966
438850
460166
364035
435621
76971
467594
458994
436987
435641
459046
10240
464588
38822
436951
54782
73443
206575
288154
399211
283160
366658
248730
291873
698512
57134
248580
459068
336871
446180
642926
452680
205315
254590
398594
106068
355542
271737
73417
338709
198644
435682
73474
10878
437539
437865
459090
436871
17187
436078
471918
436570
435868
13533
437181
391788
437062
726258
190635
37865
57091
73511
219476
209266
291879
386151
397749
267997
356888
291869
638762
73459
356494
45580
367347
285472
369299
361790
458981
357998
73625
366984
36687
453210
670999
55471
414398
52000
38304
626352
471840
282051
248139
436907
246592
11417
437578
337399
436687
459129
438848
466799
459202
337327
368033
428633
437927
54834
453107
400424
260178
645094
396200
260114
205194
647645
55443
736722
349033
362018
469891
261383
428328
384809
387496
54581
16496
264575
383917
459292
338316
217908
268553
393369
464269
221529
54505
344147
383901
390698
336915
55549
464365
471966
200872
736611
460077
436979
736748
198995
464154
268026
367533
54854
400007
343604
334306
156572
194141
625313
466086
44893
334884
360376
367463
384489
386153
437258
335843
633672
383804
364998
366088
53596
288543
436625
463037
466685
367006
437144
467992
435585
435908
283200
435809
386304
265091
459136
199706
269875
335654
441965
436261
381537
199056
10405
13051
437969
652270
667918
716365
36939
291868
285466
360619
337670
623626
342539
414803
37303
226956
371462
342668
55944
284817
55402
269851
392618
291117
436918
437826
386578
387578
436990
437841
435765
437403
437414
288511
435693
437871
435722
702752
11525
435851
202639
392791
389793
342666
418745
698737
361707
708058
364248
21186
268557
268108
56757
357164
475385
56742
196743
340893
464596
392158
263859
287965
55891
44698
203631
459304
392926
353833
659877
359967
291890
37141
196591
269651
421492
271736
291895
464118
365694
342578
467933
436062
339524
335848
12822
333879
255881
435899
10832
285444
205267
468441
386400
437555
386451
467778
416094
452014
78060
8541
201454
286348
363545
57756
286620
193978
736719
736059
197077
366225
268809
484464
384963
436493
20162
Query:
-- 6. Extract cropConfidence values from VISION_API_DATA.
SELECT t."object_id", f.value:"confidence"::FLOAT AS "cropConfidence"
FROM THE_MET.THE_MET."VISION_API_DATA" t, LATERAL FLATTEN(input => t."cropHintsAnnotation":"cropHints") f
LIMIT 1000
Answer:
Too long, hard cut:
object_id,cropConfidence
463536,1.0
286038,1.0
467486,1.0
386444,1.0
343968,1.0
288535,1.0
17449,1.0
343402,1.0
261387,1.0
342591,1.0
263135,1.0
361703,1.0
729624,1.0
385957,1.0
659124,1.0
345721,1.0
196356,1.0
339707,1.0
367415,1.0
398595,1.0
55574,1.0
197750,1.0
229095,1.0
471848,1.0
436731,1.0
198587,1.0
340058,1.0
349162,1.0
452670,1.0
342501,1.0
37895,1.0
399212,1.0
54652,1.0
11777,1.0
459002,1.0
11372,1.0
397694,1.0
206589,1.0
338515,1.0
364382,1.0
436770,1.0
10401,1.0
64534,1.0
471995,1.0
385089,1.0
342748,1.0
436911,1.0
102243,1.0
11798,1.0
11707,1.0
437490,1.0
438820,1.0
437703,1.0
475487,1.0
459040,1.0
291887,1.0
436664,1.0
463545,1.0
191777,1.0
349309,1.0
467808,1.0
205239,1.0
58026,1.0
269254,1.0
428639,1.0
260058,1.0
237070,1.0
260182,1.0
237754,1.0
45445,1.0
60060,1.0
403086,1.0
700206,1.0
371456,1.0
464151,1.0
187761,1.0
188903,1.0
398499,1.0
204625,1.0
206168,1.0
434111,1.0
393331,1.0
362267,1.0
16665,1.0
288561,1.0
250549,1.0
343201,1.0
1683,1.0
387537,1.0
391793,1.0
399237,1.0
14942,1.0
55423,1.0
195760,1.0
260113,1.0
37125,1.0
364839,1.0
366887,1.0
463765,1.0
451972,1.0
189163,1.0
56753,1.0
203111,1.0
190623,1.0
360642,1.0
202343,1.0
36707,1.0
189644,1.0
382454,1.0
56027,1.0
390689,1.0
59185,1.0
189700,1.0
194324,1.0
386145,1.0
642888,1.0
431358,1.0
302131,1.0
46445,1.0
268128,1.0
51416,1.0
286615,1.0
387541,1.0
367468,1.0
392932,1.0
434603,1.0
260140,1.0
269271,1.0
437069,1.0
460208,1.0
473465,1.0
156808,1.0
464299,1.0
204722,1.0
454344,1.0
36654,1.0
41933,1.0
438026,1.0
11274,1.0
189712,1.0
383935,1.0
63832,1.0
399691,1.0
442749,1.0
625354,1.0
38582,1.0
339119,1.0
55199,1.0
342463,1.0
227026,1.0
407167,1.0
704827,1.0
435691,1.0
436738,1.0
337665,1.0
377467,1.0
459019,1.0
271746,1.0
631422,1.0
436759,1.0
365816,1.0
12731,1.0
451283,1.0
208809,1.0
399545,1.0
249164,1.0
435766,1.0
73439,1.0
339543,1.0
10337,1.0
459015,1.0
437422,1.0
667926,1.0
459023,1.0
249232,1.0
435702,1.0
467508,1.0
435754,1.0
391053,1.0
350970,1.0
369533,1.0
453683,1.0
356476,1.0
436103,1.0
488733,1.0
10389,1.0
58263,1.0
13050,0.29999998211860657
37993,1.0
436892,1.0
656826,1.0
392687,1.0
359151,1.0
337761,1.0
361613,1.0
730790,1.0
286173,1.0
269253,1.0
344140,1.0
260348,1.0
388833,1.0
712946,1.0
260126,1.0
436900,1.0
339559,1.0
342502,1.0
54660,1.0
437004,1.0
194541,1.0
260175,0.5999999642372131
363737,1.0
2783,1.0
452125,1.0
199486,1.0
716639,1.0
54849,1.0
310365,1.0
37807,1.0
436802,1.0
389888,1.0
551108,1.0
435653,1.0
471218,1.0
435763,1.0
436835,1.0
266256,1.0
437268,1.0
436850,1.0
12552,1.0
200564,1.0
260352,1.0
198903,1.0
190119,1.0
335497,1.0
294508,1.0
461549,1.0
206726,1.0
386450,1.0
464286,1.0
471559,1.0
679466,1.0
189944,1.0
471122,1.0
193428,1.0
203376,1.0
187556,1.0
5207,1.0
446583,1.0
11471,1.0
44377,1.0
44384,1.0
682991,1.0
396179,1.0
55419,1.0
44365,1.0
56024,1.0
900,1.0
460148,1.0
364208,1.0
44373,1.0
198315,1.0
396434,1.0
38345,1.0
467475,1.0
271844,1.0
63835,1.0
656030,1.0
56534,1.0
58205,1.0
447804,1.0
400533,1.0
58256,1.0
11592,1.0
55268,1.0
288214,1.0
408994,1.0
428411,1.0
403228,1.0
286502,1.0
633712,1.0
15917,1.0
260119,1.0
437925,1.0
435716,1.0
13763,1.0
436793,1.0
186800,1.0
186826,1.0
57074,1.0
259609,1.0
386355,1.0
726237,1.0
285708,1.0
55887,1.0
368544,1.0
623329,1.0
471560,1.0
398521,1.0
221533,1.0
392427,1.0
10241,1.0
55183,1.0
464306,1.0
436118,1.0
55182,1.0
463649,1.0
436840,1.0
437593,1.0
436048,1.0
438821,1.0
284452,1.0
436502,1.0
437819,1.0
291872,1.0
285881,1.0
436230,1.0
73414,1.0
17652,1.0
459197,1.0
438025,1.0
437755,1.0
435714,1.0
44367,1.0
44366,1.0
44378,1.0
337450,1.0
209424,1.0
467378,1.0
386090,1.0
369331,1.0
203238,1.0
428608,1.0
469932,1.0
236779,1.0
193700,1.0
193450,1.0
392668,1.0
197483,1.0
44380,1.0
463697,1.0
471233,1.0
219919,1.0
396429,1.0
359431,1.0
367700,1.0
366523,1.0
386457,1.0
461128,1.0
475490,1.0
53924,1.0
390373,1.0
414259,1.0
286442,1.0
56070,1.0
467722,1.0
359618,1.0
209042,1.0
464450,1.0
446265,1.0
19732,1.0
10184,1.0
436097,1.0
186816,1.0
186825,1.0
403245,1.0
435607,1.0
446566,0.29999998211860657
388654,1.0
339882,1.0
187154,1.0
670103,1.0
438466,1.0
458984,1.0
12749,1.0
436797,1.0
338711,1.0
543901,1.0
55237,1.0
437038,1.0
186815,1.0
186803,1.0
342849,1.0
682101,1.0
661968,1.0
156804,1.0
384486,1.0
339941,1.0
471112,1.0
437775,1.0
232212,1.0
288533,1.0
437674,1.0
436603,1.0
436838,1.0
435739,1.0
458982,1.0
464048,1.0
438617,1.0
194211,1.0
460602,1.0
367745,1.0
684712,1.0
206568,1.0
246809,1.0
191947,1.0
246813,1.0
464263,1.0
191612,1.0
60213,1.0
226955,1.0
291838,1.0
195319,1.0
13025,1.0
264576,1.0
294512,1.0
387951,1.0
463825,1.0
383998,1.0
470900,1.0
288164,1.0
392523,1.0
645760,1.0
287799,1.0
349133,1.0
383358,1.0
365615,1.0
455024,1.0
436989,1.0
651672,1.0
677492,1.0
707925,1.0
439553,1.0
341760,1.0
448555,1.0
45260,1.0
36662,1.0
460189,1.0
202330,1.0
435755,1.0
437342,1.0
435832,1.0
459043,1.0
363309,1.0
452017,1.0
55746,1.0
383926,1.0
367699,1.0
396359,1.0
227931,1.0
367702,1.0
195300,1.0
438605,1.0
437261,1.0
13198,1.0
386456,1.0
435602,1.0

Query:
-- 7. Select object IDs and titles where department is 'The Libraries' and title contains 'book'.
SELECT "object_id", "title"
FROM THE_MET.THE_MET."OBJECTS"
WHERE "department" = 'The Libraries' AND "title" ILIKE '%book%'
LIMIT 1000
Answer:
object_id,title
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found"
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts"
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work"
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc."
Query:
-- 8. Extract and filter cropConfidence values greater than 0.5.
SELECT t."object_id", f.value:"confidence"::FLOAT AS "cropConfidence"
FROM THE_MET.THE_MET."VISION_API_DATA" t, LATERAL FLATTEN(input => t."cropHintsAnnotation":"cropHints") f
WHERE f.value:"confidence"::FLOAT > 0.5
LIMIT 1000
Answer:
Too long, hard cut:
object_id,cropConfidence
437177,1.0
437564,1.0
201929,1.0
397271,1.0
355599,1.0
412502,1.0
337337,1.0
209969,1.0
6039,1.0
53710,1.0
377454,1.0
196587,1.0
336772,1.0
558364,1.0
399542,1.0
390002,1.0
693798,1.0
367538,1.0
369073,1.0
37169,1.0
339833,1.0
201428,1.0
209272,1.0
416888,1.0
347688,1.0
397692,1.0
335839,1.0
471067,1.0
435595,1.0
204626,1.0
56835,1.0
209244,1.0
282028,1.0
398504,1.0
446546,1.0
194520,1.0
436509,1.0
464160,1.0
266259,1.0
438385,1.0
435852,1.0
459093,1.0
11712,1.0
467724,1.0
458979,1.0
436015,1.0
435768,1.0
338317,1.0
739395,1.0
679157,1.0
191783,1.0
202700,1.0
13661,1.0
370485,1.0
188969,1.0
291800,1.0
645771,1.0
193972,1.0
198996,1.0
64872,1.0
739029,1.0
464254,1.0
464124,1.0
463826,1.0
437928,1.0
36612,1.0
471117,1.0
199973,1.0
382755,1.0
288184,1.0
286009,1.0
645766,1.0
464293,1.0
463742,1.0
505616,1.0
386449,1.0
369562,1.0
646460,1.0
228882,1.0
207530,1.0
387497,1.0
44369,1.0
44381,1.0
198770,1.0
367300,1.0
437008,1.0
436760,1.0
198906,1.0
44375,1.0
354035,1.0
463551,1.0
56038,1.0
44363,1.0
736066,1.0
56840,1.0
437632,1.0
56515,1.0
37943,1.0
55361,1.0
286647,1.0
386928,1.0
436200,1.0
361830,1.0
392927,1.0
55273,1.0
199485,1.0
156575,1.0
200656,1.0
466107,1.0
437895,1.0
448461,1.0
436346,1.0
436692,1.0
186822,1.0
186821,1.0
63874,1.0
707799,1.0
383944,1.0
396189,1.0
668089,1.0
58031,1.0
468318,1.0
470919,1.0
191180,1.0
463602,1.0
467471,1.0
449008,1.0
437021,1.0
44510,1.0
463189,1.0
10967,1.0
11046,1.0
186812,1.0
404836,1.0
397263,1.0
389200,1.0
416042,1.0
459042,1.0
388772,1.0
338919,1.0
466353,1.0
435863,1.0
54569,1.0
353162,1.0
400609,1.0
450587,1.0
299311,1.0
436685,1.0
227304,1.0
259797,1.0
462886,1.0
44382,1.0
192751,1.0
193425,1.0
342487,1.0
386096,1.0
288300,1.0
368543,1.0
459064,1.0
464169,1.0
384498,1.0
739318,1.0
288015,1.0
287687,1.0
199487,1.0
469940,1.0
390083,1.0
335840,1.0
436481,1.0
208764,1.0
12917,1.0
189297,1.0
56927,1.0
729662,1.0
692282,1.0
471953,1.0
338480,1.0
399987,1.0
56750,1.0
437354,1.0
460220,1.0
437791,1.0
635384,1.0
283086,1.0
458977,1.0
436207,1.0
436950,1.0
288505,1.0
435594,1.0
186811,1.0
186818,1.0
186804,1.0
186798,1.0
467782,1.0
367762,1.0
349141,1.0
268069,1.0
355100,1.0
55511,1.0
55871,1.0
197732,1.0
288537,1.0
399213,1.0
386317,1.0
465972,1.0
381860,1.0
260117,1.0
437023,1.0
435616,1.0
437239,1.0
459128,1.0
246808,1.0
246810,1.0
60164,1.0
287766,1.0
246815,1.0
246811,1.0
715027,1.0
191611,1.0
78642,1.0
291867,1.0
194162,1.0
246807,1.0
207701,1.0
346872,1.0
268134,1.0
197117,1.0
73466,1.0
392114,1.0
185893,1.0
698815,1.0
283173,1.0
288165,1.0
467784,1.0
264583,1.0
55613,1.0
55865,1.0
287646,1.0
56510,1.0
55500,1.0
220126,1.0
701263,1.0
286280,1.0
437509,1.0
13043,1.0
436909,1.0
442761,1.0
435669,1.0
44358,1.0
437798,1.0
11258,1.0
436335,1.0
55325,1.0
44360,1.0
463040,1.0
463536,1.0
286038,1.0
467486,1.0
386444,1.0
343968,1.0
288535,1.0
17449,1.0
343402,1.0
261387,1.0
342591,1.0
263135,1.0
361703,1.0
729624,1.0
385957,1.0
659124,1.0
345721,1.0
196356,1.0
339707,1.0
367415,1.0
398595,1.0
55574,1.0
197750,1.0
229095,1.0
471848,1.0
436731,1.0
198587,1.0
340058,1.0
349162,1.0
452670,1.0
342501,1.0
37895,1.0
399212,1.0
54652,1.0
11777,1.0
459002,1.0
11372,1.0
397694,1.0
206589,1.0
338515,1.0
364382,1.0
436770,1.0
10401,1.0
64534,1.0
471995,1.0
385089,1.0
342748,1.0
436911,1.0
102243,1.0
11798,1.0
11707,1.0
437490,1.0
438820,1.0
437703,1.0
475487,1.0
459040,1.0
291887,1.0
436664,1.0
463545,1.0
191777,1.0
349309,1.0
467808,1.0
205239,1.0
58026,1.0
269254,1.0
428639,1.0
260058,1.0
237070,1.0
260182,1.0
237754,1.0
45445,1.0
60060,1.0
403086,1.0
700206,1.0
371456,1.0
464151,1.0
187761,1.0
188903,1.0
398499,1.0
204625,1.0
206168,1.0
434111,1.0
393331,1.0
362267,1.0
16665,1.0
288561,1.0
250549,1.0
343201,1.0
1683,1.0
387537,1.0
391793,1.0
399237,1.0
14942,1.0
55423,1.0
195760,1.0
260113,1.0
37125,1.0
364839,1.0
366887,1.0
463765,1.0
451972,1.0
189163,1.0
56753,1.0
203111,1.0
190623,1.0
360642,1.0
202343,1.0
36707,1.0
189644,1.0
382454,1.0
56027,1.0
390689,1.0
59185,1.0
189700,1.0
194324,1.0
386145,1.0
642888,1.0
431358,1.0
302131,1.0
46445,1.0
268128,1.0
51416,1.0
286615,1.0
387541,1.0
367468,1.0
392932,1.0
434603,1.0
260140,1.0
269271,1.0
437069,1.0
460208,1.0
473465,1.0
156808,1.0
464299,1.0
204722,1.0
454344,1.0
36654,1.0
41933,1.0
438026,1.0
11274,1.0
189712,1.0
383935,1.0
63832,1.0
399691,1.0
442749,1.0
625354,1.0
38582,1.0
339119,1.0
55199,1.0
342463,1.0
227026,1.0
407167,1.0
704827,1.0
435691,1.0
436738,1.0
337665,1.0
377467,1.0
459019,1.0
271746,1.0
631422,1.0
436759,1.0
365816,1.0
12731,1.0
451283,1.0
208809,1.0
399545,1.0
249164,1.0
435766,1.0
73439,1.0
339543,1.0
10337,1.0
459015,1.0
437422,1.0
667926,1.0
459023,1.0
249232,1.0
435702,1.0
467508,1.0
435754,1.0
391053,1.0
350970,1.0
369533,1.0
453683,1.0
356476,1.0
436103,1.0
488733,1.0
10389,1.0
58263,1.0
37993,1.0
436892,1.0
656826,1.0
392687,1.0
359151,1.0
337761,1.0
361613,1.0
730790,1.0
286173,1.0
269253,1.0
344140,1.0
260348,1.0
388833,1.0
712946,1.0
260126,1.0
436900,1.0
339559,1.0
342502
Query:
-- 9. Select object IDs where metadata_date is not null.
SELECT "object_id"
FROM THE_MET.THE_MET."OBJECTS"
WHERE "metadata_date" IS NOT NULL
LIMIT 1000
Answer:
Too long, hard cut:
object_id
646996
77916
38009
37988
74660
74674
74675
74677
74685
65595
73261
38042
39894
64891
65590
65594
40445
45063
40069
40070
37964
75084
75085
75086
75087
75088
75089
75090
75091
75092
75093
75094
75095
75096
75097
75098
75099
75100
75101
75102
75103
75104
75105
75106
75107
75108
75109
75110
75111
75112
75113
75114
75115
75116
75117
75118
75119
75120
75121
75122
75123
75124
75125
75126
75127
75128
75129
75130
75131
75132
75133
75134
75135
75136
75137
75138
75139
75140
75141
75142
75143
75145
75146
75147
75148
75149
75150
75151
75152
75153
54912
38448
40429
40432
73188
74683
72589
74656
64046
39899
36145
49665
36130
36435
36036
36072
49133
65620
40021
49453
49134
65075
41468
40507
40052
35995
35999
36003
45786
73669
49179
49226
51727
51705
51528
51656
51644
36129
51770
64029
60764
51902
64045
36439
40285
40107
40180
40194
40060
40058
45684
45746
39766
45749
44574
45775
45780
51865
77914
48875
48955
48954
49025
49029
56553
41780
39625
48931
48928
48959
49129
49146
49147
49163
51894
36132
51900
75814
54308
55495
49473
35987
44570
40105
40509
42329
39918
39919
40103
40104
41777
41860
40018
41778
41782
63196
63185
49047
50549
53924
53925
53926
53927
53928
53929
42323
36236
36098
72711
72712
36201
44567
49617
36208
36205
36206
36211
36210
36216
49629
49630
41504
49603
49604
49605
49607
36202
49608
49606
49614
49615
49663
49664
49626
49627
36222
36224
49623
40311
45652
39901
39959
51762
40062
40057
40094
36052
40053
36055
44506
44507
44508
44509
44510
40278
41479
45661
41478
44699
44590
45675
36123
45683
45682
39483
36093
45752
45779
44601
45776
39654
45802
45797
44606
45815
36135
45032
48934
48932
36070
48949
48952
48953
48951
41480
48950
48969
35988
39713
49019
49021
39717
49074
41470
39558
44759
37395
35998
35990
48948
36022
36021
36067
75250
48901
45676
51375
39554
36094
36080
48947
35994
48902
49095
48966
51871
39667
44703
36024
48910
36436
65013
45670
35989
41191
45655
39553
36081
36082
39552
45680
36058
36095
35992
45671
45659
51621
49030
44626
40019
49106
65555
36089
49080
40020
39557
75745
49132
41483
36131
51864
41488
51769
36453
37394
39540
49143
49144
41491
49145
49149
49151
51483
49157
49156
49150
49154
49158
36025
77870
41486
49162
49181
41492
49177
49178
49172
49170
49183
49171
49175
36018
49176
49173
49187
62743
41487
49185
49186
36015
49239
49237
36027
36047
49240
39767
49243
36432
39764
49244
44620
49247
49253
73161
49254
39765
41494
36017
36160
36155
49449
49451
49434
49458
36157
49454
49468
49469
36161
49452
36187
49474
49476
49460
49461
49464
44566
37393
49463
39715
49462
49475
36181
36179
49602
41905
36194
49594
36156
36171
49241
36167
39714
49227
44581
72263
49131
74818
49234
36105
36106
73159
36100
36186
59025
36091
44720
48946
36090
44521
36001
73646
65640
49250
49251
41493
36133
40454
36459
40456
40508
40511
41462
39547
39546
45636
45635
41154
41185
40515
41195
40134
41194
39550
41451
41193
36430
36431
44701
40514
40513
42260
41146
40309
40081
41476
40393
42261
45647
35970
44702
39895
39668
39936
39915
40007
40284
40054
40051
36037
40086
44638
36005
40133
39937
40090
36019
49017
45658
45650
65385
44873
45637
39488
48837
40185
40187
40188
40061
49006
49009
48944
45660
45747
45748
42683
45795
45763
45764
53796
45777
45783
45804
45812
48876
48874
48877
48879
35993
48904
48905
48915
48917
48926
48927
48935
48943
45384
48956
48957
48958
48963
48960
48961
48962
48964
48970
49043
49044
49097
49015
35997
48909
48930
48897
48965
49169
49174
49219
51901
36122
51807
51379
39534
42158
49033
45657
43294
63331
63216
63351
63230
63218
63336
63325
63204
63219
63338
63201
63213
63345
63337
63215
63339
63341
63212
63214
63217
63327
63348
63209
63226
63203
63078
51548
39920
45685
45793
45773
45772
36062
44573
45756
45760
36103
45821
48873
49256
51872
48968
49077
36099
39628
50168
45810
45807
36138
49013
64972
36050
51285
36013
36051
48942
36023
50167
35996
36136
41471
39551
36030
36002
36000
36188
49130
39931
36134
51803
49148
41485
49165
36016
52225
49164
36120
49182
49180
49238
36102
36096
52946
51790
44527
36026
42559
36147
49457
49433
49455
49456
36184
49472
36172
49471
49242
49459
41484
49236
36014
36139
35981
51484
40080
39549
39545
35977
51763
40087
35986
51639
51856
51858
53601
53602
53603
42187
51850
51640
51768
51546
49055
51604
35978
36035
51584
44592
44593
36084
44612
51816
44591
49167
49168
36124
40017
42324
49166
44294
49432
49448
36154
49447
49467
36170
36075
36168
51898
40059
48912
35982
35985
45784
35980
35976
51859
36066
49252
51657
40003
40106
36033
40004
40002
40196
40078
39935
45781
48933
49020
51873
48888
44451
39556
48884
35974
42560
49127
51887
35971
35972
35975
49152
49153
53552
51369
49188
39913
51896
35973
41481
49113
36433
51567
36041
51668
40088
36141
40987
51378
51490
40422
51535
51293
48945
48941
37396
45814
35983
48903
40510
51870
51869
48906
35991
63220
63225
63205
63206
63208
63228
40102
39917
51396
51540
51746
45754
45774
48872
51664
51679
51678
45677
35984
51498
51428
51500
51515
49159
49160
51427
51284
51527
51519
51574
51499
51701
51637
51425
50360
51687
51654
513
Query:
-- 10. Select metadata_date from OBJECTS to examine date formats.
SELECT "metadata_date"
FROM THE_MET.THE_MET."OBJECTS"
LIMIT 1000
Answer:
Too long, hard cut:
metadata_date
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
14863
Query:
-- 11. Select object IDs and titles with metadata dates after a specific date.
SELECT "object_id", "title"
FROM THE_MET.THE_MET."OBJECTS"
WHERE "metadata_date" > 20200101
LIMIT 1000
Answer:
Too long, hard cut:
object_id,title
646996,전(傳) 오원 장승업 (1843–1897) 청동기와 화초가 있는 정물화 조선|傳 吾園 張承業 器皿折枝圖 朝鮮|Still life with bronze vessels and flowering plants
77916,석지 채용신    학자 초상|石芝 蔡龍臣 學者肖像|Portrait of a scholar
38009,
37988,
74660,
74674,
74675,
74677,
74685,
65595,
73261,
38042,
39894,
64891,
65590,
65594,
40445,"이유원, 매화도  조선|李裕元 梅花圖  朝鮮|Plum Branch"
45063,
40069,
40070,
37964,
75084,
75085,
75086,
75087,
75088,
75089,
75090,
75091,
75092,
75093,
75094,
75095,
75096,
75097,
75098,
75099,
75100,
75101,
75102,
75103,
75104,
75105,
75106,
75107,
75108,
75109,
75110,
75111,
75112,
75113,
75114,
75115,
75116,
75117,
75118,
75119,
75120,
75121,
75122,
75123,
75124,
75125,
75126,
75127,
75128,
75129,
75130,
75131,
75132,
75133,
75134,
75135,
75136,
75137,
75138,
75139,
75140,
75141,
75142,
75143,
75145,
75146,
75147,
75148,
75149,
75150,
75151,
75152,
75153,
54912,
38448,
40429,
40432,
73188,
74683,
72589,
74656,
64046,張旭 「肚痛帖」; 懷素 「寄邊衣」詩|Ji bianyi|Letter about a Stomachache (Du tong tie)
39899,東晉 王羲之 十七日帖 十三世紀拓本|On the Seventeenth Day
36145,
49665,近代  丁輔之  荔枝  扇面|Lychees
36130,清  倣龔賢  十二月令山水圖  冊|Landscapes of the Twelve Months
36435,
36036,
36072,清  程正揆  江山臥遊圖  卷|Dream Landscape
49133,清  倣龔賢  雲山隱居圖  軸|Dwelling among Mountains and Clouds
65620,清  倣龔賢  山水圖  冊|Landscapes
40021,清 王翬 倣李成雪霽圖 軸 紙本|Snow Clearing: Landscape after Li Cheng
49453,清  王緣  趙之謙肖像  軸|Portrait of Zhao Zhiqian
49134,清  柳堉  溪山行旅圖  卷|Traveling Amid Streams and Mountains
65075,王翬、楊晉、顧昉、王雲、徐玫 仿古山水圖 冊 紙本|Landscapes after old masters
41468,元  吳鎮  蘆灘釣艇圖  卷|Fisherman
40507,元   趙孟頫   趙雍   趙麟   吳興趙氏三世人馬圖   卷|Grooms and Horses
40052,"南宋 馬和之 詩經小雅鴻雁之什六篇圖 卷|Courtly Odes, Beginning with ""Wild Geese"""
35995,
35999,
36003,
45786,
73669,清  查昇  行書七律詩  軸|Poem
49179,清  石濤(朱若極)  山水圖  冊|Searching for Immortals
49226,
51727,
51705,
51528,
51656,
51644,
36129,
51770,
64029,唐 颜真卿 顏家廟碑 現代拓片 紙本|Yan Family Temple Stele
60764,太平山水圖|Landscapes of Taiping Prefecture (Taiping shanshui tu)
51902,
64045,
36439,唐 傳鍾紹京 楷書靈飛經 冊|Spiritual Flight Sutra
40285,南宋  趙孟堅  行書梅竹詩譜  卷|Poems on Painting Plum Blossoms and Bamboo
40107,南宋   理宗趙昀  行書北宋梅堯臣 依韻和資政侍郎雪後登看山亭詩   團扇|Quatrain on Snow-covered West Lake
40180,
40194,南宋 理宗 趙昀 楷書韓翊 《 潮聲山翠》 聯句 團扇|Couplet from a Poem by Han Hong
40060,南宋  孝宗  行楷書池上水邊聯句  團扇|Couplet on pond scenery
40058,南宋   高宗   草書天山陰雨七絕詩   團扇|Quatrain on Heavenly Mountain
45684,
45746,
39766,明  王鏊  贈別詩  軸|Farewell Poem
45749,
44574,
45775,"明  文徵明  致丈人吳愈書  冊頁|Letter to the Artist's Father-in-law, Wu Yu"
45780,
51865,
77914,文彭  行草七律  水墨絹本  鏡框|Poem on Promulgating the Almanac at New Year’s
48875,
48955,
48954,
49025,
49029,明/清  王鐸  行草書日暮孤亭五律詩  軸|Poem on a Riverside Pavilion
56553,
41780,
39625,晚明  張希黃 留青竹刻 《醉翁亭記》 詩意圖筆筒|Brush holder with “Ode to the Pavilion of the Inebriated Old Man”
48931,
48928,
48959,
49129,清  法若真  行草書畫說  卷|Discourse on Painting
49146,清  朱耷 (八大山人)  李治書  扇頁|Letter by Li Zhi
49147,明/清 朱耷（八大山人） 致方士琯書 冊 紙本|Letters to Fang Shiguan
49163,
51894,"清   金農   論畫雜詩   冊|Poems on Paintings, Written for Ma Yueguan"
36132,
51900,
75814,吳煕載  篆書詩經南山有臺|Nutgrass Grows on the Southern Hills
54308,清  趙之謙  隸書引首  卷|The Lingshouhua Studio
55495,清  趙之謙  篆書五言  對聯|Couplet
49473,清  翁同龢  軸|Tiger Calligraphy
35987,
44570,
40105,元 耶律楚材 行書贈別劉滿詩 卷|Poem of Farewell to Liu Man
40509,元  趙孟頫  行書右軍四事  卷|Four anecdotes from the life of Wang Xizhi
42329,元  鄭元祐  楷書師孺齋記  卷|Record of the Following One's Ancestor Studio
39918,北宋 黃庭堅 草書廉頗藺相如傳 卷|Biographies of Lian Po and Lin Xiangru
39919,北宋  米芾  草書吳江舟中詩  卷|Poem Written in a Boat on the Wu River
40103,南宋 楊皇后 楷書薄薄殘妝七絕 團扇冊頁 絹本|Quatrain on spring’s radiance
40104,南宋  楊皇后  楷書瀹雪凝酥七絕  團扇|Quatrain on yellow roses
41777,
41860,
40018,
41778,
41782,
63196,
63185,芥子園畫傳|Mountainside View: Page from The Mustard Seed Garden Manual of Painting
49047,
50549,
53924,
53925,
53926,
53927,
53928,
53929,
42323,
36236,近代  張善子  黃山奇松圖  扇頁|Strange Pine in the Yellow Mountain
36098,
72711,清  湯貽汾  墨梅  四冊頁|Blossoming Plum
72712,清  胡遠  山水  四軸|Landscapes of the Four Seasons
36201,近代  王振聲  友梅圖  扇面|Still-life with Plum
44567,近代  吳昌碩  仙芝天竹圖  軸|Spring Offerings
49617,近代  吳昌碩  烹茶圖  橫軸|Brewing Tea
36208,近代  吳昌碩  蘭花  扇面|Orchid
36205,近代  林紓  合掌峰  扇面|Hezhang Peak
36206,近代  林紓  詩廬圖  卷|The Poetry Cottage
36211,近代  吳觀岱  山水人物  扇面|Landscape and Figure
36210,近代  楊逸  青松  扇面|Pine
36216,近代  顧麟士  臨溪亭子圖  扇面|Pavilion Beside a Rock Garden and Stream
49629,近代  王震  山羊  軸|Two Goats
49630,近代  王震  漁翁圖  軸|Returning Fisherman
41504,近代  王震  佛祖圖  軸|Buddhist Sage
49603,近代  陳衡恪  臨水書閣  冊頁|Studio by the Water
49604,近代  陳衡恪  水仙蘭花  扇面|Narcissus and Orchid
49605,近代  陳衡恪  秋山蕭寺  扇面|Remote Temple on the Autumn Mountain
49607,近代  陳衡恪  玉簪花  冊頁|Plantain Lily
36202,近代  陳衡恪  梅花  冊頁|Plum
49608,近代  陳衡恪  梨花  軸|Pear-blossoms
49606,近代  陳衡恪  山水  扇面兩幀|Landscapes
49614,近代  金城  山水  扇面|Landscape
49615,近代  金城  牡丹  扇面|Peony
49663,近代  丁輔之  雜果圖  冊頁|Fruit
49664,近代  丁輔之  冰盤進夏圖  冊頁|Dish of Iced Summer Fruit
49626,近代  俞明  桐窗仕女  扇面|A Beauty at the Window by a Wutong Tree
49627,近代  俞明  絲路行旅圖  扇面|Travel on the Silk Road
36222,近代  俞明  堆雪獅子圖  冊頁|Making a Snow-lion
3622
Query:
-- 12. Select object IDs and descriptions from labelAnnotations in VISION_API_DATA.
SELECT t."object_id", f.value:"description"::STRING AS "labelDescription"
FROM THE_MET.THE_MET."VISION_API_DATA" t, LATERAL FLATTEN(input => t."labelAnnotations") f
LIMIT 1000
Answer:
Too long, hard cut:
object_id,labelDescription
437177,painting
437177,impressionist
437177,mythology
437177,illustration
437177,portrait
437564,photograph
437564,black and white
437564,art
437564,painting
437564,sketch
201929,white
201929,black and white
201929,picture frame
201929,fireplace
201929,architecture
397271,cartoon
397271,sketch
397271,drawing
397271,illustration
397271,pattern
355599,sketch
355599,ancient history
355599,painting
355599,drawing
355599,tapestry
412502,painting
412502,tapestry
412502,sketch
412502,ancient history
412502,textile
337337,sketch
337337,drawing
337337,painting
337337,illustration
337337,pattern
209969,modern art
209969,sketch
209969,art
209969,drawing
209969,shape
6039,black and white
6039,platter
6039,plate
6039,tableware
6039,dishware
53710,color
53710,painting
53710,art
53710,mural
53710,modern art
377454,sketch
377454,drawing
377454,figure drawing
377454,portrait
377454,illustration
196587,black and white
196587,photograph
196587,human positions
196587,photography
196587,monochrome photography
336772,painting
336772,picture frame
336772,relief
336772,art
336772,carving
558364,sculpture
558364,stone carving
558364,art
558364,statue
558364,carving
399542,painting
399542,art
399542,ancient history
399542,picture frame
399542,sketch
390002,relief
390002,art
390002,picture frame
390002,sketch
390002,drawing
693798,sketch
693798,drawing
693798,art
693798,pattern
693798,design
367538,cartoon
367538,art
367538,sketch
367538,drawing
367538,ancient history
369073,painting
369073,art
369073,ancient history
369073,sketch
369073,drawing
37169,woman
37169,cartoon
37169,sketch
37169,comics
37169,comic book
339833,postage stamp
339833,banknote
339833,currency
339833,paper
339833,sketch
201428,stained glass
201428,window
201428,glass
201428,art
201428,material
209272,sculpture
209272,art
209272,relief
209272,drawing
209272,sketch
416888,cartoon
416888,sketch
416888,drawing
416888,art
416888,figure drawing
347688,painting
347688,art
347688,ancient history
347688,modern art
347688,tapestry
397692,relief
397692,sketch
397692,art
397692,drawing
397692,figure drawing
335839,art
335839,picture frame
335839,tapestry
335839,pattern
335839,textile
471067,cartoon
471067,window
471067,stained glass
471067,glass
471067,art
435595,red
435595,person
435595,image
435595,child
435595,romance
204626,relief
204626,stone carving
204626,art
204626,statue
204626,dishware
56835,person
56835,woman
56835,geisha
56835,profession
56835,costume design
209244,furniture
209244,altar
209244,throne
209244,table
209244,carving
282028,photograph
282028,image
282028,album cover
282028,history
282028,infantry
398504,art
398504,painting
398504,pattern
398504,sketch
398504,illustration
446546,art
446546,painting
446546,tapestry
446546,textile
446546,needlework
194520,black and white
194520,human positions
194520,statue
194520,art
194520,sculpture
436509,painting
436509,impressionist
436509,art
436509,ancient history
436509,middle ages
464160,statue
464160,sculpture
464160,monument
464160,stone carving
464160,art
266259,photograph
266259,picture frame
266259,portrait
266259,painting
266259,sketch
438385,painting
438385,art
438385,middle ages
438385,tapestry
438385,illustration
435852,image
435852,painting
435852,human positions
435852,child
435852,portrait
459093,painting
459093,art
459093,jungle
459093,mythology
459093,modern art
11712,photograph
11712,image
11712,painting
11712,portrait
11712,art
467724,statue
467724,monument
467724,figurine
467724,sculpture
467724,art
458979,painting
458979,art
458979,relief
458979,picture frame
458979,carving
436015,person
436015,painting
436015,art
436015,ancient history
436015,middle ages
435768,painting
435768,modern art
435768,art
435768,portrait
435768,illustration
338317,painting
338317,sketch
338317,figure drawing
338317,art
338317,drawing
739395,painting
739395,picture frame
739395,modern art
739395,art
739395,sketch
679157,pattern
679157,art
679157,design
679157,drawing
679157,sketch
191783,black and white
191783,human positions
191783,statue
191783,monochrome photography
191783,monument
202700,window
202700,altar
202700,art
202700,glass
202700,stained glass
13661,cartoon
13661,art
13661,sketch
13661,comics
13661,ancient history
370485,picture frame
370485,sketch
370485,drawing
370485,illustration
370485,design
188969,photograph
188969,black and white
188969,black
188969,monochrome
188969,monochrome photography
291800,picture frame
291800,art
291800,wood
291800,antique
291800,painting
645771,ancient history
645771,art
645771,sketch
645771,painting
645771,drawing
193972,black and white
193972,picture frame
193972,art
193972,monochrome photography
193972,sketch
198996,stained glass
198996,glass
198996,window
198996,art
198996,material
64872,painting
64872,mural
64872,art
64872,modern art
64872,ancient history
739029,painting
739029,art
739029,sketch
739029,modern art
739029,drawing
464254,relief
464254,stone carving
464254,carving
464254,art
464254,wood
464124,relief
464124,carving
464124,wood
4
Query:
-- 13. Select object IDs from VISION_API_DATA where labelAnnotations contain 'book'.
SELECT t."object_id"
FROM THE_MET.THE_MET."VISION_API_DATA" t, LATERAL FLATTEN(input => t."labelAnnotations") f
WHERE f.value:"description"::STRING ILIKE '%book%'
LIMIT 1000
Answer:
Too long, hard cut:
object_id
56753
55199
339543
339559
392668
202330
73582
37185
37169
56038
56840
346872
55613
12727
333993
415967
339551
76575
339074
335408
73429
73473
77013
478997
352198
56756
343470
451315
339498
387577
37186
339515
339492
368343
45241
55397
45494
737704
435302
392843
364035
73443
73474
36687
625313
387578
353833
339524
56509
54878
57089
682992
55262
459061
435727
407577
422630
407463
76608
710996
407461
717487
699969
649902
649902
339550
391832
339503
436794
407488
625962
669267
407561
466588
211382
345008
670701
45051
219482
70035
341428
45565
407590
666029
357398
55501
352199
683005
396949
45227
36795
54511
693783
666034
428714
341426
727857
372509
383745
388023
682947
388781
382057
343422
430671
58003
623629
387788
387792
55181
63371
416540
55715
396307
384335
435303
387425
699916
649916
387434
623895
666001
37262
58054
667987
687397
36908
54667
365280
667996
387740
387433
387424
339463
429650
434547
435314
399047
341427
649914
384067
388150
387611
339566
339534
587682
397054
56062
54666
397144
54487
388067
350341
54396
388786
339460
339532
387429
339454
336215
397138
387379
416648
381466
739485
388783
388381
7503
407449
366326
56063
36892
726677
647649
649924
55717
339200
339200
339244
339244
55719
435311
399775
343101
430704
416666
37248
56107
649903
335087
37266
339028
387420
397703
400998
391570
387555
342598
382400
428394
388070
477362
192737
76574
367490
430629
76576
36675
397434
56760
36756
397333
416622
387376
362341
648485
734110
391397
416631
435307
384662
387781
649897
485752
392468
388466
55543
345033
667707
388051
669850
54507
434533
625298
387585
383749
388154
368330
416800
388158
367565
373157
361648
56719
397142
336216
58213
416683
207712
710934
58237
362339
339545
56828
73390
355316
58062
56728
339210
680839
387448
364735
339561
339489
339489
339219
339219
339495
410924
390001
339245
397139
388802
58061
54653
339071
710913
430696
347102
339560
55485
55038
55728
339491
339215
407593
407592
684134
360405
648576
36890
286316
710955
633065
407860
37263
56818
36638
76611
335490
649608
649608
737853
382139
362313
76609
371529
665999
452752
229239
75963
339329
73574
407594
407594
670725
336238
670702
389168
669031
415971
55598
346200
407448
407448
382093
63918
371758
387786
387568
434478
665376
388021
362032
397055
387455
388823
58029
361955
415970
55581
405346
36640
341529
728005
55192
668126
687861
58015
416039
649920
387783
373152
387421
388591
387563
387554
387430
37111
388590
359765
692294
368437
55770
36860
55341
665992
666121
36898
388025
362406
37239
680845
54662
435283
337882
428353
429649
362022
57987
388799
58006
55762
383718
367759
388057
45216
55714
625285
363983
388483
374014
55788
44990
333990
333990
388094
36814
364727
387606
387454
387375
340229
367504
387734
428047
388874
56538
202468
36904
398181
362740
36702
429908
386237
387791
57097
428319
388052
341498
404782
666051
471999
388388
387381
416066
370519
341874
36606
360402
73477
390385
76563
56119
37113
667957
56014
415964
60930
666030
56808
646706
363200
388061
649915
387461
396946
73596
398478
416267
54563
55956
36911
392799
36604
397255
387729
387873
52001
387580
366995
437794
392771
391348
336306
54506
336242
391134
56676
54820
338259
369588
435300
334925
58027
375912
387431
343298
36773
63803
376445
362384
57998
73611
384240
55725
465954
339490
37002
386164
367041
406562
55786
36815
397252
221531
55722
387730
387598
73585
359981
339567
76596
76625
647996
67572
407525
76614
339262
407497
407493
401511
680855
389508
623947
55578
682993
665281
36779
370668
629783
226563
76610
651982
738090
407328
407328
670691
56008
387757
37174
337850
361854
76578
405311
416632
388039
339457
623823
391253
388411
339494
391569
387417
56802
339512
415972
386159
36676
665571
57290
58373
36648
55326
343852
624946
388024
367067
339500
434493
416620
416040
387561
73490
36824
37317
416776
55771
55524
56177
435264
56681
339496
345100
36473
56780
58009
342720
434474
387883
397048
362513
362513
56536
339585
55352
339508
358129
37329
336204
387418
397137
387426
388481
373018
56035
451417
416364
387608
400074
343585
388060
387392
37191
453093
37135
56721
388029
360117
363263
339502
387574
447071
229112
56732
57100
362643
2269
643791
382448
55270
337379
388134
468153
398429
395998
387584
55545
51089
397256
339459
427105
666123
435316
36482
360179
408616
404509
387727
687793
666008
649613
398531
407578
37139
391078
680847
649901
56603
420968
388063
55523
55523
362520
339184
339184
388595
649895
415314
339225
54591
416668
430728
387790
54498
387782
622945
56615
388824
388828
388152
361876
387458
388889
387390
73536
388066
38010
416664
58001
416796
368340
360063
55597
398479
55132
431135
412311
395044
73507
430802
54007
339533
58229
710906
58067
376444
717147
388770
73545
384173
55121
36625
57080
463648
56604
700212
339075
354833
55118
339569
56754
399750
680740
37173
387391
339349
339349
336164
58255
396169
339514
397141
339528
339552
396170
422621
710931
643772
396637
362407
451828
38000
55053
339131
416719
76612
56734
362739
55538
670578
624248
40
Query:
-- 14. Select object IDs and cropHintsAnnotation data.
SELECT "object_id", "cropHintsAnnotation"
FROM THE_MET.THE_MET."VISION_API_DATA"
LIMIT 1000
Answer:
Too long, hard cut:
object_id,cropHintsAnnotation
463536,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2158,
            ""y"": 0
          },
          {
            ""x"": 2158,
            ""y"": 2871
          },
          {
            ""x"": 0,
            ""y"": 2871
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.700000047683716e-01
    }
  ]
}"
286038,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2490,
            ""y"": 0
          },
          {
            ""x"": 2490,
            ""y"": 3340
          },
          {
            ""x"": 0,
            ""y"": 3340
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 1.100000023841858e+00
    }
  ]
}"
467486,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 1455,
            ""y"": 0
          },
          {
            ""x"": 1455,
            ""y"": 1899
          },
          {
            ""x"": 0,
            ""y"": 1899
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.700000047683716e-01
    }
  ]
}"
386444,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2843,
            ""y"": 0
          },
          {
            ""x"": 2843,
            ""y"": 3734
          },
          {
            ""x"": 0,
            ""y"": 3734
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.799999952316284e-01
    }
  ]
}"
343968,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2873,
            ""y"": 0
          },
          {
            ""x"": 2873,
            ""y"": 3982
          },
          {
            ""x"": 0,
            ""y"": 3982
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.599999845027924e-01
    }
  ]
}"
288535,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2026,
            ""y"": 0
          },
          {
            ""x"": 2026,
            ""y"": 2555
          },
          {
            ""x"": 0,
            ""y"": 2555
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 5.000000000000000e-01
    }
  ]
}"
17449,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2634,
            ""y"": 0
          },
          {
            ""x"": 2634,
            ""y"": 3999
          },
          {
            ""x"": 0,
            ""y"": 3999
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.700000047683716e-01
    }
  ]
}"
343402,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2821,
            ""y"": 0
          },
          {
            ""x"": 2821,
            ""y"": 3718
          },
          {
            ""x"": 0,
            ""y"": 3718
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.700000047683716e-01
    }
  ]
}"
261387,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2484,
            ""y"": 0
          },
          {
            ""x"": 2484,
            ""y"": 2943
          },
          {
            ""x"": 0,
            ""y"": 2943
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.499999940395355e-01
    }
  ]
}"
342591,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2614,
            ""y"": 0
          },
          {
            ""x"": 2614,
            ""y"": 3530
          },
          {
            ""x"": 0,
            ""y"": 3530
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.899999856948853e-01
    }
  ]
}"
2
Query:
-- 15. Select object IDs and titles from OBJECTS where department is 'The Libraries' and metadata_date is not null.
SELECT "object_id", "title"
FROM THE_MET.THE_MET."OBJECTS"
WHERE "department" = 'The Libraries' AND "metadata_date" IS NOT NULL
LIMIT 1000
Answer:
Too long, hard cut:
object_id,title
682011,Dialogo sobre hua nova obra no Rio Tejo ...
681546,De' ragguagli di Parnaso: Centuria prima-seconda
681534,"Contes et nouvelles de Bocace florentin : traduction libre, accommodée au gout de ce temps, & enrichie de figures en taille-douce gravées par Mr. Romain de Hooge"
681389,"Uffizio della Settimana Santa : colle rubriche volgari, argomenti de' Salmi, spiegazione delle cerimonie e misterj, con osservazioni, e riflessioni divote dell'abate Alessandro Mazzinelli"
591832,"Academie de l'espee; ou se domonstrent par reigles mathématiques sur le fondement d'un cercle mystérieux, la théorie et pratique des vrais . . ."
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans
591831,"Descriptio pbvlicae gratvlationis, spectacvlorvm et lvdorvm, in aventv sereniss: Principis Ernesti Archidvcis Avstriae Dvcis Vrgvndiae"
591865,Morte d'Arthur
591848,"The Holy Land, Syria, Idumea, Arabia, Egypt & Nubia"
591863,"Catalogue of the Collection of Jewels and Precious Works of Art, the Property of  J. Pierpont Morgan"
681573,"Les oeuvres morales de Mr. Diderot : contenant son traité De l'amitié, et celui Des passions"
682013,L'eschole de Salerne en vers burlesques & duo poemata macaronica: de bello huguenotico: et De gestis magnanimi & prudentissimi Baldi
681149,Bibliorum Sacrorum Vulgatae versionis
681556,Mémoires du Comte de Grammont : histoire amoureuse de la cour d'Angleterre sous Charles II / par Antoine Hamilton ; préface et notes par Benjamin Pifteau
681388,"Traité de Plutarque, sur la manière de discerner un flatteur d'avec un ami et Le banquet des sept sages: dialogue du même auteur revu & corrigé sur des manuscrits de la Bibliothèque du roi; avec une version françoise & des notes"
680835,"L'art de former les jardins modernes, ou, L'art des jardins anglois : traduit de l'anglois : à quoi le traducteur a ajouté un discours préliminaire sur l'origine de l'art, des notes sur le texte, & une description détaillée des jardins de Stowe, accompagnée du plan"
681547,"De l'imitation de Jesus-Christ, traduction nouvelle ; ornée de figures en taille-douce"
681545,Contes et nouvelles en vers par Jean de la Fontaine
682014,Figures françoises et comiques nouvellement inventées par M. Watteau; Figures de modes dessinées et gravées à l'eau forte par Watteau; a terminées au buin par Thomassin le fils
681128,"Les aventures de Télémaque, fils d'Ulysse par M. de Fénélon ; avec figures en taille-douce, dessinées par MM. Cochin et Moreau le jeune"
682012,Epistole eroiche di P. Ovidio Nasone
681563,"Oeuvres de Moliere : avec des remarques grammaticales, des avertissemens et des observations sur chaque piéce, par M. Bret"
716648,"Planches pour l'Encyclopédie, ou pour le Dictionaire raisonné des sciences, des arts libéraux, et des arts méchaniques, avec leur explication"
705290,博古圖錄
715005,三禮圖
739504,Examples of Chinese ornament selected from objects in the South Kensington Museum and other collections
726677,"The sunshade, the glove, the muff"
716639,"Encyclopédie, ou Dictionnaire raisonné des sciences, des arts et des métiers, par une société de gens de lettres"
699505,"Dialogos de la pintvra : sv defensa, origen, essecia, definicion, modos y diferencias"
697348,Der aller durchleuchtigisten und grosmächtigen Kayser ... Königen ... Herren vom Adel ... Bildtnussen und kurtz Beschreibungen ihrer so wol in Fridts- als Kriegszzeiten verrichten fürnembsten Thaten und Handlungen : deren Waffen und Rüstungen ... auss allen Landen der Welt ... in dem Schloss Ombrass ... zu ewiger Gedächtnuss auffbehalten werden ...
681349,"Calendrier belgique, curieux et utile, contenant les evenemens historiques sur les jours de l'an, et les travaux à faire dans les jardins en chaque mois de l'année, la description des tableaux remarquables, que l'on trouve dans la ville de Gand, avec les noms des peintres pour l'annėe MDCCLXXII"
591837,Le pitture e sculture di Brescia che sono esposte al pubblico con un' appendice di alcune private gallerie
591862,"Edwin Davis French, A Memorial: His Life, His Art"
591836,Il Ritratto di Venezia
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found"
738466,Modern chromatics : with applications to art and industry
700032,Petri Gyllii De Bosporo thracio libri III ; Petri Gyllii De topographia Constantinopoleos
700050,"Traité de l'horlogerie, méchanique et pratique, approuvé par l'Academie royale des sciences"
738463,"The principles of harmony and contrast of colours, and their applications to the arts"
704714,Mr. Vanderbilt's house and collection
700240,"The cabinet-maker and upholsterer's guide, or, Repository of designs for every article of household furniture, in the newest and most approved taste : displaying a great variety of patterns for chairs, stools ... in the plainest and most enriched styles : with a scale to each, and an e
End Exploring Related Columns
Task: Retrieve the object id, title, and the formatted metadata date (as a string in 'YYYY-MM-DD' format) for objects in the "The Libraries" department where the cropConfidence is greater than 0.5, the object's title contains the word "book".

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To retrieve the object ID, title, and formatted metadata date for objects in the "The Libraries" department where the `cropConfidence` is greater than 0.5 and the title contains the word "book", we can query the `OBJECTS` and `VISION_API_DATA` tables. The `metadata_date` should be formatted as a string in 'YYYY-MM-DD' format.

```csv
object_id,title,metadata_date
object_id1:int,title1:str,YYYY-MM-DD
object_id2:int,title2:str,YYYY-MM-DD
...
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'THE_MET': {'THE_MET': ['IMAGES', 'OBJECTS', 'VISION_API_DATA']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-20 13:46:12 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 13:46:12 - root - INFO - To retrieve the object ID, title, and formatted metadata date for objects in the "The Libraries" department where the `cropConfidence` is greater than 0.5 and the title contains the word "book", we can query the `OBJECTS` and `VISION_API_DATA` tables. The `metadata_date` should be formatted as a string in 'YYYY-MM-DD' format.

```sql
SELECT DISTINCT o."object_id",
       o."title",
       TO_VARCHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM THE_MET.THE_MET."OBJECTS" o
JOIN THE_MET.THE_MET."VISION_API_DATA" v ON o."object_id" = v."object_id",
     LATERAL FLATTEN(input => v."cropHintsAnnotation":"cropHints") f
WHERE o."department" = 'The Libraries'
  AND o."title" ILIKE '%book%'
  AND f.value:"confidence"::FLOAT > 0.5;
```
2025-01-20 13:46:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:46:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:46:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:46:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-20 13:46:13 - snowflake.connector.connection - INFO - closed
2025-01-20 13:46:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:46:14 - root - INFO - itercount: 1
2025-01-20 13:46:14 - root - INFO - 0
2025-01-20 13:46:14 - root - INFO - results: 
object_id,title,metadata_date
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc.",2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06


2025-01-20 13:46:14 - root - INFO - Please check the answer again by reviewing Retrieve the object id, title, and the formatted metadata date (as a string in 'YYYY-MM-DD' format) for objects in the "The Libraries" department where the cropConfidence is greater than 0.5, the object's title contains the word "book"., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To retrieve the object ID, title, and formatted metadata date for objects in the "The Libraries" department where the `cropConfidence` is greater than 0.5 and the title contains the word "book", we can query the `OBJECTS` and `VISION_API_DATA` tables. The `metadata_date` should be formatted as a string in 'YYYY-MM-DD' format.

```csv
object_id,title,metadata_date
object_id1:int,title1:str,YYYY-MM-DD
object_id2:int,title2:str,YYYY-MM-DD
...
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
object_id,title,metadata_date
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc.",2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
Current sql:
SELECT DISTINCT o."object_id",
       o."title",
       TO_VARCHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM THE_MET.THE_MET."OBJECTS" o
JOIN THE_MET.THE_MET."VISION_API_DATA" v ON o."object_id" = v."object_id",
     LATERAL FLATTEN(input => v."cropHintsAnnotation":"cropHints") f
WHERE o."department" = 'The Libraries'
  AND o."title" ILIKE '%book%'
  AND f.value:"confidence"::FLOAT > 0.5;For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'

2025-01-20 13:46:51 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 13:46:51 - root - INFO - ```sql
SELECT DISTINCT o."object_id",
       o."title",
       TO_VARCHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM THE_MET.THE_MET."OBJECTS" o
JOIN THE_MET.THE_MET."VISION_API_DATA" v ON o."object_id" = v."object_id",
     LATERAL FLATTEN(input => v."cropHintsAnnotation":"cropHints") f
WHERE o."department" = 'The Libraries'
  AND o."title" LIKE '%book%'
  AND f.value:"confidence"::FLOAT > 0.5;
```
2025-01-20 13:46:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:46:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:46:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:46:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 4
2025-01-20 13:46:53 - snowflake.connector.connection - INFO - closed
2025-01-20 13:46:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:46:53 - root - INFO - itercount: 2
2025-01-20 13:46:53 - root - INFO - 0
2025-01-20 13:46:53 - root - INFO - results: 
object_id,title,metadata_date
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06


2025-01-20 13:46:53 - root - INFO - Please check the answer again by reviewing Retrieve the object id, title, and the formatted metadata date (as a string in 'YYYY-MM-DD' format) for objects in the "The Libraries" department where the cropConfidence is greater than 0.5, the object's title contains the word "book"., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To retrieve the object ID, title, and formatted metadata date for objects in the "The Libraries" department where the `cropConfidence` is greater than 0.5 and the title contains the word "book", we can query the `OBJECTS` and `VISION_API_DATA` tables. The `metadata_date` should be formatted as a string in 'YYYY-MM-DD' format.

```csv
object_id,title,metadata_date
object_id1:int,title1:str,YYYY-MM-DD
object_id2:int,title2:str,YYYY-MM-DD
...
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
object_id,title,metadata_date
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
Current sql:
SELECT DISTINCT o."object_id",
       o."title",
       TO_VARCHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM THE_MET.THE_MET."OBJECTS" o
JOIN THE_MET.THE_MET."VISION_API_DATA" v ON o."object_id" = v."object_id",
     LATERAL FLATTEN(input => v."cropHintsAnnotation":"cropHints") f
WHERE o."department" = 'The Libraries'
  AND o."title" LIKE '%book%'
  AND f.value:"confidence"::FLOAT > 0.5;For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'

2025-01-20 13:47:57 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 13:47:57 - root - INFO - ```sql
SELECT DISTINCT o."object_id",
       o."title",
       TO_VARCHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM THE_MET.THE_MET."OBJECTS" o
JOIN THE_MET.THE_MET."VISION_API_DATA" v ON o."object_id" = v."object_id",
     LATERAL FLATTEN(input => v."cropHintsAnnotation":"cropHints") f
WHERE o."department" = 'The Libraries'
  AND o."title" LIKE '%book%'
  AND o."title" NOT LIKE '%Book Edges%'
  AND f.value:"confidence"::FLOAT > 0.5;
```
2025-01-20 13:47:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 13:47:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 13:47:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 13:47:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 4
2025-01-20 13:47:58 - snowflake.connector.connection - INFO - closed
2025-01-20 13:47:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 13:47:59 - root - INFO - itercount: 3
2025-01-20 13:47:59 - root - INFO - 0
2025-01-20 13:47:59 - root - INFO - Total iteration counts: 3
