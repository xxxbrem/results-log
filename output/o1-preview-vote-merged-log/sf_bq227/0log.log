2025-01-20 06:39:02 - openai._base_client - INFO - Retrying request to /chat/completions in 0.476591 seconds
2025-01-20 06:39:47 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:39:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:39:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:39:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:39:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 32
2025-01-20 06:39:49 - snowflake.connector.connection - INFO - closed
2025-01-20 06:39:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:39:49 - root - INFO - SQL:
SELECT DISTINCT "minor_category"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   LIMIT 1000;
Results:
minor_category
Burglary in a Dwelling
Motor Vehicle Interference & Tampering
Theft From Shops
Handling Stolen Goods
Theft/Taking of Pedal Cycle
Criminal Damage To Other Building
Theft/Taking Of Motor Vehicle
Criminal Damage To Motor Vehicle
Rape
Murder
Drug Trafficking
Offensive Weapon
Business Property
Personal Property
Other Sexual
Other Fraud & Forgery
Other Drugs
Other Theft
Other Notifiable
Other Theft Person
Other Criminal Damage
Going Equipped
Counted per Victim
Wounding/GBH
Assault with Injury
Theft From Motor Vehicle
Burglary in Other Buildings
Criminal Damage To Dwelling
Common Assault
Possession Of Drugs
Harassment
Other violence

2025-01-20 06:39:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:39:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:39:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:39:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 32
2025-01-20 06:39:50 - snowflake.connector.connection - INFO - closed
2025-01-20 06:39:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:39:51 - root - INFO - SQL:
SELECT "minor_category", SUM("value") AS "total_crimes"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   WHERE "year" = 2008
   GROUP BY "minor_category"
   LIMIT 1000;
Results:
minor_category,total_crimes
Other Sexual,1005
Other Drugs,373
Other Theft,99280
Other Theft Person,24453
Other Notifiable,9491
Other Fraud & Forgery,1485
Rape,268
Theft/Taking Of Motor Vehicle,28303
Criminal Damage To Motor Vehicle,41693
Murder,130
Drug Trafficking,4203
Offensive Weapon,5961
Business Property,2964
Personal Property,26663
Theft From Shops,32857
Burglary in a Dwelling,56655
Motor Vehicle Interference & Tampering,3868
Handling Stolen Goods,2466
Theft/Taking of Pedal Cycle,15895
Criminal Damage To Other Building,9011
Going Equipped,621
Counted per Victim,3840
Other Criminal Damage,17649
Wounding/GBH,8701
Assault with Injury,56586
Theft From Motor Vehicle,76570
Common Assault,37356
Burglary in Other Buildings,31437
Criminal Damage To Dwelling,23519
Harassment,43389
Possession Of Drugs,64228
Other violence,7721

2025-01-20 06:39:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:39:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:39:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:39:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 9
2025-01-20 06:39:52 - snowflake.connector.connection - INFO - closed
2025-01-20 06:39:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:39:52 - root - INFO - SQL:
SELECT DISTINCT "year"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   LIMIT 1000;
Results:
year
2015
2014
2011
2009
2008
2012
2013
2010
2016

2025-01-20 06:39:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:39:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:39:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:39:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 9
2025-01-20 06:39:54 - snowflake.connector.connection - INFO - closed
2025-01-20 06:39:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:39:54 - root - INFO - SQL:
SELECT "year", SUM("value") AS "total_crimes"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   GROUP BY "year"
   ORDER BY "year" ASC
   LIMIT 1000;
Results:
year,total_crimes
2008,738641
2009,717214
2010,715324
2011,724915
2012,737329
2013,686407
2014,680183
2015,711624
2016,736121

2025-01-20 06:39:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:39:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:39:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:39:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 06:39:56 - snowflake.connector.connection - INFO - closed
2025-01-20 06:39:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:39:56 - root - INFO - SQL:
SELECT "year", "month", "minor_category", "value"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   LIMIT 1000;
Results:
Too long, hard cut:
year,month,minor_category,value
2008,2,Rape,1
2008,4,Rape,0
2008,8,Rape,0
2008,10,Rape,0
2008,3,Rape,0
2008,11,Rape,0
2008,5,Rape,0
2008,2,Rape,1
2008,7,Rape,0
2008,3,Rape,0
2008,6,Rape,0
2008,8,Rape,0
2008,5,Rape,0
2008,5,Rape,0
2008,6,Rape,0
2008,3,Rape,0
2008,9,Rape,0
2008,3,Rape,0
2008,5,Rape,0
2008,9,Rape,0
2008,11,Rape,0
2008,2,Rape,1
2008,9,Rape,0
2008,2,Rape,0
2008,4,Rape,0
2008,12,Rape,0
2008,5,Rape,0
2008,6,Rape,0
2008,9,Rape,0
2008,9,Rape,0
2008,8,Rape,0
2008,11,Rape,0
2008,8,Rape,0
2008,5,Rape,0
2008,3,Rape,0
2008,10,Rape,0
2008,4,Rape,0
2008,11,Rape,0
2008,6,Rape,0
2008,5,Rape,0
2008,8,Rape,0
2008,2,Rape,1
2008,1,Rape,0
2008,3,Rape,0
2008,8,Rape,0
2008,10,Rape,0
2008,2,Rape,1
2008,11,Rape,0
2008,1,Rape,1
2008,2,Rape,0
2008,5,Rape,0
2008,10,Rape,0
2008,10,Rape,0
2008,7,Rape,0
2008,7,Rape,0
2008,5,Rape,0
2008,12,Rape,0
2008,10,Rape,0
2008,1,Rape,1
2008,2,Rape,1
2008,3,Rape,0
2008,9,Rape,0
2008,11,Rape,0
2008,6,Rape,0
2008,7,Rape,0
2008,4,Rape,0
2008,10,Rape,0
2008,7,Rape,0
2008,7,Rape,0
2008,9,Rape,0
2008,1,Rape,0
2008,2,Rape,1
2008,8,Rape,0
2008,8,Rape,0
2008,8,Rape,0
2008,9,Rape,0
2008,11,Rape,0
2008,5,Rape,0
2008,12,Rape,0
2008,10,Rape,0
2008,3,Rape,0
2008,7,Rape,0
2008,9,Rape,0
2008,1,Rape,0
2008,10,Rape,0
2008,5,Rape,0
2008,11,Rape,0
2008,3,Rape,0
2008,6,Rape,0
2008,6,Rape,0
2008,10,Rape,0
2008,9,Rape,0
2008,7,Rape,0
2008,8,Rape,0
2008,2,Rape,0
2008,9,Rape,0
2008,3,Rape,0
2008,1,Rape,0
2008,9,Rape,0
2008,12,Rape,0
2008,6,Rape,0
2008,1,Rape,0
2008,12,Rape,0
2008,6,Rape,0
2008,7,Rape,0
2008,9,Rape,0
2008,8,Rape,0
2008,12,Rape,0
2008,11,Rape,0
2008,3,Rape,0
2008,12,Rape,0
2008,10,Rape,0
2008,7,Rape,0
2008,3,Rape,0
2008,12,Rape,0
2008,6,Rape,0
2008,12,Rape,0
2008,3,Rape,0
2008,4,Rape,0
2008,6,Rape,0
2008,2,Rape,1
2008,1,Rape,1
2008,5,Rape,0
2008,1,Rape,1
2008,5,Rape,0
2008,11,Rape,0
2008,2,Rape,1
2008,10,Rape,0
2008,5,Rape,0
2008,3,Rape,0
2008,11,Rape,0
2008,3,Rape,0
2008,5,Rape,0
2008,1,Rape,0
2008,10,Rape,0
2008,5,Rape,0
2008,8,Rape,0
2008,4,Rape,0
2008,12,Rape,0
2008,10,Rape,0
2008,4,Rape,0
2008,8,Rape,0
2008,11,Rape,0
2008,12,Rape,0
2008,9,Rape,0
2008,11,Rape,0
2008,2,Rape,0
2008,3,Rape,0
2008,1,Rape,1
2008,8,Rape,0
2008,12,Rape,0
2008,6,Rape,0
2008,2,Rape,1
2008,10,Rape,0
2008,11,Rape,0
2008,6,Rape,0
2008,1,Rape,1
2008,4,Rape,0
2008,3,Rape,0
2008,1,Rape,1
2008,6,Rape,0
2008,8,Rape,0
2008,10,Rape,0
2008,3,Rape,0
2008,2,Rape,1
2008,10,Rape,0
2008,12,Rape,0
2008,2,Rape,1
2008,9,Rape,0
2008,10,Rape,0
2008,5,Rape,0
2008,6,Rape,0
2008,3,Rape,0
2008,3,Rape,0
2008,7,Rape,0
2008,9,Rape,0
2008,6,Rape,0
2008,2,Rape,1
2008,2,Rape,0
2008,12,Rape,0
2008,4,Rape,0
2008,1,Rape,1
2008,2,Rape,0
2008,1,Rape,1
2008,8,Rape,0
2008,7,Rape,0
2008,4,Rape,0
2008,4,Rape,0
2008,8,Rape,0
2008,3,Rape,0
2008,10,Rape,0
2008,1,Rape,1
2008,8,Rape,0
2008,10,Rape,0
2008,3,Rape,0
2008,8,Rape,0
2008,1,Rape,1
2008,4,Rape,0
2008,5,Rape,0
2008,5,Rape,0
2008,1,Rape,0
2008,9,Rape,0
2008,6,Rape,0
2008,3,Rape,0
2008,11,Rape,0
2008,10,Rape,0
2008,2,Rape,2
2008,5,Rape,0
2008,9,Rape,0
2008,1,Rape,0
2008,12,Rape,0
2008,6,Rape,0
2008,5,Rape,0
2008,12,Rape,0
2008,12,Rape,0
2008,5,Rape,0
2008,3,Rape,0
2008,3,Rape,0
2008,2,Rape,1
2008,7,Rape,0
2008,1,Rape,1
2009,6,Rape,0
2009,1,Rape,0
2009,11,Rape,0
2009,6,Rape,0
2009,12,Rape,0
2009,9,Rape,0
2009,8,Rape,0
2009,5,Rape,0
2009,12,Rape,0
2009,7,Rape,0
2009,11,Rape,0
2009,12,Rape,0
2009,9,Rape,0
2009,7,Rape,0
2009,2,Rape,0
2009,8,Rape,0
2009,4,Rape,0
2009,9,Rape,0
2009,11,Rape,0
2009,7,Rape,0
2009,8,Rape,0
2009,3,Rape,0
2009,11,Rape,0
2009,9,Rape,0
2009,8,Rape,0
2009,1,Rape,0
2009,10,Rape,0
2009,4,Rape,0
2009,1,Rape,0
2009,10,Rape,0
2009,7,Rape,0
2009,11,Rape,0
2009,5,Rape,0
2009,3,Rape,0
2009,3,Rape,0
2009,12,Rape,0
2009,1,Rape,0
2009,2,Rape,0
2009,10,Rape,0
2009,7,Rape,0
2009,12,Rape,0
2009,3,Rape,0
2009,7,Rape,0
2009,8,Rape,0
2009,12,Rape,0
2009,3,Rape,0
2009,8,Rape,0
2009,2,Rape,0
2009,6,Rape,0
2009,12,Rape,0
2009,6,Rape,0
2009,4,Rape,0
2009,3,Rape,0
2009,1,Rape,0
2009,3,Rape,0
2009,1,Rape,0
2009,5,Rape,0
2009,2,Rape,0
2009,6,Rape,0
2009,5,Rape,0
2009,3,Rape,0
2009,1,Rape,0
2009,4,Rape,0
2009,11,Rape,0
2009,1,Rape,0
2009,6,Rape,0
2009,5,Rape,0
2009,6,Rape,0
2009,12,Rape,0
2009,1,Rape,0
2009,7,Rape,0
2009,11,Rape,0
2009,2,Rape,0
2009,2,Rape,0
2009,11,Rape,0
2009,11,Rape,0
2009,6,Rape,0
2009,3,Rape,0
2009,4,Rape,0
2009,1,Rape,0
2009,8,Rape,0
2009,4,Rape,0
2009,9,Rape,0
2009,2,Rape,0
2009,11,Rape,0
2009,1,Rape,0
2009,7,Rape,0
2009,12,Rape,0
2009,8,Rape,0
2009,4,Rape,0
2009,8,Rape,0
2009,5,Rape,0
2009,11,Rape,0
2009,3,Rape,0
2009,7,Rape,0
2009,12,Rape,0
2009,12,Rape,0
2009,10,Rape,0
2009,3,Rape,0
2009,5,Rape,0
2009,3,Rape,0
2009,2,Rape,0
2009,2,Rape,0
2009,1,Rape,0
2009,8,Rape,0
2009,2,Rape,0
2009,5,Rape,0
2009,2,Rape,0
2009,12,Rape,0
2009,8,Rape,0
2009,3,Rape,0
2009,8,Rape,0
2009,4,Rape,0
2009,9,Rape,0
2009,9,Rape,0
2009,5,Rape,0
2009,4,Rape,0
2009,2,Rape,0
2009,6,Rape,0
2009,9,Rape,0
2009,3,Rape,0
2009,9,Rape,0
2009,4,Rape,0
2009,1,Rape,0
2009,1,Rape,0
2009,12,Rape,0
2009,2,Rape,0
2009,9,Rape,0
2

2025-01-20 06:39:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:39:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:39:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:39:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 32
2025-01-20 06:39:58 - snowflake.connector.connection - INFO - closed
2025-01-20 06:39:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:39:58 - root - INFO - SQL:
SELECT "minor_category", SUM("value") AS "total_crimes"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   GROUP BY "minor_category"
   ORDER BY "total_crimes" DESC
   LIMIT 1000;
Results:
minor_category,total_crimes
Other Theft,980085
Theft From Motor Vehicle,569956
Burglary in a Dwelling,491282
Harassment,458124
Assault with Injury,451001
Possession Of Drugs,431948
Common Assault,413690
Theft From Shops,345142
Other Theft Person,308842
Criminal Damage To Motor Vehicle,265463
Burglary in Other Buildings,263011
Personal Property,237578
Theft/Taking Of Motor Vehicle,216538
Theft/Taking of Pedal Cycle,168974
Criminal Damage To Dwelling,154116
Other Criminal Damage,145356
Wounding/GBH,125556
Other Notifiable,100819
Other violence,70778
Criminal Damage To Other Building,66003
Motor Vehicle Interference & Tampering,56224
Offensive Weapon,37983
Drug Trafficking,35819
Business Property,21295
Handling Stolen Goods,16100
Going Equipped,5530
Counted per Victim,3840
Other Drugs,2998
Other Fraud & Forgery,1485
Other Sexual,1005
Murder,949
Rape,268

2025-01-20 06:39:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:39:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:39:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:39:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 288
2025-01-20 06:39:59 - snowflake.connector.connection - INFO - closed
2025-01-20 06:40:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:40:00 - root - INFO - SQL:
SELECT "year", "minor_category", SUM("value") AS "total_crimes"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   WHERE "year" >= 2008
   GROUP BY "year", "minor_category"
   ORDER BY "year" ASC, "total_crimes" DESC
   LIMIT 1000;
Results:
Too long, hard cut:
year,minor_category,total_crimes
2008,Other Theft,99280
2008,Theft From Motor Vehicle,76570
2008,Possession Of Drugs,64228
2008,Burglary in a Dwelling,56655
2008,Assault with Injury,56586
2008,Harassment,43389
2008,Criminal Damage To Motor Vehicle,41693
2008,Common Assault,37356
2008,Theft From Shops,32857
2008,Burglary in Other Buildings,31437
2008,Theft/Taking Of Motor Vehicle,28303
2008,Personal Property,26663
2008,Other Theft Person,24453
2008,Criminal Damage To Dwelling,23519
2008,Other Criminal Damage,17649
2008,Theft/Taking of Pedal Cycle,15895
2008,Other Notifiable,9491
2008,Criminal Damage To Other Building,9011
2008,Wounding/GBH,8701
2008,Other violence,7721
2008,Offensive Weapon,5961
2008,Drug Trafficking,4203
2008,Motor Vehicle Interference & Tampering,3868
2008,Counted per Victim,3840
2008,Business Property,2964
2008,Handling Stolen Goods,2466
2008,Other Fraud & Forgery,1485
2008,Other Sexual,1005
2008,Going Equipped,621
2008,Other Drugs,373
2008,Rape,268
2008,Murder,130
2009,Other Theft,95424
2009,Theft From Motor Vehicle,68856
2009,Burglary in a Dwelling,60185
2009,Possession Of Drugs,56070
2009,Assault with Injury,55297
2009,Harassment,43594
2009,Common Assault,39671
2009,Criminal Damage To Motor Vehicle,36621
2009,Theft From Shops,36349
2009,Burglary in Other Buildings,30434
2009,Other Theft Person,27549
2009,Personal Property,26453
2009,Theft/Taking Of Motor Vehicle,24476
2009,Criminal Damage To Dwelling,22475
2009,Theft/Taking of Pedal Cycle,20721
2009,Other Criminal Damage,18121
2009,Other Notifiable,10007
2009,Wounding/GBH,10005
2009,Criminal Damage To Other Building,8348
2009,Other violence,7571
2009,Offensive Weapon,4520
2009,Motor Vehicle Interference & Tampering,4210
2009,Drug Trafficking,4172
2009,Business Property,3115
2009,Handling Stolen Goods,1907
2009,Going Equipped,637
2009,Other Drugs,307
2009,Murder,119
2009,Other Sexual,0
2009,Rape,0
2009,Other Fraud & Forgery,0
2009,Counted per Victim,0
2010,Other Theft,103997
2010,Theft From Motor Vehicle,69709
2010,Burglary in a Dwelling,57123
2010,Assault with Injury,54173
2010,Possession Of Drugs,54026
2010,Harassment,42808
2010,Common Assault,41591
2010,Theft From Shops,36935
2010,Criminal Damage To Motor Vehicle,32907
2010,Burglary in Other Buildings,29703
2010,Other Theft Person,29547
2010,Personal Property,29300
2010,Theft/Taking Of Motor Vehicle,24890
2010,Criminal Damage To Dwelling,20253
2010,Theft/Taking of Pedal Cycle,19726
2010,Other Criminal Damage,16775
2010,Other Notifiable,10101
2010,Wounding/GBH,8033
2010,Criminal Damage To Other Building,7962
2010,Other violence,6947
2010,Motor Vehicle Interference & Tampering,4406
2010,Drug Trafficking,4252
2010,Offensive Weapon,4229
2010,Business Property,3041
2010,Handling Stolen Goods,1714
2010,Going Equipped,667
2010,Other Drugs,396
2010,Murder,113
2010,Other Fraud & Forgery,0
2010,Other Sexual,0
2010,Rape,0
2010,Counted per Victim,0
2011,Other Theft,113616
2011,Theft From Motor Vehicle,69604
2011,Burglary in a Dwelling,62439
2011,Possession Of Drugs,52769
2011,Assault with Injury,50768
2011,Common Assault,40502
2011,Harassment,37493
2011,Theft From Shops,36351
2011,Other Theft Person,36090
2011,Personal Property,33994
2011,Burglary in Other Buildings,30876
2011,Criminal Damage To Motor Vehicle,29494
2011,Theft/Taking Of Motor Vehicle,26161
2011,Theft/Taking of Pedal Cycle,20885
2011,Criminal Damage To Dwelling,18037
2011,Other Criminal Damage,15938
2011,Other Notifiable,9565
2011,Wounding/GBH,7628
2011,Criminal Damage To Other Building,7445
2011,Other violence,6414
2011,Motor Vehicle Interference & Tampering,4481
2011,Drug Trafficking,4460
2011,Offensive Weapon,3991
2011,Business Property,2685
2011,Handling Stolen Goods,2104
2011,Going Equipped,699
2011,Other Drugs,321
2011,Murder,105
2011,Rape,0
2011,Other Sexual,0
2011,Counted per Victim,0
2011,Other Fraud & Forgery,0
2012,Other Theft,132056
2012,Theft From Motor Vehicle,68198
2012,Burglary in a Dwelling,61716
2012,Assault with Injury,50369
2012,Possession Of Drugs,47491
2012,Other Theft Person,46585
2012,Harassment,43396
2012,Common Assault,39246
2012,Theft From Shops,36562
2012,Personal Property,32810
2012,Burglary in Other Buildings,31676
2012,Criminal Damage To Motor Vehicle,25777
2012,Theft/Taking Of Motor Vehicle,22464
2012,Theft/Taking of Pedal Cycle,21339
2012,Criminal Damage To Dwelling,15330
2012,Other Criminal Damage,14298
2012,Other Notifiable,10075
2012,Wounding/GBH,7151
2012,Criminal Damage To Other Building,6753
2012,Other violence,6623
2012,Motor Vehicle Interference & Tampering,5113
2012,Drug Trafficking,3964
2012,Offensive Weapon,3134
2012,Business Property,2450
2012,Handling Stolen Goods,1737
2012,Going Equipped,600
2012,Other Drugs,321
2012,Murder,95
2012,Other Sexual,0
2012,Rape,0
2012,Counted per Victim,0
2012,Other Fraud & Forgery,0
2013,Other Theft,115757
2013,Theft From Motor Vehicle,63509
2013,Burglary in a Dwelling,56537
2013,Possession Of Drugs,45755
2013,Other Theft Person,44964
2013,Harassment,4180

2025-01-20 06:40:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:40:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:40:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:40:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 33
2025-01-20 06:40:01 - snowflake.connector.connection - INFO - closed
2025-01-20 06:40:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:40:02 - root - INFO - SQL:
SELECT DISTINCT "borough"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   LIMIT 1000;
Results:
borough
Barking and Dagenham
Bexley
Merton
Lambeth
Haringey
Ealing
Redbridge
Havering
Westminster
Brent
Camden
Islington
Waltham Forest
Hounslow
Barnet
Hillingdon
Croydon
Tower Hamlets
Sutton
Kensington and Chelsea
Newham
Wandsworth
Hammersmith and Fulham
Lewisham
Greenwich
Bromley
Southwark
Harrow
Hackney
Kingston upon Thames
Enfield
City of London
Richmond upon Thames

2025-01-20 06:40:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:40:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:40:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:40:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 33
2025-01-20 06:40:03 - snowflake.connector.connection - INFO - closed
2025-01-20 06:40:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:40:03 - root - INFO - SQL:
SELECT "borough", SUM("value") AS "total_crimes"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   WHERE "year" = 2008
   GROUP BY "borough"
   ORDER BY "total_crimes" DESC
   LIMIT 1000;
Results:
borough,total_crimes
Westminster,47846
Southwark,33470
Camden,32010
Lambeth,31717
Newham,29752
Croydon,29516
Ealing,28947
Lewisham,27054
Islington,26273
Haringey,25724
Hillingdon,24318
Waltham Forest,24080
Bromley,24015
Barnet,23944
Tower Hamlets,23578
Brent,23504
Wandsworth,23330
Greenwich,22010
Hackney,22004
Enfield,21980
Hammersmith and Fulham,21114
Redbridge,20873
Kensington and Chelsea,20663
Hounslow,20204
Barking and Dagenham,17656
Havering,15395
Bexley,15305
Merton,13875
Harrow,13774
Sutton,12943
Richmond upon Thames,11106
Kingston upon Thames,10661
City of London,0

2025-01-20 06:40:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:40:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:40:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:40:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 06:40:05 - snowflake.connector.connection - INFO - closed
2025-01-20 06:40:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:40:05 - root - INFO - SQL:
SELECT DISTINCT "lsoa_code", SUM("value") AS "total_crimes"
    FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
    GROUP BY "lsoa_code"
    LIMIT 1000;
Results:
Too long, hard cut:
lsoa_code,total_crimes
E01003732,1115
E01002448,1655
E01002467,491
E01004542,764
E01003748,1026
E01002550,966
E01004558,714
E01004554,617
E01003645,2788
E01001967,587
E01002250,1041
E01002616,778
E01002439,1272
E01003989,2326
E01004516,848
E01003832,637
E01001932,3559
E01004452,1979
E01003994,2993
E01003914,1450
E01002463,441
E01004555,649
E01004723,1370
E01003004,685
E01002902,2608
E01000521,3337
E01000312,879
E01003414,813
E01004230,1904
E01004322,3248
E01004363,2177
E01002741,1034
E01003866,434
E01000952,1019
E01000388,447
E01000330,1074
E01000884,711
E01000506,2150
E01032744,1397
E01001288,857
E01002238,672
E01003621,705
E01000774,830
E01000507,858
E01000652,605
E01002199,503
E01003534,1305
E01001134,505
E01004195,876
E01002642,3848
E01001704,938
E01004355,931
E01003734,1573
E01000708,652
E01003013,8176
E01002278,966
E01002998,483
E01001116,1681
E01003022,1090
E01033133,315
E01004668,574
E01004468,1408
E01001026,442
E01002489,1279
E01003243,1950
E01003784,713
E01001217,706
E01000374,865
E01003616,2106
E01003254,699
E01002820,2786
E01003910,394
E01000018,907
E01001279,527
E01000392,1816
E01000292,917
E01000130,787
E01000519,903
E01033586,694
E01000797,1628
E01000282,614
E01001531,393
E01003110,1215
E01001559,5021
E01001012,1652
E01001127,552
E01001135,914
E01001534,1130
E01001457,702
E01003429,744
E01002070,1486
E01002599,842
E01002348,466
E01001105,488
E01001835,630
E01003127,1753
E01003767,2158
E01004545,1768
E01001671,1013
E01002441,1007
E01000090,1189
E01001752,1604
E01003034,1086
E01003950,974
E01004534,1687
E01001851,1006
E01004047,804
E01000962,681
E01002147,412
E01000697,543
E01002181,700
E01001569,933
E01001035,746
E01003331,927
E01000965,888
E01000224,523
E01000617,998
E01000379,475
E01003113,1362
E01002673,804
E01003311,704
E01001995,1098
E01004508,1546
E01002787,1097
E01003913,3448
E01002406,2837
E01004633,640
E01002245,936
E01002078,1210
E01032764,1452
E01001935,1122
E01004674,1570
E01004427,1190
E01002973,776
E01002939,833
E01001951,1313
E01004350,1320
E01002422,1055
E01003756,1100
E01002287,481
E01003831,562
E01000532,1278
E01000944,635
E01000764,403
E01001807,857
E01003562,1303
E01002347,578
E01002281,1657
E01003268,961
E01004517,1297
E01001672,959
E01002996,463
E01002891,601
E01033728,386
E01004292,720
E01003468,428
E01002903,1749
E01000336,1455
E01001346,551
E01001359,2017
E01004087,472
E01003400,944
E01001603,1044
E01002555,1187
E01002034,4214
E01003222,628
E01003542,1309
E01001395,887
E01004044,929
E01004362,1300
E01000185,656
E01001333,2400
E01003404,419
E01000746,1423
E01003051,2428
E01001176,1364
E01001843,810
E01003282,1678
E01001683,992
E01003968,920
E01003997,1288
E01002494,547
E01001875,1627
E01000342,406
E01002221,1075
E01002060,738
E01000589,1520
E01002120,684
E01003424,518
E01000672,951
E01000187,520
E01000654,376
E01000655,402
E01003471,1244
E01000989,460
E01003119,1591
E01002026,9677
E01003271,623
E01001565,491
E01001809,755
E01002277,1182
E01004617,3584
E01003975,1151
E01033093,762
E01004574,1279
E01001640,3339
E01003760,1190
E01000103,1056
E01002938,547
E01004309,5350
E01000029,861
E01002884,3972
E01002802,1394
E01003737,1037
E01004716,1393
E01004426,789
E01000308,1272
E01000471,502
E01001204,572
E01000717,539
E01000829,445
E01000649,594
E01004020,873
E01001580,1839
E01004450,665
E01003166,2272
E01004515,839
E01001750,1811
E01003797,587
E01000530,888
E01003162,1041
E01003200,2088
E01002462,345
E01003304,3664
E01001928,1691
E01000600,4806
E01000510,2940
E01000473,1807
E01002186,945
E01003138,864
E01003446,1280
E01002089,757
E01002360,648
E01001071,614
E01001735,1570
E01002661,2215
E01004709,1574
E01004656,1732
E01001772,878
E01000068,1050
E01004422,3028
E01001911,1265
E01002183,841
E01004160,424
E01004199,1022
E01002928,783
E01004579,1228
E01001519,3536
E01001888,852
E01003140,439
E01004627,860
E01003526,1145
E01001174,855
E01004256,1327
E01003214,1851
E01001483,985
E01002608,1869
E01000031,1221
E01003747,286
E01004119,1257
E01001832,1375
E01003715,965
E01002498,1008
E01001867,663
E01000713,554
E01003157,919
E01004099,1234
E01001393,931
E01002083,775
E01001727,531
E01002303,835
E01002770,4680
E01003752,1075
E01002532,1375
E01004024,1639
E01003958,965
E01004589,829
E01002533,519
E01002310,1596
E01000041,750
E01003983,1337
E01003954,594
E01002659,492
E01001708,653
E01004469,907
E01000049,1595
E01003829,1706
E01033604,1590
E01004298,1403
E01002767,1297
E01004019,1164
E01001864,1043
E01004698,2371
E01004244,2285
E01004346,984
E01004458,1336
E01032739,376
E01000423,273
E01000894,1021
E01000926,1072
E01003440,986
E01001328,1687
E01003319,1402
E01002743,971
E01002729,1641
E01003706,711
E01000110,705
E01001921,1571
E01000294,1198
E01000909,967
E01000272,462
E01001385,724
E01000802,893
E01000754,574
E01001550,777
E01001444,609
E01003069,911
E01003579,802
E01001114,1461
E01001045,6455
E01004090,913
E01003211,1538
E01003290,1683
E01000324,751
E01002253,385
E01000023,1862
E01001400,612
E01003309,1216
E01003082,1047
E01000284,800
E01000377,460
E01001336,1000
E01004339,818
E01004357,80

2025-01-20 06:40:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:40:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:40:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:40:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 9
2025-01-20 06:40:07 - snowflake.connector.connection - INFO - closed
2025-01-20 06:40:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:40:07 - root - INFO - SQL:
SELECT "major_category", SUM("value") AS "total_crimes"
    FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
    WHERE "year" = 2008
    GROUP BY "major_category"
    ORDER BY "total_crimes" DESC
    LIMIT 1000;
Results:
major_category,total_crimes
Theft and Handling,283692
Violence Against the Person,159844
Criminal Damage,91872
Burglary,88092
Drugs,68804
Robbery,29627
Other Notifiable Offences,10112
Fraud or Forgery,5325
Sexual Offences,1273

2025-01-20 06:40:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:40:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:40:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:40:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-20 06:40:08 - snowflake.connector.connection - INFO - closed
2025-01-20 06:40:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:40:09 - root - INFO - SQL:
SELECT "minor_category", SUM("value") AS "total_crimes"
    FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
    WHERE "year" = 2008
    GROUP BY "minor_category"
    ORDER BY "total_crimes" DESC
    LIMIT 5;
Results:
minor_category,total_crimes
Other Theft,99280
Theft From Motor Vehicle,76570
Possession Of Drugs,64228
Burglary in a Dwelling,56655
Assault with Injury,56586

2025-01-20 06:40:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:40:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:40:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:40:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 12
2025-01-20 06:40:10 - snowflake.connector.connection - INFO - closed
2025-01-20 06:40:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:40:11 - root - INFO - SQL:
SELECT "month", SUM("value") AS "total_crimes"
    FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
    WHERE "year" = 2008 AND "minor_category" = (SELECT "minor_category" FROM
        (SELECT "minor_category", SUM("value") AS "total_crimes"
         FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
         WHERE "year" = 2008
         GROUP BY "minor_category"
         ORDER BY "total_crimes" DESC
         LIMIT 1))
    GROUP BY "month"
    ORDER BY "month" ASC
    LIMIT 1000;
Results:
month,total_crimes
1,8262
2,8063
3,8460
4,8368
5,8468
6,8581
7,8940
8,7877
9,7751
10,8515
11,8480
12,7515

2025-01-20 06:40:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:40:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:40:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:40:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-20 06:40:12 - snowflake.connector.connection - INFO - closed
2025-01-20 06:40:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:40:43 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:40:43 - root - INFO - ```sql
SELECT "month", SUM("value") AS "total_crimes"
FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
WHERE "year" = 2008 AND "minor_category" = 'Other Theft'
GROUP BY "month"
ORDER BY "month" ASC
LIMIT 1000;
```
2025-01-20 06:40:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:40:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:40:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:40:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 12
2025-01-20 06:40:44 - snowflake.connector.connection - INFO - closed
2025-01-20 06:40:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:41:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:41:33 - root - INFO - SQL:
SELECT "month", SUM("value") AS "total_crimes"
FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
WHERE "year" = 2008 AND "minor_category" = 'Other Theft'
GROUP BY "month"
ORDER BY "month" ASC
LIMIT 1000;
Results:
month,total_crimes
1,8262
2,8063
3,8460
4,8368
5,8468
6,8581
7,8940
8,7877
9,7751
10,8515
11,8480
12,7515

2025-01-20 06:41:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:41:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:41:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:41:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-20 06:41:34 - snowflake.connector.connection - INFO - closed
2025-01-20 06:41:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:41:35 - root - INFO - SQL:
SELECT SUM("value") AS "total_crimes"
FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
WHERE "year" >= 2008
Results:
total_crimes
6447758

2025-01-20 06:41:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:41:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:41:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:41:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-20 06:41:36 - snowflake.connector.connection - INFO - closed
2025-01-20 06:41:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:41:37 - root - INFO - SQL:
SELECT "lsoa_code", SUM("value") AS "total_crimes"
FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
GROUP BY "lsoa_code"
LIMIT 1000
Results:
Too long, hard cut:
lsoa_code,total_crimes
E01002846,1417
E01002748,1942
E01002699,1016
E01004602,943
E01001929,837
E01002799,1626
E01002803,4498
E01004605,940
E01004521,956
E01001896,1186
E01002845,772
E01002398,856
E01033593,898
E01004242,2469
E01002407,2792
E01002491,1117
E01001981,1072
E01033000,620
E01001676,1150
E01001664,2241
E01004432,1301
E01004438,4193
E01033594,3723
E01003875,700
E01004218,888
E01000901,1222
E01000340,450
E01000556,2262
E01003383,3409
E01001178,2676
E01004394,1405
E01004003,1704
E01001917,871
E01002816,1258
E01000642,3164
E01000249,490
E01000172,547
E01000535,1513
E01001232,542
E01000434,882
E01000907,782
E01002224,641
E01000782,1552
E01000367,872
E01002171,555
E01003469,1344
E01000674,733
E01003573,1029
E01003511,946
E01001009,913
E01001189,528
E01001040,1001
E01002000,973
E01033711,1005
E01003056,960
E01002264,752
E01002648,2643
E01000270,496
E01000951,623
E01002323,443
E01001459,671
E01002353,4153
E01002934,412
E01002809,1045
E01004068,1634
E01002566,2618
E01002588,1179
E01004750,6770
E01004659,1378
E01004338,800
E01002927,540
E01002995,322
E01000010,9389
E01033100,706
E01004430,5749
E01002837,519
E01032743,506
E01000244,990
E01003397,620
E01001497,694
E01003484,798
E01004391,1564
E01001913,1031
E01002793,2147
E01003857,676
E01000314,1942
E01000551,1383
E01000570,881
E01001335,1015
E01000955,1021
E01002157,1056
E01000958,2437
E01002198,486
E01004180,540
E01000769,1826
E01001079,906
E01001185,970
E01001456,353
E01001179,752
E01001412,1821
E01001083,567
E01001480,762
E01003398,923
E01003546,1150
E01002330,657
E01002032,1232
E01003326,878
E01001024,463
E01003241,1379
E01002512,1138
E01004526,1418
E01002339,504
E01003935,2097
E01003310,1105
E01033600,445
E01032790,313
E01032741,4096
E01003697,1424
E01000250,2659
E01000618,648
E01004181,603
E01003459,1105
E01001113,1554
E01003349,754
E01000994,796
E01003017,2995
E01002653,693
E01001308,771
E01003457,447
E01000744,1151
E01000816,521
E01000768,464
E01001566,591
E01003048,1631
E01001414,621
E01003111,731
E01002064,831
E01004034,1320
E01002282,2481
E01002380,922
E01004712,3238
E01004365,2096
E01004384,1461
E01001922,1534
E01000009,2405
E01004334,1009
E01004456,1821
E01004234,4374
E01000106,1992
E01000192,1872
E01000117,823
E01002153,343
E01004193,722
E01000784,565
E01003350,1003
E01000088,1260
E01004257,1254
E01002268,632
E01002434,527
E01000594,1611
E01000464,727
E01000262,753
E01001661,1346
E01002085,2192
E01003690,2900
E01002042,1451
E01002827,3190
E01002368,1757
E01000079,888
E01002807,1210
E01000511,929
E01001703,1269
E01004200,1156
E01004364,1647
E01001237,849
E01000368,702
E01000338,946
E01000616,927
E01004137,1715
E01003538,1384
E01033581,1104
E01003607,1365
E01000745,1378
E01003026,1784
E01001434,676
E01002284,1058
E01003301,1428
E01033745,541
E01004522,816
E01001657,810
E01003240,1414
E01002953,594
E01000095,4427
E01004336,1343
E01003688,1153
E01001765,1047
E01001016,727
E01002647,1001
E01004618,665
E01004360,449
E01000643,2606
E01000263,420
E01000387,348
E01000235,999
E01001381,2181
E01000801,960
E01001136,2517
E01001100,437
E01001111,1751
E01001028,590
E01001467,631
E01003039,3065
E01001782,1114
E01003046,1206
E01003727,831
E01004612,1233
E01003774,707
E01004067,7428
E01001182,881
E01004375,1116
E01004347,1289
E01002444,20578
E01001986,798
E01004386,593
E01003694,486
E01001944,1121
E01001389,2781
E01000625,866
E01000290,780
E01000174,1051
E01003381,474
E01003564,1221
E01003493,2350
E01003560,622
E01001813,1709
E01002589,2500
E01003062,1912
E01001719,620
E01004261,2215
E01001891,1846
E01002093,1700
E01000818,513
E01002534,415
E01003876,7624
E01003813,488
E01000074,842
E01000226,799
E01001338,1881
E01002351,636
E01001556,721
E01003020,2768
E01004030,1087
E01004701,660
E01003973,2280
E01000787,867
E01004569,1835
E01000844,750
E01000634,1334
E01001201,750
E01001224,582
E01000859,1482
E01003314,833
E01001845,1280
E01002319,2256
E01002789,1073
E01004022,2251
E01004016,1426
E01004462,1286
E01000102,876
E01003835,572
E01000059,887
E01001795,1359
E01001644,1787
E01004010,3507
E01032562,579
E01004214,746
E01002667,1289
E01003472,356
E01001034,760
E01003701,1743
E01033729,770
E01002564,1341
E01003805,514
E01003669,1113
E01000897,789
E01002372,499
E01003981,3853
E01032639,1829
E01004324,918
E01001553,884
E01000064,1325
E01003810,515
E01000207,870
E01003371,595
E01003195,707
E01002547,1086
E01000485,533
E01001119,255
E01003156,753
E01000052,1451
E01004610,759
E01001560,917
E01001124,304
E01002373,698
E01002881,833
E01002892,998
E01003792,815
E01003761,842
E01003934,4231
E01003768,1242
E01002735,2381
E01003757,1069
E01002539,443
E01002485,1312
E01002549,1045
E01004645,982
E01002341,388
E01002854,1707
E01004623,664
E01002794,10529
E01004290,1782
E01004467,1854
E01000086,863
E01001870,1091
E01004447,831
E01002782,1037
E01002520,1538
E01003845,611
E01001886,1210
E01002868,721
E01001880,1553
E01000893,796
E01000604,1086
E01001229,718
E01000919,10973
E01001287,659
E01002208,254
E01003637,767
E01003599,1082
E01001758,1541
E01003245,1015
E01002670,847
E01001712,15

2025-01-20 06:41:37 - root - INFO - itercount: 0
2025-01-20 06:41:37 - root - INFO - Database Name: LONDON
Schema Name: LONDON_CRIME
DDL describes table information.
,0
table_name,CRIME_BY_LSOA
description,
DDL,"create or replace TABLE CRIME_BY_LSOA (
	""lsoa_code"" VARCHAR(16777216),
	""borough"" VARCHAR(16777216),
	""major_category"" VARCHAR(16777216),
	""minor_category"" VARCHAR(16777216),
	""value"" NUMBER(38,0),
	""year"" NUMBER(38,0),
	""month"" NUMBER(38,0)
);"

Database Name: LONDON
Schema Name: LONDON_FIRE_BRIGADE
DDL describes table information.
,0
table_name,FIRE_BRIGADE_SERVICE_CALLS
description,
DDL,"create or replace TABLE FIRE_BRIGADE_SERVICE_CALLS (
	""incident_number"" VARCHAR(16777216),
	""date_of_call"" DATE,
	""cal_year"" NUMBER(38,0),
	""time_of_call"" TIME(9),
	""hour_of_call"" NUMBER(38,0),
	""timestamp_of_call"" NUMBER(38,0),
	""incident_group"" VARCHAR(16777216),
	""stop_code_description"" VARCHAR(16777216),
	""special_service_type"" VARCHAR(16777216),
	""property_category"" VARCHAR(16777216),
	""property_type"" VARCHAR(16777216),
	""address_qualifier"" VARCHAR(16777216),
	""postcode_full"" VARCHAR(16777216),
	""postcode_district"" VARCHAR(16777216),
	""borough_code"" VARCHAR(16777216),
	""borough_name"" VARCHAR(16777216),
	""proper_case"" VARCHAR(16777216),
	""ward_code"" VARCHAR(16777216),
	""ward_name"" VARCHAR(16777216),
	""ward_name_new"" VARCHAR(16777216),
	""easting_m"" NUMBER(38,0),
	""northing_m"" NUMBER(38,0),
	""easting_rounded"" NUMBER(38,0),
	""northing_rounded"" NUMBER(38,0),
	""frs"" VARCHAR(16777216),
	""incident_station_ground"" VARCHAR(16777216),
	""first_pump_arriving_attendance_time"" NUMBER(38,0),
	""first_pump_arriving_deployed_from_station"" VARCHAR(16777216),
	""second_pump_arriving_attendance_time"" NUMBER(38,0),
	""second_pump_arriving_deployed_from_station"" VARCHAR(16777216),
	""num_stations_with_pumps_attending"" NUMBER(38,0),
	""num_pumps_attending"" NUMBER(38,0)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'LONDON': {'LONDON_CRIME': ['CRIME_BY_LSOA'], 'LONDON_FIRE_BRIGADE': ['FIRE_BRIGADE_SERVICE_CALLS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

**Table:** `LONDON.LONDON_CRIME.CRIME_BY_LSOA`

- **"year"**: Used to filter data for specific years (e.g., 2008) and to group totals by year.
- **"minor_category"**: Used to identify and group data by specific minor crime categories.
- **"value"**: Represents the count of crimes, used to calculate totals.
- **"borough"**: Can be used to analyze crime data by borough (not directly required for this task).
- **"major_category"**: Higher-level crime category; potentially useful for broader analysis.
- **"month"**: Could be used for monthly analysis (not required for this annual percentage task).
- **"lsoa_code"**: Location identifier (not directly relevant for this task).

**Conditions That May Be Used:**

- **"year" = 2008**: To filter data specifically for the year 2008.
- **"year" >= 2008**: To include data from 2008 onwards.
- **Grouping by "year" and "minor_category"**: To aggregate crime counts per category and per year.

---

**Sample SQL Queries:**

1. **List all distinct minor crime categories:**
   ```sql
   SELECT DISTINCT "minor_category"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   LIMIT 1000;
   ```

2. **Retrieve total crimes per minor category in 2008:**
   ```sql
   SELECT "minor_category", SUM("value") AS "total_crimes"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   WHERE "year" = 2008
   GROUP BY "minor_category"
   LIMIT 1000;
   ```

3. **Get all years available in the dataset:**
   ```sql
   SELECT DISTINCT "year"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   LIMIT 1000;
   ```

4. **Fetch total crimes per year:**
   ```sql
   SELECT "year", SUM("value") AS "total_crimes"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   GROUP BY "year"
   ORDER BY "year" ASC
   LIMIT 1000;
   ```

5. **Sample data of crimes with year, month, category, and value:**
   ```sql
   SELECT "year", "month", "minor_category", "value"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   LIMIT 1000;
   ```

6. **List total crimes per minor category across all years:**
   ```sql
   SELECT "minor_category", SUM("value") AS "total_crimes"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   GROUP BY "minor_category"
   ORDER BY "total_crimes" DESC
   LIMIT 1000;
   ```

7. **Retrieve crimes per minor category per year from 2008 onwards:**
   ```sql
   SELECT "year", "minor_category", SUM("value") AS "total_crimes"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   WHERE "year" >= 2008
   GROUP BY "year", "minor_category"
   ORDER BY "year" ASC, "total_crimes" DESC
   LIMIT 1000;
   ```

8. **List all distinct boroughs present in the dataset:**
   ```sql
   SELECT DISTINCT "borough"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   LIMIT 1000;
   ```

9. **Retrieve total crimes per borough in 2008:**
   ```sql
   SELECT "borough", SUM("value") AS "total_crimes"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   WHERE "year" = 2008
   GROUP BY "borough"
   ORDER BY "total_crimes" DESC
   LIMIT 1000;
   ```

10. **Get sample LSOA codes and associated crime counts:**
    ```sql
    SELECT DISTINCT "lsoa_code", SUM("value") AS "total_crimes"
    FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
    GROUP BY "lsoa_code"
    LIMIT 1000;
    ```

11. **Find total crimes per major crime category in 2008:**
    ```sql
    SELECT "major_category", SUM("value") AS "total_crimes"
    FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
    WHERE "year" = 2008
    GROUP BY "major_category"
    ORDER BY "total_crimes" DESC
    LIMIT 1000;
    ```

12. **List the top 5 minor crime categories in 2008 by total crimes:**
    ```sql
    SELECT "minor_category", SUM("value") AS "total_crimes"
    FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
    WHERE "year" = 2008
    GROUP BY "minor_category"
    ORDER BY "total_crimes" DESC
    LIMIT 5;
    ```

13. **Retrieve monthly crime totals for the top minor category in 2008:**
    ```sql
    SELECT "month", SUM("value") AS "total_crimes"
    FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
    WHERE "year" = 2008 AND "minor_category" = (SELECT "minor_category" FROM
        (SELECT "minor_category", SUM("value") AS "total_crimes"
         FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
         WHERE "year" = 2008
         GROUP BY "minor_category"
         ORDER BY "total_crimes" DESC
         LIMIT 1))
    GROUP BY "month"
    ORDER BY "month" ASC
    LIMIT 1000;
    ```

14. **Check for any records with missing minor category information:**
    ```sql
    SELECT *
    FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
    WHERE "minor_category" IS NULL
    LIMIT 1000;
    ```

15. **Find the total number of crimes from 2008 onwards:**
    ```sql
    SELECT SUM("value") AS "total_crimes"
    FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
    WHERE "year" >= 2008
    LIMIT 1000;
    ```

**Note:** Each of these queries is designed to help understand the data structure and contents relevant to calculating the annual percentage shares of the top 5 minor crime categories from 2008 in London's total crimes. They focus on different aspects such as distinct values, aggregations, and data verification.Query:
SELECT DISTINCT "minor_category"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   LIMIT 1000;
Answer:
minor_category
Burglary in a Dwelling
Motor Vehicle Interference & Tampering
Theft From Shops
Handling Stolen Goods
Theft/Taking of Pedal Cycle
Criminal Damage To Other Building
Theft/Taking Of Motor Vehicle
Criminal Damage To Motor Vehicle
Rape
Murder
Drug Trafficking
Offensive Weapon
Business Property
Personal Property
Other Sexual
Other Fraud & Forgery
Other Drugs
Other Theft
Other Notifiable
Other Theft Person
Other Criminal Damage
Going Equipped
Counted per Victim
Wounding/GBH
Assault with Injury
Theft From Motor Vehicle
Burglary in Other Buildings
Criminal Damage To Dwelling
Common Assault
Possession Of Drugs
Harassment
Other violence
Query:
SELECT "minor_category", SUM("value") AS "total_crimes"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   WHERE "year" = 2008
   GROUP BY "minor_category"
   LIMIT 1000;
Answer:
minor_category,total_crimes
Other Sexual,1005
Other Drugs,373
Other Theft,99280
Other Theft Person,24453
Other Notifiable,9491
Other Fraud & Forgery,1485
Rape,268
Theft/Taking Of Motor Vehicle,28303
Criminal Damage To Motor Vehicle,41693
Murder,130
Drug Trafficking,4203
Offensive Weapon,5961
Business Property,2964
Personal Property,26663
Theft From Shops,32857
Burglary in a Dwelling,56655
Motor Vehicle Interference & Tampering,3868
Handling Stolen Goods,2466
Theft/Taking of Pedal Cycle,15895
Criminal Damage To Other Building,9011
Going Equipped,621
Counted per Victim,3840
Other Criminal Damage,17649
Wounding/GBH,8701
Assault with Injury,56586
Theft From Motor Vehicle,76570
Common Assault,37356
Burglary in Other Buildings,31437
Criminal Damage To Dwelling,23519
Harassment,43389
Possession Of Drugs,64228
Other violence,7721
Query:
SELECT DISTINCT "year"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   LIMIT 1000;
Answer:
year
2015
2014
2011
2009
2008
2012
2013
2010
2016
Query:
SELECT "year", SUM("value") AS "total_crimes"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   GROUP BY "year"
   ORDER BY "year" ASC
   LIMIT 1000;
Answer:
year,total_crimes
2008,738641
2009,717214
2010,715324
2011,724915
2012,737329
2013,686407
2014,680183
2015,711624
2016,736121
Query:
SELECT "year", "month", "minor_category", "value"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   LIMIT 1000;
Answer:
Too long, hard cut:
year,month,minor_category,value
2008,2,Rape,1
2008,4,Rape,0
2008,8,Rape,0
2008,10,Rape,0
2008,3,Rape,0
2008,11,Rape,0
2008,5,Rape,0
2008,2,Rape,1
2008,7,Rape,0
2008,3,Rape,0
2008,6,Rape,0
2008,8,Rape,0
2008,5,Rape,0
2008,5,Rape,0
2008,6,Rape,0
2008,3,Rape,0
2008,9,Rape,0
2008,3,Rape,0
2008,5,Rape,0
2008,9,Rape,0
2008,11,Rape,0
2008,2,Rape,1
2008,9,Rape,0
2008,2,Rape,0
2008,4,Rape,0
2008,12,Rape,0
2008,5,Rape,0
2008,6,Rape,0
2008,9,Rape,0
2008,9,Rape,0
2008,8,Rape,0
2008,11,Rape,0
2008,8,Rape,0
2008,5,Rape,0
2008,3,Rape,0
2008,10,Rape,0
2008,4,Rape,0
2008,11,Rape,0
2008,6,Rape,0
2008,5,Rape,0
2008,8,Rape,0
2008,2,Rape,1
2008,1,Rape,0
2008,3,Rape,0
2008,8,Rape,0
2008,10,Rape,0
2008,2,Rape,1
2008,11,Rape,0
2008,1,Rape,1
2008,2,Rape,0
2008,5,Rape,0
2008,10,Rape,0
2008,10,Rape,0
2008,7,Rape,0
2008,7,Rape,0
2008,5,Rape,0
2008,12,Rape,0
2008,10,Rape,0
2008,1,Rape,1
2008,2,Rape,1
2008,3,Rape,0
2008,9,Rape,0
2008,11,Rape,0
2008,6,Rape,0
2008,7,Rape,0
2008,4,Rape,0
2008,10,Rape,0
2008,7,Rape,0
2008,7,Rape,0
2008,9,Rape,0
2008,1,Rape,0
2008,2,Rape,1
2008,8,Rape,0
2008,8,Rape,0
2008,8,Rape,0
2008,9,Rape,0
2008,11,Rape,0
2008,5,Rape,0
2008,12,Rape,0
2008,10,Rape,0
2008,3,Rape,0
2008,7,Rape,0
2008,9,Rape,0
2008,1,Rape,0
2008,10,Rape,0
2008,5,Rape,0
2008,11,Rape,0
2008,3,Rape,0
2008,6,Rape,0
2008,6,Rape,0
2008,10,Rape,0
2008,9,Rape,0
2008,7,Rape,0
2008,8,Rape,0
2008,2,Rape,0
2008,9,Rape,0
2008,3,Rape,0
2008,1,Rape,0
2008,9,Rape,0
2008,12,Rape,0
2008,6,Rape,0
2008,1,Rape,0
2008,12,Rape,0
2008,6,Rape,0
2008,7,Rape,0
2008,9,Rape,0
2008,8,Rape,0
2008,12,Rape,0
2008,11,Rape,0
2008,3,Rape,0
2008,12,Rape,0
2008,10,Rape,0
2008,7,Rape,0
2008,3,Rape,0
2008,12,Rape,0
2008,6,Rape,0
2008,12,Rape,0
2008,3,Rape,0
2008,4,Rape,0
2008,6,Rape,0
2008,2,Rape,1
2008,1,Rape,1
2008,5,Rape,0
2008,1,Rape,1
2008,5,Rape,0
2008,11,Rape,0
2008,2,Rape,1
2008,10,Rape,0
2008,5,Rape,0
2008,3,Rape,0
2008,11,Rape,0
2008,3,Rape,0
2008,5,Rape,0
2008,1,Rape,0
2008,10,Rape,0
2008,5,Rape,0
2008,8,Rape,0
2008,4,Rape,0
2008,12,Rape,0
2008,10,Rape,0
2008,4,Rape,0
2008,8,Rape,0
2008,11,Rape,0
2008,12,Rape,0
2008,9,Rape,0
2008,11,Rape,0
2008,2,Rape,0
2008,3,Rape,0
2008,1,Rape,1
2008,8,Rape,0
2008,12,Rape,0
2008,6,Rape,0
2008,2,Rape,1
2008,10,Rape,0
2008,11,Rape,0
2008,6,Rape,0
2008,1,Rape,1
2008,4,Rape,0
2008,3,Rape,0
2008,1,Rape,1
2008,6,Rape,0
2008,8,Rape,0
2008,10,Rape,0
2008,3,Rape,0
2008,2,Rape,1
2008,10,Rape,0
2008,12,Rape,0
2008,2,Rape,1
2008,9,Rape,0
2008,10,Rape,0
2008,5,Rape,0
2008,6,Rape,0
2008,3,Rape,0
2008,3,Rape,0
2008,7,Rape,0
2008,9,Rape,0
2008,6,Rape,0
2008,2,Rape,1
2008,2,Rape,0
2008,12,Rape,0
2008,4,Rape,0
2008,1,Rape,1
2008,2,Rape,0
2008,1,Rape,1
2008,8,Rape,0
2008,7,Rape,0
2008,4,Rape,0
2008,4,Rape,0
2008,8,Rape,0
2008,3,Rape,0
2008,10,Rape,0
2008,1,Rape,1
2008,8,Rape,0
2008,10,Rape,0
2008,3,Rape,0
2008,8,Rape,0
2008,1,Rape,1
2008,4,Rape,0
2008,5,Rape,0
2008,5,Rape,0
2008,1,Rape,0
2008,9,Rape,0
2008,6,Rape,0
2008,3,Rape,0
2008,11,Rape,0
2008,10,Rape,0
2008,2,Rape,2
2008,5,Rape,0
2008,9,Rape,0
2008,1,Rape,0
2008,12,Rape,0
2008,6,Rape,0
2008,5,Rape,0
2008,12,Rape,0
2008,12,Rape,0
2008,5,Rape,0
2008,3,Rape,0
2008,3,Rape,0
2008,2,Rape,1
2008,7,Rape,0
2008,1,Rape,1
2009,6,Rape,0
2009,1,Rape,0
2009,11,Rape,0
2009,6,Rape,0
2009,12,Rape,0
2009,9,Rape,0
2009,8,Rape,0
2009,5,Rape,0
2009,12,Rape,0
2009,7,Rape,0
2009,11,Rape,0
2009,12,Rape,0
2009,9,Rape,0
2009,7,Rape,0
2009,2,Rape,0
2009,8,Rape,0
2009,4,Rape,0
2009,9,Rape,0
2009,11,Rape,0
2009,7,Rape,0
2009,8,Rape,0
2009,3,Rape,0
2009,11,Rape,0
2009,9,Rape,0
2009,8,Rape,0
2009,1,Rape,0
2009,10,Rape,0
2009,4,Rape,0
2009,1,Rape,0
2009,10,Rape,0
2009,7,Rape,0
2009,11,Rape,0
2009,5,Rape,0
2009,3,Rape,0
2009,3,Rape,0
2009,12,Rape,0
2009,1,Rape,0
2009,2,Rape,0
2009,10,Rape,0
2009,7,Rape,0
2009,12,Rape,0
2009,3,Rape,0
2009,7,Rape,0
2009,8,Rape,0
2009,12,Rape,0
2009,3,Rape,0
2009,8,Rape,0
2009,2,Rape,0
2009,6,Rape,0
2009,12,Rape,0
2009,6,Rape,0
2009,4,Rape,0
2009,3,Rape,0
2009,1,Rape,0
2009,3,Rape,0
2009,1,Rape,0
2009,5,Rape,0
2009,2,Rape,0
2009,6,Rape,0
2009,5,Rape,0
2009,3,Rape,0
2009,1,Rape,0
2009,4,Rape,0
2009,11,Rape,0
2009,1,Rape,0
2009,6,Rape,0
2009,5,Rape,0
2009,6,Rape,0
2009,12,Rape,0
2009,1,Rape,0
2009,7,Rape,0
2009,11,Rape,0
2009,2,Rape,0
2009,2,Rape,0
2009,11,Rape,0
2009,11,Rape,0
2009,6,Rape,0
2009,3,Rape,0
2009,4,Rape,0
2009,1,Rape,0
2009,8,Rape,0
2009,4,Rape,0
2009,9,Rape,0
2009,2,Rape,0
2009,11,Rape,0
2009,1,Rape,0
2009,7,Rape,0
2009,12,Rape,0
2009,8,Rape,0
2009,4,Rape,0
2009,8,Rape,0
2009,5,Rape,0
2009,11,Rape,0
2009,3,Rape,0
2009,7,Rape,0
2009,12,Rape,0
2009,12,Rape,0
2009,10,Rape,0
2009,3,Rape,0
2009,5,Rape,0
2009,3,Rape,0
2009,2,Rape,0
2009,2,Rape,0
2009,1,Rape,0
2009,8,Rape,0
2009,2,Rape,0
2009,5,Rape,0
2009,2,Rape,0
2009,12,Rape,0
2009,8,Rape,0
2009,3,Rape,0
2009,8,Rape,0
2009,4,Rape,0
2009,9,Rape,0
2009,9,Rape,0
2009,5,Rape,0
2009,4,Rape,0
2009,2,Rape,0
2009,6,Rape,0
2009,9,Rape,0
2009,3,Rape,0
2009,9,Rape,0
2009,4,Rape,0
2009,1,Rape,0
2009,1,Rape,0
2009,12,Rape,0
2009,2,Rape,0
2009,9,Rape,0
2
Query:
SELECT "minor_category", SUM("value") AS "total_crimes"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   GROUP BY "minor_category"
   ORDER BY "total_crimes" DESC
   LIMIT 1000;
Answer:
minor_category,total_crimes
Other Theft,980085
Theft From Motor Vehicle,569956
Burglary in a Dwelling,491282
Harassment,458124
Assault with Injury,451001
Possession Of Drugs,431948
Common Assault,413690
Theft From Shops,345142
Other Theft Person,308842
Criminal Damage To Motor Vehicle,265463
Burglary in Other Buildings,263011
Personal Property,237578
Theft/Taking Of Motor Vehicle,216538
Theft/Taking of Pedal Cycle,168974
Criminal Damage To Dwelling,154116
Other Criminal Damage,145356
Wounding/GBH,125556
Other Notifiable,100819
Other violence,70778
Criminal Damage To Other Building,66003
Motor Vehicle Interference & Tampering,56224
Offensive Weapon,37983
Drug Trafficking,35819
Business Property,21295
Handling Stolen Goods,16100
Going Equipped,5530
Counted per Victim,3840
Other Drugs,2998
Other Fraud & Forgery,1485
Other Sexual,1005
Murder,949
Rape,268
Query:
SELECT "year", "minor_category", SUM("value") AS "total_crimes"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   WHERE "year" >= 2008
   GROUP BY "year", "minor_category"
   ORDER BY "year" ASC, "total_crimes" DESC
   LIMIT 1000;
Answer:
Too long, hard cut:
year,minor_category,total_crimes
2008,Other Theft,99280
2008,Theft From Motor Vehicle,76570
2008,Possession Of Drugs,64228
2008,Burglary in a Dwelling,56655
2008,Assault with Injury,56586
2008,Harassment,43389
2008,Criminal Damage To Motor Vehicle,41693
2008,Common Assault,37356
2008,Theft From Shops,32857
2008,Burglary in Other Buildings,31437
2008,Theft/Taking Of Motor Vehicle,28303
2008,Personal Property,26663
2008,Other Theft Person,24453
2008,Criminal Damage To Dwelling,23519
2008,Other Criminal Damage,17649
2008,Theft/Taking of Pedal Cycle,15895
2008,Other Notifiable,9491
2008,Criminal Damage To Other Building,9011
2008,Wounding/GBH,8701
2008,Other violence,7721
2008,Offensive Weapon,5961
2008,Drug Trafficking,4203
2008,Motor Vehicle Interference & Tampering,3868
2008,Counted per Victim,3840
2008,Business Property,2964
2008,Handling Stolen Goods,2466
2008,Other Fraud & Forgery,1485
2008,Other Sexual,1005
2008,Going Equipped,621
2008,Other Drugs,373
2008,Rape,268
2008,Murder,130
2009,Other Theft,95424
2009,Theft From Motor Vehicle,68856
2009,Burglary in a Dwelling,60185
2009,Possession Of Drugs,56070
2009,Assault with Injury,55297
2009,Harassment,43594
2009,Common Assault,39671
2009,Criminal Damage To Motor Vehicle,36621
2009,Theft From Shops,36349
2009,Burglary in Other Buildings,30434
2009,Other Theft Person,27549
2009,Personal Property,26453
2009,Theft/Taking Of Motor Vehicle,24476
2009,Criminal Damage To Dwelling,22475
2009,Theft/Taking of Pedal Cycle,20721
2009,Other Criminal Damage,18121
2009,Other Notifiable,10007
2009,Wounding/GBH,10005
2009,Criminal Damage To Other Building,8348
2009,Other violence,7571
2009,Offensive Weapon,4520
2009,Motor Vehicle Interference & Tampering,4210
2009,Drug Trafficking,4172
2009,Business Property,3115
2009,Handling Stolen Goods,1907
2009,Going Equipped,637
2009,Other Drugs,307
2009,Murder,119
2009,Other Sexual,0
2009,Rape,0
2009,Other Fraud & Forgery,0
2009,Counted per Victim,0
2010,Other Theft,103997
2010,Theft From Motor Vehicle,69709
2010,Burglary in a Dwelling,57123
2010,Assault with Injury,54173
2010,Possession Of Drugs,54026
2010,Harassment,42808
2010,Common Assault,41591
2010,Theft From Shops,36935
2010,Criminal Damage To Motor Vehicle,32907
2010,Burglary in Other Buildings,29703
2010,Other Theft Person,29547
2010,Personal Property,29300
2010,Theft/Taking Of Motor Vehicle,24890
2010,Criminal Damage To Dwelling,20253
2010,Theft/Taking of Pedal Cycle,19726
2010,Other Criminal Damage,16775
2010,Other Notifiable,10101
2010,Wounding/GBH,8033
2010,Criminal Damage To Other Building,7962
2010,Other violence,6947
2010,Motor Vehicle Interference & Tampering,4406
2010,Drug Trafficking,4252
2010,Offensive Weapon,4229
2010,Business Property,3041
2010,Handling Stolen Goods,1714
2010,Going Equipped,667
2010,Other Drugs,396
2010,Murder,113
2010,Other Fraud & Forgery,0
2010,Other Sexual,0
2010,Rape,0
2010,Counted per Victim,0
2011,Other Theft,113616
2011,Theft From Motor Vehicle,69604
2011,Burglary in a Dwelling,62439
2011,Possession Of Drugs,52769
2011,Assault with Injury,50768
2011,Common Assault,40502
2011,Harassment,37493
2011,Theft From Shops,36351
2011,Other Theft Person,36090
2011,Personal Property,33994
2011,Burglary in Other Buildings,30876
2011,Criminal Damage To Motor Vehicle,29494
2011,Theft/Taking Of Motor Vehicle,26161
2011,Theft/Taking of Pedal Cycle,20885
2011,Criminal Damage To Dwelling,18037
2011,Other Criminal Damage,15938
2011,Other Notifiable,9565
2011,Wounding/GBH,7628
2011,Criminal Damage To Other Building,7445
2011,Other violence,6414
2011,Motor Vehicle Interference & Tampering,4481
2011,Drug Trafficking,4460
2011,Offensive Weapon,3991
2011,Business Property,2685
2011,Handling Stolen Goods,2104
2011,Going Equipped,699
2011,Other Drugs,321
2011,Murder,105
2011,Rape,0
2011,Other Sexual,0
2011,Counted per Victim,0
2011,Other Fraud & Forgery,0
2012,Other Theft,132056
2012,Theft From Motor Vehicle,68198
2012,Burglary in a Dwelling,61716
2012,Assault with Injury,50369
2012,Possession Of Drugs,47491
2012,Other Theft Person,46585
2012,Harassment,43396
2012,Common Assault,39246
2012,Theft From Shops,36562
2012,Personal Property,32810
2012,Burglary in Other Buildings,31676
2012,Criminal Damage To Motor Vehicle,25777
2012,Theft/Taking Of Motor Vehicle,22464
2012,Theft/Taking of Pedal Cycle,21339
2012,Criminal Damage To Dwelling,15330
2012,Other Criminal Damage,14298
2012,Other Notifiable,10075
2012,Wounding/GBH,7151
2012,Criminal Damage To Other Building,6753
2012,Other violence,6623
2012,Motor Vehicle Interference & Tampering,5113
2012,Drug Trafficking,3964
2012,Offensive Weapon,3134
2012,Business Property,2450
2012,Handling Stolen Goods,1737
2012,Going Equipped,600
2012,Other Drugs,321
2012,Murder,95
2012,Other Sexual,0
2012,Rape,0
2012,Counted per Victim,0
2012,Other Fraud & Forgery,0
2013,Other Theft,115757
2013,Theft From Motor Vehicle,63509
2013,Burglary in a Dwelling,56537
2013,Possession Of Drugs,45755
2013,Other Theft Person,44964
2013,Harassment,4180
Query:
SELECT DISTINCT "borough"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   LIMIT 1000;
Answer:
borough
Barking and Dagenham
Bexley
Merton
Lambeth
Haringey
Ealing
Redbridge
Havering
Westminster
Brent
Camden
Islington
Waltham Forest
Hounslow
Barnet
Hillingdon
Croydon
Tower Hamlets
Sutton
Kensington and Chelsea
Newham
Wandsworth
Hammersmith and Fulham
Lewisham
Greenwich
Bromley
Southwark
Harrow
Hackney
Kingston upon Thames
Enfield
City of London
Richmond upon Thames
Query:
SELECT "borough", SUM("value") AS "total_crimes"
   FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
   WHERE "year" = 2008
   GROUP BY "borough"
   ORDER BY "total_crimes" DESC
   LIMIT 1000;
Answer:
borough,total_crimes
Westminster,47846
Southwark,33470
Camden,32010
Lambeth,31717
Newham,29752
Croydon,29516
Ealing,28947
Lewisham,27054
Islington,26273
Haringey,25724
Hillingdon,24318
Waltham Forest,24080
Bromley,24015
Barnet,23944
Tower Hamlets,23578
Brent,23504
Wandsworth,23330
Greenwich,22010
Hackney,22004
Enfield,21980
Hammersmith and Fulham,21114
Redbridge,20873
Kensington and Chelsea,20663
Hounslow,20204
Barking and Dagenham,17656
Havering,15395
Bexley,15305
Merton,13875
Harrow,13774
Sutton,12943
Richmond upon Thames,11106
Kingston upon Thames,10661
City of London,0
Query:
SELECT DISTINCT "lsoa_code", SUM("value") AS "total_crimes"
    FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
    GROUP BY "lsoa_code"
    LIMIT 1000;
Answer:
Too long, hard cut:
lsoa_code,total_crimes
E01003732,1115
E01002448,1655
E01002467,491
E01004542,764
E01003748,1026
E01002550,966
E01004558,714
E01004554,617
E01003645,2788
E01001967,587
E01002250,1041
E01002616,778
E01002439,1272
E01003989,2326
E01004516,848
E01003832,637
E01001932,3559
E01004452,1979
E01003994,2993
E01003914,1450
E01002463,441
E01004555,649
E01004723,1370
E01003004,685
E01002902,2608
E01000521,3337
E01000312,879
E01003414,813
E01004230,1904
E01004322,3248
E01004363,2177
E01002741,1034
E01003866,434
E01000952,1019
E01000388,447
E01000330,1074
E01000884,711
E01000506,2150
E01032744,1397
E01001288,857
E01002238,672
E01003621,705
E01000774,830
E01000507,858
E01000652,605
E01002199,503
E01003534,1305
E01001134,505
E01004195,876
E01002642,3848
E01001704,938
E01004355,931
E01003734,1573
E01000708,652
E01003013,8176
E01002278,966
E01002998,483
E01001116,1681
E01003022,1090
E01033133,315
E01004668,574
E01004468,1408
E01001026,442
E01002489,1279
E01003243,1950
E01003784,713
E01001217,706
E01000374,865
E01003616,2106
E01003254,699
E01002820,2786
E01003910,394
E01000018,907
E01001279,527
E01000392,1816
E01000292,917
E01000130,787
E01000519,903
E01033586,694
E01000797,1628
E01000282,614
E01001531,393
E01003110,1215
E01001559,5021
E01001012,1652
E01001127,552
E01001135,914
E01001534,1130
E01001457,702
E01003429,744
E01002070,1486
E01002599,842
E01002348,466
E01001105,488
E01001835,630
E01003127,1753
E01003767,2158
E01004545,1768
E01001671,1013
E01002441,1007
E01000090,1189
E01001752,1604
E01003034,1086
E01003950,974
E01004534,1687
E01001851,1006
E01004047,804
E01000962,681
E01002147,412
E01000697,543
E01002181,700
E01001569,933
E01001035,746
E01003331,927
E01000965,888
E01000224,523
E01000617,998
E01000379,475
E01003113,1362
E01002673,804
E01003311,704
E01001995,1098
E01004508,1546
E01002787,1097
E01003913,3448
E01002406,2837
E01004633,640
E01002245,936
E01002078,1210
E01032764,1452
E01001935,1122
E01004674,1570
E01004427,1190
E01002973,776
E01002939,833
E01001951,1313
E01004350,1320
E01002422,1055
E01003756,1100
E01002287,481
E01003831,562
E01000532,1278
E01000944,635
E01000764,403
E01001807,857
E01003562,1303
E01002347,578
E01002281,1657
E01003268,961
E01004517,1297
E01001672,959
E01002996,463
E01002891,601
E01033728,386
E01004292,720
E01003468,428
E01002903,1749
E01000336,1455
E01001346,551
E01001359,2017
E01004087,472
E01003400,944
E01001603,1044
E01002555,1187
E01002034,4214
E01003222,628
E01003542,1309
E01001395,887
E01004044,929
E01004362,1300
E01000185,656
E01001333,2400
E01003404,419
E01000746,1423
E01003051,2428
E01001176,1364
E01001843,810
E01003282,1678
E01001683,992
E01003968,920
E01003997,1288
E01002494,547
E01001875,1627
E01000342,406
E01002221,1075
E01002060,738
E01000589,1520
E01002120,684
E01003424,518
E01000672,951
E01000187,520
E01000654,376
E01000655,402
E01003471,1244
E01000989,460
E01003119,1591
E01002026,9677
E01003271,623
E01001565,491
E01001809,755
E01002277,1182
E01004617,3584
E01003975,1151
E01033093,762
E01004574,1279
E01001640,3339
E01003760,1190
E01000103,1056
E01002938,547
E01004309,5350
E01000029,861
E01002884,3972
E01002802,1394
E01003737,1037
E01004716,1393
E01004426,789
E01000308,1272
E01000471,502
E01001204,572
E01000717,539
E01000829,445
E01000649,594
E01004020,873
E01001580,1839
E01004450,665
E01003166,2272
E01004515,839
E01001750,1811
E01003797,587
E01000530,888
E01003162,1041
E01003200,2088
E01002462,345
E01003304,3664
E01001928,1691
E01000600,4806
E01000510,2940
E01000473,1807
E01002186,945
E01003138,864
E01003446,1280
E01002089,757
E01002360,648
E01001071,614
E01001735,1570
E01002661,2215
E01004709,1574
E01004656,1732
E01001772,878
E01000068,1050
E01004422,3028
E01001911,1265
E01002183,841
E01004160,424
E01004199,1022
E01002928,783
E01004579,1228
E01001519,3536
E01001888,852
E01003140,439
E01004627,860
E01003526,1145
E01001174,855
E01004256,1327
E01003214,1851
E01001483,985
E01002608,1869
E01000031,1221
E01003747,286
E01004119,1257
E01001832,1375
E01003715,965
E01002498,1008
E01001867,663
E01000713,554
E01003157,919
E01004099,1234
E01001393,931
E01002083,775
E01001727,531
E01002303,835
E01002770,4680
E01003752,1075
E01002532,1375
E01004024,1639
E01003958,965
E01004589,829
E01002533,519
E01002310,1596
E01000041,750
E01003983,1337
E01003954,594
E01002659,492
E01001708,653
E01004469,907
E01000049,1595
E01003829,1706
E01033604,1590
E01004298,1403
E01002767,1297
E01004019,1164
E01001864,1043
E01004698,2371
E01004244,2285
E01004346,984
E01004458,1336
E01032739,376
E01000423,273
E01000894,1021
E01000926,1072
E01003440,986
E01001328,1687
E01003319,1402
E01002743,971
E01002729,1641
E01003706,711
E01000110,705
E01001921,1571
E01000294,1198
E01000909,967
E01000272,462
E01001385,724
E01000802,893
E01000754,574
E01001550,777
E01001444,609
E01003069,911
E01003579,802
E01001114,1461
E01001045,6455
E01004090,913
E01003211,1538
E01003290,1683
E01000324,751
E01002253,385
E01000023,1862
E01001400,612
E01003309,1216
E01003082,1047
E01000284,800
E01000377,460
E01001336,1000
E01004339,818
E01004357,80
Query:
SELECT "major_category", SUM("value") AS "total_crimes"
    FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
    WHERE "year" = 2008
    GROUP BY "major_category"
    ORDER BY "total_crimes" DESC
    LIMIT 1000;
Answer:
major_category,total_crimes
Theft and Handling,283692
Violence Against the Person,159844
Criminal Damage,91872
Burglary,88092
Drugs,68804
Robbery,29627
Other Notifiable Offences,10112
Fraud or Forgery,5325
Sexual Offences,1273
Query:
SELECT "minor_category", SUM("value") AS "total_crimes"
    FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
    WHERE "year" = 2008
    GROUP BY "minor_category"
    ORDER BY "total_crimes" DESC
    LIMIT 5;
Answer:
minor_category,total_crimes
Other Theft,99280
Theft From Motor Vehicle,76570
Possession Of Drugs,64228
Burglary in a Dwelling,56655
Assault with Injury,56586
Query:
SELECT "month", SUM("value") AS "total_crimes"
    FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
    WHERE "year" = 2008 AND "minor_category" = (SELECT "minor_category" FROM
        (SELECT "minor_category", SUM("value") AS "total_crimes"
         FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
         WHERE "year" = 2008
         GROUP BY "minor_category"
         ORDER BY "total_crimes" DESC
         LIMIT 1))
    GROUP BY "month"
    ORDER BY "month" ASC
    LIMIT 1000;
Answer:
month,total_crimes
1,8262
2,8063
3,8460
4,8368
5,8468
6,8581
7,8940
8,7877
9,7751
10,8515
11,8480
12,7515
Query:
SELECT "month", SUM("value") AS "total_crimes"
FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
WHERE "year" = 2008 AND "minor_category" = 'Other Theft'
GROUP BY "month"
ORDER BY "month" ASC
LIMIT 1000;
Answer:
month,total_crimes
1,8262
2,8063
3,8460
4,8368
5,8468
6,8581
7,8940
8,7877
9,7751
10,8515
11,8480
12,7515
Query:
SELECT SUM("value") AS "total_crimes"
FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
WHERE "year" >= 2008
Answer:
total_crimes
6447758
Query:
SELECT "lsoa_code", SUM("value") AS "total_crimes"
FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
GROUP BY "lsoa_code"
LIMIT 1000
Answer:
Too long, hard cut:
lsoa_code,total_crimes
E01002846,1417
E01002748,1942
E01002699,1016
E01004602,943
E01001929,837
E01002799,1626
E01002803,4498
E01004605,940
E01004521,956
E01001896,1186
E01002845,772
E01002398,856
E01033593,898
E01004242,2469
E01002407,2792
E01002491,1117
E01001981,1072
E01033000,620
E01001676,1150
E01001664,2241
E01004432,1301
E01004438,4193
E01033594,3723
E01003875,700
E01004218,888
E01000901,1222
E01000340,450
E01000556,2262
E01003383,3409
E01001178,2676
E01004394,1405
E01004003,1704
E01001917,871
E01002816,1258
E01000642,3164
E01000249,490
E01000172,547
E01000535,1513
E01001232,542
E01000434,882
E01000907,782
E01002224,641
E01000782,1552
E01000367,872
E01002171,555
E01003469,1344
E01000674,733
E01003573,1029
E01003511,946
E01001009,913
E01001189,528
E01001040,1001
E01002000,973
E01033711,1005
E01003056,960
E01002264,752
E01002648,2643
E01000270,496
E01000951,623
E01002323,443
E01001459,671
E01002353,4153
E01002934,412
E01002809,1045
E01004068,1634
E01002566,2618
E01002588,1179
E01004750,6770
E01004659,1378
E01004338,800
E01002927,540
E01002995,322
E01000010,9389
E01033100,706
E01004430,5749
E01002837,519
E01032743,506
E01000244,990
E01003397,620
E01001497,694
E01003484,798
E01004391,1564
E01001913,1031
E01002793,2147
E01003857,676
E01000314,1942
E01000551,1383
E01000570,881
E01001335,1015
E01000955,1021
E01002157,1056
E01000958,2437
E01002198,486
E01004180,540
E01000769,1826
E01001079,906
E01001185,970
E01001456,353
E01001179,752
E01001412,1821
E01001083,567
E01001480,762
E01003398,923
E01003546,1150
E01002330,657
E01002032,1232
E01003326,878
E01001024,463
E01003241,1379
E01002512,1138
E01004526,1418
E01002339,504
E01003935,2097
E01003310,1105
E01033600,445
E01032790,313
E01032741,4096
E01003697,1424
E01000250,2659
E01000618,648
E01004181,603
E01003459,1105
E01001113,1554
E01003349,754
E01000994,796
E01003017,2995
E01002653,693
E01001308,771
E01003457,447
E01000744,1151
E01000816,521
E01000768,464
E01001566,591
E01003048,1631
E01001414,621
E01003111,731
E01002064,831
E01004034,1320
E01002282,2481
E01002380,922
E01004712,3238
E01004365,2096
E01004384,1461
E01001922,1534
E01000009,2405
E01004334,1009
E01004456,1821
E01004234,4374
E01000106,1992
E01000192,1872
E01000117,823
E01002153,343
E01004193,722
E01000784,565
E01003350,1003
E01000088,1260
E01004257,1254
E01002268,632
E01002434,527
E01000594,1611
E01000464,727
E01000262,753
E01001661,1346
E01002085,2192
E01003690,2900
E01002042,1451
E01002827,3190
E01002368,1757
E01000079,888
E01002807,1210
E01000511,929
E01001703,1269
E01004200,1156
E01004364,1647
E01001237,849
E01000368,702
E01000338,946
E01000616,927
E01004137,1715
E01003538,1384
E01033581,1104
E01003607,1365
E01000745,1378
E01003026,1784
E01001434,676
E01002284,1058
E01003301,1428
E01033745,541
E01004522,816
E01001657,810
E01003240,1414
E01002953,594
E01000095,4427
E01004336,1343
E01003688,1153
E01001765,1047
E01001016,727
E01002647,1001
E01004618,665
E01004360,449
E01000643,2606
E01000263,420
E01000387,348
E01000235,999
E01001381,2181
E01000801,960
E01001136,2517
E01001100,437
E01001111,1751
E01001028,590
E01001467,631
E01003039,3065
E01001782,1114
E01003046,1206
E01003727,831
E01004612,1233
E01003774,707
E01004067,7428
E01001182,881
E01004375,1116
E01004347,1289
E01002444,20578
E01001986,798
E01004386,593
E01003694,486
E01001944,1121
E01001389,2781
E01000625,866
E01000290,780
E01000174,1051
E01003381,474
E01003564,1221
E01003493,2350
E01003560,622
E01001813,1709
E01002589,2500
E01003062,1912
E01001719,620
E01004261,2215
E01001891,1846
E01002093,1700
E01000818,513
E01002534,415
E01003876,7624
E01003813,488
E01000074,842
E01000226,799
E01001338,1881
E01002351,636
E01001556,721
E01003020,2768
E01004030,1087
E01004701,660
E01003973,2280
E01000787,867
E01004569,1835
E01000844,750
E01000634,1334
E01001201,750
E01001224,582
E01000859,1482
E01003314,833
E01001845,1280
E01002319,2256
E01002789,1073
E01004022,2251
E01004016,1426
E01004462,1286
E01000102,876
E01003835,572
E01000059,887
E01001795,1359
E01001644,1787
E01004010,3507
E01032562,579
E01004214,746
E01002667,1289
E01003472,356
E01001034,760
E01003701,1743
E01033729,770
E01002564,1341
E01003805,514
E01003669,1113
E01000897,789
E01002372,499
E01003981,3853
E01032639,1829
E01004324,918
E01001553,884
E01000064,1325
E01003810,515
E01000207,870
E01003371,595
E01003195,707
E01002547,1086
E01000485,533
E01001119,255
E01003156,753
E01000052,1451
E01004610,759
E01001560,917
E01001124,304
E01002373,698
E01002881,833
E01002892,998
E01003792,815
E01003761,842
E01003934,4231
E01003768,1242
E01002735,2381
E01003757,1069
E01002539,443
E01002485,1312
E01002549,1045
E01004645,982
E01002341,388
E01002854,1707
E01004623,664
E01002794,10529
E01004290,1782
E01004467,1854
E01000086,863
E01001870,1091
E01004447,831
E01002782,1037
E01002520,1538
E01003845,611
E01001886,1210
E01002868,721
E01001880,1553
E01000893,796
E01000604,1086
E01001229,718
E01000919,10973
E01001287,659
E01002208,254
E01003637,767
E01003599,1082
E01001758,1541
E01003245,1015
E01002670,847
E01001712,15
End Exploring Related Columns
Task: Could you provide the annual percentage shares, rounded to two decimal places, of the top 5 minor crime categories from 2008 in London's total crimes, with each year displayed in one row?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: Sure, here's the format for the requested information:

```csv
Year,Minor_Category_1_Percentage,Minor_Category_2_Percentage,Minor_Category_3_Percentage,Minor_Category_4_Percentage,Minor_Category_5_Percentage
year1:int,percentage1:float [0,100],percentage2:float [0,100],percentage3:float [0,100],percentage4:float [0,100],percentage5:float [0,100]
year2:int,percentage1:float [0,100],percentage2:float [0,100],percentage3:float [0,100],percentage4:float [0,100],percentage5:float [0,100]
...
```

**Explanation:**

- **Year**: The year of the recorded crime data (integer).
- **Minor_Category_1_Percentage** to **Minor_Category_5_Percentage**: The annual percentage shares, rounded to two decimal places, of each of the top 5 minor crime categories identified from 2008, in London's total crimes for that year. The percentages are numeric values between 0 and 100.

Each row represents a year, displaying the percentage shares for each of the top 5 minor crime categories in that specific year..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'LONDON': {'LONDON_CRIME': ['CRIME_BY_LSOA'], 'LONDON_FIRE_BRIGADE': ['FIRE_BRIGADE_SERVICE_CALLS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-20 06:43:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:43:05 - root - INFO - Sure, here's the SQL query to provide the annual percentage shares, rounded to two decimal places, of the top 5 minor crime categories from 2008 in London's total crimes, with each year displayed in one row:

```sql
WITH top5_categories AS (
    SELECT "minor_category",
        ROW_NUMBER() OVER (ORDER BY SUM("value") DESC) AS category_rank
    FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
    WHERE "year" = 2008
    GROUP BY "minor_category"
    ORDER BY SUM("value") DESC
    LIMIT 5
),
crime_data AS (
    SELECT t."year", t."minor_category", t."value"
    FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA t
    WHERE t."year" >= 2008
    AND t."minor_category" IN (SELECT "minor_category" FROM top5_categories)
),
total_crimes_per_year AS (
    SELECT "year", SUM("value") AS "total_crimes"
    FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
    WHERE "year" >= 2008
    GROUP BY "year"
),
crimes_per_category AS (
    SELECT cd."year", tc.category_rank, SUM(cd."value") AS "category_crimes"
    FROM crime_data cd
    INNER JOIN top5_categories tc ON cd."minor_category" = tc."minor_category"
    GROUP BY cd."year", tc.category_rank
),
pivoted_data AS (
    SELECT
        "year",
        SUM(CASE WHEN category_rank = 1 THEN "category_crimes" ELSE 0 END) AS "Minor_Category_1_Crimes",
        SUM(CASE WHEN category_rank = 2 THEN "category_crimes" ELSE 0 END) AS "Minor_Category_2_Crimes",
        SUM(CASE WHEN category_rank = 3 THEN "category_crimes" ELSE 0 END) AS "Minor_Category_3_Crimes",
        SUM(CASE WHEN category_rank = 4 THEN "category_crimes" ELSE 0 END) AS "Minor_Category_4_Crimes",
        SUM(CASE WHEN category_rank = 5 THEN "category_crimes" ELSE 0 END) AS "Minor_Category_5_Crimes"
    FROM crimes_per_category
    GROUP BY "year"
)
SELECT
    tc."year",
    ROUND((pd."Minor_Category_1_Crimes" / tc."total_crimes") * 100, 2) AS "Minor_Category_1_Percentage",
    ROUND((pd."Minor_Category_2_Crimes" / tc."total_crimes") * 100, 2) AS "Minor_Category_2_Percentage",
    ROUND((pd."Minor_Category_3_Crimes" / tc."total_crimes") * 100, 2) AS "Minor_Category_3_Percentage",
    ROUND((pd."Minor_Category_4_Crimes" / tc."total_crimes") * 100, 2) AS "Minor_Category_4_Percentage",
    ROUND((pd."Minor_Category_5_Crimes" / tc."total_crimes") * 100, 2) AS "Minor_Category_5_Percentage"
FROM total_crimes_per_year tc
LEFT JOIN pivoted_data pd ON tc."year" = pd."year"
ORDER BY tc."year" ASC;
```
2025-01-20 06:43:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:43:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:43:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:43:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 9
2025-01-20 06:43:06 - snowflake.connector.connection - INFO - closed
2025-01-20 06:43:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:43:07 - root - INFO - itercount: 1
2025-01-20 06:43:07 - root - INFO - 0
2025-01-20 06:43:07 - root - INFO - results: 
year,Minor_Category_1_Percentage,Minor_Category_2_Percentage,Minor_Category_3_Percentage,Minor_Category_4_Percentage,Minor_Category_5_Percentage
2008,13.44,10.37,8.70,7.67,7.66
2009,13.30,9.60,7.82,8.39,7.71
2010,14.54,9.75,7.55,7.99,7.57
2011,15.67,9.60,7.28,8.61,7.00
2012,17.91,9.25,6.44,8.37,6.83
2013,16.86,9.25,6.67,8.24,5.82
2014,15.96,7.67,5.93,7.20,6.72
2015,15.12,7.03,5.07,6.28,6.77
2016,14.10,6.97,4.78,5.84,6.80


2025-01-20 06:43:07 - root - INFO - Please check the answer again by reviewing Could you provide the annual percentage shares, rounded to two decimal places, of the top 5 minor crime categories from 2008 in London's total crimes, with each year displayed in one row?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: Sure, here's the format for the requested information:

```csv
Year,Minor_Category_1_Percentage,Minor_Category_2_Percentage,Minor_Category_3_Percentage,Minor_Category_4_Percentage,Minor_Category_5_Percentage
year1:int,percentage1:float [0,100],percentage2:float [0,100],percentage3:float [0,100],percentage4:float [0,100],percentage5:float [0,100]
year2:int,percentage1:float [0,100],percentage2:float [0,100],percentage3:float [0,100],percentage4:float [0,100],percentage5:float [0,100]
...
```

**Explanation:**

- **Year**: The year of the recorded crime data (integer).
- **Minor_Category_1_Percentage** to **Minor_Category_5_Percentage**: The annual percentage shares, rounded to two decimal places, of each of the top 5 minor crime categories identified from 2008, in London's total crimes for that year. The percentages are numeric values between 0 and 100.

Each row represents a year, displaying the percentage shares for each of the top 5 minor crime categories in that specific year. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
year,Minor_Category_1_Percentage,Minor_Category_2_Percentage,Minor_Category_3_Percentage,Minor_Category_4_Percentage,Minor_Category_5_Percentage
2008,13.44,10.37,8.70,7.67,7.66
2009,13.30,9.60,7.82,8.39,7.71
2010,14.54,9.75,7.55,7.99,7.57
2011,15.67,9.60,7.28,8.61,7.00
2012,17.91,9.25,6.44,8.37,6.83
2013,16.86,9.25,6.67,8.24,5.82
2014,15.96,7.67,5.93,7.20,6.72
2015,15.12,7.03,5.07,6.28,6.77
2016,14.10,6.97,4.78,5.84,6.80
Current sql:
WITH top5_categories AS (
    SELECT "minor_category",
        ROW_NUMBER() OVER (ORDER BY SUM("value") DESC) AS category_rank
    FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
    WHERE "year" = 2008
    GROUP BY "minor_category"
    ORDER BY SUM("value") DESC
    LIMIT 5
),
crime_data AS (
    SELECT t."year", t."minor_category", t."value"
    FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA t
    WHERE t."year" >= 2008
    AND t."minor_category" IN (SELECT "minor_category" FROM top5_categories)
),
total_crimes_per_year AS (
    SELECT "year", SUM("value") AS "total_crimes"
    FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
    WHERE "year" >= 2008
    GROUP BY "year"
),
crimes_per_category AS (
    SELECT cd."year", tc.category_rank, SUM(cd."value") AS "category_crimes"
    FROM crime_data cd
    INNER JOIN top5_categories tc ON cd."minor_category" = tc."minor_category"
    GROUP BY cd."year", tc.category_rank
),
pivoted_data AS (
    SELECT
        "year",
        SUM(CASE WHEN category_rank = 1 THEN "category_crimes" ELSE 0 END) AS "Minor_Category_1_Crimes",
        SUM(CASE WHEN category_rank = 2 THEN "category_crimes" ELSE 0 END) AS "Minor_Category_2_Crimes",
        SUM(CASE WHEN category_rank = 3 THEN "category_crimes" ELSE 0 END) AS "Minor_Category_3_Crimes",
        SUM(CASE WHEN category_rank = 4 THEN "category_crimes" ELSE 0 END) AS "Minor_Category_4_Crimes",
        SUM(CASE WHEN category_rank = 5 THEN "category_crimes" ELSE 0 END) AS "Minor_Category_5_Crimes"
    FROM crimes_per_category
    GROUP BY "year"
)
SELECT
    tc."year",
    ROUND((pd."Minor_Category_1_Crimes" / tc."total_crimes") * 100, 2) AS "Minor_Category_1_Percentage",
    ROUND((pd."Minor_Category_2_Crimes" / tc."total_crimes") * 100, 2) AS "Minor_Category_2_Percentage",
    ROUND((pd."Minor_Category_3_Crimes" / tc."total_crimes") * 100, 2) AS "Minor_Category_3_Percentage",
    ROUND((pd."Minor_Category_4_Crimes" / tc."total_crimes") * 100, 2) AS "Minor_Category_4_Percentage",
    ROUND((pd."Minor_Category_5_Crimes" / tc."total_crimes") * 100, 2) AS "Minor_Category_5_Percentage"
FROM total_crimes_per_year tc
LEFT JOIN pivoted_data pd ON tc."year" = pd."year"
ORDER BY tc."year" ASC;When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-20 06:43:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-20 06:43:40 - root - INFO - ```sql
WITH top5_categories AS (
    SELECT "minor_category",
        ROW_NUMBER() OVER (ORDER BY SUM("value") DESC NULLS LAST) AS category_rank
    FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
    WHERE "year" = 2008
    GROUP BY "minor_category"
    ORDER BY SUM("value") DESC NULLS LAST
    LIMIT 5
),
crime_data AS (
    SELECT t."year", t."minor_category", t."value"
    FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA t
    WHERE t."year" >= 2008
    AND t."minor_category" IN (SELECT "minor_category" FROM top5_categories)
),
total_crimes_per_year AS (
    SELECT "year", SUM("value") AS "total_crimes"
    FROM LONDON.LONDON_CRIME.CRIME_BY_LSOA
    WHERE "year" >= 2008
    GROUP BY "year"
),
crimes_per_category AS (
    SELECT cd."year", tc.category_rank, SUM(cd."value") AS "category_crimes"
    FROM crime_data cd
    INNER JOIN top5_categories tc ON cd."minor_category" = tc."minor_category"
    GROUP BY cd."year", tc.category_rank
),
pivoted_data AS (
    SELECT
        "year",
        SUM(CASE WHEN category_rank = 1 THEN "category_crimes" ELSE 0 END) AS "Minor_Category_1_Crimes",
        SUM(CASE WHEN category_rank = 2 THEN "category_crimes" ELSE 0 END) AS "Minor_Category_2_Crimes",
        SUM(CASE WHEN category_rank = 3 THEN "category_crimes" ELSE 0 END) AS "Minor_Category_3_Crimes",
        SUM(CASE WHEN category_rank = 4 THEN "category_crimes" ELSE 0 END) AS "Minor_Category_4_Crimes",
        SUM(CASE WHEN category_rank = 5 THEN "category_crimes" ELSE 0 END) AS "Minor_Category_5_Crimes"
    FROM crimes_per_category
    GROUP BY "year"
)
SELECT
    tc."year",
    ROUND((pd."Minor_Category_1_Crimes" / tc."total_crimes") * 100, 4) AS "Minor_Category_1_Percentage",
    ROUND((pd."Minor_Category_2_Crimes" / tc."total_crimes") * 100, 4) AS "Minor_Category_2_Percentage",
    ROUND((pd."Minor_Category_3_Crimes" / tc."total_crimes") * 100, 4) AS "Minor_Category_3_Percentage",
    ROUND((pd."Minor_Category_4_Crimes" / tc."total_crimes") * 100, 4) AS "Minor_Category_4_Percentage",
    ROUND((pd."Minor_Category_5_Crimes" / tc."total_crimes") * 100, 4) AS "Minor_Category_5_Percentage"
FROM total_crimes_per_year tc
LEFT JOIN pivoted_data pd ON tc."year" = pd."year"
ORDER BY tc."year" ASC;
```
2025-01-20 06:43:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-20 06:43:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-20 06:43:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-20 06:43:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 9
2025-01-20 06:43:41 - snowflake.connector.connection - INFO - closed
2025-01-20 06:43:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-20 06:43:42 - root - INFO - itercount: 2
2025-01-20 06:43:42 - root - INFO - 0
2025-01-20 06:43:42 - root - INFO - Total iteration counts: 2
