2025-01-16 16:18:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 16:19:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 16:19:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 16:19:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 16:19:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 16:19:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 61
2025-01-16 16:19:07 - snowflake.connector.connection - INFO - closed
2025-01-16 16:19:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 16:19:07 - root - INFO - SQL:
SELECT DISTINCT "nppes_provider_state"
   FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
   LIMIT 1000;
Results:
nppes_provider_state
NH
VA
AK
IN
MP
AA
MA
NV
NJ
WI
AR
TX
AE
CT
UT
AS
KS
MO
NY
RI
WY
LA
KY
AP
NM
MN
VT
XX
GU
CO
NE
NC
PR
IL
OH
MT
MD
WA
DE
SC
OR
PA
OK
WV
SD
ID
IA
DC
AL
CA
FL
GA
AZ
ND
ZZ
HI
ME
MS
VI
MI
TN

2025-01-16 16:19:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 16:19:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 16:19:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 16:19:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 61
2025-01-16 16:19:09 - snowflake.connector.connection - INFO - closed
2025-01-16 16:19:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 16:19:09 - root - INFO - SQL:
SELECT "nppes_provider_state", SUM("total_claim_count") AS total_claims
   FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
   GROUP BY "nppes_provider_state"
   ORDER BY total_claims DESC
   LIMIT 1000;
Results:
nppes_provider_state,TOTAL_CLAIMS
CA,116440694
FL,91441123
NY,79570924
TX,75682169
PA,62946334
OH,53494076
NC,46020420
IL,42527191
MI,39461213
GA,39066489
TN,35472398
MO,31071230
NJ,29242463
IN,27822613
KY,26196384
AL,26162156
MA,26156247
VA,25549776
PR,24988874
LA,22456360
SC,21795317
WI,21461606
AZ,19873807
WA,19108957
MN,17312127
MS,15737130
AR,15647866
OK,14918485
IA,14673562
OR,13889191
MD,13798859
CT,12892970
CO,12823030
KS,12042320
WV,11216491
NE,7991763
NV,7457176
UT,5796245
NM,5770207
ME,5699119
RI,5535266
ID,4852448
NH,4095519
HI,3777714
SD,3525885
MT,3315266
ND,3061665
DE,3042265
VT,2115996
DC,1487724
WY,1380174
AK,1074367
VI,197072
GU,76979
ZZ,33284
AE,7617
MP,7104
XX,1909
AP,1839
AA,999
AS,218

2025-01-16 16:19:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 16:19:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 16:19:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 16:19:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 16:19:10 - snowflake.connector.connection - INFO - closed
2025-01-16 16:19:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 16:19:11 - root - INFO - SQL:
SELECT DISTINCT "drug_name"
   FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
   WHERE "nppes_provider_state" = 'NY'
   LIMIT 1000;
Results:
Too long, hard cut:
drug_name
METAXALONE
LYRICA
NYSTATIN
METHOCARBAMOL
ATRIPLA
ULTICARE
TRIBENZOR
PROTRIPTYLINE HCL
ERYPED 200
OPSUMIT
1ST TIER UNIFINE PENTIPS
OPIUM TINCTURE
CAYSTON
ALVESCO
ACITRETIN
HALDOL DECANOATE 100
HYDROCORTISONE-ACETIC ACID
TIKOSYN
GLUCOPHAGE
PRANDIMET
K-TAB ER
CORTISONE ACETATE
INTERMEZZO
KENALOG-40
LACTATED RINGERS
GAMMAKED
FIRAZYR
TENIVAC
VECTIBIX
HALFLYTELY-BISACODYL
TRAMADOL HCL-ACETAMINOPHEN
CILOSTAZOL
DILANTIN
ZETIA
FLUNISOLIDE
HALOBETASOL PROPIONATE
LANTUS
TRAVOPROST
TOPROL XL
DOXEPIN HCL
GATIFLOXACIN
LANTUS SOLOSTAR
GALANTAMINE HBR
EVOXAC
AMPICILLIN TRIHYDRATE
ECONAZOLE NITRATE
POLYMYXIN B SUL-TRIMETHOPRIM
OSMOPREP
GEMFIBROZIL
PERPHENAZINE
ORPHENADRINE CITRATE
DUREZOL
OXANDROLONE
PEN NEEDLES
ADCIRCA
SYMLINPEN 120
TYGACIL
FYCOMPA
E.E.S. 200
VINORELBINE TARTRATE
TREXALL
TRI-PREVIFEM
ACETIC ACID-ALUMINUM
TEKAMLO
LEVOXYL
NITROLINGUAL
LUXIQ
PREDNICARBATE
ORSYTHIA
ADAPALENE
ALDACTAZIDE
TRUEPLUS INSULIN SYRINGE
BCG VACCINE (TICE STRAIN)
ZELAPAR
FENOGLIDE
CORTISPORIN
OMEPRAZOLE
BETAMETHASONE VALERATE
HYDROCORTISONE VALERATE
MYRBETRIQ
AMIODARONE HCL
ESTRADIOL-NORETHINDRONE ACETAT
PROTONIX
PAXIL CR
WELLBUTRIN SR
CARBIDOPA-LEVODOPA ER
MEGACE ES
BANZEL
LUPRON DEPOT
TEKTURNA HCT
ZYTIGA
RISPERDAL M-TAB
FOCALIN XR
ALTABAX
XYLOCAINE-MPF
PRENATE MINI
NUTROPIN AQ
PREVIDENT 5000 ENAMEL PROTECT
RETROVIR
RANITIDINE HCL
ABILIFY
COMBIVENT RESPIMAT
RANEXA
AMLODIPINE BESYLATE-BENAZEPRIL
TEKTURNA
DILTIAZEM HCL
CYCLOSPORINE MODIFIED
BUTALB-CAFF-ACETAMINOPH-CODEIN
ATROPINE SULFATE
MIACALCIN
LAMICTAL
EASY TOUCH
DIDANOSINE
PACLITAXEL
QUINIDINE GLUCONATE
BROMOCRIPTINE MESYLATE
APIDRA SOLOSTAR
ZEGERID
GILENYA
ZOSYN
PHENYTEK
PRINIVIL
PULMICORT
RELISTOR
NIACOR
AMLODIPINE-VALSARTAN
ARAVA
DIAMOX SEQUELS
STAXYN
EURAX
ARICEPT ODT
CYSTADANE
LORTAB
CARNITOR
AMBISOME
LESCOL
CARIMUNE NF NANOFILTERED
VARIVAX VACCINE
BETAPACE
IMURAN
JANTOVEN
TRAVATAN Z
TOVIAZ
TRADJENTA
ENABLEX
EXEMESTANE
ISOSORBIDE MONONITRATE
AMILORIDE HCL
DIPYRIDAMOLE
ONDANSETRON HCL
ADEFOVIR DIPIVOXIL
HUMULIN N KWIKPEN
GAVILYTE-G
BETIMOL
RIBAPAK
LO LOESTRIN FE
ERYPED 400
NARATRIPTAN HCL
LARIN FE
SINEMET CR
PREVIFEM
MAXALT MLT
FASLODEX
GENTAK
VANDAZOLE
SUBSYS
AMOXICILLIN-CLAVULANATE ER
MACRODANTIN
RAZADYNE ER
TETANUS DIPHTHERIA TOXOIDS
LEVAQUIN
TYVASO
INFANRIX DTAP
ZOLPIDEM TARTRATE
METOPROLOL TARTRATE
PRAVASTATIN SODIUM
IBANDRONATE SODIUM
HYDROCORTISONE
TOBRADEX
QVAR
DICLOFENAC SODIUM
DAPSONE
LORAZEPAM INTENSOL
VANOS
CYTRA-K
UNITHROID
ZANTAC
ESTROPIPATE
KENALOG
IMIQUIMOD
ATIVAN
FELBATOL
RILUZOLE
TIAZAC
ILEVRO
PHENYTOIN SODIUM
TACLONEX
GLUCOTROL XL
ANAFRANIL
HUMATROPE
BENLYSTA
AVANDARYL
PARNATE
TEVETEN
ZIRGAN
TWINRIX
CURITY AMD
ZMAX
TIGAN
RAMIPRIL
IBUPROFEN
FAMOTIDINE
NIFEDIPINE ER
SYNTHROID
LACTULOSE
DESMOPRESSIN ACETATE
ENDOCET
NOVOLOG FLEXPEN
JANUMET
KETOCONAZOLE
ALBUTEROL SULFATE
BUMETANIDE
HUMIRA
BD ULTRA-FINE PEN NEEDLE
SANTYL
CARISOPRODOL
INDOMETHACIN
ROZEREM
EPIVIR
BOOSTRIX TDAP
ZENPEP
DIPHENHYDRAMINE HCL
LOTRONEX
TEFLARO
CLOZARIL
VORICONAZOLE
ACAMPROSATE CALCIUM
ANTARA
CONCERTA
ENPRESSE
EPINEPHRINE
FALMINA
SOLODYN
TWYNSTA
ETIDRONATE DISODIUM
MOZOBIL
DEPEN
PROTONIX IV
TRIANEX
RAZADYNE
VINCASAR PFS
SILVER SULFADIAZINE
VOLTAREN
THEOPHYLLINE ANHYDROUS
ISOSORBIDE MONONITRATE ER
BENICAR HCT
METFORMIN HCL ER
GRISEOFULVIN ULTRAMICROSIZE
QUINAPRIL HCL
OXYCONTIN
BEPREVE
MYSOLINE
KAZANO
TELMISARTAN
WATER
KADIAN
JINTELI
ENJUVIA
REVATIO
CATAPRES-TTS 1
ZESTORETIC
REQUIP
TRILYTE WITH FLAVOR PACKETS
MODERIBA
PORTIA
VERELAN
STALEVO 150
CLINDAMYCIN PEDIATRIC
VEXOL
RECLAST
BLEPHAMIDE
ZOFRAN
LEVETIRACETAM
SPIRONOLACTONE
CADUET
IRBESARTAN-HYDROCHLOROTHIAZIDE
KLOR-CON 10
GLIPIZIDE-METFORMIN
TENORMIN
MODAFINIL
ONGLYZA
ZOMETA
XALATAN
NALTREXONE HCL
COSOPT PF
DISOPYRAMIDE PHOSPHATE
SORIATANE
SANCTURA XR
ZORTRESS
VIVITROL
ELINEST
LYSODREN
PERSANTINE
SOMA
OXACILLIN SODIUM
DEXTROSE 5%-0.9% NACL
DOXYCYCLINE HYCLATE
LEVOFLOXACIN
NITROFURANTOIN
HUMULIN R
CLOBEX
SECTRAL
PRILOSEC
PEG 3350-ELECTROLYTE
INDAPAMIDE
UCERIS
INVOKANA
PAMIDRONATE DISODIUM
VISTARIL
KINERET
NUTROPIN AQ NUSPIN
CRINONE
BUPHENYL
STAVZOR
ULTRA-THIN II
CARBINOXAMINE MALEATE
EPIDUO
E.E.S. 400
BUDEPRION XL
WERA
KLOR-CON M20
METHADONE HCL
TORSEMIDE
DICLOFENAC SODIUM-MISOPROSTOL
ISENTRESS
ALFUZOSIN HCL ER
HYDROXYUREA
OXCARBAZEPINE
OMEPRAZOLE-SODIUM BICARBONATE
FANAPT
FAZACLO
SPRYCEL
METHYCLOTHIAZIDE
CAMPRAL
FENTANYL CITRATE
SEVELAMER CARBONATE
GLEEVEC
AVALIDE
GELNIQUE
LASTACAFT
BYDUREON
ZYPREXA RELPREVV
VELIVET
MAPROTILINE HCL
ZOLADEX
ZOCOR
RYTHMOL SR
ISOPTO CARPINE
NESINA
METIPRANOLOL
PAREGORIC
FML FORTE
FLAVOXATE HCL
CATAPRES-TTS 3
URSO FORTE
CALAN
PROMETHEGAN
ZARAH
BRIELLYN
RETIN-A
SEMPREX-D
PRENATAL VITAMINS LOW IRON
GILDAGIA
TRIAMTERENE-HYDROCHLOROTHIAZID
KOMBIGLYZE XR
SINGLE USE SWAB
FLUDROCORTISONE ACETATE
AVAPRO
VIGAMOX
INVEGA SUSTENNA
ZIOPTAN
FOSINOPRIL-HYDROCHLOROTHIAZIDE
NICARDIPINE HCL
ALCOHOL PREP SWABS
DEXTROAMPHETAMINE-AMPHET ER
ABILIFY DISCMELT
DEPAKENE
PREDNISOLONE
LORYNA
WELLBUTRIN
POTIGA
FARXIGA
CUVPOSA
CURITY ALCOHOL PREPS
FIORINAL WITH CODEINE #3
HECORIA
CHENODAL
NITROGLYCERIN PATCH
COMBIPATCH
LEVOCETIRIZI

2025-01-16 16:19:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 16:19:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 16:19:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 16:19:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 16:19:12 - snowflake.connector.connection - INFO - closed
2025-01-16 16:19:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 16:19:12 - root - INFO - SQL:
SELECT "drug_name", SUM("total_claim_count") AS total_claims
   FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
   WHERE "nppes_provider_state" = 'NY'
   GROUP BY "drug_name"
   ORDER BY total_claims DESC
   LIMIT 1000;
Results:
Too long, hard cut:
drug_name,TOTAL_CLAIMS
AMLODIPINE BESYLATE,2606392
SIMVASTATIN,2483824
ATORVASTATIN CALCIUM,2343736
OMEPRAZOLE,2158771
LEVOTHYROXINE SODIUM,2091879
LISINOPRIL,1878852
FUROSEMIDE,1604273
METOPROLOL SUCCINATE,1497362
METFORMIN HCL,1483466
METOPROLOL TARTRATE,1476125
LOSARTAN POTASSIUM,1179068
HYDROCHLOROTHIAZIDE,1177844
GABAPENTIN,1063477
WARFARIN SODIUM,1037689
CLOPIDOGREL,1027289
TAMSULOSIN HCL,950300
CRESTOR,902634
ATENOLOL,872477
ZOLPIDEM TARTRATE,740031
CARVEDILOL,711856
SERTRALINE HCL,702641
NEXIUM,675301
HYDROCODONE-ACETAMINOPHEN,669509
PRAVASTATIN SODIUM,662043
PANTOPRAZOLE SODIUM,616877
FLUTICASONE PROPIONATE,579662
PREDNISONE,562097
DONEPEZIL HCL,521804
ALENDRONATE SODIUM,521736
PROAIR HFA,520129
MONTELUKAST SODIUM,518027
ENALAPRIL MALEATE,516231
LATANOPROST,508505
JANUVIA,508330
CITALOPRAM HBR,498268
ADVAIR DISKUS,483391
ALPRAZOLAM,478214
POTASSIUM CHLORIDE,457448
SYNTHROID,453791
QUETIAPINE FUMARATE,447257
ESCITALOPRAM OXALATE,446888
TRAZODONE HCL,441018
OXYCODONE-ACETAMINOPHEN,433851
CLONAZEPAM,430536
RANITIDINE HCL,422992
LOSARTAN-HYDROCHLOROTHIAZIDE,412328
ALLOPURINOL,408017
SPIRIVA,404803
AZITHROMYCIN,394490
MELOXICAM,383651
MIRTAZAPINE,383213
FINASTERIDE,378878
TRAMADOL HCL,364355
DIOVAN,358834
GLIMEPIRIDE,358155
DULOXETINE HCL,357225
ISOSORBIDE MONONITRATE ER,346521
RAMIPRIL,343510
LANTUS SOLOSTAR,343009
AMOXICILLIN,340811
RISPERIDONE,340499
CIPROFLOXACIN HCL,338454
NAMENDA,320510
LORAZEPAM,317161
METFORMIN HCL ER,306073
IBUPROFEN,302979
LISINOPRIL-HYDROCHLOROTHIAZIDE,299542
VALSARTAN-HYDROCHLOROTHIAZIDE,283681
FAMOTIDINE,278964
VOLTAREN,278509
AMMONIUM LACTATE,277683
PAROXETINE HCL,268093
GLIPIZIDE,255509
OXYCODONE HCL,255226
FENOFIBRATE,253225
FLUOXETINE HCL,252205
SPIRONOLACTONE,246063
NIFEDIPINE ER,245644
LEVETIRACETAM,232951
HYDRALAZINE HCL,229279
LOVASTATIN,225838
POLYETHYLENE GLYCOL 3350,224730
OLANZAPINE,224053
LYRICA,220106
ZETIA,214969
ABILIFY,209738
VENLAFAXINE HCL ER,207255
SYMBICORT,201916
LEVOFLOXACIN,200878
NAPROXEN,199601
AMLODIPINE BESYLATE-BENAZEPRIL,195625
CELEBREX,194637
LOVAZA,194003
LUMIGAN,193751
CLONIDINE HCL,184816
DIVALPROEX SODIUM,181189
TRIAMCINOLONE ACETONIDE,180960
LAMOTRIGINE,178665
TRIAMTERENE-HYDROCHLOROTHIAZID,178524
XARELTO,177758
BENZTROPINE MESYLATE,177116
BUPROPION XL,177098
CARBIDOPA-LEVODOPA,176483
BD ULTRA-FINE PEN NEEDLE,174415
PREDNISOLONE ACETATE,172342
LANTUS,171652
DILTIAZEM 24HR ER,168681
VENTOLIN HFA,167376
AMOX TR-POTASSIUM CLAVULANATE,167204
LIDOCAINE,166872
MECLIZINE HCL,165798
TIMOLOL MALEATE,157757
DORZOLAMIDE-TIMOLOL,155438
SULFAMETHOXAZOLE-TRIMETHOPRIM,153797
TRAVATAN Z,151135
CLOBETASOL PROPIONATE,151077
JANUMET,150537
OXYBUTYNIN CHLORIDE ER,148582
QUINAPRIL HCL,147391
BYSTOLIC,147198
PIOGLITAZONE HCL,145249
BUSPIRONE HCL,143422
RESTASIS,141964
BACLOFEN,140937
AMITRIPTYLINE HCL,140699
GLIPIZIDE ER,140394
DIAZEPAM,139279
DOXAZOSIN MESYLATE,138825
CEPHALEXIN,137706
MUPIROCIN,135100
DIGOX,134514
DIGOXIN,133812
AVODART,133353
CHLORHEXIDINE GLUCONATE,132311
LACTULOSE,128404
GLIPIZIDE XL,126744
TOPIRAMATE,126476
COMBIGAN,126296
BENICAR,125746
FENTANYL,123240
DIVALPROEX SODIUM ER,123218
VESICARE,122059
HUMALOG,119543
LABETALOL HCL,119449
ACETAMINOPHEN-CODEINE,117625
DEXILANT,116409
METHOTREXATE,116118
IRBESARTAN,115758
CLOZAPINE,109610
NOVOLOG FLEXPEN,108274
KETOCONAZOLE,105255
CICLOPIROX,104434
HALOPERIDOL,103663
PRADAXA,101573
PATADAY,101163
DILTIAZEM 24HR CD,101139
ALPHAGAN P,100973
KLOR-CON M20,100814
CLOTRIMAZOLE-BETAMETHASONE,100714
CYCLOBENZAPRINE HCL,100707
LIDODERM,99510
BRIMONIDINE TARTRATE,98842
LANSOPRAZOLE,98791
CHLORTHALIDONE,96841
NYSTATIN,96655
METHYLPREDNISOLONE,96266
NAMENDA XR,95581
DOXYCYCLINE HYCLATE,95531
LEVEMIR FLEXPEN,94262
VERAPAMIL ER,93009
NASONEX,92831
TERAZOSIN HCL,92683
RANEXA,89604
FLUOCINONIDE,88073
COLCRYS,87328
BENAZEPRIL HCL,85024
TIZANIDINE HCL,84681
TORSEMIDE,83979
GEMFIBROZIL,82491
BUPROPION HCL SR,81924
ECONAZOLE NITRATE,81847
HYDROXYCHLOROQUINE SULFATE,81124
ROPINIROLE HCL,80150
DICLOFENAC SODIUM,79801
BENICAR HCT,78764
AZELASTINE HCL,78567
VALSARTAN,78447
OXYBUTYNIN CHLORIDE,78428
MORPHINE SULFATE ER,77889
OXYCONTIN,77360
RALOXIFENE HCL,76707
SINGLE USE SWAB,76172
CLOTRIMAZOLE,75585
NITROSTAT,75561
EXELON,74714
AMIODARONE HCL,74637
NIFEDICAL XL,73128
GLYBURIDE,73043
TOPROL XL,72958
VALACYCLOVIR,72509
PROPRANOLOL HCL,72042
ANASTROZOLE,71546
KETOROLAC TROMETHAMINE,70687
ALBUTEROL SULFATE,66127
CREON,64598
COMBIVENT RESPIMAT,64509
TRADJENTA,63702
FLOVENT HFA,63459
NORVIR,62431
CARBAMAZEPINE,61858
METOCLOPRAMIDE HCL,61183
HYDROCORTISONE,60622
ALCOHOL PADS,60215
IPRATROPIUM-ALBUTEROL,60122
CALCITRIOL,59890
JANTOVEN,59842
FOSINOPRIL SODIUM,59739
IPRATROPIUM BROMIDE,59553
HYDROXYZINE HCL,59365
RAPAFLO,58620
NORTRIPTYLINE HCL,57921
METRONIDAZOLE,57609
LITHIUM CARBONATE,56866
PATANOL,56786
SEROQUEL XR,55802
TRUVADA,55534
IBANDRONATE SODIUM,54573
NITROFURANTOIN MONO-MACRO,53554
PHENYTOIN SODIUM EXTENDED,52949
INSULIN SYRINGE,52550
FLUCONAZOLE,52522
CILOSTAZOL,52479
COUMADIN,52376
VIGAMOX,52295
OMEGA-3 ACID ETHYL

2025-01-16 16:19:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 16:19:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 16:19:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 16:19:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-16 16:19:14 - snowflake.connector.connection - INFO - closed
2025-01-16 16:19:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 16:19:14 - root - INFO - SQL:
SELECT "drug_name", SUM("total_claim_count") AS total_claims
   FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
   WHERE "nppes_provider_state" = 'NY'
   GROUP BY "drug_name"
   ORDER BY total_claims DESC
   LIMIT 1;
Results:
drug_name,TOTAL_CLAIMS
AMLODIPINE BESYLATE,2606392

2025-01-16 16:19:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 16:19:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 16:19:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 16:19:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-16 16:19:15 - snowflake.connector.connection - INFO - closed
2025-01-16 16:19:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 16:20:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 16:20:02 - root - INFO - ```sql
SELECT
  "nppes_provider_state",
  SUM("total_claim_count") AS total_claims,
  SUM("total_drug_cost") AS total_drug_cost
FROM
  CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
WHERE
  "drug_name" ILIKE '%AMLODIPINE%'
GROUP BY
  "nppes_provider_state"
ORDER BY
  total_claims DESC
LIMIT 5;
```
2025-01-16 16:20:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 16:20:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 16:20:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 16:20:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-16 16:20:04 - snowflake.connector.connection - INFO - closed
2025-01-16 16:20:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 16:20:04 - root - INFO - SQL:
SELECT
  "nppes_provider_state",
  SUM("total_claim_count") AS total_claims,
  SUM("total_drug_cost") AS total_drug_cost
FROM
  CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
WHERE
  "drug_name" ILIKE '%AMLODIPINE%'
GROUP BY
  "nppes_provider_state"
ORDER BY
  total_claims DESC
LIMIT 5;
Results:
nppes_provider_state,TOTAL_CLAIMS,TOTAL_DRUG_COST
CA,3870269,43033042.41000001
FL,2843844,29839003.14
NY,2806380,32944466.709999993
TX,2390753,29464270.749999996
PA,1913463,24588408.479999997

2025-01-16 16:20:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 16:20:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 16:20:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 16:20:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-16 16:20:06 - snowflake.connector.connection - INFO - closed
2025-01-16 16:20:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 16:21:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 16:21:05 - root - INFO - ```sql
SELECT
  "nppes_provider_state",
  SUM("total_claim_count") AS total_claims,
  SUM("total_drug_cost") AS total_drug_cost
FROM
  CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
WHERE
  "generic_name" ILIKE '%AMLODIPINE%'
GROUP BY
  "nppes_provider_state"
ORDER BY
  total_claims DESC
LIMIT 5;
```
2025-01-16 16:21:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 16:21:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 16:21:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 16:21:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-16 16:21:06 - snowflake.connector.connection - INFO - closed
2025-01-16 16:21:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 16:21:07 - root - INFO - SQL:
SELECT
  "nppes_provider_state",
  SUM("total_claim_count") AS total_claims,
  SUM("total_drug_cost") AS total_drug_cost
FROM
  CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
WHERE
  "generic_name" ILIKE '%AMLODIPINE%'
GROUP BY
  "nppes_provider_state"
ORDER BY
  total_claims DESC
LIMIT 5;
Results:
nppes_provider_state,TOTAL_CLAIMS,TOTAL_DRUG_COST
CA,3971256,65183100.970000006
NY,2903522,56020095.04999999
FL,2901721,43686941.95
TX,2479191,51779688.779999994
PA,1952101,33267682.33

2025-01-16 16:21:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 16:21:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 16:21:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 16:21:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-16 16:21:08 - snowflake.connector.connection - INFO - closed
2025-01-16 16:21:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 16:21:36 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 16:21:36 - root - INFO - ```sql
SELECT
  "nppes_provider_state",
  SUM("total_claim_count") AS total_claims,
  SUM("total_drug_cost") AS total_drug_cost
FROM
  CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
WHERE
  "drug_name" = 'AMLODIPINE BESYLATE'
GROUP BY
  "nppes_provider_state"
ORDER BY
  total_claims DESC
LIMIT 5;
```
2025-01-16 16:21:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 16:21:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 16:21:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 16:21:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-16 16:21:37 - snowflake.connector.connection - INFO - closed
2025-01-16 16:21:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 16:21:38 - root - INFO - SQL:
SELECT
  "nppes_provider_state",
  SUM("total_claim_count") AS total_claims,
  SUM("total_drug_cost") AS total_drug_cost
FROM
  CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
WHERE
  "drug_name" = 'AMLODIPINE BESYLATE'
GROUP BY
  "nppes_provider_state"
ORDER BY
  total_claims DESC
LIMIT 5;
Results:
nppes_provider_state,TOTAL_CLAIMS,TOTAL_DRUG_COST
CA,3725846,35073534.86999999
FL,2689327,21046051.190000005
NY,2606392,20729281.25
TX,2212275,17513523.7
PA,1760543,14121212.74

2025-01-16 16:21:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 16:21:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 16:21:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 16:21:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-16 16:21:39 - snowflake.connector.connection - INFO - closed
2025-01-16 16:21:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 16:23:07 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 16:23:07 - root - INFO - ```sql
SELECT
  "nppes_provider_state",
  SUM("total_claim_count") AS total_claims,
  SUM("total_drug_cost") AS total_drug_cost
FROM
  CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
GROUP BY
  "nppes_provider_state"
ORDER BY
  total_claims DESC
LIMIT 5;
```
2025-01-16 16:23:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 16:23:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 16:23:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 16:23:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-16 16:23:09 - snowflake.connector.connection - INFO - closed
2025-01-16 16:23:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 16:23:09 - root - INFO - SQL:
SELECT
  "nppes_provider_state",
  SUM("total_claim_count") AS total_claims,
  SUM("total_drug_cost") AS total_drug_cost
FROM
  CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
GROUP BY
  "nppes_provider_state"
ORDER BY
  total_claims DESC
LIMIT 5;
Results:
nppes_provider_state,TOTAL_CLAIMS,TOTAL_DRUG_COST
CA,116440694,9633494580.829994
FL,91441123,6969574542.380001
NY,79570924,7521861271.36
TX,75682169,6462480867.61
PA,62946334,4841813377.080001

2025-01-16 16:23:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 16:23:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 16:23:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 16:23:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-16 16:23:11 - snowflake.connector.connection - INFO - closed
2025-01-16 16:23:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 16:23:35 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 16:23:35 - root - INFO - ```sql
SELECT
  "nppes_provider_state",
  SUM("total_claim_count") AS total_claims,
  SUM("total_drug_cost") AS total_drug_cost
FROM
  CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
WHERE
  "drug_name" = (
    SELECT
      "drug_name"
    FROM
      CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
    WHERE
      "nppes_provider_state" = 'NY'
    GROUP BY
      "drug_name"
    ORDER BY
      SUM("total_claim_count") DESC
    LIMIT 1
  )
GROUP BY
  "nppes_provider_state"
ORDER BY
  total_claims DESC
LIMIT 5;
```
2025-01-16 16:23:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 16:23:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 16:23:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 16:23:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-16 16:23:37 - snowflake.connector.connection - INFO - closed
2025-01-16 16:23:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 16:23:37 - root - INFO - SQL:
SELECT
  "nppes_provider_state",
  SUM("total_claim_count") AS total_claims,
  SUM("total_drug_cost") AS total_drug_cost
FROM
  CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
WHERE
  "drug_name" = (
    SELECT
      "drug_name"
    FROM
      CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
    WHERE
      "nppes_provider_state" = 'NY'
    GROUP BY
      "drug_name"
    ORDER BY
      SUM("total_claim_count") DESC
    LIMIT 1
  )
GROUP BY
  "nppes_provider_state"
ORDER BY
  total_claims DESC
LIMIT 5;
Results:
nppes_provider_state,TOTAL_CLAIMS,TOTAL_DRUG_COST
CA,3725846,35073534.87000001
FL,2689327,21046051.18999999
NY,2606392,20729281.250000007
TX,2212275,17513523.7
PA,1760543,14121212.739999998

2025-01-16 16:23:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 16:23:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 16:23:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 16:23:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-16 16:23:38 - snowflake.connector.connection - INFO - closed
2025-01-16 16:23:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 16:24:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 16:24:21 - root - INFO - The drug with the highest total number of prescriptions in New York State during 2014 is **AMLODIPINE BESYLATE**.

The top five states with the highest total claim counts for **AMLODIPINE BESYLATE** are:

```csv
state,total_claim_count,total_drug_cost
CA,3725846,35073534.87
FL,2689327,21046051.19
NY,2606392,20729281.25
TX,2212275,17513523.70
PA,1760543,14121212.74
```

**Explanation:**

- **AMLODIPINE BESYLATE** is the medication with the highest number of prescriptions in New York State for the year 2014.
- The table above lists the top five states with the highest total claim counts for this drug.
- Each row includes:
  - **state**: The state abbreviation.
  - **total_claim_count**: The sum of all prescription claims for **AMLODIPINE BESYLATE** in that state.
  - **total_drug_cost**: The total cost of the drug for all claims in that state.
- The data shows that California has the highest total claim count and total drug cost for **AMLODIPINE BESYLATE**, followed by Florida, New York, Texas, and Pennsylvania.
2025-01-16 16:24:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 16:24:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 16:24:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 16:24:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-16 16:24:22 - snowflake.connector.connection - INFO - closed
2025-01-16 16:24:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 16:26:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 16:26:22 - root - INFO - ```sql
SELECT
  "nppes_provider_state" AS state,
  SUM("total_claim_count") AS total_claims,
  SUM("total_drug_cost") AS total_drug_cost
FROM
  CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
WHERE
  "drug_name" = 'LISINOPRIL'
GROUP BY
  "nppes_provider_state"
ORDER BY
  total_claims DESC
LIMIT 5;
```
2025-01-16 16:26:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 16:26:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 16:26:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 16:26:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-16 16:26:24 - snowflake.connector.connection - INFO - closed
2025-01-16 16:26:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 16:26:24 - root - INFO - SQL:
SELECT
  "nppes_provider_state" AS state,
  SUM("total_claim_count") AS total_claims,
  SUM("total_drug_cost") AS total_drug_cost
FROM
  CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
WHERE
  "drug_name" = 'LISINOPRIL'
GROUP BY
  "nppes_provider_state"
ORDER BY
  total_claims DESC
LIMIT 5;
Results:
STATE,TOTAL_CLAIMS,TOTAL_DRUG_COST
CA,3328132,28081799.270000007
FL,2871093,18765053.880000006
TX,2351958,18193331.150000002
PA,2033522,13881711.110000003
NY,1878852,12129540.519999996

2025-01-16 16:26:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 16:26:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 16:26:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 16:26:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-16 16:26:25 - snowflake.connector.connection - INFO - closed
2025-01-16 16:26:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 16:27:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 16:27:14 - root - INFO - ```sql
SELECT
  "nppes_provider_state" AS state,
  SUM("total_claim_count") AS total_claim_count,
  SUM("total_drug_cost") AS total_drug_cost
FROM
  CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
WHERE
  "drug_name" = (
    SELECT
      "drug_name"
    FROM
      CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
    WHERE
      "nppes_provider_state" = 'NY'
    GROUP BY
      "drug_name"
    ORDER BY
      SUM("total_claim_count") DESC
    LIMIT 1
  )
GROUP BY
  "nppes_provider_state"
ORDER BY
  total_claim_count DESC
LIMIT 5;
```
2025-01-16 16:27:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 16:27:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 16:27:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 16:27:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-16 16:27:15 - snowflake.connector.connection - INFO - closed
2025-01-16 16:27:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 16:27:16 - root - INFO - SQL:
SELECT
  "nppes_provider_state" AS state,
  SUM("total_claim_count") AS total_claim_count,
  SUM("total_drug_cost") AS total_drug_cost
FROM
  CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
WHERE
  "drug_name" = (
    SELECT
      "drug_name"
    FROM
      CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
    WHERE
      "nppes_provider_state" = 'NY'
    GROUP BY
      "drug_name"
    ORDER BY
      SUM("total_claim_count") DESC
    LIMIT 1
  )
GROUP BY
  "nppes_provider_state"
ORDER BY
  total_claim_count DESC
LIMIT 5;
Results:
STATE,TOTAL_CLAIM_COUNT,TOTAL_DRUG_COST
CA,3725846,35073534.87
FL,2689327,21046051.19
NY,2606392,20729281.25
TX,2212275,17513523.700000003
PA,1760543,14121212.739999995

2025-01-16 16:27:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 16:27:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 16:27:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 16:27:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 16:27:17 - snowflake.connector.connection - INFO - closed
2025-01-16 16:27:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 16:27:18 - root - INFO - SQL:
SELECT "drug_name", SUM("total_drug_cost") AS total_cost
    FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
    WHERE "nppes_provider_state" = 'NY'
    GROUP BY "drug_name"
    ORDER BY total_cost DESC
    LIMIT 1000;
Results:
Too long, hard cut:
drug_name,TOTAL_COST
CRESTOR,249327097.41000006
SOVALDI,230243170.38999996
NEXIUM,214788833.78999996
JANUVIA,194438475.11999995
ABILIFY,181274610.41000003
ADVAIR DISKUS,180060546.19
SPIRIVA,150863384.09000006
LANTUS SOLOSTAR,148985758.75000003
REVLIMID,107219280.91000003
NAMENDA,83872328.88000003
ENBREL,81570443.92
COPAXONE,79486041.01999998
DIOVAN,78426639.23
TRUVADA,72683222.99
HUMIRA,72616484.42999996
DULOXETINE HCL,71719393.03
LYRICA,66070666.269999996
XARELTO,64782309.81000001
ZETIA,63663933.770000026
RESTASIS,63575130.73000001
LANTUS,61681575.25
SYMBICORT,59867832.10999999
CELEBREX,59071901.580000006
METOPROLOL SUCCINATE,57766641.46000001
OLYSIO,55122556.599999994
JANUMET,55056829.46000001
ATRIPLA,54860236.31000001
ATORVASTATIN CALCIUM,53943714.92999999
GLEEVEC,51117573.96000001
HUMALOG,48263419.920000024
NOVOLOG FLEXPEN,48213346.3
ISENTRESS,47487933.48999999
LOVAZA,45890986.80000001
SENSIPAR,45096677.93
TECFIDERA,42576237.599999994
OXYCONTIN,42112905.26999998
LIDODERM,40911216.23
RENVELA,40821118.470000006
PREZISTA,40812033.79
HARVONI,40439111.24999999
LIDOCAINE,40209597.260000005
ZYTIGA,40067382.019999996
PRADAXA,40056632.84
LEVEMIR FLEXPEN,38206535.82000001
LEVOTHYROXINE SODIUM,37782511.410000004
LUMIGAN,34801637.980000004
VESICARE,34509594.03
RANEXA,32636829.85000001
SEROQUEL XR,32380961.62000001
REYATAZ,32013003.349999998
OMEPRAZOLE,31535545.88
VICTOZA 3-PAK,30027173.900000002
PROAIR HFA,29455596.169999998
EXELON,29194113.79
TARCEVA,29140341.820000008
CREON,27937813.83000001
AVODART,27472993.95000001
CLOPIDOGREL,27348175.680000003
EPZICOM,26709837.58
NAMENDA XR,25983794.510000005
LETAIRIS,25902094.29
DEXILANT,25676366.45
BENICAR,25443543.999999993
PROCRIT,25153769.130000003
TRAVATAN Z,24771707.95999999
OLANZAPINE,24613230.34
QUETIAPINE FUMARATE,24296346.749999996
AVONEX,24095960.07
TRADJENTA,23621812.800000004
FENOFIBRATE,23577113.289999995
XTANDI,22975633.200000007
SIMVASTATIN,22966671.890000004
GAMMAGARD LIQUID,22137393.640000004
H.P. ACTHAR,22109154.050000004
TAMSULOSIN HCL,21594947.830000006
AVONEX PEN,21381695.330000002
TRACLEER,21115983.340000004
OXYCODONE-ACETAMINOPHEN,21104760.019999996
DIVALPROEX SODIUM ER,21020703.65
PRAVASTATIN SODIUM,20913612.590000004
NORVIR,20754231.05
AMLODIPINE BESYLATE,20729281.25
COMBIVENT RESPIMAT,20700370.279999997
VIREAD,20304233.08
GABAPENTIN,20300069.88
VOLTAREN,19943125.9
WELCHOL,19644395.279999997
BYSTOLIC,19561871.960000005
COLCRYS,19379766.749999993
NOVOLOG MIX 70-30 FLEXPEN,19346065.25
SYNTHROID,19280530.58000001
FORTEO,19164627.519999996
COMBIGAN,18785901.629999995
ENOXAPARIN SODIUM,17958707.12
HYDROCODONE-ACETAMINOPHEN,17544090.790000003
NASONEX,17455648.05
COMPLERA,17237542.63
RALOXIFENE HCL,17232401.169999994
ELIQUIS,17225348.980000004
ALPHAGAN P,17197571.570000004
ONGLYZA,17097443.66
CLOBETASOL PROPIONATE,17034813.120000005
STRIBILD,16736289.4
LATUDA,16714844.340000002
LOSARTAN POTASSIUM,16707068.969999999
REBIF,16471064.78
BENICAR HCT,16365516.01
FENTANYL,16106482.22
VALSARTAN,16003284.719999997
VYTORIN,15631262.600000001
INVEGA SUSTENNA,15577263.82
FLOVENT HFA,15417080.719999999
DONEPEZIL HCL,15253989.270000009
PATADAY,15244739.37
AGGRENOX,15219900.720000003
GAMUNEX-C,14807257.29
NOVOLOG,14675388.849999998
VALSARTAN-HYDROCHLOROTHIAZIDE,14637686.239999998
AMITIZA,14614131.219999999
GILENYA,14583050.46
OXYCODONE HCL,14576462.04
MONTELUKAST SODIUM,14196241.42
XIFAXAN,13925425.670000002
IMBRUVICA,13594120.349999996
AZILECT,13095812.930000002
EVISTA,12826356.570000002
POTASSIUM CHLORIDE,12816403.470000006
VIMPAT,12466537.830000002
MYRBETRIQ,12435013.940000001
METFORMIN HCL,12377618.14
HUMALOG MIX 75-25,12168255.44
LISINOPRIL,12129540.519999996
RAPAFLO,11860292.840000004
AFINITOR,11842201.230000002
AMPYRA,11729545.72
VALCYTE,11694943.840000002
PROLIA,11647358.109999998
METFORMIN HCL ER,11580778.149999999
DICLOFENAC SODIUM,11575983.980000002
ADCIRCA,11298534.26
AMLODIPINE BESYLATE-BENAZEPRIL,11121216.639999997
WARFARIN SODIUM,11100457.570000004
INTELENCE,11013016.680000003
SANTYL,10946240.519999998
JAKAFI,10902051.39
INVOKANA,10842460.52
LEVEMIR,10820001.460000003
OMEGA-3 ACID ETHYL ESTERS,10777016.41
INVEGA,10755982.930000002
FLUTICASONE PROPIONATE,10629640.18
PREDNISOLONE ACETATE,10501226.980000006
NIACIN ER,10420729.769999996
ULORIC,10399172.719999999
MULTAQ,10351336.500000004
PIOGLITAZONE HCL,10267115.029999997
EXFORGE,10256804.230000002
RISPERDAL CONSTA,10206885.15
PANTOPRAZOLE SODIUM,10186062.680000002
PREMARIN,10150921.78
TASIGNA,10099062.060000002
POMALYST,10085754.04
CLOZAPINE,10046192.16
METOPROLOL TARTRATE,9967777.96
NIFEDIPINE ER,9949490.360000003
PATANOL,9637933.740000004
ESCITALOPRAM OXALATE,9584397.980000002
LATANOPROST,9357466.48
MORPHINE SULFATE ER,9315240.060000002
LIALDA,9218202.669999998
TIVICAY,9160245.05
ACTONEL,9125216.94
SUBOXONE,9123378.790000001
OXYBUTYNIN CHLORIDE ER,9084748.639999999
METHOTREXATE,9060760.379999999
ANDROGEL,8960305.68
AZOR,8950289.61
ZOSTAVAX,8891298.76
AUBAGIO,8873366.209999999
BARACLUDE,8852746.04
AZOPT,880

2025-01-16 16:27:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 16:27:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 16:27:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 16:27:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 16:27:19 - snowflake.connector.connection - INFO - closed
2025-01-16 16:27:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 16:27:20 - root - INFO - SQL:
SELECT "generic_name", SUM("total_claim_count") AS total_claims
    FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
    WHERE "nppes_provider_state" = 'NY'
    GROUP BY "generic_name"
    ORDER BY total_claims DESC
    LIMIT 1000;
Results:
Too long, hard cut:
generic_name,TOTAL_CLAIMS
AMLODIPINE BESYLATE,2609790
LEVOTHYROXINE SODIUM,2548186
SIMVASTATIN,2484445
ATORVASTATIN CALCIUM,2352946
OMEPRAZOLE,2159111
LISINOPRIL,1879348
METFORMIN HCL,1795394
FUROSEMIDE,1604771
METOPROLOL SUCCINATE,1570320
METOPROLOL TARTRATE,1476125
LOSARTAN POTASSIUM,1180518
HYDROCHLOROTHIAZIDE,1177855
WARFARIN SODIUM,1149907
GABAPENTIN,1067927
CLOPIDOGREL BISULFATE,1038082
TAMSULOSIN HCL,952628
ROSUVASTATIN CALCIUM,902634
ATENOLOL,873106
ZOLPIDEM TARTRATE,775980
ALBUTEROL SULFATE,775194
CARVEDILOL,712969
SERTRALINE HCL,703789
ESOMEPRAZOLE MAGNESIUM,675301
HYDROCODONE/ACETAMINOPHEN,674906
PRAVASTATIN SODIUM,662228
FLUTICASONE PROPIONATE,648356
POTASSIUM CHLORIDE,638713
PANTOPRAZOLE SODIUM,619762
PREDNISONE,562181
DONEPEZIL HCL,526245
GLIPIZIDE,523087
ALENDRONATE SODIUM,522254
MONTELUKAST SODIUM,520755
ENALAPRIL MALEATE,516445
"INSULIN GLARGINE,HUM.REC.ANLOG",514661
LATANOPROST,512353
SITAGLIPTIN PHOSPHATE,508330
QUETIAPINE FUMARATE,505170
FLUTICASONE/SALMETEROL,501843
CITALOPRAM HYDROBROMIDE,498709
ALPRAZOLAM,483165
OXYCODONE HCL/ACETAMINOPHEN,465082
ESCITALOPRAM OXALATE,450632
TRAZODONE HCL,441128
VALSARTAN,437281
CLONAZEPAM,430660
RANITIDINE HCL,423347
MEMANTINE HCL,416091
LOSARTAN/HYDROCHLOROTHIAZIDE,413422
ALLOPURINOL,408043
TIOTROPIUM BROMIDE,404803
AZITHROMYCIN,399475
MELOXICAM,383749
MIRTAZAPINE,383410
DICLOFENAC SODIUM,380185
FINASTERIDE,379228
DULOXETINE HCL,372416
TRAMADOL HCL,370487
DILTIAZEM HCL,367454
GLIMEPIRIDE,358790
ISOSORBIDE MONONITRATE,352541
RISPERIDONE,344353
RAMIPRIL,344315
AMOXICILLIN,340811
CIPROFLOXACIN HCL,338754
OXYCODONE HCL,332869
NIFEDIPINE,321233
LORAZEPAM,317996
DIVALPROEX SODIUM,311476
IBUPROFEN,302979
LISINOPRIL/HYDROCHLOROTHIAZIDE,299631
VALSARTAN/HYDROCHLOROTHIAZIDE,287677
BUPROPION HCL,285131
AMMONIUM LACTATE,283490
FAMOTIDINE,278563
DIGOXIN,271702
PAROXETINE HCL,268902
"NEEDLES, INSULIN DISPOSABLE",266720
LIDOCAINE,266382
FLUOXETINE HCL,253967
LEVETIRACETAM,247216
SPIRONOLACTONE,246184
OMEGA-3 ACID ETHYL ESTERS,245783
VENLAFAXINE HCL,239132
OLANZAPINE,238540
HYDRALAZINE HCL,229279
OXYBUTYNIN CHLORIDE,227978
LOVASTATIN,225862
POLYETHYLENE GLYCOL 3350,224730
PREGABALIN,220106
ALCOHOL ANTISEPTIC PADS,215078
EZETIMIBE,214969
ARIPIPRAZOLE,212261
CARBIDOPA/LEVODOPA,208989
BUDESONIDE/FORMOTEROL FUMARATE,201916
LEVOFLOXACIN,200903
BRIMONIDINE TARTRATE,199838
NAPROXEN,199601
AMLODIPINE BESYLATE/BENAZEPRIL,196339
CELECOXIB,194696
BIMATOPROST,193751
LAMOTRIGINE,193210
CLONIDINE HCL,185016
TRIAMCINOLONE ACETONIDE,181850
TRIAMTERENE/HYDROCHLOROTHIAZID,178842
RIVAROXABAN,177758
BENZTROPINE MESYLATE,177116
PREDNISOLONE ACETATE,174496
AMOXICILLIN/POTASSIUM CLAV,167479
MECLIZINE HCL,165798
TIMOLOL MALEATE,161653
SITAGLIPTIN PHOS/METFORMIN HCL,161377
OLOPATADINE HCL,160355
DORZOLAMIDE HCL/TIMOLOL MALEAT,157027
SULFAMETHOXAZOLE/TRIMETHOPRIM,153797
INSULIN ASPART,151854
CLOBETASOL PROPIONATE,151332
TRAVOPROST,151135
MOMETASONE FUROATE,149166
QUINAPRIL HCL,147678
NEBIVOLOL HCL,147198
LACTULOSE,146253
PIOGLITAZONE HCL,145807
INSULIN DETEMIR,143447
BUSPIRONE HCL,143422
CYCLOSPORINE,142265
BACLOFEN,140937
AMITRIPTYLINE HCL,140699
DIAZEPAM,139707
DOXAZOSIN MESYLATE,139134
CEPHALEXIN,137706
NYSTATIN,133630
DUTASTERIDE,133353
CHLORHEXIDINE GLUCONATE,132732
TOPIRAMATE,129840
MUPIROCIN,126924
BRIMONIDINE TARTRATE/TIMOLOL,126296
OLMESARTAN MEDOXOMIL,125746
FENTANYL,125033
IPRATROPIUM/ALBUTEROL SULFATE,124631
RALOXIFENE HCL,124196
SOLIFENACIN SUCCINATE,122059
NITROGLYCERIN,119828
INSULIN LISPRO,119543
LABETALOL HCL,119449
ACETAMINOPHEN WITH CODEINE,117721
FENOFIBRATE NANOCRYSTALLIZED,117501
IRBESARTAN,117176
DEXLANSOPRAZOLE,116409
METHOTREXATE SODIUM,116317
CLOZAPINE,116066
HYDROCORTISONE,111330
MORPHINE SULFATE,110212
VERAPAMIL HCL,109123
PROPRANOLOL HCL,108370
LANSOPRAZOLE,105320
KETOCONAZOLE,105280
HALOPERIDOL,103651
DABIGATRAN ETEXILATE MESYLATE,101573
CYCLOBENZAPRINE HCL,100913
CLOTRIMAZOLE/BETAMETHASONE DIP,100737
CHLORTHALIDONE,96841
METHYLPREDNISOLONE,96408
DOXYCYCLINE HYCLATE,95623
TERAZOSIN HCL,92683
RANOLAZINE,89604
FLUOCINONIDE,88100
COLCHICINE,87328
CARBAMAZEPINE,86929
BENAZEPRIL HCL,85059
TIZANIDINE HCL,84772
TORSEMIDE,83979
FENOFIBRATE,83924
GEMFIBROZIL,82491
AZELASTINE HCL,82086
ECONAZOLE NITRATE,81847
HYDROXYCHLOROQUINE SULFATE,81410
ROPINIROLE HCL,80686
LITHIUM CARBONATE,80525
OLMESARTAN/HYDROCHLOROTHIAZIDE,78764
IPRATROPIUM BROMIDE,77083
AMIODARONE HCL,75771
CLOTRIMAZOLE,75585
ESTRADIOL,74801
RIVASTIGMINE,74643
GLYBURIDE,73055
VALACYCLOVIR HCL,72957
ANASTROZOLE,71935
LIPASE/PROTEASE/AMYLASE,71805
KETOROLAC TROMETHAMINE,70711
PHENYTOIN SODIUM EXTENDED,68171
LINAGLIPTIN,63702
RITONAVIR,62431
METOCLOPRAMIDE HCL,61196
CALCITRIOL,60110
FOSINOPRIL SODIUM,59739
HYDROXYZINE HCL,59365
SUCRALFATE,58880
SILODOSIN,58620
NORTRIPTYLINE HCL,58030
METRONIDAZOLE,57624
SILVER SULFADIAZINE,57379
MOXIFLOXACIN HCL,57197
CICLOPIROX OLAMINE,57133
SEVELAMER CARBONATE,57010
IBANDRONATE SODIUM,55710
EMTRICITABINE/TENOFOVIR,55534
RISEDRONATE SODIUM,54361
NITROFURANTOIN MONOHYD/M-CRYST,535

2025-01-16 16:27:20 - root - INFO - itercount: 0
2025-01-16 16:27:20 - root - INFO - Database Name: CMS_DATA
Schema Name: CMS_CODES
DDL describes table information.
,0
table_name,HCPCS
description,
DDL,"create or replace TABLE HCPCS (
	HCPC VARCHAR(16777216),
	SEQNUM VARCHAR(16777216),
	RECID NUMBER(38,0),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216),
	PRICE1 VARCHAR(16777216),
	PRICE2 VARCHAR(16777216),
	PRICE3 VARCHAR(16777216),
	PRICE4 VARCHAR(16777216),
	MULT_PI VARCHAR(16777216),
	CIM1 VARCHAR(16777216),
	CIM2 VARCHAR(16777216),
	CIM3 VARCHAR(16777216),
	MCM1 FLOAT,
	MCM2 NUMBER(38,0),
	MCM3 VARCHAR(16777216),
	STATUTE VARCHAR(16777216),
	LABCERT1 VARCHAR(16777216),
	LABCERT2 VARCHAR(16777216),
	LABCERT3 VARCHAR(16777216),
	LABCERT4 VARCHAR(16777216),
	LABCERT5 VARCHAR(16777216),
	LABCERT6 VARCHAR(16777216),
	LABCERT7 VARCHAR(16777216),
	LABCERT8 VARCHAR(16777216),
	XREF1 VARCHAR(16777216),
	XREF2 VARCHAR(16777216),
	XREF3 VARCHAR(16777216),
	XREF4 VARCHAR(16777216),
	XREF5 VARCHAR(16777216),
	COV VARCHAR(16777216),
	ASC_GRP VARCHAR(16777216),
	ASC_DT VARCHAR(16777216),
	OPPS VARCHAR(16777216),
	OPPS_PI VARCHAR(16777216),
	OPPS_DT VARCHAR(16777216),
	PROCNOTE VARCHAR(16777216),
	BETOS VARCHAR(16777216),
	TOS1 VARCHAR(16777216),
	TOS2 VARCHAR(16777216),
	TOS3 VARCHAR(16777216),
	TOS4 VARCHAR(16777216),
	TOS5 VARCHAR(16777216),
	ANEST_BU VARCHAR(16777216),
	ADD_DT VARCHAR(16777216),
	ACT_EFF_DT VARCHAR(16777216),
	TERM_DT VARCHAR(16777216),
	ACTION_CD BOOLEAN
);"

,1
table_name,ICD10_PROCEDURES_2019
description,
DDL,"create or replace TABLE ICD10_PROCEDURES_2019 (
	""order_number"" VARCHAR(16777216),
	""pcs_code"" VARCHAR(16777216),
	""is_header_code"" BOOLEAN,
	""short_description"" VARCHAR(16777216),
	""long_description"" VARCHAR(16777216)
);"

,2
table_name,ICD9_DIAGNOSES
description,
DDL,"create or replace TABLE ICD9_DIAGNOSES (
	DIAGNOSIS_CODE VARCHAR(16777216),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216)
);"

,3
table_name,ICD10_DIAGNOSES_2019
description,
DDL,"create or replace TABLE ICD10_DIAGNOSES_2019 (
	""order_number"" VARCHAR(16777216),
	""cm_code"" VARCHAR(16777216),
	""is_header_code"" BOOLEAN,
	""short_description"" VARCHAR(16777216),
	""long_description"" VARCHAR(16777216)
);"

,4
table_name,ICD9_PROCEDURES
description,
DDL,"create or replace TABLE ICD9_PROCEDURES (
	PROCEDURE_CODE VARCHAR(16777216),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_MEDICARE
DDL describes table information.
,0
table_name,HOME_HEALTH_AGENCIES_2013
description,
DDL,"create or replace TABLE HOME_HEALTH_AGENCIES_2013 (
	""provider_id"" VARCHAR(16777216),
	""agency_name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""total_episodes_non_lupa"" NUMBER(38,0),
	""distinct_users_non_lupa"" NUMBER(38,0),
	""total_hha_charge_amount_non_lupa"" NUMBER(38,0),
	""total_hha_medicare_payment_amount_non_lupa"" NUMBER(38,0),
	""total_hha_medicare_standard_payment_amount_non_lupa"" NUMBER(38,0),
	""outlier_payments_as_a_percent_of_medicare_payment_amount_non_lupa"" NUMBER(38,0),
	""total_lupa_episodes"" NUMBER(38,0),
	""total_hha_medicare_payment_amount_for_lupas"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014']
,1
table_name,HOSPICE_PROVIDERS_2014
description,
DDL,"create or replace TABLE HOSPICE_PROVIDERS_2014 (
	""provider_id"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""hrr"" VARCHAR(16777216),
	""hospice_beneficiaries"" NUMBER(38,0),
	""total_days"" NUMBER(38,0),
	""total_medicare_payment_amount"" NUMBER(38,0),
	""total_medicare_standard_payment_amount"" NUMBER(38,0),
	""total_charge_amount"" NUMBER(38,0),
	""percent_routine_home_care_days"" NUMBER(38,0),
	""physician_services"" NUMBER(38,0),
	""home_health_visit_hours_per_day"" FLOAT,
	""skilled_nursing_visit_hours_per_day"" FLOAT,
	""social_service_visit_hours_per_day"" FLOAT,
	""total_live_discharges"" NUMBER(38,0),
	""hospice_beneficiaries_with_seven_or_fewer_hospice_care_days"" NUMBER(38,0),
	""hospice_beneficiaries_with_more_than_sixty_hospice_care_days"" NUMBER(38,0),
	""hospice_beneficiaries_with_more_than_one_hundred_eighty_hospice_care_days"" NUMBER(38,0),
	""home_health_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""skilled_nursing_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""social_service_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""average_age"" FLOAT,
	""male_hospice_beneficiaries"" NUMBER(38,0),
	""female_hospice_beneficiaries"" NUMBER(38,0),
	""white_hospice_beneficiaries"" NUMBER(38,0),
	""black_hospice_beneficiaries"" NUMBER(38,0),
	""asian_hospice_beneficiaries"" NUMBER(38,0),
	""hispanic_hospice_beneficiaries"" NUMBER(38,0),
	""other_unknown_race_hospice_beneficiaries"" NUMBER(38,0),
	""medicare_advantage_hospice_beneficiaries"" NUMBER(38,0),
	""medicaid_eligible_hospice_beneficiaries"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_cancer"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_dementia"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_stroke"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_circulatory_heart_disease"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_respiratory_disease"" NUMBER(38,0),
	""hospice_beneficiaries_with_other_primary_diagnoses"" NUMBER(38,0),
	""site_of_service_home_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_assisted_living_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_long_term_care_or_non_skilled_nursing_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_skilled_nursing_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_inpatient_hospital_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_inpatient_hospice_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_other_facility_hospice_beneficiaries"" NUMBER(38,0)
);"

,2
table_name,HOSPITAL_GENERAL_INFO
description,
DDL,"create or replace TABLE HOSPITAL_GENERAL_INFO (
	""provider_id"" VARCHAR(16777216),
	""hospital_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""phone_number"" VARCHAR(16777216),
	""hospital_type"" VARCHAR(16777216),
	""hospital_ownership"" VARCHAR(16777216),
	""emergency_services"" BOOLEAN,
	""meets_criteria_for_promoting_interoperability_of_ehrs"" BOOLEAN,
	""hospital_overall_rating"" VARCHAR(16777216),
	""hospital_overall_rating_footnote"" VARCHAR(16777216),
	""mortality_group_measure_count"" VARCHAR(16777216),
	""facility_mortaility_measures_count"" VARCHAR(16777216),
	""mortality_measures_better_count"" VARCHAR(16777216),
	""mortality_measures_no_different_count"" VARCHAR(16777216),
	""mortality_measures_worse_count"" VARCHAR(16777216),
	""mortaility_group_footnote"" VARCHAR(16777216),
	""safety_measures_count"" VARCHAR(16777216),
	""facility_care_safety_measures_count"" VARCHAR(16777216),
	""safety_measures_better_count"" VARCHAR(16777216),
	""safety_measures_no_different_count"" VARCHAR(16777216),
	""safety_measures_worse_count"" VARCHAR(16777216),
	""safety_group_footnote"" VARCHAR(16777216),
	""readmission_measures_count"" VARCHAR(16777216),
	""facility_readmission_measures_count"" VARCHAR(16777216),
	""readmission_measures_better_count"" VARCHAR(16777216),
	""readmission_measures_no_different_count"" VARCHAR(16777216),
	""readmission_measures_worse_count"" VARCHAR(16777216),
	""readmission_measures_footnote"" VARCHAR(16777216),
	""patient_experience_measures_count"" VARCHAR(16777216),
	""facility_patient_experience_measures_count"" VARCHAR(16777216),
	""patient_experience_measures_footnote"" VARCHAR(16777216),
	""timely_and_effective_care_measures_count"" VARCHAR(16777216),
	""facility_timely_and_effective_care_measures_count"" VARCHAR(16777216),
	""timely_and_effective_care_measures_footnote"" VARCHAR(16777216)
);"

,3
table_name,INPATIENT_CHARGES_2011
description,
DDL,"create or replace TABLE INPATIENT_CHARGES_2011 (
	""provider_id"" VARCHAR(16777216),
	""provider_name"" VARCHAR(16777216),
	""provider_street_address"" VARCHAR(16777216),
	""provider_city"" VARCHAR(16777216),
	""provider_state"" VARCHAR(16777216),
	""provider_zipcode"" VARCHAR(16777216),
	""drg_definition"" VARCHAR(16777216),
	""hospital_referral_region_description"" VARCHAR(16777216),
	""total_discharges"" NUMBER(38,0),
	""average_covered_charges"" FLOAT,
	""average_total_payments"" FLOAT,
	""average_medicare_payments"" FLOAT
);"

Some other tables have the similar structure: ['INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2015']
,4
table_name,NURSING_FACILITIES_2014
description,
DDL,"create or replace TABLE NURSING_FACILITIES_2014 (
	""provider_id"" VARCHAR(16777216),
	""facility_name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""total_stays"" NUMBER(38,0),
	""distinct_beneficiaries_per_provider"" NUMBER(38,0),
	""average_length_of_stays_days"" FLOAT,
	""total_snf_charge_amount"" NUMBER(38,0),
	""total_snf_medicare_allowed_amount"" NUMBER(38,0),
	""total_snf_medicare_payment_amount"" NUMBER(38,0),
	""total_snf_medicare_standard_payment_amount"" NUMBER(38,0),
	""average_age"" NUMBER(38,0),
	""male_beneficiaries"" NUMBER(38,0),
	""female_beneficiaries"" NUMBER(38,0),
	""nondual_beneficiaries"" NUMBER(38,0),
	""dual_beneficiaries"" NUMBER(38,0),
	""white_beneficiaries"" NUMBER(38,0),
	""black_beneficiaries"" NUMBER(38,0),
	""asian_pacific_islander_beneficiaries"" NUMBER(38,0),
	""hispanic_beneficiaries"" NUMBER(38,0),
	""american_indian_or_alaska_native_beneficiaries"" NUMBER(38,0),
	""other_unknown_beneficiaries"" NUMBER(38,0),
	""average_hcc_score"" FLOAT,
	""percent_of_beneficiaries_with_atrial_fibrillation"" NUMBER(38,0),
	""percent_of_beneficiaries_with_alzheimers"" NUMBER(38,0),
	""percent_of_beneficiaries_with_asthma"" NUMBER(38,0),
	""percent_of_beneficiaries_with_cancer"" NUMBER(38,0),
	""percent_of_beneficiaries_with_chf"" NUMBER(38,0),
	""percent_of_beneficiaries_with_chronic_kidney_disease"" NUMBER(38,0),
	""percent_of_beneficiaries_with_copd"" NUMBER(38,0),
	""percent_of_beneficiaries_with_depression"" NUMBER(38,0),
	""percent_of_beneficiaries_with_diabetes"" NUMBER(38,0),
	""percent_of_beneficiaries_with_hyperlipidemia"" NUMBER(38,0),
	""percent_of_beneficiaries_with_hypertension"" NUMBER(38,0),
	""percent_of_beneficiaries_with_ihd"" NUMBER(38,0),
	""percent_of_beneficiaries_with_osteoporosis"" NUMBER(38,0),
	""percent_of_beneficiaries_with_ra_oa"" NUMBER(38,0),
	""percent_of_beneficiaries_with_schizophrenia"" NUMBER(38,0),
	""percent_of_beneficiaries_with_stroke"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['NURSING_FACILITIES_2014', 'NURSING_FACILITIES_2013']
,5
table_name,OUTPATIENT_CHARGES_2012
description,
DDL,"create or replace TABLE OUTPATIENT_CHARGES_2012 (
	""provider_id"" VARCHAR(16777216),
	""provider_name"" VARCHAR(16777216),
	""provider_street_address"" VARCHAR(16777216),
	""provider_city"" VARCHAR(16777216),
	""provider_state"" VARCHAR(16777216),
	""provider_zipcode"" VARCHAR(16777216),
	""apc"" VARCHAR(16777216),
	""hospital_referral_region"" VARCHAR(16777216),
	""outpatient_services"" NUMBER(38,0),
	""average_estimated_submitted_charges"" FLOAT,
	""average_total_payments"" FLOAT
);"

Some other tables have the similar structure: ['OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2015']
,6
table_name,PART_D_PRESCRIBER_2014
description,
DDL,"create or replace TABLE PART_D_PRESCRIBER_2014 (
	""npi"" VARCHAR(16777216),
	""nppes_provider_last_org_name"" VARCHAR(16777216),
	""nppes_provider_first_name"" VARCHAR(16777216),
	""nppes_provider_city"" VARCHAR(16777216),
	""nppes_provider_state"" VARCHAR(16777216),
	""specialty_description"" VARCHAR(16777216),
	""description_flag"" VARCHAR(16777216),
	""drug_name"" VARCHAR(16777216),
	""generic_name"" VARCHAR(16777216),
	""bene_count"" NUMBER(38,0),
	""total_claim_count"" NUMBER(38,0),
	""total_day_supply"" NUMBER(38,0),
	""total_drug_cost"" FLOAT,
	""bene_count_ge65"" NUMBER(38,0),
	""bene_count_ge65_suppress_flag"" VARCHAR(16777216),
	""total_claim_count_ge65"" NUMBER(38,0),
	""ge65_suppress_flag"" VARCHAR(16777216),
	""total_day_supply_ge65"" NUMBER(38,0),
	""total_drug_cost_ge65"" FLOAT,
	""total_30_day_fill_count"" FLOAT,
	""total_30_day_fill_count_ge65"" FLOAT
);"

,7
table_name,REFERRING_DURABLE_MEDICAL_EQUIP_2013
description,
DDL,"create or replace TABLE REFERRING_DURABLE_MEDICAL_EQUIP_2013 (
	""referring_npi"" VARCHAR(16777216),
	""referring_provider_last_name_organization_name"" VARCHAR(16777216),
	""referring_provider_first_name"" VARCHAR(16777216),
	""referring_provider_middle_initial"" VARCHAR(16777216),
	""referring_provider_credentials"" VARCHAR(16777216),
	""referring_provider_gender"" VARCHAR(16777216),
	""referring_provider_entity_code"" VARCHAR(16777216),
	""referring_provider_street_1"" VARCHAR(16777216),
	""referring_provider_street_2"" VARCHAR(16777216),
	""referring_provider_city"" VARCHAR(16777216),
	""referring_provider_state"" VARCHAR(16777216),
	""referring_provider_zip"" VARCHAR(16777216),
	""referring_provider_country"" VARCHAR(16777216),
	""referring_provider_type"" VARCHAR(16777216),
	""referring_provider_type_flag"" VARCHAR(16777216),
	""number_of_suppliers"" NUMBER(38,0),
	""number_of_supplier_hcpcs"" NUMBER(38,0),
	""number_of_supplier_beneficiaries"" NUMBER(38,0),
	""number_of_supplier_claims"" NUMBER(38,0),
	""number_of_supplier_services"" NUMBER(38,0),
	""supplier_submitted_charges"" FLOAT,
	""supplier_medicare_allowed_amount"" FLOAT,
	""supplier_medicare_payment_amount"" FLOAT,
	""durable_medical_equipment_suppression_indicator"" VARCHAR(16777216),
	""number_of_durable_medical_equipment_suppliers"" NUMBER(38,0),
	""number_of_durable_medical_equipment_hcpcs"" NUMBER(38,0),
	""number_of_durable_medical_equipment_beneficiaries"" NUMBER(38,0),
	""number_of_durable_medical_equipment_claims"" NUMBER(38,0),
	""number_of_durable_medical_equipment_services"" NUMBER(38,0),
	""durable_medical_equipment_submitted_charges"" FLOAT,
	""durable_medical_equipment_medicare_allowed_amount"" FLOAT,
	""durable_medical_equipment_medicare_payment_amount"" FLOAT,
	""prosthetic_and_orthotic_suppression_indicator"" VARCHAR(16777216),
	""number_of_prosthetic_and_orthotic_suppliers"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_hcpcs"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_beneficiaries"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_claims"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_services"" NUMBER(38,0),
	""prosthetic_and_orthotic_submitted_charges"" FLOAT,
	""prosthetic_and_orthotic_medicare_allowed_amount"" FLOAT,
	""prosthetic_and_orthotic_medicare_payment_amount"" FLOAT,
	""drug_and_nutritional_suppression_indicator"" VARCHAR(16777216),
	""number_of_drug_and_nutritional_products_suppliers"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_hcpcs"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_beneficiaries"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_claims"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_services"" NUMBER(38,0),
	""drug_and_nutritional_products_submitted_charges"" FLOAT,
	""drug_and_nutritional_products_medicare_allowed_amount"" FLOAT,
	""drug_and_nutritional_products_medicare_payment_amount"" FLOAT
);"

Some other tables have the similar structure: ['REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014']
,8
table_name,PHYSICIANS_AND_OTHER_SUPPLIER_2015
description,
DDL,"create or replace TABLE PHYSICIANS_AND_OTHER_SUPPLIER_2015 (
	""npi"" VARCHAR(16777216),
	""nppes_provider_last_org_name"" VARCHAR(16777216),
	""nppes_provider_first_name"" VARCHAR(16777216),
	""nppes_provider_mi"" VARCHAR(16777216),
	""nppes_credentials"" VARCHAR(16777216),
	""nppes_provider_gender"" VARCHAR(16777216),
	""nppes_entity_code"" VARCHAR(16777216),
	""nppes_provider_street1"" VARCHAR(16777216),
	""nppes_provider_street2"" VARCHAR(16777216),
	""nppes_provider_city"" VARCHAR(16777216),
	""nppes_provider_zip"" VARCHAR(16777216),
	""nppes_provider_state"" VARCHAR(16777216),
	""nppes_provider_country"" VARCHAR(16777216),
	""provider_type"" VARCHAR(16777216),
	""medicare_participation_indicator"" VARCHAR(16777216),
	""place_of_service"" VARCHAR(16777216),
	""hcpcs_code"" VARCHAR(16777216),
	""hcpcs_description"" VARCHAR(16777216),
	""hcpcs_drug_indicator"" VARCHAR(16777216),
	""line_srvc_cnt"" FLOAT,
	""bene_unique_cnt"" NUMBER(38,0),
	""bene_day_srvc_cnt"" NUMBER(38,0),
	""average_medicare_allowed_amt"" FLOAT,
	""average_submitted_chrg_amt"" FLOAT,
	""average_medicare_payment_amt"" FLOAT,
	""average_medicare_standard_amt"" FLOAT
);"

Some other tables have the similar structure: ['PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014']
Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
DDL describes table information.
,0
table_name,CONDITION_OCCURRENCE
description,
DDL,"create or replace TABLE CONDITION_OCCURRENCE (
	""condition_occurrence_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""condition_concept_id"" NUMBER(38,0),
	""condition_start_date"" DATE,
	""condition_start_datetime"" NUMBER(38,0),
	""condition_end_date"" DATE,
	""condition_end_datetime"" NUMBER(38,0),
	""condition_type_concept_id"" NUMBER(38,0),
	""stop_reason"" VARCHAR(16777216),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""condition_source_value"" VARCHAR(16777216),
	""condition_source_concept_id"" NUMBER(38,0),
	""condition_status_source_value"" VARCHAR(16777216),
	""condition_status_concept_id"" NUMBER(38,0)
);"

,1
table_name,DRUG_ERA
description,
DDL,"create or replace TABLE DRUG_ERA (
	""drug_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""drug_era_start_date"" DATE,
	""drug_era_end_date"" DATE,
	""drug_exposure_count"" NUMBER(38,0),
	""gap_days"" NUMBER(38,0)
);"

,2
table_name,LOCATION
description,
DDL,"create or replace TABLE LOCATION (
	""location_id"" NUMBER(38,0),
	""address_1"" VARCHAR(16777216),
	""address_2"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""location_source_value"" VARCHAR(16777216)
);"

,3
table_name,PERSON
description,
DDL,"create or replace TABLE PERSON (
	""race_concept_id"" NUMBER(38,0),
	""ethnicity_concept_id"" NUMBER(38,0),
	""location_id"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""care_site_id"" NUMBER(38,0),
	""person_source_value"" VARCHAR(16777216),
	""gender_source_value"" VARCHAR(16777216),
	""gender_source_concept_id"" NUMBER(38,0),
	""race_source_value"" VARCHAR(16777216),
	""race_source_concept_id"" NUMBER(38,0),
	""ethnicity_source_value"" VARCHAR(16777216),
	""ethnicity_source_concept_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""gender_concept_id"" NUMBER(38,0),
	""year_of_birth"" NUMBER(38,0),
	""month_of_birth"" NUMBER(38,0),
	""day_of_birth"" NUMBER(38,0),
	""birth_datetime"" NUMBER(38,0)
);"

,4
table_name,CONDITION_ERA
description,
DDL,"create or replace TABLE CONDITION_ERA (
	""condition_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""condition_concept_id"" NUMBER(38,0),
	""condition_era_start_date"" DATE,
	""condition_era_end_date"" DATE,
	""condition_occurrence_count"" NUMBER(38,0)
);"

,5
table_name,DEVICE_EXPOSURE
description,
DDL,"create or replace TABLE DEVICE_EXPOSURE (
	""device_exposure_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""device_concept_id"" NUMBER(38,0),
	""device_exposure_start_date"" DATE,
	""device_exposure_start_datetime"" NUMBER(38,0),
	""device_exposure_end_date"" DATE,
	""device_exposure_end_datetime"" NUMBER(38,0),
	""device_type_concept_id"" NUMBER(38,0),
	""unique_device_id"" VARCHAR(16777216),
	""quantity"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""device_source_value"" VARCHAR(16777216),
	""device_source_concept_id"" NUMBER(38,0)
);"

,6
table_name,DOMAIN
description,
DDL,"create or replace TABLE DOMAIN (
	""domain_id"" VARCHAR(16777216),
	""domain_name"" VARCHAR(16777216),
	""domain_concept_id"" NUMBER(38,0)
);"

,7
table_name,DOSE_ERA
description,
DDL,"create or replace TABLE DOSE_ERA (
	""dose_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""unit_concept_id"" NUMBER(38,0),
	""dose_value"" FLOAT,
	""dose_era_start_date"" DATE,
	""dose_era_end_date"" DATE
);"

,8
table_name,OBSERVATION
description,
DDL,"create or replace TABLE OBSERVATION (
	""observation_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""observation_concept_id"" NUMBER(38,0),
	""observation_date"" DATE,
	""observation_datetime"" NUMBER(38,0),
	""observation_type_concept_id"" NUMBER(38,0),
	""value_as_number"" FLOAT,
	""value_as_string"" VARCHAR(16777216),
	""value_as_concept_id"" NUMBER(38,0),
	""qualifier_concept_id"" NUMBER(38,0),
	""unit_concept_id"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""observation_source_value"" VARCHAR(16777216),
	""observation_source_concept_id"" NUMBER(38,0),
	""unit_source_value"" VARCHAR(16777216),
	""qualifier_source_value"" VARCHAR(16777216)
);"

,9
table_name,COST
description,
DDL,"create or replace TABLE COST (
	""cost_id"" NUMBER(38,0),
	""cost_event_id"" NUMBER(38,0),
	""cost_domain_id"" VARCHAR(16777216),
	""cost_type_concept_id"" NUMBER(38,0),
	""currency_concept_id"" NUMBER(38,0),
	""total_charge"" FLOAT,
	""total_cost"" FLOAT,
	""total_paid"" FLOAT,
	""paid_by_payer"" FLOAT,
	""paid_by_patient"" FLOAT,
	""paid_patient_copay"" FLOAT,
	""paid_patient_coinsurance"" FLOAT,
	""paid_patient_deductible"" FLOAT,
	""paid_by_primary"" FLOAT,
	""paid_ingredient_cost"" FLOAT,
	""paid_dispensing_fee"" FLOAT,
	""payer_plan_period_id"" NUMBER(38,0),
	""amount_allowed"" FLOAT,
	""revenue_code_concept_id"" NUMBER(38,0),
	""revenue_code_source_value"" VARCHAR(16777216),
	""drg_concept_id"" NUMBER(38,0),
	""drg_source_value"" VARCHAR(16777216)
);"

,10
table_name,PROVIDER
description,
DDL,"create or replace TABLE PROVIDER (
	""provider_id"" NUMBER(38,0),
	""provider_name"" VARCHAR(16777216),
	""npi"" VARCHAR(16777216),
	""dea"" VARCHAR(16777216),
	""specialty_concept_id"" NUMBER(38,0),
	""care_site_id"" NUMBER(38,0),
	""year_of_birth"" NUMBER(38,0),
	""gender_concept_id"" NUMBER(38,0),
	""provider_source_value"" VARCHAR(16777216),
	""specialty_source_value"" VARCHAR(16777216),
	""specialty_source_concept_id"" NUMBER(38,0),
	""gender_source_value"" VARCHAR(16777216),
	""gender_source_concept_id"" NUMBER(38,0)
);"

,11
table_name,CARE_SITE
description,
DDL,"create or replace TABLE CARE_SITE (
	""care_site_id"" NUMBER(38,0),
	""care_site_name"" VARCHAR(16777216),
	""place_of_service_concept_id"" NUMBER(38,0),
	""location_id"" NUMBER(38,0),
	""care_site_source_value"" VARCHAR(16777216),
	""place_of_service_source_value"" VARCHAR(16777216)
);"

,12
table_name,CONCEPT_ANCESTOR
description,
DDL,"create or replace TABLE CONCEPT_ANCESTOR (
	""ancestor_concept_id"" NUMBER(38,0),
	""descendant_concept_id"" NUMBER(38,0),
	""min_levels_of_separation"" NUMBER(38,0),
	""max_levels_of_separation"" NUMBER(38,0)
);"

,13
table_name,CONCEPT_RELATIONSHIP
description,
DDL,"create or replace TABLE CONCEPT_RELATIONSHIP (
	""concept_id_1"" NUMBER(38,0),
	""concept_id_2"" NUMBER(38,0),
	""relationship_id"" VARCHAR(16777216),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

,14
table_name,DEATH
description,
DDL,"create or replace TABLE DEATH (
	""person_id"" NUMBER(38,0),
	""death_date"" DATE,
	""death_datetime"" NUMBER(38,0),
	""death_type_concept_id"" NUMBER(38,0),
	""cause_concept_id"" NUMBER(38,0),
	""cause_source_value"" VARCHAR(16777216),
	""cause_source_concept_id"" NUMBER(38,0)
);"

,15
table_name,DRUG_STRENGTH
description,
DDL,"create or replace TABLE DRUG_STRENGTH (
	""drug_concept_id"" NUMBER(38,0),
	""ingredient_concept_id"" NUMBER(38,0),
	""amount_value"" FLOAT,
	""amount_unit_concept_id"" NUMBER(38,0),
	""numerator_value"" FLOAT,
	""numerator_unit_concept_id"" NUMBER(38,0),
	""denominator_value"" FLOAT,
	""denominator_unit_concept_id"" NUMBER(38,0),
	""box_size"" NUMBER(38,0),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

,16
table_name,CONCEPT
description,
DDL,"create or replace TABLE CONCEPT (
	""concept_id"" NUMBER(38,0),
	""concept_name"" VARCHAR(16777216),
	""domain_id"" VARCHAR(16777216),
	""vocabulary_id"" VARCHAR(16777216),
	""concept_class_id"" VARCHAR(16777216),
	""standard_concept"" VARCHAR(16777216),
	""concept_code"" VARCHAR(16777216),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

,17
table_name,CONCEPT_CLASS
description,
DDL,"create or replace TABLE CONCEPT_CLASS (
	""concept_class_id"" VARCHAR(16777216),
	""concept_class_name"" VARCHAR(16777216),
	""concept_class_concept_id"" NUMBER(38,0)
);"

,18
table_name,DRUG_EXPOSURE
description,
DDL,"create or replace TABLE DRUG_EXPOSURE (
	""drug_type_concept_id"" NUMBER(38,0),
	""stop_reason"" VARCHAR(16777216),
	""refills"" NUMBER(38,0),
	""quantity"" FLOAT,
	""days_supply"" NUMBER(38,0),
	""sig"" VARCHAR(16777216),
	""route_concept_id"" NUMBER(38,0),
	""lot_number"" VARCHAR(16777216),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""drug_source_value"" VARCHAR(16777216),
	""drug_source_concept_id"" NUMBER(38,0),
	""route_source_value"" VARCHAR(16777216),
	""dose_unit_source_value"" VARCHAR(16777216),
	""drug_exposure_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""drug_exposure_start_date"" DATE,
	""drug_exposure_start_datetime"" NUMBER(38,0),
	""drug_exposure_end_date"" DATE,
	""drug_exposure_end_datetime"" NUMBER(38,0),
	""verbatim_end_date"" DATE
);"

,19
table_name,OBSERVATION_PERIOD
description,
DDL,"create or replace TABLE OBSERVATION_PERIOD (
	""observation_period_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""observation_period_start_date"" DATE,
	""observation_period_end_date"" DATE,
	""period_type_concept_id"" NUMBER(38,0)
);"

,20
table_name,PAYER_PLAN_PERIOD
description,
DDL,"create or replace TABLE PAYER_PLAN_PERIOD (
	""payer_concept_id"" NUMBER(38,0),
	""payer_source_value"" VARCHAR(16777216),
	""payer_source_concept_id"" NUMBER(38,0),
	""plan_concept_id"" NUMBER(38,0),
	""plan_source_value"" VARCHAR(16777216),
	""plan_source_concept_id"" NUMBER(38,0),
	""sponsor_concept_id"" NUMBER(38,0),
	""sponsor_source_value"" VARCHAR(16777216),
	""sponsor_source_concept_id"" NUMBER(38,0),
	""family_source_value"" VARCHAR(16777216),
	""stop_reason_concept_id"" NUMBER(38,0),
	""stop_reason_source_value"" VARCHAR(16777216),
	""stop_reason_source_concept_id"" NUMBER(38,0),
	""payer_plan_period_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""payer_plan_period_start_date"" DATE,
	""payer_plan_period_end_date"" DATE
);"

,21
table_name,RELATIONSHIP
description,
DDL,"create or replace TABLE RELATIONSHIP (
	""relationship_id"" VARCHAR(16777216),
	""relationship_name"" VARCHAR(16777216),
	""is_hierarchical"" VARCHAR(16777216),
	""defines_ancestry"" VARCHAR(16777216),
	""reverse_relationship_id"" VARCHAR(16777216),
	""relationship_concept_id"" NUMBER(38,0)
);"

,22
table_name,VOCABULARY
description,
DDL,"create or replace TABLE VOCABULARY (
	""vocabulary_id"" VARCHAR(16777216),
	""vocabulary_name"" VARCHAR(16777216),
	""vocabulary_reference"" VARCHAR(16777216),
	""vocabulary_version"" VARCHAR(16777216),
	""vocabulary_concept_id"" NUMBER(38,0)
);"

,23
table_name,PROCEDURE_OCCURRENCE
description,
DDL,"create or replace TABLE PROCEDURE_OCCURRENCE (
	""procedure_type_concept_id"" NUMBER(38,0),
	""modifier_concept_id"" NUMBER(38,0),
	""quantity"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""procedure_source_value"" VARCHAR(16777216),
	""procedure_source_concept_id"" NUMBER(38,0),
	""modifier_source_value"" VARCHAR(16777216),
	""procedure_occurrence_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""procedure_concept_id"" NUMBER(38,0),
	""procedure_dat"" DATE,
	""procedure_datetime"" NUMBER(38,0)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'CMS_DATA': {'CMS_CODES': ['HCPCS', 'ICD10_DIAGNOSES_2019', 'ICD10_PROCEDURES_2019', 'ICD9_DIAGNOSES', 'ICD9_PROCEDURES'], 'CMS_MEDICARE': ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014', 'HOSPICE_PROVIDERS_2014', 'HOSPITAL_GENERAL_INFO', 'INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2015', 'NURSING_FACILITIES_2013', 'NURSING_FACILITIES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2015', 'PART_D_PRESCRIBER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014'], 'CMS_SYNTHETIC_PATIENT_DATA_OMOP': ['CARE_SITE', 'CONCEPT', 'CONCEPT_ANCESTOR', 'CONCEPT_CLASS', 'CONCEPT_RELATIONSHIP', 'CONDITION_ERA', 'CONDITION_OCCURRENCE', 'COST', 'DEATH', 'DEVICE_EXPOSURE', 'DOMAIN', 'DOSE_ERA', 'DRUG_ERA', 'DRUG_EXPOSURE', 'DRUG_STRENGTH', 'LOCATION', 'OBSERVATION', 'OBSERVATION_PERIOD', 'PAYER_PLAN_PERIOD', 'PERSON', 'PROCEDURE_OCCURRENCE', 'PROVIDER', 'RELATIONSHIP', 'VOCABULARY']}}
Begin Exploring Related Columns
To address the task, we first need to identify the relevant tables and columns in our database.

**Relevant Table:**

- **Table:** `PART_D_PRESCRIBER_2014` (located in `CMS_DATA.CMS_MEDICARE` schema)

**Relevant Columns and Potential Usage:**

1. **"nppes_provider_state"**: Used to filter data by state (e.g., "NY") and to group data by state.
2. **"drug_name"**: Used to identify the drug prescribed; to filter and group data by drug.
3. **"total_claim_count"**: Used to calculate the total number of prescriptions (claims) for each drug and state.
4. **"total_drug_cost"**: Used to calculate the total drug cost for each drug and state.

**Conditions that May Be Used:**

- **Filter by State:** `"nppes_provider_state" = 'NY'` to retrieve data specific to New York.
- **Filter by Drug:** After identifying the drug with the highest prescriptions in NY, filter data for that drug using `"drug_name" = [Drug_Name]`.
- **Group By:** Group data by `"drug_name"` and `"nppes_provider_state"` to aggregate totals.

---

**SQL Queries to Explore the Data:**

1. **List all unique states in the dataset:**

   ```sql
   SELECT DISTINCT "nppes_provider_state"
   FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
   LIMIT 1000;
   ```

2. **Find total claim counts per state:**

   ```sql
   SELECT "nppes_provider_state", SUM("total_claim_count") AS total_claims
   FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
   GROUP BY "nppes_provider_state"
   ORDER BY total_claims DESC
   LIMIT 1000;
   ```

3. **List all unique drug names prescribed in New York:**

   ```sql
   SELECT DISTINCT "drug_name"
   FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
   WHERE "nppes_provider_state" = 'NY'
   LIMIT 1000;
   ```

4. **Find total claim counts per drug in New York:**

   ```sql
   SELECT "drug_name", SUM("total_claim_count") AS total_claims
   FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
   WHERE "nppes_provider_state" = 'NY'
   GROUP BY "drug_name"
   ORDER BY total_claims DESC
   LIMIT 1000;
   ```

5. **Identify the drug with the highest total claim counts in New York:**

   ```sql
   SELECT "drug_name", SUM("total_claim_count") AS total_claims
   FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
   WHERE "nppes_provider_state" = 'NY'
   GROUP BY "drug_name"
   ORDER BY total_claims DESC
   LIMIT 1;
   ```

6. **For the identified drug, find total claim counts per state:**

   *(Assuming the drug with the highest total claims in NY is 'Drug_X')*

   ```sql
   SELECT "nppes_provider_state", SUM("total_claim_count") AS total_claims
   FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
   WHERE "drug_name" = 'Drug_X'
   GROUP BY "nppes_provider_state"
   ORDER BY total_claims DESC
   LIMIT 1000;
   ```

7. **For the identified drug, find total drug costs per state:**

   ```sql
   SELECT "nppes_provider_state", SUM("total_drug_cost") AS total_cost
   FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
   WHERE "drug_name" = 'Drug_X'
   GROUP BY "nppes_provider_state"
   ORDER BY total_cost DESC
   LIMIT 1000;
   ```

8. **Get total claim counts and total drug costs per state for the identified drug:**

   ```sql
   SELECT "nppes_provider_state", SUM("total_claim_count") AS total_claims, SUM("total_drug_cost") AS total_cost
   FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
   WHERE "drug_name" = 'Drug_X'
   GROUP BY "nppes_provider_state"
   ORDER BY total_claims DESC
   LIMIT 1000;
   ```

9. **Find the top five states with the highest total claim counts for the identified drug:**

   ```sql
   SELECT "nppes_provider_state", SUM("total_claim_count") AS total_claims, SUM("total_drug_cost") AS total_cost
   FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
   WHERE "drug_name" = 'Drug_X'
   GROUP BY "nppes_provider_state"
   ORDER BY total_claims DESC
   LIMIT 5;
   ```

10. **List specialties of prescribers for the identified drug in New York:**

    ```sql
    SELECT DISTINCT "specialty_description"
    FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
    WHERE "nppes_provider_state" = 'NY' AND "drug_name" = 'Drug_X'
    LIMIT 1000;
    ```

11. **Find total claim counts per specialty for the identified drug in New York:**

    ```sql
    SELECT "specialty_description", SUM("total_claim_count") AS total_claims
    FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
    WHERE "nppes_provider_state" = 'NY' AND "drug_name" = 'Drug_X'
    GROUP BY "specialty_description"
    ORDER BY total_claims DESC
    LIMIT 1000;
    ```

12. **List cities in New York where the identified drug is prescribed:**

    ```sql
    SELECT DISTINCT "nppes_provider_city"
    FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
    WHERE "nppes_provider_state" = 'NY' AND "drug_name" = 'Drug_X'
    LIMIT 1000;
    ```

13. **Find total number of prescribers in New York for the identified drug:**

    ```sql
    SELECT COUNT(DISTINCT "npi") AS num_prescribers
    FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
    WHERE "nppes_provider_state" = 'NY' AND "drug_name" = 'Drug_X'
    LIMIT 1000;
    ```

14. **Find total drug cost per drug in New York:**

    ```sql
    SELECT "drug_name", SUM("total_drug_cost") AS total_cost
    FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
    WHERE "nppes_provider_state" = 'NY'
    GROUP BY "drug_name"
    ORDER BY total_cost DESC
    LIMIT 1000;
    ```

15. **List all generic names of drugs and their total claim counts in New York:**

    ```sql
    SELECT "generic_name", SUM("total_claim_count") AS total_claims
    FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
    WHERE "nppes_provider_state" = 'NY'
    GROUP BY "generic_name"
    ORDER BY total_claims DESC
    LIMIT 1000;
    ```

These queries will help in understanding the values in the relevant columns and assist in finding the drug with the highest total prescriptions in New York during 2014, as well as identifying the top five states with the highest total claim counts for that drug.Query:
SELECT DISTINCT "nppes_provider_state"
   FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
   LIMIT 1000;
Answer:
nppes_provider_state
NH
VA
AK
IN
MP
AA
MA
NV
NJ
WI
AR
TX
AE
CT
UT
AS
KS
MO
NY
RI
WY
LA
KY
AP
NM
MN
VT
XX
GU
CO
NE
NC
PR
IL
OH
MT
MD
WA
DE
SC
OR
PA
OK
WV
SD
ID
IA
DC
AL
CA
FL
GA
AZ
ND
ZZ
HI
ME
MS
VI
MI
TN
Query:
SELECT "nppes_provider_state", SUM("total_claim_count") AS total_claims
   FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
   GROUP BY "nppes_provider_state"
   ORDER BY total_claims DESC
   LIMIT 1000;
Answer:
nppes_provider_state,TOTAL_CLAIMS
CA,116440694
FL,91441123
NY,79570924
TX,75682169
PA,62946334
OH,53494076
NC,46020420
IL,42527191
MI,39461213
GA,39066489
TN,35472398
MO,31071230
NJ,29242463
IN,27822613
KY,26196384
AL,26162156
MA,26156247
VA,25549776
PR,24988874
LA,22456360
SC,21795317
WI,21461606
AZ,19873807
WA,19108957
MN,17312127
MS,15737130
AR,15647866
OK,14918485
IA,14673562
OR,13889191
MD,13798859
CT,12892970
CO,12823030
KS,12042320
WV,11216491
NE,7991763
NV,7457176
UT,5796245
NM,5770207
ME,5699119
RI,5535266
ID,4852448
NH,4095519
HI,3777714
SD,3525885
MT,3315266
ND,3061665
DE,3042265
VT,2115996
DC,1487724
WY,1380174
AK,1074367
VI,197072
GU,76979
ZZ,33284
AE,7617
MP,7104
XX,1909
AP,1839
AA,999
AS,218
Query:
SELECT DISTINCT "drug_name"
   FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
   WHERE "nppes_provider_state" = 'NY'
   LIMIT 1000;
Answer:
Too long, hard cut:
drug_name
METAXALONE
LYRICA
NYSTATIN
METHOCARBAMOL
ATRIPLA
ULTICARE
TRIBENZOR
PROTRIPTYLINE HCL
ERYPED 200
OPSUMIT
1ST TIER UNIFINE PENTIPS
OPIUM TINCTURE
CAYSTON
ALVESCO
ACITRETIN
HALDOL DECANOATE 100
HYDROCORTISONE-ACETIC ACID
TIKOSYN
GLUCOPHAGE
PRANDIMET
K-TAB ER
CORTISONE ACETATE
INTERMEZZO
KENALOG-40
LACTATED RINGERS
GAMMAKED
FIRAZYR
TENIVAC
VECTIBIX
HALFLYTELY-BISACODYL
TRAMADOL HCL-ACETAMINOPHEN
CILOSTAZOL
DILANTIN
ZETIA
FLUNISOLIDE
HALOBETASOL PROPIONATE
LANTUS
TRAVOPROST
TOPROL XL
DOXEPIN HCL
GATIFLOXACIN
LANTUS SOLOSTAR
GALANTAMINE HBR
EVOXAC
AMPICILLIN TRIHYDRATE
ECONAZOLE NITRATE
POLYMYXIN B SUL-TRIMETHOPRIM
OSMOPREP
GEMFIBROZIL
PERPHENAZINE
ORPHENADRINE CITRATE
DUREZOL
OXANDROLONE
PEN NEEDLES
ADCIRCA
SYMLINPEN 120
TYGACIL
FYCOMPA
E.E.S. 200
VINORELBINE TARTRATE
TREXALL
TRI-PREVIFEM
ACETIC ACID-ALUMINUM
TEKAMLO
LEVOXYL
NITROLINGUAL
LUXIQ
PREDNICARBATE
ORSYTHIA
ADAPALENE
ALDACTAZIDE
TRUEPLUS INSULIN SYRINGE
BCG VACCINE (TICE STRAIN)
ZELAPAR
FENOGLIDE
CORTISPORIN
OMEPRAZOLE
BETAMETHASONE VALERATE
HYDROCORTISONE VALERATE
MYRBETRIQ
AMIODARONE HCL
ESTRADIOL-NORETHINDRONE ACETAT
PROTONIX
PAXIL CR
WELLBUTRIN SR
CARBIDOPA-LEVODOPA ER
MEGACE ES
BANZEL
LUPRON DEPOT
TEKTURNA HCT
ZYTIGA
RISPERDAL M-TAB
FOCALIN XR
ALTABAX
XYLOCAINE-MPF
PRENATE MINI
NUTROPIN AQ
PREVIDENT 5000 ENAMEL PROTECT
RETROVIR
RANITIDINE HCL
ABILIFY
COMBIVENT RESPIMAT
RANEXA
AMLODIPINE BESYLATE-BENAZEPRIL
TEKTURNA
DILTIAZEM HCL
CYCLOSPORINE MODIFIED
BUTALB-CAFF-ACETAMINOPH-CODEIN
ATROPINE SULFATE
MIACALCIN
LAMICTAL
EASY TOUCH
DIDANOSINE
PACLITAXEL
QUINIDINE GLUCONATE
BROMOCRIPTINE MESYLATE
APIDRA SOLOSTAR
ZEGERID
GILENYA
ZOSYN
PHENYTEK
PRINIVIL
PULMICORT
RELISTOR
NIACOR
AMLODIPINE-VALSARTAN
ARAVA
DIAMOX SEQUELS
STAXYN
EURAX
ARICEPT ODT
CYSTADANE
LORTAB
CARNITOR
AMBISOME
LESCOL
CARIMUNE NF NANOFILTERED
VARIVAX VACCINE
BETAPACE
IMURAN
JANTOVEN
TRAVATAN Z
TOVIAZ
TRADJENTA
ENABLEX
EXEMESTANE
ISOSORBIDE MONONITRATE
AMILORIDE HCL
DIPYRIDAMOLE
ONDANSETRON HCL
ADEFOVIR DIPIVOXIL
HUMULIN N KWIKPEN
GAVILYTE-G
BETIMOL
RIBAPAK
LO LOESTRIN FE
ERYPED 400
NARATRIPTAN HCL
LARIN FE
SINEMET CR
PREVIFEM
MAXALT MLT
FASLODEX
GENTAK
VANDAZOLE
SUBSYS
AMOXICILLIN-CLAVULANATE ER
MACRODANTIN
RAZADYNE ER
TETANUS DIPHTHERIA TOXOIDS
LEVAQUIN
TYVASO
INFANRIX DTAP
ZOLPIDEM TARTRATE
METOPROLOL TARTRATE
PRAVASTATIN SODIUM
IBANDRONATE SODIUM
HYDROCORTISONE
TOBRADEX
QVAR
DICLOFENAC SODIUM
DAPSONE
LORAZEPAM INTENSOL
VANOS
CYTRA-K
UNITHROID
ZANTAC
ESTROPIPATE
KENALOG
IMIQUIMOD
ATIVAN
FELBATOL
RILUZOLE
TIAZAC
ILEVRO
PHENYTOIN SODIUM
TACLONEX
GLUCOTROL XL
ANAFRANIL
HUMATROPE
BENLYSTA
AVANDARYL
PARNATE
TEVETEN
ZIRGAN
TWINRIX
CURITY AMD
ZMAX
TIGAN
RAMIPRIL
IBUPROFEN
FAMOTIDINE
NIFEDIPINE ER
SYNTHROID
LACTULOSE
DESMOPRESSIN ACETATE
ENDOCET
NOVOLOG FLEXPEN
JANUMET
KETOCONAZOLE
ALBUTEROL SULFATE
BUMETANIDE
HUMIRA
BD ULTRA-FINE PEN NEEDLE
SANTYL
CARISOPRODOL
INDOMETHACIN
ROZEREM
EPIVIR
BOOSTRIX TDAP
ZENPEP
DIPHENHYDRAMINE HCL
LOTRONEX
TEFLARO
CLOZARIL
VORICONAZOLE
ACAMPROSATE CALCIUM
ANTARA
CONCERTA
ENPRESSE
EPINEPHRINE
FALMINA
SOLODYN
TWYNSTA
ETIDRONATE DISODIUM
MOZOBIL
DEPEN
PROTONIX IV
TRIANEX
RAZADYNE
VINCASAR PFS
SILVER SULFADIAZINE
VOLTAREN
THEOPHYLLINE ANHYDROUS
ISOSORBIDE MONONITRATE ER
BENICAR HCT
METFORMIN HCL ER
GRISEOFULVIN ULTRAMICROSIZE
QUINAPRIL HCL
OXYCONTIN
BEPREVE
MYSOLINE
KAZANO
TELMISARTAN
WATER
KADIAN
JINTELI
ENJUVIA
REVATIO
CATAPRES-TTS 1
ZESTORETIC
REQUIP
TRILYTE WITH FLAVOR PACKETS
MODERIBA
PORTIA
VERELAN
STALEVO 150
CLINDAMYCIN PEDIATRIC
VEXOL
RECLAST
BLEPHAMIDE
ZOFRAN
LEVETIRACETAM
SPIRONOLACTONE
CADUET
IRBESARTAN-HYDROCHLOROTHIAZIDE
KLOR-CON 10
GLIPIZIDE-METFORMIN
TENORMIN
MODAFINIL
ONGLYZA
ZOMETA
XALATAN
NALTREXONE HCL
COSOPT PF
DISOPYRAMIDE PHOSPHATE
SORIATANE
SANCTURA XR
ZORTRESS
VIVITROL
ELINEST
LYSODREN
PERSANTINE
SOMA
OXACILLIN SODIUM
DEXTROSE 5%-0.9% NACL
DOXYCYCLINE HYCLATE
LEVOFLOXACIN
NITROFURANTOIN
HUMULIN R
CLOBEX
SECTRAL
PRILOSEC
PEG 3350-ELECTROLYTE
INDAPAMIDE
UCERIS
INVOKANA
PAMIDRONATE DISODIUM
VISTARIL
KINERET
NUTROPIN AQ NUSPIN
CRINONE
BUPHENYL
STAVZOR
ULTRA-THIN II
CARBINOXAMINE MALEATE
EPIDUO
E.E.S. 400
BUDEPRION XL
WERA
KLOR-CON M20
METHADONE HCL
TORSEMIDE
DICLOFENAC SODIUM-MISOPROSTOL
ISENTRESS
ALFUZOSIN HCL ER
HYDROXYUREA
OXCARBAZEPINE
OMEPRAZOLE-SODIUM BICARBONATE
FANAPT
FAZACLO
SPRYCEL
METHYCLOTHIAZIDE
CAMPRAL
FENTANYL CITRATE
SEVELAMER CARBONATE
GLEEVEC
AVALIDE
GELNIQUE
LASTACAFT
BYDUREON
ZYPREXA RELPREVV
VELIVET
MAPROTILINE HCL
ZOLADEX
ZOCOR
RYTHMOL SR
ISOPTO CARPINE
NESINA
METIPRANOLOL
PAREGORIC
FML FORTE
FLAVOXATE HCL
CATAPRES-TTS 3
URSO FORTE
CALAN
PROMETHEGAN
ZARAH
BRIELLYN
RETIN-A
SEMPREX-D
PRENATAL VITAMINS LOW IRON
GILDAGIA
TRIAMTERENE-HYDROCHLOROTHIAZID
KOMBIGLYZE XR
SINGLE USE SWAB
FLUDROCORTISONE ACETATE
AVAPRO
VIGAMOX
INVEGA SUSTENNA
ZIOPTAN
FOSINOPRIL-HYDROCHLOROTHIAZIDE
NICARDIPINE HCL
ALCOHOL PREP SWABS
DEXTROAMPHETAMINE-AMPHET ER
ABILIFY DISCMELT
DEPAKENE
PREDNISOLONE
LORYNA
WELLBUTRIN
POTIGA
FARXIGA
CUVPOSA
CURITY ALCOHOL PREPS
FIORINAL WITH CODEINE #3
HECORIA
CHENODAL
NITROGLYCERIN PATCH
COMBIPATCH
LEVOCETIRIZI
Query:
SELECT "drug_name", SUM("total_claim_count") AS total_claims
   FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
   WHERE "nppes_provider_state" = 'NY'
   GROUP BY "drug_name"
   ORDER BY total_claims DESC
   LIMIT 1000;
Answer:
Too long, hard cut:
drug_name,TOTAL_CLAIMS
AMLODIPINE BESYLATE,2606392
SIMVASTATIN,2483824
ATORVASTATIN CALCIUM,2343736
OMEPRAZOLE,2158771
LEVOTHYROXINE SODIUM,2091879
LISINOPRIL,1878852
FUROSEMIDE,1604273
METOPROLOL SUCCINATE,1497362
METFORMIN HCL,1483466
METOPROLOL TARTRATE,1476125
LOSARTAN POTASSIUM,1179068
HYDROCHLOROTHIAZIDE,1177844
GABAPENTIN,1063477
WARFARIN SODIUM,1037689
CLOPIDOGREL,1027289
TAMSULOSIN HCL,950300
CRESTOR,902634
ATENOLOL,872477
ZOLPIDEM TARTRATE,740031
CARVEDILOL,711856
SERTRALINE HCL,702641
NEXIUM,675301
HYDROCODONE-ACETAMINOPHEN,669509
PRAVASTATIN SODIUM,662043
PANTOPRAZOLE SODIUM,616877
FLUTICASONE PROPIONATE,579662
PREDNISONE,562097
DONEPEZIL HCL,521804
ALENDRONATE SODIUM,521736
PROAIR HFA,520129
MONTELUKAST SODIUM,518027
ENALAPRIL MALEATE,516231
LATANOPROST,508505
JANUVIA,508330
CITALOPRAM HBR,498268
ADVAIR DISKUS,483391
ALPRAZOLAM,478214
POTASSIUM CHLORIDE,457448
SYNTHROID,453791
QUETIAPINE FUMARATE,447257
ESCITALOPRAM OXALATE,446888
TRAZODONE HCL,441018
OXYCODONE-ACETAMINOPHEN,433851
CLONAZEPAM,430536
RANITIDINE HCL,422992
LOSARTAN-HYDROCHLOROTHIAZIDE,412328
ALLOPURINOL,408017
SPIRIVA,404803
AZITHROMYCIN,394490
MELOXICAM,383651
MIRTAZAPINE,383213
FINASTERIDE,378878
TRAMADOL HCL,364355
DIOVAN,358834
GLIMEPIRIDE,358155
DULOXETINE HCL,357225
ISOSORBIDE MONONITRATE ER,346521
RAMIPRIL,343510
LANTUS SOLOSTAR,343009
AMOXICILLIN,340811
RISPERIDONE,340499
CIPROFLOXACIN HCL,338454
NAMENDA,320510
LORAZEPAM,317161
METFORMIN HCL ER,306073
IBUPROFEN,302979
LISINOPRIL-HYDROCHLOROTHIAZIDE,299542
VALSARTAN-HYDROCHLOROTHIAZIDE,283681
FAMOTIDINE,278964
VOLTAREN,278509
AMMONIUM LACTATE,277683
PAROXETINE HCL,268093
GLIPIZIDE,255509
OXYCODONE HCL,255226
FENOFIBRATE,253225
FLUOXETINE HCL,252205
SPIRONOLACTONE,246063
NIFEDIPINE ER,245644
LEVETIRACETAM,232951
HYDRALAZINE HCL,229279
LOVASTATIN,225838
POLYETHYLENE GLYCOL 3350,224730
OLANZAPINE,224053
LYRICA,220106
ZETIA,214969
ABILIFY,209738
VENLAFAXINE HCL ER,207255
SYMBICORT,201916
LEVOFLOXACIN,200878
NAPROXEN,199601
AMLODIPINE BESYLATE-BENAZEPRIL,195625
CELEBREX,194637
LOVAZA,194003
LUMIGAN,193751
CLONIDINE HCL,184816
DIVALPROEX SODIUM,181189
TRIAMCINOLONE ACETONIDE,180960
LAMOTRIGINE,178665
TRIAMTERENE-HYDROCHLOROTHIAZID,178524
XARELTO,177758
BENZTROPINE MESYLATE,177116
BUPROPION XL,177098
CARBIDOPA-LEVODOPA,176483
BD ULTRA-FINE PEN NEEDLE,174415
PREDNISOLONE ACETATE,172342
LANTUS,171652
DILTIAZEM 24HR ER,168681
VENTOLIN HFA,167376
AMOX TR-POTASSIUM CLAVULANATE,167204
LIDOCAINE,166872
MECLIZINE HCL,165798
TIMOLOL MALEATE,157757
DORZOLAMIDE-TIMOLOL,155438
SULFAMETHOXAZOLE-TRIMETHOPRIM,153797
TRAVATAN Z,151135
CLOBETASOL PROPIONATE,151077
JANUMET,150537
OXYBUTYNIN CHLORIDE ER,148582
QUINAPRIL HCL,147391
BYSTOLIC,147198
PIOGLITAZONE HCL,145249
BUSPIRONE HCL,143422
RESTASIS,141964
BACLOFEN,140937
AMITRIPTYLINE HCL,140699
GLIPIZIDE ER,140394
DIAZEPAM,139279
DOXAZOSIN MESYLATE,138825
CEPHALEXIN,137706
MUPIROCIN,135100
DIGOX,134514
DIGOXIN,133812
AVODART,133353
CHLORHEXIDINE GLUCONATE,132311
LACTULOSE,128404
GLIPIZIDE XL,126744
TOPIRAMATE,126476
COMBIGAN,126296
BENICAR,125746
FENTANYL,123240
DIVALPROEX SODIUM ER,123218
VESICARE,122059
HUMALOG,119543
LABETALOL HCL,119449
ACETAMINOPHEN-CODEINE,117625
DEXILANT,116409
METHOTREXATE,116118
IRBESARTAN,115758
CLOZAPINE,109610
NOVOLOG FLEXPEN,108274
KETOCONAZOLE,105255
CICLOPIROX,104434
HALOPERIDOL,103663
PRADAXA,101573
PATADAY,101163
DILTIAZEM 24HR CD,101139
ALPHAGAN P,100973
KLOR-CON M20,100814
CLOTRIMAZOLE-BETAMETHASONE,100714
CYCLOBENZAPRINE HCL,100707
LIDODERM,99510
BRIMONIDINE TARTRATE,98842
LANSOPRAZOLE,98791
CHLORTHALIDONE,96841
NYSTATIN,96655
METHYLPREDNISOLONE,96266
NAMENDA XR,95581
DOXYCYCLINE HYCLATE,95531
LEVEMIR FLEXPEN,94262
VERAPAMIL ER,93009
NASONEX,92831
TERAZOSIN HCL,92683
RANEXA,89604
FLUOCINONIDE,88073
COLCRYS,87328
BENAZEPRIL HCL,85024
TIZANIDINE HCL,84681
TORSEMIDE,83979
GEMFIBROZIL,82491
BUPROPION HCL SR,81924
ECONAZOLE NITRATE,81847
HYDROXYCHLOROQUINE SULFATE,81124
ROPINIROLE HCL,80150
DICLOFENAC SODIUM,79801
BENICAR HCT,78764
AZELASTINE HCL,78567
VALSARTAN,78447
OXYBUTYNIN CHLORIDE,78428
MORPHINE SULFATE ER,77889
OXYCONTIN,77360
RALOXIFENE HCL,76707
SINGLE USE SWAB,76172
CLOTRIMAZOLE,75585
NITROSTAT,75561
EXELON,74714
AMIODARONE HCL,74637
NIFEDICAL XL,73128
GLYBURIDE,73043
TOPROL XL,72958
VALACYCLOVIR,72509
PROPRANOLOL HCL,72042
ANASTROZOLE,71546
KETOROLAC TROMETHAMINE,70687
ALBUTEROL SULFATE,66127
CREON,64598
COMBIVENT RESPIMAT,64509
TRADJENTA,63702
FLOVENT HFA,63459
NORVIR,62431
CARBAMAZEPINE,61858
METOCLOPRAMIDE HCL,61183
HYDROCORTISONE,60622
ALCOHOL PADS,60215
IPRATROPIUM-ALBUTEROL,60122
CALCITRIOL,59890
JANTOVEN,59842
FOSINOPRIL SODIUM,59739
IPRATROPIUM BROMIDE,59553
HYDROXYZINE HCL,59365
RAPAFLO,58620
NORTRIPTYLINE HCL,57921
METRONIDAZOLE,57609
LITHIUM CARBONATE,56866
PATANOL,56786
SEROQUEL XR,55802
TRUVADA,55534
IBANDRONATE SODIUM,54573
NITROFURANTOIN MONO-MACRO,53554
PHENYTOIN SODIUM EXTENDED,52949
INSULIN SYRINGE,52550
FLUCONAZOLE,52522
CILOSTAZOL,52479
COUMADIN,52376
VIGAMOX,52295
OMEGA-3 ACID ETHYL
Query:
SELECT "drug_name", SUM("total_claim_count") AS total_claims
   FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
   WHERE "nppes_provider_state" = 'NY'
   GROUP BY "drug_name"
   ORDER BY total_claims DESC
   LIMIT 1;
Answer:
drug_name,TOTAL_CLAIMS
AMLODIPINE BESYLATE,2606392
Query:
SELECT
  "nppes_provider_state",
  SUM("total_claim_count") AS total_claims,
  SUM("total_drug_cost") AS total_drug_cost
FROM
  CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
WHERE
  "drug_name" ILIKE '%AMLODIPINE%'
GROUP BY
  "nppes_provider_state"
ORDER BY
  total_claims DESC
LIMIT 5;
Answer:
nppes_provider_state,TOTAL_CLAIMS,TOTAL_DRUG_COST
CA,3870269,43033042.41000001
FL,2843844,29839003.14
NY,2806380,32944466.709999993
TX,2390753,29464270.749999996
PA,1913463,24588408.479999997
Query:
SELECT
  "nppes_provider_state",
  SUM("total_claim_count") AS total_claims,
  SUM("total_drug_cost") AS total_drug_cost
FROM
  CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
WHERE
  "generic_name" ILIKE '%AMLODIPINE%'
GROUP BY
  "nppes_provider_state"
ORDER BY
  total_claims DESC
LIMIT 5;
Answer:
nppes_provider_state,TOTAL_CLAIMS,TOTAL_DRUG_COST
CA,3971256,65183100.970000006
NY,2903522,56020095.04999999
FL,2901721,43686941.95
TX,2479191,51779688.779999994
PA,1952101,33267682.33
Query:
SELECT
  "nppes_provider_state",
  SUM("total_claim_count") AS total_claims,
  SUM("total_drug_cost") AS total_drug_cost
FROM
  CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
WHERE
  "drug_name" = 'AMLODIPINE BESYLATE'
GROUP BY
  "nppes_provider_state"
ORDER BY
  total_claims DESC
LIMIT 5;
Answer:
nppes_provider_state,TOTAL_CLAIMS,TOTAL_DRUG_COST
CA,3725846,35073534.86999999
FL,2689327,21046051.190000005
NY,2606392,20729281.25
TX,2212275,17513523.7
PA,1760543,14121212.74
Query:
SELECT
  "nppes_provider_state",
  SUM("total_claim_count") AS total_claims,
  SUM("total_drug_cost") AS total_drug_cost
FROM
  CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
GROUP BY
  "nppes_provider_state"
ORDER BY
  total_claims DESC
LIMIT 5;
Answer:
nppes_provider_state,TOTAL_CLAIMS,TOTAL_DRUG_COST
CA,116440694,9633494580.829994
FL,91441123,6969574542.380001
NY,79570924,7521861271.36
TX,75682169,6462480867.61
PA,62946334,4841813377.080001
Query:
SELECT
  "nppes_provider_state",
  SUM("total_claim_count") AS total_claims,
  SUM("total_drug_cost") AS total_drug_cost
FROM
  CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
WHERE
  "drug_name" = (
    SELECT
      "drug_name"
    FROM
      CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
    WHERE
      "nppes_provider_state" = 'NY'
    GROUP BY
      "drug_name"
    ORDER BY
      SUM("total_claim_count") DESC
    LIMIT 1
  )
GROUP BY
  "nppes_provider_state"
ORDER BY
  total_claims DESC
LIMIT 5;
Answer:
nppes_provider_state,TOTAL_CLAIMS,TOTAL_DRUG_COST
CA,3725846,35073534.87000001
FL,2689327,21046051.18999999
NY,2606392,20729281.250000007
TX,2212275,17513523.7
PA,1760543,14121212.739999998
Query:
SELECT
  "nppes_provider_state" AS state,
  SUM("total_claim_count") AS total_claims,
  SUM("total_drug_cost") AS total_drug_cost
FROM
  CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
WHERE
  "drug_name" = 'LISINOPRIL'
GROUP BY
  "nppes_provider_state"
ORDER BY
  total_claims DESC
LIMIT 5;
Answer:
STATE,TOTAL_CLAIMS,TOTAL_DRUG_COST
CA,3328132,28081799.270000007
FL,2871093,18765053.880000006
TX,2351958,18193331.150000002
PA,2033522,13881711.110000003
NY,1878852,12129540.519999996
Query:
SELECT
  "nppes_provider_state" AS state,
  SUM("total_claim_count") AS total_claim_count,
  SUM("total_drug_cost") AS total_drug_cost
FROM
  CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
WHERE
  "drug_name" = (
    SELECT
      "drug_name"
    FROM
      CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
    WHERE
      "nppes_provider_state" = 'NY'
    GROUP BY
      "drug_name"
    ORDER BY
      SUM("total_claim_count") DESC
    LIMIT 1
  )
GROUP BY
  "nppes_provider_state"
ORDER BY
  total_claim_count DESC
LIMIT 5;
Answer:
STATE,TOTAL_CLAIM_COUNT,TOTAL_DRUG_COST
CA,3725846,35073534.87
FL,2689327,21046051.19
NY,2606392,20729281.25
TX,2212275,17513523.700000003
PA,1760543,14121212.739999995
Query:
SELECT "drug_name", SUM("total_drug_cost") AS total_cost
    FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
    WHERE "nppes_provider_state" = 'NY'
    GROUP BY "drug_name"
    ORDER BY total_cost DESC
    LIMIT 1000;
Answer:
Too long, hard cut:
drug_name,TOTAL_COST
CRESTOR,249327097.41000006
SOVALDI,230243170.38999996
NEXIUM,214788833.78999996
JANUVIA,194438475.11999995
ABILIFY,181274610.41000003
ADVAIR DISKUS,180060546.19
SPIRIVA,150863384.09000006
LANTUS SOLOSTAR,148985758.75000003
REVLIMID,107219280.91000003
NAMENDA,83872328.88000003
ENBREL,81570443.92
COPAXONE,79486041.01999998
DIOVAN,78426639.23
TRUVADA,72683222.99
HUMIRA,72616484.42999996
DULOXETINE HCL,71719393.03
LYRICA,66070666.269999996
XARELTO,64782309.81000001
ZETIA,63663933.770000026
RESTASIS,63575130.73000001
LANTUS,61681575.25
SYMBICORT,59867832.10999999
CELEBREX,59071901.580000006
METOPROLOL SUCCINATE,57766641.46000001
OLYSIO,55122556.599999994
JANUMET,55056829.46000001
ATRIPLA,54860236.31000001
ATORVASTATIN CALCIUM,53943714.92999999
GLEEVEC,51117573.96000001
HUMALOG,48263419.920000024
NOVOLOG FLEXPEN,48213346.3
ISENTRESS,47487933.48999999
LOVAZA,45890986.80000001
SENSIPAR,45096677.93
TECFIDERA,42576237.599999994
OXYCONTIN,42112905.26999998
LIDODERM,40911216.23
RENVELA,40821118.470000006
PREZISTA,40812033.79
HARVONI,40439111.24999999
LIDOCAINE,40209597.260000005
ZYTIGA,40067382.019999996
PRADAXA,40056632.84
LEVEMIR FLEXPEN,38206535.82000001
LEVOTHYROXINE SODIUM,37782511.410000004
LUMIGAN,34801637.980000004
VESICARE,34509594.03
RANEXA,32636829.85000001
SEROQUEL XR,32380961.62000001
REYATAZ,32013003.349999998
OMEPRAZOLE,31535545.88
VICTOZA 3-PAK,30027173.900000002
PROAIR HFA,29455596.169999998
EXELON,29194113.79
TARCEVA,29140341.820000008
CREON,27937813.83000001
AVODART,27472993.95000001
CLOPIDOGREL,27348175.680000003
EPZICOM,26709837.58
NAMENDA XR,25983794.510000005
LETAIRIS,25902094.29
DEXILANT,25676366.45
BENICAR,25443543.999999993
PROCRIT,25153769.130000003
TRAVATAN Z,24771707.95999999
OLANZAPINE,24613230.34
QUETIAPINE FUMARATE,24296346.749999996
AVONEX,24095960.07
TRADJENTA,23621812.800000004
FENOFIBRATE,23577113.289999995
XTANDI,22975633.200000007
SIMVASTATIN,22966671.890000004
GAMMAGARD LIQUID,22137393.640000004
H.P. ACTHAR,22109154.050000004
TAMSULOSIN HCL,21594947.830000006
AVONEX PEN,21381695.330000002
TRACLEER,21115983.340000004
OXYCODONE-ACETAMINOPHEN,21104760.019999996
DIVALPROEX SODIUM ER,21020703.65
PRAVASTATIN SODIUM,20913612.590000004
NORVIR,20754231.05
AMLODIPINE BESYLATE,20729281.25
COMBIVENT RESPIMAT,20700370.279999997
VIREAD,20304233.08
GABAPENTIN,20300069.88
VOLTAREN,19943125.9
WELCHOL,19644395.279999997
BYSTOLIC,19561871.960000005
COLCRYS,19379766.749999993
NOVOLOG MIX 70-30 FLEXPEN,19346065.25
SYNTHROID,19280530.58000001
FORTEO,19164627.519999996
COMBIGAN,18785901.629999995
ENOXAPARIN SODIUM,17958707.12
HYDROCODONE-ACETAMINOPHEN,17544090.790000003
NASONEX,17455648.05
COMPLERA,17237542.63
RALOXIFENE HCL,17232401.169999994
ELIQUIS,17225348.980000004
ALPHAGAN P,17197571.570000004
ONGLYZA,17097443.66
CLOBETASOL PROPIONATE,17034813.120000005
STRIBILD,16736289.4
LATUDA,16714844.340000002
LOSARTAN POTASSIUM,16707068.969999999
REBIF,16471064.78
BENICAR HCT,16365516.01
FENTANYL,16106482.22
VALSARTAN,16003284.719999997
VYTORIN,15631262.600000001
INVEGA SUSTENNA,15577263.82
FLOVENT HFA,15417080.719999999
DONEPEZIL HCL,15253989.270000009
PATADAY,15244739.37
AGGRENOX,15219900.720000003
GAMUNEX-C,14807257.29
NOVOLOG,14675388.849999998
VALSARTAN-HYDROCHLOROTHIAZIDE,14637686.239999998
AMITIZA,14614131.219999999
GILENYA,14583050.46
OXYCODONE HCL,14576462.04
MONTELUKAST SODIUM,14196241.42
XIFAXAN,13925425.670000002
IMBRUVICA,13594120.349999996
AZILECT,13095812.930000002
EVISTA,12826356.570000002
POTASSIUM CHLORIDE,12816403.470000006
VIMPAT,12466537.830000002
MYRBETRIQ,12435013.940000001
METFORMIN HCL,12377618.14
HUMALOG MIX 75-25,12168255.44
LISINOPRIL,12129540.519999996
RAPAFLO,11860292.840000004
AFINITOR,11842201.230000002
AMPYRA,11729545.72
VALCYTE,11694943.840000002
PROLIA,11647358.109999998
METFORMIN HCL ER,11580778.149999999
DICLOFENAC SODIUM,11575983.980000002
ADCIRCA,11298534.26
AMLODIPINE BESYLATE-BENAZEPRIL,11121216.639999997
WARFARIN SODIUM,11100457.570000004
INTELENCE,11013016.680000003
SANTYL,10946240.519999998
JAKAFI,10902051.39
INVOKANA,10842460.52
LEVEMIR,10820001.460000003
OMEGA-3 ACID ETHYL ESTERS,10777016.41
INVEGA,10755982.930000002
FLUTICASONE PROPIONATE,10629640.18
PREDNISOLONE ACETATE,10501226.980000006
NIACIN ER,10420729.769999996
ULORIC,10399172.719999999
MULTAQ,10351336.500000004
PIOGLITAZONE HCL,10267115.029999997
EXFORGE,10256804.230000002
RISPERDAL CONSTA,10206885.15
PANTOPRAZOLE SODIUM,10186062.680000002
PREMARIN,10150921.78
TASIGNA,10099062.060000002
POMALYST,10085754.04
CLOZAPINE,10046192.16
METOPROLOL TARTRATE,9967777.96
NIFEDIPINE ER,9949490.360000003
PATANOL,9637933.740000004
ESCITALOPRAM OXALATE,9584397.980000002
LATANOPROST,9357466.48
MORPHINE SULFATE ER,9315240.060000002
LIALDA,9218202.669999998
TIVICAY,9160245.05
ACTONEL,9125216.94
SUBOXONE,9123378.790000001
OXYBUTYNIN CHLORIDE ER,9084748.639999999
METHOTREXATE,9060760.379999999
ANDROGEL,8960305.68
AZOR,8950289.61
ZOSTAVAX,8891298.76
AUBAGIO,8873366.209999999
BARACLUDE,8852746.04
AZOPT,880
Query:
SELECT "generic_name", SUM("total_claim_count") AS total_claims
    FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
    WHERE "nppes_provider_state" = 'NY'
    GROUP BY "generic_name"
    ORDER BY total_claims DESC
    LIMIT 1000;
Answer:
Too long, hard cut:
generic_name,TOTAL_CLAIMS
AMLODIPINE BESYLATE,2609790
LEVOTHYROXINE SODIUM,2548186
SIMVASTATIN,2484445
ATORVASTATIN CALCIUM,2352946
OMEPRAZOLE,2159111
LISINOPRIL,1879348
METFORMIN HCL,1795394
FUROSEMIDE,1604771
METOPROLOL SUCCINATE,1570320
METOPROLOL TARTRATE,1476125
LOSARTAN POTASSIUM,1180518
HYDROCHLOROTHIAZIDE,1177855
WARFARIN SODIUM,1149907
GABAPENTIN,1067927
CLOPIDOGREL BISULFATE,1038082
TAMSULOSIN HCL,952628
ROSUVASTATIN CALCIUM,902634
ATENOLOL,873106
ZOLPIDEM TARTRATE,775980
ALBUTEROL SULFATE,775194
CARVEDILOL,712969
SERTRALINE HCL,703789
ESOMEPRAZOLE MAGNESIUM,675301
HYDROCODONE/ACETAMINOPHEN,674906
PRAVASTATIN SODIUM,662228
FLUTICASONE PROPIONATE,648356
POTASSIUM CHLORIDE,638713
PANTOPRAZOLE SODIUM,619762
PREDNISONE,562181
DONEPEZIL HCL,526245
GLIPIZIDE,523087
ALENDRONATE SODIUM,522254
MONTELUKAST SODIUM,520755
ENALAPRIL MALEATE,516445
"INSULIN GLARGINE,HUM.REC.ANLOG",514661
LATANOPROST,512353
SITAGLIPTIN PHOSPHATE,508330
QUETIAPINE FUMARATE,505170
FLUTICASONE/SALMETEROL,501843
CITALOPRAM HYDROBROMIDE,498709
ALPRAZOLAM,483165
OXYCODONE HCL/ACETAMINOPHEN,465082
ESCITALOPRAM OXALATE,450632
TRAZODONE HCL,441128
VALSARTAN,437281
CLONAZEPAM,430660
RANITIDINE HCL,423347
MEMANTINE HCL,416091
LOSARTAN/HYDROCHLOROTHIAZIDE,413422
ALLOPURINOL,408043
TIOTROPIUM BROMIDE,404803
AZITHROMYCIN,399475
MELOXICAM,383749
MIRTAZAPINE,383410
DICLOFENAC SODIUM,380185
FINASTERIDE,379228
DULOXETINE HCL,372416
TRAMADOL HCL,370487
DILTIAZEM HCL,367454
GLIMEPIRIDE,358790
ISOSORBIDE MONONITRATE,352541
RISPERIDONE,344353
RAMIPRIL,344315
AMOXICILLIN,340811
CIPROFLOXACIN HCL,338754
OXYCODONE HCL,332869
NIFEDIPINE,321233
LORAZEPAM,317996
DIVALPROEX SODIUM,311476
IBUPROFEN,302979
LISINOPRIL/HYDROCHLOROTHIAZIDE,299631
VALSARTAN/HYDROCHLOROTHIAZIDE,287677
BUPROPION HCL,285131
AMMONIUM LACTATE,283490
FAMOTIDINE,278563
DIGOXIN,271702
PAROXETINE HCL,268902
"NEEDLES, INSULIN DISPOSABLE",266720
LIDOCAINE,266382
FLUOXETINE HCL,253967
LEVETIRACETAM,247216
SPIRONOLACTONE,246184
OMEGA-3 ACID ETHYL ESTERS,245783
VENLAFAXINE HCL,239132
OLANZAPINE,238540
HYDRALAZINE HCL,229279
OXYBUTYNIN CHLORIDE,227978
LOVASTATIN,225862
POLYETHYLENE GLYCOL 3350,224730
PREGABALIN,220106
ALCOHOL ANTISEPTIC PADS,215078
EZETIMIBE,214969
ARIPIPRAZOLE,212261
CARBIDOPA/LEVODOPA,208989
BUDESONIDE/FORMOTEROL FUMARATE,201916
LEVOFLOXACIN,200903
BRIMONIDINE TARTRATE,199838
NAPROXEN,199601
AMLODIPINE BESYLATE/BENAZEPRIL,196339
CELECOXIB,194696
BIMATOPROST,193751
LAMOTRIGINE,193210
CLONIDINE HCL,185016
TRIAMCINOLONE ACETONIDE,181850
TRIAMTERENE/HYDROCHLOROTHIAZID,178842
RIVAROXABAN,177758
BENZTROPINE MESYLATE,177116
PREDNISOLONE ACETATE,174496
AMOXICILLIN/POTASSIUM CLAV,167479
MECLIZINE HCL,165798
TIMOLOL MALEATE,161653
SITAGLIPTIN PHOS/METFORMIN HCL,161377
OLOPATADINE HCL,160355
DORZOLAMIDE HCL/TIMOLOL MALEAT,157027
SULFAMETHOXAZOLE/TRIMETHOPRIM,153797
INSULIN ASPART,151854
CLOBETASOL PROPIONATE,151332
TRAVOPROST,151135
MOMETASONE FUROATE,149166
QUINAPRIL HCL,147678
NEBIVOLOL HCL,147198
LACTULOSE,146253
PIOGLITAZONE HCL,145807
INSULIN DETEMIR,143447
BUSPIRONE HCL,143422
CYCLOSPORINE,142265
BACLOFEN,140937
AMITRIPTYLINE HCL,140699
DIAZEPAM,139707
DOXAZOSIN MESYLATE,139134
CEPHALEXIN,137706
NYSTATIN,133630
DUTASTERIDE,133353
CHLORHEXIDINE GLUCONATE,132732
TOPIRAMATE,129840
MUPIROCIN,126924
BRIMONIDINE TARTRATE/TIMOLOL,126296
OLMESARTAN MEDOXOMIL,125746
FENTANYL,125033
IPRATROPIUM/ALBUTEROL SULFATE,124631
RALOXIFENE HCL,124196
SOLIFENACIN SUCCINATE,122059
NITROGLYCERIN,119828
INSULIN LISPRO,119543
LABETALOL HCL,119449
ACETAMINOPHEN WITH CODEINE,117721
FENOFIBRATE NANOCRYSTALLIZED,117501
IRBESARTAN,117176
DEXLANSOPRAZOLE,116409
METHOTREXATE SODIUM,116317
CLOZAPINE,116066
HYDROCORTISONE,111330
MORPHINE SULFATE,110212
VERAPAMIL HCL,109123
PROPRANOLOL HCL,108370
LANSOPRAZOLE,105320
KETOCONAZOLE,105280
HALOPERIDOL,103651
DABIGATRAN ETEXILATE MESYLATE,101573
CYCLOBENZAPRINE HCL,100913
CLOTRIMAZOLE/BETAMETHASONE DIP,100737
CHLORTHALIDONE,96841
METHYLPREDNISOLONE,96408
DOXYCYCLINE HYCLATE,95623
TERAZOSIN HCL,92683
RANOLAZINE,89604
FLUOCINONIDE,88100
COLCHICINE,87328
CARBAMAZEPINE,86929
BENAZEPRIL HCL,85059
TIZANIDINE HCL,84772
TORSEMIDE,83979
FENOFIBRATE,83924
GEMFIBROZIL,82491
AZELASTINE HCL,82086
ECONAZOLE NITRATE,81847
HYDROXYCHLOROQUINE SULFATE,81410
ROPINIROLE HCL,80686
LITHIUM CARBONATE,80525
OLMESARTAN/HYDROCHLOROTHIAZIDE,78764
IPRATROPIUM BROMIDE,77083
AMIODARONE HCL,75771
CLOTRIMAZOLE,75585
ESTRADIOL,74801
RIVASTIGMINE,74643
GLYBURIDE,73055
VALACYCLOVIR HCL,72957
ANASTROZOLE,71935
LIPASE/PROTEASE/AMYLASE,71805
KETOROLAC TROMETHAMINE,70711
PHENYTOIN SODIUM EXTENDED,68171
LINAGLIPTIN,63702
RITONAVIR,62431
METOCLOPRAMIDE HCL,61196
CALCITRIOL,60110
FOSINOPRIL SODIUM,59739
HYDROXYZINE HCL,59365
SUCRALFATE,58880
SILODOSIN,58620
NORTRIPTYLINE HCL,58030
METRONIDAZOLE,57624
SILVER SULFADIAZINE,57379
MOXIFLOXACIN HCL,57197
CICLOPIROX OLAMINE,57133
SEVELAMER CARBONATE,57010
IBANDRONATE SODIUM,55710
EMTRICITABINE/TENOFOVIR,55534
RISEDRONATE SODIUM,54361
NITROFURANTOIN MONOHYD/M-CRYST,535
End Exploring Related Columns
Task: For the drug with the highest total number of prescriptions in New York State during 2014, could you list the top five states with the highest total claim counts for this drug? Please also include their total claim counts and total drug costs. 

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: SELECT S."Column_Name" FROM {Database Name}.{Schema Name}.{Table_name} (ensure all column names are enclosed in double quotations)
Follow the answer format like: The drug with the highest total number of prescriptions in New York State during 2014 is **Drug_X**. The top five states with the highest total claim counts for **Drug_X** are:

```csv
state,total_claim_count,total_drug_cost
State_A,int,float
State_B,int,float
State_C,int,float
State_D,int,float
State_E,int,float
```.
Here are some useful tips for answering:
When calculating distances between two geometries, use `ST_MakePoint(x, y)` to make a point and `ST_Distance(geometry1 GEOMETRY, geometry2 GEOMETRY)` to compute. No need to convert from meters to miles unless requested. Don't use Haversine like 2 * 6371000 * ASIN(...), use ST_DISTANCE for more precise results.
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'CMS_DATA': {'CMS_CODES': ['HCPCS', 'ICD10_DIAGNOSES_2019', 'ICD10_PROCEDURES_2019', 'ICD9_DIAGNOSES', 'ICD9_PROCEDURES'], 'CMS_MEDICARE': ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014', 'HOSPICE_PROVIDERS_2014', 'HOSPITAL_GENERAL_INFO', 'INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2015', 'NURSING_FACILITIES_2013', 'NURSING_FACILITIES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2015', 'PART_D_PRESCRIBER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014'], 'CMS_SYNTHETIC_PATIENT_DATA_OMOP': ['CARE_SITE', 'CONCEPT', 'CONCEPT_ANCESTOR', 'CONCEPT_CLASS', 'CONCEPT_RELATIONSHIP', 'CONDITION_ERA', 'CONDITION_OCCURRENCE', 'COST', 'DEATH', 'DEVICE_EXPOSURE', 'DOMAIN', 'DOSE_ERA', 'DRUG_ERA', 'DRUG_EXPOSURE', 'DRUG_STRENGTH', 'LOCATION', 'OBSERVATION', 'OBSERVATION_PERIOD', 'PAYER_PLAN_PERIOD', 'PERSON', 'PROCEDURE_OCCURRENCE', 'PROVIDER', 'RELATIONSHIP', 'VOCABULARY']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'
When handling TO_TIMESTAMP_NTZ conversions, use query like: SELECT CASE WHEN "date" >= 1e15 THEN TO_TIMESTAMP_NTZ("date" / 1000000) WHEN "date" >= 1e12 THEN TO_TIMESTAMP_NTZ("date" / 1000) ELSE TO_TIMESTAMP_NTZ("date") END AS parsed_timestamp FROM my_table;
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
Keep all decimals to four decimal places.

2025-01-16 16:27:47 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 16:27:47 - root - INFO - ```sql
SELECT
  "nppes_provider_state" AS state,
  SUM("total_claim_count") AS total_claim_count,
  SUM("total_drug_cost") AS total_drug_cost
FROM
  CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
WHERE
  "drug_name" = (
    SELECT "drug_name"
    FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
    WHERE "nppes_provider_state" = 'NY'
    GROUP BY "drug_name"
    ORDER BY SUM("total_claim_count") DESC
    LIMIT 1
  )
GROUP BY
  "nppes_provider_state"
ORDER BY
  total_claim_count DESC
LIMIT 5;
```
2025-01-16 16:27:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 16:27:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 16:27:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 16:27:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-16 16:27:49 - snowflake.connector.connection - INFO - closed
2025-01-16 16:27:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 16:27:49 - root - INFO - itercount: 1
2025-01-16 16:27:49 - root - INFO - 0
2025-01-16 16:27:49 - root - INFO - results: 
STATE,TOTAL_CLAIM_COUNT,TOTAL_DRUG_COST
CA,3725846,35073534.87
FL,2689327,21046051.19
NY,2606392,20729281.25
TX,2212275,17513523.700000003
PA,1760543,14121212.739999995


2025-01-16 16:27:49 - root - INFO - Please check the answer again by reviewing For the drug with the highest total number of prescriptions in New York State during 2014, could you list the top five states with the highest total claim counts for this drug? Please also include their total claim counts and total drug costs. , reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: The drug with the highest total number of prescriptions in New York State during 2014 is **Drug_X**. The top five states with the highest total claim counts for **Drug_X** are:

```csv
state,total_claim_count,total_drug_cost
State_A,int,float
State_B,int,float
State_C,int,float
State_D,int,float
State_E,int,float
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
STATE,TOTAL_CLAIM_COUNT,TOTAL_DRUG_COST
CA,3725846,35073534.87
FL,2689327,21046051.19
NY,2606392,20729281.25
TX,2212275,17513523.700000003
PA,1760543,14121212.739999995
Current sql:
SELECT
  "nppes_provider_state" AS state,
  SUM("total_claim_count") AS total_claim_count,
  SUM("total_drug_cost") AS total_drug_cost
FROM
  CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
WHERE
  "drug_name" = (
    SELECT "drug_name"
    FROM CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
    WHERE "nppes_provider_state" = 'NY'
    GROUP BY "drug_name"
    ORDER BY SUM("total_claim_count") DESC
    LIMIT 1
  )
GROUP BY
  "nppes_provider_state"
ORDER BY
  total_claim_count DESC
LIMIT 5;When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-16 16:28:54 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 16:28:54 - root - INFO - The drug with the highest total number of prescriptions in New York State during 2014 is **AMLODIPINE BESYLATE**. The top five states with the highest total claim counts for **AMLODIPINE BESYLATE** are:

```csv
state,total_claim_count,total_drug_cost
CA,3725846,35073534.8700
FL,2689327,21046051.1900
NY,2606392,20729281.2500
TX,2212275,17513523.7000
PA,1760543,14121212.7400
```

```sql
SELECT
  "nppes_provider_state" AS state,
  SUM("total_claim_count") AS total_claim_count,
  SUM("total_drug_cost") AS total_drug_cost
FROM
  CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
WHERE
  "drug_name" = (
    SELECT
      "drug_name"
    FROM
      CMS_DATA.CMS_MEDICARE.PART_D_PRESCRIBER_2014
    WHERE
      "nppes_provider_state" = 'NY'
    GROUP BY
      "drug_name"
    ORDER BY
      SUM("total_claim_count") DESC NULLS LAST
    LIMIT 1
  )
GROUP BY
  "nppes_provider_state"
ORDER BY
  total_claim_count DESC NULLS LAST
LIMIT 5;
```
2025-01-16 16:28:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 16:28:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 16:28:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 16:28:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-16 16:28:56 - snowflake.connector.connection - INFO - closed
2025-01-16 16:28:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 16:28:56 - root - INFO - itercount: 2
2025-01-16 16:28:56 - root - INFO - 0
2025-01-16 16:28:56 - root - INFO - Total iteration counts: 2
