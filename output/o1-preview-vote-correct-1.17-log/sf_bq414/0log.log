2025-01-17 19:58:00 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 19:59:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 19:59:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 19:59:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 19:59:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 19:59:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-01-17 19:59:11 - snowflake.connector.connection - INFO - closed
2025-01-17 19:59:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 19:59:11 - root - INFO - SQL:
SELECT DISTINCT "department" FROM "THE_MET"."THE_MET"."OBJECTS";
Results:
department
Asian Art
Islamic Art
Photographs
Medieval Art
The Cloisters
The Libraries
Arms and Armor
Costume Institute
European Paintings
Drawings and Prints
Greek and Roman Art
Musical Instruments
Ancient Near Eastern Art
Robert Lehman Collection
Modern and Contemporary Art
American Paintings and Sculpture
"Arts of Africa, Oceania, and the Americas"
American Decorative Arts
European Sculpture and Decorative Arts
Egyptian Art

2025-01-17 19:59:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 19:59:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 19:59:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 19:59:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1472
2025-01-17 19:59:14 - snowflake.connector.connection - INFO - closed
2025-01-17 19:59:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 19:59:15 - root - INFO - SQL:
SELECT DISTINCT "title"
   FROM "THE_MET"."THE_MET"."OBJECTS"
   WHERE LOWER("title") LIKE '%book%';
Results:
Too long, hard cut:
title
明     郭詡     稱書圖     軸|Weighing Books
明     杜堇     伏生授經圖   軸|The Scholar Fu Sheng Transmitting the Book of Documents
画本宝能縷|Picture Book of Brocades with Precious Threads (Ehon takara no itosuji)
絵本松のしらべ|Picture Book on the Music of the Pine Trees (Ehon matsu no shirabe)
『和国諸職絵尽　諸織 絵本鏡』|A Picture Book Mirror of Various Occupations (Wakoku shoshoku ezukushi)
Ehon Asakayama|絵本浅香山|Picture Book: Mount Asaka (Ehon Asakayama)
Ehon Ogurayama|絵本小倉山|Picture Book: Ogura Hill (Ehon Ogurayama)
Ehon Himetsubaki|繪本女貞木|Picture Book: Camellia (Ehon Himetsubaki)
『繪本小倉山』|Picture Book of Ogura Hill (Ehon ogurayama)
『繪本小松原』|Picture Book of Komatsubara (Ehon komatsubara)
『寫山樓畫本』|Shazanrō (Bunchō) Picture Book (Shazanrō ehon)
『絵本時世粧』|Picture Book of Modern Figures of Fashion (Ehon imayō sugata)
絵本吾妻遊|Ehon Azuma asobi|Picture Book of Amusements of the Eastern Capital (Ehon Azuma asobi)
Ehon Momochidori Kyōka-awase|百千鳥狂歌合|Myriad Birds: Picture Book of Playful Verse (Momo chidori kyōka-awase)
潮干のつと|Gifts from the Ebb Tide (The Shell Book) (Shiohi no tsuto)
繪本四季花|Picture Book of Flowers of the Four Seasons (Ehon shiki no hana)
『画本狂歌山満多山』|Picture Book of Kyōka Poems: Mountains upon Mountains (Ehon kyōka yama mata yama)
『絵本和漢誉』|Picture Book on Heroes of China and Japan (Ehon wakan no homare)
絵本和歌夷 「龢謌夷」|Picture Book with Playful Poems for the Young God Ebisu
画本虫撰|Picture Book of Crawling Creatures (The Insect Book) (Ehon mushi erami)
『青楼繪本年中行事』|Yoshiwara Picture Book of New Year’s Festivities (Seirō ehon nenjū gyōji)
『暁斎漫画』|Kyōsai Sketchbook (Kyōsai manga)
"『閨の雛形』　正月|Plate from the Erotic Book Mounds of Dyed Colors: A Pattern Book for the Boudoir (Someiro no yama neya no hinagata), First Month"
"『画本虫撰』  「虻」「芋虫」|Horsefly (abu); Green Caterpillar, imomushi, from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』   「松虫」「虫蛍」|Tree cricket (Matsumushi); Firefly (Hotaru), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"画本虫撰　バッタと蟷螂|Cone-headed Grasshopper or Locust, (batta); Praying Mantis (Tōrō or Kamakiri), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"四季の花|Women on a Bridge, from the illustrated book Flowers of the Four Seasons"
"四季の花|A Child Lighting Fireworks, from the illustrated book Flowers of the Four Seasons"
"四季の花|Girls Getting on Board a Boat, from the illustrated book Flowers of the Four Seasons"
"四季の花|New Year's Games, from the printed book Flowers of the Four Seasons (Shiki no hana)"
"『雛形若菜初模様　玉や内　しら玉』|The Courtesan Shiratama of the Tamaya Brothel, from the series “A Pat-tern Book of the Year’s First Designs, Fresh as Spring Herbs” (“Hinagata wakana hatsu moyō”)"
"『雛形若菜初模様　四ツ目屋内　にしき木』|The Courtesan Nishikigi of the Yotsumeya Brothel, from the series “A Pattern Book of the Year’s First Designs, Fresh as Spring Herbs” (“Hinagata wakana hatsu moyō”)"
"『雛形若菜の初模様　扇屋内　七越』|The Courtesan Nanakoshi of the Ōgiya Brothel, from the series “A Pat-tern Book of the Year’s First Designs, Fresh as Spring Herbs” (“Hinagata wakana no hatsu moyō”)"
"『画本虫撰』   「けら」「はさみむし」|Mole Cricket (Kera); Earwig, (Hasami-mushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』「蝸牛」「轡虫」|Land Snail (Katatsumuri); Giant Katydid (Kutsuwamushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"Kamakura no Koshi|The Filial Son at Kamakura, From the Book: Sasekishu"
"『雛形若菜の初模様　つたや内　人まち』|The Courtesan Hitomachi of the Tsutaya Brothel, from the series “A Pat-tern Book of the Year’s First Designs, Fresh as Spring Herbs” (“Hinagata wakana no hatsu moyō”)"
[Woman in Robes Reading a Book]
[Seated Man Pointing to a Passage in an Open Book]
"Manuscript Illumination with the Visitation in an Initial D, from a Choir Book"
"Manuscript Leaf with Adoration of the Holy Name, from a Book of Hours"
The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans
"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work"
"London Chair-Makers' and Carvers' Book of Prices, for Workmanship..."
"The Oxford Drawing Book to which is added, Lessons in Flower Drawing"
A Booke of Christian Prayers
"Sketch Book Containing 182 drawings on 91 leaves. One of a series used by the artist on his Italian trip, 1750–52; Sketches made in Milan, Turin, Florence, and Rome."
Compendium of Architectural Books by Sebastiano Serlio (Books I-V)
The Architecture of A. Palladio in Four Books containing a Short Treatise on the Five Orders (L'Architecture de A. Palladio en quatre livres... / Il quattro libri dell'architettura)
Book of Designs [for Ironwork]
"St. Luke, seated on a cloud with an open book in both hands, a bull lying at his feet, from a series of the four evangelists after Agostino Veneziano, which are in turn after Giulio Romano"
"Dialectic: a young woman standing in a decorated interior and touching her right index finger to her left middle finger in a counting gesture, at he

2025-01-17 19:59:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 19:59:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 19:59:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 19:59:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-17 19:59:16 - snowflake.connector.connection - INFO - closed
2025-01-17 19:59:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 19:59:16 - root - INFO - SQL:
SELECT "metadata_date"
   FROM "THE_MET"."THE_MET"."OBJECTS"
   LIMIT 1000;
Results:
Too long, hard cut:
metadata_date
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
14863

2025-01-17 19:59:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 19:59:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 19:59:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 19:59:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 120
2025-01-17 19:59:18 - snowflake.connector.connection - INFO - closed
2025-01-17 19:59:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 19:59:18 - root - INFO - SQL:
SELECT "object_id"
   FROM "THE_MET"."THE_MET"."OBJECTS"
   WHERE "department" = 'The Libraries';
Results:
object_id
682011
681546
681534
681389
591832
591860
591831
591865
591848
591863
681573
682013
681149
681556
681388
680835
681547
681545
682014
681128
682012
681563
716648
705290
715005
739504
726677
716639
699505
697348
681349
591837
591862
591836
700238
738466
700032
700050
738463
704714
700240
738758
700232
700091
738765
682010
681259
726717
707455
726673
726669
681246
679732
726678
591835
681559
591839
681502
680708
682015
681386
679476
681551
680818
680752
591844
591849
591830
591824
591834
591854
591840
591864
591841
591855
591842
681372
591845
591847
591829
591828
591825
591827
681554
591857
591850
591852
591853
591859
591858
591861
591843
681357
680832
679629
679465
724625
591826
591838
591833
705638
681274
681504
678732
680821
682098
680318
591856
681384
591851
591846
591868
734108
734109
734110
734111
738516
680819
679638
681269

2025-01-17 19:59:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 19:59:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 19:59:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 19:59:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1314
2025-01-17 19:59:21 - snowflake.connector.connection - INFO - closed
2025-01-17 19:59:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 19:59:21 - root - INFO - SQL:
SELECT "object_id", "title"
   FROM "THE_MET"."THE_MET"."OBJECTS"
   WHERE LOWER("title") LIKE '%book%';
Results:
Too long, hard cut:
object_id,title
39483,明     郭詡     稱書圖     軸|Weighing Books
39667,明     杜堇     伏生授經圖   軸|The Scholar Fu Sheng Transmitting the Book of Documents
57754,画本宝能縷|Picture Book of Brocades with Precious Threads (Ehon takara no itosuji)
78593,絵本松のしらべ|Picture Book on the Music of the Pine Trees (Ehon matsu no shirabe)
78688,『和国諸職絵尽　諸織 絵本鏡』|A Picture Book Mirror of Various Occupations (Wakoku shoshoku ezukushi)
53815,Ehon Asakayama|絵本浅香山|Picture Book: Mount Asaka (Ehon Asakayama)
45062,"絵本末摘花|Picture Book: Flowers Yet to be Picked, Vol. 1"
57842,Ehon Ogurayama|絵本小倉山|Picture Book: Ogura Hill (Ehon Ogurayama)
57858,Ehon Himetsubaki|繪本女貞木|Picture Book: Camellia (Ehon Himetsubaki)
78723,『繪本常盤草』|Picture Book of the Evergreens (Ehon tokiwagusa)
78728,『繪本小倉山』|Picture Book of Ogura Hill (Ehon ogurayama)
78729,『繪本小松原』|Picture Book of Komatsubara (Ehon komatsubara)
78722,絵本常盤草　上・中・下|Picture Book of the Evergreens (Ehon tokiwagusa)
78585,『寫山樓畫本』|Shazanrō (Bunchō) Picture Book (Shazanrō ehon)
78739,『絵本時世粧』|Picture Book of Modern Figures of Fashion (Ehon imayō sugata)
78597,艶本 婦慈のゆき|An Erotic Picture Book of Snow on Fuji (Enpon fuji no yuki)
45273,絵本吾妻遊|Ehon Azuma asobi|Picture Book of Amusements of the Eastern Capital (Ehon Azuma asobi)
57568,Ehon Momochidori Kyōka-awase|百千鳥狂歌合|Myriad Birds: Picture Book of Playful Verse (Momo chidori kyōka-awase)
57605,絵本和歌夷 「龢謌夷」|Picture Book with Playful Poems for the Young God Ebisu
57648,潮干のつと|Gifts from the Ebb Tide (The Shell Book) (Shiohi no tsuto)
57569,画本虫撰|Picture Book of Crawling Creatures (The Insect Book) (Ehon mushi erami)
57570,画本虫撰|Picture Book of Crawling Creatures (The Insect Book) (Ehon mushi erami)
45322,繪本四季花|Picture Book of Flowers of the Four Seasons (Ehon shiki no hana)
78746,『青楼繪本年中行事』|Yoshiwara Picture Book of New Year’s Festivities (Seirō ehon nenjū gyōji)
78758,（榎木新右衛門）画 『雛形伊勢乃海』|Book of Kosode Patterns (Hiinagata Ise no umi)
45444,Ehon Musashi no Abumi|A Picture Book of Japanese Warriors
78635,『画本狂歌山満多山』|Picture Book of Kyōka Poems: Mountains upon Mountains (Ehon kyōka yama mata yama)
78771,"繪本彩色通　初編|Picture Book on the Use of Coloring, first volume (Ehon saishikitsū shohen)"
78772,『絵本和漢誉』|Picture Book on Heroes of China and Japan (Ehon wakan no homare)
78667,『暁斎漫画』|Kyōsai Sketchbook (Kyōsai manga)
55597,"『閨の雛形』　正月|Plate from the Erotic Book Mounds of Dyed Colors: A Pattern Book for the Boudoir (Someiro no yama neya no hinagata), First Month"
37283,"『画本虫撰』  「蜂」「毛虫」|Paper Wasp (Hachi); Hairy Caterpillar (Kemushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37284,"『画本虫撰』   「馬追虫」「むかて」|Katydid (Umaoi-mushi); Centipede, (Mukade), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37285,"『画本虫撰』   「けら」「はさみむし」|Mole Cricket (Kera); Earwig, (Hasami-mushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37286,"『画本虫撰』   「蝶」「蜻蛉」|Butterfly (Chō); Dragonfly (Kagerō or Tonbo), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37287,"『画本虫撰』  「虻」「芋虫」|Horsefly (abu); Green Caterpillar, imomushi, from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37288,"『画本虫撰』   「松虫」「虫蛍」|Tree cricket (Matsumushi); Firefly (Hotaru), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37289,"画本虫撰　バッタと蟷螂|Cone-headed Grasshopper or Locust, (batta); Praying Mantis (Tōrō or Kamakiri), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37290,"『画本虫撰』 「ひくらし」「くも」|Evening Cicada, Higurashi; Spider, Kumo, from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37291,"『画本虫撰』「赤蜻蛉」「いなこ」|Red Dragonfly (Akatonbo); Locust (Inago), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37292,"『画本虫撰』「虵」「とかけ」|Rat Snake (Hebi); Lizard or Skink (Tokage), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37293,"『画本虫撰』「蓑虫」「兜虫」|Bagworm (Minomushi); Horned Scarab Beetle (Kabutomushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37294,"『画本虫撰』「蝸牛」「轡虫」|Land Snail (Katatsumuri); Giant Katydid (Kutsuwamushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37295,"『画本虫撰』「きりきりす」「蝉」|Grasshopper (Kirigirisu); Cicada (Semi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37296,"『画本虫撰』「蚓」「こうろき」|Earthworm (Mimizu); Cricket (Kōrogi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37306,"四季の花|The Coming Thunderstorm, from the illustrated book Flowers of the Four Seasons"
37307,"四季の花|Women on a Bridge, from the illustrated book Flowers of the Four Seasons"
37308,"四季の花|A Child Lighting Fireworks, from the illustrated book Flowers of the Four Seasons"
37309,"四季の花|Girls Getting on Board a Boat, from the illustrated book Flowers of the Four Seasons"
37310,"四季の花|Girls Picking Green Leaves, from the illustrated book Flowers of the Four Seasons"
37311,"四季の花|New Year's Games, from the printed book Flowers of the Four Seasons (Shiki no hana)"
37312,"四季の花|Girls Entertained by Performers, from the illustrated book Flowers of the Four Seasons"
37313,"四季の花

2025-01-17 19:59:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 19:59:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 19:59:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 19:59:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 25074
2025-01-17 19:59:25 - snowflake.connector.connection - INFO - closed
2025-01-17 19:59:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 19:59:25 - root - INFO - SQL:
SELECT DISTINCT "object_id"
   FROM "THE_MET"."THE_MET"."VISION_API_DATA";
Results:
Too long, hard cut:
object_id
361703
367415
385089
45445
55423
10401
436911
459040
467808
343201
37125
451972
390689
383935
464286
434111
382454
51416
156808
55199
249232
730790
389888
436850
364208
186800
386355
464306
469932
193450
386457
339941
392523
383358
336882
269236
380487
363260
10353
338973
156426
445280
197750
459015
453683
339559
436835
398521
436840
437819
438025
209042
349133
55746
437855
229601
11627
267233
442183
459005
392464
436048
452017
704977
291921
45249
470874
466201
446577
435848
900
10184
436410
156804
339836
464275
437100
288214
333993
437454
467679
488853
436542
334772
402847
392327
45322
4205
4200
288012
436019
326695
394309
460207
392937
478972
290476
4203
408902
13245
342743
384064
193614
458996
37385
698490
288126
343737
371590
45261
207160
358160
351416
547690
286833
451258
204267
344913
4140
436519
307013
643540
435947
549501
385669
49567
367000
12554
435984
286582
365096
388713
199990
395492
263206
625912
36841
390688
32840
455057
200837
464277
359455
248809
289329
436267
6788
447801
114709
13786
252955
471824
342531
306204
407171
376674
460236
342525
339675
56756
436180
198992
459059
359909
458998
459198
458992
336508
464135
361605
288160
467648
63812
463039
390082
20495
260115
399217
393290
56764
189964
335156
294445
268109
438467
468317
430870
55216
55209
288532
467640
437336
437743
285692
194181
707785
306155
301973
437912
471068
239425
282191
249180
186317
13345
242035
73429
316594
57649
195965
403077
644110
436537
45313
12644
32830
268354
352198
670908
471942
385969
464494
684336
437244
464281
260185
286165
459950
44355
199489
466192
291857
696392
335420
392469
388970
289308
366522
371141
463555
656747
335942
287770
260118
717610
342608
678732
414746
4209
340262
263193
436190
37186
412823
54499
645240
348790
506089
374026
10961
205109
192720
261347
11603
416247
467941
242318
435709
54678
436205
428022
358365
261480
189351
291939
335751
187145
398655
467523
195345
383686
260112
349097
392843
76971
288154
435682
17187
369299
670999
205194
469891
387496
460077
334306
334884
269875
652270
716365
285466
436918
437414
386451
736059
294515
370452
203576
436461
461448
464588
291873
291869
390698
435585
435908
436261
392618
708058
357164
56742
291890
37141
271736
435899
437555
260350
54878
382932
668074
435822
645448
205630
227763
292002
390467
238577
437250
262992
291878
712180
385063
288162
54827
455041
467462
548438
204272
437650
437777
399439
190537
635401
339942
682989
436099
55879
437028
657683
650860
466277
204484
468105
371107
436604
269251
11133
470346
467466
197997
415389
460166
398594
702752
201454
205267
36668
44376
659502
437491
269252
55262
341770
435727
446285
437177
196587
367538
209272
397692
56835
266259
646460
436760
198906
54569
13043
399542
435852
679157
370485
464124
463742
37943
361830
199485
468318
467471
390083
382755
55273
466107
449008
388772
199487
469940
12917
186804
186798
399213
60164
437798
505616
299311
463038
44359
201588
269243
435745
55323
459039
188885
285789
466561
286636
12717
188970
10077
437740
306162
437722
459045
227723
73415
471903
438387
471976
55266
460151
437330
246807
460152
250596
474380
123761
246379
40493
271600
72306
550008
313511
64312
409358
324454
326849
212859
57624
695354
561751
243463
740757
326103
25301
588380
700967
214856
249695
23415
241871
323093
554933
548072
549769
464095
474633
26474
214053
450709
317540
471450
29747
455175
546406
213749
200403
324544
471677
246449
27802
5652
464900
269419
502652
189659
647648
420557
646730
204522
257693
198457
551962
58834
548867
252871
551085
445922
58134
546994
560477
247626
501711
267980
45563
414830
406343
646719
467227
29632
556994
454023
694386
250438
557094
324509
414887
225005
255085
6878
55656
309265
60238
675892
464872
553820
463375
315350
315483
475345
545512
44400
323106
75122
565427
7821
327130
70440
252764
213406
214545
221273
326571
59168
317396
67467
562681
548169
472118
450354
443737
204555
219288
694233
221296
259168
41067
66812
38567
317
660954
447642
651239
188315
588368
308667
48549
317153
62545
575094
323110
259165
364356
695319
326707
459288
546384
252854
455223
168449
398641
253817
465619
318214
450226
323065
64355
25491
243479
466509
421138
39307
324204
57887
120716
58635
58339
25573
60528
219486
246028
466750
680203
75016
246347
446324
428679
375777
447194
466764
392604
289215
740825
394314
381621
25098
59649
729885
430189
388598
321806
447997
225008
326668
317289
401668
321728
451145
468806
546847
557355
325996
452706
58279
25447
475542
325495
548349
740777
37208
732432
49391
120762
213800
740780
326961
500952
269881
447122
362652
360623
291946
452937
560345
323649
559185
221124
555034
23675
201116
323702
559492
565837
326018
309054
475427
590822
362921
645512
215002
255455
57476
25259
559013
317066
474504
23669
464937
60853
467300
229738
547990
553870
457103
504482
47790
282180
66913
29526
448793
17505
551959
26004
247783
503347
247764
394031
321561
29701
326886
246778
590759
189329
254468
559509
119173
552394
565765
5567
22802
443581
466445
651683
324954
199789
253258

2025-01-17 19:59:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 19:59:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 19:59:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 19:59:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 236
2025-01-17 19:59:28 - snowflake.connector.connection - INFO - closed
2025-01-17 19:59:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 19:59:28 - root - INFO - SQL:
SELECT "cropHintsAnnotation"
   FROM "THE_MET"."THE_MET"."VISION_API_DATA"
   LIMIT 1000;
Results:
Too long, hard cut:
cropHintsAnnotation
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2158,
            ""y"": 0
          },
          {
            ""x"": 2158,
            ""y"": 2871
          },
          {
            ""x"": 0,
            ""y"": 2871
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.700000047683716e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2490,
            ""y"": 0
          },
          {
            ""x"": 2490,
            ""y"": 3340
          },
          {
            ""x"": 0,
            ""y"": 3340
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 1.100000023841858e+00
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 1455,
            ""y"": 0
          },
          {
            ""x"": 1455,
            ""y"": 1899
          },
          {
            ""x"": 0,
            ""y"": 1899
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.700000047683716e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2843,
            ""y"": 0
          },
          {
            ""x"": 2843,
            ""y"": 3734
          },
          {
            ""x"": 0,
            ""y"": 3734
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.799999952316284e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2873,
            ""y"": 0
          },
          {
            ""x"": 2873,
            ""y"": 3982
          },
          {
            ""x"": 0,
            ""y"": 3982
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.599999845027924e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2026,
            ""y"": 0
          },
          {
            ""x"": 2026,
            ""y"": 2555
          },
          {
            ""x"": 0,
            ""y"": 2555
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 5.000000000000000e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2634,
            ""y"": 0
          },
          {
            ""x"": 2634,
            ""y"": 3999
          },
          {
            ""x"": 0,
            ""y"": 3999
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.700000047683716e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2821,
            ""y"": 0
          },
          {
            ""x"": 2821,
            ""y"": 3718
          },
          {
            ""x"": 0,
            ""y"": 3718
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.700000047683716e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2484,
            ""y"": 0
          },
          {
            ""x"": 2484,
            ""y"": 2943
          },
          {
            ""x"": 0,
            ""y"": 2943
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.499999940395355e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2614,
            ""y"": 0
          },
          {
            ""x"": 2614,
            ""y"": 3530
          },
          {
            ""x"": 0,
            ""y"": 3530
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.899999856948853e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
  

2025-01-17 19:59:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 19:59:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 19:59:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 19:59:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-17 19:59:29 - snowflake.connector.connection - INFO - closed
2025-01-17 19:59:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 19:59:59 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 19:59:59 - root - INFO - ```sql
SELECT
    o."object_id",
    o."title",
    TO_VARCHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM
    "THE_MET"."THE_MET"."OBJECTS" AS o
JOIN
    "THE_MET"."THE_MET"."VISION_API_DATA" AS v
    ON o."object_id" = v."object_id"
WHERE
    v."cropHintsAnnotation" IS NOT NULL
    AND v."cropHintsAnnotation":"cropHints"[0]:"confidence"::FLOAT > 0.5
    AND o."department" = 'The Libraries'
    AND LOWER(o."title") LIKE '%book%'
```
2025-01-17 19:59:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 19:59:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 19:59:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:00:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-17 20:00:00 - snowflake.connector.connection - INFO - closed
2025-01-17 20:00:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:00:00 - root - INFO - SQL:
SELECT
    o."object_id",
    o."title",
    TO_VARCHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM
    "THE_MET"."THE_MET"."OBJECTS" AS o
JOIN
    "THE_MET"."THE_MET"."VISION_API_DATA" AS v
    ON o."object_id" = v."object_id"
WHERE
    v."cropHintsAnnotation" IS NOT NULL
    AND v."cropHintsAnnotation":"cropHints"[0]:"confidence"::FLOAT > 0.5
    AND o."department" = 'The Libraries'
    AND LOWER(o."title") LIKE '%book%'
Results:
object_id,title,metadata_date
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc.",2017-02-06
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06

2025-01-17 20:00:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:00:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:00:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:00:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-17 20:00:02 - snowflake.connector.connection - INFO - closed
2025-01-17 20:00:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:00:28 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:00:28 - root - INFO - ```sql
SELECT
    o."object_id",
    o."title",
    TO_VARCHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM
    "THE_MET"."THE_MET"."OBJECTS" AS o
JOIN
    "THE_MET"."THE_MET"."VISION_API_DATA" AS v
    ON o."object_id" = v."object_id"
JOIN
    LATERAL FLATTEN(
        INPUT => PARSE_JSON(v."cropHintsAnnotation"):"cropHints"
    ) AS f
WHERE
    o."department" = 'The Libraries'
    AND LOWER(o."title") LIKE '%book%'
    AND TRY_TO_DOUBLE(f.value:"confidence") > 0.5;
```
2025-01-17 20:00:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:00:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:00:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:00:30 - snowflake.connector.connection - INFO - closed
2025-01-17 20:00:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:01:04 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:01:04 - root - INFO - ```sql
SELECT
    o."object_id",
    o."title",
    TO_VARCHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM
    "THE_MET"."THE_MET"."OBJECTS" AS o
JOIN
    "THE_MET"."THE_MET"."VISION_API_DATA" AS v
    ON o."object_id" = v."object_id"
LATERAL FLATTEN(
    INPUT => v."cropHintsAnnotation":cropHints
) AS ch
WHERE
    o."department" = 'The Libraries'
    AND LOWER(o."title") LIKE '%book%'
    AND TRY_TO_DOUBLE(ch.value:"confidence"::STRING) > 0.5;
```
2025-01-17 20:01:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:01:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:01:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:01:05 - snowflake.connector.connection - INFO - closed
2025-01-17 20:01:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:02:06 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:02:06 - root - INFO - ```sql
SELECT
    o."object_id",
    o."title",
    TO_CHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM
    "THE_MET"."THE_MET"."OBJECTS" AS o
JOIN
    "THE_MET"."THE_MET"."VISION_API_DATA" AS v
        ON o."object_id" = v."object_id"
WHERE
    o."department" = 'The Libraries'
    AND LOWER(o."title") LIKE '%book%'
    AND v."cropHintsAnnotation":"cropHints"[0]:"confidence"::FLOAT > 0.5;
```

We corrected the query to avoid the syntax error by removing the `LATERAL FLATTEN` and directly accessing the `"confidence"` value from the first element of the `"cropHints"` array within the `"cropHintsAnnotation"` column. The condition `v."cropHintsAnnotation":"cropHints"[0]:"confidence"::FLOAT > 0.5` filters objects where the `cropConfidence` is greater than 0.5.

The query retrieves the `object_id`, `title`, and formats the `metadata_date` as a string in 'YYYY-MM-DD' format for objects in the **"The Libraries"** department where the `title` contains the word "book" (case-insensitive), and the `cropConfidence` is greater than 0.5.
2025-01-17 20:02:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:02:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:02:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:02:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-17 20:02:08 - snowflake.connector.connection - INFO - closed
2025-01-17 20:02:08 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:02:08 - root - INFO - SQL:
SELECT
    o."object_id",
    o."title",
    TO_CHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM
    "THE_MET"."THE_MET"."OBJECTS" AS o
JOIN
    "THE_MET"."THE_MET"."VISION_API_DATA" AS v
        ON o."object_id" = v."object_id"
WHERE
    o."department" = 'The Libraries'
    AND LOWER(o."title") LIKE '%book%'
    AND v."cropHintsAnnotation":"cropHints"[0]:"confidence"::FLOAT > 0.5;
Results:
object_id,title,metadata_date
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc.",2017-02-06
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06

2025-01-17 20:02:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:02:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:02:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:02:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 228
2025-01-17 20:02:11 - snowflake.connector.connection - INFO - closed
2025-01-17 20:02:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:02:11 - root - INFO - SQL:
SELECT "object_id", "cropHintsAnnotation"
    FROM "THE_MET"."THE_MET"."VISION_API_DATA"
    WHERE "cropHintsAnnotation" IS NOT NULL
    LIMIT 1000;
Results:
Too long, hard cut:
object_id,cropHintsAnnotation
437177,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 1586,
            ""y"": 0
          },
          {
            ""x"": 1586,
            ""y"": 1907
          },
          {
            ""x"": 0,
            ""y"": 1907
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 5.299999713897705e-01
    }
  ]
}"
437564,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2754,
            ""y"": 0
          },
          {
            ""x"": 2754,
            ""y"": 3418
          },
          {
            ""x"": 0,
            ""y"": 3418
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.499999940395355e-01
    }
  ]
}"
201929,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 1795,
            ""y"": 0
          },
          {
            ""x"": 1795,
            ""y"": 1307
          },
          {
            ""x"": 0,
            ""y"": 1307
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.899999856948853e-01
    }
  ]
}"
397271,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2351,
            ""y"": 0
          },
          {
            ""x"": 2351,
            ""y"": 3999
          },
          {
            ""x"": 0,
            ""y"": 3999
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.599999845027924e-01
    }
  ]
}"
355599,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 1323,
            ""y"": 0
          },
          {
            ""x"": 1323,
            ""y"": 1963
          },
          {
            ""x"": 0,
            ""y"": 1963
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.499999940395355e-01
    }
  ]
}"
412502,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 3648,
            ""y"": 0
          },
          {
            ""x"": 3648,
            ""y"": 2882
          },
          {
            ""x"": 0,
            ""y"": 2882
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.499999940395355e-01
    }
  ]
}"
337337,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2755,
            ""y"": 0
          },
          {
            ""x"": 2755,
            ""y"": 3473
          },
          {
            ""x"": 0,
            ""y"": 3473
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.799999952316284e-01
    }
  ]
}"
209969,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 3999,
            ""y"": 0
          },
          {
            ""x"": 3999,
            ""y"": 2701
          },
          {
            ""x"": 0,
            ""y"": 2701
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.499999940395355e-01
    }
  ]
}"
6039,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 187,
            ""y"": 0
          },
          {
            ""x"": 1695,
            ""y"": 0
          },
          {
            ""x"": 1695,
            ""y"": 1934
          },
          {
            ""x"": 187,
            ""y"": 1934
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 4.299999773502350e-01
    }
  ]
}"
53710,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 3820,
            ""y"": 0
          },
          {
            ""x"": 3820,
            ""y"": 1866
          },
          {
            ""x"": 0,
            ""y"": 1866
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.999999761581421e-01
    }
  ]
}"

2025-01-17 20:02:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:02:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:02:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:02:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-17 20:02:13 - snowflake.connector.connection - INFO - closed
2025-01-17 20:02:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:02:13 - root - INFO - SQL:
SELECT "title", "department"
    FROM "THE_MET"."THE_MET"."OBJECTS"
    LIMIT 1000;
Results:
Too long, hard cut:
title,department
전(傳) 오원 장승업 (1843–1897) 청동기와 화초가 있는 정물화 조선|傳 吾園 張承業 器皿折枝圖 朝鮮|Still life with bronze vessels and flowering plants,Asian Art
석지 채용신    학자 초상|石芝 蔡龍臣 學者肖像|Portrait of a scholar,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
"이유원, 매화도  조선|李裕元 梅花圖  朝鮮|Plum Branch",Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
張旭 「肚痛帖」; 懷素 「寄邊衣」詩|Ji bianyi|Letter about a Stomachache (Du tong tie),Asian Art
東晉 王羲之 十七日帖 十三世紀拓本|On the Seventeenth Day,Asian Art
,Asian Art
近代  丁輔之  荔枝  扇面|Lychees,Asian Art
清  倣龔賢  十二月令山水圖  冊|Landscapes of the Twelve Months,Asian Art
,Asian Art
,Asian Art
清  程正揆  江山臥遊圖  卷|Dream Landscape,Asian Art
清  倣龔賢  雲山隱居圖  軸|Dwelling among Mountains and Clouds,Asian Art
清  倣龔賢  山水圖  冊|Landscapes,Asian Art
清 王翬 倣李成雪霽圖 軸 紙本|Snow Clearing: Landscape after Li Cheng,Asian Art
清  王緣  趙之謙肖像  軸|Portrait of Zhao Zhiqian,Asian Art
清  柳堉  溪山行旅圖  卷|Traveling Amid Streams and Mountains,Asian Art
王翬、楊晉、顧昉、王雲、徐玫 仿古山水圖 冊 紙本|Landscapes after old masters,Asian Art
元  吳鎮  蘆灘釣艇圖  卷|Fisherman,Asian Art
元   趙孟頫   趙雍   趙麟   吳興趙氏三世人馬圖   卷|Grooms and Horses,Asian Art
"南宋 馬和之 詩經小雅鴻雁之什六篇圖 卷|Courtly Odes, Beginning with ""Wild Geese""",Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
清  查昇  行書七律詩  軸|Poem,Asian Art
清  石濤(朱若極)  山水圖  冊|Searching for Immortals,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
唐 颜真卿 顏家廟碑 現代拓片 紙本|Yan Family Temple Stele,Asian Art
太平山水圖|Landscapes of Taiping Prefecture (Taiping shanshui tu),Asian Art
,Asian Art
,Asian Art
唐 傳鍾紹京 楷書靈飛經 冊|Spiritual Flight Sutra,Asian Art
南宋  趙孟堅  行書梅竹詩譜  卷|Poems on Painting Plum Blossoms and Bamboo,Asian Art
南宋   理宗趙昀  行書北宋梅堯臣 依韻和資政侍郎雪後登看山亭詩   團扇|Quatrain on Snow-covered West Lake,Asian Art
,Asian Art
南宋 理宗 趙昀 楷書韓翊 《 潮聲山翠》 聯句 團扇|Couplet from a Poem by Han Hong,Asian Art
南宋  孝宗  行楷書池上水邊聯句  團扇|Couplet on pond scenery,Asian Art
南宋   高宗   草書天山陰雨七絕詩   團扇|Quatrain on Heavenly Mountain,Asian Art
,Asian Art
,Asian Art
明  王鏊  贈別詩  軸|Farewell Poem,Asian Art
,Asian Art
,Asian Art
"明  文徵明  致丈人吳愈書  冊頁|Letter to the Artist's Father-in-law, Wu Yu",Asian Art
,Asian Art
,Asian Art
文彭  行草七律  水墨絹本  鏡框|Poem on Promulgating the Almanac at New Year’s,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
明/清  王鐸  行草書日暮孤亭五律詩  軸|Poem on a Riverside Pavilion,Asian Art
,Asian Art
,Asian Art
晚明  張希黃 留青竹刻 《醉翁亭記》 詩意圖筆筒|Brush holder with “Ode to the Pavilion of the Inebriated Old Man”,Asian Art
,Asian Art
,Asian Art
,Asian Art
清  法若真  行草書畫說  卷|Discourse on Painting,Asian Art
清  朱耷 (八大山人)  李治書  扇頁|Letter by Li Zhi,Asian Art
明/清 朱耷（八大山人） 致方士琯書 冊 紙本|Letters to Fang Shiguan,Asian Art
,Asian Art
"清   金農   論畫雜詩   冊|Poems on Paintings, Written for Ma Yueguan",Asian Art
,Asian Art
,Asian Art
吳煕載  篆書詩經南山有臺|Nutgrass Grows on the Southern Hills,Asian Art
清  趙之謙  隸書引首  卷|The Lingshouhua Studio,Asian Art
清  趙之謙  篆書五言  對聯|Couplet,Asian Art
清  翁同龢  軸|Tiger Calligraphy,Asian Art
,Asian Art
,Asian Art
元 耶律楚材 行書贈別劉滿詩 卷|Poem of Farewell to Liu Man,Asian Art
元  趙孟頫  行書右軍四事  卷|Four anecdotes from the life of Wang Xizhi,Asian Art
元  鄭元祐  楷書師孺齋記  卷|Record of the Following One's Ancestor Studio,Asian Art
北宋 黃庭堅 草書廉頗藺相如傳 卷|Biographies of Lian Po and Lin Xiangru,Asian Art
北宋  米芾  草書吳江舟中詩  卷|Poem Written in a Boat on the Wu River,Asian Art
南宋 楊皇后 楷書薄薄殘妝七絕 團扇冊頁 絹本|Quatrain on spring’s radiance,Asian Art
南宋  楊皇后  楷書瀹雪凝酥七絕  團扇|Quatrain on yellow roses,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
芥子園畫傳|Mountainside View: Page from The Mustard Seed Garden Manual of Painting,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
近代  張善子  黃山奇松圖  扇頁|Strange Pine in the Yellow Mountain,Asian Art
,Asian Art
清  湯貽汾  墨梅  四冊頁|Blossoming Plum,Asian Art
清  胡遠  山水  四軸|Landscapes of the Four Seasons,Asian Art
近代  王振聲  友梅圖  扇面|Still-life with Plum,Asian Art
近代  吳昌碩  仙芝天竹圖  軸|Spring Offerings,Asian Art
近代  吳昌碩  烹茶圖  橫軸|Brewing Tea,Asian Art
近代  吳昌碩  蘭花  扇面|Orchid,Asian Art
近代  林紓  合掌峰  扇面|Hezhang Peak,Asian Art
近代  林紓  詩廬圖  卷|The Poetry Cottage,Asian Art

2025-01-17 20:02:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:02:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:02:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:02:14 - snowflake.connector.connection - INFO - closed
2025-01-17 20:02:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:02:36 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:02:36 - root - INFO - ```sql
SELECT
    "object_id",
    TO_VARCHAR(TO_TIMESTAMP_NTZ("metadata_date" / 1e6), 'YYYY-MM-DD') AS "formatted_metadata_date"
FROM
    "THE_MET"."THE_MET"."OBJECTS"
LIMIT 1000;
```
2025-01-17 20:02:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:02:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:02:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:02:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-17 20:02:38 - snowflake.connector.connection - INFO - closed
2025-01-17 20:02:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:02:38 - root - INFO - SQL:
SELECT
    "object_id",
    TO_VARCHAR(TO_TIMESTAMP_NTZ("metadata_date" / 1e6), 'YYYY-MM-DD') AS "formatted_metadata_date"
FROM
    "THE_MET"."THE_MET"."OBJECTS"
LIMIT 1000;
Results:
Too long, hard cut:
object_id,formatted_metadata_date
646996,2017-02-06
77916,2017-02-06
38009,2017-02-06
37988,2017-02-06
74660,2017-02-06
74674,2017-02-06
74675,2017-02-06
74677,2017-02-06
74685,2017-02-06
65595,2017-02-06
73261,2017-02-06
38042,2017-02-06
39894,2017-02-06
64891,2017-02-06
65590,2017-02-06
65594,2017-02-06
40445,2017-02-06
45063,2017-02-06
40069,2017-02-06
40070,2017-02-06
37964,2017-02-06
75084,2017-02-06
75085,2017-02-06
75086,2017-02-06
75087,2017-02-06
75088,2017-02-06
75089,2017-02-06
75090,2017-02-06
75091,2017-02-06
75092,2017-02-06
75093,2017-02-06
75094,2017-02-06
75095,2017-02-06
75096,2017-02-06
75097,2017-02-06
75098,2017-02-06
75099,2017-02-06
75100,2017-02-06
75101,2017-02-06
75102,2017-02-06
75103,2017-02-06
75104,2017-02-06
75105,2017-02-06
75106,2017-02-06
75107,2017-02-06
75108,2017-02-06
75109,2017-02-06
75110,2017-02-06
75111,2017-02-06
75112,2017-02-06
75113,2017-02-06
75114,2017-02-06
75115,2017-02-06
75116,2017-02-06
75117,2017-02-06
75118,2017-02-06
75119,2017-02-06
75120,2017-02-06
75121,2017-02-06
75122,2017-02-06
75123,2017-02-06
75124,2017-02-06
75125,2017-02-06
75126,2017-02-06
75127,2017-02-06
75128,2017-02-06
75129,2017-02-06
75130,2017-02-06
75131,2017-02-06
75132,2017-02-06
75133,2017-02-06
75134,2017-02-06
75135,2017-02-06
75136,2017-02-06
75137,2017-02-06
75138,2017-02-06
75139,2017-02-06
75140,2017-02-06
75141,2017-02-06
75142,2017-02-06
75143,2017-02-06
75145,2017-02-06
75146,2017-02-06
75147,2017-02-06
75148,2017-02-06
75149,2017-02-06
75150,2017-02-06
75151,2017-02-06
75152,2017-02-06
75153,2017-02-06
54912,2017-02-06
38448,2017-02-06
40429,2017-02-06
40432,2017-02-06
73188,2017-02-06
74683,2017-02-06
72589,2017-02-06
74656,2017-02-06
64046,2017-02-06
39899,2017-02-06
36145,2017-02-06
49665,2017-02-06
36130,2017-02-06
36435,2017-02-06
36036,2017-02-06
36072,2017-02-06
49133,2017-02-06
65620,2017-02-06
40021,2017-02-06
49453,2017-02-06
49134,2017-02-06
65075,2017-02-06
41468,2017-02-06
40507,2017-02-06
40052,2017-02-06
35995,2017-02-06
35999,2017-02-06
36003,2017-02-06
45786,2017-02-06
73669,2017-02-06
49179,2017-02-06
49226,2017-02-06
51727,2017-02-06
51705,2017-02-06
51528,2017-02-06
51656,2017-02-06
51644,2017-02-06
36129,2017-02-06
51770,2017-02-06
64029,2017-02-06
60764,2017-02-06
51902,2017-02-06
64045,2017-02-06
36439,2017-02-06
40285,2017-02-06
40107,2017-02-06
40180,2017-02-06
40194,2017-02-06
40060,2017-02-06
40058,2017-02-06
45684,2017-02-06
45746,2017-02-06
39766,2017-02-06
45749,2017-02-06
44574,2017-02-06
45775,2017-02-06
45780,2017-02-06
51865,2017-02-06
77914,2017-02-06
48875,2017-02-06
48955,2017-02-06
48954,2017-02-06
49025,2017-02-06
49029,2017-02-06
56553,2017-02-06
41780,2017-02-06
39625,2017-02-06
48931,2017-02-06
48928,2017-02-06
48959,2017-02-06
49129,2017-02-06
49146,2017-02-06
49147,2017-02-06
49163,2017-02-06
51894,2017-02-06
36132,2017-02-06
51900,2017-02-06
75814,2017-02-06
54308,2017-02-06
55495,2017-02-06
49473,2017-02-06
35987,2017-02-06
44570,2017-02-06
40105,2017-02-06
40509,2017-02-06
42329,2017-02-06
39918,2017-02-06
39919,2017-02-06
40103,2017-02-06
40104,2017-02-06
41777,2017-02-06
41860,2017-02-06
40018,2017-02-06
41778,2017-02-06
41782,2017-02-06
63196,2017-02-06
63185,2017-02-06
49047,2017-02-06
50549,2017-02-06
53924,2017-02-06
53925,2017-02-06
53926,2017-02-06
53927,2017-02-06
53928,2017-02-06
53929,2017-02-06
42323,2017-02-06
36236,2017-02-06
36098,2017-02-06
72711,2017-02-06
72712,2017-02-06
36201,2017-02-06
44567,2017-02-06
49617,2017-02-06
36208,2017-02-06
36205,2017-02-06
36206,2017-02-06
36211,2017-02-06
36210,2017-02-06
36216,2017-02-06
49629,2017-02-06
49630,2017-02-06
41504,2017-02-06
49603,2017-02-06
49604,2017-02-06
49605,2017-02-06
49607,2017-02-06
36202,2017-02-06
49608,2017-02-06
49606,2017-02-06
49614,2017-02-06
49615,2017-02-06
49663,2017-02-06
49664,2017-02-06
49626,2017-02-06
49627,2017-02-06
36222,2017-02-06
36224,2017-02-06
49623,2017-02-06
40311,2017-02-06
45652,2017-02-06
39901,2017-02-06
39959,2017-02-06
51762,2017-02-06
40062,2017-02-06
40057,2017-02-06
40094,2017-02-06
36052,2017-02-06
40053,2017-02-06
36055,2017-02-06
44506,2017-02-06
44507,2017-02-06
44508,2017-02-06
44509,2017-02-06
44510,2017-02-06
40278,2017-02-06
41479,2017-02-06
45661,2017-02-06
41478,2017-02-06
44699,2017-02-06
44590,2017-02-06
45675,2017-02-06
36123,2017-02-06
45683,2017-02-06
45682,2017-02-06
39483,2017-02-06
36093,2017-02-06
45752,2017-02-06
45779,2017-02-06
44601,2017-02-06
45776,2017-02-06
39654,2017-02-06
45802,2017-02-06
45797,2017-02-06
44606,2017-02-06
45815,2017-02-06
36135,2017-02-06
45032,2017-02-06
48934,2017-02-06
48932,2017-02-06
36070,2017-02-06
48949,2017-02-06
48952,2017-02-06
48953,2017-02-06
48951,2017-02-06
41480,2017-02-06
48950,2017-02-06
48969,2017-02-06
35988,2017-02-06
39713,2017-02-06
49019,2017-02-06
49021,2017-02-06
39717,2017-02-06
49074,2017-02-06
41470,2017-02-06
39558,2017-02-06
44759,2017-02-06
37395,2017-02-06
35998,2017-02-06
35990,2017-02-06
48948,2017-02-06
36022,2017-02-06
36021,2017-02-06
3

2025-01-17 20:02:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:02:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:02:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:02:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-17 20:02:40 - snowflake.connector.connection - INFO - closed
2025-01-17 20:02:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:02:40 - root - INFO - SQL:
SELECT DISTINCT t1."object_id"
    FROM "THE_MET"."THE_MET"."OBJECTS" t1
    WHERE t1."object_id" IN (SELECT t2."object_id" FROM "THE_MET"."THE_MET"."VISION_API_DATA" t2)
    LIMIT 1000;
Results:
Too long, hard cut:
object_id
2704
308689
546942
204339
343127
578666
202859
104470
201749
239562
113100
393606
449595
308332
546355
226289
568716
90391
388318
453272
196116
340669
506171
447997
310223
214796
325122
345467
75091
9595
438947
681278
285647
559821
189458
562094
37216
12182
445763
450642
5419
199611
227360
67391
59408
247783
431194
457582
422120
406563
188922
203055
55166
478568
371380
555174
2416
44426
339104
21919
26327
463240
9524
191065
457103
706476
47379
463793
198114
450362
325404
390599
422167
198525
58006
195003
119817
114692
457652
240352
209420
188252
42427
552608
437585
410925
551448
407097
194942
407117
188790
336026
5289
50060
201833
559049
200413
246607
261842
12440
245736
557048
244998
309966
543956
188673
437278
459218
287224
104125
68945
339364
371330
229917
72238
363718
50567
248996
190932
2408
222298
322041
53294
470655
239820
53829
187333
257058
446239
67544
503844
565871
203436
214013
323916
40927
68909
226694
408387
555482
192752
324194
504522
243266
264982
446997
666123
548861
710927
466754
70494
623386
158967
37980
196881
411307
464566
550160
337920
342718
58774
210720
255152
288478
284874
14307
464662
244603
340690
5179
200942
360519
505106
45222
22067
471572
335099
355297
429577
396961
334118
38406
8247
483721
254598
259152
548918
443429
386602
255180
693149
189464
157645
26505
12536
459756
364657
546319
562783
680079
90509
16479
705848
367283
49457
377640
356327
307641
11625
460911
33416
56864
237794
463400
247677
228953
238890
706447
200075
409358
361716
205579
287227
339329
202452
391036
225069
373934
209332
577252
446349
334221
413447
223568
347404
345491
21355
453299
196921
383677
461279
7769
247850
386092
267987
56069
52471
14731
355377
227192
60626
15944
59160
66715
173422
644465
675898
239801
56922
244892
241006
219348
326425
62198
324507
396903
2193
360743
256149
159420
485547
156406
549444
36888
215354
57442
465046
504201
450132
318649
243795
446749
67933
545185
36512
443619
13621
314494
394016
12834
12607
342590
204646
343059
55498
372991
3115
55814
571945
22070
652440
438033
3984
465583
457316
444199
58940
639405
823
547995
189855
412508
52709
112933
548932
680464
361656
683
479299
549079
186434
659535
60605
573130
363050
484644
46970
156996
188916
571089
62954
49194
451272
62577
623258
576998
59290
13629
72203
317567
384993
423149
68580
224024
222421
469942
245457
69832
577208
206032
66737
544918
475263
481037
559797
43157
383012
66211
252392
214228
230476
219561
217194
325260
35629
230414
222656
414878
62094
37256
261879
369623
13261
218670
222954
549709
219215
193590
69419
198916
550253
21304
403876
248778
336035
325661
415234
60076
384176
205025
365723
340883
173651
502513
422679
50573
400084
370772
55583
69748
391283
624385
316578
12592
451933
58507
545033
37915
59434
22876
12271
460185
221130
43187
364110
552304
193609
213469
467233
437311
408555
243638
242983
662923
186301
376110
444840
53301
222763
400876
322240
19022
45251
119566
659539
124281
248903
66746
443823
226358
342218
396339
358404
448856
204773
58068
336919
204903
259583
197660
217269
327288
548995
449010
662608
63819
195268
251134
316963
244132
62974
451734
416148
465537
437637
323960
216309
418593
450455
187528
68385
15807
156171
554596
67545
445502
323504
287368
223496
447928
188353
60125
336339
376307
253044
124189
436274
251197
428762
339191
36657
72223
201353
64336
1999
338222
68751
545016
363506
570666
340835
19099
191825
115295
308667
13749
406656
193723
55737
412057
47853
39371
13761
247626
216991
388259
546214
54418
394031
545905
227841
477767
50859
393665
317533
156174
308015
445280
10184
390689
463039
287770
370485
652955
389415
243899
44118
205984
243818
470868
222408
562061
70179
45063
192669
143
571613
86350
30850
462952
86757
194633
446891
5769
41117
227393
309186
436436
46283
373153
559066
246399
400955
214012
13597
348339
590760
68355
3441
43810
549703
216725
51416
10353
288532
451149
62907
190588
323613
240089
5850
256132
464474
267665
660008
66172
241423
168761
240128
544006
26309
26598
51478
228808
11488
239155
458958
21185
209571
90999
219262
466626
307937
548969
403674
4154
464905
384959
14626
545300
323353
447006
251053
448208
13000
684053
460166
661791
16319
369356
650866
341660
324310
386617
192048
26568
5133
251138
694344
414932
364742
348771
70670
316713
410377
310218
69717
685806
341439
670645
204120
60283
414949
228086
224317
444423
659075
13384
43039
327381
554326
324800
553870
202382
65837
316818
415603
336855
321658
13799
408913
221970
463870
221857
437273
40871
346399
400618
443296
207934
10141
232033
465980
419903
73419
567611
65986
410444
570431
22394
218093
449337
435788
395546
123233
552455
545203
383824
334422
66524
199891
2487
704860
448081
53281
26529
168342
400020
467909
452027
47115
13074
188867
463702
268226
229689
393249
573092
465683
345033
544238
411473
195610
69838
23396
476394
588380
325897
8405
463927
547562
10945
327345
15448
406908
32356
269560
8273
369251
185904
26429
23161
460499
692598
12848
443778
51150
263219
121214
407562
223055
446115
215128
447890


2025-01-17 20:02:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:02:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:02:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:02:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-17 20:02:42 - snowflake.connector.connection - INFO - closed
2025-01-17 20:02:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:03:11 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:03:11 - root - INFO - ```sql
SELECT
    o."object_id",
    o."title",
    TO_CHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM
    "THE_MET"."THE_MET"."OBJECTS" AS o
JOIN
    "THE_MET"."THE_MET"."VISION_API_DATA" AS v
    ON o."object_id" = v."object_id"
WHERE
    o."department" = 'The Libraries'
    AND LOWER(o."title") LIKE '%book%'
```
2025-01-17 20:03:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:03:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:03:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:03:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-17 20:03:12 - snowflake.connector.connection - INFO - closed
2025-01-17 20:03:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:03:13 - root - INFO - SQL:
SELECT
    o."object_id",
    o."title",
    TO_CHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM
    "THE_MET"."THE_MET"."OBJECTS" AS o
JOIN
    "THE_MET"."THE_MET"."VISION_API_DATA" AS v
    ON o."object_id" = v."object_id"
WHERE
    o."department" = 'The Libraries'
    AND LOWER(o."title") LIKE '%book%'
Results:
object_id,title,metadata_date
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc.",2017-02-06
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06

2025-01-17 20:03:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:03:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:03:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:03:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-17 20:03:14 - snowflake.connector.connection - INFO - closed
2025-01-17 20:03:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:03:14 - root - INFO - SQL:
SELECT "object_id", "title"
    FROM "THE_MET"."THE_MET"."OBJECTS"
    WHERE "department" = 'The Libraries' AND LOWER("title") LIKE '%book%';
Results:
object_id,title
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found"
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts"
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work"
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc."

2025-01-17 20:03:14 - root - INFO - itercount: 0
2025-01-17 20:03:14 - root - INFO - Database Name: THE_MET
Schema Name: THE_MET
DDL describes table information.
,0
table_name,VISION_API_DATA
description,
DDL,"create or replace TABLE VISION_API_DATA (
	""object_id"" NUMBER(38,0),
	""faceAnnotations"" VARIANT,
	""landmarkAnnotations"" VARIANT,
	""cropHintsAnnotation"" VARIANT,
	""logoAnnotations"" VARIANT,
	""labelAnnotations"" VARIANT,
	""textAnnotations"" VARIANT,
	""fullTextAnnotation"" VARCHAR(16777216),
	""imagePropertiesAnnotation"" VARIANT,
	""safeSearchAnnotation"" VARCHAR(16777216),
	""webDetection"" VARIANT
);"

,1
table_name,IMAGES
description,
DDL,"create or replace TABLE IMAGES (
	""object_id"" NUMBER(38,0),
	""public_caption"" VARCHAR(16777216),
	""title"" VARCHAR(16777216),
	""original_image_url"" VARCHAR(16777216),
	""caption"" VARCHAR(16777216),
	""is_oasc"" BOOLEAN,
	""gcs_url"" VARCHAR(16777216)
);"

,2
table_name,OBJECTS
description,
DDL,"create or replace TABLE OBJECTS (
	""object_number"" VARCHAR(16777216),
	""is_highlight"" BOOLEAN,
	""is_public_domain"" BOOLEAN,
	""object_id"" NUMBER(38,0),
	""department"" VARCHAR(16777216),
	""object_name"" VARCHAR(16777216),
	""title"" VARCHAR(16777216),
	""culture"" VARCHAR(16777216),
	""period"" VARCHAR(16777216),
	""dynasty"" VARCHAR(16777216),
	""reign"" VARCHAR(16777216),
	""portfolio"" VARCHAR(16777216),
	""artist_role"" VARCHAR(16777216),
	""artist_prefix"" VARCHAR(16777216),
	""artist_display_name"" VARCHAR(16777216),
	""artist_display_bio"" VARCHAR(16777216),
	""artist_suffix"" VARCHAR(16777216),
	""artist_alpha_sort"" VARCHAR(16777216),
	""artist_nationality"" VARCHAR(16777216),
	""artist_begin_date"" VARCHAR(16777216),
	""artist_end_date"" VARCHAR(16777216),
	""object_date"" VARCHAR(16777216),
	""object_begin_date"" NUMBER(38,0),
	""object_end_date"" NUMBER(38,0),
	""medium"" VARCHAR(16777216),
	""dimensions"" VARCHAR(16777216),
	""credit_line"" VARCHAR(16777216),
	""geography_type"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""subregion"" VARCHAR(16777216),
	""locale"" VARCHAR(16777216),
	""locus"" VARCHAR(16777216),
	""excavation"" VARCHAR(16777216),
	""river"" VARCHAR(16777216),
	""classification"" VARCHAR(16777216),
	""rights_and_reproduction"" VARCHAR(16777216),
	""link_resource"" VARCHAR(16777216),
	""metadata_date"" NUMBER(38,0),
	""repository"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'THE_MET': {'THE_MET': ['IMAGES', 'OBJECTS', 'VISION_API_DATA']}}
Begin Exploring Related Columns
Sure, let's consider the relevant tables, columns, and potential usage for the task.

### Relevant Tables and Columns:

**From `OBJECTS` table:**

- **"object_id"**: Used to join with the `VISION_API_DATA` table.
- **"title"**: To retrieve the object's title and filter titles containing the word "book".
- **"metadata_date"**: To retrieve and format as a string in 'YYYY-MM-DD' format.
- **"department"**: Used to filter objects belonging to "The Libraries" department.

**From `VISION_API_DATA` table:**

- **"object_id"**: Used to join with the `OBJECTS` table.
- **"cropHintsAnnotation"**: A VARIANT column containing JSON data; used to extract "cropConfidence" value for filtering where "cropConfidence" > 0.5.

### Conditions that May Be Used:

- **"department" = 'The Libraries'**
- **"title" contains 'book'** (case-insensitive match)
- **"cropConfidence" > 0.5**

### SQL Queries to Understand the Data:

1. **Retrieve distinct departments from the `OBJECTS` table:**

   ```sql
   SELECT DISTINCT "department" FROM "THE_MET"."THE_MET"."OBJECTS";
   ```

2. **Find titles containing the word 'book' in the `OBJECTS` table:**

   ```sql
   SELECT DISTINCT "title"
   FROM "THE_MET"."THE_MET"."OBJECTS"
   WHERE LOWER("title") LIKE '%book%';
   ```

3. **View sample metadata dates from the `OBJECTS` table:**

   ```sql
   SELECT "metadata_date"
   FROM "THE_MET"."THE_MET"."OBJECTS"
   LIMIT 1000;
   ```

4. **Retrieve object IDs from the `OBJECTS` table where department is 'The Libraries':**

   ```sql
   SELECT "object_id"
   FROM "THE_MET"."THE_MET"."OBJECTS"
   WHERE "department" = 'The Libraries';
   ```

5. **Retrieve object IDs and titles from the `OBJECTS` table where title contains 'book':**

   ```sql
   SELECT "object_id", "title"
   FROM "THE_MET"."THE_MET"."OBJECTS"
   WHERE LOWER("title") LIKE '%book%';
   ```

6. **Retrieve distinct object IDs from the `VISION_API_DATA` table:**

   ```sql
   SELECT DISTINCT "object_id"
   FROM "THE_MET"."THE_MET"."VISION_API_DATA";
   ```

7. **View sample `cropHintsAnnotation` data from `VISION_API_DATA`:**

   ```sql
   SELECT "cropHintsAnnotation"
   FROM "THE_MET"."THE_MET"."VISION_API_DATA"
   LIMIT 1000;
   ```

8. **Extract `cropHints` field from `cropHintsAnnotation`:**

   ```sql
   SELECT f.value:"cropHints"
   FROM "THE_MET"."THE_MET"."VISION_API_DATA" t,
   LATERAL FLATTEN(input => t."cropHintsAnnotation") f
   LIMIT 1000;
   ```

9. **Extract `confidence` values from `cropHintsAnnotation`:**

   ```sql
   SELECT f.value:"cropHints"[0]:"confidence"::FLOAT AS "cropConfidence"
   FROM "THE_MET"."THE_MET"."VISION_API_DATA" t,
   LATERAL FLATTEN(input => t."cropHintsAnnotation") f
   LIMIT 1000;
   ```

10. **Retrieve object IDs and `cropHintsAnnotation` where `cropHintsAnnotation` is not null:**

    ```sql
    SELECT "object_id", "cropHintsAnnotation"
    FROM "THE_MET"."THE_MET"."VISION_API_DATA"
    WHERE "cropHintsAnnotation" IS NOT NULL
    LIMIT 1000;
    ```

11. **Retrieve sample values of `title` and `department` for objects:**

    ```sql
    SELECT "title", "department"
    FROM "THE_MET"."THE_MET"."OBJECTS"
    LIMIT 1000;
    ```

12. **Retrieve object IDs and formatted `metadata_date` from `OBJECTS`:**

    ```sql
    SELECT "object_id", TO_VARCHAR(TO_DATE("metadata_date"), 'YYYY-MM-DD') AS "formatted_metadata_date"
    FROM "THE_MET"."THE_MET"."OBJECTS"
    LIMIT 1000;
    ```

13. **List all object IDs present in both `OBJECTS` and `VISION_API_DATA`:**

    ```sql
    SELECT DISTINCT t1."object_id"
    FROM "THE_MET"."THE_MET"."OBJECTS" t1
    WHERE t1."object_id" IN (SELECT t2."object_id" FROM "THE_MET"."THE_MET"."VISION_API_DATA" t2)
    LIMIT 1000;
    ```

14. **Check for null values in `metadata_date`:**

    ```sql
    SELECT "object_id", "metadata_date"
    FROM "THE_MET"."THE_MET"."OBJECTS"
    WHERE "metadata_date" IS NULL
    LIMIT 1000;
    ```

15. **Retrieve `object_id` and `title` from `OBJECTS` where `department` is 'The Libraries' and `title` contains 'book':**

    ```sql
    SELECT "object_id", "title"
    FROM "THE_MET"."THE_MET"."OBJECTS"
    WHERE "department" = 'The Libraries' AND LOWER("title") LIKE '%book%';
    ```

These queries help explore the relevant tables and columns to better understand the data needed for the task.Query:
SELECT DISTINCT "department" FROM "THE_MET"."THE_MET"."OBJECTS";
Answer:
department
Asian Art
Islamic Art
Photographs
Medieval Art
The Cloisters
The Libraries
Arms and Armor
Costume Institute
European Paintings
Drawings and Prints
Greek and Roman Art
Musical Instruments
Ancient Near Eastern Art
Robert Lehman Collection
Modern and Contemporary Art
American Paintings and Sculpture
"Arts of Africa, Oceania, and the Americas"
American Decorative Arts
European Sculpture and Decorative Arts
Egyptian Art
Query:
SELECT DISTINCT "title"
   FROM "THE_MET"."THE_MET"."OBJECTS"
   WHERE LOWER("title") LIKE '%book%';
Answer:
Too long, hard cut:
title
明     郭詡     稱書圖     軸|Weighing Books
明     杜堇     伏生授經圖   軸|The Scholar Fu Sheng Transmitting the Book of Documents
画本宝能縷|Picture Book of Brocades with Precious Threads (Ehon takara no itosuji)
絵本松のしらべ|Picture Book on the Music of the Pine Trees (Ehon matsu no shirabe)
『和国諸職絵尽　諸織 絵本鏡』|A Picture Book Mirror of Various Occupations (Wakoku shoshoku ezukushi)
Ehon Asakayama|絵本浅香山|Picture Book: Mount Asaka (Ehon Asakayama)
Ehon Ogurayama|絵本小倉山|Picture Book: Ogura Hill (Ehon Ogurayama)
Ehon Himetsubaki|繪本女貞木|Picture Book: Camellia (Ehon Himetsubaki)
『繪本小倉山』|Picture Book of Ogura Hill (Ehon ogurayama)
『繪本小松原』|Picture Book of Komatsubara (Ehon komatsubara)
『寫山樓畫本』|Shazanrō (Bunchō) Picture Book (Shazanrō ehon)
『絵本時世粧』|Picture Book of Modern Figures of Fashion (Ehon imayō sugata)
絵本吾妻遊|Ehon Azuma asobi|Picture Book of Amusements of the Eastern Capital (Ehon Azuma asobi)
Ehon Momochidori Kyōka-awase|百千鳥狂歌合|Myriad Birds: Picture Book of Playful Verse (Momo chidori kyōka-awase)
潮干のつと|Gifts from the Ebb Tide (The Shell Book) (Shiohi no tsuto)
繪本四季花|Picture Book of Flowers of the Four Seasons (Ehon shiki no hana)
『画本狂歌山満多山』|Picture Book of Kyōka Poems: Mountains upon Mountains (Ehon kyōka yama mata yama)
『絵本和漢誉』|Picture Book on Heroes of China and Japan (Ehon wakan no homare)
絵本和歌夷 「龢謌夷」|Picture Book with Playful Poems for the Young God Ebisu
画本虫撰|Picture Book of Crawling Creatures (The Insect Book) (Ehon mushi erami)
『青楼繪本年中行事』|Yoshiwara Picture Book of New Year’s Festivities (Seirō ehon nenjū gyōji)
『暁斎漫画』|Kyōsai Sketchbook (Kyōsai manga)
"『閨の雛形』　正月|Plate from the Erotic Book Mounds of Dyed Colors: A Pattern Book for the Boudoir (Someiro no yama neya no hinagata), First Month"
"『画本虫撰』  「虻」「芋虫」|Horsefly (abu); Green Caterpillar, imomushi, from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』   「松虫」「虫蛍」|Tree cricket (Matsumushi); Firefly (Hotaru), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"画本虫撰　バッタと蟷螂|Cone-headed Grasshopper or Locust, (batta); Praying Mantis (Tōrō or Kamakiri), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"四季の花|Women on a Bridge, from the illustrated book Flowers of the Four Seasons"
"四季の花|A Child Lighting Fireworks, from the illustrated book Flowers of the Four Seasons"
"四季の花|Girls Getting on Board a Boat, from the illustrated book Flowers of the Four Seasons"
"四季の花|New Year's Games, from the printed book Flowers of the Four Seasons (Shiki no hana)"
"『雛形若菜初模様　玉や内　しら玉』|The Courtesan Shiratama of the Tamaya Brothel, from the series “A Pat-tern Book of the Year’s First Designs, Fresh as Spring Herbs” (“Hinagata wakana hatsu moyō”)"
"『雛形若菜初模様　四ツ目屋内　にしき木』|The Courtesan Nishikigi of the Yotsumeya Brothel, from the series “A Pattern Book of the Year’s First Designs, Fresh as Spring Herbs” (“Hinagata wakana hatsu moyō”)"
"『雛形若菜の初模様　扇屋内　七越』|The Courtesan Nanakoshi of the Ōgiya Brothel, from the series “A Pat-tern Book of the Year’s First Designs, Fresh as Spring Herbs” (“Hinagata wakana no hatsu moyō”)"
"『画本虫撰』   「けら」「はさみむし」|Mole Cricket (Kera); Earwig, (Hasami-mushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』「蝸牛」「轡虫」|Land Snail (Katatsumuri); Giant Katydid (Kutsuwamushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"Kamakura no Koshi|The Filial Son at Kamakura, From the Book: Sasekishu"
"『雛形若菜の初模様　つたや内　人まち』|The Courtesan Hitomachi of the Tsutaya Brothel, from the series “A Pat-tern Book of the Year’s First Designs, Fresh as Spring Herbs” (“Hinagata wakana no hatsu moyō”)"
[Woman in Robes Reading a Book]
[Seated Man Pointing to a Passage in an Open Book]
"Manuscript Illumination with the Visitation in an Initial D, from a Choir Book"
"Manuscript Leaf with Adoration of the Holy Name, from a Book of Hours"
The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans
"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work"
"London Chair-Makers' and Carvers' Book of Prices, for Workmanship..."
"The Oxford Drawing Book to which is added, Lessons in Flower Drawing"
A Booke of Christian Prayers
"Sketch Book Containing 182 drawings on 91 leaves. One of a series used by the artist on his Italian trip, 1750–52; Sketches made in Milan, Turin, Florence, and Rome."
Compendium of Architectural Books by Sebastiano Serlio (Books I-V)
The Architecture of A. Palladio in Four Books containing a Short Treatise on the Five Orders (L'Architecture de A. Palladio en quatre livres... / Il quattro libri dell'architettura)
Book of Designs [for Ironwork]
"St. Luke, seated on a cloud with an open book in both hands, a bull lying at his feet, from a series of the four evangelists after Agostino Veneziano, which are in turn after Giulio Romano"
"Dialectic: a young woman standing in a decorated interior and touching her right index finger to her left middle finger in a counting gesture, at he
Query:
SELECT "metadata_date"
   FROM "THE_MET"."THE_MET"."OBJECTS"
   LIMIT 1000;
Answer:
Too long, hard cut:
metadata_date
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
14863
Query:
SELECT "object_id"
   FROM "THE_MET"."THE_MET"."OBJECTS"
   WHERE "department" = 'The Libraries';
Answer:
object_id
682011
681546
681534
681389
591832
591860
591831
591865
591848
591863
681573
682013
681149
681556
681388
680835
681547
681545
682014
681128
682012
681563
716648
705290
715005
739504
726677
716639
699505
697348
681349
591837
591862
591836
700238
738466
700032
700050
738463
704714
700240
738758
700232
700091
738765
682010
681259
726717
707455
726673
726669
681246
679732
726678
591835
681559
591839
681502
680708
682015
681386
679476
681551
680818
680752
591844
591849
591830
591824
591834
591854
591840
591864
591841
591855
591842
681372
591845
591847
591829
591828
591825
591827
681554
591857
591850
591852
591853
591859
591858
591861
591843
681357
680832
679629
679465
724625
591826
591838
591833
705638
681274
681504
678732
680821
682098
680318
591856
681384
591851
591846
591868
734108
734109
734110
734111
738516
680819
679638
681269
Query:
SELECT "object_id", "title"
   FROM "THE_MET"."THE_MET"."OBJECTS"
   WHERE LOWER("title") LIKE '%book%';
Answer:
Too long, hard cut:
object_id,title
39483,明     郭詡     稱書圖     軸|Weighing Books
39667,明     杜堇     伏生授經圖   軸|The Scholar Fu Sheng Transmitting the Book of Documents
57754,画本宝能縷|Picture Book of Brocades with Precious Threads (Ehon takara no itosuji)
78593,絵本松のしらべ|Picture Book on the Music of the Pine Trees (Ehon matsu no shirabe)
78688,『和国諸職絵尽　諸織 絵本鏡』|A Picture Book Mirror of Various Occupations (Wakoku shoshoku ezukushi)
53815,Ehon Asakayama|絵本浅香山|Picture Book: Mount Asaka (Ehon Asakayama)
45062,"絵本末摘花|Picture Book: Flowers Yet to be Picked, Vol. 1"
57842,Ehon Ogurayama|絵本小倉山|Picture Book: Ogura Hill (Ehon Ogurayama)
57858,Ehon Himetsubaki|繪本女貞木|Picture Book: Camellia (Ehon Himetsubaki)
78723,『繪本常盤草』|Picture Book of the Evergreens (Ehon tokiwagusa)
78728,『繪本小倉山』|Picture Book of Ogura Hill (Ehon ogurayama)
78729,『繪本小松原』|Picture Book of Komatsubara (Ehon komatsubara)
78722,絵本常盤草　上・中・下|Picture Book of the Evergreens (Ehon tokiwagusa)
78585,『寫山樓畫本』|Shazanrō (Bunchō) Picture Book (Shazanrō ehon)
78739,『絵本時世粧』|Picture Book of Modern Figures of Fashion (Ehon imayō sugata)
78597,艶本 婦慈のゆき|An Erotic Picture Book of Snow on Fuji (Enpon fuji no yuki)
45273,絵本吾妻遊|Ehon Azuma asobi|Picture Book of Amusements of the Eastern Capital (Ehon Azuma asobi)
57568,Ehon Momochidori Kyōka-awase|百千鳥狂歌合|Myriad Birds: Picture Book of Playful Verse (Momo chidori kyōka-awase)
57605,絵本和歌夷 「龢謌夷」|Picture Book with Playful Poems for the Young God Ebisu
57648,潮干のつと|Gifts from the Ebb Tide (The Shell Book) (Shiohi no tsuto)
57569,画本虫撰|Picture Book of Crawling Creatures (The Insect Book) (Ehon mushi erami)
57570,画本虫撰|Picture Book of Crawling Creatures (The Insect Book) (Ehon mushi erami)
45322,繪本四季花|Picture Book of Flowers of the Four Seasons (Ehon shiki no hana)
78746,『青楼繪本年中行事』|Yoshiwara Picture Book of New Year’s Festivities (Seirō ehon nenjū gyōji)
78758,（榎木新右衛門）画 『雛形伊勢乃海』|Book of Kosode Patterns (Hiinagata Ise no umi)
45444,Ehon Musashi no Abumi|A Picture Book of Japanese Warriors
78635,『画本狂歌山満多山』|Picture Book of Kyōka Poems: Mountains upon Mountains (Ehon kyōka yama mata yama)
78771,"繪本彩色通　初編|Picture Book on the Use of Coloring, first volume (Ehon saishikitsū shohen)"
78772,『絵本和漢誉』|Picture Book on Heroes of China and Japan (Ehon wakan no homare)
78667,『暁斎漫画』|Kyōsai Sketchbook (Kyōsai manga)
55597,"『閨の雛形』　正月|Plate from the Erotic Book Mounds of Dyed Colors: A Pattern Book for the Boudoir (Someiro no yama neya no hinagata), First Month"
37283,"『画本虫撰』  「蜂」「毛虫」|Paper Wasp (Hachi); Hairy Caterpillar (Kemushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37284,"『画本虫撰』   「馬追虫」「むかて」|Katydid (Umaoi-mushi); Centipede, (Mukade), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37285,"『画本虫撰』   「けら」「はさみむし」|Mole Cricket (Kera); Earwig, (Hasami-mushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37286,"『画本虫撰』   「蝶」「蜻蛉」|Butterfly (Chō); Dragonfly (Kagerō or Tonbo), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37287,"『画本虫撰』  「虻」「芋虫」|Horsefly (abu); Green Caterpillar, imomushi, from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37288,"『画本虫撰』   「松虫」「虫蛍」|Tree cricket (Matsumushi); Firefly (Hotaru), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37289,"画本虫撰　バッタと蟷螂|Cone-headed Grasshopper or Locust, (batta); Praying Mantis (Tōrō or Kamakiri), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37290,"『画本虫撰』 「ひくらし」「くも」|Evening Cicada, Higurashi; Spider, Kumo, from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37291,"『画本虫撰』「赤蜻蛉」「いなこ」|Red Dragonfly (Akatonbo); Locust (Inago), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37292,"『画本虫撰』「虵」「とかけ」|Rat Snake (Hebi); Lizard or Skink (Tokage), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37293,"『画本虫撰』「蓑虫」「兜虫」|Bagworm (Minomushi); Horned Scarab Beetle (Kabutomushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37294,"『画本虫撰』「蝸牛」「轡虫」|Land Snail (Katatsumuri); Giant Katydid (Kutsuwamushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37295,"『画本虫撰』「きりきりす」「蝉」|Grasshopper (Kirigirisu); Cicada (Semi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37296,"『画本虫撰』「蚓」「こうろき」|Earthworm (Mimizu); Cricket (Kōrogi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37306,"四季の花|The Coming Thunderstorm, from the illustrated book Flowers of the Four Seasons"
37307,"四季の花|Women on a Bridge, from the illustrated book Flowers of the Four Seasons"
37308,"四季の花|A Child Lighting Fireworks, from the illustrated book Flowers of the Four Seasons"
37309,"四季の花|Girls Getting on Board a Boat, from the illustrated book Flowers of the Four Seasons"
37310,"四季の花|Girls Picking Green Leaves, from the illustrated book Flowers of the Four Seasons"
37311,"四季の花|New Year's Games, from the printed book Flowers of the Four Seasons (Shiki no hana)"
37312,"四季の花|Girls Entertained by Performers, from the illustrated book Flowers of the Four Seasons"
37313,"四季の花
Query:
SELECT DISTINCT "object_id"
   FROM "THE_MET"."THE_MET"."VISION_API_DATA";
Answer:
Too long, hard cut:
object_id
361703
367415
385089
45445
55423
10401
436911
459040
467808
343201
37125
451972
390689
383935
464286
434111
382454
51416
156808
55199
249232
730790
389888
436850
364208
186800
386355
464306
469932
193450
386457
339941
392523
383358
336882
269236
380487
363260
10353
338973
156426
445280
197750
459015
453683
339559
436835
398521
436840
437819
438025
209042
349133
55746
437855
229601
11627
267233
442183
459005
392464
436048
452017
704977
291921
45249
470874
466201
446577
435848
900
10184
436410
156804
339836
464275
437100
288214
333993
437454
467679
488853
436542
334772
402847
392327
45322
4205
4200
288012
436019
326695
394309
460207
392937
478972
290476
4203
408902
13245
342743
384064
193614
458996
37385
698490
288126
343737
371590
45261
207160
358160
351416
547690
286833
451258
204267
344913
4140
436519
307013
643540
435947
549501
385669
49567
367000
12554
435984
286582
365096
388713
199990
395492
263206
625912
36841
390688
32840
455057
200837
464277
359455
248809
289329
436267
6788
447801
114709
13786
252955
471824
342531
306204
407171
376674
460236
342525
339675
56756
436180
198992
459059
359909
458998
459198
458992
336508
464135
361605
288160
467648
63812
463039
390082
20495
260115
399217
393290
56764
189964
335156
294445
268109
438467
468317
430870
55216
55209
288532
467640
437336
437743
285692
194181
707785
306155
301973
437912
471068
239425
282191
249180
186317
13345
242035
73429
316594
57649
195965
403077
644110
436537
45313
12644
32830
268354
352198
670908
471942
385969
464494
684336
437244
464281
260185
286165
459950
44355
199489
466192
291857
696392
335420
392469
388970
289308
366522
371141
463555
656747
335942
287770
260118
717610
342608
678732
414746
4209
340262
263193
436190
37186
412823
54499
645240
348790
506089
374026
10961
205109
192720
261347
11603
416247
467941
242318
435709
54678
436205
428022
358365
261480
189351
291939
335751
187145
398655
467523
195345
383686
260112
349097
392843
76971
288154
435682
17187
369299
670999
205194
469891
387496
460077
334306
334884
269875
652270
716365
285466
436918
437414
386451
736059
294515
370452
203576
436461
461448
464588
291873
291869
390698
435585
435908
436261
392618
708058
357164
56742
291890
37141
271736
435899
437555
260350
54878
382932
668074
435822
645448
205630
227763
292002
390467
238577
437250
262992
291878
712180
385063
288162
54827
455041
467462
548438
204272
437650
437777
399439
190537
635401
339942
682989
436099
55879
437028
657683
650860
466277
204484
468105
371107
436604
269251
11133
470346
467466
197997
415389
460166
398594
702752
201454
205267
36668
44376
659502
437491
269252
55262
341770
435727
446285
437177
196587
367538
209272
397692
56835
266259
646460
436760
198906
54569
13043
399542
435852
679157
370485
464124
463742
37943
361830
199485
468318
467471
390083
382755
55273
466107
449008
388772
199487
469940
12917
186804
186798
399213
60164
437798
505616
299311
463038
44359
201588
269243
435745
55323
459039
188885
285789
466561
286636
12717
188970
10077
437740
306162
437722
459045
227723
73415
471903
438387
471976
55266
460151
437330
246807
460152
250596
474380
123761
246379
40493
271600
72306
550008
313511
64312
409358
324454
326849
212859
57624
695354
561751
243463
740757
326103
25301
588380
700967
214856
249695
23415
241871
323093
554933
548072
549769
464095
474633
26474
214053
450709
317540
471450
29747
455175
546406
213749
200403
324544
471677
246449
27802
5652
464900
269419
502652
189659
647648
420557
646730
204522
257693
198457
551962
58834
548867
252871
551085
445922
58134
546994
560477
247626
501711
267980
45563
414830
406343
646719
467227
29632
556994
454023
694386
250438
557094
324509
414887
225005
255085
6878
55656
309265
60238
675892
464872
553820
463375
315350
315483
475345
545512
44400
323106
75122
565427
7821
327130
70440
252764
213406
214545
221273
326571
59168
317396
67467
562681
548169
472118
450354
443737
204555
219288
694233
221296
259168
41067
66812
38567
317
660954
447642
651239
188315
588368
308667
48549
317153
62545
575094
323110
259165
364356
695319
326707
459288
546384
252854
455223
168449
398641
253817
465619
318214
450226
323065
64355
25491
243479
466509
421138
39307
324204
57887
120716
58635
58339
25573
60528
219486
246028
466750
680203
75016
246347
446324
428679
375777
447194
466764
392604
289215
740825
394314
381621
25098
59649
729885
430189
388598
321806
447997
225008
326668
317289
401668
321728
451145
468806
546847
557355
325996
452706
58279
25447
475542
325495
548349
740777
37208
732432
49391
120762
213800
740780
326961
500952
269881
447122
362652
360623
291946
452937
560345
323649
559185
221124
555034
23675
201116
323702
559492
565837
326018
309054
475427
590822
362921
645512
215002
255455
57476
25259
559013
317066
474504
23669
464937
60853
467300
229738
547990
553870
457103
504482
47790
282180
66913
29526
448793
17505
551959
26004
247783
503347
247764
394031
321561
29701
326886
246778
590759
189329
254468
559509
119173
552394
565765
5567
22802
443581
466445
651683
324954
199789
253258
Query:
SELECT "cropHintsAnnotation"
   FROM "THE_MET"."THE_MET"."VISION_API_DATA"
   LIMIT 1000;
Answer:
Too long, hard cut:
cropHintsAnnotation
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2158,
            ""y"": 0
          },
          {
            ""x"": 2158,
            ""y"": 2871
          },
          {
            ""x"": 0,
            ""y"": 2871
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.700000047683716e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2490,
            ""y"": 0
          },
          {
            ""x"": 2490,
            ""y"": 3340
          },
          {
            ""x"": 0,
            ""y"": 3340
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 1.100000023841858e+00
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 1455,
            ""y"": 0
          },
          {
            ""x"": 1455,
            ""y"": 1899
          },
          {
            ""x"": 0,
            ""y"": 1899
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.700000047683716e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2843,
            ""y"": 0
          },
          {
            ""x"": 2843,
            ""y"": 3734
          },
          {
            ""x"": 0,
            ""y"": 3734
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.799999952316284e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2873,
            ""y"": 0
          },
          {
            ""x"": 2873,
            ""y"": 3982
          },
          {
            ""x"": 0,
            ""y"": 3982
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.599999845027924e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2026,
            ""y"": 0
          },
          {
            ""x"": 2026,
            ""y"": 2555
          },
          {
            ""x"": 0,
            ""y"": 2555
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 5.000000000000000e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2634,
            ""y"": 0
          },
          {
            ""x"": 2634,
            ""y"": 3999
          },
          {
            ""x"": 0,
            ""y"": 3999
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.700000047683716e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2821,
            ""y"": 0
          },
          {
            ""x"": 2821,
            ""y"": 3718
          },
          {
            ""x"": 0,
            ""y"": 3718
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.700000047683716e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2484,
            ""y"": 0
          },
          {
            ""x"": 2484,
            ""y"": 2943
          },
          {
            ""x"": 0,
            ""y"": 2943
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.499999940395355e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2614,
            ""y"": 0
          },
          {
            ""x"": 2614,
            ""y"": 3530
          },
          {
            ""x"": 0,
            ""y"": 3530
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.899999856948853e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
  
Query:
SELECT
    o."object_id",
    o."title",
    TO_VARCHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM
    "THE_MET"."THE_MET"."OBJECTS" AS o
JOIN
    "THE_MET"."THE_MET"."VISION_API_DATA" AS v
    ON o."object_id" = v."object_id"
WHERE
    v."cropHintsAnnotation" IS NOT NULL
    AND v."cropHintsAnnotation":"cropHints"[0]:"confidence"::FLOAT > 0.5
    AND o."department" = 'The Libraries'
    AND LOWER(o."title") LIKE '%book%'
Answer:
object_id,title,metadata_date
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc.",2017-02-06
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06
Query:
SELECT
    o."object_id",
    o."title",
    TO_CHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM
    "THE_MET"."THE_MET"."OBJECTS" AS o
JOIN
    "THE_MET"."THE_MET"."VISION_API_DATA" AS v
        ON o."object_id" = v."object_id"
WHERE
    o."department" = 'The Libraries'
    AND LOWER(o."title") LIKE '%book%'
    AND v."cropHintsAnnotation":"cropHints"[0]:"confidence"::FLOAT > 0.5;
Answer:
object_id,title,metadata_date
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc.",2017-02-06
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06
Query:
SELECT "object_id", "cropHintsAnnotation"
    FROM "THE_MET"."THE_MET"."VISION_API_DATA"
    WHERE "cropHintsAnnotation" IS NOT NULL
    LIMIT 1000;
Answer:
Too long, hard cut:
object_id,cropHintsAnnotation
437177,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 1586,
            ""y"": 0
          },
          {
            ""x"": 1586,
            ""y"": 1907
          },
          {
            ""x"": 0,
            ""y"": 1907
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 5.299999713897705e-01
    }
  ]
}"
437564,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2754,
            ""y"": 0
          },
          {
            ""x"": 2754,
            ""y"": 3418
          },
          {
            ""x"": 0,
            ""y"": 3418
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.499999940395355e-01
    }
  ]
}"
201929,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 1795,
            ""y"": 0
          },
          {
            ""x"": 1795,
            ""y"": 1307
          },
          {
            ""x"": 0,
            ""y"": 1307
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.899999856948853e-01
    }
  ]
}"
397271,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2351,
            ""y"": 0
          },
          {
            ""x"": 2351,
            ""y"": 3999
          },
          {
            ""x"": 0,
            ""y"": 3999
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.599999845027924e-01
    }
  ]
}"
355599,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 1323,
            ""y"": 0
          },
          {
            ""x"": 1323,
            ""y"": 1963
          },
          {
            ""x"": 0,
            ""y"": 1963
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.499999940395355e-01
    }
  ]
}"
412502,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 3648,
            ""y"": 0
          },
          {
            ""x"": 3648,
            ""y"": 2882
          },
          {
            ""x"": 0,
            ""y"": 2882
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.499999940395355e-01
    }
  ]
}"
337337,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2755,
            ""y"": 0
          },
          {
            ""x"": 2755,
            ""y"": 3473
          },
          {
            ""x"": 0,
            ""y"": 3473
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.799999952316284e-01
    }
  ]
}"
209969,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 3999,
            ""y"": 0
          },
          {
            ""x"": 3999,
            ""y"": 2701
          },
          {
            ""x"": 0,
            ""y"": 2701
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.499999940395355e-01
    }
  ]
}"
6039,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 187,
            ""y"": 0
          },
          {
            ""x"": 1695,
            ""y"": 0
          },
          {
            ""x"": 1695,
            ""y"": 1934
          },
          {
            ""x"": 187,
            ""y"": 1934
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 4.299999773502350e-01
    }
  ]
}"
53710,"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 3820,
            ""y"": 0
          },
          {
            ""x"": 3820,
            ""y"": 1866
          },
          {
            ""x"": 0,
            ""y"": 1866
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.999999761581421e-01
    }
  ]
}"
Query:
SELECT "title", "department"
    FROM "THE_MET"."THE_MET"."OBJECTS"
    LIMIT 1000;
Answer:
Too long, hard cut:
title,department
전(傳) 오원 장승업 (1843–1897) 청동기와 화초가 있는 정물화 조선|傳 吾園 張承業 器皿折枝圖 朝鮮|Still life with bronze vessels and flowering plants,Asian Art
석지 채용신    학자 초상|石芝 蔡龍臣 學者肖像|Portrait of a scholar,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
"이유원, 매화도  조선|李裕元 梅花圖  朝鮮|Plum Branch",Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
張旭 「肚痛帖」; 懷素 「寄邊衣」詩|Ji bianyi|Letter about a Stomachache (Du tong tie),Asian Art
東晉 王羲之 十七日帖 十三世紀拓本|On the Seventeenth Day,Asian Art
,Asian Art
近代  丁輔之  荔枝  扇面|Lychees,Asian Art
清  倣龔賢  十二月令山水圖  冊|Landscapes of the Twelve Months,Asian Art
,Asian Art
,Asian Art
清  程正揆  江山臥遊圖  卷|Dream Landscape,Asian Art
清  倣龔賢  雲山隱居圖  軸|Dwelling among Mountains and Clouds,Asian Art
清  倣龔賢  山水圖  冊|Landscapes,Asian Art
清 王翬 倣李成雪霽圖 軸 紙本|Snow Clearing: Landscape after Li Cheng,Asian Art
清  王緣  趙之謙肖像  軸|Portrait of Zhao Zhiqian,Asian Art
清  柳堉  溪山行旅圖  卷|Traveling Amid Streams and Mountains,Asian Art
王翬、楊晉、顧昉、王雲、徐玫 仿古山水圖 冊 紙本|Landscapes after old masters,Asian Art
元  吳鎮  蘆灘釣艇圖  卷|Fisherman,Asian Art
元   趙孟頫   趙雍   趙麟   吳興趙氏三世人馬圖   卷|Grooms and Horses,Asian Art
"南宋 馬和之 詩經小雅鴻雁之什六篇圖 卷|Courtly Odes, Beginning with ""Wild Geese""",Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
清  查昇  行書七律詩  軸|Poem,Asian Art
清  石濤(朱若極)  山水圖  冊|Searching for Immortals,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
唐 颜真卿 顏家廟碑 現代拓片 紙本|Yan Family Temple Stele,Asian Art
太平山水圖|Landscapes of Taiping Prefecture (Taiping shanshui tu),Asian Art
,Asian Art
,Asian Art
唐 傳鍾紹京 楷書靈飛經 冊|Spiritual Flight Sutra,Asian Art
南宋  趙孟堅  行書梅竹詩譜  卷|Poems on Painting Plum Blossoms and Bamboo,Asian Art
南宋   理宗趙昀  行書北宋梅堯臣 依韻和資政侍郎雪後登看山亭詩   團扇|Quatrain on Snow-covered West Lake,Asian Art
,Asian Art
南宋 理宗 趙昀 楷書韓翊 《 潮聲山翠》 聯句 團扇|Couplet from a Poem by Han Hong,Asian Art
南宋  孝宗  行楷書池上水邊聯句  團扇|Couplet on pond scenery,Asian Art
南宋   高宗   草書天山陰雨七絕詩   團扇|Quatrain on Heavenly Mountain,Asian Art
,Asian Art
,Asian Art
明  王鏊  贈別詩  軸|Farewell Poem,Asian Art
,Asian Art
,Asian Art
"明  文徵明  致丈人吳愈書  冊頁|Letter to the Artist's Father-in-law, Wu Yu",Asian Art
,Asian Art
,Asian Art
文彭  行草七律  水墨絹本  鏡框|Poem on Promulgating the Almanac at New Year’s,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
明/清  王鐸  行草書日暮孤亭五律詩  軸|Poem on a Riverside Pavilion,Asian Art
,Asian Art
,Asian Art
晚明  張希黃 留青竹刻 《醉翁亭記》 詩意圖筆筒|Brush holder with “Ode to the Pavilion of the Inebriated Old Man”,Asian Art
,Asian Art
,Asian Art
,Asian Art
清  法若真  行草書畫說  卷|Discourse on Painting,Asian Art
清  朱耷 (八大山人)  李治書  扇頁|Letter by Li Zhi,Asian Art
明/清 朱耷（八大山人） 致方士琯書 冊 紙本|Letters to Fang Shiguan,Asian Art
,Asian Art
"清   金農   論畫雜詩   冊|Poems on Paintings, Written for Ma Yueguan",Asian Art
,Asian Art
,Asian Art
吳煕載  篆書詩經南山有臺|Nutgrass Grows on the Southern Hills,Asian Art
清  趙之謙  隸書引首  卷|The Lingshouhua Studio,Asian Art
清  趙之謙  篆書五言  對聯|Couplet,Asian Art
清  翁同龢  軸|Tiger Calligraphy,Asian Art
,Asian Art
,Asian Art
元 耶律楚材 行書贈別劉滿詩 卷|Poem of Farewell to Liu Man,Asian Art
元  趙孟頫  行書右軍四事  卷|Four anecdotes from the life of Wang Xizhi,Asian Art
元  鄭元祐  楷書師孺齋記  卷|Record of the Following One's Ancestor Studio,Asian Art
北宋 黃庭堅 草書廉頗藺相如傳 卷|Biographies of Lian Po and Lin Xiangru,Asian Art
北宋  米芾  草書吳江舟中詩  卷|Poem Written in a Boat on the Wu River,Asian Art
南宋 楊皇后 楷書薄薄殘妝七絕 團扇冊頁 絹本|Quatrain on spring’s radiance,Asian Art
南宋  楊皇后  楷書瀹雪凝酥七絕  團扇|Quatrain on yellow roses,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
芥子園畫傳|Mountainside View: Page from The Mustard Seed Garden Manual of Painting,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
,Asian Art
近代  張善子  黃山奇松圖  扇頁|Strange Pine in the Yellow Mountain,Asian Art
,Asian Art
清  湯貽汾  墨梅  四冊頁|Blossoming Plum,Asian Art
清  胡遠  山水  四軸|Landscapes of the Four Seasons,Asian Art
近代  王振聲  友梅圖  扇面|Still-life with Plum,Asian Art
近代  吳昌碩  仙芝天竹圖  軸|Spring Offerings,Asian Art
近代  吳昌碩  烹茶圖  橫軸|Brewing Tea,Asian Art
近代  吳昌碩  蘭花  扇面|Orchid,Asian Art
近代  林紓  合掌峰  扇面|Hezhang Peak,Asian Art
近代  林紓  詩廬圖  卷|The Poetry Cottage,Asian Art
Query:
SELECT
    "object_id",
    TO_VARCHAR(TO_TIMESTAMP_NTZ("metadata_date" / 1e6), 'YYYY-MM-DD') AS "formatted_metadata_date"
FROM
    "THE_MET"."THE_MET"."OBJECTS"
LIMIT 1000;
Answer:
Too long, hard cut:
object_id,formatted_metadata_date
646996,2017-02-06
77916,2017-02-06
38009,2017-02-06
37988,2017-02-06
74660,2017-02-06
74674,2017-02-06
74675,2017-02-06
74677,2017-02-06
74685,2017-02-06
65595,2017-02-06
73261,2017-02-06
38042,2017-02-06
39894,2017-02-06
64891,2017-02-06
65590,2017-02-06
65594,2017-02-06
40445,2017-02-06
45063,2017-02-06
40069,2017-02-06
40070,2017-02-06
37964,2017-02-06
75084,2017-02-06
75085,2017-02-06
75086,2017-02-06
75087,2017-02-06
75088,2017-02-06
75089,2017-02-06
75090,2017-02-06
75091,2017-02-06
75092,2017-02-06
75093,2017-02-06
75094,2017-02-06
75095,2017-02-06
75096,2017-02-06
75097,2017-02-06
75098,2017-02-06
75099,2017-02-06
75100,2017-02-06
75101,2017-02-06
75102,2017-02-06
75103,2017-02-06
75104,2017-02-06
75105,2017-02-06
75106,2017-02-06
75107,2017-02-06
75108,2017-02-06
75109,2017-02-06
75110,2017-02-06
75111,2017-02-06
75112,2017-02-06
75113,2017-02-06
75114,2017-02-06
75115,2017-02-06
75116,2017-02-06
75117,2017-02-06
75118,2017-02-06
75119,2017-02-06
75120,2017-02-06
75121,2017-02-06
75122,2017-02-06
75123,2017-02-06
75124,2017-02-06
75125,2017-02-06
75126,2017-02-06
75127,2017-02-06
75128,2017-02-06
75129,2017-02-06
75130,2017-02-06
75131,2017-02-06
75132,2017-02-06
75133,2017-02-06
75134,2017-02-06
75135,2017-02-06
75136,2017-02-06
75137,2017-02-06
75138,2017-02-06
75139,2017-02-06
75140,2017-02-06
75141,2017-02-06
75142,2017-02-06
75143,2017-02-06
75145,2017-02-06
75146,2017-02-06
75147,2017-02-06
75148,2017-02-06
75149,2017-02-06
75150,2017-02-06
75151,2017-02-06
75152,2017-02-06
75153,2017-02-06
54912,2017-02-06
38448,2017-02-06
40429,2017-02-06
40432,2017-02-06
73188,2017-02-06
74683,2017-02-06
72589,2017-02-06
74656,2017-02-06
64046,2017-02-06
39899,2017-02-06
36145,2017-02-06
49665,2017-02-06
36130,2017-02-06
36435,2017-02-06
36036,2017-02-06
36072,2017-02-06
49133,2017-02-06
65620,2017-02-06
40021,2017-02-06
49453,2017-02-06
49134,2017-02-06
65075,2017-02-06
41468,2017-02-06
40507,2017-02-06
40052,2017-02-06
35995,2017-02-06
35999,2017-02-06
36003,2017-02-06
45786,2017-02-06
73669,2017-02-06
49179,2017-02-06
49226,2017-02-06
51727,2017-02-06
51705,2017-02-06
51528,2017-02-06
51656,2017-02-06
51644,2017-02-06
36129,2017-02-06
51770,2017-02-06
64029,2017-02-06
60764,2017-02-06
51902,2017-02-06
64045,2017-02-06
36439,2017-02-06
40285,2017-02-06
40107,2017-02-06
40180,2017-02-06
40194,2017-02-06
40060,2017-02-06
40058,2017-02-06
45684,2017-02-06
45746,2017-02-06
39766,2017-02-06
45749,2017-02-06
44574,2017-02-06
45775,2017-02-06
45780,2017-02-06
51865,2017-02-06
77914,2017-02-06
48875,2017-02-06
48955,2017-02-06
48954,2017-02-06
49025,2017-02-06
49029,2017-02-06
56553,2017-02-06
41780,2017-02-06
39625,2017-02-06
48931,2017-02-06
48928,2017-02-06
48959,2017-02-06
49129,2017-02-06
49146,2017-02-06
49147,2017-02-06
49163,2017-02-06
51894,2017-02-06
36132,2017-02-06
51900,2017-02-06
75814,2017-02-06
54308,2017-02-06
55495,2017-02-06
49473,2017-02-06
35987,2017-02-06
44570,2017-02-06
40105,2017-02-06
40509,2017-02-06
42329,2017-02-06
39918,2017-02-06
39919,2017-02-06
40103,2017-02-06
40104,2017-02-06
41777,2017-02-06
41860,2017-02-06
40018,2017-02-06
41778,2017-02-06
41782,2017-02-06
63196,2017-02-06
63185,2017-02-06
49047,2017-02-06
50549,2017-02-06
53924,2017-02-06
53925,2017-02-06
53926,2017-02-06
53927,2017-02-06
53928,2017-02-06
53929,2017-02-06
42323,2017-02-06
36236,2017-02-06
36098,2017-02-06
72711,2017-02-06
72712,2017-02-06
36201,2017-02-06
44567,2017-02-06
49617,2017-02-06
36208,2017-02-06
36205,2017-02-06
36206,2017-02-06
36211,2017-02-06
36210,2017-02-06
36216,2017-02-06
49629,2017-02-06
49630,2017-02-06
41504,2017-02-06
49603,2017-02-06
49604,2017-02-06
49605,2017-02-06
49607,2017-02-06
36202,2017-02-06
49608,2017-02-06
49606,2017-02-06
49614,2017-02-06
49615,2017-02-06
49663,2017-02-06
49664,2017-02-06
49626,2017-02-06
49627,2017-02-06
36222,2017-02-06
36224,2017-02-06
49623,2017-02-06
40311,2017-02-06
45652,2017-02-06
39901,2017-02-06
39959,2017-02-06
51762,2017-02-06
40062,2017-02-06
40057,2017-02-06
40094,2017-02-06
36052,2017-02-06
40053,2017-02-06
36055,2017-02-06
44506,2017-02-06
44507,2017-02-06
44508,2017-02-06
44509,2017-02-06
44510,2017-02-06
40278,2017-02-06
41479,2017-02-06
45661,2017-02-06
41478,2017-02-06
44699,2017-02-06
44590,2017-02-06
45675,2017-02-06
36123,2017-02-06
45683,2017-02-06
45682,2017-02-06
39483,2017-02-06
36093,2017-02-06
45752,2017-02-06
45779,2017-02-06
44601,2017-02-06
45776,2017-02-06
39654,2017-02-06
45802,2017-02-06
45797,2017-02-06
44606,2017-02-06
45815,2017-02-06
36135,2017-02-06
45032,2017-02-06
48934,2017-02-06
48932,2017-02-06
36070,2017-02-06
48949,2017-02-06
48952,2017-02-06
48953,2017-02-06
48951,2017-02-06
41480,2017-02-06
48950,2017-02-06
48969,2017-02-06
35988,2017-02-06
39713,2017-02-06
49019,2017-02-06
49021,2017-02-06
39717,2017-02-06
49074,2017-02-06
41470,2017-02-06
39558,2017-02-06
44759,2017-02-06
37395,2017-02-06
35998,2017-02-06
35990,2017-02-06
48948,2017-02-06
36022,2017-02-06
36021,2017-02-06
3
Query:
SELECT DISTINCT t1."object_id"
    FROM "THE_MET"."THE_MET"."OBJECTS" t1
    WHERE t1."object_id" IN (SELECT t2."object_id" FROM "THE_MET"."THE_MET"."VISION_API_DATA" t2)
    LIMIT 1000;
Answer:
Too long, hard cut:
object_id
2704
308689
546942
204339
343127
578666
202859
104470
201749
239562
113100
393606
449595
308332
546355
226289
568716
90391
388318
453272
196116
340669
506171
447997
310223
214796
325122
345467
75091
9595
438947
681278
285647
559821
189458
562094
37216
12182
445763
450642
5419
199611
227360
67391
59408
247783
431194
457582
422120
406563
188922
203055
55166
478568
371380
555174
2416
44426
339104
21919
26327
463240
9524
191065
457103
706476
47379
463793
198114
450362
325404
390599
422167
198525
58006
195003
119817
114692
457652
240352
209420
188252
42427
552608
437585
410925
551448
407097
194942
407117
188790
336026
5289
50060
201833
559049
200413
246607
261842
12440
245736
557048
244998
309966
543956
188673
437278
459218
287224
104125
68945
339364
371330
229917
72238
363718
50567
248996
190932
2408
222298
322041
53294
470655
239820
53829
187333
257058
446239
67544
503844
565871
203436
214013
323916
40927
68909
226694
408387
555482
192752
324194
504522
243266
264982
446997
666123
548861
710927
466754
70494
623386
158967
37980
196881
411307
464566
550160
337920
342718
58774
210720
255152
288478
284874
14307
464662
244603
340690
5179
200942
360519
505106
45222
22067
471572
335099
355297
429577
396961
334118
38406
8247
483721
254598
259152
548918
443429
386602
255180
693149
189464
157645
26505
12536
459756
364657
546319
562783
680079
90509
16479
705848
367283
49457
377640
356327
307641
11625
460911
33416
56864
237794
463400
247677
228953
238890
706447
200075
409358
361716
205579
287227
339329
202452
391036
225069
373934
209332
577252
446349
334221
413447
223568
347404
345491
21355
453299
196921
383677
461279
7769
247850
386092
267987
56069
52471
14731
355377
227192
60626
15944
59160
66715
173422
644465
675898
239801
56922
244892
241006
219348
326425
62198
324507
396903
2193
360743
256149
159420
485547
156406
549444
36888
215354
57442
465046
504201
450132
318649
243795
446749
67933
545185
36512
443619
13621
314494
394016
12834
12607
342590
204646
343059
55498
372991
3115
55814
571945
22070
652440
438033
3984
465583
457316
444199
58940
639405
823
547995
189855
412508
52709
112933
548932
680464
361656
683
479299
549079
186434
659535
60605
573130
363050
484644
46970
156996
188916
571089
62954
49194
451272
62577
623258
576998
59290
13629
72203
317567
384993
423149
68580
224024
222421
469942
245457
69832
577208
206032
66737
544918
475263
481037
559797
43157
383012
66211
252392
214228
230476
219561
217194
325260
35629
230414
222656
414878
62094
37256
261879
369623
13261
218670
222954
549709
219215
193590
69419
198916
550253
21304
403876
248778
336035
325661
415234
60076
384176
205025
365723
340883
173651
502513
422679
50573
400084
370772
55583
69748
391283
624385
316578
12592
451933
58507
545033
37915
59434
22876
12271
460185
221130
43187
364110
552304
193609
213469
467233
437311
408555
243638
242983
662923
186301
376110
444840
53301
222763
400876
322240
19022
45251
119566
659539
124281
248903
66746
443823
226358
342218
396339
358404
448856
204773
58068
336919
204903
259583
197660
217269
327288
548995
449010
662608
63819
195268
251134
316963
244132
62974
451734
416148
465537
437637
323960
216309
418593
450455
187528
68385
15807
156171
554596
67545
445502
323504
287368
223496
447928
188353
60125
336339
376307
253044
124189
436274
251197
428762
339191
36657
72223
201353
64336
1999
338222
68751
545016
363506
570666
340835
19099
191825
115295
308667
13749
406656
193723
55737
412057
47853
39371
13761
247626
216991
388259
546214
54418
394031
545905
227841
477767
50859
393665
317533
156174
308015
445280
10184
390689
463039
287770
370485
652955
389415
243899
44118
205984
243818
470868
222408
562061
70179
45063
192669
143
571613
86350
30850
462952
86757
194633
446891
5769
41117
227393
309186
436436
46283
373153
559066
246399
400955
214012
13597
348339
590760
68355
3441
43810
549703
216725
51416
10353
288532
451149
62907
190588
323613
240089
5850
256132
464474
267665
660008
66172
241423
168761
240128
544006
26309
26598
51478
228808
11488
239155
458958
21185
209571
90999
219262
466626
307937
548969
403674
4154
464905
384959
14626
545300
323353
447006
251053
448208
13000
684053
460166
661791
16319
369356
650866
341660
324310
386617
192048
26568
5133
251138
694344
414932
364742
348771
70670
316713
410377
310218
69717
685806
341439
670645
204120
60283
414949
228086
224317
444423
659075
13384
43039
327381
554326
324800
553870
202382
65837
316818
415603
336855
321658
13799
408913
221970
463870
221857
437273
40871
346399
400618
443296
207934
10141
232033
465980
419903
73419
567611
65986
410444
570431
22394
218093
449337
435788
395546
123233
552455
545203
383824
334422
66524
199891
2487
704860
448081
53281
26529
168342
400020
467909
452027
47115
13074
188867
463702
268226
229689
393249
573092
465683
345033
544238
411473
195610
69838
23396
476394
588380
325897
8405
463927
547562
10945
327345
15448
406908
32356
269560
8273
369251
185904
26429
23161
460499
692598
12848
443778
51150
263219
121214
407562
223055
446115
215128
447890

Query:
SELECT
    o."object_id",
    o."title",
    TO_CHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM
    "THE_MET"."THE_MET"."OBJECTS" AS o
JOIN
    "THE_MET"."THE_MET"."VISION_API_DATA" AS v
    ON o."object_id" = v."object_id"
WHERE
    o."department" = 'The Libraries'
    AND LOWER(o."title") LIKE '%book%'
Answer:
object_id,title,metadata_date
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc.",2017-02-06
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06
Query:
SELECT "object_id", "title"
    FROM "THE_MET"."THE_MET"."OBJECTS"
    WHERE "department" = 'The Libraries' AND LOWER("title") LIKE '%book%';
Answer:
object_id,title
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found"
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts"
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work"
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc."
End Exploring Related Columns
Task: Retrieve the object id, title, and the formatted metadata date (as a string in 'YYYY-MM-DD' format) for objects in the "The Libraries" department where the cropConfidence is greater than 0.5, the object's title contains the word "book".

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: SELECT S."Column_Name" FROM {Database Name}.{Schema Name}.{Table_name} (ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
object_id,title,metadata_date
object_id:int,title containing 'book',date in 'YYYY-MM-DD' format
```

We retrieved the `object_id`, `title`, and the formatted `metadata_date` for all objects in the "The Libraries" department where the `cropConfidence` is greater than 0.5 and the `title` contains the word "book". The `metadata_date` is formatted as a string in 'YYYY-MM-DD' format..
Here are some useful tips for answering:
When calculating distances between two geometries, use `ST_MakePoint(x, y)` to make a point and `ST_Distance(geometry1 GEOMETRY, geometry2 GEOMETRY)` to compute. No need to convert from meters to miles unless requested. Don't use Haversine like 2 * 6371000 * ASIN(...), use ST_DISTANCE for more precise results.
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'THE_MET': {'THE_MET': ['IMAGES', 'OBJECTS', 'VISION_API_DATA']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'
When handling TO_TIMESTAMP_NTZ conversions, use query like: SELECT CASE WHEN "date" >= 1e15 THEN TO_TIMESTAMP_NTZ("date" / 1000000) WHEN "date" >= 1e12 THEN TO_TIMESTAMP_NTZ("date" / 1000) ELSE TO_TIMESTAMP_NTZ("date") END AS parsed_timestamp FROM my_table;
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
Keep all decimals to four decimal places.
For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'

2025-01-17 20:03:50 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:03:50 - root - INFO - ```sql
SELECT
    o."object_id",
    o."title",
    TO_CHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM
    "THE_MET"."THE_MET"."OBJECTS" AS o
JOIN
    "THE_MET"."THE_MET"."VISION_API_DATA" AS v
    ON o."object_id" = v."object_id"
WHERE
    o."department" = 'The Libraries'
    AND LOWER(o."title") LIKE '%book%'
    AND v."cropHintsAnnotation":"cropHints"[0]:"confidence"::FLOAT > 0.5;
```
2025-01-17 20:03:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:03:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:03:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:03:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-17 20:03:52 - snowflake.connector.connection - INFO - closed
2025-01-17 20:03:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:03:52 - root - INFO - itercount: 1
2025-01-17 20:03:52 - root - INFO - 0
2025-01-17 20:03:52 - root - INFO - results: 
object_id,title,metadata_date
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc.",2017-02-06
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06


2025-01-17 20:03:52 - root - INFO - Please check the answer again by reviewing Retrieve the object id, title, and the formatted metadata date (as a string in 'YYYY-MM-DD' format) for objects in the "The Libraries" department where the cropConfidence is greater than 0.5, the object's title contains the word "book"., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
object_id,title,metadata_date
object_id:int,title containing 'book',date in 'YYYY-MM-DD' format
```

We retrieved the `object_id`, `title`, and the formatted `metadata_date` for all objects in the "The Libraries" department where the `cropConfidence` is greater than 0.5 and the `title` contains the word "book". The `metadata_date` is formatted as a string in 'YYYY-MM-DD' format. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
object_id,title,metadata_date
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc.",2017-02-06
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06
Current sql:
SELECT
    o."object_id",
    o."title",
    TO_CHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM
    "THE_MET"."THE_MET"."OBJECTS" AS o
JOIN
    "THE_MET"."THE_MET"."VISION_API_DATA" AS v
    ON o."object_id" = v."object_id"
WHERE
    o."department" = 'The Libraries'
    AND LOWER(o."title") LIKE '%book%'
    AND v."cropHintsAnnotation":"cropHints"[0]:"confidence"::FLOAT > 0.5;For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'

2025-01-17 20:04:18 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:04:18 - root - INFO - ```sql
SELECT
    o."object_id",
    o."title",
    TO_CHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM
    "THE_MET"."THE_MET"."OBJECTS" AS o
JOIN
    "THE_MET"."THE_MET"."VISION_API_DATA" AS v
    ON o."object_id" = v."object_id"
WHERE
    o."department" = 'The Libraries'
    AND o."title" LIKE '%book%'
    AND v."cropHintsAnnotation":"cropHints"[0]:"confidence"::FLOAT > 0.5;
```
2025-01-17 20:04:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:04:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:04:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:04:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 4
2025-01-17 20:04:19 - snowflake.connector.connection - INFO - closed
2025-01-17 20:04:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:04:19 - root - INFO - itercount: 2
2025-01-17 20:04:19 - root - INFO - 0
2025-01-17 20:04:19 - root - INFO - results: 
object_id,title,metadata_date
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06


2025-01-17 20:04:19 - root - INFO - Please check the answer again by reviewing Retrieve the object id, title, and the formatted metadata date (as a string in 'YYYY-MM-DD' format) for objects in the "The Libraries" department where the cropConfidence is greater than 0.5, the object's title contains the word "book"., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
object_id,title,metadata_date
object_id:int,title containing 'book',date in 'YYYY-MM-DD' format
```

We retrieved the `object_id`, `title`, and the formatted `metadata_date` for all objects in the "The Libraries" department where the `cropConfidence` is greater than 0.5 and the `title` contains the word "book". The `metadata_date` is formatted as a string in 'YYYY-MM-DD' format. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
object_id,title,metadata_date
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06
Current sql:
SELECT
    o."object_id",
    o."title",
    TO_CHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM
    "THE_MET"."THE_MET"."OBJECTS" AS o
JOIN
    "THE_MET"."THE_MET"."VISION_API_DATA" AS v
    ON o."object_id" = v."object_id"
WHERE
    o."department" = 'The Libraries'
    AND o."title" LIKE '%book%'
    AND v."cropHintsAnnotation":"cropHints"[0]:"confidence"::FLOAT > 0.5;For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'

2025-01-17 20:04:49 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:04:49 - root - INFO - ```sql
SELECT
    o."object_id",
    o."title",
    TO_CHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM
    "THE_MET"."THE_MET"."OBJECTS" AS o
JOIN
    "THE_MET"."THE_MET"."VISION_API_DATA" AS v
    ON o."object_id" = v."object_id"
WHERE
    o."department" = 'The Libraries'
    AND o."title" ILIKE '%book%'
    AND v."cropHintsAnnotation":"cropHints"[0]:"confidence"::FLOAT > 0.5;
```
2025-01-17 20:04:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:04:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:04:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:04:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-17 20:04:50 - snowflake.connector.connection - INFO - closed
2025-01-17 20:04:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:04:51 - root - INFO - itercount: 3
2025-01-17 20:04:51 - root - INFO - 0
2025-01-17 20:04:51 - root - INFO - Total iteration counts: 3
