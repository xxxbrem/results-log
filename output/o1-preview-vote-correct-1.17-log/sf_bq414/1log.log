2025-01-17 19:58:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 19:59:41 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 19:59:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 19:59:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 19:59:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 19:59:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 20
2025-01-17 19:59:42 - snowflake.connector.connection - INFO - closed
2025-01-17 19:59:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 19:59:43 - root - INFO - SQL:
SELECT DISTINCT "department" FROM THE_MET.THE_MET.OBJECTS LIMIT 1000;
Results:
department
Asian Art
Islamic Art
Photographs
Medieval Art
The Cloisters
The Libraries
Arms and Armor
Costume Institute
European Paintings
Drawings and Prints
Greek and Roman Art
Musical Instruments
Ancient Near Eastern Art
Robert Lehman Collection
Modern and Contemporary Art
American Paintings and Sculpture
"Arts of Africa, Oceania, and the Americas"
American Decorative Arts
European Sculpture and Decorative Arts
Egyptian Art

2025-01-17 19:59:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 19:59:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 19:59:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 19:59:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 120
2025-01-17 19:59:44 - snowflake.connector.connection - INFO - closed
2025-01-17 19:59:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 19:59:44 - root - INFO - SQL:
SELECT "object_id", "title" FROM THE_MET.THE_MET.OBJECTS WHERE "department" = 'The Libraries' LIMIT 1000;
Results:
Too long, hard cut:
object_id,title
682011,Dialogo sobre hua nova obra no Rio Tejo ...
681546,De' ragguagli di Parnaso: Centuria prima-seconda
681534,"Contes et nouvelles de Bocace florentin : traduction libre, accommodée au gout de ce temps, & enrichie de figures en taille-douce gravées par Mr. Romain de Hooge"
681389,"Uffizio della Settimana Santa : colle rubriche volgari, argomenti de' Salmi, spiegazione delle cerimonie e misterj, con osservazioni, e riflessioni divote dell'abate Alessandro Mazzinelli"
591832,"Academie de l'espee; ou se domonstrent par reigles mathématiques sur le fondement d'un cercle mystérieux, la théorie et pratique des vrais . . ."
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans
591831,"Descriptio pbvlicae gratvlationis, spectacvlorvm et lvdorvm, in aventv sereniss: Principis Ernesti Archidvcis Avstriae Dvcis Vrgvndiae"
591865,Morte d'Arthur
591848,"The Holy Land, Syria, Idumea, Arabia, Egypt & Nubia"
591863,"Catalogue of the Collection of Jewels and Precious Works of Art, the Property of  J. Pierpont Morgan"
681573,"Les oeuvres morales de Mr. Diderot : contenant son traité De l'amitié, et celui Des passions"
682013,L'eschole de Salerne en vers burlesques & duo poemata macaronica: de bello huguenotico: et De gestis magnanimi & prudentissimi Baldi
681149,Bibliorum Sacrorum Vulgatae versionis
681556,Mémoires du Comte de Grammont : histoire amoureuse de la cour d'Angleterre sous Charles II / par Antoine Hamilton ; préface et notes par Benjamin Pifteau
681388,"Traité de Plutarque, sur la manière de discerner un flatteur d'avec un ami et Le banquet des sept sages: dialogue du même auteur revu & corrigé sur des manuscrits de la Bibliothèque du roi; avec une version françoise & des notes"
680835,"L'art de former les jardins modernes, ou, L'art des jardins anglois : traduit de l'anglois : à quoi le traducteur a ajouté un discours préliminaire sur l'origine de l'art, des notes sur le texte, & une description détaillée des jardins de Stowe, accompagnée du plan"
681547,"De l'imitation de Jesus-Christ, traduction nouvelle ; ornée de figures en taille-douce"
681545,Contes et nouvelles en vers par Jean de la Fontaine
682014,Figures françoises et comiques nouvellement inventées par M. Watteau; Figures de modes dessinées et gravées à l'eau forte par Watteau; a terminées au buin par Thomassin le fils
681128,"Les aventures de Télémaque, fils d'Ulysse par M. de Fénélon ; avec figures en taille-douce, dessinées par MM. Cochin et Moreau le jeune"
682012,Epistole eroiche di P. Ovidio Nasone
681563,"Oeuvres de Moliere : avec des remarques grammaticales, des avertissemens et des observations sur chaque piéce, par M. Bret"
716648,"Planches pour l'Encyclopédie, ou pour le Dictionaire raisonné des sciences, des arts libéraux, et des arts méchaniques, avec leur explication"
705290,博古圖錄
715005,三禮圖
739504,Examples of Chinese ornament selected from objects in the South Kensington Museum and other collections
726677,"The sunshade, the glove, the muff"
716639,"Encyclopédie, ou Dictionnaire raisonné des sciences, des arts et des métiers, par une société de gens de lettres"
699505,"Dialogos de la pintvra : sv defensa, origen, essecia, definicion, modos y diferencias"
697348,Der aller durchleuchtigisten und grosmächtigen Kayser ... Königen ... Herren vom Adel ... Bildtnussen und kurtz Beschreibungen ihrer so wol in Fridts- als Kriegszzeiten verrichten fürnembsten Thaten und Handlungen : deren Waffen und Rüstungen ... auss allen Landen der Welt ... in dem Schloss Ombrass ... zu ewiger Gedächtnuss auffbehalten werden ...
681349,"Calendrier belgique, curieux et utile, contenant les evenemens historiques sur les jours de l'an, et les travaux à faire dans les jardins en chaque mois de l'année, la description des tableaux remarquables, que l'on trouve dans la ville de Gand, avec les noms des peintres pour l'annėe MDCCLXXII"
591837,Le pitture e sculture di Brescia che sono esposte al pubblico con un' appendice di alcune private gallerie
591862,"Edwin Davis French, A Memorial: His Life, His Art"
591836,Il Ritratto di Venezia
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found"
738466,Modern chromatics : with applications to art and industry
700032,Petri Gyllii De Bosporo thracio libri III ; Petri Gyllii De topographia Constantinopoleos
700050,"Traité de l'horlogerie, méchanique et pratique, approuvé par l'Academie royale des sciences"
738463,"The principles of harmony and contrast of colours, and their applications to the arts"
704714,Mr. Vanderbilt's house and collection
700240,"The cabinet-maker and upholsterer's guide, or, Repository of designs for every article of household furniture, in the newest and most approved taste : displaying a great variety of patterns for chairs, stools ... in the plainest and most enriched styles : with a scale to each, and an e

2025-01-17 19:59:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 19:59:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 19:59:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 19:59:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-17 19:59:46 - snowflake.connector.connection - INFO - closed
2025-01-17 19:59:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 19:59:46 - root - INFO - SQL:
SELECT "title" FROM THE_MET.THE_MET.OBJECTS WHERE "title" ILIKE '%book%' LIMIT 1000;
Results:
Too long, hard cut:
title
明     郭詡     稱書圖     軸|Weighing Books
明     杜堇     伏生授經圖   軸|The Scholar Fu Sheng Transmitting the Book of Documents
画本宝能縷|Picture Book of Brocades with Precious Threads (Ehon takara no itosuji)
絵本松のしらべ|Picture Book on the Music of the Pine Trees (Ehon matsu no shirabe)
『和国諸職絵尽　諸織 絵本鏡』|A Picture Book Mirror of Various Occupations (Wakoku shoshoku ezukushi)
Ehon Asakayama|絵本浅香山|Picture Book: Mount Asaka (Ehon Asakayama)
"絵本末摘花|Picture Book: Flowers Yet to be Picked, Vol. 1"
Ehon Ogurayama|絵本小倉山|Picture Book: Ogura Hill (Ehon Ogurayama)
Ehon Himetsubaki|繪本女貞木|Picture Book: Camellia (Ehon Himetsubaki)
『繪本常盤草』|Picture Book of the Evergreens (Ehon tokiwagusa)
『繪本小倉山』|Picture Book of Ogura Hill (Ehon ogurayama)
『繪本小松原』|Picture Book of Komatsubara (Ehon komatsubara)
絵本常盤草　上・中・下|Picture Book of the Evergreens (Ehon tokiwagusa)
『寫山樓畫本』|Shazanrō (Bunchō) Picture Book (Shazanrō ehon)
『絵本時世粧』|Picture Book of Modern Figures of Fashion (Ehon imayō sugata)
艶本 婦慈のゆき|An Erotic Picture Book of Snow on Fuji (Enpon fuji no yuki)
絵本吾妻遊|Ehon Azuma asobi|Picture Book of Amusements of the Eastern Capital (Ehon Azuma asobi)
Ehon Momochidori Kyōka-awase|百千鳥狂歌合|Myriad Birds: Picture Book of Playful Verse (Momo chidori kyōka-awase)
絵本和歌夷 「龢謌夷」|Picture Book with Playful Poems for the Young God Ebisu
潮干のつと|Gifts from the Ebb Tide (The Shell Book) (Shiohi no tsuto)
画本虫撰|Picture Book of Crawling Creatures (The Insect Book) (Ehon mushi erami)
画本虫撰|Picture Book of Crawling Creatures (The Insect Book) (Ehon mushi erami)
繪本四季花|Picture Book of Flowers of the Four Seasons (Ehon shiki no hana)
『青楼繪本年中行事』|Yoshiwara Picture Book of New Year’s Festivities (Seirō ehon nenjū gyōji)
（榎木新右衛門）画 『雛形伊勢乃海』|Book of Kosode Patterns (Hiinagata Ise no umi)
Ehon Musashi no Abumi|A Picture Book of Japanese Warriors
『画本狂歌山満多山』|Picture Book of Kyōka Poems: Mountains upon Mountains (Ehon kyōka yama mata yama)
"繪本彩色通　初編|Picture Book on the Use of Coloring, first volume (Ehon saishikitsū shohen)"
『絵本和漢誉』|Picture Book on Heroes of China and Japan (Ehon wakan no homare)
『暁斎漫画』|Kyōsai Sketchbook (Kyōsai manga)
"『閨の雛形』　正月|Plate from the Erotic Book Mounds of Dyed Colors: A Pattern Book for the Boudoir (Someiro no yama neya no hinagata), First Month"
"『画本虫撰』  「蜂」「毛虫」|Paper Wasp (Hachi); Hairy Caterpillar (Kemushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』   「馬追虫」「むかて」|Katydid (Umaoi-mushi); Centipede, (Mukade), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』   「けら」「はさみむし」|Mole Cricket (Kera); Earwig, (Hasami-mushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』   「蝶」「蜻蛉」|Butterfly (Chō); Dragonfly (Kagerō or Tonbo), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』  「虻」「芋虫」|Horsefly (abu); Green Caterpillar, imomushi, from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』   「松虫」「虫蛍」|Tree cricket (Matsumushi); Firefly (Hotaru), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"画本虫撰　バッタと蟷螂|Cone-headed Grasshopper or Locust, (batta); Praying Mantis (Tōrō or Kamakiri), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』 「ひくらし」「くも」|Evening Cicada, Higurashi; Spider, Kumo, from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』「赤蜻蛉」「いなこ」|Red Dragonfly (Akatonbo); Locust (Inago), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』「虵」「とかけ」|Rat Snake (Hebi); Lizard or Skink (Tokage), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』「蓑虫」「兜虫」|Bagworm (Minomushi); Horned Scarab Beetle (Kabutomushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』「蝸牛」「轡虫」|Land Snail (Katatsumuri); Giant Katydid (Kutsuwamushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』「きりきりす」「蝉」|Grasshopper (Kirigirisu); Cicada (Semi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』「蚓」「こうろき」|Earthworm (Mimizu); Cricket (Kōrogi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"四季の花|The Coming Thunderstorm, from the illustrated book Flowers of the Four Seasons"
"四季の花|Women on a Bridge, from the illustrated book Flowers of the Four Seasons"
"四季の花|A Child Lighting Fireworks, from the illustrated book Flowers of the Four Seasons"
"四季の花|Girls Getting on Board a Boat, from the illustrated book Flowers of the Four Seasons"
"四季の花|Girls Picking Green Leaves, from the illustrated book Flowers of the Four Seasons"
"四季の花|New Year's Games, from the printed book Flowers of the Four Seasons (Shiki no hana)"
"四季の花|Girls Entertained by Performers, from the illustrated book Flowers of the Four Seasons"
"四季の花|Poetry, from the illustrated book Flowers of the Four Seasons"
"『画本虫撰』「蛙」「こかねむし」|Frog (Kaeru); Gold Beetle (Kogane mushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"Kamakura no Koshi|The Filial Son at Kamakura, From the Book: Sasekishu"
"『雛形若菜の初模様　つるや内　すがたみ』|The Courtesan Sugatami of the Tsuruya Brothel

2025-01-17 19:59:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 19:59:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 19:59:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 19:59:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-17 19:59:48 - snowflake.connector.connection - INFO - closed
2025-01-17 19:59:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 19:59:48 - root - INFO - SQL:
SELECT "object_id" FROM THE_MET.THE_MET.OBJECTS WHERE "department" = 'The Libraries' AND "title" ILIKE '%book%' LIMIT 1000;
Results:
object_id
591860
700238
700232
591861
591856

2025-01-17 19:59:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 19:59:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 19:59:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 19:59:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-17 19:59:50 - snowflake.connector.connection - INFO - closed
2025-01-17 19:59:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 19:59:50 - root - INFO - SQL:
SELECT "metadata_date" FROM THE_MET.THE_MET.OBJECTS LIMIT 1000;
Results:
Too long, hard cut:
metadata_date
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
14863

2025-01-17 19:59:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 19:59:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 19:59:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 19:59:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-17 19:59:51 - snowflake.connector.connection - INFO - closed
2025-01-17 19:59:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 19:59:52 - root - INFO - SQL:
SELECT "object_id", TO_CHAR(TO_TIMESTAMP("metadata_date"), 'YYYY-MM-DD') AS "formatted_metadata_date" FROM THE_MET.THE_MET.OBJECTS LIMIT 1000;
Results:
Too long, hard cut:
object_id,formatted_metadata_date
646996,47103097-05-20
77916,47103097-05-20
38009,47103097-05-20
37988,47103097-05-20
74660,47103097-05-20
74674,47103097-05-20
74675,47103097-05-20
74677,47103097-05-20
74685,47103097-05-20
65595,47103097-05-20
73261,47103097-05-20
38042,47103097-05-20
39894,47103097-05-20
64891,47103097-05-20
65590,47103097-05-20
65594,47103097-05-20
40445,47103097-05-20
45063,47103097-05-20
40069,47103097-05-20
40070,47103097-05-20
37964,47103097-05-20
75084,47103097-05-20
75085,47103097-05-20
75086,47103097-05-20
75087,47103097-05-20
75088,47103097-05-20
75089,47103097-05-20
75090,47103097-05-20
75091,47103097-05-20
75092,47103097-05-20
75093,47103097-05-20
75094,47103097-05-20
75095,47103097-05-20
75096,47103097-05-20
75097,47103097-05-20
75098,47103097-05-20
75099,47103097-05-20
75100,47103097-05-20
75101,47103097-05-20
75102,47103097-05-20
75103,47103097-05-20
75104,47103097-05-20
75105,47103097-05-20
75106,47103097-05-20
75107,47103097-05-20
75108,47103097-05-20
75109,47103097-05-20
75110,47103097-05-20
75111,47103097-05-20
75112,47103097-05-20
75113,47103097-05-20
75114,47103097-05-20
75115,47103097-05-20
75116,47103097-05-20
75117,47103097-05-20
75118,47103097-05-20
75119,47103097-05-20
75120,47103097-05-20
75121,47103097-05-20
75122,47103097-05-20
75123,47103097-05-20
75124,47103097-05-20
75125,47103097-05-20
75126,47103097-05-20
75127,47103097-05-20
75128,47103097-05-20
75129,47103097-05-20
75130,47103097-05-20
75131,47103097-05-20
75132,47103097-05-20
75133,47103097-05-20
75134,47103097-05-20
75135,47103097-05-20
75136,47103097-05-20
75137,47103097-05-20
75138,47103097-05-20
75139,47103097-05-20
75140,47103097-05-20
75141,47103097-05-20
75142,47103097-05-20
75143,47103097-05-20
75145,47103097-05-20
75146,47103097-05-20
75147,47103097-05-20
75148,47103097-05-20
75149,47103097-05-20
75150,47103097-05-20
75151,47103097-05-20
75152,47103097-05-20
75153,47103097-05-20
54912,47103097-05-20
38448,47103097-05-20
40429,47103097-05-20
40432,47103097-05-20
73188,47103097-05-20
74683,47103097-05-20
72589,47103097-05-20
74656,47103097-05-20
64046,47103097-05-20
39899,47103097-05-20
36145,47103097-05-20
49665,47103097-05-20
36130,47103097-05-20
36435,47103097-05-20
36036,47103097-05-20
36072,47103097-05-20
49133,47103097-05-20
65620,47103097-05-20
40021,47103097-05-20
49453,47103097-05-20
49134,47103097-05-20
65075,47103097-05-20
41468,47103097-05-20
40507,47103097-05-20
40052,47103097-05-20
35995,47103097-05-20
35999,47103097-05-20
36003,47103097-05-20
45786,47103097-05-20
73669,47103097-05-20
49179,47103097-05-20
49226,47103097-05-20
51727,47103097-05-20
51705,47103097-05-20
51528,47103097-05-20
51656,47103097-05-20
51644,47103097-05-20
36129,47103097-05-20
51770,47103097-05-20
64029,47103097-05-20
60764,47103097-05-20
51902,47103097-05-20
64045,47103097-05-20
36439,47103097-05-20
40285,47103097-05-20
40107,47103097-05-20
40180,47103097-05-20
40194,47103097-05-20
40060,47103097-05-20
40058,47103097-05-20
45684,47103097-05-20
45746,47103097-05-20
39766,47103097-05-20
45749,47103097-05-20
44574,47103097-05-20
45775,47103097-05-20
45780,47103097-05-20
51865,47103097-05-20
77914,47103097-05-20
48875,47103097-05-20
48955,47103097-05-20
48954,47103097-05-20
49025,47103097-05-20
49029,47103097-05-20
56553,47103097-05-20
41780,47103097-05-20
39625,47103097-05-20
48931,47103097-05-20
48928,47103097-05-20
48959,47103097-05-20
49129,47103097-05-20
49146,47103097-05-20
49147,47103097-05-20
49163,47103097-05-20
51894,47103097-05-20
36132,47103097-05-20
51900,47103097-05-20
75814,47103097-05-20
54308,47103097-05-20
55495,47103097-05-20
49473,47103097-05-20
35987,47103097-05-20
44570,47103097-05-20
40105,47103097-05-20
40509,47103097-05-20
42329,47103097-05-20
39918,47103097-05-20
39919,47103097-05-20
40103,47103097-05-20
40104,47103097-05-20
41777,47103097-05-20
41860,47103097-05-20
40018,47103097-05-20
41778,47103097-05-20
41782,47103097-05-20
63196,47103097-05-20
63185,47103097-05-20
49047,47103097-05-20
50549,47103097-05-20
53924,47103097-05-20
53925,47103097-05-20
53926,47103097-05-20
53927,47103097-05-20
53928,47103097-05-20
53929,47103097-05-20
42323,47103097-05-20
36236,47103097-05-20
36098,47103097-05-20
72711,47103097-05-20
72712,47103097-05-20
36201,47103097-05-20
44567,47103097-05-20
49617,47103097-05-20
36208,47103097-05-20
36205,47103097-05-20
36206,47103097-05-20
36211,47103097-05-20
36210,47103097-05-20
36216,47103097-05-20
49629,47103097-05-20
49630,47103097-05-20
41504,47103097-05-20
49603,47103097-05-20
49604,47103097-05-20
49605,47103097-05-20
49607,47103097-05-20
36202,47103097-05-20
49608,47103097-05-20
49606,47103097-05-20
49614,47103097-05-20
49615,47103097-05-20
49663,47103097-05-20
49664,47103097-05-20
49626,47103097-05-20
49627,47103097-05-20
36222,47103097-05-20
36224,47103097-05-20
49623,47103097-05-20
40311,47103097-05-20
45652,47103097-05-20
39901,47103097-05-20
39959,47103097-05-20
51762,47103097-05-20
40062,47103097-05-20
40057,47103097-05-20
40094,47103097-05-20
36052,471

2025-01-17 19:59:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 19:59:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 19:59:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 19:59:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-17 19:59:53 - snowflake.connector.connection - INFO - closed
2025-01-17 19:59:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 19:59:53 - root - INFO - SQL:
SELECT "object_id" FROM THE_MET.THE_MET.VISION_API_DATA LIMIT 1000;
Results:
Too long, hard cut:
object_id
463536
286038
467486
386444
343968
288535
17449
343402
261387
342591
263135
361703
729624
385957
659124
345721
196356
339707
367415
398595
55574
197750
229095
471848
436731
198587
340058
349162
452670
342501
37895
399212
54652
11777
459002
11372
397694
206589
338515
364382
436770
10401
64534
471995
385089
342748
436911
102243
11798
11707
437490
438820
437703
475487
459040
291887
436664
463545
191777
349309
467808
205239
58026
269254
428639
260058
237070
260182
237754
45445
60060
403086
700206
371456
464151
187761
188903
398499
204625
206168
434111
393331
362267
16665
288561
250549
343201
1683
387537
391793
399237
14942
55423
195760
260113
37125
364839
366887
463765
451972
189163
56753
203111
190623
360642
202343
36707
189644
382454
56027
390689
59185
189700
194324
386145
642888
431358
302131
46445
268128
51416
286615
387541
367468
392932
434603
260140
269271
437069
460208
473465
156808
464299
204722
454344
36654
41933
438026
11274
189712
383935
63832
399691
442749
625354
38582
339119
55199
342463
227026
407167
704827
435691
436738
337665
377467
459019
271746
631422
436759
365816
12731
451283
208809
399545
249164
435766
73439
339543
10337
459015
437422
667926
459023
249232
435702
467508
435754
391053
350970
369533
453683
356476
436103
488733
10389
58263
13050
37993
436892
656826
392687
359151
337761
361613
730790
286173
269253
344140
260348
388833
712946
260126
436900
339559
342502
54660
437004
194541
260175
363737
2783
452125
199486
716639
54849
310365
37807
436802
389888
551108
435653
471218
435763
436835
266256
437268
436850
12552
200564
260352
198903
190119
335497
294508
461549
206726
386450
464286
471559
679466
189944
471122
193428
203376
187556
5207
446583
11471
44377
44384
682991
396179
55419
44365
56024
900
460148
364208
44373
198315
396434
38345
467475
271844
63835
656030
56534
58205
447804
400533
58256
11592
55268
288214
408994
428411
403228
286502
633712
15917
260119
437925
435716
13763
436793
186800
186826
57074
259609
386355
726237
285708
55887
368544
623329
471560
398521
221533
392427
10241
55183
464306
436118
55182
463649
436840
437593
436048
438821
284452
436502
437819
291872
285881
436230
73414
17652
459197
438025
437755
435714
44367
44366
44378
337450
209424
467378
386090
369331
203238
428608
469932
236779
193700
193450
392668
197483
44380
463697
471233
219919
396429
359431
367700
366523
386457
461128
475490
53924
390373
414259
286442
56070
467722
359618
209042
464450
446265
19732
10184
436097
186816
186825
403245
435607
446566
388654
339882
187154
670103
438466
458984
12749
436797
338711
543901
55237
437038
186815
186803
342849
682101
661968
156804
384486
339941
471112
437775
232212
288533
437674
436603
436838
435739
458982
464048
438617
194211
460602
367745
684712
206568
246809
191947
246813
464263
191612
60213
226955
291838
195319
13025
264576
294512
387951
463825
383998
470900
288164
392523
645760
287799
349133
383358
365615
455024
436989
651672
677492
707925
439553
341760
448555
45260
36662
460189
202330
435755
437342
435832
459043
363309
452017
55746
383926
367699
396359
227931
367702
195300
438605
437261
13198
386456
435602
198917
437855
463810
438427
426334
464290
44353
470306
453359
437606
435901
459075
343475
438724
231174
306160
452016
337948
339836
200591
189832
452019
704977
336882
189999
452015
291921
468949
421489
287964
199892
306161
236111
337963
467521
269236
435590
463974
53549
55261
73521
73582
343789
417495
338973
230011
56670
467641
212620
299315
45249
470618
358113
337058
248205
467650
436410
229568
467783
647634
54880
55561
201886
380487
232207
254819
264573
339890
471455
229601
55269
470874
288536
460192
202331
467787
461298
470921
437202
199070
436201
437298
459131
435578
198564
73510
368594
437604
55211
471981
55864
306156
437256
11627
436803
437897
267233
435824
442183
464275
286046
294514
452021
264579
467694
364823
641282
470873
392811
365971
193427
652670
306153
363260
631544
10353
468255
393293
55886
466330
345269
55894
306154
437019
454054
461628
305832
61532
294727
437602
447743
436076
286895
466201
436781
469871
467643
436487
446577
436098
10554
464272
156426
700867
54839
459005
192770
392464
343568
437018
436889
268085
73445
37956
384989
263070
437788
463580
428487
436518
471924
437466
435848
454049
437240
436656
436561
458961
55338
73461
437100
445280
437024
668004
37801
269260
342753
271712
437290
437329
470600
436801
37185
437222
436799
10534
556940
569681
58733
565031
504243
252416
309142
317631
448765
567611
326393
251899
189521
308879
58534
463673
225027
309141
229714
326580
2283
58596
545272
61135
323290
324546
717482
557255
251908
326827
422188
229722
322446
309139
244386
244370
549434
464615
545275
309144
324787
62550
250617
554932
549667
3994
473937
61146
315311
251124
3017
577195
325295
317408
700974
422111
323990
557135
1020
549870
457485
24624
26340
34943
450007
462906
681386
243818
243015
244178
324910
408572
323359
326233
561456
561453
559499
327720
738364
726160
558365
313448
37997
567637
447345
715022
24936
37996
738070
328788
2

2025-01-17 19:59:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 19:59:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 19:59:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 19:59:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 236
2025-01-17 19:59:56 - snowflake.connector.connection - INFO - closed
2025-01-17 19:59:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 19:59:56 - root - INFO - SQL:
SELECT "cropHintsAnnotation" FROM THE_MET.THE_MET.VISION_API_DATA LIMIT 1000;
Results:
Too long, hard cut:
cropHintsAnnotation
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2158,
            ""y"": 0
          },
          {
            ""x"": 2158,
            ""y"": 2871
          },
          {
            ""x"": 0,
            ""y"": 2871
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.700000047683716e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2490,
            ""y"": 0
          },
          {
            ""x"": 2490,
            ""y"": 3340
          },
          {
            ""x"": 0,
            ""y"": 3340
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 1.100000023841858e+00
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 1455,
            ""y"": 0
          },
          {
            ""x"": 1455,
            ""y"": 1899
          },
          {
            ""x"": 0,
            ""y"": 1899
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.700000047683716e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2843,
            ""y"": 0
          },
          {
            ""x"": 2843,
            ""y"": 3734
          },
          {
            ""x"": 0,
            ""y"": 3734
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.799999952316284e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2873,
            ""y"": 0
          },
          {
            ""x"": 2873,
            ""y"": 3982
          },
          {
            ""x"": 0,
            ""y"": 3982
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.599999845027924e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2026,
            ""y"": 0
          },
          {
            ""x"": 2026,
            ""y"": 2555
          },
          {
            ""x"": 0,
            ""y"": 2555
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 5.000000000000000e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2634,
            ""y"": 0
          },
          {
            ""x"": 2634,
            ""y"": 3999
          },
          {
            ""x"": 0,
            ""y"": 3999
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.700000047683716e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2821,
            ""y"": 0
          },
          {
            ""x"": 2821,
            ""y"": 3718
          },
          {
            ""x"": 0,
            ""y"": 3718
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.700000047683716e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2484,
            ""y"": 0
          },
          {
            ""x"": 2484,
            ""y"": 2943
          },
          {
            ""x"": 0,
            ""y"": 2943
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.499999940395355e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2614,
            ""y"": 0
          },
          {
            ""x"": 2614,
            ""y"": 3530
          },
          {
            ""x"": 0,
            ""y"": 3530
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.899999856948853e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
  

2025-01-17 19:59:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 19:59:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 19:59:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 19:59:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-17 19:59:58 - snowflake.connector.connection - INFO - closed
2025-01-17 19:59:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 19:59:58 - root - INFO - SQL:
SELECT
     t."object_id",
     f.value:"cropHints"[0]:"confidence"::FLOAT AS "cropConfidence"
   FROM
     THE_MET.THE_MET.VISION_API_DATA t,
     LATERAL FLATTEN(input => t."cropHintsAnnotation") f
   LIMIT 1000;
Results:
Too long, hard cut:
object_id,cropConfidence
437177,
437564,
201929,
397271,
355599,
412502,
337337,
209969,
6039,
53710,
377454,
196587,
336772,
558364,
399542,
390002,
693798,
367538,
369073,
37169,
339833,
201428,
209272,
416888,
347688,
397692,
335839,
471067,
435595,
204626,
56835,
209244,
282028,
398504,
446546,
194520,
436509,
464160,
266259,
438385,
435852,
459093,
11712,
467724,
458979,
436015,
435768,
338317,
739395,
679157,
191783,
202700,
13661,
370485,
188969,
291800,
645771,
193972,
198996,
64872,
739029,
464254,
464124,
463826,
437928,
36612,
471117,
199973,
382755,
288184,
286009,
645766,
464293,
463742,
505616,
386449,
369562,
646460,
228882,
207530,
387497,
44369,
44381,
198770,
367300,
437008,
436760,
198906,
44375,
354035,
463551,
56038,
44363,
736066,
56840,
437632,
56515,
37943,
55361,
286647,
386928,
436200,
361830,
392927,
55273,
199485,
156575,
200656,
466107,
437895,
448461,
436346,
436692,
186822,
186821,
63874,
707799,
383944,
396189,
668089,
58031,
468318,
470919,
191180,
463602,
467471,
463536,
286038,
467486,
386444,
343968,
288535,
17449,
343402,
261387,
342591,
263135,
361703,
729624,
385957,
659124,
345721,
196356,
339707,
367415,
398595,
55574,
197750,
229095,
471848,
436731,
198587,
340058,
349162,
452670,
342501,
37895,
399212,
54652,
11777,
459002,
11372,
397694,
206589,
338515,
364382,
436770,
10401,
64534,
471995,
385089,
342748,
436911,
102243,
11798,
11707,
437490,
438820,
437703,
475487,
459040,
291887,
436664,
463545,
191777,
349309,
467808,
205239,
58026,
269254,
428639,
260058,
237070,
260182,
237754,
45445,
60060,
403086,
700206,
371456,
464151,
187761,
188903,
398499,
204625,
206168,
434111,
393331,
362267,
16665,
288561,
250549,
343201,
1683,
387537,
391793,
399237,
14942,
55423,
195760,
260113,
37125,
364839,
366887,
463765,
451972,
189163,
56753,
203111,
190623,
360642,
202343,
36707,
189644,
382454,
56027,
390689,
59185,
189700,
194324,
386145,
642888,
431358,
302131,
46445,
268128,
51416,
286615,
387541,
367468,
392932,
434603,
260140,
269271,
437069,
460208,
473465,
156808,
464299,
204722,
454344,
36654,
41933,
438026,
11274,
189712,
383935,
63832,
399691,
442749,
625354,
38582,
339119,
55199,
342463,
227026,
407167,
704827,
435691,
436738,
337665,
377467,
459019,
271746,
631422,
436759,
365816,
12731,
451283,
208809,
399545,
249164,
435766,
73439,
339543,
10337,
459015,
437422,
667926,
459023,
249232,
435702,
467508,
435754,
391053,
350970,
369533,
453683,
356476,
436103,
488733,
10389,
58263,
13050,
37993,
436892,
656826,
392687,
359151,
337761,
361613,
730790,
286173,
269253,
344140,
260348,
388833,
712946,
260126,
436900,
339559,
342502,
54660,
437004,
194541,
260175,
363737,
2783,
452125,
199486,
716639,
54849,
310365,
37807,
436802,
389888,
551108,
435653,
471218,
435763,
436835,
266256,
437268,
436850,
12552,
200564,
260352,
198903,
190119,
335497,
294508,
461549,
206726,
386450,
464286,
471559,
679466,
189944,
471122,
193428,
203376,
187556,
5207,
446583,
11471,
44377,
44384,
682991,
205225,
357059,
333993,
38169,
44833,
548510,
391673,
387059,
74832,
17571,
437454,
467679,
42727,
436233,
623621,
467630,
335297,
10465,
335539,
435804,
263862,
437535,
246654,
288012,
436289,
437396,
547768,
13091,
11191,
10795,
503448,
369298,
288496,
436955,
384064,
437421,
192728,
405228,
339264,
10531,
10085,
488853,
12601,
436542,
386009,
436253,
254646,
369230,
435869,
268371,
193614,
12696,
10836,
10745,
337340,
489546,
437903,
10067,
435664,
436019,
460214,
326695,
435623,
436239,
437679,
39894,
436259,
197032,
10218,
437836,
45100,
206291,
97353,
548638,
435776,
437438,
730794,
288112,
11243,
334772,
415999,
399175,
366477,
306667,
394309,
422255,
15149,
458996,
417300,
268569,
36670,
402847,
196931,
289367,
625649,
415967,
419977,
261326,
339012,
113215,
189310,
369542,
59249,
342778,
406437,
192859,
392327,
460207,
10593,
386196,
392937,
390724,
205131,
339348,
641804,
268460,
659972,
417863,
728076,
350806,
193106,
708720,
45322,
37385,
739498,
643747,
396179,
55419,
44365,
56024,
398241,
471068,
420015,
336824,
396226,
291654,
394744,
698490,
268233,
396165,
388760,
10905,
423183,
390845,
428819,
374032,
12562,
13385,
478972,
288126,
393950,
364813,
414387,
633820,
390811,
699923,
268532,
339551,
10596,
268452,
369152,
372245,
55078,
11674,
264364,
369158,
290476,
371226,
392482,
367028,
424157,
348888,
394433,
686030,
11021,
372938,
428461,
557210,
306767,
306762,
38387,
417607,
4171,
4208,
4205,
4203,
4229,
4212,
4200,
4207,
4238,
4210,
467396,
4250,
343737,
189227,
12977,
14312,
326223,
200562,
408603,
76575,
411232,
675516,
399271,
371590,
11276,
336419,
10848,
285456,
268343,
391776,
45261,
348391,
246742,
339272,
10167,
424137,
408902,
645237,
207217,
676536,
436496,
208176,
13245,
37377,
361575,
193612,
410390,
73476,
288125,
15588,
268700,
416901,
410372,
339074,
291892,
351416,
435955,
37343,
405514,
437413,
242423,
337758,
547690,
16022,
207160,
644184,
465983,
358160,
388672,
335408,
213249,
12002,
53927,
361934,
342743,
402842,
387979,
239425,
395469,
342852,


2025-01-17 19:59:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 19:59:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 19:59:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:00:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-17 20:00:00 - snowflake.connector.connection - INFO - closed
2025-01-17 20:00:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:00:35 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:00:35 - root - INFO - ```sql
SELECT
  o."object_id",
  o."title",
  TO_CHAR(TO_TIMESTAMP(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "formatted_metadata_date"
FROM
  THE_MET.THE_MET.OBJECTS o
  INNER JOIN THE_MET.THE_MET.VISION_API_DATA v ON o."object_id" = v."object_id"
WHERE
  o."department" = 'The Libraries' AND
  o."title" ILIKE '%book%' AND
  v."cropHintsAnnotation":'cropHints'[0]:'confidence'::FLOAT > 0.5;
```
2025-01-17 20:00:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:00:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:00:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:00:36 - snowflake.connector.connection - INFO - closed
2025-01-17 20:00:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:01:15 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:01:15 - root - INFO - ```sql
SELECT
  o."object_id",
  o."title",
  TO_CHAR(TO_TIMESTAMP(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "formatted_metadata_date"
FROM
  THE_MET.THE_MET.OBJECTS o
  INNER JOIN THE_MET.THE_MET.VISION_API_DATA v ON o."object_id" = v."object_id"
WHERE
  o."department" = 'The Libraries' AND
  o."title" ILIKE '%book%' AND
  v."cropHintsAnnotation".get_path('cropHints[0].confidence')::FLOAT > 0.5;
```
2025-01-17 20:01:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:01:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:01:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:01:17 - snowflake.connector.connection - INFO - closed
2025-01-17 20:01:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:02:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:02:10 - root - INFO - ```sql
SELECT
  o."object_id",
  o."title",
  TO_CHAR(TO_TIMESTAMP(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "formatted_metadata_date"
FROM
  THE_MET.THE_MET.OBJECTS o
  JOIN THE_MET.THE_MET.VISION_API_DATA v ON o."object_id" = v."object_id"
WHERE
  o."department" = 'The Libraries'
  AND o."title" ILIKE '%book%'
  AND v."cropHintsAnnotation":cropHints[0]:confidence::FLOAT > 0.5;
```
2025-01-17 20:02:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:02:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:02:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:02:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-17 20:02:11 - snowflake.connector.connection - INFO - closed
2025-01-17 20:02:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:02:11 - root - INFO - SQL:
SELECT
  o."object_id",
  o."title",
  TO_CHAR(TO_TIMESTAMP(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "formatted_metadata_date"
FROM
  THE_MET.THE_MET.OBJECTS o
  JOIN THE_MET.THE_MET.VISION_API_DATA v ON o."object_id" = v."object_id"
WHERE
  o."department" = 'The Libraries'
  AND o."title" ILIKE '%book%'
  AND v."cropHintsAnnotation":cropHints[0]:confidence::FLOAT > 0.5;
Results:
object_id,title,formatted_metadata_date
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc.",2017-02-06
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06

2025-01-17 20:02:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:02:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:02:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:02:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-17 20:02:13 - snowflake.connector.connection - INFO - closed
2025-01-17 20:02:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:02:49 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:02:49 - root - INFO - ```sql
SELECT
  o."object_id",
  o."title",
  TO_CHAR(TO_TIMESTAMP(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "formatted_metadata_date"
FROM
  THE_MET.THE_MET.OBJECTS o
  JOIN THE_MET.THE_MET.VISION_API_DATA v ON o."object_id" = v."object_id"
WHERE
  o."department" = 'The Libraries'
  AND o."title" ILIKE '%book%';
```
2025-01-17 20:02:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:02:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:02:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:02:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-17 20:02:51 - snowflake.connector.connection - INFO - closed
2025-01-17 20:02:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:02:51 - root - INFO - SQL:
SELECT
  o."object_id",
  o."title",
  TO_CHAR(TO_TIMESTAMP(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "formatted_metadata_date"
FROM
  THE_MET.THE_MET.OBJECTS o
  JOIN THE_MET.THE_MET.VISION_API_DATA v ON o."object_id" = v."object_id"
WHERE
  o."department" = 'The Libraries'
  AND o."title" ILIKE '%book%';
Results:
object_id,title,formatted_metadata_date
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc.",2017-02-06
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06

2025-01-17 20:02:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:02:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:02:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:02:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-17 20:02:53 - snowflake.connector.connection - INFO - closed
2025-01-17 20:02:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:02:53 - root - INFO - SQL:
SELECT "object_id", "title" FROM THE_MET.THE_MET.OBJECTS WHERE "title" ILIKE '%book%' LIMIT 1000;
Results:
Too long, hard cut:
object_id,title
39483,明     郭詡     稱書圖     軸|Weighing Books
39667,明     杜堇     伏生授經圖   軸|The Scholar Fu Sheng Transmitting the Book of Documents
57754,画本宝能縷|Picture Book of Brocades with Precious Threads (Ehon takara no itosuji)
78593,絵本松のしらべ|Picture Book on the Music of the Pine Trees (Ehon matsu no shirabe)
78688,『和国諸職絵尽　諸織 絵本鏡』|A Picture Book Mirror of Various Occupations (Wakoku shoshoku ezukushi)
53815,Ehon Asakayama|絵本浅香山|Picture Book: Mount Asaka (Ehon Asakayama)
45062,"絵本末摘花|Picture Book: Flowers Yet to be Picked, Vol. 1"
57842,Ehon Ogurayama|絵本小倉山|Picture Book: Ogura Hill (Ehon Ogurayama)
57858,Ehon Himetsubaki|繪本女貞木|Picture Book: Camellia (Ehon Himetsubaki)
78723,『繪本常盤草』|Picture Book of the Evergreens (Ehon tokiwagusa)
78728,『繪本小倉山』|Picture Book of Ogura Hill (Ehon ogurayama)
78729,『繪本小松原』|Picture Book of Komatsubara (Ehon komatsubara)
78722,絵本常盤草　上・中・下|Picture Book of the Evergreens (Ehon tokiwagusa)
78585,『寫山樓畫本』|Shazanrō (Bunchō) Picture Book (Shazanrō ehon)
78739,『絵本時世粧』|Picture Book of Modern Figures of Fashion (Ehon imayō sugata)
78597,艶本 婦慈のゆき|An Erotic Picture Book of Snow on Fuji (Enpon fuji no yuki)
45273,絵本吾妻遊|Ehon Azuma asobi|Picture Book of Amusements of the Eastern Capital (Ehon Azuma asobi)
57568,Ehon Momochidori Kyōka-awase|百千鳥狂歌合|Myriad Birds: Picture Book of Playful Verse (Momo chidori kyōka-awase)
57605,絵本和歌夷 「龢謌夷」|Picture Book with Playful Poems for the Young God Ebisu
57648,潮干のつと|Gifts from the Ebb Tide (The Shell Book) (Shiohi no tsuto)
57569,画本虫撰|Picture Book of Crawling Creatures (The Insect Book) (Ehon mushi erami)
57570,画本虫撰|Picture Book of Crawling Creatures (The Insect Book) (Ehon mushi erami)
45322,繪本四季花|Picture Book of Flowers of the Four Seasons (Ehon shiki no hana)
78746,『青楼繪本年中行事』|Yoshiwara Picture Book of New Year’s Festivities (Seirō ehon nenjū gyōji)
78758,（榎木新右衛門）画 『雛形伊勢乃海』|Book of Kosode Patterns (Hiinagata Ise no umi)
45444,Ehon Musashi no Abumi|A Picture Book of Japanese Warriors
78635,『画本狂歌山満多山』|Picture Book of Kyōka Poems: Mountains upon Mountains (Ehon kyōka yama mata yama)
78771,"繪本彩色通　初編|Picture Book on the Use of Coloring, first volume (Ehon saishikitsū shohen)"
78772,『絵本和漢誉』|Picture Book on Heroes of China and Japan (Ehon wakan no homare)
78667,『暁斎漫画』|Kyōsai Sketchbook (Kyōsai manga)
55597,"『閨の雛形』　正月|Plate from the Erotic Book Mounds of Dyed Colors: A Pattern Book for the Boudoir (Someiro no yama neya no hinagata), First Month"
37283,"『画本虫撰』  「蜂」「毛虫」|Paper Wasp (Hachi); Hairy Caterpillar (Kemushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37284,"『画本虫撰』   「馬追虫」「むかて」|Katydid (Umaoi-mushi); Centipede, (Mukade), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37285,"『画本虫撰』   「けら」「はさみむし」|Mole Cricket (Kera); Earwig, (Hasami-mushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37286,"『画本虫撰』   「蝶」「蜻蛉」|Butterfly (Chō); Dragonfly (Kagerō or Tonbo), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37287,"『画本虫撰』  「虻」「芋虫」|Horsefly (abu); Green Caterpillar, imomushi, from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37288,"『画本虫撰』   「松虫」「虫蛍」|Tree cricket (Matsumushi); Firefly (Hotaru), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37289,"画本虫撰　バッタと蟷螂|Cone-headed Grasshopper or Locust, (batta); Praying Mantis (Tōrō or Kamakiri), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37290,"『画本虫撰』 「ひくらし」「くも」|Evening Cicada, Higurashi; Spider, Kumo, from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37291,"『画本虫撰』「赤蜻蛉」「いなこ」|Red Dragonfly (Akatonbo); Locust (Inago), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37292,"『画本虫撰』「虵」「とかけ」|Rat Snake (Hebi); Lizard or Skink (Tokage), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37293,"『画本虫撰』「蓑虫」「兜虫」|Bagworm (Minomushi); Horned Scarab Beetle (Kabutomushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37294,"『画本虫撰』「蝸牛」「轡虫」|Land Snail (Katatsumuri); Giant Katydid (Kutsuwamushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37295,"『画本虫撰』「きりきりす」「蝉」|Grasshopper (Kirigirisu); Cicada (Semi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37296,"『画本虫撰』「蚓」「こうろき」|Earthworm (Mimizu); Cricket (Kōrogi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37306,"四季の花|The Coming Thunderstorm, from the illustrated book Flowers of the Four Seasons"
37307,"四季の花|Women on a Bridge, from the illustrated book Flowers of the Four Seasons"
37308,"四季の花|A Child Lighting Fireworks, from the illustrated book Flowers of the Four Seasons"
37309,"四季の花|Girls Getting on Board a Boat, from the illustrated book Flowers of the Four Seasons"
37310,"四季の花|Girls Picking Green Leaves, from the illustrated book Flowers of the Four Seasons"
37311,"四季の花|New Year's Games, from the printed book Flowers of the Four Seasons (Shiki no hana)"
37312,"四季の花|Girls Entertained by Performers, from the illustrated book Flowers of the Four Seasons"
37313,"四季の花

2025-01-17 20:02:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:02:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:02:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:02:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-17 20:02:55 - snowflake.connector.connection - INFO - closed
2025-01-17 20:02:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:02:55 - root - INFO - SQL:
SELECT DISTINCT "metadata_date" FROM THE_MET.THE_MET.OBJECTS LIMIT 1000;
Results:
metadata_date
1486368016000000

2025-01-17 20:02:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:02:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:02:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:02:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 546
2025-01-17 20:02:57 - snowflake.connector.connection - INFO - closed
2025-01-17 20:02:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:02:58 - root - INFO - SQL:
SELECT
      t."object_id",
      f.value::STRING AS "cropHintsValue"
    FROM
      THE_MET.THE_MET.VISION_API_DATA t,
      LATERAL FLATTEN(input => t."cropHintsAnnotation") f
    LIMIT 1000;
Results:
Too long, hard cut:
object_id,cropHintsValue
437177,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":1586,""y"":0},{""x"":1586,""y"":1907},{""x"":0,""y"":1907}]},""confidence"":1.000000000000000e+00,""importanceFraction"":5.299999713897705e-01}]"
437564,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":2754,""y"":0},{""x"":2754,""y"":3418},{""x"":0,""y"":3418}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.499999940395355e-01}]"
201929,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":1795,""y"":0},{""x"":1795,""y"":1307},{""x"":0,""y"":1307}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.899999856948853e-01}]"
397271,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":2351,""y"":0},{""x"":2351,""y"":3999},{""x"":0,""y"":3999}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.599999845027924e-01}]"
355599,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":1323,""y"":0},{""x"":1323,""y"":1963},{""x"":0,""y"":1963}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.499999940395355e-01}]"
412502,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":3648,""y"":0},{""x"":3648,""y"":2882},{""x"":0,""y"":2882}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.499999940395355e-01}]"
337337,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":2755,""y"":0},{""x"":2755,""y"":3473},{""x"":0,""y"":3473}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.799999952316284e-01}]"
209969,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":3999,""y"":0},{""x"":3999,""y"":2701},{""x"":0,""y"":2701}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.499999940395355e-01}]"
6039,"[{""boundingPoly"":{""vertices"":[{""x"":187,""y"":0},{""x"":1695,""y"":0},{""x"":1695,""y"":1934},{""x"":187,""y"":1934}]},""confidence"":1.000000000000000e+00,""importanceFraction"":4.299999773502350e-01}]"
53710,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":3820,""y"":0},{""x"":3820,""y"":1866},{""x"":0,""y"":1866}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.999999761581421e-01}]"
377454,"[{""boundingPoly"":{""vertices"":[{""x"":179,""y"":0},{""x"":2505,""y"":0},{""x"":2505,""y"":3100},{""x"":179,""y"":3100}]},""confidence"":1.000000000000000e+00,""importanceFraction"":1.949999928474426e+00}]"
196587,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":1463,""y"":0},{""x"":1463,""y"":1811},{""x"":0,""y"":1811}]},""confidence"":1.000000000000000e+00,""importanceFraction"":9.699999690055847e-01}]"
336772,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":2815,""y"":0},{""x"":2815,""y"":3516},{""x"":0,""y"":3516}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.700000047683716e-01}]"
558364,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":2495,""y"":0},{""x"":2495,""y"":3855},{""x"":0,""y"":3855}]},""confidence"":1.000000000000000e+00,""importanceFraction"":4.699999988079071e-01}]"
399542,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":1854,""y"":0},{""x"":1854,""y"":1553},{""x"":0,""y"":1553}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.599999845027924e-01}]"
390002,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":3635,""y"":0},{""x"":3635,""y"":2750},{""x"":0,""y"":2750}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.499999940395355e-01}]"
693798,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":2565,""y"":0},{""x"":2565,""y"":3490},{""x"":0,""y"":3490}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.499999940395355e-01}]"
367538,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":3684,""y"":0},{""x"":3684,""y"":2406},{""x"":0,""y"":2406}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.499999940395355e-01}]"
369073,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":3725,""y"":0},{""x"":3725,""y"":2674},{""x"":0,""y"":2674}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.599999845027924e-01}]"
37169,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":1254,""y"":0},{""x"":1254,""y"":1919},{""x"":0,""y"":1919}]},""confidence"":1.000000000000000e+00,""importanceFraction"":4.399999976158142e-01}]"
339833,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":2390,""y"":0},{""x"":2390,""y"":1052},{""x"":0,""y"":1052}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.899999856948853e-01}]"
201428,"[{""boundingPoly"":{""vertices"":[{""x"":53,""y"":0},{""x"":1750,""y"":0},{""x"":1750,""y"":1195},{""x"":53,""y"":1195}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.899999856948853e-01}]"
209272,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":2784,""y"":0},{""x"":2784,""y"":2776},{""x"":0,""y"":2776}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.700000047683716e-01}]"
416888,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":228

2025-01-17 20:02:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:02:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:02:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:02:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-17 20:02:59 - snowflake.connector.connection - INFO - closed
2025-01-17 20:02:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:03:00 - root - INFO - SQL:
SELECT DISTINCT o."object_id"
    FROM THE_MET.THE_MET.OBJECTS o
    INNER JOIN THE_MET.THE_MET.VISION_API_DATA v ON o."object_id" = v."object_id"
    LIMIT 1000;
Results:
Too long, hard cut:
object_id
2704
308689
546942
204339
343127
578666
202859
104470
201749
239562
113100
393606
449595
308332
546355
226289
568716
90391
388318
453272
196116
340669
506171
447997
310223
214796
325122
345467
75091
9595
438947
681278
285647
559821
189458
562094
37216
12182
445763
450642
5419
199611
227360
67391
59408
247783
411307
422120
200413
309966
188922
203055
55166
478568
371380
555174
2416
44426
22067
21919
355297
26327
221130
334118
457103
706476
47379
463793
198114
450362
325404
390599
422167
198525
58006
195003
119817
114692
457652
240352
209420
188252
42427
552608
437585
410925
551448
407097
194942
407117
188790
336026
5289
50060
469942
67933
559049
246607
261842
12440
245736
557048
244998
543956
188673
406563
437278
459218
287224
104125
33416
68945
237794
339364
371330
229917
72238
363718
50567
248996
190932
2408
222298
322041
53294
470655
239820
53829
187333
465046
196881
443778
43187
464566
475263
215128
429577
559797
314494
671046
252392
414878
204646
38406
219215
550160
403876
8247
243638
457316
67544
323916
40927
226694
264982
457582
666123
548861
710927
623386
256149
37980
342718
210720
471572
335099
544918
552304
481037
396961
322209
217194
35629
53301
255152
446239
244603
192752
340690
360519
70494
158967
483721
463240
254598
259152
548918
443429
386602
255180
693149
189464
157645
26505
12536
459756
364657
546319
562783
680079
90509
215354
3984
367283
49457
377640
356327
307641
11625
460911
56864
463400
247677
228953
238890
706447
200075
409358
361716
205579
287227
339329
202452
391036
225069
373934
209332
36888
57442
504201
450132
318649
245457
69832
263219
577208
206032
223055
243795
446749
345033
364110
545185
36512
443619
13621
394016
383012
219561
12607
342590
195610
560420
325260
222656
343059
13261
372991
55814
571945
22070
652440
550253
337920
467250
438033
12834
465583
3115
577252
257058
203436
413447
347404
214013
345491
21355
453299
196921
156406
383677
7769
247850
56069
52471
408387
227192
324194
504522
243266
60626
229689
644465
573092
675898
56922
244892
241006
466754
324507
396903
159420
502513
444199
58940
58774
639405
823
547995
588380
189855
412508
52709
460185
222421
407562
66737
43157
214228
230476
213469
230414
467233
62094
37256
261879
369623
103642
222954
549709
193590
359471
200159
86410
69419
198916
21304
694395
336035
325661
415234
66211
218670
60076
384176
446349
565871
112933
288478
284874
14307
223568
464662
16479
339104
68909
386092
680464
267987
361656
683
355377
479299
549079
186434
659535
15944
573130
363050
5179
22876
46970
200942
156996
188916
219348
62198
571089
317567
360743
49194
451272
384993
705848
62577
623258
505106
369251
549444
45222
423149
205025
365723
340883
173651
547214
50573
400084
370772
55583
69748
391283
624385
316578
12592
451933
58507
545033
444840
37915
59434
209715
193609
437311
55498
9524
446997
326425
576998
68580
12271
224024
422679
288483
662923
186301
376110
222763
503844
400876
322240
19022
45251
119566
659539
124281
248903
66746
443823
237244
226358
342218
396339
358404
204773
58068
336919
259583
382652
197660
217269
327288
449010
662608
63819
59148
195268
251134
316963
244132
62974
451734
416148
465537
437637
323960
22768
216309
418593
450455
187528
68385
15807
156171
554596
67545
445502
323504
287368
223496
447928
188353
60125
3858
336339
376307
253044
124189
436274
251197
428762
339191
36657
72223
201353
64336
1999
338222
68751
545016
363506
570666
340835
19099
191825
115295
308667
13749
406656
193723
55737
412057
47853
39371
13761
247626
216991
388259
546214
54418
394031
545905
227841
477767
50859
393665
317533
156174
308015
463039
287770
445280
10184
390689
357164
37186
467941
412823
460166
549152
559066
246399
35126
400955
209571
90999
454504
307937
548969
57806
464905
437822
384959
14626
43911
323032
447006
460804
186216
246624
13000
255183
465624
684053
372635
661791
16319
415013
205742
369356
244558
341660
74650
50492
324310
214012
27144
348339
45274
590760
3441
43810
549703
216725
288532
54499
247215
26309
26598
51478
239155
458958
21185
219262
437056
323353
18844
251053
348004
43230
243821
232049
337624
386617
453494
192048
10141
26568
5133
251138
414932
364742
472117
348771
70670
316713
410377
310218
328746
232033
69717
685806
341439
670645
3096
204120
60283
414949
449313
652955
243899
62907
205984
243818
190588
222408
562061
323613
192669
5850
462952
86757
446891
340808
227393
240128
224317
444423
659075
43039
327381
554326
324800
553870
419903
65837
316818
415603
336855
321658
13799
463870
437273
40871
57221
346399
400618
443296
207934
389415
168761
465980
221970
567611
65986
410444
570431
60716
22394
218093
449337
158262
435788
395546
552455
545203
383824
334422
66524
199891
2487
169664
704860
448081
53281
26529
168342
400020
467909
452027
13074
47115
51150
544238
474512
66045
411473
465128
131994
188867
463702
268226
393249
485547
69838
23396
476394
325897
121214
446115
447890
251544
467258
336767
70471
243793
285838
408555
216978
248778
551600
169723
8405
334221
431194
463927
461279
555482
14731
60605
13629
201833

2025-01-17 20:03:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:03:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:03:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:03:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-17 20:03:01 - snowflake.connector.connection - INFO - closed
2025-01-17 20:03:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:03:02 - root - INFO - SQL:
SELECT "title" FROM THE_MET.THE_MET.OBJECTS WHERE "department" = 'The Libraries' AND "title" ILIKE '%book%' LIMIT 1000;
Results:
title
The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans
"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found"
"The cabinet-maker and upholsterer's drawing-book, in three parts"
"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work"
"The Whole Art of Marbling as Applied to Paper, Book Edges, etc."

2025-01-17 20:03:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:03:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:03:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:03:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-17 20:03:03 - snowflake.connector.connection - INFO - closed
2025-01-17 20:03:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:03:03 - root - INFO - SQL:
SELECT "object_id", TO_CHAR(TO_TIMESTAMP("metadata_date"), 'YYYY-MM-DD') AS "formatted_metadata_date" FROM THE_MET.THE_MET.OBJECTS LIMIT 1000;
Results:
Too long, hard cut:
object_id,formatted_metadata_date
646996,47103097-05-20
77916,47103097-05-20
38009,47103097-05-20
37988,47103097-05-20
74660,47103097-05-20
74674,47103097-05-20
74675,47103097-05-20
74677,47103097-05-20
74685,47103097-05-20
65595,47103097-05-20
73261,47103097-05-20
38042,47103097-05-20
39894,47103097-05-20
64891,47103097-05-20
65590,47103097-05-20
65594,47103097-05-20
40445,47103097-05-20
45063,47103097-05-20
40069,47103097-05-20
40070,47103097-05-20
37964,47103097-05-20
75084,47103097-05-20
75085,47103097-05-20
75086,47103097-05-20
75087,47103097-05-20
75088,47103097-05-20
75089,47103097-05-20
75090,47103097-05-20
75091,47103097-05-20
75092,47103097-05-20
75093,47103097-05-20
75094,47103097-05-20
75095,47103097-05-20
75096,47103097-05-20
75097,47103097-05-20
75098,47103097-05-20
75099,47103097-05-20
75100,47103097-05-20
75101,47103097-05-20
75102,47103097-05-20
75103,47103097-05-20
75104,47103097-05-20
75105,47103097-05-20
75106,47103097-05-20
75107,47103097-05-20
75108,47103097-05-20
75109,47103097-05-20
75110,47103097-05-20
75111,47103097-05-20
75112,47103097-05-20
75113,47103097-05-20
75114,47103097-05-20
75115,47103097-05-20
75116,47103097-05-20
75117,47103097-05-20
75118,47103097-05-20
75119,47103097-05-20
75120,47103097-05-20
75121,47103097-05-20
75122,47103097-05-20
75123,47103097-05-20
75124,47103097-05-20
75125,47103097-05-20
75126,47103097-05-20
75127,47103097-05-20
75128,47103097-05-20
75129,47103097-05-20
75130,47103097-05-20
75131,47103097-05-20
75132,47103097-05-20
75133,47103097-05-20
75134,47103097-05-20
75135,47103097-05-20
75136,47103097-05-20
75137,47103097-05-20
75138,47103097-05-20
75139,47103097-05-20
75140,47103097-05-20
75141,47103097-05-20
75142,47103097-05-20
75143,47103097-05-20
75145,47103097-05-20
75146,47103097-05-20
75147,47103097-05-20
75148,47103097-05-20
75149,47103097-05-20
75150,47103097-05-20
75151,47103097-05-20
75152,47103097-05-20
75153,47103097-05-20
54912,47103097-05-20
38448,47103097-05-20
40429,47103097-05-20
40432,47103097-05-20
73188,47103097-05-20
74683,47103097-05-20
72589,47103097-05-20
74656,47103097-05-20
64046,47103097-05-20
39899,47103097-05-20
36145,47103097-05-20
49665,47103097-05-20
36130,47103097-05-20
36435,47103097-05-20
36036,47103097-05-20
36072,47103097-05-20
49133,47103097-05-20
65620,47103097-05-20
40021,47103097-05-20
49453,47103097-05-20
49134,47103097-05-20
65075,47103097-05-20
41468,47103097-05-20
40507,47103097-05-20
40052,47103097-05-20
35995,47103097-05-20
35999,47103097-05-20
36003,47103097-05-20
45786,47103097-05-20
73669,47103097-05-20
49179,47103097-05-20
49226,47103097-05-20
51727,47103097-05-20
51705,47103097-05-20
51528,47103097-05-20
51656,47103097-05-20
51644,47103097-05-20
36129,47103097-05-20
51770,47103097-05-20
64029,47103097-05-20
60764,47103097-05-20
51902,47103097-05-20
64045,47103097-05-20
36439,47103097-05-20
40285,47103097-05-20
40107,47103097-05-20
40180,47103097-05-20
40194,47103097-05-20
40060,47103097-05-20
40058,47103097-05-20
45684,47103097-05-20
45746,47103097-05-20
39766,47103097-05-20
45749,47103097-05-20
44574,47103097-05-20
45775,47103097-05-20
45780,47103097-05-20
51865,47103097-05-20
77914,47103097-05-20
48875,47103097-05-20
48955,47103097-05-20
48954,47103097-05-20
49025,47103097-05-20
49029,47103097-05-20
56553,47103097-05-20
41780,47103097-05-20
39625,47103097-05-20
48931,47103097-05-20
48928,47103097-05-20
48959,47103097-05-20
49129,47103097-05-20
49146,47103097-05-20
49147,47103097-05-20
49163,47103097-05-20
51894,47103097-05-20
36132,47103097-05-20
51900,47103097-05-20
75814,47103097-05-20
54308,47103097-05-20
55495,47103097-05-20
49473,47103097-05-20
35987,47103097-05-20
44570,47103097-05-20
40105,47103097-05-20
40509,47103097-05-20
42329,47103097-05-20
39918,47103097-05-20
39919,47103097-05-20
40103,47103097-05-20
40104,47103097-05-20
41777,47103097-05-20
41860,47103097-05-20
40018,47103097-05-20
41778,47103097-05-20
41782,47103097-05-20
63196,47103097-05-20
63185,47103097-05-20
49047,47103097-05-20
50549,47103097-05-20
53924,47103097-05-20
53925,47103097-05-20
53926,47103097-05-20
53927,47103097-05-20
53928,47103097-05-20
53929,47103097-05-20
42323,47103097-05-20
36236,47103097-05-20
36098,47103097-05-20
72711,47103097-05-20
72712,47103097-05-20
36201,47103097-05-20
44567,47103097-05-20
49617,47103097-05-20
36208,47103097-05-20
36205,47103097-05-20
36206,47103097-05-20
36211,47103097-05-20
36210,47103097-05-20
36216,47103097-05-20
49629,47103097-05-20
49630,47103097-05-20
41504,47103097-05-20
49603,47103097-05-20
49604,47103097-05-20
49605,47103097-05-20
49607,47103097-05-20
36202,47103097-05-20
49608,47103097-05-20
49606,47103097-05-20
49614,47103097-05-20
49615,47103097-05-20
49663,47103097-05-20
49664,47103097-05-20
49626,47103097-05-20
49627,47103097-05-20
36222,47103097-05-20
36224,47103097-05-20
49623,47103097-05-20
40311,47103097-05-20
45652,47103097-05-20
39901,47103097-05-20
39959,47103097-05-20
51762,47103097-05-20
40062,47103097-05-20
40057,47103097-05-20
40094,47103097-05-20
36052,471

2025-01-17 20:03:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:03:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:03:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:03:05 - snowflake.connector.connection - INFO - closed
2025-01-17 20:03:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:04:10 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:04:10 - root - INFO - ```sql
SELECT
  o."object_id",
  o."title",
  TO_CHAR(TO_TIMESTAMP(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "formatted_metadata_date"
FROM
  THE_MET.THE_MET.OBJECTS o
  JOIN THE_MET.THE_MET.VISION_API_DATA v ON o."object_id" = v."object_id"
WHERE
  o."department" = 'The Libraries'
  AND o."title" ILIKE '%book%'
  AND v."cropHintsAnnotation":cropHints[0]:confidence::FLOAT > 0.5;
```
2025-01-17 20:04:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:04:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:04:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:04:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-17 20:04:11 - snowflake.connector.connection - INFO - closed
2025-01-17 20:04:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:04:12 - root - INFO - SQL:
SELECT
  o."object_id",
  o."title",
  TO_CHAR(TO_TIMESTAMP(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "formatted_metadata_date"
FROM
  THE_MET.THE_MET.OBJECTS o
  JOIN THE_MET.THE_MET.VISION_API_DATA v ON o."object_id" = v."object_id"
WHERE
  o."department" = 'The Libraries'
  AND o."title" ILIKE '%book%'
  AND v."cropHintsAnnotation":cropHints[0]:confidence::FLOAT > 0.5;
Results:
object_id,title,formatted_metadata_date
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc.",2017-02-06
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06

2025-01-17 20:04:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:04:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:04:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:04:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-17 20:04:13 - snowflake.connector.connection - INFO - closed
2025-01-17 20:04:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:04:13 - root - INFO - SQL:
SELECT DISTINCT "title" FROM THE_MET.THE_MET.OBJECTS WHERE "title" ILIKE '%book%' LIMIT 1000;
Results:
Too long, hard cut:
title
明     郭詡     稱書圖     軸|Weighing Books
明     杜堇     伏生授經圖   軸|The Scholar Fu Sheng Transmitting the Book of Documents
画本宝能縷|Picture Book of Brocades with Precious Threads (Ehon takara no itosuji)
絵本松のしらべ|Picture Book on the Music of the Pine Trees (Ehon matsu no shirabe)
『和国諸職絵尽　諸織 絵本鏡』|A Picture Book Mirror of Various Occupations (Wakoku shoshoku ezukushi)
Ehon Asakayama|絵本浅香山|Picture Book: Mount Asaka (Ehon Asakayama)
Ehon Ogurayama|絵本小倉山|Picture Book: Ogura Hill (Ehon Ogurayama)
Ehon Himetsubaki|繪本女貞木|Picture Book: Camellia (Ehon Himetsubaki)
『繪本小倉山』|Picture Book of Ogura Hill (Ehon ogurayama)
『繪本小松原』|Picture Book of Komatsubara (Ehon komatsubara)
『寫山樓畫本』|Shazanrō (Bunchō) Picture Book (Shazanrō ehon)
『絵本時世粧』|Picture Book of Modern Figures of Fashion (Ehon imayō sugata)
絵本吾妻遊|Ehon Azuma asobi|Picture Book of Amusements of the Eastern Capital (Ehon Azuma asobi)
Ehon Momochidori Kyōka-awase|百千鳥狂歌合|Myriad Birds: Picture Book of Playful Verse (Momo chidori kyōka-awase)
潮干のつと|Gifts from the Ebb Tide (The Shell Book) (Shiohi no tsuto)
繪本四季花|Picture Book of Flowers of the Four Seasons (Ehon shiki no hana)
『画本狂歌山満多山』|Picture Book of Kyōka Poems: Mountains upon Mountains (Ehon kyōka yama mata yama)
『絵本和漢誉』|Picture Book on Heroes of China and Japan (Ehon wakan no homare)
絵本和歌夷 「龢謌夷」|Picture Book with Playful Poems for the Young God Ebisu
画本虫撰|Picture Book of Crawling Creatures (The Insect Book) (Ehon mushi erami)
『青楼繪本年中行事』|Yoshiwara Picture Book of New Year’s Festivities (Seirō ehon nenjū gyōji)
『暁斎漫画』|Kyōsai Sketchbook (Kyōsai manga)
"『閨の雛形』　正月|Plate from the Erotic Book Mounds of Dyed Colors: A Pattern Book for the Boudoir (Someiro no yama neya no hinagata), First Month"
"『画本虫撰』  「虻」「芋虫」|Horsefly (abu); Green Caterpillar, imomushi, from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』   「松虫」「虫蛍」|Tree cricket (Matsumushi); Firefly (Hotaru), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"画本虫撰　バッタと蟷螂|Cone-headed Grasshopper or Locust, (batta); Praying Mantis (Tōrō or Kamakiri), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"四季の花|Women on a Bridge, from the illustrated book Flowers of the Four Seasons"
"四季の花|A Child Lighting Fireworks, from the illustrated book Flowers of the Four Seasons"
"四季の花|Girls Getting on Board a Boat, from the illustrated book Flowers of the Four Seasons"
"四季の花|New Year's Games, from the printed book Flowers of the Four Seasons (Shiki no hana)"
"『雛形若菜初模様　玉や内　しら玉』|The Courtesan Shiratama of the Tamaya Brothel, from the series “A Pat-tern Book of the Year’s First Designs, Fresh as Spring Herbs” (“Hinagata wakana hatsu moyō”)"
"『雛形若菜初模様　四ツ目屋内　にしき木』|The Courtesan Nishikigi of the Yotsumeya Brothel, from the series “A Pattern Book of the Year’s First Designs, Fresh as Spring Herbs” (“Hinagata wakana hatsu moyō”)"
"『雛形若菜の初模様　扇屋内　七越』|The Courtesan Nanakoshi of the Ōgiya Brothel, from the series “A Pat-tern Book of the Year’s First Designs, Fresh as Spring Herbs” (“Hinagata wakana no hatsu moyō”)"
"『画本虫撰』   「けら」「はさみむし」|Mole Cricket (Kera); Earwig, (Hasami-mushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』「蝸牛」「轡虫」|Land Snail (Katatsumuri); Giant Katydid (Kutsuwamushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"Kamakura no Koshi|The Filial Son at Kamakura, From the Book: Sasekishu"
"『雛形若菜の初模様　つたや内　人まち』|The Courtesan Hitomachi of the Tsutaya Brothel, from the series “A Pat-tern Book of the Year’s First Designs, Fresh as Spring Herbs” (“Hinagata wakana no hatsu moyō”)"
[Woman in Robes Reading a Book]
[Seated Man Pointing to a Passage in an Open Book]
"Manuscript Illumination with the Visitation in an Initial D, from a Choir Book"
"Manuscript Leaf with Adoration of the Holy Name, from a Book of Hours"
The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans
"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work"
"London Chair-Makers' and Carvers' Book of Prices, for Workmanship..."
"The Oxford Drawing Book to which is added, Lessons in Flower Drawing"
A Booke of Christian Prayers
"Sketch Book Containing 182 drawings on 91 leaves. One of a series used by the artist on his Italian trip, 1750–52; Sketches made in Milan, Turin, Florence, and Rome."
Compendium of Architectural Books by Sebastiano Serlio (Books I-V)
The Architecture of A. Palladio in Four Books containing a Short Treatise on the Five Orders (L'Architecture de A. Palladio en quatre livres... / Il quattro libri dell'architettura)
Book of Designs [for Ironwork]
"St. Luke, seated on a cloud with an open book in both hands, a bull lying at his feet, from a series of the four evangelists after Agostino Veneziano, which are in turn after Giulio Romano"
"Dialectic: a young woman standing in a decorated interior and touching her right index finger to her left middle finger in a counting gesture, at he

2025-01-17 20:04:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:04:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:04:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:04:15 - snowflake.connector.connection - INFO - closed
2025-01-17 20:04:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:04:46 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:04:46 - root - INFO - ```sql
SELECT
  v."object_id"
FROM
  THE_MET.THE_MET.VISION_API_DATA v
WHERE
  v."cropHintsAnnotation":'cropHints'[0]:'confidence'::FLOAT > 0.5
LIMIT 1000;
```
2025-01-17 20:04:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:04:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:04:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:04:48 - snowflake.connector.connection - INFO - closed
2025-01-17 20:04:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:05:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:05:14 - root - INFO - ```sql
SELECT
  o."object_id",
  o."title",
  TO_CHAR(TO_TIMESTAMP(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "formatted_metadata_date"
FROM
  THE_MET.THE_MET.OBJECTS o
  JOIN THE_MET.THE_MET.VISION_API_DATA v ON o."object_id" = v."object_id"
WHERE
  o."department" = 'The Libraries'
  AND o."title" ILIKE '%book%'
  AND v."cropHintsAnnotation".GET('cropHints[0].confidence')::FLOAT > 0.5;
```
2025-01-17 20:05:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:05:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:05:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:05:16 - snowflake.connector.connection - INFO - closed
2025-01-17 20:05:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:06:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:06:05 - root - INFO - ```sql
SELECT
  o."object_id",
  o."title",
  TO_CHAR(TO_TIMESTAMP(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "formatted_metadata_date"
FROM
  THE_MET.THE_MET.OBJECTS o
  JOIN THE_MET.THE_MET.VISION_API_DATA v ON o."object_id" = v."object_id"
WHERE
  o."department" = 'The Libraries'
  AND o."title" ILIKE '%book%'
  AND GET_PATH(v."cropHintsAnnotation", 'cropHints[0].confidence')::FLOAT > 0.5;
```
2025-01-17 20:06:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:06:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:06:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:06:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-17 20:06:06 - snowflake.connector.connection - INFO - closed
2025-01-17 20:06:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:06:06 - root - INFO - SQL:
SELECT
  o."object_id",
  o."title",
  TO_CHAR(TO_TIMESTAMP(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "formatted_metadata_date"
FROM
  THE_MET.THE_MET.OBJECTS o
  JOIN THE_MET.THE_MET.VISION_API_DATA v ON o."object_id" = v."object_id"
WHERE
  o."department" = 'The Libraries'
  AND o."title" ILIKE '%book%'
  AND GET_PATH(v."cropHintsAnnotation", 'cropHints[0].confidence')::FLOAT > 0.5;
Results:
object_id,title,formatted_metadata_date
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc.",2017-02-06
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06

2025-01-17 20:06:07 - root - INFO - itercount: 0
2025-01-17 20:06:07 - root - INFO - Database Name: THE_MET
Schema Name: THE_MET
DDL describes table information.
,0
table_name,VISION_API_DATA
description,
DDL,"create or replace TABLE VISION_API_DATA (
	""object_id"" NUMBER(38,0),
	""faceAnnotations"" VARIANT,
	""landmarkAnnotations"" VARIANT,
	""cropHintsAnnotation"" VARIANT,
	""logoAnnotations"" VARIANT,
	""labelAnnotations"" VARIANT,
	""textAnnotations"" VARIANT,
	""fullTextAnnotation"" VARCHAR(16777216),
	""imagePropertiesAnnotation"" VARIANT,
	""safeSearchAnnotation"" VARCHAR(16777216),
	""webDetection"" VARIANT
);"

,1
table_name,IMAGES
description,
DDL,"create or replace TABLE IMAGES (
	""object_id"" NUMBER(38,0),
	""public_caption"" VARCHAR(16777216),
	""title"" VARCHAR(16777216),
	""original_image_url"" VARCHAR(16777216),
	""caption"" VARCHAR(16777216),
	""is_oasc"" BOOLEAN,
	""gcs_url"" VARCHAR(16777216)
);"

,2
table_name,OBJECTS
description,
DDL,"create or replace TABLE OBJECTS (
	""object_number"" VARCHAR(16777216),
	""is_highlight"" BOOLEAN,
	""is_public_domain"" BOOLEAN,
	""object_id"" NUMBER(38,0),
	""department"" VARCHAR(16777216),
	""object_name"" VARCHAR(16777216),
	""title"" VARCHAR(16777216),
	""culture"" VARCHAR(16777216),
	""period"" VARCHAR(16777216),
	""dynasty"" VARCHAR(16777216),
	""reign"" VARCHAR(16777216),
	""portfolio"" VARCHAR(16777216),
	""artist_role"" VARCHAR(16777216),
	""artist_prefix"" VARCHAR(16777216),
	""artist_display_name"" VARCHAR(16777216),
	""artist_display_bio"" VARCHAR(16777216),
	""artist_suffix"" VARCHAR(16777216),
	""artist_alpha_sort"" VARCHAR(16777216),
	""artist_nationality"" VARCHAR(16777216),
	""artist_begin_date"" VARCHAR(16777216),
	""artist_end_date"" VARCHAR(16777216),
	""object_date"" VARCHAR(16777216),
	""object_begin_date"" NUMBER(38,0),
	""object_end_date"" NUMBER(38,0),
	""medium"" VARCHAR(16777216),
	""dimensions"" VARCHAR(16777216),
	""credit_line"" VARCHAR(16777216),
	""geography_type"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""subregion"" VARCHAR(16777216),
	""locale"" VARCHAR(16777216),
	""locus"" VARCHAR(16777216),
	""excavation"" VARCHAR(16777216),
	""river"" VARCHAR(16777216),
	""classification"" VARCHAR(16777216),
	""rights_and_reproduction"" VARCHAR(16777216),
	""link_resource"" VARCHAR(16777216),
	""metadata_date"" NUMBER(38,0),
	""repository"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'THE_MET': {'THE_MET': ['IMAGES', 'OBJECTS', 'VISION_API_DATA']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **OBJECTS table**:
  - `"object_id"`: Used to uniquely identify each object and join with other tables.
  - `"title"`: To retrieve the title of the object.
  - `"metadata_date"`: Contains the metadata date, which needs to be formatted.
  - `"department"`: To filter objects belonging to "The Libraries" department.

- **VISION_API_DATA table**:
  - `"object_id"`: To join with the OBJECTS table.
  - `"cropHintsAnnotation"`: Contains `cropConfidence` values within its JSON structure.

**Conditions to be used:**

- Filter objects where `"department"` equals `'The Libraries'`.
- Filter titles containing the word `'book'`.
- Extract and filter on `"cropConfidence"` greater than `0.5`.

---

**SQL Queries:**

1. **Retrieve distinct departments from the OBJECTS table:**
   ```sql
   SELECT DISTINCT "department" FROM THE_MET.THE_MET.OBJECTS LIMIT 1000;
   ```

2. **Get object IDs and titles from the OBJECTS table where the department is "The Libraries":**
   ```sql
   SELECT "object_id", "title" FROM THE_MET.THE_MET.OBJECTS WHERE "department" = 'The Libraries' LIMIT 1000;
   ```

3. **Find titles containing the word "book" in the OBJECTS table:**
   ```sql
   SELECT "title" FROM THE_MET.THE_MET.OBJECTS WHERE "title" ILIKE '%book%' LIMIT 1000;
   ```

4. **Retrieve object IDs where the title contains "book" and department is "The Libraries":**
   ```sql
   SELECT "object_id" FROM THE_MET.THE_MET.OBJECTS WHERE "department" = 'The Libraries' AND "title" ILIKE '%book%' LIMIT 1000;
   ```

5. **Select metadata dates from the OBJECTS table to understand the format:**
   ```sql
   SELECT "metadata_date" FROM THE_MET.THE_MET.OBJECTS LIMIT 1000;
   ```

6. **Attempt to format metadata dates (assuming it's an epoch timestamp):**
   ```sql
   SELECT "object_id", TO_CHAR(TO_TIMESTAMP("metadata_date"), 'YYYY-MM-DD') AS "formatted_metadata_date" FROM THE_MET.THE_MET.OBJECTS LIMIT 1000;
   ```

7. **Retrieve object IDs from the VISION_API_DATA table:**
   ```sql
   SELECT "object_id" FROM THE_MET.THE_MET.VISION_API_DATA LIMIT 1000;
   ```

8. **Explore the structure of "cropHintsAnnotation" in VISION_API_DATA:**
   ```sql
   SELECT "cropHintsAnnotation" FROM THE_MET.THE_MET.VISION_API_DATA LIMIT 1000;
   ```

9. **Extract "cropConfidence" values from "cropHintsAnnotation":**
   ```sql
   SELECT
     t."object_id",
     f.value:"cropHints"[0]:"confidence"::FLOAT AS "cropConfidence"
   FROM
     THE_MET.THE_MET.VISION_API_DATA t,
     LATERAL FLATTEN(input => t."cropHintsAnnotation") f
   LIMIT 1000;
   ```

10. **Retrieve object IDs where "cropConfidence" is greater than 0.5:**
    ```sql
    SELECT
      t."object_id"
    FROM
      THE_MET.THE_MET.VISION_API_DATA t,
      LATERAL FLATTEN(input => t."cropHintsAnnotation") f
    WHERE
      f.value:"cropHints"[0]:"confidence"::FLOAT > 0.5
    LIMIT 1000;
    ```

11. **Find titles containing the word "book" in the IMAGES table:**
    ```sql
    SELECT "title" FROM THE_MET.THE_MET.IMAGES WHERE "title" ILIKE '%book%' LIMIT 1000;
    ```

12. **List object IDs and titles from OBJECTS where titles contain "book":**
    ```sql
    SELECT "object_id", "title" FROM THE_MET.THE_MET.OBJECTS WHERE "title" ILIKE '%book%' LIMIT 1000;
    ```

13. **Retrieve distinct metadata dates to check for any anomalies:**
    ```sql
    SELECT DISTINCT "metadata_date" FROM THE_MET.THE_MET.OBJECTS LIMIT 1000;
    ```

14. **Check sample values of "cropHintsAnnotation" to understand its JSON structure:**
    ```sql
    SELECT
      t."object_id",
      f.value::STRING AS "cropHintsValue"
    FROM
      THE_MET.THE_MET.VISION_API_DATA t,
      LATERAL FLATTEN(input => t."cropHintsAnnotation") f
    LIMIT 1000;
    ```

15. **List object IDs from OBJECTS that are also present in VISION_API_DATA:**
    ```sql
    SELECT DISTINCT o."object_id"
    FROM THE_MET.THE_MET.OBJECTS o
    INNER JOIN THE_MET.THE_MET.VISION_API_DATA v ON o."object_id" = v."object_id"
    LIMIT 1000;
    ```

16. **Retrieve titles from OBJECTS where department is "The Libraries" and title contains "book":**
    ```sql
    SELECT "title" FROM THE_MET.THE_MET.OBJECTS WHERE "department" = 'The Libraries' AND "title" ILIKE '%book%' LIMIT 1000;
    ```

17. **Get object IDs and formatted metadata dates from OBJECTS:**
    ```sql
    SELECT "object_id", TO_CHAR(TO_TIMESTAMP("metadata_date"), 'YYYY-MM-DD') AS "formatted_metadata_date" FROM THE_MET.THE_MET.OBJECTS LIMIT 1000;
    ```

18. **Extract all "confidence" values from "cropHintsAnnotation" for analysis:**
    ```sql
    SELECT
      t."object_id",
      f.value:"confidence"::FLOAT AS "cropConfidence"
    FROM
      THE_MET.THE_MET.VISION_API_DATA t,
      LATERAL FLATTEN(input => t."cropHintsAnnotation":'cropHints') f
    LIMIT 1000;
    ```

19. **Identify all unique titles in OBJECTS containing "book":**
    ```sql
    SELECT DISTINCT "title" FROM THE_MET.THE_MET.OBJECTS WHERE "title" ILIKE '%book%' LIMIT 1000;
    ```

20. **Check for object IDs with high "cropConfidence" in VISION_API_DATA:**
    ```sql
    SELECT "object_id" FROM THE_MET.THE_MET.VISION_API_DATA WHERE "cropHintsAnnotation"::VARIANT CONTAINS '"confidence": 0.6' LIMIT 1000;
    ```

These queries help in understanding the structure and content of the relevant tables and columns, which is essential for formulating the final query to retrieve the required data.Query:
SELECT DISTINCT "department" FROM THE_MET.THE_MET.OBJECTS LIMIT 1000;
Answer:
department
Asian Art
Islamic Art
Photographs
Medieval Art
The Cloisters
The Libraries
Arms and Armor
Costume Institute
European Paintings
Drawings and Prints
Greek and Roman Art
Musical Instruments
Ancient Near Eastern Art
Robert Lehman Collection
Modern and Contemporary Art
American Paintings and Sculpture
"Arts of Africa, Oceania, and the Americas"
American Decorative Arts
European Sculpture and Decorative Arts
Egyptian Art
Query:
SELECT "object_id", "title" FROM THE_MET.THE_MET.OBJECTS WHERE "department" = 'The Libraries' LIMIT 1000;
Answer:
Too long, hard cut:
object_id,title
682011,Dialogo sobre hua nova obra no Rio Tejo ...
681546,De' ragguagli di Parnaso: Centuria prima-seconda
681534,"Contes et nouvelles de Bocace florentin : traduction libre, accommodée au gout de ce temps, & enrichie de figures en taille-douce gravées par Mr. Romain de Hooge"
681389,"Uffizio della Settimana Santa : colle rubriche volgari, argomenti de' Salmi, spiegazione delle cerimonie e misterj, con osservazioni, e riflessioni divote dell'abate Alessandro Mazzinelli"
591832,"Academie de l'espee; ou se domonstrent par reigles mathématiques sur le fondement d'un cercle mystérieux, la théorie et pratique des vrais . . ."
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans
591831,"Descriptio pbvlicae gratvlationis, spectacvlorvm et lvdorvm, in aventv sereniss: Principis Ernesti Archidvcis Avstriae Dvcis Vrgvndiae"
591865,Morte d'Arthur
591848,"The Holy Land, Syria, Idumea, Arabia, Egypt & Nubia"
591863,"Catalogue of the Collection of Jewels and Precious Works of Art, the Property of  J. Pierpont Morgan"
681573,"Les oeuvres morales de Mr. Diderot : contenant son traité De l'amitié, et celui Des passions"
682013,L'eschole de Salerne en vers burlesques & duo poemata macaronica: de bello huguenotico: et De gestis magnanimi & prudentissimi Baldi
681149,Bibliorum Sacrorum Vulgatae versionis
681556,Mémoires du Comte de Grammont : histoire amoureuse de la cour d'Angleterre sous Charles II / par Antoine Hamilton ; préface et notes par Benjamin Pifteau
681388,"Traité de Plutarque, sur la manière de discerner un flatteur d'avec un ami et Le banquet des sept sages: dialogue du même auteur revu & corrigé sur des manuscrits de la Bibliothèque du roi; avec une version françoise & des notes"
680835,"L'art de former les jardins modernes, ou, L'art des jardins anglois : traduit de l'anglois : à quoi le traducteur a ajouté un discours préliminaire sur l'origine de l'art, des notes sur le texte, & une description détaillée des jardins de Stowe, accompagnée du plan"
681547,"De l'imitation de Jesus-Christ, traduction nouvelle ; ornée de figures en taille-douce"
681545,Contes et nouvelles en vers par Jean de la Fontaine
682014,Figures françoises et comiques nouvellement inventées par M. Watteau; Figures de modes dessinées et gravées à l'eau forte par Watteau; a terminées au buin par Thomassin le fils
681128,"Les aventures de Télémaque, fils d'Ulysse par M. de Fénélon ; avec figures en taille-douce, dessinées par MM. Cochin et Moreau le jeune"
682012,Epistole eroiche di P. Ovidio Nasone
681563,"Oeuvres de Moliere : avec des remarques grammaticales, des avertissemens et des observations sur chaque piéce, par M. Bret"
716648,"Planches pour l'Encyclopédie, ou pour le Dictionaire raisonné des sciences, des arts libéraux, et des arts méchaniques, avec leur explication"
705290,博古圖錄
715005,三禮圖
739504,Examples of Chinese ornament selected from objects in the South Kensington Museum and other collections
726677,"The sunshade, the glove, the muff"
716639,"Encyclopédie, ou Dictionnaire raisonné des sciences, des arts et des métiers, par une société de gens de lettres"
699505,"Dialogos de la pintvra : sv defensa, origen, essecia, definicion, modos y diferencias"
697348,Der aller durchleuchtigisten und grosmächtigen Kayser ... Königen ... Herren vom Adel ... Bildtnussen und kurtz Beschreibungen ihrer so wol in Fridts- als Kriegszzeiten verrichten fürnembsten Thaten und Handlungen : deren Waffen und Rüstungen ... auss allen Landen der Welt ... in dem Schloss Ombrass ... zu ewiger Gedächtnuss auffbehalten werden ...
681349,"Calendrier belgique, curieux et utile, contenant les evenemens historiques sur les jours de l'an, et les travaux à faire dans les jardins en chaque mois de l'année, la description des tableaux remarquables, que l'on trouve dans la ville de Gand, avec les noms des peintres pour l'annėe MDCCLXXII"
591837,Le pitture e sculture di Brescia che sono esposte al pubblico con un' appendice di alcune private gallerie
591862,"Edwin Davis French, A Memorial: His Life, His Art"
591836,Il Ritratto di Venezia
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found"
738466,Modern chromatics : with applications to art and industry
700032,Petri Gyllii De Bosporo thracio libri III ; Petri Gyllii De topographia Constantinopoleos
700050,"Traité de l'horlogerie, méchanique et pratique, approuvé par l'Academie royale des sciences"
738463,"The principles of harmony and contrast of colours, and their applications to the arts"
704714,Mr. Vanderbilt's house and collection
700240,"The cabinet-maker and upholsterer's guide, or, Repository of designs for every article of household furniture, in the newest and most approved taste : displaying a great variety of patterns for chairs, stools ... in the plainest and most enriched styles : with a scale to each, and an e
Query:
SELECT "title" FROM THE_MET.THE_MET.OBJECTS WHERE "title" ILIKE '%book%' LIMIT 1000;
Answer:
Too long, hard cut:
title
明     郭詡     稱書圖     軸|Weighing Books
明     杜堇     伏生授經圖   軸|The Scholar Fu Sheng Transmitting the Book of Documents
画本宝能縷|Picture Book of Brocades with Precious Threads (Ehon takara no itosuji)
絵本松のしらべ|Picture Book on the Music of the Pine Trees (Ehon matsu no shirabe)
『和国諸職絵尽　諸織 絵本鏡』|A Picture Book Mirror of Various Occupations (Wakoku shoshoku ezukushi)
Ehon Asakayama|絵本浅香山|Picture Book: Mount Asaka (Ehon Asakayama)
"絵本末摘花|Picture Book: Flowers Yet to be Picked, Vol. 1"
Ehon Ogurayama|絵本小倉山|Picture Book: Ogura Hill (Ehon Ogurayama)
Ehon Himetsubaki|繪本女貞木|Picture Book: Camellia (Ehon Himetsubaki)
『繪本常盤草』|Picture Book of the Evergreens (Ehon tokiwagusa)
『繪本小倉山』|Picture Book of Ogura Hill (Ehon ogurayama)
『繪本小松原』|Picture Book of Komatsubara (Ehon komatsubara)
絵本常盤草　上・中・下|Picture Book of the Evergreens (Ehon tokiwagusa)
『寫山樓畫本』|Shazanrō (Bunchō) Picture Book (Shazanrō ehon)
『絵本時世粧』|Picture Book of Modern Figures of Fashion (Ehon imayō sugata)
艶本 婦慈のゆき|An Erotic Picture Book of Snow on Fuji (Enpon fuji no yuki)
絵本吾妻遊|Ehon Azuma asobi|Picture Book of Amusements of the Eastern Capital (Ehon Azuma asobi)
Ehon Momochidori Kyōka-awase|百千鳥狂歌合|Myriad Birds: Picture Book of Playful Verse (Momo chidori kyōka-awase)
絵本和歌夷 「龢謌夷」|Picture Book with Playful Poems for the Young God Ebisu
潮干のつと|Gifts from the Ebb Tide (The Shell Book) (Shiohi no tsuto)
画本虫撰|Picture Book of Crawling Creatures (The Insect Book) (Ehon mushi erami)
画本虫撰|Picture Book of Crawling Creatures (The Insect Book) (Ehon mushi erami)
繪本四季花|Picture Book of Flowers of the Four Seasons (Ehon shiki no hana)
『青楼繪本年中行事』|Yoshiwara Picture Book of New Year’s Festivities (Seirō ehon nenjū gyōji)
（榎木新右衛門）画 『雛形伊勢乃海』|Book of Kosode Patterns (Hiinagata Ise no umi)
Ehon Musashi no Abumi|A Picture Book of Japanese Warriors
『画本狂歌山満多山』|Picture Book of Kyōka Poems: Mountains upon Mountains (Ehon kyōka yama mata yama)
"繪本彩色通　初編|Picture Book on the Use of Coloring, first volume (Ehon saishikitsū shohen)"
『絵本和漢誉』|Picture Book on Heroes of China and Japan (Ehon wakan no homare)
『暁斎漫画』|Kyōsai Sketchbook (Kyōsai manga)
"『閨の雛形』　正月|Plate from the Erotic Book Mounds of Dyed Colors: A Pattern Book for the Boudoir (Someiro no yama neya no hinagata), First Month"
"『画本虫撰』  「蜂」「毛虫」|Paper Wasp (Hachi); Hairy Caterpillar (Kemushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』   「馬追虫」「むかて」|Katydid (Umaoi-mushi); Centipede, (Mukade), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』   「けら」「はさみむし」|Mole Cricket (Kera); Earwig, (Hasami-mushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』   「蝶」「蜻蛉」|Butterfly (Chō); Dragonfly (Kagerō or Tonbo), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』  「虻」「芋虫」|Horsefly (abu); Green Caterpillar, imomushi, from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』   「松虫」「虫蛍」|Tree cricket (Matsumushi); Firefly (Hotaru), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"画本虫撰　バッタと蟷螂|Cone-headed Grasshopper or Locust, (batta); Praying Mantis (Tōrō or Kamakiri), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』 「ひくらし」「くも」|Evening Cicada, Higurashi; Spider, Kumo, from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』「赤蜻蛉」「いなこ」|Red Dragonfly (Akatonbo); Locust (Inago), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』「虵」「とかけ」|Rat Snake (Hebi); Lizard or Skink (Tokage), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』「蓑虫」「兜虫」|Bagworm (Minomushi); Horned Scarab Beetle (Kabutomushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』「蝸牛」「轡虫」|Land Snail (Katatsumuri); Giant Katydid (Kutsuwamushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』「きりきりす」「蝉」|Grasshopper (Kirigirisu); Cicada (Semi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』「蚓」「こうろき」|Earthworm (Mimizu); Cricket (Kōrogi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"四季の花|The Coming Thunderstorm, from the illustrated book Flowers of the Four Seasons"
"四季の花|Women on a Bridge, from the illustrated book Flowers of the Four Seasons"
"四季の花|A Child Lighting Fireworks, from the illustrated book Flowers of the Four Seasons"
"四季の花|Girls Getting on Board a Boat, from the illustrated book Flowers of the Four Seasons"
"四季の花|Girls Picking Green Leaves, from the illustrated book Flowers of the Four Seasons"
"四季の花|New Year's Games, from the printed book Flowers of the Four Seasons (Shiki no hana)"
"四季の花|Girls Entertained by Performers, from the illustrated book Flowers of the Four Seasons"
"四季の花|Poetry, from the illustrated book Flowers of the Four Seasons"
"『画本虫撰』「蛙」「こかねむし」|Frog (Kaeru); Gold Beetle (Kogane mushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"Kamakura no Koshi|The Filial Son at Kamakura, From the Book: Sasekishu"
"『雛形若菜の初模様　つるや内　すがたみ』|The Courtesan Sugatami of the Tsuruya Brothel
Query:
SELECT "object_id" FROM THE_MET.THE_MET.OBJECTS WHERE "department" = 'The Libraries' AND "title" ILIKE '%book%' LIMIT 1000;
Answer:
object_id
591860
700238
700232
591861
591856
Query:
SELECT "metadata_date" FROM THE_MET.THE_MET.OBJECTS LIMIT 1000;
Answer:
Too long, hard cut:
metadata_date
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
1486368016000000
14863
Query:
SELECT "object_id", TO_CHAR(TO_TIMESTAMP("metadata_date"), 'YYYY-MM-DD') AS "formatted_metadata_date" FROM THE_MET.THE_MET.OBJECTS LIMIT 1000;
Answer:
Too long, hard cut:
object_id,formatted_metadata_date
646996,47103097-05-20
77916,47103097-05-20
38009,47103097-05-20
37988,47103097-05-20
74660,47103097-05-20
74674,47103097-05-20
74675,47103097-05-20
74677,47103097-05-20
74685,47103097-05-20
65595,47103097-05-20
73261,47103097-05-20
38042,47103097-05-20
39894,47103097-05-20
64891,47103097-05-20
65590,47103097-05-20
65594,47103097-05-20
40445,47103097-05-20
45063,47103097-05-20
40069,47103097-05-20
40070,47103097-05-20
37964,47103097-05-20
75084,47103097-05-20
75085,47103097-05-20
75086,47103097-05-20
75087,47103097-05-20
75088,47103097-05-20
75089,47103097-05-20
75090,47103097-05-20
75091,47103097-05-20
75092,47103097-05-20
75093,47103097-05-20
75094,47103097-05-20
75095,47103097-05-20
75096,47103097-05-20
75097,47103097-05-20
75098,47103097-05-20
75099,47103097-05-20
75100,47103097-05-20
75101,47103097-05-20
75102,47103097-05-20
75103,47103097-05-20
75104,47103097-05-20
75105,47103097-05-20
75106,47103097-05-20
75107,47103097-05-20
75108,47103097-05-20
75109,47103097-05-20
75110,47103097-05-20
75111,47103097-05-20
75112,47103097-05-20
75113,47103097-05-20
75114,47103097-05-20
75115,47103097-05-20
75116,47103097-05-20
75117,47103097-05-20
75118,47103097-05-20
75119,47103097-05-20
75120,47103097-05-20
75121,47103097-05-20
75122,47103097-05-20
75123,47103097-05-20
75124,47103097-05-20
75125,47103097-05-20
75126,47103097-05-20
75127,47103097-05-20
75128,47103097-05-20
75129,47103097-05-20
75130,47103097-05-20
75131,47103097-05-20
75132,47103097-05-20
75133,47103097-05-20
75134,47103097-05-20
75135,47103097-05-20
75136,47103097-05-20
75137,47103097-05-20
75138,47103097-05-20
75139,47103097-05-20
75140,47103097-05-20
75141,47103097-05-20
75142,47103097-05-20
75143,47103097-05-20
75145,47103097-05-20
75146,47103097-05-20
75147,47103097-05-20
75148,47103097-05-20
75149,47103097-05-20
75150,47103097-05-20
75151,47103097-05-20
75152,47103097-05-20
75153,47103097-05-20
54912,47103097-05-20
38448,47103097-05-20
40429,47103097-05-20
40432,47103097-05-20
73188,47103097-05-20
74683,47103097-05-20
72589,47103097-05-20
74656,47103097-05-20
64046,47103097-05-20
39899,47103097-05-20
36145,47103097-05-20
49665,47103097-05-20
36130,47103097-05-20
36435,47103097-05-20
36036,47103097-05-20
36072,47103097-05-20
49133,47103097-05-20
65620,47103097-05-20
40021,47103097-05-20
49453,47103097-05-20
49134,47103097-05-20
65075,47103097-05-20
41468,47103097-05-20
40507,47103097-05-20
40052,47103097-05-20
35995,47103097-05-20
35999,47103097-05-20
36003,47103097-05-20
45786,47103097-05-20
73669,47103097-05-20
49179,47103097-05-20
49226,47103097-05-20
51727,47103097-05-20
51705,47103097-05-20
51528,47103097-05-20
51656,47103097-05-20
51644,47103097-05-20
36129,47103097-05-20
51770,47103097-05-20
64029,47103097-05-20
60764,47103097-05-20
51902,47103097-05-20
64045,47103097-05-20
36439,47103097-05-20
40285,47103097-05-20
40107,47103097-05-20
40180,47103097-05-20
40194,47103097-05-20
40060,47103097-05-20
40058,47103097-05-20
45684,47103097-05-20
45746,47103097-05-20
39766,47103097-05-20
45749,47103097-05-20
44574,47103097-05-20
45775,47103097-05-20
45780,47103097-05-20
51865,47103097-05-20
77914,47103097-05-20
48875,47103097-05-20
48955,47103097-05-20
48954,47103097-05-20
49025,47103097-05-20
49029,47103097-05-20
56553,47103097-05-20
41780,47103097-05-20
39625,47103097-05-20
48931,47103097-05-20
48928,47103097-05-20
48959,47103097-05-20
49129,47103097-05-20
49146,47103097-05-20
49147,47103097-05-20
49163,47103097-05-20
51894,47103097-05-20
36132,47103097-05-20
51900,47103097-05-20
75814,47103097-05-20
54308,47103097-05-20
55495,47103097-05-20
49473,47103097-05-20
35987,47103097-05-20
44570,47103097-05-20
40105,47103097-05-20
40509,47103097-05-20
42329,47103097-05-20
39918,47103097-05-20
39919,47103097-05-20
40103,47103097-05-20
40104,47103097-05-20
41777,47103097-05-20
41860,47103097-05-20
40018,47103097-05-20
41778,47103097-05-20
41782,47103097-05-20
63196,47103097-05-20
63185,47103097-05-20
49047,47103097-05-20
50549,47103097-05-20
53924,47103097-05-20
53925,47103097-05-20
53926,47103097-05-20
53927,47103097-05-20
53928,47103097-05-20
53929,47103097-05-20
42323,47103097-05-20
36236,47103097-05-20
36098,47103097-05-20
72711,47103097-05-20
72712,47103097-05-20
36201,47103097-05-20
44567,47103097-05-20
49617,47103097-05-20
36208,47103097-05-20
36205,47103097-05-20
36206,47103097-05-20
36211,47103097-05-20
36210,47103097-05-20
36216,47103097-05-20
49629,47103097-05-20
49630,47103097-05-20
41504,47103097-05-20
49603,47103097-05-20
49604,47103097-05-20
49605,47103097-05-20
49607,47103097-05-20
36202,47103097-05-20
49608,47103097-05-20
49606,47103097-05-20
49614,47103097-05-20
49615,47103097-05-20
49663,47103097-05-20
49664,47103097-05-20
49626,47103097-05-20
49627,47103097-05-20
36222,47103097-05-20
36224,47103097-05-20
49623,47103097-05-20
40311,47103097-05-20
45652,47103097-05-20
39901,47103097-05-20
39959,47103097-05-20
51762,47103097-05-20
40062,47103097-05-20
40057,47103097-05-20
40094,47103097-05-20
36052,471
Query:
SELECT "object_id" FROM THE_MET.THE_MET.VISION_API_DATA LIMIT 1000;
Answer:
Too long, hard cut:
object_id
463536
286038
467486
386444
343968
288535
17449
343402
261387
342591
263135
361703
729624
385957
659124
345721
196356
339707
367415
398595
55574
197750
229095
471848
436731
198587
340058
349162
452670
342501
37895
399212
54652
11777
459002
11372
397694
206589
338515
364382
436770
10401
64534
471995
385089
342748
436911
102243
11798
11707
437490
438820
437703
475487
459040
291887
436664
463545
191777
349309
467808
205239
58026
269254
428639
260058
237070
260182
237754
45445
60060
403086
700206
371456
464151
187761
188903
398499
204625
206168
434111
393331
362267
16665
288561
250549
343201
1683
387537
391793
399237
14942
55423
195760
260113
37125
364839
366887
463765
451972
189163
56753
203111
190623
360642
202343
36707
189644
382454
56027
390689
59185
189700
194324
386145
642888
431358
302131
46445
268128
51416
286615
387541
367468
392932
434603
260140
269271
437069
460208
473465
156808
464299
204722
454344
36654
41933
438026
11274
189712
383935
63832
399691
442749
625354
38582
339119
55199
342463
227026
407167
704827
435691
436738
337665
377467
459019
271746
631422
436759
365816
12731
451283
208809
399545
249164
435766
73439
339543
10337
459015
437422
667926
459023
249232
435702
467508
435754
391053
350970
369533
453683
356476
436103
488733
10389
58263
13050
37993
436892
656826
392687
359151
337761
361613
730790
286173
269253
344140
260348
388833
712946
260126
436900
339559
342502
54660
437004
194541
260175
363737
2783
452125
199486
716639
54849
310365
37807
436802
389888
551108
435653
471218
435763
436835
266256
437268
436850
12552
200564
260352
198903
190119
335497
294508
461549
206726
386450
464286
471559
679466
189944
471122
193428
203376
187556
5207
446583
11471
44377
44384
682991
396179
55419
44365
56024
900
460148
364208
44373
198315
396434
38345
467475
271844
63835
656030
56534
58205
447804
400533
58256
11592
55268
288214
408994
428411
403228
286502
633712
15917
260119
437925
435716
13763
436793
186800
186826
57074
259609
386355
726237
285708
55887
368544
623329
471560
398521
221533
392427
10241
55183
464306
436118
55182
463649
436840
437593
436048
438821
284452
436502
437819
291872
285881
436230
73414
17652
459197
438025
437755
435714
44367
44366
44378
337450
209424
467378
386090
369331
203238
428608
469932
236779
193700
193450
392668
197483
44380
463697
471233
219919
396429
359431
367700
366523
386457
461128
475490
53924
390373
414259
286442
56070
467722
359618
209042
464450
446265
19732
10184
436097
186816
186825
403245
435607
446566
388654
339882
187154
670103
438466
458984
12749
436797
338711
543901
55237
437038
186815
186803
342849
682101
661968
156804
384486
339941
471112
437775
232212
288533
437674
436603
436838
435739
458982
464048
438617
194211
460602
367745
684712
206568
246809
191947
246813
464263
191612
60213
226955
291838
195319
13025
264576
294512
387951
463825
383998
470900
288164
392523
645760
287799
349133
383358
365615
455024
436989
651672
677492
707925
439553
341760
448555
45260
36662
460189
202330
435755
437342
435832
459043
363309
452017
55746
383926
367699
396359
227931
367702
195300
438605
437261
13198
386456
435602
198917
437855
463810
438427
426334
464290
44353
470306
453359
437606
435901
459075
343475
438724
231174
306160
452016
337948
339836
200591
189832
452019
704977
336882
189999
452015
291921
468949
421489
287964
199892
306161
236111
337963
467521
269236
435590
463974
53549
55261
73521
73582
343789
417495
338973
230011
56670
467641
212620
299315
45249
470618
358113
337058
248205
467650
436410
229568
467783
647634
54880
55561
201886
380487
232207
254819
264573
339890
471455
229601
55269
470874
288536
460192
202331
467787
461298
470921
437202
199070
436201
437298
459131
435578
198564
73510
368594
437604
55211
471981
55864
306156
437256
11627
436803
437897
267233
435824
442183
464275
286046
294514
452021
264579
467694
364823
641282
470873
392811
365971
193427
652670
306153
363260
631544
10353
468255
393293
55886
466330
345269
55894
306154
437019
454054
461628
305832
61532
294727
437602
447743
436076
286895
466201
436781
469871
467643
436487
446577
436098
10554
464272
156426
700867
54839
459005
192770
392464
343568
437018
436889
268085
73445
37956
384989
263070
437788
463580
428487
436518
471924
437466
435848
454049
437240
436656
436561
458961
55338
73461
437100
445280
437024
668004
37801
269260
342753
271712
437290
437329
470600
436801
37185
437222
436799
10534
556940
569681
58733
565031
504243
252416
309142
317631
448765
567611
326393
251899
189521
308879
58534
463673
225027
309141
229714
326580
2283
58596
545272
61135
323290
324546
717482
557255
251908
326827
422188
229722
322446
309139
244386
244370
549434
464615
545275
309144
324787
62550
250617
554932
549667
3994
473937
61146
315311
251124
3017
577195
325295
317408
700974
422111
323990
557135
1020
549870
457485
24624
26340
34943
450007
462906
681386
243818
243015
244178
324910
408572
323359
326233
561456
561453
559499
327720
738364
726160
558365
313448
37997
567637
447345
715022
24936
37996
738070
328788
2
Query:
SELECT "cropHintsAnnotation" FROM THE_MET.THE_MET.VISION_API_DATA LIMIT 1000;
Answer:
Too long, hard cut:
cropHintsAnnotation
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2158,
            ""y"": 0
          },
          {
            ""x"": 2158,
            ""y"": 2871
          },
          {
            ""x"": 0,
            ""y"": 2871
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.700000047683716e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2490,
            ""y"": 0
          },
          {
            ""x"": 2490,
            ""y"": 3340
          },
          {
            ""x"": 0,
            ""y"": 3340
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 1.100000023841858e+00
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 1455,
            ""y"": 0
          },
          {
            ""x"": 1455,
            ""y"": 1899
          },
          {
            ""x"": 0,
            ""y"": 1899
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.700000047683716e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2843,
            ""y"": 0
          },
          {
            ""x"": 2843,
            ""y"": 3734
          },
          {
            ""x"": 0,
            ""y"": 3734
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.799999952316284e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2873,
            ""y"": 0
          },
          {
            ""x"": 2873,
            ""y"": 3982
          },
          {
            ""x"": 0,
            ""y"": 3982
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.599999845027924e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2026,
            ""y"": 0
          },
          {
            ""x"": 2026,
            ""y"": 2555
          },
          {
            ""x"": 0,
            ""y"": 2555
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 5.000000000000000e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2634,
            ""y"": 0
          },
          {
            ""x"": 2634,
            ""y"": 3999
          },
          {
            ""x"": 0,
            ""y"": 3999
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.700000047683716e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2821,
            ""y"": 0
          },
          {
            ""x"": 2821,
            ""y"": 3718
          },
          {
            ""x"": 0,
            ""y"": 3718
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.700000047683716e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2484,
            ""y"": 0
          },
          {
            ""x"": 2484,
            ""y"": 2943
          },
          {
            ""x"": 0,
            ""y"": 2943
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.499999940395355e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
          {
            ""x"": 0,
            ""y"": 0
          },
          {
            ""x"": 2614,
            ""y"": 0
          },
          {
            ""x"": 2614,
            ""y"": 3530
          },
          {
            ""x"": 0,
            ""y"": 3530
          }
        ]
      },
      ""confidence"": 1.000000000000000e+00,
      ""importanceFraction"": 3.899999856948853e-01
    }
  ]
}"
"{
  ""cropHints"": [
    {
      ""boundingPoly"": {
        ""vertices"": [
  
Query:
SELECT
     t."object_id",
     f.value:"cropHints"[0]:"confidence"::FLOAT AS "cropConfidence"
   FROM
     THE_MET.THE_MET.VISION_API_DATA t,
     LATERAL FLATTEN(input => t."cropHintsAnnotation") f
   LIMIT 1000;
Answer:
Too long, hard cut:
object_id,cropConfidence
437177,
437564,
201929,
397271,
355599,
412502,
337337,
209969,
6039,
53710,
377454,
196587,
336772,
558364,
399542,
390002,
693798,
367538,
369073,
37169,
339833,
201428,
209272,
416888,
347688,
397692,
335839,
471067,
435595,
204626,
56835,
209244,
282028,
398504,
446546,
194520,
436509,
464160,
266259,
438385,
435852,
459093,
11712,
467724,
458979,
436015,
435768,
338317,
739395,
679157,
191783,
202700,
13661,
370485,
188969,
291800,
645771,
193972,
198996,
64872,
739029,
464254,
464124,
463826,
437928,
36612,
471117,
199973,
382755,
288184,
286009,
645766,
464293,
463742,
505616,
386449,
369562,
646460,
228882,
207530,
387497,
44369,
44381,
198770,
367300,
437008,
436760,
198906,
44375,
354035,
463551,
56038,
44363,
736066,
56840,
437632,
56515,
37943,
55361,
286647,
386928,
436200,
361830,
392927,
55273,
199485,
156575,
200656,
466107,
437895,
448461,
436346,
436692,
186822,
186821,
63874,
707799,
383944,
396189,
668089,
58031,
468318,
470919,
191180,
463602,
467471,
463536,
286038,
467486,
386444,
343968,
288535,
17449,
343402,
261387,
342591,
263135,
361703,
729624,
385957,
659124,
345721,
196356,
339707,
367415,
398595,
55574,
197750,
229095,
471848,
436731,
198587,
340058,
349162,
452670,
342501,
37895,
399212,
54652,
11777,
459002,
11372,
397694,
206589,
338515,
364382,
436770,
10401,
64534,
471995,
385089,
342748,
436911,
102243,
11798,
11707,
437490,
438820,
437703,
475487,
459040,
291887,
436664,
463545,
191777,
349309,
467808,
205239,
58026,
269254,
428639,
260058,
237070,
260182,
237754,
45445,
60060,
403086,
700206,
371456,
464151,
187761,
188903,
398499,
204625,
206168,
434111,
393331,
362267,
16665,
288561,
250549,
343201,
1683,
387537,
391793,
399237,
14942,
55423,
195760,
260113,
37125,
364839,
366887,
463765,
451972,
189163,
56753,
203111,
190623,
360642,
202343,
36707,
189644,
382454,
56027,
390689,
59185,
189700,
194324,
386145,
642888,
431358,
302131,
46445,
268128,
51416,
286615,
387541,
367468,
392932,
434603,
260140,
269271,
437069,
460208,
473465,
156808,
464299,
204722,
454344,
36654,
41933,
438026,
11274,
189712,
383935,
63832,
399691,
442749,
625354,
38582,
339119,
55199,
342463,
227026,
407167,
704827,
435691,
436738,
337665,
377467,
459019,
271746,
631422,
436759,
365816,
12731,
451283,
208809,
399545,
249164,
435766,
73439,
339543,
10337,
459015,
437422,
667926,
459023,
249232,
435702,
467508,
435754,
391053,
350970,
369533,
453683,
356476,
436103,
488733,
10389,
58263,
13050,
37993,
436892,
656826,
392687,
359151,
337761,
361613,
730790,
286173,
269253,
344140,
260348,
388833,
712946,
260126,
436900,
339559,
342502,
54660,
437004,
194541,
260175,
363737,
2783,
452125,
199486,
716639,
54849,
310365,
37807,
436802,
389888,
551108,
435653,
471218,
435763,
436835,
266256,
437268,
436850,
12552,
200564,
260352,
198903,
190119,
335497,
294508,
461549,
206726,
386450,
464286,
471559,
679466,
189944,
471122,
193428,
203376,
187556,
5207,
446583,
11471,
44377,
44384,
682991,
205225,
357059,
333993,
38169,
44833,
548510,
391673,
387059,
74832,
17571,
437454,
467679,
42727,
436233,
623621,
467630,
335297,
10465,
335539,
435804,
263862,
437535,
246654,
288012,
436289,
437396,
547768,
13091,
11191,
10795,
503448,
369298,
288496,
436955,
384064,
437421,
192728,
405228,
339264,
10531,
10085,
488853,
12601,
436542,
386009,
436253,
254646,
369230,
435869,
268371,
193614,
12696,
10836,
10745,
337340,
489546,
437903,
10067,
435664,
436019,
460214,
326695,
435623,
436239,
437679,
39894,
436259,
197032,
10218,
437836,
45100,
206291,
97353,
548638,
435776,
437438,
730794,
288112,
11243,
334772,
415999,
399175,
366477,
306667,
394309,
422255,
15149,
458996,
417300,
268569,
36670,
402847,
196931,
289367,
625649,
415967,
419977,
261326,
339012,
113215,
189310,
369542,
59249,
342778,
406437,
192859,
392327,
460207,
10593,
386196,
392937,
390724,
205131,
339348,
641804,
268460,
659972,
417863,
728076,
350806,
193106,
708720,
45322,
37385,
739498,
643747,
396179,
55419,
44365,
56024,
398241,
471068,
420015,
336824,
396226,
291654,
394744,
698490,
268233,
396165,
388760,
10905,
423183,
390845,
428819,
374032,
12562,
13385,
478972,
288126,
393950,
364813,
414387,
633820,
390811,
699923,
268532,
339551,
10596,
268452,
369152,
372245,
55078,
11674,
264364,
369158,
290476,
371226,
392482,
367028,
424157,
348888,
394433,
686030,
11021,
372938,
428461,
557210,
306767,
306762,
38387,
417607,
4171,
4208,
4205,
4203,
4229,
4212,
4200,
4207,
4238,
4210,
467396,
4250,
343737,
189227,
12977,
14312,
326223,
200562,
408603,
76575,
411232,
675516,
399271,
371590,
11276,
336419,
10848,
285456,
268343,
391776,
45261,
348391,
246742,
339272,
10167,
424137,
408902,
645237,
207217,
676536,
436496,
208176,
13245,
37377,
361575,
193612,
410390,
73476,
288125,
15588,
268700,
416901,
410372,
339074,
291892,
351416,
435955,
37343,
405514,
437413,
242423,
337758,
547690,
16022,
207160,
644184,
465983,
358160,
388672,
335408,
213249,
12002,
53927,
361934,
342743,
402842,
387979,
239425,
395469,
342852,

Query:
SELECT
  o."object_id",
  o."title",
  TO_CHAR(TO_TIMESTAMP(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "formatted_metadata_date"
FROM
  THE_MET.THE_MET.OBJECTS o
  JOIN THE_MET.THE_MET.VISION_API_DATA v ON o."object_id" = v."object_id"
WHERE
  o."department" = 'The Libraries'
  AND o."title" ILIKE '%book%'
  AND v."cropHintsAnnotation":cropHints[0]:confidence::FLOAT > 0.5;
Answer:
object_id,title,formatted_metadata_date
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc.",2017-02-06
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06
Query:
SELECT
  o."object_id",
  o."title",
  TO_CHAR(TO_TIMESTAMP(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "formatted_metadata_date"
FROM
  THE_MET.THE_MET.OBJECTS o
  JOIN THE_MET.THE_MET.VISION_API_DATA v ON o."object_id" = v."object_id"
WHERE
  o."department" = 'The Libraries'
  AND o."title" ILIKE '%book%';
Answer:
object_id,title,formatted_metadata_date
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc.",2017-02-06
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06
Query:
SELECT "object_id", "title" FROM THE_MET.THE_MET.OBJECTS WHERE "title" ILIKE '%book%' LIMIT 1000;
Answer:
Too long, hard cut:
object_id,title
39483,明     郭詡     稱書圖     軸|Weighing Books
39667,明     杜堇     伏生授經圖   軸|The Scholar Fu Sheng Transmitting the Book of Documents
57754,画本宝能縷|Picture Book of Brocades with Precious Threads (Ehon takara no itosuji)
78593,絵本松のしらべ|Picture Book on the Music of the Pine Trees (Ehon matsu no shirabe)
78688,『和国諸職絵尽　諸織 絵本鏡』|A Picture Book Mirror of Various Occupations (Wakoku shoshoku ezukushi)
53815,Ehon Asakayama|絵本浅香山|Picture Book: Mount Asaka (Ehon Asakayama)
45062,"絵本末摘花|Picture Book: Flowers Yet to be Picked, Vol. 1"
57842,Ehon Ogurayama|絵本小倉山|Picture Book: Ogura Hill (Ehon Ogurayama)
57858,Ehon Himetsubaki|繪本女貞木|Picture Book: Camellia (Ehon Himetsubaki)
78723,『繪本常盤草』|Picture Book of the Evergreens (Ehon tokiwagusa)
78728,『繪本小倉山』|Picture Book of Ogura Hill (Ehon ogurayama)
78729,『繪本小松原』|Picture Book of Komatsubara (Ehon komatsubara)
78722,絵本常盤草　上・中・下|Picture Book of the Evergreens (Ehon tokiwagusa)
78585,『寫山樓畫本』|Shazanrō (Bunchō) Picture Book (Shazanrō ehon)
78739,『絵本時世粧』|Picture Book of Modern Figures of Fashion (Ehon imayō sugata)
78597,艶本 婦慈のゆき|An Erotic Picture Book of Snow on Fuji (Enpon fuji no yuki)
45273,絵本吾妻遊|Ehon Azuma asobi|Picture Book of Amusements of the Eastern Capital (Ehon Azuma asobi)
57568,Ehon Momochidori Kyōka-awase|百千鳥狂歌合|Myriad Birds: Picture Book of Playful Verse (Momo chidori kyōka-awase)
57605,絵本和歌夷 「龢謌夷」|Picture Book with Playful Poems for the Young God Ebisu
57648,潮干のつと|Gifts from the Ebb Tide (The Shell Book) (Shiohi no tsuto)
57569,画本虫撰|Picture Book of Crawling Creatures (The Insect Book) (Ehon mushi erami)
57570,画本虫撰|Picture Book of Crawling Creatures (The Insect Book) (Ehon mushi erami)
45322,繪本四季花|Picture Book of Flowers of the Four Seasons (Ehon shiki no hana)
78746,『青楼繪本年中行事』|Yoshiwara Picture Book of New Year’s Festivities (Seirō ehon nenjū gyōji)
78758,（榎木新右衛門）画 『雛形伊勢乃海』|Book of Kosode Patterns (Hiinagata Ise no umi)
45444,Ehon Musashi no Abumi|A Picture Book of Japanese Warriors
78635,『画本狂歌山満多山』|Picture Book of Kyōka Poems: Mountains upon Mountains (Ehon kyōka yama mata yama)
78771,"繪本彩色通　初編|Picture Book on the Use of Coloring, first volume (Ehon saishikitsū shohen)"
78772,『絵本和漢誉』|Picture Book on Heroes of China and Japan (Ehon wakan no homare)
78667,『暁斎漫画』|Kyōsai Sketchbook (Kyōsai manga)
55597,"『閨の雛形』　正月|Plate from the Erotic Book Mounds of Dyed Colors: A Pattern Book for the Boudoir (Someiro no yama neya no hinagata), First Month"
37283,"『画本虫撰』  「蜂」「毛虫」|Paper Wasp (Hachi); Hairy Caterpillar (Kemushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37284,"『画本虫撰』   「馬追虫」「むかて」|Katydid (Umaoi-mushi); Centipede, (Mukade), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37285,"『画本虫撰』   「けら」「はさみむし」|Mole Cricket (Kera); Earwig, (Hasami-mushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37286,"『画本虫撰』   「蝶」「蜻蛉」|Butterfly (Chō); Dragonfly (Kagerō or Tonbo), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37287,"『画本虫撰』  「虻」「芋虫」|Horsefly (abu); Green Caterpillar, imomushi, from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37288,"『画本虫撰』   「松虫」「虫蛍」|Tree cricket (Matsumushi); Firefly (Hotaru), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37289,"画本虫撰　バッタと蟷螂|Cone-headed Grasshopper or Locust, (batta); Praying Mantis (Tōrō or Kamakiri), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37290,"『画本虫撰』 「ひくらし」「くも」|Evening Cicada, Higurashi; Spider, Kumo, from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37291,"『画本虫撰』「赤蜻蛉」「いなこ」|Red Dragonfly (Akatonbo); Locust (Inago), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37292,"『画本虫撰』「虵」「とかけ」|Rat Snake (Hebi); Lizard or Skink (Tokage), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37293,"『画本虫撰』「蓑虫」「兜虫」|Bagworm (Minomushi); Horned Scarab Beetle (Kabutomushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37294,"『画本虫撰』「蝸牛」「轡虫」|Land Snail (Katatsumuri); Giant Katydid (Kutsuwamushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37295,"『画本虫撰』「きりきりす」「蝉」|Grasshopper (Kirigirisu); Cicada (Semi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37296,"『画本虫撰』「蚓」「こうろき」|Earthworm (Mimizu); Cricket (Kōrogi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
37306,"四季の花|The Coming Thunderstorm, from the illustrated book Flowers of the Four Seasons"
37307,"四季の花|Women on a Bridge, from the illustrated book Flowers of the Four Seasons"
37308,"四季の花|A Child Lighting Fireworks, from the illustrated book Flowers of the Four Seasons"
37309,"四季の花|Girls Getting on Board a Boat, from the illustrated book Flowers of the Four Seasons"
37310,"四季の花|Girls Picking Green Leaves, from the illustrated book Flowers of the Four Seasons"
37311,"四季の花|New Year's Games, from the printed book Flowers of the Four Seasons (Shiki no hana)"
37312,"四季の花|Girls Entertained by Performers, from the illustrated book Flowers of the Four Seasons"
37313,"四季の花
Query:
SELECT DISTINCT "metadata_date" FROM THE_MET.THE_MET.OBJECTS LIMIT 1000;
Answer:
metadata_date
1486368016000000
Query:
SELECT
      t."object_id",
      f.value::STRING AS "cropHintsValue"
    FROM
      THE_MET.THE_MET.VISION_API_DATA t,
      LATERAL FLATTEN(input => t."cropHintsAnnotation") f
    LIMIT 1000;
Answer:
Too long, hard cut:
object_id,cropHintsValue
437177,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":1586,""y"":0},{""x"":1586,""y"":1907},{""x"":0,""y"":1907}]},""confidence"":1.000000000000000e+00,""importanceFraction"":5.299999713897705e-01}]"
437564,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":2754,""y"":0},{""x"":2754,""y"":3418},{""x"":0,""y"":3418}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.499999940395355e-01}]"
201929,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":1795,""y"":0},{""x"":1795,""y"":1307},{""x"":0,""y"":1307}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.899999856948853e-01}]"
397271,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":2351,""y"":0},{""x"":2351,""y"":3999},{""x"":0,""y"":3999}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.599999845027924e-01}]"
355599,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":1323,""y"":0},{""x"":1323,""y"":1963},{""x"":0,""y"":1963}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.499999940395355e-01}]"
412502,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":3648,""y"":0},{""x"":3648,""y"":2882},{""x"":0,""y"":2882}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.499999940395355e-01}]"
337337,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":2755,""y"":0},{""x"":2755,""y"":3473},{""x"":0,""y"":3473}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.799999952316284e-01}]"
209969,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":3999,""y"":0},{""x"":3999,""y"":2701},{""x"":0,""y"":2701}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.499999940395355e-01}]"
6039,"[{""boundingPoly"":{""vertices"":[{""x"":187,""y"":0},{""x"":1695,""y"":0},{""x"":1695,""y"":1934},{""x"":187,""y"":1934}]},""confidence"":1.000000000000000e+00,""importanceFraction"":4.299999773502350e-01}]"
53710,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":3820,""y"":0},{""x"":3820,""y"":1866},{""x"":0,""y"":1866}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.999999761581421e-01}]"
377454,"[{""boundingPoly"":{""vertices"":[{""x"":179,""y"":0},{""x"":2505,""y"":0},{""x"":2505,""y"":3100},{""x"":179,""y"":3100}]},""confidence"":1.000000000000000e+00,""importanceFraction"":1.949999928474426e+00}]"
196587,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":1463,""y"":0},{""x"":1463,""y"":1811},{""x"":0,""y"":1811}]},""confidence"":1.000000000000000e+00,""importanceFraction"":9.699999690055847e-01}]"
336772,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":2815,""y"":0},{""x"":2815,""y"":3516},{""x"":0,""y"":3516}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.700000047683716e-01}]"
558364,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":2495,""y"":0},{""x"":2495,""y"":3855},{""x"":0,""y"":3855}]},""confidence"":1.000000000000000e+00,""importanceFraction"":4.699999988079071e-01}]"
399542,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":1854,""y"":0},{""x"":1854,""y"":1553},{""x"":0,""y"":1553}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.599999845027924e-01}]"
390002,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":3635,""y"":0},{""x"":3635,""y"":2750},{""x"":0,""y"":2750}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.499999940395355e-01}]"
693798,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":2565,""y"":0},{""x"":2565,""y"":3490},{""x"":0,""y"":3490}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.499999940395355e-01}]"
367538,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":3684,""y"":0},{""x"":3684,""y"":2406},{""x"":0,""y"":2406}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.499999940395355e-01}]"
369073,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":3725,""y"":0},{""x"":3725,""y"":2674},{""x"":0,""y"":2674}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.599999845027924e-01}]"
37169,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":1254,""y"":0},{""x"":1254,""y"":1919},{""x"":0,""y"":1919}]},""confidence"":1.000000000000000e+00,""importanceFraction"":4.399999976158142e-01}]"
339833,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":2390,""y"":0},{""x"":2390,""y"":1052},{""x"":0,""y"":1052}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.899999856948853e-01}]"
201428,"[{""boundingPoly"":{""vertices"":[{""x"":53,""y"":0},{""x"":1750,""y"":0},{""x"":1750,""y"":1195},{""x"":53,""y"":1195}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.899999856948853e-01}]"
209272,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":2784,""y"":0},{""x"":2784,""y"":2776},{""x"":0,""y"":2776}]},""confidence"":1.000000000000000e+00,""importanceFraction"":3.700000047683716e-01}]"
416888,"[{""boundingPoly"":{""vertices"":[{""x"":0,""y"":0},{""x"":228
Query:
SELECT DISTINCT o."object_id"
    FROM THE_MET.THE_MET.OBJECTS o
    INNER JOIN THE_MET.THE_MET.VISION_API_DATA v ON o."object_id" = v."object_id"
    LIMIT 1000;
Answer:
Too long, hard cut:
object_id
2704
308689
546942
204339
343127
578666
202859
104470
201749
239562
113100
393606
449595
308332
546355
226289
568716
90391
388318
453272
196116
340669
506171
447997
310223
214796
325122
345467
75091
9595
438947
681278
285647
559821
189458
562094
37216
12182
445763
450642
5419
199611
227360
67391
59408
247783
411307
422120
200413
309966
188922
203055
55166
478568
371380
555174
2416
44426
22067
21919
355297
26327
221130
334118
457103
706476
47379
463793
198114
450362
325404
390599
422167
198525
58006
195003
119817
114692
457652
240352
209420
188252
42427
552608
437585
410925
551448
407097
194942
407117
188790
336026
5289
50060
469942
67933
559049
246607
261842
12440
245736
557048
244998
543956
188673
406563
437278
459218
287224
104125
33416
68945
237794
339364
371330
229917
72238
363718
50567
248996
190932
2408
222298
322041
53294
470655
239820
53829
187333
465046
196881
443778
43187
464566
475263
215128
429577
559797
314494
671046
252392
414878
204646
38406
219215
550160
403876
8247
243638
457316
67544
323916
40927
226694
264982
457582
666123
548861
710927
623386
256149
37980
342718
210720
471572
335099
544918
552304
481037
396961
322209
217194
35629
53301
255152
446239
244603
192752
340690
360519
70494
158967
483721
463240
254598
259152
548918
443429
386602
255180
693149
189464
157645
26505
12536
459756
364657
546319
562783
680079
90509
215354
3984
367283
49457
377640
356327
307641
11625
460911
56864
463400
247677
228953
238890
706447
200075
409358
361716
205579
287227
339329
202452
391036
225069
373934
209332
36888
57442
504201
450132
318649
245457
69832
263219
577208
206032
223055
243795
446749
345033
364110
545185
36512
443619
13621
394016
383012
219561
12607
342590
195610
560420
325260
222656
343059
13261
372991
55814
571945
22070
652440
550253
337920
467250
438033
12834
465583
3115
577252
257058
203436
413447
347404
214013
345491
21355
453299
196921
156406
383677
7769
247850
56069
52471
408387
227192
324194
504522
243266
60626
229689
644465
573092
675898
56922
244892
241006
466754
324507
396903
159420
502513
444199
58940
58774
639405
823
547995
588380
189855
412508
52709
460185
222421
407562
66737
43157
214228
230476
213469
230414
467233
62094
37256
261879
369623
103642
222954
549709
193590
359471
200159
86410
69419
198916
21304
694395
336035
325661
415234
66211
218670
60076
384176
446349
565871
112933
288478
284874
14307
223568
464662
16479
339104
68909
386092
680464
267987
361656
683
355377
479299
549079
186434
659535
15944
573130
363050
5179
22876
46970
200942
156996
188916
219348
62198
571089
317567
360743
49194
451272
384993
705848
62577
623258
505106
369251
549444
45222
423149
205025
365723
340883
173651
547214
50573
400084
370772
55583
69748
391283
624385
316578
12592
451933
58507
545033
444840
37915
59434
209715
193609
437311
55498
9524
446997
326425
576998
68580
12271
224024
422679
288483
662923
186301
376110
222763
503844
400876
322240
19022
45251
119566
659539
124281
248903
66746
443823
237244
226358
342218
396339
358404
204773
58068
336919
259583
382652
197660
217269
327288
449010
662608
63819
59148
195268
251134
316963
244132
62974
451734
416148
465537
437637
323960
22768
216309
418593
450455
187528
68385
15807
156171
554596
67545
445502
323504
287368
223496
447928
188353
60125
3858
336339
376307
253044
124189
436274
251197
428762
339191
36657
72223
201353
64336
1999
338222
68751
545016
363506
570666
340835
19099
191825
115295
308667
13749
406656
193723
55737
412057
47853
39371
13761
247626
216991
388259
546214
54418
394031
545905
227841
477767
50859
393665
317533
156174
308015
463039
287770
445280
10184
390689
357164
37186
467941
412823
460166
549152
559066
246399
35126
400955
209571
90999
454504
307937
548969
57806
464905
437822
384959
14626
43911
323032
447006
460804
186216
246624
13000
255183
465624
684053
372635
661791
16319
415013
205742
369356
244558
341660
74650
50492
324310
214012
27144
348339
45274
590760
3441
43810
549703
216725
288532
54499
247215
26309
26598
51478
239155
458958
21185
219262
437056
323353
18844
251053
348004
43230
243821
232049
337624
386617
453494
192048
10141
26568
5133
251138
414932
364742
472117
348771
70670
316713
410377
310218
328746
232033
69717
685806
341439
670645
3096
204120
60283
414949
449313
652955
243899
62907
205984
243818
190588
222408
562061
323613
192669
5850
462952
86757
446891
340808
227393
240128
224317
444423
659075
43039
327381
554326
324800
553870
419903
65837
316818
415603
336855
321658
13799
463870
437273
40871
57221
346399
400618
443296
207934
389415
168761
465980
221970
567611
65986
410444
570431
60716
22394
218093
449337
158262
435788
395546
552455
545203
383824
334422
66524
199891
2487
169664
704860
448081
53281
26529
168342
400020
467909
452027
13074
47115
51150
544238
474512
66045
411473
465128
131994
188867
463702
268226
393249
485547
69838
23396
476394
325897
121214
446115
447890
251544
467258
336767
70471
243793
285838
408555
216978
248778
551600
169723
8405
334221
431194
463927
461279
555482
14731
60605
13629
201833
Query:
SELECT "title" FROM THE_MET.THE_MET.OBJECTS WHERE "department" = 'The Libraries' AND "title" ILIKE '%book%' LIMIT 1000;
Answer:
title
The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans
"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found"
"The cabinet-maker and upholsterer's drawing-book, in three parts"
"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work"
"The Whole Art of Marbling as Applied to Paper, Book Edges, etc."
Query:
SELECT DISTINCT "title" FROM THE_MET.THE_MET.OBJECTS WHERE "title" ILIKE '%book%' LIMIT 1000;
Answer:
Too long, hard cut:
title
明     郭詡     稱書圖     軸|Weighing Books
明     杜堇     伏生授經圖   軸|The Scholar Fu Sheng Transmitting the Book of Documents
画本宝能縷|Picture Book of Brocades with Precious Threads (Ehon takara no itosuji)
絵本松のしらべ|Picture Book on the Music of the Pine Trees (Ehon matsu no shirabe)
『和国諸職絵尽　諸織 絵本鏡』|A Picture Book Mirror of Various Occupations (Wakoku shoshoku ezukushi)
Ehon Asakayama|絵本浅香山|Picture Book: Mount Asaka (Ehon Asakayama)
Ehon Ogurayama|絵本小倉山|Picture Book: Ogura Hill (Ehon Ogurayama)
Ehon Himetsubaki|繪本女貞木|Picture Book: Camellia (Ehon Himetsubaki)
『繪本小倉山』|Picture Book of Ogura Hill (Ehon ogurayama)
『繪本小松原』|Picture Book of Komatsubara (Ehon komatsubara)
『寫山樓畫本』|Shazanrō (Bunchō) Picture Book (Shazanrō ehon)
『絵本時世粧』|Picture Book of Modern Figures of Fashion (Ehon imayō sugata)
絵本吾妻遊|Ehon Azuma asobi|Picture Book of Amusements of the Eastern Capital (Ehon Azuma asobi)
Ehon Momochidori Kyōka-awase|百千鳥狂歌合|Myriad Birds: Picture Book of Playful Verse (Momo chidori kyōka-awase)
潮干のつと|Gifts from the Ebb Tide (The Shell Book) (Shiohi no tsuto)
繪本四季花|Picture Book of Flowers of the Four Seasons (Ehon shiki no hana)
『画本狂歌山満多山』|Picture Book of Kyōka Poems: Mountains upon Mountains (Ehon kyōka yama mata yama)
『絵本和漢誉』|Picture Book on Heroes of China and Japan (Ehon wakan no homare)
絵本和歌夷 「龢謌夷」|Picture Book with Playful Poems for the Young God Ebisu
画本虫撰|Picture Book of Crawling Creatures (The Insect Book) (Ehon mushi erami)
『青楼繪本年中行事』|Yoshiwara Picture Book of New Year’s Festivities (Seirō ehon nenjū gyōji)
『暁斎漫画』|Kyōsai Sketchbook (Kyōsai manga)
"『閨の雛形』　正月|Plate from the Erotic Book Mounds of Dyed Colors: A Pattern Book for the Boudoir (Someiro no yama neya no hinagata), First Month"
"『画本虫撰』  「虻」「芋虫」|Horsefly (abu); Green Caterpillar, imomushi, from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』   「松虫」「虫蛍」|Tree cricket (Matsumushi); Firefly (Hotaru), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"画本虫撰　バッタと蟷螂|Cone-headed Grasshopper or Locust, (batta); Praying Mantis (Tōrō or Kamakiri), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"四季の花|Women on a Bridge, from the illustrated book Flowers of the Four Seasons"
"四季の花|A Child Lighting Fireworks, from the illustrated book Flowers of the Four Seasons"
"四季の花|Girls Getting on Board a Boat, from the illustrated book Flowers of the Four Seasons"
"四季の花|New Year's Games, from the printed book Flowers of the Four Seasons (Shiki no hana)"
"『雛形若菜初模様　玉や内　しら玉』|The Courtesan Shiratama of the Tamaya Brothel, from the series “A Pat-tern Book of the Year’s First Designs, Fresh as Spring Herbs” (“Hinagata wakana hatsu moyō”)"
"『雛形若菜初模様　四ツ目屋内　にしき木』|The Courtesan Nishikigi of the Yotsumeya Brothel, from the series “A Pattern Book of the Year’s First Designs, Fresh as Spring Herbs” (“Hinagata wakana hatsu moyō”)"
"『雛形若菜の初模様　扇屋内　七越』|The Courtesan Nanakoshi of the Ōgiya Brothel, from the series “A Pat-tern Book of the Year’s First Designs, Fresh as Spring Herbs” (“Hinagata wakana no hatsu moyō”)"
"『画本虫撰』   「けら」「はさみむし」|Mole Cricket (Kera); Earwig, (Hasami-mushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"『画本虫撰』「蝸牛」「轡虫」|Land Snail (Katatsumuri); Giant Katydid (Kutsuwamushi), from the Picture Book of Crawling Creatures (Ehon mushi erami)"
"Kamakura no Koshi|The Filial Son at Kamakura, From the Book: Sasekishu"
"『雛形若菜の初模様　つたや内　人まち』|The Courtesan Hitomachi of the Tsutaya Brothel, from the series “A Pat-tern Book of the Year’s First Designs, Fresh as Spring Herbs” (“Hinagata wakana no hatsu moyō”)"
[Woman in Robes Reading a Book]
[Seated Man Pointing to a Passage in an Open Book]
"Manuscript Illumination with the Visitation in an Initial D, from a Choir Book"
"Manuscript Leaf with Adoration of the Holy Name, from a Book of Hours"
The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans
"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work"
"London Chair-Makers' and Carvers' Book of Prices, for Workmanship..."
"The Oxford Drawing Book to which is added, Lessons in Flower Drawing"
A Booke of Christian Prayers
"Sketch Book Containing 182 drawings on 91 leaves. One of a series used by the artist on his Italian trip, 1750–52; Sketches made in Milan, Turin, Florence, and Rome."
Compendium of Architectural Books by Sebastiano Serlio (Books I-V)
The Architecture of A. Palladio in Four Books containing a Short Treatise on the Five Orders (L'Architecture de A. Palladio en quatre livres... / Il quattro libri dell'architettura)
Book of Designs [for Ironwork]
"St. Luke, seated on a cloud with an open book in both hands, a bull lying at his feet, from a series of the four evangelists after Agostino Veneziano, which are in turn after Giulio Romano"
"Dialectic: a young woman standing in a decorated interior and touching her right index finger to her left middle finger in a counting gesture, at he
Query:
SELECT
  o."object_id",
  o."title",
  TO_CHAR(TO_TIMESTAMP(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "formatted_metadata_date"
FROM
  THE_MET.THE_MET.OBJECTS o
  JOIN THE_MET.THE_MET.VISION_API_DATA v ON o."object_id" = v."object_id"
WHERE
  o."department" = 'The Libraries'
  AND o."title" ILIKE '%book%'
  AND GET_PATH(v."cropHintsAnnotation", 'cropHints[0].confidence')::FLOAT > 0.5;
Answer:
object_id,title,formatted_metadata_date
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc.",2017-02-06
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06
End Exploring Related Columns
Task: Retrieve the object id, title, and the formatted metadata date (as a string in 'YYYY-MM-DD' format) for objects in the "The Libraries" department where the cropConfidence is greater than 0.5, the object's title contains the word "book".

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: SELECT S."Column_Name" FROM {Database Name}.{Schema Name}.{Table_name} (ensure all column names are enclosed in double quotations)
Follow the answer format like: The query retrieves the `object_id`, `title`, and formatted `metadata_date` (in 'YYYY-MM-DD' format) for objects in the "The Libraries" department where the `cropConfidence` is greater than 0.5 and the `title` contains the word "book".

```csv
object_id,title,metadata_date
object_id:int,title containing "book",YYYY-MM-DD
```.
Here are some useful tips for answering:
When calculating distances between two geometries, use `ST_MakePoint(x, y)` to make a point and `ST_Distance(geometry1 GEOMETRY, geometry2 GEOMETRY)` to compute. No need to convert from meters to miles unless requested. Don't use Haversine like 2 * 6371000 * ASIN(...), use ST_DISTANCE for more precise results.
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'THE_MET': {'THE_MET': ['IMAGES', 'OBJECTS', 'VISION_API_DATA']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'
When handling TO_TIMESTAMP_NTZ conversions, use query like: SELECT CASE WHEN "date" >= 1e15 THEN TO_TIMESTAMP_NTZ("date" / 1000000) WHEN "date" >= 1e12 THEN TO_TIMESTAMP_NTZ("date" / 1000) ELSE TO_TIMESTAMP_NTZ("date") END AS parsed_timestamp FROM my_table;
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
Keep all decimals to four decimal places.
For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'

2025-01-17 20:06:42 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:06:42 - root - INFO - The query retrieves the `object_id`, `title`, and formatted `metadata_date` (in 'YYYY-MM-DD' format) for objects in the "The Libraries" department where the `cropConfidence` is greater than 0.5 and the `title` contains the word "book".

```sql
SELECT
    o."object_id",
    o."title",
    TO_CHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM
    "THE_MET"."THE_MET"."OBJECTS" AS o
    JOIN "THE_MET"."THE_MET"."VISION_API_DATA" AS v
        ON o."object_id" = v."object_id"
WHERE
    o."department" = 'The Libraries'
    AND o."title" ILIKE '%book%'
    AND v."cropHintsAnnotation":cropHints[0].confidence::FLOAT > 0.5;
```
2025-01-17 20:06:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:06:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:06:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:06:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-17 20:06:43 - snowflake.connector.connection - INFO - closed
2025-01-17 20:06:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:06:44 - root - INFO - itercount: 1
2025-01-17 20:06:44 - root - INFO - 0
2025-01-17 20:06:44 - root - INFO - results: 
object_id,title,metadata_date
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc.",2017-02-06
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06


2025-01-17 20:06:44 - root - INFO - Please check the answer again by reviewing Retrieve the object id, title, and the formatted metadata date (as a string in 'YYYY-MM-DD' format) for objects in the "The Libraries" department where the cropConfidence is greater than 0.5, the object's title contains the word "book"., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: The query retrieves the `object_id`, `title`, and formatted `metadata_date` (in 'YYYY-MM-DD' format) for objects in the "The Libraries" department where the `cropConfidence` is greater than 0.5 and the `title` contains the word "book".

```csv
object_id,title,metadata_date
object_id:int,title containing "book",YYYY-MM-DD
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
object_id,title,metadata_date
591856,"The Whole Art of Marbling as Applied to Paper, Book Edges, etc.",2017-02-06
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06
Current sql:
SELECT
    o."object_id",
    o."title",
    TO_CHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM
    "THE_MET"."THE_MET"."OBJECTS" AS o
    JOIN "THE_MET"."THE_MET"."VISION_API_DATA" AS v
        ON o."object_id" = v."object_id"
WHERE
    o."department" = 'The Libraries'
    AND o."title" ILIKE '%book%'
    AND v."cropHintsAnnotation":cropHints[0].confidence::FLOAT > 0.5;For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'

2025-01-17 20:07:07 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:07:07 - root - INFO - The query retrieves the `object_id`, `title`, and formatted `metadata_date` (in 'YYYY-MM-DD' format) for objects in the "The Libraries" department where the `cropConfidence` is greater than 0.5 and the `title` contains the word "book".

```sql
SELECT
    o."object_id",
    o."title",
    TO_CHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM
    "THE_MET"."THE_MET"."OBJECTS" AS o
    INNER JOIN "THE_MET"."THE_MET"."VISION_API_DATA" AS v
        ON o."object_id" = v."object_id"
WHERE
    o."department" = 'The Libraries'
    AND o."title" LIKE '%book%'
    AND v."cropHintsAnnotation":cropHints[0].confidence::FLOAT > 0.5;
```
2025-01-17 20:07:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:07:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:07:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:07:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 4
2025-01-17 20:07:08 - snowflake.connector.connection - INFO - closed
2025-01-17 20:07:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:07:09 - root - INFO - itercount: 2
2025-01-17 20:07:09 - root - INFO - 0
2025-01-17 20:07:09 - root - INFO - results: 
object_id,title,metadata_date
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06


2025-01-17 20:07:09 - root - INFO - Please check the answer again by reviewing Retrieve the object id, title, and the formatted metadata date (as a string in 'YYYY-MM-DD' format) for objects in the "The Libraries" department where the cropConfidence is greater than 0.5, the object's title contains the word "book"., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: The query retrieves the `object_id`, `title`, and formatted `metadata_date` (in 'YYYY-MM-DD' format) for objects in the "The Libraries" department where the `cropConfidence` is greater than 0.5 and the `title` contains the word "book".

```csv
object_id,title,metadata_date
object_id:int,title containing "book",YYYY-MM-DD
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
object_id,title,metadata_date
700238,"The cabinet-makers' London book of prices, and designs of cabinet work, calculated for the convenience of cabinet makers in general, whereby the price of executing any piece of work may be easily found",2017-02-06
591860,The Treatyse of  Fysshynge wyth an Angle from the book of Saint Albans,2017-02-06
700232,"The cabinet-maker and upholsterer's drawing-book, in three parts",2017-02-06
591861,"Scrapbook containing newspaper and magazine clippings, calling cards, sketches, photographs of paintings, and two sales catalogs of Harnett's (William Michael Harnett, 1848–1892) work",2017-02-06
Current sql:
SELECT
    o."object_id",
    o."title",
    TO_CHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM
    "THE_MET"."THE_MET"."OBJECTS" AS o
    INNER JOIN "THE_MET"."THE_MET"."VISION_API_DATA" AS v
        ON o."object_id" = v."object_id"
WHERE
    o."department" = 'The Libraries'
    AND o."title" LIKE '%book%'
    AND v."cropHintsAnnotation":cropHints[0].confidence::FLOAT > 0.5;For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'

2025-01-17 20:07:43 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:07:43 - root - INFO - ```sql
SELECT
    o."object_id",
    o."title",
    TO_CHAR(TO_TIMESTAMP_NTZ(o."metadata_date" / 1e6), 'YYYY-MM-DD') AS "metadata_date"
FROM
    "THE_MET"."THE_MET"."OBJECTS" AS o
    INNER JOIN "THE_MET"."THE_MET"."VISION_API_DATA" AS v
        ON o."object_id" = v."object_id"
WHERE
    o."department" = 'The Libraries'
    AND o."title" LIKE '%book%'
    AND v."cropHintsAnnotation":cropHints[0].confidence::FLOAT > 0.5;
```
2025-01-17 20:07:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:07:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:07:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:07:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 4
2025-01-17 20:07:44 - snowflake.connector.connection - INFO - closed
2025-01-17 20:07:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:07:45 - root - INFO - itercount: 3
2025-01-17 20:07:45 - root - INFO - 0
2025-01-17 20:07:45 - root - INFO - Total iteration counts: 3
