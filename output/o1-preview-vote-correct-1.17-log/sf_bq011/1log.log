2025-01-16 10:06:06 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 10:07:03 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 10:07:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 10:07:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 10:07:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 10:07:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 10:07:05 - snowflake.connector.connection - INFO - closed
2025-01-16 10:07:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 10:07:05 - root - INFO - SQL:
-- 1. Get distinct USER_PSEUDO_IDs from January 1, 2021
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
LIMIT 1000
Results:
Too long, hard cut:
USER_PSEUDO_ID
1003046.9452926974
1023282.4639847710
1026043.4481623879
1026409.1551860912
1032138.1796039159
1037928.9294661675
1045950.7099606829
1051288.9523352374
1066655.6240997015
1080064.0071613184
1082746.7285674512
1097358.9593491100
1104313.9641823605
1112823.8475775772
1116587.1725520171
1127824.3503063268
1107198.5152483918
1134825.6533092350
1164648.0319944302
1168297.2853699605
1170405.4925804370
1178889.6850461952
1205590.2516186397
1218586.5350251990
1246063.3665874179
1259302.9069938124
1296701.2382814729
1269423.6724500672
1277765.6068129494
1308776.9803994658
1318624.9067804638
1320187.6719997668
1375005.2583322863
1382535.7283137323
1401649.9529464111
1422161.0871788362
1437260.5988606411
1448835.0934102497
1499810.5142637849
1543004.7243225422
1582390.8206269591
1674937.2501954408
1693134.9790437518
1707918.4797422153
1820733.6464417466
1912537.7440240268
1961265.4757052307
2019465.0056495205
2157133.5876722467
2329161.7120010083
2340587.9439563847
2411763.0850272555
2432374.8482039518
2501661.0331987453
2687473.9692412289
1677450.9117017807
2007867.8957787066
2304235.4728947355
2327547.5435328629
2417078.3361324500
2754697.4847843626
2916336.4829526738
4132154.7009329565
4233290.6269558513
1054372.6755770068
1064574.6224708641
1138692.0103796281
1160488.2375923167
1174066.6437027818
1188134.8498680538
1213932.4846099850
1215465.1474478000
1255322.2973246181
1211099.8247563235
1275797.1936238018
1326289.2331853598
1333091.0887566663
1352892.5937639189
1385112.5897617274
1396456.6482506733
1453555.6810069410
1453951.1387928223
1473136.1149103090
1501018.3808301483
1518831.1475327211
1539940.5253610440
1564015.6880680172
1616136.8949543878
1684301.4109152707
1713530.3382800695
1719564.6333875501
1734528.1974041204
1762263.6990880514
1784794.0627143380
1829763.3860332334
1884090.9722372635
1958116.3750166429
1967725.7354072666
1993768.0582544668
2077981.6202330137
2194957.7885097322
2228172.7936687802
2244553.9738621373
2247846.3358362547
2362829.7919429820
2378480.6534474606
2384902.1644296925
2492721.1881800375
2506075.7314444580
2539661.0024435471
2563982.7084295364
2589245.5979068367
2630765.5704087315
2691270.4995570828
2719657.8629194725
1503421.5168556763
1515646.3111272928
1688147.2939632391
1694910.7733232660
1745171.2191701968
1765594.3047173009
1859470.4546513665
1886250.8920156183
1990491.3893000361
2007362.2149327588
2041235.3400307589
2091407.8804833129
2168528.2202958861
2263288.5212004372
2275476.3701234224
2375215.3636092839
2376646.7974930863
2463849.3270043637
2484010.5620979211
2486846.9299481244
2560700.2802998477
2578870.7901059159
2627874.7977372146
2694084.5852510731
1846974.0316175078
2102395.6721696580
2290904.3176780756
2748139.1358063966
2755973.1582682668
2767600.1190297171
2776706.0228802998
2783014.3813479767
2795133.4288865632
2810822.2085903402
2838667.1045753224
2844832.0483599899
2856545.1057637132
2893808.1269182675
2938826.3390148112
2965622.6326568063
3022409.8765357635
3027107.9482352721
3055314.8442482614
3067110.2430706696
3071789.9352232891
3085295.3644476516
3149868.5539413842
3158627.0434170250
3168155.2539701733
3205524.3451816980
3351786.5083077372
3421870.5719723099
3431784.9519587791
3845835.1922317737
3849458.8298476645
3909413.6458295238
4097505.3094071156
4332118.8573405921
4471894.7657502115
4496026.4851166246
3160960.1631301259
3193679.0282666132
3307311.0640715369
4124604.0408794437
4283464.4359186905
4376829.5724821918
4902634.1944567521
5035963.1657420274
5807457.8598720960
5825139.4540388000
6153608.9737608054
6248139.1631749929
6417370.3822460993
6859607.1364502314
7186178.0486082027
7327139.4510255713
1240786.8917310160
1456890.1673716823
1459436.8826692932
1534689.9343310805
1619900.3195973863
1646722.0078157231
1680043.1145812114
1759212.2216007988
2029664.5317923957
2159725.7481437355
2268837.3082004933
2322051.0966144624
2344300.8375944627
2599362.6005762632
2613632.7561400432
2655279.4923479690
1485472.4390061373
1575061.4789497906
1620024.8966870933
1699037.5870634483
1729803.5105688857
1749246.8534368616
1958256.0896241884
1999213.1832096854
2044855.8624761839
2084772.9471491241
2142722.9676010623
2150276.2168438227
2167343.6164963557
2245992.8909040661
2264573.5209212671
2272023.1096248377
2311908.3797713386
2437853.8047077377
2438148.3441039719
2683925.9434937492
2688110.9777730450
2709449.6736747839
1745072.0004799132
1804199.2014328535
2382451.4611706340
2485922.5515109543
2489685.1683265365
2681967.7844689964
2712864.2294346749
2739425.0432989823
2746195.3557509904
2779137.7674526641
2795240.3198638943
2796100.1284437751
2803851.7451929280
2821509.2290888995
2839647.6325562515
2842598.5931018472
2873742.8991614203
2882177.0250975565
2885429.0157235569
2892944.4318946076
2908071.3197159392
2912682.3106786643
2913205.0530257308
2917194.9600461127
2917834.9881423689
2952066.5004557428
2979122.8002670631
3001110.3208062401
3007601.9537396348
3017509.1296773380
3028781.2091495833
3038064.1337656016
3059739.3349984598
3071174

2025-01-16 10:07:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 10:07:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 10:07:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 10:07:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 10:07:06 - snowflake.connector.connection - INFO - closed
2025-01-16 10:07:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 10:07:07 - root - INFO - SQL:
-- 2. Get distinct USER_PSEUDO_IDs from January 2, 2021
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
LIMIT 1000
Results:
Too long, hard cut:
USER_PSEUDO_ID
1005484.1092567297
1019468.5334749980
1020695.6921096883
1034552.3956022963
1035433.9962487028
1054184.5156674867
1055969.5872512303
1104189.1961360907
1134613.7634894426
1137060.9310088729
1140798.4477437179
1161350.5694934880
1164110.7921696016
1219168.5485233162
1250553.7197007147
1253534.6863073074
1254621.7726451069
1272248.3527408128
1274599.3928448053
1278408.9014565519
1293446.1816560362
1296701.2382814729
1299487.6744511638
1160488.2375923167
1246097.1442578537
1279602.6727600031
1314847.4544971351
1315049.1291069189
1325116.8912286004
1334700.6047036975
1359861.1338029424
1364085.2107948688
1370461.9318815596
1380837.6952136083
1381565.5047705405
1392466.8272664309
1440319.2684459003
1470601.3891204117
1482331.8123183039
1537916.6494875994
1595062.2978681339
1689822.6628262328
1708071.1093492535
1720808.5659233423
1722117.4481798918
1778028.3352091849
1849787.1417367270
1873058.4156402266
1442997.6750483462
1524258.4980135729
1664037.8368386837
1810164.8096235223
1821461.3337986263
1946567.8498627659
2003178.1919214406
2003410.3743325553
2047377.2903997635
2149555.4176497170
2152321.4561806737
2498852.6851889965
2482206.0801635150
2914301.0348640426
3821938.0718647672
4466520.4224380665
1127197.7845904071
1273851.7434031787
1239682.4582755521
1382535.7283137323
1390300.4796021112
1402138.5184246691
1405619.5662753913
1413270.7201714861
1505379.6854768255
1507645.2354095566
1508520.3631208357
1619900.3195973863
1621047.1809785712
1652787.4806754655
1653230.5444867771
1698322.2974178584
1746667.8607565392
1550647.9864364390
1587333.3490610470
1664926.0864851694
1688021.5951717579
1699537.8074625037
1704767.6168359047
1788337.3157672800
1862279.2644343817
1928081.8451007978
1695729.1971283274
1929880.8943789391
1941137.5727282147
1966814.1086113170
1977599.8253595252
1989653.0310679976
1997680.4430170613
2014468.4429759626
2017291.1955110057
2022577.6028076666
2038564.1352340774
2087721.6967658602
2096059.7363835654
2109449.9660162118
2113798.0518736192
2115313.5923151214
2116832.9143999021
2124015.0378908424
2181825.8993193032
2183606.6278528627
2198590.4966974374
2202427.5069899276
2221930.1797585103
2240072.6562005194
2274040.6741003102
2275111.4028372694
2296500.5827142601
2370322.3013967089
2371746.6281118505
2403131.1457037836
2404282.2391450101
2455077.3609833583
2483927.4346404473
2492165.4306556688
2492500.1425673190
2507095.9841079823
2525850.6494695512
2531897.1720965032
2570370.5558938997
2580777.6323298293
2651666.4560824658
2660973.0848806953
2698448.4947532775
2701141.9642091381
2717248.8441315841
2774129.5676429649
2796844.1147797199
2803531.7150631290
2805870.7332545870
2226580.8704433782
2347781.8032119000
2394410.3295052541
2525713.0322520707
2702859.5556545822
2790732.2996651984
2859541.0647797664
2873795.2188253405
2944116.9709140014
2968068.9503410251
2979175.6555658320
3050126.3100434060
3103397.8438223081
3123951.7267370052
3129575.4645330370
3139310.3136681064
3190332.9286711863
3196986.4506387348
3270169.3923260547
3283436.9703000993
3298802.6061854202
3304301.6034432720
3331204.4960601137
3337255.4062843031
3370614.1127721319
3389304.0761075079
3422562.1233739382
3479120.0780634379
3662682.2223793701
3669778.2150269612
3799320.4811100799
3862731.2442659104
3969440.1397711344
4169937.4332655341
4269330.6240990162
4517487.0123463007
4693069.0008342578
3212822.5265745510
3490206.3115945074
3868373.8552176049
4071735.7876058990
4507678.9235168640
4343363.3390393347
4916065.6816652712
5107791.4014664740
5194215.6175507718
5785112.8218902397
6358024.9360228635
6437781.4636468836
6708277.1224699368
6719737.4821468787
6790221.7492641384
1441065.6470414018
1587120.7886409442
1650186.4171427739
1721354.6818865235
1793640.9588973139
1804084.9503910975
1824121.5656787337
1661549.9249699570
1679710.5467997846
1684439.4801767659
1846974.0316175078
1946378.2604112351
1988973.6797776774
1990491.3893000361
2063626.9238065250
2100078.5164826353
2144124.6364405235
2197705.7004821624
2225774.7364227776
2253111.9586733581
2284553.4981188662
2301921.2057149746
2303142.6308475718
2314215.6504049440
2331461.5841279593
2336526.9274069819
2345583.2413952607
2350448.4141410843
2361377.9933199841
2430658.1327125161
2500745.7357943995
2508716.6266480416
2534054.9013465326
2536363.5033290586
2537006.1447313249
2537784.9601456696
2543713.9652701500
2593958.9228258081
2624672.3577974916
2633946.3497198473
2635200.0699795839
2655651.8460042132
2689155.5329072803
2729998.5888891394
2755212.7073417309
2826036.8165007769
2829836.1939432968
2846251.5565404014
2226624.7706208292
2235087.0942165188
2380241.2215017615
2520337.3364032237
2583358.3664829751
2586866.8291568544
2659583.1200764629
2684654.7272120586
2716352.9687101097
2757199.8307230870
2766451.6819922873
2841776.9997975452
2855379.6764009053
2916466.0256798553
2924834.5756001494
2926676.0612560137
2937600.0398319286
2952420.3520432233
2967255.9371191104
2977911.6545493734
2985689.3188605734
2989061.1420113322
3013251.7143326291
3024189

2025-01-16 10:07:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 10:07:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 10:07:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 10:07:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 10:07:08 - snowflake.connector.connection - INFO - closed
2025-01-16 10:07:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 10:07:09 - root - INFO - SQL:
-- 3. Get distinct USER_PSEUDO_IDs from January 3, 2021
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
LIMIT 1000
Results:
Too long, hard cut:
USER_PSEUDO_ID
1002909.5490808649
1005317.0661766703
1019755.1505990457
1040686.3843613593
1052352.6374592258
1063831.2287636950
1064723.3587773894
1078657.7431630909
1090942.3656035032
1100538.7303282538
1110565.1782268698
1113469.1950253831
1115892.5784150898
1122585.7488321709
1128307.8804338977
1160488.2375923167
1162127.7258009994
1193163.2977185902
1215085.1365476037
1227555.8440964013
1254635.4374785888
1281967.0612172650
1315804.4711170020
1323571.6093451149
1152407.0498719030
1252850.0331551815
1337333.7376655274
1161321.2837154002
1337545.1457768752
1346788.0845555279
1351515.4448203569
1367121.2892216686
1373665.5021657907
1380451.8811229172
1392466.8272664309
1396652.0099177607
1412894.3157340807
1469872.0658596547
1486145.0830518341
1499585.9084564597
1532892.3620003291
1537627.2287708814
1541674.7751153834
1542935.3233857088
1592849.2265519225
1682124.6448806669
1695754.0063712697
1411153.8126169951
1421827.9572513749
1572749.7611592304
1614191.8941227146
1812383.0910322447
1818576.4805267463
1881209.0076863006
1897533.7011168120
1945068.8887037343
2007133.2050607499
2025094.8458541150
2038619.5845722539
2041636.5714374787
2119739.1670732304
2280413.3644356777
2573743.1340578848
2826460.7594363371
1091029.8690027225
1150237.3795733230
1224962.9088243391
1273436.8995766746
1134613.7634894426
1158176.7649664163
1240998.2484233559
1272248.3527408128
1359122.4451792116
1364311.9400187078
1402138.5184246691
1421905.2876669825
1431100.3601536868
1447357.9474081641
1467491.0144424693
1479460.0711186525
1492257.1138270046
1493438.1834934820
1506421.3254179692
1514731.7040098386
1517389.5868953250
1524148.6665316369
1540840.8307652027
1543001.0061190370
1549534.8666555998
1559691.3070864144
1581352.9819384508
1676361.4249094214
1680228.3236339760
1701171.7891319767
1722821.4828861908
1441310.9435193216
1540189.8503303096
1594198.5163900495
1620024.8966870933
1638888.9196983491
1725061.6799620601
1778706.3695787213
1795348.7274570896
1828323.6363540243
1835098.8936415398
1836002.4464896869
1846974.0316175078
1855281.3848935817
1866502.0937824174
1904344.1246218075
1926942.7504502304
1975795.3885477150
1984981.1368985758
2013179.1961252046
2016350.2293248690
2021392.5582405639
2037226.9494356563
2051660.3699709133
2061051.4106233261
2074343.2529016722
2080113.4054405724
2080627.6433673015
2132082.0425871090
2149555.4176497170
2167556.5931244051
2230338.6447127604
2235087.0942165188
2244416.2131745073
2251697.6988530890
2261361.1024090855
2264647.0487709418
2268811.3293751715
2293327.7085879362
2324895.1791131968
2331220.0924408261
2415858.4972221670
2429545.0739470755
2537784.9601456696
2550346.0240459466
2553007.7989629504
2594994.9553538392
2636714.6150733575
2676710.1116599974
2745163.0287640909
2755125.1317028746
2790457.4820504680
2175748.6632446476
2369117.0306760559
2452944.6891191369
2490320.0019887642
2513182.3165081489
2577015.7109497692
2622344.4282271889
2752584.3486742258
2773889.3043972604
2846692.8806198515
2856080.3703273863
2902982.6625267541
2914301.0348640426
2933389.9188626942
2963687.6828704107
3089324.8152427839
3097406.6896765026
3114951.7301878881
3141277.0508009875
3181855.4972976686
3189696.8513754654
3197448.9244429763
3328745.5456317568
3345685.1895997342
3377339.5089753849
3379611.0658210929
3456591.6309392992
3484580.9883519327
3587110.4310578340
3593045.4474754034
3729541.2879863814
3747998.9136824379
3785496.8643699837
3807842.5003018860
4076433.1925875378
4143683.1978506174
4526496.4812747154
3238899.1774806862
4708841.8269597203
4819501.9483311114
4857009.7277045305
5141791.6821581739
5311446.0799471986
5683791.6366649386
5791539.6874767478
1146873.1391018144
1276909.6538469251
1322015.5018667302
1349503.8334692563
1405673.2837970999
1481380.1920064669
1738826.5362245141
1520148.2433623014
1561053.3911726952
1605564.2171778452
1726193.3100477031
1739034.9012964285
1807272.4286827133
1807963.9006954889
1844179.1799405502
1914709.0568449387
1948683.3397099611
1988973.6797776774
2015735.0531195958
2039126.6383271583
2056616.0747926191
2073604.4967468975
2078465.2278288976
2116278.5223204033
2146786.6850366036
2152325.3380201742
2176615.6010852073
2265540.8008532129
2267646.6725590413
2295278.4688935985
2308373.3394347065
2367298.5991928738
2415629.6598683842
2430814.2764324500
2430928.8778009492
2437168.2728482016
2533249.2785094842
2554987.2869542845
2555082.4233289096
2563982.7084295364
2634677.3085257806
2658281.7873085687
2728671.5444484223
2737329.2443602937
2744962.6808165378
2794016.6440539861
2865307.6460813087
1979778.7331964605
2094642.2631508719
2160515.1902326402
2221181.9620961014
2275313.5266564172
2293260.7167260153
2345345.3780200574
2480908.6648549176
2730719.0820696621
2783233.8366408661
2784282.4789765642
2836065.8456107379
2840286.0273963646
2857035.9328090656
2885429.0157235569
2566092.9507111229
2887406.1792807548
2893336.6716596891
2927609.8749336065
2928524.5577316092
2964264.1652462823
2972608.8263112140
2983642.9311751419
3019547.6190207209
3048586

2025-01-16 10:07:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 10:07:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 10:07:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 10:07:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 10:07:10 - snowflake.connector.connection - INFO - closed
2025-01-16 10:07:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 10:07:11 - root - INFO - SQL:
-- 4. Get distinct USER_PSEUDO_IDs from January 4, 2021
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
LIMIT 1000
Results:
Too long, hard cut:
USER_PSEUDO_ID
1008499.5928445086
1013760.9231029745
1014209.5295344253
1026137.2290719007
1028167.1226079449
1032092.5249707229
1053193.3273260382
1057066.6724870774
1067841.4647153954
1081165.5314971225
1082690.0377265261
1109836.9501901728
1113469.1950253831
1114181.7368629788
1130810.6137694456
1158637.0383647084
1164741.6860607634
1181674.5265741661
1194575.2891034137
1214573.9183644653
1134613.7634894426
1121518.2859510925
1215389.2295507570
1222867.5284822262
1227012.8467411408
1238230.5582832258
1284535.4676055384
1289319.0865612371
1297488.8153560940
1299487.6744511638
1307038.3688504236
1312237.6155331000
1385090.1246142947
1401785.6584445113
1402228.3482241994
1445737.4102905419
1450787.9898569840
1470241.3611852177
1471187.8226858001
1493030.0825468207
1519189.6398973848
1607100.0381093527
1634789.3752037441
1243221.1777211525
1403129.5580554677
1458803.4123039458
1509456.3177418451
1590715.7165540392
1624884.8451928269
1732811.6786855240
1751599.1685077136
1765130.1889939374
1824201.1380052029
1891844.3029317015
1930569.1007455155
2164352.2670593278
2303928.3507051479
2388941.9518774856
2587147.0479569634
2630262.0012746307
2808285.4912615885
2933942.9058732953
3063778.7827149758
3232149.8018732656
1057265.5844727802
1065673.0722289663
1103286.8251708796
1075223.2681702246
1185078.3105419781
1252690.3944441209
1288248.9113459714
1309149.1848587742
1313329.6311058857
1314747.6066644573
1320284.3859724504
1325688.1519909745
1339205.5397897099
1373324.8357357420
1385662.1127085473
1488009.3142808321
1497130.5055593166
1500615.9964438412
1586022.1800460720
1590652.6726149736
1629639.2044968342
1334969.6157017719
1466910.4554610435
1504953.0746977838
1522857.5896662267
1544748.2905250855
1556885.1837167077
1588666.3949365829
1622235.9923526878
1656975.3346712388
1659842.4321850950
1665661.9122532614
1668416.2014466630
1690623.2302780540
1702845.7520261284
1703253.2388947937
1754331.3157951821
1757510.5330787128
1765047.7773329261
1770215.5966952525
1780294.0221405041
1787504.7670504282
1791921.4002592107
1807394.6792147711
1841613.4096590753
1857518.5760998088
1895574.3356492898
1901730.7277275021
1922936.0279129669
1945068.8887037343
1949104.1690663627
1950108.6469907871
1954953.0721200891
1966048.6599698958
1976029.4501496209
1983421.2936555498
1993697.9945930656
2002776.5976883193
2005618.5376901983
2014270.2546235318
2055215.4967663939
2094642.2631508719
2116278.5223204033
2167317.9816236215
2175416.5833910330
2192432.3542621657
2193948.2281082270
2200081.2420876058
2245385.0615539791
2248364.4469117960
2250793.6313697017
2258641.1629826733
2263380.7170574283
2265208.1282213045
2327460.3641621424
1711048.6268268364
1799135.7941835837
1842336.8436996882
1859470.4546513665
2203449.4497261194
2276075.8079921958
2277998.4131015438
2304235.4728947355
2349749.6508625488
2382234.3846802600
2415858.4972221670
2438902.8824385354
2440353.3206892115
2461015.7427876593
2507894.1372177453
2526912.7108743899
2536104.6818349493
2551167.3034654376
2551300.8505181236
2568488.0444965897
2599191.1809781484
2613732.0466667239
2614498.1516604416
2624431.4002749857
2632235.6933492055
2636673.7777856869
2637684.2664716834
2818493.7937628616
2882533.0281462726
2962062.5636750914
2977883.7344825123
3095151.5001822426
3124894.2857829744
3163846.4345628829
3314414.8482814192
3412220.6161181119
3429129.1766622829
3455493.8716820126
3458672.4067777996
3481366.0062791617
3522747.5222413884
3549371.4147860086
3314204.2967165973
3375221.1442572249
3796545.6803466963
3893846.7926490461
3945067.6189159317
4361543.5487737593
4708759.3565818280
5698867.7395543069
1536105.5891820566
1560589.3791460585
1588332.2823326217
1578948.0834575091
1632927.1894987991
1639296.9002795622
1648032.7331818100
1668023.4150976276
1672632.0859250572
1702019.9842929153
1707319.9934501562
1711971.4968010332
1726993.2463217900
1730497.6226428479
1745835.9106014489
1795540.6156637931
1808170.2762309629
1808232.5654454206
1855160.6431356491
1908860.5902672888
1934857.9616833097
2022577.6028076666
2049590.8596560881
2051318.3089832623
2079154.1476733507
2096766.0019470232
2121651.9176614852
2131056.2525081023
2131509.8375213648
2157825.0718936880
2172399.2091034226
2177957.7412962494
2197864.5182472083
2204878.2541228096
2214606.8300190111
2263420.2110121128
2284976.1899128869
2301413.0302404690
1843227.1315168145
1888732.5808117060
1979778.7331964605
1982815.8232892378
2147417.5961373356
2194441.0544343537
2248754.7783173763
2250953.6316204806
2262724.6807963688
2279457.7315196874
2329707.0387773385
2331461.5841279593
2333408.5403558380
2346000.3226235037
2374910.1217694068
2382887.9214525018
2392346.1836393196
2393556.1146578015
2399121.7379674359
2404535.1253227145
2415432.3160368774
2415788.3641983779
2417805.0150005257
2419732.5640450460
2422137.6877778640
2425570.7323199738
2430886.9385533523
2465015.1494457724
2467393.7377682212
2491439.4728767719
2501970.2707488768
2526432.6035949356
2546017.5150907817
2548737.2552051276
2558365.7246265443
2581316

2025-01-16 10:07:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 10:07:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 10:07:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 10:07:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 10:07:12 - snowflake.connector.connection - INFO - closed
2025-01-16 10:07:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 10:07:13 - root - INFO - SQL:
-- 5. Get distinct USER_PSEUDO_IDs from January 5, 2021
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
LIMIT 1000
Results:
Too long, hard cut:
USER_PSEUDO_ID
1006764.2593478041
1011730.5937310445
1025554.7155857902
1028337.8871283783
1031058.2518048614
1032606.3576924541
1056329.7612609650
1071257.2904972531
1075223.2681702246
1079374.1910653935
1082920.8892141550
1086535.4875940498
1087808.3711873816
1096553.1505774248
1102947.5096330985
1113194.4596973553
1124854.6111785259
1141770.2200021598
1153093.0119048067
1068701.3018406914
1117874.3324542795
1132555.2301002365
1133964.7947497780
1115003.4680616065
1160488.2375923167
1182923.0909175622
1187482.7824786316
1192643.6460701245
1203853.5073281021
1204844.2691721789
1215841.5184851096
1218242.9191016186
1225314.7220680786
1226878.4100446319
1241629.8724178917
1243376.8542545034
1247686.2070404262
1254011.7545907964
1258911.4567959870
1264993.3645153639
1274495.5184398589
1275384.3626297214
1284133.7579148747
1318068.2020052683
1186112.8377343718
1241220.1441674551
1272248.3527408128
1318879.8038263711
1321742.4551192896
1325482.4574108673
1325688.1519909745
1336694.6432583433
1379775.2562814073
1432451.2006018969
1499710.7075498493
1601062.3810646545
1620254.4260686044
1624184.5854197789
1634789.3752037441
1684159.4687183007
1691574.8292247705
1728565.2006018969
1790724.2394851163
1887643.2920418963
1089575.2761256602
1122855.4085911936
1129742.7402804867
1172217.8534916097
1197568.4892852272
1222409.1951536768
1260992.5282234785
1264306.5410019941
1276342.9126460945
1280266.1333397958
1285418.4651557245
1291228.5655196810
1292185.5593921414
1301862.0758294607
1304296.6040710271
1261100.0843906075
1278427.6141690556
1286945.3645505196
1306493.1469289903
1307038.3688504236
1309149.1848587742
1244606.6899321311
1307807.0071561878
1321029.7577861325
1326179.1742099424
1342157.7728855384
1345509.3936713223
1348068.1593058656
1399527.2790058720
1404886.4182310055
1414193.2963567157
1439687.4557873700
1455809.7208111760
1457888.4327764965
1460768.9286238752
1469643.2045997031
1474066.3112067437
1484308.7242312753
1490370.6853135246
1492265.2880623974
1493519.8322170424
1512868.5635891160
1529263.1215051275
1579480.5217830271
1598992.9833853976
1605958.5124385076
1624884.8451928269
1631157.7294829770
1643710.6184759313
1660273.8916953629
1668728.4457564716
1677656.0408442666
1678522.1728444321
1683135.7204561691
1689680.1758593934
1692783.8693710254
1701360.1955093195
1719948.6487524460
1730442.5913214469
1743537.3807228570
1769082.9639759569
1777640.6199182586
1801091.1241509207
1806270.7453025738
1903900.7465384771
1912465.1226265010
1915544.8129735440
1915861.2747686951
1944841.0469682976
1950108.6469907871
1951948.3958655417
1967071.8507920403
1973596.8847857907
1406007.4609789626
1535511.8717950286
1627793.7205729342
1674457.5024784341
1758063.1561647030
1815114.2194185357
1828683.2365695110
1921576.8040299290
1953961.4681289955
1929432.7626947942
1958026.2831982626
2028003.7547803636
2068054.9611310747
2092012.6174342505
2105669.6226949819
2109755.7685489728
2118611.8310815420
2125070.4400620233
2135694.1271960485
2165966.8215524686
2197864.5182472083
2201944.0699665555
2222452.9695157189
2238932.4005449023
2261700.6454970936
2312554.3356483680
2317618.6395077991
2323477.7085022522
2361948.8320917052
2379179.4251306058
2483928.9846569809
2490218.9350271294
2495859.0664008046
2534951.2425037201
2610798.7861805723
2623420.0664690811
2661860.2046532516
2662675.7949692171
2686485.2659740693
2705521.6524856404
2746901.7010168334
3008011.9598954692
3065109.3493355601
3084839.1075146820
2435294.1392236670
2705245.1520911278
2956829.8164724582
3212604.7959516553
3331491.6160080099
3455493.8716820126
3492112.6709159602
3784858.9917233650
4108792.0630353488
4718939.2279552414
1304588.7510213626
1352587.0117468163
1360671.0435504959
1487082.6524856404
1537312.2917195558
1564199.6125444442
1578274.5274788603
1604724.4234077225
1606235.3819045638
1620024.8966870933
1624589.6191841132
1638886.3189064831
1676773.5069362381
1677190.7248845737
1696108.9096256870
1699542.3955012593
1724873.0147071241
1738611.7151385455
1741134.3014269392
1748445.0250662291
1750371.7249808647
1752247.4003173929
1760816.4329690600
1775693.2061637855
1784392.5897601717
1814543.0883007631
1820584.9928114663
1827148.6871625424
1829646.8413644399
1845515.7457629065
1847031.8084425545
1863546.1943218811
1882711.8628729867
1897436.1791225377
1912292.1832297951
1938550.0034007429
1956174.7971081539
1957305.4611719510
1966814.2988882243
1969417.8912253448
1356010.8691002356
1397822.5235180436
1434548.8581092193
1455644.0190003959
1529884.1932366182
1624230.7368868695
1838825.9112970722
1858499.7282083599
1861628.8947054439
1887579.9697810740
1918525.1677638858
1927968.5861658781
1946071.4353177173
1954953.0721200891
1859470.4546513665
1941137.5727282147
1946008.0388629105
1983907.3611526882
1998068.4108860041
2022517.4263243587
2029332.3604728700
2040396.6725159529
2052993.4401507223
2062314.9246293593
2094636.6332384800
2101466.8177182409
2110137.4748876278
2110567.6072497635
2114984.3580023602
2116278.5223204033
2123018.8091748657
2133723

2025-01-16 10:07:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 10:07:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 10:07:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 10:07:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 10:07:14 - snowflake.connector.connection - INFO - closed
2025-01-16 10:07:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 10:07:14 - root - INFO - SQL:
-- 6. Get distinct USER_PSEUDO_IDs from January 6, 2021
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
LIMIT 1000
Results:
Too long, hard cut:
USER_PSEUDO_ID
1001303.4827739208
1014060.1100191558
1015239.8458513676
1023213.5350684501
1025773.0920505617
1033020.5841925327
1042140.6802444773
1045720.9269650087
1049106.9990499157
1049739.7909391395
1065322.6541302193
1072513.2161702512
1075240.7394043586
1075333.9269112947
1078788.8328338285
1081165.5314971225
1087271.0550084610
1095740.4839642689
1114964.3576383224
1118833.2974558782
1126378.6956818362
1069165.2811408476
1083792.6034832516
1086843.9052907013
1128261.6033595713
1128289.3662024583
1133313.1103337373
1144792.8191246270
1146837.4730107711
1151687.1996189042
1153093.0119048067
1163998.9977514528
1170673.0496256889
1173439.7311015929
1180762.6954492448
1214408.9886831537
1216128.7020381390
1243180.2889994882
1257670.9852008771
1218031.2772164166
1255130.2864074728
1278990.5126400811
1280885.4587684428
1304296.6040710271
1311409.7691253264
1324330.4963761152
1326729.2901375460
1328537.2795814770
1357835.0893556888
1369631.9406198523
1408865.7005954025
1442352.3658130118
1474912.2146834138
1524322.6852456903
1537642.0362746652
1390300.4796021112
1614669.6038310943
1624875.9469354174
1685163.0188672299
1760327.1126266238
1830571.5765734358
1921439.1124554416
2013775.7921697237
2369962.9052586610
1069494.0113686800
1084471.2677471598
1087808.3711873816
1115377.5526866793
1060274.1098179258
1086668.0925005810
1111626.7442894456
1130911.8567954377
1141870.4386338572
1148615.3691736909
1160488.2375923167
1169456.0744217795
1185502.9456478888
1185607.4529846208
1213730.2023854144
1214882.5762650867
1224512.5360000287
1230929.5891057900
1252675.9812778248
1253621.4143036992
1256871.5825332697
1270650.6052564575
1133962.3740970739
1177018.6074439798
1211099.8247563235
1285418.4651557245
1285421.1033375628
1295893.9741062295
1304912.9788917690
1306493.1469289903
1314525.6769250991
1324723.7882312578
1325005.1519738149
1358070.7682863119
1362293.0058255347
1366045.3922534826
1372261.7721304420
1374353.8427076075
1377886.1560338090
1380305.7377133735
1383476.9026182603
1388300.4678602079
1395824.1622992884
1418623.6541339375
1421329.8121000178
1451268.4257155324
1470631.9552326980
1483107.7440546761
1485221.2761545005
1493982.6183998464
1520786.0949644980
1529639.2751490138
1538853.8027080230
1542686.8251143701
1553110.3711752329
1557094.4086790025
1565944.2403531565
1569105.7216127560
1572598.8364509193
1332716.7234827218
1390701.8959589858
1436098.4730553026
1563588.5377359390
1532659.8332550859
1584311.2852657177
1600662.6721143107
1607155.9736505928
1644962.0672937719
1665685.1962105106
1671731.4079391358
1673366.1492700771
1711666.5759989568
1715613.1015599605
1725092.2005673007
1770542.1482149599
1774229.1142302813
1775022.8326960466
1786806.6734812198
1805650.8119186851
1834580.5106619345
1869265.9376251928
1909593.9396452170
1944841.0469682976
1950108.6469907871
1959950.1321560119
1960091.6138417827
1984800.0163024441
1988560.6872382890
1990765.0839533057
1990797.7990017528
1992389.4170917308
1999673.6165164371
2040396.6725159529
2049788.5802519058
2061908.5124252786
2090129.6574242641
2111290.0027794271
2120147.1170157058
2127823.7478622035
2134985.6767664940
2156329.6864342628
2218392.6502870255
2277495.4291720656
2346698.7306200948
2370622.7087996111
2467532.4579179929
2490431.1454031899
2516342.0462813812
2539311.5761208134
2548639.6153956564
1806270.7453025738
1888612.2074326083
1925677.0426697206
2059002.9163061848
2212942.6465272497
2219098.9178831127
2256421.3695830766
2281638.3308228648
2381765.2646486155
2387737.8440654529
2404535.1253227145
2691215.8305309072
2922252.5561637733
2942279.6949051665
3080096.7941775869
3089831.5533518781
3131506.1834242034
3140165.3845579972
1135774.0646413552
1144150.5821344535
1175417.7164964556
1221611.6181416961
1245742.1517954276
1259037.7018534149
1264306.5410019941
1274840.8216292245
1223402.7111643409
1250075.3055872841
1251677.0033366371
1282586.4517477452
1283422.3494279515
1291684.5715903210
1304588.7510213626
1318199.4944291645
1368947.6948566343
1376090.8119482339
1387570.7927046510
1412724.1344589310
1433324.7672312716
1484136.6530214500
1496913.8935875858
1506439.0847364167
1506539.1639843846
1513363.4705791183
1522572.1753325266
1529746.2151935759
1544033.2704162362
1555307.6654439904
1568701.7618656061
1573704.7204978503
1499057.4357872580
1506112.7265258752
1519792.3976302972
1498978.1889757995
1595752.5739499079
1604576.0477201832
1606972.7164816338
1630439.0167164545
1646872.3600157379
1670772.8517777467
1677342.6525684271
1702808.4648640313
1706543.4300583809
1722746.7723659310
1732904.4615563462
1743359.6937438402
1750371.7249808647
1754006.0994834886
1754096.9892214658
1762188.0255397483
1776940.9301836875
1780380.8421968556
1782989.8792867764
1783326.7767103110
1789084.1816233251
1799418.1299673128
1803057.3123311699
1817739.9801196106
1818888.2177557064
1819801.1582224257
1847031.8084425545
1860348.3130044315
1861628.8947054439
1870216.8883543271
1883551.8077158377
1896441.1015330367
1912970.3114085343
1913596.0640126840
1960911

2025-01-16 10:07:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 10:07:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 10:07:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 10:07:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 10:07:16 - snowflake.connector.connection - INFO - closed
2025-01-16 10:07:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 10:07:16 - root - INFO - SQL:
-- 7. Get distinct USER_PSEUDO_IDs from January 7, 2021
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
LIMIT 1000
Results:
Too long, hard cut:
USER_PSEUDO_ID
1000557.2911835023
1002616.3660015684
1008726.7423030385
1009541.6887464068
1009676.4905193951
1016428.1065641732
1020795.7432964012
1028144.2081628525
1030326.1353640844
1036021.1054561259
1043511.9901401232
1046404.1129546883
1073430.9059120582
1087808.3711873816
1099671.3398238118
1107549.5710254296
1109808.6106046131
1124540.2333393152
1019574.8776308935
1066407.3757892113
1072012.7284818935
1116865.4647068394
1132479.2425986879
1132946.8730897471
1122146.8997157148
1144754.6830399719
1149393.9441120966
1150418.5729329589
1151529.7874029554
1151687.1996189042
1168153.2069804316
1174920.8866835138
1177876.9777589683
1181141.8389731329
1194177.8166317724
1209023.5496836341
1224731.3666771048
1237924.3309856915
1246241.1259892311
1247293.4194247843
1272559.2391561764
1276927.7607362138
1366363.8080922440
1196040.9501767394
1256871.5825332697
1266942.9616912837
1275281.1401174806
1299775.3014967415
1317681.8410322222
1404246.6716592021
1425808.3063725064
1431033.2186997626
1446850.8020489502
1447620.3308368044
1459124.3307795496
1550391.0083775168
1631724.2395953902
1667250.8018262205
1750084.1602132369
1883648.1654112367
1947449.4066998823
1709858.9795411204
2352032.6961720993
2387032.5320070875
1056020.6709260931
1063386.3828577009
1100949.9283905733
1114216.0904812151
1098584.0776604006
1138520.5891734753
1150257.3416332583
1163998.9977514528
1166484.2621554560
1169660.2704170325
1172211.4577928962
1182923.0909175622
1195966.3969559148
1231601.8963574336
1242735.7779476738
1280885.4587684428
1291324.6496937233
1309980.6522015685
1333728.0047687977
1359026.8307338454
1362228.4966015575
1366103.4269040146
1374932.4478575733
1263510.2346903431
1283562.7271739130
1287483.1535140122
1320383.7530644264
1332979.8914503740
1342173.6511298548
1357251.3765617872
1366281.7261580221
1369023.5738995470
1378696.4627477130
1385336.9757682390
1390701.8959589858
1406007.4609789626
1406098.2272398299
1406568.6449738818
1408955.7264448085
1417342.6523496808
1421115.4433330025
1421856.0079266060
1434822.0221853225
1450600.6803049558
1457470.5940116605
1459299.1013763792
1461952.0290351411
1478029.4552762559
1480795.6595718331
1528342.2635970316
1544241.6807718255
1561122.7855918216
1569852.5468689472
1590652.6726149736
1650314.7806652804
1659496.8938806193
1673328.4452718162
1690932.7741713887
1702434.1337833338
1704559.1277489943
1713151.7799105629
1724440.6442958003
1725560.3896736022
1749326.0413550275
1767689.7108431002
1799694.8972403574
1825800.9927595957
1839358.0620214551
1867222.1866677990
1889430.9379107863
1907356.8098775960
1947877.1109354712
1988560.6872382890
2014270.2546235318
2017764.9469389867
2039856.4057543029
2058616.9904162015
1554803.8279036598
1626366.8919067582
1658205.7748137560
1680148.7300106081
1778635.2272822812
1803816.2751642917
1852845.4335508679
1915112.3520066455
1963150.5780975373
1983135.0030940300
2014307.3611842210
2014709.5760211511
1713143.1515270435
2073032.0340382286
2075161.4907764275
2081586.3480335058
2100577.0184610827
2141191.6534652110
2156834.4695745566
2184597.5180287784
2212942.6465272497
2265878.0595059594
2278217.6227941431
2336672.2485114998
2379367.8970354004
2389441.8991227766
2465113.6238683470
2502078.8282016554
2528087.3940013153
2552193.1533386792
2560997.2558350501
2565533.4912616346
2601275.5971642210
2619587.2051047193
2666470.5691573546
2732035.7369571716
2762030.3380654956
2958451.8916179810
2185769.2680594160
3052704.4194270640
3097076.4453723823
3117289.0450306966
3138649.1729775710
3644405.6914122756
3683768.6421577232
3808716.5372557296
3869501.2085951407
4006774.2034898959
4095807.0946454031
4147591.0087343477
1091162.1989694199
1104189.1961360907
1227321.4549113942
1295828.0586489111
1186421.2997808469
1296777.6630043403
1304171.0604038711
1329436.8221805419
1342397.5707081379
1364505.7481550412
1403236.7518250436
1404269.7082895339
1414085.4804386953
1418203.9991889841
1444536.6153824784
1444614.0381635975
1493167.5512652590
1536093.8467158445
1572474.2624475475
1574288.0335442195
1581678.4089346605
1607408.4697646280
1613328.8113572519
1627454.0430815452
1655338.7233343192
1668595.1498499526
1676773.5069362381
1677041.1501664616
1706199.7091522122
1717170.7325581233
1730865.8857828441
1739185.6417988339
1766211.8575237576
1788873.5659424922
1790461.4302221148
1832746.6709228981
1845803.4216408728
1881056.5708385955
1882891.1942887897
1894733.4475939447
1927473.5473152507
1930951.1042348154
1933629.8612777946
1935706.2469501287
1947409.1939782091
1951926.5035164256
1952518.4421988208
1961698.6630150303
2008350.4389402699
2023891.7979970018
2039179.7218079866
2062713.4006549189
1565944.2403531565
1683135.7204561691
1701036.7762199410
1736811.0099185946
1804942.4304035440
1842685.0275380592
1904312.5578123224
1905669.9634464574
1911613.9628018306
1916232.2044487343
1946103.9953128236
1961376.9468264317
1974627.5712881901
2007362.2149327588
2034349.2195692243
1900950.0040962720
2040396.6725159529
2065953.3629381605
2080579.7444739445
2081705

2025-01-16 10:07:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 10:07:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 10:07:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 10:07:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 16
2025-01-16 10:07:18 - snowflake.connector.connection - INFO - closed
2025-01-16 10:07:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 10:07:18 - root - INFO - SQL:
-- 8. Explore EVENT_NAMES on January 1, 2021
SELECT DISTINCT "EVENT_NAME"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
LIMIT 1000
Results:
EVENT_NAME
first_visit
page_view
session_start
user_engagement
scroll
view_item
add_shipping_info
add_payment_info
view_search_results
select_promotion
click
select_item
add_to_cart
view_promotion
begin_checkout
purchase

2025-01-16 10:07:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 10:07:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 10:07:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 10:07:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 16
2025-01-16 10:07:19 - snowflake.connector.connection - INFO - closed
2025-01-16 10:07:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 10:07:20 - root - INFO - SQL:
-- 9. Get count of events per EVENT_NAME on January 1, 2021
SELECT "EVENT_NAME", COUNT(*) AS "event_count"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
GROUP BY "EVENT_NAME"
LIMIT 1000
Results:
EVENT_NAME,event_count
first_visit,1916
page_view,7906
session_start,2289
user_engagement,4618
scroll,2113
view_item,1498
add_shipping_info,54
add_payment_info,33
view_search_results,149
select_promotion,63
click,2
select_item,186
add_to_cart,295
view_promotion,798
begin_checkout,162
purchase,14

2025-01-16 10:07:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 10:07:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 10:07:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 10:07:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 10:07:21 - snowflake.connector.connection - INFO - closed
2025-01-16 10:07:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 10:07:22 - root - INFO - SQL:
-- 10. Explore EVENT_PARAMS keys and values on January 1, 2021
SELECT t."EVENT_NAME", f.value:"key"::STRING AS "param_key", f.value:"value"::STRING AS "param_value"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101" t,
LATERAL FLATTEN(input => t."EVENT_PARAMS") f
LIMIT 1000
Results:
Too long, hard cut:
EVENT_NAME,param_key,param_value
first_visit,ga_session_number,"{""int_value"":1}"
first_visit,ga_session_id,"{""int_value"":3209612510}"
first_visit,page_referrer,
first_visit,page_location,"{""string_value"":""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""}"
first_visit,page_title,"{""string_value"":""Google Dino Game Tee""}"
first_visit,session_engaged,"{""int_value"":1}"
first_visit,engaged_session_event,"{""int_value"":1}"
page_view,page_location,"{""string_value"":""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""}"
page_view,entrances,"{""int_value"":1}"
page_view,medium,"{""string_value"":""organic""}"
page_view,campaign,"{""string_value"":""(organic)""}"
page_view,source,"{""string_value"":""google""}"
page_view,page_title,"{""string_value"":""Google Dino Game Tee""}"
page_view,engaged_session_event,"{""int_value"":1}"
page_view,page_referrer,
page_view,term,"{""string_value"":""<obfuscated>""}"
page_view,session_engaged,"{""string_value"":""0""}"
page_view,ga_session_number,"{""int_value"":1}"
page_view,all_data,
page_view,clean_event,"{""string_value"":""gtm.js""}"
page_view,debug_mode,"{""int_value"":1}"
page_view,ga_session_id,"{""int_value"":3209612510}"
session_start,ga_session_number,"{""int_value"":1}"
session_start,engaged_session_event,"{""int_value"":1}"
session_start,ga_session_id,"{""int_value"":3209612510}"
session_start,page_location,"{""string_value"":""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""}"
session_start,page_title,"{""string_value"":""Google Dino Game Tee""}"
session_start,page_referrer,
user_engagement,engaged_session_event,"{""int_value"":1}"
user_engagement,ga_session_number,"{""int_value"":1}"
user_engagement,page_title,"{""string_value"":""Google Dino Game Tee""}"
user_engagement,debug_mode,"{""int_value"":1}"
user_engagement,engagement_time_msec,"{""int_value"":2075}"
user_engagement,session_engaged,"{""string_value"":""1""}"
user_engagement,page_location,"{""string_value"":""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""}"
user_engagement,ga_session_id,"{""int_value"":3209612510}"
user_engagement,page_referrer,
page_view,ga_session_id,"{""int_value"":3209612510}"
page_view,ga_session_number,"{""int_value"":1}"
page_view,engagement_time_msec,"{""int_value"":9}"
page_view,debug_mode,"{""int_value"":1}"
page_view,engaged_session_event,"{""int_value"":1}"
page_view,page_title,"{""string_value"":""Google Dino Game Tee""}"
page_view,page_location,"{""string_value"":""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""}"
page_view,session_engaged,"{""string_value"":""1""}"
page_view,page_referrer,
scroll,page_referrer,"{""string_value"":""https://shop.googlemerchandisestore.com/Google+Redesign/New?""}"
scroll,page_location,"{""string_value"":""https://shop.googlemerchandisestore.com/Google+Redesign/Campus+Collection/Google+Sunnyvale+Campus+Bottle""}"
scroll,engagement_time_msec,"{""int_value"":15567}"
scroll,page_title,"{""string_value"":""Google Sunnyvale Campus Bottle""}"
scroll,session_engaged,"{""string_value"":""1""}"
scroll,ga_session_number,"{""int_value"":1}"
scroll,ga_session_id,"{""int_value"":7473279052}"
scroll,debug_mode,"{""int_value"":1}"
scroll,engaged_session_event,"{""int_value"":1}"
scroll,percent_scrolled,"{""int_value"":90}"
user_engagement,campaign,"{""string_value"":""<Other>""}"
user_engagement,medium,"{""string_value"":""<Other>""}"
user_engagement,session_engaged,"{""string_value"":""1""}"
user_engagement,page_location,"{""string_value"":""https://shop.googlemerchandisestore.com/Google+Redesign/Lifestyle/Fun/Malibu+Sunglasses.axd""}"
user_engagement,ga_session_number,"{""int_value"":1}"
user_engagement,ga_session_id,"{""int_value"":7473279052}"
user_engagement,debug_mode,"{""int_value"":1}"
user_engagement,page_referrer,
user_engagement,engagement_time_msec,"{""int_value"":21900}"
user_engagement,source,"{""string_value"":""<Other>""}"
user_engagement,engaged_session_event,"{""int_value"":1}"
user_engagement,page_title,"{""string_value"":""The Google Merchandise Store/Malibu Sunglasses""}"
page_view,engaged_session_event,"{""int_value"":1}"
page_view,ga_session_id,"{""int_value"":7473279052}"
page_view,session_engaged,"{""string_value"":""1""}"
page_view,page_title,"{""string_value"":""Home""}"
page_view,ga_session_number,"{""int_value"":1}"
page_view,debug_mode,"{""int_value"":1}"
page_view,engagement_time_msec,"{""int_value"":7}"
page_view,page_location,"{""string_value"":""https://shop.googlemerchandisestore.com/""}"
user_engagement,campaign,"{""string_value"":""<Other>""}"
user_engagement,engaged_session_event,"{""int_value"":1}"
user_engagement,engagement_time_msec,"{""int_value"":6603}"
user_engagement,session_engaged,"{""string_value"":""1""}"
user_engagement,medium,"{""string_value"":""<Other>""}"
user_engagement,ga_session_id,"{""int_value"":74732

2025-01-16 10:07:22 - root - INFO - itercount: 0
2025-01-16 10:07:22 - root - INFO - Database Name: GA4
Schema Name: GA4_OBFUSCATED_SAMPLE_ECOMMERCE
DDL describes table information.
,0
table_name,EVENTS_20201104
description,
DDL,"create or replace TABLE EVENTS_20201104 (
	EVENT_DATE VARCHAR(16777216),
	EVENT_TIMESTAMP NUMBER(38,0),
	EVENT_NAME VARCHAR(16777216),
	EVENT_PARAMS VARIANT,
	EVENT_PREVIOUS_TIMESTAMP NUMBER(38,0),
	EVENT_VALUE_IN_USD FLOAT,
	EVENT_BUNDLE_SEQUENCE_ID NUMBER(38,0),
	EVENT_SERVER_TIMESTAMP_OFFSET NUMBER(38,0),
	USER_ID VARCHAR(16777216),
	USER_PSEUDO_ID VARCHAR(16777216),
	PRIVACY_INFO VARIANT,
	USER_PROPERTIES VARIANT,
	USER_FIRST_TOUCH_TIMESTAMP NUMBER(38,0),
	USER_LTV VARIANT,
	DEVICE VARIANT,
	GEO VARIANT,
	APP_INFO VARIANT,
	TRAFFIC_SOURCE VARIANT,
	STREAM_ID NUMBER(38,0),
	PLATFORM VARCHAR(16777216),
	EVENT_DIMENSIONS VARIANT,
	ECOMMERCE VARIANT,
	ITEMS VARIANT
);"

Some other tables have the similar structure: ['EVENTS_20201104', 'EVENTS_20201108', 'EVENTS_20201114', 'EVENTS_20201116', 'EVENTS_20201204', 'EVENTS_20201207', 'EVENTS_20201211', 'EVENTS_20201220', 'EVENTS_20201115', 'EVENTS_20201208', 'EVENTS_20201223', 'EVENTS_20210103', 'EVENTS_20210114', 'EVENTS_20210122', 'EVENTS_20210123', 'EVENTS_20210126', 'EVENTS_20201212', 'EVENTS_20210107', 'EVENTS_20201101', 'EVENTS_20201103', 'EVENTS_20201105', 'EVENTS_20201119', 'EVENTS_20201128', 'EVENTS_20201202', 'EVENTS_20201203', 'EVENTS_20201206', 'EVENTS_20201210', 'EVENTS_20201216', 'EVENTS_20201218', 'EVENTS_20201224', 'EVENTS_20201227', 'EVENTS_20201228', 'EVENTS_20210118', 'EVENTS_20210130', 'EVENTS_20201214', 'EVENTS_20201215', 'EVENTS_20201222', 'EVENTS_20201231', 'EVENTS_20210109', 'EVENTS_20210115', 'EVENTS_20210116', 'EVENTS_20210105', 'EVENTS_20210119', 'EVENTS_20210120', 'EVENTS_20201118', 'EVENTS_20201219', 'EVENTS_20210127', 'EVENTS_20210106', 'EVENTS_20210108', 'EVENTS_20210124', 'EVENTS_20201106', 'EVENTS_20201110', 'EVENTS_20201117', 'EVENTS_20201121', 'EVENTS_20201125', 'EVENTS_20201201', 'EVENTS_20201213', 'EVENTS_20201217', 'EVENTS_20201226', 'EVENTS_20210121', 'EVENTS_20201124', 'EVENTS_20201126', 'EVENTS_20201127', 'EVENTS_20201230', 'EVENTS_20210110', 'EVENTS_20210112', 'EVENTS_20210129', 'EVENTS_20201205', 'EVENTS_20201221', 'EVENTS_20210125', 'EVENTS_20201102', 'EVENTS_20201107', 'EVENTS_20201109', 'EVENTS_20201111', 'EVENTS_20201112', 'EVENTS_20201113', 'EVENTS_20201120', 'EVENTS_20201122', 'EVENTS_20201225', 'EVENTS_20210102', 'EVENTS_20201123', 'EVENTS_20201129', 'EVENTS_20201209', 'EVENTS_20210101', 'EVENTS_20210111', 'EVENTS_20210117', 'EVENTS_20210128', 'EVENTS_20210131', 'EVENTS_20201130', 'EVENTS_20201229', 'EVENTS_20210104', 'EVENTS_20210113']
External knowledge that might be helpful: 
# GA4 - BigQuery Export schema

This article explains the format and schema of the Google Analytics 4 property data and the Google Analytics for Firebase data that is exported to BigQuery.

## Datasets

For each Google Analytics 4 property and each Firebase project that is linked to BigQuery, a single dataset named "analytics_<property_id>" is added to your BigQuery project. Property ID refers to your Analytics Property ID, which you can find in the property settings for your Google Analytics 4 property, and in App Analytics Settings in Firebase. Each Google Analytics 4 property and each app for which BigQuery exporting is enabled will export its data to that single dataset.

## Tables

Within each dataset, a table named `events_YYYYMMDD` is created each day if the Daily export option is enabled.

If the Streaming export option is enabled, a table named`events_intraday_YYYYMMDD`is created. This table is populated continuously as events are recorded throughout the day. This table is deleted at the end of each day once `events_YYYYMMDD` is complete.

Not all devices on which events are triggered send their data to Analytics on the same day the events are triggered. To account for this latency, Analytics will update the daily tables (`events_YYYYMMDD`) with events for those dates for up to three days after the dates of the events. Events will have the correct time stamp regardless of arriving late. Events that arrive after that three-day window are not recorded.

## Columns

Each column in the `events_YYYYMMDD`table represents an event-specific parameter. Note that some parameters are nested within RECORDS, and some RECORDS such as
`[items](https://support.google.com/analytics/answer/7029846?hl=en&ref_topic=9359001&sjid=16041154979191290935-EU#items)`
and
`[event_params](https://support.google.com/analytics/answer/7029846?hl=en&ref_topic=9359001&sjid=16041154979191290935-EU#event_params)`
are repeatable. Table columns are described below.

### event

The event fields contain information that uniquely identifies an event.

| Field name | Data type | Description |
|---|---|---|
| batch_event_index | INTEGER | A number indicating the sequential order of each event within a batch based on their order of occurrence on the device. |
| batch_ordering_id | INTEGER | A monotonically increasing number that is incremented each time a network request is sent from a given page. |
| batch_page_id | INTEGER | A sequential number assigned to a page that increases for each subsequent page within an engagement. |
| event_date | STRING | The date when the event was logged (YYYYMMDD format in the registered timezone of your app). |
| event_timestamp | INTEGER | The time (in microseconds, UTC) when the event was logged on the client. |
| event_previous_timestamp | INTEGER | The time (in microseconds, UTC) when the event was previously logged on the client. |
| event_name | STRING | The name of the event. |
| event_value_in_usd | FLOAT | The currency-converted value (in USD) of the event's "value" parameter. |
| event_bundle_sequence_id | INTEGER | The sequential ID of the bundle in which these events were uploaded. |
| event_server_timestamp_offset | INTEGER | Timestamp offset between collection time and upload time in micros. |

#### event_params RECORD

The event_params RECORD can store campaign-level and contextual event parameters as well as any user-defined event parameters. The event_params RECORD is repeated for each key that is associated with an event. The set of parameters stored in the event_params RECORD is unique to each implementation. To see the complete list of event parameters for your implementation, query the event parameter list.

| Field name | Data type | Description |
|---|---|---|
| event_params.key | STRING | The name of the event parameter. |
| event_params.value | RECORD | A record containing the event parameter's value. |
| event_params.value.string_value | STRING | If the event parameter is represented by a string, such as a URL or campaign name, it is populated in this field. |
| event_params.value.int_value | INTEGER | If the event parameter is represented by an integer, it is populated in this field. |
| event_params.value.double_value | FLOAT | If the event parameter is represented by a double value, it is populated in this field. |
| event_params.value.float_value | FLOAT | If the event parameter is represented by a floating point value, it is populated in this field. This field is not currently in use. |

#### item_params RECORD

The item_params RECORD can store item parameters as well as any user-defined item parameters. The set of parameters stored in the item_params RECORD is unique to each implementation.

| Field name | Data type | Description |
|---|---|---|
| item_params.key | STRING | The name of the item parameter. |
| item_params.value | RECORD | A record containing the item parameters value. |
| item_params.value.string_value | STRING | If the item parameter is represented by a string, it is populated in this field. |
| item_params.value.int_value | INTEGER | If the item parameter is represented by an integer, it is populated in this field. |
| item_params.value.double_value | FLOAT | If the item parameter is represented by a double value, it is populated in this field. |
| item_params.value.float_value | FLOAT | If the item parameter is represented by a floating point value, it is populated in this field. | 

### user

The user fields contain information that uniquely identifies the user associated with the event.

| Field name | Data type | Description |
|---|---|---|
| is_active_user | BOOLEAN | Whether the user was active (True) or inactive (False) at any point in the calendar day Included in only the daily tables ( events_YYYYMMDD) . |
| user_id | STRING | The unique ID assigned to a user. |
| user_pseudo_id | STRING | The pseudonymous id (e.g., app instance ID) for the user. |
| user_first_touch_timestamp | INTEGER | The time (in microseconds) at which the user first opened the app or visited the site. |

#### privacy_info fields

The privacy_info fields contain information based on the consent status of a user when consent mode is enabled .

| Field name | Data type | Description |
|---|---|---|
| privacy_info.ads_storage | STRING | Whether ad targeting is enabled for a user. Possible values: Yes, No, Unset |
| privacy_info.analytics_storage | STRING | Whether Analytics storage is enabled for the user. Possible values: Yes, No, Unset |
| privacy_info.uses_transient_token | STRING | Whether a web user has denied Analytics storage and the developer has enabled measurement without cookies based on transient tokens in server data. Possible values: Yes, No, Unset |

#### user_properties RECORD

The user_properties RECORD contains any user properties that you have set. It is repeated for each key that is associated with a user.

| Field name | Data type | Description |
|---|---|---|
| user_properties.key | STRING | The name of the user property. |
| user_properties.value | RECORD | A record for the user property value. |
| user_properties.value.string_value | STRING | The string value of the user property. |
| user_properties.value.int_value | INTEGER | The integer value of the user property. |
| user_properties.value.double_value | FLOAT | The double value of the user property. |
| user_properties.value.float_value | FLOAT | This field is currently unused. |
| user_properties.value.set_timestamp_micros | INTEGER | The time (in microseconds) at which the user property was last set. |

#### user_ltv RECORD

The user_ltv RECORD contains Lifetime Value information about the user. This RECORD is not populated in intraday tables.

| Field name | Data type | Description |
|---|---|---|
| user_ltv.revenue | FLOAT | The Lifetime Value (revenue) of the user. This field is not populated in intraday tables. |
| user_ltv.currency | STRING | The Lifetime Value (currency) of the user. This field is not populated in intraday tables. | 

### device

The device RECORD contains information about the device from which the event originated.

| Field name | Data type | Description |
|---|---|---|
| device.category | STRING | The device category (mobile, tablet, desktop). |
| device.mobile_brand_name | STRING | The device brand name. |
| device.mobile_model_name | STRING | The device model name. |
| device.mobile_marketing_name | STRING | The device marketing name. |
| device.mobile_os_hardware_model | STRING | The device model information retrieved directly from the operating system. |
| device.operating_system | STRING | The operating system of the device. |
| device.operating_system_version | STRING | The OS version. |
| device.vendor_id | STRING | IDFV (present only if IDFA is not collected). |
| device.advertising_id | STRING | Advertising ID/IDFA. |
| device.language | STRING | The OS language. |
| device.time_zone_offset_seconds | INTEGER | The offset from GMT in seconds. |
| device.is_limited_ad_tracking | BOOLEAN | The device's Limit Ad Tracking setting. On iOS14+, returns false if the IDFA is non-zero. |
| device.web_info.browser | STRING | The browser in which the user viewed content. |
| device.web_info.browser_version | STRING | The version of the browser in which the user viewed content. |
| device.web_info.hostname | STRING | The hostname associated with the logged event. | 

### geo

The geo RECORD contains information about the geographic location where the event was initiated.

| Field name | Data type | Description |
|---|---|---|
| geo.continent | STRING | The continent from which events were reported, based on IP address. |
| geo.sub_continent | STRING | The subcontinent from which events were reported, based on IP address. |
| geo.country | STRING | The country from which events were reported, based on IP address. |
| geo.region | STRING | The region from which events were reported, based on IP address. |
| geo.metro | STRING | The metro from which events were reported, based on IP address. |
| geo.city | STRING | The city from which events were reported, based on IP address. | 

### app_info

The app_info RECORD contains information about the app in which the event was initiated. | Field name | Data type | Description |
|---|---|---|
| app_info.id | STRING | The package name or bundle ID of the app. |
| app_info.firebase_app_id | STRING | The Firebase App ID associated with the app |
| app_info.install_source | STRING | The store that installed the app. |
| app_info.version | STRING | The app's versionName (Android) or short bundle version. | 

### collected_traffic_source

The collected_traffic_source RECORD contains the traffic source data that was collected with the event.

| Field name | Data type | Description |
|---|---|---|
| manual_campaign_id | STRING | The manual campaign id (utm_id) that was collected with the event. |
| manual_campaign_name | STRING | The manual campaign name (utm_campaign) that was collected with the event. |
| manual_source | STRING | The manual campaign source (utm_source) that was collected with the event. Also includes parsed parameters from referral params, not just UTM values. |
| manual_medium | STRING | The manual campaign medium (utm_medium) that was collected with the event. Also includes parsed parameters from referral params, not just UTM values. |
| manual_term | STRING | The manual campaign keyword/term (utm_term) that was collected with the event. |
| manual_content | STRING | The additional manual campaign metadata (utm_content) that was collected with the event. |
| manual_creative_format | STRING | The manual campaign creative format (utm_creative_format) that was collected with the event. |
| manual_marketing_tactic | STRING | The manual campaign marketing tactic (utm_marketing_tactic) that was collected with the event. |
| manual_source_platform | STRING | The manual campaign source platform (utm_source_platform) that was collected with the event. |
| gclid | STRING | The Google click identifier that was collected with the event. |
| dclid | STRING | The DoubleClick Click Identifier for Display and Video 360 and Campaign Manager 360 that was collected with the event. |
| srsltid | STRING | The Google Merchant Center identifier that was collected with the event. | 

### session_traffic_source_last_click

The session_traffic_source_last_click RECORD contains the last-click attributed session traffic source data across Google ads and manual contexts, where available.

| Field Name | Data Type | Description |
|---|---|---|
| session_traffic_source_last_click. manual_campaign.campaign_id | STRING | The ID of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.campaign_name | STRING | The name of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.medium | STRING | The medium of the last clicked manual campaign (e.g., paid search, organic search, email) |
| session_traffic_source_last_click. manual_campaign.term | STRING | The keyword/search term of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.content | STRING | Additional metadata of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.source_platform | STRING | The platform of the last clicked manual campaign (e.g., search engine, social media) |
| session_traffic_source_last_click. manual_campaign.source | STRING | The specific source within the platform of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.creative_format | STRING | The format of the creative of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.marketing_tactic | STRING | The marketing tactic of the last clicked manual campaign |
| session_traffic_source_last_click. google_ads_campaign.customer_id | STRING | The customer ID associated with the Google Ads account |
| session_traffic_source_last_click. google_ads_campaign.account_name | STRING | The name of the Google Ads account |
| session_traffic_source_last_click. google_ads_campaign.campaign_id | STRING | The ID of the Google Ads campaign |
| session_traffic_source_last_click. google_ads_campaign.campaign_name | STRING | The name of the Google Ads campaign |
| session_traffic_source_last_click. google_ads_campaign.ad_group_id | STRING | The ID of the ad group within the Google Ads campaign |
| session_traffic_source_last_click. google_ads_campaign.ad_group_name | STRING | The name of the ad group within the Google Ads campaign | 

### traffic_source

The traffic_source RECORD contains information about the traffic source that first acquired the user. This record is not populated in intraday tables. Note: The traffic_source values do not change if the user interacts with subsequent campaigns after installation.

| Field name | Data type | Description |
|---|---|---|
| traffic_source.name | STRING | Name of the marketing campaign that first acquired the user. This field is not populated in intraday tables. |
| traffic_source.medium | STRING | Name of the medium (paid search, organic search, email, etc.) that first acquired the user. This field is not populated in intraday tables. |
| traffic_source.source | STRING | Name of the network that first acquired the user. This field is not populated in intraday tables. | 

### stream and platform

The stream and platform fields contain information about the stream and the app platform.

| Field name | Data type | Description |
|---|---|---|
| stream_id | STRING | The numeric ID of the data stream from which the event originated. |
| platform | STRING | The data stream platform (Web, IOS or Android) from which the event originated. | 

### ecommerce

This ecommerce RECORD contains information about any ecommerce events that have been setup on a website or app.

| Field name | Data type | Description |
|---|---|---|
| ecommerce.total_item_quantity | INTEGER | Total number of items in this event, which is the sum of items.quantity. |
| ecommerce.purchase_revenue_in_usd | FLOAT | Purchase revenue of this event, represented in USD with standard unit. Populated for purchase event only. |
| ecommerce.purchase_revenue | FLOAT | Purchase revenue of this event, represented in local currency with standard unit. Populated for purchase event only. |
| ecommerce.refund_value_in_usd | FLOAT | The amount of refund in this event, represented in USD with standard unit. Populated for refund event only. |
| ecommerce.refund_value | FLOAT | The amount of refund in this event, represented in local currency with standard unit. Populated for refund event only. |
| ecommerce.shipping_value_in_usd | FLOAT | The shipping cost in this event, represented in USD with standard unit. |
| ecommerce.shipping_value | FLOAT | The shipping cost in this event, represented in local currency. |
| ecommerce.tax_value_in_usd | FLOAT | The tax value in this event, represented in USD with standard unit. |
| ecommerce.tax_value | FLOAT | The tax value in this event, represented in local currency with standard unit. |
| ecommerce.transaction_id | STRING | The transaction ID of the ecommerce transaction. |
| ecommerce.unique_items | INTEGER | The number of unique items in this event, based on item_id, item_name, and item_brand. | 

### items

The items RECORD contains information about items included in an event. It is repeated for each item.

| Field name | Data type | Description |
|---|---|---|
| items.item_id | STRING | The ID of the item. |
| items.item_name | STRING | The name of the item. |
| items.item_brand | STRING | The brand of the item. |
| items.item_variant | STRING | The variant of the item. |
| items.item_category | STRING | The category of the item. |
| items.item_category2 | STRING | The sub category of the item. |
| items.item_category3 | STRING | The sub category of the item. |
| items.item_category4 | STRING | The sub category of the item. |
| items.item_category5 | STRING | The sub category of the item. |
| items.price_in_usd | FLOAT | The price of the item, in USD with standard unit. |
| items.price | FLOAT | The price of the item in local currency. |
| items.quantity | INTEGER | The quantity of the item. Quantity set to 1 if not specified. |
| items.item_revenue_in_usd | FLOAT | The revenue of this item, calculated as price_in_usd * quantity. It is populated for purchase events only, in USD with standard unit. |
| items.item_revenue | FLOAT | The revenue of this item, calculated as price * quantity. It is populated for purchase events only, in local currency with standard unit. |
| items.item_refund_in_usd | FLOAT | The refund value of this item, calculated as price_in_usd * quantity. It is populated for refund events only, in USD with standard unit. |
| items.item_refund | FLOAT | The refund value of this item, calculated as price * quantity. It is populated for refund events only, in local currency with standard unit. |
| items.coupon | STRING | Coupon code applied to this item. |
| items.affiliation | STRING | A product affiliation to designate a supplying company or brick and mortar store location. |
| items.location_id | STRING | The location associated with the item. |
| items.item_list_id | STRING | The ID of the list in which the item was presented to the user. |
| items.item_list_name | STRING | The name of the list in which the item was presented to the user. |
| Items.item_list_index | STRING | The position of the item in a list. |
| items.promotion_id | STRING | The ID of a product promotion. |
| items.promotion_name | STRING | The name of a product promotion. |
| items.creative_name | STRING | The name of a creative used in a promotional spot. |
| items.creative_slot | STRING | The name of a creative slot. |

#### item_params RECORD

The item_params RECORD stores the custom item parameters that you defined. Note that predefined item parameters like item_id, item_name etc, are not included here, instead they are exported as explicit fields. The set of parameters stored in the item_params RECORD is unique to each implementation. To learn more about ecommerce implementations and the Google Analytics 4 items array, see Measure ecommerce .

| Field name | Data type | Description |
|---|---|---|
| items.item_params.key | STRING | The name of the item parameter. |
| items.item_params.value | RECORD | A record containing the item parameters value. |
| items.item_params.value.string_value | STRING | If the item parameter is represented by a string, it is populated in this field. |
| items.item_params.value.int_value | INTEGER | If the item parameter is represented by an integer, it is populated in this field. |
| items.item_params.value.double_value | FLOAT | If the item parameter is represented by a double value, it is populated in this field. |
| items.item_params.value.float_value | FLOAT | If the item parameter is represented by a floating point value, it is populated in this field. | 

## Rows

Data for a single event may be represented in one or multiple rows, depending on whether it contains repeated RECORDS. A `page_view` event with multiple
`[event_params](https://support.google.com/analytics/answer/7029846?hl=en&ref_topic=9359001&sjid=16041154979191290935-EU#event_params)`,
for example, would look similar to the following table. The initial row contains the event name, date, timestamp and other non-repeated data items. The
`[event_params](https://support.google.com/analytics/answer/7029846?hl=en&ref_topic=9359001&sjid=16041154979191290935-EU#event_params)`
RECORD is repeated for each parameter associated with the event. These repeated RECORDS are populated in subsequent rows directly under the initial event row.

| event_date | event_timestamp | event_name | event_params.key | event_params_value.string_value |
|---|---|---|---|---|
| 20220222 | 1643673600483790 | page_view | page_location | https://example.com |
| - | - | - | page_title | Home |
| - | - | - | medium | referral |
| - | - | - | source | google |
| - | - | - | page_referrer | https://www.google.com |
| - | - | - | parameters... | values... |
The table structure information is ({database name: {schema name: {table name}}}): 
{'GA4': {'GA4_OBFUSCATED_SAMPLE_ECOMMERCE': ['EVENTS_20201101', 'EVENTS_20201102', 'EVENTS_20201103', 'EVENTS_20201104', 'EVENTS_20201105', 'EVENTS_20201106', 'EVENTS_20201107', 'EVENTS_20201108', 'EVENTS_20201109', 'EVENTS_20201110', 'EVENTS_20201111', 'EVENTS_20201112', 'EVENTS_20201113', 'EVENTS_20201114', 'EVENTS_20201115', 'EVENTS_20201116', 'EVENTS_20201117', 'EVENTS_20201118', 'EVENTS_20201119', 'EVENTS_20201120', 'EVENTS_20201121', 'EVENTS_20201122', 'EVENTS_20201123', 'EVENTS_20201124', 'EVENTS_20201125', 'EVENTS_20201126', 'EVENTS_20201127', 'EVENTS_20201128', 'EVENTS_20201129', 'EVENTS_20201130', 'EVENTS_20201201', 'EVENTS_20201202', 'EVENTS_20201203', 'EVENTS_20201204', 'EVENTS_20201205', 'EVENTS_20201206', 'EVENTS_20201207', 'EVENTS_20201208', 'EVENTS_20201209', 'EVENTS_20201210', 'EVENTS_20201211', 'EVENTS_20201212', 'EVENTS_20201213', 'EVENTS_20201214', 'EVENTS_20201215', 'EVENTS_20201216', 'EVENTS_20201217', 'EVENTS_20201218', 'EVENTS_20201219', 'EVENTS_20201220', 'EVENTS_20201221', 'EVENTS_20201222', 'EVENTS_20201223', 'EVENTS_20201224', 'EVENTS_20201225', 'EVENTS_20201226', 'EVENTS_20201227', 'EVENTS_20201228', 'EVENTS_20201229', 'EVENTS_20201230', 'EVENTS_20201231', 'EVENTS_20210101', 'EVENTS_20210102', 'EVENTS_20210103', 'EVENTS_20210104', 'EVENTS_20210105', 'EVENTS_20210106', 'EVENTS_20210107', 'EVENTS_20210108', 'EVENTS_20210109', 'EVENTS_20210110', 'EVENTS_20210111', 'EVENTS_20210112', 'EVENTS_20210113', 'EVENTS_20210114', 'EVENTS_20210115', 'EVENTS_20210116', 'EVENTS_20210117', 'EVENTS_20210118', 'EVENTS_20210119', 'EVENTS_20210120', 'EVENTS_20210121', 'EVENTS_20210122', 'EVENTS_20210123', 'EVENTS_20210124', 'EVENTS_20210125', 'EVENTS_20210126', 'EVENTS_20210127', 'EVENTS_20210128', 'EVENTS_20210129', 'EVENTS_20210130', 'EVENTS_20210131']}}
Begin Exploring Related Columns
**Relevant Columns and Potential Usage:**

- **"USER_PSEUDO_ID"**: Used to identify unique pseudo users.
- **"EVENT_DATE"**: Used to filter events by specific dates.
- **"EVENT_TIMESTAMP"**: Can be used to filter events within specific time ranges.
- **"EVENT_NAME"**: Could be used if we need to consider specific event types.

**Conditions that may be used:**

- Select events where **"EVENT_DATE"** is between `'20210101'` and `'20210105'` to find users active in the last 7 days excluding the last 2 days.
- Select events where **"EVENT_DATE"** is between `'20210106'` and `'20210107'` to find users active in the last 2 days.
- Compare user activity between these date ranges to identify users who were active in the first period but not in the second.

---

**SQL Queries:**

```sql
-- 1. Get distinct USER_PSEUDO_IDs from January 1, 2021
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
LIMIT 1000;

-- 2. Get distinct USER_PSEUDO_IDs from January 2, 2021
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
LIMIT 1000;

-- 3. Get distinct USER_PSEUDO_IDs from January 3, 2021
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
LIMIT 1000;

-- 4. Get distinct USER_PSEUDO_IDs from January 4, 2021
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
LIMIT 1000;

-- 5. Get distinct USER_PSEUDO_IDs from January 5, 2021
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
LIMIT 1000;

-- 6. Get distinct USER_PSEUDO_IDs from January 6, 2021
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
LIMIT 1000;

-- 7. Get distinct USER_PSEUDO_IDs from January 7, 2021
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
LIMIT 1000;

-- 8. Explore EVENT_NAMES on January 1, 2021
SELECT DISTINCT "EVENT_NAME"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
LIMIT 1000;

-- 9. Get count of events per EVENT_NAME on January 1, 2021
SELECT "EVENT_NAME", COUNT(*) AS "event_count"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
GROUP BY "EVENT_NAME"
LIMIT 1000;

-- 10. Explore EVENT_PARAMS keys and values on January 1, 2021
SELECT t."EVENT_NAME", f.value:"key"::STRING AS "param_key", f.value:"value"::STRING AS "param_value"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101" t,
LATERAL FLATTEN(input => t."EVENT_PARAMS") f
LIMIT 1000;
```

These queries will help in understanding the relevant data:

- Queries 1-7 retrieve unique pseudo user IDs for each day from January 1 to January 7, 2021.
- Query 8 lists the different event names that occurred on January 1, 2021.
- Query 9 counts how many times each event occurred on January 1, 2021.
- Query 10 explores the keys and values within the nested `"EVENT_PARAMS"` column for events on January 1, 2021.Query:
-- 1. Get distinct USER_PSEUDO_IDs from January 1, 2021
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
LIMIT 1000
Answer:
Too long, hard cut:
USER_PSEUDO_ID
1003046.9452926974
1023282.4639847710
1026043.4481623879
1026409.1551860912
1032138.1796039159
1037928.9294661675
1045950.7099606829
1051288.9523352374
1066655.6240997015
1080064.0071613184
1082746.7285674512
1097358.9593491100
1104313.9641823605
1112823.8475775772
1116587.1725520171
1127824.3503063268
1107198.5152483918
1134825.6533092350
1164648.0319944302
1168297.2853699605
1170405.4925804370
1178889.6850461952
1205590.2516186397
1218586.5350251990
1246063.3665874179
1259302.9069938124
1296701.2382814729
1269423.6724500672
1277765.6068129494
1308776.9803994658
1318624.9067804638
1320187.6719997668
1375005.2583322863
1382535.7283137323
1401649.9529464111
1422161.0871788362
1437260.5988606411
1448835.0934102497
1499810.5142637849
1543004.7243225422
1582390.8206269591
1674937.2501954408
1693134.9790437518
1707918.4797422153
1820733.6464417466
1912537.7440240268
1961265.4757052307
2019465.0056495205
2157133.5876722467
2329161.7120010083
2340587.9439563847
2411763.0850272555
2432374.8482039518
2501661.0331987453
2687473.9692412289
1677450.9117017807
2007867.8957787066
2304235.4728947355
2327547.5435328629
2417078.3361324500
2754697.4847843626
2916336.4829526738
4132154.7009329565
4233290.6269558513
1054372.6755770068
1064574.6224708641
1138692.0103796281
1160488.2375923167
1174066.6437027818
1188134.8498680538
1213932.4846099850
1215465.1474478000
1255322.2973246181
1211099.8247563235
1275797.1936238018
1326289.2331853598
1333091.0887566663
1352892.5937639189
1385112.5897617274
1396456.6482506733
1453555.6810069410
1453951.1387928223
1473136.1149103090
1501018.3808301483
1518831.1475327211
1539940.5253610440
1564015.6880680172
1616136.8949543878
1684301.4109152707
1713530.3382800695
1719564.6333875501
1734528.1974041204
1762263.6990880514
1784794.0627143380
1829763.3860332334
1884090.9722372635
1958116.3750166429
1967725.7354072666
1993768.0582544668
2077981.6202330137
2194957.7885097322
2228172.7936687802
2244553.9738621373
2247846.3358362547
2362829.7919429820
2378480.6534474606
2384902.1644296925
2492721.1881800375
2506075.7314444580
2539661.0024435471
2563982.7084295364
2589245.5979068367
2630765.5704087315
2691270.4995570828
2719657.8629194725
1503421.5168556763
1515646.3111272928
1688147.2939632391
1694910.7733232660
1745171.2191701968
1765594.3047173009
1859470.4546513665
1886250.8920156183
1990491.3893000361
2007362.2149327588
2041235.3400307589
2091407.8804833129
2168528.2202958861
2263288.5212004372
2275476.3701234224
2375215.3636092839
2376646.7974930863
2463849.3270043637
2484010.5620979211
2486846.9299481244
2560700.2802998477
2578870.7901059159
2627874.7977372146
2694084.5852510731
1846974.0316175078
2102395.6721696580
2290904.3176780756
2748139.1358063966
2755973.1582682668
2767600.1190297171
2776706.0228802998
2783014.3813479767
2795133.4288865632
2810822.2085903402
2838667.1045753224
2844832.0483599899
2856545.1057637132
2893808.1269182675
2938826.3390148112
2965622.6326568063
3022409.8765357635
3027107.9482352721
3055314.8442482614
3067110.2430706696
3071789.9352232891
3085295.3644476516
3149868.5539413842
3158627.0434170250
3168155.2539701733
3205524.3451816980
3351786.5083077372
3421870.5719723099
3431784.9519587791
3845835.1922317737
3849458.8298476645
3909413.6458295238
4097505.3094071156
4332118.8573405921
4471894.7657502115
4496026.4851166246
3160960.1631301259
3193679.0282666132
3307311.0640715369
4124604.0408794437
4283464.4359186905
4376829.5724821918
4902634.1944567521
5035963.1657420274
5807457.8598720960
5825139.4540388000
6153608.9737608054
6248139.1631749929
6417370.3822460993
6859607.1364502314
7186178.0486082027
7327139.4510255713
1240786.8917310160
1456890.1673716823
1459436.8826692932
1534689.9343310805
1619900.3195973863
1646722.0078157231
1680043.1145812114
1759212.2216007988
2029664.5317923957
2159725.7481437355
2268837.3082004933
2322051.0966144624
2344300.8375944627
2599362.6005762632
2613632.7561400432
2655279.4923479690
1485472.4390061373
1575061.4789497906
1620024.8966870933
1699037.5870634483
1729803.5105688857
1749246.8534368616
1958256.0896241884
1999213.1832096854
2044855.8624761839
2084772.9471491241
2142722.9676010623
2150276.2168438227
2167343.6164963557
2245992.8909040661
2264573.5209212671
2272023.1096248377
2311908.3797713386
2437853.8047077377
2438148.3441039719
2683925.9434937492
2688110.9777730450
2709449.6736747839
1745072.0004799132
1804199.2014328535
2382451.4611706340
2485922.5515109543
2489685.1683265365
2681967.7844689964
2712864.2294346749
2739425.0432989823
2746195.3557509904
2779137.7674526641
2795240.3198638943
2796100.1284437751
2803851.7451929280
2821509.2290888995
2839647.6325562515
2842598.5931018472
2873742.8991614203
2882177.0250975565
2885429.0157235569
2892944.4318946076
2908071.3197159392
2912682.3106786643
2913205.0530257308
2917194.9600461127
2917834.9881423689
2952066.5004557428
2979122.8002670631
3001110.3208062401
3007601.9537396348
3017509.1296773380
3028781.2091495833
3038064.1337656016
3059739.3349984598
3071174
Query:
-- 2. Get distinct USER_PSEUDO_IDs from January 2, 2021
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
LIMIT 1000
Answer:
Too long, hard cut:
USER_PSEUDO_ID
1005484.1092567297
1019468.5334749980
1020695.6921096883
1034552.3956022963
1035433.9962487028
1054184.5156674867
1055969.5872512303
1104189.1961360907
1134613.7634894426
1137060.9310088729
1140798.4477437179
1161350.5694934880
1164110.7921696016
1219168.5485233162
1250553.7197007147
1253534.6863073074
1254621.7726451069
1272248.3527408128
1274599.3928448053
1278408.9014565519
1293446.1816560362
1296701.2382814729
1299487.6744511638
1160488.2375923167
1246097.1442578537
1279602.6727600031
1314847.4544971351
1315049.1291069189
1325116.8912286004
1334700.6047036975
1359861.1338029424
1364085.2107948688
1370461.9318815596
1380837.6952136083
1381565.5047705405
1392466.8272664309
1440319.2684459003
1470601.3891204117
1482331.8123183039
1537916.6494875994
1595062.2978681339
1689822.6628262328
1708071.1093492535
1720808.5659233423
1722117.4481798918
1778028.3352091849
1849787.1417367270
1873058.4156402266
1442997.6750483462
1524258.4980135729
1664037.8368386837
1810164.8096235223
1821461.3337986263
1946567.8498627659
2003178.1919214406
2003410.3743325553
2047377.2903997635
2149555.4176497170
2152321.4561806737
2498852.6851889965
2482206.0801635150
2914301.0348640426
3821938.0718647672
4466520.4224380665
1127197.7845904071
1273851.7434031787
1239682.4582755521
1382535.7283137323
1390300.4796021112
1402138.5184246691
1405619.5662753913
1413270.7201714861
1505379.6854768255
1507645.2354095566
1508520.3631208357
1619900.3195973863
1621047.1809785712
1652787.4806754655
1653230.5444867771
1698322.2974178584
1746667.8607565392
1550647.9864364390
1587333.3490610470
1664926.0864851694
1688021.5951717579
1699537.8074625037
1704767.6168359047
1788337.3157672800
1862279.2644343817
1928081.8451007978
1695729.1971283274
1929880.8943789391
1941137.5727282147
1966814.1086113170
1977599.8253595252
1989653.0310679976
1997680.4430170613
2014468.4429759626
2017291.1955110057
2022577.6028076666
2038564.1352340774
2087721.6967658602
2096059.7363835654
2109449.9660162118
2113798.0518736192
2115313.5923151214
2116832.9143999021
2124015.0378908424
2181825.8993193032
2183606.6278528627
2198590.4966974374
2202427.5069899276
2221930.1797585103
2240072.6562005194
2274040.6741003102
2275111.4028372694
2296500.5827142601
2370322.3013967089
2371746.6281118505
2403131.1457037836
2404282.2391450101
2455077.3609833583
2483927.4346404473
2492165.4306556688
2492500.1425673190
2507095.9841079823
2525850.6494695512
2531897.1720965032
2570370.5558938997
2580777.6323298293
2651666.4560824658
2660973.0848806953
2698448.4947532775
2701141.9642091381
2717248.8441315841
2774129.5676429649
2796844.1147797199
2803531.7150631290
2805870.7332545870
2226580.8704433782
2347781.8032119000
2394410.3295052541
2525713.0322520707
2702859.5556545822
2790732.2996651984
2859541.0647797664
2873795.2188253405
2944116.9709140014
2968068.9503410251
2979175.6555658320
3050126.3100434060
3103397.8438223081
3123951.7267370052
3129575.4645330370
3139310.3136681064
3190332.9286711863
3196986.4506387348
3270169.3923260547
3283436.9703000993
3298802.6061854202
3304301.6034432720
3331204.4960601137
3337255.4062843031
3370614.1127721319
3389304.0761075079
3422562.1233739382
3479120.0780634379
3662682.2223793701
3669778.2150269612
3799320.4811100799
3862731.2442659104
3969440.1397711344
4169937.4332655341
4269330.6240990162
4517487.0123463007
4693069.0008342578
3212822.5265745510
3490206.3115945074
3868373.8552176049
4071735.7876058990
4507678.9235168640
4343363.3390393347
4916065.6816652712
5107791.4014664740
5194215.6175507718
5785112.8218902397
6358024.9360228635
6437781.4636468836
6708277.1224699368
6719737.4821468787
6790221.7492641384
1441065.6470414018
1587120.7886409442
1650186.4171427739
1721354.6818865235
1793640.9588973139
1804084.9503910975
1824121.5656787337
1661549.9249699570
1679710.5467997846
1684439.4801767659
1846974.0316175078
1946378.2604112351
1988973.6797776774
1990491.3893000361
2063626.9238065250
2100078.5164826353
2144124.6364405235
2197705.7004821624
2225774.7364227776
2253111.9586733581
2284553.4981188662
2301921.2057149746
2303142.6308475718
2314215.6504049440
2331461.5841279593
2336526.9274069819
2345583.2413952607
2350448.4141410843
2361377.9933199841
2430658.1327125161
2500745.7357943995
2508716.6266480416
2534054.9013465326
2536363.5033290586
2537006.1447313249
2537784.9601456696
2543713.9652701500
2593958.9228258081
2624672.3577974916
2633946.3497198473
2635200.0699795839
2655651.8460042132
2689155.5329072803
2729998.5888891394
2755212.7073417309
2826036.8165007769
2829836.1939432968
2846251.5565404014
2226624.7706208292
2235087.0942165188
2380241.2215017615
2520337.3364032237
2583358.3664829751
2586866.8291568544
2659583.1200764629
2684654.7272120586
2716352.9687101097
2757199.8307230870
2766451.6819922873
2841776.9997975452
2855379.6764009053
2916466.0256798553
2924834.5756001494
2926676.0612560137
2937600.0398319286
2952420.3520432233
2967255.9371191104
2977911.6545493734
2985689.3188605734
2989061.1420113322
3013251.7143326291
3024189
Query:
-- 3. Get distinct USER_PSEUDO_IDs from January 3, 2021
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
LIMIT 1000
Answer:
Too long, hard cut:
USER_PSEUDO_ID
1002909.5490808649
1005317.0661766703
1019755.1505990457
1040686.3843613593
1052352.6374592258
1063831.2287636950
1064723.3587773894
1078657.7431630909
1090942.3656035032
1100538.7303282538
1110565.1782268698
1113469.1950253831
1115892.5784150898
1122585.7488321709
1128307.8804338977
1160488.2375923167
1162127.7258009994
1193163.2977185902
1215085.1365476037
1227555.8440964013
1254635.4374785888
1281967.0612172650
1315804.4711170020
1323571.6093451149
1152407.0498719030
1252850.0331551815
1337333.7376655274
1161321.2837154002
1337545.1457768752
1346788.0845555279
1351515.4448203569
1367121.2892216686
1373665.5021657907
1380451.8811229172
1392466.8272664309
1396652.0099177607
1412894.3157340807
1469872.0658596547
1486145.0830518341
1499585.9084564597
1532892.3620003291
1537627.2287708814
1541674.7751153834
1542935.3233857088
1592849.2265519225
1682124.6448806669
1695754.0063712697
1411153.8126169951
1421827.9572513749
1572749.7611592304
1614191.8941227146
1812383.0910322447
1818576.4805267463
1881209.0076863006
1897533.7011168120
1945068.8887037343
2007133.2050607499
2025094.8458541150
2038619.5845722539
2041636.5714374787
2119739.1670732304
2280413.3644356777
2573743.1340578848
2826460.7594363371
1091029.8690027225
1150237.3795733230
1224962.9088243391
1273436.8995766746
1134613.7634894426
1158176.7649664163
1240998.2484233559
1272248.3527408128
1359122.4451792116
1364311.9400187078
1402138.5184246691
1421905.2876669825
1431100.3601536868
1447357.9474081641
1467491.0144424693
1479460.0711186525
1492257.1138270046
1493438.1834934820
1506421.3254179692
1514731.7040098386
1517389.5868953250
1524148.6665316369
1540840.8307652027
1543001.0061190370
1549534.8666555998
1559691.3070864144
1581352.9819384508
1676361.4249094214
1680228.3236339760
1701171.7891319767
1722821.4828861908
1441310.9435193216
1540189.8503303096
1594198.5163900495
1620024.8966870933
1638888.9196983491
1725061.6799620601
1778706.3695787213
1795348.7274570896
1828323.6363540243
1835098.8936415398
1836002.4464896869
1846974.0316175078
1855281.3848935817
1866502.0937824174
1904344.1246218075
1926942.7504502304
1975795.3885477150
1984981.1368985758
2013179.1961252046
2016350.2293248690
2021392.5582405639
2037226.9494356563
2051660.3699709133
2061051.4106233261
2074343.2529016722
2080113.4054405724
2080627.6433673015
2132082.0425871090
2149555.4176497170
2167556.5931244051
2230338.6447127604
2235087.0942165188
2244416.2131745073
2251697.6988530890
2261361.1024090855
2264647.0487709418
2268811.3293751715
2293327.7085879362
2324895.1791131968
2331220.0924408261
2415858.4972221670
2429545.0739470755
2537784.9601456696
2550346.0240459466
2553007.7989629504
2594994.9553538392
2636714.6150733575
2676710.1116599974
2745163.0287640909
2755125.1317028746
2790457.4820504680
2175748.6632446476
2369117.0306760559
2452944.6891191369
2490320.0019887642
2513182.3165081489
2577015.7109497692
2622344.4282271889
2752584.3486742258
2773889.3043972604
2846692.8806198515
2856080.3703273863
2902982.6625267541
2914301.0348640426
2933389.9188626942
2963687.6828704107
3089324.8152427839
3097406.6896765026
3114951.7301878881
3141277.0508009875
3181855.4972976686
3189696.8513754654
3197448.9244429763
3328745.5456317568
3345685.1895997342
3377339.5089753849
3379611.0658210929
3456591.6309392992
3484580.9883519327
3587110.4310578340
3593045.4474754034
3729541.2879863814
3747998.9136824379
3785496.8643699837
3807842.5003018860
4076433.1925875378
4143683.1978506174
4526496.4812747154
3238899.1774806862
4708841.8269597203
4819501.9483311114
4857009.7277045305
5141791.6821581739
5311446.0799471986
5683791.6366649386
5791539.6874767478
1146873.1391018144
1276909.6538469251
1322015.5018667302
1349503.8334692563
1405673.2837970999
1481380.1920064669
1738826.5362245141
1520148.2433623014
1561053.3911726952
1605564.2171778452
1726193.3100477031
1739034.9012964285
1807272.4286827133
1807963.9006954889
1844179.1799405502
1914709.0568449387
1948683.3397099611
1988973.6797776774
2015735.0531195958
2039126.6383271583
2056616.0747926191
2073604.4967468975
2078465.2278288976
2116278.5223204033
2146786.6850366036
2152325.3380201742
2176615.6010852073
2265540.8008532129
2267646.6725590413
2295278.4688935985
2308373.3394347065
2367298.5991928738
2415629.6598683842
2430814.2764324500
2430928.8778009492
2437168.2728482016
2533249.2785094842
2554987.2869542845
2555082.4233289096
2563982.7084295364
2634677.3085257806
2658281.7873085687
2728671.5444484223
2737329.2443602937
2744962.6808165378
2794016.6440539861
2865307.6460813087
1979778.7331964605
2094642.2631508719
2160515.1902326402
2221181.9620961014
2275313.5266564172
2293260.7167260153
2345345.3780200574
2480908.6648549176
2730719.0820696621
2783233.8366408661
2784282.4789765642
2836065.8456107379
2840286.0273963646
2857035.9328090656
2885429.0157235569
2566092.9507111229
2887406.1792807548
2893336.6716596891
2927609.8749336065
2928524.5577316092
2964264.1652462823
2972608.8263112140
2983642.9311751419
3019547.6190207209
3048586
Query:
-- 4. Get distinct USER_PSEUDO_IDs from January 4, 2021
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
LIMIT 1000
Answer:
Too long, hard cut:
USER_PSEUDO_ID
1008499.5928445086
1013760.9231029745
1014209.5295344253
1026137.2290719007
1028167.1226079449
1032092.5249707229
1053193.3273260382
1057066.6724870774
1067841.4647153954
1081165.5314971225
1082690.0377265261
1109836.9501901728
1113469.1950253831
1114181.7368629788
1130810.6137694456
1158637.0383647084
1164741.6860607634
1181674.5265741661
1194575.2891034137
1214573.9183644653
1134613.7634894426
1121518.2859510925
1215389.2295507570
1222867.5284822262
1227012.8467411408
1238230.5582832258
1284535.4676055384
1289319.0865612371
1297488.8153560940
1299487.6744511638
1307038.3688504236
1312237.6155331000
1385090.1246142947
1401785.6584445113
1402228.3482241994
1445737.4102905419
1450787.9898569840
1470241.3611852177
1471187.8226858001
1493030.0825468207
1519189.6398973848
1607100.0381093527
1634789.3752037441
1243221.1777211525
1403129.5580554677
1458803.4123039458
1509456.3177418451
1590715.7165540392
1624884.8451928269
1732811.6786855240
1751599.1685077136
1765130.1889939374
1824201.1380052029
1891844.3029317015
1930569.1007455155
2164352.2670593278
2303928.3507051479
2388941.9518774856
2587147.0479569634
2630262.0012746307
2808285.4912615885
2933942.9058732953
3063778.7827149758
3232149.8018732656
1057265.5844727802
1065673.0722289663
1103286.8251708796
1075223.2681702246
1185078.3105419781
1252690.3944441209
1288248.9113459714
1309149.1848587742
1313329.6311058857
1314747.6066644573
1320284.3859724504
1325688.1519909745
1339205.5397897099
1373324.8357357420
1385662.1127085473
1488009.3142808321
1497130.5055593166
1500615.9964438412
1586022.1800460720
1590652.6726149736
1629639.2044968342
1334969.6157017719
1466910.4554610435
1504953.0746977838
1522857.5896662267
1544748.2905250855
1556885.1837167077
1588666.3949365829
1622235.9923526878
1656975.3346712388
1659842.4321850950
1665661.9122532614
1668416.2014466630
1690623.2302780540
1702845.7520261284
1703253.2388947937
1754331.3157951821
1757510.5330787128
1765047.7773329261
1770215.5966952525
1780294.0221405041
1787504.7670504282
1791921.4002592107
1807394.6792147711
1841613.4096590753
1857518.5760998088
1895574.3356492898
1901730.7277275021
1922936.0279129669
1945068.8887037343
1949104.1690663627
1950108.6469907871
1954953.0721200891
1966048.6599698958
1976029.4501496209
1983421.2936555498
1993697.9945930656
2002776.5976883193
2005618.5376901983
2014270.2546235318
2055215.4967663939
2094642.2631508719
2116278.5223204033
2167317.9816236215
2175416.5833910330
2192432.3542621657
2193948.2281082270
2200081.2420876058
2245385.0615539791
2248364.4469117960
2250793.6313697017
2258641.1629826733
2263380.7170574283
2265208.1282213045
2327460.3641621424
1711048.6268268364
1799135.7941835837
1842336.8436996882
1859470.4546513665
2203449.4497261194
2276075.8079921958
2277998.4131015438
2304235.4728947355
2349749.6508625488
2382234.3846802600
2415858.4972221670
2438902.8824385354
2440353.3206892115
2461015.7427876593
2507894.1372177453
2526912.7108743899
2536104.6818349493
2551167.3034654376
2551300.8505181236
2568488.0444965897
2599191.1809781484
2613732.0466667239
2614498.1516604416
2624431.4002749857
2632235.6933492055
2636673.7777856869
2637684.2664716834
2818493.7937628616
2882533.0281462726
2962062.5636750914
2977883.7344825123
3095151.5001822426
3124894.2857829744
3163846.4345628829
3314414.8482814192
3412220.6161181119
3429129.1766622829
3455493.8716820126
3458672.4067777996
3481366.0062791617
3522747.5222413884
3549371.4147860086
3314204.2967165973
3375221.1442572249
3796545.6803466963
3893846.7926490461
3945067.6189159317
4361543.5487737593
4708759.3565818280
5698867.7395543069
1536105.5891820566
1560589.3791460585
1588332.2823326217
1578948.0834575091
1632927.1894987991
1639296.9002795622
1648032.7331818100
1668023.4150976276
1672632.0859250572
1702019.9842929153
1707319.9934501562
1711971.4968010332
1726993.2463217900
1730497.6226428479
1745835.9106014489
1795540.6156637931
1808170.2762309629
1808232.5654454206
1855160.6431356491
1908860.5902672888
1934857.9616833097
2022577.6028076666
2049590.8596560881
2051318.3089832623
2079154.1476733507
2096766.0019470232
2121651.9176614852
2131056.2525081023
2131509.8375213648
2157825.0718936880
2172399.2091034226
2177957.7412962494
2197864.5182472083
2204878.2541228096
2214606.8300190111
2263420.2110121128
2284976.1899128869
2301413.0302404690
1843227.1315168145
1888732.5808117060
1979778.7331964605
1982815.8232892378
2147417.5961373356
2194441.0544343537
2248754.7783173763
2250953.6316204806
2262724.6807963688
2279457.7315196874
2329707.0387773385
2331461.5841279593
2333408.5403558380
2346000.3226235037
2374910.1217694068
2382887.9214525018
2392346.1836393196
2393556.1146578015
2399121.7379674359
2404535.1253227145
2415432.3160368774
2415788.3641983779
2417805.0150005257
2419732.5640450460
2422137.6877778640
2425570.7323199738
2430886.9385533523
2465015.1494457724
2467393.7377682212
2491439.4728767719
2501970.2707488768
2526432.6035949356
2546017.5150907817
2548737.2552051276
2558365.7246265443
2581316
Query:
-- 5. Get distinct USER_PSEUDO_IDs from January 5, 2021
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
LIMIT 1000
Answer:
Too long, hard cut:
USER_PSEUDO_ID
1006764.2593478041
1011730.5937310445
1025554.7155857902
1028337.8871283783
1031058.2518048614
1032606.3576924541
1056329.7612609650
1071257.2904972531
1075223.2681702246
1079374.1910653935
1082920.8892141550
1086535.4875940498
1087808.3711873816
1096553.1505774248
1102947.5096330985
1113194.4596973553
1124854.6111785259
1141770.2200021598
1153093.0119048067
1068701.3018406914
1117874.3324542795
1132555.2301002365
1133964.7947497780
1115003.4680616065
1160488.2375923167
1182923.0909175622
1187482.7824786316
1192643.6460701245
1203853.5073281021
1204844.2691721789
1215841.5184851096
1218242.9191016186
1225314.7220680786
1226878.4100446319
1241629.8724178917
1243376.8542545034
1247686.2070404262
1254011.7545907964
1258911.4567959870
1264993.3645153639
1274495.5184398589
1275384.3626297214
1284133.7579148747
1318068.2020052683
1186112.8377343718
1241220.1441674551
1272248.3527408128
1318879.8038263711
1321742.4551192896
1325482.4574108673
1325688.1519909745
1336694.6432583433
1379775.2562814073
1432451.2006018969
1499710.7075498493
1601062.3810646545
1620254.4260686044
1624184.5854197789
1634789.3752037441
1684159.4687183007
1691574.8292247705
1728565.2006018969
1790724.2394851163
1887643.2920418963
1089575.2761256602
1122855.4085911936
1129742.7402804867
1172217.8534916097
1197568.4892852272
1222409.1951536768
1260992.5282234785
1264306.5410019941
1276342.9126460945
1280266.1333397958
1285418.4651557245
1291228.5655196810
1292185.5593921414
1301862.0758294607
1304296.6040710271
1261100.0843906075
1278427.6141690556
1286945.3645505196
1306493.1469289903
1307038.3688504236
1309149.1848587742
1244606.6899321311
1307807.0071561878
1321029.7577861325
1326179.1742099424
1342157.7728855384
1345509.3936713223
1348068.1593058656
1399527.2790058720
1404886.4182310055
1414193.2963567157
1439687.4557873700
1455809.7208111760
1457888.4327764965
1460768.9286238752
1469643.2045997031
1474066.3112067437
1484308.7242312753
1490370.6853135246
1492265.2880623974
1493519.8322170424
1512868.5635891160
1529263.1215051275
1579480.5217830271
1598992.9833853976
1605958.5124385076
1624884.8451928269
1631157.7294829770
1643710.6184759313
1660273.8916953629
1668728.4457564716
1677656.0408442666
1678522.1728444321
1683135.7204561691
1689680.1758593934
1692783.8693710254
1701360.1955093195
1719948.6487524460
1730442.5913214469
1743537.3807228570
1769082.9639759569
1777640.6199182586
1801091.1241509207
1806270.7453025738
1903900.7465384771
1912465.1226265010
1915544.8129735440
1915861.2747686951
1944841.0469682976
1950108.6469907871
1951948.3958655417
1967071.8507920403
1973596.8847857907
1406007.4609789626
1535511.8717950286
1627793.7205729342
1674457.5024784341
1758063.1561647030
1815114.2194185357
1828683.2365695110
1921576.8040299290
1953961.4681289955
1929432.7626947942
1958026.2831982626
2028003.7547803636
2068054.9611310747
2092012.6174342505
2105669.6226949819
2109755.7685489728
2118611.8310815420
2125070.4400620233
2135694.1271960485
2165966.8215524686
2197864.5182472083
2201944.0699665555
2222452.9695157189
2238932.4005449023
2261700.6454970936
2312554.3356483680
2317618.6395077991
2323477.7085022522
2361948.8320917052
2379179.4251306058
2483928.9846569809
2490218.9350271294
2495859.0664008046
2534951.2425037201
2610798.7861805723
2623420.0664690811
2661860.2046532516
2662675.7949692171
2686485.2659740693
2705521.6524856404
2746901.7010168334
3008011.9598954692
3065109.3493355601
3084839.1075146820
2435294.1392236670
2705245.1520911278
2956829.8164724582
3212604.7959516553
3331491.6160080099
3455493.8716820126
3492112.6709159602
3784858.9917233650
4108792.0630353488
4718939.2279552414
1304588.7510213626
1352587.0117468163
1360671.0435504959
1487082.6524856404
1537312.2917195558
1564199.6125444442
1578274.5274788603
1604724.4234077225
1606235.3819045638
1620024.8966870933
1624589.6191841132
1638886.3189064831
1676773.5069362381
1677190.7248845737
1696108.9096256870
1699542.3955012593
1724873.0147071241
1738611.7151385455
1741134.3014269392
1748445.0250662291
1750371.7249808647
1752247.4003173929
1760816.4329690600
1775693.2061637855
1784392.5897601717
1814543.0883007631
1820584.9928114663
1827148.6871625424
1829646.8413644399
1845515.7457629065
1847031.8084425545
1863546.1943218811
1882711.8628729867
1897436.1791225377
1912292.1832297951
1938550.0034007429
1956174.7971081539
1957305.4611719510
1966814.2988882243
1969417.8912253448
1356010.8691002356
1397822.5235180436
1434548.8581092193
1455644.0190003959
1529884.1932366182
1624230.7368868695
1838825.9112970722
1858499.7282083599
1861628.8947054439
1887579.9697810740
1918525.1677638858
1927968.5861658781
1946071.4353177173
1954953.0721200891
1859470.4546513665
1941137.5727282147
1946008.0388629105
1983907.3611526882
1998068.4108860041
2022517.4263243587
2029332.3604728700
2040396.6725159529
2052993.4401507223
2062314.9246293593
2094636.6332384800
2101466.8177182409
2110137.4748876278
2110567.6072497635
2114984.3580023602
2116278.5223204033
2123018.8091748657
2133723
Query:
-- 6. Get distinct USER_PSEUDO_IDs from January 6, 2021
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
LIMIT 1000
Answer:
Too long, hard cut:
USER_PSEUDO_ID
1001303.4827739208
1014060.1100191558
1015239.8458513676
1023213.5350684501
1025773.0920505617
1033020.5841925327
1042140.6802444773
1045720.9269650087
1049106.9990499157
1049739.7909391395
1065322.6541302193
1072513.2161702512
1075240.7394043586
1075333.9269112947
1078788.8328338285
1081165.5314971225
1087271.0550084610
1095740.4839642689
1114964.3576383224
1118833.2974558782
1126378.6956818362
1069165.2811408476
1083792.6034832516
1086843.9052907013
1128261.6033595713
1128289.3662024583
1133313.1103337373
1144792.8191246270
1146837.4730107711
1151687.1996189042
1153093.0119048067
1163998.9977514528
1170673.0496256889
1173439.7311015929
1180762.6954492448
1214408.9886831537
1216128.7020381390
1243180.2889994882
1257670.9852008771
1218031.2772164166
1255130.2864074728
1278990.5126400811
1280885.4587684428
1304296.6040710271
1311409.7691253264
1324330.4963761152
1326729.2901375460
1328537.2795814770
1357835.0893556888
1369631.9406198523
1408865.7005954025
1442352.3658130118
1474912.2146834138
1524322.6852456903
1537642.0362746652
1390300.4796021112
1614669.6038310943
1624875.9469354174
1685163.0188672299
1760327.1126266238
1830571.5765734358
1921439.1124554416
2013775.7921697237
2369962.9052586610
1069494.0113686800
1084471.2677471598
1087808.3711873816
1115377.5526866793
1060274.1098179258
1086668.0925005810
1111626.7442894456
1130911.8567954377
1141870.4386338572
1148615.3691736909
1160488.2375923167
1169456.0744217795
1185502.9456478888
1185607.4529846208
1213730.2023854144
1214882.5762650867
1224512.5360000287
1230929.5891057900
1252675.9812778248
1253621.4143036992
1256871.5825332697
1270650.6052564575
1133962.3740970739
1177018.6074439798
1211099.8247563235
1285418.4651557245
1285421.1033375628
1295893.9741062295
1304912.9788917690
1306493.1469289903
1314525.6769250991
1324723.7882312578
1325005.1519738149
1358070.7682863119
1362293.0058255347
1366045.3922534826
1372261.7721304420
1374353.8427076075
1377886.1560338090
1380305.7377133735
1383476.9026182603
1388300.4678602079
1395824.1622992884
1418623.6541339375
1421329.8121000178
1451268.4257155324
1470631.9552326980
1483107.7440546761
1485221.2761545005
1493982.6183998464
1520786.0949644980
1529639.2751490138
1538853.8027080230
1542686.8251143701
1553110.3711752329
1557094.4086790025
1565944.2403531565
1569105.7216127560
1572598.8364509193
1332716.7234827218
1390701.8959589858
1436098.4730553026
1563588.5377359390
1532659.8332550859
1584311.2852657177
1600662.6721143107
1607155.9736505928
1644962.0672937719
1665685.1962105106
1671731.4079391358
1673366.1492700771
1711666.5759989568
1715613.1015599605
1725092.2005673007
1770542.1482149599
1774229.1142302813
1775022.8326960466
1786806.6734812198
1805650.8119186851
1834580.5106619345
1869265.9376251928
1909593.9396452170
1944841.0469682976
1950108.6469907871
1959950.1321560119
1960091.6138417827
1984800.0163024441
1988560.6872382890
1990765.0839533057
1990797.7990017528
1992389.4170917308
1999673.6165164371
2040396.6725159529
2049788.5802519058
2061908.5124252786
2090129.6574242641
2111290.0027794271
2120147.1170157058
2127823.7478622035
2134985.6767664940
2156329.6864342628
2218392.6502870255
2277495.4291720656
2346698.7306200948
2370622.7087996111
2467532.4579179929
2490431.1454031899
2516342.0462813812
2539311.5761208134
2548639.6153956564
1806270.7453025738
1888612.2074326083
1925677.0426697206
2059002.9163061848
2212942.6465272497
2219098.9178831127
2256421.3695830766
2281638.3308228648
2381765.2646486155
2387737.8440654529
2404535.1253227145
2691215.8305309072
2922252.5561637733
2942279.6949051665
3080096.7941775869
3089831.5533518781
3131506.1834242034
3140165.3845579972
1135774.0646413552
1144150.5821344535
1175417.7164964556
1221611.6181416961
1245742.1517954276
1259037.7018534149
1264306.5410019941
1274840.8216292245
1223402.7111643409
1250075.3055872841
1251677.0033366371
1282586.4517477452
1283422.3494279515
1291684.5715903210
1304588.7510213626
1318199.4944291645
1368947.6948566343
1376090.8119482339
1387570.7927046510
1412724.1344589310
1433324.7672312716
1484136.6530214500
1496913.8935875858
1506439.0847364167
1506539.1639843846
1513363.4705791183
1522572.1753325266
1529746.2151935759
1544033.2704162362
1555307.6654439904
1568701.7618656061
1573704.7204978503
1499057.4357872580
1506112.7265258752
1519792.3976302972
1498978.1889757995
1595752.5739499079
1604576.0477201832
1606972.7164816338
1630439.0167164545
1646872.3600157379
1670772.8517777467
1677342.6525684271
1702808.4648640313
1706543.4300583809
1722746.7723659310
1732904.4615563462
1743359.6937438402
1750371.7249808647
1754006.0994834886
1754096.9892214658
1762188.0255397483
1776940.9301836875
1780380.8421968556
1782989.8792867764
1783326.7767103110
1789084.1816233251
1799418.1299673128
1803057.3123311699
1817739.9801196106
1818888.2177557064
1819801.1582224257
1847031.8084425545
1860348.3130044315
1861628.8947054439
1870216.8883543271
1883551.8077158377
1896441.1015330367
1912970.3114085343
1913596.0640126840
1960911
Query:
-- 7. Get distinct USER_PSEUDO_IDs from January 7, 2021
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
LIMIT 1000
Answer:
Too long, hard cut:
USER_PSEUDO_ID
1000557.2911835023
1002616.3660015684
1008726.7423030385
1009541.6887464068
1009676.4905193951
1016428.1065641732
1020795.7432964012
1028144.2081628525
1030326.1353640844
1036021.1054561259
1043511.9901401232
1046404.1129546883
1073430.9059120582
1087808.3711873816
1099671.3398238118
1107549.5710254296
1109808.6106046131
1124540.2333393152
1019574.8776308935
1066407.3757892113
1072012.7284818935
1116865.4647068394
1132479.2425986879
1132946.8730897471
1122146.8997157148
1144754.6830399719
1149393.9441120966
1150418.5729329589
1151529.7874029554
1151687.1996189042
1168153.2069804316
1174920.8866835138
1177876.9777589683
1181141.8389731329
1194177.8166317724
1209023.5496836341
1224731.3666771048
1237924.3309856915
1246241.1259892311
1247293.4194247843
1272559.2391561764
1276927.7607362138
1366363.8080922440
1196040.9501767394
1256871.5825332697
1266942.9616912837
1275281.1401174806
1299775.3014967415
1317681.8410322222
1404246.6716592021
1425808.3063725064
1431033.2186997626
1446850.8020489502
1447620.3308368044
1459124.3307795496
1550391.0083775168
1631724.2395953902
1667250.8018262205
1750084.1602132369
1883648.1654112367
1947449.4066998823
1709858.9795411204
2352032.6961720993
2387032.5320070875
1056020.6709260931
1063386.3828577009
1100949.9283905733
1114216.0904812151
1098584.0776604006
1138520.5891734753
1150257.3416332583
1163998.9977514528
1166484.2621554560
1169660.2704170325
1172211.4577928962
1182923.0909175622
1195966.3969559148
1231601.8963574336
1242735.7779476738
1280885.4587684428
1291324.6496937233
1309980.6522015685
1333728.0047687977
1359026.8307338454
1362228.4966015575
1366103.4269040146
1374932.4478575733
1263510.2346903431
1283562.7271739130
1287483.1535140122
1320383.7530644264
1332979.8914503740
1342173.6511298548
1357251.3765617872
1366281.7261580221
1369023.5738995470
1378696.4627477130
1385336.9757682390
1390701.8959589858
1406007.4609789626
1406098.2272398299
1406568.6449738818
1408955.7264448085
1417342.6523496808
1421115.4433330025
1421856.0079266060
1434822.0221853225
1450600.6803049558
1457470.5940116605
1459299.1013763792
1461952.0290351411
1478029.4552762559
1480795.6595718331
1528342.2635970316
1544241.6807718255
1561122.7855918216
1569852.5468689472
1590652.6726149736
1650314.7806652804
1659496.8938806193
1673328.4452718162
1690932.7741713887
1702434.1337833338
1704559.1277489943
1713151.7799105629
1724440.6442958003
1725560.3896736022
1749326.0413550275
1767689.7108431002
1799694.8972403574
1825800.9927595957
1839358.0620214551
1867222.1866677990
1889430.9379107863
1907356.8098775960
1947877.1109354712
1988560.6872382890
2014270.2546235318
2017764.9469389867
2039856.4057543029
2058616.9904162015
1554803.8279036598
1626366.8919067582
1658205.7748137560
1680148.7300106081
1778635.2272822812
1803816.2751642917
1852845.4335508679
1915112.3520066455
1963150.5780975373
1983135.0030940300
2014307.3611842210
2014709.5760211511
1713143.1515270435
2073032.0340382286
2075161.4907764275
2081586.3480335058
2100577.0184610827
2141191.6534652110
2156834.4695745566
2184597.5180287784
2212942.6465272497
2265878.0595059594
2278217.6227941431
2336672.2485114998
2379367.8970354004
2389441.8991227766
2465113.6238683470
2502078.8282016554
2528087.3940013153
2552193.1533386792
2560997.2558350501
2565533.4912616346
2601275.5971642210
2619587.2051047193
2666470.5691573546
2732035.7369571716
2762030.3380654956
2958451.8916179810
2185769.2680594160
3052704.4194270640
3097076.4453723823
3117289.0450306966
3138649.1729775710
3644405.6914122756
3683768.6421577232
3808716.5372557296
3869501.2085951407
4006774.2034898959
4095807.0946454031
4147591.0087343477
1091162.1989694199
1104189.1961360907
1227321.4549113942
1295828.0586489111
1186421.2997808469
1296777.6630043403
1304171.0604038711
1329436.8221805419
1342397.5707081379
1364505.7481550412
1403236.7518250436
1404269.7082895339
1414085.4804386953
1418203.9991889841
1444536.6153824784
1444614.0381635975
1493167.5512652590
1536093.8467158445
1572474.2624475475
1574288.0335442195
1581678.4089346605
1607408.4697646280
1613328.8113572519
1627454.0430815452
1655338.7233343192
1668595.1498499526
1676773.5069362381
1677041.1501664616
1706199.7091522122
1717170.7325581233
1730865.8857828441
1739185.6417988339
1766211.8575237576
1788873.5659424922
1790461.4302221148
1832746.6709228981
1845803.4216408728
1881056.5708385955
1882891.1942887897
1894733.4475939447
1927473.5473152507
1930951.1042348154
1933629.8612777946
1935706.2469501287
1947409.1939782091
1951926.5035164256
1952518.4421988208
1961698.6630150303
2008350.4389402699
2023891.7979970018
2039179.7218079866
2062713.4006549189
1565944.2403531565
1683135.7204561691
1701036.7762199410
1736811.0099185946
1804942.4304035440
1842685.0275380592
1904312.5578123224
1905669.9634464574
1911613.9628018306
1916232.2044487343
1946103.9953128236
1961376.9468264317
1974627.5712881901
2007362.2149327588
2034349.2195692243
1900950.0040962720
2040396.6725159529
2065953.3629381605
2080579.7444739445
2081705
Query:
-- 8. Explore EVENT_NAMES on January 1, 2021
SELECT DISTINCT "EVENT_NAME"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
LIMIT 1000
Answer:
EVENT_NAME
first_visit
page_view
session_start
user_engagement
scroll
view_item
add_shipping_info
add_payment_info
view_search_results
select_promotion
click
select_item
add_to_cart
view_promotion
begin_checkout
purchase
Query:
-- 9. Get count of events per EVENT_NAME on January 1, 2021
SELECT "EVENT_NAME", COUNT(*) AS "event_count"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
GROUP BY "EVENT_NAME"
LIMIT 1000
Answer:
EVENT_NAME,event_count
first_visit,1916
page_view,7906
session_start,2289
user_engagement,4618
scroll,2113
view_item,1498
add_shipping_info,54
add_payment_info,33
view_search_results,149
select_promotion,63
click,2
select_item,186
add_to_cart,295
view_promotion,798
begin_checkout,162
purchase,14
Query:
-- 10. Explore EVENT_PARAMS keys and values on January 1, 2021
SELECT t."EVENT_NAME", f.value:"key"::STRING AS "param_key", f.value:"value"::STRING AS "param_value"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101" t,
LATERAL FLATTEN(input => t."EVENT_PARAMS") f
LIMIT 1000
Answer:
Too long, hard cut:
EVENT_NAME,param_key,param_value
first_visit,ga_session_number,"{""int_value"":1}"
first_visit,ga_session_id,"{""int_value"":3209612510}"
first_visit,page_referrer,
first_visit,page_location,"{""string_value"":""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""}"
first_visit,page_title,"{""string_value"":""Google Dino Game Tee""}"
first_visit,session_engaged,"{""int_value"":1}"
first_visit,engaged_session_event,"{""int_value"":1}"
page_view,page_location,"{""string_value"":""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""}"
page_view,entrances,"{""int_value"":1}"
page_view,medium,"{""string_value"":""organic""}"
page_view,campaign,"{""string_value"":""(organic)""}"
page_view,source,"{""string_value"":""google""}"
page_view,page_title,"{""string_value"":""Google Dino Game Tee""}"
page_view,engaged_session_event,"{""int_value"":1}"
page_view,page_referrer,
page_view,term,"{""string_value"":""<obfuscated>""}"
page_view,session_engaged,"{""string_value"":""0""}"
page_view,ga_session_number,"{""int_value"":1}"
page_view,all_data,
page_view,clean_event,"{""string_value"":""gtm.js""}"
page_view,debug_mode,"{""int_value"":1}"
page_view,ga_session_id,"{""int_value"":3209612510}"
session_start,ga_session_number,"{""int_value"":1}"
session_start,engaged_session_event,"{""int_value"":1}"
session_start,ga_session_id,"{""int_value"":3209612510}"
session_start,page_location,"{""string_value"":""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""}"
session_start,page_title,"{""string_value"":""Google Dino Game Tee""}"
session_start,page_referrer,
user_engagement,engaged_session_event,"{""int_value"":1}"
user_engagement,ga_session_number,"{""int_value"":1}"
user_engagement,page_title,"{""string_value"":""Google Dino Game Tee""}"
user_engagement,debug_mode,"{""int_value"":1}"
user_engagement,engagement_time_msec,"{""int_value"":2075}"
user_engagement,session_engaged,"{""string_value"":""1""}"
user_engagement,page_location,"{""string_value"":""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""}"
user_engagement,ga_session_id,"{""int_value"":3209612510}"
user_engagement,page_referrer,
page_view,ga_session_id,"{""int_value"":3209612510}"
page_view,ga_session_number,"{""int_value"":1}"
page_view,engagement_time_msec,"{""int_value"":9}"
page_view,debug_mode,"{""int_value"":1}"
page_view,engaged_session_event,"{""int_value"":1}"
page_view,page_title,"{""string_value"":""Google Dino Game Tee""}"
page_view,page_location,"{""string_value"":""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""}"
page_view,session_engaged,"{""string_value"":""1""}"
page_view,page_referrer,
scroll,page_referrer,"{""string_value"":""https://shop.googlemerchandisestore.com/Google+Redesign/New?""}"
scroll,page_location,"{""string_value"":""https://shop.googlemerchandisestore.com/Google+Redesign/Campus+Collection/Google+Sunnyvale+Campus+Bottle""}"
scroll,engagement_time_msec,"{""int_value"":15567}"
scroll,page_title,"{""string_value"":""Google Sunnyvale Campus Bottle""}"
scroll,session_engaged,"{""string_value"":""1""}"
scroll,ga_session_number,"{""int_value"":1}"
scroll,ga_session_id,"{""int_value"":7473279052}"
scroll,debug_mode,"{""int_value"":1}"
scroll,engaged_session_event,"{""int_value"":1}"
scroll,percent_scrolled,"{""int_value"":90}"
user_engagement,campaign,"{""string_value"":""<Other>""}"
user_engagement,medium,"{""string_value"":""<Other>""}"
user_engagement,session_engaged,"{""string_value"":""1""}"
user_engagement,page_location,"{""string_value"":""https://shop.googlemerchandisestore.com/Google+Redesign/Lifestyle/Fun/Malibu+Sunglasses.axd""}"
user_engagement,ga_session_number,"{""int_value"":1}"
user_engagement,ga_session_id,"{""int_value"":7473279052}"
user_engagement,debug_mode,"{""int_value"":1}"
user_engagement,page_referrer,
user_engagement,engagement_time_msec,"{""int_value"":21900}"
user_engagement,source,"{""string_value"":""<Other>""}"
user_engagement,engaged_session_event,"{""int_value"":1}"
user_engagement,page_title,"{""string_value"":""The Google Merchandise Store/Malibu Sunglasses""}"
page_view,engaged_session_event,"{""int_value"":1}"
page_view,ga_session_id,"{""int_value"":7473279052}"
page_view,session_engaged,"{""string_value"":""1""}"
page_view,page_title,"{""string_value"":""Home""}"
page_view,ga_session_number,"{""int_value"":1}"
page_view,debug_mode,"{""int_value"":1}"
page_view,engagement_time_msec,"{""int_value"":7}"
page_view,page_location,"{""string_value"":""https://shop.googlemerchandisestore.com/""}"
user_engagement,campaign,"{""string_value"":""<Other>""}"
user_engagement,engaged_session_event,"{""int_value"":1}"
user_engagement,engagement_time_msec,"{""int_value"":6603}"
user_engagement,session_engaged,"{""string_value"":""1""}"
user_engagement,medium,"{""string_value"":""<Other>""}"
user_engagement,ga_session_id,"{""int_value"":74732
End Exploring Related Columns
Task: How many pseudo users were active in the last 7 days but inactive in the last 2 days as of January 7, 2021?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: SELECT S."Column_Name" FROM {Database Name}.{Schema Name}.{Table_name} (ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
number_of_pseudo_users
num:int
```

**Explanation:**

This represents the number of pseudo users (`USER_PSEUDO_ID`) who were active in the last 7 days but inactive in the last 2 days as of January 7, 2021. Specifically, these are users who had events from **January 1, 2021** to **January 5, 2021** but had no events on **January 6, 2021** and **January 7, 2021**..
Here are some useful tips for answering:
When calculating distances between two geometries, use `ST_MakePoint(x, y)` to make a point and `ST_Distance(geometry1 GEOMETRY, geometry2 GEOMETRY)` to compute. No need to convert from meters to miles unless requested. Don't use Haversine like 2 * 6371000 * ASIN(...), use ST_DISTANCE for more precise results.
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'GA4': {'GA4_OBFUSCATED_SAMPLE_ECOMMERCE': ['EVENTS_20201101', 'EVENTS_20201102', 'EVENTS_20201103', 'EVENTS_20201104', 'EVENTS_20201105', 'EVENTS_20201106', 'EVENTS_20201107', 'EVENTS_20201108', 'EVENTS_20201109', 'EVENTS_20201110', 'EVENTS_20201111', 'EVENTS_20201112', 'EVENTS_20201113', 'EVENTS_20201114', 'EVENTS_20201115', 'EVENTS_20201116', 'EVENTS_20201117', 'EVENTS_20201118', 'EVENTS_20201119', 'EVENTS_20201120', 'EVENTS_20201121', 'EVENTS_20201122', 'EVENTS_20201123', 'EVENTS_20201124', 'EVENTS_20201125', 'EVENTS_20201126', 'EVENTS_20201127', 'EVENTS_20201128', 'EVENTS_20201129', 'EVENTS_20201130', 'EVENTS_20201201', 'EVENTS_20201202', 'EVENTS_20201203', 'EVENTS_20201204', 'EVENTS_20201205', 'EVENTS_20201206', 'EVENTS_20201207', 'EVENTS_20201208', 'EVENTS_20201209', 'EVENTS_20201210', 'EVENTS_20201211', 'EVENTS_20201212', 'EVENTS_20201213', 'EVENTS_20201214', 'EVENTS_20201215', 'EVENTS_20201216', 'EVENTS_20201217', 'EVENTS_20201218', 'EVENTS_20201219', 'EVENTS_20201220', 'EVENTS_20201221', 'EVENTS_20201222', 'EVENTS_20201223', 'EVENTS_20201224', 'EVENTS_20201225', 'EVENTS_20201226', 'EVENTS_20201227', 'EVENTS_20201228', 'EVENTS_20201229', 'EVENTS_20201230', 'EVENTS_20201231', 'EVENTS_20210101', 'EVENTS_20210102', 'EVENTS_20210103', 'EVENTS_20210104', 'EVENTS_20210105', 'EVENTS_20210106', 'EVENTS_20210107', 'EVENTS_20210108', 'EVENTS_20210109', 'EVENTS_20210110', 'EVENTS_20210111', 'EVENTS_20210112', 'EVENTS_20210113', 'EVENTS_20210114', 'EVENTS_20210115', 'EVENTS_20210116', 'EVENTS_20210117', 'EVENTS_20210118', 'EVENTS_20210119', 'EVENTS_20210120', 'EVENTS_20210121', 'EVENTS_20210122', 'EVENTS_20210123', 'EVENTS_20210124', 'EVENTS_20210125', 'EVENTS_20210126', 'EVENTS_20210127', 'EVENTS_20210128', 'EVENTS_20210129', 'EVENTS_20210130', 'EVENTS_20210131']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'
When handling TO_TIMESTAMP_NTZ conversions, use query like: SELECT CASE WHEN "date" >= 1e15 THEN TO_TIMESTAMP_NTZ("date" / 1000000) WHEN "date" >= 1e12 THEN TO_TIMESTAMP_NTZ("date" / 1000) ELSE TO_TIMESTAMP_NTZ("date") END AS parsed_timestamp FROM my_table;
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
Keep all decimals to four decimal places.

2025-01-16 10:08:45 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 10:08:45 - root - INFO - ```sql
SELECT COUNT(*) AS "number_of_pseudo_users"
FROM (
    SELECT "USER_PSEUDO_ID" FROM
        (
            SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
            UNION
            SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
            UNION
            SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
            UNION
            SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
            UNION
            SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
        )
    EXCEPT
    SELECT "USER_PSEUDO_ID" FROM
        (
            SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
            UNION
            SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
        )
) AS t;
```
2025-01-16 10:08:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 10:08:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 10:08:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 10:08:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-16 10:08:47 - snowflake.connector.connection - INFO - closed
2025-01-16 10:08:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 10:08:47 - root - INFO - itercount: 1
2025-01-16 10:08:47 - root - INFO - 0
2025-01-16 10:08:47 - root - INFO - results: 
number_of_pseudo_users
13442


2025-01-16 10:08:47 - root - INFO - Please check the answer again by reviewing How many pseudo users were active in the last 7 days but inactive in the last 2 days as of January 7, 2021?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
number_of_pseudo_users
num:int
```

**Explanation:**

This represents the number of pseudo users (`USER_PSEUDO_ID`) who were active in the last 7 days but inactive in the last 2 days as of January 7, 2021. Specifically, these are users who had events from **January 1, 2021** to **January 5, 2021** but had no events on **January 6, 2021** and **January 7, 2021**. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
number_of_pseudo_users
13442
Current sql:
SELECT COUNT(*) AS "number_of_pseudo_users"
FROM (
    SELECT "USER_PSEUDO_ID" FROM
        (
            SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
            UNION
            SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
            UNION
            SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
            UNION
            SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
            UNION
            SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
        )
    EXCEPT
    SELECT "USER_PSEUDO_ID" FROM
        (
            SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
            UNION
            SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
        )
) AS t;Be careful of information in nested JSON columns. e.g.1. When it comes to active users in a date range, it refers to has engagement_time_msec parameter rather than directly counting users. So the right query is: SELECT DISTINCT USER_PSEUDO_ID FROM all_user_activity, LATERAL FLATTEN(input => event_params) AS flattened_params WHERE flattened_params.value:key = 'engagement_time_msec' rather than directly count number in or not in the date range.
e.g.2 When it comes to top-selling product, you should pay attention to hits2.value:"eCommerceAction":"action_type"::INTEGER = 6 where 6 means sold product.

2025-01-16 10:09:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 10:09:33 - root - INFO - ```sql
SELECT COUNT(*) AS "number_of_pseudo_users"
FROM (
    SELECT DISTINCT "USER_PSEUDO_ID" FROM (
        SELECT t."USER_PSEUDO_ID"
        FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101" t,
        LATERAL FLATTEN(input => t."EVENT_PARAMS") f
        WHERE f.value:"key"::STRING = 'engagement_time_msec'
        UNION
        SELECT t."USER_PSEUDO_ID"
        FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102" t,
        LATERAL FLATTEN(input => t."EVENT_PARAMS") f
        WHERE f.value:"key"::STRING = 'engagement_time_msec'
        UNION
        SELECT t."USER_PSEUDO_ID"
        FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103" t,
        LATERAL FLATTEN(input => t."EVENT_PARAMS") f
        WHERE f.value:"key"::STRING = 'engagement_time_msec'
        UNION
        SELECT t."USER_PSEUDO_ID"
        FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104" t,
        LATERAL FLATTEN(input => t."EVENT_PARAMS") f
        WHERE f.value:"key"::STRING = 'engagement_time_msec'
        UNION
        SELECT t."USER_PSEUDO_ID"
        FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105" t,
        LATERAL FLATTEN(input => t."EVENT_PARAMS") f
        WHERE f.value:"key"::STRING = 'engagement_time_msec'
    )
    EXCEPT
    SELECT DISTINCT "USER_PSEUDO_ID" FROM (
        SELECT t."USER_PSEUDO_ID"
        FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106" t,
        LATERAL FLATTEN(input => t."EVENT_PARAMS") f
        WHERE f.value:"key"::STRING = 'engagement_time_msec'
        UNION
        SELECT t."USER_PSEUDO_ID"
        FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107" t,
        LATERAL FLATTEN(input => t."EVENT_PARAMS") f
        WHERE f.value:"key"::STRING = 'engagement_time_msec'
    )
);
```
2025-01-16 10:09:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 10:09:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 10:09:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 10:09:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-16 10:09:37 - snowflake.connector.connection - INFO - closed
2025-01-16 10:09:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 10:09:37 - root - INFO - itercount: 2
2025-01-16 10:09:37 - root - INFO - 0
2025-01-16 10:09:37 - root - INFO - results: 
number_of_pseudo_users
12212


2025-01-16 10:09:37 - root - INFO - Please check the answer again by reviewing How many pseudo users were active in the last 7 days but inactive in the last 2 days as of January 7, 2021?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
number_of_pseudo_users
num:int
```

**Explanation:**

This represents the number of pseudo users (`USER_PSEUDO_ID`) who were active in the last 7 days but inactive in the last 2 days as of January 7, 2021. Specifically, these are users who had events from **January 1, 2021** to **January 5, 2021** but had no events on **January 6, 2021** and **January 7, 2021**. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
number_of_pseudo_users
12212
Current sql:
SELECT COUNT(*) AS "number_of_pseudo_users"
FROM (
    SELECT DISTINCT "USER_PSEUDO_ID" FROM (
        SELECT t."USER_PSEUDO_ID"
        FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101" t,
        LATERAL FLATTEN(input => t."EVENT_PARAMS") f
        WHERE f.value:"key"::STRING = 'engagement_time_msec'
        UNION
        SELECT t."USER_PSEUDO_ID"
        FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102" t,
        LATERAL FLATTEN(input => t."EVENT_PARAMS") f
        WHERE f.value:"key"::STRING = 'engagement_time_msec'
        UNION
        SELECT t."USER_PSEUDO_ID"
        FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103" t,
        LATERAL FLATTEN(input => t."EVENT_PARAMS") f
        WHERE f.value:"key"::STRING = 'engagement_time_msec'
        UNION
        SELECT t."USER_PSEUDO_ID"
        FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104" t,
        LATERAL FLATTEN(input => t."EVENT_PARAMS") f
        WHERE f.value:"key"::STRING = 'engagement_time_msec'
        UNION
        SELECT t."USER_PSEUDO_ID"
        FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105" t,
        LATERAL FLATTEN(input => t."EVENT_PARAMS") f
        WHERE f.value:"key"::STRING = 'engagement_time_msec'
    )
    EXCEPT
    SELECT DISTINCT "USER_PSEUDO_ID" FROM (
        SELECT t."USER_PSEUDO_ID"
        FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106" t,
        LATERAL FLATTEN(input => t."EVENT_PARAMS") f
        WHERE f.value:"key"::STRING = 'engagement_time_msec'
        UNION
        SELECT t."USER_PSEUDO_ID"
        FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107" t,
        LATERAL FLATTEN(input => t."EVENT_PARAMS") f
        WHERE f.value:"key"::STRING = 'engagement_time_msec'
    )
);Be careful of information in nested JSON columns. e.g.1. When it comes to active users in a date range, it refers to has engagement_time_msec parameter rather than directly counting users. So the right query is: SELECT DISTINCT USER_PSEUDO_ID FROM all_user_activity, LATERAL FLATTEN(input => event_params) AS flattened_params WHERE flattened_params.value:key = 'engagement_time_msec' rather than directly count number in or not in the date range.
e.g.2 When it comes to top-selling product, you should pay attention to hits2.value:"eCommerceAction":"action_type"::INTEGER = 6 where 6 means sold product.

2025-01-16 10:10:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 10:10:01 - root - INFO - ```sql
SELECT COUNT(*) AS "number_of_pseudo_users"
FROM (
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM (
        SELECT t."USER_PSEUDO_ID"
        FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101" t,
        LATERAL FLATTEN(input => t."EVENT_PARAMS") f
        WHERE f.value:"key"::STRING = 'engagement_time_msec'
        UNION
        SELECT t."USER_PSEUDO_ID"
        FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102" t,
        LATERAL FLATTEN(input => t."EVENT_PARAMS") f
        WHERE f.value:"key"::STRING = 'engagement_time_msec'
        UNION
        SELECT t."USER_PSEUDO_ID"
        FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103" t,
        LATERAL FLATTEN(input => t."EVENT_PARAMS") f
        WHERE f.value:"key"::STRING = 'engagement_time_msec'
        UNION
        SELECT t."USER_PSEUDO_ID"
        FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104" t,
        LATERAL FLATTEN(input => t."EVENT_PARAMS") f
        WHERE f.value:"key"::STRING = 'engagement_time_msec'
        UNION
        SELECT t."USER_PSEUDO_ID"
        FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105" t,
        LATERAL FLATTEN(input => t."EVENT_PARAMS") f
        WHERE f.value:"key"::STRING = 'engagement_time_msec'
    )
    EXCEPT
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM (
        SELECT t."USER_PSEUDO_ID"
        FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106" t,
        LATERAL FLATTEN(input => t."EVENT_PARAMS") f
        WHERE f.value:"key"::STRING = 'engagement_time_msec'
        UNION
        SELECT t."USER_PSEUDO_ID"
        FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107" t,
        LATERAL FLATTEN(input => t."EVENT_PARAMS") f
        WHERE f.value:"key"::STRING = 'engagement_time_msec'
    )
);
```
2025-01-16 10:10:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 10:10:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 10:10:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 10:10:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-16 10:10:03 - snowflake.connector.connection - INFO - closed
2025-01-16 10:10:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 10:10:03 - root - INFO - itercount: 3
2025-01-16 10:10:03 - root - INFO - 0
2025-01-16 10:10:03 - root - INFO - Total iteration counts: 3
