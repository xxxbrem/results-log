2025-01-16 13:48:46 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 13:50:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 13:51:03 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 13:51:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 13:51:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 13:51:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 13:51:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 13:51:05 - snowflake.connector.connection - INFO - closed
2025-01-16 13:51:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 13:51:05 - root - INFO - SQL:
-- Query 1: View distinct CPC codes in the "cpc" column
SELECT DISTINCT f.value::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
LIMIT 1000;
Results:
Too long, hard cut:
cpc_code
"{""code"":""G02B7/16"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""H04N23/66"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""Y02A50/30"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61P31/18"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K31/506"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H04B1/1036"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G11B2005/0002"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""H01H9/161"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G01D3/022"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G11B7/0945"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B29C65/524"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""B29C66/721"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01L23/48"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""B41J2/04581"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G11C7/12"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""G01B11/2522"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61M25/01"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61P31/16"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H03K19/17764"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""D04H1/407"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""F05D2260/30"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""C08K5/52"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G06N10/40"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""H02K3/18"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01Q9/045"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A23C21/02"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""B41J25/3088"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""C07D311/12"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A01G5/06"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B60R21/20"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B29C53/063"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B65D63/08"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61L2/18"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""G09F23/105"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G06N20/00"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61K35/32"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""F02B37/14"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B01D2257/702"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""H01M2010/4278"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G08G1/161"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A47C7/282"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H04N17/04"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G05B19/4185"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B60L2240/80"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B8/06"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01L24/83"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""H01L2224/05184"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A44C5/145"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G02B27/144"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""D06M13/368"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G07C9/00309"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01H51/2254"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""F16B33/008"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K39/4613"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G09F2013/222"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G03B2205/0015"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""C22C38/48"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H04B1/04"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61J7/0076"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G02B6/4467"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G06F3/0619"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""H04N23/672"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""H04N23/951"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""E04B2/763"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H04M2250/02"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G06F2212/281"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G02F1/13394"",""first"":true,""inve

2025-01-16 13:51:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 13:51:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 13:51:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 13:51:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-16 13:51:07 - snowflake.connector.connection - INFO - closed
2025-01-16 13:51:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 13:51:20 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 13:51:20 - root - INFO - ```sql
SELECT DISTINCT f.value:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
LIMIT 1000;
```

This query extracts the `"code"` field from the JSON data in the `"cpc"` column, providing a list of distinct CPC codes. It corrects the previous query by parsing the JSON structure properly to retrieve the actual CPC codes.
2025-01-16 13:51:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 13:51:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 13:51:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 13:51:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 13:51:21 - snowflake.connector.connection - INFO - closed
2025-01-16 13:51:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 13:51:22 - root - INFO - SQL:
SELECT DISTINCT f.value:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
LIMIT 1000;
Results:
Too long, hard cut:
cpc_code
H05K2203/1327
H04B1/0057
G06T19/006
H01L21/50
B32B27/308
B32B27/32
C09D7/65
C01B9/04
H01L21/76849
A61G13/02
G06K9/00369
G06F40/279
H04B7/086
B32B37/12
G01N15/14
H04W72/542
A61K31/282
G01D11/245
G01D21/00
F16F9/19
H04W64/00
H01L45/08
H02J7/04
H01L21/823437
F41C23/04
F02D2250/36
C04B2111/40
F02B67/00
H01L24/19
C07F15/0093
G01N15/1459
G02B27/0172
F02M26/00
F24D2220/042
A61K2300/00
Y02P70/10
C23C18/24
Y02T70/10
C07K5/06034
F21V5/008
C07F15/025
A61K39/0017
A61B17/3468
A63C10/24
F16L3/1236
B29C70/003
H04M19/08
F22G7/14
C08F299/065
C09K5/063
B82Y40/00
H01L21/3065
H04N2201/3278
C09D11/17
H04L67/10
H04L41/22
H01M8/04671
B29C48/913
H05K7/20545
H04M3/42314
G01N33/74
C08G65/30
A01K2207/15
C08L77/06
C07F7/126
F24H9/02
G06Q50/02
H04N21/4147
H01M4/62
E05B17/0058
A61K31/439
A23K20/24
B60W2710/083
A47C1/032
B62D1/185
E02F9/2217
C22C21/08
B32B2307/746
G02B1/18
G06T2207/10088
A61L2/10
A61N5/0616
G06F2201/88
G06K9/2063
E04F13/06
H04N19/159
G06T9/004
G06F2009/4557
H04N19/114
A61M25/1027
C09D5/00
F05D2260/98
F02C7/266
G07C5/008
G09G2330/023
A61K31/065
A43B1/0009
A47J31/18
D04H1/587
A61B2017/07257
A61K2800/5426
B23K2103/02
B23K35/3053
G10L15/08
G06F19/3475
B01D61/10
H01L24/09
H03K3/84
G01K7/42
A61B17/0401
G06F9/3808
E21B43/084
C30B25/10
F04B1/12
H01L27/3272
F02B2053/005
C09J2489/00
A43B13/125
A23L19/00
G02B27/0093
B66D1/14
G06F1/1626
H01S3/076
H04L45/02
G03G15/5041
A61K31/195
G06Q30/0278
A61L27/50
H01M4/381
B21B45/004
A61H2201/0157
G11C29/52
A63F2300/63
G06Q30/0267
B01D53/268
G06T2207/20021
C30B25/18
E04H15/06
G16H20/40
G06F2203/04105
A23K40/30
B29C55/04
G01S2205/01
G06F16/43
B01J35/56
H02J50/20
H01L33/145
C12N15/1065
C12N2310/20
B01D53/263
F02N2200/022
H04B5/0087
B33Y50/00
D07B2201/2043
A61L29/14
A46B7/044
H02P7/29
E05B45/12
H04B17/382
A23L27/20
Y10T29/49885
A47C1/12
G02B2027/0165
A61B17/12109
F41H5/0471
C04B38/0022
B01D1/221
E06B9/171
H04N9/888
C07D231/14
B60G17/0152
B60G2202/42
A47C4/286
E01C19/176
F02M59/48
H01J2237/221
H02J7/0063
H01M16/00
C09J7/00
A61F5/56
C04B2201/10
B01D39/2017
B32B27/28
A61M1/3427
B63C11/18
G01N2223/6116
B41K1/58
B63B2704/00
B60Y2200/92
A63F2300/8047
G06T2207/20092
E01C15/00
C08F2/001
H10K59/129
H01L27/0292
A46B13/02
F16K15/18
C04B33/34
H04Q1/144
F04C2/344
D21D5/24
G06F17/30876
A61B2017/00353
B23K26/127
H03M13/2792
C04B35/6261
B63B13/02
A41C1/00
B01D2253/108
B23K2101/42
B60W10/10
H04J11/0093
B60L58/30
F23R3/286
G06V20/58
B32B2457/20
H04L69/04
G06F2203/04112
G02B5/3033
D02J1/08
G06F17/30138
G07F11/10
B03B4/005
G01J3/108
Y10T83/8716
F24F3/153
F23Q2/32
B44C5/0407
C08K3/24
B65D47/2037
H04L9/00
E06B9/15
E21B47/01
B29C2949/08
B67B7/44
F16H61/30
B29D22/00
B65H21/00
B23B27/22
B64C3/54
C07C323/44
F25D23/065
F01D5/025
F01N13/001
H01H67/06
B29C73/02
G06F16/2471
H02G15/013
A61K49/0036
B60L2240/545
H01L23/3675
C03B37/0124
C12N2500/02
A61M2037/0023
A61M2037/0046
B25J19/021
H04N19/85
G06F3/0655
C22C38/10
A63B69/0059
H04L12/1822
G01V2210/244
Y10T409/307672
B23K35/286
G01J3/04
B23K35/325
A61B2017/2904
A61B2090/037
A61K49/0065
H04B1/71632
G06F9/44505
B65G47/71
H01L29/7889
B60L3/0069
A61M2025/0226
C09J7/02
A61N1/36135
A61N1/37217
C10N2040/42
H01L33/486
B67D3/0029
A61B1/31
H01L33/10
Y10T137/8593
A61H2230/10
F16C2300/34
Y10T29/49032
B81B2201/042
C09J163/00
B60S1/3887
A63F13/56
G02F1/133317
B01J2219/0801
H03K17/693
A61K47/59
C04B35/63428
B27G19/04
C12Q2525/307
C07C213/06
A61C3/025
A61K51/1251
C08G64/22
A47B47/005
A61K36/233
G01J5/10
A61K36/232
B67D1/0009
B67D1/0412
B60P1/34
B65G1/0478
H04W36/0064
G06N3/067
A61F2/2466
A61L2/238
G06F18/217
H02H3/343
B01D2258/014
H03K5/135
H04L41/0816
H04L43/0811
F02D41/1462
H01L2924/20753
Y10T428/24702
F42C19/00
G11C2013/0092
A61B8/485
H02K1/187
F05D2240/303
F16H37/12
B23D45/048
Y10S901/36
H02M1/0054
H01S5/028
B29C2045/1741
H05K13/08
H03F3/20
G06F3/06
C08G59/621
H04N23/611
H02K3/345
F16H2025/2481
H01L43/10
H01L2224/05157
A61B5/4504
G02B6/06
H01L2224/03462
A61H2201/1436
C23F13/005
H05K3/426
F24C15/2035
Y02P30/00
H04W36/0016
A61M1/1524
H04K3/224
C01B3/42
G03G15/04054
A61M60/40
A61B2017/2906
H03K19/17764
F16L1/10
G06Q10/047
H04L12/2856
A61B2017/0464
G11B20/1879
G06F21/31
C08F251/02
A43B17/026
Y10T29/49989
B01D2256/10
B25B27/06
C09K9/02
G06T2207/10012
G08B13/1427
A61N1/378
G06T2207/30024
B65H2403/73
E05B77/38
B60W2556/65
G01S19/37
G02F1/133621
G06V40/197
H04N1/00708
G06N3/0418
G05D1/24
H01L21/187
H01L27/11514
H02K33/02
B65D25/108
Y10T83/155
A61K39/001103
H04L2012/5614
H05K2201/09736
A61B5/0836
F02M63/0078
B22D11/0406
A61K31/4172
H01L2224/82101
B65D5/241
B65D5/2019
H01L24/40
B65H2801/31
C21B2400/08
F04C18/16
C12Y302/01091
A61B8/5253
G01N21/8806
H10N70/884
C07F15/0046
C12Q1/04
F16F7/123
B01D2257/404
H04N9/3114
H04M1/0216
B60L2240/507
G02B5/3008
C08G75/045
A61M25/003
C08G63/00
C09J9/00
H01J37/32669
C04B2111/00767
F15B2211/265
G02B17/0812
G06F2200/1633
H01M50/533
G06F17/241
A63B45/00
F16C2316/10
H01M8/0606
A61F2002/91591
B65D2575/329
A61F2013/00246
B01D46/69
B32B2307/584
G16B20/10
H04N19/96
H01H13/81
C09D5/1668
F25C5/182
A61H2201/123
B24D3/002
C07F7/0838
C07D211/66
H04B1/18
A63B21/0407
H04W36/

2025-01-16 13:51:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 13:51:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 13:51:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 13:51:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 13:51:23 - snowflake.connector.connection - INFO - closed
2025-01-16 13:51:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 13:51:24 - root - INFO - SQL:
-- Query 3: View distinct assignee names from "assignee_harmonized"
SELECT DISTINCT f.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."assignee_harmonized") f
LIMIT 1000;
Results:
Too long, hard cut:
assignee_name
PREC BIOSCIENCES INC
STANLEY WORKS LTD
CAMURUS AB
WWT SPOLKA Z OGRANICZONA ODPOWIEDZIALNOSCIA
EISEN EIKO
WISTRON NEWEB CORP
UST INC
UNIV ANGERS
CHUNG CHI Y
ZHU MIN
SUMNER MICHAEL
BERNARD MARC R
HRA PHARMA LAB
GANZHOU HEMAY PHARMACEUTICAL CO
SURROZEN OPERATING INC
KIMBERLY CLARK CO
VIGIL NEUROSCIENCE INC
ROCKWOOL INT
OMNISYSTEM CO LTD
AGCO DO BRASIL SOLUCOES AGRICOLAS LTDA
KOREA INST OCEAN SCI & TECH
MATHUR BHAVNA
VARTIAINEN PANU
KAN GEORGE L
SUN HAO
KOO YEON KWAN
ADVANCED BIONICS LLC
MICROELECTRONICS TECH INC
MARTIN DOMINIC R
BRUKER BIOSPIN AG
SOROCO PRIVATE LTD
NIKE INC
Turner Tackle LLC
WAGNER JOACHIM
TOOLTECH LLC
ATOTECH DEUTSCHLAND GMBH
AJINOMOTO KK
HIKMET RIFAT A M
AUYOUNG ALVIN
CHEVRON ORONITE SAS
UNIV MACAU
H4X EU
FUNDACION INSTITUTO DE INVESTIG SANITARIA FUNDACION JIMENEZ DIAZ
COGNEX CORP
WIRTGEN GMBH
AUE TEXTILMASCHINENBAU GMBH
OTKRYTOE AKTSIONERNOE OBSHCHESTVO INFORMATSIONNYE TEKH I KOMMUNIKATSIONNYE SISTEMY
ACTION ELIZABETH
RATKAY ALECSEU
EXXON RESEARCH ENGINEERING CO
FOSTER WHEELER ENERGY CORP
LAESSER FRANZ AG
KORPORATSIJA MASTERNEHT AOZT
HOWELL THOMAS A
SHIM JAE J
MEGURO TAKESHI
ARNEY SHANE R
UBE MAT IND LTD
POORNACHANDRAN RAJESH
OOI TETSUYA
SCHUMACHER DONALD J
DECKARD CARL
TAPIA MARIO G
PEREGO ANDREA
KAWANA TAKAHIRO
SERVIER LAB
GRINKEVICH ALEKSANDR VASIL EVICH
DVOEGLAZOV ALEKSEJ IVANOVICH
ASEA AB
SCHAEFER ELEKTROTECHNIK U SONDERMASCHINEN GMBH
ZIMMERMANN GISELA
SHINDENGEN ELECTRIC MFG CO
ATATUERK UENIVERSITESI BILIMSEL ARASTIRMA PROJELERI BIRIMI
LYUBEZNOV VALERIJ KONSTANTINOVICH
KODAMA NOBUTAKA
GUOZHU YE
HINTERMAIER WOLFGANG
MAURER JOHN H
PICHER PATRICK
LAMBA DIGVIJAY SINGH
LÉONARD FRANÇOIS
CARUELLE JEAN-PIERRE
ST MICROELECTRONICS ROUSSET
TERMINATOR IP LTD
TOTALENERGIES CORBION BV
KAISER GYPSUM COMPANY INC
LISTON JAMES A TRUSTEE
SYLVESTER RICHARD
WITTENBERGE NAEHMASCH VEB
BORG HOLDING A G
WARNER LAMBERT TECH
ORTH JANOSNE
FAIL SAFE IND INC
HIAB AB
MOBIPAYPOINT LTD
HEWLETT PACKARD DEVELOPMENT CO LP
ROBOPAC SPA
ROCHE DIAGNOSTICS OPERATIONS INC
HEINRICH GEORG GMBH MASCHF
BioVersys AG
JANSMA MICHAEL
BIOTA EUROPE LTD
VICENTE JOSE GERMAN
CELLULAR RES INC
JANSSEN PHARMACEUTICALS INC
DARNELL WAYNE
TECHNION RES & DEV FOUNDATION
ANALOGIC CORP
WEIR MINERALS AUSTRALIA LTD
FORMLABS INC
SUBARU CORP
LUKITO HARSOYO
MEEKER DAVID E
LARYNGEAL MASK CO LTD
MOLYNEUX STEPHEN
JOHNSON & JOHNSON SURGICAL VISION INC
BERTHIEZ C N M P
BASF PLANT SCIENCE CO GMBH
CQLT SAARGUMMI TECH SARL
HEFEI MIDEA REFRIGERATOR CO
FERROLI SPA
STEFFENS RALF
ZHANG JINGLIN
XIAMEN CHANGELIGHT CO LTD
MURATA TOSHIKI
SUMITOMO METAL MINING CO
SOLINAS MEDICAL INC
RADIABEAM TECH LLC
Evol Science LLC
MARTINEZ CANALES MONICA LUCIA
WAVE OPTICS LTD
JIANGSU SHEMAR ELECTRIC CO LTD
KANG MIN SOO
LUEDTKE OLIVER
BUONO JUAN C MR
FARGO KENDALL M
KELLER IGOR
MONOPANEL SA
ROLLERBLADE INC
GALLER KURT
TOLEDO ERAN
EL TAHER TODD
ISHITANI TOMOYA
MATERIALS & ELECTROCHEMICAL RES CORP
TERATRON GMBH
EUROPOLES GMBH & CO KG
WHITE IAN D
GOTFRIED YECHIEL
KESSLER MANFRED
STAPP SOEREN
EUROCATENE SRL
SEOK TAEK O
WOO DAE ENGINEERING CONSULTANT CO LTD
ELIESON CHAIMSONOVITZ PROSPER
MARSHALL & ILSLEY BANK
JAMES B BLACKBURN
BERACA SABARA QUIMICOS E INGRE
SWEETSER BERT M
LELAND ELECTRIC CO
NIPPON KOGAKU KK
BOGIE N
KELVINATOR CORP
REDINGTON COUNTERS INC
DANFOSS AS
STOCK EQUIPMENT CO
BISSETT & SONS LTD J
TAITO CORP
GROSS ISAK
TELEX CORP THE
TURNER BROTHERS ASBEST
HITACHI SOFTWARE ENG
REMINGTON TYPEWRITER CO
PEUGEOT
STIRN ALBERT L
JANSSEN VACCINES & PREVENTION BV
WARREN FASTENER CORP
MUELLER JOHANN
WHEELABRATOR CORP
PACIFIC MILLS
CANADIAN SAFETY FUSE COMPANY L
CARTIER JOSEPH GIDEON
OMARK INDUSTRIES INC
STICKEL CHARLES E A
NORGREN CO C A
HOLDEN ARTEMAS F
ARMSTRONG WHITWORTH CO ENG
CEBAL
WEA MFG INC
WILLIAM R BECKER
SICARI R
PERES DALMO JOSE
ALFRED CARRINGTON KENNEDY
CARL WALTHER OHG
KIOXIA CORP
BATTELLE ENERGY ALLIANCE LLC
SOLID INC
TG3D STUDIO
LIXIL SUZUKI SHUTTER CORP
EMPRESSA NAC DE MINERIA ENAMI
VELCRO IP HOLDINGS LLC
MATSUMOTO AYAKA
LODZKA FAB MASZYN JEDWABNI
ALLEN GROUP
SANNER FRIEDR GMBH CO KG
SINGAPORE CHARTERED IND
BEHR GMBH & CO KG
SPATTI GIOVANNI
BOMBAY TEXTILE RES ASS BTRA
SUZUKI MASAMI
WOONGJIN CHEMICAL CO LTD
Convida Wireless LLC
HEATON JEREMIAH
SONOS INC
REMEDEE LABS
BYSTRONIC MASCH
AFP ADVANCED FOOD PRODUCTS LLC
CHR HANSEN AS
THEKKADATH GOVINDANUNNY
SHANGHAI GUIMU ROBOT CO LTD
DEUTSCHE REICHSBAHN
TELO GENOMICS HOLDINGS CORP
POTOMAC PHOTONICS INC
TRIGEM COMPUTER INC
PARK MAN KI
UNIV FLORIDA STATE
MUSIL FRANTISEK
NGUYEN THIEN NHON DIANA
METAL IND RES & DEV CT
DAIKIN FLUOROCHEMICALS CHINA CO LTD
HOWARD DANE
LEPPIN HANS
PEUCKERT KLAUS
KIRCHNER RUDI
MITSUMI ELECTRIC CO LTD
REXROTH INDRAMAT GMBH
DYNAVAX TECH CORP
PROGRESSIVE TOOL & IND CO
MUROTA WATARU
PITCHER CHARLES SPENCER
REVIVE ENVIRONMENTAL TECHNOLOGY LLC
DROSTE RENATE
VRACAR VIKTOR
THE REGENTS OF UNIV OF CALIFORNIA
GEISER TOBIAS
YANG BONG HYUN
MITSUBISHI HITACHI POWER SYSTEMS ENV SOLUTIONS LTD
UNIV OHIO STATE
JEONG DONG HUN
SANKEI YAKUHIN KK
TAIWAN SEMICONDUCTOR MFG
YEH CHIH-KANG
HILL CLYDE D
YANG CHENG-CHUAN


2025-01-16 13:51:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 13:51:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 13:51:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 13:51:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 149
2025-01-16 13:51:25 - snowflake.connector.connection - INFO - closed
2025-01-16 13:51:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 13:51:26 - root - INFO - SQL:
-- Query 4: Extract filing years from "filing_date"
SELECT DISTINCT TO_VARCHAR(TO_DATE(t."filing_date"::STRING, 'YYYYMMDD'), 'YYYY') AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE TRY_TO_DATE(t."filing_date"::STRING, 'YYYYMMDD') IS NOT NULL
LIMIT 1000;
Results:
filing_year
2009
1998
1950
1933
1922
1898
2012
2000
1907
1905
1885
1889
1970
1941
1881
1948
1992
2013
1951
2007
1961
1974
1913
1997
1880
1949
1887
1988
1976
1901
1955
2017
1935
1936
1944
1867
1927
1967
1939
1923
1886
2010
2024
1926
1924
1985
1986
1993
1890
2021
1968
1928
1940
1995
1912
1962
1918
1897
2006
1937
1903
2002
2020
1934
1917
1925
1916
2023
2019
1931
1899
2014
1920
1952
1963
2022
1984
1990
1958
1853
1915
1946
1973
1954
1883
2018
2015
2016
1983
1978
1979
1981
1999
1980
1892
1919
1975
1959
1893
1902
1996
1938
1953
1906
1900
1964
1947
1966
1877
2005
1945
1972
1895
1911
1960
1991
1914
1921
1904
1994
1971
1896
1943
1860
2004
1989
2011
1969
1929
1909
2001
1932
1957
1894
1882
1930
1987
1910
1942
1908
1846
1965
1982
1891
2008
1888
1977
2003
1956

2025-01-16 13:51:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 13:51:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 13:51:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 13:51:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-16 13:51:27 - snowflake.connector.connection - INFO - closed
2025-01-16 13:51:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 13:52:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 13:52:01 - root - INFO - ```sql
SELECT DISTINCT CAST(t."filing_date" / 10000 AS INTEGER) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 1000;
```

This query extracts the filing year by dividing the `"filing_date"` (assumed to be in `YYYYMMDD` format as an integer) by 10,000 and casting it to an integer. It simplifies the previous query to ensure that data is returned.
2025-01-16 13:52:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 13:52:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 13:52:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 13:52:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 150
2025-01-16 13:52:02 - snowflake.connector.connection - INFO - closed
2025-01-16 13:52:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 13:52:02 - root - INFO - SQL:
SELECT DISTINCT CAST(t."filing_date" / 10000 AS INTEGER) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 1000;
Results:
filing_year
1998
1988
1934
1885
2011
1950
2021
1965
2007
1961
1890
1909
1882
1946
1975
1889
1972
1982
1999
1918
1846
1981
1997
1887
2017
1899
1983
2004
1928
2018
2006
1925
1973
2001
1980
1949
1904
1877
1860
1943
1994
1892
1977
1969
1938
1915
1970
2005
1976
2000
1932
1906
1987
1955
1919
1902
2010
1927
1881
2012
1957
1923
1867
1978
1898
1989
0
2014
1916
1974
1853
1993
2008
1964
1937
1895
1931
1929
1991
1966
1886
1958
1956
1933
2020
1920
1926
1930
1995
2009
1953
1907
1971
1952
1947
1992
1979
1912
1945
1986
2019
1962
2002
1948
1910
1913
1984
1967
1939
1940
1911
2024
1924
1900
1897
1896
1944
1880
1942
2022
2015
1905
1963
1921
1883
1914
1936
1990
1951
2013
1954
1908
1985
1903
1960
1888
1996
2016
1893
1935
1941
1968
1901
1959
1917
1894
2023
2003
1922
1891

2025-01-16 13:52:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 13:52:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 13:52:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 13:52:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-16 13:52:04 - snowflake.connector.connection - INFO - closed
2025-01-16 13:52:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 13:52:31 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 13:52:31 - root - INFO - ```sql
SELECT DISTINCT SUBSTRING(t."filing_date"::STRING, 1, 4) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE t."filing_date" IS NOT NULL
LIMIT 1000;
```
2025-01-16 13:52:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 13:52:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 13:52:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 13:52:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 150
2025-01-16 13:52:32 - snowflake.connector.connection - INFO - closed
2025-01-16 13:52:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 13:52:33 - root - INFO - SQL:
SELECT DISTINCT SUBSTRING(t."filing_date"::STRING, 1, 4) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE t."filing_date" IS NOT NULL
LIMIT 1000;
Results:
filing_year
2015
2016
2018
1983
1978
1898
1949
1887
2012
2000
1907
1905
1885
1904
1846
1942
1908
1881
1936
1948
2013
1951
1992
1910
2010
2024
1926
1924
2014
1963
1952
1920
1928
1940
1995
1912
1930
1922
1889
1994
1986
1993
1985
1890
2021
1968
2017
1935
2003
1956
2009
1998
1950
1933
1927
1981
1999
1980
1979
1892
1997
1880
1996
0
1953
1938
1964
1947
1906
1900
1969
1909
1929
2005
1945
1972
1960
1911
1895
2006
1903
1937
1923
1886
2019
2023
1899
1931
1988
1976
1955
1901
2008
1946
1915
1967
1939
1944
1867
1991
1921
1914
2020
2002
1934
1916
1925
1917
1970
1941
1971
1943
1896
1860
2011
2004
1989
1966
1877
2001
1882
1957
1894
1932
1962
1897
1918
1987
1974
2007
1961
1913
1975
1959
1919
1902
1893
1965
1982
1891
2022
1984
1990
1958
1853
1977
1888
1973
1954
1883

2025-01-16 13:52:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 13:52:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 13:52:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 13:52:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-16 13:52:34 - snowflake.connector.connection - INFO - closed
2025-01-16 13:52:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 13:53:16 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 13:53:16 - root - INFO - ```sql
SELECT DISTINCT SUBSTRING(t."publication_date"::STRING, 1, 4) AS "publication_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE t."publication_date" IS NOT NULL
LIMIT 1000;
```
2025-01-16 13:53:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 13:53:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 13:53:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 13:53:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 187
2025-01-16 13:53:18 - snowflake.connector.connection - INFO - closed
2025-01-16 13:53:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 13:53:18 - root - INFO - SQL:
SELECT DISTINCT SUBSTRING(t."publication_date"::STRING, 1, 4) AS "publication_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE t."publication_date" IS NOT NULL
LIMIT 1000;
Results:
publication_year
1843
1922
1873
1898
1881
1949
1887
1948
1863
2006
1937
1903
1904
1868
2010
2024
1924
1926
1864
1872
2017
1935
1936
1847
1944
1866
1867
2000
2012
1907
1905
1885
1839
1886
1923
1865
1975
1959
1893
1919
1902
1875
1986
1985
1993
1890
2021
1968
1940
1928
2001
1870
1957
1882
1932
1894
1972
1960
1895
1911
1991
1914
1878
1921
2007
1961
1974
1913
1841
1994
1854
1971
1860
1896
1943
1858
1862
1842
2005
1945
1845
1930
1983
1978
1910
1970
1884
1941
1982
1965
1891
1851
1947
1906
1859
1964
1900
1848
1915
1946
1967
1939
1998
2009
1950
1933
1844
2013
1992
1951
1849
1980
1981
1999
1979
1892
1876
2019
2023
1899
1931
1988
1976
1955
1901
2004
2011
1989
1969
1909
1929
1995
1879
1912
2016
2015
2018
1987
1889
1997
1880
1855
2014
1963
1920
1952
1856
2022
1984
1990
1958
1874
1853
1977
1888
1837
1857
1973
1954
1883
1962
1897
1918
1927
1850
1852
2020
2002
1917
1934
1916
1925
1871
1942
1908
1861
1846
1996
0
1953
1938
2008
1869
1966
1877
2003
1956

2025-01-16 13:53:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 13:53:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 13:53:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 13:53:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-16 13:53:20 - snowflake.connector.connection - INFO - closed
2025-01-16 13:53:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 13:54:35 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 13:54:35 - root - INFO - ```sql
SELECT f1.value:"name"::STRING AS "assignee_name", COUNT(DISTINCT t."application_number") AS "num_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f1
GROUP BY f1.value:"name"::STRING
ORDER BY "num_applications" DESC
LIMIT 1000;
```

This query simplifies the previous conditions by removing the CPC code filter, which was causing no data to be returned. It retrieves the assignee names and counts the number of unique applications filed by each assignee across all categories. The results are grouped by assignee name and ordered by the number of applications in descending order.
2025-01-16 13:54:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 13:54:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 13:54:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 13:54:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 13:54:37 - snowflake.connector.connection - INFO - closed
2025-01-16 13:54:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 13:54:37 - root - INFO - SQL:
SELECT f1.value:"name"::STRING AS "assignee_name", COUNT(DISTINCT t."application_number") AS "num_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f1
GROUP BY f1.value:"name"::STRING
ORDER BY "num_applications" DESC
LIMIT 1000;
Results:
Too long, hard cut:
assignee_name,num_applications
SAMSUNG ELECTRONICS CO LTD,2238
CANON KK,2114
HITACHI LTD,2011
MATSUSHITA ELECTRIC IND CO LTD,1948
MITSUBISHI ELECTRIC CORP,1732
SONY CORP,1477
FUJITSU LTD,1363
TOSHIBA CORP,1296
NEC CORP,1280
IBM,1239
LG ELECTRONICS INC,1053
HUAWEI TECH CO LTD,1027
SIEMENS AG,987
SEIKO EPSON CORP,963
GEN ELECTRIC,947
SHARP KK,913
STATE GRID CORP CHINA,839
TOYOTA MOTOR CORP,839
BOSCH GMBH ROBERT,837
HONDA MOTOR CO LTD,836
QUALCOMM INC,812
RICOH KK,735
DENSO CORP,628
SANYO ELECTRIC CO,616
HYUNDAI MOTOR CO LTD,577
NIPPON TELEGRAPH & TELEPHONE,568
TOSHIBA KK,545
BAYER AG,528
FUJI PHOTO FILM CO LTD,522
NISSAN MOTOR,515
TOYOTA MOTOR CO LTD,507
MITSUBISHI HEAVY IND LTD,488
ZTE CORP,479
INTEL CORP,475
ERICSSON TELEFON AB L M,462
BOE TECHNOLOGY GROUP CO LTD,435
FUJI XEROX CO LTD,427
DU PONT,423
MATSUSHITA ELECTRIC WORKS LTD,403
NIPPON STEEL CORP,401
SUMITOMO ELECTRIC INDUSTRIES,399
PROCTER & GAMBLE,394
BASF AG,366
HOECHST AG,364
GREE ELECTRIC APPLIANCES INC ZHUHAI,364
PANASONIC CORP,357
SUMITOMO CHEMICAL CO,354
TOKYO SHIBAURA ELECTRIC CO,353
FUJIFILM CORP,349
BROTHER IND LTD,325
HOFFMANN LA ROCHE,319
FORD GLOBAL TECH LLC,319
LG CHEMICAL LTD,318
KYOCERA CORP,316
UNIV ZHEJIANG,314
MURATA MANUFACTURING CO,305
PHILIPS NV,304
APPLE INC,299
TORAY INDUSTRIES,298
KONINKL PHILIPS ELECTRONICS NV,298
HON HAI PREC IND CO LTD,296
DAINIPPON PRINTING CO LTD,294
SAMSUNG DISPLAY CO LTD,289
MICROSOFT CORP,285
MIDEA GROUP CO LTD,278
FUJI ELECTRIC CO LTD,270
NIPPON ELECTRIC CO,270
TAIWAN SEMICONDUCTOR MFG CO LTD,269
UNIV TSINGHUA,264
KOBE STEEL LTD,262
MICROSOFT TECHNOLOGY LICENSING LLC,256
3M INNOVATIVE PROPERTIES CO,253
SEKISUI CHEMICAL CO LTD,249
OKI ELECTRIC IND CO LTD,241
RICOH CO LTD,240
EASTMAN KODAK CO,238
XEROX CORP,236
OMRON TATEISI ELECTRONICS CO,236
KAO CORP,234
WESTINGHOUSE ELECTRIC CORP,231
NIKON CORP,231
TOKYO ELECTRON LTD,230
CASIO COMPUTER CO LTD,229
TOPPAN PRINTING CO LTD,229
MOTOROLA INC,228
BASF SE,225
KONISHIROKU PHOTO IND,225
APPLIED MATERIALS INC,224
BRIDGESTONE CORP,222
NITTO DENKO CORP,221
MICRON TECHNOLOGY INC,220
YAZAKI CORP,219
BOEING CO,217
HYNIX SEMICONDUCTOR INC,214
RCA CORP,213
HEWLETT PACKARD DEVELOPMENT CO,213
DAIKIN IND LTD,211
TDK CORP,209
LG DISPLAY CO LTD,208
SAMSUNG SDI CO LTD,208
GEN MOTORS CORP,206
OLYMPUS OPTICAL CO,206
PANASONIC IP MAN CO LTD,205
CIBA GEIGY AG,204
MAZDA MOTOR,203
SHELL INT RESEARCH,201
TEXAS INSTRUMENTS INC,200
LILLY CO ELI,199
UNIV CALIFORNIA,199
PETROCHINA CO LTD,199
TENCENT TECH SHENZHEN CO LTD,197
NTT DOCOMO INC,195
UNIV SOUTH CHINA TECH,192
GUANGDONG OPPO MOBILE TELECOMMUNICATIONS CORP LTD,191
SAMSUNG ELECTRO MECH,190
OLYMPUS CORP,190
UNIV TIANJIN,190
KIA MOTORS CORP,187
SUMITOMO WIRING SYSTEMS,186
COLGATE PALMOLIVE CO,186
KUBOTA KK,183
SEMICONDUCTOR ENERGY LAB,182
FURUKAWA ELECTRIC CO LTD,181
CHINA PETROLEUM & CHEM CORP,180
SANKYO CO,180
DOW CHEMICAL CO,178
OREAL,177
PFIZER,175
KAWASAKI STEEL CO,173
POSCO,172
ICI LTD,171
KOREA ELECTRONICS TELECOMM,170
UNIV JILIN,169
HAIER SMART HOME CO LTD,167
SUMITOMO METAL IND,165
TOSHIBA TEC KK,165
NOVARTIS AG,165
NIPPON KOKAN KK,165
BAYERISCHE MOTOREN WERKE AG,165
SHINETSU CHEMICAL CO,165
SHIMADZU CORP,165
MINNESOTA MINING & MFG,164
COMMISSARIAT ENERGIE ATOMIQUE,163
ASAHI CHEMICAL IND,162
ALPS ELECTRIC CO LTD,161
HONEYWELL INT INC,160
MERCK PATENT GMBH,159
AISIN SEIKI,159
GOOGLE LLC,159
UNIV SHANGHAI JIAOTONG,158
UNIV SOUTHEAST,158
HITACHI CHEMICAL CO LTD,157
ISHIKAWAJIMA HARIMA HEAVY IND,155
LG INNOTEK CO LTD,155
NANJING UNIVERSITY OF TECHNOLOGY,153
CENTRE NAT RECH SCIENT,152
ZAHNRADFABRIK FRIEDRICHSHAFEN,151
ISEKI AGRICULT MACH,150
ASAHI GLASS CO LTD,150
VOLKSWAGEN AG,150
GM GLOBAL TECH OPERATIONS INC,148
ILLINOIS TOOL WORKS,147
AMERICAN CYANAMID CO,147
MERCK & CO INC,146
ALIBABA GROUP HOLDING LTD,145
INFINEON TECHNOLOGIES AG,142
NTN TOYO BEARING CO LTD,142
NOKIA CORP,142
KONINKLIJKE PHILIPS NV,142
IND TECH RES INST,142
DEERE & CO,141
MITSUBISHI MATERIALS CORP,141
KIMBERLY CLARK CO,141
MITSUBISHI CHEM CORP,138
HALLIBURTON ENERGY SERVICES INC,138
YAMAHA MOTOR CO LTD,137
MURATA MACHINERY LTD,136
NSK LTD,136
BYD CO LTD,136
WESTERN ELECTRIC CO,136
UNIV SHANDONG,136
HONGFUJIN PREC IND SHENZHEN,134
BEIJING XIAOMI MOBILE SOFTWARE CO LTD,134
KAWASAKI HEAVY IND LTD,133
UNILEVER NV,132
AUDI AG,131
SCHAEFFLER TECHNOLOGIES AG,131
KOMATSU MFG CO LTD,130
UNIV JIANGNAN,130
FUJIKURA LTD,128
UNIV NANJING FORESTRY,128
TOYO BOSEKI,127
AU OPTRONICS CORP,127
CHINA PETROLEUM & CHEMICAL,127
TEIJIN LTD,126
HITACHI METALS LTD,126
FRAUNHOFER GES FORSCHUNG,126
ROHM & HAAS,125
UNION CARBIDE CORP,124
NGK INSULATORS LTD,124
YOKOHAMA RUBBER CO LTD,123
VICTOR COMPANY OF JAPAN,122
UNIV DALIAN TECH,122
JFE STEEL CORP,120
UNIV HUAZHONG SCIENCE TECH,119
UNIV CENTRAL SOUTH,119
YAMAHA CORP,118
TOTO LTD,118
UNITED TECHNOLOGIES CORP,118
SANYO PRODUCT CO LTD,117
UNIV KUNMING SCIENCE & TECHNOLOGY,117
DOW GLOBAL TECHNOLOGIES LLC,116
PANASONIC IP MAN CORP,116
MITSUBISHI RAYON CO,114
ROHM CO LTD,114
UNIV ZHEJIANG TECHNOLOGY,114
SHOWA DENKO KK,114
GUANGDONG POWE

2025-01-16 13:54:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 13:54:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 13:54:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 13:54:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-16 13:54:39 - snowflake.connector.connection - INFO - closed
2025-01-16 13:54:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 13:55:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 13:55:01 - root - INFO - ```sql
SELECT f1.value:"name"::STRING AS "assignee_name",
       SUBSTRING(t."filing_date"::STRING, 1, 4) AS "filing_year",
       COUNT(DISTINCT t."application_number") AS "num_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f1,
     LATERAL FLATTEN(input => t."cpc") f2
WHERE f2.value:"code"::STRING LIKE 'A61%'
GROUP BY f1.value:"name"::STRING, SUBSTRING(t."filing_date"::STRING, 1, 4)
ORDER BY "num_applications" DESC
LIMIT 1000;
```
2025-01-16 13:55:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 13:55:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 13:55:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 13:55:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 13:55:02 - snowflake.connector.connection - INFO - closed
2025-01-16 13:55:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 13:55:03 - root - INFO - SQL:
SELECT f1.value:"name"::STRING AS "assignee_name",
       SUBSTRING(t."filing_date"::STRING, 1, 4) AS "filing_year",
       COUNT(DISTINCT t."application_number") AS "num_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f1,
     LATERAL FLATTEN(input => t."cpc") f2
WHERE f2.value:"code"::STRING LIKE 'A61%'
GROUP BY f1.value:"name"::STRING, SUBSTRING(t."filing_date"::STRING, 1, 4)
ORDER BY "num_applications" DESC
LIMIT 1000;
Results:
Too long, hard cut:
assignee_name,filing_year,num_applications
KONINKLIJKE PHILIPS NV,2018,15
PROCTER & GAMBLE,1997,15
NOVARTIS AG,2006,13
UNIV CALIFORNIA,2020,12
NOVARTIS AG,2011,11
COVIDIEN LP,2020,11
PROCTER & GAMBLE,2000,11
OLYMPUS CORP,2016,11
FUJIFILM CORP,2019,11
UNIV CALIFORNIA,2019,10
PROCTER & GAMBLE,1999,10
NOVARTIS AG,2014,10
PROCTER & GAMBLE,1998,10
COVIDIEN LP,2016,10
HOFFMANN LA ROCHE,2006,9
NOVARTIS AG,2007,9
GENENTECH INC,2002,9
PFIZER,2015,9
ETHICON LLC,2019,9
KONINKL PHILIPS ELECTRONICS NV,2010,9
HOFFMANN LA ROCHE,2003,9
HOFFMANN LA ROCHE,2008,9
OREAL,1995,9
NOVARTIS AG,2008,9
KONINKLIJKE PHILIPS NV,2016,9
COVIDIEN LP,2017,8
SMITHKLINE BEECHAM CORP,1998,8
BAYER AG,2001,8
COVIDIEN LP,2019,8
PROCTER & GAMBLE,1996,8
BOEHRINGER INGELHEIM INT,2009,8
KONINKLIJKE PHILIPS NV,2019,8
HOFFMANN LA ROCHE,2002,8
OLYMPUS CORP,2017,8
SIEMENS HEALTHCARE GMBH,2019,8
OLYMPUS MEDICAL SYSTEMS CORP,2008,8
HOFFMANN LA ROCHE,2004,8
PROCTER & GAMBLE,2016,8
HOFFMANN LA ROCHE,2001,8
SANOFI AVENTIS,2007,8
ASTRAZENECA AB,2001,8
LILLY CO ELI,1998,8
PFIZER,1993,7
PROCTER & GAMBLE,2008,7
US HEALTH,2018,7
UNIV CALIFORNIA,2018,7
FUJIFILM CORP,2020,7
PROCTER & GAMBLE,2007,7
BAYER AG,1993,7
KONINKL PHILIPS ELECTRONICS NV,2008,7
GENENTECH INC,2018,7
PFIZER,1990,7
OREAL,2005,7
ETHICON ENDO SURGERY INC,2014,7
NOVARTIS AG,2015,7
NOVARTIS AG,2005,7
KIMBERLY CLARK CO,1999,7
NOVARTIS AG,2020,7
PFIZER PROD INC,2001,7
ASTRAZENECA AB,2005,7
HOFFMANN LA ROCHE,2019,7
BRISTOL MYERS SQUIBB CO,2002,7
WYETH CORP,2006,7
LILLY CO ELI,1994,7
ASTRAZENECA AB,2007,7
PROCTER & GAMBLE,2012,7
TYCO HEALTHCARE,2010,7
KONINKLIJKE PHILIPS NV,2020,7
PROCTER & GAMBLE,2017,7
HOFFMANN LA ROCHE,2009,7
PROCTER & GAMBLE,2006,7
KONINKLIJKE PHILIPS NV,2021,7
HOECHST AG,1992,7
ETHICON ENDO SURGERY LLC,2016,6
HOFFMANN LA ROCHE,2021,6
TOSHIBA MEDICAL SYS CORP,2012,6
PHILIP MORRIS PRODUCTS SA,2016,6
UNIV TEXAS,2021,6
NOVARTIS AG,2003,6
UNIV LELAND STANFORD JUNIOR,2019,6
COVIDIEN LP,2014,6
NOVARTIS AG,2004,6
SAMSUNG ELECTRONICS CO LTD,2020,6
PFIZER,2004,6
CANON KK,2017,6
HOFFMANN LA ROCHE,2018,6
PFIZER PROD INC,1999,6
BOEHRINGER INGELHEIM PHARMA,2002,6
WYETH CORP,2004,6
JANSSEN PHARMACEUTICA NV,1998,6
COVIDIEN LP,2018,6
OREAL,2002,6
COVIDIEN LP,2012,6
UNIV CALIFORNIA,2017,6
MERCK & CO INC,2003,6
LILLY CO ELI,2017,6
ETHICON LLC,2017,6
SANOFI AVENTIS,2009,6
LILLY CO ELI,1996,6
MERCK PATENT GMBH,2004,6
HOFFMANN LA ROCHE,2020,6
OLYMPUS CORP,2018,6
OREAL,2019,6
EDWARDS LIFESCIENCES CORP,2023,6
PROCTER & GAMBLE,1995,6
TYCO HEALTHCARE,2009,6
OREAL,2015,6
CENTRE NAT RECH SCIENT,2014,6
HOFFMANN LA ROCHE,2007,6
MEDTRONIC INC,2021,6
SMITHKLINE BEECHAM PLC,1998,6
BRISTOL MYERS SQUIBB CO,2003,6
HOFFMANN LA ROCHE,2014,6
MERCK PATENT GMBH,2002,6
ETHICON ENDO SURGERY INC,2011,6
LILLY CO ELI,2012,6
UNIV CALIFORNIA,2023,6
NOVARTIS AG,2002,6
BIOSENSE WEBSTER ISRAEL LTD,2019,6
BRISTOL MYERS SQUIBB CO,2013,6
OREAL,1999,6
HOFFMANN LA ROCHE,1985,6
NOVARTIS AG,2019,6
HOFFMANN LA ROCHE,2015,6
PFIZER PROD INC,2002,6
UNI CHARM CORP,2003,6
GLAXOSMITHKLINE IP DEV LTD,2015,6
OREAL,2006,6
MERCK PATENT GMBH,2003,6
GENENTECH INC,2008,6
ASTRA AB,1996,5
COLGATE PALMOLIVE CO,2008,5
BOEHRINGER INGELHEIM VETMEDICA GMBH,2020,5
SANOFI SA,2009,5
LG HOUSEHOLD & HEALTH CARE LTD,2015,5
FUJIFILM CORP,2010,5
PROCTER & GAMBLE,1994,5
HOECHST AG,1993,5
OREAL,2004,5
UPJOHN CO,2001,5
DU PONT PHARM CO,1999,5
FUJIFILM CORP,2021,5
TAKEDA PHARMACEUTICALS CO,2018,5
GEN ELECTRIC,2011,5
INTUITIVE SURGICAL OPERATIONS,2019,5
OREAL,1988,5
HOFFMANN LA ROCHE,1999,5
SMITHKLINE BEECHAM CORP,1997,5
KONINKLIJKE PHILIPS NV,2017,5
PROCTER & GAMBLE,1990,5
BRISTOL MYERS SQUIBB CO,2020,5
SANOFI AVENTIS DEUTSCHLAND,2012,5
SAMSUNG ELECTRONICS CO LTD,2017,5
CENTRE NAT RECH SCIENT,2021,5
SCHERING CORP,1999,5
COLGATE PALMOLIVE CO,2015,5
MERCK & CO INC,1992,5
KIMBERLY CLARK CO,2001,5
TOSHIBA MEDICAL SYS CORP,2013,5
BAYER AG,1983,5
NOVARTIS AG,2013,5
PROCTER & GAMBLE,1991,5
SIEMENS AG,2004,5
KONINKLIJKE PHILIPS NV,2015,5
JANSSEN PHARMACEUTICA NV,2008,5
PROCTER & GAMBLE,2015,5
BECTON DICKINSON CO,2014,5
KONINKLIJKE PHILIPS NV,2013,5
BOEHRINGER INGELHEIM INT,2010,5
BAYER AG,2019,5
WYETH CORP,2008,5
KIMBERLY CLARK CO,2002,5
HOECHST AG,1981,5
OREAL,2003,5
INST NAT SANTE RECH MED,2021,5
LILLY CO ELI,1981,5
COLGATE PALMOLIVE CO,2010,5
CILAG GMBH INT,2019,5
OLYMPUS CORP,2005,5
ASTRAZENECA AB,2008,5
ASTRAZENECA AB,2010,5
AMGEN INC,2017,5
BECTON DICKINSON CO,2018,5
MERCK & CO INC,1986,5
LILLY CO ELI,2009,5
PFIZER PROD INC,1998,5
FUJIFILM CORP,2009,5
TERUMO CORP,2018,5
ABBOTT LAB,2006,5
KIMBERLY CLARK CO,2003,5
SAMSUNG ELECTRONICS CO LTD,2015,5
OLYMPUS CORP,2019,5
MERCK PATENT GMBH,2000,5
TERUMO CORP,2019,5
PROCTER & GAMBLE,2014,5
PFIZER,1982,5
SANOFI AVENTIS DEUTSCHLAND,2011,5
ARRAY BIOPHARMA INC,2009,5
COVIDIEN LP,2015,5
AVENTIS PHARMA SA,1999,5
PHILIP MORRIS PRODUCTS SA,2014,5
ALLERGAN INC,2010,5
HOECHST AG,1997,5
BECTON DICKINSON CO,2011,5
WARNER LAMBERT CO,1987,5
DEXCOM INC,2019,5
HOFFMANN LA ROCHE,2010,5
UNI CHARM CORP,2005,5
SCIMED LIFE SYSTEMS INC,2001,5
JANSSEN PH

2025-01-16 13:55:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 13:55:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 13:55:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 13:55:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-16 13:55:04 - snowflake.connector.connection - INFO - closed
2025-01-16 13:55:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 13:56:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 13:56:13 - root - INFO - ```sql
SELECT f1.value:"name"::STRING AS "assignee_name",
       SUBSTRING(t."filing_date"::STRING, 1, 4) AS "filing_year",
       COUNT(DISTINCT t."application_number") AS "num_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f1,
     LATERAL FLATTEN(input => t."ipc") f2
WHERE f2.value::STRING LIKE '%A61%'
GROUP BY f1.value:"name"::STRING, SUBSTRING(t."filing_date"::STRING, 1, 4)
ORDER BY "num_applications" DESC
LIMIT 1000;
```
2025-01-16 13:56:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 13:56:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 13:56:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 13:56:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 13:56:15 - snowflake.connector.connection - INFO - closed
2025-01-16 13:56:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 13:56:16 - root - INFO - SQL:
SELECT f1.value:"name"::STRING AS "assignee_name",
       SUBSTRING(t."filing_date"::STRING, 1, 4) AS "filing_year",
       COUNT(DISTINCT t."application_number") AS "num_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f1,
     LATERAL FLATTEN(input => t."ipc") f2
WHERE f2.value::STRING LIKE '%A61%'
GROUP BY f1.value:"name"::STRING, SUBSTRING(t."filing_date"::STRING, 1, 4)
ORDER BY "num_applications" DESC
LIMIT 1000;
Results:
Too long, hard cut:
assignee_name,filing_year,num_applications
PROCTER & GAMBLE,1997,16
FUJIFILM CORP,2019,14
KONINKLIJKE PHILIPS NV,2018,13
UNION HOSPITAL TONGJI MEDICAL COLLEGE HUAZHONG UNIV SCI & TECH,2019,13
PROCTER & GAMBLE,1998,12
OLYMPUS CORP,2016,12
NOVARTIS AG,2006,12
PROCTER & GAMBLE,1999,11
COVIDIEN LP,2020,11
COVIDIEN LP,2016,10
JIANGSU PROVINCE HOSPITAL FIRST AFFILIATED HOSPITAL WITH NANJING MEDICAL UNIV,2021,10
UNION HOSPITAL TONGJI MEDICAL COLLEGE HUAZHONG UNIV SCI & TECH,2020,10
ETHICON LLC,2019,9
KONINKL PHILIPS ELECTRONICS NV,2010,9
OREAL,1995,9
PROCTER & GAMBLE,2000,9
NOVARTIS AG,2011,9
HOFFMANN LA ROCHE,2001,9
UNIV CALIFORNIA,2020,9
OLYMPUS MEDICAL SYSTEMS CORP,2008,9
ASTRAZENECA AB,2001,9
XIANGYA HOSPITAL CENTRAL SOUTH UNIV,2020,9
UNIV PLA 3RD MILITARY MEDICAL,2016,9
COVIDIEN LP,2019,8
PROCTER & GAMBLE,2016,8
LILLY CO ELI,1998,8
SMITHKLINE BEECHAM CORP,1998,8
LILLY CO ELI,1981,8
HOFFMANN LA ROCHE,2002,8
COVIDIEN LP,2017,8
BAYER AG,2001,8
UNIV CALIFORNIA,2019,8
KONINKLIJKE PHILIPS NV,2016,8
PROCTER & GAMBLE,1996,8
BOEHRINGER INGELHEIM INT,2009,8
HOFFMANN LA ROCHE,2003,8
PFIZER,1993,8
PROCTER & GAMBLE,2006,7
SMITHKLINE BEECHAM CORP,1997,7
GENENTECH INC,2002,7
PROCTER & GAMBLE,2017,7
PROCTER & GAMBLE,2008,7
OLYMPUS CORP,2005,7
OLYMPUS CORP,2017,7
TYCO HEALTHCARE,2010,7
PFIZER PROD INC,2001,7
NOVARTIS AG,2007,7
SIEMENS HEALTHCARE GMBH,2019,7
KONINKLIJKE PHILIPS NV,2019,7
BRISTOL MYERS SQUIBB CO,2003,7
ETHICON ENDO SURGERY INC,2014,7
FUJIFILM CORP,2020,7
KONINKLIJKE PHILIPS NV,2021,7
LILLY CO ELI,1994,7
FUJIFILM CORP,2010,7
UNIV CALIFORNIA,2017,7
WYETH CORP,2004,7
OLYMPUS CORP,2003,7
HOECHST AG,1992,7
BRISTOL MYERS SQUIBB CO,2002,7
OLYMPUS OPTICAL CO,1993,7
UNI CHARM CORP,2003,7
NOVARTIS AG,2008,7
NOVARTIS AG,2003,7
HOFFMANN LA ROCHE,2004,7
SANOFI AVENTIS,2007,7
NOVARTIS AG,2014,7
UNIV CALIFORNIA,2018,7
PFIZER,2015,7
OREAL,2005,7
PFIZER,1990,7
BAYER AG,1993,7
SHIMADZU CORP,1996,7
HOFFMANN LA ROCHE,2008,7
HOFFMANN LA ROCHE,2006,7
UNIV JILIN,2020,7
CHINESE PLA GENERAL HOSPITAL,2020,7
KIMBERLY CLARK CO,1999,6
NOVARTIS AG,2002,6
ETHICON LLC,2017,6
HOFFMANN LA ROCHE,1985,6
OREAL,1999,6
SIEMENS AG,2006,6
PFIZER,1996,6
ASTRAZENECA AB,2008,6
BIOSENSE WEBSTER ISRAEL LTD,2019,6
WYETH CORP,2006,6
UNIV WUHAN,2020,6
MERCK PATENT GMBH,2003,6
KONINKLIJKE PHILIPS NV,2020,6
UNIV PLA AIR FORCE MEDICAL,2020,6
OREAL,2002,6
EDWARDS LIFESCIENCES CORP,2023,6
COVIDIEN LP,2018,6
FIRST AFFILIATED HOSPITAL ZHENGZHOU UNIV,2019,6
MERCK & CO INC,2003,6
UNIV LELAND STANFORD JUNIOR,2019,6
BAYER AG,1995,6
ABBOTT LAB,2006,6
ETHICON ENDO SURGERY INC,2011,6
UPJOHN CO,2001,6
OREAL,2015,6
MERCK PATENT GMBH,2002,6
PROCTER & GAMBLE,2007,6
COVIDIEN LP,2012,6
OLYMPUS OPTICAL CO,1987,6
ASTRAZENECA AB,2007,6
PROCTER & GAMBLE,2012,6
PFIZER,2004,6
OREAL,2019,6
RHONE POULENC RORER SA,1996,6
FUJIFILM CORP,2021,6
MEDTRONIC INC,2021,6
CANON KK,2017,6
FUJIFILM CORP,2008,6
UNIV TEXAS,2021,6
BOEHRINGER INGELHEIM PHARMA,2002,6
NOVARTIS AG,2020,6
JANSSEN PHARMACEUTICA NV,1998,6
OLYMPUS CORP,2018,6
TYCO HEALTHCARE,2009,6
GENENTECH INC,2018,6
TOSHIBA MEDICAL SYS CORP,2012,6
CHINESE PEOPLE'S LIBERATION ARMY AIR FORCE MILITARY MEDICAL UNIV,2022,6
SMITHKLINE BEECHAM PLC,1998,6
OREAL,2014,6
COVIDIEN LP,2014,6
BAYER AG,1997,6
MERCK PATENT GMBH,2004,6
FIRST PEOPLES HOSPITAL CHANGZHOU,2018,6
LILLY CO ELI,1996,6
TOSHIBA CORP,1989,6
ETHICON ENDO SURGERY LLC,2016,6
TOSHIBA MEDICAL SYS CORP,2013,6
GLAXOSMITHKLINE IP DEV LTD,2015,6
PFIZER PROD INC,2002,6
PROCTER & GAMBLE,1995,6
TAKEDA PHARMACEUTICALS CO,2018,5
CILAG GMBH INT,2019,5
BOEHRINGER INGELHEIM INT,2010,5
LILLY CO ELI,1997,5
HOECHST AG,1993,5
ICI PLC,1989,5
AVENTIS PHARMA SA,1999,5
HOECHST AG,1985,5
BAYER AG,1983,5
PFIZER,1982,5
NOVARTIS AG,2019,5
SAMSUNG ELECTRONICS CO LTD,2017,5
KONICA MINOLTA INC,2020,5
HOFFMANN LA ROCHE,2009,5
ASTRAZENECA AB,2005,5
AMGEN INC,2017,5
PEKING UNION MEDICAL COLLEGE HOSPITAL CAMS,2019,5
WARNER LAMBERT CO,1987,5
OREAL,2003,5
SCHERING CORP,1999,5
HOFFMANN LA ROCHE,2007,5
NANJING FIRST HOSPITAL,2020,5
ETHICON LLC,2018,5
PROCTER & GAMBLE,1986,5
KONINKLIJKE PHILIPS NV,2015,5
UNIV PEKING SHENZHEN HOSPITAL,2018,5
WEST CHINA HOSPITAL SICHUAN UNIV,2020,5
SHISEIDO CO LTD,2010,5
COVIDIEN LP,2015,5
BRISTOL MYERS CO,1986,5
SANOFI AVENTIS DEUTSCHLAND,2012,5
KIMBERLY CLARK CO,2001,5
MERCK & CO INC,1992,5
HOECHST AG,1997,5
PROCTER & GAMBLE,2015,5
KONINKLIJKE PHILIPS NV,2017,5
OLYMPUS CORP,2015,5
NOVARTIS AG,2015,5
PFIZER,1994,5
TERUMO CORP,2018,5
WEST CHINA HOSPITAL SICHUAN UNIV,2022,5
ASTRA AB,1995,5
CENTRE NAT RECH SCIENT,2014,5
KIMBERLY CLARK CO,2013,5
TERUMO CORP,2019,5
HOFFMANN LA ROCHE,2014,5
OLYMPUS OPTICAL CO,2002,5
UNIV LELAND STANFORD JUNIOR,2005,5
UNI CHARM CORP,2005,5
BECTON DICKINSON CO,2014,5
FIRST HOSPITAL CHINA MEDICAL UNIV,2019,5
SANOFI AVENTIS DEUTSCHLAND,2014,5
PROCTER & GAMBLE,1991,5
HOFFMANN LA ROCHE,2020,5
OLYMPUS CORP,2002,5
LUOHE NO 1 PEOPLES HOSPITAL,2020,5
TAIZHOU ENZE MEDICAL CT GROUP,2021,5
HOFFMANN LA ROCHE,1979,5
LILLY CO ELI,2017,5
BOEHRINGER INGELHEIM VETMEDICA GMBH,2020,5


2025-01-16 13:56:16 - root - INFO - itercount: 0
2025-01-16 13:56:16 - root - INFO - Database Name: PATENTS
Schema Name: PATENTS
DDL describes table information.
,0
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,1
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""spif_publication_number"" VARCHAR(16777216),
	""spif_application_number"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""claims_localized_html"" VARIANT,
	""description_localized"" VARIANT,
	""description_localized_html"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""locarno"" VARIANT,
	""citation"" VARIANT,
	""parent"" VARIANT,
	""child"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,2
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table:** `PATENTS.PATENTS.PUBLICATIONS`
  - **"cpc"**: Used to find applications in patent category 'A61' by examining CPC codes.
  - **"assignee_harmonized"**: Contains information about the assignees; used to identify assignees with the most applications.
  - **"filing_date"**: Used to extract the year when applications were filed.
  - **"application_number"**: Unique identifier for each patent application.

**Conditions that may be used:**

- **CPC Category Filter**: CPC codes starting with 'A61' to find relevant patents.
- **Assignee Extraction**: Extract assignee names from the "assignee_harmonized" VARIANT column.
- **Year Extraction**: Extract the year from the "filing_date" column.
- **Fuzzy Matching**: Use `LIKE` with `%` to perform fuzzy matching on strings.
- **Data Limitation**: Limit results to 1000 rows for each query.

---

**SQL Queries:**

```sql
-- Query 1: View distinct CPC codes in the "cpc" column
SELECT DISTINCT f.value::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
LIMIT 1000;
```

---

```sql
-- Query 2: View distinct CPC codes starting with 'A61'
SELECT DISTINCT f.value::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::STRING LIKE 'A61%'
LIMIT 1000;
```

---

```sql
-- Query 3: View distinct assignee names from "assignee_harmonized"
SELECT DISTINCT f.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."assignee_harmonized") f
LIMIT 1000;
```

---

```sql
-- Query 4: Extract filing years from "filing_date"
SELECT DISTINCT TO_VARCHAR(TO_DATE(t."filing_date"::STRING, 'YYYYMMDD'), 'YYYY') AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE TRY_TO_DATE(t."filing_date"::STRING, 'YYYYMMDD') IS NOT NULL
LIMIT 1000;
```

---

```sql
-- Query 5: Get application numbers for applications in category 'A61'
SELECT DISTINCT t."application_number"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::STRING LIKE 'A61%'
LIMIT 1000;
```

---

```sql
-- Query 6: Get assignee names and application numbers for applications in 'A61'
SELECT DISTINCT t."application_number", f1.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f1,
     LATERAL FLATTEN(input => t."cpc") f2
WHERE f2.value::STRING LIKE 'A61%'
LIMIT 1000;
```

---

```sql
-- Query 7: Count number of applications per assignee in 'A61'
SELECT f1.value:"name"::STRING AS "assignee_name", COUNT(DISTINCT t."application_number") AS "num_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f1,
     LATERAL FLATTEN(input => t."cpc") f2
WHERE f2.value::STRING LIKE 'A61%'
GROUP BY f1.value:"name"::STRING
LIMIT 1000;
```

---

```sql
-- Query 8: Get filing years for applications in 'A61'
SELECT DISTINCT TO_VARCHAR(TO_DATE(t."filing_date"::STRING, 'YYYYMMDD'), 'YYYY') AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
WHERE f.value::STRING LIKE 'A61%' AND TRY_TO_DATE(t."filing_date"::STRING, 'YYYYMMDD') IS NOT NULL
LIMIT 1000;
```

---

```sql
-- Query 9: Get the number of applications per year for each assignee in 'A61'
SELECT f1.value:"name"::STRING AS "assignee_name",
       TO_VARCHAR(TO_DATE(t."filing_date"::STRING, 'YYYYMMDD'), 'YYYY') AS "filing_year",
       COUNT(DISTINCT t."application_number") AS "num_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f1,
     LATERAL FLATTEN(input => t."cpc") f2
WHERE f2.value::STRING LIKE 'A61%' AND TRY_TO_DATE(t."filing_date"::STRING, 'YYYYMMDD') IS NOT NULL
GROUP BY f1.value:"name"::STRING, TO_VARCHAR(TO_DATE(t."filing_date"::STRING, 'YYYYMMDD'), 'YYYY')
LIMIT 1000;
```

---

```sql
-- Query 10: Get top assignees by number of applications in 'A61' (descending order)
SELECT f1.value:"name"::STRING AS "assignee_name", COUNT(DISTINCT t."application_number") AS "num_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f1,
     LATERAL FLATTEN(input => t."cpc") f2
WHERE f2.value::STRING LIKE 'A61%'
GROUP BY f1.value:"name"::STRING
ORDER BY "num_applications" DESC
LIMIT 1000;
```

---

These queries help in understanding the values in the relevant columns and how they can be used to solve the task. They extract distinct CPC codes, assignee names, filing years, and count the number of applications, adhering to the conditions specified.Query:
-- Query 1: View distinct CPC codes in the "cpc" column
SELECT DISTINCT f.value::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
LIMIT 1000;
Answer:
Too long, hard cut:
cpc_code
"{""code"":""G02B7/16"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""H04N23/66"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""Y02A50/30"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61P31/18"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61K31/506"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H04B1/1036"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G11B2005/0002"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""H01H9/161"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G01D3/022"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G11B7/0945"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B29C65/524"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""B29C66/721"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01L23/48"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""B41J2/04581"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G11C7/12"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""G01B11/2522"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61M25/01"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61P31/16"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H03K19/17764"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""D04H1/407"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""F05D2260/30"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""C08K5/52"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G06N10/40"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""H02K3/18"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01Q9/045"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A23C21/02"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""B41J25/3088"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""C07D311/12"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A01G5/06"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B60R21/20"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B29C53/063"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B65D63/08"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61L2/18"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""G09F23/105"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G06N20/00"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""A61K35/32"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""F02B37/14"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B01D2257/702"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""H01M2010/4278"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G08G1/161"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A47C7/282"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H04N17/04"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G05B19/4185"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""B60L2240/80"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61B8/06"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01L24/83"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""H01L2224/05184"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A44C5/145"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G02B27/144"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""D06M13/368"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G07C9/00309"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H01H51/2254"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""F16B33/008"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""A61K39/4613"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G09F2013/222"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G03B2205/0015"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""C22C38/48"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H04B1/04"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""A61J7/0076"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G02B6/4467"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""G06F3/0619"",""first"":true,""inventive"":true,""tree"":[]}"
"{""code"":""H04N23/672"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""H04N23/951"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""E04B2/763"",""first"":false,""inventive"":true,""tree"":[]}"
"{""code"":""H04M2250/02"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G06F2212/281"",""first"":false,""inventive"":false,""tree"":[]}"
"{""code"":""G02F1/13394"",""first"":true,""inve
Query:
SELECT DISTINCT f.value:"code"::STRING AS "cpc_code"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."cpc") f
LIMIT 1000;
Answer:
Too long, hard cut:
cpc_code
H05K2203/1327
H04B1/0057
G06T19/006
H01L21/50
B32B27/308
B32B27/32
C09D7/65
C01B9/04
H01L21/76849
A61G13/02
G06K9/00369
G06F40/279
H04B7/086
B32B37/12
G01N15/14
H04W72/542
A61K31/282
G01D11/245
G01D21/00
F16F9/19
H04W64/00
H01L45/08
H02J7/04
H01L21/823437
F41C23/04
F02D2250/36
C04B2111/40
F02B67/00
H01L24/19
C07F15/0093
G01N15/1459
G02B27/0172
F02M26/00
F24D2220/042
A61K2300/00
Y02P70/10
C23C18/24
Y02T70/10
C07K5/06034
F21V5/008
C07F15/025
A61K39/0017
A61B17/3468
A63C10/24
F16L3/1236
B29C70/003
H04M19/08
F22G7/14
C08F299/065
C09K5/063
B82Y40/00
H01L21/3065
H04N2201/3278
C09D11/17
H04L67/10
H04L41/22
H01M8/04671
B29C48/913
H05K7/20545
H04M3/42314
G01N33/74
C08G65/30
A01K2207/15
C08L77/06
C07F7/126
F24H9/02
G06Q50/02
H04N21/4147
H01M4/62
E05B17/0058
A61K31/439
A23K20/24
B60W2710/083
A47C1/032
B62D1/185
E02F9/2217
C22C21/08
B32B2307/746
G02B1/18
G06T2207/10088
A61L2/10
A61N5/0616
G06F2201/88
G06K9/2063
E04F13/06
H04N19/159
G06T9/004
G06F2009/4557
H04N19/114
A61M25/1027
C09D5/00
F05D2260/98
F02C7/266
G07C5/008
G09G2330/023
A61K31/065
A43B1/0009
A47J31/18
D04H1/587
A61B2017/07257
A61K2800/5426
B23K2103/02
B23K35/3053
G10L15/08
G06F19/3475
B01D61/10
H01L24/09
H03K3/84
G01K7/42
A61B17/0401
G06F9/3808
E21B43/084
C30B25/10
F04B1/12
H01L27/3272
F02B2053/005
C09J2489/00
A43B13/125
A23L19/00
G02B27/0093
B66D1/14
G06F1/1626
H01S3/076
H04L45/02
G03G15/5041
A61K31/195
G06Q30/0278
A61L27/50
H01M4/381
B21B45/004
A61H2201/0157
G11C29/52
A63F2300/63
G06Q30/0267
B01D53/268
G06T2207/20021
C30B25/18
E04H15/06
G16H20/40
G06F2203/04105
A23K40/30
B29C55/04
G01S2205/01
G06F16/43
B01J35/56
H02J50/20
H01L33/145
C12N15/1065
C12N2310/20
B01D53/263
F02N2200/022
H04B5/0087
B33Y50/00
D07B2201/2043
A61L29/14
A46B7/044
H02P7/29
E05B45/12
H04B17/382
A23L27/20
Y10T29/49885
A47C1/12
G02B2027/0165
A61B17/12109
F41H5/0471
C04B38/0022
B01D1/221
E06B9/171
H04N9/888
C07D231/14
B60G17/0152
B60G2202/42
A47C4/286
E01C19/176
F02M59/48
H01J2237/221
H02J7/0063
H01M16/00
C09J7/00
A61F5/56
C04B2201/10
B01D39/2017
B32B27/28
A61M1/3427
B63C11/18
G01N2223/6116
B41K1/58
B63B2704/00
B60Y2200/92
A63F2300/8047
G06T2207/20092
E01C15/00
C08F2/001
H10K59/129
H01L27/0292
A46B13/02
F16K15/18
C04B33/34
H04Q1/144
F04C2/344
D21D5/24
G06F17/30876
A61B2017/00353
B23K26/127
H03M13/2792
C04B35/6261
B63B13/02
A41C1/00
B01D2253/108
B23K2101/42
B60W10/10
H04J11/0093
B60L58/30
F23R3/286
G06V20/58
B32B2457/20
H04L69/04
G06F2203/04112
G02B5/3033
D02J1/08
G06F17/30138
G07F11/10
B03B4/005
G01J3/108
Y10T83/8716
F24F3/153
F23Q2/32
B44C5/0407
C08K3/24
B65D47/2037
H04L9/00
E06B9/15
E21B47/01
B29C2949/08
B67B7/44
F16H61/30
B29D22/00
B65H21/00
B23B27/22
B64C3/54
C07C323/44
F25D23/065
F01D5/025
F01N13/001
H01H67/06
B29C73/02
G06F16/2471
H02G15/013
A61K49/0036
B60L2240/545
H01L23/3675
C03B37/0124
C12N2500/02
A61M2037/0023
A61M2037/0046
B25J19/021
H04N19/85
G06F3/0655
C22C38/10
A63B69/0059
H04L12/1822
G01V2210/244
Y10T409/307672
B23K35/286
G01J3/04
B23K35/325
A61B2017/2904
A61B2090/037
A61K49/0065
H04B1/71632
G06F9/44505
B65G47/71
H01L29/7889
B60L3/0069
A61M2025/0226
C09J7/02
A61N1/36135
A61N1/37217
C10N2040/42
H01L33/486
B67D3/0029
A61B1/31
H01L33/10
Y10T137/8593
A61H2230/10
F16C2300/34
Y10T29/49032
B81B2201/042
C09J163/00
B60S1/3887
A63F13/56
G02F1/133317
B01J2219/0801
H03K17/693
A61K47/59
C04B35/63428
B27G19/04
C12Q2525/307
C07C213/06
A61C3/025
A61K51/1251
C08G64/22
A47B47/005
A61K36/233
G01J5/10
A61K36/232
B67D1/0009
B67D1/0412
B60P1/34
B65G1/0478
H04W36/0064
G06N3/067
A61F2/2466
A61L2/238
G06F18/217
H02H3/343
B01D2258/014
H03K5/135
H04L41/0816
H04L43/0811
F02D41/1462
H01L2924/20753
Y10T428/24702
F42C19/00
G11C2013/0092
A61B8/485
H02K1/187
F05D2240/303
F16H37/12
B23D45/048
Y10S901/36
H02M1/0054
H01S5/028
B29C2045/1741
H05K13/08
H03F3/20
G06F3/06
C08G59/621
H04N23/611
H02K3/345
F16H2025/2481
H01L43/10
H01L2224/05157
A61B5/4504
G02B6/06
H01L2224/03462
A61H2201/1436
C23F13/005
H05K3/426
F24C15/2035
Y02P30/00
H04W36/0016
A61M1/1524
H04K3/224
C01B3/42
G03G15/04054
A61M60/40
A61B2017/2906
H03K19/17764
F16L1/10
G06Q10/047
H04L12/2856
A61B2017/0464
G11B20/1879
G06F21/31
C08F251/02
A43B17/026
Y10T29/49989
B01D2256/10
B25B27/06
C09K9/02
G06T2207/10012
G08B13/1427
A61N1/378
G06T2207/30024
B65H2403/73
E05B77/38
B60W2556/65
G01S19/37
G02F1/133621
G06V40/197
H04N1/00708
G06N3/0418
G05D1/24
H01L21/187
H01L27/11514
H02K33/02
B65D25/108
Y10T83/155
A61K39/001103
H04L2012/5614
H05K2201/09736
A61B5/0836
F02M63/0078
B22D11/0406
A61K31/4172
H01L2224/82101
B65D5/241
B65D5/2019
H01L24/40
B65H2801/31
C21B2400/08
F04C18/16
C12Y302/01091
A61B8/5253
G01N21/8806
H10N70/884
C07F15/0046
C12Q1/04
F16F7/123
B01D2257/404
H04N9/3114
H04M1/0216
B60L2240/507
G02B5/3008
C08G75/045
A61M25/003
C08G63/00
C09J9/00
H01J37/32669
C04B2111/00767
F15B2211/265
G02B17/0812
G06F2200/1633
H01M50/533
G06F17/241
A63B45/00
F16C2316/10
H01M8/0606
A61F2002/91591
B65D2575/329
A61F2013/00246
B01D46/69
B32B2307/584
G16B20/10
H04N19/96
H01H13/81
C09D5/1668
F25C5/182
A61H2201/123
B24D3/002
C07F7/0838
C07D211/66
H04B1/18
A63B21/0407
H04W36/
Query:
-- Query 3: View distinct assignee names from "assignee_harmonized"
SELECT DISTINCT f.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t, LATERAL FLATTEN(input => t."assignee_harmonized") f
LIMIT 1000;
Answer:
Too long, hard cut:
assignee_name
PREC BIOSCIENCES INC
STANLEY WORKS LTD
CAMURUS AB
WWT SPOLKA Z OGRANICZONA ODPOWIEDZIALNOSCIA
EISEN EIKO
WISTRON NEWEB CORP
UST INC
UNIV ANGERS
CHUNG CHI Y
ZHU MIN
SUMNER MICHAEL
BERNARD MARC R
HRA PHARMA LAB
GANZHOU HEMAY PHARMACEUTICAL CO
SURROZEN OPERATING INC
KIMBERLY CLARK CO
VIGIL NEUROSCIENCE INC
ROCKWOOL INT
OMNISYSTEM CO LTD
AGCO DO BRASIL SOLUCOES AGRICOLAS LTDA
KOREA INST OCEAN SCI & TECH
MATHUR BHAVNA
VARTIAINEN PANU
KAN GEORGE L
SUN HAO
KOO YEON KWAN
ADVANCED BIONICS LLC
MICROELECTRONICS TECH INC
MARTIN DOMINIC R
BRUKER BIOSPIN AG
SOROCO PRIVATE LTD
NIKE INC
Turner Tackle LLC
WAGNER JOACHIM
TOOLTECH LLC
ATOTECH DEUTSCHLAND GMBH
AJINOMOTO KK
HIKMET RIFAT A M
AUYOUNG ALVIN
CHEVRON ORONITE SAS
UNIV MACAU
H4X EU
FUNDACION INSTITUTO DE INVESTIG SANITARIA FUNDACION JIMENEZ DIAZ
COGNEX CORP
WIRTGEN GMBH
AUE TEXTILMASCHINENBAU GMBH
OTKRYTOE AKTSIONERNOE OBSHCHESTVO INFORMATSIONNYE TEKH I KOMMUNIKATSIONNYE SISTEMY
ACTION ELIZABETH
RATKAY ALECSEU
EXXON RESEARCH ENGINEERING CO
FOSTER WHEELER ENERGY CORP
LAESSER FRANZ AG
KORPORATSIJA MASTERNEHT AOZT
HOWELL THOMAS A
SHIM JAE J
MEGURO TAKESHI
ARNEY SHANE R
UBE MAT IND LTD
POORNACHANDRAN RAJESH
OOI TETSUYA
SCHUMACHER DONALD J
DECKARD CARL
TAPIA MARIO G
PEREGO ANDREA
KAWANA TAKAHIRO
SERVIER LAB
GRINKEVICH ALEKSANDR VASIL EVICH
DVOEGLAZOV ALEKSEJ IVANOVICH
ASEA AB
SCHAEFER ELEKTROTECHNIK U SONDERMASCHINEN GMBH
ZIMMERMANN GISELA
SHINDENGEN ELECTRIC MFG CO
ATATUERK UENIVERSITESI BILIMSEL ARASTIRMA PROJELERI BIRIMI
LYUBEZNOV VALERIJ KONSTANTINOVICH
KODAMA NOBUTAKA
GUOZHU YE
HINTERMAIER WOLFGANG
MAURER JOHN H
PICHER PATRICK
LAMBA DIGVIJAY SINGH
LÉONARD FRANÇOIS
CARUELLE JEAN-PIERRE
ST MICROELECTRONICS ROUSSET
TERMINATOR IP LTD
TOTALENERGIES CORBION BV
KAISER GYPSUM COMPANY INC
LISTON JAMES A TRUSTEE
SYLVESTER RICHARD
WITTENBERGE NAEHMASCH VEB
BORG HOLDING A G
WARNER LAMBERT TECH
ORTH JANOSNE
FAIL SAFE IND INC
HIAB AB
MOBIPAYPOINT LTD
HEWLETT PACKARD DEVELOPMENT CO LP
ROBOPAC SPA
ROCHE DIAGNOSTICS OPERATIONS INC
HEINRICH GEORG GMBH MASCHF
BioVersys AG
JANSMA MICHAEL
BIOTA EUROPE LTD
VICENTE JOSE GERMAN
CELLULAR RES INC
JANSSEN PHARMACEUTICALS INC
DARNELL WAYNE
TECHNION RES & DEV FOUNDATION
ANALOGIC CORP
WEIR MINERALS AUSTRALIA LTD
FORMLABS INC
SUBARU CORP
LUKITO HARSOYO
MEEKER DAVID E
LARYNGEAL MASK CO LTD
MOLYNEUX STEPHEN
JOHNSON & JOHNSON SURGICAL VISION INC
BERTHIEZ C N M P
BASF PLANT SCIENCE CO GMBH
CQLT SAARGUMMI TECH SARL
HEFEI MIDEA REFRIGERATOR CO
FERROLI SPA
STEFFENS RALF
ZHANG JINGLIN
XIAMEN CHANGELIGHT CO LTD
MURATA TOSHIKI
SUMITOMO METAL MINING CO
SOLINAS MEDICAL INC
RADIABEAM TECH LLC
Evol Science LLC
MARTINEZ CANALES MONICA LUCIA
WAVE OPTICS LTD
JIANGSU SHEMAR ELECTRIC CO LTD
KANG MIN SOO
LUEDTKE OLIVER
BUONO JUAN C MR
FARGO KENDALL M
KELLER IGOR
MONOPANEL SA
ROLLERBLADE INC
GALLER KURT
TOLEDO ERAN
EL TAHER TODD
ISHITANI TOMOYA
MATERIALS & ELECTROCHEMICAL RES CORP
TERATRON GMBH
EUROPOLES GMBH & CO KG
WHITE IAN D
GOTFRIED YECHIEL
KESSLER MANFRED
STAPP SOEREN
EUROCATENE SRL
SEOK TAEK O
WOO DAE ENGINEERING CONSULTANT CO LTD
ELIESON CHAIMSONOVITZ PROSPER
MARSHALL & ILSLEY BANK
JAMES B BLACKBURN
BERACA SABARA QUIMICOS E INGRE
SWEETSER BERT M
LELAND ELECTRIC CO
NIPPON KOGAKU KK
BOGIE N
KELVINATOR CORP
REDINGTON COUNTERS INC
DANFOSS AS
STOCK EQUIPMENT CO
BISSETT & SONS LTD J
TAITO CORP
GROSS ISAK
TELEX CORP THE
TURNER BROTHERS ASBEST
HITACHI SOFTWARE ENG
REMINGTON TYPEWRITER CO
PEUGEOT
STIRN ALBERT L
JANSSEN VACCINES & PREVENTION BV
WARREN FASTENER CORP
MUELLER JOHANN
WHEELABRATOR CORP
PACIFIC MILLS
CANADIAN SAFETY FUSE COMPANY L
CARTIER JOSEPH GIDEON
OMARK INDUSTRIES INC
STICKEL CHARLES E A
NORGREN CO C A
HOLDEN ARTEMAS F
ARMSTRONG WHITWORTH CO ENG
CEBAL
WEA MFG INC
WILLIAM R BECKER
SICARI R
PERES DALMO JOSE
ALFRED CARRINGTON KENNEDY
CARL WALTHER OHG
KIOXIA CORP
BATTELLE ENERGY ALLIANCE LLC
SOLID INC
TG3D STUDIO
LIXIL SUZUKI SHUTTER CORP
EMPRESSA NAC DE MINERIA ENAMI
VELCRO IP HOLDINGS LLC
MATSUMOTO AYAKA
LODZKA FAB MASZYN JEDWABNI
ALLEN GROUP
SANNER FRIEDR GMBH CO KG
SINGAPORE CHARTERED IND
BEHR GMBH & CO KG
SPATTI GIOVANNI
BOMBAY TEXTILE RES ASS BTRA
SUZUKI MASAMI
WOONGJIN CHEMICAL CO LTD
Convida Wireless LLC
HEATON JEREMIAH
SONOS INC
REMEDEE LABS
BYSTRONIC MASCH
AFP ADVANCED FOOD PRODUCTS LLC
CHR HANSEN AS
THEKKADATH GOVINDANUNNY
SHANGHAI GUIMU ROBOT CO LTD
DEUTSCHE REICHSBAHN
TELO GENOMICS HOLDINGS CORP
POTOMAC PHOTONICS INC
TRIGEM COMPUTER INC
PARK MAN KI
UNIV FLORIDA STATE
MUSIL FRANTISEK
NGUYEN THIEN NHON DIANA
METAL IND RES & DEV CT
DAIKIN FLUOROCHEMICALS CHINA CO LTD
HOWARD DANE
LEPPIN HANS
PEUCKERT KLAUS
KIRCHNER RUDI
MITSUMI ELECTRIC CO LTD
REXROTH INDRAMAT GMBH
DYNAVAX TECH CORP
PROGRESSIVE TOOL & IND CO
MUROTA WATARU
PITCHER CHARLES SPENCER
REVIVE ENVIRONMENTAL TECHNOLOGY LLC
DROSTE RENATE
VRACAR VIKTOR
THE REGENTS OF UNIV OF CALIFORNIA
GEISER TOBIAS
YANG BONG HYUN
MITSUBISHI HITACHI POWER SYSTEMS ENV SOLUTIONS LTD
UNIV OHIO STATE
JEONG DONG HUN
SANKEI YAKUHIN KK
TAIWAN SEMICONDUCTOR MFG
YEH CHIH-KANG
HILL CLYDE D
YANG CHENG-CHUAN

Query:
-- Query 4: Extract filing years from "filing_date"
SELECT DISTINCT TO_VARCHAR(TO_DATE(t."filing_date"::STRING, 'YYYYMMDD'), 'YYYY') AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE TRY_TO_DATE(t."filing_date"::STRING, 'YYYYMMDD') IS NOT NULL
LIMIT 1000;
Answer:
filing_year
2009
1998
1950
1933
1922
1898
2012
2000
1907
1905
1885
1889
1970
1941
1881
1948
1992
2013
1951
2007
1961
1974
1913
1997
1880
1949
1887
1988
1976
1901
1955
2017
1935
1936
1944
1867
1927
1967
1939
1923
1886
2010
2024
1926
1924
1985
1986
1993
1890
2021
1968
1928
1940
1995
1912
1962
1918
1897
2006
1937
1903
2002
2020
1934
1917
1925
1916
2023
2019
1931
1899
2014
1920
1952
1963
2022
1984
1990
1958
1853
1915
1946
1973
1954
1883
2018
2015
2016
1983
1978
1979
1981
1999
1980
1892
1919
1975
1959
1893
1902
1996
1938
1953
1906
1900
1964
1947
1966
1877
2005
1945
1972
1895
1911
1960
1991
1914
1921
1904
1994
1971
1896
1943
1860
2004
1989
2011
1969
1929
1909
2001
1932
1957
1894
1882
1930
1987
1910
1942
1908
1846
1965
1982
1891
2008
1888
1977
2003
1956
Query:
SELECT DISTINCT CAST(t."filing_date" / 10000 AS INTEGER) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 1000;
Answer:
filing_year
1998
1988
1934
1885
2011
1950
2021
1965
2007
1961
1890
1909
1882
1946
1975
1889
1972
1982
1999
1918
1846
1981
1997
1887
2017
1899
1983
2004
1928
2018
2006
1925
1973
2001
1980
1949
1904
1877
1860
1943
1994
1892
1977
1969
1938
1915
1970
2005
1976
2000
1932
1906
1987
1955
1919
1902
2010
1927
1881
2012
1957
1923
1867
1978
1898
1989
0
2014
1916
1974
1853
1993
2008
1964
1937
1895
1931
1929
1991
1966
1886
1958
1956
1933
2020
1920
1926
1930
1995
2009
1953
1907
1971
1952
1947
1992
1979
1912
1945
1986
2019
1962
2002
1948
1910
1913
1984
1967
1939
1940
1911
2024
1924
1900
1897
1896
1944
1880
1942
2022
2015
1905
1963
1921
1883
1914
1936
1990
1951
2013
1954
1908
1985
1903
1960
1888
1996
2016
1893
1935
1941
1968
1901
1959
1917
1894
2023
2003
1922
1891
Query:
SELECT DISTINCT SUBSTRING(t."filing_date"::STRING, 1, 4) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE t."filing_date" IS NOT NULL
LIMIT 1000;
Answer:
filing_year
2015
2016
2018
1983
1978
1898
1949
1887
2012
2000
1907
1905
1885
1904
1846
1942
1908
1881
1936
1948
2013
1951
1992
1910
2010
2024
1926
1924
2014
1963
1952
1920
1928
1940
1995
1912
1930
1922
1889
1994
1986
1993
1985
1890
2021
1968
2017
1935
2003
1956
2009
1998
1950
1933
1927
1981
1999
1980
1979
1892
1997
1880
1996
0
1953
1938
1964
1947
1906
1900
1969
1909
1929
2005
1945
1972
1960
1911
1895
2006
1903
1937
1923
1886
2019
2023
1899
1931
1988
1976
1955
1901
2008
1946
1915
1967
1939
1944
1867
1991
1921
1914
2020
2002
1934
1916
1925
1917
1970
1941
1971
1943
1896
1860
2011
2004
1989
1966
1877
2001
1882
1957
1894
1932
1962
1897
1918
1987
1974
2007
1961
1913
1975
1959
1919
1902
1893
1965
1982
1891
2022
1984
1990
1958
1853
1977
1888
1973
1954
1883
Query:
SELECT DISTINCT SUBSTRING(t."publication_date"::STRING, 1, 4) AS "publication_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE t."publication_date" IS NOT NULL
LIMIT 1000;
Answer:
publication_year
1843
1922
1873
1898
1881
1949
1887
1948
1863
2006
1937
1903
1904
1868
2010
2024
1924
1926
1864
1872
2017
1935
1936
1847
1944
1866
1867
2000
2012
1907
1905
1885
1839
1886
1923
1865
1975
1959
1893
1919
1902
1875
1986
1985
1993
1890
2021
1968
1940
1928
2001
1870
1957
1882
1932
1894
1972
1960
1895
1911
1991
1914
1878
1921
2007
1961
1974
1913
1841
1994
1854
1971
1860
1896
1943
1858
1862
1842
2005
1945
1845
1930
1983
1978
1910
1970
1884
1941
1982
1965
1891
1851
1947
1906
1859
1964
1900
1848
1915
1946
1967
1939
1998
2009
1950
1933
1844
2013
1992
1951
1849
1980
1981
1999
1979
1892
1876
2019
2023
1899
1931
1988
1976
1955
1901
2004
2011
1989
1969
1909
1929
1995
1879
1912
2016
2015
2018
1987
1889
1997
1880
1855
2014
1963
1920
1952
1856
2022
1984
1990
1958
1874
1853
1977
1888
1837
1857
1973
1954
1883
1962
1897
1918
1927
1850
1852
2020
2002
1917
1934
1916
1925
1871
1942
1908
1861
1846
1996
0
1953
1938
2008
1869
1966
1877
2003
1956
Query:
SELECT f1.value:"name"::STRING AS "assignee_name", COUNT(DISTINCT t."application_number") AS "num_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f1
GROUP BY f1.value:"name"::STRING
ORDER BY "num_applications" DESC
LIMIT 1000;
Answer:
Too long, hard cut:
assignee_name,num_applications
SAMSUNG ELECTRONICS CO LTD,2238
CANON KK,2114
HITACHI LTD,2011
MATSUSHITA ELECTRIC IND CO LTD,1948
MITSUBISHI ELECTRIC CORP,1732
SONY CORP,1477
FUJITSU LTD,1363
TOSHIBA CORP,1296
NEC CORP,1280
IBM,1239
LG ELECTRONICS INC,1053
HUAWEI TECH CO LTD,1027
SIEMENS AG,987
SEIKO EPSON CORP,963
GEN ELECTRIC,947
SHARP KK,913
STATE GRID CORP CHINA,839
TOYOTA MOTOR CORP,839
BOSCH GMBH ROBERT,837
HONDA MOTOR CO LTD,836
QUALCOMM INC,812
RICOH KK,735
DENSO CORP,628
SANYO ELECTRIC CO,616
HYUNDAI MOTOR CO LTD,577
NIPPON TELEGRAPH & TELEPHONE,568
TOSHIBA KK,545
BAYER AG,528
FUJI PHOTO FILM CO LTD,522
NISSAN MOTOR,515
TOYOTA MOTOR CO LTD,507
MITSUBISHI HEAVY IND LTD,488
ZTE CORP,479
INTEL CORP,475
ERICSSON TELEFON AB L M,462
BOE TECHNOLOGY GROUP CO LTD,435
FUJI XEROX CO LTD,427
DU PONT,423
MATSUSHITA ELECTRIC WORKS LTD,403
NIPPON STEEL CORP,401
SUMITOMO ELECTRIC INDUSTRIES,399
PROCTER & GAMBLE,394
BASF AG,366
HOECHST AG,364
GREE ELECTRIC APPLIANCES INC ZHUHAI,364
PANASONIC CORP,357
SUMITOMO CHEMICAL CO,354
TOKYO SHIBAURA ELECTRIC CO,353
FUJIFILM CORP,349
BROTHER IND LTD,325
HOFFMANN LA ROCHE,319
FORD GLOBAL TECH LLC,319
LG CHEMICAL LTD,318
KYOCERA CORP,316
UNIV ZHEJIANG,314
MURATA MANUFACTURING CO,305
PHILIPS NV,304
APPLE INC,299
TORAY INDUSTRIES,298
KONINKL PHILIPS ELECTRONICS NV,298
HON HAI PREC IND CO LTD,296
DAINIPPON PRINTING CO LTD,294
SAMSUNG DISPLAY CO LTD,289
MICROSOFT CORP,285
MIDEA GROUP CO LTD,278
FUJI ELECTRIC CO LTD,270
NIPPON ELECTRIC CO,270
TAIWAN SEMICONDUCTOR MFG CO LTD,269
UNIV TSINGHUA,264
KOBE STEEL LTD,262
MICROSOFT TECHNOLOGY LICENSING LLC,256
3M INNOVATIVE PROPERTIES CO,253
SEKISUI CHEMICAL CO LTD,249
OKI ELECTRIC IND CO LTD,241
RICOH CO LTD,240
EASTMAN KODAK CO,238
XEROX CORP,236
OMRON TATEISI ELECTRONICS CO,236
KAO CORP,234
WESTINGHOUSE ELECTRIC CORP,231
NIKON CORP,231
TOKYO ELECTRON LTD,230
CASIO COMPUTER CO LTD,229
TOPPAN PRINTING CO LTD,229
MOTOROLA INC,228
BASF SE,225
KONISHIROKU PHOTO IND,225
APPLIED MATERIALS INC,224
BRIDGESTONE CORP,222
NITTO DENKO CORP,221
MICRON TECHNOLOGY INC,220
YAZAKI CORP,219
BOEING CO,217
HYNIX SEMICONDUCTOR INC,214
RCA CORP,213
HEWLETT PACKARD DEVELOPMENT CO,213
DAIKIN IND LTD,211
TDK CORP,209
LG DISPLAY CO LTD,208
SAMSUNG SDI CO LTD,208
GEN MOTORS CORP,206
OLYMPUS OPTICAL CO,206
PANASONIC IP MAN CO LTD,205
CIBA GEIGY AG,204
MAZDA MOTOR,203
SHELL INT RESEARCH,201
TEXAS INSTRUMENTS INC,200
LILLY CO ELI,199
UNIV CALIFORNIA,199
PETROCHINA CO LTD,199
TENCENT TECH SHENZHEN CO LTD,197
NTT DOCOMO INC,195
UNIV SOUTH CHINA TECH,192
GUANGDONG OPPO MOBILE TELECOMMUNICATIONS CORP LTD,191
SAMSUNG ELECTRO MECH,190
OLYMPUS CORP,190
UNIV TIANJIN,190
KIA MOTORS CORP,187
SUMITOMO WIRING SYSTEMS,186
COLGATE PALMOLIVE CO,186
KUBOTA KK,183
SEMICONDUCTOR ENERGY LAB,182
FURUKAWA ELECTRIC CO LTD,181
CHINA PETROLEUM & CHEM CORP,180
SANKYO CO,180
DOW CHEMICAL CO,178
OREAL,177
PFIZER,175
KAWASAKI STEEL CO,173
POSCO,172
ICI LTD,171
KOREA ELECTRONICS TELECOMM,170
UNIV JILIN,169
HAIER SMART HOME CO LTD,167
SUMITOMO METAL IND,165
TOSHIBA TEC KK,165
NOVARTIS AG,165
NIPPON KOKAN KK,165
BAYERISCHE MOTOREN WERKE AG,165
SHINETSU CHEMICAL CO,165
SHIMADZU CORP,165
MINNESOTA MINING & MFG,164
COMMISSARIAT ENERGIE ATOMIQUE,163
ASAHI CHEMICAL IND,162
ALPS ELECTRIC CO LTD,161
HONEYWELL INT INC,160
MERCK PATENT GMBH,159
AISIN SEIKI,159
GOOGLE LLC,159
UNIV SHANGHAI JIAOTONG,158
UNIV SOUTHEAST,158
HITACHI CHEMICAL CO LTD,157
ISHIKAWAJIMA HARIMA HEAVY IND,155
LG INNOTEK CO LTD,155
NANJING UNIVERSITY OF TECHNOLOGY,153
CENTRE NAT RECH SCIENT,152
ZAHNRADFABRIK FRIEDRICHSHAFEN,151
ISEKI AGRICULT MACH,150
ASAHI GLASS CO LTD,150
VOLKSWAGEN AG,150
GM GLOBAL TECH OPERATIONS INC,148
ILLINOIS TOOL WORKS,147
AMERICAN CYANAMID CO,147
MERCK & CO INC,146
ALIBABA GROUP HOLDING LTD,145
INFINEON TECHNOLOGIES AG,142
NTN TOYO BEARING CO LTD,142
NOKIA CORP,142
KONINKLIJKE PHILIPS NV,142
IND TECH RES INST,142
DEERE & CO,141
MITSUBISHI MATERIALS CORP,141
KIMBERLY CLARK CO,141
MITSUBISHI CHEM CORP,138
HALLIBURTON ENERGY SERVICES INC,138
YAMAHA MOTOR CO LTD,137
MURATA MACHINERY LTD,136
NSK LTD,136
BYD CO LTD,136
WESTERN ELECTRIC CO,136
UNIV SHANDONG,136
HONGFUJIN PREC IND SHENZHEN,134
BEIJING XIAOMI MOBILE SOFTWARE CO LTD,134
KAWASAKI HEAVY IND LTD,133
UNILEVER NV,132
AUDI AG,131
SCHAEFFLER TECHNOLOGIES AG,131
KOMATSU MFG CO LTD,130
UNIV JIANGNAN,130
FUJIKURA LTD,128
UNIV NANJING FORESTRY,128
TOYO BOSEKI,127
AU OPTRONICS CORP,127
CHINA PETROLEUM & CHEMICAL,127
TEIJIN LTD,126
HITACHI METALS LTD,126
FRAUNHOFER GES FORSCHUNG,126
ROHM & HAAS,125
UNION CARBIDE CORP,124
NGK INSULATORS LTD,124
YOKOHAMA RUBBER CO LTD,123
VICTOR COMPANY OF JAPAN,122
UNIV DALIAN TECH,122
JFE STEEL CORP,120
UNIV HUAZHONG SCIENCE TECH,119
UNIV CENTRAL SOUTH,119
YAMAHA CORP,118
TOTO LTD,118
UNITED TECHNOLOGIES CORP,118
SANYO PRODUCT CO LTD,117
UNIV KUNMING SCIENCE & TECHNOLOGY,117
DOW GLOBAL TECHNOLOGIES LLC,116
PANASONIC IP MAN CORP,116
MITSUBISHI RAYON CO,114
ROHM CO LTD,114
UNIV ZHEJIANG TECHNOLOGY,114
SHOWA DENKO KK,114
GUANGDONG POWE
Query:
SELECT f1.value:"name"::STRING AS "assignee_name",
       SUBSTRING(t."filing_date"::STRING, 1, 4) AS "filing_year",
       COUNT(DISTINCT t."application_number") AS "num_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f1,
     LATERAL FLATTEN(input => t."cpc") f2
WHERE f2.value:"code"::STRING LIKE 'A61%'
GROUP BY f1.value:"name"::STRING, SUBSTRING(t."filing_date"::STRING, 1, 4)
ORDER BY "num_applications" DESC
LIMIT 1000;
Answer:
Too long, hard cut:
assignee_name,filing_year,num_applications
KONINKLIJKE PHILIPS NV,2018,15
PROCTER & GAMBLE,1997,15
NOVARTIS AG,2006,13
UNIV CALIFORNIA,2020,12
NOVARTIS AG,2011,11
COVIDIEN LP,2020,11
PROCTER & GAMBLE,2000,11
OLYMPUS CORP,2016,11
FUJIFILM CORP,2019,11
UNIV CALIFORNIA,2019,10
PROCTER & GAMBLE,1999,10
NOVARTIS AG,2014,10
PROCTER & GAMBLE,1998,10
COVIDIEN LP,2016,10
HOFFMANN LA ROCHE,2006,9
NOVARTIS AG,2007,9
GENENTECH INC,2002,9
PFIZER,2015,9
ETHICON LLC,2019,9
KONINKL PHILIPS ELECTRONICS NV,2010,9
HOFFMANN LA ROCHE,2003,9
HOFFMANN LA ROCHE,2008,9
OREAL,1995,9
NOVARTIS AG,2008,9
KONINKLIJKE PHILIPS NV,2016,9
COVIDIEN LP,2017,8
SMITHKLINE BEECHAM CORP,1998,8
BAYER AG,2001,8
COVIDIEN LP,2019,8
PROCTER & GAMBLE,1996,8
BOEHRINGER INGELHEIM INT,2009,8
KONINKLIJKE PHILIPS NV,2019,8
HOFFMANN LA ROCHE,2002,8
OLYMPUS CORP,2017,8
SIEMENS HEALTHCARE GMBH,2019,8
OLYMPUS MEDICAL SYSTEMS CORP,2008,8
HOFFMANN LA ROCHE,2004,8
PROCTER & GAMBLE,2016,8
HOFFMANN LA ROCHE,2001,8
SANOFI AVENTIS,2007,8
ASTRAZENECA AB,2001,8
LILLY CO ELI,1998,8
PFIZER,1993,7
PROCTER & GAMBLE,2008,7
US HEALTH,2018,7
UNIV CALIFORNIA,2018,7
FUJIFILM CORP,2020,7
PROCTER & GAMBLE,2007,7
BAYER AG,1993,7
KONINKL PHILIPS ELECTRONICS NV,2008,7
GENENTECH INC,2018,7
PFIZER,1990,7
OREAL,2005,7
ETHICON ENDO SURGERY INC,2014,7
NOVARTIS AG,2015,7
NOVARTIS AG,2005,7
KIMBERLY CLARK CO,1999,7
NOVARTIS AG,2020,7
PFIZER PROD INC,2001,7
ASTRAZENECA AB,2005,7
HOFFMANN LA ROCHE,2019,7
BRISTOL MYERS SQUIBB CO,2002,7
WYETH CORP,2006,7
LILLY CO ELI,1994,7
ASTRAZENECA AB,2007,7
PROCTER & GAMBLE,2012,7
TYCO HEALTHCARE,2010,7
KONINKLIJKE PHILIPS NV,2020,7
PROCTER & GAMBLE,2017,7
HOFFMANN LA ROCHE,2009,7
PROCTER & GAMBLE,2006,7
KONINKLIJKE PHILIPS NV,2021,7
HOECHST AG,1992,7
ETHICON ENDO SURGERY LLC,2016,6
HOFFMANN LA ROCHE,2021,6
TOSHIBA MEDICAL SYS CORP,2012,6
PHILIP MORRIS PRODUCTS SA,2016,6
UNIV TEXAS,2021,6
NOVARTIS AG,2003,6
UNIV LELAND STANFORD JUNIOR,2019,6
COVIDIEN LP,2014,6
NOVARTIS AG,2004,6
SAMSUNG ELECTRONICS CO LTD,2020,6
PFIZER,2004,6
CANON KK,2017,6
HOFFMANN LA ROCHE,2018,6
PFIZER PROD INC,1999,6
BOEHRINGER INGELHEIM PHARMA,2002,6
WYETH CORP,2004,6
JANSSEN PHARMACEUTICA NV,1998,6
COVIDIEN LP,2018,6
OREAL,2002,6
COVIDIEN LP,2012,6
UNIV CALIFORNIA,2017,6
MERCK & CO INC,2003,6
LILLY CO ELI,2017,6
ETHICON LLC,2017,6
SANOFI AVENTIS,2009,6
LILLY CO ELI,1996,6
MERCK PATENT GMBH,2004,6
HOFFMANN LA ROCHE,2020,6
OLYMPUS CORP,2018,6
OREAL,2019,6
EDWARDS LIFESCIENCES CORP,2023,6
PROCTER & GAMBLE,1995,6
TYCO HEALTHCARE,2009,6
OREAL,2015,6
CENTRE NAT RECH SCIENT,2014,6
HOFFMANN LA ROCHE,2007,6
MEDTRONIC INC,2021,6
SMITHKLINE BEECHAM PLC,1998,6
BRISTOL MYERS SQUIBB CO,2003,6
HOFFMANN LA ROCHE,2014,6
MERCK PATENT GMBH,2002,6
ETHICON ENDO SURGERY INC,2011,6
LILLY CO ELI,2012,6
UNIV CALIFORNIA,2023,6
NOVARTIS AG,2002,6
BIOSENSE WEBSTER ISRAEL LTD,2019,6
BRISTOL MYERS SQUIBB CO,2013,6
OREAL,1999,6
HOFFMANN LA ROCHE,1985,6
NOVARTIS AG,2019,6
HOFFMANN LA ROCHE,2015,6
PFIZER PROD INC,2002,6
UNI CHARM CORP,2003,6
GLAXOSMITHKLINE IP DEV LTD,2015,6
OREAL,2006,6
MERCK PATENT GMBH,2003,6
GENENTECH INC,2008,6
ASTRA AB,1996,5
COLGATE PALMOLIVE CO,2008,5
BOEHRINGER INGELHEIM VETMEDICA GMBH,2020,5
SANOFI SA,2009,5
LG HOUSEHOLD & HEALTH CARE LTD,2015,5
FUJIFILM CORP,2010,5
PROCTER & GAMBLE,1994,5
HOECHST AG,1993,5
OREAL,2004,5
UPJOHN CO,2001,5
DU PONT PHARM CO,1999,5
FUJIFILM CORP,2021,5
TAKEDA PHARMACEUTICALS CO,2018,5
GEN ELECTRIC,2011,5
INTUITIVE SURGICAL OPERATIONS,2019,5
OREAL,1988,5
HOFFMANN LA ROCHE,1999,5
SMITHKLINE BEECHAM CORP,1997,5
KONINKLIJKE PHILIPS NV,2017,5
PROCTER & GAMBLE,1990,5
BRISTOL MYERS SQUIBB CO,2020,5
SANOFI AVENTIS DEUTSCHLAND,2012,5
SAMSUNG ELECTRONICS CO LTD,2017,5
CENTRE NAT RECH SCIENT,2021,5
SCHERING CORP,1999,5
COLGATE PALMOLIVE CO,2015,5
MERCK & CO INC,1992,5
KIMBERLY CLARK CO,2001,5
TOSHIBA MEDICAL SYS CORP,2013,5
BAYER AG,1983,5
NOVARTIS AG,2013,5
PROCTER & GAMBLE,1991,5
SIEMENS AG,2004,5
KONINKLIJKE PHILIPS NV,2015,5
JANSSEN PHARMACEUTICA NV,2008,5
PROCTER & GAMBLE,2015,5
BECTON DICKINSON CO,2014,5
KONINKLIJKE PHILIPS NV,2013,5
BOEHRINGER INGELHEIM INT,2010,5
BAYER AG,2019,5
WYETH CORP,2008,5
KIMBERLY CLARK CO,2002,5
HOECHST AG,1981,5
OREAL,2003,5
INST NAT SANTE RECH MED,2021,5
LILLY CO ELI,1981,5
COLGATE PALMOLIVE CO,2010,5
CILAG GMBH INT,2019,5
OLYMPUS CORP,2005,5
ASTRAZENECA AB,2008,5
ASTRAZENECA AB,2010,5
AMGEN INC,2017,5
BECTON DICKINSON CO,2018,5
MERCK & CO INC,1986,5
LILLY CO ELI,2009,5
PFIZER PROD INC,1998,5
FUJIFILM CORP,2009,5
TERUMO CORP,2018,5
ABBOTT LAB,2006,5
KIMBERLY CLARK CO,2003,5
SAMSUNG ELECTRONICS CO LTD,2015,5
OLYMPUS CORP,2019,5
MERCK PATENT GMBH,2000,5
TERUMO CORP,2019,5
PROCTER & GAMBLE,2014,5
PFIZER,1982,5
SANOFI AVENTIS DEUTSCHLAND,2011,5
ARRAY BIOPHARMA INC,2009,5
COVIDIEN LP,2015,5
AVENTIS PHARMA SA,1999,5
PHILIP MORRIS PRODUCTS SA,2014,5
ALLERGAN INC,2010,5
HOECHST AG,1997,5
BECTON DICKINSON CO,2011,5
WARNER LAMBERT CO,1987,5
DEXCOM INC,2019,5
HOFFMANN LA ROCHE,2010,5
UNI CHARM CORP,2005,5
SCIMED LIFE SYSTEMS INC,2001,5
JANSSEN PH
Query:
SELECT f1.value:"name"::STRING AS "assignee_name",
       SUBSTRING(t."filing_date"::STRING, 1, 4) AS "filing_year",
       COUNT(DISTINCT t."application_number") AS "num_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f1,
     LATERAL FLATTEN(input => t."ipc") f2
WHERE f2.value::STRING LIKE '%A61%'
GROUP BY f1.value:"name"::STRING, SUBSTRING(t."filing_date"::STRING, 1, 4)
ORDER BY "num_applications" DESC
LIMIT 1000;
Answer:
Too long, hard cut:
assignee_name,filing_year,num_applications
PROCTER & GAMBLE,1997,16
FUJIFILM CORP,2019,14
KONINKLIJKE PHILIPS NV,2018,13
UNION HOSPITAL TONGJI MEDICAL COLLEGE HUAZHONG UNIV SCI & TECH,2019,13
PROCTER & GAMBLE,1998,12
OLYMPUS CORP,2016,12
NOVARTIS AG,2006,12
PROCTER & GAMBLE,1999,11
COVIDIEN LP,2020,11
COVIDIEN LP,2016,10
JIANGSU PROVINCE HOSPITAL FIRST AFFILIATED HOSPITAL WITH NANJING MEDICAL UNIV,2021,10
UNION HOSPITAL TONGJI MEDICAL COLLEGE HUAZHONG UNIV SCI & TECH,2020,10
ETHICON LLC,2019,9
KONINKL PHILIPS ELECTRONICS NV,2010,9
OREAL,1995,9
PROCTER & GAMBLE,2000,9
NOVARTIS AG,2011,9
HOFFMANN LA ROCHE,2001,9
UNIV CALIFORNIA,2020,9
OLYMPUS MEDICAL SYSTEMS CORP,2008,9
ASTRAZENECA AB,2001,9
XIANGYA HOSPITAL CENTRAL SOUTH UNIV,2020,9
UNIV PLA 3RD MILITARY MEDICAL,2016,9
COVIDIEN LP,2019,8
PROCTER & GAMBLE,2016,8
LILLY CO ELI,1998,8
SMITHKLINE BEECHAM CORP,1998,8
LILLY CO ELI,1981,8
HOFFMANN LA ROCHE,2002,8
COVIDIEN LP,2017,8
BAYER AG,2001,8
UNIV CALIFORNIA,2019,8
KONINKLIJKE PHILIPS NV,2016,8
PROCTER & GAMBLE,1996,8
BOEHRINGER INGELHEIM INT,2009,8
HOFFMANN LA ROCHE,2003,8
PFIZER,1993,8
PROCTER & GAMBLE,2006,7
SMITHKLINE BEECHAM CORP,1997,7
GENENTECH INC,2002,7
PROCTER & GAMBLE,2017,7
PROCTER & GAMBLE,2008,7
OLYMPUS CORP,2005,7
OLYMPUS CORP,2017,7
TYCO HEALTHCARE,2010,7
PFIZER PROD INC,2001,7
NOVARTIS AG,2007,7
SIEMENS HEALTHCARE GMBH,2019,7
KONINKLIJKE PHILIPS NV,2019,7
BRISTOL MYERS SQUIBB CO,2003,7
ETHICON ENDO SURGERY INC,2014,7
FUJIFILM CORP,2020,7
KONINKLIJKE PHILIPS NV,2021,7
LILLY CO ELI,1994,7
FUJIFILM CORP,2010,7
UNIV CALIFORNIA,2017,7
WYETH CORP,2004,7
OLYMPUS CORP,2003,7
HOECHST AG,1992,7
BRISTOL MYERS SQUIBB CO,2002,7
OLYMPUS OPTICAL CO,1993,7
UNI CHARM CORP,2003,7
NOVARTIS AG,2008,7
NOVARTIS AG,2003,7
HOFFMANN LA ROCHE,2004,7
SANOFI AVENTIS,2007,7
NOVARTIS AG,2014,7
UNIV CALIFORNIA,2018,7
PFIZER,2015,7
OREAL,2005,7
PFIZER,1990,7
BAYER AG,1993,7
SHIMADZU CORP,1996,7
HOFFMANN LA ROCHE,2008,7
HOFFMANN LA ROCHE,2006,7
UNIV JILIN,2020,7
CHINESE PLA GENERAL HOSPITAL,2020,7
KIMBERLY CLARK CO,1999,6
NOVARTIS AG,2002,6
ETHICON LLC,2017,6
HOFFMANN LA ROCHE,1985,6
OREAL,1999,6
SIEMENS AG,2006,6
PFIZER,1996,6
ASTRAZENECA AB,2008,6
BIOSENSE WEBSTER ISRAEL LTD,2019,6
WYETH CORP,2006,6
UNIV WUHAN,2020,6
MERCK PATENT GMBH,2003,6
KONINKLIJKE PHILIPS NV,2020,6
UNIV PLA AIR FORCE MEDICAL,2020,6
OREAL,2002,6
EDWARDS LIFESCIENCES CORP,2023,6
COVIDIEN LP,2018,6
FIRST AFFILIATED HOSPITAL ZHENGZHOU UNIV,2019,6
MERCK & CO INC,2003,6
UNIV LELAND STANFORD JUNIOR,2019,6
BAYER AG,1995,6
ABBOTT LAB,2006,6
ETHICON ENDO SURGERY INC,2011,6
UPJOHN CO,2001,6
OREAL,2015,6
MERCK PATENT GMBH,2002,6
PROCTER & GAMBLE,2007,6
COVIDIEN LP,2012,6
OLYMPUS OPTICAL CO,1987,6
ASTRAZENECA AB,2007,6
PROCTER & GAMBLE,2012,6
PFIZER,2004,6
OREAL,2019,6
RHONE POULENC RORER SA,1996,6
FUJIFILM CORP,2021,6
MEDTRONIC INC,2021,6
CANON KK,2017,6
FUJIFILM CORP,2008,6
UNIV TEXAS,2021,6
BOEHRINGER INGELHEIM PHARMA,2002,6
NOVARTIS AG,2020,6
JANSSEN PHARMACEUTICA NV,1998,6
OLYMPUS CORP,2018,6
TYCO HEALTHCARE,2009,6
GENENTECH INC,2018,6
TOSHIBA MEDICAL SYS CORP,2012,6
CHINESE PEOPLE'S LIBERATION ARMY AIR FORCE MILITARY MEDICAL UNIV,2022,6
SMITHKLINE BEECHAM PLC,1998,6
OREAL,2014,6
COVIDIEN LP,2014,6
BAYER AG,1997,6
MERCK PATENT GMBH,2004,6
FIRST PEOPLES HOSPITAL CHANGZHOU,2018,6
LILLY CO ELI,1996,6
TOSHIBA CORP,1989,6
ETHICON ENDO SURGERY LLC,2016,6
TOSHIBA MEDICAL SYS CORP,2013,6
GLAXOSMITHKLINE IP DEV LTD,2015,6
PFIZER PROD INC,2002,6
PROCTER & GAMBLE,1995,6
TAKEDA PHARMACEUTICALS CO,2018,5
CILAG GMBH INT,2019,5
BOEHRINGER INGELHEIM INT,2010,5
LILLY CO ELI,1997,5
HOECHST AG,1993,5
ICI PLC,1989,5
AVENTIS PHARMA SA,1999,5
HOECHST AG,1985,5
BAYER AG,1983,5
PFIZER,1982,5
NOVARTIS AG,2019,5
SAMSUNG ELECTRONICS CO LTD,2017,5
KONICA MINOLTA INC,2020,5
HOFFMANN LA ROCHE,2009,5
ASTRAZENECA AB,2005,5
AMGEN INC,2017,5
PEKING UNION MEDICAL COLLEGE HOSPITAL CAMS,2019,5
WARNER LAMBERT CO,1987,5
OREAL,2003,5
SCHERING CORP,1999,5
HOFFMANN LA ROCHE,2007,5
NANJING FIRST HOSPITAL,2020,5
ETHICON LLC,2018,5
PROCTER & GAMBLE,1986,5
KONINKLIJKE PHILIPS NV,2015,5
UNIV PEKING SHENZHEN HOSPITAL,2018,5
WEST CHINA HOSPITAL SICHUAN UNIV,2020,5
SHISEIDO CO LTD,2010,5
COVIDIEN LP,2015,5
BRISTOL MYERS CO,1986,5
SANOFI AVENTIS DEUTSCHLAND,2012,5
KIMBERLY CLARK CO,2001,5
MERCK & CO INC,1992,5
HOECHST AG,1997,5
PROCTER & GAMBLE,2015,5
KONINKLIJKE PHILIPS NV,2017,5
OLYMPUS CORP,2015,5
NOVARTIS AG,2015,5
PFIZER,1994,5
TERUMO CORP,2018,5
WEST CHINA HOSPITAL SICHUAN UNIV,2022,5
ASTRA AB,1995,5
CENTRE NAT RECH SCIENT,2014,5
KIMBERLY CLARK CO,2013,5
TERUMO CORP,2019,5
HOFFMANN LA ROCHE,2014,5
OLYMPUS OPTICAL CO,2002,5
UNIV LELAND STANFORD JUNIOR,2005,5
UNI CHARM CORP,2005,5
BECTON DICKINSON CO,2014,5
FIRST HOSPITAL CHINA MEDICAL UNIV,2019,5
SANOFI AVENTIS DEUTSCHLAND,2014,5
PROCTER & GAMBLE,1991,5
HOFFMANN LA ROCHE,2020,5
OLYMPUS CORP,2002,5
LUOHE NO 1 PEOPLES HOSPITAL,2020,5
TAIZHOU ENZE MEDICAL CT GROUP,2021,5
HOFFMANN LA ROCHE,1979,5
LILLY CO ELI,2017,5
BOEHRINGER INGELHEIM VETMEDICA GMBH,2020,5

End Exploring Related Columns
Task: In which year did the assignee with the most applications in the patent category 'A61' file the most?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: SELECT S."Column_Name" FROM {Database Name}.{Schema Name}.{Table_name} (ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
year,number_of_applications
year:int,applications:int
```

The table shows the year in which the assignee with the most applications in the patent category 'A61' filed the highest number of applications, along with the number of applications filed that year..
Here are some useful tips for answering:
When calculating distances between two geometries, use `ST_MakePoint(x, y)` to make a point and `ST_Distance(geometry1 GEOMETRY, geometry2 GEOMETRY)` to compute. No need to convert from meters to miles unless requested. Don't use Haversine like 2 * 6371000 * ASIN(...), use ST_DISTANCE for more precise results.
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'
When handling TO_TIMESTAMP_NTZ conversions, use query like: SELECT CASE WHEN "date" >= 1e15 THEN TO_TIMESTAMP_NTZ("date" / 1000000) WHEN "date" >= 1e12 THEN TO_TIMESTAMP_NTZ("date" / 1000) ELSE TO_TIMESTAMP_NTZ("date") END AS parsed_timestamp FROM my_table;
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
Keep all decimals to four decimal places.

2025-01-16 13:56:48 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 13:56:48 - root - INFO - ```sql
WITH top_assignee AS (
    SELECT f1.value:"name"::STRING AS "assignee_name",
           COUNT(DISTINCT t."application_number") AS "num_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."assignee_harmonized") f1,
         LATERAL FLATTEN(input => t."cpc") f2
    WHERE f2.value:"code"::STRING LIKE 'A61%'
    GROUP BY f1.value:"name"::STRING
    ORDER BY "num_applications" DESC
    LIMIT 1
)
SELECT SUBSTRING(t."filing_date"::STRING, 1, 4) AS "year",
       COUNT(DISTINCT t."application_number") AS "number_of_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t
    JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f1 ON TRUE
    JOIN LATERAL FLATTEN(input => t."cpc") f2 ON TRUE,
    top_assignee
WHERE f1.value:"name"::STRING = top_assignee.assignee_name
  AND f2.value:"code"::STRING LIKE 'A61%'
GROUP BY "year"
ORDER BY "number_of_applications" DESC NULLS LAST
LIMIT 1;
```
2025-01-16 13:56:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 13:56:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 13:56:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 13:56:50 - snowflake.connector.connection - INFO - closed
2025-01-16 13:56:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 13:56:50 - root - INFO - itercount: 1
2025-01-16 13:56:50 - root - INFO - 000904 (42000): 01b9c044-0004-7b0e-0001-11c300d95042: SQL compilation error: error line 18 at position 32
invalid identifier 'TOP_ASSIGNEE.ASSIGNEE_NAME'
2025-01-16 13:56:50 - root - INFO - Input sql:
WITH top_assignee AS (
    SELECT f1.value:"name"::STRING AS "assignee_name",
           COUNT(DISTINCT t."application_number") AS "num_applications"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."assignee_harmonized") f1,
         LATERAL FLATTEN(input => t."cpc") f2
    WHERE f2.value:"code"::STRING LIKE 'A61%'
    GROUP BY f1.value:"name"::STRING
    ORDER BY "num_applications" DESC
    LIMIT 1
)
SELECT SUBSTRING(t."filing_date"::STRING, 1, 4) AS "year",
       COUNT(DISTINCT t."application_number") AS "number_of_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t
    JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f1 ON TRUE
    JOIN LATERAL FLATTEN(input => t."cpc") f2 ON TRUE,
    top_assignee
WHERE f1.value:"name"::STRING = top_assignee.assignee_name
  AND f2.value:"code"::STRING LIKE 'A61%'
GROUP BY "year"
ORDER BY "number_of_applications" DESC NULLS LAST
LIMIT 1;
The error information is:
000904 (42000): 01b9c044-0004-7b0e-0001-11c300d95042: SQL compilation error: error line 18 at position 32
invalid identifier 'TOP_ASSIGNEE.ASSIGNEE_NAME'
Please correct it and output only 1 complete SQL query.When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-16 13:57:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 13:57:38 - root - INFO - ```sql
WITH top_assignee AS (
    SELECT f1.value:"name"::STRING AS "assignee_name"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."assignee_harmonized") f1,
         LATERAL FLATTEN(input => t."cpc") f2
    WHERE f2.value:"code"::STRING LIKE 'A61%'
    GROUP BY f1.value:"name"::STRING
    ORDER BY COUNT(DISTINCT t."application_number") DESC
    LIMIT 1
)
SELECT SUBSTRING(t."filing_date"::STRING, 1, 4) AS "year",
       COUNT(DISTINCT t."application_number") AS "number_of_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t
    JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f1 ON TRUE
    JOIN LATERAL FLATTEN(input => t."cpc") f2 ON TRUE
WHERE f1.value:"name"::STRING = (SELECT assignee_name FROM top_assignee)
  AND f2.value:"code"::STRING LIKE 'A61%'
GROUP BY "year"
ORDER BY "number_of_applications" DESC NULLS LAST
LIMIT 1;
```
2025-01-16 13:57:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 13:57:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 13:57:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 13:57:40 - snowflake.connector.connection - INFO - closed
2025-01-16 13:57:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 13:57:40 - root - INFO - itercount: 2
2025-01-16 13:57:40 - root - INFO - 000904 (42000): 01b9c045-0004-7c54-0001-11c300d936c2: SQL compilation error: error line 16 at position 40
invalid identifier 'ASSIGNEE_NAME'
2025-01-16 13:57:40 - root - INFO - Input sql:
WITH top_assignee AS (
    SELECT f1.value:"name"::STRING AS "assignee_name"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."assignee_harmonized") f1,
         LATERAL FLATTEN(input => t."cpc") f2
    WHERE f2.value:"code"::STRING LIKE 'A61%'
    GROUP BY f1.value:"name"::STRING
    ORDER BY COUNT(DISTINCT t."application_number") DESC
    LIMIT 1
)
SELECT SUBSTRING(t."filing_date"::STRING, 1, 4) AS "year",
       COUNT(DISTINCT t."application_number") AS "number_of_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t
    JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f1 ON TRUE
    JOIN LATERAL FLATTEN(input => t."cpc") f2 ON TRUE
WHERE f1.value:"name"::STRING = (SELECT assignee_name FROM top_assignee)
  AND f2.value:"code"::STRING LIKE 'A61%'
GROUP BY "year"
ORDER BY "number_of_applications" DESC NULLS LAST
LIMIT 1;
The error information is:
000904 (42000): 01b9c045-0004-7c54-0001-11c300d936c2: SQL compilation error: error line 16 at position 40
invalid identifier 'ASSIGNEE_NAME'
Please correct it and output only 1 complete SQL query.When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-16 13:58:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 13:58:29 - root - INFO - ```sql
WITH top_assignee AS (
    SELECT f1.value:"name"::STRING AS "assignee_name"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."assignee_harmonized") f1,
         LATERAL FLATTEN(input => t."cpc") f2
    WHERE f2.value:"code"::STRING LIKE 'A61%'
    GROUP BY f1.value:"name"::STRING
    ORDER BY COUNT(DISTINCT t."application_number") DESC NULLS LAST
    LIMIT 1
)
SELECT SUBSTRING(t."filing_date"::STRING, 1, 4) AS "year",
       COUNT(DISTINCT t."application_number") AS "number_of_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t
JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f1 ON TRUE
JOIN LATERAL FLATTEN(input => t."cpc") f2 ON TRUE
CROSS JOIN top_assignee ta
WHERE f1.value:"name"::STRING = ta.assignee_name
  AND f2.value:"code"::STRING LIKE 'A61%'
GROUP BY "year"
ORDER BY "number_of_applications" DESC NULLS LAST
LIMIT 1;
```
2025-01-16 13:58:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 13:58:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 13:58:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 13:58:30 - snowflake.connector.connection - INFO - closed
2025-01-16 13:58:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 13:58:31 - root - INFO - itercount: 3
2025-01-16 13:58:31 - root - INFO - 000904 (42000): 01b9c046-0004-7b0e-0001-11c300d9506e: SQL compilation error: error line 17 at position 32
invalid identifier 'TA.ASSIGNEE_NAME'
2025-01-16 13:58:31 - root - INFO - Input sql:
WITH top_assignee AS (
    SELECT f1.value:"name"::STRING AS "assignee_name"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
         LATERAL FLATTEN(input => t."assignee_harmonized") f1,
         LATERAL FLATTEN(input => t."cpc") f2
    WHERE f2.value:"code"::STRING LIKE 'A61%'
    GROUP BY f1.value:"name"::STRING
    ORDER BY COUNT(DISTINCT t."application_number") DESC NULLS LAST
    LIMIT 1
)
SELECT SUBSTRING(t."filing_date"::STRING, 1, 4) AS "year",
       COUNT(DISTINCT t."application_number") AS "number_of_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t
JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f1 ON TRUE
JOIN LATERAL FLATTEN(input => t."cpc") f2 ON TRUE
CROSS JOIN top_assignee ta
WHERE f1.value:"name"::STRING = ta.assignee_name
  AND f2.value:"code"::STRING LIKE 'A61%'
GROUP BY "year"
ORDER BY "number_of_applications" DESC NULLS LAST
LIMIT 1;
The error information is:
000904 (42000): 01b9c046-0004-7b0e-0001-11c300d9506e: SQL compilation error: error line 17 at position 32
invalid identifier 'TA.ASSIGNEE_NAME'
Please correct it and output only 1 complete SQL query.When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-16 13:59:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 13:59:38 - root - INFO - ```sql
WITH top_assignee AS (
    SELECT f1.value:"name"::STRING AS "assignee_name"
    FROM PATENTS.PATENTS.PUBLICATIONS t
         LATERAL FLATTEN(input => t."assignee_harmonized") f1
         LATERAL FLATTEN(input => t."cpc") f2
    WHERE f2.value:"code"::STRING LIKE 'A61%'
    GROUP BY "assignee_name"
    ORDER BY COUNT(DISTINCT t."application_number") DESC NULLS LAST
    LIMIT 1
)
SELECT SUBSTRING(t."filing_date"::STRING, 1, 4) AS "year",
       COUNT(DISTINCT t."application_number") AS "number_of_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t
     LATERAL FLATTEN(input => t."assignee_harmonized") f1
     LATERAL FLATTEN(input => t."cpc") f2,
     top_assignee
WHERE f1.value:"name"::STRING = top_assignee."assignee_name"
  AND f2.value:"code"::STRING LIKE 'A61%'
GROUP BY "year"
ORDER BY "number_of_applications" DESC NULLS LAST
LIMIT 1;
```
2025-01-16 13:59:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 13:59:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 13:59:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 13:59:40 - snowflake.connector.connection - INFO - closed
2025-01-16 13:59:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 13:59:40 - root - INFO - itercount: 4
2025-01-16 13:59:40 - root - INFO - 001003 (42000): 01b9c047-0004-7b48-0001-11c300d94256: SQL compilation error:
syntax error line 4 at position 9 unexpected 'LATERAL'.
syntax error line 4 at position 25 unexpected 'input'.
syntax error line 4 at position 59 unexpected 'f1'.
2025-01-16 13:59:40 - root - INFO - Input sql:
WITH top_assignee AS (
    SELECT f1.value:"name"::STRING AS "assignee_name"
    FROM PATENTS.PATENTS.PUBLICATIONS t
         LATERAL FLATTEN(input => t."assignee_harmonized") f1
         LATERAL FLATTEN(input => t."cpc") f2
    WHERE f2.value:"code"::STRING LIKE 'A61%'
    GROUP BY "assignee_name"
    ORDER BY COUNT(DISTINCT t."application_number") DESC NULLS LAST
    LIMIT 1
)
SELECT SUBSTRING(t."filing_date"::STRING, 1, 4) AS "year",
       COUNT(DISTINCT t."application_number") AS "number_of_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t
     LATERAL FLATTEN(input => t."assignee_harmonized") f1
     LATERAL FLATTEN(input => t."cpc") f2,
     top_assignee
WHERE f1.value:"name"::STRING = top_assignee."assignee_name"
  AND f2.value:"code"::STRING LIKE 'A61%'
GROUP BY "year"
ORDER BY "number_of_applications" DESC NULLS LAST
LIMIT 1;
The error information is:
001003 (42000): 01b9c047-0004-7b48-0001-11c300d94256: SQL compilation error:
syntax error line 4 at position 9 unexpected 'LATERAL'.
syntax error line 4 at position 25 unexpected 'input'.
syntax error line 4 at position 59 unexpected 'f1'.
Please correct it and output only 1 complete SQL query.When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-16 14:00:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 14:00:40 - root - INFO - ```sql
WITH top_assignee AS (
    SELECT f1.value:"name"::STRING AS "assignee_name"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f1 ON TRUE
    JOIN LATERAL FLATTEN(input => t."cpc") f2 ON TRUE
    WHERE f2.value:"code"::STRING LIKE 'A61%'
    GROUP BY f1.value:"name"::STRING
    ORDER BY COUNT(DISTINCT t."application_number") DESC NULLS LAST
    LIMIT 1
)
SELECT SUBSTRING(t."filing_date"::STRING, 1, 4) AS "year",
       COUNT(DISTINCT t."application_number") AS "number_of_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t
JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f1 ON TRUE
JOIN LATERAL FLATTEN(input => t."cpc") f2 ON TRUE
WHERE f1.value:"name"::STRING = (SELECT assignee_name FROM top_assignee)
  AND f2.value:"code"::STRING LIKE 'A61%'
GROUP BY "year"
ORDER BY "number_of_applications" DESC NULLS LAST
LIMIT 1;
```
2025-01-16 14:00:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 14:00:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 14:00:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 14:00:41 - snowflake.connector.connection - INFO - closed
2025-01-16 14:00:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 14:00:42 - root - INFO - itercount: 5
2025-01-16 14:00:42 - root - INFO - 000904 (42000): 01b9c048-0004-7b0e-0001-11c300d95086: SQL compilation error: error line 16 at position 40
invalid identifier 'ASSIGNEE_NAME'
2025-01-16 14:00:42 - root - INFO - Input sql:
WITH top_assignee AS (
    SELECT f1.value:"name"::STRING AS "assignee_name"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f1 ON TRUE
    JOIN LATERAL FLATTEN(input => t."cpc") f2 ON TRUE
    WHERE f2.value:"code"::STRING LIKE 'A61%'
    GROUP BY f1.value:"name"::STRING
    ORDER BY COUNT(DISTINCT t."application_number") DESC NULLS LAST
    LIMIT 1
)
SELECT SUBSTRING(t."filing_date"::STRING, 1, 4) AS "year",
       COUNT(DISTINCT t."application_number") AS "number_of_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t
JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f1 ON TRUE
JOIN LATERAL FLATTEN(input => t."cpc") f2 ON TRUE
WHERE f1.value:"name"::STRING = (SELECT assignee_name FROM top_assignee)
  AND f2.value:"code"::STRING LIKE 'A61%'
GROUP BY "year"
ORDER BY "number_of_applications" DESC NULLS LAST
LIMIT 1;
The error information is:
000904 (42000): 01b9c048-0004-7b0e-0001-11c300d95086: SQL compilation error: error line 16 at position 40
invalid identifier 'ASSIGNEE_NAME'
Please correct it and output only 1 complete SQL query.When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-16 14:01:46 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 14:01:46 - root - INFO - ```sql
WITH top_assignee AS (
    SELECT f1.value:"name"::STRING AS "ASSIGNEE_NAME"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f1 ON TRUE
    JOIN LATERAL FLATTEN(input => t."cpc") f2 ON TRUE
    WHERE f2.value:"code"::STRING LIKE 'A61%'
    GROUP BY "ASSIGNEE_NAME"
    ORDER BY COUNT(DISTINCT t."application_number") DESC NULLS LAST
    LIMIT 1
)
SELECT SUBSTRING(t."filing_date"::STRING, 1, 4) AS "year",
       COUNT(DISTINCT t."application_number") AS "number_of_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t
JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f1 ON TRUE
JOIN LATERAL FLATTEN(input => t."cpc") f2 ON TRUE
JOIN top_assignee ta ON f1.value:"name"::STRING = ta."ASSIGNEE_NAME"
WHERE f2.value:"code"::STRING LIKE 'A61%'
GROUP BY "year"
ORDER BY "number_of_applications" DESC NULLS LAST
LIMIT 1;
```
2025-01-16 14:01:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 14:01:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 14:01:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 14:01:48 - snowflake.connector.connection - INFO - closed
2025-01-16 14:01:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 14:01:48 - root - INFO - itercount: 6
2025-01-16 14:01:48 - root - INFO - 000002 (0A000): 01b9c049-0004-7c54-0001-11c300d93732: Unsupported feature 'lateral table function called with OUTER JOIN syntax or a join predicate (ON clause)'.
2025-01-16 14:01:48 - root - INFO - Input sql:
WITH top_assignee AS (
    SELECT f1.value:"name"::STRING AS "ASSIGNEE_NAME"
    FROM PATENTS.PATENTS.PUBLICATIONS t
    JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f1 ON TRUE
    JOIN LATERAL FLATTEN(input => t."cpc") f2 ON TRUE
    WHERE f2.value:"code"::STRING LIKE 'A61%'
    GROUP BY "ASSIGNEE_NAME"
    ORDER BY COUNT(DISTINCT t."application_number") DESC NULLS LAST
    LIMIT 1
)
SELECT SUBSTRING(t."filing_date"::STRING, 1, 4) AS "year",
       COUNT(DISTINCT t."application_number") AS "number_of_applications"
FROM PATENTS.PATENTS.PUBLICATIONS t
JOIN LATERAL FLATTEN(input => t."assignee_harmonized") f1 ON TRUE
JOIN LATERAL FLATTEN(input => t."cpc") f2 ON TRUE
JOIN top_assignee ta ON f1.value:"name"::STRING = ta."ASSIGNEE_NAME"
WHERE f2.value:"code"::STRING LIKE 'A61%'
GROUP BY "year"
ORDER BY "number_of_applications" DESC NULLS LAST
LIMIT 1;
The error information is:
000002 (0A000): 01b9c049-0004-7c54-0001-11c300d93732: Unsupported feature 'lateral table function called with OUTER JOIN syntax or a join predicate (ON clause)'.
Please correct it and output only 1 complete SQL query.When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

