2025-01-16 21:59:52 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 22:01:04 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 22:01:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 22:01:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 22:01:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 22:01:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 22:01:06 - snowflake.connector.connection - INFO - closed
2025-01-16 22:01:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 22:01:06 - root - INFO - SQL:
SELECT DISTINCT "person_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON"
   LIMIT 1000;
Results:
Too long, hard cut:
person_id
649532
1216480
858137
1030915
382704
1728171
1242757
724288
775924
2207987
949485
1909732
1933885
619362
2195007
2054700
2041070
1497122
2417
620086
1688362
1408216
1819658
28150
907544
1536037
2180828
751805
1821358
2114658
772990
491783
1001295
351509
902445
1712298
1449253
882669
1770135
1576821
1639654
2317297
1542932
1250207
590855
1747108
1750476
1465728
870448
1541679
117824
1759847
186307
2260141
133151
331711
632201
1728485
2058151
2078119
378552
37445
1820527
2144053
1791179
976988
982204
1127068
1985664
2078352
1118759
357284
1465950
9956
1356860
1320755
766038
743708
2090479
388975
471200
1346489
1161766
1058518
652825
1135142
1146443
1919305
1356715
1912905
1584661
873341
2326503
1390417
27426
1105735
597443
1984570
1747545
1204831
892069
1202265
1393843
166190
1123457
2247883
1120851
1376109
1953658
1640776
406435
123298
158674
594761
847203
2155335
2292612
2242049
1546910
1375726
1233227
1351896
1234218
1565611
1731354
153981
1203593
1826510
2304544
2046869
2304536
1223563
451172
814502
2216851
221334
1635352
1924023
264467
32627
1615833
667249
1471319
780956
762323
169692
186249
1627092
1716554
390772
1301671
2152186
2229223
1566979
176939
1554155
111902
2044932
241829
2010154
384555
1385560
493984
1206268
1312704
907380
1670735
1031526
1007721
1087442
524188
152400
1716123
2095222
1457187
72285
878763
774639
1930692
1711617
394369
1139302
1467695
1919045
1599613
39588
1655968
1845536
813615
2254462
1206728
2023791
695415
2200906
150391
38395
270445
1609960
1665155
1723298
909548
2256619
1997577
767308
2008716
985158
725968
1750268
712244
568165
442898
1705107
1894070
1808782
1910017
1922689
449455
1208922
717972
700567
1160913
1414267
352833
593392
594031
2098951
1599443
2260962
1707090
1509411
1214778
323091
1181206
1307300
538213
1659070
1336337
633994
583846
1943383
1722374
457075
640502
166395
201711
1145559
1474496
1121086
219708
1142439
1836740
1880885
1082584
1288656
190750
304304
1394510
1991197
455100
1200592
435698
339405
1045016
1488136
201491
1309039
2020724
1661641
2102467
2213010
609050
1227756
2279978
895381
352084
2216320
28656
1854263
5407
1941626
1534585
302267
2115680
168925
2229839
604954
1073402
446814
392589
1696133
99040
980449
1359485
961466
821167
1109640
1312944
33258
1485120
2222445
1386210
2277049
1705210
74721
441780
2266135
2082130
415263
830506
2089920
1450989
314737
1060530
482272
158771
1079415
1573530
1204936
1808450
643387
717075
673696
475040
1507511
1736386
1436579
1504761
960868
1775997
1561393
1719342
1137245
1235672
740871
86900
128842
1698846
923725
1560121
494457
89948
659964
489215
958064
1735562
736054
1452080
181541
2112842
1135895
526453
636072
493089
2140289
1664946
567268
1758974
97811
334417
1504397
1598681
1910542
2204714
12388
1366694
1564904
1958770
718580
2265203
1559234
2059485
2242434
1029958
2313629
481328
597453
1882962
2026162
2107525
1104537
2101965
1929799
2222825
1145957
2098437
781140
503379
201148
974205
1422302
731411
386904
1794451
1306032
2077318
122620
1057858
1581413
493562
1301343
2040205
1555346
1084336
1742744
2228649
2060935
796040
1080597
1270139
923928
937504
2201800
1945210
690639
1050105
453845
618084
801285
1742561
2195552
1582765
1685008
1700631
2162106
859319
1374452
2002474
1598101
206279
1427443
1202088
167967
1117429
1554077
1999013
1739847
740573
1757438
2079856
1768862
562235
1530419
1355277
337907
1995452
537279
1397984
1532302
1530157
384237
1334247
2290476
513725
1427695
978903
661368
2224508
1115141
1640731
1875978
1879674
1744865
549002
1953769
2117237
894441
1587937
598099
2268832
822755
820124
1092363
1054962
169497
804830
518785
1437826
281686
897623
389356
370981
2242655
1878105
682449
2307101
671466
532165
2144465
542135
2250763
384807
2295252
1632192
352190
1157302
717236
2130063
877010
1033629
1189903
352773
675582
1604742
1173314
1039048
1208523
556250
1449921
2056351
1062317
2179008
870520
906739
423151
1850997
1555016
1198775
1157411
2285084
1336444
1502909
2312452
1214030
62297
429677
2175167
1048766
1175106
1415287
1897224
424413
547402
422585
345922
944565
131466
2080108
1600906
1134009
162558
1321452
1354000
525738
1790593
215798
1388303
928614
1394402
1222696
951873
2299872
1784360
1510152
943531
268960
1527990
316496
1323167
628887
2281077
1280612
1832790
1197145
1113023
719526
1654297
261533
973470
613617
122795
2241536
824187
1099907
1478854
111149
67617
2170045
925859
1544900
956718
2054747
1604307
1834789
458283
1489238
26300
1755175
723975
1241255
663160
201810
965640
1571661
346925
221410
1331669
1638393
666152
2144134
1365677
1037924
328632
259859
1017826
779457
932685
738248
2025857
2284296
1110278
1182946
520785
635239
809785
30903
1419522
887543
1684992
66615
220913
40687
1782283
1983909
444022
474111
1498758
1566986
149112
1860108
1097452
1178807
1959762
2311513
552614
782978
2138882
858623
1576348
564392
998178
2242966
180484
825423
486571
1694417
2280167
319089
442497
1283364
1526176
1889262
834054
2224222
271572
1405674
2269265
1451650
1855195
1303905
1552399
1163

2025-01-16 22:01:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 22:01:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 22:01:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 22:01:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-16 22:01:08 - snowflake.connector.connection - INFO - closed
2025-01-16 22:01:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 22:01:09 - root - INFO - SQL:
SELECT DISTINCT "concept_id", "concept_name", "vocabulary_id", "concept_code"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
   WHERE "concept_code" = '35208'
   LIMIT 1000;
Results:
concept_id,concept_name,vocabulary_id,concept_code
1331235,quinapril,RxNorm,35208

2025-01-16 22:01:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 22:01:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 22:01:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 22:01:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 22:01:11 - snowflake.connector.connection - INFO - closed
2025-01-16 22:01:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 22:01:12 - root - INFO - SQL:
SELECT DISTINCT "concept_id", "concept_name", "concept_code", "vocabulary_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
   WHERE LOWER("concept_name") LIKE '%quinapril%'
   LIMIT 1000;
Results:
Too long, hard cut:
concept_id,concept_name,concept_code,vocabulary_id
35748142,quinapril 10 MG Delayed Release Oral Tablet by Dowelhurst,OMOP2749603,RxNorm Extension
44043725,quinapril Oral Tablet [Gd-Quinapril],OMOP1038356,RxNorm Extension
19111733,quinapril 1 MG/ML,451329,RxNorm
45675672,"quinapril 20mg/1 ORAL TABLET, FILM COATED",1d295d65-ebf9-440e-aa59-747418d09ce0,SPL
44901002,quinapril 5 MG Oral Tablet [Accupril],54868330700,NDC
43289972,quinapril 10 MG Oral Tablet [Aquinafil],OMOP546915,RxNorm Extension
41313171,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Oral Tablet [Quinapril Heumann],OMOP2511133,RxNorm Extension
41308876,quinapril 10 MG Oral Tablet [Quinapril Ct],OMOP2506838,RxNorm Extension
41027967,quinapril 10 MG Delayed Release Oral Tablet [Quinapril Hexal Comp],OMOP2225929,RxNorm Extension
41308877,quinapril 10 MG Delayed Release Oral Tablet [Quinapril Abz] Box of 30,OMOP2506839,RxNorm Extension
43179025,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Delayed Release Oral Tablet [QUINAPRIL/HYDROCHLOROTHIAZIDE MYLAN] Box of 90,OMOP448084,RxNorm Extension
41320336,quinapril 5 MG Oral Tablet [Quinapril Stada] Box of 30 by Stada,OMOP2518298,RxNorm Extension
41257864,quinapril 20 MG Oral Tablet [Quinapril Stada] Box of 100 by Stada,OMOP2455826,RxNorm Extension
35752264,quinapril 5 MG Delayed Release Oral Tablet [Accupro] by Dowelhurst,OMOP2753725,RxNorm Extension
40872209,quinapril 10 MG Delayed Release Oral Tablet [Quinapril Ct] Box of 50,OMOP2070171,RxNorm Extension
35748140,quinapril 10 MG Delayed Release Oral Tablet Box of 28 by Kent,OMOP2749601,RxNorm Extension
21053125,quinapril 10 MG Oral Tablet Box of 28 by Kent,OMOP374011,RxNorm Extension
35760639,quinapril 5 MG Delayed Release Oral Tablet [Accupro] Box of 28 by Dowelhurst,OMOP2762100,RxNorm Extension
40945895,quinapril 10 MG Oral Tablet [Accupro] Box of 30 by Pfizer,OMOP2143857,RxNorm Extension
21072832,quinapril 20 MG Oral Tablet Box of 28 by Mylan,OMOP373963,RxNorm Extension
41184482,quinapril 20 MG Delayed Release Oral Tablet [Quinapril Abz] Box of 50,OMOP2382444,RxNorm Extension
44181971,quinapril 20 MG Delayed Release Oral Tablet [Quinalich] Box of 50 by Sanofi,OMOP3058694,RxNorm Extension
35760651,quinapril 20 MG Delayed Release Oral Tablet by DE,OMOP2762112,RxNorm Extension
45038769,quinapril 20 MG Oral Tablet [Accupril],58016079876,NDC
44970442,quinapril 20 MG Oral Tablet [Accupril],58016079836,NDC
43129684,QUINAPRIL ZENTIVA,OMOP433676,RxNorm Extension
45378253,"quinapril 5mg/1 ORAL TABLET, FILM COATED",548685279,NDC
45850996,"quinapril hydrochloride 10mg/1 ORAL TABLET, FILM COATED [quinapril]",658620618,NDC
45278198,"quinapril hydrochloride 5mg/1 ORAL TABLET, FILM COATED",597625019,NDC
45234947,Quinapril 40 mg/1 TABLET [Quinapril],055111624,NDC
45091341,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Oral Tablet,63304016230,NDC
46252531,quinapril 10 MG Oral Tablet,63187042590,NDC
45998448,Quinapril 5mg tablets (Genus Pharmaceuticals Ltd),8044211000001102,SNOMED
46130119,Quinapril 5mg tablets (Mylan Ltd) 28 tablet 2 x 14 tablets,7392111000001102,SNOMED
46189346,Quinapril 5mg tablets (Waymade Healthcare Plc) 28 tablet,21875311000001104,SNOMED
45162992,quinapril 20 MG Oral Tablet,00185004901,NDC
45019363,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Oral Tablet,53869220001,NDC
44971184,quinapril 20 MG Oral Tablet [Accupril],60491000330,NDC
44872918,quinapril 10 MG Oral Tablet,00093105198,NDC
44921994,quinapril 5 MG Oral Tablet [Accupril],65427052740,NDC
45160014,quinapril 10 MG Oral Tablet [Accupril],65427053099,NDC
43587070,quinapril Oral Tablet [Accupro 20],OMOP675548,RxNorm Extension
36213873,quinapril Pill,1157877,RxNorm
46189350,Quinapril 40mg tablets (Waymade Healthcare Plc) 28 tablet,21876111000001107,SNOMED
46189347,Quinapril 10mg tablets (Waymade Healthcare Plc) 28 tablet,21875611000001109,SNOMED
40815540,Quinapril 1a,OMOP2013502,RxNorm Extension
45232824,quinapril 5 MG Oral Tablet,00480105098,NDC
44855967,quinapril 20 MG Oral Tablet,00093104505,NDC
45001606,quinapril 10 MG Oral Tablet,52152024204,NDC
4353314,POTASSIUM CHLORIDE/QUINAPRIL,N0000033140,NDFRT
43129685,QUINAPRIL/HYDROCHLOROTHIAZIDE ARROW,OMOP434388,RxNorm Extension
44988012,"quinapril hydrochloride 40mg/1 ORAL TABLET, FILM COATED",597625022,NDC
45064750,Quinapril ORAL 20140225 TABLET [Quinapril] ## FDA,068001186,NDC
45874643,quinapril 40 MG Oral Tablet,50268069111,NDC
45006855,quinapril 40 MG Oral Tablet,65862062078,NDC
45208166,quinapril 10 MG Oral Tablet,55567027209,NDC
44176855,quinapril 20 MG Delayed Release Oral Tablet [Quinalich],OMOP3053578,RxNorm Extension
40907413,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Delayed Release Oral Tablet [Accuzide],OMOP2105375,RxNorm Extension
35750359,quinapril 20 MG Delayed Release Oral Tablet [Quinil],OMOP2751820,RxNorm Extension
41250971,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Delayed Release Oral Tablet [Quinalich],OMOP2448933,RxNorm Extension
1331241,quinapril 20 MG Oral Tablet,312749,RxNorm
41246826,quinapril 20 MG Oral Tablet 

2025-01-16 22:01:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 22:01:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 22:01:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 22:01:13 - snowflake.connector.connection - INFO - closed
2025-01-16 22:01:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 22:01:48 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 22:01:48 - root - INFO - The error you're encountering is due to a syntax issue in your SQL query. Specifically, the placeholder `/* quinapril_concept_id */` is a comment in SQL and gets ignored by the SQL parser. This means that the parser sees the `WHERE` clause as incomplete because there's no value after the equals sign. Here's the breakdown:

**Your Query:**

```sql
SELECT DISTINCT "descendant_concept_id"
FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT_ANCESTOR"
WHERE "ancestor_concept_id" = /* quinapril_concept_id */
LIMIT 1000;
```

**Issue:**

- The `/* quinapril_concept_id */` is a comment and gets ignored by the SQL engine.
- This leaves the `WHERE` clause incomplete: `WHERE "ancestor_concept_id" =`
- The SQL parser expects a value after the equals sign and doesn't find one, leading to a syntax error.
- The error message points to `LIMIT 1000;` because the parser reaches that point without completing the previous statement.

**Solution:**

You need to replace the placeholder comment `/* quinapril_concept_id */` with the actual concept ID for quinapril. From your earlier query results, you've determined that the `concept_id` for quinapril is **1331235**.

**Corrected Query:**

```sql
SELECT DISTINCT "descendant_concept_id"
FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT_ANCESTOR"
WHERE "ancestor_concept_id" = 1331235
LIMIT 1000;
```

**Next Steps:**

1. **Run the Corrected Query:**

   Execute the corrected query to retrieve all descendant concept IDs related to quinapril.

   ```sql
   SELECT DISTINCT "descendant_concept_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT_ANCESTOR"
   WHERE "ancestor_concept_id" = 1331235
   LIMIT 1000;
   ```

2. **Verify the Results:**

   Ensure the query returns the expected descendant concept IDs. These IDs represent all medications related to quinapril in the concept hierarchy.

3. **Retrieve Details for Descendant Concepts:**

   You can obtain the names and details of these descendant concepts by querying the `CONCEPT` table.

   ```sql
   SELECT DISTINCT "concept_id", "concept_name", "vocabulary_id", "concept_code"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
   WHERE "concept_id" IN (
       SELECT DISTINCT "descendant_concept_id"
       FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT_ANCESTOR"
       WHERE "ancestor_concept_id" = 1331235
   )
   LIMIT 1000;
   ```

4. **Identify Participants Not Using Quinapril or Related Medications:**

   Now that you have the list of all related medication concept IDs, you can identify participants who **are** using these medications.

   ```sql
   SELECT DISTINCT "person_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
   WHERE "drug_concept_id" IN (
       SELECT DISTINCT "descendant_concept_id"
       FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT_ANCESTOR"
       WHERE "ancestor_concept_id" = 1331235
   )
   LIMIT 1000;
   ```

5. **Calculate the Percentage:**

   To compute the percentage of participants **not** using quinapril or related medications:

   - **Total Participants:**

     ```sql
     SELECT COUNT(DISTINCT "person_id") AS "total_participants"
     FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON";
     ```

   - **Participants Using Quinapril or Related Medications:**

     ```sql
     SELECT COUNT(DISTINCT "person_id") AS "users_of_quinapril_related_medications"
     FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
     WHERE "drug_concept_id" IN (
         SELECT DISTINCT "descendant_concept_id"
         FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT_ANCESTOR"
         WHERE "ancestor_concept_id" = 1331235
     );
     ```

   - **Calculate the Percentage Not Using:**

     ```sql
     SELECT
       100.0 * (
         (total.total_participants - users.users_of_quinapril_related_medications) 
         / total.total_participants
       ) AS "percentage_not_using_quinapril_and_related_medications"
     FROM
       (
         SELECT COUNT(DISTINCT "person_id") AS total_participants
         FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON"
       ) total,
       (
         SELECT COUNT(DISTINCT "person_id") AS users_of_quinapril_related_medications
         FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
         WHERE "drug_concept_id" IN (
             SELECT DISTINCT "descendant_concept_id"
             FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT_ANCESTOR"
             WHERE "ancestor_concept_id" = 1331235
         )
       ) users;
     ```

**Note:** Make sure to replace any placeholders with actual values. Comments in SQL should not be used as placeholders for values in a query, as they are ignored by the SQL engine.

**Final Answer in CSV Format:**

Assuming you run the above calculations and obtain the percentage value, the final answer should be formatted as:

```csv
Percentage_not_using_quinapril_and_related_medications
percentage_value: float between 0 and 100
```

**Example:**

```csv
Percentage_not_using_quinapril_and_related_medications
85.76
```

*(Please replace `85.76` with the actual calculated percentage based on your data.)*

---

**Summary:**

The syntax error occurred because the SQL parser expected a value after the equals sign in the `WHERE` clause, but it found a comment instead. By replacing the comment with the actual `concept_id` for quinapril, the query becomes valid. Always ensure that any placeholders or comments are replaced with actual values when running SQL queries.
2025-01-16 22:01:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 22:01:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 22:01:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 22:01:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-16 22:01:50 - snowflake.connector.connection - INFO - closed
2025-01-16 22:01:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 22:01:51 - root - INFO - SQL:
SELECT
       100.0 * (
         (total.total_participants - users.users_of_quinapril_related_medications) 
         / total.total_participants
       ) AS "percentage_not_using_quinapril_and_related_medications"
     FROM
       (
         SELECT COUNT(DISTINCT "person_id") AS total_participants
         FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON"
       ) total,
       (
         SELECT COUNT(DISTINCT "person_id") AS users_of_quinapril_related_medications
         FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
         WHERE "drug_concept_id" IN (
             SELECT DISTINCT "descendant_concept_id"
             FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT_ANCESTOR"
             WHERE "ancestor_concept_id" = 1331235
         )
       ) users;
Results:
percentage_not_using_quinapril_and_related_medications
90.120700

2025-01-16 22:01:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 22:01:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 22:01:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 22:01:52 - snowflake.connector.connection - INFO - closed
2025-01-16 22:01:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 22:02:19 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 22:02:19 - root - INFO - **Explanation of the Error:**

Your SQL query is encountering an error because of the use of a placeholder comment within the `IN` clause. In SQL, anything between `/*` and `*/` is considered a comment and is ignored by the SQL parser. This leads to a syntactical issue when the parser expects values within the `IN` clause but finds none.

**Your Query:**

```sql
SELECT DISTINCT "person_id", "drug_concept_id"
FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
WHERE "drug_concept_id" IN (/* list of quinapril-related concept_ids */)
LIMIT 1000;
```

**Issue:**

- The placeholder `/* list of quinapril-related concept_ids */` is treated as a comment and ignored by the SQL engine.
- This results in the `IN` clause being empty: `IN ()`, which is invalid SQL syntax.
- The parser expects a non-empty list of values within the parentheses.

**Solution:**

To fix the error, you need to replace the placeholder comment with a valid list of concept IDs or a subquery that returns the list of quinapril-related concept IDs.

**Steps to Correct the Query:**

1. **Use a Subquery to Obtain the List of Related Concept IDs:**

   Since the list of quinapril-related concept IDs may be extensive, it's practical to use a subquery to fetch them dynamically from the `CONCEPT_ANCESTOR` table.

2. **Corrected Query:**

   ```sql
   SELECT DISTINCT "person_id", "drug_concept_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
   WHERE "drug_concept_id" IN (
       SELECT DISTINCT "descendant_concept_id"
       FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT_ANCESTOR"
       WHERE "ancestor_concept_id" = 1331235
   )
   LIMIT 1000;
   ```

   - Here, `1331235` is the `concept_id` for quinapril obtained from your previous query.
   - The subquery retrieves all `descendant_concept_id`s related to quinapril.
   - These IDs are then used in the `IN` clause to select relevant drug exposures.

3. **Explanation of the Corrected Query:**

   - **Main Query:**
     - Selects distinct `person_id` and `drug_concept_id` from the `DRUG_EXPOSURE` table.
     - Filters records where the `drug_concept_id` matches any of the quinapril-related concept IDs.

   - **Subquery:**
     - Selects distinct `descendant_concept_id` from the `CONCEPT_ANCESTOR` table where the `ancestor_concept_id` is `1331235` (quinapril).
     - This effectively retrieves all concept IDs of medications that are related to quinapril.

**Additional Steps:**

- **Verify the Subquery Separately:**

  Before running the main query, you might want to verify the subquery independently to ensure it returns the expected concept IDs.

  ```sql
  SELECT DISTINCT "descendant_concept_id"
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT_ANCESTOR"
  WHERE "ancestor_concept_id" = 1331235
  LIMIT 1000;
  ```

- **Retrieve Drug Names for Validation:**

  To better understand which drugs are included, you can retrieve their names:

  ```sql
  SELECT DISTINCT c."concept_id", c."concept_name", c."concept_code", c."vocabulary_id"
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT" c
  WHERE c."concept_id" IN (
      SELECT DISTINCT "descendant_concept_id"
      FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT_ANCESTOR"
      WHERE "ancestor_concept_id" = 1331235
  )
  LIMIT 1000;
  ```

**Summary:**

- Comments in SQL (`/* comment */`) are ignored by the parser.
- Placeholders within comments need to be replaced with actual values or valid SQL code.
- By substituting the placeholder with a subquery that generates the required list of concept IDs, the query becomes syntactically correct.

**Final Notes:**

- Always ensure that your SQL queries contain valid syntax by avoiding unintentional comments or placeholders that are not replaced.
- Utilizing subqueries is an effective way to handle dynamic lists within `IN` clauses when the list of values is derived from other tables.

**I hope this helps you resolve the error and successfully retrieve the desired data.**
2025-01-16 22:02:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 22:02:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 22:02:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 22:02:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 22:02:21 - snowflake.connector.connection - INFO - closed
2025-01-16 22:02:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 22:02:21 - root - INFO - SQL:
SELECT DISTINCT c."concept_id", c."concept_name", c."concept_code", c."vocabulary_id"
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT" c
  WHERE c."concept_id" IN (
      SELECT DISTINCT "descendant_concept_id"
      FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT_ANCESTOR"
      WHERE "ancestor_concept_id" = 1331235
  )
  LIMIT 1000;
Results:
Too long, hard cut:
concept_id,concept_name,concept_code,vocabulary_id
35764775,quinapril 20 MG Delayed Release Oral Tablet by Mawdsley-Brooks,OMOP2766236,RxNorm Extension
40979155,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Delayed Release Oral Tablet [Quinaplus Al] Box of 100 by Aliud,OMOP2177117,RxNorm Extension
41084024,quinapril 5 MG Oral Tablet Box of 56,OMOP2281986,RxNorm Extension
43273756,quinapril 10 MG Oral Tablet Box of 30 by Pfizer,OMOP546905,RxNorm Extension
41164663,quinapril 5 MG Delayed Release Oral Tablet [Accupron] Box of 56 by Gerke,OMOP2362625,RxNorm Extension
43217641,quinapril 20 MG Delayed Release Oral Tablet [QUINAPRIL BIOGARAN] Box of 28 by Biogaran,OMOP499996,RxNorm Extension
43157076,Hydrochlorothiazide / quinapril Delayed Release Oral Tablet [QUINAPRIL/HYDROCHLOROTHIAZIDE ZENTIVA],OMOP448048,RxNorm Extension
41198361,Hydrochlorothiazide 12.5 MG / quinapril 10 MG Oral Tablet Box of 100 by Novartis,OMOP2396323,RxNorm Extension
19078104,Hydrochlorothiazide 12.5 MG / quinapril 10 MG Oral Tablet,310796,RxNorm
41032217,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Delayed Release Oral Tablet [Accuzide] Box of 300,OMOP2230179,RxNorm Extension
41059190,quinapril 5 MG Delayed Release Oral Tablet [Accupron] Box of 500,OMOP2257152,RxNorm Extension
43289970,quinapril 10 MG Oral Tablet [Acquin],OMOP546910,RxNorm Extension
43145819,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Delayed Release Oral Tablet [QUINAPRIL/HYDROCHLOROTHIAZIDE MYLAN] Box of 28,OMOP448082,RxNorm Extension
41059185,quinapril 10 MG Delayed Release Oral Tablet [Accupro] Box of 30,OMOP2257147,RxNorm Extension
35773338,quinapril 10 MG Delayed Release Oral Tablet [Accupro] Box of 28 by Pfizer,OMOP2774799,RxNorm Extension
21092310,quinapril 40 MG Oral Tablet by Ranbaxy,OMOP374050,RxNorm Extension
44185726,quinapril 5 MG Delayed Release Oral Tablet [Accupro] Box of 28 by Gerke,OMOP3062449,RxNorm Extension
41184488,quinapril 5 MG Oral Tablet [Quinalich] Box of 50,OMOP2382450,RxNorm Extension
40969799,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Oral Tablet [Accuzide] Box of 300,OMOP2167761,RxNorm Extension
44174519,quinapril 20 MG Delayed Release Oral Tablet [Quinapril Abz] Box of 30 by AbZ-Pharma,OMOP3051242,RxNorm Extension
41072879,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Oral Tablet Box of 50 by Betapharm,OMOP2270841,RxNorm Extension
41167015,Hydrochlorothiazide 12.5 MG / quinapril 10 MG Oral Tablet [Quinaplus Stada] Box of 50 by Stada,OMOP2364977,RxNorm Extension
43151722,quinapril Delayed Release Oral Tablet [QUINAPRIL MYLAN],OMOP499939,RxNorm Extension
41177766,quinapril 10 MG Oral Tablet Box of 50,OMOP2375728,RxNorm Extension
44127099,quinapril 40 MG Oral Tablet by Pro Doc Limitee,OMOP1121730,RxNorm Extension
21161193,Hydrochlorothiazide 12.5 MG / quinapril 10 MG Oral Tablet [Accuretic] by Waymade,OMOP374140,RxNorm Extension
41246828,quinapril 20 MG Oral Tablet [Quinapril Abz],OMOP2444790,RxNorm Extension
44162295,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Delayed Release Oral Tablet [Quinapril Heumann] Box of 50,OMOP3039018,RxNorm Extension
40876475,Hydrochlorothiazide 12.5 MG / quinapril 10 MG Oral Tablet [Quinaplus Al] Box of 100,OMOP2074437,RxNorm Extension
41308880,quinapril 40 MG Oral Tablet [Quinapril Hexal Comp],OMOP2506842,RxNorm Extension
21053120,quinapril 20 MG Oral Tablet by TEVA,OMOP373957,RxNorm Extension
40914476,quinapril 5 MG Oral Tablet [Quinapril Abz] Box of 50 by AbZ-Pharma,OMOP2112438,RxNorm Extension
41308886,quinapril 5 MG Oral Tablet [Quinapril Ct] Box of 100,OMOP2506848,RxNorm Extension
41260260,Hydrochlorothiazide 12.5 MG / quinapril 10 MG Oral Tablet [Quinaplus Al] Box of 30 by Aliud,OMOP2458222,RxNorm Extension
40885932,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Oral Tablet Box of 30 by Novartis,OMOP2083894,RxNorm Extension
43257374,quinapril 20 MG Oral Tablet by Generic Health,OMOP546872,RxNorm Extension
41027971,quinapril 10 MG Oral Tablet [Quinalich] Box of 50,OMOP2225933,RxNorm Extension
35756489,quinapril 20 MG Delayed Release Oral Tablet Box of 28 by Mawdsley-Brooks,OMOP2757950,RxNorm Extension
40883565,quinapril 20 MG Oral Tablet Box of 50 by Ratiopharm,OMOP2081527,RxNorm Extension
43189937,Hydrochlorothiazide 12.5 MG / quinapril 20 MG [QUINAPRIL/HYDROCHLOROTHIAZIDE ARROW],OMOP448052,RxNorm Extension
41001111,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Delayed Release Oral Tablet [Acuretic],OMOP2199073,RxNorm Extension
44178269,quinapril 10 MG Delayed Release Oral Tablet [Quinapril Heumann] Box of 100 by Heumann,OMOP3054992,RxNorm Extension
41094952,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Oral Tablet [Quinapril Heumann] Box of 50,OMOP2292914,RxNorm Extension
44180538,quinapril 10 MG Delayed Release Oral Tablet [Quinalich] Box of 50,OMOP3057261,RxNorm Extension
41277668,quinapril 10 MG Delayed Release Oral Tablet [Quinapril Heumann] Box of 30,OMOP2475630,RxNorm Extension
35743908,quinapril 5 MG Delayed Release Oral Tablet Box of 28 by TEVA,OMOP2745369,RxNorm Extension
44088106,quinap

2025-01-16 22:02:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 22:02:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 22:02:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 22:02:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 22:02:22 - snowflake.connector.connection - INFO - closed
2025-01-16 22:02:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 22:02:23 - root - INFO - SQL:
SELECT DISTINCT "drug_concept_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
   LIMIT 1000;
Results:
Too long, hard cut:
drug_concept_id
40080069
46275982
40018375
2213462
19022064
1589505
19020053
40237878
19122220
40170472
19023567
40163468
19079172
40163568
40228214
40162711
19074842
40175215
40162683
40174943
1168160
40224645
40174409
40221913
19073181
40172047
40224805
40226771
1328556
40168016
19025333
40233955
40163212
19096179
40170348
19020478
40162777
40171946
1120734
19114316
19131644
40231804
1769538
19057566
40165757
19047487
751889
40184729
19027831
40175876
40184084
40172737
40173594
46275604
19132040
700322
40173563
528325
40233295
19079835
19082577
40169706
42873817
40225747
19031629
40172513
42799866
40162483
975470
19037969
40173301
1152738
40163548
907267
40239104
46275505
19065475
40168673
19032967
703252
40169274
40165499
40161678
997997
1321363
19073650
1734107
19132436
19071494
19078551
40226528
1781407
40243514
40171504
1166028
40169391
19096196
1309992
40165543
40237124
741575
19031851
40163230
40162091
19074785
975490
42899227
40169267
1782543
40174179
19077766
19004471
40164099
40226328
19077736
1160013
40171692
1153668
19131884
19076707
1165095
19029901
40232127
40174707
19034327
40163128
40162925
957235
1547505
42873968
40224350
19030091
19023062
42901923
942496
19078663
19133751
40165733
40172776
40231899
40222902
40171322
42799699
19028249
40175307
40165708
19125164
40170173
19079690
2213490
40172239
19057912
40228215
40227492
19043739
551854
19034041
19131017
40169353
19016710
1036144
40223155
2213451
40222659
40225083
1746118
19124649
986148
40233236
920623
19122808
1131495
40225037
40230471
46287393
40162937
40163220
40224359
40160962
907422
19032168
40239152
19108043
19068753
40163913
40237540
40175079
40221871
40173537
19027884
40244165
1119155
19039818
42799660
778769
19124661
46275077
40226430
19030761
19096491
42873659
40166418
19033982
40174148
40181425
19126570
40165012
40169278
40072348
1506270
40141823
1550776
19133296
19071475
19076734
40231813
40167824
42800850
1037007
19134410
19008700
40225166
916945
1314009
781062
19080003
755739
19072237
19077549
40172522
19078607
40162553
19077763
19123355
40174097
19025331
40169909
40232735
19077653
40185006
40162940
19074847
1304793
1314008
19027624
40174402
40170580
974200
42708410
19074181
40029020
40167202
19131621
992591
19019310
40168170
40161244
1305472
40222727
19058921
19132315
40163850
1554073
40173949
19096813
922806
19027106
19029813
19027941
42708690
40224209
40244027
984237
42799599
40169484
19024536
19133840
967309
40163991
1501454
19030197
40170029
1350490
42800708
40185416
19019071
19066196
1711525
40172268
40164196
19124179
43532891
40161105
40174404
42707244
903284
40174838
789580
40242129
40234043
40163520
712620
1567232
1768851
40243206
40236857
19075606
43011909
1361859
40233977
40168374
40164331
19020365
19079712
19041421
19125278
1337190
19102555
45776438
19125468
40239806
40173152
40221631
40224837
19077302
19133232
40179707
40229805
46275355
40236575
19079088
40232730
40175919
40235213
19113858
40223769
918635
40175943
40232217
40161591
1165157
904598
40172263
40161517
46275202
40173385
19132872
42709047
40170957
40222467
948557
19032969
40222227
19028247
1177822
19113288
1777287
40185304
40175677
42902095
19003272
40164617
1396013
40239796
19080218
19121298
1128871
40241162
40166808
1134561
40234410
40226253
42902075
19019158
40167605
19047210
40063294
40226552
1188235
919528
916949
1762775
1799158
40171513
19037780
19030770
19129737
19076926
1548199
1194535
1237159
40232477
40221650
40228967
40224898
40163827
1550579
1001194
40167368
992616
1836519
19127526
19102572
40175124
40173400
19038503
42898829
1560750
19098330
19019009
40164340
19130288
40229970
42707604
40224559
40238436
1318984
735477
40166464
42799562
1121524
19040961
974163
551463
19029941
40172377
40181873
40231990
40239737
40173398
40164778
19018389
1312779
40238009
19067262
40232569
40229055
42873728
19122898
19095289
43527208
43013597
19069321
40226401
19033716
40034680
46275076
1308290
40094836
40015456
535714
40078598
40221966
19075034
1127433
19095325
1763844
1797516
40170333
42800271
40223553
40172130
19019074
40163525
43011850
19020367
40161236
19042762
596898
40226864
19114928
1314006
19129440
40161732
1754996
720730
2213495
987250
40227233
19035622
19078106
19102640
40221651
19074272
19136019
19079982
19095153
982109
19023563
40165262
2213443
2213395
40222456
924442
1115244
40174494
19133562
1126494
923541
19127534
40161631
40172706
40170747
1154079
1797576
1560558
917310
40169004
19064963
957626
19034011
40236828
45776287
19045932
1791016
711585
19008547
19028939
1196532
40174357
1522990
40175311
43012671
19131060
40227393
43011889
40161752
19098439
1799140
40227483
40224604
44818237
19121208
40225741
19005066
917082
40222579
40224642
40163070
19079685
19022487
1769562
40225940
19071784
19077941
19102739
40226678
40167847
19038643
40227396
40224085
40163757
40233950
40163541
40170820
19075395
919005
40232648
19027461
40239110
19030005
42902059
40172215
19127397
19135492
40172412
40175289
974196
40223170
1387785
997961
19098491
19096794
4016

2025-01-16 22:02:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 22:02:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 22:02:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 22:02:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 22:02:25 - snowflake.connector.connection - INFO - closed
2025-01-16 22:02:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 22:02:26 - root - INFO - SQL:
SELECT DISTINCT "concept_id", "concept_name", "concept_code"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
   WHERE "concept_id" IN (
       SELECT DISTINCT "drug_concept_id"
       FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
   )
   LIMIT 1000;
Results:
Too long, hard cut:
concept_id,concept_name,concept_code
40172351,green ash pollen extract 25 MG/ML / white ash pollen extract 25 MG/ML Injectable Solution,900064
1503059,Aminoglutethimide 250 MG Oral Tablet,197352
964731,Salicylic Acid 20 MG/ML / Sulfur 30 MG/ML Topical Cream,244537
40221955,Acetaminophen 500 MG / Orphenadrine Citrate 50 MG Oral Tablet,994809
40163525,Warfarin Sodium 2 MG Oral Tablet [Coumadin],855304
19038682,Thiothixene 1 MG Oral Capsule [Navane],208492
40226744,orange allergenic extract 50 MG/ML Injectable Solution,1010858
40227778,CARBETAPENTANE CITRATE 4 MG/ML / Guaifenesin 20 MG/ML / Phenylephrine Hydrochloride 3 MG/ML Oral Solution,1037245
40161827,American house dust mite extract 30 AU/ML Injectable Solution,854046
19130786,Alanine 8.8 MG/ML / Arginine 4.89 MG/ML / Glucose 100 MG/ML / Glycine 4.38 MG/ML / Histidine 2.04 MG/ML / Isoleucine 2.55 MG/ML / Leucine 3.11 MG/ML / Lysine 2.47 MG/ML / Methionine 1.7 MG/ML / Phenylalanine 2.38 MG/ML / Proline 2.89 MG/ML / Serine 2.13 M,800405
42708140,Brompheniramine Maleate 0.8 MG/ML / Pseudoephedrine Hydrochloride 4 MG/ML Oral Solution [BroveX PSB],1243500
40049686,Hydrocortisone Injectable Solution,370648
43526136,Dexamethasone sodium phosphate 24 MG/ML Injectable Solution,1376068
40171584,Allscale pollen extract 10000 UNT/ML Injectable Solution,897311
19077941,Haloperidol 1 MG/ML Oral Solution,310673
19133672,Desmopressin Acetate 0.15 MG/ACTUAT Nasal Spray [Stimate],831460
40162477,Acetaminophen 500 MG / Hydrocodone Bitartrate 5 MG Oral Capsule [Dolacet],857159
40165081,Nicardipine hydrochloride 20 MG Oral Capsule [Cardene],858615
43014091,hydrocortisone valerate 2 MG/ML Topical Cream,1370754
19032226,Levodopa 250 MG Oral Tablet [Larodopa],206386
19032269,Methadyl Acetate 10 MG/ML Oral Solution [Orlaam],206399
906933,Metoclopramide 5 MG Oral Tablet,311668
19128297,terbinafine 187.5 MG Oral Granules [Lamisil],753108
42902108,methylprednisolone acetate 20 MG/ML Injectable Suspension [Depo-Medrol],1358512
19076899,Epinephrine 1 MG/ML Injectable Solution,310132
40224911,Doxepin Hydrochloride 50 MG/ML Topical Cream [Zonalon],1000095
19078632,"Insulin, Regular, Pork 100 UNT/ML Injectable Solution",311057
40175212,Levothyroxine Sodium 0.05 MG Oral Tablet [Euthyrox],966160
19037521,Hydrochlorothiazide 50 MG / Spironolactone 50 MG Oral Tablet [Aldactazide],208116
40230466,azelaic acid 0.15 MG/MG Topical Gel [Finacea],1043748
19076707,Dolasetron 50 MG Oral Tablet,310007
40060257,cytomegalovirus immune globulin Injectable Solution,376867
46275899,ANTI-INHIBITOR COAGULANT COMPLEX 1 UNT,1659996
40164694,Hydrocodone Bitartrate 10 MG / Ibuprofen 200 MG Oral Tablet [Reprexain],859331
19019004,Fluconazole 50 MG Oral Tablet,197701
19073306,Amylases 70000 UNT / Endopeptidases 55000 UNT / Lipase 25000 UNT Delayed Release Oral Capsule,308241
19114108,Citric Acid 66.8 MG/ML / sodium citrate 100 MG/ML Oral Solution [Cytra 2],543018
46276333,3 ML Amiodarone hydrochloride 50 MG/ML Injection,1663224
1000774,Granisetron 1 MG/ML Injectable Solution [Kytril],152625
42901957,Brompheniramine Maleate 4 MG / Phenylpropanolamine Hydrochloride 25 MG Oral Tablet,1357428
1636872,testosterone cypionate 100 MG/ML Injectable Solution [Depo-testosterone],835831
19040307,Lovastatin 10 MG Oral Tablet [Mevacor],209013
40231737,{21 (Ethinyl Estradiol 0.035 MG / Norethindrone 1 MG Oral Tablet) / 7 (Inert Ingredients 1 MG Oral Tablet) } Pack [Cyclafem 1/35 28 Day],1047040
40238419,Nefazodone hydrochloride 150 MG Oral Tablet,1098666
19032001,Guaifenesin 6.67 MG/ML / Theophylline 6.67 MG/ML Oral Solution [Elixophyllin-GG],206318
19046436,Sodium Fluoride 1 MG Oral Tablet [Fluorodex],211806
40164762,Guaifenesin 40 MG/ML / Hydrocodone Bitartrate 0.5 MG/ML Oral Solution,859383
19131609,Phentermine Hydrochloride 37.5 MG Oral Capsule [Adipex-P],803350
40243890,Fluocinolone Acetonide 0.25 MG/ML Topical Cream [Synemol],1191321
19036748,Stanozolol 2 MG Oral Tablet [Winstrol],207890
40183581,Fenbendazole 0.1 MG/MG Oral Paste [Safe-Guard],993348
40166822,24 HR Hydrochlorothiazide 12.5 MG / metoprolol succinate 50 MG Extended Release Oral Tablet [Dutoprol],866475
40162500,Acetaminophen 500 MG / Hydrocodone Bitartrate 5 MG Oral Tablet [Panacet],857373
1714304,voriconazole 200 MG Oral Tablet [Vfend],352219
19004032,mycophenolate mofetil 500 MG Injection [Cellcept],213394
19079973,desoxycorticosterone 25 MG/ML Injectable Suspension [Percorten V],584596
1154619,200 ACTUAT Albuterol 0.09 MG/ACTUAT Metered Dose Inhaler [ProAir],745752
939801,10 ML Sodium Bicarbonate 84 MG/ML Prefilled Syringe,792577
19122278,Guaifenesin 900 MG / Phenylephrine 30 MG Extended Release Oral Tablet [Deconex],602191
1728606,2 ML penicillin G benzathine 600000 UNT/ML Prefilled Syringe [Bicillin L-A],731568
40169352,24 HR quetiapine 150 MG Extended Release Oral Tablet,895670
19057568,Vancomycin 100 MG/ML Injectable Solution,239209
40226821,Epinephrine 0.005 MG/ML / Lidocaine Hydrochloride 15 MG/ML Injectable Solution [Xylocaine with Epinephrine],10

2025-01-16 22:02:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 22:02:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 22:02:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 22:02:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 41
2025-01-16 22:02:27 - snowflake.connector.connection - INFO - closed
2025-01-16 22:02:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 22:02:28 - root - INFO - SQL:
SELECT DISTINCT "vocabulary_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
   LIMIT 1000;
Results:
vocabulary_id
NDC
Specialty
Observation Type
ICD10CM
RxNorm
HCPCS
Gender
VA Class
Meas Type
Note Type
Cost Type
Device Type
Race
Concept Class
Place of Service
None
SNOMED
Drug Type
Condition Type
SPL
ICD9CM
ICD9Proc
ABMS
Revenue Code
RxNorm Extension
Relationship
Vocabulary
Visit
Procedure Type
Domain
Death Type
CPT4
UCUM
NUCC
Currency
Visit Type
LOINC
Obs Period Type
NDFRT
ATC
Ethnicity

2025-01-16 22:02:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 22:02:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 22:02:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 22:02:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 22:02:29 - snowflake.connector.connection - INFO - closed
2025-01-16 22:02:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 22:02:30 - root - INFO - SQL:
SELECT DISTINCT "concept_id", "concept_name", "concept_code"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
   WHERE "vocabulary_id" = 'RxNorm' AND "concept_class_id" = 'Ingredient'
   LIMIT 1000;
Results:
Too long, hard cut:
concept_id,concept_name,concept_code
19055569,AMINO ACIDS 11.4%,235892
19115027,"japanese encepahlitis virus vaccine, inactivated",547233
42900213,TRIBASIC SODIUM PHOSPHATE,1307159
42899523,Iris versicolor root extract,1309668
42899166,Helianthemum canadense extract,1311106
42898659,Asterias rubens preparation,1311303
19080273,"ALLERGENIC EXTRACT, ASPERGILLUS NIGER",314323
19009915,Trichophyton mentagrophytes,10786
40053046,IPECAC ALKALOIDS,317237
40150665,"Hepatitis A Vaccine, Inactivated strain HM175",797750
40161463,Russian olive pollen extract,852367
40160943,English walnut pollen extract,852577
40172321,mustard seed allergenic extract,899456
40175868,green bell pepper allergenic extract,862478
43526351,SILODRATE,1373351
43013946,behenate,1368204
43525811,Boswellia sacra bark extract,1371444
35604368,Cymbidium hookerianum flower extract,1737791
40220703,Magnolia kobus flowering top extract,1801506
44784888,POLYACRYLIC ACID (8000 MW),1484857
43012972,STEARETH-21,1367122
42898489,Bryonia alba root extract,1309676
45775560,ethyl salicylate,1546423
40170916,lobster allergenic extract,892561
44507845,Hyoscyamus niger whole extract,1442993
43560287,"Tilia cordata, whole extract",1432477
42903489,Hexyldecyl Laurate,1312598
43532101,Pepper extract,1427085
42904170,2-propoxy-1-propanol,1356481
42903972,Arthrospira platensis,1321355
19066433,MILK THISTLE SEED EXTRACT,259274
1593946,Sepia officinalis whole extract,1868205
44784745,Colchicum autumnale seed extract,1485065
44814422,Shigella sonnei,1491872
42899155,Hamamelis virginiana leaf extract,1307887
40170235,Sydney golden wattle pollen extract,895365
1746244,Saquinavir,83395
42904221,Cistus incanus whole extract,1358477
43013669,Ilex paraguariensis whole extract,1368377
35603472,linalyl acetate,1735331
43012917,Poloxamer 338,1364384
45776898,Bos taurus somatic nerve preparation,1544245
42904166,TRIOCTYLDODECYL CITRATE,1356150
45775350,cadmium cation,1546276
42898527,Bos taurus knee joint preparation,1310262
42903470,chromium dioxide,1312546
43532204,TRIISOSTEARIN,1426662
42903858,POLOXAMER 124,1314379
42904084,Bowfin preparation,1347559
42904057,Fucus serratus extract,1342489
43532477,perillaldehyde,1426913
19050560,Eugenol,4186
19071809,TOXICODENDRON Preparation,285166
19136031,Saralasin,9556
19015703,ferumoxides,72901
43532450,saccharomyces lysate extract,1426343
35604418,ALLYL ACRYLATE,1788869
43525889,Gynostemma pentaphyllum top extract,1372927
19060992,Malt soup extract,91264
42904227,"1,3-dimethylurea",1358483
45775722,ETHYL PERFLUOROBUTYL ETHER,1540871
1594087,"ethyl 2,4-decadienoate, (2E,4Z)-",1869048
45775965,pembrolizumab,1547545
45892905,"((2s,3s,5s)-2-(2-(2,6-dimethylphenoxy)acetamido)-5-((s)-3-methyl-2-(2-oxotetrahydropyrimidin-1(2h)-yl)butanamido)-1,6-diphenylhexan-3-yl) 3-methyl-2-(2-oxotetrahydropyrimidin-1(2h)-yl)butanoate, (s)-",1599828
43532088,PPG-2 MYRISTYL ETHER PROPIONATE,1426407
42903950,Xerophyllum asphodeloides extract,1318234
45774933,Daphne mezereum whole extract,1545790
42900078,Solidago virgaurea flowering top extract,1309763
42898271,AMINOMETHYL PROPANEDIOL,1307680
42904248,Tremella fuciformis fruiting body extract,1358890
45774751,empagliflozin,1545653
43532388,HYDROLYSED MARINE COLLAGEN (ENZYMATIC; 2000 MW),1427229
45774848,Uncaria gambir whole extract,1539191
43531972,L-lactate,1427172
42899726,Sanicula europaea extract,1311101
42900187,Sus scrofa tooth preparation,1311354
19013828,Hyoscyamus extract,314674
19018640,bopindolol,19605
43532079,POLYOXYL 50 HYDROGENATED CASTOR OIL,1426435
43527177,etilevodopa,1421444
40175802,barley smut extract,968492
42900143,Sus scrofa esophagus preparation,1311328
42898571,CARBOMER COPOLYMER TYPE A,1310599
40228827,sugarcane allergenic extract,1014711
45892869,Strychnos nux-vomica whole extract,1599640
43014180,palmitoyl glutamate,1370585
42899065,Dill Seed Oil,1309204
44784749,Common hazel pollen extract,1484979
1593942,Astragalus chinensis seed extract,1868198
40167582,ofatumumab,712566
42900474,Interleukin-11,1311380
1593873,Ginkgo biloba root extract,1918243
35603210,diethylene glycol monophenyl ether,1719253
42898327,Angelica archangelica root extract,1309828
42900502,lesser galangal root extract,1307953
42898557,CALENDULA OFFICINALIS SEED OIL,1307790
43531845,diethylamino hydroxybenzoyl hexyl benzoate,1426392
42903718,tartrate,1314221
46234308,Rabies virus,1648419
42898269,ALUMINUM ZIRCONIUM TETRACHLOROHYDREX GLY,1305896
46221503,PEG-60 LANOLIN,1603523
35603445,Luffa aegyptiaca fruit extract,1735043
40240027,gamithromycin,1113697
43013507,C12-13 pareth-3,1368907
42903800,Halimeda opuntia extract,1314311
19091239,domiphen,23623
19009405,Vitamin D,11253
1103552,almotriptan,279645
19118007,STANNOUS TARTRATE,56701
1391861,Yohimbe bark preparation,236801
42900107,Tetrakis(1-isocyano-2-methoxy-2-methyl-propane)-copper(i) Tetrafluoroborate,1306061
40224712,barley malt allergenic extract,1006510
43532253,Yucca Schidigera extract,1425403
42900537,thallium sulfate,1309339
43531987,Lachnanthes caro

2025-01-16 22:02:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 22:02:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 22:02:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 22:02:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 22:02:31 - snowflake.connector.connection - INFO - closed
2025-01-16 22:02:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 22:02:32 - root - INFO - SQL:
SELECT DISTINCT "drug_source_value"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
    LIMIT 1000;
Results:
Too long, hard cut:
drug_source_value
J2710
J9206
J0500
00143178750
17236035001
58016027618
59115002475
00024414210
51129307501
00044101200
00677057501
67618031001
65862045012
51432061820
58716077112
43683012430
00179026530
55045112201
52446010021
00364060501
55289086330
00689512502
54868432500
54799054035
00781941292
55887031230
58016014815
00185002305
C9257
55175121900
10135028430
00364720930
61392044625
00245360023
58016062989
00469562040
48692001310
J7645
J7190
00054338363
65862031350
00254210302
52446070764
00228200350
00228303003
00085083402
21695030710
49348092109
00254785174
55887066615
67046052060
67113000401
17314370505
23490794602
51129186601
00406831505
53002030315
00378132305
51079001919
00032102352
00781322391
36987174302
55567004100
51660001510
50175031802
18837015795
00157028510
12634051471
21695001490
00247033715
00332310704
00677142205
66689003850
55289018640
68382004105
58165003202
51014089803
52735045226
00006404541
58177088880
66116068720
00555102204
43063022090
51301007616
54868474302
00074245202
57844020852
J2540
58016099367
62584023801
54569860103
51079001940
61314032815
36987212503
24338065661
00179120130
55045121005
14593010203
55983083711
44206025110
55887017330
52959086800
66267000115
00075291201
49648062975
00490710796
55567016213
00117108205
63629177406
59702007501
36987228801
49692090375
62076004503
00247119101
51432090303
58016003000
58016009399
00590511065
54568050002
65505062212
58016021236
52959066760
58016049328
00756035103
36987315801
10678000106
54569108800
13668002210
61392041791
61442022301
60758095215
58016035590
00364218041
00832820316
00088155220
12634078350
24236058102
58016062098
00157071001
66479058403
63874021560
23490151602
49348037469
63874107402
55111023430
34330000112
52959001124
00054002517
58016008340
54868398603
54868311103
55749000106
00228303111
54569091401
51129436001
58016010900
00527138301
61392090830
49288007203
24236026302
58016021621
52446093478
63874050440
36987257703
00281231117
43806054812
11523720002
00839678665
52959090909
00839610925
49999006000
42549060940
51129116101
52544077401
53568022002
00074226605
00574083625
58768087705
40042004805
52544081055
32889025810
54868400900
00013330351
61392049695
00056066085
00904399060
49884008712
00247192300
00004024208
58016086975
00814091814
55887067910
00603650066
00007036720
60312026709
58016057404
00409118021
52428000103
00405213516
49281025010
55045333101
10135012690
58016013856
00378015105
54868310503
52152021402
68788052806
49643004850
00574200202
00186125013
00406871004
00591558206
52555034101
54838021780
58016080824
59855027507
67544040115
43806072401
59676031200
58016305601
61392069539
49999034760
00066060307
00268668305
51285090802
50111088224
54868368601
62825000101
00719525151
68115017120
36987293804
58016070128
00074241614
54569469900
64980016201
00062065530
53261036324
49856268003
18837006460
45782000001
55175294302
60432024504
00591341605
51079016120
12838160104
67776045603
36987160301
49884031191
55289032416
59747011775
68462019401
00074490334
51672413800
36987106003
68820002317
52297011110
00527071528
11695910505
67402002106
11845039020
18837005530
66267010720
51655002030
12071029010
58016013905
53808076601
68115033000
00185019860
00548192710
66394003060
00904580315
23589001116
55045285306
61314022505
58016051089
54569001507
67870011305
00085083403
00037540030
43353015960
52584009501
26053009401
55154525004
52347661501
11023000111
63629397603
00378312093
54868420801
54868596601
67296026601
52446070766
00641027325
00223728010
62584064533
00006097151
36987185501
63629159701
37937019907
00247210002
00536345701
00527101210
54523013040
00472120006
58016079950
55289061514
58016019914
00281029807
16590027690
68387053630
61703022543
52493064830
00074159003
00223410802
58160084241
46672058516
59842001203
36987223801
46672024610
00157029144
87900092748
58016019921
16590032360
66267031310
64679076001
65649010102
60505008309
50111032501
51432052122
54868559001
00349874110
00085175801
36987184101
52959067430
23490500503
60505131001
67544003365
00247002701
58016033967
00814024020
00115230003
15330010210
64011006126
49725019130
60940000901
54569029800
58864051201
49999041830
65862004130
00302171001
11819006598
52959034920
52959033840
67296003602
55045295809
61392090665
55887047282
48695122003
61392090430
58016088932
00179155671
00254417221
00781217669
00548605600
64920000105
00223619901
00402090810
00179127970
67296004101
33261005436
49999002640
36987144601
16837087010
52544015130
57896010110
00247012528
00247002278
00555021702
68071028491
68387010010
00904766224
35470215709
00024072702
23490001009
58016178015
58016087220
00029600921
58016013216
52959044520
68788138501
00839151706
66336008530
49884056605
11509021516
50580027024
53261025720
62037052201
68752001160
00173068221
63874026702
00349210398
00378055305
53746046505
00501750605
00093711556
00172531200
58016008798
66267021015
21695010430
58356000103
21695026910
36987188701
00677066101
00247014040
55887091730
00904055870
00536443120
43858028501
68382001806
59702080

2025-01-16 22:02:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 22:02:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 22:02:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 22:02:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 18
2025-01-16 22:02:33 - snowflake.connector.connection - INFO - closed
2025-01-16 22:02:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 22:02:34 - root - INFO - SQL:
SELECT DISTINCT "concept_code", "concept_name"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
    WHERE LOWER("concept_name") LIKE '%ace inhibitor%'
    LIMIT 1000;
Results:
concept_code,concept_name
C09B,"ACE INHIBITORS, COMBINATIONS"
C09BB,ACE inhibitors and calcium channel blockers
81608-2,NM for blood flow and kidney function W ACE inhibitor PO
241961007,ACE inhibitor-aggravated angio-oedema-urticaria
C09BX,"ACE inhibitors, other combinations"
4480F,Patient receiving ACE inhibitor/ARB therapy and beta-blocker therapy for 3 months or longer (HF)
C09BA,ACE inhibitors and diuretics
0008F,"ACE inhibitor therapy, prescribed"
371627004,ACE inhibitor-aggravated angioedema
4481F,Patient receiving ACE inhibitor/ARB therapy and beta-blocker therapy for less than 3 months or patient not receiving ACE inhibitor/ARB therapy and beta-blocker therapy (HF)
C09A,"ACE INHIBITORS, PLAIN"
LP31444-0,Ace inhibitors
151223007,ACE inhibitor prophylaxis
315054007,ACE inhibitor prophylaxis
C09AA,"ACE inhibitors, plain"
422593004,Acute renal failure due to ACE inhibitor
CV800,ACE INHIBITORS
182939002,ACE inhibitor prophylaxis

2025-01-16 22:02:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 22:02:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 22:02:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 22:02:35 - snowflake.connector.connection - INFO - closed
2025-01-16 22:02:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 22:03:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 22:03:14 - root - INFO - **Explanation of the Error:**

The error you're encountering is due to the use of placeholder comments (`/* ... */`) within your SQL query. In SQL, anything between `/*` and `*/` is treated as a comment and is ignored by the SQL parser. This leads to syntactical issues when the parser expects values but finds nothing after the equals sign.

**Your Query:**

```sql
SELECT DISTINCT "concept_id_1", "concept_id_2", "relationship_id"
FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT_RELATIONSHIP"
WHERE "concept_id_1" = /* quinapril_concept_id */ OR "concept_id_2" = /* quinapril_concept_id */
LIMIT 1000;
```

**Issue:**

- The placeholders `/* quinapril_concept_id */` are treated as comments and are ignored.
- This results in the WHERE clause being incomplete:

  ```sql
  WHERE "concept_id_1" =  OR "concept_id_2" = 
  ```

- The SQL parser encounters `OR` without a valid expression before it, leading to the error:

  ```
  syntax error line 3 at position 54 unexpected 'OR'.
  ```

- Similarly, it reaches `LIMIT 1000;` without a complete preceding statement, resulting in:

  ```
  syntax error line 4 at position 10 unexpected '1000'.
  ```

**Solution:**

Replace the placeholder comment `/* quinapril_concept_id */` with the actual `concept_id` for quinapril. From your previous queries, you've identified that the `concept_id` for quinapril is **1331235**.

**Corrected Query:**

```sql
SELECT DISTINCT "concept_id_1", "concept_id_2", "relationship_id"
FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT_RELATIONSHIP"
WHERE "concept_id_1" = 1331235 OR "concept_id_2" = 1331235
LIMIT 1000;
```

**Explanation of the Corrected Query:**

- **"concept_id_1" = 1331235**: Selects records where the first concept ID is quinapril.
- **OR "concept_id_2" = 1331235**: Selects records where the second concept ID is quinapril.
- **OR** combines the conditions to include any relationships involving quinapril.
- **LIMIT 1000**: Restricts the output to the first 1000 distinct records.

**Next Steps:**

1. **Run the Corrected Query:**

   ```sql
   SELECT DISTINCT "concept_id_1", "concept_id_2", "relationship_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT_RELATIONSHIP"
   WHERE "concept_id_1" = 1331235 OR "concept_id_2" = 1331235
   LIMIT 1000;
   ```

2. **Interpret the Results:**

   - The query will return relationships involving quinapril.
   - Use the `relationship_id` to understand how quinapril is related to other concepts.
     - For example, `Maps to`, `Has ingredient`, `Is a`, etc.

3. **Retrieve Related Concepts:**

   - You can obtain the names of related concepts by joining with the `CONCEPT` table.

   ```sql
   SELECT
     cr."concept_id_1",
     c1."concept_name" AS "concept_name_1",
     cr."concept_id_2",
     c2."concept_name" AS "concept_name_2",
     cr."relationship_id"
   FROM
     "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT_RELATIONSHIP" cr
     LEFT JOIN "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT" c1 ON cr."concept_id_1" = c1."concept_id"
     LEFT JOIN "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT" c2 ON cr."concept_id_2" = c2."concept_id"
   WHERE
     cr."concept_id_1" = 1331235 OR cr."concept_id_2" = 1331235
   LIMIT 1000;
   ```

   - This query fetches the concept names associated with the concept IDs, providing more context.

**Additional Notes:**

- **Avoid Using Comments as Placeholders:**

  - In SQL, comments are ignored during execution.
  - Use actual values or variables (if supported) instead of placeholders in comments.

- **Understanding the Error Messages:**

  - **"syntax error line 3 at position 54 unexpected 'OR'."**
    - The parser found `OR` but was still expecting a value after the `=`.
  - **"syntax error line 4 at position 10 unexpected '1000'."**
    - The incomplete WHERE clause caused the parser to misinterpret the structure, leading to confusion at the `LIMIT` clause.

**Summary:**

- Replace placeholders with actual values to ensure syntactically correct queries.
- Comments should not be used where the SQL parser expects expressions or values.
- Use joins to enrich your data with additional context, like concept names.

**Example of Retrieving Related Concepts:**

After running the corrected query with joins, you might get results like:

| concept_id_1 | concept_name_1        | concept_id_2 | concept_name_2                  | relationship_id |
|--------------|-----------------------|--------------|---------------------------------|-----------------|
| 1331235      | quinapril             | 19087075     | quinapril 10 MG Oral Tablet     | Has precise ingredient |
| 1331235      | quinapril             | 35752264     | quinapril 5 MG Delayed Release Oral Tablet | Has precise ingredient |
| ...          | ...                   | ...          | ...                             | ...             |

*Note: Replace the data above with actual results from your query.*

**Conclusion:**

By correcting the syntax and replacing placeholders with actual values, you can successfully execute your SQL queries and extract the data needed for your analysis.
2025-01-16 22:03:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 22:03:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 22:03:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 22:03:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 146
2025-01-16 22:03:17 - snowflake.connector.connection - INFO - closed
2025-01-16 22:03:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 22:03:17 - root - INFO - SQL:
SELECT
     cr."concept_id_1",
     c1."concept_name" AS "concept_name_1",
     cr."concept_id_2",
     c2."concept_name" AS "concept_name_2",
     cr."relationship_id"
   FROM
     "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT_RELATIONSHIP" cr
     LEFT JOIN "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT" c1 ON cr."concept_id_1" = c1."concept_id"
     LEFT JOIN "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT" c2 ON cr."concept_id_2" = c2."concept_id"
   WHERE
     cr."concept_id_1" = 1331235 OR cr."concept_id_2" = 1331235
   LIMIT 1000;
Results:
Too long, hard cut:
concept_id_1,concept_name_1,concept_id_2,concept_name_2,relationship_id
1331235,quinapril,4348756,quinapril,RxNorm - NDFRT eq
1331235,quinapril,1331264,quinapril 10 MG,RxNorm ing of
1331235,quinapril,19111733,quinapril 1 MG/ML,RxNorm ing of
1331235,quinapril,40098149,quinapril Injectable Solution,RxNorm ing of
1331235,quinapril,19055338,Quinapril hydrochloride,Has form
1331235,quinapril,36213871,quinapril Injectable Product,RxNorm ing of
1331235,quinapril,43253044,Filpril,Has brand name
1331235,quinapril,43129686,QUINAPRIL/HYDROCHLOROTHIAZIDE MYLAN,Has brand name
1331235,quinapril,44013794,Apo-Quinapril,Has brand name
1331235,quinapril,43252269,Aquinafil,Has brand name
1331235,quinapril,43575131,Quinapril Hexal Comp,Has brand name
1331235,quinapril,43128000,KOREC,Has brand name
1331235,quinapril,40815577,Quinapril Heumann,Has brand name
1331235,quinapril,19113325,Quinaretic,Has brand name
1331235,quinapril,40279463,Quinapril hydrochloride,Mapped from
1331235,quinapril,21601790,quinapril,Mapped from
1331235,quinapril,21601790,quinapril,RxNorm - ATC name
1331235,quinapril,21601790,quinapril,RxNorm - ATC
1331235,quinapril,43129688,QUINAPRIL/HYDROCHLOROTHIAZIDE ZENTIVA,Has brand name
1331235,quinapril,21017288,Quinil,Has brand name
1331235,quinapril,43127027,ACUITEL,Has brand name
1331235,quinapril,43575132,Quinapril-1 A Pharma Plus,Has brand name
1331235,quinapril,43575128,Quinaplus Al,Has brand name
1331235,quinapril,43129682,QUINAPRIL MYLAN,Has brand name
1331235,quinapril,43128001,KORETIC,Has brand name
1331235,quinapril,43129679,QUINAPRIL BIOGARAN,Has brand name
1331235,quinapril,40815542,Quinapril Abz,Has brand name
1331235,quinapril,40815541,Quinapril 1a Pharma Plus,Has brand name
1331235,quinapril,44020216,Ran-Quinapril,Has brand name
1331235,quinapril,43129687,QUINAPRIL/HYDROCHLOROTHIAZIDE TEVA,Has brand name
1331235,quinapril,40815576,Quinapril Ct,Has brand name
1331235,quinapril,43129680,QUINAPRIL EG,Has brand name
1331235,quinapril,43575129,Quinaplus Stada,Has brand name
1331235,quinapril,36213872,quinapril Oral Product,RxNorm ing of
1331235,quinapril,43252119,Acquin,Has brand name
1331235,quinapril,19013171,Accupril,Has brand name
1331235,quinapril,43129683,QUINAPRIL TEVA,Has brand name
1331235,quinapril,44019595,Pms-Quinapril,Has brand name
1331235,quinapril,40815578,Quinapril Stada,Has brand name
1331235,quinapril,40815574,Quinapril Beta,Has brand name
1331235,quinapril,43129684,QUINAPRIL ZENTIVA,Has brand name
4299839,Quinapril,1331235,quinapril,Maps to
4299839,Quinapril,1331235,quinapril,SNOMED - RxNorm eq
43253848,Qpril,1331235,quinapril,Brand name of
19020260,Accuretic,1331235,quinapril,Brand name of
19013468,Accupro,1331235,quinapril,Brand name of
43129685,QUINAPRIL/HYDROCHLOROTHIAZIDE ARROW,1331235,quinapril,Brand name of
44013795,Apo-Quinapril/Hctz,1331235,quinapril,Brand name of
43563561,Accuzide,1331235,quinapril,Brand name of
43127026,ACUILIX,1331235,quinapril,Brand name of
44014962,Gd-Quinapril,1331235,quinapril,Brand name of
43129681,QUINAPRIL HYDROCHLOROTHIAZIDE E,1331235,quinapril,Brand name of
43575130,Quinapril Al,1331235,quinapril,Brand name of
43129678,QUINAPRIL ARROW,1331235,quinapril,Brand name of
40815518,Quinalich,1331235,quinapril,Brand name of
40799391,Accupron,1331235,quinapril,Brand name of
40799538,Acuretic,1331235,quinapril,Brand name of
43129687,QUINAPRIL/HYDROCHLOROTHIAZIDE TEVA,1331235,quinapril,Brand name of
40815576,Quinapril Ct,1331235,quinapril,Brand name of
43129680,QUINAPRIL EG,1331235,quinapril,Brand name of
43575129,Quinaplus Stada,1331235,quinapril,Brand name of
36213872,quinapril Oral Product,1331235,quinapril,RxNorm has ing
4348756,quinapril,1331235,quinapril,NDFRT - RxNorm eq
19111733,quinapril 1 MG/ML,1331235,quinapril,RxNorm has ing
1331264,quinapril 10 MG,1331235,quinapril,RxNorm has ing
40098149,quinapril Injectable Solution,1331235,quinapril,RxNorm has ing
19055338,Quinapril hydrochloride,1331235,quinapril,Form of
36218316,Hydrochlorothiazide / quinapril Oral Product,1331235,quinapril,RxNorm has ing
36218317,Hydrochlorothiazide / quinapril Pill,1331235,quinapril,RxNorm has ing
4029080,Quinapril,1331235,quinapril,SNOMED - RxNorm eq
4029080,Quinapril,1331235,quinapril,Maps to
1331267,quinapril 5 MG,1331235,quinapril,RxNorm has ing
40098150,quinapril Oral Tablet,1331235,quinapril,RxNorm has ing
40045124,Hydrochlorothiazide / quinapril Oral Tablet,1331235,quinapril,RxNorm has ing
43157075,Hydrochlorothiazide / quinapril Delayed Release Oral Tablet,1331235,quinapril,RxNorm has ing
4293356,QUINAPRIL,1331235,quinapril,NDFRT - RxNorm eq
43252269,Aquinafil,1331235,quinapril,Brand name of
43253044,Filpril,1331235,quinapril,Brand name of
43128000,KOREC,1331235,quinapril,Brand name of
43129686,QUINAPRIL/HYDROCHLOROTHIAZIDE MYLAN,1331235,quinapril,Brand name of
44013794,Apo-Quinapril,1331235,quinapril,Brand name of
43575131,Quinapril Hexal Comp,1331235,quinapril,Brand name of
40815577,Quinapril Heumann,1331235,quinapril,Brand name of
19113325,Quinaretic,1331235,

2025-01-16 22:03:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 22:03:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 22:03:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 22:03:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 22:03:19 - snowflake.connector.connection - INFO - closed
2025-01-16 22:03:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 22:03:19 - root - INFO - SQL:
SELECT DISTINCT "person_id"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
    LIMIT 1000;
Results:
Too long, hard cut:
person_id
181389
2277595
1966193
343643
1549423
639750
1225719
749959
638151
1418302
1867190
1189463
65081
61851
1247227
1271984
1818037
1653185
685445
823389
1900299
1713797
575686
911640
724141
369357
146333
1240652
1929635
1229140
831702
1529796
2242108
883004
1544116
896073
2076725
1132187
735605
1986707
227369
2908
39193
1156771
1551457
444535
1344091
116105
2213789
881228
1338673
248279
1719575
1414616
1629657
752264
746751
555696
1888423
831489
815061
2114508
33465
1235619
1952912
957461
1554774
2049721
100613
423177
1437041
1376649
1656295
1170689
2144588
1991450
1164333
271736
1996996
971923
1630986
93269
469891
1134758
30035
1423416
711118
287126
1212352
125099
2190899
1347359
2131017
1324230
14611
1566487
244869
1652497
1114126
812630
1580748
1799390
21037
1008302
521051
496013
184742
1035011
1017623
1638523
804344
1839577
595001
662613
2290796
2246205
1351140
1342649
1316255
1117603
2279348
1039493
1773115
1009346
1617831
749572
186618
1744557
2272714
2240492
175267
1222414
1371980
1160039
1237129
318390
383817
569030
1192344
1562241
1454996
1210314
1605920
2131518
663724
2181944
1012119
817240
751441
2114205
1021128
2323302
597099
1303664
1742269
597080
802580
5031
749234
1488491
1757897
1405173
1467493
857037
678605
212360
2187425
1517864
841585
1265116
1888586
1337942
294784
1056543
221879
489439
1300700
1465629
1813026
77358
1193658
1474870
2018107
1384568
426100
1429798
958235
767294
673133
837201
818282
679942
1063325
1299842
1816951
167203
748997
1743115
306188
33541
339941
168462
563781
1447990
1503881
2162585
916805
1636429
822126
1404956
1383265
808899
483066
1848551
300667
2302155
1709933
1511717
608028
90336
1080058
1522029
1590578
1066215
1809914
1048961
564697
1065780
2298627
1138550
1896135
202267
1130171
1604949
230152
1053577
2094015
1383891
1038790
805934
909134
2077964
1867355
1528660
1177426
1904124
1447742
727276
402813
2184905
1436924
765944
9663
2271883
1464223
1862085
1592844
523273
65709
1933950
1793546
1236087
121214
47735
350389
1688673
1353843
1403218
502093
1048977
201366
972757
2137352
10765
60369
1038951
1641687
690610
1813853
1215058
125203
931197
825713
902140
1702634
54498
1751360
664208
1447286
2305521
1529252
170532
726991
1341402
103791
358806
1588211
2286254
1876065
1114961
1841771
1206855
1969413
863571
692935
833157
193897
592679
910565
1023335
1643381
21058
2043517
1383984
170721
631787
1141891
356367
1928126
2320165
666820
1670558
1736409
317668
2302519
1405969
650340
1056882
251695
1095061
1768406
623724
1017897
1820730
1622765
1582970
105046
2231401
1396328
103318
980915
997502
255477
1364778
691357
1951176
289047
1898344
1562186
2269385
2228798
502660
2011762
178017
1235659
1813480
1050234
2318876
1797770
1072057
1160358
1515650
2320990
130745
898848
2052832
661056
904094
697649
1734025
1619288
1204233
1455825
1844827
1470126
575531
945425
1362532
1515141
198195
1528227
1968798
342638
154020
893509
940878
2119901
1447191
737444
722201
1816025
121114
1314566
439656
118622
604955
120260
1799205
1968788
2142179
909726
1453809
87781
2263811
1035876
1320269
170026
1505262
1092414
1086358
1386910
36554
739506
1603220
1845286
725998
1951912
1918776
1293172
1670546
628001
553272
1501976
323628
1406223
400559
1491690
1377294
1924848
671566
2017155
435273
581111
1871023
1714825
271641
1384272
1279679
1126939
1485380
950121
1102337
2032713
2183776
1501295
276082
1221641
172921
483116
1659427
184771
181137
675142
1363049
252946
183696
308435
1183008
1025810
862847
958841
2179529
1944883
1874214
35881
2001979
836635
1355848
1618335
2024928
2030396
1754355
1589390
333709
458157
1809443
1054094
1143927
460698
609493
538060
1082492
70509
1982882
156642
1997874
399422
1547218
548572
1642152
780863
2133275
1535296
305627
1565899
2129983
973782
288881
57561
1113235
1264877
191478
122984
1986000
1873266
1467737
1380562
1296282
1531259
575565
1557671
1864963
181466
1331187
1559836
530108
1529061
1785928
1417996
935359
964314
1650935
477890
758487
1428271
201904
169835
1258263
1268874
1280208
2049089
771554
853475
722188
2190746
618950
308942
429801
410699
636301
2108447
1356301
1981803
2125903
1318816
2114931
1235867
903890
2285886
379371
1223819
1207160
831092
1686262
2090810
1527264
1852296
1399649
2140644
2312250
1290162
1725240
870810
1207426
1687383
1032892
192958
753165
61737
1130239
1803765
779059
1838719
1546542
344245
44672
2271697
1147027
1529842
2212739
346590
1210693
295028
1724977
967222
1191673
1036683
598493
639005
1395186
312343
718387
1966451
2282085
1963877
1384403
1280337
1811265
2004834
1760687
1297859
183531
1222682
611159
1998356
208162
393884
57844
2194535
2116677
494581
2206758
1389357
1202927
2278803
510275
1631034
1170049
35570
1785967
1223477
475579
1706015
1509251
1492552
658297
1867091
148210
757608
2246815
629824
1591372
1988831
1366492
1649303
2283923
2076856
1151114
970609
819331
203952
1553448
86991
1902712
834505
1854640
1618723
1639192
1408863
127746
1994464
380806
1479237
1701394
1313864
678155
724453
1346561
1290519
1649124
356506
1744

2025-01-16 22:03:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 22:03:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 22:03:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 22:03:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 22:03:21 - snowflake.connector.connection - INFO - closed
2025-01-16 22:03:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 22:03:21 - root - INFO - SQL:
SELECT "drug_concept_id", COUNT(*) AS "exposure_count"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
    GROUP BY "drug_concept_id"
    ORDER BY "exposure_count" DESC
    LIMIT 1000;
Results:
Too long, hard cut:
drug_concept_id,exposure_count
0,3295638
1301125,2756239
2213440,1542698
40098312,1497787
19025280,1225686
19077577,747326
19019418,719275
19019116,638625
1539407,588322
1539411,545702
19019117,541327
957136,499574
40164929,487835
19019044,478711
19077682,464436
40032317,460918
40080069,457202
19076600,446726
19078106,442067
1539463,437291
19019115,425602
1331312,418296
19077546,417263
19076623,400316
19077636,399994
19080129,385924
19080128,384819
1314008,381661
40164897,380970
1309010,378202
964362,369520
40167218,350785
1518606,350555
1308251,337154
708298,333760
19018937,328641
40163342,307048
19077638,306989
1154186,303724
40164946,300813
1000560,299623
40163312,294299
1308221,292767
903963,291657
1332419,287919
40175400,284395
19079658,273928
1129105,268156
40163333,265331
19073093,264214
40175395,263750
1539462,262093
40162494,262087
1340161,261624
40221904,257904
19077659,253619
19019309,246149
1237261,244624
1545997,243673
19123592,243280
40169766,243209
19018811,241743
19018935,241354
40166448,239120
1506270,237392
1594976,236016
40165762,234206
956877,230396
40167202,228133
19075380,225137
40165773,225056
40163361,224897
40165789,223186
929889,221284
1545996,219437
19018850,217155
19077375,216300
1314006,211144
19020053,210655
19018787,208526
1237231,207531
40171852,204500
2213483,204436
1367571,202139
19078166,200689
19019331,200266
19096678,197042
19077463,196639
19074673,195194
1836434,191847
42901480,190649
40171917,186573
1707346,184524
1304643,183714
19080217,182217
19080187,180538
1167323,180482
19073187,180481
40162717,179817
1551838,179456
974226,179050
19025488,176384
961050,175351
40163554,174440
19075601,171803
40163473,170967
40167021,170263
1312743,168633
19074672,167291
739207,166344
19134047,165004
19049684,163773
19100691,163224
40163286,160038
19075394,158502
40175050,157334
40169770,156338
19019332,156319
19078140,156172
745372,154878
19023636,154702
40162672,152754
40162729,152051
1502856,151628
19123105,151447
19095325,149506
1502811,149407
904547,149258
19133622,149209
1363059,148499
40175210,147702
1351583,146926
19074977,146628
1594975,146185
1395073,145575
1154349,145353
907020,145264
19023551,145019
42799606,144897
749932,140544
2213438,139389
1341270,138528
1136980,137820
19022486,136301
40163924,135490
778765,134622
46287340,133594
1154350,132251
19018781,132148
19019310,132090
739209,129872
19019073,128787
1501500,127338
40163524,127080
19046742,126460
967434,125060
19078461,124714
19018875,123774
43011909,123308
40082914,123071
40163460,122891
19077462,122408
40175001,121294
19133570,120577
19079776,119745
19077548,119520
40171884,118781
40162552,118689
1797515,118640
19019074,118401
40169689,118080
19133768,117856
1127433,117537
40165767,117521
19033627,116842
40222796,116368
1350521,115335
40169683,113982
40175174,112831
1504672,112698
40173591,112546
19133566,110965
40174947,110704
1237116,110635
40221913,110592
1134771,109868
19022749,109379
19079524,108600
40162658,108571
19019072,108435
19067686,107096
40169889,106950
19018978,106265
19077344,106001
40185305,105960
964369,105261
40162704,104971
40174888,104622
19079773,104042
1308250,103860
19077684,103563
19022750,103167
704945,103010
40169775,102888
40168654,102839
974200,102494
19113528,102289
721760,102202
1101556,101369
19110450,101234
40171661,101208
19022781,101185
1551101,101015
1551192,100928
19049335,100808
40163510,100697
902429,99981
40171671,99975
19031629,99870
19123989,98870
787787,97811
40162737,97230
1597772,97209
1350552,97123
992612,97009
40163546,96820
978557,96762
1363058,96445
970283,96080
723042,95896
1551170,95863
40162570,95699
19019238,95549
40162711,95523
40174880,95494
19019273,94905
1328689,94897
40162465,94846
40175182,94747
40162511,93925
19018874,93694
19073094,93479
40163534,93453
920458,93449
19074671,93045
1105837,92609
1334459,92494
19077547,92490
40224897,92295
1559685,92263
1501311,91920
1395060,91732
19079497,91518
906891,91262
40176723,91134
1545998,91027
40176744,90630
19019113,90555
40224903,90358
19133614,89729
19019412,89257
961082,88522
40165246,88489
1341268,87816
725178,87453
905275,87125
1597773,87089
40165254,86229
704944,86170
798875,86091
1502812,85760
1347386,85456
1308876,84888
40168664,84877
40224320,84752
40163464,84505
1334494,84488
19079730,84144
40173129,83951
40224352,83909
40175215,83366
1341302,83334
778479,83277
1153702,83089
40167213,83027
19077653,82795
19073183,82748
778299,82464
19073071,82282
40222060,82122
734356,81786
40163760,81652
798876,81590
19074697,81565
19049375,81561
40175401,81517
1113076,80667
40162875,80666
40222779,79998
40242777,79408
1151423,79331
1331241,79190
19077241,79099
40171863,78598
40162683,78525
40173997,78328
46275982,77997
40166831,77894
1525221,77847
1350490,77667
40162864,77589
19075034,77456
40180065,77413
40163350,77359
1154654,77286
1118047,77235
1501496,77050
1308877,77019
40175391,77007
40180087,76670
1545999,76586
40162665,75957
1363060,75555
40224875,75434
40166825,75014
700325,74858
40164930,74689
723020,743

2025-01-16 22:03:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 22:03:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 22:03:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 22:03:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-16 22:03:23 - snowflake.connector.connection - INFO - closed
2025-01-16 22:03:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 22:03:23 - root - INFO - SQL:
SELECT DISTINCT "concept_id", "concept_name", "concept_code"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
    WHERE "concept_class_id" = 'Clinical Drug'
    LIMIT 1000;
Results:
Too long, hard cut:
concept_id,concept_name,concept_code
19072238,Acetaminophen 81 MG / Phenylephrine 1.25 MG Chewable Tablet,307697
19071331,Naproxen 200 MG / Pseudoephedrine 120 MG Extended Release Tablet,284166
40026482,Chondroitin Sulfates 400 MG / Glucosamine Sulfate 500 MG Oral Tablet,200201
40089993,Undecylenic Acid 100 MG/ML Topical Spray,200291
40013601,Aspirin 325 MG / Phenylpropanolamine 20 MG Oral Solution,241972
40053512,Interferon Alfa-2b 3 MMU Injectable Solution,239988
40126750,Methylcellulose 0.3 MG/MG Powder,577363
40043446,Homeopathic Remedies 450 MG Oral Capsule,198698
966464,Allantoin 0.015 MG/MG / pramoxine 0.01 MG/MG Topical Ointment,616948
19086406,conivaptan 0.2 MG/ML Injectable Solution,847289
40237941,Sodium Bicarbonate 15 MG/ML / tartaric acid 13.6 MG/ML Oral Solution,1098595
19125248,Hydrocortisone 10 MG/ML / pramoxine 10 MG/ML Topical Spray,670098
1130301,Acetaminophen 650 MG / Diphenhydramine 50 MG Oral Powder,247297
40231657,potassium bicarbonate 78 MG/ML / Sodium Bicarbonate 780 MG/ML / sodium citrate 16 MG/ML Oral Solution,1042860
40171532,Acetaminophen 325 MG / Chlorpheniramine 2 MG / Dextromethorphan 10 MG / Phenylephrine 5 MG Oral Capsule,901270
19123751,linoleate 50 MG/ML Injectable Solution,618479
40241565,Acetaminophen 325 MG / Caffeine 50 MG / phenyltoloxamine 20 MG / salicylamide 250 MG Oral Capsule,1147784
1121644,Dextromethorphan 2 MG/ML / Guaifenesin 40 MG/ML / Phenylephrine 1 MG/ML Oral Solution,692625
1790882,Chlorhexidine 0.01 MG/MG Topical Ointment,251944
1120266,Dextromethorphan 5 MG/ML / Guaifenesin 50 MG/ML / Phenylephrine 2.5 MG/ML Oral Solution,242617
42873552,"Hyoscyamine 0.12 MG / Methenamine 120 MG / Methylene blue 10.8 MG / phenyl salicylate 36.2 MG / Sodium Phosphate, Monobasic 40.8 MG Oral Tablet",1302479
40134058,Methylphenidate 3.33 MG/HR Transdermal Patch,636258
40072246,Penicillin G 40000 UNT/ML Injectable Solution,312265
19129009,Hydrocodone 0.5 MG/ML / Phenylpropanolamine 2.5 MG/ML Oral Solution,756101
19129013,Hydrocodone 1 MG/ML / Phenylpropanolamine 5 MG/ML Oral Solution,756105
902520,brimonidine 2 MG/ML / Timolol 5 MG/ML Ophthalmic Solution,597144
19003511,Chenodeoxycholic Acid 125 MG / Ursodeoxycholic Acid 125 MG Oral Tablet,104194
19102515,Metformin 1000 MG / rosiglitazone 4 MG Oral Tablet,403916
934178,Guaifenesin 20 MG/ML / Hydrocodone 0.34 MG/ML / Pheniramine 1.26 MG/ML / Phenylpropanolamine 2.5 MG/ML / Pyrilamine 1.26 MG/ML Oral Solution,755778
40126389,Hyaluronic Acid 0.002 MG/MG Topical Gel,584646
40045403,"HEPARIN, PORK 25000 UNT/ML Injectable Solution",244234
19076020,Cyclopentolate 10 MG/ML Ophthalmic Solution,309620
40091964,alemtuzumab 30 MG/ML Injectable Solution,485516
40118710,Nitroglycerin 0.3 MG Oral Tablet,541847
19003739,Amiloride 2.5 MG / Hydrochlorothiazide 25 MG / Timolol 10 MG Oral Tablet,104341
794955,Chlorpromazine 100 MG Enteric Coated Tablet,484479
19058718,Atropine 0.2 MG/ML / Chlorpheniramine 5 MG/ML Injectable Solution,242980
40055122,histamine phosphate 2.75 MG/ML Topical Solution,199077
40045707,HISTAMINE HYDROCHLORIDE 6 MG/ML Injectable Solution,348780
40033801,Dextromethorphan 30 MG / Phenylephrine 15 MG / Potassium guaiacol sulfonate 600 MG 12 hour Extended Release Tablet,359913
989897,Lidocaine 40 MG/ML Mucous Membrane Topical Solution,197875
40151348,Acetic Acid 0.05 MEQ/ML / Alanine 4.48 MG/ML / Arginine 3.43 MG/ML / Glycine 4.48 MG/ML / Histidine 1.05 MG/ML / Isoleucine 2.52 MG/ML / Leucine 3.29 MG/ML / Lysine 2.52 MG/ML / Methionine 1.40 MG/ML / Phenylalanine 1.54 MG/ML / Proline 3 MG/ML / Serine,799968
40131650,linoleate 365 MG / Linolenate 45 MG Oral Capsule,618419
40001682,"ALLERGENIC EXTRACT,POLLEN 20000 UNT Injectable Solution",347175
40045540,Glucose 5000 MG / Potassium Chloride 74.5 MG / Sodium Chloride 225 MG Injectable Solution,346698
19095093,Metoprolol 100 MG Extended Release Tablet,343003
40100164,piperazine 2000 MG Oral Solution,245833
1130329,Diphenhydramine 10 MG/ML / Pyrilamine 10 MG/ML Topical Cream,249913
1196699,formoterol 0.01 MG/ML Inhalant Solution,728211
19105403,Dihydroergotamine 1.5 MG / propyphenazone 375 MG Rectal Suppository,420626
1315345,Flaxseed extract 500 MG / Vitamin E 5 UNT Oral Capsule,241976
40086968,"Tetanus immune globulin, human 250 UNT Injectable Solution",315226
40072221,Penicillin G 30000 UNT/ML Injectable Solution,312262
42903012,Factor VIII 750 UNT/ML Prefilled Syringe,1360125
19127218,2 ML Fluphenazine 25 MG/ML Prefilled Syringe,727839
1318282,Nicardipine 45 MG 12 hour Extended Release Capsule,637198
1165936,Guaifenesin 20 MG/ML / Hydrocodone 0.5 MG/ML / Phenylephrine 1 MG/ML Oral Solution,672575
1738789,Doxycycline 10 MG/ML Oral Solution,755733
757639,Galantamine 8 MG 24 Hour Extended Release Capsule,485793
40004952,Acetylcarnitine 250 MG Oral Capsule,476314
40006886,Albuterol 0.83 MG/ML Inhalant Solution,307780
40065899,Mold Extract 10 MU/ML Injectable Solution,239303
40026655,Cortisone 25 MG/ML Injectable Solution,309543
40005410,Acetaminophen 500 MG Oral Tablet,485168


2025-01-16 22:03:23 - root - INFO - itercount: 0
2025-01-16 22:03:23 - root - INFO - Database Name: CMS_DATA
Schema Name: CMS_CODES
DDL describes table information.
,0
table_name,HCPCS
description,
DDL,"create or replace TABLE HCPCS (
	HCPC VARCHAR(16777216),
	SEQNUM VARCHAR(16777216),
	RECID NUMBER(38,0),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216),
	PRICE1 VARCHAR(16777216),
	PRICE2 VARCHAR(16777216),
	PRICE3 VARCHAR(16777216),
	PRICE4 VARCHAR(16777216),
	MULT_PI VARCHAR(16777216),
	CIM1 VARCHAR(16777216),
	CIM2 VARCHAR(16777216),
	CIM3 VARCHAR(16777216),
	MCM1 FLOAT,
	MCM2 NUMBER(38,0),
	MCM3 VARCHAR(16777216),
	STATUTE VARCHAR(16777216),
	LABCERT1 VARCHAR(16777216),
	LABCERT2 VARCHAR(16777216),
	LABCERT3 VARCHAR(16777216),
	LABCERT4 VARCHAR(16777216),
	LABCERT5 VARCHAR(16777216),
	LABCERT6 VARCHAR(16777216),
	LABCERT7 VARCHAR(16777216),
	LABCERT8 VARCHAR(16777216),
	XREF1 VARCHAR(16777216),
	XREF2 VARCHAR(16777216),
	XREF3 VARCHAR(16777216),
	XREF4 VARCHAR(16777216),
	XREF5 VARCHAR(16777216),
	COV VARCHAR(16777216),
	ASC_GRP VARCHAR(16777216),
	ASC_DT VARCHAR(16777216),
	OPPS VARCHAR(16777216),
	OPPS_PI VARCHAR(16777216),
	OPPS_DT VARCHAR(16777216),
	PROCNOTE VARCHAR(16777216),
	BETOS VARCHAR(16777216),
	TOS1 VARCHAR(16777216),
	TOS2 VARCHAR(16777216),
	TOS3 VARCHAR(16777216),
	TOS4 VARCHAR(16777216),
	TOS5 VARCHAR(16777216),
	ANEST_BU VARCHAR(16777216),
	ADD_DT VARCHAR(16777216),
	ACT_EFF_DT VARCHAR(16777216),
	TERM_DT VARCHAR(16777216),
	ACTION_CD BOOLEAN
);"

,1
table_name,ICD10_PROCEDURES_2019
description,
DDL,"create or replace TABLE ICD10_PROCEDURES_2019 (
	""order_number"" VARCHAR(16777216),
	""pcs_code"" VARCHAR(16777216),
	""is_header_code"" BOOLEAN,
	""short_description"" VARCHAR(16777216),
	""long_description"" VARCHAR(16777216)
);"

,2
table_name,ICD9_DIAGNOSES
description,
DDL,"create or replace TABLE ICD9_DIAGNOSES (
	DIAGNOSIS_CODE VARCHAR(16777216),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216)
);"

,3
table_name,ICD10_DIAGNOSES_2019
description,
DDL,"create or replace TABLE ICD10_DIAGNOSES_2019 (
	""order_number"" VARCHAR(16777216),
	""cm_code"" VARCHAR(16777216),
	""is_header_code"" BOOLEAN,
	""short_description"" VARCHAR(16777216),
	""long_description"" VARCHAR(16777216)
);"

,4
table_name,ICD9_PROCEDURES
description,
DDL,"create or replace TABLE ICD9_PROCEDURES (
	PROCEDURE_CODE VARCHAR(16777216),
	LONG_DESCRIPTION VARCHAR(16777216),
	SHORT_DESCRIPTION VARCHAR(16777216)
);"

Database Name: CMS_DATA
Schema Name: CMS_MEDICARE
DDL describes table information.
,0
table_name,HOME_HEALTH_AGENCIES_2013
description,
DDL,"create or replace TABLE HOME_HEALTH_AGENCIES_2013 (
	""provider_id"" VARCHAR(16777216),
	""agency_name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""total_episodes_non_lupa"" NUMBER(38,0),
	""distinct_users_non_lupa"" NUMBER(38,0),
	""total_hha_charge_amount_non_lupa"" NUMBER(38,0),
	""total_hha_medicare_payment_amount_non_lupa"" NUMBER(38,0),
	""total_hha_medicare_standard_payment_amount_non_lupa"" NUMBER(38,0),
	""outlier_payments_as_a_percent_of_medicare_payment_amount_non_lupa"" NUMBER(38,0),
	""total_lupa_episodes"" NUMBER(38,0),
	""total_hha_medicare_payment_amount_for_lupas"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014']
,1
table_name,HOSPICE_PROVIDERS_2014
description,
DDL,"create or replace TABLE HOSPICE_PROVIDERS_2014 (
	""provider_id"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""hrr"" VARCHAR(16777216),
	""hospice_beneficiaries"" NUMBER(38,0),
	""total_days"" NUMBER(38,0),
	""total_medicare_payment_amount"" NUMBER(38,0),
	""total_medicare_standard_payment_amount"" NUMBER(38,0),
	""total_charge_amount"" NUMBER(38,0),
	""percent_routine_home_care_days"" NUMBER(38,0),
	""physician_services"" NUMBER(38,0),
	""home_health_visit_hours_per_day"" FLOAT,
	""skilled_nursing_visit_hours_per_day"" FLOAT,
	""social_service_visit_hours_per_day"" FLOAT,
	""total_live_discharges"" NUMBER(38,0),
	""hospice_beneficiaries_with_seven_or_fewer_hospice_care_days"" NUMBER(38,0),
	""hospice_beneficiaries_with_more_than_sixty_hospice_care_days"" NUMBER(38,0),
	""hospice_beneficiaries_with_more_than_one_hundred_eighty_hospice_care_days"" NUMBER(38,0),
	""home_health_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""skilled_nursing_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""social_service_visit_hours_per_day_during_week_prior_to_death"" FLOAT,
	""average_age"" FLOAT,
	""male_hospice_beneficiaries"" NUMBER(38,0),
	""female_hospice_beneficiaries"" NUMBER(38,0),
	""white_hospice_beneficiaries"" NUMBER(38,0),
	""black_hospice_beneficiaries"" NUMBER(38,0),
	""asian_hospice_beneficiaries"" NUMBER(38,0),
	""hispanic_hospice_beneficiaries"" NUMBER(38,0),
	""other_unknown_race_hospice_beneficiaries"" NUMBER(38,0),
	""medicare_advantage_hospice_beneficiaries"" NUMBER(38,0),
	""medicaid_eligible_hospice_beneficiaries"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_cancer"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_dementia"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_stroke"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_circulatory_heart_disease"" NUMBER(38,0),
	""hospice_beneficiaries_with_a_primary_diagnosis_of_respiratory_disease"" NUMBER(38,0),
	""hospice_beneficiaries_with_other_primary_diagnoses"" NUMBER(38,0),
	""site_of_service_home_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_assisted_living_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_long_term_care_or_non_skilled_nursing_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_skilled_nursing_facility_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_inpatient_hospital_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_inpatient_hospice_hospice_beneficiaries"" NUMBER(38,0),
	""site_of_service_other_facility_hospice_beneficiaries"" NUMBER(38,0)
);"

,2
table_name,HOSPITAL_GENERAL_INFO
description,
DDL,"create or replace TABLE HOSPITAL_GENERAL_INFO (
	""provider_id"" VARCHAR(16777216),
	""hospital_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" VARCHAR(16777216),
	""county_name"" VARCHAR(16777216),
	""phone_number"" VARCHAR(16777216),
	""hospital_type"" VARCHAR(16777216),
	""hospital_ownership"" VARCHAR(16777216),
	""emergency_services"" BOOLEAN,
	""meets_criteria_for_promoting_interoperability_of_ehrs"" BOOLEAN,
	""hospital_overall_rating"" VARCHAR(16777216),
	""hospital_overall_rating_footnote"" VARCHAR(16777216),
	""mortality_group_measure_count"" VARCHAR(16777216),
	""facility_mortaility_measures_count"" VARCHAR(16777216),
	""mortality_measures_better_count"" VARCHAR(16777216),
	""mortality_measures_no_different_count"" VARCHAR(16777216),
	""mortality_measures_worse_count"" VARCHAR(16777216),
	""mortaility_group_footnote"" VARCHAR(16777216),
	""safety_measures_count"" VARCHAR(16777216),
	""facility_care_safety_measures_count"" VARCHAR(16777216),
	""safety_measures_better_count"" VARCHAR(16777216),
	""safety_measures_no_different_count"" VARCHAR(16777216),
	""safety_measures_worse_count"" VARCHAR(16777216),
	""safety_group_footnote"" VARCHAR(16777216),
	""readmission_measures_count"" VARCHAR(16777216),
	""facility_readmission_measures_count"" VARCHAR(16777216),
	""readmission_measures_better_count"" VARCHAR(16777216),
	""readmission_measures_no_different_count"" VARCHAR(16777216),
	""readmission_measures_worse_count"" VARCHAR(16777216),
	""readmission_measures_footnote"" VARCHAR(16777216),
	""patient_experience_measures_count"" VARCHAR(16777216),
	""facility_patient_experience_measures_count"" VARCHAR(16777216),
	""patient_experience_measures_footnote"" VARCHAR(16777216),
	""timely_and_effective_care_measures_count"" VARCHAR(16777216),
	""facility_timely_and_effective_care_measures_count"" VARCHAR(16777216),
	""timely_and_effective_care_measures_footnote"" VARCHAR(16777216)
);"

,3
table_name,INPATIENT_CHARGES_2011
description,
DDL,"create or replace TABLE INPATIENT_CHARGES_2011 (
	""provider_id"" VARCHAR(16777216),
	""provider_name"" VARCHAR(16777216),
	""provider_street_address"" VARCHAR(16777216),
	""provider_city"" VARCHAR(16777216),
	""provider_state"" VARCHAR(16777216),
	""provider_zipcode"" VARCHAR(16777216),
	""drg_definition"" VARCHAR(16777216),
	""hospital_referral_region_description"" VARCHAR(16777216),
	""total_discharges"" NUMBER(38,0),
	""average_covered_charges"" FLOAT,
	""average_total_payments"" FLOAT,
	""average_medicare_payments"" FLOAT
);"

Some other tables have the similar structure: ['INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2015']
,4
table_name,NURSING_FACILITIES_2014
description,
DDL,"create or replace TABLE NURSING_FACILITIES_2014 (
	""provider_id"" VARCHAR(16777216),
	""facility_name"" VARCHAR(16777216),
	""street_address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip_code"" NUMBER(38,0),
	""total_stays"" NUMBER(38,0),
	""distinct_beneficiaries_per_provider"" NUMBER(38,0),
	""average_length_of_stays_days"" FLOAT,
	""total_snf_charge_amount"" NUMBER(38,0),
	""total_snf_medicare_allowed_amount"" NUMBER(38,0),
	""total_snf_medicare_payment_amount"" NUMBER(38,0),
	""total_snf_medicare_standard_payment_amount"" NUMBER(38,0),
	""average_age"" NUMBER(38,0),
	""male_beneficiaries"" NUMBER(38,0),
	""female_beneficiaries"" NUMBER(38,0),
	""nondual_beneficiaries"" NUMBER(38,0),
	""dual_beneficiaries"" NUMBER(38,0),
	""white_beneficiaries"" NUMBER(38,0),
	""black_beneficiaries"" NUMBER(38,0),
	""asian_pacific_islander_beneficiaries"" NUMBER(38,0),
	""hispanic_beneficiaries"" NUMBER(38,0),
	""american_indian_or_alaska_native_beneficiaries"" NUMBER(38,0),
	""other_unknown_beneficiaries"" NUMBER(38,0),
	""average_hcc_score"" FLOAT,
	""percent_of_beneficiaries_with_atrial_fibrillation"" NUMBER(38,0),
	""percent_of_beneficiaries_with_alzheimers"" NUMBER(38,0),
	""percent_of_beneficiaries_with_asthma"" NUMBER(38,0),
	""percent_of_beneficiaries_with_cancer"" NUMBER(38,0),
	""percent_of_beneficiaries_with_chf"" NUMBER(38,0),
	""percent_of_beneficiaries_with_chronic_kidney_disease"" NUMBER(38,0),
	""percent_of_beneficiaries_with_copd"" NUMBER(38,0),
	""percent_of_beneficiaries_with_depression"" NUMBER(38,0),
	""percent_of_beneficiaries_with_diabetes"" NUMBER(38,0),
	""percent_of_beneficiaries_with_hyperlipidemia"" NUMBER(38,0),
	""percent_of_beneficiaries_with_hypertension"" NUMBER(38,0),
	""percent_of_beneficiaries_with_ihd"" NUMBER(38,0),
	""percent_of_beneficiaries_with_osteoporosis"" NUMBER(38,0),
	""percent_of_beneficiaries_with_ra_oa"" NUMBER(38,0),
	""percent_of_beneficiaries_with_schizophrenia"" NUMBER(38,0),
	""percent_of_beneficiaries_with_stroke"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['NURSING_FACILITIES_2014', 'NURSING_FACILITIES_2013']
,5
table_name,OUTPATIENT_CHARGES_2012
description,
DDL,"create or replace TABLE OUTPATIENT_CHARGES_2012 (
	""provider_id"" VARCHAR(16777216),
	""provider_name"" VARCHAR(16777216),
	""provider_street_address"" VARCHAR(16777216),
	""provider_city"" VARCHAR(16777216),
	""provider_state"" VARCHAR(16777216),
	""provider_zipcode"" VARCHAR(16777216),
	""apc"" VARCHAR(16777216),
	""hospital_referral_region"" VARCHAR(16777216),
	""outpatient_services"" NUMBER(38,0),
	""average_estimated_submitted_charges"" FLOAT,
	""average_total_payments"" FLOAT
);"

Some other tables have the similar structure: ['OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2015']
,6
table_name,PART_D_PRESCRIBER_2014
description,
DDL,"create or replace TABLE PART_D_PRESCRIBER_2014 (
	""npi"" VARCHAR(16777216),
	""nppes_provider_last_org_name"" VARCHAR(16777216),
	""nppes_provider_first_name"" VARCHAR(16777216),
	""nppes_provider_city"" VARCHAR(16777216),
	""nppes_provider_state"" VARCHAR(16777216),
	""specialty_description"" VARCHAR(16777216),
	""description_flag"" VARCHAR(16777216),
	""drug_name"" VARCHAR(16777216),
	""generic_name"" VARCHAR(16777216),
	""bene_count"" NUMBER(38,0),
	""total_claim_count"" NUMBER(38,0),
	""total_day_supply"" NUMBER(38,0),
	""total_drug_cost"" FLOAT,
	""bene_count_ge65"" NUMBER(38,0),
	""bene_count_ge65_suppress_flag"" VARCHAR(16777216),
	""total_claim_count_ge65"" NUMBER(38,0),
	""ge65_suppress_flag"" VARCHAR(16777216),
	""total_day_supply_ge65"" NUMBER(38,0),
	""total_drug_cost_ge65"" FLOAT,
	""total_30_day_fill_count"" FLOAT,
	""total_30_day_fill_count_ge65"" FLOAT
);"

,7
table_name,REFERRING_DURABLE_MEDICAL_EQUIP_2013
description,
DDL,"create or replace TABLE REFERRING_DURABLE_MEDICAL_EQUIP_2013 (
	""referring_npi"" VARCHAR(16777216),
	""referring_provider_last_name_organization_name"" VARCHAR(16777216),
	""referring_provider_first_name"" VARCHAR(16777216),
	""referring_provider_middle_initial"" VARCHAR(16777216),
	""referring_provider_credentials"" VARCHAR(16777216),
	""referring_provider_gender"" VARCHAR(16777216),
	""referring_provider_entity_code"" VARCHAR(16777216),
	""referring_provider_street_1"" VARCHAR(16777216),
	""referring_provider_street_2"" VARCHAR(16777216),
	""referring_provider_city"" VARCHAR(16777216),
	""referring_provider_state"" VARCHAR(16777216),
	""referring_provider_zip"" VARCHAR(16777216),
	""referring_provider_country"" VARCHAR(16777216),
	""referring_provider_type"" VARCHAR(16777216),
	""referring_provider_type_flag"" VARCHAR(16777216),
	""number_of_suppliers"" NUMBER(38,0),
	""number_of_supplier_hcpcs"" NUMBER(38,0),
	""number_of_supplier_beneficiaries"" NUMBER(38,0),
	""number_of_supplier_claims"" NUMBER(38,0),
	""number_of_supplier_services"" NUMBER(38,0),
	""supplier_submitted_charges"" FLOAT,
	""supplier_medicare_allowed_amount"" FLOAT,
	""supplier_medicare_payment_amount"" FLOAT,
	""durable_medical_equipment_suppression_indicator"" VARCHAR(16777216),
	""number_of_durable_medical_equipment_suppliers"" NUMBER(38,0),
	""number_of_durable_medical_equipment_hcpcs"" NUMBER(38,0),
	""number_of_durable_medical_equipment_beneficiaries"" NUMBER(38,0),
	""number_of_durable_medical_equipment_claims"" NUMBER(38,0),
	""number_of_durable_medical_equipment_services"" NUMBER(38,0),
	""durable_medical_equipment_submitted_charges"" FLOAT,
	""durable_medical_equipment_medicare_allowed_amount"" FLOAT,
	""durable_medical_equipment_medicare_payment_amount"" FLOAT,
	""prosthetic_and_orthotic_suppression_indicator"" VARCHAR(16777216),
	""number_of_prosthetic_and_orthotic_suppliers"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_hcpcs"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_beneficiaries"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_claims"" NUMBER(38,0),
	""number_of_prosthetic_and_orthotic_services"" NUMBER(38,0),
	""prosthetic_and_orthotic_submitted_charges"" FLOAT,
	""prosthetic_and_orthotic_medicare_allowed_amount"" FLOAT,
	""prosthetic_and_orthotic_medicare_payment_amount"" FLOAT,
	""drug_and_nutritional_suppression_indicator"" VARCHAR(16777216),
	""number_of_drug_and_nutritional_products_suppliers"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_hcpcs"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_beneficiaries"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_claims"" NUMBER(38,0),
	""number_of_drug_and_nutritional_products_services"" NUMBER(38,0),
	""drug_and_nutritional_products_submitted_charges"" FLOAT,
	""drug_and_nutritional_products_medicare_allowed_amount"" FLOAT,
	""drug_and_nutritional_products_medicare_payment_amount"" FLOAT
);"

Some other tables have the similar structure: ['REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014']
,8
table_name,PHYSICIANS_AND_OTHER_SUPPLIER_2015
description,
DDL,"create or replace TABLE PHYSICIANS_AND_OTHER_SUPPLIER_2015 (
	""npi"" VARCHAR(16777216),
	""nppes_provider_last_org_name"" VARCHAR(16777216),
	""nppes_provider_first_name"" VARCHAR(16777216),
	""nppes_provider_mi"" VARCHAR(16777216),
	""nppes_credentials"" VARCHAR(16777216),
	""nppes_provider_gender"" VARCHAR(16777216),
	""nppes_entity_code"" VARCHAR(16777216),
	""nppes_provider_street1"" VARCHAR(16777216),
	""nppes_provider_street2"" VARCHAR(16777216),
	""nppes_provider_city"" VARCHAR(16777216),
	""nppes_provider_zip"" VARCHAR(16777216),
	""nppes_provider_state"" VARCHAR(16777216),
	""nppes_provider_country"" VARCHAR(16777216),
	""provider_type"" VARCHAR(16777216),
	""medicare_participation_indicator"" VARCHAR(16777216),
	""place_of_service"" VARCHAR(16777216),
	""hcpcs_code"" VARCHAR(16777216),
	""hcpcs_description"" VARCHAR(16777216),
	""hcpcs_drug_indicator"" VARCHAR(16777216),
	""line_srvc_cnt"" FLOAT,
	""bene_unique_cnt"" NUMBER(38,0),
	""bene_day_srvc_cnt"" NUMBER(38,0),
	""average_medicare_allowed_amt"" FLOAT,
	""average_submitted_chrg_amt"" FLOAT,
	""average_medicare_payment_amt"" FLOAT,
	""average_medicare_standard_amt"" FLOAT
);"

Some other tables have the similar structure: ['PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014']
Database Name: CMS_DATA
Schema Name: CMS_SYNTHETIC_PATIENT_DATA_OMOP
DDL describes table information.
,0
table_name,CONDITION_OCCURRENCE
description,
DDL,"create or replace TABLE CONDITION_OCCURRENCE (
	""condition_occurrence_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""condition_concept_id"" NUMBER(38,0),
	""condition_start_date"" DATE,
	""condition_start_datetime"" NUMBER(38,0),
	""condition_end_date"" DATE,
	""condition_end_datetime"" NUMBER(38,0),
	""condition_type_concept_id"" NUMBER(38,0),
	""stop_reason"" VARCHAR(16777216),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""condition_source_value"" VARCHAR(16777216),
	""condition_source_concept_id"" NUMBER(38,0),
	""condition_status_source_value"" VARCHAR(16777216),
	""condition_status_concept_id"" NUMBER(38,0)
);"

,1
table_name,DRUG_ERA
description,
DDL,"create or replace TABLE DRUG_ERA (
	""drug_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""drug_era_start_date"" DATE,
	""drug_era_end_date"" DATE,
	""drug_exposure_count"" NUMBER(38,0),
	""gap_days"" NUMBER(38,0)
);"

,2
table_name,LOCATION
description,
DDL,"create or replace TABLE LOCATION (
	""location_id"" NUMBER(38,0),
	""address_1"" VARCHAR(16777216),
	""address_2"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""location_source_value"" VARCHAR(16777216)
);"

,3
table_name,PERSON
description,
DDL,"create or replace TABLE PERSON (
	""race_concept_id"" NUMBER(38,0),
	""ethnicity_concept_id"" NUMBER(38,0),
	""location_id"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""care_site_id"" NUMBER(38,0),
	""person_source_value"" VARCHAR(16777216),
	""gender_source_value"" VARCHAR(16777216),
	""gender_source_concept_id"" NUMBER(38,0),
	""race_source_value"" VARCHAR(16777216),
	""race_source_concept_id"" NUMBER(38,0),
	""ethnicity_source_value"" VARCHAR(16777216),
	""ethnicity_source_concept_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""gender_concept_id"" NUMBER(38,0),
	""year_of_birth"" NUMBER(38,0),
	""month_of_birth"" NUMBER(38,0),
	""day_of_birth"" NUMBER(38,0),
	""birth_datetime"" NUMBER(38,0)
);"

,4
table_name,CONDITION_ERA
description,
DDL,"create or replace TABLE CONDITION_ERA (
	""condition_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""condition_concept_id"" NUMBER(38,0),
	""condition_era_start_date"" DATE,
	""condition_era_end_date"" DATE,
	""condition_occurrence_count"" NUMBER(38,0)
);"

,5
table_name,DEVICE_EXPOSURE
description,
DDL,"create or replace TABLE DEVICE_EXPOSURE (
	""device_exposure_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""device_concept_id"" NUMBER(38,0),
	""device_exposure_start_date"" DATE,
	""device_exposure_start_datetime"" NUMBER(38,0),
	""device_exposure_end_date"" DATE,
	""device_exposure_end_datetime"" NUMBER(38,0),
	""device_type_concept_id"" NUMBER(38,0),
	""unique_device_id"" VARCHAR(16777216),
	""quantity"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""device_source_value"" VARCHAR(16777216),
	""device_source_concept_id"" NUMBER(38,0)
);"

,6
table_name,DOMAIN
description,
DDL,"create or replace TABLE DOMAIN (
	""domain_id"" VARCHAR(16777216),
	""domain_name"" VARCHAR(16777216),
	""domain_concept_id"" NUMBER(38,0)
);"

,7
table_name,DOSE_ERA
description,
DDL,"create or replace TABLE DOSE_ERA (
	""dose_era_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""unit_concept_id"" NUMBER(38,0),
	""dose_value"" FLOAT,
	""dose_era_start_date"" DATE,
	""dose_era_end_date"" DATE
);"

,8
table_name,OBSERVATION
description,
DDL,"create or replace TABLE OBSERVATION (
	""observation_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""observation_concept_id"" NUMBER(38,0),
	""observation_date"" DATE,
	""observation_datetime"" NUMBER(38,0),
	""observation_type_concept_id"" NUMBER(38,0),
	""value_as_number"" FLOAT,
	""value_as_string"" VARCHAR(16777216),
	""value_as_concept_id"" NUMBER(38,0),
	""qualifier_concept_id"" NUMBER(38,0),
	""unit_concept_id"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""observation_source_value"" VARCHAR(16777216),
	""observation_source_concept_id"" NUMBER(38,0),
	""unit_source_value"" VARCHAR(16777216),
	""qualifier_source_value"" VARCHAR(16777216)
);"

,9
table_name,COST
description,
DDL,"create or replace TABLE COST (
	""cost_id"" NUMBER(38,0),
	""cost_event_id"" NUMBER(38,0),
	""cost_domain_id"" VARCHAR(16777216),
	""cost_type_concept_id"" NUMBER(38,0),
	""currency_concept_id"" NUMBER(38,0),
	""total_charge"" FLOAT,
	""total_cost"" FLOAT,
	""total_paid"" FLOAT,
	""paid_by_payer"" FLOAT,
	""paid_by_patient"" FLOAT,
	""paid_patient_copay"" FLOAT,
	""paid_patient_coinsurance"" FLOAT,
	""paid_patient_deductible"" FLOAT,
	""paid_by_primary"" FLOAT,
	""paid_ingredient_cost"" FLOAT,
	""paid_dispensing_fee"" FLOAT,
	""payer_plan_period_id"" NUMBER(38,0),
	""amount_allowed"" FLOAT,
	""revenue_code_concept_id"" NUMBER(38,0),
	""revenue_code_source_value"" VARCHAR(16777216),
	""drg_concept_id"" NUMBER(38,0),
	""drg_source_value"" VARCHAR(16777216)
);"

,10
table_name,PROVIDER
description,
DDL,"create or replace TABLE PROVIDER (
	""provider_id"" NUMBER(38,0),
	""provider_name"" VARCHAR(16777216),
	""npi"" VARCHAR(16777216),
	""dea"" VARCHAR(16777216),
	""specialty_concept_id"" NUMBER(38,0),
	""care_site_id"" NUMBER(38,0),
	""year_of_birth"" NUMBER(38,0),
	""gender_concept_id"" NUMBER(38,0),
	""provider_source_value"" VARCHAR(16777216),
	""specialty_source_value"" VARCHAR(16777216),
	""specialty_source_concept_id"" NUMBER(38,0),
	""gender_source_value"" VARCHAR(16777216),
	""gender_source_concept_id"" NUMBER(38,0)
);"

,11
table_name,CARE_SITE
description,
DDL,"create or replace TABLE CARE_SITE (
	""care_site_id"" NUMBER(38,0),
	""care_site_name"" VARCHAR(16777216),
	""place_of_service_concept_id"" NUMBER(38,0),
	""location_id"" NUMBER(38,0),
	""care_site_source_value"" VARCHAR(16777216),
	""place_of_service_source_value"" VARCHAR(16777216)
);"

,12
table_name,CONCEPT_ANCESTOR
description,
DDL,"create or replace TABLE CONCEPT_ANCESTOR (
	""ancestor_concept_id"" NUMBER(38,0),
	""descendant_concept_id"" NUMBER(38,0),
	""min_levels_of_separation"" NUMBER(38,0),
	""max_levels_of_separation"" NUMBER(38,0)
);"

,13
table_name,CONCEPT_RELATIONSHIP
description,
DDL,"create or replace TABLE CONCEPT_RELATIONSHIP (
	""concept_id_1"" NUMBER(38,0),
	""concept_id_2"" NUMBER(38,0),
	""relationship_id"" VARCHAR(16777216),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

,14
table_name,DEATH
description,
DDL,"create or replace TABLE DEATH (
	""person_id"" NUMBER(38,0),
	""death_date"" DATE,
	""death_datetime"" NUMBER(38,0),
	""death_type_concept_id"" NUMBER(38,0),
	""cause_concept_id"" NUMBER(38,0),
	""cause_source_value"" VARCHAR(16777216),
	""cause_source_concept_id"" NUMBER(38,0)
);"

,15
table_name,DRUG_STRENGTH
description,
DDL,"create or replace TABLE DRUG_STRENGTH (
	""drug_concept_id"" NUMBER(38,0),
	""ingredient_concept_id"" NUMBER(38,0),
	""amount_value"" FLOAT,
	""amount_unit_concept_id"" NUMBER(38,0),
	""numerator_value"" FLOAT,
	""numerator_unit_concept_id"" NUMBER(38,0),
	""denominator_value"" FLOAT,
	""denominator_unit_concept_id"" NUMBER(38,0),
	""box_size"" NUMBER(38,0),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

,16
table_name,CONCEPT
description,
DDL,"create or replace TABLE CONCEPT (
	""concept_id"" NUMBER(38,0),
	""concept_name"" VARCHAR(16777216),
	""domain_id"" VARCHAR(16777216),
	""vocabulary_id"" VARCHAR(16777216),
	""concept_class_id"" VARCHAR(16777216),
	""standard_concept"" VARCHAR(16777216),
	""concept_code"" VARCHAR(16777216),
	""valid_start_date"" DATE,
	""valid_end_date"" DATE,
	""invalid_reason"" VARCHAR(16777216)
);"

,17
table_name,CONCEPT_CLASS
description,
DDL,"create or replace TABLE CONCEPT_CLASS (
	""concept_class_id"" VARCHAR(16777216),
	""concept_class_name"" VARCHAR(16777216),
	""concept_class_concept_id"" NUMBER(38,0)
);"

,18
table_name,DRUG_EXPOSURE
description,
DDL,"create or replace TABLE DRUG_EXPOSURE (
	""drug_type_concept_id"" NUMBER(38,0),
	""stop_reason"" VARCHAR(16777216),
	""refills"" NUMBER(38,0),
	""quantity"" FLOAT,
	""days_supply"" NUMBER(38,0),
	""sig"" VARCHAR(16777216),
	""route_concept_id"" NUMBER(38,0),
	""lot_number"" VARCHAR(16777216),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""drug_source_value"" VARCHAR(16777216),
	""drug_source_concept_id"" NUMBER(38,0),
	""route_source_value"" VARCHAR(16777216),
	""dose_unit_source_value"" VARCHAR(16777216),
	""drug_exposure_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""drug_concept_id"" NUMBER(38,0),
	""drug_exposure_start_date"" DATE,
	""drug_exposure_start_datetime"" NUMBER(38,0),
	""drug_exposure_end_date"" DATE,
	""drug_exposure_end_datetime"" NUMBER(38,0),
	""verbatim_end_date"" DATE
);"

,19
table_name,OBSERVATION_PERIOD
description,
DDL,"create or replace TABLE OBSERVATION_PERIOD (
	""observation_period_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""observation_period_start_date"" DATE,
	""observation_period_end_date"" DATE,
	""period_type_concept_id"" NUMBER(38,0)
);"

,20
table_name,PAYER_PLAN_PERIOD
description,
DDL,"create or replace TABLE PAYER_PLAN_PERIOD (
	""payer_concept_id"" NUMBER(38,0),
	""payer_source_value"" VARCHAR(16777216),
	""payer_source_concept_id"" NUMBER(38,0),
	""plan_concept_id"" NUMBER(38,0),
	""plan_source_value"" VARCHAR(16777216),
	""plan_source_concept_id"" NUMBER(38,0),
	""sponsor_concept_id"" NUMBER(38,0),
	""sponsor_source_value"" VARCHAR(16777216),
	""sponsor_source_concept_id"" NUMBER(38,0),
	""family_source_value"" VARCHAR(16777216),
	""stop_reason_concept_id"" NUMBER(38,0),
	""stop_reason_source_value"" VARCHAR(16777216),
	""stop_reason_source_concept_id"" NUMBER(38,0),
	""payer_plan_period_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""payer_plan_period_start_date"" DATE,
	""payer_plan_period_end_date"" DATE
);"

,21
table_name,RELATIONSHIP
description,
DDL,"create or replace TABLE RELATIONSHIP (
	""relationship_id"" VARCHAR(16777216),
	""relationship_name"" VARCHAR(16777216),
	""is_hierarchical"" VARCHAR(16777216),
	""defines_ancestry"" VARCHAR(16777216),
	""reverse_relationship_id"" VARCHAR(16777216),
	""relationship_concept_id"" NUMBER(38,0)
);"

,22
table_name,VOCABULARY
description,
DDL,"create or replace TABLE VOCABULARY (
	""vocabulary_id"" VARCHAR(16777216),
	""vocabulary_name"" VARCHAR(16777216),
	""vocabulary_reference"" VARCHAR(16777216),
	""vocabulary_version"" VARCHAR(16777216),
	""vocabulary_concept_id"" NUMBER(38,0)
);"

,23
table_name,PROCEDURE_OCCURRENCE
description,
DDL,"create or replace TABLE PROCEDURE_OCCURRENCE (
	""procedure_type_concept_id"" NUMBER(38,0),
	""modifier_concept_id"" NUMBER(38,0),
	""quantity"" NUMBER(38,0),
	""provider_id"" NUMBER(38,0),
	""visit_occurrence_id"" NUMBER(38,0),
	""visit_detail_id"" NUMBER(38,0),
	""procedure_source_value"" VARCHAR(16777216),
	""procedure_source_concept_id"" NUMBER(38,0),
	""modifier_source_value"" VARCHAR(16777216),
	""procedure_occurrence_id"" NUMBER(38,0),
	""person_id"" NUMBER(38,0),
	""procedure_concept_id"" NUMBER(38,0),
	""procedure_dat"" DATE,
	""procedure_datetime"" NUMBER(38,0)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'CMS_DATA': {'CMS_CODES': ['HCPCS', 'ICD10_DIAGNOSES_2019', 'ICD10_PROCEDURES_2019', 'ICD9_DIAGNOSES', 'ICD9_PROCEDURES'], 'CMS_MEDICARE': ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014', 'HOSPICE_PROVIDERS_2014', 'HOSPITAL_GENERAL_INFO', 'INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2015', 'NURSING_FACILITIES_2013', 'NURSING_FACILITIES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2015', 'PART_D_PRESCRIBER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014'], 'CMS_SYNTHETIC_PATIENT_DATA_OMOP': ['CARE_SITE', 'CONCEPT', 'CONCEPT_ANCESTOR', 'CONCEPT_CLASS', 'CONCEPT_RELATIONSHIP', 'CONDITION_ERA', 'CONDITION_OCCURRENCE', 'COST', 'DEATH', 'DEVICE_EXPOSURE', 'DOMAIN', 'DOSE_ERA', 'DRUG_ERA', 'DRUG_EXPOSURE', 'DRUG_STRENGTH', 'LOCATION', 'OBSERVATION', 'OBSERVATION_PERIOD', 'PAYER_PLAN_PERIOD', 'PERSON', 'PROCEDURE_OCCURRENCE', 'PROVIDER', 'RELATIONSHIP', 'VOCABULARY']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **Table:** `CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.PERSON`
   - **"person_id"**: Identifies each participant.

2. **Table:** `CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.DRUG_EXPOSURE`
   - **"person_id"**: Links drug exposures to participants.
   - **"drug_concept_id"**: Identifies the drug taken by the participant.
   - **"drug_source_value"**: Source code of the drug from the original data.

3. **Table:** `CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONCEPT`
   - **"concept_id"**: Unique identifier for each concept (e.g., drugs).
   - **"concept_name"**: Name of the concept (drug name).
   - **"concept_code"**: Code associated with the concept, such as RxCUI code.
   - **"vocabulary_id"**: Specifies the vocabulary (e.g., 'RxNorm').

4. **Table:** `CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONCEPT_ANCESTOR`
   - **"ancestor_concept_id"**: Higher-level concept in the hierarchy.
   - **"descendant_concept_id"**: Lower-level concept related to the ancestor.
   - Used to find all related medications to quinapril.

5. **Table:** `CMS_DATA.CMS_SYNTHETIC_PATIENT_DATA_OMOP.CONCEPT_RELATIONSHIP`
   - **"concept_id_1"** and **"concept_id_2"**: For mapping relationships between concepts.
   - **"relationship_id"**: Type of relationship (e.g., 'Maps to').

**Conditions that may be used:**

- Filter concepts where `"concept_code"` equals `'35208'` to find the concept ID for quinapril.
- Use `"concept_ancestor"` table to find all descendant (related) medications to quinapril.
- Identify participants (`"person_id"`) who have taken quinapril or related medications.
- Calculate the percentage of participants not using these medications.

---

**SQL Queries:**

1. **List all participant IDs from the PERSON table:**

   ```sql
   SELECT DISTINCT "person_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON"
   LIMIT 1000;
   ```

2. **Find the concept ID for quinapril using the RxCUI code '35208':**

   ```sql
   SELECT DISTINCT "concept_id", "concept_name", "vocabulary_id", "concept_code"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
   WHERE "concept_code" = '35208'
   LIMIT 1000;
   ```

3. **List all concepts where the concept name contains 'quinapril':**

   ```sql
   SELECT DISTINCT "concept_id", "concept_name", "concept_code", "vocabulary_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
   WHERE LOWER("concept_name") LIKE '%quinapril%'
   LIMIT 1000;
   ```

4. **Retrieve all descendant concept IDs related to quinapril from the CONCEPT_ANCESTOR table:**

   (Assuming quinapril's concept_id is known from previous queries)

   ```sql
   SELECT DISTINCT "descendant_concept_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT_ANCESTOR"
   WHERE "ancestor_concept_id" = /* quinapril_concept_id */
   LIMIT 1000;
   ```

5. **List all drug exposure records for quinapril or related medications:**

   (Assuming we have a list of related concept IDs)

   ```sql
   SELECT DISTINCT "person_id", "drug_concept_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
   WHERE "drug_concept_id" IN (/* list of quinapril-related concept_ids */)
   LIMIT 1000;
   ```

6. **Get all unique drug concept IDs from the DRUG_EXPOSURE table:**

   ```sql
   SELECT DISTINCT "drug_concept_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
   LIMIT 1000;
   ```

7. **Retrieve drug names and codes from the CONCEPT table for drugs in DRUG_EXPOSURE:**

   ```sql
   SELECT DISTINCT "concept_id", "concept_name", "concept_code"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
   WHERE "concept_id" IN (
       SELECT DISTINCT "drug_concept_id"
       FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
   )
   LIMIT 1000;
   ```

8. **List all vocabulary IDs used in the CONCEPT table:**

   ```sql
   SELECT DISTINCT "vocabulary_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
   LIMIT 1000;
   ```

9. **List all entries in the CONCEPT table where vocabulary is 'RxNorm' and concept class is 'Ingredient':**

   ```sql
   SELECT DISTINCT "concept_id", "concept_name", "concept_code"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
   WHERE "vocabulary_id" = 'RxNorm' AND "concept_class_id" = 'Ingredient'
   LIMIT 1000;
   ```

10. **Retrieve all drug source values from the DRUG_EXPOSURE table:**

    ```sql
    SELECT DISTINCT "drug_source_value"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
    LIMIT 1000;
    ```

11. **List all concept codes from the CONCEPT table where concept names contain 'ACE inhibitor' (medication class of quinapril):**

    ```sql
    SELECT DISTINCT "concept_code", "concept_name"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
    WHERE LOWER("concept_name") LIKE '%ace inhibitor%'
    LIMIT 1000;
    ```

12. **Retrieve all relationships for quinapril in the CONCEPT_RELATIONSHIP table:**

    (Assuming quinapril's concept_id is known)

    ```sql
    SELECT DISTINCT "concept_id_1", "concept_id_2", "relationship_id"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT_RELATIONSHIP"
    WHERE "concept_id_1" = /* quinapril_concept_id */ OR "concept_id_2" = /* quinapril_concept_id */
    LIMIT 1000;
    ```

13. **Get all participants who have any drug exposure recorded:**

    ```sql
    SELECT DISTINCT "person_id"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
    LIMIT 1000;
    ```

14. **List all drugs (concept IDs and names) that participants are exposed to, along with the count of exposures:**

    ```sql
    SELECT "drug_concept_id", COUNT(*) AS "exposure_count"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
    GROUP BY "drug_concept_id"
    ORDER BY "exposure_count" DESC
    LIMIT 1000;
    ```

15. **Retrieve all concept names and concept codes for drugs classified as 'Clinical Drug':**

    ```sql
    SELECT DISTINCT "concept_id", "concept_name", "concept_code"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
    WHERE "concept_class_id" = 'Clinical Drug'
    LIMIT 1000;
    ```

---

These queries help in understanding the data related to participants, drug exposures, and specifically medications related to quinapril. By examining the concepts, relationships, and drug exposures, one can identify participants who have taken quinapril or related medications and calculate the percentage of those who have not.Query:
SELECT DISTINCT "person_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON"
   LIMIT 1000;
Answer:
Too long, hard cut:
person_id
649532
1216480
858137
1030915
382704
1728171
1242757
724288
775924
2207987
949485
1909732
1933885
619362
2195007
2054700
2041070
1497122
2417
620086
1688362
1408216
1819658
28150
907544
1536037
2180828
751805
1821358
2114658
772990
491783
1001295
351509
902445
1712298
1449253
882669
1770135
1576821
1639654
2317297
1542932
1250207
590855
1747108
1750476
1465728
870448
1541679
117824
1759847
186307
2260141
133151
331711
632201
1728485
2058151
2078119
378552
37445
1820527
2144053
1791179
976988
982204
1127068
1985664
2078352
1118759
357284
1465950
9956
1356860
1320755
766038
743708
2090479
388975
471200
1346489
1161766
1058518
652825
1135142
1146443
1919305
1356715
1912905
1584661
873341
2326503
1390417
27426
1105735
597443
1984570
1747545
1204831
892069
1202265
1393843
166190
1123457
2247883
1120851
1376109
1953658
1640776
406435
123298
158674
594761
847203
2155335
2292612
2242049
1546910
1375726
1233227
1351896
1234218
1565611
1731354
153981
1203593
1826510
2304544
2046869
2304536
1223563
451172
814502
2216851
221334
1635352
1924023
264467
32627
1615833
667249
1471319
780956
762323
169692
186249
1627092
1716554
390772
1301671
2152186
2229223
1566979
176939
1554155
111902
2044932
241829
2010154
384555
1385560
493984
1206268
1312704
907380
1670735
1031526
1007721
1087442
524188
152400
1716123
2095222
1457187
72285
878763
774639
1930692
1711617
394369
1139302
1467695
1919045
1599613
39588
1655968
1845536
813615
2254462
1206728
2023791
695415
2200906
150391
38395
270445
1609960
1665155
1723298
909548
2256619
1997577
767308
2008716
985158
725968
1750268
712244
568165
442898
1705107
1894070
1808782
1910017
1922689
449455
1208922
717972
700567
1160913
1414267
352833
593392
594031
2098951
1599443
2260962
1707090
1509411
1214778
323091
1181206
1307300
538213
1659070
1336337
633994
583846
1943383
1722374
457075
640502
166395
201711
1145559
1474496
1121086
219708
1142439
1836740
1880885
1082584
1288656
190750
304304
1394510
1991197
455100
1200592
435698
339405
1045016
1488136
201491
1309039
2020724
1661641
2102467
2213010
609050
1227756
2279978
895381
352084
2216320
28656
1854263
5407
1941626
1534585
302267
2115680
168925
2229839
604954
1073402
446814
392589
1696133
99040
980449
1359485
961466
821167
1109640
1312944
33258
1485120
2222445
1386210
2277049
1705210
74721
441780
2266135
2082130
415263
830506
2089920
1450989
314737
1060530
482272
158771
1079415
1573530
1204936
1808450
643387
717075
673696
475040
1507511
1736386
1436579
1504761
960868
1775997
1561393
1719342
1137245
1235672
740871
86900
128842
1698846
923725
1560121
494457
89948
659964
489215
958064
1735562
736054
1452080
181541
2112842
1135895
526453
636072
493089
2140289
1664946
567268
1758974
97811
334417
1504397
1598681
1910542
2204714
12388
1366694
1564904
1958770
718580
2265203
1559234
2059485
2242434
1029958
2313629
481328
597453
1882962
2026162
2107525
1104537
2101965
1929799
2222825
1145957
2098437
781140
503379
201148
974205
1422302
731411
386904
1794451
1306032
2077318
122620
1057858
1581413
493562
1301343
2040205
1555346
1084336
1742744
2228649
2060935
796040
1080597
1270139
923928
937504
2201800
1945210
690639
1050105
453845
618084
801285
1742561
2195552
1582765
1685008
1700631
2162106
859319
1374452
2002474
1598101
206279
1427443
1202088
167967
1117429
1554077
1999013
1739847
740573
1757438
2079856
1768862
562235
1530419
1355277
337907
1995452
537279
1397984
1532302
1530157
384237
1334247
2290476
513725
1427695
978903
661368
2224508
1115141
1640731
1875978
1879674
1744865
549002
1953769
2117237
894441
1587937
598099
2268832
822755
820124
1092363
1054962
169497
804830
518785
1437826
281686
897623
389356
370981
2242655
1878105
682449
2307101
671466
532165
2144465
542135
2250763
384807
2295252
1632192
352190
1157302
717236
2130063
877010
1033629
1189903
352773
675582
1604742
1173314
1039048
1208523
556250
1449921
2056351
1062317
2179008
870520
906739
423151
1850997
1555016
1198775
1157411
2285084
1336444
1502909
2312452
1214030
62297
429677
2175167
1048766
1175106
1415287
1897224
424413
547402
422585
345922
944565
131466
2080108
1600906
1134009
162558
1321452
1354000
525738
1790593
215798
1388303
928614
1394402
1222696
951873
2299872
1784360
1510152
943531
268960
1527990
316496
1323167
628887
2281077
1280612
1832790
1197145
1113023
719526
1654297
261533
973470
613617
122795
2241536
824187
1099907
1478854
111149
67617
2170045
925859
1544900
956718
2054747
1604307
1834789
458283
1489238
26300
1755175
723975
1241255
663160
201810
965640
1571661
346925
221410
1331669
1638393
666152
2144134
1365677
1037924
328632
259859
1017826
779457
932685
738248
2025857
2284296
1110278
1182946
520785
635239
809785
30903
1419522
887543
1684992
66615
220913
40687
1782283
1983909
444022
474111
1498758
1566986
149112
1860108
1097452
1178807
1959762
2311513
552614
782978
2138882
858623
1576348
564392
998178
2242966
180484
825423
486571
1694417
2280167
319089
442497
1283364
1526176
1889262
834054
2224222
271572
1405674
2269265
1451650
1855195
1303905
1552399
1163
Query:
SELECT DISTINCT "concept_id", "concept_name", "vocabulary_id", "concept_code"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
   WHERE "concept_code" = '35208'
   LIMIT 1000;
Answer:
concept_id,concept_name,vocabulary_id,concept_code
1331235,quinapril,RxNorm,35208
Query:
SELECT DISTINCT "concept_id", "concept_name", "concept_code", "vocabulary_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
   WHERE LOWER("concept_name") LIKE '%quinapril%'
   LIMIT 1000;
Answer:
Too long, hard cut:
concept_id,concept_name,concept_code,vocabulary_id
35748142,quinapril 10 MG Delayed Release Oral Tablet by Dowelhurst,OMOP2749603,RxNorm Extension
44043725,quinapril Oral Tablet [Gd-Quinapril],OMOP1038356,RxNorm Extension
19111733,quinapril 1 MG/ML,451329,RxNorm
45675672,"quinapril 20mg/1 ORAL TABLET, FILM COATED",1d295d65-ebf9-440e-aa59-747418d09ce0,SPL
44901002,quinapril 5 MG Oral Tablet [Accupril],54868330700,NDC
43289972,quinapril 10 MG Oral Tablet [Aquinafil],OMOP546915,RxNorm Extension
41313171,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Oral Tablet [Quinapril Heumann],OMOP2511133,RxNorm Extension
41308876,quinapril 10 MG Oral Tablet [Quinapril Ct],OMOP2506838,RxNorm Extension
41027967,quinapril 10 MG Delayed Release Oral Tablet [Quinapril Hexal Comp],OMOP2225929,RxNorm Extension
41308877,quinapril 10 MG Delayed Release Oral Tablet [Quinapril Abz] Box of 30,OMOP2506839,RxNorm Extension
43179025,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Delayed Release Oral Tablet [QUINAPRIL/HYDROCHLOROTHIAZIDE MYLAN] Box of 90,OMOP448084,RxNorm Extension
41320336,quinapril 5 MG Oral Tablet [Quinapril Stada] Box of 30 by Stada,OMOP2518298,RxNorm Extension
41257864,quinapril 20 MG Oral Tablet [Quinapril Stada] Box of 100 by Stada,OMOP2455826,RxNorm Extension
35752264,quinapril 5 MG Delayed Release Oral Tablet [Accupro] by Dowelhurst,OMOP2753725,RxNorm Extension
40872209,quinapril 10 MG Delayed Release Oral Tablet [Quinapril Ct] Box of 50,OMOP2070171,RxNorm Extension
35748140,quinapril 10 MG Delayed Release Oral Tablet Box of 28 by Kent,OMOP2749601,RxNorm Extension
21053125,quinapril 10 MG Oral Tablet Box of 28 by Kent,OMOP374011,RxNorm Extension
35760639,quinapril 5 MG Delayed Release Oral Tablet [Accupro] Box of 28 by Dowelhurst,OMOP2762100,RxNorm Extension
40945895,quinapril 10 MG Oral Tablet [Accupro] Box of 30 by Pfizer,OMOP2143857,RxNorm Extension
21072832,quinapril 20 MG Oral Tablet Box of 28 by Mylan,OMOP373963,RxNorm Extension
41184482,quinapril 20 MG Delayed Release Oral Tablet [Quinapril Abz] Box of 50,OMOP2382444,RxNorm Extension
44181971,quinapril 20 MG Delayed Release Oral Tablet [Quinalich] Box of 50 by Sanofi,OMOP3058694,RxNorm Extension
35760651,quinapril 20 MG Delayed Release Oral Tablet by DE,OMOP2762112,RxNorm Extension
45038769,quinapril 20 MG Oral Tablet [Accupril],58016079876,NDC
44970442,quinapril 20 MG Oral Tablet [Accupril],58016079836,NDC
43129684,QUINAPRIL ZENTIVA,OMOP433676,RxNorm Extension
45378253,"quinapril 5mg/1 ORAL TABLET, FILM COATED",548685279,NDC
45850996,"quinapril hydrochloride 10mg/1 ORAL TABLET, FILM COATED [quinapril]",658620618,NDC
45278198,"quinapril hydrochloride 5mg/1 ORAL TABLET, FILM COATED",597625019,NDC
45234947,Quinapril 40 mg/1 TABLET [Quinapril],055111624,NDC
45091341,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Oral Tablet,63304016230,NDC
46252531,quinapril 10 MG Oral Tablet,63187042590,NDC
45998448,Quinapril 5mg tablets (Genus Pharmaceuticals Ltd),8044211000001102,SNOMED
46130119,Quinapril 5mg tablets (Mylan Ltd) 28 tablet 2 x 14 tablets,7392111000001102,SNOMED
46189346,Quinapril 5mg tablets (Waymade Healthcare Plc) 28 tablet,21875311000001104,SNOMED
45162992,quinapril 20 MG Oral Tablet,00185004901,NDC
45019363,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Oral Tablet,53869220001,NDC
44971184,quinapril 20 MG Oral Tablet [Accupril],60491000330,NDC
44872918,quinapril 10 MG Oral Tablet,00093105198,NDC
44921994,quinapril 5 MG Oral Tablet [Accupril],65427052740,NDC
45160014,quinapril 10 MG Oral Tablet [Accupril],65427053099,NDC
43587070,quinapril Oral Tablet [Accupro 20],OMOP675548,RxNorm Extension
36213873,quinapril Pill,1157877,RxNorm
46189350,Quinapril 40mg tablets (Waymade Healthcare Plc) 28 tablet,21876111000001107,SNOMED
46189347,Quinapril 10mg tablets (Waymade Healthcare Plc) 28 tablet,21875611000001109,SNOMED
40815540,Quinapril 1a,OMOP2013502,RxNorm Extension
45232824,quinapril 5 MG Oral Tablet,00480105098,NDC
44855967,quinapril 20 MG Oral Tablet,00093104505,NDC
45001606,quinapril 10 MG Oral Tablet,52152024204,NDC
4353314,POTASSIUM CHLORIDE/QUINAPRIL,N0000033140,NDFRT
43129685,QUINAPRIL/HYDROCHLOROTHIAZIDE ARROW,OMOP434388,RxNorm Extension
44988012,"quinapril hydrochloride 40mg/1 ORAL TABLET, FILM COATED",597625022,NDC
45064750,Quinapril ORAL 20140225 TABLET [Quinapril] ## FDA,068001186,NDC
45874643,quinapril 40 MG Oral Tablet,50268069111,NDC
45006855,quinapril 40 MG Oral Tablet,65862062078,NDC
45208166,quinapril 10 MG Oral Tablet,55567027209,NDC
44176855,quinapril 20 MG Delayed Release Oral Tablet [Quinalich],OMOP3053578,RxNorm Extension
40907413,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Delayed Release Oral Tablet [Accuzide],OMOP2105375,RxNorm Extension
35750359,quinapril 20 MG Delayed Release Oral Tablet [Quinil],OMOP2751820,RxNorm Extension
41250971,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Delayed Release Oral Tablet [Quinalich],OMOP2448933,RxNorm Extension
1331241,quinapril 20 MG Oral Tablet,312749,RxNorm
41246826,quinapril 20 MG Oral Tablet 
Query:
SELECT
       100.0 * (
         (total.total_participants - users.users_of_quinapril_related_medications) 
         / total.total_participants
       ) AS "percentage_not_using_quinapril_and_related_medications"
     FROM
       (
         SELECT COUNT(DISTINCT "person_id") AS total_participants
         FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON"
       ) total,
       (
         SELECT COUNT(DISTINCT "person_id") AS users_of_quinapril_related_medications
         FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
         WHERE "drug_concept_id" IN (
             SELECT DISTINCT "descendant_concept_id"
             FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT_ANCESTOR"
             WHERE "ancestor_concept_id" = 1331235
         )
       ) users;
Answer:
percentage_not_using_quinapril_and_related_medications
90.120700
Query:
SELECT DISTINCT c."concept_id", c."concept_name", c."concept_code", c."vocabulary_id"
  FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT" c
  WHERE c."concept_id" IN (
      SELECT DISTINCT "descendant_concept_id"
      FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT_ANCESTOR"
      WHERE "ancestor_concept_id" = 1331235
  )
  LIMIT 1000;
Answer:
Too long, hard cut:
concept_id,concept_name,concept_code,vocabulary_id
35764775,quinapril 20 MG Delayed Release Oral Tablet by Mawdsley-Brooks,OMOP2766236,RxNorm Extension
40979155,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Delayed Release Oral Tablet [Quinaplus Al] Box of 100 by Aliud,OMOP2177117,RxNorm Extension
41084024,quinapril 5 MG Oral Tablet Box of 56,OMOP2281986,RxNorm Extension
43273756,quinapril 10 MG Oral Tablet Box of 30 by Pfizer,OMOP546905,RxNorm Extension
41164663,quinapril 5 MG Delayed Release Oral Tablet [Accupron] Box of 56 by Gerke,OMOP2362625,RxNorm Extension
43217641,quinapril 20 MG Delayed Release Oral Tablet [QUINAPRIL BIOGARAN] Box of 28 by Biogaran,OMOP499996,RxNorm Extension
43157076,Hydrochlorothiazide / quinapril Delayed Release Oral Tablet [QUINAPRIL/HYDROCHLOROTHIAZIDE ZENTIVA],OMOP448048,RxNorm Extension
41198361,Hydrochlorothiazide 12.5 MG / quinapril 10 MG Oral Tablet Box of 100 by Novartis,OMOP2396323,RxNorm Extension
19078104,Hydrochlorothiazide 12.5 MG / quinapril 10 MG Oral Tablet,310796,RxNorm
41032217,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Delayed Release Oral Tablet [Accuzide] Box of 300,OMOP2230179,RxNorm Extension
41059190,quinapril 5 MG Delayed Release Oral Tablet [Accupron] Box of 500,OMOP2257152,RxNorm Extension
43289970,quinapril 10 MG Oral Tablet [Acquin],OMOP546910,RxNorm Extension
43145819,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Delayed Release Oral Tablet [QUINAPRIL/HYDROCHLOROTHIAZIDE MYLAN] Box of 28,OMOP448082,RxNorm Extension
41059185,quinapril 10 MG Delayed Release Oral Tablet [Accupro] Box of 30,OMOP2257147,RxNorm Extension
35773338,quinapril 10 MG Delayed Release Oral Tablet [Accupro] Box of 28 by Pfizer,OMOP2774799,RxNorm Extension
21092310,quinapril 40 MG Oral Tablet by Ranbaxy,OMOP374050,RxNorm Extension
44185726,quinapril 5 MG Delayed Release Oral Tablet [Accupro] Box of 28 by Gerke,OMOP3062449,RxNorm Extension
41184488,quinapril 5 MG Oral Tablet [Quinalich] Box of 50,OMOP2382450,RxNorm Extension
40969799,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Oral Tablet [Accuzide] Box of 300,OMOP2167761,RxNorm Extension
44174519,quinapril 20 MG Delayed Release Oral Tablet [Quinapril Abz] Box of 30 by AbZ-Pharma,OMOP3051242,RxNorm Extension
41072879,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Oral Tablet Box of 50 by Betapharm,OMOP2270841,RxNorm Extension
41167015,Hydrochlorothiazide 12.5 MG / quinapril 10 MG Oral Tablet [Quinaplus Stada] Box of 50 by Stada,OMOP2364977,RxNorm Extension
43151722,quinapril Delayed Release Oral Tablet [QUINAPRIL MYLAN],OMOP499939,RxNorm Extension
41177766,quinapril 10 MG Oral Tablet Box of 50,OMOP2375728,RxNorm Extension
44127099,quinapril 40 MG Oral Tablet by Pro Doc Limitee,OMOP1121730,RxNorm Extension
21161193,Hydrochlorothiazide 12.5 MG / quinapril 10 MG Oral Tablet [Accuretic] by Waymade,OMOP374140,RxNorm Extension
41246828,quinapril 20 MG Oral Tablet [Quinapril Abz],OMOP2444790,RxNorm Extension
44162295,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Delayed Release Oral Tablet [Quinapril Heumann] Box of 50,OMOP3039018,RxNorm Extension
40876475,Hydrochlorothiazide 12.5 MG / quinapril 10 MG Oral Tablet [Quinaplus Al] Box of 100,OMOP2074437,RxNorm Extension
41308880,quinapril 40 MG Oral Tablet [Quinapril Hexal Comp],OMOP2506842,RxNorm Extension
21053120,quinapril 20 MG Oral Tablet by TEVA,OMOP373957,RxNorm Extension
40914476,quinapril 5 MG Oral Tablet [Quinapril Abz] Box of 50 by AbZ-Pharma,OMOP2112438,RxNorm Extension
41308886,quinapril 5 MG Oral Tablet [Quinapril Ct] Box of 100,OMOP2506848,RxNorm Extension
41260260,Hydrochlorothiazide 12.5 MG / quinapril 10 MG Oral Tablet [Quinaplus Al] Box of 30 by Aliud,OMOP2458222,RxNorm Extension
40885932,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Oral Tablet Box of 30 by Novartis,OMOP2083894,RxNorm Extension
43257374,quinapril 20 MG Oral Tablet by Generic Health,OMOP546872,RxNorm Extension
41027971,quinapril 10 MG Oral Tablet [Quinalich] Box of 50,OMOP2225933,RxNorm Extension
35756489,quinapril 20 MG Delayed Release Oral Tablet Box of 28 by Mawdsley-Brooks,OMOP2757950,RxNorm Extension
40883565,quinapril 20 MG Oral Tablet Box of 50 by Ratiopharm,OMOP2081527,RxNorm Extension
43189937,Hydrochlorothiazide 12.5 MG / quinapril 20 MG [QUINAPRIL/HYDROCHLOROTHIAZIDE ARROW],OMOP448052,RxNorm Extension
41001111,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Delayed Release Oral Tablet [Acuretic],OMOP2199073,RxNorm Extension
44178269,quinapril 10 MG Delayed Release Oral Tablet [Quinapril Heumann] Box of 100 by Heumann,OMOP3054992,RxNorm Extension
41094952,Hydrochlorothiazide 12.5 MG / quinapril 20 MG Oral Tablet [Quinapril Heumann] Box of 50,OMOP2292914,RxNorm Extension
44180538,quinapril 10 MG Delayed Release Oral Tablet [Quinalich] Box of 50,OMOP3057261,RxNorm Extension
41277668,quinapril 10 MG Delayed Release Oral Tablet [Quinapril Heumann] Box of 30,OMOP2475630,RxNorm Extension
35743908,quinapril 5 MG Delayed Release Oral Tablet Box of 28 by TEVA,OMOP2745369,RxNorm Extension
44088106,quinap
Query:
SELECT DISTINCT "drug_concept_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
   LIMIT 1000;
Answer:
Too long, hard cut:
drug_concept_id
40080069
46275982
40018375
2213462
19022064
1589505
19020053
40237878
19122220
40170472
19023567
40163468
19079172
40163568
40228214
40162711
19074842
40175215
40162683
40174943
1168160
40224645
40174409
40221913
19073181
40172047
40224805
40226771
1328556
40168016
19025333
40233955
40163212
19096179
40170348
19020478
40162777
40171946
1120734
19114316
19131644
40231804
1769538
19057566
40165757
19047487
751889
40184729
19027831
40175876
40184084
40172737
40173594
46275604
19132040
700322
40173563
528325
40233295
19079835
19082577
40169706
42873817
40225747
19031629
40172513
42799866
40162483
975470
19037969
40173301
1152738
40163548
907267
40239104
46275505
19065475
40168673
19032967
703252
40169274
40165499
40161678
997997
1321363
19073650
1734107
19132436
19071494
19078551
40226528
1781407
40243514
40171504
1166028
40169391
19096196
1309992
40165543
40237124
741575
19031851
40163230
40162091
19074785
975490
42899227
40169267
1782543
40174179
19077766
19004471
40164099
40226328
19077736
1160013
40171692
1153668
19131884
19076707
1165095
19029901
40232127
40174707
19034327
40163128
40162925
957235
1547505
42873968
40224350
19030091
19023062
42901923
942496
19078663
19133751
40165733
40172776
40231899
40222902
40171322
42799699
19028249
40175307
40165708
19125164
40170173
19079690
2213490
40172239
19057912
40228215
40227492
19043739
551854
19034041
19131017
40169353
19016710
1036144
40223155
2213451
40222659
40225083
1746118
19124649
986148
40233236
920623
19122808
1131495
40225037
40230471
46287393
40162937
40163220
40224359
40160962
907422
19032168
40239152
19108043
19068753
40163913
40237540
40175079
40221871
40173537
19027884
40244165
1119155
19039818
42799660
778769
19124661
46275077
40226430
19030761
19096491
42873659
40166418
19033982
40174148
40181425
19126570
40165012
40169278
40072348
1506270
40141823
1550776
19133296
19071475
19076734
40231813
40167824
42800850
1037007
19134410
19008700
40225166
916945
1314009
781062
19080003
755739
19072237
19077549
40172522
19078607
40162553
19077763
19123355
40174097
19025331
40169909
40232735
19077653
40185006
40162940
19074847
1304793
1314008
19027624
40174402
40170580
974200
42708410
19074181
40029020
40167202
19131621
992591
19019310
40168170
40161244
1305472
40222727
19058921
19132315
40163850
1554073
40173949
19096813
922806
19027106
19029813
19027941
42708690
40224209
40244027
984237
42799599
40169484
19024536
19133840
967309
40163991
1501454
19030197
40170029
1350490
42800708
40185416
19019071
19066196
1711525
40172268
40164196
19124179
43532891
40161105
40174404
42707244
903284
40174838
789580
40242129
40234043
40163520
712620
1567232
1768851
40243206
40236857
19075606
43011909
1361859
40233977
40168374
40164331
19020365
19079712
19041421
19125278
1337190
19102555
45776438
19125468
40239806
40173152
40221631
40224837
19077302
19133232
40179707
40229805
46275355
40236575
19079088
40232730
40175919
40235213
19113858
40223769
918635
40175943
40232217
40161591
1165157
904598
40172263
40161517
46275202
40173385
19132872
42709047
40170957
40222467
948557
19032969
40222227
19028247
1177822
19113288
1777287
40185304
40175677
42902095
19003272
40164617
1396013
40239796
19080218
19121298
1128871
40241162
40166808
1134561
40234410
40226253
42902075
19019158
40167605
19047210
40063294
40226552
1188235
919528
916949
1762775
1799158
40171513
19037780
19030770
19129737
19076926
1548199
1194535
1237159
40232477
40221650
40228967
40224898
40163827
1550579
1001194
40167368
992616
1836519
19127526
19102572
40175124
40173400
19038503
42898829
1560750
19098330
19019009
40164340
19130288
40229970
42707604
40224559
40238436
1318984
735477
40166464
42799562
1121524
19040961
974163
551463
19029941
40172377
40181873
40231990
40239737
40173398
40164778
19018389
1312779
40238009
19067262
40232569
40229055
42873728
19122898
19095289
43527208
43013597
19069321
40226401
19033716
40034680
46275076
1308290
40094836
40015456
535714
40078598
40221966
19075034
1127433
19095325
1763844
1797516
40170333
42800271
40223553
40172130
19019074
40163525
43011850
19020367
40161236
19042762
596898
40226864
19114928
1314006
19129440
40161732
1754996
720730
2213495
987250
40227233
19035622
19078106
19102640
40221651
19074272
19136019
19079982
19095153
982109
19023563
40165262
2213443
2213395
40222456
924442
1115244
40174494
19133562
1126494
923541
19127534
40161631
40172706
40170747
1154079
1797576
1560558
917310
40169004
19064963
957626
19034011
40236828
45776287
19045932
1791016
711585
19008547
19028939
1196532
40174357
1522990
40175311
43012671
19131060
40227393
43011889
40161752
19098439
1799140
40227483
40224604
44818237
19121208
40225741
19005066
917082
40222579
40224642
40163070
19079685
19022487
1769562
40225940
19071784
19077941
19102739
40226678
40167847
19038643
40227396
40224085
40163757
40233950
40163541
40170820
19075395
919005
40232648
19027461
40239110
19030005
42902059
40172215
19127397
19135492
40172412
40175289
974196
40223170
1387785
997961
19098491
19096794
4016
Query:
SELECT DISTINCT "concept_id", "concept_name", "concept_code"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
   WHERE "concept_id" IN (
       SELECT DISTINCT "drug_concept_id"
       FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
   )
   LIMIT 1000;
Answer:
Too long, hard cut:
concept_id,concept_name,concept_code
40172351,green ash pollen extract 25 MG/ML / white ash pollen extract 25 MG/ML Injectable Solution,900064
1503059,Aminoglutethimide 250 MG Oral Tablet,197352
964731,Salicylic Acid 20 MG/ML / Sulfur 30 MG/ML Topical Cream,244537
40221955,Acetaminophen 500 MG / Orphenadrine Citrate 50 MG Oral Tablet,994809
40163525,Warfarin Sodium 2 MG Oral Tablet [Coumadin],855304
19038682,Thiothixene 1 MG Oral Capsule [Navane],208492
40226744,orange allergenic extract 50 MG/ML Injectable Solution,1010858
40227778,CARBETAPENTANE CITRATE 4 MG/ML / Guaifenesin 20 MG/ML / Phenylephrine Hydrochloride 3 MG/ML Oral Solution,1037245
40161827,American house dust mite extract 30 AU/ML Injectable Solution,854046
19130786,Alanine 8.8 MG/ML / Arginine 4.89 MG/ML / Glucose 100 MG/ML / Glycine 4.38 MG/ML / Histidine 2.04 MG/ML / Isoleucine 2.55 MG/ML / Leucine 3.11 MG/ML / Lysine 2.47 MG/ML / Methionine 1.7 MG/ML / Phenylalanine 2.38 MG/ML / Proline 2.89 MG/ML / Serine 2.13 M,800405
42708140,Brompheniramine Maleate 0.8 MG/ML / Pseudoephedrine Hydrochloride 4 MG/ML Oral Solution [BroveX PSB],1243500
40049686,Hydrocortisone Injectable Solution,370648
43526136,Dexamethasone sodium phosphate 24 MG/ML Injectable Solution,1376068
40171584,Allscale pollen extract 10000 UNT/ML Injectable Solution,897311
19077941,Haloperidol 1 MG/ML Oral Solution,310673
19133672,Desmopressin Acetate 0.15 MG/ACTUAT Nasal Spray [Stimate],831460
40162477,Acetaminophen 500 MG / Hydrocodone Bitartrate 5 MG Oral Capsule [Dolacet],857159
40165081,Nicardipine hydrochloride 20 MG Oral Capsule [Cardene],858615
43014091,hydrocortisone valerate 2 MG/ML Topical Cream,1370754
19032226,Levodopa 250 MG Oral Tablet [Larodopa],206386
19032269,Methadyl Acetate 10 MG/ML Oral Solution [Orlaam],206399
906933,Metoclopramide 5 MG Oral Tablet,311668
19128297,terbinafine 187.5 MG Oral Granules [Lamisil],753108
42902108,methylprednisolone acetate 20 MG/ML Injectable Suspension [Depo-Medrol],1358512
19076899,Epinephrine 1 MG/ML Injectable Solution,310132
40224911,Doxepin Hydrochloride 50 MG/ML Topical Cream [Zonalon],1000095
19078632,"Insulin, Regular, Pork 100 UNT/ML Injectable Solution",311057
40175212,Levothyroxine Sodium 0.05 MG Oral Tablet [Euthyrox],966160
19037521,Hydrochlorothiazide 50 MG / Spironolactone 50 MG Oral Tablet [Aldactazide],208116
40230466,azelaic acid 0.15 MG/MG Topical Gel [Finacea],1043748
19076707,Dolasetron 50 MG Oral Tablet,310007
40060257,cytomegalovirus immune globulin Injectable Solution,376867
46275899,ANTI-INHIBITOR COAGULANT COMPLEX 1 UNT,1659996
40164694,Hydrocodone Bitartrate 10 MG / Ibuprofen 200 MG Oral Tablet [Reprexain],859331
19019004,Fluconazole 50 MG Oral Tablet,197701
19073306,Amylases 70000 UNT / Endopeptidases 55000 UNT / Lipase 25000 UNT Delayed Release Oral Capsule,308241
19114108,Citric Acid 66.8 MG/ML / sodium citrate 100 MG/ML Oral Solution [Cytra 2],543018
46276333,3 ML Amiodarone hydrochloride 50 MG/ML Injection,1663224
1000774,Granisetron 1 MG/ML Injectable Solution [Kytril],152625
42901957,Brompheniramine Maleate 4 MG / Phenylpropanolamine Hydrochloride 25 MG Oral Tablet,1357428
1636872,testosterone cypionate 100 MG/ML Injectable Solution [Depo-testosterone],835831
19040307,Lovastatin 10 MG Oral Tablet [Mevacor],209013
40231737,{21 (Ethinyl Estradiol 0.035 MG / Norethindrone 1 MG Oral Tablet) / 7 (Inert Ingredients 1 MG Oral Tablet) } Pack [Cyclafem 1/35 28 Day],1047040
40238419,Nefazodone hydrochloride 150 MG Oral Tablet,1098666
19032001,Guaifenesin 6.67 MG/ML / Theophylline 6.67 MG/ML Oral Solution [Elixophyllin-GG],206318
19046436,Sodium Fluoride 1 MG Oral Tablet [Fluorodex],211806
40164762,Guaifenesin 40 MG/ML / Hydrocodone Bitartrate 0.5 MG/ML Oral Solution,859383
19131609,Phentermine Hydrochloride 37.5 MG Oral Capsule [Adipex-P],803350
40243890,Fluocinolone Acetonide 0.25 MG/ML Topical Cream [Synemol],1191321
19036748,Stanozolol 2 MG Oral Tablet [Winstrol],207890
40183581,Fenbendazole 0.1 MG/MG Oral Paste [Safe-Guard],993348
40166822,24 HR Hydrochlorothiazide 12.5 MG / metoprolol succinate 50 MG Extended Release Oral Tablet [Dutoprol],866475
40162500,Acetaminophen 500 MG / Hydrocodone Bitartrate 5 MG Oral Tablet [Panacet],857373
1714304,voriconazole 200 MG Oral Tablet [Vfend],352219
19004032,mycophenolate mofetil 500 MG Injection [Cellcept],213394
19079973,desoxycorticosterone 25 MG/ML Injectable Suspension [Percorten V],584596
1154619,200 ACTUAT Albuterol 0.09 MG/ACTUAT Metered Dose Inhaler [ProAir],745752
939801,10 ML Sodium Bicarbonate 84 MG/ML Prefilled Syringe,792577
19122278,Guaifenesin 900 MG / Phenylephrine 30 MG Extended Release Oral Tablet [Deconex],602191
1728606,2 ML penicillin G benzathine 600000 UNT/ML Prefilled Syringe [Bicillin L-A],731568
40169352,24 HR quetiapine 150 MG Extended Release Oral Tablet,895670
19057568,Vancomycin 100 MG/ML Injectable Solution,239209
40226821,Epinephrine 0.005 MG/ML / Lidocaine Hydrochloride 15 MG/ML Injectable Solution [Xylocaine with Epinephrine],10
Query:
SELECT DISTINCT "vocabulary_id"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
   LIMIT 1000;
Answer:
vocabulary_id
NDC
Specialty
Observation Type
ICD10CM
RxNorm
HCPCS
Gender
VA Class
Meas Type
Note Type
Cost Type
Device Type
Race
Concept Class
Place of Service
None
SNOMED
Drug Type
Condition Type
SPL
ICD9CM
ICD9Proc
ABMS
Revenue Code
RxNorm Extension
Relationship
Vocabulary
Visit
Procedure Type
Domain
Death Type
CPT4
UCUM
NUCC
Currency
Visit Type
LOINC
Obs Period Type
NDFRT
ATC
Ethnicity
Query:
SELECT DISTINCT "concept_id", "concept_name", "concept_code"
   FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
   WHERE "vocabulary_id" = 'RxNorm' AND "concept_class_id" = 'Ingredient'
   LIMIT 1000;
Answer:
Too long, hard cut:
concept_id,concept_name,concept_code
19055569,AMINO ACIDS 11.4%,235892
19115027,"japanese encepahlitis virus vaccine, inactivated",547233
42900213,TRIBASIC SODIUM PHOSPHATE,1307159
42899523,Iris versicolor root extract,1309668
42899166,Helianthemum canadense extract,1311106
42898659,Asterias rubens preparation,1311303
19080273,"ALLERGENIC EXTRACT, ASPERGILLUS NIGER",314323
19009915,Trichophyton mentagrophytes,10786
40053046,IPECAC ALKALOIDS,317237
40150665,"Hepatitis A Vaccine, Inactivated strain HM175",797750
40161463,Russian olive pollen extract,852367
40160943,English walnut pollen extract,852577
40172321,mustard seed allergenic extract,899456
40175868,green bell pepper allergenic extract,862478
43526351,SILODRATE,1373351
43013946,behenate,1368204
43525811,Boswellia sacra bark extract,1371444
35604368,Cymbidium hookerianum flower extract,1737791
40220703,Magnolia kobus flowering top extract,1801506
44784888,POLYACRYLIC ACID (8000 MW),1484857
43012972,STEARETH-21,1367122
42898489,Bryonia alba root extract,1309676
45775560,ethyl salicylate,1546423
40170916,lobster allergenic extract,892561
44507845,Hyoscyamus niger whole extract,1442993
43560287,"Tilia cordata, whole extract",1432477
42903489,Hexyldecyl Laurate,1312598
43532101,Pepper extract,1427085
42904170,2-propoxy-1-propanol,1356481
42903972,Arthrospira platensis,1321355
19066433,MILK THISTLE SEED EXTRACT,259274
1593946,Sepia officinalis whole extract,1868205
44784745,Colchicum autumnale seed extract,1485065
44814422,Shigella sonnei,1491872
42899155,Hamamelis virginiana leaf extract,1307887
40170235,Sydney golden wattle pollen extract,895365
1746244,Saquinavir,83395
42904221,Cistus incanus whole extract,1358477
43013669,Ilex paraguariensis whole extract,1368377
35603472,linalyl acetate,1735331
43012917,Poloxamer 338,1364384
45776898,Bos taurus somatic nerve preparation,1544245
42904166,TRIOCTYLDODECYL CITRATE,1356150
45775350,cadmium cation,1546276
42898527,Bos taurus knee joint preparation,1310262
42903470,chromium dioxide,1312546
43532204,TRIISOSTEARIN,1426662
42903858,POLOXAMER 124,1314379
42904084,Bowfin preparation,1347559
42904057,Fucus serratus extract,1342489
43532477,perillaldehyde,1426913
19050560,Eugenol,4186
19071809,TOXICODENDRON Preparation,285166
19136031,Saralasin,9556
19015703,ferumoxides,72901
43532450,saccharomyces lysate extract,1426343
35604418,ALLYL ACRYLATE,1788869
43525889,Gynostemma pentaphyllum top extract,1372927
19060992,Malt soup extract,91264
42904227,"1,3-dimethylurea",1358483
45775722,ETHYL PERFLUOROBUTYL ETHER,1540871
1594087,"ethyl 2,4-decadienoate, (2E,4Z)-",1869048
45775965,pembrolizumab,1547545
45892905,"((2s,3s,5s)-2-(2-(2,6-dimethylphenoxy)acetamido)-5-((s)-3-methyl-2-(2-oxotetrahydropyrimidin-1(2h)-yl)butanamido)-1,6-diphenylhexan-3-yl) 3-methyl-2-(2-oxotetrahydropyrimidin-1(2h)-yl)butanoate, (s)-",1599828
43532088,PPG-2 MYRISTYL ETHER PROPIONATE,1426407
42903950,Xerophyllum asphodeloides extract,1318234
45774933,Daphne mezereum whole extract,1545790
42900078,Solidago virgaurea flowering top extract,1309763
42898271,AMINOMETHYL PROPANEDIOL,1307680
42904248,Tremella fuciformis fruiting body extract,1358890
45774751,empagliflozin,1545653
43532388,HYDROLYSED MARINE COLLAGEN (ENZYMATIC; 2000 MW),1427229
45774848,Uncaria gambir whole extract,1539191
43531972,L-lactate,1427172
42899726,Sanicula europaea extract,1311101
42900187,Sus scrofa tooth preparation,1311354
19013828,Hyoscyamus extract,314674
19018640,bopindolol,19605
43532079,POLYOXYL 50 HYDROGENATED CASTOR OIL,1426435
43527177,etilevodopa,1421444
40175802,barley smut extract,968492
42900143,Sus scrofa esophagus preparation,1311328
42898571,CARBOMER COPOLYMER TYPE A,1310599
40228827,sugarcane allergenic extract,1014711
45892869,Strychnos nux-vomica whole extract,1599640
43014180,palmitoyl glutamate,1370585
42899065,Dill Seed Oil,1309204
44784749,Common hazel pollen extract,1484979
1593942,Astragalus chinensis seed extract,1868198
40167582,ofatumumab,712566
42900474,Interleukin-11,1311380
1593873,Ginkgo biloba root extract,1918243
35603210,diethylene glycol monophenyl ether,1719253
42898327,Angelica archangelica root extract,1309828
42900502,lesser galangal root extract,1307953
42898557,CALENDULA OFFICINALIS SEED OIL,1307790
43531845,diethylamino hydroxybenzoyl hexyl benzoate,1426392
42903718,tartrate,1314221
46234308,Rabies virus,1648419
42898269,ALUMINUM ZIRCONIUM TETRACHLOROHYDREX GLY,1305896
46221503,PEG-60 LANOLIN,1603523
35603445,Luffa aegyptiaca fruit extract,1735043
40240027,gamithromycin,1113697
43013507,C12-13 pareth-3,1368907
42903800,Halimeda opuntia extract,1314311
19091239,domiphen,23623
19009405,Vitamin D,11253
1103552,almotriptan,279645
19118007,STANNOUS TARTRATE,56701
1391861,Yohimbe bark preparation,236801
42900107,Tetrakis(1-isocyano-2-methoxy-2-methyl-propane)-copper(i) Tetrafluoroborate,1306061
40224712,barley malt allergenic extract,1006510
43532253,Yucca Schidigera extract,1425403
42900537,thallium sulfate,1309339
43531987,Lachnanthes caro
Query:
SELECT DISTINCT "drug_source_value"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
    LIMIT 1000;
Answer:
Too long, hard cut:
drug_source_value
J2710
J9206
J0500
00143178750
17236035001
58016027618
59115002475
00024414210
51129307501
00044101200
00677057501
67618031001
65862045012
51432061820
58716077112
43683012430
00179026530
55045112201
52446010021
00364060501
55289086330
00689512502
54868432500
54799054035
00781941292
55887031230
58016014815
00185002305
C9257
55175121900
10135028430
00364720930
61392044625
00245360023
58016062989
00469562040
48692001310
J7645
J7190
00054338363
65862031350
00254210302
52446070764
00228200350
00228303003
00085083402
21695030710
49348092109
00254785174
55887066615
67046052060
67113000401
17314370505
23490794602
51129186601
00406831505
53002030315
00378132305
51079001919
00032102352
00781322391
36987174302
55567004100
51660001510
50175031802
18837015795
00157028510
12634051471
21695001490
00247033715
00332310704
00677142205
66689003850
55289018640
68382004105
58165003202
51014089803
52735045226
00006404541
58177088880
66116068720
00555102204
43063022090
51301007616
54868474302
00074245202
57844020852
J2540
58016099367
62584023801
54569860103
51079001940
61314032815
36987212503
24338065661
00179120130
55045121005
14593010203
55983083711
44206025110
55887017330
52959086800
66267000115
00075291201
49648062975
00490710796
55567016213
00117108205
63629177406
59702007501
36987228801
49692090375
62076004503
00247119101
51432090303
58016003000
58016009399
00590511065
54568050002
65505062212
58016021236
52959066760
58016049328
00756035103
36987315801
10678000106
54569108800
13668002210
61392041791
61442022301
60758095215
58016035590
00364218041
00832820316
00088155220
12634078350
24236058102
58016062098
00157071001
66479058403
63874021560
23490151602
49348037469
63874107402
55111023430
34330000112
52959001124
00054002517
58016008340
54868398603
54868311103
55749000106
00228303111
54569091401
51129436001
58016010900
00527138301
61392090830
49288007203
24236026302
58016021621
52446093478
63874050440
36987257703
00281231117
43806054812
11523720002
00839678665
52959090909
00839610925
49999006000
42549060940
51129116101
52544077401
53568022002
00074226605
00574083625
58768087705
40042004805
52544081055
32889025810
54868400900
00013330351
61392049695
00056066085
00904399060
49884008712
00247192300
00004024208
58016086975
00814091814
55887067910
00603650066
00007036720
60312026709
58016057404
00409118021
52428000103
00405213516
49281025010
55045333101
10135012690
58016013856
00378015105
54868310503
52152021402
68788052806
49643004850
00574200202
00186125013
00406871004
00591558206
52555034101
54838021780
58016080824
59855027507
67544040115
43806072401
59676031200
58016305601
61392069539
49999034760
00066060307
00268668305
51285090802
50111088224
54868368601
62825000101
00719525151
68115017120
36987293804
58016070128
00074241614
54569469900
64980016201
00062065530
53261036324
49856268003
18837006460
45782000001
55175294302
60432024504
00591341605
51079016120
12838160104
67776045603
36987160301
49884031191
55289032416
59747011775
68462019401
00074490334
51672413800
36987106003
68820002317
52297011110
00527071528
11695910505
67402002106
11845039020
18837005530
66267010720
51655002030
12071029010
58016013905
53808076601
68115033000
00185019860
00548192710
66394003060
00904580315
23589001116
55045285306
61314022505
58016051089
54569001507
67870011305
00085083403
00037540030
43353015960
52584009501
26053009401
55154525004
52347661501
11023000111
63629397603
00378312093
54868420801
54868596601
67296026601
52446070766
00641027325
00223728010
62584064533
00006097151
36987185501
63629159701
37937019907
00247210002
00536345701
00527101210
54523013040
00472120006
58016079950
55289061514
58016019914
00281029807
16590027690
68387053630
61703022543
52493064830
00074159003
00223410802
58160084241
46672058516
59842001203
36987223801
46672024610
00157029144
87900092748
58016019921
16590032360
66267031310
64679076001
65649010102
60505008309
50111032501
51432052122
54868559001
00349874110
00085175801
36987184101
52959067430
23490500503
60505131001
67544003365
00247002701
58016033967
00814024020
00115230003
15330010210
64011006126
49725019130
60940000901
54569029800
58864051201
49999041830
65862004130
00302171001
11819006598
52959034920
52959033840
67296003602
55045295809
61392090665
55887047282
48695122003
61392090430
58016088932
00179155671
00254417221
00781217669
00548605600
64920000105
00223619901
00402090810
00179127970
67296004101
33261005436
49999002640
36987144601
16837087010
52544015130
57896010110
00247012528
00247002278
00555021702
68071028491
68387010010
00904766224
35470215709
00024072702
23490001009
58016178015
58016087220
00029600921
58016013216
52959044520
68788138501
00839151706
66336008530
49884056605
11509021516
50580027024
53261025720
62037052201
68752001160
00173068221
63874026702
00349210398
00378055305
53746046505
00501750605
00093711556
00172531200
58016008798
66267021015
21695010430
58356000103
21695026910
36987188701
00677066101
00247014040
55887091730
00904055870
00536443120
43858028501
68382001806
59702080
Query:
SELECT DISTINCT "concept_code", "concept_name"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
    WHERE LOWER("concept_name") LIKE '%ace inhibitor%'
    LIMIT 1000;
Answer:
concept_code,concept_name
C09B,"ACE INHIBITORS, COMBINATIONS"
C09BB,ACE inhibitors and calcium channel blockers
81608-2,NM for blood flow and kidney function W ACE inhibitor PO
241961007,ACE inhibitor-aggravated angio-oedema-urticaria
C09BX,"ACE inhibitors, other combinations"
4480F,Patient receiving ACE inhibitor/ARB therapy and beta-blocker therapy for 3 months or longer (HF)
C09BA,ACE inhibitors and diuretics
0008F,"ACE inhibitor therapy, prescribed"
371627004,ACE inhibitor-aggravated angioedema
4481F,Patient receiving ACE inhibitor/ARB therapy and beta-blocker therapy for less than 3 months or patient not receiving ACE inhibitor/ARB therapy and beta-blocker therapy (HF)
C09A,"ACE INHIBITORS, PLAIN"
LP31444-0,Ace inhibitors
151223007,ACE inhibitor prophylaxis
315054007,ACE inhibitor prophylaxis
C09AA,"ACE inhibitors, plain"
422593004,Acute renal failure due to ACE inhibitor
CV800,ACE INHIBITORS
182939002,ACE inhibitor prophylaxis
Query:
SELECT
     cr."concept_id_1",
     c1."concept_name" AS "concept_name_1",
     cr."concept_id_2",
     c2."concept_name" AS "concept_name_2",
     cr."relationship_id"
   FROM
     "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT_RELATIONSHIP" cr
     LEFT JOIN "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT" c1 ON cr."concept_id_1" = c1."concept_id"
     LEFT JOIN "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT" c2 ON cr."concept_id_2" = c2."concept_id"
   WHERE
     cr."concept_id_1" = 1331235 OR cr."concept_id_2" = 1331235
   LIMIT 1000;
Answer:
Too long, hard cut:
concept_id_1,concept_name_1,concept_id_2,concept_name_2,relationship_id
1331235,quinapril,4348756,quinapril,RxNorm - NDFRT eq
1331235,quinapril,1331264,quinapril 10 MG,RxNorm ing of
1331235,quinapril,19111733,quinapril 1 MG/ML,RxNorm ing of
1331235,quinapril,40098149,quinapril Injectable Solution,RxNorm ing of
1331235,quinapril,19055338,Quinapril hydrochloride,Has form
1331235,quinapril,36213871,quinapril Injectable Product,RxNorm ing of
1331235,quinapril,43253044,Filpril,Has brand name
1331235,quinapril,43129686,QUINAPRIL/HYDROCHLOROTHIAZIDE MYLAN,Has brand name
1331235,quinapril,44013794,Apo-Quinapril,Has brand name
1331235,quinapril,43252269,Aquinafil,Has brand name
1331235,quinapril,43575131,Quinapril Hexal Comp,Has brand name
1331235,quinapril,43128000,KOREC,Has brand name
1331235,quinapril,40815577,Quinapril Heumann,Has brand name
1331235,quinapril,19113325,Quinaretic,Has brand name
1331235,quinapril,40279463,Quinapril hydrochloride,Mapped from
1331235,quinapril,21601790,quinapril,Mapped from
1331235,quinapril,21601790,quinapril,RxNorm - ATC name
1331235,quinapril,21601790,quinapril,RxNorm - ATC
1331235,quinapril,43129688,QUINAPRIL/HYDROCHLOROTHIAZIDE ZENTIVA,Has brand name
1331235,quinapril,21017288,Quinil,Has brand name
1331235,quinapril,43127027,ACUITEL,Has brand name
1331235,quinapril,43575132,Quinapril-1 A Pharma Plus,Has brand name
1331235,quinapril,43575128,Quinaplus Al,Has brand name
1331235,quinapril,43129682,QUINAPRIL MYLAN,Has brand name
1331235,quinapril,43128001,KORETIC,Has brand name
1331235,quinapril,43129679,QUINAPRIL BIOGARAN,Has brand name
1331235,quinapril,40815542,Quinapril Abz,Has brand name
1331235,quinapril,40815541,Quinapril 1a Pharma Plus,Has brand name
1331235,quinapril,44020216,Ran-Quinapril,Has brand name
1331235,quinapril,43129687,QUINAPRIL/HYDROCHLOROTHIAZIDE TEVA,Has brand name
1331235,quinapril,40815576,Quinapril Ct,Has brand name
1331235,quinapril,43129680,QUINAPRIL EG,Has brand name
1331235,quinapril,43575129,Quinaplus Stada,Has brand name
1331235,quinapril,36213872,quinapril Oral Product,RxNorm ing of
1331235,quinapril,43252119,Acquin,Has brand name
1331235,quinapril,19013171,Accupril,Has brand name
1331235,quinapril,43129683,QUINAPRIL TEVA,Has brand name
1331235,quinapril,44019595,Pms-Quinapril,Has brand name
1331235,quinapril,40815578,Quinapril Stada,Has brand name
1331235,quinapril,40815574,Quinapril Beta,Has brand name
1331235,quinapril,43129684,QUINAPRIL ZENTIVA,Has brand name
4299839,Quinapril,1331235,quinapril,Maps to
4299839,Quinapril,1331235,quinapril,SNOMED - RxNorm eq
43253848,Qpril,1331235,quinapril,Brand name of
19020260,Accuretic,1331235,quinapril,Brand name of
19013468,Accupro,1331235,quinapril,Brand name of
43129685,QUINAPRIL/HYDROCHLOROTHIAZIDE ARROW,1331235,quinapril,Brand name of
44013795,Apo-Quinapril/Hctz,1331235,quinapril,Brand name of
43563561,Accuzide,1331235,quinapril,Brand name of
43127026,ACUILIX,1331235,quinapril,Brand name of
44014962,Gd-Quinapril,1331235,quinapril,Brand name of
43129681,QUINAPRIL HYDROCHLOROTHIAZIDE E,1331235,quinapril,Brand name of
43575130,Quinapril Al,1331235,quinapril,Brand name of
43129678,QUINAPRIL ARROW,1331235,quinapril,Brand name of
40815518,Quinalich,1331235,quinapril,Brand name of
40799391,Accupron,1331235,quinapril,Brand name of
40799538,Acuretic,1331235,quinapril,Brand name of
43129687,QUINAPRIL/HYDROCHLOROTHIAZIDE TEVA,1331235,quinapril,Brand name of
40815576,Quinapril Ct,1331235,quinapril,Brand name of
43129680,QUINAPRIL EG,1331235,quinapril,Brand name of
43575129,Quinaplus Stada,1331235,quinapril,Brand name of
36213872,quinapril Oral Product,1331235,quinapril,RxNorm has ing
4348756,quinapril,1331235,quinapril,NDFRT - RxNorm eq
19111733,quinapril 1 MG/ML,1331235,quinapril,RxNorm has ing
1331264,quinapril 10 MG,1331235,quinapril,RxNorm has ing
40098149,quinapril Injectable Solution,1331235,quinapril,RxNorm has ing
19055338,Quinapril hydrochloride,1331235,quinapril,Form of
36218316,Hydrochlorothiazide / quinapril Oral Product,1331235,quinapril,RxNorm has ing
36218317,Hydrochlorothiazide / quinapril Pill,1331235,quinapril,RxNorm has ing
4029080,Quinapril,1331235,quinapril,SNOMED - RxNorm eq
4029080,Quinapril,1331235,quinapril,Maps to
1331267,quinapril 5 MG,1331235,quinapril,RxNorm has ing
40098150,quinapril Oral Tablet,1331235,quinapril,RxNorm has ing
40045124,Hydrochlorothiazide / quinapril Oral Tablet,1331235,quinapril,RxNorm has ing
43157075,Hydrochlorothiazide / quinapril Delayed Release Oral Tablet,1331235,quinapril,RxNorm has ing
4293356,QUINAPRIL,1331235,quinapril,NDFRT - RxNorm eq
43252269,Aquinafil,1331235,quinapril,Brand name of
43253044,Filpril,1331235,quinapril,Brand name of
43128000,KOREC,1331235,quinapril,Brand name of
43129686,QUINAPRIL/HYDROCHLOROTHIAZIDE MYLAN,1331235,quinapril,Brand name of
44013794,Apo-Quinapril,1331235,quinapril,Brand name of
43575131,Quinapril Hexal Comp,1331235,quinapril,Brand name of
40815577,Quinapril Heumann,1331235,quinapril,Brand name of
19113325,Quinaretic,1331235,
Query:
SELECT DISTINCT "person_id"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
    LIMIT 1000;
Answer:
Too long, hard cut:
person_id
181389
2277595
1966193
343643
1549423
639750
1225719
749959
638151
1418302
1867190
1189463
65081
61851
1247227
1271984
1818037
1653185
685445
823389
1900299
1713797
575686
911640
724141
369357
146333
1240652
1929635
1229140
831702
1529796
2242108
883004
1544116
896073
2076725
1132187
735605
1986707
227369
2908
39193
1156771
1551457
444535
1344091
116105
2213789
881228
1338673
248279
1719575
1414616
1629657
752264
746751
555696
1888423
831489
815061
2114508
33465
1235619
1952912
957461
1554774
2049721
100613
423177
1437041
1376649
1656295
1170689
2144588
1991450
1164333
271736
1996996
971923
1630986
93269
469891
1134758
30035
1423416
711118
287126
1212352
125099
2190899
1347359
2131017
1324230
14611
1566487
244869
1652497
1114126
812630
1580748
1799390
21037
1008302
521051
496013
184742
1035011
1017623
1638523
804344
1839577
595001
662613
2290796
2246205
1351140
1342649
1316255
1117603
2279348
1039493
1773115
1009346
1617831
749572
186618
1744557
2272714
2240492
175267
1222414
1371980
1160039
1237129
318390
383817
569030
1192344
1562241
1454996
1210314
1605920
2131518
663724
2181944
1012119
817240
751441
2114205
1021128
2323302
597099
1303664
1742269
597080
802580
5031
749234
1488491
1757897
1405173
1467493
857037
678605
212360
2187425
1517864
841585
1265116
1888586
1337942
294784
1056543
221879
489439
1300700
1465629
1813026
77358
1193658
1474870
2018107
1384568
426100
1429798
958235
767294
673133
837201
818282
679942
1063325
1299842
1816951
167203
748997
1743115
306188
33541
339941
168462
563781
1447990
1503881
2162585
916805
1636429
822126
1404956
1383265
808899
483066
1848551
300667
2302155
1709933
1511717
608028
90336
1080058
1522029
1590578
1066215
1809914
1048961
564697
1065780
2298627
1138550
1896135
202267
1130171
1604949
230152
1053577
2094015
1383891
1038790
805934
909134
2077964
1867355
1528660
1177426
1904124
1447742
727276
402813
2184905
1436924
765944
9663
2271883
1464223
1862085
1592844
523273
65709
1933950
1793546
1236087
121214
47735
350389
1688673
1353843
1403218
502093
1048977
201366
972757
2137352
10765
60369
1038951
1641687
690610
1813853
1215058
125203
931197
825713
902140
1702634
54498
1751360
664208
1447286
2305521
1529252
170532
726991
1341402
103791
358806
1588211
2286254
1876065
1114961
1841771
1206855
1969413
863571
692935
833157
193897
592679
910565
1023335
1643381
21058
2043517
1383984
170721
631787
1141891
356367
1928126
2320165
666820
1670558
1736409
317668
2302519
1405969
650340
1056882
251695
1095061
1768406
623724
1017897
1820730
1622765
1582970
105046
2231401
1396328
103318
980915
997502
255477
1364778
691357
1951176
289047
1898344
1562186
2269385
2228798
502660
2011762
178017
1235659
1813480
1050234
2318876
1797770
1072057
1160358
1515650
2320990
130745
898848
2052832
661056
904094
697649
1734025
1619288
1204233
1455825
1844827
1470126
575531
945425
1362532
1515141
198195
1528227
1968798
342638
154020
893509
940878
2119901
1447191
737444
722201
1816025
121114
1314566
439656
118622
604955
120260
1799205
1968788
2142179
909726
1453809
87781
2263811
1035876
1320269
170026
1505262
1092414
1086358
1386910
36554
739506
1603220
1845286
725998
1951912
1918776
1293172
1670546
628001
553272
1501976
323628
1406223
400559
1491690
1377294
1924848
671566
2017155
435273
581111
1871023
1714825
271641
1384272
1279679
1126939
1485380
950121
1102337
2032713
2183776
1501295
276082
1221641
172921
483116
1659427
184771
181137
675142
1363049
252946
183696
308435
1183008
1025810
862847
958841
2179529
1944883
1874214
35881
2001979
836635
1355848
1618335
2024928
2030396
1754355
1589390
333709
458157
1809443
1054094
1143927
460698
609493
538060
1082492
70509
1982882
156642
1997874
399422
1547218
548572
1642152
780863
2133275
1535296
305627
1565899
2129983
973782
288881
57561
1113235
1264877
191478
122984
1986000
1873266
1467737
1380562
1296282
1531259
575565
1557671
1864963
181466
1331187
1559836
530108
1529061
1785928
1417996
935359
964314
1650935
477890
758487
1428271
201904
169835
1258263
1268874
1280208
2049089
771554
853475
722188
2190746
618950
308942
429801
410699
636301
2108447
1356301
1981803
2125903
1318816
2114931
1235867
903890
2285886
379371
1223819
1207160
831092
1686262
2090810
1527264
1852296
1399649
2140644
2312250
1290162
1725240
870810
1207426
1687383
1032892
192958
753165
61737
1130239
1803765
779059
1838719
1546542
344245
44672
2271697
1147027
1529842
2212739
346590
1210693
295028
1724977
967222
1191673
1036683
598493
639005
1395186
312343
718387
1966451
2282085
1963877
1384403
1280337
1811265
2004834
1760687
1297859
183531
1222682
611159
1998356
208162
393884
57844
2194535
2116677
494581
2206758
1389357
1202927
2278803
510275
1631034
1170049
35570
1785967
1223477
475579
1706015
1509251
1492552
658297
1867091
148210
757608
2246815
629824
1591372
1988831
1366492
1649303
2283923
2076856
1151114
970609
819331
203952
1553448
86991
1902712
834505
1854640
1618723
1639192
1408863
127746
1994464
380806
1479237
1701394
1313864
678155
724453
1346561
1290519
1649124
356506
1744
Query:
SELECT "drug_concept_id", COUNT(*) AS "exposure_count"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
    GROUP BY "drug_concept_id"
    ORDER BY "exposure_count" DESC
    LIMIT 1000;
Answer:
Too long, hard cut:
drug_concept_id,exposure_count
0,3295638
1301125,2756239
2213440,1542698
40098312,1497787
19025280,1225686
19077577,747326
19019418,719275
19019116,638625
1539407,588322
1539411,545702
19019117,541327
957136,499574
40164929,487835
19019044,478711
19077682,464436
40032317,460918
40080069,457202
19076600,446726
19078106,442067
1539463,437291
19019115,425602
1331312,418296
19077546,417263
19076623,400316
19077636,399994
19080129,385924
19080128,384819
1314008,381661
40164897,380970
1309010,378202
964362,369520
40167218,350785
1518606,350555
1308251,337154
708298,333760
19018937,328641
40163342,307048
19077638,306989
1154186,303724
40164946,300813
1000560,299623
40163312,294299
1308221,292767
903963,291657
1332419,287919
40175400,284395
19079658,273928
1129105,268156
40163333,265331
19073093,264214
40175395,263750
1539462,262093
40162494,262087
1340161,261624
40221904,257904
19077659,253619
19019309,246149
1237261,244624
1545997,243673
19123592,243280
40169766,243209
19018811,241743
19018935,241354
40166448,239120
1506270,237392
1594976,236016
40165762,234206
956877,230396
40167202,228133
19075380,225137
40165773,225056
40163361,224897
40165789,223186
929889,221284
1545996,219437
19018850,217155
19077375,216300
1314006,211144
19020053,210655
19018787,208526
1237231,207531
40171852,204500
2213483,204436
1367571,202139
19078166,200689
19019331,200266
19096678,197042
19077463,196639
19074673,195194
1836434,191847
42901480,190649
40171917,186573
1707346,184524
1304643,183714
19080217,182217
19080187,180538
1167323,180482
19073187,180481
40162717,179817
1551838,179456
974226,179050
19025488,176384
961050,175351
40163554,174440
19075601,171803
40163473,170967
40167021,170263
1312743,168633
19074672,167291
739207,166344
19134047,165004
19049684,163773
19100691,163224
40163286,160038
19075394,158502
40175050,157334
40169770,156338
19019332,156319
19078140,156172
745372,154878
19023636,154702
40162672,152754
40162729,152051
1502856,151628
19123105,151447
19095325,149506
1502811,149407
904547,149258
19133622,149209
1363059,148499
40175210,147702
1351583,146926
19074977,146628
1594975,146185
1395073,145575
1154349,145353
907020,145264
19023551,145019
42799606,144897
749932,140544
2213438,139389
1341270,138528
1136980,137820
19022486,136301
40163924,135490
778765,134622
46287340,133594
1154350,132251
19018781,132148
19019310,132090
739209,129872
19019073,128787
1501500,127338
40163524,127080
19046742,126460
967434,125060
19078461,124714
19018875,123774
43011909,123308
40082914,123071
40163460,122891
19077462,122408
40175001,121294
19133570,120577
19079776,119745
19077548,119520
40171884,118781
40162552,118689
1797515,118640
19019074,118401
40169689,118080
19133768,117856
1127433,117537
40165767,117521
19033627,116842
40222796,116368
1350521,115335
40169683,113982
40175174,112831
1504672,112698
40173591,112546
19133566,110965
40174947,110704
1237116,110635
40221913,110592
1134771,109868
19022749,109379
19079524,108600
40162658,108571
19019072,108435
19067686,107096
40169889,106950
19018978,106265
19077344,106001
40185305,105960
964369,105261
40162704,104971
40174888,104622
19079773,104042
1308250,103860
19077684,103563
19022750,103167
704945,103010
40169775,102888
40168654,102839
974200,102494
19113528,102289
721760,102202
1101556,101369
19110450,101234
40171661,101208
19022781,101185
1551101,101015
1551192,100928
19049335,100808
40163510,100697
902429,99981
40171671,99975
19031629,99870
19123989,98870
787787,97811
40162737,97230
1597772,97209
1350552,97123
992612,97009
40163546,96820
978557,96762
1363058,96445
970283,96080
723042,95896
1551170,95863
40162570,95699
19019238,95549
40162711,95523
40174880,95494
19019273,94905
1328689,94897
40162465,94846
40175182,94747
40162511,93925
19018874,93694
19073094,93479
40163534,93453
920458,93449
19074671,93045
1105837,92609
1334459,92494
19077547,92490
40224897,92295
1559685,92263
1501311,91920
1395060,91732
19079497,91518
906891,91262
40176723,91134
1545998,91027
40176744,90630
19019113,90555
40224903,90358
19133614,89729
19019412,89257
961082,88522
40165246,88489
1341268,87816
725178,87453
905275,87125
1597773,87089
40165254,86229
704944,86170
798875,86091
1502812,85760
1347386,85456
1308876,84888
40168664,84877
40224320,84752
40163464,84505
1334494,84488
19079730,84144
40173129,83951
40224352,83909
40175215,83366
1341302,83334
778479,83277
1153702,83089
40167213,83027
19077653,82795
19073183,82748
778299,82464
19073071,82282
40222060,82122
734356,81786
40163760,81652
798876,81590
19074697,81565
19049375,81561
40175401,81517
1113076,80667
40162875,80666
40222779,79998
40242777,79408
1151423,79331
1331241,79190
19077241,79099
40171863,78598
40162683,78525
40173997,78328
46275982,77997
40166831,77894
1525221,77847
1350490,77667
40162864,77589
19075034,77456
40180065,77413
40163350,77359
1154654,77286
1118047,77235
1501496,77050
1308877,77019
40175391,77007
40180087,76670
1545999,76586
40162665,75957
1363060,75555
40224875,75434
40166825,75014
700325,74858
40164930,74689
723020,743
Query:
SELECT DISTINCT "concept_id", "concept_name", "concept_code"
    FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT"
    WHERE "concept_class_id" = 'Clinical Drug'
    LIMIT 1000;
Answer:
Too long, hard cut:
concept_id,concept_name,concept_code
19072238,Acetaminophen 81 MG / Phenylephrine 1.25 MG Chewable Tablet,307697
19071331,Naproxen 200 MG / Pseudoephedrine 120 MG Extended Release Tablet,284166
40026482,Chondroitin Sulfates 400 MG / Glucosamine Sulfate 500 MG Oral Tablet,200201
40089993,Undecylenic Acid 100 MG/ML Topical Spray,200291
40013601,Aspirin 325 MG / Phenylpropanolamine 20 MG Oral Solution,241972
40053512,Interferon Alfa-2b 3 MMU Injectable Solution,239988
40126750,Methylcellulose 0.3 MG/MG Powder,577363
40043446,Homeopathic Remedies 450 MG Oral Capsule,198698
966464,Allantoin 0.015 MG/MG / pramoxine 0.01 MG/MG Topical Ointment,616948
19086406,conivaptan 0.2 MG/ML Injectable Solution,847289
40237941,Sodium Bicarbonate 15 MG/ML / tartaric acid 13.6 MG/ML Oral Solution,1098595
19125248,Hydrocortisone 10 MG/ML / pramoxine 10 MG/ML Topical Spray,670098
1130301,Acetaminophen 650 MG / Diphenhydramine 50 MG Oral Powder,247297
40231657,potassium bicarbonate 78 MG/ML / Sodium Bicarbonate 780 MG/ML / sodium citrate 16 MG/ML Oral Solution,1042860
40171532,Acetaminophen 325 MG / Chlorpheniramine 2 MG / Dextromethorphan 10 MG / Phenylephrine 5 MG Oral Capsule,901270
19123751,linoleate 50 MG/ML Injectable Solution,618479
40241565,Acetaminophen 325 MG / Caffeine 50 MG / phenyltoloxamine 20 MG / salicylamide 250 MG Oral Capsule,1147784
1121644,Dextromethorphan 2 MG/ML / Guaifenesin 40 MG/ML / Phenylephrine 1 MG/ML Oral Solution,692625
1790882,Chlorhexidine 0.01 MG/MG Topical Ointment,251944
1120266,Dextromethorphan 5 MG/ML / Guaifenesin 50 MG/ML / Phenylephrine 2.5 MG/ML Oral Solution,242617
42873552,"Hyoscyamine 0.12 MG / Methenamine 120 MG / Methylene blue 10.8 MG / phenyl salicylate 36.2 MG / Sodium Phosphate, Monobasic 40.8 MG Oral Tablet",1302479
40134058,Methylphenidate 3.33 MG/HR Transdermal Patch,636258
40072246,Penicillin G 40000 UNT/ML Injectable Solution,312265
19129009,Hydrocodone 0.5 MG/ML / Phenylpropanolamine 2.5 MG/ML Oral Solution,756101
19129013,Hydrocodone 1 MG/ML / Phenylpropanolamine 5 MG/ML Oral Solution,756105
902520,brimonidine 2 MG/ML / Timolol 5 MG/ML Ophthalmic Solution,597144
19003511,Chenodeoxycholic Acid 125 MG / Ursodeoxycholic Acid 125 MG Oral Tablet,104194
19102515,Metformin 1000 MG / rosiglitazone 4 MG Oral Tablet,403916
934178,Guaifenesin 20 MG/ML / Hydrocodone 0.34 MG/ML / Pheniramine 1.26 MG/ML / Phenylpropanolamine 2.5 MG/ML / Pyrilamine 1.26 MG/ML Oral Solution,755778
40126389,Hyaluronic Acid 0.002 MG/MG Topical Gel,584646
40045403,"HEPARIN, PORK 25000 UNT/ML Injectable Solution",244234
19076020,Cyclopentolate 10 MG/ML Ophthalmic Solution,309620
40091964,alemtuzumab 30 MG/ML Injectable Solution,485516
40118710,Nitroglycerin 0.3 MG Oral Tablet,541847
19003739,Amiloride 2.5 MG / Hydrochlorothiazide 25 MG / Timolol 10 MG Oral Tablet,104341
794955,Chlorpromazine 100 MG Enteric Coated Tablet,484479
19058718,Atropine 0.2 MG/ML / Chlorpheniramine 5 MG/ML Injectable Solution,242980
40055122,histamine phosphate 2.75 MG/ML Topical Solution,199077
40045707,HISTAMINE HYDROCHLORIDE 6 MG/ML Injectable Solution,348780
40033801,Dextromethorphan 30 MG / Phenylephrine 15 MG / Potassium guaiacol sulfonate 600 MG 12 hour Extended Release Tablet,359913
989897,Lidocaine 40 MG/ML Mucous Membrane Topical Solution,197875
40151348,Acetic Acid 0.05 MEQ/ML / Alanine 4.48 MG/ML / Arginine 3.43 MG/ML / Glycine 4.48 MG/ML / Histidine 1.05 MG/ML / Isoleucine 2.52 MG/ML / Leucine 3.29 MG/ML / Lysine 2.52 MG/ML / Methionine 1.40 MG/ML / Phenylalanine 1.54 MG/ML / Proline 3 MG/ML / Serine,799968
40131650,linoleate 365 MG / Linolenate 45 MG Oral Capsule,618419
40001682,"ALLERGENIC EXTRACT,POLLEN 20000 UNT Injectable Solution",347175
40045540,Glucose 5000 MG / Potassium Chloride 74.5 MG / Sodium Chloride 225 MG Injectable Solution,346698
19095093,Metoprolol 100 MG Extended Release Tablet,343003
40100164,piperazine 2000 MG Oral Solution,245833
1130329,Diphenhydramine 10 MG/ML / Pyrilamine 10 MG/ML Topical Cream,249913
1196699,formoterol 0.01 MG/ML Inhalant Solution,728211
19105403,Dihydroergotamine 1.5 MG / propyphenazone 375 MG Rectal Suppository,420626
1315345,Flaxseed extract 500 MG / Vitamin E 5 UNT Oral Capsule,241976
40086968,"Tetanus immune globulin, human 250 UNT Injectable Solution",315226
40072221,Penicillin G 30000 UNT/ML Injectable Solution,312262
42903012,Factor VIII 750 UNT/ML Prefilled Syringe,1360125
19127218,2 ML Fluphenazine 25 MG/ML Prefilled Syringe,727839
1318282,Nicardipine 45 MG 12 hour Extended Release Capsule,637198
1165936,Guaifenesin 20 MG/ML / Hydrocodone 0.5 MG/ML / Phenylephrine 1 MG/ML Oral Solution,672575
1738789,Doxycycline 10 MG/ML Oral Solution,755733
757639,Galantamine 8 MG 24 Hour Extended Release Capsule,485793
40004952,Acetylcarnitine 250 MG Oral Capsule,476314
40006886,Albuterol 0.83 MG/ML Inhalant Solution,307780
40065899,Mold Extract 10 MU/ML Injectable Solution,239303
40026655,Cortisone 25 MG/ML Injectable Solution,309543
40005410,Acetaminophen 500 MG Oral Tablet,485168

End Exploring Related Columns
Task: Please tell me the percentage of participants not using quinapril and related medications(Quinapril RxCUI: 35208).

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: SELECT S."Column_Name" FROM {Database Name}.{Schema Name}.{Table_name} (ensure all column names are enclosed in double quotations)
Follow the answer format like: To determine the percentage of participants not using quinapril and related medications (Quinapril RxCUI: 35208), we consider all participants and identify those who are not using quinapril or its related medications.

```csv
Percentage_not_using_quinapril_and_related_medications
percentage_value: float between 0 and 100
```.
Here are some useful tips for answering:
When calculating distances between two geometries, use `ST_MakePoint(x, y)` to make a point and `ST_Distance(geometry1 GEOMETRY, geometry2 GEOMETRY)` to compute. No need to convert from meters to miles unless requested. Don't use Haversine like 2 * 6371000 * ASIN(...), use ST_DISTANCE for more precise results.
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'CMS_DATA': {'CMS_CODES': ['HCPCS', 'ICD10_DIAGNOSES_2019', 'ICD10_PROCEDURES_2019', 'ICD9_DIAGNOSES', 'ICD9_PROCEDURES'], 'CMS_MEDICARE': ['HOME_HEALTH_AGENCIES_2013', 'HOME_HEALTH_AGENCIES_2014', 'HOSPICE_PROVIDERS_2014', 'HOSPITAL_GENERAL_INFO', 'INPATIENT_CHARGES_2011', 'INPATIENT_CHARGES_2012', 'INPATIENT_CHARGES_2013', 'INPATIENT_CHARGES_2014', 'INPATIENT_CHARGES_2015', 'NURSING_FACILITIES_2013', 'NURSING_FACILITIES_2014', 'OUTPATIENT_CHARGES_2011', 'OUTPATIENT_CHARGES_2012', 'OUTPATIENT_CHARGES_2013', 'OUTPATIENT_CHARGES_2014', 'OUTPATIENT_CHARGES_2015', 'PART_D_PRESCRIBER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2012', 'PHYSICIANS_AND_OTHER_SUPPLIER_2013', 'PHYSICIANS_AND_OTHER_SUPPLIER_2014', 'PHYSICIANS_AND_OTHER_SUPPLIER_2015', 'REFERRING_DURABLE_MEDICAL_EQUIP_2013', 'REFERRING_DURABLE_MEDICAL_EQUIP_2014'], 'CMS_SYNTHETIC_PATIENT_DATA_OMOP': ['CARE_SITE', 'CONCEPT', 'CONCEPT_ANCESTOR', 'CONCEPT_CLASS', 'CONCEPT_RELATIONSHIP', 'CONDITION_ERA', 'CONDITION_OCCURRENCE', 'COST', 'DEATH', 'DEVICE_EXPOSURE', 'DOMAIN', 'DOSE_ERA', 'DRUG_ERA', 'DRUG_EXPOSURE', 'DRUG_STRENGTH', 'LOCATION', 'OBSERVATION', 'OBSERVATION_PERIOD', 'PAYER_PLAN_PERIOD', 'PERSON', 'PROCEDURE_OCCURRENCE', 'PROVIDER', 'RELATIONSHIP', 'VOCABULARY']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'
When handling TO_TIMESTAMP_NTZ conversions, use query like: SELECT CASE WHEN "date" >= 1e15 THEN TO_TIMESTAMP_NTZ("date" / 1000000) WHEN "date" >= 1e12 THEN TO_TIMESTAMP_NTZ("date" / 1000) ELSE TO_TIMESTAMP_NTZ("date") END AS parsed_timestamp FROM my_table;
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
Keep all decimals to four decimal places.

2025-01-16 22:04:03 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 22:04:03 - root - INFO - ```sql
SELECT
    100.0 * (
        (total.total_participants - users.users_of_quinapril_related_medications) 
        / total.total_participants
    ) AS "Percentage_not_using_quinapril_and_related_medications"
FROM
    (
        SELECT COUNT(DISTINCT "person_id") AS total_participants
        FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON"
    ) total,
    (
        SELECT COUNT(DISTINCT "person_id") AS users_of_quinapril_related_medications
        FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
        WHERE "drug_concept_id" IN (
            SELECT DISTINCT "descendant_concept_id"
            FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT_ANCESTOR"
            WHERE "ancestor_concept_id" = 1331235
        )
    ) users;
```
2025-01-16 22:04:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 22:04:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 22:04:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 22:04:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-16 22:04:04 - snowflake.connector.connection - INFO - closed
2025-01-16 22:04:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 22:04:04 - root - INFO - itercount: 1
2025-01-16 22:04:04 - root - INFO - 0
2025-01-16 22:04:04 - root - INFO - results: 
Percentage_not_using_quinapril_and_related_medications
90.120700


2025-01-16 22:04:04 - root - INFO - Please check the answer again by reviewing Please tell me the percentage of participants not using quinapril and related medications(Quinapril RxCUI: 35208)., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To determine the percentage of participants not using quinapril and related medications (Quinapril RxCUI: 35208), we consider all participants and identify those who are not using quinapril or its related medications.

```csv
Percentage_not_using_quinapril_and_related_medications
percentage_value: float between 0 and 100
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Percentage_not_using_quinapril_and_related_medications
90.120700
Current sql:
SELECT
    100.0 * (
        (total.total_participants - users.users_of_quinapril_related_medications) 
        / total.total_participants
    ) AS "Percentage_not_using_quinapril_and_related_medications"
FROM
    (
        SELECT COUNT(DISTINCT "person_id") AS total_participants
        FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON"
    ) total,
    (
        SELECT COUNT(DISTINCT "person_id") AS users_of_quinapril_related_medications
        FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
        WHERE "drug_concept_id" IN (
            SELECT DISTINCT "descendant_concept_id"
            FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT_ANCESTOR"
            WHERE "ancestor_concept_id" = 1331235
        )
    ) users;
2025-01-16 22:04:41 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-16 22:04:41 - root - INFO - To determine the percentage of participants not using quinapril and related medications (Quinapril RxCUI: 35208), we consider all participants and identify those who are not using quinapril or its related medications.

```csv
Percentage_not_using_quinapril_and_related_medications
90.1207
```

```sql
SELECT
    ROUND(
        100.0 * (
            (total.total_participants - users.users_of_quinapril_related_medications) 
            / total.total_participants
        ),
        4
    ) AS "Percentage_not_using_quinapril_and_related_medications"
FROM
    (
        SELECT COUNT(DISTINCT "person_id") AS total_participants
        FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."PERSON"
    ) total,
    (
        SELECT COUNT(DISTINCT "person_id") AS users_of_quinapril_related_medications
        FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."DRUG_EXPOSURE"
        WHERE "drug_concept_id" IN (
            SELECT DISTINCT "descendant_concept_id"
            FROM "CMS_DATA"."CMS_SYNTHETIC_PATIENT_DATA_OMOP"."CONCEPT_ANCESTOR"
            WHERE "ancestor_concept_id" = 1331235
        )
    ) users;
```
2025-01-16 22:04:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-16 22:04:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-16 22:04:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-16 22:04:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-16 22:04:42 - snowflake.connector.connection - INFO - closed
2025-01-16 22:04:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-16 22:04:43 - root - INFO - itercount: 2
2025-01-16 22:04:43 - root - INFO - 0
2025-01-16 22:04:43 - root - INFO - Total iteration counts: 2
