2025-01-17 20:08:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:09:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:09:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:09:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:09:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:09:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 23
2025-01-17 20:09:57 - snowflake.connector.connection - INFO - closed
2025-01-17 20:09:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:09:58 - root - INFO - SQL:
-- 1. List distinct modalities in the DICOM_ALL table
SELECT DISTINCT "Modality"
FROM IDC.IDC_V17.DICOM_ALL
LIMIT 1000;
Results:
Modality
RTPLAN
PR
RTDOSE
M3D
DX
FUSION
MG
SR
RWV
NM
RTSTRUCT
CR
US
OT
XA
CT
REG
SC
SM
XC
MR
PT
SEG

2025-01-17 20:09:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:09:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:09:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:10:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-17 20:10:00 - snowflake.connector.connection - INFO - closed
2025-01-17 20:10:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:10:00 - root - INFO - SQL:
-- 2. Count the number of instances where Modality is 'SM'
SELECT COUNT(*) AS "SM_Modality_Count"
FROM IDC.IDC_V17.DICOM_ALL
WHERE "Modality" = 'SM';
Results:
SM_Modality_Count
8512

2025-01-17 20:10:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:10:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:10:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:10:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-17 20:10:02 - snowflake.connector.connection - INFO - closed
2025-01-17 20:10:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:10:03 - root - INFO - SQL:
-- 3. Select distinct SOPInstanceUIDs where Modality is 'SM'
SELECT DISTINCT "SOPInstanceUID"
FROM IDC.IDC_V17.DICOM_ALL
WHERE "Modality" = 'SM'
LIMIT 1000;
Results:
Too long, hard cut:
SOPInstanceUID
1.3.6.1.4.1.5962.99.1.288502917.435733701.1640966042757.14.0
1.3.6.1.4.1.5962.99.1.1429222978.920933212.1637811795522.15.0
1.3.6.1.4.1.5962.99.1.1823031872.289054648.1638205604416.36.0
1.3.6.1.4.1.5962.99.1.1561375760.417860699.1637943948304.36.0
1.3.6.1.4.1.5962.99.1.1828604770.69343606.1638211177314.22.0
1.3.6.1.4.1.5962.99.1.255325960.1276718182.1640932865800.28.0
1.3.6.1.4.1.5962.99.1.1877838119.1948234345.1638260410663.29.0
1.3.6.1.4.1.5962.99.1.1999877904.570862717.1655562319632.479.0
1.3.6.1.4.1.5962.99.1.1100612088.1220290507.1637483184632.29.0
1.3.6.1.4.1.5962.99.1.1300570035.309218492.1637683142579.36.0
1.3.6.1.4.1.5962.99.1.1451596735.1129566628.1637834169279.8.0
1.3.6.1.4.1.5962.99.1.2098928367.300930011.1638481500911.22.0
1.3.6.1.4.1.5962.99.1.1075540375.93664924.1637458112919.29.0
1.3.6.1.4.1.5962.99.1.2033235271.1897531689.1638415807815.8.0
1.3.6.1.4.1.5962.99.1.293351711.95000986.1640970891551.35.0
1.3.6.1.4.1.5962.99.1.2001352215.222014479.1655563793943.346.0
1.3.6.1.4.1.5962.99.1.2005676518.178837978.1638388249062.36.0
1.3.6.1.4.1.5962.99.1.251476781.1015172444.1640929016621.14.0
1.3.6.1.4.1.5962.99.1.1631531608.353996804.1638014104152.36.0
1.3.6.1.4.1.5962.99.1.1909716652.987650816.1638292289196.22.0
1.3.6.1.4.1.5962.99.1.3061424162.933099148.1639443996706.15.0
1.3.6.1.4.1.5962.99.1.1235720605.1448919340.1637618293149.29.0
1.3.6.1.4.1.5962.99.1.2204308995.1136610178.1655766750723.37.0
1.3.6.1.4.1.5962.99.1.2358547573.1319252942.1655920989301.1326.0
1.3.6.1.4.1.5962.99.1.2004905765.1709848768.1638387478309.8.0
1.3.6.1.4.1.5962.99.1.252115199.1463077838.1640929655039.14.0
1.3.6.1.4.1.5962.99.1.272850553.1839714480.1640950390393.14.0
1.3.6.1.4.1.5962.99.1.3911376849.1201197034.1687538589649.30.0
1.3.6.1.4.1.5962.99.1.3458122692.1084633459.1639840695236.36.0
1.3.6.1.4.1.5962.99.1.294962783.1096614356.1640972502623.21.0
1.3.6.1.4.1.5962.99.1.1350385546.875081525.1637732958090.15.0
1.3.6.1.4.1.5962.99.1.2198863952.1145103584.1655761305680.44.0
1.3.6.1.4.1.5962.99.1.1459976677.1442651228.1637842549221.15.0
1.3.6.1.4.1.5962.99.1.1267210173.280579398.1637649782717.8.0
1.3.6.1.4.1.5962.99.1.124998202.2129488500.1640802538042.28.0
1.3.6.1.4.1.5962.99.1.1833547434.197627960.1638216119978.8.0
1.3.6.1.4.1.5962.99.1.256082067.529589996.1640933621907.21.0
1.3.6.1.4.1.5962.99.1.2137283551.627273463.1638519856095.8.0
1.3.6.1.4.1.5962.99.1.3022497032.1736082188.1639405069576.8.0
1.3.6.1.4.1.5962.99.1.1322893234.769468910.1637705465778.22.0
1.3.6.1.4.1.5962.99.1.3660062119.450198422.1640042634663.15.0
1.3.6.1.4.1.5962.99.1.1481315148.2127257417.1637863887692.22.0
1.3.6.1.4.1.5962.99.1.487549708.1025029709.1641165089548.35.0
1.3.6.1.4.1.5962.99.1.2107044430.169416486.1638489616974.8.0
1.3.6.1.4.1.5962.99.1.2354479345.898820832.1655916921073.941.0
1.3.6.1.4.1.5962.99.1.2202494792.302947620.1655764936520.37.0
1.3.6.1.4.1.5962.99.1.228217509.165497107.1640905757349.14.0
1.3.6.1.4.1.5962.99.1.2395853585.1034553989.1686023066385.16.0
1.3.6.1.4.1.5962.99.1.3099185692.848972114.1639481758236.22.0
1.3.6.1.4.1.5962.99.1.3655371307.1304141063.1640037943851.22.0
1.3.6.1.4.1.5962.99.1.3025352208.477704041.1639407924752.29.0
1.3.6.1.4.1.5962.99.1.1877301006.647042380.1638259873550.15.0
1.3.6.1.4.1.5962.99.1.288981992.1793344149.1640966521832.21.0
1.3.6.1.4.1.5962.99.1.273570084.1306102505.1640951109924.14.0
1.3.6.1.4.1.5962.99.1.2140289611.596105917.1655702731339.44.0
1.3.6.1.4.1.5962.99.1.1223242279.173503740.1637605814823.15.0
1.3.6.1.4.1.5962.99.1.1671973406.1746147156.1638054545950.8.0
1.3.6.1.4.1.5962.99.1.2271635652.2044023739.1638654208196.29.0
1.3.6.1.4.1.5962.99.1.1365696247.2017412565.1637748268791.22.0
1.3.6.1.4.1.5962.99.1.1588653069.665412881.1637971225613.22.0
1.3.6.1.4.1.5962.99.1.1042806844.973369406.1637425379388.36.0
1.3.6.1.4.1.5962.99.1.239161282.1298032537.1640916701122.28.0
1.3.6.1.4.1.5962.99.1.2090391183.193375910.1638472963727.36.0
1.3.6.1.4.1.5962.99.1.257012593.705706238.1640934552433.21.0
1.3.6.1.4.1.5962.99.1.1102420566.1825806482.1637484993110.8.0
1.3.6.1.4.1.5962.99.1.3032933152.1699425996.1639415505696.8.0
1.3.6.1.4.1.5962.99.1.3407100213.400206568.1639789672757.15.0
1.3.6.1.4.1.5962.99.1.1491017924.432079602.1637873590468.36.0
1.3.6.1.4.1.5962.99.1.1419641095.759723268.1637802213639.29.0
1.3.6.1.4.1.5962.99.1.200274034.46406646.1640877813874.14.0
1.3.6.1.4.1.5962.99.1.3016813181.144689614.1639399385725.29.0
1.3.6.1.4.1.5962.99.1.1134629870.1737744298.1637517202414.36.0
1.3.6.1.4.1.5962.99.1.2876075559.1762242618.1639258648103.36.0
1.3.6.1.4.1.5962.99.1.2044307168.1358874540.1638426879712.8.0
1.3.6.1.4.1.5962.99.1.3458166009.108465870.1639840738553.8.0
1.3.6.1.4.1.5962.99.1.2341019412.21033900.1638723591956.36.0
1.3.6.1.4.1.5962.99.1.219000382.1281575540.1640896540222.7.0
1.3.6.1.4.1.5962.99.1.2860007431.1389616193.1639242579975.8.0
1.3.6.1.4.1.5962.99.1.2321044444.1228939709.1638703616988.29.0
1.3.6.1.4.1.5962.99.1.1954045878.82393848.1638336618422.8.0
1.3.6.1.4.1.5962.99.1.

2025-01-17 20:10:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:10:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:10:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:10:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-17 20:10:06 - snowflake.connector.connection - INFO - closed
2025-01-17 20:10:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:10:07 - root - INFO - SQL:
-- 4. Explore SpecimenDescriptionSequence in SM modality images
SELECT t."SOPInstanceUID", f.value AS "SpecimenDescriptionSequence"
FROM IDC.IDC_V17.DICOM_ALL t,
LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") f
WHERE t."Modality" = 'SM'
LIMIT 1000;
Results:
Too long, hard cut:
SOPInstanceUID,SpecimenDescriptionSequence
1.3.6.1.4.1.5962.99.1.491513722.777873477.1641169053562.42.0,"{
  ""PrimaryAnatomicStructureSequence"": [
    {
      ""CodeMeaning"": ""Lung"",
      ""CodeValue"": ""39607008"",
      ""CodingSchemeDesignator"": ""SCT"",
      ""PrimaryAnatomicStructureModifierSequence"": []
    }
  ],
  ""SpecimenIdentifier"": ""130630_NLSI0000167"",
  ""SpecimenPreparationSequence"": [
    {
      ""SpecimenPreparationStepContentItemSequence"": [
        {
          ""ConceptCodeSequence"": [],
          ""ConceptNameCodeSequence"": [
            {
              ""CodeMeaning"": ""Specimen Identifier"",
              ""CodeValue"": ""121041"",
              ""CodingSchemeDesignator"": ""DCM""
            }
          ],
          ""TextValue"": ""130630_NLSI0000167"",
          ""ValueType"": ""TEXT""
        },
        {
          ""ConceptCodeSequence"": [
            {
              ""CodeMeaning"": ""Specimen processing"",
              ""CodeValue"": ""9265001"",
              ""CodingSchemeDesignator"": ""SCT""
            }
          ],
          ""ConceptNameCodeSequence"": [
            {
              ""CodeMeaning"": ""Processing type"",
              ""CodeValue"": ""111701"",
              ""CodingSchemeDesignator"": ""DCM""
            }
          ],
          ""ValueType"": ""CODE""
        },
        {
          ""ConceptCodeSequence"": [
            {
              ""CodeMeaning"": ""Formalin"",
              ""CodeValue"": ""431510009"",
              ""CodingSchemeDesignator"": ""SCT""
            }
          ],
          ""ConceptNameCodeSequence"": [
            {
              ""CodeMeaning"": ""Tissue Fixative"",
              ""CodeValue"": ""430864009"",
              ""CodingSchemeDesignator"": ""SCT""
            }
          ],
          ""ValueType"": ""CODE""
        }
      ]
    },
    {
      ""SpecimenPreparationStepContentItemSequence"": [
        {
          ""ConceptCodeSequence"": [],
          ""ConceptNameCodeSequence"": [
            {
              ""CodeMeaning"": ""Specimen Identifier"",
              ""CodeValue"": ""121041"",
              ""CodingSchemeDesignator"": ""DCM""
            }
          ],
          ""TextValue"": ""130630_NLSI0000167"",
          ""ValueType"": ""TEXT""
        },
        {
          ""ConceptCodeSequence"": [
            {
              ""CodeMeaning"": ""Specimen processing"",
              ""CodeValue"": ""9265001"",
              ""CodingSchemeDesignator"": ""SCT""
            }
          ],
          ""ConceptNameCodeSequence"": [
            {
              ""CodeMeaning"": ""Processing type"",
              ""CodeValue"": ""111701"",
              ""CodingSchemeDesignator"": ""DCM""
            }
          ],
          ""ValueType"": ""CODE""
        },
        {
          ""ConceptCodeSequence"": [
            {
              ""CodeMeaning"": ""Paraffin wax"",
              ""CodeValue"": ""311731000"",
              ""CodingSchemeDesignator"": ""SCT""
            }
          ],
          ""ConceptNameCodeSequence"": [
            {
              ""CodeMeaning"": ""Embedding medium"",
              ""CodeValue"": ""430863003"",
              ""CodingSchemeDesignator"": ""SCT""
            }
          ],
          ""ValueType"": ""CODE""
        }
      ]
    },
    {
      ""SpecimenPreparationStepContentItemSequence"": [
        {
          ""ConceptCodeSequence"": [],
          ""ConceptNameCodeSequence"": [
            {
              ""CodeMeaning"": ""Specimen Identifier"",
              ""CodeValue"": ""121041"",
              ""CodingSchemeDesignator"": ""DCM""
            }
          ],
          ""TextValue"": ""130630_NLSI0000167"",
          ""ValueType"": ""TEXT""
        },
        {
          ""ConceptCodeSequence"": [
            {
              ""CodeMeaning"": ""Staining"",
              ""CodeValue"": ""127790008"",
              ""CodingSchemeDesignator"": ""SCT""
            }
          ],
          ""ConceptNameCodeSequence"": [
            {
              ""CodeMeaning"": ""Processing type"",
              ""CodeValue"": ""111701"",
              ""CodingSchemeDesignator"": ""DCM""
            }
          ],
          ""ValueType"": ""CODE""
        },
        {
          ""ConceptCodeSequence"": [
            {
              ""CodeMeaning"": ""hematoxylin stain"",
              ""CodeValue"": ""12710003"",
              ""CodingSchemeDesignator"": ""SCT""
            }
          ],
          ""ConceptNameCodeSequence"": [
            {
              ""CodeMeaning"": ""Using substance"",
              ""CodeValue"": ""424361007"",
              ""CodingSchemeDesignator"": ""SCT""
            }
          ],
          ""ValueType"": ""CODE""
        },
        {
          ""ConceptCodeSequence"": [
            {
              ""CodeMeaning"": ""water soluble eosin stain"",
              ""CodeValue"": ""36879007"",
              ""CodingSchemeDesignator"": ""SCT""
            }

2025-01-17 20:10:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:10:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:10:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:10:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 52
2025-01-17 20:10:09 - snowflake.connector.connection - INFO - closed
2025-01-17 20:10:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:10:10 - root - INFO - SQL:
-- 5. Retrieve SpecimenPreparationSequence from SpecimenDescriptionSequence
SELECT t."SOPInstanceUID", s.value AS "SpecimenPreparationSequence"
FROM IDC.IDC_V17.DICOM_ALL t,
LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd,
LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") s
WHERE t."Modality" = 'SM'
LIMIT 1000;
Results:
Too long, hard cut:
SOPInstanceUID,SpecimenPreparationSequence
1.3.6.1.4.1.5962.99.1.505946602.106805238.1641183486442.21.0,"{
  ""SpecimenPreparationStepContentItemSequence"": [
    {
      ""ConceptCodeSequence"": [],
      ""ConceptNameCodeSequence"": [
        {
          ""CodeMeaning"": ""Specimen Identifier"",
          ""CodeValue"": ""121041"",
          ""CodingSchemeDesignator"": ""DCM""
        }
      ],
      ""TextValue"": ""120316_11782"",
      ""ValueType"": ""TEXT""
    },
    {
      ""ConceptCodeSequence"": [
        {
          ""CodeMeaning"": ""Specimen processing"",
          ""CodeValue"": ""9265001"",
          ""CodingSchemeDesignator"": ""SCT""
        }
      ],
      ""ConceptNameCodeSequence"": [
        {
          ""CodeMeaning"": ""Processing type"",
          ""CodeValue"": ""111701"",
          ""CodingSchemeDesignator"": ""DCM""
        }
      ],
      ""ValueType"": ""CODE""
    },
    {
      ""ConceptCodeSequence"": [
        {
          ""CodeMeaning"": ""Formalin"",
          ""CodeValue"": ""431510009"",
          ""CodingSchemeDesignator"": ""SCT""
        }
      ],
      ""ConceptNameCodeSequence"": [
        {
          ""CodeMeaning"": ""Tissue Fixative"",
          ""CodeValue"": ""430864009"",
          ""CodingSchemeDesignator"": ""SCT""
        }
      ],
      ""ValueType"": ""CODE""
    }
  ]
}"
1.3.6.1.4.1.5962.99.1.505946602.106805238.1641183486442.21.0,"{
  ""SpecimenPreparationStepContentItemSequence"": [
    {
      ""ConceptCodeSequence"": [],
      ""ConceptNameCodeSequence"": [
        {
          ""CodeMeaning"": ""Specimen Identifier"",
          ""CodeValue"": ""121041"",
          ""CodingSchemeDesignator"": ""DCM""
        }
      ],
      ""TextValue"": ""120316_11782"",
      ""ValueType"": ""TEXT""
    },
    {
      ""ConceptCodeSequence"": [
        {
          ""CodeMeaning"": ""Specimen processing"",
          ""CodeValue"": ""9265001"",
          ""CodingSchemeDesignator"": ""SCT""
        }
      ],
      ""ConceptNameCodeSequence"": [
        {
          ""CodeMeaning"": ""Processing type"",
          ""CodeValue"": ""111701"",
          ""CodingSchemeDesignator"": ""DCM""
        }
      ],
      ""ValueType"": ""CODE""
    },
    {
      ""ConceptCodeSequence"": [
        {
          ""CodeMeaning"": ""Paraffin wax"",
          ""CodeValue"": ""311731000"",
          ""CodingSchemeDesignator"": ""SCT""
        }
      ],
      ""ConceptNameCodeSequence"": [
        {
          ""CodeMeaning"": ""Embedding medium"",
          ""CodeValue"": ""430863003"",
          ""CodingSchemeDesignator"": ""SCT""
        }
      ],
      ""ValueType"": ""CODE""
    }
  ]
}"
1.3.6.1.4.1.5962.99.1.505946602.106805238.1641183486442.21.0,"{
  ""SpecimenPreparationStepContentItemSequence"": [
    {
      ""ConceptCodeSequence"": [],
      ""ConceptNameCodeSequence"": [
        {
          ""CodeMeaning"": ""Specimen Identifier"",
          ""CodeValue"": ""121041"",
          ""CodingSchemeDesignator"": ""DCM""
        }
      ],
      ""TextValue"": ""120316_11782"",
      ""ValueType"": ""TEXT""
    },
    {
      ""ConceptCodeSequence"": [
        {
          ""CodeMeaning"": ""Staining"",
          ""CodeValue"": ""127790008"",
          ""CodingSchemeDesignator"": ""SCT""
        }
      ],
      ""ConceptNameCodeSequence"": [
        {
          ""CodeMeaning"": ""Processing type"",
          ""CodeValue"": ""111701"",
          ""CodingSchemeDesignator"": ""DCM""
        }
      ],
      ""ValueType"": ""CODE""
    },
    {
      ""ConceptCodeSequence"": [
        {
          ""CodeMeaning"": ""hematoxylin stain"",
          ""CodeValue"": ""12710003"",
          ""CodingSchemeDesignator"": ""SCT""
        }
      ],
      ""ConceptNameCodeSequence"": [
        {
          ""CodeMeaning"": ""Using substance"",
          ""CodeValue"": ""424361007"",
          ""CodingSchemeDesignator"": ""SCT""
        }
      ],
      ""ValueType"": ""CODE""
    },
    {
      ""ConceptCodeSequence"": [
        {
          ""CodeMeaning"": ""water soluble eosin stain"",
          ""CodeValue"": ""36879007"",
          ""CodingSchemeDesignator"": ""SCT""
        }
      ],
      ""ConceptNameCodeSequence"": [
        {
          ""CodeMeaning"": ""Using substance"",
          ""CodeValue"": ""424361007"",
          ""CodingSchemeDesignator"": ""SCT""
        }
      ],
      ""ValueType"": ""CODE""
    }
  ]
}"
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,"{
  ""SpecimenPreparationStepContentItemSequence"": [
    {
      ""ConceptCodeSequence"": [],
      ""ConceptNameCodeSequence"": [
        {
          ""CodeMeaning"": ""Specimen Identifier"",
          ""CodeValue"": ""121041"",
          ""CodingSchemeDesignator"": ""DCM""
        }
      ],
      ""TextValue"": ""HTA7_922_2"",
      ""ValueType"": ""TEXT""
    },
    {
      ""ConceptCodeSequence"": [
        {
          ""CodeMeaning"": ""Specimen Collection"",
          ""CodeValue"": ""17636008"",


2025-01-17 20:10:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:10:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:10:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:10:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 281
2025-01-17 20:10:12 - snowflake.connector.connection - INFO - closed
2025-01-17 20:10:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:10:13 - root - INFO - SQL:
-- 6. Extract SpecimenPreparationStepContentItemSequence
SELECT t."SOPInstanceUID", c.value AS "SpecimenPreparationStepContentItemSequence"
FROM IDC.IDC_V17.DICOM_ALL t,
LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd,
LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp,
LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
WHERE t."Modality" = 'SM'
LIMIT 1000;
Results:
Too long, hard cut:
SOPInstanceUID,SpecimenPreparationStepContentItemSequence
1.3.6.1.4.1.5962.99.1.2023000241.619219898.1638405572785.29.0,"{
  ""ConceptCodeSequence"": [],
  ""ConceptNameCodeSequence"": [
    {
      ""CodeMeaning"": ""Specimen Identifier"",
      ""CodeValue"": ""121041"",
      ""CodingSchemeDesignator"": ""DCM""
    }
  ],
  ""TextValue"": ""TCGA-24-2298-01"",
  ""ValueType"": ""TEXT""
}"
1.3.6.1.4.1.5962.99.1.2023000241.619219898.1638405572785.29.0,"{
  ""ConceptCodeSequence"": [
    {
      ""CodeMeaning"": ""Specimen container"",
      ""CodeValue"": ""434711009"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ConceptNameCodeSequence"": [
    {
      ""CodeMeaning"": ""Specimen container"",
      ""CodeValue"": ""434711009"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ValueType"": ""CODE""
}"
1.3.6.1.4.1.5962.99.1.2023000241.619219898.1638405572785.29.0,"{
  ""ConceptCodeSequence"": [
    {
      ""CodeMeaning"": ""Tissue specimen"",
      ""CodeValue"": ""119376003"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ConceptNameCodeSequence"": [
    {
      ""CodeMeaning"": ""Specimen type"",
      ""CodeValue"": ""371439000"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ValueType"": ""CODE""
}"
1.3.6.1.4.1.5962.99.1.2023000241.619219898.1638405572785.29.0,"{
  ""ConceptCodeSequence"": [
    {
      ""CodeMeaning"": ""Specimen Collection"",
      ""CodeValue"": ""17636008"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ConceptNameCodeSequence"": [
    {
      ""CodeMeaning"": ""Processing type"",
      ""CodeValue"": ""111701"",
      ""CodingSchemeDesignator"": ""DCM""
    }
  ],
  ""ValueType"": ""CODE""
}"
1.3.6.1.4.1.5962.99.1.2023000241.619219898.1638405572785.29.0,"{
  ""ConceptCodeSequence"": [
    {
      ""CodeMeaning"": ""Removal"",
      ""CodeValue"": ""118292001"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ConceptNameCodeSequence"": [
    {
      ""CodeMeaning"": ""Specimen Collection"",
      ""CodeValue"": ""17636008"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ValueType"": ""CODE""
}"
1.3.6.1.4.1.5962.99.1.2023000241.619219898.1638405572785.29.0,"{
  ""ConceptCodeSequence"": [],
  ""ConceptNameCodeSequence"": [
    {
      ""CodeMeaning"": ""Specimen Identifier"",
      ""CodeValue"": ""121041"",
      ""CodingSchemeDesignator"": ""DCM""
    }
  ],
  ""TextValue"": ""TCGA-24-2298-01A"",
  ""ValueType"": ""TEXT""
}"
1.3.6.1.4.1.5962.99.1.2023000241.619219898.1638405572785.29.0,"{
  ""ConceptCodeSequence"": [
    {
      ""CodeMeaning"": ""Specimen vial"",
      ""CodeValue"": ""434746001"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ConceptNameCodeSequence"": [
    {
      ""CodeMeaning"": ""Specimen container"",
      ""CodeValue"": ""434711009"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ValueType"": ""CODE""
}"
1.3.6.1.4.1.5962.99.1.2023000241.619219898.1638405572785.29.0,"{
  ""ConceptCodeSequence"": [
    {
      ""CodeMeaning"": ""Tissue specimen"",
      ""CodeValue"": ""119376003"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ConceptNameCodeSequence"": [
    {
      ""CodeMeaning"": ""Specimen type"",
      ""CodeValue"": ""371439000"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ValueType"": ""CODE""
}"
1.3.6.1.4.1.5962.99.1.2023000241.619219898.1638405572785.29.0,"{
  ""ConceptCodeSequence"": [
    {
      ""CodeMeaning"": ""Specimen Sampling"",
      ""CodeValue"": ""433465004"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ConceptNameCodeSequence"": [
    {
      ""CodeMeaning"": ""Processing type"",
      ""CodeValue"": ""111701"",
      ""CodingSchemeDesignator"": ""DCM""
    }
  ],
  ""ValueType"": ""CODE""
}"
1.3.6.1.4.1.5962.99.1.2023000241.619219898.1638405572785.29.0,"{
  ""ConceptCodeSequence"": [
    {
      ""CodeMeaning"": ""Sampling of tissue specimen"",
      ""CodeValue"": ""433465004"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ConceptNameCodeSequence"": [
    {
      ""CodeMeaning"": ""Sampling Method"",
      ""CodeValue"": ""111704"",
      ""CodingSchemeDesignator"": ""DCM""
    }
  ],
  ""ValueType"": ""CODE""
}"
1.3.6.1.4.1.5962.99.1.2023000241.619219898.1638405572785.29.0,"{
  ""ConceptCodeSequence"": [],
  ""ConceptNameCodeSequence"": [
    {
      ""CodeMeaning"": ""Parent Specimen Identifier"",
      ""CodeValue"": ""111705"",
      ""CodingSchemeDesignator"": ""DCM""
    }
  ],
  ""TextValue"": ""TCGA-24-2298-01"",
  ""ValueType"": ""TEXT""
}"
1.3.6.1.4.1.5962.99.1.2023000241.619219898.1638405572785.29.0,"{
  ""ConceptCodeSequence"": [
    {
      ""CodeMeaning"": ""Tissue specimen"",
      ""CodeValue"": ""119376003"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ConceptNameCodeSequence"": [
    {
      ""CodeMeaning"": ""Parent specimen type"",
      ""CodeValue"": ""111707"",
      ""CodingSchemeDesignator"": ""DCM""
    }
  ],
  ""ValueType"": ""CODE""
}"
1.3.6.1.4.1.

2025-01-17 20:10:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:10:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:10:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:10:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-17 20:10:14 - snowflake.connector.connection - INFO - closed
2025-01-17 20:10:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:10:15 - root - INFO - SQL:
-- 7. Extract CodeMeaning and CodingSchemeDesignator from SpecimenPreparationStepContentItemSequence
SELECT
  t."SOPInstanceUID",
  c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING AS "ConceptNameCodeMeaning",
  c.value:"ConceptNameCodeSequence"[0]:"CodingSchemeDesignator"::STRING AS "ConceptNameCodingSchemeDesignator",
  c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "ConceptCodeMeaning",
  c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING AS "ConceptCodeCodingSchemeDesignator",
  c.value:"TextValue"::STRING AS "TextValue"
FROM IDC.IDC_V17.DICOM_ALL t,
LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd,
LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp,
LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
WHERE t."Modality" = 'SM'
LIMIT 1000;
Results:
Too long, hard cut:
SOPInstanceUID,ConceptNameCodeMeaning,ConceptNameCodingSchemeDesignator,ConceptCodeMeaning,ConceptCodeCodingSchemeDesignator,TextValue
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Specimen Identifier,DCM,,,HTA7_922_2
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Processing type,DCM,Specimen Collection,SCT,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Specimen Collection,SCT,Resection,SCT,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Specimen Identifier,DCM,,,HTA7_922_1000
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Specimen container,SCT,Microscope slide,SCT,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Specimen type,SCT,Slide,SCT,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Processing type,DCM,Specimen Sampling,SCT,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Sampling Method,DCM,Block sectioning,SCT,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Parent Specimen Identifier,DCM,,,HTA7_922_2
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Parent specimen type,DCM,Gross specimen,SCT,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Specimen Identifier,DCM,,,HTA7_922_1000
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Processing type,DCM,Staining,SCT,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Channel,NCIt,,,5
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Cycle,NCIt,,,2
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Component investigated,SCT,Rat protein,SCT,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Component investigated,SCT,,,Rat-IgG
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Tracer,NCIt,Fluorophore,UMLS,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Using Fluorophore,UMLS,Alexa Fluor 488,PUBCHEM_CID,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Using Fluorophore,UMLS,,,Alexa Fluor 488
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Using substance,SCT,"Donkey anti-Rat IgG (H+L) Secondary AB, Alexa Fluor 488",RRID,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Staining Technique,SCT,Fluorescent staining,SCT,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Manufacturer Name,UMLS,,,Thermo Fisher
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Brand Name,DCM,,,A-21208
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Dilution,UMLS,,,1:2000
1.3.6.1.4.1.5962.99.1.156560246.107498373.1640834100086.7.0,Specimen Identifier,DCM,,,C3L-02556-03
1.3.6.1.4.1.5962.99.1.156560246.107498373.1640834100086.7.0,Processing type,DCM,Staining,SCT,
1.3.6.1.4.1.5962.99.1.156560246.107498373.1640834100086.7.0,Using substance,SCT,hematoxylin stain,SCT,
1.3.6.1.4.1.5962.99.1.156560246.107498373.1640834100086.7.0,Using substance,SCT,water soluble eosin stain,SCT,
1.3.6.1.4.1.5962.99.1.156579441.409510745.1640834119281.35.0,Specimen Identifier,DCM,,,C3N-00852-02
1.3.6.1.4.1.5962.99.1.156579441.409510745.1640834119281.35.0,Processing type,DCM,Staining,SCT,
1.3.6.1.4.1.5962.99.1.156579441.409510745.1640834119281.35.0,Using substance,SCT,hematoxylin stain,SCT,
1.3.6.1.4.1.5962.99.1.156579441.409510745.1640834119281.35.0,Using substance,SCT,water soluble eosin stain,SCT,
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Specimen Identifier,DCM,,,TCGA-06-5417-01
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Specimen container,SCT,Specimen container,SCT,
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Specimen type,SCT,Tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Processing type,DCM,Specimen Collection,SCT,
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Specimen Collection,SCT,Removal,SCT,
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Specimen Identifier,DCM,,,TCGA-06-5417-01A
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Specimen container,SCT,Specimen vial,SCT,
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Specimen type,SCT,Tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Processing type,DCM,Specimen Sampling,SCT,
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Sampling Method,DCM,Sampling of tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Parent Specimen Identifier,DCM,,,TCGA-06-5417-01
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Parent specimen type,DCM,Tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Specimen Identifier,DCM,,,TCGA-06-5417-01A-01
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Processing type,DCM,Specimen Sampling,SCT,
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Specimen cont

2025-01-17 20:10:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:10:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:10:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:10:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1000
2025-01-17 20:10:16 - snowflake.connector.connection - INFO - closed
2025-01-17 20:10:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:10:17 - root - INFO - SQL:
-- 8. Filter for CodingSchemeDesignator='SCT' and extract CodeMeanings
SELECT
  t."SOPInstanceUID",
  c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING AS "ConceptNameCodeMeaning",
  c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "ConceptCodeMeaning",
  c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING AS "CodingSchemeDesignator",
  c.value:"TextValue"::STRING AS "TextValue"
FROM IDC.IDC_V17.DICOM_ALL t,
LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd,
LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp,
LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
WHERE t."Modality" = 'SM'
  AND c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
LIMIT 1000;
Results:
Too long, hard cut:
SOPInstanceUID,ConceptNameCodeMeaning,ConceptCodeMeaning,CodingSchemeDesignator,TextValue
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Specimen container,Specimen container,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Specimen type,Tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Processing type,Specimen Collection,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Specimen Collection,Removal,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Specimen container,Specimen vial,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Specimen type,Tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Processing type,Specimen Sampling,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Sampling Method,Sampling of tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Parent specimen type,Tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Processing type,Specimen Sampling,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Specimen container,Tissue cassette,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Specimen type,Gross specimen,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Sampling Method,Sampling of tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Parent specimen type,Tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Specimen container,Microscope slide,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Specimen type,Slide,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Processing type,Specimen Sampling,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Sampling Method,Block sectioning,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Parent specimen type,Gross specimen,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Processing type,Specimen processing,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Tissue Fixative,Formalin,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Processing type,Specimen processing,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Embedding medium,Paraffin wax,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Processing type,Staining,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Using substance,hematoxylin stain,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Using substance,water soluble eosin stain,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Specimen container,Specimen container,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Specimen type,Tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Processing type,Specimen Collection,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Specimen Collection,Removal,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Specimen container,Specimen vial,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Specimen type,Tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Processing type,Specimen Sampling,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Sampling Method,Sampling of tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Parent specimen type,Tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Processing type,Specimen Sampling,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Specimen container,Tissue cassette,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Specimen type,Gross specimen,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Sampling Method,Sampling of tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Parent specimen type,Tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Specimen container,Microscope slide,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Specimen type,Slide,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Processing type,Specimen Sampling,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Sampling Method,Block sectioning,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Parent specimen type,Gross specimen,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Processing type,Specimen processing,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Embedding medium,Tissue freezing medium,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Processing type,Staining,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Using substance,hematoxylin stain

2025-01-17 20:10:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:10:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:10:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:10:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-17 20:10:18 - snowflake.connector.connection - INFO - closed
2025-01-17 20:10:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:10:19 - root - INFO - SQL:
-- 9. List distinct embedding medium code meanings from SM modality
SELECT DISTINCT c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "EmbeddingMediumCodeMeaning"
FROM IDC.IDC_V17.DICOM_ALL t,
LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd,
LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp,
LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
WHERE t."Modality" = 'SM'
  AND c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING ILIKE '%embedding medium%'
  AND c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
LIMIT 1000;
Results:
EmbeddingMediumCodeMeaning
Tissue freezing medium
Paraffin wax

2025-01-17 20:10:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:10:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:10:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:10:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-17 20:10:20 - snowflake.connector.connection - INFO - closed
2025-01-17 20:10:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:10:20 - root - INFO - SQL:
-- 10. List distinct staining substance code meanings from SM modality
SELECT DISTINCT c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "StainingSubstanceCodeMeaning"
FROM IDC.IDC_V17.DICOM_ALL t,
LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd,
LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp,
LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
WHERE t."Modality" = 'SM'
  AND c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING ILIKE '%staining%'
  AND c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
LIMIT 1000;
Results:
StainingSubstanceCodeMeaning
Fluorescent staining

2025-01-17 20:10:20 - root - INFO - itercount: 0
2025-01-17 20:10:20 - root - INFO - Database Name: IDC
Schema Name: IDC_V17
DDL describes table information.
,0
table_name,DICOM_METADATA
description,
DDL,"create or replace TABLE DICOM_METADATA (
	""MediaStorageSOPClassUID"" VARCHAR(16777216),
	""MediaStorageSOPInstanceUID"" VARCHAR(16777216),
	""TransferSyntaxUID"" VARCHAR(16777216),
	""ImplementationClassUID"" VARCHAR(16777216),
	""ImplementationVersionName"" VARCHAR(16777216),
	""SourceApplicationEntityTitle"" VARCHAR(16777216),
	""ReferencedFileID"" VARIANT,
	""ReferencedSOPInstanceUIDInFile"" VARCHAR(16777216),
	""LengthToEnd"" NUMBER(38,0),
	""SpecificCharacterSet"" VARIANT,
	""ImageType"" VARIANT,
	""RecognitionCode"" VARCHAR(16777216),
	""InstanceCreationDate"" DATE,
	""InstanceCreationTime"" TIME(9),
	""InstanceCreatorUID"" VARCHAR(16777216),
	""SOPClassUID"" VARCHAR(16777216),
	""SOPInstanceUID"" VARCHAR(16777216),
	""OriginalSpecializedSOPClassUID"" VARCHAR(16777216),
	""StudyDate"" DATE,
	""SeriesDate"" DATE,
	""AcquisitionDate"" DATE,
	""ContentDate"" DATE,
	""OverlayDate"" DATE,
	""CurveDate"" DATE,
	""AcquisitionDateTime"" NUMBER(38,0),
	""StudyTime"" TIME(9),
	""SeriesTime"" TIME(9),
	""AcquisitionTime"" TIME(9),
	""ContentTime"" TIME(9),
	""DataSetType"" NUMBER(38,0),
	""DataSetSubtype"" VARCHAR(16777216),
	""AccessionNumber"" VARCHAR(16777216),
	""IssuerOfAccessionNumberSequence"" VARIANT,
	""RetrieveAETitle"" VARIANT,
	""FailedSOPInstanceUIDList"" VARIANT,
	""Modality"" VARCHAR(16777216),
	""ModalitiesInStudy"" VARIANT,
	""ConversionType"" VARCHAR(16777216),
	""PresentationIntentType"" VARCHAR(16777216),
	""Manufacturer"" VARCHAR(16777216),
	""InstitutionName"" VARCHAR(16777216),
	""InstitutionAddress"" VARCHAR(16777216),
	""ReferringPhysicianName"" VARIANT,
	""ReferringPhysicianAddress"" VARCHAR(16777216),
	""ReferringPhysicianTelephoneNumbers"" VARIANT,
	""CodeValue"" VARCHAR(16777216),
	""CodingSchemeDesignator"" VARCHAR(16777216),
	""CodingSchemeUID"" VARCHAR(16777216),
	""ContextGroupExtensionCreatorUID"" VARCHAR(16777216),
	""ContextIdentifier"" VARCHAR(16777216),
	""CodingSchemeIdentificationSequence"" VARIANT,
	""ContextGroupIdentificationSequence"" VARIANT,
	""MappingResourceIdentificationSequence"" VARIANT,
	""TimezoneOffsetFromUTC"" VARCHAR(16777216),
	""StationName"" VARCHAR(16777216),
	""StudyDescription"" VARCHAR(16777216),
	""ProcedureCodeSequence"" VARIANT,
	""SeriesDescription"" VARCHAR(16777216),
	""InstitutionalDepartmentName"" VARCHAR(16777216),
	""PerformingPhysicianName"" VARIANT,
	""OperatorsName"" VARIANT,
	""AdmittingDiagnosesDescription"" VARIANT,
	""AdmittingDiagnosesCodeSequence"" VARIANT,
	""ManufacturerModelName"" VARCHAR(16777216),
	""ReferencedStudySequence"" VARIANT,
	""ReferencedPerformedProcedureStepSequence"" VARIANT,
	""ReferencedSeriesSequence"" VARIANT,
	""ReferencedPatientSequence"" VARIANT,
	""ReferencedImageSequence"" VARIANT,
	""ReferencedSOPClassUID"" VARCHAR(16777216),
	""ReferencedSOPInstanceUID"" VARCHAR(16777216),
	""TransactionUID"" VARCHAR(16777216),
	""StudiesContainingOtherReferencedInstancesSequence"" VARIANT,
	""RelatedSeriesSequence"" VARIANT,
	""LossyImageCompressionRetired"" VARCHAR(16777216),
	""DerivationDescription"" VARCHAR(16777216),
	""SourceImageSequence"" VARIANT,
	""StartTrim"" VARCHAR(16777216),
	""StopTrim"" VARCHAR(16777216),
	""RecommendedDisplayFrameRate"" VARCHAR(16777216),
	""AnatomicRegionSequence"" VARIANT,
	""IrradiationEventUID"" VARIANT,
	""SourceIrradiationEventSequence"" VARIANT,
	""FrameType"" VARIANT,
	""ReferencedImageEvidenceSequence"" VARIANT,
	""ReferencedRawDataSequence"" VARIANT,
	""CreatorVersionUID"" VARCHAR(16777216),
	""DerivationImageSequence"" VARIANT,
	""PixelPresentation"" VARCHAR(16777216),
	""VolumetricProperties"" VARCHAR(16777216),
	""VolumeBasedCalculationTechnique"" VARCHAR(16777216),
	""ComplexImageComponent"" VARCHAR(16777216),
	""AcquisitionContrast"" VARCHAR(16777216),
	""DerivationCodeSequence"" VARIANT,
	""PatientName"" VARIANT,
	""PatientID"" VARCHAR(16777216),
	""IssuerOfPatientID"" VARCHAR(16777216),
	""TypeOfPatientID"" VARCHAR(16777216),
	""IssuerOfPatientIDQualifiersSequence"" VARIANT,
	""SourcePatientGroupIdentificationSequence"" VARIANT,
	""PatientBirthDate"" DATE,
	""PatientBirthTime"" TIME(9),
	""PatientSex"" VARCHAR(16777216),
	""QualityControlSubject"" VARCHAR(16777216),
	""StrainDescription"" VARCHAR(16777216),
	""StrainNomenclature"" VARCHAR(16777216),
	""StrainCodeSequence"" VARIANT,
	""OtherPatientIDs"" VARIANT,
	""PatientAge"" VARCHAR(16777216),
	""PatientSize"" VARCHAR(16777216),
	""PatientWeight"" VARCHAR(16777216),
	""PatientAddress"" VARCHAR(16777216),
	""MedicalAlerts"" VARIANT,
	""Allergies"" VARIANT,
	""PatientTelephoneNumbers"" VARIANT,
	""EthnicGroup"" VARCHAR(16777216),
	""Occupation"" VARCHAR(16777216),
	""SmokingStatus"" VARCHAR(16777216),
	""AdditionalPatientHistory"" VARCHAR(16777216),
	""PregnancyStatus"" NUMBER(38,0),
	""LastMenstrualDate"" DATE,
	""PatientSpeciesDescription"" VARCHAR(16777216),
	""PatientSpeciesCodeSequence"" VARIANT,
	""PatientSexNeutered"" VARCHAR(16777216),
	""AnatomicalOrientationType"" VARCHAR(16777216),
	""PatientBreedDescription"" VARCHAR(16777216),
	""PatientBreedCodeSequence"" VARIANT,
	""ResponsibleOrganization"" VARCHAR(16777216),
	""PatientComments"" VARCHAR(16777216),
	""ClinicalTrialSponsorName"" VARCHAR(16777216),
	""ClinicalTrialProtocolID"" VARCHAR(16777216),
	""ClinicalTrialProtocolName"" VARCHAR(16777216),
	""ClinicalTrialSiteID"" VARCHAR(16777216),
	""ClinicalTrialSiteName"" VARCHAR(16777216),
	""ClinicalTrialSubjectID"" VARCHAR(16777216),
	""ClinicalTrialSubjectReadingID"" VARCHAR(16777216),
	""ClinicalTrialTimePointID"" VARCHAR(16777216),
	""ClinicalTrialTimePointDescription"" VARCHAR(16777216),
	""LongitudinalTemporalOffsetFromEvent"" FLOAT,
	""LongitudinalTemporalEventType"" VARCHAR(16777216),
	""ClinicalTrialCoordinatingCenterName"" VARCHAR(16777216),
	""PatientIdentityRemoved"" VARCHAR(16777216),
	""DeidentificationMethod"" VARIANT,
	""DeidentificationMethodCodeSequence"" VARIANT,
	""ClinicalTrialSeriesID"" VARCHAR(16777216),
	""FNumber"" VARCHAR(16777216),
	""FocalLength"" VARCHAR(16777216),
	""LensSpecification"" VARIANT,
	""LensMake"" VARCHAR(16777216),
	""LensModel"" VARCHAR(16777216),
	""ContrastBolusAgent"" VARCHAR(16777216),
	""BodyPartExamined"" VARCHAR(16777216),
	""ScanningSequence"" VARIANT,
	""SequenceVariant"" VARIANT,
	""ScanOptions"" VARIANT,
	""MRAcquisitionType"" VARCHAR(16777216),
	""SequenceName"" VARCHAR(16777216),
	""AngioFlag"" VARCHAR(16777216),
	""InterventionDrugInformationSequence"" VARIANT,
	""Radiopharmaceutical"" VARCHAR(16777216),
	""CineRate"" VARCHAR(16777216),
	""SliceThickness"" VARCHAR(16777216),
	KVP VARCHAR(16777216),
	""CountsAccumulated"" VARCHAR(16777216),
	""AcquisitionTerminationCondition"" VARCHAR(16777216),
	""EffectiveDuration"" VARCHAR(16777216),
	""AcquisitionStartCondition"" VARCHAR(16777216),
	""AcquisitionStartConditionData"" VARCHAR(16777216),
	""AcquisitionTerminationConditionData"" VARCHAR(16777216),
	""RepetitionTime"" VARCHAR(16777216),
	""EchoTime"" VARCHAR(16777216),
	""InversionTime"" VARCHAR(16777216),
	""NumberOfAverages"" VARCHAR(16777216),
	""ImagingFrequency"" VARCHAR(16777216),
	""ImagedNucleus"" VARCHAR(16777216),
	""EchoNumbers"" VARIANT,
	""MagneticFieldStrength"" VARCHAR(16777216),
	""SpacingBetweenSlices"" VARCHAR(16777216),
	""NumberOfPhaseEncodingSteps"" VARCHAR(16777216),
	""DataCollectionDiameter"" VARCHAR(16777216),
	""EchoTrainLength"" VARCHAR(16777216),
	""PercentSampling"" VARCHAR(16777216),
	""PercentPhaseFieldOfView"" VARCHAR(16777216),
	""PixelBandwidth"" VARCHAR(16777216),
	""DeviceSerialNumber"" VARCHAR(16777216),
	""DeviceUID"" VARCHAR(16777216),
	""PlateID"" VARCHAR(16777216),
	""GantryID"" VARCHAR(16777216),
	""SecondaryCaptureDeviceID"" VARCHAR(16777216),
	""DateOfSecondaryCapture"" DATE,
	""TimeOfSecondaryCapture"" TIME(9),
	""SecondaryCaptureDeviceManufacturer"" VARCHAR(16777216),
	""SecondaryCaptureDeviceManufacturerModelName"" VARCHAR(16777216),
	""SecondaryCaptureDeviceSoftwareVersions"" VARIANT,
	""SoftwareVersions"" VARIANT,
	""VideoImageFormatAcquired"" VARCHAR(16777216),
	""DigitalImageFormatAcquired"" VARCHAR(16777216),
	""ProtocolName"" VARCHAR(16777216),
	""ContrastBolusRoute"" VARCHAR(16777216),
	""ContrastBolusVolume"" VARCHAR(16777216),
	""ContrastBolusStartTime"" TIME(9),
	""ContrastBolusStopTime"" TIME(9),
	""ContrastBolusTotalDose"" VARCHAR(16777216),
	""ContrastFlowRate"" VARIANT,
	""ContrastFlowDuration"" VARIANT,
	""ContrastBolusIngredient"" VARCHAR(16777216),
	""ContrastBolusIngredientConcentration"" VARCHAR(16777216),
	""SpatialResolution"" VARCHAR(16777216),
	""TriggerTime"" VARCHAR(16777216),
	""TriggerSourceOrType"" VARCHAR(16777216),
	""NominalInterval"" VARCHAR(16777216),
	""FrameTime"" VARCHAR(16777216),
	""CardiacFramingType"" VARCHAR(16777216),
	""FrameDelay"" VARCHAR(16777216),
	""SynchronizationTrigger"" VARCHAR(16777216),
	""RadiopharmaceuticalVolume"" VARCHAR(16777216),
	""RadiopharmaceuticalStartTime"" TIME(9),
	""RadionuclideTotalDose"" VARCHAR(16777216),
	""BeatRejectionFlag"" VARCHAR(16777216),
	""LowRRValue"" VARCHAR(16777216),
	""HighRRValue"" VARCHAR(16777216),
	""IntervalsAcquired"" VARCHAR(16777216),
	""IntervalsRejected"" VARCHAR(16777216),
	""PVCRejection"" VARCHAR(16777216),
	""SkipBeats"" VARCHAR(16777216),
	""HeartRate"" VARCHAR(16777216),
	""CardiacNumberOfImages"" VARCHAR(16777216),
	""TriggerWindow"" VARCHAR(16777216),
	""ReconstructionDiameter"" VARCHAR(16777216),
	""DistanceSourceToDetector"" VARCHAR(16777216),
	""DistanceSourceToPatient"" VARCHAR(16777216),
	""EstimatedRadiographicMagnificationFactor"" VARCHAR(16777216),
	""GantryDetectorTilt"" VARCHAR(16777216),
	""GantryDetectorSlew"" VARCHAR(16777216),
	""TableHeight"" VARCHAR(16777216),
	""TableTraverse"" VARCHAR(16777216),
	""RotationDirection"" VARCHAR(16777216),
	""AngularPosition"" VARCHAR(16777216),
	""ScanArc"" VARCHAR(16777216),
	""FieldOfViewShape"" VARCHAR(16777216),
	""FieldOfViewDimensions"" VARIANT,
	""ExposureTime"" VARCHAR(16777216),
	""XRayTubeCurrent"" VARCHAR(16777216),
	""Exposure"" VARCHAR(16777216),
	""ExposureInuAs"" VARCHAR(16777216),
	""AveragePulseWidth"" VARCHAR(16777216),
	""RadiationSetting"" VARCHAR(16777216),
	""RectificationType"" VARCHAR(16777216),
	""RadiationMode"" VARCHAR(16777216),
	""ImageAndFluoroscopyAreaDoseProduct"" VARCHAR(16777216),
	""FilterType"" VARCHAR(16777216),
	""IntensifierSize"" VARCHAR(16777216),
	""ImagerPixelSpacing"" VARIANT,
	""Grid"" VARIANT,
	""GeneratorPower"" VARCHAR(16777216),
	""CollimatorGridName"" VARCHAR(16777216),
	""CollimatorType"" VARCHAR(16777216),
	""XFocusCenter"" VARIANT,
	""YFocusCenter"" VARIANT,
	""FocalSpots"" VARIANT,
	""AnodeTargetMaterial"" VARCHAR(16777216),
	""BodyPartThickness"" VARCHAR(16777216),
	""CompressionForce"" VARCHAR(16777216),
	""PaddleDescription"" VARCHAR(16777216),
	""DateOfLastCalibration"" VARIANT,
	""TimeOfLastCalibration"" VARIANT,
	""ConvolutionKernel"" VARIANT,
	""ActualFrameDuration"" VARCHAR(16777216),
	""CountRate"" VARCHAR(16777216),
	""PreferredPlaybackSequencing"" NUMBER(38,0),
	""ReceiveCoilName"" VARCHAR(16777216),
	""TransmitCoilName"" VARCHAR(16777216),
	""PlateType"" VARCHAR(16777216),
	""ScanVelocity"" VARCHAR(16777216),
	""WholeBodyTechnique"" VARIANT,
	""ScanLength"" VARCHAR(16777216),
	""AcquisitionMatrix"" VARIANT,
	""InPlanePhaseEncodingDirection"" VARCHAR(16777216),
	""FlipAngle"" VARCHAR(16777216),
	""VariableFlipAngleFlag"" VARCHAR(16777216),
	SAR VARCHAR(16777216),
	""dBdt"" VARCHAR(16777216),
	""B1rms"" FLOAT,
	""AcquisitionDeviceProcessingDescription"" VARCHAR(16777216),
	""AcquisitionDeviceProcessingCode"" VARCHAR(16777216),
	""CassetteOrientation"" VARCHAR(16777216),
	""CassetteSize"" VARCHAR(16777216),
	""ExposuresOnPlate"" NUMBER(38,0),
	""RelativeXRayExposure"" VARCHAR(16777216),
	""ExposureIndex"" VARCHAR(16777216),
	""TargetExposureIndex"" VARCHAR(16777216),
	""DeviationIndex"" VARCHAR(16777216),
	""TomoLayerHeight"" VARCHAR(16777216),
	""TomoAngle"" VARCHAR(16777216),
	""TomoTime"" VARCHAR(16777216),
	""TomoType"" VARCHAR(16777216),
	""TomoClass"" VARCHAR(16777216),
	""NumberOfTomosynthesisSourceImages"" VARCHAR(16777216),
	""PositionerMotion"" VARCHAR(16777216),
	""PositionerType"" VARCHAR(16777216),
	""PositionerPrimaryAngle"" VARCHAR(16777216),
	""PositionerSecondaryAngle"" VARCHAR(16777216),
	""DetectorSecondaryAngle"" VARCHAR(16777216),
	""ShutterShape"" VARIANT,
	""ShutterLeftVerticalEdge"" VARCHAR(16777216),
	""ShutterRightVerticalEdge"" VARCHAR(16777216),
	""ShutterUpperHorizontalEdge"" VARCHAR(16777216),
	""ShutterLowerHorizontalEdge"" VARCHAR(16777216),
	""CenterOfCircularShutter"" VARIANT,
	""RadiusOfCircularShutter"" VARCHAR(16777216),
	""VerticesOfThePolygonalShutter"" VARIANT,
	""ShutterPresentationValue"" NUMBER(38,0),
	""CollimatorShape"" VARIANT,
	""CollimatorLeftVerticalEdge"" VARCHAR(16777216),
	""CollimatorRightVerticalEdge"" VARCHAR(16777216),
	""CollimatorUpperHorizontalEdge"" VARCHAR(16777216),
	""CollimatorLowerHorizontalEdge"" VARCHAR(16777216),
	""VerticesOfThePolygonalCollimator"" VARIANT,
	""AcquisitionTimeSynchronized"" VARCHAR(16777216),
	""NominalScannedPixelSpacing"" VARIANT,
	""AcquisitionComments"" VARCHAR(16777216),
	""TransducerData"" VARIANT,
	""ProcessingFunction"" VARCHAR(16777216),
	""PostprocessingFunction"" VARCHAR(16777216),
	""MechanicalIndex"" VARCHAR(16777216),
	""BoneThermalIndex"" VARCHAR(16777216),
	""SoftTissueThermalIndex"" VARCHAR(16777216),
	""PatientPosition"" VARCHAR(16777216),
	""ViewPosition"" VARCHAR(16777216),
	""Sensitivity"" VARCHAR(16777216),
	""SequenceOfUltrasoundRegions"" VARIANT,
	""TransducerType"" VARCHAR(16777216),
	""DetectorConditionsNominalFlag"" VARCHAR(16777216),
	""DetectorTemperature"" VARCHAR(16777216),
	""DetectorType"" VARCHAR(16777216),
	""DetectorConfiguration"" VARCHAR(16777216),
	""DetectorDescription"" VARCHAR(16777216),
	""DetectorMode"" VARCHAR(16777216),
	""DetectorID"" VARCHAR(16777216),
	""DateOfLastDetectorCalibration"" DATE,
	""TimeOfLastDetectorCalibration"" TIME(9),
	""ExposuresOnDetectorSinceLastCalibration"" VARCHAR(16777216),
	""ExposuresOnDetectorSinceManufactured"" VARCHAR(16777216),
	""DetectorTimeSinceLastExposure"" VARCHAR(16777216),
	""DetectorActiveTime"" VARCHAR(16777216),
	""DetectorBinning"" VARIANT,
	""DetectorElementPhysicalSize"" VARIANT,
	""DetectorElementSpacing"" VARIANT,
	""DetectorActiveShape"" VARCHAR(16777216),
	""DetectorActiveDimensions"" VARIANT,
	""DetectorManufacturerName"" VARCHAR(16777216),
	""DetectorManufacturerModelName"" VARCHAR(16777216),
	""FieldOfViewOrigin"" VARIANT,
	""FieldOfViewRotation"" VARCHAR(16777216),
	""FieldOfViewHorizontalFlip"" VARCHAR(16777216),
	""GridAspectRatio"" VARIANT,
	""GridFocalDistance"" VARCHAR(16777216),
	""FilterMaterial"" VARIANT,
	""FilterThicknessMinimum"" VARIANT,
	""FilterThicknessMaximum"" VARIANT,
	""ExposureControlMode"" VARCHAR(16777216),
	""ExposureControlModeDescription"" VARCHAR(16777216),
	""ExposureStatus"" VARCHAR(16777216),
	""ExposureTimeInuS"" VARCHAR(16777216),
	""XRayTubeCurrentInuA"" VARCHAR(16777216),
	""ContentQualification"" VARCHAR(16777216),
	""PulseSequenceName"" VARCHAR(16777216),
	""EchoPulseSequence"" VARCHAR(16777216),
	""InversionRecovery"" VARCHAR(16777216),
	""MultipleSpinEcho"" VARCHAR(16777216),
	""MultiPlanarExcitation"" VARCHAR(16777216),
	""PhaseContrast"" VARCHAR(16777216),
	""TimeOfFlightContrast"" VARCHAR(16777216),
	""Spoiling"" VARCHAR(16777216),
	""SteadyStatePulseSequence"" VARCHAR(16777216),
	""EchoPlanarPulseSequence"" VARCHAR(16777216),
	""TagAngleFirstAxis"" FLOAT,
	""MagnetizationTransfer"" VARCHAR(16777216),
	""T2Preparation"" VARCHAR(16777216),
	""BloodSignalNulling"" VARCHAR(16777216),
	""SaturationRecovery"" VARCHAR(16777216),
	""SpectrallySelectedSuppression"" VARCHAR(16777216),
	""SpectrallySelectedExcitation"" VARCHAR(16777216),
	""SpatialPresaturation"" VARCHAR(16777216),
	""Tagging"" VARCHAR(16777216),
	""OversamplingPhase"" VARCHAR(16777216),
	""TagSpacingFirstDimension"" FLOAT,
	""GeometryOfKSpaceTraversal"" VARCHAR(16777216),
	""SegmentedKSpaceTraversal"" VARCHAR(16777216),
	""RectilinearPhaseEncodeReordering"" VARCHAR(16777216),
	""TagThickness"" FLOAT,
	""PartialFourierDirection"" VARCHAR(16777216),
	""CardiacSynchronizationTechnique"" VARCHAR(16777216),
	""ReceiveCoilType"" VARCHAR(16777216),
	""QuadratureReceiveCoil"" VARCHAR(16777216),
	""MultiCoilDefinitionSequence"" VARIANT,
	""MultiCoilElementName"" VARCHAR(16777216),
	""TransmitCoilType"" VARCHAR(16777216),
	""ChemicalShiftReference"" VARIANT,
	""MRAcquisitionFrequencyEncodingSteps"" NUMBER(38,0),
	""Decoupling"" VARCHAR(16777216),
	""KSpaceFiltering"" VARCHAR(16777216),
	""ParallelReductionFactorInPlane"" FLOAT,
	""AcquisitionDuration"" FLOAT,
	""FrameAcquisitionDateTime"" NUMBER(38,0),
	""DiffusionDirectionality"" VARCHAR(16777216),
	""ParallelAcquisition"" VARCHAR(16777216),
	""ParallelAcquisitionTechnique"" VARCHAR(16777216),
	""InversionTimes"" VARIANT,
	""MetaboliteMapDescription"" VARCHAR(16777216),
	""PartialFourier"" VARCHAR(16777216),
	""EffectiveEchoTime"" FLOAT,
	""CardiacSignalSource"" VARCHAR(16777216),
	""DiffusionBValue"" FLOAT,
	""DiffusionGradientOrientation"" VARIANT,
	""VelocityEncodingDirection"" VARIANT,
	""VelocityEncodingMinimumValue"" FLOAT,
	""NumberOfKSpaceTrajectories"" NUMBER(38,0),
	""CoverageOfKSpace"" VARCHAR(16777216),
	""FrequencyCorrection"" VARCHAR(16777216),
	""FrameReferenceDateTime"" NUMBER(38,0),
	""ParallelReductionFactorOutOfPlane"" FLOAT,
	""ParallelReductionFactorSecondInPlane"" FLOAT,
	""CardiacBeatRejectionTechnique"" VARCHAR(16777216),
	""RespiratoryMotionCompensationTechnique"" VARCHAR(16777216),
	""RespiratorySignalSource"" VARCHAR(16777216),
	""BulkMotionCompensationTechnique"" VARCHAR(16777216),
	""ApplicableSafetyStandardAgency"" VARCHAR(16777216),
	""SpecificAbsorptionRateDefinition"" VARCHAR(16777216),
	""GradientOutputType"" VARCHAR(16777216),
	""SpecificAbsorptionRateValue"" FLOAT,
	""GradientOutput"" FLOAT,
	""FlowCompensationDirection"" VARCHAR(16777216),
	""WaterReferencedPhaseCorrection"" VARCHAR(16777216),
	""FrameAcquisitionDuration"" FLOAT,
	""MRAcquisitionPhaseEncodingStepsInPlane"" NUMBER(38,0),
	""MRAcquisitionPhaseEncodingStepsOutOfPlane"" NUMBER(38,0),
	""RFEchoTrainLength"" NUMBER(38,0),
	""GradientEchoTrainLength"" NUMBER(38,0),
	""AcquisitionType"" VARCHAR(16777216),
	""TubeAngle"" FLOAT,
	""RevolutionTime"" FLOAT,
	""SingleCollimationWidth"" FLOAT,
	""TotalCollimationWidth"" FLOAT,
	""TableSpeed"" FLOAT,
	""TableFeedPerRotation"" FLOAT,
	""SpiralPitchFactor"" FLOAT,
	""DataCollectionCenterPatient"" VARIANT,
	""ReconstructionTargetCenterPatient"" VARIANT,
	""CTExposureSequence"" VARIANT,
	""ExposureModulationType"" VARIANT,
	""EstimatedDoseSaving"" FLOAT,
	""TablePosition"" FLOAT,
	""ExposureTimeInms"" FLOAT,
	""XRayTubeCurrentInmA"" FLOAT,
	""ExposureInmAs"" FLOAT,
	""FluoroscopyFlag"" VARCHAR(16777216),
	""CTDIvol"" FLOAT,
	""CTDIPhantomTypeCodeSequence"" VARIANT,
	""CalciumScoringMassFactorDevice"" VARIANT,
	""EnergyWeightingFactor"" FLOAT,
	""CTAdditionalXRaySourceSequence"" VARIANT,
	""ContributingSourcesSequence"" VARIANT,
	""XRay3DAcquisitionSequence"" VARIANT,
	""XRay3DReconstructionSequence"" VARIANT,
	""PositionerPrimaryAngleDirection"" VARCHAR(16777216),
	""DiffusionBValueXX"" FLOAT,
	""DiffusionBValueXY"" FLOAT,
	""DiffusionBValueXZ"" FLOAT,
	""DiffusionBValueYY"" FLOAT,
	""DiffusionBValueYZ"" FLOAT,
	""DiffusionBValueZZ"" FLOAT,
	""ContributingEquipmentSequence"" VARIANT,
	""StudyInstanceUID"" VARCHAR(16777216),
	""SeriesInstanceUID"" VARCHAR(16777216),
	""StudyID"" VARCHAR(16777216),
	""SeriesNumber"" VARCHAR(16777216),
	""AcquisitionNumber"" VARCHAR(16777216),
	""InstanceNumber"" VARCHAR(16777216),
	""ItemNumber"" VARCHAR(16777216),
	""PatientOrientation"" VARIANT,
	""ImagePosition"" VARIANT,
	""ImagePositionPatient"" VARIANT,
	""ImageOrientation"" VARIANT,
	""ImageOrientationPatient"" VARIANT,
	""Location"" VARCHAR(16777216),
	""FrameOfReferenceUID"" VARCHAR(16777216),
	""Laterality"" VARCHAR(16777216),
	""ImageLaterality"" VARCHAR(16777216),
	""ImageGeometryType"" VARCHAR(16777216),
	""TemporalPositionIdentifier"" VARCHAR(16777216),
	""NumberOfTemporalPositions"" VARCHAR(16777216),
	""TemporalResolution"" VARCHAR(16777216),
	""SynchronizationFrameOfReferenceUID"" VARCHAR(16777216),
	""AcquisitionsInSeries"" VARCHAR(16777216),
	""ImagesInAcquisition"" VARCHAR(16777216),
	""ImagesInSeries"" VARCHAR(16777216),
	""PositionReferenceIndicator"" VARCHAR(16777216),
	""SliceLocation"" VARCHAR(16777216),
	""NumberOfStudyRelatedSeries"" VARCHAR(16777216),
	""NumberOfStudyRelatedInstances"" VARCHAR(16777216),
	""NumberOfSeriesRelatedInstances"" VARCHAR(16777216),
	""ImageComments"" VARCHAR(16777216),
	""OriginalImageIdentification"" VARIANT,
	""OriginalImageIdentificationNomenclature"" VARIANT,
	""StackID"" VARCHAR(16777216),
	""InStackPositionNumber"" NUMBER(38,0),
	""FrameLaterality"" VARCHAR(16777216),
	""TemporalPositionIndex"" NUMBER(38,0),
	""DimensionIndexValues"" VARIANT,
	""FrameComments"" VARCHAR(16777216),
	""ConcatenationUID"" VARCHAR(16777216),
	""DimensionOrganizationUID"" VARCHAR(16777216),
	""DimensionOrganizationSequence"" VARIANT,
	""DimensionIndexSequence"" VARIANT,
	""NominalPercentageOfCardiacPhase"" FLOAT,
	""RespiratoryIntervalTime"" FLOAT,
	""NominalRespiratoryTriggerDelayTime"" FLOAT,
	""RespiratoryTriggerDelayThreshold"" FLOAT,
	""DimensionOrganizationType"" VARCHAR(16777216),
	""SamplesPerPixel"" NUMBER(38,0),
	""PhotometricInterpretation"" VARCHAR(16777216),
	""ImageDimensions"" NUMBER(38,0),
	""PlanarConfiguration"" NUMBER(38,0),
	""NumberOfFrames"" VARCHAR(16777216),
	""FrameIncrementPointer"" VARIANT,
	""Rows"" NUMBER(38,0),
	""Columns"" NUMBER(38,0),
	""Planes"" NUMBER(38,0),
	""UltrasoundColorDataPresent"" NUMBER(38,0),
	""PixelSpacing"" VARIANT,
	""ZoomFactor"" VARIANT,
	""ZoomCenter"" VARIANT,
	""PixelAspectRatio"" VARIANT,
	""ImageFormat"" VARCHAR(16777216),
	""ManipulatedImage"" VARIANT,
	""CorrectedImage"" VARIANT,
	""CompressionCode"" VARCHAR(16777216),
	""BitsAllocated"" NUMBER(38,0),
	""BitsStored"" NUMBER(38,0),
	""HighBit"" NUMBER(38,0),
	""PixelRepresentation"" NUMBER(38,0),
	""SmallestValidPixelValue"" NUMBER(38,0),
	""LargestValidPixelValue"" NUMBER(38,0),
	""SmallestImagePixelValue"" NUMBER(38,0),
	""LargestImagePixelValue"" NUMBER(38,0),
	""SmallestPixelValueInSeries"" NUMBER(38,0),
	""LargestPixelValueInSeries"" NUMBER(38,0),
	""PixelPaddingValue"" NUMBER(38,0),
	""PixelPaddingRangeLimit"" NUMBER(38,0),
	""ImageLocation"" NUMBER(38,0),
	""QualityControlImage"" VARCHAR(16777216),
	""BurnedInAnnotation"" VARCHAR(16777216),
	""RecognizableVisualFeatures"" VARCHAR(16777216),
	""LongitudinalTemporalInformationModified"" VARCHAR(16777216),
	""PixelSpacingCalibrationType"" VARCHAR(16777216),
	""PixelSpacingCalibrationDescription"" VARCHAR(16777216),
	""PixelIntensityRelationship"" VARCHAR(16777216),
	""PixelIntensityRelationshipSign"" NUMBER(38,0),
	""WindowCenter"" VARIANT,
	""WindowWidth"" VARIANT,
	""RescaleIntercept"" VARCHAR(16777216),
	""RescaleSlope"" VARCHAR(16777216),
	""RescaleType"" VARCHAR(16777216),
	""WindowCenterWidthExplanation"" VARIANT,
	""VOILUTFunction"" VARCHAR(16777216),
	""RedPaletteColorLookupTableDescriptor"" VARIANT,
	""GreenPaletteColorLookupTableDescriptor"" VARIANT,
	""BluePaletteColorLookupTableDescriptor"" VARIANT,
	""PaletteColorLookupTableUID"" VARCHAR(16777216),
	""LargePaletteColorLookupTableUID"" VARCHAR(16777216),
	""BreastImplantPresent"" VARCHAR(16777216),
	""PartialView"" VARCHAR(16777216),
	""LossyImageCompression"" VARCHAR(16777216),
	""LossyImageCompressionRatio"" VARIANT,
	""LossyImageCompressionMethod"" VARIANT,
	""LUTExplanation"" VARCHAR(16777216),
	""VOILUTSequence"" VARIANT,
	""SoftcopyVOILUTSequence"" VARIANT,
	""RepresentativeFrameNumber"" NUMBER(38,0),
	""FrameOfInterestDescription"" VARIANT,
	""DataPointRows"" NUMBER(38,0),
	""DataPointColumns"" NUMBER(38,0),
	""StudyStatusID"" VARCHAR(16777216),
	""StudyPriorityID"" VARCHAR(16777216),
	""StudyReadDate"" DATE,
	""StudyReadTime"" TIME(9),
	""ScheduledStudyStartDate"" DATE,
	""ScheduledStudyStartTime"" TIME(9),
	""ScheduledStudyLocation"" VARCHAR(16777216),
	""ScheduledStudyLocationAETitle"" VARIANT,
	""ReasonForStudy"" VARCHAR(16777216),
	""StudyArrivalDate"" DATE,
	""StudyArrivalTime"" TIME(9),
	""StudyCompletionDate"" DATE,
	""StudyCompletionTime"" TIME(9),
	""RequestedProcedureDescription"" VARCHAR(16777216),
	""RequestedProcedureCodeSequence"" VARIANT,
	""RequestedContrastAgent"" VARCHAR(16777216),
	""StudyComments"" VARCHAR(16777216),
	""RouteOfAdmissions"" VARCHAR(16777216),
	""AdmittingDate"" DATE,
	""AdmittingTime"" TIME(9),
	""DischargeTime"" TIME(9),
	""SpecialNeeds"" VARCHAR(16777216),
	""PatientState"" VARCHAR(16777216),
	""ScheduledProcedureStepStartDate"" DATE,
	""ScheduledProcedureStepStartTime"" TIME(9),
	""ScheduledProcedureStepEndDate"" DATE,
	""ScheduledProcedureStepEndTime"" TIME(9),
	""ScheduledProcedureStepDescription"" VARCHAR(16777216),
	""ScheduledProtocolCodeSequence"" VARIANT,
	""ScheduledProcedureStepID"" VARCHAR(16777216),
	""ScheduledStationName"" VARIANT,
	""ScheduledProcedureStepSequence"" VARIANT,
	""PerformedStationAETitle"" VARCHAR(16777216),
	""PerformedStationName"" VARCHAR(16777216),
	""PerformedProcedureStepStartDate"" DATE,
	""PerformedProcedureStepStartTime"" TIME(9),
	""PerformedProcedureStepEndDate"" DATE,
	""PerformedProcedureStepEndTime"" TIME(9),
	""PerformedProcedureStepID"" VARCHAR(16777216),
	""PerformedProcedureStepDescription"" VARCHAR(16777216),
	""PerformedProtocolCodeSequence"" VARIANT,
	""RequestAttributesSequence"" VARIANT,
	""CommentsOnThePerformedProcedureStep"" VARCHAR(16777216),
	""TotalNumberOfExposures"" NUMBER(38,0),
	""EntranceDose"" NUMBER(38,0),
	""ExposedArea"" VARIANT,
	""DistanceSourceToEntrance"" VARCHAR(16777216),
	""ExposureDoseSequence"" VARIANT,
	""CommentsOnRadiationDose"" VARCHAR(16777216),
	""HalfValueLayer"" VARCHAR(16777216),
	""OrganDose"" VARCHAR(16777216),
	""OrganExposed"" VARCHAR(16777216),
	""ContainerIdentifier"" VARCHAR(16777216),
	""ContainerTypeCodeSequence"" VARIANT,
	""AcquisitionContextSequence"" VARIANT,
	""SpecimenDescriptionSequence"" VARIANT,
	""RequestedProcedureID"" VARCHAR(16777216),
	""ReasonForTheRequestedProcedure"" VARCHAR(16777216),
	""RequestedProcedurePriority"" VARCHAR(16777216),
	""ConfidentialityCode"" VARCHAR(16777216),
	""ReasonForRequestedProcedureCodeSequence"" VARIANT,
	""RequestedProcedureComments"" VARCHAR(16777216),
	""ReasonForTheImagingServiceRequest"" VARCHAR(16777216),
	""IssueDateOfImagingServiceRequest"" DATE,
	""IssueTimeOfImagingServiceRequest"" TIME(9),
	""FillerOrderNumberImagingServiceRequest"" VARCHAR(16777216),
	""ImagingServiceRequestComments"" VARCHAR(16777216),
	""ReferencedGeneralPurposeScheduledProcedureStepTransactionUID"" VARCHAR(16777216),
	""EntranceDoseInmGy"" VARCHAR(16777216),
	""ReferencedImageRealWorldValueMappingSequence"" VARIANT,
	""RealWorldValueMappingSequence"" VARIANT,
	""LUTLabel"" VARCHAR(16777216),
	""ObservationDateTime"" NUMBER(38,0),
	""ValueType"" VARCHAR(16777216),
	""ConceptNameCodeSequence"" VARIANT,
	""ContinuityOfContent"" VARCHAR(16777216),
	""VerifyingObserverSequence"" VARIANT,
	""VerifyingObserverName"" VARIANT,
	""DateTime"" NUMBER(38,0),
	""PersonName"" VARIANT,
	UID VARCHAR(16777216),
	""PredecessorDocumentsSequence"" VARIANT,
	""ReferencedRequestSequence"" VARIANT,
	""PerformedProcedureCodeSequence"" VARIANT,
	""CurrentRequestedProcedureEvidenceSequence"" VARIANT,
	""CompletionFlag"" VARCHAR(16777216),
	""VerificationFlag"" VARCHAR(16777216),
	""PreliminaryFlag"" VARCHAR(16777216),
	""ContentTemplateSequence"" VARIANT,
	""ContentSequence"" VARIANT,
	""TemplateExtensionOrganizationUID"" VARCHAR(16777216),
	""TemplateExtensionCreatorUID"" VARCHAR(16777216),
	""MIMETypeOfEncapsulatedDocument"" VARCHAR(16777216),
	""EncapsulatedDocumentLength"" NUMBER(38,0),
	""ImagedVolumeWidth"" FLOAT,
	""ImagedVolumeHeight"" FLOAT,
	""ImagedVolumeDepth"" FLOAT,
	""TotalPixelMatrixColumns"" NUMBER(38,0),
	""TotalPixelMatrixRows"" NUMBER(38,0),
	""TotalPixelMatrixOriginSequence"" VARIANT,
	""SpecimenLabelInImage"" VARCHAR(16777216),
	""FocusMethod"" VARCHAR(16777216),
	""ExtendedDepthOfField"" VARCHAR(16777216),
	""RecommendedAbsentPixelCIELabValue"" VARIANT,
	""ImageOrientationSlide"" VARIANT,
	""OpticalPathSequence"" VARIANT,
	""NumberOfOpticalPaths"" NUMBER(38,0),
	""TotalPixelMatrixFocalPlanes"" NUMBER(38,0),
	""CalibrationImage"" VARCHAR(16777216),
	""EnergyWindowVector"" VARIANT,
	""NumberOfEnergyWindows"" NUMBER(38,0),
	""EnergyWindowInformationSequence"" VARIANT,
	""EnergyWindowRangeSequence"" VARIANT,
	""RadiopharmaceuticalInformationSequence"" VARIANT,
	""DetectorVector"" VARIANT,
	""NumberOfDetectors"" NUMBER(38,0),
	""DetectorInformationSequence"" VARIANT,
	""PhaseVector"" VARIANT,
	""NumberOfPhases"" NUMBER(38,0),
	""PhaseInformationSequence"" VARIANT,
	""NumberOfRotations"" NUMBER(38,0),
	""RotationInformationSequence"" VARIANT,
	""NumberOfRRIntervals"" NUMBER(38,0),
	""NumberOfTimeSlots"" NUMBER(38,0),
	""SliceVector"" VARIANT,
	""NumberOfSlices"" NUMBER(38,0),
	""TimeSliceVector"" VARIANT,
	""NumberOfTimeSlices"" NUMBER(38,0),
	""TypeOfDetectorMotion"" VARCHAR(16777216),
	""ViewCodeSequence"" VARIANT,
	""ViewModifierCodeSequence"" VARIANT,
	""ImageID"" VARCHAR(16777216),
	""PatientOrientationCodeSequence"" VARIANT,
	""PatientOrientationModifierCodeSequence"" VARIANT,
	""PatientGantryRelationshipCodeSequence"" VARIANT,
	""ScanProgressionDirection"" VARCHAR(16777216),
	""SeriesType"" VARIANT,
	""Units"" VARCHAR(16777216),
	""CountsSource"" VARCHAR(16777216),
	""ReprojectionMethod"" VARCHAR(16777216),
	""RandomsCorrectionMethod"" VARCHAR(16777216),
	""AttenuationCorrectionMethod"" VARCHAR(16777216),
	""DecayCorrection"" VARCHAR(16777216),
	""ReconstructionMethod"" VARCHAR(16777216),
	""DetectorLinesOfResponseUsed"" VARCHAR(16777216),
	""ScatterCorrectionMethod"" VARCHAR(16777216),
	""AxialAcceptance"" VARCHAR(16777216),
	""AxialMash"" VARIANT,
	""TransverseMash"" VARCHAR(16777216),
	""CoincidenceWindowWidth"" VARCHAR(16777216),
	""SecondaryCountsType"" VARIANT,
	""FrameReferenceTime"" VARCHAR(16777216),
	""PrimaryPromptsCountsAccumulated"" VARCHAR(16777216),
	""SecondaryCountsAccumulated"" VARIANT,
	""SliceSensitivityFactor"" VARCHAR(16777216),
	""DecayFactor"" VARCHAR(16777216),
	""DoseCalibrationFactor"" VARCHAR(16777216),
	""ScatterFractionFactor"" VARCHAR(16777216),
	""DeadTimeFactor"" VARCHAR(16777216),
	""ImageIndex"" NUMBER(38,0),
	""HistogramSequence"" VARIANT,
	""SegmentationType"" VARCHAR(16777216),
	""SegmentSequence"" VARIANT,
	""MaximumFractionalValue"" NUMBER(38,0),
	""SegmentationFractionalType"" VARCHAR(16777216),
	""SegmentsOverlap"" VARCHAR(16777216),
	""ImageRotation"" NUMBER(38,0),
	""DisplayedAreaSelectionSequence"" VARIANT,
	""GraphicLayerSequence"" VARIANT,
	""ContentLabel"" VARCHAR(16777216),
	""ContentDescription"" VARCHAR(16777216),
	""PresentationCreationDate"" DATE,
	""PresentationCreationTime"" TIME(9),
	""ContentCreatorName"" VARIANT,
	""RegistrationSequence"" VARIANT,
	""FiducialUID"" VARCHAR(16777216),
	""RelativeOpacity"" FLOAT,
	""AdvancedBlendingSequence"" VARIANT,
	""BlendingDisplaySequence"" VARIANT,
	""StorageMediaFileSetUID"" VARCHAR(16777216),
	""IconImageSequence"" VARIANT,
	""DigitalSignatureUID"" VARCHAR(16777216),
	""ImageDisplayFormat"" VARCHAR(16777216),
	""AnnotationDisplayFormatID"" VARCHAR(16777216),
	""FilmOrientation"" VARCHAR(16777216),
	""BorderDensity"" VARCHAR(16777216),
	""Trim"" VARCHAR(16777216),
	""ImageBoxPosition"" NUMBER(38,0),
	""PresentationLUTShape"" VARCHAR(16777216),
	""DoseUnits"" VARCHAR(16777216),
	""DoseType"" VARCHAR(16777216),
	""DoseComment"" VARCHAR(16777216),
	""DoseSummationType"" VARCHAR(16777216),
	""GridFrameOffsetVector"" VARIANT,
	""DoseGridScaling"" VARCHAR(16777216),
	""TissueHeterogeneityCorrection"" VARIANT,
	""StructureSetLabel"" VARCHAR(16777216),
	""StructureSetName"" VARCHAR(16777216),
	""StructureSetDate"" DATE,
	""StructureSetTime"" TIME(9),
	""ReferencedFrameOfReferenceSequence"" VARIANT,
	""StructureSetROISequence"" VARIANT,
	""ReferencedFrameOfReferenceUID"" VARCHAR(16777216),
	""ROIContourSequence"" VARIANT,
	""RTROIObservationsSequence"" VARIANT,
	""RelatedFrameOfReferenceUID"" VARCHAR(16777216),
	""RTPlanLabel"" VARCHAR(16777216),
	""RTPlanName"" VARCHAR(16777216),
	""RTPlanDescription"" VARCHAR(16777216),
	""RTPlanDate"" DATE,
	""RTPlanGeometry"" VARCHAR(16777216),
	""DoseReferenceSequence"" VARIANT,
	""DoseReferenceUID"" VARCHAR(16777216),
	""FractionGroupSequence"" VARIANT,
	""BeamSequence"" VARIANT,
	""GantryAngle"" VARCHAR(16777216),
	""PatientSupportAngle"" VARCHAR(16777216),
	""TableTopLongitudinalPosition"" VARCHAR(16777216),
	""TableTopLateralPosition"" VARCHAR(16777216),
	""TableTopPitchAngle"" FLOAT,
	""TableTopRollAngle"" FLOAT,
	""PatientSetupSequence"" VARIANT,
	""PatientSetupNumber"" VARCHAR(16777216),
	""ReferencedRTPlanSequence"" VARIANT,
	""ReferencedStructureSetSequence"" VARIANT,
	""ApprovalStatus"" VARCHAR(16777216),
	""InterpretationTypeID"" VARCHAR(16777216),
	""InterpretationStatusID"" VARCHAR(16777216),
	""CurveDimensions"" VARIANT,
	""NumberOfPoints"" VARIANT,
	""TypeOfData"" VARIANT,
	""DataValueRepresentation"" VARIANT,
	""SharedFunctionalGroupsSequence"" VARIANT,
	""PerFrameFunctionalGroupsSequence"" VARIANT,
	""OverlayRows"" VARIANT,
	""OverlayColumns"" VARIANT,
	""NumberOfFramesInOverlay"" VARIANT,
	""OverlayDescription"" VARIANT,
	""OverlayType"" VARIANT,
	""OverlayOrigin"" VARIANT,
	""ImageFrameOrigin"" VARIANT,
	""OverlayBitsAllocated"" VARIANT,
	""OverlayBitPosition"" VARIANT,
	""Tag_00091110"" VARIANT,
	""Tag_00291032"" VARIANT,
	""Tag_00291140"" VARIANT,
	""Tag_00551012"" VARIANT,
	""Tag_00551022"" VARIANT,
	""Tag_01171010"" VARIANT,
	""Tag_01171020"" VARIANT,
	""Tag_01171022"" VARIANT,
	""Tag_01171024"" VARIANT,
	""Tag_011710B0"" VARIANT,
	""Tag_01191180"" VARIANT,
	""Tag_01F31001"" VARIANT,
	""Tag_01F31011"" VARIANT,
	""Tag_2001105F"" VARIANT,
	""Tag_20019000"" VARIANT,
	""Tag_20051080"" VARIANT,
	""Tag_20051084"" VARIANT,
	""Tag_20051085"" VARIANT,
	""Tag_20051132"" VARIANT,
	""Tag_20051402"" VARIANT,
	""Tag_2005140E"" VARIANT,
	""Tag_2005140F"" VARIANT,
	""OtherElements"" VARIANT,
	""DroppedTags"" VARIANT,
	""Type"" VARCHAR(16777216),
	""LastUpdated"" NUMBER(38,0),
	""StorageClass"" VARCHAR(16777216),
	""BlobStorageSize"" NUMBER(38,0)
);"

,1
table_name,DICOM_METADATA_CURATED
description,
DDL,"create or replace TABLE DICOM_METADATA_CURATED (
	""SOPInstanceUID"" VARCHAR(16777216),
	""SliceThickness"" FLOAT,
	""BodyPartExamined"" VARCHAR(16777216)
);"

,2
table_name,AUXILIARY_METADATA
description,
DDL,"create or replace TABLE AUXILIARY_METADATA (
	""collection_name"" VARCHAR(16777216),
	""collection_id"" VARCHAR(16777216),
	""collection_timestamp"" NUMBER(38,0),
	""collection_hash"" VARCHAR(16777216),
	""collection_init_idc_version"" NUMBER(38,0),
	""collection_revised_idc_version"" NUMBER(38,0),
	""submitter_case_id"" VARCHAR(16777216),
	""idc_case_id"" VARCHAR(16777216),
	""patient_hash"" VARCHAR(16777216),
	""patient_init_idc_version"" NUMBER(38,0),
	""patient_revised_idc_version"" NUMBER(38,0),
	""StudyInstanceUID"" VARCHAR(16777216),
	""study_uuid"" VARCHAR(16777216),
	""study_instances"" NUMBER(38,0),
	""study_hash"" VARCHAR(16777216),
	""study_init_idc_version"" NUMBER(38,0),
	""study_revised_idc_version"" NUMBER(38,0),
	""study_final_idc_version"" NUMBER(38,0),
	""SeriesInstanceUID"" VARCHAR(16777216),
	""series_uuid"" VARCHAR(16777216),
	""series_gcs_url"" VARCHAR(16777216),
	""series_aws_url"" VARCHAR(16777216),
	""source_doi"" VARCHAR(16777216),
	""source_url"" VARCHAR(16777216),
	""series_instances"" NUMBER(38,0),
	""series_hash"" VARCHAR(16777216),
	""access"" VARCHAR(16777216),
	""series_init_idc_version"" NUMBER(38,0),
	""series_revised_idc_version"" NUMBER(38,0),
	""series_final_idc_version"" NUMBER(38,0),
	""SOPInstanceUID"" VARCHAR(16777216),
	""instance_uuid"" VARCHAR(16777216),
	""gcs_url"" VARCHAR(16777216),
	""gcs_bucket"" VARCHAR(16777216),
	""aws_url"" VARCHAR(16777216),
	""aws_bucket"" VARCHAR(16777216),
	""instance_size"" NUMBER(38,0),
	""instance_hash"" VARCHAR(16777216),
	""instance_init_idc_version"" NUMBER(38,0),
	""instance_revised_idc_version"" NUMBER(38,0),
	""instance_final_idc_version"" NUMBER(38,0),
	""license_url"" VARCHAR(16777216),
	""license_long_name"" VARCHAR(16777216),
	""license_short_name"" VARCHAR(16777216),
	""tcia_api_collection_id"" VARCHAR(16777216),
	""idc_webapp_collection_id"" VARCHAR(16777216)
);"

,3
table_name,DICOM_ALL
description,
DDL,"create or replace TABLE DICOM_ALL (
	""collection_name"" VARCHAR(16777216),
	""collection_id"" VARCHAR(16777216),
	""collection_timestamp"" NUMBER(38,0),
	""collection_hash"" VARCHAR(16777216),
	""collection_init_idc_version"" NUMBER(38,0),
	""collection_revised_idc_version"" NUMBER(38,0),
	""collection_tumorLocation"" VARCHAR(16777216),
	""collection_species"" VARCHAR(16777216),
	""collection_cancerType"" VARCHAR(16777216),
	""access"" VARCHAR(16777216),
	""PatientID"" VARCHAR(16777216),
	""idc_case_id"" VARCHAR(16777216),
	""patient_hash"" VARCHAR(16777216),
	""patient_init_idc_version"" NUMBER(38,0),
	""patient_revised_idc_version"" NUMBER(38,0),
	""StudyInstanceUID"" VARCHAR(16777216),
	""crdc_study_uuid"" VARCHAR(16777216),
	""study_hash"" VARCHAR(16777216),
	""study_init_idc_version"" NUMBER(38,0),
	""study_revised_idc_version"" NUMBER(38,0),
	""SeriesInstanceUID"" VARCHAR(16777216),
	""crdc_series_uuid"" VARCHAR(16777216),
	""series_gcs_url"" VARCHAR(16777216),
	""series_aws_url"" VARCHAR(16777216),
	""series_hash"" VARCHAR(16777216),
	""series_init_idc_version"" NUMBER(38,0),
	""series_revised_idc_version"" NUMBER(38,0),
	""SOPInstanceUID"" VARCHAR(16777216),
	""crdc_instance_uuid"" VARCHAR(16777216),
	""gcs_url"" VARCHAR(16777216),
	""gcs_bucket"" VARCHAR(16777216),
	""aws_url"" VARCHAR(16777216),
	""aws_bucket"" VARCHAR(16777216),
	""instance_size"" NUMBER(38,0),
	""instance_hash"" VARCHAR(16777216),
	""instance_init_idc_version"" NUMBER(38,0),
	""instance_revised_idc_version"" NUMBER(38,0),
	""Source_DOI"" VARCHAR(16777216),
	""Source_URL"" VARCHAR(16777216),
	""license_url"" VARCHAR(16777216),
	""license_long_name"" VARCHAR(16777216),
	""license_short_name"" VARCHAR(16777216),
	""tcia_api_collection_id"" VARCHAR(16777216),
	""idc_webapp_collection_id"" VARCHAR(16777216),
	""tcia_tumorLocation"" VARCHAR(16777216),
	""tcia_species"" VARCHAR(16777216),
	""tcia_cancerType"" VARCHAR(16777216),
	""MediaStorageSOPClassUID"" VARCHAR(16777216),
	""MediaStorageSOPInstanceUID"" VARCHAR(16777216),
	""TransferSyntaxUID"" VARCHAR(16777216),
	""ImplementationClassUID"" VARCHAR(16777216),
	""ImplementationVersionName"" VARCHAR(16777216),
	""SourceApplicationEntityTitle"" VARCHAR(16777216),
	""ReferencedFileID"" VARIANT,
	""ReferencedSOPInstanceUIDInFile"" VARCHAR(16777216),
	""LengthToEnd"" NUMBER(38,0),
	""SpecificCharacterSet"" VARIANT,
	""ImageType"" VARIANT,
	""RecognitionCode"" VARCHAR(16777216),
	""InstanceCreationDate"" DATE,
	""InstanceCreationTime"" TIME(9),
	""InstanceCreatorUID"" VARCHAR(16777216),
	""SOPClassUID"" VARCHAR(16777216),
	""OriginalSpecializedSOPClassUID"" VARCHAR(16777216),
	""StudyDate"" DATE,
	""SeriesDate"" DATE,
	""AcquisitionDate"" DATE,
	""ContentDate"" DATE,
	""OverlayDate"" DATE,
	""CurveDate"" DATE,
	""AcquisitionDateTime"" NUMBER(38,0),
	""StudyTime"" TIME(9),
	""SeriesTime"" TIME(9),
	""AcquisitionTime"" TIME(9),
	""ContentTime"" TIME(9),
	""DataSetType"" NUMBER(38,0),
	""DataSetSubtype"" VARCHAR(16777216),
	""AccessionNumber"" VARCHAR(16777216),
	""IssuerOfAccessionNumberSequence"" VARIANT,
	""RetrieveAETitle"" VARIANT,
	""FailedSOPInstanceUIDList"" VARIANT,
	""Modality"" VARCHAR(16777216),
	""ModalitiesInStudy"" VARIANT,
	""ConversionType"" VARCHAR(16777216),
	""PresentationIntentType"" VARCHAR(16777216),
	""Manufacturer"" VARCHAR(16777216),
	""InstitutionName"" VARCHAR(16777216),
	""InstitutionAddress"" VARCHAR(16777216),
	""ReferringPhysicianName"" VARIANT,
	""ReferringPhysicianAddress"" VARCHAR(16777216),
	""ReferringPhysicianTelephoneNumbers"" VARIANT,
	""CodeValue"" VARCHAR(16777216),
	""CodingSchemeDesignator"" VARCHAR(16777216),
	""CodingSchemeUID"" VARCHAR(16777216),
	""ContextGroupExtensionCreatorUID"" VARCHAR(16777216),
	""ContextIdentifier"" VARCHAR(16777216),
	""CodingSchemeIdentificationSequence"" VARIANT,
	""ContextGroupIdentificationSequence"" VARIANT,
	""MappingResourceIdentificationSequence"" VARIANT,
	""TimezoneOffsetFromUTC"" VARCHAR(16777216),
	""StationName"" VARCHAR(16777216),
	""StudyDescription"" VARCHAR(16777216),
	""ProcedureCodeSequence"" VARIANT,
	""SeriesDescription"" VARCHAR(16777216),
	""InstitutionalDepartmentName"" VARCHAR(16777216),
	""PerformingPhysicianName"" VARIANT,
	""OperatorsName"" VARIANT,
	""AdmittingDiagnosesDescription"" VARIANT,
	""AdmittingDiagnosesCodeSequence"" VARIANT,
	""ManufacturerModelName"" VARCHAR(16777216),
	""ReferencedStudySequence"" VARIANT,
	""ReferencedPerformedProcedureStepSequence"" VARIANT,
	""ReferencedSeriesSequence"" VARIANT,
	""ReferencedPatientSequence"" VARIANT,
	""ReferencedImageSequence"" VARIANT,
	""ReferencedSOPClassUID"" VARCHAR(16777216),
	""ReferencedSOPInstanceUID"" VARCHAR(16777216),
	""TransactionUID"" VARCHAR(16777216),
	""StudiesContainingOtherReferencedInstancesSequence"" VARIANT,
	""RelatedSeriesSequence"" VARIANT,
	""LossyImageCompressionRetired"" VARCHAR(16777216),
	""DerivationDescription"" VARCHAR(16777216),
	""SourceImageSequence"" VARIANT,
	""StartTrim"" VARCHAR(16777216),
	""StopTrim"" VARCHAR(16777216),
	""RecommendedDisplayFrameRate"" VARCHAR(16777216),
	""AnatomicRegionSequence"" VARIANT,
	""IrradiationEventUID"" VARIANT,
	""SourceIrradiationEventSequence"" VARIANT,
	""FrameType"" VARIANT,
	""ReferencedImageEvidenceSequence"" VARIANT,
	""ReferencedRawDataSequence"" VARIANT,
	""CreatorVersionUID"" VARCHAR(16777216),
	""DerivationImageSequence"" VARIANT,
	""PixelPresentation"" VARCHAR(16777216),
	""VolumetricProperties"" VARCHAR(16777216),
	""VolumeBasedCalculationTechnique"" VARCHAR(16777216),
	""ComplexImageComponent"" VARCHAR(16777216),
	""AcquisitionContrast"" VARCHAR(16777216),
	""DerivationCodeSequence"" VARIANT,
	""PatientName"" VARIANT,
	""IssuerOfPatientID"" VARCHAR(16777216),
	""TypeOfPatientID"" VARCHAR(16777216),
	""IssuerOfPatientIDQualifiersSequence"" VARIANT,
	""SourcePatientGroupIdentificationSequence"" VARIANT,
	""PatientBirthDate"" DATE,
	""PatientBirthTime"" TIME(9),
	""PatientSex"" VARCHAR(16777216),
	""QualityControlSubject"" VARCHAR(16777216),
	""StrainDescription"" VARCHAR(16777216),
	""StrainNomenclature"" VARCHAR(16777216),
	""StrainCodeSequence"" VARIANT,
	""OtherPatientIDs"" VARIANT,
	""PatientAge"" VARCHAR(16777216),
	""PatientSize"" VARCHAR(16777216),
	""PatientWeight"" VARCHAR(16777216),
	""PatientAddress"" VARCHAR(16777216),
	""MedicalAlerts"" VARIANT,
	""Allergies"" VARIANT,
	""PatientTelephoneNumbers"" VARIANT,
	""EthnicGroup"" VARCHAR(16777216),
	""Occupation"" VARCHAR(16777216),
	""SmokingStatus"" VARCHAR(16777216),
	""AdditionalPatientHistory"" VARCHAR(16777216),
	""PregnancyStatus"" NUMBER(38,0),
	""LastMenstrualDate"" DATE,
	""PatientSpeciesDescription"" VARCHAR(16777216),
	""PatientSpeciesCodeSequence"" VARIANT,
	""PatientSexNeutered"" VARCHAR(16777216),
	""AnatomicalOrientationType"" VARCHAR(16777216),
	""PatientBreedDescription"" VARCHAR(16777216),
	""PatientBreedCodeSequence"" VARIANT,
	""ResponsibleOrganization"" VARCHAR(16777216),
	""PatientComments"" VARCHAR(16777216),
	""ClinicalTrialSponsorName"" VARCHAR(16777216),
	""ClinicalTrialProtocolID"" VARCHAR(16777216),
	""ClinicalTrialProtocolName"" VARCHAR(16777216),
	""ClinicalTrialSiteID"" VARCHAR(16777216),
	""ClinicalTrialSiteName"" VARCHAR(16777216),
	""ClinicalTrialSubjectID"" VARCHAR(16777216),
	""ClinicalTrialSubjectReadingID"" VARCHAR(16777216),
	""ClinicalTrialTimePointID"" VARCHAR(16777216),
	""ClinicalTrialTimePointDescription"" VARCHAR(16777216),
	""LongitudinalTemporalOffsetFromEvent"" FLOAT,
	""LongitudinalTemporalEventType"" VARCHAR(16777216),
	""ClinicalTrialCoordinatingCenterName"" VARCHAR(16777216),
	""PatientIdentityRemoved"" VARCHAR(16777216),
	""DeidentificationMethod"" VARIANT,
	""DeidentificationMethodCodeSequence"" VARIANT,
	""ClinicalTrialSeriesID"" VARCHAR(16777216),
	""FNumber"" VARCHAR(16777216),
	""FocalLength"" VARCHAR(16777216),
	""LensSpecification"" VARIANT,
	""LensMake"" VARCHAR(16777216),
	""LensModel"" VARCHAR(16777216),
	""ContrastBolusAgent"" VARCHAR(16777216),
	""BodyPartExamined"" VARCHAR(16777216),
	""ScanningSequence"" VARIANT,
	""SequenceVariant"" VARIANT,
	""ScanOptions"" VARIANT,
	""MRAcquisitionType"" VARCHAR(16777216),
	""SequenceName"" VARCHAR(16777216),
	""AngioFlag"" VARCHAR(16777216),
	""InterventionDrugInformationSequence"" VARIANT,
	""Radiopharmaceutical"" VARCHAR(16777216),
	""CineRate"" VARCHAR(16777216),
	""SliceThickness"" VARCHAR(16777216),
	KVP VARCHAR(16777216),
	""CountsAccumulated"" VARCHAR(16777216),
	""AcquisitionTerminationCondition"" VARCHAR(16777216),
	""EffectiveDuration"" VARCHAR(16777216),
	""AcquisitionStartCondition"" VARCHAR(16777216),
	""AcquisitionStartConditionData"" VARCHAR(16777216),
	""AcquisitionTerminationConditionData"" VARCHAR(16777216),
	""RepetitionTime"" VARCHAR(16777216),
	""EchoTime"" VARCHAR(16777216),
	""InversionTime"" VARCHAR(16777216),
	""NumberOfAverages"" VARCHAR(16777216),
	""ImagingFrequency"" VARCHAR(16777216),
	""ImagedNucleus"" VARCHAR(16777216),
	""EchoNumbers"" VARIANT,
	""MagneticFieldStrength"" VARCHAR(16777216),
	""SpacingBetweenSlices"" VARCHAR(16777216),
	""NumberOfPhaseEncodingSteps"" VARCHAR(16777216),
	""DataCollectionDiameter"" VARCHAR(16777216),
	""EchoTrainLength"" VARCHAR(16777216),
	""PercentSampling"" VARCHAR(16777216),
	""PercentPhaseFieldOfView"" VARCHAR(16777216),
	""PixelBandwidth"" VARCHAR(16777216),
	""DeviceSerialNumber"" VARCHAR(16777216),
	""DeviceUID"" VARCHAR(16777216),
	""PlateID"" VARCHAR(16777216),
	""GantryID"" VARCHAR(16777216),
	""SecondaryCaptureDeviceID"" VARCHAR(16777216),
	""DateOfSecondaryCapture"" DATE,
	""TimeOfSecondaryCapture"" TIME(9),
	""SecondaryCaptureDeviceManufacturer"" VARCHAR(16777216),
	""SecondaryCaptureDeviceManufacturerModelName"" VARCHAR(16777216),
	""SecondaryCaptureDeviceSoftwareVersions"" VARIANT,
	""SoftwareVersions"" VARIANT,
	""VideoImageFormatAcquired"" VARCHAR(16777216),
	""DigitalImageFormatAcquired"" VARCHAR(16777216),
	""ProtocolName"" VARCHAR(16777216),
	""ContrastBolusRoute"" VARCHAR(16777216),
	""ContrastBolusVolume"" VARCHAR(16777216),
	""ContrastBolusStartTime"" TIME(9),
	""ContrastBolusStopTime"" TIME(9),
	""ContrastBolusTotalDose"" VARCHAR(16777216),
	""ContrastFlowRate"" VARIANT,
	""ContrastFlowDuration"" VARIANT,
	""ContrastBolusIngredient"" VARCHAR(16777216),
	""ContrastBolusIngredientConcentration"" VARCHAR(16777216),
	""SpatialResolution"" VARCHAR(16777216),
	""TriggerTime"" VARCHAR(16777216),
	""TriggerSourceOrType"" VARCHAR(16777216),
	""NominalInterval"" VARCHAR(16777216),
	""FrameTime"" VARCHAR(16777216),
	""CardiacFramingType"" VARCHAR(16777216),
	""FrameDelay"" VARCHAR(16777216),
	""SynchronizationTrigger"" VARCHAR(16777216),
	""RadiopharmaceuticalVolume"" VARCHAR(16777216),
	""RadiopharmaceuticalStartTime"" TIME(9),
	""RadionuclideTotalDose"" VARCHAR(16777216),
	""BeatRejectionFlag"" VARCHAR(16777216),
	""LowRRValue"" VARCHAR(16777216),
	""HighRRValue"" VARCHAR(16777216),
	""IntervalsAcquired"" VARCHAR(16777216),
	""IntervalsRejected"" VARCHAR(16777216),
	""PVCRejection"" VARCHAR(16777216),
	""SkipBeats"" VARCHAR(16777216),
	""HeartRate"" VARCHAR(16777216),
	""CardiacNumberOfImages"" VARCHAR(16777216),
	""TriggerWindow"" VARCHAR(16777216),
	""ReconstructionDiameter"" VARCHAR(16777216),
	""DistanceSourceToDetector"" VARCHAR(16777216),
	""DistanceSourceToPatient"" VARCHAR(16777216),
	""EstimatedRadiographicMagnificationFactor"" VARCHAR(16777216),
	""GantryDetectorTilt"" VARCHAR(16777216),
	""GantryDetectorSlew"" VARCHAR(16777216),
	""TableHeight"" VARCHAR(16777216),
	""TableTraverse"" VARCHAR(16777216),
	""RotationDirection"" VARCHAR(16777216),
	""AngularPosition"" VARCHAR(16777216),
	""ScanArc"" VARCHAR(16777216),
	""FieldOfViewShape"" VARCHAR(16777216),
	""FieldOfViewDimensions"" VARIANT,
	""ExposureTime"" VARCHAR(16777216),
	""XRayTubeCurrent"" VARCHAR(16777216),
	""Exposure"" VARCHAR(16777216),
	""ExposureInuAs"" VARCHAR(16777216),
	""AveragePulseWidth"" VARCHAR(16777216),
	""RadiationSetting"" VARCHAR(16777216),
	""RectificationType"" VARCHAR(16777216),
	""RadiationMode"" VARCHAR(16777216),
	""ImageAndFluoroscopyAreaDoseProduct"" VARCHAR(16777216),
	""FilterType"" VARCHAR(16777216),
	""IntensifierSize"" VARCHAR(16777216),
	""ImagerPixelSpacing"" VARIANT,
	""Grid"" VARIANT,
	""GeneratorPower"" VARCHAR(16777216),
	""CollimatorGridName"" VARCHAR(16777216),
	""CollimatorType"" VARCHAR(16777216),
	""XFocusCenter"" VARIANT,
	""YFocusCenter"" VARIANT,
	""FocalSpots"" VARIANT,
	""AnodeTargetMaterial"" VARCHAR(16777216),
	""BodyPartThickness"" VARCHAR(16777216),
	""CompressionForce"" VARCHAR(16777216),
	""PaddleDescription"" VARCHAR(16777216),
	""DateOfLastCalibration"" VARIANT,
	""TimeOfLastCalibration"" VARIANT,
	""ConvolutionKernel"" VARIANT,
	""ActualFrameDuration"" VARCHAR(16777216),
	""CountRate"" VARCHAR(16777216),
	""PreferredPlaybackSequencing"" NUMBER(38,0),
	""ReceiveCoilName"" VARCHAR(16777216),
	""TransmitCoilName"" VARCHAR(16777216),
	""PlateType"" VARCHAR(16777216),
	""ScanVelocity"" VARCHAR(16777216),
	""WholeBodyTechnique"" VARIANT,
	""ScanLength"" VARCHAR(16777216),
	""AcquisitionMatrix"" VARIANT,
	""InPlanePhaseEncodingDirection"" VARCHAR(16777216),
	""FlipAngle"" VARCHAR(16777216),
	""VariableFlipAngleFlag"" VARCHAR(16777216),
	SAR VARCHAR(16777216),
	""dBdt"" VARCHAR(16777216),
	""B1rms"" FLOAT,
	""AcquisitionDeviceProcessingDescription"" VARCHAR(16777216),
	""AcquisitionDeviceProcessingCode"" VARCHAR(16777216),
	""CassetteOrientation"" VARCHAR(16777216),
	""CassetteSize"" VARCHAR(16777216),
	""ExposuresOnPlate"" NUMBER(38,0),
	""RelativeXRayExposure"" VARCHAR(16777216),
	""ExposureIndex"" VARCHAR(16777216),
	""TargetExposureIndex"" VARCHAR(16777216),
	""DeviationIndex"" VARCHAR(16777216),
	""TomoLayerHeight"" VARCHAR(16777216),
	""TomoAngle"" VARCHAR(16777216),
	""TomoTime"" VARCHAR(16777216),
	""TomoType"" VARCHAR(16777216),
	""TomoClass"" VARCHAR(16777216),
	""NumberOfTomosynthesisSourceImages"" VARCHAR(16777216),
	""PositionerMotion"" VARCHAR(16777216),
	""PositionerType"" VARCHAR(16777216),
	""PositionerPrimaryAngle"" VARCHAR(16777216),
	""PositionerSecondaryAngle"" VARCHAR(16777216),
	""DetectorSecondaryAngle"" VARCHAR(16777216),
	""ShutterShape"" VARIANT,
	""ShutterLeftVerticalEdge"" VARCHAR(16777216),
	""ShutterRightVerticalEdge"" VARCHAR(16777216),
	""ShutterUpperHorizontalEdge"" VARCHAR(16777216),
	""ShutterLowerHorizontalEdge"" VARCHAR(16777216),
	""CenterOfCircularShutter"" VARIANT,
	""RadiusOfCircularShutter"" VARCHAR(16777216),
	""VerticesOfThePolygonalShutter"" VARIANT,
	""ShutterPresentationValue"" NUMBER(38,0),
	""CollimatorShape"" VARIANT,
	""CollimatorLeftVerticalEdge"" VARCHAR(16777216),
	""CollimatorRightVerticalEdge"" VARCHAR(16777216),
	""CollimatorUpperHorizontalEdge"" VARCHAR(16777216),
	""CollimatorLowerHorizontalEdge"" VARCHAR(16777216),
	""VerticesOfThePolygonalCollimator"" VARIANT,
	""AcquisitionTimeSynchronized"" VARCHAR(16777216),
	""NominalScannedPixelSpacing"" VARIANT,
	""AcquisitionComments"" VARCHAR(16777216),
	""TransducerData"" VARIANT,
	""ProcessingFunction"" VARCHAR(16777216),
	""PostprocessingFunction"" VARCHAR(16777216),
	""MechanicalIndex"" VARCHAR(16777216),
	""BoneThermalIndex"" VARCHAR(16777216),
	""SoftTissueThermalIndex"" VARCHAR(16777216),
	""PatientPosition"" VARCHAR(16777216),
	""ViewPosition"" VARCHAR(16777216),
	""Sensitivity"" VARCHAR(16777216),
	""SequenceOfUltrasoundRegions"" VARIANT,
	""TransducerType"" VARCHAR(16777216),
	""DetectorConditionsNominalFlag"" VARCHAR(16777216),
	""DetectorTemperature"" VARCHAR(16777216),
	""DetectorType"" VARCHAR(16777216),
	""DetectorConfiguration"" VARCHAR(16777216),
	""DetectorDescription"" VARCHAR(16777216),
	""DetectorMode"" VARCHAR(16777216),
	""DetectorID"" VARCHAR(16777216),
	""DateOfLastDetectorCalibration"" DATE,
	""TimeOfLastDetectorCalibration"" TIME(9),
	""ExposuresOnDetectorSinceLastCalibration"" VARCHAR(16777216),
	""ExposuresOnDetectorSinceManufactured"" VARCHAR(16777216),
	""DetectorTimeSinceLastExposure"" VARCHAR(16777216),
	""DetectorActiveTime"" VARCHAR(16777216),
	""DetectorBinning"" VARIANT,
	""DetectorElementPhysicalSize"" VARIANT,
	""DetectorElementSpacing"" VARIANT,
	""DetectorActiveShape"" VARCHAR(16777216),
	""DetectorActiveDimensions"" VARIANT,
	""DetectorManufacturerName"" VARCHAR(16777216),
	""DetectorManufacturerModelName"" VARCHAR(16777216),
	""FieldOfViewOrigin"" VARIANT,
	""FieldOfViewRotation"" VARCHAR(16777216),
	""FieldOfViewHorizontalFlip"" VARCHAR(16777216),
	""GridAspectRatio"" VARIANT,
	""GridFocalDistance"" VARCHAR(16777216),
	""FilterMaterial"" VARIANT,
	""FilterThicknessMinimum"" VARIANT,
	""FilterThicknessMaximum"" VARIANT,
	""ExposureControlMode"" VARCHAR(16777216),
	""ExposureControlModeDescription"" VARCHAR(16777216),
	""ExposureStatus"" VARCHAR(16777216),
	""ExposureTimeInuS"" VARCHAR(16777216),
	""XRayTubeCurrentInuA"" VARCHAR(16777216),
	""ContentQualification"" VARCHAR(16777216),
	""PulseSequenceName"" VARCHAR(16777216),
	""EchoPulseSequence"" VARCHAR(16777216),
	""InversionRecovery"" VARCHAR(16777216),
	""MultipleSpinEcho"" VARCHAR(16777216),
	""MultiPlanarExcitation"" VARCHAR(16777216),
	""PhaseContrast"" VARCHAR(16777216),
	""TimeOfFlightContrast"" VARCHAR(16777216),
	""Spoiling"" VARCHAR(16777216),
	""SteadyStatePulseSequence"" VARCHAR(16777216),
	""EchoPlanarPulseSequence"" VARCHAR(16777216),
	""TagAngleFirstAxis"" FLOAT,
	""MagnetizationTransfer"" VARCHAR(16777216),
	""T2Preparation"" VARCHAR(16777216),
	""BloodSignalNulling"" VARCHAR(16777216),
	""SaturationRecovery"" VARCHAR(16777216),
	""SpectrallySelectedSuppression"" VARCHAR(16777216),
	""SpectrallySelectedExcitation"" VARCHAR(16777216),
	""SpatialPresaturation"" VARCHAR(16777216),
	""Tagging"" VARCHAR(16777216),
	""OversamplingPhase"" VARCHAR(16777216),
	""TagSpacingFirstDimension"" FLOAT,
	""GeometryOfKSpaceTraversal"" VARCHAR(16777216),
	""SegmentedKSpaceTraversal"" VARCHAR(16777216),
	""RectilinearPhaseEncodeReordering"" VARCHAR(16777216),
	""TagThickness"" FLOAT,
	""PartialFourierDirection"" VARCHAR(16777216),
	""CardiacSynchronizationTechnique"" VARCHAR(16777216),
	""ReceiveCoilType"" VARCHAR(16777216),
	""QuadratureReceiveCoil"" VARCHAR(16777216),
	""MultiCoilDefinitionSequence"" VARIANT,
	""MultiCoilElementName"" VARCHAR(16777216),
	""TransmitCoilType"" VARCHAR(16777216),
	""ChemicalShiftReference"" VARIANT,
	""MRAcquisitionFrequencyEncodingSteps"" NUMBER(38,0),
	""Decoupling"" VARCHAR(16777216),
	""KSpaceFiltering"" VARCHAR(16777216),
	""ParallelReductionFactorInPlane"" FLOAT,
	""AcquisitionDuration"" FLOAT,
	""FrameAcquisitionDateTime"" NUMBER(38,0),
	""DiffusionDirectionality"" VARCHAR(16777216),
	""ParallelAcquisition"" VARCHAR(16777216),
	""ParallelAcquisitionTechnique"" VARCHAR(16777216),
	""InversionTimes"" VARIANT,
	""MetaboliteMapDescription"" VARCHAR(16777216),
	""PartialFourier"" VARCHAR(16777216),
	""EffectiveEchoTime"" FLOAT,
	""CardiacSignalSource"" VARCHAR(16777216),
	""DiffusionBValue"" FLOAT,
	""DiffusionGradientOrientation"" VARIANT,
	""VelocityEncodingDirection"" VARIANT,
	""VelocityEncodingMinimumValue"" FLOAT,
	""NumberOfKSpaceTrajectories"" NUMBER(38,0),
	""CoverageOfKSpace"" VARCHAR(16777216),
	""FrequencyCorrection"" VARCHAR(16777216),
	""FrameReferenceDateTime"" NUMBER(38,0),
	""ParallelReductionFactorOutOfPlane"" FLOAT,
	""ParallelReductionFactorSecondInPlane"" FLOAT,
	""CardiacBeatRejectionTechnique"" VARCHAR(16777216),
	""RespiratoryMotionCompensationTechnique"" VARCHAR(16777216),
	""RespiratorySignalSource"" VARCHAR(16777216),
	""BulkMotionCompensationTechnique"" VARCHAR(16777216),
	""ApplicableSafetyStandardAgency"" VARCHAR(16777216),
	""SpecificAbsorptionRateDefinition"" VARCHAR(16777216),
	""GradientOutputType"" VARCHAR(16777216),
	""SpecificAbsorptionRateValue"" FLOAT,
	""GradientOutput"" FLOAT,
	""FlowCompensationDirection"" VARCHAR(16777216),
	""WaterReferencedPhaseCorrection"" VARCHAR(16777216),
	""FrameAcquisitionDuration"" FLOAT,
	""MRAcquisitionPhaseEncodingStepsInPlane"" NUMBER(38,0),
	""MRAcquisitionPhaseEncodingStepsOutOfPlane"" NUMBER(38,0),
	""RFEchoTrainLength"" NUMBER(38,0),
	""GradientEchoTrainLength"" NUMBER(38,0),
	""AcquisitionType"" VARCHAR(16777216),
	""TubeAngle"" FLOAT,
	""RevolutionTime"" FLOAT,
	""SingleCollimationWidth"" FLOAT,
	""TotalCollimationWidth"" FLOAT,
	""TableSpeed"" FLOAT,
	""TableFeedPerRotation"" FLOAT,
	""SpiralPitchFactor"" FLOAT,
	""DataCollectionCenterPatient"" VARIANT,
	""ReconstructionTargetCenterPatient"" VARIANT,
	""CTExposureSequence"" VARIANT,
	""ExposureModulationType"" VARIANT,
	""EstimatedDoseSaving"" FLOAT,
	""TablePosition"" FLOAT,
	""ExposureTimeInms"" FLOAT,
	""XRayTubeCurrentInmA"" FLOAT,
	""ExposureInmAs"" FLOAT,
	""FluoroscopyFlag"" VARCHAR(16777216),
	""CTDIvol"" FLOAT,
	""CTDIPhantomTypeCodeSequence"" VARIANT,
	""CalciumScoringMassFactorDevice"" VARIANT,
	""EnergyWeightingFactor"" FLOAT,
	""CTAdditionalXRaySourceSequence"" VARIANT,
	""ContributingSourcesSequence"" VARIANT,
	""XRay3DAcquisitionSequence"" VARIANT,
	""XRay3DReconstructionSequence"" VARIANT,
	""PositionerPrimaryAngleDirection"" VARCHAR(16777216),
	""DiffusionBValueXX"" FLOAT,
	""DiffusionBValueXY"" FLOAT,
	""DiffusionBValueXZ"" FLOAT,
	""DiffusionBValueYY"" FLOAT,
	""DiffusionBValueYZ"" FLOAT,
	""DiffusionBValueZZ"" FLOAT,
	""ContributingEquipmentSequence"" VARIANT,
	""StudyID"" VARCHAR(16777216),
	""SeriesNumber"" VARCHAR(16777216),
	""AcquisitionNumber"" VARCHAR(16777216),
	""InstanceNumber"" VARCHAR(16777216),
	""ItemNumber"" VARCHAR(16777216),
	""PatientOrientation"" VARIANT,
	""ImagePosition"" VARIANT,
	""ImagePositionPatient"" VARIANT,
	""ImageOrientation"" VARIANT,
	""ImageOrientationPatient"" VARIANT,
	""Location"" VARCHAR(16777216),
	""FrameOfReferenceUID"" VARCHAR(16777216),
	""Laterality"" VARCHAR(16777216),
	""ImageLaterality"" VARCHAR(16777216),
	""ImageGeometryType"" VARCHAR(16777216),
	""TemporalPositionIdentifier"" VARCHAR(16777216),
	""NumberOfTemporalPositions"" VARCHAR(16777216),
	""TemporalResolution"" VARCHAR(16777216),
	""SynchronizationFrameOfReferenceUID"" VARCHAR(16777216),
	""AcquisitionsInSeries"" VARCHAR(16777216),
	""ImagesInAcquisition"" VARCHAR(16777216),
	""ImagesInSeries"" VARCHAR(16777216),
	""PositionReferenceIndicator"" VARCHAR(16777216),
	""SliceLocation"" VARCHAR(16777216),
	""NumberOfStudyRelatedSeries"" VARCHAR(16777216),
	""NumberOfStudyRelatedInstances"" VARCHAR(16777216),
	""NumberOfSeriesRelatedInstances"" VARCHAR(16777216),
	""ImageComments"" VARCHAR(16777216),
	""OriginalImageIdentification"" VARIANT,
	""OriginalImageIdentificationNomenclature"" VARIANT,
	""StackID"" VARCHAR(16777216),
	""InStackPositionNumber"" NUMBER(38,0),
	""FrameLaterality"" VARCHAR(16777216),
	""TemporalPositionIndex"" NUMBER(38,0),
	""DimensionIndexValues"" VARIANT,
	""FrameComments"" VARCHAR(16777216),
	""ConcatenationUID"" VARCHAR(16777216),
	""DimensionOrganizationUID"" VARCHAR(16777216),
	""DimensionOrganizationSequence"" VARIANT,
	""DimensionIndexSequence"" VARIANT,
	""NominalPercentageOfCardiacPhase"" FLOAT,
	""RespiratoryIntervalTime"" FLOAT,
	""NominalRespiratoryTriggerDelayTime"" FLOAT,
	""RespiratoryTriggerDelayThreshold"" FLOAT,
	""DimensionOrganizationType"" VARCHAR(16777216),
	""SamplesPerPixel"" NUMBER(38,0),
	""PhotometricInterpretation"" VARCHAR(16777216),
	""ImageDimensions"" NUMBER(38,0),
	""PlanarConfiguration"" NUMBER(38,0),
	""NumberOfFrames"" VARCHAR(16777216),
	""FrameIncrementPointer"" VARIANT,
	""Rows"" NUMBER(38,0),
	""Columns"" NUMBER(38,0),
	""Planes"" NUMBER(38,0),
	""UltrasoundColorDataPresent"" NUMBER(38,0),
	""PixelSpacing"" VARIANT,
	""ZoomFactor"" VARIANT,
	""ZoomCenter"" VARIANT,
	""PixelAspectRatio"" VARIANT,
	""ImageFormat"" VARCHAR(16777216),
	""ManipulatedImage"" VARIANT,
	""CorrectedImage"" VARIANT,
	""CompressionCode"" VARCHAR(16777216),
	""BitsAllocated"" NUMBER(38,0),
	""BitsStored"" NUMBER(38,0),
	""HighBit"" NUMBER(38,0),
	""PixelRepresentation"" NUMBER(38,0),
	""SmallestValidPixelValue"" NUMBER(38,0),
	""LargestValidPixelValue"" NUMBER(38,0),
	""SmallestImagePixelValue"" NUMBER(38,0),
	""LargestImagePixelValue"" NUMBER(38,0),
	""SmallestPixelValueInSeries"" NUMBER(38,0),
	""LargestPixelValueInSeries"" NUMBER(38,0),
	""PixelPaddingValue"" NUMBER(38,0),
	""PixelPaddingRangeLimit"" NUMBER(38,0),
	""ImageLocation"" NUMBER(38,0),
	""QualityControlImage"" VARCHAR(16777216),
	""BurnedInAnnotation"" VARCHAR(16777216),
	""RecognizableVisualFeatures"" VARCHAR(16777216),
	""LongitudinalTemporalInformationModified"" VARCHAR(16777216),
	""PixelSpacingCalibrationType"" VARCHAR(16777216),
	""PixelSpacingCalibrationDescription"" VARCHAR(16777216),
	""PixelIntensityRelationship"" VARCHAR(16777216),
	""PixelIntensityRelationshipSign"" NUMBER(38,0),
	""WindowCenter"" VARIANT,
	""WindowWidth"" VARIANT,
	""RescaleIntercept"" VARCHAR(16777216),
	""RescaleSlope"" VARCHAR(16777216),
	""RescaleType"" VARCHAR(16777216),
	""WindowCenterWidthExplanation"" VARIANT,
	""VOILUTFunction"" VARCHAR(16777216),
	""RedPaletteColorLookupTableDescriptor"" VARIANT,
	""GreenPaletteColorLookupTableDescriptor"" VARIANT,
	""BluePaletteColorLookupTableDescriptor"" VARIANT,
	""PaletteColorLookupTableUID"" VARCHAR(16777216),
	""LargePaletteColorLookupTableUID"" VARCHAR(16777216),
	""BreastImplantPresent"" VARCHAR(16777216),
	""PartialView"" VARCHAR(16777216),
	""LossyImageCompression"" VARCHAR(16777216),
	""LossyImageCompressionRatio"" VARIANT,
	""LossyImageCompressionMethod"" VARIANT,
	""LUTExplanation"" VARCHAR(16777216),
	""VOILUTSequence"" VARIANT,
	""SoftcopyVOILUTSequence"" VARIANT,
	""RepresentativeFrameNumber"" NUMBER(38,0),
	""FrameOfInterestDescription"" VARIANT,
	""DataPointRows"" NUMBER(38,0),
	""DataPointColumns"" NUMBER(38,0),
	""StudyStatusID"" VARCHAR(16777216),
	""StudyPriorityID"" VARCHAR(16777216),
	""StudyReadDate"" DATE,
	""StudyReadTime"" TIME(9),
	""ScheduledStudyStartDate"" DATE,
	""ScheduledStudyStartTime"" TIME(9),
	""ScheduledStudyLocation"" VARCHAR(16777216),
	""ScheduledStudyLocationAETitle"" VARIANT,
	""ReasonForStudy"" VARCHAR(16777216),
	""StudyArrivalDate"" DATE,
	""StudyArrivalTime"" TIME(9),
	""StudyCompletionDate"" DATE,
	""StudyCompletionTime"" TIME(9),
	""RequestedProcedureDescription"" VARCHAR(16777216),
	""RequestedProcedureCodeSequence"" VARIANT,
	""RequestedContrastAgent"" VARCHAR(16777216),
	""StudyComments"" VARCHAR(16777216),
	""RouteOfAdmissions"" VARCHAR(16777216),
	""AdmittingDate"" DATE,
	""AdmittingTime"" TIME(9),
	""DischargeTime"" TIME(9),
	""SpecialNeeds"" VARCHAR(16777216),
	""PatientState"" VARCHAR(16777216),
	""ScheduledProcedureStepStartDate"" DATE,
	""ScheduledProcedureStepStartTime"" TIME(9),
	""ScheduledProcedureStepEndDate"" DATE,
	""ScheduledProcedureStepEndTime"" TIME(9),
	""ScheduledProcedureStepDescription"" VARCHAR(16777216),
	""ScheduledProtocolCodeSequence"" VARIANT,
	""ScheduledProcedureStepID"" VARCHAR(16777216),
	""ScheduledStationName"" VARIANT,
	""ScheduledProcedureStepSequence"" VARIANT,
	""PerformedStationAETitle"" VARCHAR(16777216),
	""PerformedStationName"" VARCHAR(16777216),
	""PerformedProcedureStepStartDate"" DATE,
	""PerformedProcedureStepStartTime"" TIME(9),
	""PerformedProcedureStepEndDate"" DATE,
	""PerformedProcedureStepEndTime"" TIME(9),
	""PerformedProcedureStepID"" VARCHAR(16777216),
	""PerformedProcedureStepDescription"" VARCHAR(16777216),
	""PerformedProtocolCodeSequence"" VARIANT,
	""RequestAttributesSequence"" VARIANT,
	""CommentsOnThePerformedProcedureStep"" VARCHAR(16777216),
	""TotalNumberOfExposures"" NUMBER(38,0),
	""EntranceDose"" NUMBER(38,0),
	""ExposedArea"" VARIANT,
	""DistanceSourceToEntrance"" VARCHAR(16777216),
	""ExposureDoseSequence"" VARIANT,
	""CommentsOnRadiationDose"" VARCHAR(16777216),
	""HalfValueLayer"" VARCHAR(16777216),
	""OrganDose"" VARCHAR(16777216),
	""OrganExposed"" VARCHAR(16777216),
	""ContainerIdentifier"" VARCHAR(16777216),
	""ContainerTypeCodeSequence"" VARIANT,
	""AcquisitionContextSequence"" VARIANT,
	""SpecimenDescriptionSequence"" VARIANT,
	""RequestedProcedureID"" VARCHAR(16777216),
	""ReasonForTheRequestedProcedure"" VARCHAR(16777216),
	""RequestedProcedurePriority"" VARCHAR(16777216),
	""ConfidentialityCode"" VARCHAR(16777216),
	""ReasonForRequestedProcedureCodeSequence"" VARIANT,
	""RequestedProcedureComments"" VARCHAR(16777216),
	""ReasonForTheImagingServiceRequest"" VARCHAR(16777216),
	""IssueDateOfImagingServiceRequest"" DATE,
	""IssueTimeOfImagingServiceRequest"" TIME(9),
	""FillerOrderNumberImagingServiceRequest"" VARCHAR(16777216),
	""ImagingServiceRequestComments"" VARCHAR(16777216),
	""ReferencedGeneralPurposeScheduledProcedureStepTransactionUID"" VARCHAR(16777216),
	""EntranceDoseInmGy"" VARCHAR(16777216),
	""ReferencedImageRealWorldValueMappingSequence"" VARIANT,
	""RealWorldValueMappingSequence"" VARIANT,
	""LUTLabel"" VARCHAR(16777216),
	""ObservationDateTime"" NUMBER(38,0),
	""ValueType"" VARCHAR(16777216),
	""ConceptNameCodeSequence"" VARIANT,
	""ContinuityOfContent"" VARCHAR(16777216),
	""VerifyingObserverSequence"" VARIANT,
	""VerifyingObserverName"" VARIANT,
	""DateTime"" NUMBER(38,0),
	""PersonName"" VARIANT,
	UID VARCHAR(16777216),
	""PredecessorDocumentsSequence"" VARIANT,
	""ReferencedRequestSequence"" VARIANT,
	""PerformedProcedureCodeSequence"" VARIANT,
	""CurrentRequestedProcedureEvidenceSequence"" VARIANT,
	""CompletionFlag"" VARCHAR(16777216),
	""VerificationFlag"" VARCHAR(16777216),
	""PreliminaryFlag"" VARCHAR(16777216),
	""ContentTemplateSequence"" VARIANT,
	""ContentSequence"" VARIANT,
	""TemplateExtensionOrganizationUID"" VARCHAR(16777216),
	""TemplateExtensionCreatorUID"" VARCHAR(16777216),
	""MIMETypeOfEncapsulatedDocument"" VARCHAR(16777216),
	""EncapsulatedDocumentLength"" NUMBER(38,0),
	""ImagedVolumeWidth"" FLOAT,
	""ImagedVolumeHeight"" FLOAT,
	""ImagedVolumeDepth"" FLOAT,
	""TotalPixelMatrixColumns"" NUMBER(38,0),
	""TotalPixelMatrixRows"" NUMBER(38,0),
	""TotalPixelMatrixOriginSequence"" VARIANT,
	""SpecimenLabelInImage"" VARCHAR(16777216),
	""FocusMethod"" VARCHAR(16777216),
	""ExtendedDepthOfField"" VARCHAR(16777216),
	""RecommendedAbsentPixelCIELabValue"" VARIANT,
	""ImageOrientationSlide"" VARIANT,
	""OpticalPathSequence"" VARIANT,
	""NumberOfOpticalPaths"" NUMBER(38,0),
	""TotalPixelMatrixFocalPlanes"" NUMBER(38,0),
	""CalibrationImage"" VARCHAR(16777216),
	""EnergyWindowVector"" VARIANT,
	""NumberOfEnergyWindows"" NUMBER(38,0),
	""EnergyWindowInformationSequence"" VARIANT,
	""EnergyWindowRangeSequence"" VARIANT,
	""RadiopharmaceuticalInformationSequence"" VARIANT,
	""DetectorVector"" VARIANT,
	""NumberOfDetectors"" NUMBER(38,0),
	""DetectorInformationSequence"" VARIANT,
	""PhaseVector"" VARIANT,
	""NumberOfPhases"" NUMBER(38,0),
	""PhaseInformationSequence"" VARIANT,
	""NumberOfRotations"" NUMBER(38,0),
	""RotationInformationSequence"" VARIANT,
	""NumberOfRRIntervals"" NUMBER(38,0),
	""NumberOfTimeSlots"" NUMBER(38,0),
	""SliceVector"" VARIANT,
	""NumberOfSlices"" NUMBER(38,0),
	""TimeSliceVector"" VARIANT,
	""NumberOfTimeSlices"" NUMBER(38,0),
	""TypeOfDetectorMotion"" VARCHAR(16777216),
	""ViewCodeSequence"" VARIANT,
	""ViewModifierCodeSequence"" VARIANT,
	""ImageID"" VARCHAR(16777216),
	""PatientOrientationCodeSequence"" VARIANT,
	""PatientOrientationModifierCodeSequence"" VARIANT,
	""PatientGantryRelationshipCodeSequence"" VARIANT,
	""ScanProgressionDirection"" VARCHAR(16777216),
	""SeriesType"" VARIANT,
	""Units"" VARCHAR(16777216),
	""CountsSource"" VARCHAR(16777216),
	""ReprojectionMethod"" VARCHAR(16777216),
	""RandomsCorrectionMethod"" VARCHAR(16777216),
	""AttenuationCorrectionMethod"" VARCHAR(16777216),
	""DecayCorrection"" VARCHAR(16777216),
	""ReconstructionMethod"" VARCHAR(16777216),
	""DetectorLinesOfResponseUsed"" VARCHAR(16777216),
	""ScatterCorrectionMethod"" VARCHAR(16777216),
	""AxialAcceptance"" VARCHAR(16777216),
	""AxialMash"" VARIANT,
	""TransverseMash"" VARCHAR(16777216),
	""CoincidenceWindowWidth"" VARCHAR(16777216),
	""SecondaryCountsType"" VARIANT,
	""FrameReferenceTime"" VARCHAR(16777216),
	""PrimaryPromptsCountsAccumulated"" VARCHAR(16777216),
	""SecondaryCountsAccumulated"" VARIANT,
	""SliceSensitivityFactor"" VARCHAR(16777216),
	""DecayFactor"" VARCHAR(16777216),
	""DoseCalibrationFactor"" VARCHAR(16777216),
	""ScatterFractionFactor"" VARCHAR(16777216),
	""DeadTimeFactor"" VARCHAR(16777216),
	""ImageIndex"" NUMBER(38,0),
	""HistogramSequence"" VARIANT,
	""SegmentationType"" VARCHAR(16777216),
	""SegmentSequence"" VARIANT,
	""MaximumFractionalValue"" NUMBER(38,0),
	""SegmentationFractionalType"" VARCHAR(16777216),
	""SegmentsOverlap"" VARCHAR(16777216),
	""ImageRotation"" NUMBER(38,0),
	""DisplayedAreaSelectionSequence"" VARIANT,
	""GraphicLayerSequence"" VARIANT,
	""ContentLabel"" VARCHAR(16777216),
	""ContentDescription"" VARCHAR(16777216),
	""PresentationCreationDate"" DATE,
	""PresentationCreationTime"" TIME(9),
	""ContentCreatorName"" VARIANT,
	""RegistrationSequence"" VARIANT,
	""FiducialUID"" VARCHAR(16777216),
	""RelativeOpacity"" FLOAT,
	""AdvancedBlendingSequence"" VARIANT,
	""BlendingDisplaySequence"" VARIANT,
	""StorageMediaFileSetUID"" VARCHAR(16777216),
	""IconImageSequence"" VARIANT,
	""DigitalSignatureUID"" VARCHAR(16777216),
	""ImageDisplayFormat"" VARCHAR(16777216),
	""AnnotationDisplayFormatID"" VARCHAR(16777216),
	""FilmOrientation"" VARCHAR(16777216),
	""BorderDensity"" VARCHAR(16777216),
	""Trim"" VARCHAR(16777216),
	""ImageBoxPosition"" NUMBER(38,0),
	""PresentationLUTShape"" VARCHAR(16777216),
	""DoseUnits"" VARCHAR(16777216),
	""DoseType"" VARCHAR(16777216),
	""DoseComment"" VARCHAR(16777216),
	""DoseSummationType"" VARCHAR(16777216),
	""GridFrameOffsetVector"" VARIANT,
	""DoseGridScaling"" VARCHAR(16777216),
	""TissueHeterogeneityCorrection"" VARIANT,
	""StructureSetLabel"" VARCHAR(16777216),
	""StructureSetName"" VARCHAR(16777216),
	""StructureSetDate"" DATE,
	""StructureSetTime"" TIME(9),
	""ReferencedFrameOfReferenceSequence"" VARIANT,
	""StructureSetROISequence"" VARIANT,
	""ReferencedFrameOfReferenceUID"" VARCHAR(16777216),
	""ROIContourSequence"" VARIANT,
	""RTROIObservationsSequence"" VARIANT,
	""RelatedFrameOfReferenceUID"" VARCHAR(16777216),
	""RTPlanLabel"" VARCHAR(16777216),
	""RTPlanName"" VARCHAR(16777216),
	""RTPlanDescription"" VARCHAR(16777216),
	""RTPlanDate"" DATE,
	""RTPlanGeometry"" VARCHAR(16777216),
	""DoseReferenceSequence"" VARIANT,
	""DoseReferenceUID"" VARCHAR(16777216),
	""FractionGroupSequence"" VARIANT,
	""BeamSequence"" VARIANT,
	""GantryAngle"" VARCHAR(16777216),
	""PatientSupportAngle"" VARCHAR(16777216),
	""TableTopLongitudinalPosition"" VARCHAR(16777216),
	""TableTopLateralPosition"" VARCHAR(16777216),
	""TableTopPitchAngle"" FLOAT,
	""TableTopRollAngle"" FLOAT,
	""PatientSetupSequence"" VARIANT,
	""PatientSetupNumber"" VARCHAR(16777216),
	""ReferencedRTPlanSequence"" VARIANT,
	""ReferencedStructureSetSequence"" VARIANT,
	""ApprovalStatus"" VARCHAR(16777216),
	""InterpretationTypeID"" VARCHAR(16777216),
	""InterpretationStatusID"" VARCHAR(16777216),
	""CurveDimensions"" VARIANT,
	""NumberOfPoints"" VARIANT,
	""TypeOfData"" VARIANT,
	""DataValueRepresentation"" VARIANT,
	""SharedFunctionalGroupsSequence"" VARIANT,
	""PerFrameFunctionalGroupsSequence"" VARIANT,
	""OverlayRows"" VARIANT,
	""OverlayColumns"" VARIANT,
	""NumberOfFramesInOverlay"" VARIANT,
	""OverlayDescription"" VARIANT,
	""OverlayType"" VARIANT,
	""OverlayOrigin"" VARIANT,
	""ImageFrameOrigin"" VARIANT,
	""OverlayBitsAllocated"" VARIANT,
	""OverlayBitPosition"" VARIANT,
	""Tag_00091110"" VARIANT,
	""Tag_00291032"" VARIANT,
	""Tag_00291140"" VARIANT,
	""Tag_00551012"" VARIANT,
	""Tag_00551022"" VARIANT,
	""Tag_01171010"" VARIANT,
	""Tag_01171020"" VARIANT,
	""Tag_01171022"" VARIANT,
	""Tag_01171024"" VARIANT,
	""Tag_011710B0"" VARIANT,
	""Tag_01191180"" VARIANT,
	""Tag_01F31001"" VARIANT,
	""Tag_01F31011"" VARIANT,
	""Tag_2001105F"" VARIANT,
	""Tag_20019000"" VARIANT,
	""Tag_20051080"" VARIANT,
	""Tag_20051084"" VARIANT,
	""Tag_20051085"" VARIANT,
	""Tag_20051132"" VARIANT,
	""Tag_20051402"" VARIANT,
	""Tag_2005140E"" VARIANT,
	""Tag_2005140F"" VARIANT,
	""OtherElements"" VARIANT,
	""DroppedTags"" VARIANT,
	""Type"" VARCHAR(16777216),
	""LastUpdated"" NUMBER(38,0),
	""StorageClass"" VARCHAR(16777216),
	""BlobStorageSize"" NUMBER(38,0)
);"

,4
table_name,MUTABLE_METADATA
description,
DDL,"create or replace TABLE MUTABLE_METADATA (
	""crdc_study_uuid"" VARCHAR(16777216),
	""crdc_series_uuid"" VARCHAR(16777216),
	""crdc_instance_uuid"" VARCHAR(16777216),
	""gcs_url"" VARCHAR(16777216),
	""aws_url"" VARCHAR(16777216),
	""access"" VARCHAR(16777216),
	""source_url"" VARCHAR(16777216),
	""source_doi"" VARCHAR(16777216),
	""license_long_name"" VARCHAR(16777216),
	""license_short_name"" VARCHAR(16777216),
	""license_url"" VARCHAR(16777216)
);"

,5
table_name,SEGMENTATIONS
description,
DDL,"create or replace TABLE SEGMENTATIONS (
	""PatientID"" VARCHAR(16777216),
	""StudyInstanceUID"" VARCHAR(16777216),
	""SeriesInstanceUID"" VARCHAR(16777216),
	""SOPInstanceUID"" VARCHAR(16777216),
	""FrameOfReferenceUID"" VARCHAR(16777216),
	""AnatomicRegion"" VARIANT,
	""AnatomicRegionModifier"" VARIANT,
	""SegmentedPropertyCategory"" VARIANT,
	""SegmentedPropertyType"" VARIANT,
	""SegmentAlgorithmType"" VARCHAR(16777216),
	""SegmentAlgorithmName"" VARCHAR(16777216),
	""SegmentNumber"" NUMBER(38,0),
	""TrackingUID"" VARCHAR(16777216),
	""TrackingID"" VARCHAR(16777216),
	""segmented_SeriesInstanceUID"" VARCHAR(16777216),
	""viewer_url"" VARCHAR(16777216)
);"

,6
table_name,QUANTITATIVE_MEASUREMENTS
description,
DDL,"create or replace TABLE QUANTITATIVE_MEASUREMENTS (
	""PatientID"" VARCHAR(16777216),
	""SOPInstanceUID"" VARCHAR(16777216),
	""SeriesDescription"" VARCHAR(16777216),
	""measurementGroup_number"" NUMBER(38,0),
	""segmentationInstanceUID"" VARCHAR(16777216),
	""segmentationSegmentNumber"" VARIANT,
	""sourceSegmentedSeriesUID"" VARCHAR(16777216),
	""trackingIdentifier"" VARCHAR(16777216),
	""trackingUniqueIdentifier"" VARCHAR(16777216),
	""Quantity"" VARIANT,
	""derivationModifier"" VARIANT,
	""Value"" NUMBER(38,9),
	""Units"" VARIANT,
	""finding"" VARIANT,
	""findingSite"" VARIANT
);"

,7
table_name,ANALYSIS_RESULTS_METADATA
description,
DDL,"create or replace TABLE ANALYSIS_RESULTS_METADATA (
	ID VARCHAR(16777216),
	""Title"" VARCHAR(16777216),
	""Access"" VARCHAR(16777216),
	DOI VARCHAR(16777216),
	""CancerType"" VARCHAR(16777216),
	""Location"" VARCHAR(16777216),
	""Subjects"" NUMBER(38,0),
	""Collections"" VARCHAR(16777216),
	""AnalysisArtifacts"" VARCHAR(16777216),
	""Updated"" DATE,
	""license_url"" VARCHAR(16777216),
	""license_long_name"" VARCHAR(16777216),
	""license_short_name"" VARCHAR(16777216),
	""Description"" VARCHAR(16777216),
	""AnalysisArtifactsonTCIA"" VARCHAR(16777216)
);"

,8
table_name,QUALITATIVE_MEASUREMENTS
description,
DDL,"create or replace TABLE QUALITATIVE_MEASUREMENTS (
	""PatientID"" VARCHAR(16777216),
	""SOPInstanceUID"" VARCHAR(16777216),
	""measurementGroup_number"" NUMBER(38,0),
	""segmentationInstanceUID"" VARCHAR(16777216),
	""segmentationSegmentNumber"" VARIANT,
	""sourceSegmentedSeriesUID"" VARCHAR(16777216),
	""trackingIdentifier"" VARCHAR(16777216),
	""trackingUniqueIdentifier"" VARCHAR(16777216),
	""Quantity"" VARIANT,
	""Value"" VARIANT,
	""finding"" VARIANT,
	""findingSite"" VARIANT
);"

,9
table_name,TCGA_CLINICAL_REL9
description,
DDL,"create or replace TABLE TCGA_CLINICAL_REL9 (
	""case_gdc_id"" VARCHAR(16777216),
	""case_barcode"" VARCHAR(16777216),
	""program_name"" VARCHAR(16777216),
	""disease_code"" VARCHAR(16777216),
	""project_short_name"" VARCHAR(16777216),
	""age_at_diagnosis"" NUMBER(38,0),
	""age_began_smoking_in_years"" VARCHAR(16777216),
	""anatomic_neoplasm_subdivision"" VARCHAR(16777216),
	""batch_number"" NUMBER(38,0),
	""bcr"" VARCHAR(16777216),
	""bmi"" FLOAT,
	""clinical_M"" VARCHAR(16777216),
	""clinical_N"" VARCHAR(16777216),
	""clinical_stage"" VARCHAR(16777216),
	""clinical_T"" VARCHAR(16777216),
	""colorectal_cancer"" VARCHAR(16777216),
	""country"" VARCHAR(16777216),
	""days_to_birth"" NUMBER(38,0),
	""days_to_death"" NUMBER(38,0),
	""days_to_initial_pathologic_diagnosis"" NUMBER(38,0),
	""days_to_last_followup"" NUMBER(38,0),
	""days_to_last_known_alive"" NUMBER(38,0),
	""days_to_submitted_specimen_dx"" VARCHAR(16777216),
	""ethnicity"" VARCHAR(16777216),
	""gender"" VARCHAR(16777216),
	""gleason_score_combined"" VARCHAR(16777216),
	""h_pylori_infection"" VARCHAR(16777216),
	""height"" NUMBER(38,0),
	""histological_type"" VARCHAR(16777216),
	""history_of_colon_polyps"" VARCHAR(16777216),
	""history_of_neoadjuvant_treatment"" VARCHAR(16777216),
	""hpv_calls"" VARCHAR(16777216),
	""hpv_status"" VARCHAR(16777216),
	""icd_10"" VARCHAR(16777216),
	""icd_o_3_histology"" VARCHAR(16777216),
	""icd_o_3_site"" VARCHAR(16777216),
	""lymphatic_invasion"" VARCHAR(16777216),
	""lymphnodes_examined"" VARCHAR(16777216),
	""lymphovascular_invasion_present"" VARCHAR(16777216),
	""menopause_status"" VARCHAR(16777216),
	""mononucleotide_and_dinucleotide_marker_panel_analysis_status"" VARCHAR(16777216),
	""neoplasm_histologic_grade"" VARCHAR(16777216),
	""new_tumor_event_after_initial_treatment"" BOOLEAN,
	""number_of_lymphnodes_examined"" NUMBER(38,0),
	""number_of_lymphnodes_positive_by_he"" VARCHAR(16777216),
	""number_pack_years_smoked"" NUMBER(38,0),
	""other_dx"" VARCHAR(16777216),
	""other_malignancy_anatomic_site"" VARCHAR(16777216),
	""other_malignancy_histological_type"" VARCHAR(16777216),
	""other_malignancy_type"" VARCHAR(16777216),
	""pathologic_M"" VARCHAR(16777216),
	""pathologic_N"" VARCHAR(16777216),
	""pathologic_stage"" VARCHAR(16777216),
	""pathologic_T"" VARCHAR(16777216),
	""person_neoplasm_cancer_status"" VARCHAR(16777216),
	""pregnancies"" VARCHAR(16777216),
	""primary_neoplasm_melanoma_dx"" VARCHAR(16777216),
	""primary_therapy_outcome_success"" VARCHAR(16777216),
	""psa_value"" VARCHAR(16777216),
	""race"" VARCHAR(16777216),
	""residual_tumor"" VARCHAR(16777216),
	""stopped_smoking_year"" NUMBER(38,0),
	""tobacco_smoking_history"" NUMBER(38,0),
	""tss_code"" VARCHAR(16777216),
	""tumor_tissue_site"" VARCHAR(16777216),
	""tumor_type"" VARCHAR(16777216),
	""venous_invasion"" VARCHAR(16777216),
	""vital_status"" VARCHAR(16777216),
	""weight"" NUMBER(38,0),
	""year_of_diagnosis"" NUMBER(38,0),
	""year_of_tobacco_smoking_onset"" NUMBER(38,0),
	""project_name"" VARCHAR(16777216)
);"

,10
table_name,VERSION_METADATA
description,
DDL,"create or replace TABLE VERSION_METADATA (
	""idc_version"" NUMBER(38,0),
	""version_hash"" VARCHAR(16777216),
	""version_timestamp"" VARCHAR(16777216)
);"

,11
table_name,DICOM_METADATA_CURATED_SERIES_LEVEL
description,
DDL,"create or replace TABLE DICOM_METADATA_CURATED_SERIES_LEVEL (
	""SeriesInstanceUID"" VARCHAR(16777216),
	""min_PixelSpacing_2sf"" FLOAT,
	""max_TotalPixelMatrixColumns"" NUMBER(38,0),
	""max_TotalPixelMatrixRows"" NUMBER(38,0),
	""ObjectiveLensPower"" NUMBER(38,0),
	""primaryAnatomicStructure_code_designator_value_str"" VARCHAR(16777216),
	""primaryAnatomicStructure_CodeMeaning"" VARCHAR(16777216),
	""illuminationType_code_designator_value_str"" VARCHAR(16777216),
	""illuminationType_CodeMeaning"" VARCHAR(16777216),
	""Modality"" VARCHAR(16777216)
);"

,12
table_name,DICOM_PIVOT
description,
DDL,"create or replace TABLE DICOM_PIVOT (
	""PatientID"" VARCHAR(16777216),
	""BodyPartExamined"" VARCHAR(16777216),
	""SeriesInstanceUID"" VARCHAR(16777216),
	""SliceThickness"" FLOAT,
	""SeriesNumber"" VARCHAR(16777216),
	""SeriesDescription"" VARCHAR(16777216),
	""StudyInstanceUID"" VARCHAR(16777216),
	""StudyDescription"" VARCHAR(16777216),
	""StudyDate"" DATE,
	""SOPInstanceUID"" VARCHAR(16777216),
	""Modality"" VARCHAR(16777216),
	""SOPClassUID"" VARCHAR(16777216),
	""collection_id"" VARCHAR(16777216),
	""AnatomicRegionSequence"" VARCHAR(16777216),
	""FrameOfReferenceUID"" VARCHAR(16777216),
	""crdc_study_uuid"" VARCHAR(16777216),
	""crdc_series_uuid"" VARCHAR(16777216),
	""crdc_instance_uuid"" VARCHAR(16777216),
	""Program"" VARCHAR(16777216),
	""tcia_tumorLocation"" VARCHAR(16777216),
	""source_DOI"" VARCHAR(16777216),
	""tcia_species"" VARCHAR(16777216),
	""license_short_name"" VARCHAR(16777216),
	""Manufacturer"" VARCHAR(16777216),
	""ManufacturerModelName"" VARCHAR(16777216),
	""instance_size"" NUMBER(38,0),
	""analysis_results_id"" VARCHAR(16777216),
	""SamplesPerPixel"" NUMBER(38,0),
	""CancerType"" VARCHAR(16777216),
	""Apparent_Diffusion_Coefficient"" NUMBER(38,9),
	""Internal_structure"" VARCHAR(16777216),
	""Sphericity"" VARCHAR(16777216),
	""Calcification"" VARCHAR(16777216),
	""Lobular_Pattern"" VARCHAR(16777216),
	""Spiculation"" VARCHAR(16777216),
	""Margin"" VARCHAR(16777216),
	""Texture"" VARCHAR(16777216),
	""Subtlety_score"" VARCHAR(16777216),
	""Malignancy"" VARCHAR(16777216),
	""Volume"" NUMBER(38,9),
	""Diameter"" NUMBER(38,9),
	""Surface_area_of_mesh"" NUMBER(38,9),
	""Sphericity_quant"" NUMBER(38,9),
	""Volume_of_Mesh"" NUMBER(38,9),
	""illuminationType"" VARCHAR(16777216),
	""primaryAnatomicStructure"" VARCHAR(16777216),
	""ObjectiveLensPower"" NUMBER(38,0),
	""min_PixelSpacing"" FLOAT,
	""max_TotalPixelMatrixColumns"" NUMBER(38,0),
	""max_TotalPixelMatrixRows"" NUMBER(38,0),
	""SegmentedPropertyCategoryCodeSequence"" VARCHAR(16777216),
	""SegmentedPropertyTypeCodeSequence"" VARCHAR(16777216),
	""SegmentNumber"" NUMBER(38,0),
	""SegmentAlgorithmType"" VARCHAR(16777216),
	""AdditionalPatientHistory"" VARCHAR(16777216),
	""Allergies"" VARCHAR(16777216),
	""ImageType"" VARCHAR(16777216),
	""LastMenstrualDate"" DATE,
	""MedicalAlerts"" VARCHAR(16777216),
	""EthnicGroup"" VARCHAR(16777216),
	""Occupation"" VARCHAR(16777216),
	""PatientAge"" VARCHAR(16777216),
	""PatientSex"" VARCHAR(16777216),
	""PatientComments"" VARCHAR(16777216),
	""PatientSize"" VARCHAR(16777216),
	""PatientWeight"" VARCHAR(16777216),
	""PregnancyStatus"" NUMBER(38,0),
	""ReasonForStudy"" VARCHAR(16777216),
	""RequestedProcedureComments"" VARCHAR(16777216),
	""SmokingStatus"" VARCHAR(16777216),
	""SeriesDate"" DATE,
	""access"" VARCHAR(16777216),
	""gcs_url"" VARCHAR(16777216),
	""aws_url"" VARCHAR(16777216),
	""gcs_bucket"" VARCHAR(16777216),
	""aws_bucket"" VARCHAR(16777216)
);"

,13
table_name,ORIGINAL_COLLECTIONS_METADATA
description,
DDL,"create or replace TABLE ORIGINAL_COLLECTIONS_METADATA (
	""collection_name"" VARCHAR(16777216),
	""collection_id"" VARCHAR(16777216),
	""Program"" VARCHAR(16777216),
	""Status"" VARCHAR(16777216),
	""Updated"" DATE,
	""Access"" VARIANT,
	""ImageTypes"" VARCHAR(16777216),
	""Subjects"" NUMBER(38,0),
	DOI VARCHAR(16777216),
	URL VARCHAR(16777216),
	""CancerType"" VARCHAR(16777216),
	""SupportingData"" VARCHAR(16777216),
	""Species"" VARCHAR(16777216),
	""Location"" VARCHAR(16777216),
	""licenses"" VARIANT,
	""Description"" VARCHAR(16777216),
	""idc_webapp_collection_id"" VARCHAR(16777216),
	""tcia_api_collection_id"" VARCHAR(16777216),
	""tcia_wiki_collection_id"" VARCHAR(16777216)
);"

,14
table_name,MEASUREMENT_GROUPS
description,
DDL,"create or replace TABLE MEASUREMENT_GROUPS (
	""SOPInstanceUID"" VARCHAR(16777216),
	""measurementGroup_number"" NUMBER(38,0),
	""trackingUniqueIdentifier"" VARCHAR(16777216),
	""trackingIdentifier"" VARCHAR(16777216),
	""PatientID"" VARCHAR(16777216),
	""SeriesDescription"" VARCHAR(16777216),
	""finding"" VARIANT,
	""findingSite"" VARIANT,
	""sourceSegmentedSeriesUID"" VARCHAR(16777216),
	""segmentationInstanceUID"" VARCHAR(16777216),
	""segmentationSegmentNumber"" VARIANT,
	""contentSequence"" VARIANT
);"

,15
table_name,TCGA_BIOSPECIMEN_REL9
description,
DDL,"create or replace TABLE TCGA_BIOSPECIMEN_REL9 (
	""sample_barcode"" VARCHAR(16777216),
	""sample_gdc_id"" VARCHAR(16777216),
	""case_barcode"" VARCHAR(16777216),
	""case_gdc_id"" VARCHAR(16777216),
	""sample_type"" VARCHAR(16777216),
	""sample_type_name"" VARCHAR(16777216),
	""program_name"" VARCHAR(16777216),
	""project_short_name"" VARCHAR(16777216),
	""batch_number"" NUMBER(38,0),
	""bcr"" VARCHAR(16777216),
	""days_to_collection"" FLOAT,
	""days_to_sample_procurement"" FLOAT,
	""is_ffpe"" VARCHAR(16777216),
	""num_portions"" NUMBER(38,0),
	""num_slides"" NUMBER(38,0),
	""avg_percent_lymphocyte_infiltration"" FLOAT,
	""avg_percent_monocyte_infiltration"" FLOAT,
	""avg_percent_necrosis"" FLOAT,
	""avg_percent_neutrophil_infiltration"" FLOAT,
	""avg_percent_normal_cells"" FLOAT,
	""avg_percent_stromal_cells"" FLOAT,
	""avg_percent_tumor_cells"" FLOAT,
	""avg_percent_tumor_nuclei"" FLOAT,
	""max_percent_lymphocyte_infiltration"" FLOAT,
	""max_percent_monocyte_infiltration"" FLOAT,
	""max_percent_necrosis"" FLOAT,
	""max_percent_neutrophil_infiltration"" FLOAT,
	""max_percent_normal_cells"" FLOAT,
	""max_percent_stromal_cells"" FLOAT,
	""max_percent_tumor_cells"" FLOAT,
	""max_percent_tumor_nuclei"" FLOAT,
	""min_percent_lymphocyte_infiltration"" FLOAT,
	""min_percent_monocyte_infiltration"" FLOAT,
	""min_percent_necrosis"" FLOAT,
	""min_percent_neutrophil_infiltration"" FLOAT,
	""min_percent_normal_cells"" FLOAT,
	""min_percent_stromal_cells"" FLOAT,
	""min_percent_tumor_cells"" FLOAT,
	""min_percent_tumor_nuclei"" FLOAT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'IDC': {'IDC_V17': ['ANALYSIS_RESULTS_METADATA', 'AUXILIARY_METADATA', 'DICOM_ALL', 'DICOM_METADATA', 'DICOM_METADATA_CURATED', 'DICOM_METADATA_CURATED_SERIES_LEVEL', 'DICOM_PIVOT', 'MEASUREMENT_GROUPS', 'MUTABLE_METADATA', 'ORIGINAL_COLLECTIONS_METADATA', 'QUALITATIVE_MEASUREMENTS', 'QUANTITATIVE_MEASUREMENTS', 'SEGMENTATIONS', 'TCGA_BIOSPECIMEN_REL9', 'TCGA_CLINICAL_REL9', 'VERSION_METADATA']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table:** `IDC.IDC_V17.DICOM_ALL`

  - **"Modality"**: Used to filter records for the 'SM' (Slide Microscopy) modality.
  
  - **"SOPInstanceUID"**: Unique identifier for each DICOM instance; useful for tracing back to specific images.
  
  - **"SpecimenDescriptionSequence"**: A `VARIANT` column containing nested specimen descriptions, which may include specimen preparation details.
  
  - **Potential Nested Columns within "SpecimenDescriptionSequence":**
  
    - **"SpecimenPreparationSequence"**: Contains details about specimen preparation steps.
    
    - **"SpecimenPreparationStepContentItemSequence"**: Nested within "SpecimenPreparationSequence"; includes content items with code meanings.
    
    - **"ConceptNameCodeSequence"**: Contains the name of the concept, such as 'Embedding medium' or 'Staining substance'.
    
    - **"ConceptCodeSequence"**: Contains the actual code and its meaning.
    
    - **"CodingSchemeDesignator"**: Indicates the coding scheme used, e.g., 'SCT' for SNOMED CT.
    
    - **"CodeMeaning"**: Provides the human-readable meaning of the code.
    
- **Conditions:**

  - Filter records where **"Modality"** is `'SM'`.
  
  - Extract codes where the **"CodingSchemeDesignator"** is `'SCT'` (SNOMED CT).
  
  - Unnest the sequences within **"SpecimenDescriptionSequence"** to access embedding medium and staining substance information.

---

**SQL Queries:**

```sql
-- 1. List distinct modalities in the DICOM_ALL table
SELECT DISTINCT "Modality"
FROM IDC.IDC_V17.DICOM_ALL
LIMIT 1000;
```

---

```sql
-- 2. Count the number of instances where Modality is 'SM'
SELECT COUNT(*) AS "SM_Modality_Count"
FROM IDC.IDC_V17.DICOM_ALL
WHERE "Modality" = 'SM';
```

---

```sql
-- 3. Select distinct SOPInstanceUIDs where Modality is 'SM'
SELECT DISTINCT "SOPInstanceUID"
FROM IDC.IDC_V17.DICOM_ALL
WHERE "Modality" = 'SM'
LIMIT 1000;
```

---

```sql
-- 4. Explore SpecimenDescriptionSequence in SM modality images
SELECT t."SOPInstanceUID", f.value AS "SpecimenDescriptionSequence"
FROM IDC.IDC_V17.DICOM_ALL t,
LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") f
WHERE t."Modality" = 'SM'
LIMIT 1000;
```

---

```sql
-- 5. Retrieve SpecimenPreparationSequence from SpecimenDescriptionSequence
SELECT t."SOPInstanceUID", s.value AS "SpecimenPreparationSequence"
FROM IDC.IDC_V17.DICOM_ALL t,
LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd,
LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") s
WHERE t."Modality" = 'SM'
LIMIT 1000;
```

---

```sql
-- 6. Extract SpecimenPreparationStepContentItemSequence
SELECT t."SOPInstanceUID", c.value AS "SpecimenPreparationStepContentItemSequence"
FROM IDC.IDC_V17.DICOM_ALL t,
LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd,
LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp,
LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
WHERE t."Modality" = 'SM'
LIMIT 1000;
```

---

```sql
-- 7. Extract CodeMeaning and CodingSchemeDesignator from SpecimenPreparationStepContentItemSequence
SELECT
  t."SOPInstanceUID",
  c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING AS "ConceptNameCodeMeaning",
  c.value:"ConceptNameCodeSequence"[0]:"CodingSchemeDesignator"::STRING AS "ConceptNameCodingSchemeDesignator",
  c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "ConceptCodeMeaning",
  c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING AS "ConceptCodeCodingSchemeDesignator",
  c.value:"TextValue"::STRING AS "TextValue"
FROM IDC.IDC_V17.DICOM_ALL t,
LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd,
LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp,
LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
WHERE t."Modality" = 'SM'
LIMIT 1000;
```

---

```sql
-- 8. Filter for CodingSchemeDesignator='SCT' and extract CodeMeanings
SELECT
  t."SOPInstanceUID",
  c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING AS "ConceptNameCodeMeaning",
  c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "ConceptCodeMeaning",
  c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING AS "CodingSchemeDesignator",
  c.value:"TextValue"::STRING AS "TextValue"
FROM IDC.IDC_V17.DICOM_ALL t,
LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd,
LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp,
LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
WHERE t."Modality" = 'SM'
  AND c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
LIMIT 1000;
```

---

```sql
-- 9. List distinct embedding medium code meanings from SM modality
SELECT DISTINCT c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "EmbeddingMediumCodeMeaning"
FROM IDC.IDC_V17.DICOM_ALL t,
LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd,
LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp,
LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
WHERE t."Modality" = 'SM'
  AND c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING ILIKE '%embedding medium%'
  AND c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
LIMIT 1000;
```

---

```sql
-- 10. List distinct staining substance code meanings from SM modality
SELECT DISTINCT c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "StainingSubstanceCodeMeaning"
FROM IDC.IDC_V17.DICOM_ALL t,
LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd,
LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp,
LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
WHERE t."Modality" = 'SM'
  AND c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING ILIKE '%staining%'
  AND c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
LIMIT 1000;
```

---

These queries assist in exploring the data necessary to fulfill the task by:

- Identifying the modalities present and focusing on the 'SM' modality.
  
- Extracting and unnesting the **"SpecimenDescriptionSequence"** to access the nested specimen preparation details.
  
- Unnesting further sequences like **"SpecimenPreparationSequence"** and **"SpecimenPreparationStepContentItemSequence"**.
  
- Retrieving **"CodeMeaning"** and **"CodingSchemeDesignator"** to identify embedding mediums and staining substances with codes from the SNOMED CT ('SCT') coding scheme.
  
- Listing distinct code meanings for embedding mediums and staining substances to understand the possible values.

By executing these queries, we gain insights into the structure and content of the relevant data, which is crucial for listing all unique pairs of embedding medium and staining substance code meanings along with their occurrences.Query:
-- 1. List distinct modalities in the DICOM_ALL table
SELECT DISTINCT "Modality"
FROM IDC.IDC_V17.DICOM_ALL
LIMIT 1000;
Answer:
Modality
RTPLAN
PR
RTDOSE
M3D
DX
FUSION
MG
SR
RWV
NM
RTSTRUCT
CR
US
OT
XA
CT
REG
SC
SM
XC
MR
PT
SEG
Query:
-- 2. Count the number of instances where Modality is 'SM'
SELECT COUNT(*) AS "SM_Modality_Count"
FROM IDC.IDC_V17.DICOM_ALL
WHERE "Modality" = 'SM';
Answer:
SM_Modality_Count
8512
Query:
-- 3. Select distinct SOPInstanceUIDs where Modality is 'SM'
SELECT DISTINCT "SOPInstanceUID"
FROM IDC.IDC_V17.DICOM_ALL
WHERE "Modality" = 'SM'
LIMIT 1000;
Answer:
Too long, hard cut:
SOPInstanceUID
1.3.6.1.4.1.5962.99.1.288502917.435733701.1640966042757.14.0
1.3.6.1.4.1.5962.99.1.1429222978.920933212.1637811795522.15.0
1.3.6.1.4.1.5962.99.1.1823031872.289054648.1638205604416.36.0
1.3.6.1.4.1.5962.99.1.1561375760.417860699.1637943948304.36.0
1.3.6.1.4.1.5962.99.1.1828604770.69343606.1638211177314.22.0
1.3.6.1.4.1.5962.99.1.255325960.1276718182.1640932865800.28.0
1.3.6.1.4.1.5962.99.1.1877838119.1948234345.1638260410663.29.0
1.3.6.1.4.1.5962.99.1.1999877904.570862717.1655562319632.479.0
1.3.6.1.4.1.5962.99.1.1100612088.1220290507.1637483184632.29.0
1.3.6.1.4.1.5962.99.1.1300570035.309218492.1637683142579.36.0
1.3.6.1.4.1.5962.99.1.1451596735.1129566628.1637834169279.8.0
1.3.6.1.4.1.5962.99.1.2098928367.300930011.1638481500911.22.0
1.3.6.1.4.1.5962.99.1.1075540375.93664924.1637458112919.29.0
1.3.6.1.4.1.5962.99.1.2033235271.1897531689.1638415807815.8.0
1.3.6.1.4.1.5962.99.1.293351711.95000986.1640970891551.35.0
1.3.6.1.4.1.5962.99.1.2001352215.222014479.1655563793943.346.0
1.3.6.1.4.1.5962.99.1.2005676518.178837978.1638388249062.36.0
1.3.6.1.4.1.5962.99.1.251476781.1015172444.1640929016621.14.0
1.3.6.1.4.1.5962.99.1.1631531608.353996804.1638014104152.36.0
1.3.6.1.4.1.5962.99.1.1909716652.987650816.1638292289196.22.0
1.3.6.1.4.1.5962.99.1.3061424162.933099148.1639443996706.15.0
1.3.6.1.4.1.5962.99.1.1235720605.1448919340.1637618293149.29.0
1.3.6.1.4.1.5962.99.1.2204308995.1136610178.1655766750723.37.0
1.3.6.1.4.1.5962.99.1.2358547573.1319252942.1655920989301.1326.0
1.3.6.1.4.1.5962.99.1.2004905765.1709848768.1638387478309.8.0
1.3.6.1.4.1.5962.99.1.252115199.1463077838.1640929655039.14.0
1.3.6.1.4.1.5962.99.1.272850553.1839714480.1640950390393.14.0
1.3.6.1.4.1.5962.99.1.3911376849.1201197034.1687538589649.30.0
1.3.6.1.4.1.5962.99.1.3458122692.1084633459.1639840695236.36.0
1.3.6.1.4.1.5962.99.1.294962783.1096614356.1640972502623.21.0
1.3.6.1.4.1.5962.99.1.1350385546.875081525.1637732958090.15.0
1.3.6.1.4.1.5962.99.1.2198863952.1145103584.1655761305680.44.0
1.3.6.1.4.1.5962.99.1.1459976677.1442651228.1637842549221.15.0
1.3.6.1.4.1.5962.99.1.1267210173.280579398.1637649782717.8.0
1.3.6.1.4.1.5962.99.1.124998202.2129488500.1640802538042.28.0
1.3.6.1.4.1.5962.99.1.1833547434.197627960.1638216119978.8.0
1.3.6.1.4.1.5962.99.1.256082067.529589996.1640933621907.21.0
1.3.6.1.4.1.5962.99.1.2137283551.627273463.1638519856095.8.0
1.3.6.1.4.1.5962.99.1.3022497032.1736082188.1639405069576.8.0
1.3.6.1.4.1.5962.99.1.1322893234.769468910.1637705465778.22.0
1.3.6.1.4.1.5962.99.1.3660062119.450198422.1640042634663.15.0
1.3.6.1.4.1.5962.99.1.1481315148.2127257417.1637863887692.22.0
1.3.6.1.4.1.5962.99.1.487549708.1025029709.1641165089548.35.0
1.3.6.1.4.1.5962.99.1.2107044430.169416486.1638489616974.8.0
1.3.6.1.4.1.5962.99.1.2354479345.898820832.1655916921073.941.0
1.3.6.1.4.1.5962.99.1.2202494792.302947620.1655764936520.37.0
1.3.6.1.4.1.5962.99.1.228217509.165497107.1640905757349.14.0
1.3.6.1.4.1.5962.99.1.2395853585.1034553989.1686023066385.16.0
1.3.6.1.4.1.5962.99.1.3099185692.848972114.1639481758236.22.0
1.3.6.1.4.1.5962.99.1.3655371307.1304141063.1640037943851.22.0
1.3.6.1.4.1.5962.99.1.3025352208.477704041.1639407924752.29.0
1.3.6.1.4.1.5962.99.1.1877301006.647042380.1638259873550.15.0
1.3.6.1.4.1.5962.99.1.288981992.1793344149.1640966521832.21.0
1.3.6.1.4.1.5962.99.1.273570084.1306102505.1640951109924.14.0
1.3.6.1.4.1.5962.99.1.2140289611.596105917.1655702731339.44.0
1.3.6.1.4.1.5962.99.1.1223242279.173503740.1637605814823.15.0
1.3.6.1.4.1.5962.99.1.1671973406.1746147156.1638054545950.8.0
1.3.6.1.4.1.5962.99.1.2271635652.2044023739.1638654208196.29.0
1.3.6.1.4.1.5962.99.1.1365696247.2017412565.1637748268791.22.0
1.3.6.1.4.1.5962.99.1.1588653069.665412881.1637971225613.22.0
1.3.6.1.4.1.5962.99.1.1042806844.973369406.1637425379388.36.0
1.3.6.1.4.1.5962.99.1.239161282.1298032537.1640916701122.28.0
1.3.6.1.4.1.5962.99.1.2090391183.193375910.1638472963727.36.0
1.3.6.1.4.1.5962.99.1.257012593.705706238.1640934552433.21.0
1.3.6.1.4.1.5962.99.1.1102420566.1825806482.1637484993110.8.0
1.3.6.1.4.1.5962.99.1.3032933152.1699425996.1639415505696.8.0
1.3.6.1.4.1.5962.99.1.3407100213.400206568.1639789672757.15.0
1.3.6.1.4.1.5962.99.1.1491017924.432079602.1637873590468.36.0
1.3.6.1.4.1.5962.99.1.1419641095.759723268.1637802213639.29.0
1.3.6.1.4.1.5962.99.1.200274034.46406646.1640877813874.14.0
1.3.6.1.4.1.5962.99.1.3016813181.144689614.1639399385725.29.0
1.3.6.1.4.1.5962.99.1.1134629870.1737744298.1637517202414.36.0
1.3.6.1.4.1.5962.99.1.2876075559.1762242618.1639258648103.36.0
1.3.6.1.4.1.5962.99.1.2044307168.1358874540.1638426879712.8.0
1.3.6.1.4.1.5962.99.1.3458166009.108465870.1639840738553.8.0
1.3.6.1.4.1.5962.99.1.2341019412.21033900.1638723591956.36.0
1.3.6.1.4.1.5962.99.1.219000382.1281575540.1640896540222.7.0
1.3.6.1.4.1.5962.99.1.2860007431.1389616193.1639242579975.8.0
1.3.6.1.4.1.5962.99.1.2321044444.1228939709.1638703616988.29.0
1.3.6.1.4.1.5962.99.1.1954045878.82393848.1638336618422.8.0
1.3.6.1.4.1.5962.99.1.
Query:
-- 4. Explore SpecimenDescriptionSequence in SM modality images
SELECT t."SOPInstanceUID", f.value AS "SpecimenDescriptionSequence"
FROM IDC.IDC_V17.DICOM_ALL t,
LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") f
WHERE t."Modality" = 'SM'
LIMIT 1000;
Answer:
Too long, hard cut:
SOPInstanceUID,SpecimenDescriptionSequence
1.3.6.1.4.1.5962.99.1.491513722.777873477.1641169053562.42.0,"{
  ""PrimaryAnatomicStructureSequence"": [
    {
      ""CodeMeaning"": ""Lung"",
      ""CodeValue"": ""39607008"",
      ""CodingSchemeDesignator"": ""SCT"",
      ""PrimaryAnatomicStructureModifierSequence"": []
    }
  ],
  ""SpecimenIdentifier"": ""130630_NLSI0000167"",
  ""SpecimenPreparationSequence"": [
    {
      ""SpecimenPreparationStepContentItemSequence"": [
        {
          ""ConceptCodeSequence"": [],
          ""ConceptNameCodeSequence"": [
            {
              ""CodeMeaning"": ""Specimen Identifier"",
              ""CodeValue"": ""121041"",
              ""CodingSchemeDesignator"": ""DCM""
            }
          ],
          ""TextValue"": ""130630_NLSI0000167"",
          ""ValueType"": ""TEXT""
        },
        {
          ""ConceptCodeSequence"": [
            {
              ""CodeMeaning"": ""Specimen processing"",
              ""CodeValue"": ""9265001"",
              ""CodingSchemeDesignator"": ""SCT""
            }
          ],
          ""ConceptNameCodeSequence"": [
            {
              ""CodeMeaning"": ""Processing type"",
              ""CodeValue"": ""111701"",
              ""CodingSchemeDesignator"": ""DCM""
            }
          ],
          ""ValueType"": ""CODE""
        },
        {
          ""ConceptCodeSequence"": [
            {
              ""CodeMeaning"": ""Formalin"",
              ""CodeValue"": ""431510009"",
              ""CodingSchemeDesignator"": ""SCT""
            }
          ],
          ""ConceptNameCodeSequence"": [
            {
              ""CodeMeaning"": ""Tissue Fixative"",
              ""CodeValue"": ""430864009"",
              ""CodingSchemeDesignator"": ""SCT""
            }
          ],
          ""ValueType"": ""CODE""
        }
      ]
    },
    {
      ""SpecimenPreparationStepContentItemSequence"": [
        {
          ""ConceptCodeSequence"": [],
          ""ConceptNameCodeSequence"": [
            {
              ""CodeMeaning"": ""Specimen Identifier"",
              ""CodeValue"": ""121041"",
              ""CodingSchemeDesignator"": ""DCM""
            }
          ],
          ""TextValue"": ""130630_NLSI0000167"",
          ""ValueType"": ""TEXT""
        },
        {
          ""ConceptCodeSequence"": [
            {
              ""CodeMeaning"": ""Specimen processing"",
              ""CodeValue"": ""9265001"",
              ""CodingSchemeDesignator"": ""SCT""
            }
          ],
          ""ConceptNameCodeSequence"": [
            {
              ""CodeMeaning"": ""Processing type"",
              ""CodeValue"": ""111701"",
              ""CodingSchemeDesignator"": ""DCM""
            }
          ],
          ""ValueType"": ""CODE""
        },
        {
          ""ConceptCodeSequence"": [
            {
              ""CodeMeaning"": ""Paraffin wax"",
              ""CodeValue"": ""311731000"",
              ""CodingSchemeDesignator"": ""SCT""
            }
          ],
          ""ConceptNameCodeSequence"": [
            {
              ""CodeMeaning"": ""Embedding medium"",
              ""CodeValue"": ""430863003"",
              ""CodingSchemeDesignator"": ""SCT""
            }
          ],
          ""ValueType"": ""CODE""
        }
      ]
    },
    {
      ""SpecimenPreparationStepContentItemSequence"": [
        {
          ""ConceptCodeSequence"": [],
          ""ConceptNameCodeSequence"": [
            {
              ""CodeMeaning"": ""Specimen Identifier"",
              ""CodeValue"": ""121041"",
              ""CodingSchemeDesignator"": ""DCM""
            }
          ],
          ""TextValue"": ""130630_NLSI0000167"",
          ""ValueType"": ""TEXT""
        },
        {
          ""ConceptCodeSequence"": [
            {
              ""CodeMeaning"": ""Staining"",
              ""CodeValue"": ""127790008"",
              ""CodingSchemeDesignator"": ""SCT""
            }
          ],
          ""ConceptNameCodeSequence"": [
            {
              ""CodeMeaning"": ""Processing type"",
              ""CodeValue"": ""111701"",
              ""CodingSchemeDesignator"": ""DCM""
            }
          ],
          ""ValueType"": ""CODE""
        },
        {
          ""ConceptCodeSequence"": [
            {
              ""CodeMeaning"": ""hematoxylin stain"",
              ""CodeValue"": ""12710003"",
              ""CodingSchemeDesignator"": ""SCT""
            }
          ],
          ""ConceptNameCodeSequence"": [
            {
              ""CodeMeaning"": ""Using substance"",
              ""CodeValue"": ""424361007"",
              ""CodingSchemeDesignator"": ""SCT""
            }
          ],
          ""ValueType"": ""CODE""
        },
        {
          ""ConceptCodeSequence"": [
            {
              ""CodeMeaning"": ""water soluble eosin stain"",
              ""CodeValue"": ""36879007"",
              ""CodingSchemeDesignator"": ""SCT""
            }
Query:
-- 5. Retrieve SpecimenPreparationSequence from SpecimenDescriptionSequence
SELECT t."SOPInstanceUID", s.value AS "SpecimenPreparationSequence"
FROM IDC.IDC_V17.DICOM_ALL t,
LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd,
LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") s
WHERE t."Modality" = 'SM'
LIMIT 1000;
Answer:
Too long, hard cut:
SOPInstanceUID,SpecimenPreparationSequence
1.3.6.1.4.1.5962.99.1.505946602.106805238.1641183486442.21.0,"{
  ""SpecimenPreparationStepContentItemSequence"": [
    {
      ""ConceptCodeSequence"": [],
      ""ConceptNameCodeSequence"": [
        {
          ""CodeMeaning"": ""Specimen Identifier"",
          ""CodeValue"": ""121041"",
          ""CodingSchemeDesignator"": ""DCM""
        }
      ],
      ""TextValue"": ""120316_11782"",
      ""ValueType"": ""TEXT""
    },
    {
      ""ConceptCodeSequence"": [
        {
          ""CodeMeaning"": ""Specimen processing"",
          ""CodeValue"": ""9265001"",
          ""CodingSchemeDesignator"": ""SCT""
        }
      ],
      ""ConceptNameCodeSequence"": [
        {
          ""CodeMeaning"": ""Processing type"",
          ""CodeValue"": ""111701"",
          ""CodingSchemeDesignator"": ""DCM""
        }
      ],
      ""ValueType"": ""CODE""
    },
    {
      ""ConceptCodeSequence"": [
        {
          ""CodeMeaning"": ""Formalin"",
          ""CodeValue"": ""431510009"",
          ""CodingSchemeDesignator"": ""SCT""
        }
      ],
      ""ConceptNameCodeSequence"": [
        {
          ""CodeMeaning"": ""Tissue Fixative"",
          ""CodeValue"": ""430864009"",
          ""CodingSchemeDesignator"": ""SCT""
        }
      ],
      ""ValueType"": ""CODE""
    }
  ]
}"
1.3.6.1.4.1.5962.99.1.505946602.106805238.1641183486442.21.0,"{
  ""SpecimenPreparationStepContentItemSequence"": [
    {
      ""ConceptCodeSequence"": [],
      ""ConceptNameCodeSequence"": [
        {
          ""CodeMeaning"": ""Specimen Identifier"",
          ""CodeValue"": ""121041"",
          ""CodingSchemeDesignator"": ""DCM""
        }
      ],
      ""TextValue"": ""120316_11782"",
      ""ValueType"": ""TEXT""
    },
    {
      ""ConceptCodeSequence"": [
        {
          ""CodeMeaning"": ""Specimen processing"",
          ""CodeValue"": ""9265001"",
          ""CodingSchemeDesignator"": ""SCT""
        }
      ],
      ""ConceptNameCodeSequence"": [
        {
          ""CodeMeaning"": ""Processing type"",
          ""CodeValue"": ""111701"",
          ""CodingSchemeDesignator"": ""DCM""
        }
      ],
      ""ValueType"": ""CODE""
    },
    {
      ""ConceptCodeSequence"": [
        {
          ""CodeMeaning"": ""Paraffin wax"",
          ""CodeValue"": ""311731000"",
          ""CodingSchemeDesignator"": ""SCT""
        }
      ],
      ""ConceptNameCodeSequence"": [
        {
          ""CodeMeaning"": ""Embedding medium"",
          ""CodeValue"": ""430863003"",
          ""CodingSchemeDesignator"": ""SCT""
        }
      ],
      ""ValueType"": ""CODE""
    }
  ]
}"
1.3.6.1.4.1.5962.99.1.505946602.106805238.1641183486442.21.0,"{
  ""SpecimenPreparationStepContentItemSequence"": [
    {
      ""ConceptCodeSequence"": [],
      ""ConceptNameCodeSequence"": [
        {
          ""CodeMeaning"": ""Specimen Identifier"",
          ""CodeValue"": ""121041"",
          ""CodingSchemeDesignator"": ""DCM""
        }
      ],
      ""TextValue"": ""120316_11782"",
      ""ValueType"": ""TEXT""
    },
    {
      ""ConceptCodeSequence"": [
        {
          ""CodeMeaning"": ""Staining"",
          ""CodeValue"": ""127790008"",
          ""CodingSchemeDesignator"": ""SCT""
        }
      ],
      ""ConceptNameCodeSequence"": [
        {
          ""CodeMeaning"": ""Processing type"",
          ""CodeValue"": ""111701"",
          ""CodingSchemeDesignator"": ""DCM""
        }
      ],
      ""ValueType"": ""CODE""
    },
    {
      ""ConceptCodeSequence"": [
        {
          ""CodeMeaning"": ""hematoxylin stain"",
          ""CodeValue"": ""12710003"",
          ""CodingSchemeDesignator"": ""SCT""
        }
      ],
      ""ConceptNameCodeSequence"": [
        {
          ""CodeMeaning"": ""Using substance"",
          ""CodeValue"": ""424361007"",
          ""CodingSchemeDesignator"": ""SCT""
        }
      ],
      ""ValueType"": ""CODE""
    },
    {
      ""ConceptCodeSequence"": [
        {
          ""CodeMeaning"": ""water soluble eosin stain"",
          ""CodeValue"": ""36879007"",
          ""CodingSchemeDesignator"": ""SCT""
        }
      ],
      ""ConceptNameCodeSequence"": [
        {
          ""CodeMeaning"": ""Using substance"",
          ""CodeValue"": ""424361007"",
          ""CodingSchemeDesignator"": ""SCT""
        }
      ],
      ""ValueType"": ""CODE""
    }
  ]
}"
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,"{
  ""SpecimenPreparationStepContentItemSequence"": [
    {
      ""ConceptCodeSequence"": [],
      ""ConceptNameCodeSequence"": [
        {
          ""CodeMeaning"": ""Specimen Identifier"",
          ""CodeValue"": ""121041"",
          ""CodingSchemeDesignator"": ""DCM""
        }
      ],
      ""TextValue"": ""HTA7_922_2"",
      ""ValueType"": ""TEXT""
    },
    {
      ""ConceptCodeSequence"": [
        {
          ""CodeMeaning"": ""Specimen Collection"",
          ""CodeValue"": ""17636008"",

Query:
-- 6. Extract SpecimenPreparationStepContentItemSequence
SELECT t."SOPInstanceUID", c.value AS "SpecimenPreparationStepContentItemSequence"
FROM IDC.IDC_V17.DICOM_ALL t,
LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd,
LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp,
LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
WHERE t."Modality" = 'SM'
LIMIT 1000;
Answer:
Too long, hard cut:
SOPInstanceUID,SpecimenPreparationStepContentItemSequence
1.3.6.1.4.1.5962.99.1.2023000241.619219898.1638405572785.29.0,"{
  ""ConceptCodeSequence"": [],
  ""ConceptNameCodeSequence"": [
    {
      ""CodeMeaning"": ""Specimen Identifier"",
      ""CodeValue"": ""121041"",
      ""CodingSchemeDesignator"": ""DCM""
    }
  ],
  ""TextValue"": ""TCGA-24-2298-01"",
  ""ValueType"": ""TEXT""
}"
1.3.6.1.4.1.5962.99.1.2023000241.619219898.1638405572785.29.0,"{
  ""ConceptCodeSequence"": [
    {
      ""CodeMeaning"": ""Specimen container"",
      ""CodeValue"": ""434711009"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ConceptNameCodeSequence"": [
    {
      ""CodeMeaning"": ""Specimen container"",
      ""CodeValue"": ""434711009"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ValueType"": ""CODE""
}"
1.3.6.1.4.1.5962.99.1.2023000241.619219898.1638405572785.29.0,"{
  ""ConceptCodeSequence"": [
    {
      ""CodeMeaning"": ""Tissue specimen"",
      ""CodeValue"": ""119376003"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ConceptNameCodeSequence"": [
    {
      ""CodeMeaning"": ""Specimen type"",
      ""CodeValue"": ""371439000"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ValueType"": ""CODE""
}"
1.3.6.1.4.1.5962.99.1.2023000241.619219898.1638405572785.29.0,"{
  ""ConceptCodeSequence"": [
    {
      ""CodeMeaning"": ""Specimen Collection"",
      ""CodeValue"": ""17636008"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ConceptNameCodeSequence"": [
    {
      ""CodeMeaning"": ""Processing type"",
      ""CodeValue"": ""111701"",
      ""CodingSchemeDesignator"": ""DCM""
    }
  ],
  ""ValueType"": ""CODE""
}"
1.3.6.1.4.1.5962.99.1.2023000241.619219898.1638405572785.29.0,"{
  ""ConceptCodeSequence"": [
    {
      ""CodeMeaning"": ""Removal"",
      ""CodeValue"": ""118292001"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ConceptNameCodeSequence"": [
    {
      ""CodeMeaning"": ""Specimen Collection"",
      ""CodeValue"": ""17636008"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ValueType"": ""CODE""
}"
1.3.6.1.4.1.5962.99.1.2023000241.619219898.1638405572785.29.0,"{
  ""ConceptCodeSequence"": [],
  ""ConceptNameCodeSequence"": [
    {
      ""CodeMeaning"": ""Specimen Identifier"",
      ""CodeValue"": ""121041"",
      ""CodingSchemeDesignator"": ""DCM""
    }
  ],
  ""TextValue"": ""TCGA-24-2298-01A"",
  ""ValueType"": ""TEXT""
}"
1.3.6.1.4.1.5962.99.1.2023000241.619219898.1638405572785.29.0,"{
  ""ConceptCodeSequence"": [
    {
      ""CodeMeaning"": ""Specimen vial"",
      ""CodeValue"": ""434746001"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ConceptNameCodeSequence"": [
    {
      ""CodeMeaning"": ""Specimen container"",
      ""CodeValue"": ""434711009"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ValueType"": ""CODE""
}"
1.3.6.1.4.1.5962.99.1.2023000241.619219898.1638405572785.29.0,"{
  ""ConceptCodeSequence"": [
    {
      ""CodeMeaning"": ""Tissue specimen"",
      ""CodeValue"": ""119376003"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ConceptNameCodeSequence"": [
    {
      ""CodeMeaning"": ""Specimen type"",
      ""CodeValue"": ""371439000"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ValueType"": ""CODE""
}"
1.3.6.1.4.1.5962.99.1.2023000241.619219898.1638405572785.29.0,"{
  ""ConceptCodeSequence"": [
    {
      ""CodeMeaning"": ""Specimen Sampling"",
      ""CodeValue"": ""433465004"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ConceptNameCodeSequence"": [
    {
      ""CodeMeaning"": ""Processing type"",
      ""CodeValue"": ""111701"",
      ""CodingSchemeDesignator"": ""DCM""
    }
  ],
  ""ValueType"": ""CODE""
}"
1.3.6.1.4.1.5962.99.1.2023000241.619219898.1638405572785.29.0,"{
  ""ConceptCodeSequence"": [
    {
      ""CodeMeaning"": ""Sampling of tissue specimen"",
      ""CodeValue"": ""433465004"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ConceptNameCodeSequence"": [
    {
      ""CodeMeaning"": ""Sampling Method"",
      ""CodeValue"": ""111704"",
      ""CodingSchemeDesignator"": ""DCM""
    }
  ],
  ""ValueType"": ""CODE""
}"
1.3.6.1.4.1.5962.99.1.2023000241.619219898.1638405572785.29.0,"{
  ""ConceptCodeSequence"": [],
  ""ConceptNameCodeSequence"": [
    {
      ""CodeMeaning"": ""Parent Specimen Identifier"",
      ""CodeValue"": ""111705"",
      ""CodingSchemeDesignator"": ""DCM""
    }
  ],
  ""TextValue"": ""TCGA-24-2298-01"",
  ""ValueType"": ""TEXT""
}"
1.3.6.1.4.1.5962.99.1.2023000241.619219898.1638405572785.29.0,"{
  ""ConceptCodeSequence"": [
    {
      ""CodeMeaning"": ""Tissue specimen"",
      ""CodeValue"": ""119376003"",
      ""CodingSchemeDesignator"": ""SCT""
    }
  ],
  ""ConceptNameCodeSequence"": [
    {
      ""CodeMeaning"": ""Parent specimen type"",
      ""CodeValue"": ""111707"",
      ""CodingSchemeDesignator"": ""DCM""
    }
  ],
  ""ValueType"": ""CODE""
}"
1.3.6.1.4.1.
Query:
-- 7. Extract CodeMeaning and CodingSchemeDesignator from SpecimenPreparationStepContentItemSequence
SELECT
  t."SOPInstanceUID",
  c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING AS "ConceptNameCodeMeaning",
  c.value:"ConceptNameCodeSequence"[0]:"CodingSchemeDesignator"::STRING AS "ConceptNameCodingSchemeDesignator",
  c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "ConceptCodeMeaning",
  c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING AS "ConceptCodeCodingSchemeDesignator",
  c.value:"TextValue"::STRING AS "TextValue"
FROM IDC.IDC_V17.DICOM_ALL t,
LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd,
LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp,
LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
WHERE t."Modality" = 'SM'
LIMIT 1000;
Answer:
Too long, hard cut:
SOPInstanceUID,ConceptNameCodeMeaning,ConceptNameCodingSchemeDesignator,ConceptCodeMeaning,ConceptCodeCodingSchemeDesignator,TextValue
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Specimen Identifier,DCM,,,HTA7_922_2
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Processing type,DCM,Specimen Collection,SCT,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Specimen Collection,SCT,Resection,SCT,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Specimen Identifier,DCM,,,HTA7_922_1000
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Specimen container,SCT,Microscope slide,SCT,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Specimen type,SCT,Slide,SCT,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Processing type,DCM,Specimen Sampling,SCT,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Sampling Method,DCM,Block sectioning,SCT,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Parent Specimen Identifier,DCM,,,HTA7_922_2
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Parent specimen type,DCM,Gross specimen,SCT,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Specimen Identifier,DCM,,,HTA7_922_1000
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Processing type,DCM,Staining,SCT,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Channel,NCIt,,,5
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Cycle,NCIt,,,2
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Component investigated,SCT,Rat protein,SCT,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Component investigated,SCT,,,Rat-IgG
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Tracer,NCIt,Fluorophore,UMLS,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Using Fluorophore,UMLS,Alexa Fluor 488,PUBCHEM_CID,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Using Fluorophore,UMLS,,,Alexa Fluor 488
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Using substance,SCT,"Donkey anti-Rat IgG (H+L) Secondary AB, Alexa Fluor 488",RRID,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Staining Technique,SCT,Fluorescent staining,SCT,
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Manufacturer Name,UMLS,,,Thermo Fisher
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Brand Name,DCM,,,A-21208
1.3.6.1.4.1.5962.99.1.2349996087.1135814742.1655912437815.227.0,Dilution,UMLS,,,1:2000
1.3.6.1.4.1.5962.99.1.156560246.107498373.1640834100086.7.0,Specimen Identifier,DCM,,,C3L-02556-03
1.3.6.1.4.1.5962.99.1.156560246.107498373.1640834100086.7.0,Processing type,DCM,Staining,SCT,
1.3.6.1.4.1.5962.99.1.156560246.107498373.1640834100086.7.0,Using substance,SCT,hematoxylin stain,SCT,
1.3.6.1.4.1.5962.99.1.156560246.107498373.1640834100086.7.0,Using substance,SCT,water soluble eosin stain,SCT,
1.3.6.1.4.1.5962.99.1.156579441.409510745.1640834119281.35.0,Specimen Identifier,DCM,,,C3N-00852-02
1.3.6.1.4.1.5962.99.1.156579441.409510745.1640834119281.35.0,Processing type,DCM,Staining,SCT,
1.3.6.1.4.1.5962.99.1.156579441.409510745.1640834119281.35.0,Using substance,SCT,hematoxylin stain,SCT,
1.3.6.1.4.1.5962.99.1.156579441.409510745.1640834119281.35.0,Using substance,SCT,water soluble eosin stain,SCT,
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Specimen Identifier,DCM,,,TCGA-06-5417-01
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Specimen container,SCT,Specimen container,SCT,
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Specimen type,SCT,Tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Processing type,DCM,Specimen Collection,SCT,
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Specimen Collection,SCT,Removal,SCT,
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Specimen Identifier,DCM,,,TCGA-06-5417-01A
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Specimen container,SCT,Specimen vial,SCT,
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Specimen type,SCT,Tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Processing type,DCM,Specimen Sampling,SCT,
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Sampling Method,DCM,Sampling of tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Parent Specimen Identifier,DCM,,,TCGA-06-5417-01
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Parent specimen type,DCM,Tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Specimen Identifier,DCM,,,TCGA-06-5417-01A-01
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Processing type,DCM,Specimen Sampling,SCT,
1.3.6.1.4.1.5962.99.1.1126803882.1132778094.1637509376426.15.0,Specimen cont
Query:
-- 8. Filter for CodingSchemeDesignator='SCT' and extract CodeMeanings
SELECT
  t."SOPInstanceUID",
  c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING AS "ConceptNameCodeMeaning",
  c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "ConceptCodeMeaning",
  c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING AS "CodingSchemeDesignator",
  c.value:"TextValue"::STRING AS "TextValue"
FROM IDC.IDC_V17.DICOM_ALL t,
LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd,
LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp,
LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
WHERE t."Modality" = 'SM'
  AND c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
LIMIT 1000;
Answer:
Too long, hard cut:
SOPInstanceUID,ConceptNameCodeMeaning,ConceptCodeMeaning,CodingSchemeDesignator,TextValue
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Specimen container,Specimen container,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Specimen type,Tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Processing type,Specimen Collection,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Specimen Collection,Removal,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Specimen container,Specimen vial,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Specimen type,Tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Processing type,Specimen Sampling,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Sampling Method,Sampling of tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Parent specimen type,Tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Processing type,Specimen Sampling,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Specimen container,Tissue cassette,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Specimen type,Gross specimen,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Sampling Method,Sampling of tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Parent specimen type,Tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Specimen container,Microscope slide,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Specimen type,Slide,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Processing type,Specimen Sampling,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Sampling Method,Block sectioning,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Parent specimen type,Gross specimen,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Processing type,Specimen processing,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Tissue Fixative,Formalin,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Processing type,Specimen processing,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Embedding medium,Paraffin wax,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Processing type,Staining,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Using substance,hematoxylin stain,SCT,
1.3.6.1.4.1.5962.99.1.1258951611.772750638.1637641524155.8.0,Using substance,water soluble eosin stain,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Specimen container,Specimen container,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Specimen type,Tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Processing type,Specimen Collection,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Specimen Collection,Removal,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Specimen container,Specimen vial,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Specimen type,Tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Processing type,Specimen Sampling,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Sampling Method,Sampling of tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Parent specimen type,Tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Processing type,Specimen Sampling,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Specimen container,Tissue cassette,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Specimen type,Gross specimen,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Sampling Method,Sampling of tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Parent specimen type,Tissue specimen,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Specimen container,Microscope slide,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Specimen type,Slide,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Processing type,Specimen Sampling,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Sampling Method,Block sectioning,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Parent specimen type,Gross specimen,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Processing type,Specimen processing,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Embedding medium,Tissue freezing medium,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Processing type,Staining,SCT,
1.3.6.1.4.1.5962.99.1.1272275004.185830696.1637654847548.29.0,Using substance,hematoxylin stain
Query:
-- 9. List distinct embedding medium code meanings from SM modality
SELECT DISTINCT c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "EmbeddingMediumCodeMeaning"
FROM IDC.IDC_V17.DICOM_ALL t,
LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd,
LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp,
LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
WHERE t."Modality" = 'SM'
  AND c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING ILIKE '%embedding medium%'
  AND c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
LIMIT 1000;
Answer:
EmbeddingMediumCodeMeaning
Tissue freezing medium
Paraffin wax
Query:
-- 10. List distinct staining substance code meanings from SM modality
SELECT DISTINCT c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "StainingSubstanceCodeMeaning"
FROM IDC.IDC_V17.DICOM_ALL t,
LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd,
LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp,
LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
WHERE t."Modality" = 'SM'
  AND c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING ILIKE '%staining%'
  AND c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
LIMIT 1000;
Answer:
StainingSubstanceCodeMeaning
Fluorescent staining
End Exploring Related Columns
Task: Can you list all unique pairs of embedding medium and staining substance code meanings, along with the number of occurrences for each pair, based on distinct embedding medium and staining substance codes from the 'SM' modality in the DICOM dataset's un-nested specimen preparation sequences, ensuring that the codes are from the SCT coding scheme?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: SELECT S."Column_Name" FROM {Database Name}.{Schema Name}.{Table_name} (ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
embedding_medium_meaning,staining_substance_meaning,occurrences
embedding_medium_code_meaning:str,staining_substance_code_meaning:str,num:int
```

This table lists all unique pairs of embedding medium and staining substance code meanings from the SCT (SNOMED CT) coding scheme found in the 'SM' (Slide Microscopy) modality images within the DICOM dataset's un-nested specimen preparation sequences. Each row represents a unique combination of embedding medium and staining substance along with the number of occurrences (`occurrences`) for that pair..
Here are some useful tips for answering:
When calculating distances between two geometries, use `ST_MakePoint(x, y)` to make a point and `ST_Distance(geometry1 GEOMETRY, geometry2 GEOMETRY)` to compute. No need to convert from meters to miles unless requested. Don't use Haversine like 2 * 6371000 * ASIN(...), use ST_DISTANCE for more precise results.
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'IDC': {'IDC_V17': ['ANALYSIS_RESULTS_METADATA', 'AUXILIARY_METADATA', 'DICOM_ALL', 'DICOM_METADATA', 'DICOM_METADATA_CURATED', 'DICOM_METADATA_CURATED_SERIES_LEVEL', 'DICOM_PIVOT', 'MEASUREMENT_GROUPS', 'MUTABLE_METADATA', 'ORIGINAL_COLLECTIONS_METADATA', 'QUALITATIVE_MEASUREMENTS', 'QUANTITATIVE_MEASUREMENTS', 'SEGMENTATIONS', 'TCGA_BIOSPECIMEN_REL9', 'TCGA_CLINICAL_REL9', 'VERSION_METADATA']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book" SQL: WHERE "title" LIKE '%book%'
However, if the string is not decided, you may use ILIKE and %. e.g. Get articles that mention "education": SQL: "body" ILIKE '%education%' OR "title" ILIKE '%education%'
When handling TO_TIMESTAMP_NTZ conversions, use query like: SELECT CASE WHEN "date" >= 1e15 THEN TO_TIMESTAMP_NTZ("date" / 1000000) WHEN "date" >= 1e12 THEN TO_TIMESTAMP_NTZ("date" / 1000) ELSE TO_TIMESTAMP_NTZ("date") END AS parsed_timestamp FROM my_table;
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
Keep all decimals to four decimal places.

2025-01-17 20:11:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:11:17 - root - INFO - ```sql
WITH embedding_medium AS (
  SELECT DISTINCT
    t."SOPInstanceUID",
    sd.index AS sd_index,
    c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "embedding_medium_meaning"
  FROM IDC.IDC_V17.DICOM_ALL t
    LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd
    LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp
    LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
  WHERE t."Modality" = 'SM'
    AND c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Embedding medium'
    AND c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
),
staining_substance AS (
  SELECT DISTINCT
    t."SOPInstanceUID",
    sd.index AS sd_index,
    c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "staining_substance_meaning"
  FROM IDC.IDC_V17.DICOM_ALL t
    LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd
    LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp
    LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
  WHERE t."Modality" = 'SM'
    AND c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Using substance'
    AND c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
    AND EXISTS (
      SELECT 1
      FROM TABLE(LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence")) c2
      WHERE c2.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Processing type'
        AND c2.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING = 'Staining'
    )
)
SELECT
  em."embedding_medium_meaning",
  ss."staining_substance_meaning",
  COUNT(DISTINCT em."SOPInstanceUID", em.sd_index) AS "occurrences"
FROM embedding_medium em
JOIN staining_substance ss
  ON em."SOPInstanceUID" = ss."SOPInstanceUID" AND em.sd_index = ss.sd_index
GROUP BY em."embedding_medium_meaning", ss."staining_substance_meaning"
ORDER BY "occurrences" DESC;
```
2025-01-17 20:11:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:11:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:11:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:11:18 - snowflake.connector.connection - INFO - closed
2025-01-17 20:11:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:11:18 - root - INFO - itercount: 1
2025-01-17 20:11:18 - root - INFO - 001003 (42000): 01b9c75b-0004-7ca3-0001-11c300edb2ee: SQL compilation error:
syntax error line 7 at position 4 unexpected 'LATERAL'.
syntax error line 7 at position 20 unexpected 'input'.
syntax error line 7 at position 62 unexpected 'sd'.
2025-01-17 20:11:18 - root - INFO - Input sql:
WITH embedding_medium AS (
  SELECT DISTINCT
    t."SOPInstanceUID",
    sd.index AS sd_index,
    c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "embedding_medium_meaning"
  FROM IDC.IDC_V17.DICOM_ALL t
    LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd
    LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp
    LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
  WHERE t."Modality" = 'SM'
    AND c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Embedding medium'
    AND c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
),
staining_substance AS (
  SELECT DISTINCT
    t."SOPInstanceUID",
    sd.index AS sd_index,
    c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "staining_substance_meaning"
  FROM IDC.IDC_V17.DICOM_ALL t
    LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd
    LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp
    LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
  WHERE t."Modality" = 'SM'
    AND c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Using substance'
    AND c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
    AND EXISTS (
      SELECT 1
      FROM TABLE(LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence")) c2
      WHERE c2.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Processing type'
        AND c2.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING = 'Staining'
    )
)
SELECT
  em."embedding_medium_meaning",
  ss."staining_substance_meaning",
  COUNT(DISTINCT em."SOPInstanceUID", em.sd_index) AS "occurrences"
FROM embedding_medium em
JOIN staining_substance ss
  ON em."SOPInstanceUID" = ss."SOPInstanceUID" AND em.sd_index = ss.sd_index
GROUP BY em."embedding_medium_meaning", ss."staining_substance_meaning"
ORDER BY "occurrences" DESC;
The error information is:
001003 (42000): 01b9c75b-0004-7ca3-0001-11c300edb2ee: SQL compilation error:
syntax error line 7 at position 4 unexpected 'LATERAL'.
syntax error line 7 at position 20 unexpected 'input'.
syntax error line 7 at position 62 unexpected 'sd'.
Please correct it and output only 1 complete SQL query.When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-17 20:11:47 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:11:47 - root - INFO - ```sql
WITH embedding_medium AS (
  SELECT DISTINCT
    t."SOPInstanceUID",
    sd.seq AS sd_seq,
    c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "embedding_medium_meaning"
  FROM IDC.IDC_V17.DICOM_ALL t
    CROSS JOIN LATERAL TABLE(FLATTEN(input => t."SpecimenDescriptionSequence")) sd
    CROSS JOIN LATERAL TABLE(FLATTEN(input => sd.value:"SpecimenPreparationSequence")) sp
    CROSS JOIN LATERAL TABLE(FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence")) c
  WHERE t."Modality" = 'SM'
    AND c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Embedding medium'
    AND c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
),
staining_substance AS (
  SELECT DISTINCT
    t."SOPInstanceUID",
    sd.seq AS sd_seq,
    c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "staining_substance_meaning"
  FROM IDC.IDC_V17.DICOM_ALL t
    CROSS JOIN LATERAL TABLE(FLATTEN(input => t."SpecimenDescriptionSequence")) sd
    CROSS JOIN LATERAL TABLE(FLATTEN(input => sd.value:"SpecimenPreparationSequence")) sp
    CROSS JOIN LATERAL TABLE(FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence")) c
  WHERE t."Modality" = 'SM'
    AND c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Using substance'
    AND c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
    AND EXISTS (
      SELECT 1
      FROM TABLE(FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence")) c2
      WHERE c2.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Processing type'
        AND c2.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING = 'Staining'
    )
)
SELECT
  em."embedding_medium_meaning",
  ss."staining_substance_meaning",
  COUNT(DISTINCT em."SOPInstanceUID", em.sd_seq) AS "occurrences"
FROM embedding_medium em
JOIN staining_substance ss
  ON em."SOPInstanceUID" = ss."SOPInstanceUID" AND em.sd_seq = ss.sd_seq
GROUP BY em."embedding_medium_meaning", ss."staining_substance_meaning"
ORDER BY "occurrences" DESC NULLS LAST;
```
2025-01-17 20:11:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:11:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:11:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:11:48 - snowflake.connector.connection - INFO - closed
2025-01-17 20:11:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:11:49 - root - INFO - itercount: 2
2025-01-17 20:11:49 - root - INFO - 001003 (42000): 01b9c75b-0004-7ca3-0001-11c300edb30e: SQL compilation error:
syntax error line 7 at position 23 unexpected 'TABLE'.
syntax error line 7 at position 28 unexpected '('.
2025-01-17 20:11:49 - root - INFO - Input sql:
WITH embedding_medium AS (
  SELECT DISTINCT
    t."SOPInstanceUID",
    sd.seq AS sd_seq,
    c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "embedding_medium_meaning"
  FROM IDC.IDC_V17.DICOM_ALL t
    CROSS JOIN LATERAL TABLE(FLATTEN(input => t."SpecimenDescriptionSequence")) sd
    CROSS JOIN LATERAL TABLE(FLATTEN(input => sd.value:"SpecimenPreparationSequence")) sp
    CROSS JOIN LATERAL TABLE(FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence")) c
  WHERE t."Modality" = 'SM'
    AND c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Embedding medium'
    AND c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
),
staining_substance AS (
  SELECT DISTINCT
    t."SOPInstanceUID",
    sd.seq AS sd_seq,
    c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "staining_substance_meaning"
  FROM IDC.IDC_V17.DICOM_ALL t
    CROSS JOIN LATERAL TABLE(FLATTEN(input => t."SpecimenDescriptionSequence")) sd
    CROSS JOIN LATERAL TABLE(FLATTEN(input => sd.value:"SpecimenPreparationSequence")) sp
    CROSS JOIN LATERAL TABLE(FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence")) c
  WHERE t."Modality" = 'SM'
    AND c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Using substance'
    AND c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
    AND EXISTS (
      SELECT 1
      FROM TABLE(FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence")) c2
      WHERE c2.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Processing type'
        AND c2.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING = 'Staining'
    )
)
SELECT
  em."embedding_medium_meaning",
  ss."staining_substance_meaning",
  COUNT(DISTINCT em."SOPInstanceUID", em.sd_seq) AS "occurrences"
FROM embedding_medium em
JOIN staining_substance ss
  ON em."SOPInstanceUID" = ss."SOPInstanceUID" AND em.sd_seq = ss.sd_seq
GROUP BY em."embedding_medium_meaning", ss."staining_substance_meaning"
ORDER BY "occurrences" DESC NULLS LAST;
The error information is:
001003 (42000): 01b9c75b-0004-7ca3-0001-11c300edb30e: SQL compilation error:
syntax error line 7 at position 23 unexpected 'TABLE'.
syntax error line 7 at position 28 unexpected '('.
Please correct it and output only 1 complete SQL query.When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-17 20:13:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:13:13 - root - INFO - ```sql
WITH embedding_medium AS (
  SELECT DISTINCT
    t."SOPInstanceUID",
    sd.seq AS sd_seq,
    c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "embedding_medium_meaning"
  FROM IDC.IDC_V17.DICOM_ALL t
    CROSS JOIN LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd
    CROSS JOIN LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp
    CROSS JOIN LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
  WHERE t."Modality" = 'SM'
    AND c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Embedding medium'
    AND c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
),
staining_substance AS (
  SELECT DISTINCT
    t."SOPInstanceUID",
    sd.seq AS sd_seq,
    c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "staining_substance_meaning"
  FROM IDC.IDC_V17.DICOM_ALL t
    CROSS JOIN LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd
    CROSS JOIN LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp
    CROSS JOIN LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
  WHERE t."Modality" = 'SM'
    AND c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Using substance'
    AND c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
    AND EXISTS (
      SELECT 1
      FROM LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c2
      WHERE c2.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Processing type'
        AND c2.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING = 'Staining'
    )
)
SELECT
  em."embedding_medium_meaning",
  ss."staining_substance_meaning",
  COUNT(DISTINCT em."SOPInstanceUID", em.sd_seq) AS "occurrences"
FROM embedding_medium em
JOIN staining_substance ss
  ON em."SOPInstanceUID" = ss."SOPInstanceUID" AND em.sd_seq = ss.sd_seq
GROUP BY em."embedding_medium_meaning", ss."staining_substance_meaning"
ORDER BY "occurrences" DESC NULLS LAST;
```
2025-01-17 20:13:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:13:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:13:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:13:14 - snowflake.connector.connection - INFO - closed
2025-01-17 20:13:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:13:15 - root - INFO - itercount: 3
2025-01-17 20:13:15 - root - INFO - 002031 (42601): 01b9c75d-0004-7b16-0001-11c300eda6c6: SQL compilation error:
Unsupported subquery type cannot be evaluated
2025-01-17 20:13:15 - root - INFO - Input sql:
WITH embedding_medium AS (
  SELECT DISTINCT
    t."SOPInstanceUID",
    sd.seq AS sd_seq,
    c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "embedding_medium_meaning"
  FROM IDC.IDC_V17.DICOM_ALL t
    CROSS JOIN LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd
    CROSS JOIN LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp
    CROSS JOIN LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
  WHERE t."Modality" = 'SM'
    AND c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Embedding medium'
    AND c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
),
staining_substance AS (
  SELECT DISTINCT
    t."SOPInstanceUID",
    sd.seq AS sd_seq,
    c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "staining_substance_meaning"
  FROM IDC.IDC_V17.DICOM_ALL t
    CROSS JOIN LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd
    CROSS JOIN LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp
    CROSS JOIN LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
  WHERE t."Modality" = 'SM'
    AND c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Using substance'
    AND c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
    AND EXISTS (
      SELECT 1
      FROM LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c2
      WHERE c2.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Processing type'
        AND c2.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING = 'Staining'
    )
)
SELECT
  em."embedding_medium_meaning",
  ss."staining_substance_meaning",
  COUNT(DISTINCT em."SOPInstanceUID", em.sd_seq) AS "occurrences"
FROM embedding_medium em
JOIN staining_substance ss
  ON em."SOPInstanceUID" = ss."SOPInstanceUID" AND em.sd_seq = ss.sd_seq
GROUP BY em."embedding_medium_meaning", ss."staining_substance_meaning"
ORDER BY "occurrences" DESC NULLS LAST;
The error information is:
002031 (42601): 01b9c75d-0004-7b16-0001-11c300eda6c6: SQL compilation error:
Unsupported subquery type cannot be evaluated
Please correct it and output only 1 complete SQL query.When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-17 20:13:53 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:13:53 - root - INFO - ```sql
WITH
embedding_medium AS (
  SELECT DISTINCT
    t."SOPInstanceUID",
    sd.seq AS sd_seq,
    sp.seq AS sp_seq,
    c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "embedding_medium_meaning"
  FROM IDC.IDC_V17.DICOM_ALL t
    CROSS JOIN LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd
    CROSS JOIN LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp
    CROSS JOIN LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
  WHERE t."Modality" = 'SM'
    AND c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Embedding medium'
    AND c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
),
staining_substance AS (
  SELECT DISTINCT
    t."SOPInstanceUID",
    sd.seq AS sd_seq,
    sp.seq AS sp_seq,
    c_us.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "staining_substance_meaning"
  FROM IDC.IDC_V17.DICOM_ALL t
    CROSS JOIN LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd
    CROSS JOIN LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp
    CROSS JOIN LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c_pt
    CROSS JOIN LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c_us
  WHERE t."Modality" = 'SM'
    AND c_pt.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Processing type'
    AND c_pt.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING = 'Staining'
    AND c_us.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Using substance'
    AND c_us.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
)
SELECT
  em."embedding_medium_meaning",
  ss."staining_substance_meaning",
  COUNT(DISTINCT em."SOPInstanceUID", em.sd_seq, em.sp_seq) AS "occurrences"
FROM embedding_medium em
JOIN staining_substance ss
  ON em."SOPInstanceUID" = ss."SOPInstanceUID"
     AND em.sd_seq = ss.sd_seq
     AND em.sp_seq = ss.sp_seq
GROUP BY em."embedding_medium_meaning", ss."staining_substance_meaning"
ORDER BY "occurrences" DESC NULLS LAST;
```
2025-01-17 20:13:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:13:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:13:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:13:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 4
2025-01-17 20:13:55 - snowflake.connector.connection - INFO - closed
2025-01-17 20:13:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:13:55 - root - INFO - itercount: 4
2025-01-17 20:13:55 - root - INFO - 0
2025-01-17 20:13:55 - root - INFO - results: 
embedding_medium_meaning,staining_substance_meaning,occurrences
Tissue freezing medium,hematoxylin stain,163
Tissue freezing medium,water soluble eosin stain,163
Paraffin wax,hematoxylin stain,140
Paraffin wax,water soluble eosin stain,140


2025-01-17 20:13:55 - root - INFO - Please check the answer again by reviewing Can you list all unique pairs of embedding medium and staining substance code meanings, along with the number of occurrences for each pair, based on distinct embedding medium and staining substance codes from the 'SM' modality in the DICOM dataset's un-nested specimen preparation sequences, ensuring that the codes are from the SCT coding scheme?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
embedding_medium_meaning,staining_substance_meaning,occurrences
embedding_medium_code_meaning:str,staining_substance_code_meaning:str,num:int
```

This table lists all unique pairs of embedding medium and staining substance code meanings from the SCT (SNOMED CT) coding scheme found in the 'SM' (Slide Microscopy) modality images within the DICOM dataset's un-nested specimen preparation sequences. Each row represents a unique combination of embedding medium and staining substance along with the number of occurrences (`occurrences`) for that pair. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
embedding_medium_meaning,staining_substance_meaning,occurrences
Tissue freezing medium,hematoxylin stain,163
Tissue freezing medium,water soluble eosin stain,163
Paraffin wax,hematoxylin stain,140
Paraffin wax,water soluble eosin stain,140
Current sql:
WITH
embedding_medium AS (
  SELECT DISTINCT
    t."SOPInstanceUID",
    sd.seq AS sd_seq,
    sp.seq AS sp_seq,
    c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "embedding_medium_meaning"
  FROM IDC.IDC_V17.DICOM_ALL t
    CROSS JOIN LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd
    CROSS JOIN LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp
    CROSS JOIN LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
  WHERE t."Modality" = 'SM'
    AND c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Embedding medium'
    AND c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
),
staining_substance AS (
  SELECT DISTINCT
    t."SOPInstanceUID",
    sd.seq AS sd_seq,
    sp.seq AS sp_seq,
    c_us.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "staining_substance_meaning"
  FROM IDC.IDC_V17.DICOM_ALL t
    CROSS JOIN LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd
    CROSS JOIN LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp
    CROSS JOIN LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c_pt
    CROSS JOIN LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c_us
  WHERE t."Modality" = 'SM'
    AND c_pt.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Processing type'
    AND c_pt.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING = 'Staining'
    AND c_us.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Using substance'
    AND c_us.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
)
SELECT
  em."embedding_medium_meaning",
  ss."staining_substance_meaning",
  COUNT(DISTINCT em."SOPInstanceUID", em.sd_seq, em.sp_seq) AS "occurrences"
FROM embedding_medium em
JOIN staining_substance ss
  ON em."SOPInstanceUID" = ss."SOPInstanceUID"
     AND em.sd_seq = ss.sd_seq
     AND em.sp_seq = ss.sp_seq
GROUP BY em."embedding_medium_meaning", ss."staining_substance_meaning"
ORDER BY "occurrences" DESC NULLS LAST;When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-17 20:14:35 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-17 20:14:35 - root - INFO - ```sql
WITH
embedding_medium AS (
  SELECT DISTINCT
    t."SOPInstanceUID",
    sd.seq AS sd_seq,
    sp.seq AS sp_seq,
    c.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "embedding_medium_meaning"
  FROM IDC.IDC_V17.DICOM_ALL t
    CROSS JOIN LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd
    CROSS JOIN LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp
    CROSS JOIN LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c
  WHERE t."Modality" = 'SM'
    AND c.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Embedding medium'
    AND c.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
),
staining_substance AS (
  SELECT DISTINCT
    t."SOPInstanceUID",
    sd.seq AS sd_seq,
    sp.seq AS sp_seq,
    c_us.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING AS "staining_substance_meaning"
  FROM IDC.IDC_V17.DICOM_ALL t
    CROSS JOIN LATERAL FLATTEN(input => t."SpecimenDescriptionSequence") sd
    CROSS JOIN LATERAL FLATTEN(input => sd.value:"SpecimenPreparationSequence") sp
    CROSS JOIN LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c_pt
    CROSS JOIN LATERAL FLATTEN(input => sp.value:"SpecimenPreparationStepContentItemSequence") c_us
  WHERE t."Modality" = 'SM'
    AND c_pt.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Processing type'
    AND c_pt.value:"ConceptCodeSequence"[0]:"CodeMeaning"::STRING = 'Staining'
    AND c_us.value:"ConceptNameCodeSequence"[0]:"CodeMeaning"::STRING = 'Using substance'
    AND c_us.value:"ConceptCodeSequence"[0]:"CodingSchemeDesignator"::STRING = 'SCT'
)
SELECT
  em."embedding_medium_meaning",
  ss."staining_substance_meaning",
  COUNT(DISTINCT em."SOPInstanceUID", em.sd_seq, em.sp_seq) AS "occurrences"
FROM embedding_medium em
JOIN staining_substance ss
  ON em."SOPInstanceUID" = ss."SOPInstanceUID"
     AND em.sd_seq = ss.sd_seq
     AND em.sp_seq = ss.sp_seq
GROUP BY em."embedding_medium_meaning", ss."staining_substance_meaning"
ORDER BY "occurrences" DESC NULLS LAST;
```
2025-01-17 20:14:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-17 20:14:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-17 20:14:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-17 20:14:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 4
2025-01-17 20:14:36 - snowflake.connector.connection - INFO - closed
2025-01-17 20:14:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-17 20:14:36 - root - INFO - itercount: 5
2025-01-17 20:14:36 - root - INFO - 0
2025-01-17 20:14:36 - root - INFO - Total iteration counts: 5
