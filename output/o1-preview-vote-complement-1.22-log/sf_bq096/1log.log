2025-01-25 13:07:59 - openai._base_client - INFO - Retrying request to /chat/completions in 0.399850 seconds
2025-01-25 13:08:34 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 13:08:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 13:08:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 13:08:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 13:08:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 13:08:36 - snowflake.connector.connection - INFO - closed
2025-01-25 13:08:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 13:08:37 - root - INFO - SQL:
SELECT DISTINCT "scientificname"
   FROM GBIF.GBIF.OCCURRENCES
   LIMIT 100;
Results:
scientificname
"Rhyticeros undulatus (Shaw, 1812)"
Euphorbia cyparissias L.
"Dicrurus aeneus Vieillot, 1817"
"Rostrhamus sociabilis (Vieillot, 1817)"
"Leiothlypis ruficapilla (A.Wilson, 1811)"
"Setophaga nigrescens (J.K.Townsend, 1837)"
Luzula pilosa (L.) Willd.
Echinochloa crus-galli (L.) P.Beauv.
Mercurialis perennis L.
Artemisia vulgaris L.
Rumex acetosella L.
"Curruca undata (Boddaert, 1783)"
"Poecile gambeli (Ridgway, 1886)"
"Oriolus sagittatus (Latham, 1802)"
"Quiscalus nicaraguensis Salvin & Godman, 1891"
"Cuculus canorus Linnaeus, 1758"
"Hypothymis azurea (Boddaert, 1783)"
"Trogon personatus Gould, 1842"
"Dicaeum monticolum Sharpe, 1887"
"Stercorarius parasiticus (Linnaeus, 1758)"
Pultenaea juniperina Labill.
Mercurialis L.
Actinocephalus denudatus (Körn.) Sano
Spiraeanthemum katakata Seem.
Hypericum cordifolium Choisy
Erythroxylum columbinum Mart.
Cassia australis Sims
Thermopsis lupinoides (L.) Link
"Jynx torquilla Linnaeus, 1758"
"Poecile hudsonicus (J.R.Forster, 1772)"
"Troglodytes pacificus S.F.Baird, 1864"
"Trogon curucui Linnaeus, 1766"
"Todus subulatus G.R.Gray, 1847"
"Hafferia zeledoni (Pelzeln, 1868)"
"Megalurus palustris Horsfield, 1821"
Pseudorchis albida (L.) Á.Löve & D.Löve
Catharanthus roseus (L.) G.Don
Gyalolechia schistidii Anzi
"Lecanora subfusca var. geographica A.Massal., 1852"
Pimpinella saxifraga L.
Malva alcea L.
Veronica serpyllifolia subsp. serpyllifolia
Aphyllanthes monspeliensis L.
Myosotis ramosissima Rochel
Lysimachia arvensis (L.) U.Manns & Anderb.
"Leptarthrus brevirostris (Meigen, 1804)"
Chionochloa australis (Buchanan) Zotov
Triteleia peduncularis Lindl.
Chamaebatia foliolosa Benth.
"Pekania pennanti (Erxleben, 1777)"
Berberis darwinii Hook.
"Onychostruthus taczanowskii (Prjevalsky, 1876)"
Fuirena simplex Vahl
Inga vera Willd.
Phoradendron falcatum (Cham. & Schltdl.) Trel.
"Dorcatoma dresdensis Herbst, 1792"
"Eopsaltria australis (Shaw, 1790)"
"Pseudo-nitzschia H.Peragallo, 1900"
"Octadecabacter Gosink et al., 1998"
Rickettsiaceae
Herdmania
"Cyclotella (F.T.Kützing) A.de Brébisson, 1838"
Veronica anagallis-aquatica subsp. aquatica Bernh. ex Nyman
Carex paniculata L.
"Bombus bohemicus Seidl, 1838"
Pertusaria flavida (DC.) J.R.Laundon
"Lanius humeralis Stanley, 1814"
"Sayornis phoebe (Latham, 1790)"
"Cardinalis cardinalis (Linnaeus, 1758)"
"Anas platyrhynchos Linnaeus, 1758"
Solidago virgaurea subsp. virgaurea
Solanum dulcamara var. dulcamara
"Nycticorax nycticorax (Linnaeus, 1758)"
"Fringilla montifringilla Linnaeus, 1758"
"Lepidocolaptes souleyetii (Des Murs, 1849)"
"Acrocephalus arundinaceus (Linnaeus, 1758)"
"Cypsiurus balasiensis (J.E.Gray, 1829)"
"Haemulon chrysargyreum Günther, 1859"
"Cantorchilus modestus (Cabanis, 1861)"
"Carterornis leucotis (Gould, 1851)"
Cissampelos ovalifolia DC.
Inga killipiana J.F.Macbr.
Sorbus persica Hedl.
Pedicularis platychila P.C.Tsoong
Agoseris heterophylla var. heterophylla
"Sturnia blythii (Jerdon, 1845)"
"Elanus caeruleus (Desfontaines, 1789)"
"Rallus aquaticus Linnaeus, 1758"
Daedalea quercina (L.) Pers.
"Euodice malabarica (Linnaeus, 1758)"
"Celypha lacunana (Denis & Schiffermüller, 1775)"
Epilobium montanum L.
Vaccinium vitis-idaea L.
Distichophyllum montagneanum (Müll.Hal.) Bosch & Sande Lac.
Ailanthus altissima (Mill.) Swingle
Dactylorhiza majalis subsp. baltica (Klinge) H.Sund.
"Cicindela campestris Linnaeus, 1758"
"Anthidium florentinum (Fabricius, 1775)"
"Balaenoptera acutorostrata Lacépède, 1804"
Symplocarpus foetidus (L.) Salisb. ex W.P.C.Barton

2025-01-25 13:08:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 13:08:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 13:08:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 13:08:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 13:08:39 - snowflake.connector.connection - INFO - closed
2025-01-25 13:08:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 13:08:40 - root - INFO - SQL:
SELECT *
   FROM GBIF.GBIF.OCCURRENCES
   WHERE "scientificname" ILIKE '%Sterna%paradisaea%'
   LIMIT 100;
Results:
Too long, hard cut:
gbifid,datasetkey,occurrenceid,kingdom,phylum,class,order,family,genus,species,infraspecificepithet,taxonrank,scientificname,verbatimscientificname,verbatimscientificnameauthorship,countrycode,locality,stateprovince,occurrencestatus,individualcount,publishingorgkey,decimallatitude,decimallongitude,coordinateuncertaintyinmeters,coordinateprecision,elevation,elevationaccuracy,depth,depthaccuracy,eventdate,day,month,year,taxonkey,specieskey,basisofrecord,institutioncode,collectioncode,catalognumber,recordnumber,identifiedby,dateidentified,license,rightsholder,recordedby,typestatus,establishmentmeans,lastinterpreted,mediatype,issue
3254607827,4fa7b334-ce0d-4e88-aaae-2e0c138d049e,URN:catalog:CLO:EBIRD:OBS965453120,Animalia,Chordata,Aves,Charadriiformes,Laridae,Sterna,Sterna paradisaea,,SPECIES,"Sterna paradisaea Pontoppidan, 1763",Sterna paradisaea,,FI,Kemiönsaari--Morgonlandet,Southwest Finland,PRESENT,19.0,e2e717bf-551a-4917-bdc9-4fa0f342c530,59.759808,22.702053,,,,,,,1596844800000000,8,8,2020,5229230,5229230,HUMAN_OBSERVATION,CLO,EBIRD,OBS965453120,,"{
  ""array"": []
}",,CC_BY_4_0,,"{
  ""array"": [
    {
      ""array_element"": ""obsr326479""
    }
  ]
}","{
  ""array"": []
}",,1713347959212000,"{
  ""array"": []
}","{
  ""array"": [
    {
      ""array_element"": ""CONTINENT_DERIVED_FROM_COORDINATES""
    },
    {
      ""array_element"": ""TAXON_MATCH_TAXON_CONCEPT_ID_IGNORED""
    }
  ]
}"
1786922330,4fa7b334-ce0d-4e88-aaae-2e0c138d049e,URN:catalog:CLO:EBIRD:OBS477060788,Animalia,Chordata,Aves,Charadriiformes,Laridae,Sterna,Sterna paradisaea,,SPECIES,"Sterna paradisaea Pontoppidan, 1763",Sterna paradisaea,,US,Bethel (town),Alaska,PRESENT,2.0,e2e717bf-551a-4917-bdc9-4fa0f342c530,60.796295,-161.76471,,,,,,,992044800000000,9,6,2001,5229230,5229230,HUMAN_OBSERVATION,CLO,EBIRD,OBS477060788,,"{
  ""array"": []
}",,CC_BY_4_0,,"{
  ""array"": [
    {
      ""array_element"": ""obsr341611""
    }
  ]
}","{
  ""array"": []
}",,1713343632361000,"{
  ""array"": []
}","{
  ""array"": [
    {
      ""array_element"": ""CONTINENT_DERIVED_FROM_COORDINATES""
    },
    {
      ""array_element"": ""TAXON_MATCH_TAXON_CONCEPT_ID_IGNORED""
    }
  ]
}"
2184694696,4fa7b334-ce0d-4e88-aaae-2e0c138d049e,URN:catalog:CLO:EBIRD:OBS629789246,Animalia,Chordata,Aves,Charadriiformes,Laridae,Sterna,Sterna paradisaea,,SPECIES,"Sterna paradisaea Pontoppidan, 1763",Sterna paradisaea,,US,Gustavus--Forelands Preserve (Salmon River),Alaska,PRESENT,3.0,e2e717bf-551a-4917-bdc9-4fa0f342c530,58.399643,-135.73805,,,,,,,1528329600000000,7,6,2018,5229230,5229230,HUMAN_OBSERVATION,CLO,EBIRD,OBS629789246,,"{
  ""array"": []
}",,CC_BY_4_0,,"{
  ""array"": [
    {
      ""array_element"": ""obsr195342""
    }
  ]
}","{
  ""array"": []
}",,1713343713514000,"{
  ""array"": []
}","{
  ""array"": [
    {
      ""array_element"": ""CONTINENT_DERIVED_FROM_COORDINATES""
    },
    {
      ""array_element"": ""TAXON_MATCH_TAXON_CONCEPT_ID_IGNORED""
    }
  ]
}"
3281236696,4fa7b334-ce0d-4e88-aaae-2e0c138d049e,URN:catalog:CLO:EBIRD:OBS979554286,Animalia,Chordata,Aves,Charadriiformes,Laridae,Sterna,Sterna paradisaea,,SPECIES,"Sterna paradisaea Pontoppidan, 1763",Sterna paradisaea,,GB,At sea - Vlissingen to Fair Isle,Scotland,PRESENT,,e2e717bf-551a-4917-bdc9-4fa0f342c530,58.105972,-1.23438,,,,,,,1433203200000000,2,6,2015,5229230,5229230,HUMAN_OBSERVATION,CLO,EBIRD,OBS979554286,,"{
  ""array"": []
}",,CC_BY_4_0,,"{
  ""array"": [
    {
      ""array_element"": ""obsr1287064""
    }
  ]
}","{
  ""array"": []
}",,1713343941133000,"{
  ""array"": []
}","{
  ""array"": [
    {
      ""array_element"": ""COORDINATE_ROUNDED""
    },
    {
      ""array_element"": ""TAXON_MATCH_TAXON_CONCEPT_ID_IGNORED""
    }
  ]
}"
4767549314,4fa7b334-ce0d-4e88-aaae-2e0c138d049e,URN:catalog:CLO:EBIRD_AK:OBS1759933056,Animalia,Chordata,Aves,Charadriiformes,Laridae,Sterna,Sterna paradisaea,,SPECIES,"Sterna paradisaea Pontoppidan, 1763",Sterna paradisaea,,US,"2230 Woodworth Cir, Anchorage US-AK 61.20626, -149.92576",Alaska,PRESENT,1.0,e2e717bf-551a-4917-bdc9-4fa0f342c530,61.206257,-149.92577,,,,,,,1686700800000000,14,6,2023,5229230,5229230,HUMAN_OBSERVATION,CLO,EBIRD_AK,OBS1759933056,,"{
  ""array"": []
}",,CC_BY_4_0,,"{
  ""array"": [
    {
      ""array_element"": ""obsr769205""
    }
  ]
}","{
  ""array"": []
}",,1713348587604000,"{
  ""array"": []
}","{
  ""array"": [
    {
      ""array_element"": ""CONTINENT_DERIVED_FROM_COORDINATES""
    },
    {
      ""array_element"": ""TAXON_MATCH_TAXON_CONCEPT_ID_IGNORED""
    }
  ]
}"
183926166,4fa7b334-ce0d-4e88-aaae-2e0c138d049e,URN:catalog:CLO:EBIRD:OBS56605403,Animalia,Chordata,Aves,Charadriiformes,Laridae,Sterna,Sterna paradisaea,,SPECIES,"Sterna paradisaea Pontoppidan, 1763",Sterna paradisaea,,CA,Grand Manan Island,New Brunswick,PRESENT,,e2e717bf-551a-4917-bdc9-4fa0f342c530,44.70611,-66.79793,,,,,,,1026518400000000,13,7,2002,5229230,5229230,HUMAN_OBSERVATION,CLO,EBIRD,OBS56605403,,"{
  ""array"": []
}",,CC_BY_4_0,,"{
  ""array"": [
    {

2025-01-25 13:08:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 13:08:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 13:08:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 13:08:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 13:08:41 - snowflake.connector.connection - INFO - closed
2025-01-25 13:08:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 13:08:42 - root - INFO - SQL:
SELECT "decimallatitude", "decimallongitude"
   FROM GBIF.GBIF.OCCURRENCES
   WHERE "scientificname" ILIKE '%Sterna%paradisaea%'
   LIMIT 100;
Results:
decimallatitude,decimallongitude
55.55865,8.07632
56.368,8.12364
55.8497,10.1899
56.9898,10.33241
55.97112,11.29865
56.16564,10.50995
61.069523,-149.81778
64.48643,-165.29314
61.059303,-149.80414
35.186493,-75.630226
63.073174,-146.70227
55.56837,12.56758
55.57358,12.55788
55.43947,8.60136
55.89325,10.68625
56.45795,10.07044
54.180138,-0.27103
56.187126,-2.557411
60.9293,21.1377
56.32563,8.1213
55.17921,9.63165
55.06555,10.20571
55.4991,12.20547
57.01724,9.51018
55.89325,10.68625
55.55738,12.59735
54.83815,9.72687
55.08358,11.76241
55.51172,8.31449
55.56125,12.56235
55.53667,11.14903
55.4991,12.20547
56.65665,10.3548
54.55957,11.96971
55.86878,10.00475
60.534657,-151.21179
54.66914,11.872659
55.07611,10.0746
55.38989,8.39633
55.97604,11.77679
55.34217,8.4499
55.15013,12.01053
54.89708,8.64943
55.4991,12.20547
54.95048,10.57
55.87815,9.87592
55.53667,11.14903
55.92838,12.52696
55.4991,12.20547
55.33633,8.4872
56.1425,10.7113
57.08874,9.75955
55.60453,12.37554
59.02575,-155.62321
55.86878,10.00475
55.1545,12.09852
55.53507,12.21844
54.55957,11.96971
56.15542,9.52037
56.9898,10.33241
55.56112,12.5598
54.90527,10.71689
55.4991,12.20547
55.1545,12.09852
57.02804,9.07891
55.58468,12.53353
54.72742,10.7089
54.81443,11.14974
56.96494,8.92167
70.8582,29.0922
50.916733,0.964449
55.4426,12.84379
51.797443,1.004903
61.07758,-149.8262
61.178192,-150.03679
64.50106,-165.40814
61.207047,-149.91988
55.57587,11.29054
55.51172,8.31449
57.04859,9.08802
55.5173,8.32885
55.53667,11.14903
55.87563,9.9815
54.92139,8.64934
55.92838,12.52696
53.05,4.85
62.455654,-114.39128
61.207047,-149.91988
58.40578,-134.57132
53.89518,8.976577
64.493706,-165.37425
60.47042,-151.13863
65.659924,-16.974619
63.7793,-171.72145
61.507496,-149.57188
38.931427,-74.96223
64.946915,25.449541
78.225571,15.645881
52.1,4.1
53.05,4.85

2025-01-25 13:08:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 13:08:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 13:08:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 13:08:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 13:08:43 - snowflake.connector.connection - INFO - closed
2025-01-25 13:08:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 13:08:44 - root - INFO - SQL:
SELECT "scientificname", "decimallatitude", "decimallongitude"
   FROM GBIF.GBIF.OCCURRENCES
   WHERE "decimallatitude" > 40
   LIMIT 100;
Results:
scientificname,decimallatitude,decimallongitude
Digitalis lutea L.,48.61425,2.5252
Cardamine impatiens L.,45.18776,1.79031
Fumana procumbens (Dunal) Gren. & Godr.,48.43372,2.39163
Umbilicus rupestris (Salisb.) Dandy,45.18776,1.79031
Bunias orientalis L.,48.52368,2.39059
Hypericum humifusum L.,45.18776,1.79031
Spergula arvensis L.,48.43434,2.52682
Urtica dioica L.,45.18776,1.79031
Euphorbia esula L.,48.61363,2.38954
Ribes alpinum L.,45.37351,2.55285
Juncus tenuis Willd.,48.79274,2.25132
Bunium bulbocastanum L.,46.17506,4.49075
Cirsium arvense (L.) Scop.,48.70357,2.38849
Prunus avium (L.) L.,46.17506,4.49075
Anthemis arvensis L.,47.07847,4.25209
Ornithogalum umbellatum L.,46.17136,4.74994
Aira caryophyllea L.,47.07697,4.38387
Fragaria viridis Duchesne ex Weston,46.17136,4.74994
Vulpia myuros (L.) C.C.Gmel.,47.07982,4.12031
Malva moschata L.,46.17329,4.62035
Galega officinalis L.,48.70357,2.38849
Genista pilosa L.,46.08326,4.61769
Sedum dasyphyllum L.,47.24946,4.91728
Juncus squarrosus L.,46.17506,4.49075
Inula conyza DC.,48.7028,2.25261
Parnassia palustris L.,46.26509,4.49321
Erigeron annuus (L.) Desf,46.8069,4.37697
Rubus idaeus L.,45.90658,4.35448
Ligustrum vulgare L.,47.08523,2.93409
Globularia bisnagarica L.,45.99131,4.74421
Rorippa palustris (L.) Besser,47.16985,4.12219
Sonchus asper (L.) Hill,45.99131,4.74421
Senecio vulgaris L.,48.7028,2.25261
Veronica scutellata L.,46.17506,4.49075
Pedicularis palustris L.,46.81513,2.93442
Euphorbia exigua L.,45.99131,4.74421
Polygala vulgaris L.,47.26107,3.99184
Carex hirta L.,45.99131,4.74421
Silybum marianum (L.) Gaertn.,47.08373,2.40686
Stellaria nemorum L.,45.81654,4.35227
Veronica peregrina L.,46.9952,3.0658
Festuca gigantea (L.) Vill.,45.72314,4.60716
Dipsacus fullonum L.,48.7028,2.25261
Campanula persicifolia L.,45.72489,4.47862
Scorzonera laciniata L.,47.42219,0.67848
Danthonia decumbens (L.) DC.,45.72123,4.73569
Bromus sterilis L.,46.90427,3.4598
Oenanthe peucedanifolia Pollich,45.6312,4.73287
Alopecurus geniculatus L.,47.77645,0.39585
Epilobium angustifolium L.,46.17506,4.49075
Geum urbanum L.,46.17669,4.36115
Cirsium palustre (L.) Scop.,46.17506,4.49075
Luzula pilosa (L.) Willd.,46.17669,4.36115
Rosa canina L.,46.08326,4.61769
Artemisia verlotiorum Lamotte,47.9533,0.25312
Cornus mas L.,45.99323,4.61505
Cyperus esculentus L.,46.99505,3.19739
Impatiens noli-tangere L.,45.99499,4.48588
Cytisus scoparius (L.) Link,47.9533,0.25312
Acer pseudoplatanus L.,46.26332,4.62301
Veronica officinalis L.,48.21296,-0.16456
Orchis militaris L.,45.8092,4.86726
Orchis purpurea Huds.,48.12658,-0.02487
Sison amomum L.,45.8092,4.86726
Drosera intermedia Hayne,47.98308,2.26276
Malva neglecta Wallr.,45.81933,4.09473
Onopordum acanthium L.,48.7028,2.25261
Salix purpurea L.,45.81933,4.09473
Rubus vestitus Weihe,46.63192,3.84964
Veronica montana L.,45.81126,4.73852
Mentha longifolia (L.) Huds.,46.98845,4.25001
Cornus mas L.,45.8092,4.86726
Carex tomentosa L.,46.81199,2.14754
Linum trigynum L.,45.807,4.99598
Gaudinia fragilis (L.) P.Beauv.,46.81199,2.14754
Ludwigia palustris (L.) Elliott,45.807,4.99598
Melissa officinalis L.,47.44533,3.06635
Gentianella germanica (Willd.) Börner,45.8092,4.86726
Melissa officinalis L.,47.61353,1.33595
Stellaria holostea L.,46.26332,4.62301
Melittis melissophyllum L.,47.53384,3.59813
Holcus lanatus L.,44.37458,4.44337
Cirsium arvense (L.) Scop.,47.59942,0.53764
Picris hieracioides L.,44.37458,4.44337
Isopyrum thalictroides L.,46.44827,4.23763
Cuscuta epilinum Weihe,45.55404,2.67957
Epilobium parviflorum Schreb.,48.12305,-0.15917
Angelica sylvestris L.,45.46443,2.93602
Athyrium filix-femina (L.) Roth,48.12305,-0.15917
Salix pentandra L.,45.46443,2.93602
Medicago lupulina L.,47.84583,-0.41031
Valerianella carinata Loisel.,45.55404,2.67957
Molinia caerulea (L.) Moench,47.8664,0.39144
Phragmites australis (Cav.) Trin. ex Steud.,45.46428,2.80805
Prospero autumnale (L.) Speta,48.21296,-0.16456
Silene flos-cuculi (L.) Clairv.,45.46443,2.93602
Descurainia sophia (L.) Webb ex Prantl,46.27072,3.9739
Eleocharis palustris (L.) Roem. & Schult.,45.46443,2.93602
Dipsacus pilosus L.,48.61193,2.11825
Potentilla palustris (L.) Scop.,45.46443,2.93602

2025-01-25 13:08:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 13:08:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 13:08:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 13:08:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 13:08:45 - snowflake.connector.connection - INFO - closed
2025-01-25 13:08:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 13:08:46 - root - INFO - SQL:
SELECT "scientificname", "decimallatitude", "decimallongitude"
   FROM GBIF.GBIF.OCCURRENCES
   WHERE "scientificname" ILIKE '%Sterna%paradisaea%'
     AND "decimallatitude" > 40
   LIMIT 100;
Results:
Too long, hard cut:
scientificname,decimallatitude,decimallongitude
"Sterna paradisaea Pontoppidan, 1763",58.753041,5.490216
"Sterna paradisaea Pontoppidan, 1763",59.984469,10.777951
"Sterna paradisaea Pontoppidan, 1763",59.232378,5.183306
"Sterna paradisaea Pontoppidan, 1763",66.855965,13.251076
"Sterna paradisaea Pontoppidan, 1763",59.928935,5.271242
"Sterna paradisaea Pontoppidan, 1763",58.71675,5.520013
"Sterna paradisaea Pontoppidan, 1763",70.071567,30.118338
"Sterna paradisaea Pontoppidan, 1763",62.875532,11.798985
"Sterna paradisaea Pontoppidan, 1763",59.706802,9.82942
"Sterna paradisaea Pontoppidan, 1763",69.659237,18.935965
"Sterna paradisaea Pontoppidan, 1763",59.161171,10.968016
"Sterna paradisaea Pontoppidan, 1763",78.248196,15.488465
"Sterna paradisaea Pontoppidan, 1763",60.6047,-95.2039
"Sterna paradisaea Pontoppidan, 1763",61.207047,-149.91988
"Sterna paradisaea Pontoppidan, 1763",58.957979,5.608146
"Sterna paradisaea Pontoppidan, 1763",63.694725,9.667732
"Sterna paradisaea Pontoppidan, 1763",59.43801,5.090178
"Sterna paradisaea Pontoppidan, 1763",50.21667,-63.75
"Sterna paradisaea Pontoppidan, 1763",58.871464,9.601445
"Sterna paradisaea Pontoppidan, 1763",69.837814,25.073543
"Sterna paradisaea Pontoppidan, 1763",62.02253,12.067716
"Sterna paradisaea Pontoppidan, 1763",62.528552,11.296387
"Sterna paradisaea Pontoppidan, 1763",61.207047,-149.91988
"Sterna paradisaea Pontoppidan, 1763",55.031778,10.240755
"Sterna paradisaea Pontoppidan, 1763",55.47517,11.077726
"Sterna paradisaea Pontoppidan, 1763",56.68566,8.563771
"Sterna paradisaea Pontoppidan, 1763",55.082927,12.247259
"Sterna paradisaea Pontoppidan, 1763",55.314836,9.793953
"Sterna paradisaea Pontoppidan, 1763",55.304824,8.630392
"Sterna paradisaea Pontoppidan, 1763",65.779568,12.115327
"Sterna paradisaea Pontoppidan, 1763",67.522086,12.104475
"Sterna paradisaea Pontoppidan, 1763",69.544144,20.542485
"Sterna paradisaea Pontoppidan, 1763",66.08644,-17.32132
"Sterna paradisaea Pontoppidan, 1763",52.246616,1.622586
"Sterna paradisaea Pontoppidan, 1763",40.21866,-74.518654
"Sterna paradisaea Pontoppidan, 1763",58.766106,23.453644
"Sterna paradisaea Pontoppidan, 1763",55.614989,12.755423
"Sterna paradisaea Pontoppidan, 1763",70.371678,31.092408
"Sterna paradisaea Pontoppidan, 1763",58.67309,5.544294
"Sterna paradisaea Pontoppidan, 1763",78.249788,15.487441
"Sterna paradisaea Pontoppidan, 1763",58.738947,5.572133
"Sterna paradisaea Pontoppidan, 1763",62.494967,9.890514
"Sterna paradisaea Pontoppidan, 1763",66.950512,13.63409
"Sterna paradisaea Pontoppidan, 1763",78.220836,15.640145
"Sterna paradisaea Pontoppidan, 1763",55.153305,11.701773
"Sterna paradisaea Pontoppidan, 1763",55.621419,10.289417
"Sterna paradisaea Pontoppidan, 1763",56.700122,8.538617
"Sterna paradisaea Pontoppidan, 1763",56.877509,8.877148
"Sterna paradisaea Pontoppidan, 1763",55.104831,10.090433
"Sterna paradisaea Pontoppidan, 1763",64.47205,-164.74669
"Sterna paradisaea Pontoppidan, 1763",61.207047,-149.91988
"Sterna paradisaea Pontoppidan, 1763",55.332895,10.981733
"Sterna paradisaea Pontoppidan, 1763",58.719726,5.519689
"Sterna paradisaea Pontoppidan, 1763",58.981322,10.957874
"Sterna paradisaea Pontoppidan, 1763",58.871464,9.601445
"Sterna paradisaea Pontoppidan, 1763",55.62285,-1.632285
"Sterna paradisaea Pontoppidan, 1763",56.01489,-2.850244
"Sterna paradisaea Pontoppidan, 1763",64.14401,-21.942444
"Sterna paradisaea Pontoppidan, 1763",65.58711,-17.155134
"Sterna paradisaea Pontoppidan, 1763",63.358517,8.48554
"Sterna paradisaea Pontoppidan, 1763",63.669654,8.309003
"Sterna paradisaea Pontoppidan, 1763",69.167653,15.755228
"Sterna paradisaea Pontoppidan, 1763",70.28751,31.023417
"Sterna paradisaea Pontoppidan, 1763",68.760325,17.149872
"Sterna paradisaea Pontoppidan, 1763",66.36365,12.336905
"Sterna paradisaea Pontoppidan, 1763",62.839792,6.865321
"Sterna paradisaea Pontoppidan, 1763",77.772918,13.747979
"Sterna paradisaea Pontoppidan, 1763",68.584146,15.001973
"Sterna paradisaea Pontoppidan, 1763",59.924996,11.108675
"Sterna paradisaea Pontoppidan, 1763",63.439392,10.47362
"Sterna paradisaea Pontoppidan, 1763",58.98789,9.751428
"Sterna paradisaea Pontoppidan, 1763",78.249788,15.487441
"Sterna paradisaea Pontoppidan, 1763",53.946495,-1.031556
"Sterna paradisaea Pontoppidan, 1763",50.911278,0.967672
"Sterna paradisaea Pontoppidan, 1763",55.179322,8.484491
"Sterna paradisaea Pontoppidan, 1763",61.305373,10.646464
"Sterna paradisaea Pontoppidan, 1763",58.97397,9.823437
"Sterna paradisaea Pontoppidan, 1763",55.591511,12.765596
"Sterna paradisaea Pontoppidan, 1763",45.412643,-75.7171
"Sterna paradisaea Pontoppidan, 1763",53.13782,-1.439129
"Sterna paradisaea Pontoppidan, 1763",64.56435,-165.51158
"Sterna paradisaea Pontoppidan, 1763",70.1179,-145.84912
"Sterna paradisaea Pontoppidan, 1763",65.12688,-164.73071
"Sterna paradisaea Pontoppidan, 1763",58.40578,-134.57132
"Sterna paradisaea Pontoppidan, 1763",58.938942,11.179835
"Sterna paradisaea Pontoppidan, 1763",64.140892,-21.927833
"Sterna paradi

2025-01-25 13:08:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 13:08:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 13:08:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 13:08:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 13
2025-01-25 13:08:59 - snowflake.connector.connection - INFO - closed
2025-01-25 13:08:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 13:09:00 - root - INFO - SQL:
SELECT DISTINCT "month"
   FROM GBIF.GBIF.OCCURRENCES
   WHERE "scientificname" ILIKE '%Sterna%paradisaea%'
     AND "decimallatitude" > 40
   LIMIT 100;
Results:
month
10.0
9.0
5.0
6.0
4.0
7.0
1.0
""
8.0
12.0
3.0
2.0
11.0

2025-01-25 13:09:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 13:09:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 13:09:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 13:09:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 13:09:02 - snowflake.connector.connection - INFO - closed
2025-01-25 13:09:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 13:09:02 - root - INFO - SQL:
SELECT "year", "month", "day", "decimallatitude"
   FROM GBIF.GBIF.OCCURRENCES
   WHERE "scientificname" ILIKE '%Sterna%paradisaea%'
     AND "decimallatitude" > 40
     AND "month" > 1
   LIMIT 100;
Results:
year,month,day,decimallatitude
2022,5,15,40.21866
2023,6,10,64.47205
2010,6,3,61.207047
1972,7,30,56.01489
2016,8,12,64.14401
2005,9,27,50.911278
2016,5,10,53.13782
2023,6,4,64.56435
2011,6,15,64.49986
2021,5,19,62.138435
2012,6,21,58.75865
2000,7,20,73.7167
2016,6,15,64.47753
2022,6,23,63.83575
2016,8,3,65.50115
1997,9,21,78.22258
2011,6,20,69.700689
2010,6,6,61.452254
1995,6,6,78.246258
2020,6,2,68.781907
2009,8,2,76.996983
2016,9,3,44.62769
2014,5,9,61.207947
2019,7,26,66.03043
2021,5,21,44.3889
2020,4,22,53.60077
2023,6,12,54.597324
2021,5,9,60.481735
2023,5,6,59.64673
1997,8,3,65.85676
2017,6,19,43.889465
2018,6,27,67.063614
2024,7,9,63.569424
2014,5,29,58.871464
2021,7,26,69.019119
2017,6,25,46.905247
2002,5,7,60.535664
2010,7,25,63.434098
2003,6,14,60.293881
2013,5,25,63.340035
2016,7,2,66.841283
2020,5,10,61.207947
2021,5,11,59.535618
1994,8,6,44.501766
2022,6,14,58.416595
2022,7,2,52.17372
2021,4,24,54.96708
2015,6,26,78.43044
2017,6,15,61.071533
2023,8,9,44.60776
2012,8,23,50.18333
2004,8,11,49.95164
2021,5,16,56.43345
2018,8,9,58.486443
2012,6,26,43.861885
2009,7,2,58.67309
2013,6,4,63.401171
2018,7,19,65.8732
2011,9,7,58.871464
2016,5,29,62.674183
2016,5,5,43.52977
1987,5,23,56.19642
2010,5,31,64.49128
2006,5,31,55.591511
2016,6,19,61.05592
2018,5,4,52.513714
2014,7,12,78.225792
2010,6,3,60.539713
1990,5,20,63.476138
2012,9,7,68.377377
2022,6,29,59.177658
2022,6,22,69.413138
2024,6,29,62.565903
2014,7,10,79.680858
2010,6,7,78.249788
2012,6,29,68.685637
2016,5,28,65.0329
2021,6,14,55.011545
2022,6,24,43.868073
2017,5,29,70.153597
2017,5,16,61.117943
2011,7,31,68.800301
2023,5,19,59.437407
2018,5,31,59.416362
2011,10,20,62.559003
2000,6,17,62.497315
2018,5,26,51.65
2006,5,31,54.919148
2006,6,8,55.926554
1979,6,19,44.501766
2015,9,6,46.905247
1986,8,6,56.61352
2021,6,23,69.69044
2022,6,17,64.04509
2023,5,22,64.769264
2008,6,11,58.69846
2023,5,15,55.189204
2023,5,27,55.067506
2018,5,22,57.4813
2019,8,3,46.8833

2025-01-25 13:09:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 13:09:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 13:09:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 13:09:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 13:09:12 - snowflake.connector.connection - INFO - closed
2025-01-25 13:09:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 13:09:13 - root - INFO - SQL:
SELECT "year", "month", "day", COUNT("gbifid") AS "daily_sightings"
   FROM GBIF.GBIF.OCCURRENCES
   WHERE "scientificname" ILIKE '%Sterna%paradisaea%'
     AND "decimallatitude" > 40
     AND "month" > 1
   GROUP BY "year", "month", "day"
   ORDER BY "year", "month", "day"
   LIMIT 100;
Results:
year,month,day,daily_sightings
1773,7,5.0,1
1827,7,5.0,1
1837,7,15.0,1
1838,7,25.0,1
1843,7,6.0,1
1843,7,12.0,2
1850,5,29.0,1
1851,5,20.0,1
1855,6,20.0,1
1856,5,24.0,1
1857,5,25.0,1
1857,9,,1
1858,7,22.0,1
1860,7,28.0,1
1861,5,3.0,1
1861,6,26.0,1
1861,7,24.0,1
1861,7,30.0,1
1862,10,20.0,1
1863,7,30.0,1
1864,6,,1
1865,6,23.0,1
1865,7,22.0,1
1867,6,6.0,1
1867,6,7.0,1
1868,5,16.0,2
1868,5,25.0,1
1868,6,16.0,1
1868,7,1.0,5
1868,7,13.0,1
1868,7,21.0,1
1869,5,,1
1870,2,,1
1870,6,12.0,1
1870,6,,1
1870,7,1.0,1
1870,7,17.0,1
1871,6,13.0,1
1871,6,14.0,3
1871,6,22.0,2
1871,6,24.0,1
1871,6,28.0,1
1871,10,7.0,1
1872,6,3.0,1
1872,6,4.0,1
1872,6,10.0,2
1872,7,2.0,2
1872,7,24.0,1
1872,8,7.0,1
1873,7,10.0,1
1874,6,14.0,1
1874,7,7.0,1
1874,8,6.0,1
1874,10,10.0,1
1875,6,6.0,4
1875,6,30.0,1
1875,7,20.0,8
1875,7,22.0,1
1875,7,23.0,1
1875,7,24.0,1
1876,6,10.0,1
1876,7,10.0,1
1876,7,27.0,2
1876,8,2.0,1
1876,8,5.0,2
1876,9,18.0,1
1877,5,20.0,1
1877,6,27.0,1
1877,7,28.0,1
1878,6,10.0,1
1878,7,1.0,1
1878,7,8.0,1
1879,6,14.0,1
1879,6,18.0,3
1879,6,,2
1879,7,16.0,2
1879,7,17.0,2
1879,7,23.0,1
1879,7,27.0,2
1880,6,13.0,1
1880,6,17.0,1
1880,6,18.0,1
1880,6,20.0,1
1881,5,1.0,1
1881,5,23.0,3
1881,6,12.0,1
1881,6,14.0,1
1881,6,20.0,1
1881,6,26.0,4
1882,5,20.0,1
1882,5,28.0,1
1882,6,6.0,1
1882,6,18.0,1
1882,6,20.0,2
1882,6,27.0,1
1882,6,28.0,1
1882,7,16.0,1
1882,7,18.0,1
1882,9,9.0,1
1883,6,15.0,1

2025-01-25 13:09:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 13:09:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 13:09:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 13:09:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 13:09:32 - snowflake.connector.connection - INFO - closed
2025-01-25 13:09:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 13:09:32 - root - INFO - SQL:
SELECT "year", "month", "day", COUNT("gbifid") AS "sightings_count"
   FROM GBIF.GBIF.OCCURRENCES
   WHERE "scientificname" ILIKE '%Sterna%paradisaea%'
     AND "decimallatitude" > 40
     AND "month" > 1
   GROUP BY "year", "month", "day"
   HAVING COUNT("gbifid") > 10
   ORDER BY "year", "month", "day"
   LIMIT 100;
Results:
year,month,day,sightings_count
1894,5,23.0,14
1910,6,30.0,13
1913,7,13.0,28
1916,5,29.0,18
1925,6,5.0,31
1932,6,25.0,15
1938,7,12.0,12
1939,7,2.0,21
1948,7,,16
1950,7,1.0,14
1951,5,30.0,17
1956,6,9.0,14
1960,6,15.0,19
1960,6,28.0,24
1960,7,2.0,12
1962,6,2.0,21
1962,6,10.0,15
1962,6,13.0,21
1962,6,17.0,15
1962,6,21.0,14
1962,6,22.0,24
1962,6,27.0,12
1962,6,29.0,35
1963,6,29.0,18
1963,6,30.0,24
1964,7,22.0,12
1965,6,21.0,14
1965,7,27.0,11
1966,5,19.0,12
1966,6,20.0,17
1966,6,21.0,21
1966,6,25.0,29
1966,6,30.0,23
1966,7,18.0,11
1966,7,21.0,12
1966,7,22.0,11
1966,7,31.0,11
1966,8,9.0,18
1967,5,13.0,18
1967,5,14.0,13
1967,6,17.0,11
1967,6,25.0,29
1967,7,1.0,15
1967,7,8.0,12
1967,7,13.0,11
1967,7,15.0,14
1967,7,29.0,11
1967,7,30.0,13
1967,8,19.0,13
1968,6,29.0,19
1968,7,1.0,12
1968,7,2.0,11
1968,7,3.0,22
1968,7,4.0,52
1968,7,6.0,23
1968,7,7.0,17
1968,7,23.0,14
1968,7,24.0,19
1968,7,25.0,29
1968,7,26.0,34
1968,7,27.0,48
1968,7,28.0,31
1968,7,29.0,35
1968,7,30.0,37
1968,7,31.0,11
1968,8,2.0,16
1968,8,3.0,37
1969,5,15.0,12
1969,5,31.0,11
1969,6,17.0,11
1969,6,24.0,26
1969,6,29.0,36
1969,7,5.0,11
1969,7,6.0,23
1969,7,7.0,11
1969,7,10.0,13
1969,7,12.0,16
1969,7,19.0,12
1969,7,20.0,11
1969,7,23.0,12
1970,5,7.0,16
1970,5,10.0,14
1970,6,22.0,17
1970,6,27.0,13
1970,6,28.0,11
1970,7,1.0,33
1970,7,3.0,21
1970,7,4.0,12
1970,7,5.0,28
1970,7,9.0,20
1970,7,12.0,16
1970,7,13.0,29
1970,7,17.0,13
1970,7,19.0,13
1970,7,20.0,13
1970,7,23.0,13
1970,7,25.0,18
1970,7,26.0,16
1970,7,30.0,14
1970,8,15.0,11

2025-01-25 13:09:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 13:09:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 13:09:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 13:09:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 76
2025-01-25 13:09:44 - snowflake.connector.connection - INFO - closed
2025-01-25 13:09:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 13:09:45 - root - INFO - SQL:
SELECT "year", MIN(DATE_FROM_PARTS("year", "month", "day")) AS "first_high_sightings_date"
    FROM (
      SELECT "year", "month", "day", COUNT("gbifid") AS "sightings_count"
      FROM GBIF.GBIF.OCCURRENCES
      WHERE "scientificname" ILIKE '%Sterna%paradisaea%'
        AND "decimallatitude" > 40
        AND "month" > 1
      GROUP BY "year", "month", "day"
      HAVING COUNT("gbifid") > 10
    ) AS sub
    GROUP BY "year"
    ORDER BY "first_high_sightings_date"
    LIMIT 100;
Results:
year,first_high_sightings_date
1894,1894-05-23
1910,1910-06-30
1913,1913-07-13
1916,1916-05-29
1925,1925-06-05
1932,1932-06-25
1938,1938-07-12
1939,1939-07-02
1950,1950-07-01
1951,1951-05-30
1956,1956-06-09
1960,1960-06-15
1962,1962-06-02
1963,1963-06-29
1964,1964-07-22
1965,1965-06-21
1966,1966-05-19
1967,1967-05-13
1968,1968-06-29
1969,1969-05-15
1970,1970-05-07
1971,1971-05-15
1972,1972-05-06
1973,1973-05-31
1974,1974-05-11
1975,1975-05-04
1976,1976-04-25
1977,1977-05-14
1978,1978-05-01
1979,1979-05-05
1980,1980-05-01
1981,1981-05-03
1982,1982-05-08
1983,1983-04-30
1984,1984-04-20
1985,1985-05-04
1986,1986-04-20
1987,1987-04-24
1988,1988-04-16
1989,1989-04-20
1990,1990-04-15
1991,1991-04-26
1992,1992-04-20
1993,1993-04-18
1994,1994-04-16
1995,1995-04-11
1996,1996-04-20
1997,1997-04-17
1998,1998-04-17
1999,1999-04-16
2000,2000-04-09
2001,2001-04-20
2002,2002-04-17
2003,2003-04-12
2004,2004-04-09
2005,2005-04-07
2006,2006-04-13
2007,2007-04-11
2008,2008-04-13
2009,2009-04-08
2010,2010-04-13
2011,2011-04-09
2012,2012-04-11
2013,2013-04-12
2014,2014-04-10
2015,2015-04-11
2016,2016-04-09
2017,2017-04-09
2018,2018-04-08
2019,2019-04-15
2020,2020-04-06
2021,2021-04-15
2022,2022-04-13
2023,2023-04-03
2024,2024-04-13
1948,

2025-01-25 13:09:45 - root - INFO - itercount: 0
2025-01-25 13:09:45 - root - INFO - Database Name: GBIF
Schema Name: GBIF
DDL describes table information.
,0
table_name,OCCURRENCES
description,
DDL,"create or replace TABLE OCCURRENCES (
	""gbifid"" VARCHAR(16777216),
	""datasetkey"" VARCHAR(16777216),
	""occurrenceid"" VARCHAR(16777216),
	""kingdom"" VARCHAR(16777216),
	""phylum"" VARCHAR(16777216),
	""class"" VARCHAR(16777216),
	""order"" VARCHAR(16777216),
	""family"" VARCHAR(16777216),
	""genus"" VARCHAR(16777216),
	""species"" VARCHAR(16777216),
	""infraspecificepithet"" VARCHAR(16777216),
	""taxonrank"" VARCHAR(16777216),
	""scientificname"" VARCHAR(16777216),
	""verbatimscientificname"" VARCHAR(16777216),
	""verbatimscientificnameauthorship"" VARCHAR(16777216),
	""countrycode"" VARCHAR(16777216),
	""locality"" VARCHAR(16777216),
	""stateprovince"" VARCHAR(16777216),
	""occurrencestatus"" VARCHAR(16777216),
	""individualcount"" NUMBER(38,0),
	""publishingorgkey"" VARCHAR(16777216),
	""decimallatitude"" FLOAT,
	""decimallongitude"" FLOAT,
	""coordinateuncertaintyinmeters"" FLOAT,
	""coordinateprecision"" FLOAT,
	""elevation"" FLOAT,
	""elevationaccuracy"" FLOAT,
	""depth"" FLOAT,
	""depthaccuracy"" FLOAT,
	""eventdate"" NUMBER(38,0),
	""day"" NUMBER(38,0),
	""month"" NUMBER(38,0),
	""year"" NUMBER(38,0),
	""taxonkey"" NUMBER(38,0),
	""specieskey"" NUMBER(38,0),
	""basisofrecord"" VARCHAR(16777216),
	""institutioncode"" VARCHAR(16777216),
	""collectioncode"" VARCHAR(16777216),
	""catalognumber"" VARCHAR(16777216),
	""recordnumber"" VARCHAR(16777216),
	""identifiedby"" VARIANT,
	""dateidentified"" NUMBER(38,0),
	""license"" VARCHAR(16777216),
	""rightsholder"" VARCHAR(16777216),
	""recordedby"" VARIANT,
	""typestatus"" VARIANT,
	""establishmentmeans"" VARCHAR(16777216),
	""lastinterpreted"" NUMBER(38,0),
	""mediatype"" VARIANT,
	""issue"" VARIANT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'GBIF': {'GBIF': ['OCCURRENCES']}}
Begin Exploring Related Columns
To address the task, we first need to identify the relevant columns from the `OCCURRENCES` table and understand how they can be used:

**Relevant Columns and Potential Usage:**

- `"scientificname"`: To filter records for the species *Sterna paradisaea*.
- `"decimallatitude"`: To select sightings north of 40 degrees latitude.
- `"month"`: To filter for months after January (months greater than 1).
- `"day"`: To group sightings by day.
- `"year"`: To group sightings by year.
- `"gbifid"`: Unique identifier for each sighting; used to count occurrences.

**Conditions That May Be Used:**

- `"scientificname"` ILIKE '%Sterna paradisaea%': Ensures we capture all records with the species name, accounting for variations in case or additional text.
- `"decimallatitude"` > 40: Filters sightings to those north of 40 degrees latitude.
- `"month"` > 1: Filters out sightings in January.
- `COUNT("gbifid") > 10`: Identifies days with more than 10 sightings.

---

To gain an understanding of the values in the related columns, here are 10 different SQL queries ranging from simple to complex:

1. **Retrieve distinct scientific names:**

   ```sql
   SELECT DISTINCT "scientificname"
   FROM GBIF.GBIF.OCCURRENCES
   LIMIT 100;
   ```

2. **List sightings of *Sterna paradisaea*:**

   ```sql
   SELECT *
   FROM GBIF.GBIF.OCCURRENCES
   WHERE "scientificname" ILIKE '%Sterna%paradisaea%'
   LIMIT 100;
   ```

3. **Fetch coordinates of *Sterna paradisaea* sightings:**

   ```sql
   SELECT "decimallatitude", "decimallongitude"
   FROM GBIF.GBIF.OCCURRENCES
   WHERE "scientificname" ILIKE '%Sterna%paradisaea%'
   LIMIT 100;
   ```

4. **Find sightings north of 40 degrees latitude:**

   ```sql
   SELECT "scientificname", "decimallatitude", "decimallongitude"
   FROM GBIF.GBIF.OCCURRENCES
   WHERE "decimallatitude" > 40
   LIMIT 100;
   ```

5. **List *Sterna paradisaea* sightings north of 40 degrees latitude:**

   ```sql
   SELECT "scientificname", "decimallatitude", "decimallongitude"
   FROM GBIF.GBIF.OCCURRENCES
   WHERE "scientificname" ILIKE '%Sterna%paradisaea%'
     AND "decimallatitude" > 40
   LIMIT 100;
   ```

6. **Retrieve months of sightings for *Sterna paradisaea* north of 40 degrees latitude:**

   ```sql
   SELECT DISTINCT "month"
   FROM GBIF.GBIF.OCCURRENCES
   WHERE "scientificname" ILIKE '%Sterna%paradisaea%'
     AND "decimallatitude" > 40
   LIMIT 100;
   ```

7. **Get sightings after January for *Sterna paradisaea* north of 40 degrees latitude:**

   ```sql
   SELECT "year", "month", "day", "decimallatitude"
   FROM GBIF.GBIF.OCCURRENCES
   WHERE "scientificname" ILIKE '%Sterna%paradisaea%'
     AND "decimallatitude" > 40
     AND "month" > 1
   LIMIT 100;
   ```

8. **Count daily sightings after January for *Sterna paradisaea* north of 40 degrees latitude:**

   ```sql
   SELECT "year", "month", "day", COUNT("gbifid") AS "daily_sightings"
   FROM GBIF.GBIF.OCCURRENCES
   WHERE "scientificname" ILIKE '%Sterna%paradisaea%'
     AND "decimallatitude" > 40
     AND "month" > 1
   GROUP BY "year", "month", "day"
   ORDER BY "year", "month", "day"
   LIMIT 100;
   ```

9. **Identify days with more than 10 sightings:**

   ```sql
   SELECT "year", "month", "day", COUNT("gbifid") AS "sightings_count"
   FROM GBIF.GBIF.OCCURRENCES
   WHERE "scientificname" ILIKE '%Sterna%paradisaea%'
     AND "decimallatitude" > 40
     AND "month" > 1
   GROUP BY "year", "month", "day"
   HAVING COUNT("gbifid") > 10
   ORDER BY "year", "month", "day"
   LIMIT 100;
   ```

10. **Find the earliest day after January with more than 10 sightings for each year:**

    ```sql
    SELECT "year", MIN(DATE_FROM_PARTS("year", "month", "day")) AS "first_high_sightings_date"
    FROM (
      SELECT "year", "month", "day", COUNT("gbifid") AS "sightings_count"
      FROM GBIF.GBIF.OCCURRENCES
      WHERE "scientificname" ILIKE '%Sterna%paradisaea%'
        AND "decimallatitude" > 40
        AND "month" > 1
      GROUP BY "year", "month", "day"
      HAVING COUNT("gbifid") > 10
    ) AS sub
    GROUP BY "year"
    ORDER BY "first_high_sightings_date"
    LIMIT 100;
    ```

---

These queries progressively explore the data relevant to the task by filtering for the species, geographic location, time frame, and counting occurrences to identify patterns in the sightings data.

- **Query 1**: Identifies all species in the dataset.
- **Query 2**: Retrieves all records related to *Sterna paradisaea*.
- **Query 3**: Fetches geographical coordinates of the species sightings.
- **Query 4**: Finds all sightings north of 40 degrees latitude.
- **Query 5**: Combines species filter with geographic location.
- **Query 6**: Lists months when sightings occurred to check for months after January.
- **Query 7**: Retrieves sightings after January for further analysis.
- **Query 8**: Counts the number of sightings per day.
- **Query 9**: Identifies specific days with more than 10 sightings.
- **Query 10**: Determines the earliest such day for each year.

**Note:** All column names are enclosed in double quotations to comply with Snowflake SQL syntax, and `ILIKE` is used for case-insensitive matching. The use of `%` in the `ILIKE` clause accounts for any additional characters or variations in the species name. Each query is limited to 100 rows using `LIMIT 100` as per the guidelines.Query:
SELECT DISTINCT "scientificname"
   FROM GBIF.GBIF.OCCURRENCES
   LIMIT 100;
Answer:
scientificname
"Rhyticeros undulatus (Shaw, 1812)"
Euphorbia cyparissias L.
"Dicrurus aeneus Vieillot, 1817"
"Rostrhamus sociabilis (Vieillot, 1817)"
"Leiothlypis ruficapilla (A.Wilson, 1811)"
"Setophaga nigrescens (J.K.Townsend, 1837)"
Luzula pilosa (L.) Willd.
Echinochloa crus-galli (L.) P.Beauv.
Mercurialis perennis L.
Artemisia vulgaris L.
Rumex acetosella L.
"Curruca undata (Boddaert, 1783)"
"Poecile gambeli (Ridgway, 1886)"
"Oriolus sagittatus (Latham, 1802)"
"Quiscalus nicaraguensis Salvin & Godman, 1891"
"Cuculus canorus Linnaeus, 1758"
"Hypothymis azurea (Boddaert, 1783)"
"Trogon personatus Gould, 1842"
"Dicaeum monticolum Sharpe, 1887"
"Stercorarius parasiticus (Linnaeus, 1758)"
Pultenaea juniperina Labill.
Mercurialis L.
Actinocephalus denudatus (Körn.) Sano
Spiraeanthemum katakata Seem.
Hypericum cordifolium Choisy
Erythroxylum columbinum Mart.
Cassia australis Sims
Thermopsis lupinoides (L.) Link
"Jynx torquilla Linnaeus, 1758"
"Poecile hudsonicus (J.R.Forster, 1772)"
"Troglodytes pacificus S.F.Baird, 1864"
"Trogon curucui Linnaeus, 1766"
"Todus subulatus G.R.Gray, 1847"
"Hafferia zeledoni (Pelzeln, 1868)"
"Megalurus palustris Horsfield, 1821"
Pseudorchis albida (L.) Á.Löve & D.Löve
Catharanthus roseus (L.) G.Don
Gyalolechia schistidii Anzi
"Lecanora subfusca var. geographica A.Massal., 1852"
Pimpinella saxifraga L.
Malva alcea L.
Veronica serpyllifolia subsp. serpyllifolia
Aphyllanthes monspeliensis L.
Myosotis ramosissima Rochel
Lysimachia arvensis (L.) U.Manns & Anderb.
"Leptarthrus brevirostris (Meigen, 1804)"
Chionochloa australis (Buchanan) Zotov
Triteleia peduncularis Lindl.
Chamaebatia foliolosa Benth.
"Pekania pennanti (Erxleben, 1777)"
Berberis darwinii Hook.
"Onychostruthus taczanowskii (Prjevalsky, 1876)"
Fuirena simplex Vahl
Inga vera Willd.
Phoradendron falcatum (Cham. & Schltdl.) Trel.
"Dorcatoma dresdensis Herbst, 1792"
"Eopsaltria australis (Shaw, 1790)"
"Pseudo-nitzschia H.Peragallo, 1900"
"Octadecabacter Gosink et al., 1998"
Rickettsiaceae
Herdmania
"Cyclotella (F.T.Kützing) A.de Brébisson, 1838"
Veronica anagallis-aquatica subsp. aquatica Bernh. ex Nyman
Carex paniculata L.
"Bombus bohemicus Seidl, 1838"
Pertusaria flavida (DC.) J.R.Laundon
"Lanius humeralis Stanley, 1814"
"Sayornis phoebe (Latham, 1790)"
"Cardinalis cardinalis (Linnaeus, 1758)"
"Anas platyrhynchos Linnaeus, 1758"
Solidago virgaurea subsp. virgaurea
Solanum dulcamara var. dulcamara
"Nycticorax nycticorax (Linnaeus, 1758)"
"Fringilla montifringilla Linnaeus, 1758"
"Lepidocolaptes souleyetii (Des Murs, 1849)"
"Acrocephalus arundinaceus (Linnaeus, 1758)"
"Cypsiurus balasiensis (J.E.Gray, 1829)"
"Haemulon chrysargyreum Günther, 1859"
"Cantorchilus modestus (Cabanis, 1861)"
"Carterornis leucotis (Gould, 1851)"
Cissampelos ovalifolia DC.
Inga killipiana J.F.Macbr.
Sorbus persica Hedl.
Pedicularis platychila P.C.Tsoong
Agoseris heterophylla var. heterophylla
"Sturnia blythii (Jerdon, 1845)"
"Elanus caeruleus (Desfontaines, 1789)"
"Rallus aquaticus Linnaeus, 1758"
Daedalea quercina (L.) Pers.
"Euodice malabarica (Linnaeus, 1758)"
"Celypha lacunana (Denis & Schiffermüller, 1775)"
Epilobium montanum L.
Vaccinium vitis-idaea L.
Distichophyllum montagneanum (Müll.Hal.) Bosch & Sande Lac.
Ailanthus altissima (Mill.) Swingle
Dactylorhiza majalis subsp. baltica (Klinge) H.Sund.
"Cicindela campestris Linnaeus, 1758"
"Anthidium florentinum (Fabricius, 1775)"
"Balaenoptera acutorostrata Lacépède, 1804"
Symplocarpus foetidus (L.) Salisb. ex W.P.C.Barton
Query:
SELECT *
   FROM GBIF.GBIF.OCCURRENCES
   WHERE "scientificname" ILIKE '%Sterna%paradisaea%'
   LIMIT 100;
Answer:
Too long, hard cut:
gbifid,datasetkey,occurrenceid,kingdom,phylum,class,order,family,genus,species,infraspecificepithet,taxonrank,scientificname,verbatimscientificname,verbatimscientificnameauthorship,countrycode,locality,stateprovince,occurrencestatus,individualcount,publishingorgkey,decimallatitude,decimallongitude,coordinateuncertaintyinmeters,coordinateprecision,elevation,elevationaccuracy,depth,depthaccuracy,eventdate,day,month,year,taxonkey,specieskey,basisofrecord,institutioncode,collectioncode,catalognumber,recordnumber,identifiedby,dateidentified,license,rightsholder,recordedby,typestatus,establishmentmeans,lastinterpreted,mediatype,issue
3254607827,4fa7b334-ce0d-4e88-aaae-2e0c138d049e,URN:catalog:CLO:EBIRD:OBS965453120,Animalia,Chordata,Aves,Charadriiformes,Laridae,Sterna,Sterna paradisaea,,SPECIES,"Sterna paradisaea Pontoppidan, 1763",Sterna paradisaea,,FI,Kemiönsaari--Morgonlandet,Southwest Finland,PRESENT,19.0,e2e717bf-551a-4917-bdc9-4fa0f342c530,59.759808,22.702053,,,,,,,1596844800000000,8,8,2020,5229230,5229230,HUMAN_OBSERVATION,CLO,EBIRD,OBS965453120,,"{
  ""array"": []
}",,CC_BY_4_0,,"{
  ""array"": [
    {
      ""array_element"": ""obsr326479""
    }
  ]
}","{
  ""array"": []
}",,1713347959212000,"{
  ""array"": []
}","{
  ""array"": [
    {
      ""array_element"": ""CONTINENT_DERIVED_FROM_COORDINATES""
    },
    {
      ""array_element"": ""TAXON_MATCH_TAXON_CONCEPT_ID_IGNORED""
    }
  ]
}"
1786922330,4fa7b334-ce0d-4e88-aaae-2e0c138d049e,URN:catalog:CLO:EBIRD:OBS477060788,Animalia,Chordata,Aves,Charadriiformes,Laridae,Sterna,Sterna paradisaea,,SPECIES,"Sterna paradisaea Pontoppidan, 1763",Sterna paradisaea,,US,Bethel (town),Alaska,PRESENT,2.0,e2e717bf-551a-4917-bdc9-4fa0f342c530,60.796295,-161.76471,,,,,,,992044800000000,9,6,2001,5229230,5229230,HUMAN_OBSERVATION,CLO,EBIRD,OBS477060788,,"{
  ""array"": []
}",,CC_BY_4_0,,"{
  ""array"": [
    {
      ""array_element"": ""obsr341611""
    }
  ]
}","{
  ""array"": []
}",,1713343632361000,"{
  ""array"": []
}","{
  ""array"": [
    {
      ""array_element"": ""CONTINENT_DERIVED_FROM_COORDINATES""
    },
    {
      ""array_element"": ""TAXON_MATCH_TAXON_CONCEPT_ID_IGNORED""
    }
  ]
}"
2184694696,4fa7b334-ce0d-4e88-aaae-2e0c138d049e,URN:catalog:CLO:EBIRD:OBS629789246,Animalia,Chordata,Aves,Charadriiformes,Laridae,Sterna,Sterna paradisaea,,SPECIES,"Sterna paradisaea Pontoppidan, 1763",Sterna paradisaea,,US,Gustavus--Forelands Preserve (Salmon River),Alaska,PRESENT,3.0,e2e717bf-551a-4917-bdc9-4fa0f342c530,58.399643,-135.73805,,,,,,,1528329600000000,7,6,2018,5229230,5229230,HUMAN_OBSERVATION,CLO,EBIRD,OBS629789246,,"{
  ""array"": []
}",,CC_BY_4_0,,"{
  ""array"": [
    {
      ""array_element"": ""obsr195342""
    }
  ]
}","{
  ""array"": []
}",,1713343713514000,"{
  ""array"": []
}","{
  ""array"": [
    {
      ""array_element"": ""CONTINENT_DERIVED_FROM_COORDINATES""
    },
    {
      ""array_element"": ""TAXON_MATCH_TAXON_CONCEPT_ID_IGNORED""
    }
  ]
}"
3281236696,4fa7b334-ce0d-4e88-aaae-2e0c138d049e,URN:catalog:CLO:EBIRD:OBS979554286,Animalia,Chordata,Aves,Charadriiformes,Laridae,Sterna,Sterna paradisaea,,SPECIES,"Sterna paradisaea Pontoppidan, 1763",Sterna paradisaea,,GB,At sea - Vlissingen to Fair Isle,Scotland,PRESENT,,e2e717bf-551a-4917-bdc9-4fa0f342c530,58.105972,-1.23438,,,,,,,1433203200000000,2,6,2015,5229230,5229230,HUMAN_OBSERVATION,CLO,EBIRD,OBS979554286,,"{
  ""array"": []
}",,CC_BY_4_0,,"{
  ""array"": [
    {
      ""array_element"": ""obsr1287064""
    }
  ]
}","{
  ""array"": []
}",,1713343941133000,"{
  ""array"": []
}","{
  ""array"": [
    {
      ""array_element"": ""COORDINATE_ROUNDED""
    },
    {
      ""array_element"": ""TAXON_MATCH_TAXON_CONCEPT_ID_IGNORED""
    }
  ]
}"
4767549314,4fa7b334-ce0d-4e88-aaae-2e0c138d049e,URN:catalog:CLO:EBIRD_AK:OBS1759933056,Animalia,Chordata,Aves,Charadriiformes,Laridae,Sterna,Sterna paradisaea,,SPECIES,"Sterna paradisaea Pontoppidan, 1763",Sterna paradisaea,,US,"2230 Woodworth Cir, Anchorage US-AK 61.20626, -149.92576",Alaska,PRESENT,1.0,e2e717bf-551a-4917-bdc9-4fa0f342c530,61.206257,-149.92577,,,,,,,1686700800000000,14,6,2023,5229230,5229230,HUMAN_OBSERVATION,CLO,EBIRD_AK,OBS1759933056,,"{
  ""array"": []
}",,CC_BY_4_0,,"{
  ""array"": [
    {
      ""array_element"": ""obsr769205""
    }
  ]
}","{
  ""array"": []
}",,1713348587604000,"{
  ""array"": []
}","{
  ""array"": [
    {
      ""array_element"": ""CONTINENT_DERIVED_FROM_COORDINATES""
    },
    {
      ""array_element"": ""TAXON_MATCH_TAXON_CONCEPT_ID_IGNORED""
    }
  ]
}"
183926166,4fa7b334-ce0d-4e88-aaae-2e0c138d049e,URN:catalog:CLO:EBIRD:OBS56605403,Animalia,Chordata,Aves,Charadriiformes,Laridae,Sterna,Sterna paradisaea,,SPECIES,"Sterna paradisaea Pontoppidan, 1763",Sterna paradisaea,,CA,Grand Manan Island,New Brunswick,PRESENT,,e2e717bf-551a-4917-bdc9-4fa0f342c530,44.70611,-66.79793,,,,,,,1026518400000000,13,7,2002,5229230,5229230,HUMAN_OBSERVATION,CLO,EBIRD,OBS56605403,,"{
  ""array"": []
}",,CC_BY_4_0,,"{
  ""array"": [
    {
Query:
SELECT "decimallatitude", "decimallongitude"
   FROM GBIF.GBIF.OCCURRENCES
   WHERE "scientificname" ILIKE '%Sterna%paradisaea%'
   LIMIT 100;
Answer:
decimallatitude,decimallongitude
55.55865,8.07632
56.368,8.12364
55.8497,10.1899
56.9898,10.33241
55.97112,11.29865
56.16564,10.50995
61.069523,-149.81778
64.48643,-165.29314
61.059303,-149.80414
35.186493,-75.630226
63.073174,-146.70227
55.56837,12.56758
55.57358,12.55788
55.43947,8.60136
55.89325,10.68625
56.45795,10.07044
54.180138,-0.27103
56.187126,-2.557411
60.9293,21.1377
56.32563,8.1213
55.17921,9.63165
55.06555,10.20571
55.4991,12.20547
57.01724,9.51018
55.89325,10.68625
55.55738,12.59735
54.83815,9.72687
55.08358,11.76241
55.51172,8.31449
55.56125,12.56235
55.53667,11.14903
55.4991,12.20547
56.65665,10.3548
54.55957,11.96971
55.86878,10.00475
60.534657,-151.21179
54.66914,11.872659
55.07611,10.0746
55.38989,8.39633
55.97604,11.77679
55.34217,8.4499
55.15013,12.01053
54.89708,8.64943
55.4991,12.20547
54.95048,10.57
55.87815,9.87592
55.53667,11.14903
55.92838,12.52696
55.4991,12.20547
55.33633,8.4872
56.1425,10.7113
57.08874,9.75955
55.60453,12.37554
59.02575,-155.62321
55.86878,10.00475
55.1545,12.09852
55.53507,12.21844
54.55957,11.96971
56.15542,9.52037
56.9898,10.33241
55.56112,12.5598
54.90527,10.71689
55.4991,12.20547
55.1545,12.09852
57.02804,9.07891
55.58468,12.53353
54.72742,10.7089
54.81443,11.14974
56.96494,8.92167
70.8582,29.0922
50.916733,0.964449
55.4426,12.84379
51.797443,1.004903
61.07758,-149.8262
61.178192,-150.03679
64.50106,-165.40814
61.207047,-149.91988
55.57587,11.29054
55.51172,8.31449
57.04859,9.08802
55.5173,8.32885
55.53667,11.14903
55.87563,9.9815
54.92139,8.64934
55.92838,12.52696
53.05,4.85
62.455654,-114.39128
61.207047,-149.91988
58.40578,-134.57132
53.89518,8.976577
64.493706,-165.37425
60.47042,-151.13863
65.659924,-16.974619
63.7793,-171.72145
61.507496,-149.57188
38.931427,-74.96223
64.946915,25.449541
78.225571,15.645881
52.1,4.1
53.05,4.85
Query:
SELECT "scientificname", "decimallatitude", "decimallongitude"
   FROM GBIF.GBIF.OCCURRENCES
   WHERE "decimallatitude" > 40
   LIMIT 100;
Answer:
scientificname,decimallatitude,decimallongitude
Digitalis lutea L.,48.61425,2.5252
Cardamine impatiens L.,45.18776,1.79031
Fumana procumbens (Dunal) Gren. & Godr.,48.43372,2.39163
Umbilicus rupestris (Salisb.) Dandy,45.18776,1.79031
Bunias orientalis L.,48.52368,2.39059
Hypericum humifusum L.,45.18776,1.79031
Spergula arvensis L.,48.43434,2.52682
Urtica dioica L.,45.18776,1.79031
Euphorbia esula L.,48.61363,2.38954
Ribes alpinum L.,45.37351,2.55285
Juncus tenuis Willd.,48.79274,2.25132
Bunium bulbocastanum L.,46.17506,4.49075
Cirsium arvense (L.) Scop.,48.70357,2.38849
Prunus avium (L.) L.,46.17506,4.49075
Anthemis arvensis L.,47.07847,4.25209
Ornithogalum umbellatum L.,46.17136,4.74994
Aira caryophyllea L.,47.07697,4.38387
Fragaria viridis Duchesne ex Weston,46.17136,4.74994
Vulpia myuros (L.) C.C.Gmel.,47.07982,4.12031
Malva moschata L.,46.17329,4.62035
Galega officinalis L.,48.70357,2.38849
Genista pilosa L.,46.08326,4.61769
Sedum dasyphyllum L.,47.24946,4.91728
Juncus squarrosus L.,46.17506,4.49075
Inula conyza DC.,48.7028,2.25261
Parnassia palustris L.,46.26509,4.49321
Erigeron annuus (L.) Desf,46.8069,4.37697
Rubus idaeus L.,45.90658,4.35448
Ligustrum vulgare L.,47.08523,2.93409
Globularia bisnagarica L.,45.99131,4.74421
Rorippa palustris (L.) Besser,47.16985,4.12219
Sonchus asper (L.) Hill,45.99131,4.74421
Senecio vulgaris L.,48.7028,2.25261
Veronica scutellata L.,46.17506,4.49075
Pedicularis palustris L.,46.81513,2.93442
Euphorbia exigua L.,45.99131,4.74421
Polygala vulgaris L.,47.26107,3.99184
Carex hirta L.,45.99131,4.74421
Silybum marianum (L.) Gaertn.,47.08373,2.40686
Stellaria nemorum L.,45.81654,4.35227
Veronica peregrina L.,46.9952,3.0658
Festuca gigantea (L.) Vill.,45.72314,4.60716
Dipsacus fullonum L.,48.7028,2.25261
Campanula persicifolia L.,45.72489,4.47862
Scorzonera laciniata L.,47.42219,0.67848
Danthonia decumbens (L.) DC.,45.72123,4.73569
Bromus sterilis L.,46.90427,3.4598
Oenanthe peucedanifolia Pollich,45.6312,4.73287
Alopecurus geniculatus L.,47.77645,0.39585
Epilobium angustifolium L.,46.17506,4.49075
Geum urbanum L.,46.17669,4.36115
Cirsium palustre (L.) Scop.,46.17506,4.49075
Luzula pilosa (L.) Willd.,46.17669,4.36115
Rosa canina L.,46.08326,4.61769
Artemisia verlotiorum Lamotte,47.9533,0.25312
Cornus mas L.,45.99323,4.61505
Cyperus esculentus L.,46.99505,3.19739
Impatiens noli-tangere L.,45.99499,4.48588
Cytisus scoparius (L.) Link,47.9533,0.25312
Acer pseudoplatanus L.,46.26332,4.62301
Veronica officinalis L.,48.21296,-0.16456
Orchis militaris L.,45.8092,4.86726
Orchis purpurea Huds.,48.12658,-0.02487
Sison amomum L.,45.8092,4.86726
Drosera intermedia Hayne,47.98308,2.26276
Malva neglecta Wallr.,45.81933,4.09473
Onopordum acanthium L.,48.7028,2.25261
Salix purpurea L.,45.81933,4.09473
Rubus vestitus Weihe,46.63192,3.84964
Veronica montana L.,45.81126,4.73852
Mentha longifolia (L.) Huds.,46.98845,4.25001
Cornus mas L.,45.8092,4.86726
Carex tomentosa L.,46.81199,2.14754
Linum trigynum L.,45.807,4.99598
Gaudinia fragilis (L.) P.Beauv.,46.81199,2.14754
Ludwigia palustris (L.) Elliott,45.807,4.99598
Melissa officinalis L.,47.44533,3.06635
Gentianella germanica (Willd.) Börner,45.8092,4.86726
Melissa officinalis L.,47.61353,1.33595
Stellaria holostea L.,46.26332,4.62301
Melittis melissophyllum L.,47.53384,3.59813
Holcus lanatus L.,44.37458,4.44337
Cirsium arvense (L.) Scop.,47.59942,0.53764
Picris hieracioides L.,44.37458,4.44337
Isopyrum thalictroides L.,46.44827,4.23763
Cuscuta epilinum Weihe,45.55404,2.67957
Epilobium parviflorum Schreb.,48.12305,-0.15917
Angelica sylvestris L.,45.46443,2.93602
Athyrium filix-femina (L.) Roth,48.12305,-0.15917
Salix pentandra L.,45.46443,2.93602
Medicago lupulina L.,47.84583,-0.41031
Valerianella carinata Loisel.,45.55404,2.67957
Molinia caerulea (L.) Moench,47.8664,0.39144
Phragmites australis (Cav.) Trin. ex Steud.,45.46428,2.80805
Prospero autumnale (L.) Speta,48.21296,-0.16456
Silene flos-cuculi (L.) Clairv.,45.46443,2.93602
Descurainia sophia (L.) Webb ex Prantl,46.27072,3.9739
Eleocharis palustris (L.) Roem. & Schult.,45.46443,2.93602
Dipsacus pilosus L.,48.61193,2.11825
Potentilla palustris (L.) Scop.,45.46443,2.93602
Query:
SELECT "scientificname", "decimallatitude", "decimallongitude"
   FROM GBIF.GBIF.OCCURRENCES
   WHERE "scientificname" ILIKE '%Sterna%paradisaea%'
     AND "decimallatitude" > 40
   LIMIT 100;
Answer:
Too long, hard cut:
scientificname,decimallatitude,decimallongitude
"Sterna paradisaea Pontoppidan, 1763",58.753041,5.490216
"Sterna paradisaea Pontoppidan, 1763",59.984469,10.777951
"Sterna paradisaea Pontoppidan, 1763",59.232378,5.183306
"Sterna paradisaea Pontoppidan, 1763",66.855965,13.251076
"Sterna paradisaea Pontoppidan, 1763",59.928935,5.271242
"Sterna paradisaea Pontoppidan, 1763",58.71675,5.520013
"Sterna paradisaea Pontoppidan, 1763",70.071567,30.118338
"Sterna paradisaea Pontoppidan, 1763",62.875532,11.798985
"Sterna paradisaea Pontoppidan, 1763",59.706802,9.82942
"Sterna paradisaea Pontoppidan, 1763",69.659237,18.935965
"Sterna paradisaea Pontoppidan, 1763",59.161171,10.968016
"Sterna paradisaea Pontoppidan, 1763",78.248196,15.488465
"Sterna paradisaea Pontoppidan, 1763",60.6047,-95.2039
"Sterna paradisaea Pontoppidan, 1763",61.207047,-149.91988
"Sterna paradisaea Pontoppidan, 1763",58.957979,5.608146
"Sterna paradisaea Pontoppidan, 1763",63.694725,9.667732
"Sterna paradisaea Pontoppidan, 1763",59.43801,5.090178
"Sterna paradisaea Pontoppidan, 1763",50.21667,-63.75
"Sterna paradisaea Pontoppidan, 1763",58.871464,9.601445
"Sterna paradisaea Pontoppidan, 1763",69.837814,25.073543
"Sterna paradisaea Pontoppidan, 1763",62.02253,12.067716
"Sterna paradisaea Pontoppidan, 1763",62.528552,11.296387
"Sterna paradisaea Pontoppidan, 1763",61.207047,-149.91988
"Sterna paradisaea Pontoppidan, 1763",55.031778,10.240755
"Sterna paradisaea Pontoppidan, 1763",55.47517,11.077726
"Sterna paradisaea Pontoppidan, 1763",56.68566,8.563771
"Sterna paradisaea Pontoppidan, 1763",55.082927,12.247259
"Sterna paradisaea Pontoppidan, 1763",55.314836,9.793953
"Sterna paradisaea Pontoppidan, 1763",55.304824,8.630392
"Sterna paradisaea Pontoppidan, 1763",65.779568,12.115327
"Sterna paradisaea Pontoppidan, 1763",67.522086,12.104475
"Sterna paradisaea Pontoppidan, 1763",69.544144,20.542485
"Sterna paradisaea Pontoppidan, 1763",66.08644,-17.32132
"Sterna paradisaea Pontoppidan, 1763",52.246616,1.622586
"Sterna paradisaea Pontoppidan, 1763",40.21866,-74.518654
"Sterna paradisaea Pontoppidan, 1763",58.766106,23.453644
"Sterna paradisaea Pontoppidan, 1763",55.614989,12.755423
"Sterna paradisaea Pontoppidan, 1763",70.371678,31.092408
"Sterna paradisaea Pontoppidan, 1763",58.67309,5.544294
"Sterna paradisaea Pontoppidan, 1763",78.249788,15.487441
"Sterna paradisaea Pontoppidan, 1763",58.738947,5.572133
"Sterna paradisaea Pontoppidan, 1763",62.494967,9.890514
"Sterna paradisaea Pontoppidan, 1763",66.950512,13.63409
"Sterna paradisaea Pontoppidan, 1763",78.220836,15.640145
"Sterna paradisaea Pontoppidan, 1763",55.153305,11.701773
"Sterna paradisaea Pontoppidan, 1763",55.621419,10.289417
"Sterna paradisaea Pontoppidan, 1763",56.700122,8.538617
"Sterna paradisaea Pontoppidan, 1763",56.877509,8.877148
"Sterna paradisaea Pontoppidan, 1763",55.104831,10.090433
"Sterna paradisaea Pontoppidan, 1763",64.47205,-164.74669
"Sterna paradisaea Pontoppidan, 1763",61.207047,-149.91988
"Sterna paradisaea Pontoppidan, 1763",55.332895,10.981733
"Sterna paradisaea Pontoppidan, 1763",58.719726,5.519689
"Sterna paradisaea Pontoppidan, 1763",58.981322,10.957874
"Sterna paradisaea Pontoppidan, 1763",58.871464,9.601445
"Sterna paradisaea Pontoppidan, 1763",55.62285,-1.632285
"Sterna paradisaea Pontoppidan, 1763",56.01489,-2.850244
"Sterna paradisaea Pontoppidan, 1763",64.14401,-21.942444
"Sterna paradisaea Pontoppidan, 1763",65.58711,-17.155134
"Sterna paradisaea Pontoppidan, 1763",63.358517,8.48554
"Sterna paradisaea Pontoppidan, 1763",63.669654,8.309003
"Sterna paradisaea Pontoppidan, 1763",69.167653,15.755228
"Sterna paradisaea Pontoppidan, 1763",70.28751,31.023417
"Sterna paradisaea Pontoppidan, 1763",68.760325,17.149872
"Sterna paradisaea Pontoppidan, 1763",66.36365,12.336905
"Sterna paradisaea Pontoppidan, 1763",62.839792,6.865321
"Sterna paradisaea Pontoppidan, 1763",77.772918,13.747979
"Sterna paradisaea Pontoppidan, 1763",68.584146,15.001973
"Sterna paradisaea Pontoppidan, 1763",59.924996,11.108675
"Sterna paradisaea Pontoppidan, 1763",63.439392,10.47362
"Sterna paradisaea Pontoppidan, 1763",58.98789,9.751428
"Sterna paradisaea Pontoppidan, 1763",78.249788,15.487441
"Sterna paradisaea Pontoppidan, 1763",53.946495,-1.031556
"Sterna paradisaea Pontoppidan, 1763",50.911278,0.967672
"Sterna paradisaea Pontoppidan, 1763",55.179322,8.484491
"Sterna paradisaea Pontoppidan, 1763",61.305373,10.646464
"Sterna paradisaea Pontoppidan, 1763",58.97397,9.823437
"Sterna paradisaea Pontoppidan, 1763",55.591511,12.765596
"Sterna paradisaea Pontoppidan, 1763",45.412643,-75.7171
"Sterna paradisaea Pontoppidan, 1763",53.13782,-1.439129
"Sterna paradisaea Pontoppidan, 1763",64.56435,-165.51158
"Sterna paradisaea Pontoppidan, 1763",70.1179,-145.84912
"Sterna paradisaea Pontoppidan, 1763",65.12688,-164.73071
"Sterna paradisaea Pontoppidan, 1763",58.40578,-134.57132
"Sterna paradisaea Pontoppidan, 1763",58.938942,11.179835
"Sterna paradisaea Pontoppidan, 1763",64.140892,-21.927833
"Sterna paradi
Query:
SELECT DISTINCT "month"
   FROM GBIF.GBIF.OCCURRENCES
   WHERE "scientificname" ILIKE '%Sterna%paradisaea%'
     AND "decimallatitude" > 40
   LIMIT 100;
Answer:
month
10.0
9.0
5.0
6.0
4.0
7.0
1.0
""
8.0
12.0
3.0
2.0
11.0
Query:
SELECT "year", "month", "day", "decimallatitude"
   FROM GBIF.GBIF.OCCURRENCES
   WHERE "scientificname" ILIKE '%Sterna%paradisaea%'
     AND "decimallatitude" > 40
     AND "month" > 1
   LIMIT 100;
Answer:
year,month,day,decimallatitude
2022,5,15,40.21866
2023,6,10,64.47205
2010,6,3,61.207047
1972,7,30,56.01489
2016,8,12,64.14401
2005,9,27,50.911278
2016,5,10,53.13782
2023,6,4,64.56435
2011,6,15,64.49986
2021,5,19,62.138435
2012,6,21,58.75865
2000,7,20,73.7167
2016,6,15,64.47753
2022,6,23,63.83575
2016,8,3,65.50115
1997,9,21,78.22258
2011,6,20,69.700689
2010,6,6,61.452254
1995,6,6,78.246258
2020,6,2,68.781907
2009,8,2,76.996983
2016,9,3,44.62769
2014,5,9,61.207947
2019,7,26,66.03043
2021,5,21,44.3889
2020,4,22,53.60077
2023,6,12,54.597324
2021,5,9,60.481735
2023,5,6,59.64673
1997,8,3,65.85676
2017,6,19,43.889465
2018,6,27,67.063614
2024,7,9,63.569424
2014,5,29,58.871464
2021,7,26,69.019119
2017,6,25,46.905247
2002,5,7,60.535664
2010,7,25,63.434098
2003,6,14,60.293881
2013,5,25,63.340035
2016,7,2,66.841283
2020,5,10,61.207947
2021,5,11,59.535618
1994,8,6,44.501766
2022,6,14,58.416595
2022,7,2,52.17372
2021,4,24,54.96708
2015,6,26,78.43044
2017,6,15,61.071533
2023,8,9,44.60776
2012,8,23,50.18333
2004,8,11,49.95164
2021,5,16,56.43345
2018,8,9,58.486443
2012,6,26,43.861885
2009,7,2,58.67309
2013,6,4,63.401171
2018,7,19,65.8732
2011,9,7,58.871464
2016,5,29,62.674183
2016,5,5,43.52977
1987,5,23,56.19642
2010,5,31,64.49128
2006,5,31,55.591511
2016,6,19,61.05592
2018,5,4,52.513714
2014,7,12,78.225792
2010,6,3,60.539713
1990,5,20,63.476138
2012,9,7,68.377377
2022,6,29,59.177658
2022,6,22,69.413138
2024,6,29,62.565903
2014,7,10,79.680858
2010,6,7,78.249788
2012,6,29,68.685637
2016,5,28,65.0329
2021,6,14,55.011545
2022,6,24,43.868073
2017,5,29,70.153597
2017,5,16,61.117943
2011,7,31,68.800301
2023,5,19,59.437407
2018,5,31,59.416362
2011,10,20,62.559003
2000,6,17,62.497315
2018,5,26,51.65
2006,5,31,54.919148
2006,6,8,55.926554
1979,6,19,44.501766
2015,9,6,46.905247
1986,8,6,56.61352
2021,6,23,69.69044
2022,6,17,64.04509
2023,5,22,64.769264
2008,6,11,58.69846
2023,5,15,55.189204
2023,5,27,55.067506
2018,5,22,57.4813
2019,8,3,46.8833
Query:
SELECT "year", "month", "day", COUNT("gbifid") AS "daily_sightings"
   FROM GBIF.GBIF.OCCURRENCES
   WHERE "scientificname" ILIKE '%Sterna%paradisaea%'
     AND "decimallatitude" > 40
     AND "month" > 1
   GROUP BY "year", "month", "day"
   ORDER BY "year", "month", "day"
   LIMIT 100;
Answer:
year,month,day,daily_sightings
1773,7,5.0,1
1827,7,5.0,1
1837,7,15.0,1
1838,7,25.0,1
1843,7,6.0,1
1843,7,12.0,2
1850,5,29.0,1
1851,5,20.0,1
1855,6,20.0,1
1856,5,24.0,1
1857,5,25.0,1
1857,9,,1
1858,7,22.0,1
1860,7,28.0,1
1861,5,3.0,1
1861,6,26.0,1
1861,7,24.0,1
1861,7,30.0,1
1862,10,20.0,1
1863,7,30.0,1
1864,6,,1
1865,6,23.0,1
1865,7,22.0,1
1867,6,6.0,1
1867,6,7.0,1
1868,5,16.0,2
1868,5,25.0,1
1868,6,16.0,1
1868,7,1.0,5
1868,7,13.0,1
1868,7,21.0,1
1869,5,,1
1870,2,,1
1870,6,12.0,1
1870,6,,1
1870,7,1.0,1
1870,7,17.0,1
1871,6,13.0,1
1871,6,14.0,3
1871,6,22.0,2
1871,6,24.0,1
1871,6,28.0,1
1871,10,7.0,1
1872,6,3.0,1
1872,6,4.0,1
1872,6,10.0,2
1872,7,2.0,2
1872,7,24.0,1
1872,8,7.0,1
1873,7,10.0,1
1874,6,14.0,1
1874,7,7.0,1
1874,8,6.0,1
1874,10,10.0,1
1875,6,6.0,4
1875,6,30.0,1
1875,7,20.0,8
1875,7,22.0,1
1875,7,23.0,1
1875,7,24.0,1
1876,6,10.0,1
1876,7,10.0,1
1876,7,27.0,2
1876,8,2.0,1
1876,8,5.0,2
1876,9,18.0,1
1877,5,20.0,1
1877,6,27.0,1
1877,7,28.0,1
1878,6,10.0,1
1878,7,1.0,1
1878,7,8.0,1
1879,6,14.0,1
1879,6,18.0,3
1879,6,,2
1879,7,16.0,2
1879,7,17.0,2
1879,7,23.0,1
1879,7,27.0,2
1880,6,13.0,1
1880,6,17.0,1
1880,6,18.0,1
1880,6,20.0,1
1881,5,1.0,1
1881,5,23.0,3
1881,6,12.0,1
1881,6,14.0,1
1881,6,20.0,1
1881,6,26.0,4
1882,5,20.0,1
1882,5,28.0,1
1882,6,6.0,1
1882,6,18.0,1
1882,6,20.0,2
1882,6,27.0,1
1882,6,28.0,1
1882,7,16.0,1
1882,7,18.0,1
1882,9,9.0,1
1883,6,15.0,1
Query:
SELECT "year", "month", "day", COUNT("gbifid") AS "sightings_count"
   FROM GBIF.GBIF.OCCURRENCES
   WHERE "scientificname" ILIKE '%Sterna%paradisaea%'
     AND "decimallatitude" > 40
     AND "month" > 1
   GROUP BY "year", "month", "day"
   HAVING COUNT("gbifid") > 10
   ORDER BY "year", "month", "day"
   LIMIT 100;
Answer:
year,month,day,sightings_count
1894,5,23.0,14
1910,6,30.0,13
1913,7,13.0,28
1916,5,29.0,18
1925,6,5.0,31
1932,6,25.0,15
1938,7,12.0,12
1939,7,2.0,21
1948,7,,16
1950,7,1.0,14
1951,5,30.0,17
1956,6,9.0,14
1960,6,15.0,19
1960,6,28.0,24
1960,7,2.0,12
1962,6,2.0,21
1962,6,10.0,15
1962,6,13.0,21
1962,6,17.0,15
1962,6,21.0,14
1962,6,22.0,24
1962,6,27.0,12
1962,6,29.0,35
1963,6,29.0,18
1963,6,30.0,24
1964,7,22.0,12
1965,6,21.0,14
1965,7,27.0,11
1966,5,19.0,12
1966,6,20.0,17
1966,6,21.0,21
1966,6,25.0,29
1966,6,30.0,23
1966,7,18.0,11
1966,7,21.0,12
1966,7,22.0,11
1966,7,31.0,11
1966,8,9.0,18
1967,5,13.0,18
1967,5,14.0,13
1967,6,17.0,11
1967,6,25.0,29
1967,7,1.0,15
1967,7,8.0,12
1967,7,13.0,11
1967,7,15.0,14
1967,7,29.0,11
1967,7,30.0,13
1967,8,19.0,13
1968,6,29.0,19
1968,7,1.0,12
1968,7,2.0,11
1968,7,3.0,22
1968,7,4.0,52
1968,7,6.0,23
1968,7,7.0,17
1968,7,23.0,14
1968,7,24.0,19
1968,7,25.0,29
1968,7,26.0,34
1968,7,27.0,48
1968,7,28.0,31
1968,7,29.0,35
1968,7,30.0,37
1968,7,31.0,11
1968,8,2.0,16
1968,8,3.0,37
1969,5,15.0,12
1969,5,31.0,11
1969,6,17.0,11
1969,6,24.0,26
1969,6,29.0,36
1969,7,5.0,11
1969,7,6.0,23
1969,7,7.0,11
1969,7,10.0,13
1969,7,12.0,16
1969,7,19.0,12
1969,7,20.0,11
1969,7,23.0,12
1970,5,7.0,16
1970,5,10.0,14
1970,6,22.0,17
1970,6,27.0,13
1970,6,28.0,11
1970,7,1.0,33
1970,7,3.0,21
1970,7,4.0,12
1970,7,5.0,28
1970,7,9.0,20
1970,7,12.0,16
1970,7,13.0,29
1970,7,17.0,13
1970,7,19.0,13
1970,7,20.0,13
1970,7,23.0,13
1970,7,25.0,18
1970,7,26.0,16
1970,7,30.0,14
1970,8,15.0,11
Query:
SELECT "year", MIN(DATE_FROM_PARTS("year", "month", "day")) AS "first_high_sightings_date"
    FROM (
      SELECT "year", "month", "day", COUNT("gbifid") AS "sightings_count"
      FROM GBIF.GBIF.OCCURRENCES
      WHERE "scientificname" ILIKE '%Sterna%paradisaea%'
        AND "decimallatitude" > 40
        AND "month" > 1
      GROUP BY "year", "month", "day"
      HAVING COUNT("gbifid") > 10
    ) AS sub
    GROUP BY "year"
    ORDER BY "first_high_sightings_date"
    LIMIT 100;
Answer:
year,first_high_sightings_date
1894,1894-05-23
1910,1910-06-30
1913,1913-07-13
1916,1916-05-29
1925,1925-06-05
1932,1932-06-25
1938,1938-07-12
1939,1939-07-02
1950,1950-07-01
1951,1951-05-30
1956,1956-06-09
1960,1960-06-15
1962,1962-06-02
1963,1963-06-29
1964,1964-07-22
1965,1965-06-21
1966,1966-05-19
1967,1967-05-13
1968,1968-06-29
1969,1969-05-15
1970,1970-05-07
1971,1971-05-15
1972,1972-05-06
1973,1973-05-31
1974,1974-05-11
1975,1975-05-04
1976,1976-04-25
1977,1977-05-14
1978,1978-05-01
1979,1979-05-05
1980,1980-05-01
1981,1981-05-03
1982,1982-05-08
1983,1983-04-30
1984,1984-04-20
1985,1985-05-04
1986,1986-04-20
1987,1987-04-24
1988,1988-04-16
1989,1989-04-20
1990,1990-04-15
1991,1991-04-26
1992,1992-04-20
1993,1993-04-18
1994,1994-04-16
1995,1995-04-11
1996,1996-04-20
1997,1997-04-17
1998,1998-04-17
1999,1999-04-16
2000,2000-04-09
2001,2001-04-20
2002,2002-04-17
2003,2003-04-12
2004,2004-04-09
2005,2005-04-07
2006,2006-04-13
2007,2007-04-11
2008,2008-04-13
2009,2009-04-08
2010,2010-04-13
2011,2011-04-09
2012,2012-04-11
2013,2013-04-12
2014,2014-04-10
2015,2015-04-11
2016,2016-04-09
2017,2017-04-09
2018,2018-04-08
2019,2019-04-15
2020,2020-04-06
2021,2021-04-15
2022,2022-04-13
2023,2023-04-03
2024,2024-04-13
1948,
End Exploring Related Columns
Task: Which year had the first day after January with more than 10 sightings of Sterna paradisaea north of 40 degrees latitude?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To determine which year had the first day after January with more than 10 sightings of *Sterna paradisaea* north of 40 degrees latitude, we need to analyze the `OCCURRENCES` table from the `GBIF` database. The steps involved are:

1. **Filter the Data**: Select records where:
   - `scientificname` is `'Sterna paradisaea'`.
   - `decimallatitude` > 40.
   - `month` > 1 (months after January).

2. **Aggregate Sightings**: Group the filtered data by `year`, `month`, and `day`, and count the number of sightings per day.

3. **Identify Dates with More Than 10 Sightings**: From the aggregated data, find the earliest date for each year after January where the count exceeds 10.

4. **Determine the Year with the Earliest Date**: Compare these dates across years to find which year had the earliest such day.

Since the actual data is not provided, the answer format is as follows:

```csv
Year
year:int
(Attention: answer in one row)
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'GBIF': {'GBIF': ['OCCURRENCES']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-25 13:10:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 13:10:05 - root - INFO - ```sql
WITH daily_counts AS (
    SELECT "year", "month", "day", COUNT("gbifid") AS "sightings_count"
    FROM GBIF.GBIF.OCCURRENCES
    WHERE "scientificname" ILIKE '%Sterna paradisaea%'
      AND "decimallatitude" > 40
      AND "month" > 1
    GROUP BY "year", "month", "day"
    HAVING COUNT("gbifid") > 10
),
yearly_first_dates AS (
    SELECT "year", MIN(DATE_FROM_PARTS("year", "month", "day")) AS "first_high_sightings_date"
    FROM daily_counts
    GROUP BY "year"
)
SELECT "year"
FROM yearly_first_dates
ORDER BY "first_high_sightings_date"
LIMIT 1;
```
2025-01-25 13:10:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 13:10:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 13:10:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 13:10:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 13:10:13 - snowflake.connector.connection - INFO - closed
2025-01-25 13:10:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 13:10:13 - root - INFO - itercount: 1
2025-01-25 13:10:13 - root - INFO - 0
2025-01-25 13:10:13 - root - INFO - results: 
year
1894


2025-01-25 13:10:13 - root - INFO - Please check the answer again by reviewing Which year had the first day after January with more than 10 sightings of Sterna paradisaea north of 40 degrees latitude?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To determine which year had the first day after January with more than 10 sightings of *Sterna paradisaea* north of 40 degrees latitude, we need to analyze the `OCCURRENCES` table from the `GBIF` database. The steps involved are:

1. **Filter the Data**: Select records where:
   - `scientificname` is `'Sterna paradisaea'`.
   - `decimallatitude` > 40.
   - `month` > 1 (months after January).

2. **Aggregate Sightings**: Group the filtered data by `year`, `month`, and `day`, and count the number of sightings per day.

3. **Identify Dates with More Than 10 Sightings**: From the aggregated data, find the earliest date for each year after January where the count exceeds 10.

4. **Determine the Year with the Earliest Date**: Compare these dates across years to find which year had the earliest such day.

Since the actual data is not provided, the answer format is as follows:

```csv
Year
year:int
(Attention: answer in one row)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
year
1894
Current sql:
WITH daily_counts AS (
    SELECT "year", "month", "day", COUNT("gbifid") AS "sightings_count"
    FROM GBIF.GBIF.OCCURRENCES
    WHERE "scientificname" ILIKE '%Sterna paradisaea%'
      AND "decimallatitude" > 40
      AND "month" > 1
    GROUP BY "year", "month", "day"
    HAVING COUNT("gbifid") > 10
),
yearly_first_dates AS (
    SELECT "year", MIN(DATE_FROM_PARTS("year", "month", "day")) AS "first_high_sightings_date"
    FROM daily_counts
    GROUP BY "year"
)
SELECT "year"
FROM yearly_first_dates
ORDER BY "first_high_sightings_date"
LIMIT 1;
2025-01-25 13:10:45 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 13:10:45 - root - INFO - ```sql
WITH daily_counts AS (
    SELECT "year", "month", "day", COUNT("gbifid") AS "sightings_count"
    FROM GBIF.GBIF.OCCURRENCES
    WHERE "species" = 'Sterna paradisaea'
      AND "decimallatitude" > 40
      AND "month" > 1
    GROUP BY "year", "month", "day"
    HAVING COUNT("gbifid") > 10
),
yearly_first_dates AS (
    SELECT "year", MIN(DATE_FROM_PARTS("year", "month", "day")) AS "first_high_sightings_date"
    FROM daily_counts
    GROUP BY "year"
)
SELECT "year"
FROM yearly_first_dates
ORDER BY "first_high_sightings_date"
LIMIT 1;
```
2025-01-25 13:10:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 13:10:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 13:10:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 13:10:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-25 13:10:54 - snowflake.connector.connection - INFO - closed
2025-01-25 13:10:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 13:10:54 - root - INFO - itercount: 2
2025-01-25 13:10:54 - root - INFO - 0
2025-01-25 13:10:54 - root - INFO - Total iteration counts: 2
