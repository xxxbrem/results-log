2025-01-23 17:12:18 - openai._base_client - INFO - Retrying request to /chat/completions in 0.390292 seconds
2025-01-23 17:13:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 17:13:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:13:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:13:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:13:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:13:11 - snowflake.connector.connection - INFO - closed
2025-01-23 17:13:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:13:11 - root - INFO - SQL:
SELECT "user_pseudo_id", "user_first_touch_timestamp"
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
   LIMIT 100;
Results:
Too long, hard cut:
user_pseudo_id,user_first_touch_timestamp
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1

2025-01-23 17:13:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:13:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:13:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:13:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 32
2025-01-23 17:13:13 - snowflake.connector.connection - INFO - closed
2025-01-23 17:13:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:13:13 - root - INFO - SQL:
SELECT DISTINCT "event_name"
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
   LIMIT 100;
Results:
event_name
level_complete_quickplay
session_start
screen_view
level_fail_quickplay
level_end_quickplay
post_score
level_start_quickplay
user_engagement
level_up
level_complete
select_content
level_fail
level_end
level_start
level_retry
completed_5_levels
no_more_extra_steps
level_retry_quickplay
level_reset
level_reset_quickplay
app_exception
os_update
app_remove
app_clear_data
app_update
firebase_campaign
error
ad_reward
use_extra_steps
spend_virtual_currency
challenge_a_friend
first_open

2025-01-23 17:13:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:13:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:13:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:13:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 32
2025-01-23 17:13:14 - snowflake.connector.connection - INFO - closed
2025-01-23 17:13:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:13:15 - root - INFO - SQL:
SELECT "event_name", COUNT(*) AS "event_count"
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
   GROUP BY "event_name"
   LIMIT 100;
Results:
event_name,event_count
level_complete_quickplay,1896
session_start,621
screen_view,20378
level_fail_quickplay,1173
level_end_quickplay,3068
post_score,2144
level_start_quickplay,4493
user_engagement,11605
level_up,248
level_complete,229
select_content,942
level_fail,148
level_end,396
level_start,560
level_retry,357
completed_5_levels,11
no_more_extra_steps,22
level_retry_quickplay,387
level_reset,72
level_reset_quickplay,916
app_exception,54
os_update,19
app_remove,13
app_clear_data,1
app_update,8
firebase_campaign,38
error,15
ad_reward,18
use_extra_steps,55
spend_virtual_currency,85
challenge_a_friend,1
first_open,27

2025-01-23 17:13:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:13:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:13:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:13:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-23 17:13:16 - snowflake.connector.connection - INFO - closed
2025-01-23 17:13:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:13:16 - root - INFO - SQL:
SELECT "platform", COUNT(DISTINCT "user_pseudo_id") AS "user_count"
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
   GROUP BY "platform"
   LIMIT 100;
Results:
platform,user_count
ANDROID,282
IOS,169

2025-01-23 17:13:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:13:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:13:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:13:18 - snowflake.connector.connection - INFO - closed
2025-01-23 17:13:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:13:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 17:13:40 - root - INFO - The error you're encountering is due to case sensitivity in column names when using the `FLATTEN` function in Snowflake. In Snowflake SQL:

- Unquoted identifiers (like `VALUE`) are automatically converted to uppercase.
- Quoted identifiers (like `"value"`) are case-sensitive and remain exactly as typed.

In your query, you referenced `f."value"`, which looks for a column named `value` in lowercase. However, the `FLATTEN` function returns columns in uppercase by default (`KEY`, `VALUE`, `INDEX`, `PATH`, etc.).

To fix the error, you should reference the `VALUE` column in uppercase without quotes, or with quotes as `"VALUE"`.

**Corrected SQL Query:**

```sql
SELECT f.VALUE
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 AS t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 100;
```

**Or using quotes with uppercase:**

```sql
SELECT f."VALUE"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 AS t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 100;
```

**Explanation:**

- **Use `f.VALUE`**: Since unquoted identifiers are treated as uppercase, `VALUE` matches the column name returned by `FLATTEN`.
- **Alternatively, use `f."VALUE"`**: Quoting the identifier preserves the case, so `"VALUE"` matches the uppercase column name.

**Additional Information:**

- The `FLATTEN` function expands the `VARIANT` or `OBJECT` column (`event_params` in this case) into a set of rows.
- The columns produced by `FLATTEN` include:
  - `KEY`: The key of the element.
  - `VALUE`: The value of the element.
  - `INDEX`: The index of the element (if the input is an array).
  - `PATH`: The path to the element.
  - `THIS`: The original input.

**Example Usage:**

If you want to see both the keys and values from the `event_params`, you can modify the query:

```sql
SELECT f.KEY, f.VALUE
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 AS t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 100;
```

This will give you the keys and corresponding values from the `event_params` column for further analysis.
2025-01-23 17:13:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:13:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:13:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:13:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:13:41 - snowflake.connector.connection - INFO - closed
2025-01-23 17:13:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:14:36 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 17:14:36 - root - INFO - SQL:
SELECT f.VALUE
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 AS t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 100;
Results:
Too long, hard cut:
VALUE
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8126232848982224228
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8126232848982224228
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490845
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FloodItActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490838
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490838
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""FloodItActivity""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""ExtraStepsActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490799
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490799
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""shop_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490798
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""ExtraStepsActivity""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490798
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""shop_menu""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""GameFinishedActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490785
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490785
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_over""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"

2025-01-23 17:14:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:14:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:14:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:14:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-23 17:14:38 - snowflake.connector.connection - INFO - closed
2025-01-23 17:14:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:15:26 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 17:15:26 - root - INFO - ```sql
SELECT DISTINCT "user_pseudo_id"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
LIMIT 100;
```

**Explanation:**

Since the previous query returned no data, it's likely that the condition on `"user_first_touch_timestamp"` didn't match any records due to mismatched timestamp formats or units. To simplify and ensure we retrieve data, I've removed the condition and focused on selecting distinct users from the events on July 2, 2018.

This query will fetch up to 100 unique users (`"user_pseudo_id"`) who had any event on July 2, 2018. This simplification allows us to proceed with the retention analysis by identifying users active on that date without imposing conditions that may exclude all records.
2025-01-23 17:15:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:15:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:15:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:15:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:15:28 - snowflake.connector.connection - INFO - closed
2025-01-23 17:15:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:17:23 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 17:17:23 - root - INFO - SQL:
SELECT DISTINCT "user_pseudo_id"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
LIMIT 100;
Results:
user_pseudo_id
654F30C1312F6C1A26DFDA9F076A62D8
65D7715C409E6A38667447CE2B52AFFE
B205B117C82A24AA95E663FFB7D04718
EF9E8CCCCBBB015CAE0C334AB1745417
83D8C7F90DAF2C832F05A9DDD8693135
093642BD46204EB5F950303CE696BC18
0F67E233B19D2898229CD156974A93AE
5217AB1A454DAED6243E1C9818BE6A20
C6EAD483A8AF7EE9B0ADE6D7CE5DD698
58230465C695B0FDDDAE08A481FAEECC
38D4084307B6D1CEA37A48981753428E
0373DF7959F6867CDFB1C905D39CE67C
D34924C19421D7E083FD387D97765F94
C136A7CE1D0A52B8D4E5F144DF114EB7
4BF98D09CA8359FC59ADAF56D00338F8
08D399C66188D9A356AFAD5E2B2BA45E
49309C5759610DBF6C829C0D4AB23943
909A16079F7183140ACF4C71A6CCDF3D
3031EAD1E9D35306A37A0F3DC3B84A0A
3A58859E074B02E8FB1CAEA291636112
706C748E6D1E0768BFEFE6362B5D3F67
F815B0069F973BFA743EF90A85224109
D0F280B12652EB0D74F6BC74AB13606F
3EF8FC940E379D53BBD3FEFDAF626BB2
E6FEE8B98E75EA5311FE004F98559A27
50FEAE9ECFE22E951E8810622A2E8F66
4A47422A455E62E3529DE4F9F3BFAF66
4948BEDE78FC6EBA9899F26BF5C53897
88A41BFED275BB69125BE1F5524F3B42
A064A84CD3CF7058F39333D6212E8615
A87A30159D909E2356F72AAC76F26707
7AE4084BAA29B1987E51BF2964646805
5CDFC86835249BE3DB5E9F6778E344AD
7842C62D45ECE888132F21C9F4417B21
7101B4232F5B26A9C987C54F8717DCDC
29845B6298FB882DF53607D21F0E1DF7
76BB576278338D2E508DE5D705241B47
7207044281C74501C14233463AAD9A71
4BDC831A6940071E2461D0B5293A329E
A74EFE8BDAC26101B308D57A18B746CF
037DAC225F0C1E54657770CD201CDDA7
936906C2CB90CE437DBFC01BBD96BA39
D7EA8E3645EFFBD6443946179ED704A6
53866E32BA0ABFD846772D4B7B9B5921
257A35EA0A92B4B2F8FB4BA3F8B4C3D8
11A8D6037368A4C4508B11ADB4353BC4
C87CDC0C4F86B10B7467281D516929B5
028CAE01A9F16A228177C973451441A1
4CE503AE5B4C4F67A00474CE380CCC39
2304B486B11E4CFFA0BB8AC8F2F5F4B6
CE7404D5A8831F2DE46BD0A013A8ED64
60CFF65B640769B6FD3BC9593EDF7C1D
EBFE0623EF1109A89B392B9DF4375951
664F913ED3B54941B5F0886D94E01623
5D5895B1267014C54ECBE08864420979
92B0B6F48ECE132C7E502F94798FE205
05407E04B9FA64CB63D8FA1D966AD6A2
4D084D38156128AAA060303AA91E689D
E2D6E7FE36B7CDD0789CC8F03CC747E0
2F5B044B41268F6643EB4D0EF15D4E87
E8710E77072D6674A93E46DFEF725587
672B24B51143CC66DCBAA0FA88C38D57
2F8E2DBB938D2E43C2D171AF5F35EEF8
DE4912FBC5F915C027000A8A6FF44F85
48AB910A8DE8485D4C34238EA61F782C
92BF054A90804B6D65F11D7CDFCDDEFC
3DEB0C12C49AD19D7ACE68FA59E7ACD6
B7701369F8598A25DED0499DAD3BE85D
64BA3BB3BD757CE7000D38CB7125E6DA
E50F7AC0680FD87AD6CE6B6700D209A7
7D613AF4DA0F508C7090E96FD73B7E6D
C795AFA7F574C2BB09D3647AD90A9719
FEDC59699D8832A11B88BFCCCAD0951D
59454BAC415BB1F18517C6FD2C023E49
E451D416F972019604F1456533FF3858
AFE7A3E11C66E71FA9EA7B138700EC44
B75F91EB6C7FDA9A329567E763CF9E44
D739D483CCD20D4651E4A75ADEE94064
7480AE90D76538F44A066A153F448198
8EDB9A9856CDB5AFC42546106EE46734
3EDE8E7A50DE76AA2EC12DDD2AE3F9F4
CA04708DA02378999ECB402481FF1AE4
3D03A380687FE3369E93915D50C572CB
EA9A16D9042286D55399A418CC7A28F3
117AD1627465CC9E03AB5D8825D42E07
01562149DD13E75D732F0A9CA2D8CF5C
8320FC247A1967E7C0CDFC1502241310
5E694DE02688C2FDDEA38A6946A4CC3F
60FAC27D8495BF33C2AE5283A7B07005
4DA8863CD8D2C860F6BB73579BC6F5C9
97E7144B7FA861C3C8DB7424D7039832
DD695F4DCB9694F4E026B78E17BD7945
8040FC9C0479C3B9A74ED298DD8F357D
920DB84FCC0F4421650B9E257E33180B
AE920B86560554C0BE3F888EDBA2BBF7
27859DA5E38F4C681DA4FBF0CFB9F306
84D135997D8A4D9CB35D4ECA46EF6861
2F5BBABE9DD0271DCD62E501F76DA736
D3F06F9B7BD9D7FC8758BF78BF0705E9
2B1A8699D5D9CC85A21E5AD20A5F1278

2025-01-23 17:17:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:17:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:17:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:17:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7
2025-01-23 17:17:25 - snowflake.connector.connection - INFO - closed
2025-01-23 17:17:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:17:25 - root - INFO - SQL:
SELECT "event_date", COUNT(*) AS "event_count"
FROM (
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180703
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180704
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180705
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180706
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180707
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180708
) AS t
GROUP BY "event_date"
LIMIT 100
Results:
event_date,event_count
20180702,50000
20180703,50000
20180704,50000
20180705,50000
20180706,50000
20180707,50000
20180708,50000

2025-01-23 17:17:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:17:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:17:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:17:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:17:27 - snowflake.connector.connection - INFO - closed
2025-01-23 17:17:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:17:27 - root - INFO - SQL:
SELECT DISTINCT "user_pseudo_id"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180709
LIMIT 100
Results:
user_pseudo_id
AE9C7A5E358F2E0E0E90E4B8DD67AE76
6E018CE86D4601A362A9154B2500348A
23183C7A7E31451194345099C978F49E
3B7AC9CAE2D7BB661BE66F3DE36DD005
9D535D543FD07B8247DEADB4669FADE6
22DC6A6AE86C0AA33EBB8C3164A26925
EF9E8CCCCBBB015CAE0C334AB1745417
85FD06F19EBB6097388EEE0B207598B7
295D9E24D8DE65A010313E667131EF19
9603F4B5ABFC1E48B0BF68C83669F845
5217AB1A454DAED6243E1C9818BE6A20
5256B2B115955E80DDB7449775D92325
E0F91AA200D6F12DBE53B0D166AFD87B
2F0F260BD7B876C346B41977D0D03D62
DB9F0F2561524A9EE1436805AAD70675
E2B530ADD7430BEA6BC7F3D431C8A6FF
71746D859E4E6D655FEE8FFBC3B6C7E9
980DEC5BA17132A841D7D7A140333114
C6B7ED4E2FA4AABE5693A61B9A07753C
77F5E9A5630151C9E831156AEAB4DA11
49309C5759610DBF6C829C0D4AB23943
9F3EAF490630617EF2CB47A8BD2CBBCC
4BF98D09CA8359FC59ADAF56D00338F8
D7D49CC32C4A23AD56E8DEAE6878EC7B
4500595CA1FC3CBC6140A502240FB7B4
1F25763EC8BCAEC7FB069E81659A2153
706C748E6D1E0768BFEFE6362B5D3F67
F815B0069F973BFA743EF90A85224109
05F7B2C58D627CE948B06C10E39CDF91
3EF8FC940E379D53BBD3FEFDAF626BB2
E6FEE8B98E75EA5311FE004F98559A27
AB32482D193E2CE166B59F82EF78D8BB
B56E67847E1AE8D6411A5ECCA26585CA
29845B6298FB882DF53607D21F0E1DF7
9B27F8491DC5DA23D369F31250BD8D65
17515C32D8E535AA8A1B18BA774BB90C
85A84EA2A3017D368F41519312C6D3A2
037DAC225F0C1E54657770CD201CDDA7
4BDC831A6940071E2461D0B5293A329E
84AFEFA3875BA1F17232CB41D06B6EF4
6B9CFFB3E0DE6FA0C47B8410C4467F89
59BE43F3FE7AB3F91B016B56508D4C46
FFFE80A7B9667187D501CE6037876955
A65FAEAB5577A16B517735A9D9C54958
84F5D9204EDAE98B3B542AEA93F40BED
D7EA8E3645EFFBD6443946179ED704A6
F19B8122771D0514F440E914B722656A
8BE7BF90C971453A34C1FF6FF2A0ACAE
AB6FCC6558326ADC858DE37C8D9EB7CD
EBFE0623EF1109A89B392B9DF4375951
CA04708DA02378999ECB402481FF1AE4
EF9C32CA65880162136061B25D24E05E
F26EC6056E284FDDEA7771F203B6BB8F
945DE7C965AFB12E35C3C992CF9847E2
0160043392B1572A375E5C3BE1BB0C31
C136A7CE1D0A52B8D4E5F144DF114EB7
5F824D23AE3CF750894A96098818E789
5C5A0787542CD24F1E19F9EB778BA766
60603343AB8FEECD78B1009C957D193D
23A7E8D987ADCC38EB026096DC513F85
B4394AD77C6DE7A5C7385C307F35F84F
D0F280B12652EB0D74F6BC74AB13606F
48AB910A8DE8485D4C34238EA61F782C
EAFD6F2604C8351032764E5F8B4D389E
75C683C1AE98FC6CCE6EA156C9E90A35
88A41BFED275BB69125BE1F5524F3B42
8D31836A6C3C14CE71056BED8925F0A4
D5F9D9AF22EF5073E10342973D48FB2C
7566596A1D6ACA781692A7A0B89B06EF
A05ACB383D79E187B98B95E9C749C416
693EB525C74694F2E6990CA738F5E5D5
7F2B633C86B765201C93FDB6FF261143
331C58F19DE71B2DE30DDC47ECE5CCA6
B275DC380CF75B352381D5419E397047
7537C0AA6291AC7B99DC4D2D695EEF1D
9038CCC5F7D7ABDA6E296D18FFDD1AAA
6DC90DD09DF860E7C60C00BF36906CB3
7D613AF4DA0F508C7090E96FD73B7E6D
FEC117631F54C2699CB76603EBB98CF0
C795AFA7F574C2BB09D3647AD90A9719
FEDC59699D8832A11B88BFCCCAD0951D
017CF202552235BBA4338E0D82A53F43
B75F91EB6C7FDA9A329567E763CF9E44
8EDB9A9856CDB5AFC42546106EE46734
0B99B2EC1247C09535717331F816D42D
E4196C5E0A92A22F69DE4E3AA288D6EE
2F5BBABE9DD0271DCD62E501F76DA736
10522BF919A454B898540F51FFDCB292
0373DF7959F6867CDFB1C905D39CE67C
3827BA312204EA6F6847DFA4222C90CC
4D084D38156128AAA060303AA91E689D
0E05F56141200FF41FCC0C7FA297FF08
2F5B044B41268F6643EB4D0EF15D4E87
8E6F7A428C907165D78A2377ABEB7315
A29EBFE2A58D7C4D6FDA23C3A53742FF
60ACC539CFC3DB94C60921D5572C3A4D
4CFD4E167957842AFC9C7A6A5FF78827
1B2FC37816CC4DDAACA97A75E685756F
59454BAC415BB1F18517C6FD2C023E49
7480AE90D76538F44A066A153F448198

2025-01-23 17:17:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:17:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:17:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:17:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:17:29 - snowflake.connector.connection - INFO - closed
2025-01-23 17:17:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:17:29 - root - INFO - SQL:
SELECT f."KEY", f."VALUE"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 AS t,
LATERAL FLATTEN(input => t."user_properties") f
LIMIT 100
Results:
Too long, hard cut:
KEY,VALUE
,"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482378805491000,
    ""string_value"": ""2""
  }
}"
,"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1477369230231000,
    ""string_value"": ""3""
  }
}"
,"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1476908488411000,
    ""string_value"": ""true""
  }
}"
,"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1530589570174000,
    ""string_value"": ""30""
  }
}"
,"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1494813899942000,
    ""string_value"": ""4857993083614758445""
  }
}"
,"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1530589572284000,
    ""string_value"": ""1""
  }
}"
,"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1476917467314000,
    ""string_value"": ""true""
  }
}"
,"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1530589572283000,
    ""string_value"": ""0""
  }
}"
,"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1476908354977000,
    ""set_timestamp_micros"": 1476908266977000
  }
}"
,"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482378833491000,
    ""string_value"": ""2""
  }
}"
,"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1477369258231000,
    ""string_value"": ""3""
  }
}"
,"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1476908516411000,
    ""string_value"": ""true""
  }
}"
,"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1530592265519000,
    ""string_value"": ""30""
  }
}"
,"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1494813927942000,
    ""string_value"": ""4857993083614758445""
  }
}"
,"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1530589600284000,
    ""string_value"": ""1""
  }
}"
,"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1476917495314000,
    ""string_value"": ""true""
  }
}"
,"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1530589600283000,
    ""string_value"": ""0""
  }
}"
,"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1476908354977000,
    ""set_timestamp_micros"": 1476908294977000
  }
}"
,"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482378862491000,
    ""string_value"": ""2""
  }
}"
,"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1477369287231000,
    ""string_value"": ""3""
  }
}"
,"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1476908545411000,
    ""string_value"": ""true""
  }
}"
,"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1530592294519000,
    ""string_value"": ""30""
  }
}"
,"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1494813956942000,
    ""string_value"": ""4857993083614758445""
  }
}"
,"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1530589629284000,
    ""string_value"": ""1""
  }
}"
,"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1476917524314000,
    ""string_value"": ""true""
  }
}"
,"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1530589629283000,
    ""string_value"": ""0""
  }
}"
,"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1476908354977000,
    ""set_timestamp_micros"": 1476908323977000
  }
}"
,"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482378809491000,
    ""string_value"": ""2""
  }
}"
,"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1477369234231000,
    ""string_value"": ""3""
  }
}"
,"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1476908492411000,
    ""string_value"": ""true""
  }
}"
,"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1530589574174000,
    ""string_value"": ""30""
  }
}"
,"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1494813903942000,
    ""string_value"": ""4857993083614758445""
  }
}"
,"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1530589576284000,
    ""string_value"": ""1""
  }
}"
,"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1476917471314000,
    ""string_value"": ""true""
  }
}"
,"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1530589576283000,
    ""string_value"": ""0""
  }
}"
,"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1476908354977000,
    ""set_timestamp_

2025-01-23 17:17:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:17:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:17:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:17:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:17:31 - snowflake.connector.connection - INFO - closed
2025-01-23 17:17:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:17:31 - root - INFO - SQL:
SELECT "user_pseudo_id", "event_name"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180716
LIMIT 100
Results:
user_pseudo_id,event_name
64BB7DFAE772A77F70FB63373D0808F5,screen_view
64BB7DFAE772A77F70FB63373D0808F5,screen_view
64BB7DFAE772A77F70FB63373D0808F5,user_engagement
9D535D543FD07B8247DEADB4669FADE6,ad_reward
9D535D543FD07B8247DEADB4669FADE6,use_extra_steps
9D535D543FD07B8247DEADB4669FADE6,spend_virtual_currency
9D535D543FD07B8247DEADB4669FADE6,no_more_extra_steps
9D535D543FD07B8247DEADB4669FADE6,use_extra_steps
9D535D543FD07B8247DEADB4669FADE6,spend_virtual_currency
9D535D543FD07B8247DEADB4669FADE6,ad_reward
9D535D543FD07B8247DEADB4669FADE6,use_extra_steps
9D535D543FD07B8247DEADB4669FADE6,spend_virtual_currency
9D535D543FD07B8247DEADB4669FADE6,post_score
9D535D543FD07B8247DEADB4669FADE6,post_score
9D535D543FD07B8247DEADB4669FADE6,level_up
9D535D543FD07B8247DEADB4669FADE6,level_up
9D535D543FD07B8247DEADB4669FADE6,level_start
9D535D543FD07B8247DEADB4669FADE6,level_end
9D535D543FD07B8247DEADB4669FADE6,level_retry
9D535D543FD07B8247DEADB4669FADE6,level_start
9D535D543FD07B8247DEADB4669FADE6,level_end
9D535D543FD07B8247DEADB4669FADE6,level_retry
9D535D543FD07B8247DEADB4669FADE6,level_complete
9D535D543FD07B8247DEADB4669FADE6,level_complete
9D535D543FD07B8247DEADB4669FADE6,session_start
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,select_content
9D535D543FD07B8247DEADB4669FADE6,select_content
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,app_exception
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail

2025-01-23 17:17:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:17:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:17:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:17:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-23 17:17:35 - snowflake.connector.connection - INFO - closed
2025-01-23 17:17:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:17:35 - root - INFO - SQL:
SELECT "platform", COUNT(DISTINCT "user_pseudo_id") AS "user_count"
FROM (
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180703
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180704
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180705
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180706
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180707
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180708
) AS t
GROUP BY "platform"
LIMIT 100
Results:
platform,user_count
ANDROID,1028
IOS,602

2025-01-23 17:17:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:17:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:17:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:17:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-23 17:17:37 - snowflake.connector.connection - INFO - closed
2025-01-23 17:17:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:17:37 - root - INFO - SQL:
SELECT "event_name", COUNT(*) AS "event_count"
FROM (
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180703
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180704
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180705
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180706
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180707
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180708
) AS t
GROUP BY "event_name"
ORDER BY "event_count" DESC
LIMIT 5
Results:
event_name,event_count
screen_view,142638
user_engagement,81342
level_start_quickplay,31311
level_end_quickplay,21742
post_score,15470

2025-01-23 17:17:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:17:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:17:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:17:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:17:39 - snowflake.connector.connection - INFO - closed
2025-01-23 17:17:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:17:39 - root - INFO - SQL:
SELECT DISTINCT "user_pseudo_id", "event_date"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180723
LIMIT 100
Results:
user_pseudo_id,event_date
F2D0B7E8667E4855BEFD39ECA3185BF7,20180723
E6850F5E0DAB3E339C6A36BDEECCA26F,20180723
3B7AC9CAE2D7BB661BE66F3DE36DD005,20180723
023A2DB99CC3F70A4B71869C36952D74,20180723
8C648AA8E1BED4F1A904777CD622F4FF,20180723
FC55032FC8C06EB1A1220D1ABD1164C9,20180723
E069FDF17198500FCB6DDDF406ABA122,20180723
85FD06F19EBB6097388EEE0B207598B7,20180723
9BC94B3773C8304A9E101AEBCFEF4A5F,20180723
5217AB1A454DAED6243E1C9818BE6A20,20180723
5256B2B115955E80DDB7449775D92325,20180723
D11624EBD7C1693F9C3B4803A8D71DBA,20180723
71746D859E4E6D655FEE8FFBC3B6C7E9,20180723
772DA2BB33B435F5694AB02D10141E14,20180723
3604E77825369AD5C4101DA2644554A2,20180723
37DDB3680762B550822DDB952BF5F8C2,20180723
C18D4F7D4769C88197DFD443B97DAB8E,20180723
4CDB160C7A0483695AE6DB265C4E038F,20180723
945DE7C965AFB12E35C3C992CF9847E2,20180723
B9D8DF9BE543DEFAEDC13BF8903A859A,20180723
5A329C088FCD2F024968581AB06AABBB,20180723
77F5E9A5630151C9E831156AEAB4DA11,20180723
54EEE6C24B723126E17219F5C0F6DE12,20180723
9F81BD3E1662363A62176934DD8D50A9,20180723
BA08BDEC281666CB07A3F709BFB029EF,20180723
48D0C822ACA6BD0B5FBA8ECD27CBB247,20180723
D6CE2614AB26B05B94FC3840D08E91F0,20180723
8D478A447317FB83662A7CC605FCF39A,20180723
E6FEE8B98E75EA5311FE004F98559A27,20180723
6CD2676098B3E076AD66D10BF4565BFA,20180723
37A3C46088E501AB87767546AA7AF421,20180723
B56E67847E1AE8D6411A5ECCA26585CA,20180723
2F48607C41ECC4015FA296500F0A2C4B,20180723
BEB1E4B878112A53985AA6A0A2D30F16,20180723
3DEB0C12C49AD19D7ACE68FA59E7ACD6,20180723
42B0EA9C46944FD3177C30038D4970B3,20180723
CE3E59F2C2C3BD7F1C8FB80D53CF0F3B,20180723
920DB84FCC0F4421650B9E257E33180B,20180723
9AB38AB2AE2B6B15B572DE3AEFB04363,20180723
3DC1C89C927D2FC9D264FBC21E401E5B,20180723
2FC7AA16D54B177F0A2911FEA105A0B3,20180723
59454BAC415BB1F18517C6FD2C023E49,20180723
8E1749E5A26DD54E346476A289854E93,20180723
475B281839C403CCF826D0D44890BFA5,20180723
B79F414B574CB7F894FE7236A1465837,20180723
8EDB9A9856CDB5AFC42546106EE46734,20180723
FFA9AE78B23263835F8AAED57713EBE9,20180723
D1CC3A8740095F70116D613EC471A21D,20180723
4CE503AE5B4C4F67A00474CE380CCC39,20180723
C64FDEA4F0B0743BCF6CEDB45FEE8AB7,20180723
4A0A237C8AB244CE7449AF812EA5E641,20180723
EBFE0623EF1109A89B392B9DF4375951,20180723
37F354B57F5815ED7F977B4EB58C17EF,20180723
0A8B3658EFEEE8A30763ED36A4152C4B,20180723
476409D7DFD0B2B2B0AB11E5F6D7DDBE,20180723
FC2DDF0F37BB211D565307010B1B30A1,20180723
C6B7ED4E2FA4AABE5693A61B9A07753C,20180723
91FFEA4997DB9E39A944F4B23B6A3B24,20180723
1A3C9B890548F1BCE865FC5422E08672,20180723
38774821C3A944A0D1CEA88CFCAFB405,20180723
08B7AEC83DA53E917D595FE60C2CB600,20180723
906490EA8F6D8BBA578F7CC150DF731D,20180723
B4653EE7AA5AB38E47F66AAE2F708BD9,20180723
706C748E6D1E0768BFEFE6362B5D3F67,20180723
CF66FE17C9FF87481F56A40F25B9BB88,20180723
48AB910A8DE8485D4C34238EA61F782C,20180723
ECDB424F7CB9C379CCF9D380EF11ADAB,20180723
AB32482D193E2CE166B59F82EF78D8BB,20180723
BADA03898CDBE31CBC727C737BABF5A7,20180723
6E49F3C990E2B95BC6048052C788789A,20180723
0D6A346C85BF606BE12F9A70FC20A7B7,20180723
98593396FB382E58809F59B3468025C9,20180723
FB1F87054CBD0625890297427AAAD990,20180723
D5F9D9AF22EF5073E10342973D48FB2C,20180723
1B2FC37816CC4DDAACA97A75E685756F,20180723
EE1D33F9073FBBC4D4072E958FB59E96,20180723
09A826527E24EFA70A0B7A8BDCD38962,20180723
5885B9A6C2FBB71AB1304B9EDB330B76,20180723
59BE43F3FE7AB3F91B016B56508D4C46,20180723
FEDC59699D8832A11B88BFCCCAD0951D,20180723
84D185835F0DE9C48712855B8713996E,20180723
8601A3659DC5C1F0444E5CCDA5ED3E14,20180723
D7EA8E3645EFFBD6443946179ED704A6,20180723
0939A5A6511211C939F2C5E2FC7A569A,20180723
EC318F837DFB8AB9D7D0115D7E53C56C,20180723
3D03A380687FE3369E93915D50C572CB,20180723
F2B128A28239782F1A667A3B0775A29D,20180723
5BFB6CC6B3E4271086B1E1B58180B56A,20180723
9DE7361ACCDEA6541AD5EA55D59B1C78,20180723
23A7E8D987ADCC38EB026096DC513F85,20180723
D182B4F9F81C0FD573A703FE9DC30259,20180723
D7D49CC32C4A23AD56E8DEAE6878EC7B,20180723
B99FD965B0874192EE94E8A8FE85EA9E,20180723
F815B0069F973BFA743EF90A85224109,20180723
B855837734B4686C3E8D439BA634E8B3,20180723
DAA3F353F320A717A0C418A8205292B2,20180723
B75F91EB6C7FDA9A329567E763CF9E44,20180723
8AB29C262591541BA945BF48D74DB5F5,20180723
CA04708DA02378999ECB402481FF1AE4,20180723
EA9A16D9042286D55399A418CC7A28F3,20180723

2025-01-23 17:17:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:17:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:17:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:17:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-23 17:17:41 - snowflake.connector.connection - INFO - closed
2025-01-23 17:17:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:17:42 - root - INFO - SQL:
SELECT "event_date", COUNT(*) AS "event_count"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
GROUP BY "event_date"
LIMIT 100
Results:
event_date,event_count
20180702,50000

2025-01-23 17:17:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:17:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:17:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:17:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 17:17:43 - snowflake.connector.connection - INFO - closed
2025-01-23 17:17:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:17:43 - root - INFO - SQL:
SELECT t."user_pseudo_id", t."device"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 AS t
LIMIT 100
Results:
Too long, hard cut:
user_pseudo_id,device
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo da

2025-01-23 17:17:43 - root - INFO - itercount: 0
2025-01-23 17:17:43 - root - INFO - Database Name: FIREBASE
Schema Name: ANALYTICS_153293282
DDL describes table information.
,0
table_name,EVENTS_20180613
description,
DDL,"create or replace TABLE EVENTS_20180613 (
	""event_date"" VARCHAR(16777216),
	""event_timestamp"" NUMBER(38,0),
	""event_name"" VARCHAR(16777216),
	""event_params"" VARIANT,
	""event_previous_timestamp"" NUMBER(38,0),
	""user_id"" VARCHAR(16777216),
	""user_pseudo_id"" VARCHAR(16777216),
	""user_properties"" VARIANT,
	""user_first_touch_timestamp"" NUMBER(38,0),
	""user_ltv"" VARIANT,
	""device"" VARIANT,
	""geo"" VARIANT,
	""app_info"" VARIANT,
	""traffic_source"" VARIANT,
	""stream_id"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']
External knowledge that might be helpful: 
How to Calculate User Retention in Big Query from Google Demo Game Analytics Data

As a Product / Website Analyst, I was pretty psyched to discover Googles public Google Analytics 4 (GA4) gaming event dataset called `firebase-public-project.analytics_153293282.events_*`. The table allows experienced developers and learners alike to experiment with raw GA4 data in Big Query for free. Event data is basically a log of user interactions with your product for analysis .For newbies interested in learning more about event data and GA4, visit my prior blog. This article provides SQL queries for a quick table overview and explains how to utilize Google Big Query to calculate user retention.


What is Retention?
User retention rates are key indicators for whether your product team meets user needs. Improving retention is often central to long term growth strategies.

**Retention measures how often and for how long users tend to return to your product.**

The metric can be a powerful proxy for product usefulness and user opinion. Its analysis can reveal critical information like how well your site converts new visitors to users and which items and features are associated with users coming back. If user data is available, retention can also help a business understand the profiles of its most active users (power users). Finally, retention is a great guardrail metric for A/B tests. Successful, product oriented companies prioritize a healthy user bases over short term profits.


**Common Retention Calculation Strategies**

Two common strategies to calculate retention are: 

a) N-Day retention

b) Unbounded Retention.


a) For N-Day retention, analysts calculate how many users with certain characteristics return over successive periods. It is called N days because we define the length of each period. For example, with N=7 day retention, if User A becomes part of our cohort of interest on day 0 and returns to the product day 5 and day 15, they are counted as retained for week 1 (17 days) and week 3 (1521 days) but not week 2 (814 days).


b) For Unbounded Retention, a user is counted as retained each week so long as their most recent product contact was after the week. For example, if User A becomes part of the cohort on day 0 and last returned to the site on day 21, they will be counted as retained in week 1 (17 days), week 2 (814 days), and week 3 (1521 days) but not week 4 (2228 days).

By calculating these metrics, companies can evaluate how well their products hold users interests. It also them closer to identifying the patterns that generate return users.



The table structure information is ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}
Begin Exploring Related Columns
**Columns and Potential Usage:**

- **"user_pseudo_id"**: Unique identifier for a user.
  - *Potential Usage*: To track individual users across events and dates.

- **"user_first_touch_timestamp"**: Timestamp of the user's first interaction with the app.
  - *Potential Usage*: To identify new users who first used the app during the week starting on July 2, 2018.

- **"event_timestamp"**: Timestamp of the event.
  - *Potential Usage*: To determine when events occurred for analyzing user activity over time.

- **"event_date"**: Date of the event (in 'YYYYMMDD' format).
  - *Potential Usage*: To filter events by specific dates or weeks for retention analysis.

- **"event_name"**: Name of the event.
  - *Potential Usage*: To analyze user actions and engagement.

- **"event_params"**: Additional parameters of the event (stored as VARIANT/JSON).
  - *Potential Usage*: To extract detailed information about events.

- **"platform"**: Platform used by the user (e.g., iOS, Android).
  - *Potential Usage*: To segment users by platform.

**Conditions that may be used:**

- Filtering users where **"user_first_touch_timestamp"** is between July 2, 2018 and July 8, 2018 to identify new users during the target week.
- Using **"event_date"** to analyze user activity in subsequent weeks for retention calculation.
- Matching **"user_pseudo_id"** across different dates to check if users returned in later weeks.

---

**SQL Queries:**

1. **Retrieve user_pseudo_id and user_first_touch_timestamp of users on July 2, 2018:**

   ```sql
   SELECT "user_pseudo_id", "user_first_touch_timestamp"
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
   LIMIT 100;
   ```

2. **Get distinct event_names recorded on July 2, 2018:**

   ```sql
   SELECT DISTINCT "event_name"
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
   LIMIT 100;
   ```

3. **Count the number of events per event_name on July 2, 2018:**

   ```sql
   SELECT "event_name", COUNT(*) AS "event_count"
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
   GROUP BY "event_name"
   LIMIT 100;
   ```

4. **List all platforms used by users on July 2, 2018 along with user counts:**

   ```sql
   SELECT "platform", COUNT(DISTINCT "user_pseudo_id") AS "user_count"
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
   GROUP BY "platform"
   LIMIT 100;
   ```

5. **Extract values from event_params on July 2, 2018:**

   ```sql
   SELECT f."value"
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 AS t,
   LATERAL FLATTEN(input => t."event_params") f
   LIMIT 100;
   ```

6. **Retrieve user_pseudo_ids of users who first used the app between July 2 and July 8, 2018:**

   ```sql
   SELECT DISTINCT "user_pseudo_id"
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
   WHERE "user_first_touch_timestamp" >= 1530489600000 AND "user_first_touch_timestamp" < 1531094400000
   LIMIT 100;
   ```
   *(Note: 1530489600000 and 1531094400000 are UNIX timestamps in milliseconds for July 2, 2018 and July 9, 2018 respectively.)*

7. **List event_dates and counts of events during the week starting July 2, 2018:**

   ```sql
   SELECT "event_date", COUNT(*) AS "event_count"
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
   WHERE "event_date" BETWEEN '20180702' AND '20180708'
   GROUP BY "event_date"
   LIMIT 100;
   ```

8. **Find user_pseudo_ids who had events on July 9, 2018 (Week 1):**

   ```sql
   SELECT DISTINCT "user_pseudo_id"
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180709
   LIMIT 100;
   ```

9. **Extract keys and values from user_properties on July 2, 2018:**

   ```sql
   SELECT f."key", f."value"
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 AS t,
   LATERAL FLATTEN(input => t."user_properties") f
   LIMIT 100;
   ```

10. **Retrieve user_pseudo_ids and event_names of users who had events on July 16, 2018 (Week 2):**

    ```sql
    SELECT "user_pseudo_id", "event_name"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180716
    LIMIT 100;
    ```

11. **List the number of users per platform during the initial week (July 2 - July 8, 2018):**

    ```sql
    SELECT "platform", COUNT(DISTINCT "user_pseudo_id") AS "user_count"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
    WHERE "event_date" BETWEEN '20180702' AND '20180708'
    GROUP BY "platform"
    LIMIT 100;
    ```

12. **Get the top 5 most frequent event_names during the initial week:**

    ```sql
    SELECT "event_name", COUNT(*) AS "event_count"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
    WHERE "event_date" BETWEEN '20180702' AND '20180708'
    GROUP BY "event_name"
    ORDER BY "event_count" DESC
    LIMIT 5;
    ```

13. **List user_pseudo_ids and event_dates for events on July 23, 2018 (Week 3):**

    ```sql
    SELECT DISTINCT "user_pseudo_id", "event_date"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180723
    LIMIT 100;
    ```

14. **Find the count of events per day for users who first used the app during the initial week:**

    ```sql
    SELECT "event_date", COUNT(*) AS "event_count"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
    WHERE "user_first_touch_timestamp" >= 1530489600000 AND "user_first_touch_timestamp" < 1531094400000
    GROUP BY "event_date"
    LIMIT 100;
    ```

15. **Extract device information from events on July 2, 2018:**

    ```sql
    SELECT t."user_pseudo_id", t."device"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 AS t
    LIMIT 100;
    ```

---

These queries help in exploring the data related to users who first used the app during the week starting on July 2, 2018, and their activity in subsequent weeks. By analyzing the results of these queries, we can proceed to perform the 7-day retention analysis as required.Query:
SELECT "user_pseudo_id", "user_first_touch_timestamp"
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
   LIMIT 100;
Answer:
Too long, hard cut:
user_pseudo_id,user_first_touch_timestamp
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,1476908354977000
654F30C1
Query:
SELECT DISTINCT "event_name"
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
   LIMIT 100;
Answer:
event_name
level_complete_quickplay
session_start
screen_view
level_fail_quickplay
level_end_quickplay
post_score
level_start_quickplay
user_engagement
level_up
level_complete
select_content
level_fail
level_end
level_start
level_retry
completed_5_levels
no_more_extra_steps
level_retry_quickplay
level_reset
level_reset_quickplay
app_exception
os_update
app_remove
app_clear_data
app_update
firebase_campaign
error
ad_reward
use_extra_steps
spend_virtual_currency
challenge_a_friend
first_open
Query:
SELECT "event_name", COUNT(*) AS "event_count"
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
   GROUP BY "event_name"
   LIMIT 100;
Answer:
event_name,event_count
level_complete_quickplay,1896
session_start,621
screen_view,20378
level_fail_quickplay,1173
level_end_quickplay,3068
post_score,2144
level_start_quickplay,4493
user_engagement,11605
level_up,248
level_complete,229
select_content,942
level_fail,148
level_end,396
level_start,560
level_retry,357
completed_5_levels,11
no_more_extra_steps,22
level_retry_quickplay,387
level_reset,72
level_reset_quickplay,916
app_exception,54
os_update,19
app_remove,13
app_clear_data,1
app_update,8
firebase_campaign,38
error,15
ad_reward,18
use_extra_steps,55
spend_virtual_currency,85
challenge_a_friend,1
first_open,27
Query:
SELECT "platform", COUNT(DISTINCT "user_pseudo_id") AS "user_count"
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
   GROUP BY "platform"
   LIMIT 100;
Answer:
platform,user_count
ANDROID,282
IOS,169
Query:
SELECT f.VALUE
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 AS t,
LATERAL FLATTEN(input => t."event_params") f
LIMIT 100;
Answer:
Too long, hard cut:
VALUE
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8126232848982224228
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8126232848982224228
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490845
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FloodItActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490838
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490838
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""FloodItActivity""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""ExtraStepsActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490799
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490799
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""shop_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490798
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""ExtraStepsActivity""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490798
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""shop_menu""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""GameFinishedActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490785
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490785
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_over""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"
Query:
SELECT DISTINCT "user_pseudo_id"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
LIMIT 100;
Answer:
user_pseudo_id
654F30C1312F6C1A26DFDA9F076A62D8
65D7715C409E6A38667447CE2B52AFFE
B205B117C82A24AA95E663FFB7D04718
EF9E8CCCCBBB015CAE0C334AB1745417
83D8C7F90DAF2C832F05A9DDD8693135
093642BD46204EB5F950303CE696BC18
0F67E233B19D2898229CD156974A93AE
5217AB1A454DAED6243E1C9818BE6A20
C6EAD483A8AF7EE9B0ADE6D7CE5DD698
58230465C695B0FDDDAE08A481FAEECC
38D4084307B6D1CEA37A48981753428E
0373DF7959F6867CDFB1C905D39CE67C
D34924C19421D7E083FD387D97765F94
C136A7CE1D0A52B8D4E5F144DF114EB7
4BF98D09CA8359FC59ADAF56D00338F8
08D399C66188D9A356AFAD5E2B2BA45E
49309C5759610DBF6C829C0D4AB23943
909A16079F7183140ACF4C71A6CCDF3D
3031EAD1E9D35306A37A0F3DC3B84A0A
3A58859E074B02E8FB1CAEA291636112
706C748E6D1E0768BFEFE6362B5D3F67
F815B0069F973BFA743EF90A85224109
D0F280B12652EB0D74F6BC74AB13606F
3EF8FC940E379D53BBD3FEFDAF626BB2
E6FEE8B98E75EA5311FE004F98559A27
50FEAE9ECFE22E951E8810622A2E8F66
4A47422A455E62E3529DE4F9F3BFAF66
4948BEDE78FC6EBA9899F26BF5C53897
88A41BFED275BB69125BE1F5524F3B42
A064A84CD3CF7058F39333D6212E8615
A87A30159D909E2356F72AAC76F26707
7AE4084BAA29B1987E51BF2964646805
5CDFC86835249BE3DB5E9F6778E344AD
7842C62D45ECE888132F21C9F4417B21
7101B4232F5B26A9C987C54F8717DCDC
29845B6298FB882DF53607D21F0E1DF7
76BB576278338D2E508DE5D705241B47
7207044281C74501C14233463AAD9A71
4BDC831A6940071E2461D0B5293A329E
A74EFE8BDAC26101B308D57A18B746CF
037DAC225F0C1E54657770CD201CDDA7
936906C2CB90CE437DBFC01BBD96BA39
D7EA8E3645EFFBD6443946179ED704A6
53866E32BA0ABFD846772D4B7B9B5921
257A35EA0A92B4B2F8FB4BA3F8B4C3D8
11A8D6037368A4C4508B11ADB4353BC4
C87CDC0C4F86B10B7467281D516929B5
028CAE01A9F16A228177C973451441A1
4CE503AE5B4C4F67A00474CE380CCC39
2304B486B11E4CFFA0BB8AC8F2F5F4B6
CE7404D5A8831F2DE46BD0A013A8ED64
60CFF65B640769B6FD3BC9593EDF7C1D
EBFE0623EF1109A89B392B9DF4375951
664F913ED3B54941B5F0886D94E01623
5D5895B1267014C54ECBE08864420979
92B0B6F48ECE132C7E502F94798FE205
05407E04B9FA64CB63D8FA1D966AD6A2
4D084D38156128AAA060303AA91E689D
E2D6E7FE36B7CDD0789CC8F03CC747E0
2F5B044B41268F6643EB4D0EF15D4E87
E8710E77072D6674A93E46DFEF725587
672B24B51143CC66DCBAA0FA88C38D57
2F8E2DBB938D2E43C2D171AF5F35EEF8
DE4912FBC5F915C027000A8A6FF44F85
48AB910A8DE8485D4C34238EA61F782C
92BF054A90804B6D65F11D7CDFCDDEFC
3DEB0C12C49AD19D7ACE68FA59E7ACD6
B7701369F8598A25DED0499DAD3BE85D
64BA3BB3BD757CE7000D38CB7125E6DA
E50F7AC0680FD87AD6CE6B6700D209A7
7D613AF4DA0F508C7090E96FD73B7E6D
C795AFA7F574C2BB09D3647AD90A9719
FEDC59699D8832A11B88BFCCCAD0951D
59454BAC415BB1F18517C6FD2C023E49
E451D416F972019604F1456533FF3858
AFE7A3E11C66E71FA9EA7B138700EC44
B75F91EB6C7FDA9A329567E763CF9E44
D739D483CCD20D4651E4A75ADEE94064
7480AE90D76538F44A066A153F448198
8EDB9A9856CDB5AFC42546106EE46734
3EDE8E7A50DE76AA2EC12DDD2AE3F9F4
CA04708DA02378999ECB402481FF1AE4
3D03A380687FE3369E93915D50C572CB
EA9A16D9042286D55399A418CC7A28F3
117AD1627465CC9E03AB5D8825D42E07
01562149DD13E75D732F0A9CA2D8CF5C
8320FC247A1967E7C0CDFC1502241310
5E694DE02688C2FDDEA38A6946A4CC3F
60FAC27D8495BF33C2AE5283A7B07005
4DA8863CD8D2C860F6BB73579BC6F5C9
97E7144B7FA861C3C8DB7424D7039832
DD695F4DCB9694F4E026B78E17BD7945
8040FC9C0479C3B9A74ED298DD8F357D
920DB84FCC0F4421650B9E257E33180B
AE920B86560554C0BE3F888EDBA2BBF7
27859DA5E38F4C681DA4FBF0CFB9F306
84D135997D8A4D9CB35D4ECA46EF6861
2F5BBABE9DD0271DCD62E501F76DA736
D3F06F9B7BD9D7FC8758BF78BF0705E9
2B1A8699D5D9CC85A21E5AD20A5F1278
Query:
SELECT "event_date", COUNT(*) AS "event_count"
FROM (
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180703
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180704
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180705
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180706
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180707
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180708
) AS t
GROUP BY "event_date"
LIMIT 100
Answer:
event_date,event_count
20180702,50000
20180703,50000
20180704,50000
20180705,50000
20180706,50000
20180707,50000
20180708,50000
Query:
SELECT DISTINCT "user_pseudo_id"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180709
LIMIT 100
Answer:
user_pseudo_id
AE9C7A5E358F2E0E0E90E4B8DD67AE76
6E018CE86D4601A362A9154B2500348A
23183C7A7E31451194345099C978F49E
3B7AC9CAE2D7BB661BE66F3DE36DD005
9D535D543FD07B8247DEADB4669FADE6
22DC6A6AE86C0AA33EBB8C3164A26925
EF9E8CCCCBBB015CAE0C334AB1745417
85FD06F19EBB6097388EEE0B207598B7
295D9E24D8DE65A010313E667131EF19
9603F4B5ABFC1E48B0BF68C83669F845
5217AB1A454DAED6243E1C9818BE6A20
5256B2B115955E80DDB7449775D92325
E0F91AA200D6F12DBE53B0D166AFD87B
2F0F260BD7B876C346B41977D0D03D62
DB9F0F2561524A9EE1436805AAD70675
E2B530ADD7430BEA6BC7F3D431C8A6FF
71746D859E4E6D655FEE8FFBC3B6C7E9
980DEC5BA17132A841D7D7A140333114
C6B7ED4E2FA4AABE5693A61B9A07753C
77F5E9A5630151C9E831156AEAB4DA11
49309C5759610DBF6C829C0D4AB23943
9F3EAF490630617EF2CB47A8BD2CBBCC
4BF98D09CA8359FC59ADAF56D00338F8
D7D49CC32C4A23AD56E8DEAE6878EC7B
4500595CA1FC3CBC6140A502240FB7B4
1F25763EC8BCAEC7FB069E81659A2153
706C748E6D1E0768BFEFE6362B5D3F67
F815B0069F973BFA743EF90A85224109
05F7B2C58D627CE948B06C10E39CDF91
3EF8FC940E379D53BBD3FEFDAF626BB2
E6FEE8B98E75EA5311FE004F98559A27
AB32482D193E2CE166B59F82EF78D8BB
B56E67847E1AE8D6411A5ECCA26585CA
29845B6298FB882DF53607D21F0E1DF7
9B27F8491DC5DA23D369F31250BD8D65
17515C32D8E535AA8A1B18BA774BB90C
85A84EA2A3017D368F41519312C6D3A2
037DAC225F0C1E54657770CD201CDDA7
4BDC831A6940071E2461D0B5293A329E
84AFEFA3875BA1F17232CB41D06B6EF4
6B9CFFB3E0DE6FA0C47B8410C4467F89
59BE43F3FE7AB3F91B016B56508D4C46
FFFE80A7B9667187D501CE6037876955
A65FAEAB5577A16B517735A9D9C54958
84F5D9204EDAE98B3B542AEA93F40BED
D7EA8E3645EFFBD6443946179ED704A6
F19B8122771D0514F440E914B722656A
8BE7BF90C971453A34C1FF6FF2A0ACAE
AB6FCC6558326ADC858DE37C8D9EB7CD
EBFE0623EF1109A89B392B9DF4375951
CA04708DA02378999ECB402481FF1AE4
EF9C32CA65880162136061B25D24E05E
F26EC6056E284FDDEA7771F203B6BB8F
945DE7C965AFB12E35C3C992CF9847E2
0160043392B1572A375E5C3BE1BB0C31
C136A7CE1D0A52B8D4E5F144DF114EB7
5F824D23AE3CF750894A96098818E789
5C5A0787542CD24F1E19F9EB778BA766
60603343AB8FEECD78B1009C957D193D
23A7E8D987ADCC38EB026096DC513F85
B4394AD77C6DE7A5C7385C307F35F84F
D0F280B12652EB0D74F6BC74AB13606F
48AB910A8DE8485D4C34238EA61F782C
EAFD6F2604C8351032764E5F8B4D389E
75C683C1AE98FC6CCE6EA156C9E90A35
88A41BFED275BB69125BE1F5524F3B42
8D31836A6C3C14CE71056BED8925F0A4
D5F9D9AF22EF5073E10342973D48FB2C
7566596A1D6ACA781692A7A0B89B06EF
A05ACB383D79E187B98B95E9C749C416
693EB525C74694F2E6990CA738F5E5D5
7F2B633C86B765201C93FDB6FF261143
331C58F19DE71B2DE30DDC47ECE5CCA6
B275DC380CF75B352381D5419E397047
7537C0AA6291AC7B99DC4D2D695EEF1D
9038CCC5F7D7ABDA6E296D18FFDD1AAA
6DC90DD09DF860E7C60C00BF36906CB3
7D613AF4DA0F508C7090E96FD73B7E6D
FEC117631F54C2699CB76603EBB98CF0
C795AFA7F574C2BB09D3647AD90A9719
FEDC59699D8832A11B88BFCCCAD0951D
017CF202552235BBA4338E0D82A53F43
B75F91EB6C7FDA9A329567E763CF9E44
8EDB9A9856CDB5AFC42546106EE46734
0B99B2EC1247C09535717331F816D42D
E4196C5E0A92A22F69DE4E3AA288D6EE
2F5BBABE9DD0271DCD62E501F76DA736
10522BF919A454B898540F51FFDCB292
0373DF7959F6867CDFB1C905D39CE67C
3827BA312204EA6F6847DFA4222C90CC
4D084D38156128AAA060303AA91E689D
0E05F56141200FF41FCC0C7FA297FF08
2F5B044B41268F6643EB4D0EF15D4E87
8E6F7A428C907165D78A2377ABEB7315
A29EBFE2A58D7C4D6FDA23C3A53742FF
60ACC539CFC3DB94C60921D5572C3A4D
4CFD4E167957842AFC9C7A6A5FF78827
1B2FC37816CC4DDAACA97A75E685756F
59454BAC415BB1F18517C6FD2C023E49
7480AE90D76538F44A066A153F448198
Query:
SELECT f."KEY", f."VALUE"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 AS t,
LATERAL FLATTEN(input => t."user_properties") f
LIMIT 100
Answer:
Too long, hard cut:
KEY,VALUE
,"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482378805491000,
    ""string_value"": ""2""
  }
}"
,"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1477369230231000,
    ""string_value"": ""3""
  }
}"
,"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1476908488411000,
    ""string_value"": ""true""
  }
}"
,"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1530589570174000,
    ""string_value"": ""30""
  }
}"
,"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1494813899942000,
    ""string_value"": ""4857993083614758445""
  }
}"
,"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1530589572284000,
    ""string_value"": ""1""
  }
}"
,"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1476917467314000,
    ""string_value"": ""true""
  }
}"
,"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1530589572283000,
    ""string_value"": ""0""
  }
}"
,"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1476908354977000,
    ""set_timestamp_micros"": 1476908266977000
  }
}"
,"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482378833491000,
    ""string_value"": ""2""
  }
}"
,"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1477369258231000,
    ""string_value"": ""3""
  }
}"
,"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1476908516411000,
    ""string_value"": ""true""
  }
}"
,"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1530592265519000,
    ""string_value"": ""30""
  }
}"
,"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1494813927942000,
    ""string_value"": ""4857993083614758445""
  }
}"
,"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1530589600284000,
    ""string_value"": ""1""
  }
}"
,"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1476917495314000,
    ""string_value"": ""true""
  }
}"
,"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1530589600283000,
    ""string_value"": ""0""
  }
}"
,"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1476908354977000,
    ""set_timestamp_micros"": 1476908294977000
  }
}"
,"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482378862491000,
    ""string_value"": ""2""
  }
}"
,"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1477369287231000,
    ""string_value"": ""3""
  }
}"
,"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1476908545411000,
    ""string_value"": ""true""
  }
}"
,"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1530592294519000,
    ""string_value"": ""30""
  }
}"
,"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1494813956942000,
    ""string_value"": ""4857993083614758445""
  }
}"
,"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1530589629284000,
    ""string_value"": ""1""
  }
}"
,"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1476917524314000,
    ""string_value"": ""true""
  }
}"
,"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1530589629283000,
    ""string_value"": ""0""
  }
}"
,"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1476908354977000,
    ""set_timestamp_micros"": 1476908323977000
  }
}"
,"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482378809491000,
    ""string_value"": ""2""
  }
}"
,"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1477369234231000,
    ""string_value"": ""3""
  }
}"
,"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1476908492411000,
    ""string_value"": ""true""
  }
}"
,"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1530589574174000,
    ""string_value"": ""30""
  }
}"
,"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1494813903942000,
    ""string_value"": ""4857993083614758445""
  }
}"
,"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1530589576284000,
    ""string_value"": ""1""
  }
}"
,"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1476917471314000,
    ""string_value"": ""true""
  }
}"
,"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1530589576283000,
    ""string_value"": ""0""
  }
}"
,"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1476908354977000,
    ""set_timestamp_
Query:
SELECT "user_pseudo_id", "event_name"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180716
LIMIT 100
Answer:
user_pseudo_id,event_name
64BB7DFAE772A77F70FB63373D0808F5,screen_view
64BB7DFAE772A77F70FB63373D0808F5,screen_view
64BB7DFAE772A77F70FB63373D0808F5,user_engagement
9D535D543FD07B8247DEADB4669FADE6,ad_reward
9D535D543FD07B8247DEADB4669FADE6,use_extra_steps
9D535D543FD07B8247DEADB4669FADE6,spend_virtual_currency
9D535D543FD07B8247DEADB4669FADE6,no_more_extra_steps
9D535D543FD07B8247DEADB4669FADE6,use_extra_steps
9D535D543FD07B8247DEADB4669FADE6,spend_virtual_currency
9D535D543FD07B8247DEADB4669FADE6,ad_reward
9D535D543FD07B8247DEADB4669FADE6,use_extra_steps
9D535D543FD07B8247DEADB4669FADE6,spend_virtual_currency
9D535D543FD07B8247DEADB4669FADE6,post_score
9D535D543FD07B8247DEADB4669FADE6,post_score
9D535D543FD07B8247DEADB4669FADE6,level_up
9D535D543FD07B8247DEADB4669FADE6,level_up
9D535D543FD07B8247DEADB4669FADE6,level_start
9D535D543FD07B8247DEADB4669FADE6,level_end
9D535D543FD07B8247DEADB4669FADE6,level_retry
9D535D543FD07B8247DEADB4669FADE6,level_start
9D535D543FD07B8247DEADB4669FADE6,level_end
9D535D543FD07B8247DEADB4669FADE6,level_retry
9D535D543FD07B8247DEADB4669FADE6,level_complete
9D535D543FD07B8247DEADB4669FADE6,level_complete
9D535D543FD07B8247DEADB4669FADE6,session_start
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,screen_view
9D535D543FD07B8247DEADB4669FADE6,select_content
9D535D543FD07B8247DEADB4669FADE6,select_content
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9D535D543FD07B8247DEADB4669FADE6,user_engagement
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,app_exception
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
9BC94B3773C8304A9E101AEBCFEF4A5F,level_end
9BC94B3773C8304A9E101AEBCFEF4A5F,level_fail
Query:
SELECT "platform", COUNT(DISTINCT "user_pseudo_id") AS "user_count"
FROM (
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180703
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180704
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180705
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180706
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180707
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180708
) AS t
GROUP BY "platform"
LIMIT 100
Answer:
platform,user_count
ANDROID,1028
IOS,602
Query:
SELECT "event_name", COUNT(*) AS "event_count"
FROM (
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180703
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180704
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180705
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180706
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180707
    UNION ALL
    SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180708
) AS t
GROUP BY "event_name"
ORDER BY "event_count" DESC
LIMIT 5
Answer:
event_name,event_count
screen_view,142638
user_engagement,81342
level_start_quickplay,31311
level_end_quickplay,21742
post_score,15470
Query:
SELECT DISTINCT "user_pseudo_id", "event_date"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180723
LIMIT 100
Answer:
user_pseudo_id,event_date
F2D0B7E8667E4855BEFD39ECA3185BF7,20180723
E6850F5E0DAB3E339C6A36BDEECCA26F,20180723
3B7AC9CAE2D7BB661BE66F3DE36DD005,20180723
023A2DB99CC3F70A4B71869C36952D74,20180723
8C648AA8E1BED4F1A904777CD622F4FF,20180723
FC55032FC8C06EB1A1220D1ABD1164C9,20180723
E069FDF17198500FCB6DDDF406ABA122,20180723
85FD06F19EBB6097388EEE0B207598B7,20180723
9BC94B3773C8304A9E101AEBCFEF4A5F,20180723
5217AB1A454DAED6243E1C9818BE6A20,20180723
5256B2B115955E80DDB7449775D92325,20180723
D11624EBD7C1693F9C3B4803A8D71DBA,20180723
71746D859E4E6D655FEE8FFBC3B6C7E9,20180723
772DA2BB33B435F5694AB02D10141E14,20180723
3604E77825369AD5C4101DA2644554A2,20180723
37DDB3680762B550822DDB952BF5F8C2,20180723
C18D4F7D4769C88197DFD443B97DAB8E,20180723
4CDB160C7A0483695AE6DB265C4E038F,20180723
945DE7C965AFB12E35C3C992CF9847E2,20180723
B9D8DF9BE543DEFAEDC13BF8903A859A,20180723
5A329C088FCD2F024968581AB06AABBB,20180723
77F5E9A5630151C9E831156AEAB4DA11,20180723
54EEE6C24B723126E17219F5C0F6DE12,20180723
9F81BD3E1662363A62176934DD8D50A9,20180723
BA08BDEC281666CB07A3F709BFB029EF,20180723
48D0C822ACA6BD0B5FBA8ECD27CBB247,20180723
D6CE2614AB26B05B94FC3840D08E91F0,20180723
8D478A447317FB83662A7CC605FCF39A,20180723
E6FEE8B98E75EA5311FE004F98559A27,20180723
6CD2676098B3E076AD66D10BF4565BFA,20180723
37A3C46088E501AB87767546AA7AF421,20180723
B56E67847E1AE8D6411A5ECCA26585CA,20180723
2F48607C41ECC4015FA296500F0A2C4B,20180723
BEB1E4B878112A53985AA6A0A2D30F16,20180723
3DEB0C12C49AD19D7ACE68FA59E7ACD6,20180723
42B0EA9C46944FD3177C30038D4970B3,20180723
CE3E59F2C2C3BD7F1C8FB80D53CF0F3B,20180723
920DB84FCC0F4421650B9E257E33180B,20180723
9AB38AB2AE2B6B15B572DE3AEFB04363,20180723
3DC1C89C927D2FC9D264FBC21E401E5B,20180723
2FC7AA16D54B177F0A2911FEA105A0B3,20180723
59454BAC415BB1F18517C6FD2C023E49,20180723
8E1749E5A26DD54E346476A289854E93,20180723
475B281839C403CCF826D0D44890BFA5,20180723
B79F414B574CB7F894FE7236A1465837,20180723
8EDB9A9856CDB5AFC42546106EE46734,20180723
FFA9AE78B23263835F8AAED57713EBE9,20180723
D1CC3A8740095F70116D613EC471A21D,20180723
4CE503AE5B4C4F67A00474CE380CCC39,20180723
C64FDEA4F0B0743BCF6CEDB45FEE8AB7,20180723
4A0A237C8AB244CE7449AF812EA5E641,20180723
EBFE0623EF1109A89B392B9DF4375951,20180723
37F354B57F5815ED7F977B4EB58C17EF,20180723
0A8B3658EFEEE8A30763ED36A4152C4B,20180723
476409D7DFD0B2B2B0AB11E5F6D7DDBE,20180723
FC2DDF0F37BB211D565307010B1B30A1,20180723
C6B7ED4E2FA4AABE5693A61B9A07753C,20180723
91FFEA4997DB9E39A944F4B23B6A3B24,20180723
1A3C9B890548F1BCE865FC5422E08672,20180723
38774821C3A944A0D1CEA88CFCAFB405,20180723
08B7AEC83DA53E917D595FE60C2CB600,20180723
906490EA8F6D8BBA578F7CC150DF731D,20180723
B4653EE7AA5AB38E47F66AAE2F708BD9,20180723
706C748E6D1E0768BFEFE6362B5D3F67,20180723
CF66FE17C9FF87481F56A40F25B9BB88,20180723
48AB910A8DE8485D4C34238EA61F782C,20180723
ECDB424F7CB9C379CCF9D380EF11ADAB,20180723
AB32482D193E2CE166B59F82EF78D8BB,20180723
BADA03898CDBE31CBC727C737BABF5A7,20180723
6E49F3C990E2B95BC6048052C788789A,20180723
0D6A346C85BF606BE12F9A70FC20A7B7,20180723
98593396FB382E58809F59B3468025C9,20180723
FB1F87054CBD0625890297427AAAD990,20180723
D5F9D9AF22EF5073E10342973D48FB2C,20180723
1B2FC37816CC4DDAACA97A75E685756F,20180723
EE1D33F9073FBBC4D4072E958FB59E96,20180723
09A826527E24EFA70A0B7A8BDCD38962,20180723
5885B9A6C2FBB71AB1304B9EDB330B76,20180723
59BE43F3FE7AB3F91B016B56508D4C46,20180723
FEDC59699D8832A11B88BFCCCAD0951D,20180723
84D185835F0DE9C48712855B8713996E,20180723
8601A3659DC5C1F0444E5CCDA5ED3E14,20180723
D7EA8E3645EFFBD6443946179ED704A6,20180723
0939A5A6511211C939F2C5E2FC7A569A,20180723
EC318F837DFB8AB9D7D0115D7E53C56C,20180723
3D03A380687FE3369E93915D50C572CB,20180723
F2B128A28239782F1A667A3B0775A29D,20180723
5BFB6CC6B3E4271086B1E1B58180B56A,20180723
9DE7361ACCDEA6541AD5EA55D59B1C78,20180723
23A7E8D987ADCC38EB026096DC513F85,20180723
D182B4F9F81C0FD573A703FE9DC30259,20180723
D7D49CC32C4A23AD56E8DEAE6878EC7B,20180723
B99FD965B0874192EE94E8A8FE85EA9E,20180723
F815B0069F973BFA743EF90A85224109,20180723
B855837734B4686C3E8D439BA634E8B3,20180723
DAA3F353F320A717A0C418A8205292B2,20180723
B75F91EB6C7FDA9A329567E763CF9E44,20180723
8AB29C262591541BA945BF48D74DB5F5,20180723
CA04708DA02378999ECB402481FF1AE4,20180723
EA9A16D9042286D55399A418CC7A28F3,20180723
Query:
SELECT "event_date", COUNT(*) AS "event_count"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
GROUP BY "event_date"
LIMIT 100
Answer:
event_date,event_count
20180702,50000
Query:
SELECT t."user_pseudo_id", t."device"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 AS t
LIMIT 100
Answer:
Too long, hard cut:
user_pseudo_id,device
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo da
End Exploring Related Columns
Task: Please perform a 7-day retention analysis for users who first used the app during the week starting on July 2, 2018. Provide the total number of these new users and the number of retained users for each week from Week 0 (the initial week) through Week 4.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Week,Total_New_Users,Retained_Users
0,total_new_users:int,retained_users_week0:int
1,,retained_users_week1:int
2,,retained_users_week2:int
3,,retained_users_week3:int
4,,retained_users_week4:int
```

This table provides a 7-day retention analysis for users who first used the app during the week starting on July 2, 2018 (Week 0). "Total_New_Users" represents the total number of new users in the initial week, and "Retained_Users" indicates the number of these users who returned to use the app in each subsequent week from Week 0 through Week 4..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-23 17:20:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 17:20:08 - root - INFO - ```sql
WITH
events_week0 AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180703
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180704
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180705
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180706
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180707
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180708
),
new_users AS (
  SELECT DISTINCT "user_pseudo_id"
  FROM events_week0
  WHERE "user_first_touch_timestamp" >= 1530489600000 AND "user_first_touch_timestamp" < 1531094400000
),
events_week1 AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180709
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180710
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180711
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180712
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180713
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180714
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180715
),
events_week2 AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180716
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180717
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180718
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180719
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180720
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180721
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180722
),
events_week3 AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180723
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180724
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180725
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180726
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180727
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180728
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180729
),
events_week4 AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180730
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180731
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180801
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180802
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180803
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180804
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180805
),
retention AS (
  SELECT 0 AS "Week", COUNT(DISTINCT n."user_pseudo_id") AS "Retained_Users"
  FROM new_users n
  JOIN events_week0 e0 ON n."user_pseudo_id" = e0."user_pseudo_id"
  UNION ALL
  SELECT 1 AS "Week", COUNT(DISTINCT n."user_pseudo_id") AS "Retained_Users"
  FROM new_users n
  JOIN events_week1 e1 ON n."user_pseudo_id" = e1."user_pseudo_id"
  UNION ALL
  SELECT 2 AS "Week", COUNT(DISTINCT n."user_pseudo_id") AS "Retained_Users"
  FROM new_users n
  JOIN events_week2 e2 ON n."user_pseudo_id" = e2."user_pseudo_id"
  UNION ALL
  SELECT 3 AS "Week", COUNT(DISTINCT n."user_pseudo_id") AS "Retained_Users"
  FROM new_users n
  JOIN events_week3 e3 ON n."user_pseudo_id" = e3."user_pseudo_id"
  UNION ALL
  SELECT 4 AS "Week", COUNT(DISTINCT n."user_pseudo_id") AS "Retained_Users"
  FROM new_users n
  JOIN events_week4 e4 ON n."user_pseudo_id" = e4."user_pseudo_id"
)
SELECT 
  retention."Week",
  (CASE WHEN retention."Week" = 0 THEN (SELECT COUNT(*) FROM new_users) ELSE NULL END) AS "Total_New_Users",
  retention."Retained_Users"
FROM retention
ORDER BY retention."Week";
```
2025-01-23 17:20:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:20:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:20:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:20:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-23 17:20:09 - snowflake.connector.connection - INFO - closed
2025-01-23 17:20:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:20:10 - root - INFO - itercount: 1
2025-01-23 17:20:10 - root - INFO - 0
2025-01-23 17:20:10 - root - INFO - results: 
Week,Total_New_Users,Retained_Users
0,0.0,0
1,,0
2,,0
3,,0
4,,0


2025-01-23 17:20:10 - root - INFO - Please check the answer again by reviewing Please perform a 7-day retention analysis for users who first used the app during the week starting on July 2, 2018. Provide the total number of these new users and the number of retained users for each week from Week 0 (the initial week) through Week 4., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Week,Total_New_Users,Retained_Users
0,total_new_users:int,retained_users_week0:int
1,,retained_users_week1:int
2,,retained_users_week2:int
3,,retained_users_week3:int
4,,retained_users_week4:int
```

This table provides a 7-day retention analysis for users who first used the app during the week starting on July 2, 2018 (Week 0). "Total_New_Users" represents the total number of new users in the initial week, and "Retained_Users" indicates the number of these users who returned to use the app in each subsequent week from Week 0 through Week 4. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Week,Total_New_Users,Retained_Users
0,0.0,0
1,,0
2,,0
3,,0
4,,0
Current sql:
WITH
events_week0 AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180703
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180704
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180705
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180706
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180707
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180708
),
new_users AS (
  SELECT DISTINCT "user_pseudo_id"
  FROM events_week0
  WHERE "user_first_touch_timestamp" >= 1530489600000 AND "user_first_touch_timestamp" < 1531094400000
),
events_week1 AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180709
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180710
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180711
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180712
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180713
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180714
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180715
),
events_week2 AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180716
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180717
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180718
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180719
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180720
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180721
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180722
),
events_week3 AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180723
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180724
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180725
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180726
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180727
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180728
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180729
),
events_week4 AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180730
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180731
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180801
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180802
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180803
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180804
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180805
),
retention AS (
  SELECT 0 AS "Week", COUNT(DISTINCT n."user_pseudo_id") AS "Retained_Users"
  FROM new_users n
  JOIN events_week0 e0 ON n."user_pseudo_id" = e0."user_pseudo_id"
  UNION ALL
  SELECT 1 AS "Week", COUNT(DISTINCT n."user_pseudo_id") AS "Retained_Users"
  FROM new_users n
  JOIN events_week1 e1 ON n."user_pseudo_id" = e1."user_pseudo_id"
  UNION ALL
  SELECT 2 AS "Week", COUNT(DISTINCT n."user_pseudo_id") AS "Retained_Users"
  FROM new_users n
  JOIN events_week2 e2 ON n."user_pseudo_id" = e2."user_pseudo_id"
  UNION ALL
  SELECT 3 AS "Week", COUNT(DISTINCT n."user_pseudo_id") AS "Retained_Users"
  FROM new_users n
  JOIN events_week3 e3 ON n."user_pseudo_id" = e3."user_pseudo_id"
  UNION ALL
  SELECT 4 AS "Week", COUNT(DISTINCT n."user_pseudo_id") AS "Retained_Users"
  FROM new_users n
  JOIN events_week4 e4 ON n."user_pseudo_id" = e4."user_pseudo_id"
)
SELECT 
  retention."Week",
  (CASE WHEN retention."Week" = 0 THEN (SELECT COUNT(*) FROM new_users) ELSE NULL END) AS "Total_New_Users",
  retention."Retained_Users"
FROM retention
ORDER BY retention."Week";Empty results in Column ['Total_New_Users', 'Retained_Users']. Please correct them.

2025-01-23 17:21:24 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 17:21:24 - root - INFO - ```sql
WITH
events_week0 AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180703
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180704
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180705
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180706
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180707
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180708
),
new_users AS (
  SELECT DISTINCT "user_pseudo_id"
  FROM events_week0
  WHERE "user_first_touch_timestamp" >= 1530489600000000 AND "user_first_touch_timestamp" < 1531094400000000
),
events_week1 AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180709
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180710
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180711
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180712
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180713
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180714
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180715
),
events_week2 AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180716
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180717
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180718
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180719
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180720
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180721
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180722
),
events_week3 AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180723
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180724
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180725
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180726
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180727
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180728
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180729
),
events_week4 AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180730
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180731
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180801
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180802
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180803
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180804
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180805
),
retention AS (
  SELECT 0 AS "Week", COUNT(DISTINCT n."user_pseudo_id") AS "Retained_Users"
  FROM new_users n
  JOIN events_week0 e0 ON n."user_pseudo_id" = e0."user_pseudo_id"
  UNION ALL
  SELECT 1 AS "Week", COUNT(DISTINCT n."user_pseudo_id") AS "Retained_Users"
  FROM new_users n
  JOIN events_week1 e1 ON n."user_pseudo_id" = e1."user_pseudo_id"
  UNION ALL
  SELECT 2 AS "Week", COUNT(DISTINCT n."user_pseudo_id") AS "Retained_Users"
  FROM new_users n
  JOIN events_week2 e2 ON n."user_pseudo_id" = e2."user_pseudo_id"
  UNION ALL
  SELECT 3 AS "Week", COUNT(DISTINCT n."user_pseudo_id") AS "Retained_Users"
  FROM new_users n
  JOIN events_week3 e3 ON n."user_pseudo_id" = e3."user_pseudo_id"
  UNION ALL
  SELECT 4 AS "Week", COUNT(DISTINCT n."user_pseudo_id") AS "Retained_Users"
  FROM new_users n
  JOIN events_week4 e4 ON n."user_pseudo_id" = e4."user_pseudo_id"
)
SELECT 
  retention."Week",
  (CASE WHEN retention."Week" = 0 THEN (SELECT COUNT(*) FROM new_users) ELSE NULL END) AS "Total_New_Users",
  retention."Retained_Users"
FROM retention
ORDER BY retention."Week";
```
2025-01-23 17:21:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:21:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:21:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:21:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-23 17:21:27 - snowflake.connector.connection - INFO - closed
2025-01-23 17:21:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:21:27 - root - INFO - itercount: 2
2025-01-23 17:21:27 - root - INFO - 0
2025-01-23 17:21:27 - root - INFO - results: 
Week,Total_New_Users,Retained_Users
0,222.0,222
1,,54
2,,37
3,,35
4,,15


2025-01-23 17:21:27 - root - INFO - Please check the answer again by reviewing Please perform a 7-day retention analysis for users who first used the app during the week starting on July 2, 2018. Provide the total number of these new users and the number of retained users for each week from Week 0 (the initial week) through Week 4., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Week,Total_New_Users,Retained_Users
0,total_new_users:int,retained_users_week0:int
1,,retained_users_week1:int
2,,retained_users_week2:int
3,,retained_users_week3:int
4,,retained_users_week4:int
```

This table provides a 7-day retention analysis for users who first used the app during the week starting on July 2, 2018 (Week 0). "Total_New_Users" represents the total number of new users in the initial week, and "Retained_Users" indicates the number of these users who returned to use the app in each subsequent week from Week 0 through Week 4. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Week,Total_New_Users,Retained_Users
0,222.0,222
1,,54
2,,37
3,,35
4,,15
Current sql:
WITH
events_week0 AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180703
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180704
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180705
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180706
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180707
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180708
),
new_users AS (
  SELECT DISTINCT "user_pseudo_id"
  FROM events_week0
  WHERE "user_first_touch_timestamp" >= 1530489600000000 AND "user_first_touch_timestamp" < 1531094400000000
),
events_week1 AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180709
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180710
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180711
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180712
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180713
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180714
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180715
),
events_week2 AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180716
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180717
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180718
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180719
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180720
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180721
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180722
),
events_week3 AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180723
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180724
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180725
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180726
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180727
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180728
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180729
),
events_week4 AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180730
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180731
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180801
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180802
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180803
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180804
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180805
),
retention AS (
  SELECT 0 AS "Week", COUNT(DISTINCT n."user_pseudo_id") AS "Retained_Users"
  FROM new_users n
  JOIN events_week0 e0 ON n."user_pseudo_id" = e0."user_pseudo_id"
  UNION ALL
  SELECT 1 AS "Week", COUNT(DISTINCT n."user_pseudo_id") AS "Retained_Users"
  FROM new_users n
  JOIN events_week1 e1 ON n."user_pseudo_id" = e1."user_pseudo_id"
  UNION ALL
  SELECT 2 AS "Week", COUNT(DISTINCT n."user_pseudo_id") AS "Retained_Users"
  FROM new_users n
  JOIN events_week2 e2 ON n."user_pseudo_id" = e2."user_pseudo_id"
  UNION ALL
  SELECT 3 AS "Week", COUNT(DISTINCT n."user_pseudo_id") AS "Retained_Users"
  FROM new_users n
  JOIN events_week3 e3 ON n."user_pseudo_id" = e3."user_pseudo_id"
  UNION ALL
  SELECT 4 AS "Week", COUNT(DISTINCT n."user_pseudo_id") AS "Retained_Users"
  FROM new_users n
  JOIN events_week4 e4 ON n."user_pseudo_id" = e4."user_pseudo_id"
)
SELECT 
  retention."Week",
  (CASE WHEN retention."Week" = 0 THEN (SELECT COUNT(*) FROM new_users) ELSE NULL END) AS "Total_New_Users",
  retention."Retained_Users"
FROM retention
ORDER BY retention."Week";
2025-01-23 17:22:26 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 17:22:26 - root - INFO - ```sql
WITH
events_week0 AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180703
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180704
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180705
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180706
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180707
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180708
),
new_users AS (
  SELECT DISTINCT "user_pseudo_id"
  FROM events_week0
  WHERE "user_first_touch_timestamp" >= 1530489600000000 AND "user_first_touch_timestamp" < 1531094400000000
),
events_week1 AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180709
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180710
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180711
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180712
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180713
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180714
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180715
),
events_week2 AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180716
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180717
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180718
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180719
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180720
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180721
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180722
),
events_week3 AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180723
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180724
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180725
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180726
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180727
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180728
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180729
),
events_week4 AS (
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180730
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180731
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180801
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180802
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180803
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180804
  UNION ALL
  SELECT * FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180805
),
retention AS (
  SELECT 0 AS "Week", COUNT(DISTINCT n."user_pseudo_id") AS "Retained_Users"
  FROM new_users n
  JOIN events_week0 e0 ON n."user_pseudo_id" = e0."user_pseudo_id"
  UNION ALL
  SELECT 1 AS "Week", COUNT(DISTINCT n."user_pseudo_id") AS "Retained_Users"
  FROM new_users n
  JOIN events_week1 e1 ON n."user_pseudo_id" = e1."user_pseudo_id"
  UNION ALL
  SELECT 2 AS "Week", COUNT(DISTINCT n."user_pseudo_id") AS "Retained_Users"
  FROM new_users n
  JOIN events_week2 e2 ON n."user_pseudo_id" = e2."user_pseudo_id"
  UNION ALL
  SELECT 3 AS "Week", COUNT(DISTINCT n."user_pseudo_id") AS "Retained_Users"
  FROM new_users n
  JOIN events_week3 e3 ON n."user_pseudo_id" = e3."user_pseudo_id"
  UNION ALL
  SELECT 4 AS "Week", COUNT(DISTINCT n."user_pseudo_id") AS "Retained_Users"
  FROM new_users n
  JOIN events_week4 e4 ON n."user_pseudo_id" = e4."user_pseudo_id"
)
SELECT 
  retention."Week",
  (CASE WHEN retention."Week" = 0 THEN (SELECT COUNT(*) FROM new_users) ELSE NULL END) AS "Total_New_Users",
  retention."Retained_Users"
FROM retention
ORDER BY retention."Week";
```
2025-01-23 17:22:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 17:22:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 17:22:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 17:22:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-23 17:22:28 - snowflake.connector.connection - INFO - closed
2025-01-23 17:22:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 17:22:28 - root - INFO - itercount: 3
2025-01-23 17:22:28 - root - INFO - 0
2025-01-23 17:22:28 - root - INFO - Total iteration counts: 3
