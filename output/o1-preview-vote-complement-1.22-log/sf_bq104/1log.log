2025-01-24 06:47:28 - openai._base_client - INFO - Retrying request to /chat/completions in 0.480663 seconds
2025-01-24 06:48:45 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 06:48:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:48:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:48:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:48:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:48:46 - snowflake.connector.connection - INFO - closed
2025-01-24 06:48:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:48:47 - root - INFO - SQL:
-- Query 1: Retrieve distinct weeks available in TOP_RISING_TERMS
SELECT DISTINCT "week"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_RISING_TERMS
LIMIT 100;
Results:
week
2024-05-19
2021-05-30
2020-10-11
2019-09-08
2023-04-30
2022-09-04
2021-06-13
2022-05-15
2023-06-25
2023-01-01
2023-12-17
2019-11-24
2023-05-28
2024-08-11
2021-03-14
2020-10-25
2023-07-02
2019-12-08
2022-03-20
2019-11-17
2022-08-21
2020-05-24
2022-11-13
2024-09-15
2021-08-01
2020-01-26
2023-12-03
2022-04-10
2019-12-22
2024-10-06
2020-04-19
2020-11-29
2023-10-22
2021-11-21
2022-06-12
2022-09-25
2023-07-30
2020-06-28
2020-04-12
2020-07-05
2023-03-26
2019-12-29
2022-06-05
2023-01-15
2024-02-11
2024-01-14
2024-07-28
2019-10-20
2020-08-16
2024-05-26
2023-09-24
2024-04-14
2021-02-21
2021-10-17
2021-04-25
2020-07-12
2020-07-26
2022-04-17
2020-08-09
2020-02-16
2020-10-18
2021-02-07
2023-02-26
2022-12-18
2022-10-09
2021-01-03
2023-10-15
2019-09-01
2023-11-26
2020-02-02
2024-05-12
2022-02-20
2019-12-01
2024-06-09
2024-01-28
2021-05-16
2020-05-03
2021-12-05
2022-07-17
2023-07-16
2023-01-29
2023-09-10
2020-03-15
2020-03-08
2022-11-20
2023-06-11
2021-08-08
2024-06-23
2024-06-30
2021-10-31
2021-03-07
2022-04-03
2022-12-25
2023-04-09
2021-09-12
2020-08-30
2021-07-25
2023-08-06
2024-03-03
2020-02-23

2025-01-24 06:48:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:48:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:48:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:48:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-24 06:48:48 - snowflake.connector.connection - INFO - closed
2025-01-24 06:48:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:49:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 06:49:37 - root - INFO - ```sql
SELECT t."dma_name", SUM(t."score") AS "total_score"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_TERMS t
WHERE t."term" IN (
    SELECT DISTINCT "term"
    FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_RISING_TERMS
    WHERE "week" = '2022-10-09'
)
AND t."week" = '2022-10-09'
GROUP BY t."dma_name"
ORDER BY "total_score" DESC
LIMIT 1;
```
2025-01-24 06:49:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:49:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:49:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:49:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 06:49:38 - snowflake.connector.connection - INFO - closed
2025-01-24 06:49:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:50:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 06:50:32 - root - INFO - SQL:
SELECT t."dma_name", SUM(t."score") AS "total_score"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_TERMS t
WHERE t."term" IN (
    SELECT DISTINCT "term"
    FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_RISING_TERMS
    WHERE "week" = '2022-10-09'
)
AND t."week" = '2022-10-09'
GROUP BY t."dma_name"
ORDER BY "total_score" DESC
LIMIT 1;
Results:
dma_name,total_score
Ottumwa IA-Kirksville MO,

2025-01-24 06:50:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:50:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:50:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:50:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:50:34 - snowflake.connector.connection - INFO - closed
2025-01-24 06:50:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:50:34 - root - INFO - SQL:
-- Query 3: Get top rising terms and their percent gain from one year ago
SELECT "term", "percent_gain"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_RISING_TERMS
WHERE "week" = '2022-10-09'
ORDER BY "percent_gain" DESC
LIMIT 100
Results:
term,percent_gain
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850

2025-01-24 06:50:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:50:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:50:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:50:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:50:36 - snowflake.connector.connection - INFO - closed
2025-01-24 06:50:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:50:36 - root - INFO - SQL:
-- Query 4: Retrieve distinct DMA names and IDs from TOP_TERMS
SELECT DISTINCT "dma_name", "dma_id"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_TERMS
LIMIT 100
Results:
dma_name,dma_id
Columbus-Tupelo-West Point MS,673
Albany GA,525
Madison WI,669
Clarksburg-Weston WV,598
Reno NV,811
Ottumwa IA-Kirksville MO,631
Casper-Riverton WY,767
Traverse City-Cadillac MI,540
Joplin MO-Pittsburg KS,603
Utica NY,526
Boston MA-Manchester NH,506
Colorado Springs-Pueblo CO,752
Lafayette IN,582
Topeka KS,605
Lake Charles LA,643
Springfield-Holyoke MA,543
Sioux Falls(Mitchell) SD,725
Minot-Bismarck-Dickinson(Williston) ND,687
Great Falls MT,755
Salt Lake City UT,770
Davenport IA-Rock Island-Moline IL,682
Rochester NY,538
Wilmington NC,550
Beaumont-Port Arthur TX,692
Bend OR,821
Indianapolis IN,527
Columbus GA,522
Victoria TX,626
South Bend-Elkhart IN,588
Cincinnati OH,515
Tulsa OK,671
Chico-Redding CA,868
Greenville-Spartanburg-Asheville-Anderson,567
Monterey-Salinas CA,828
Monroe LA-El Dorado AR,628
Austin TX,635
Jacksonville FL,561
Philadelphia PA,504
Ft. Myers-Naples FL,571
Kansas City MO,616
Syracuse NY,555
New Orleans LA,622
Baltimore MD,512
Glendive MT,798
Elmira (Corning) NY,565
Presque Isle ME,552
Flint-Saginaw-Bay City MI,513
Wheeling WV-Steubenville OH,554
Mankato MN,737
Boise ID,757
Rochester-Mason City-Austin IA,611
Baton Rouge LA,716
Toledo OH,547
La Crosse-Eau Claire WI,702
Portland OR,820
Washington DC (Hagerstown MD),511
Lincoln & Hastings-Kearney NE,722
Greensboro-High Point-Winston Salem NC,518
Wichita Falls TX & Lawton OK,627
Seattle-Tacoma WA,819
Johnstown-Altoona-State College PA,574
Oklahoma City OK,650
Lansing MI,551
Fresno-Visalia CA,866
Charleston-Huntington WV,564
Richmond-Petersburg VA,556
Phoenix AZ,753
Burlington VT-Plattsburgh NY,523
Panama City FL,656
Roanoke-Lynchburg VA,573
Hartford & New Haven CT,533
Hattiesburg-Laurel MS,710
Youngstown OH,536
Greenville-New Bern-Washington NC,545
Lubbock TX,651
Bluefield-Beckley-Oak Hill WV,559
Abilene-Sweetwater TX,662
Macon GA,503
St. Louis MO,609
Omaha NE,652
Raleigh-Durham (Fayetteville) NC,560
Eugene OR,801
Juneau AK,747
Marquette MI,553
Fairbanks AK,745
Jackson TN,639
Missoula MT,762
Bangor ME,537
Norfolk-Portsmouth-Newport News VA,544
Des Moines-Ames IA,679
Minneapolis-St. Paul MN,613
Memphis TN,640
Tallahassee FL-Thomasville GA,530
Louisville KY,529
Honolulu HI,744
Evansville IN,649
Grand Junction-Montrose CO,773
Denver CO,751
El Paso TX,765
Dallas-Ft. Worth TX,623

2025-01-24 06:50:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:50:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:50:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:50:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:50:37 - snowflake.connector.connection - INFO - closed
2025-01-24 06:50:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:50:38 - root - INFO - SQL:
-- Query 5: Get search scores per term and DMA from TOP_TERMS for one year ago
SELECT "dma_name", "term", "score"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_TERMS
WHERE "week" = '2022-10-09'
LIMIT 100
Results:
dma_name,term,score
Portland-Auburn ME,49ers,9.0
Charlotte NC,49ers,22.0
Wilmington NC,49ers,7.0
Dothan AL,49ers,
Portland-Auburn ME,Brandon McManus,
Greenville-New Bern-Washington NC,Brandon McManus,
Dothan AL,Brandon McManus,
Baltimore MD,Brandon McManus,
Marquette MI,Brandon McManus,
Evansville IN,Brandon McManus,
Portland-Auburn ME,Aurora forecast,
Charlotte NC,Aurora forecast,
Wilmington NC,Aurora forecast,
Chattanooga TN,Aurora forecast,
Dothan AL,Aurora forecast,
Baltimore MD,Aurora forecast,
Rapid City SD,Aurora forecast,
Kansas City MO,Tom Brady,18.0
Charlotte NC,Andy Beshear,
Greenville-New Bern-Washington NC,Andy Beshear,
Wilmington NC,Andy Beshear,
Chattanooga TN,Andy Beshear,
Chattanooga TN,Aidan Hutchinson,
Portland-Auburn ME,Bad boys,
Portland-Auburn ME,ABC news,12.0
Charlotte NC,ABC news,11.0
Greenville-New Bern-Washington NC,Aurora forecast,
Atlanta GA,Aurora forecast,
Marquette MI,Aurora forecast,
Grand Rapids-Kalamazoo-Battle Creek MI,Aurora forecast,
Wilkes Barre-Scranton PA,Aurora forecast,
Evansville IN,Aurora forecast,
Philadelphia PA,Aurora forecast,
Las Vegas NV,Brandon McManus,
Columbus-Tupelo-West Point MS,Brandon McManus,
Juneau AK,Brandon McManus,
Seattle-Tacoma WA,Brandon McManus,
Burlington VT-Plattsburgh NY,Brandon McManus,
Baltimore MD,Aidan Hutchinson,
Atlanta GA,Aidan Hutchinson,
Marquette MI,Aidan Hutchinson,
Grand Rapids-Kalamazoo-Battle Creek MI,Aidan Hutchinson,
Rapid City SD,Aidan Hutchinson,
Buffalo NY,Aurora forecast,
Ft. Myers-Naples FL,Aurora forecast,
Lake Charles LA,Aurora forecast,
Huntsville-Decatur (Florence) AL,Aurora forecast,
Seattle-Tacoma WA,Aurora forecast,1.0
Orlando-Daytona Beach-Melbourne FL,Aurora forecast,
Columbia-Jefferson City MO,Aurora forecast,
Palm Springs CA,Aurora forecast,
Charleston SC,Tom Brady,15.0
Butte-Bozeman MT,Tom Brady,18.0
Providence-New Bedford MA,Tom Brady,12.0
Atlanta GA,Andy Beshear,
Marquette MI,Andy Beshear,
Grand Rapids-Kalamazoo-Battle Creek MI,Andy Beshear,
Wilkes Barre-Scranton PA,Andy Beshear,
Rapid City SD,Andy Beshear,
Buffalo NY,Aidan Hutchinson,
Ft. Myers-Naples FL,Aidan Hutchinson,
Lake Charles LA,Aidan Hutchinson,
Las Vegas NV,Aidan Hutchinson,
Huntsville-Decatur (Florence) AL,Aidan Hutchinson,
Seattle-Tacoma WA,Aidan Hutchinson,
Cleveland-Akron (Canton) OH,Aidan Hutchinson,
Palm Springs CA,Aidan Hutchinson,
Greenville-New Bern-Washington NC,Bad boys,
Chattanooga TN,Bad boys,
Dothan AL,Bad boys,
Portland-Auburn ME,Ana de Armas,
Portland-Auburn ME,49ers vs Seahawks,
Charlotte NC,49ers vs Seahawks,
Greenville-New Bern-Washington NC,49ers vs Seahawks,
Marquette MI,49ers vs Seahawks,
Wilkes Barre-Scranton PA,49ers vs Seahawks,
Rapid City SD,49ers vs Seahawks,
Philadelphia PA,49ers vs Seahawks,
Ft. Wayne IN,Tom Brady,15.0
Memphis TN,Tom Brady,15.0
Helena MT,Tom Brady,
St. Louis MO,Tom Brady,11.0
Albuquerque-Santa Fe NM,Brandon McManus,
Bend OR,Brandon McManus,
Little Rock-Pine Bluff AR,Brandon McManus,
Kansas City MO,Brandon McManus,
Providence-New Bedford MA,Brandon McManus,
Amarillo TX,Brandon McManus,
Grand Junction-Montrose CO,Brandon McManus,
Richmond-Petersburg VA,Brandon McManus,
Johnstown-Altoona-State College PA,Brandon McManus,
St. Louis MO,Brandon McManus,
Laredo TX,Brandon McManus,
Tallahassee FL-Thomasville GA,Brandon McManus,
Springfield-Holyoke MA,Brandon McManus,
Greenville-New Bern-Washington NC,ABC news,17.0
Chattanooga TN,ABC news,16.0
Albuquerque-Santa Fe NM,Aidan Hutchinson,
Wausau-Rhinelander WI,Aidan Hutchinson,
Kansas City MO,Aidan Hutchinson,

2025-01-24 06:50:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:50:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:50:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:50:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:50:39 - snowflake.connector.connection - INFO - closed
2025-01-24 06:50:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:50:40 - root - INFO - SQL:
-- Query 6: Find search scores for terms that were top rising one year ago
SELECT t."dma_name", t."term", t."score"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_TERMS t
WHERE t."term" IN (
    SELECT DISTINCT "term"
    FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_RISING_TERMS
    WHERE "week" = '2022-10-09'
)
AND t."week" = '2022-10-09'
LIMIT 100
Results:
dma_name,term,score
Albany GA,49ers,9.0
Nashville TN,49ers,9.0
Colorado Springs-Pueblo CO,49ers,10.0
Wichita Falls TX & Lawton OK,49ers,7.0
Sioux City IA,49ers,10.0
St. Louis MO,49ers,6.0
Charlottesville VA,49ers,
Abilene-Sweetwater TX,49ers,9.0
Milwaukee WI,49ers,6.0
Spokane WA,49ers,17.0
Charleston-Huntington WV,49ers,8.0
Columbus-Tupelo-West Point MS,49ers,12.0
Parkersburg WV,49ers,
Lafayette LA,49ers,10.0
Huntsville-Decatur (Florence) AL,49ers,4.0
Sacramento-Stockton-Modesto CA,49ers,27.0
Ft. Smith-Fayetteville-Springdale-Rogers AR,49ers,7.0
Atlanta GA,49ers,11.0
Evansville IN,49ers,7.0
Columbus GA,49ers,9.0
Syracuse NY,49ers,9.0
Macon GA,49ers,9.0
Tulsa OK,49ers,8.0
Alpena MI,49ers,
Providence-New Bedford MA,49ers,9.0
Phoenix AZ,49ers,15.0
Greenwood-Greenville MS,49ers,19.0
Bakersfield CA,49ers,22.0
Greenwood-Greenville MS,49ers,16.0
Columbus OH,49ers,6.0
Pittsburgh PA,49ers,5.0
Tallahassee FL-Thomasville GA,49ers,6.0
Victoria TX,49ers,
San Diego CA,49ers,13.0
Memphis TN,49ers,15.0
Cedar Rapids-Waterloo-Iowa City & Dubuque IA,49ers,10.0
Springfield MO,49ers,4.0
Toledo OH,49ers,9.0
Boston MA-Manchester NH,49ers,7.0
Greenville-New Bern-Washington NC,49ers,9.0
Wheeling WV-Steubenville OH,49ers,8.0
Bend OR,49ers,21.0
Savannah GA,49ers,8.0
Albany-Schenectady-Troy NY,49ers,10.0
St. Louis MO,49ers,6.0
Anchorage AK,49ers,15.0
Bowling Green KY,49ers,
Utica NY,49ers,16.0
Rochester-Mason City-Austin IA,49ers,4.0
Jackson TN,49ers,16.0
Dayton OH,49ers,11.0
Mobile AL-Pensacola (Ft. Walton Beach) FL,49ers,8.0
Jacksonville FL,49ers,7.0
Yuma AZ-El Centro CA,49ers,19.0
Chico-Redding CA,49ers,35.0
Monroe LA-El Dorado AR,49ers,9.0
Columbia SC,49ers,17.0
Harrisonburg VA,49ers,7.0
Charlottesville VA,49ers,4.0
Dothan AL,49ers,
Philadelphia PA,49ers,7.0
Sherman-Ada OK,49ers,8.0
Alexandria LA,49ers,
Victoria TX,49ers,
Lafayette IN,49ers,
Monroe LA-El Dorado AR,49ers,5.0
Roanoke-Lynchburg VA,49ers,11.0
Tucson (Sierra Vista) AZ,49ers,16.0
Cedar Rapids-Waterloo-Iowa City & Dubuque IA,49ers,10.0
Terre Haute IN,49ers,7.0
Harlingen-Weslaco-Brownsville-McAllen TX,49ers,10.0
Waco-Temple-Bryan TX,49ers,10.0
West Palm Beach-Ft. Pierce FL,49ers,9.0
Wichita Falls TX & Lawton OK,49ers,9.0
Chicago IL,49ers,6.0
Ft. Myers-Naples FL,49ers,7.0
Phoenix AZ,49ers,15.0
Lima OH,49ers,
Jonesboro AR,49ers,
Minneapolis-St. Paul MN,49ers,4.0
Chattanooga TN,49ers,8.0
Yuma AZ-El Centro CA,49ers,18.0
El Paso TX,49ers,23.0
Wilkes Barre-Scranton PA,49ers,10.0
La Crosse-Eau Claire WI,49ers,5.0
Indianapolis IN,49ers,6.0
Paducah KY-Cape Girardeau MO-Harrisburg-Mount Vernon IL,49ers,4.0
Grand Junction-Montrose CO,49ers,14.0
Glendive MT,49ers,
Corpus Christi TX,49ers,9.0
Tucson (Sierra Vista) AZ,49ers,16.0
Youngstown OH,49ers,10.0
Joplin MO-Pittsburg KS,49ers,4.0
Wichita-Hutchinson KS,49ers,7.0
Detroit MI,49ers,3.0
Tyler-Longview(Lufkin & Nacogdoches) TX,49ers,8.0
Providence-New Bedford MA,49ers,9.0
Tyler-Longview(Lufkin & Nacogdoches) TX,49ers,8.0
Fargo-Valley City ND,49ers,9.0
San Francisco-Oakland-San Jose CA,49ers,24.0

2025-01-24 06:50:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:50:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:50:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:50:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:50:41 - snowflake.connector.connection - INFO - closed
2025-01-24 06:50:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:50:42 - root - INFO - SQL:
-- Query 7: Sum the search scores per DMA for top rising terms from one year ago
SELECT t."dma_name", SUM(t."score") AS "total_score"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_TERMS t
WHERE t."term" IN (
    SELECT DISTINCT "term"
    FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_RISING_TERMS
    WHERE "week" = '2022-10-09'
)
AND t."week" = '2022-10-09'
GROUP BY t."dma_name"
ORDER BY "total_score" DESC
LIMIT 100
Results:
dma_name,total_score
Gainesville FL,
Quincy IL-Hannibal MO-Keokuk IA,
Victoria TX,
Ottumwa IA-Kirksville MO,
Dothan AL,
Meridian MS,
Columbia-Jefferson City MO,
Zanesville OH,
Alpena MI,
St. Joseph MO,
Fairbanks AK,
Presque Isle ME,
Panama City FL,
Glendive MT,
Bowling Green KY,
Mankato MN,
North Platte NE,
Marquette MI,
Juneau AK,
Parkersburg WV,
Jonesboro AR,
Alexandria LA,
Lima OH,
Chico-Redding CA,71.0
Medford-Klamath Falls OR,69.0
Fresno-Visalia CA,68.0
Eureka CA,63.0
Sacramento-Stockton-Modesto CA,55.0
Monterey-Salinas CA,52.0
Reno NV,47.0
San Francisco-Oakland-San Jose CA,47.0
Santa Barbara-Santa Maria-San Luis Obispo CA,45.0
El Paso TX,45.0
Charlotte NC,44.0
Bakersfield CA,44.0
Bend OR,43.0
Palm Springs CA,42.0
Great Falls MT,42.0
Helena MT,41.0
Eugene OR,39.0
Albuquerque-Santa Fe NM,38.0
Yuma AZ-El Centro CA,37.0
Boise ID,37.0
Honolulu HI,37.0
Bluefield-Beckley-Oak Hill WV,37.0
Casper-Riverton WY,36.0
Greenwood-Greenville MS,35.0
Columbia SC,35.0
Las Vegas NV,34.0
Anchorage AK,34.0
Spokane WA,34.0
Idaho Falls-Pocatello ID,33.0
Twin Falls ID,33.0
Portland OR,32.0
Tucson (Sierra Vista) AZ,32.0
Hattiesburg-Laurel MS,31.0
Phoenix AZ,30.0
Utica NY,30.0
Memphis TN,29.0
Greensboro-High Point-Winston Salem NC,28.0
Los Angeles CA,28.0
Jackson MS,28.0
Jackson TN,28.0
Norfolk-Portsmouth-Newport News VA,28.0
Watertown NY,27.0
Sioux Falls(Mitchell) SD,27.0
Erie PA,27.0
Shreveport LA,27.0
Baton Rouge LA,26.0
Florence-Myrtle Beach SC,26.0
Richmond-Petersburg VA,26.0
Salt Lake City UT,26.0
San Diego CA,26.0
Lubbock TX,26.0
Grand Junction-Montrose CO,25.0
Charleston SC,25.0
Odessa-Midland TX,25.0
Missoula MT,25.0
Butte-Bozeman MT,25.0
Rochester NY,24.0
Augusta GA,24.0
Raleigh-Durham (Fayetteville) NC,23.0
Minot-Bismarck-Dickinson(Williston) ND,23.0
Yakima-Pasco-Richland-Kennewick WA,23.0
Lake Charles LA,23.0
Austin TX,23.0
Roanoke-Lynchburg VA,22.0
Amarillo TX,22.0
Youngstown OH,22.0
Davenport IA-Rock Island-Moline IL,22.0
Columbus-Tupelo-West Point MS,22.0
San Angelo TX,22.0
Colorado Springs-Pueblo CO,21.0
Dayton OH,21.0
Lafayette LA,21.0
Salisbury MD,21.0
Atlanta GA,21.0
Elmira (Corning) NY,21.0
Wilkes Barre-Scranton PA,20.0
Harlingen-Weslaco-Brownsville-McAllen TX,20.0

2025-01-24 06:50:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:50:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:50:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:50:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:50:44 - snowflake.connector.connection - INFO - closed
2025-01-24 06:50:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:50:44 - root - INFO - SQL:
-- Query 8: Get counts of distinct terms per DMA in TOP_TERMS for one year ago
SELECT "dma_name", COUNT(DISTINCT "term") AS "term_count"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_TERMS
WHERE "week" = '2022-10-09'
GROUP BY "dma_name"
ORDER BY "term_count" DESC
LIMIT 100
Results:
dma_name,term_count
Knoxville TN,660
Springfield-Holyoke MA,660
Ottumwa IA-Kirksville MO,660
Traverse City-Cadillac MI,660
Lubbock TX,660
Bend OR,660
Johnstown-Altoona-State College PA,660
Lafayette IN,660
Grand Rapids-Kalamazoo-Battle Creek MI,660
Fargo-Valley City ND,660
Seattle-Tacoma WA,660
Topeka KS,660
Presque Isle ME,660
Portland-Auburn ME,660
Utica NY,660
Cheyenne WY-Scottsbluff NE,660
San Francisco-Oakland-San Jose CA,660
Mankato MN,660
Cleveland-Akron (Canton) OH,660
Nashville TN,660
Fresno-Visalia CA,660
El Paso TX,660
Elmira (Corning) NY,660
Mobile AL-Pensacola (Ft. Walton Beach) FL,660
Huntsville-Decatur (Florence) AL,660
Columbia SC,660
Rockford IL,660
Los Angeles CA,660
Champaign & Springfield-Decatur IL,660
Laredo TX,660
Kansas City MO,660
Greenville-Spartanburg-Asheville-Anderson,660
Milwaukee WI,660
Houston TX,660
Portland OR,660
Evansville IN,660
Casper-Riverton WY,660
Bowling Green KY,660
Syracuse NY,660
Greenwood-Greenville MS,660
Butte-Bozeman MT,660
Phoenix AZ,660
Springfield MO,660
Meridian MS,660
Billings MT,660
Peoria-Bloomington IL,660
La Crosse-Eau Claire WI,660
Toledo OH,660
Hattiesburg-Laurel MS,660
Burlington VT-Plattsburgh NY,660
Joplin MO-Pittsburg KS,660
Juneau AK,660
Tucson (Sierra Vista) AZ,660
Bluefield-Beckley-Oak Hill WV,660
South Bend-Elkhart IN,660
Chattanooga TN,660
Louisville KY,660
Pittsburgh PA,660
Las Vegas NV,660
Washington DC (Hagerstown MD),660
Yuma AZ-El Centro CA,660
Rochester-Mason City-Austin IA,660
Sioux Falls(Mitchell) SD,660
Tallahassee FL-Thomasville GA,660
Tampa-St. Petersburg (Sarasota) FL,660
Great Falls MT,660
San Antonio TX,660
Honolulu HI,660
Roanoke-Lynchburg VA,660
Jacksonville FL,660
Ft. Wayne IN,660
New York NY,660
Flint-Saginaw-Bay City MI,660
Idaho Falls-Pocatello ID,660
Monterey-Salinas CA,660
Eureka CA,660
Madison WI,660
Columbus-Tupelo-West Point MS,660
Youngstown OH,660
Wausau-Rhinelander WI,660
Columbus OH,660
Quincy IL-Hannibal MO-Keokuk IA,660
San Angelo TX,660
Marquette MI,660
Helena MT,660
Indianapolis IN,660
Macon GA,660
Santa Barbara-Santa Maria-San Luis Obispo CA,660
Glendive MT,660
Reno NV,660
Terre Haute IN,660
Green Bay-Appleton WI,660
Sioux City IA,660
Baltimore MD,660
Philadelphia PA,660
Paducah KY-Cape Girardeau MO-Harrisburg-Mount Vernon IL,660
Wheeling WV-Steubenville OH,660
Alpena MI,660
Detroit MI,660
Harrisonburg VA,660

2025-01-24 06:50:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:50:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:50:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:50:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:50:46 - snowflake.connector.connection - INFO - closed
2025-01-24 06:50:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:50:46 - root - INFO - SQL:
-- Query 9: Calculate average search score per DMA in TOP_TERMS for one year ago
SELECT "dma_name", AVG("score") AS "average_score"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_TERMS
WHERE "week" = '2022-10-09'
GROUP BY "dma_name"
ORDER BY "average_score" DESC
LIMIT 100
Results:
dma_name,average_score
Glendive MT,66.500000
North Platte NE,58.700000
Alpena MI,53.000000
Helena MT,48.700000
Ottumwa IA-Kirksville MO,46.860465
Juneau AK,45.900000
Meridian MS,45.557692
Presque Isle ME,43.222222
Jonesboro AR,41.736842
Greenwood-Greenville MS,40.868852
Zanesville OH,40.810811
Fairbanks AK,40.195652
Bowling Green KY,39.434783
Great Falls MT,38.757576
Utica NY,38.535088
Mankato MN,38.245283
Elmira (Corning) NY,37.920000
Watertown NY,37.168317
Binghamton NY,37.157025
Jackson TN,37.093750
Dothan AL,36.677083
Lima OH,36.515625
Harrisonburg VA,36.283186
Erie PA,36.281690
Victoria TX,35.535714
Lafayette IN,35.506173
Biloxi-Gulfport MS,35.417910
Grand Junction-Montrose CO,35.101266
Cheyenne WY-Scottsbluff NE,35.016393
San Angelo TX,34.388889
St. Joseph MO,34.384615
Wilmington NC,34.331395
Casper-Riverton WY,34.309524
Clarksburg-Weston WV,34.219512
Bluefield-Beckley-Oak Hill WV,34.164835
Salisbury MD,33.907407
Parkersburg WV,33.826923
Bend OR,33.821782
Hattiesburg-Laurel MS,33.519608
Abilene-Sweetwater TX,33.500000
Albany GA,33.460177
Laredo TX,33.310345
Gainesville FL,33.224242
Rochester-Mason City-Austin IA,33.178082
Sioux City IA,33.146154
Santa Barbara-Santa Maria-San Luis Obispo CA,33.128866
Panama City FL,33.006452
Florence-Myrtle Beach SC,33.004762
Eureka CA,33.000000
Terre Haute IN,32.802083
Anchorage AK,32.783582
Rapid City SD,32.719101
Lubbock TX,32.691358
Palm Springs CA,32.644295
Montgomery-Selma AL,32.603659
Twin Falls ID,32.582278
Evansville IN,32.493750
Bangor ME,32.351351
Alexandria LA,32.343284
Augusta GA,32.324176
Tri-Cities TN-VA,32.306358
Knoxville TN,32.261224
Macon GA,32.085366
Columbus-Tupelo-West Point MS,32.057377
Johnstown-Altoona-State College PA,32.052910
Columbus GA,32.034286
Minot-Bismarck-Dickinson(Williston) ND,31.976000
Beaumont-Port Arthur TX,31.932331
Wichita Falls TX & Lawton OK,31.866071
Roanoke-Lynchburg VA,31.865801
Butte-Bozeman MT,31.794393
Memphis TN,31.761134
Wheeling WV-Steubenville OH,31.760000
Sherman-Ada OK,31.640777
Amarillo TX,31.524476
Peoria-Bloomington IL,31.496855
Quincy IL-Hannibal MO-Keokuk IA,31.430380
Ft. Wayne IN,31.417989
Rockford IL,31.411348
Jackson MS,31.353261
Baton Rouge LA,31.312500
Wilkes Barre-Scranton PA,31.309013
Lake Charles LA,31.190476
Burlington VT-Plattsburgh NY,31.158416
Medford-Klamath Falls OR,31.148936
Sioux Falls(Mitchell) SD,31.084270
Savannah GA,31.056769
Yuma AZ-El Centro CA,31.017241
Reno NV,31.015873
Missoula MT,31.000000
Lincoln & Hastings-Kearney NE,30.963351
Charleston SC,30.957265
Odessa-Midland TX,30.944828
Tulsa OK,30.723684
Cedar Rapids-Waterloo-Iowa City & Dubuque IA,30.721154
Monroe LA-El Dorado AR,30.666667
Greensboro-High Point-Winston Salem NC,30.609195
Colorado Springs-Pueblo CO,30.603687
Chattanooga TN,30.584906
Tyler-Longview(Lufkin & Nacogdoches) TX,30.578947

2025-01-24 06:50:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:50:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:50:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:50:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:50:47 - snowflake.connector.connection - INFO - closed
2025-01-24 06:50:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:50:48 - root - INFO - SQL:
-- Query 10: List terms with the highest percent gain one year ago
SELECT "term", "percent_gain"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_RISING_TERMS
WHERE "week" = '2022-10-09'
ORDER BY "percent_gain" DESC
LIMIT 100
Results:
term,percent_gain
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850

2025-01-24 06:50:48 - root - INFO - itercount: 0
2025-01-24 06:50:48 - root - INFO - Database Name: GOOGLE_TRENDS
Schema Name: GOOGLE_TRENDS
DDL describes table information.
,0
table_name,TOP_TERMS
description,
DDL,"create or replace TABLE TOP_TERMS (
	""dma_name"" VARCHAR(16777216),
	""dma_id"" NUMBER(38,0),
	""term"" VARCHAR(16777216),
	""week"" DATE,
	""score"" NUMBER(38,0),
	""rank"" NUMBER(38,0),
	""refresh_date"" DATE
);"

,1
table_name,TOP_RISING_TERMS
description,
DDL,"create or replace TABLE TOP_RISING_TERMS (
	""dma_id"" NUMBER(38,0),
	""term"" VARCHAR(16777216),
	""week"" DATE,
	""score"" NUMBER(38,0),
	""rank"" NUMBER(38,0),
	""percent_gain"" NUMBER(38,0),
	""refresh_date"" DATE,
	""dma_name"" VARCHAR(16777216)
);"

,2
table_name,INTERNATIONAL_TOP_RISING_TERMS
description,
DDL,"create or replace TABLE INTERNATIONAL_TOP_RISING_TERMS (
	""percent_gain"" NUMBER(38,0),
	""region_name"" VARCHAR(16777216),
	""term"" VARCHAR(16777216),
	""week"" DATE,
	""score"" NUMBER(38,0),
	""refresh_date"" DATE,
	""country_name"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""region_code"" VARCHAR(16777216),
	""rank"" NUMBER(38,0)
);"

,3
table_name,INTERNATIONAL_TOP_TERMS
description,
DDL,"create or replace TABLE INTERNATIONAL_TOP_TERMS (
	""term"" VARCHAR(16777216),
	""refresh_date"" DATE,
	""region_code"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""region_name"" VARCHAR(16777216),
	""week"" DATE,
	""score"" NUMBER(38,0),
	""rank"" NUMBER(38,0),
	""country_name"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'GOOGLE_TRENDS': {'GOOGLE_TRENDS': ['INTERNATIONAL_TOP_RISING_TERMS', 'INTERNATIONAL_TOP_TERMS', 'TOP_RISING_TERMS', 'TOP_TERMS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

**Table:** `GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_RISING_TERMS`

- **"term"**: To identify the top rising search terms from one year ago.
- **"week"**: To filter records from exactly one year ago.
- **"percent_gain"**: To understand the magnitude of the rise in search interest.
- **"dma_id"**: To identify the Designated Market Areas (DMAs).
- **"dma_name"**: To get the names of the DMAs.
- **Conditions**: `WHERE "week" = [date one year ago]`

**Table:** `GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_TERMS`

- **"term"**: To find search scores for the top rising terms.
- **"week"**: To match the time period from one year ago.
- **"dma_id"**: To aggregate scores per DMA.
- **"dma_name"**: For DMA names in the results.
- **"score"**: To calculate the total search scores.
- **Conditions**:
  - `WHERE "week" = [date one year ago]`
  - `WHERE "term" IN (list of top rising terms from one year ago)`

---

**SQL Queries:**

```sql
-- Query 1: Retrieve distinct weeks available in TOP_RISING_TERMS
SELECT DISTINCT "week"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_RISING_TERMS
LIMIT 100;
```

```sql
-- Query 2: List distinct terms from TOP_RISING_TERMS one year ago
SELECT DISTINCT "term"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_RISING_TERMS
WHERE "week" = '2022-10-01'
LIMIT 100;
```

```sql
-- Query 3: Get top rising terms and their percent gain from one year ago
SELECT "term", "percent_gain"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_RISING_TERMS
WHERE "week" = '2022-10-01'
ORDER BY "percent_gain" DESC
LIMIT 100;
```

```sql
-- Query 4: Retrieve distinct DMA names and IDs from TOP_TERMS
SELECT DISTINCT "dma_name", "dma_id"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_TERMS
LIMIT 100;
```

```sql
-- Query 5: Get search scores per term and DMA from TOP_TERMS for one year ago
SELECT "dma_name", "term", "score"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_TERMS
WHERE "week" = '2022-10-01'
LIMIT 100;
```

```sql
-- Query 6: Find search scores for terms that were top rising one year ago
SELECT t."dma_name", t."term", t."score"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_TERMS t
WHERE t."term" IN (
    SELECT DISTINCT "term"
    FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_RISING_TERMS
    WHERE "week" = '2022-10-01'
)
AND t."week" = '2022-10-01'
LIMIT 100;
```

```sql
-- Query 7: Sum the search scores per DMA for top rising terms from one year ago
SELECT t."dma_name", SUM(t."score") AS "total_score"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_TERMS t
WHERE t."term" IN (
    SELECT DISTINCT "term"
    FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_RISING_TERMS
    WHERE "week" = '2022-10-01'
)
AND t."week" = '2022-10-01'
GROUP BY t."dma_name"
ORDER BY "total_score" DESC
LIMIT 100;
```

```sql
-- Query 8: Get counts of distinct terms per DMA in TOP_TERMS
SELECT "dma_name", COUNT(DISTINCT "term") AS "term_count"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_TERMS
GROUP BY "dma_name"
ORDER BY "term_count" DESC
LIMIT 100;
```

```sql
-- Query 9: Calculate average search score per DMA in TOP_TERMS
SELECT "dma_name", AVG("score") AS "average_score"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_TERMS
GROUP BY "dma_name"
ORDER BY "average_score" DESC
LIMIT 100;
```

```sql
-- Query 10: List terms with the highest percent gain one year ago
SELECT "term", "percent_gain"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_RISING_TERMS
WHERE "week" = '2022-10-01'
ORDER BY "percent_gain" DESC
LIMIT 100;
```

---

These queries progressively explore the necessary data to understand which DMA had the highest search scores for the terms that were top rising one year ago. By examining the weeks available, identifying the relevant terms and DMAs, and calculating the total search scores, we can gather insights needed to address the task.Query:
-- Query 1: Retrieve distinct weeks available in TOP_RISING_TERMS
SELECT DISTINCT "week"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_RISING_TERMS
LIMIT 100;
Answer:
week
2024-05-19
2021-05-30
2020-10-11
2019-09-08
2023-04-30
2022-09-04
2021-06-13
2022-05-15
2023-06-25
2023-01-01
2023-12-17
2019-11-24
2023-05-28
2024-08-11
2021-03-14
2020-10-25
2023-07-02
2019-12-08
2022-03-20
2019-11-17
2022-08-21
2020-05-24
2022-11-13
2024-09-15
2021-08-01
2020-01-26
2023-12-03
2022-04-10
2019-12-22
2024-10-06
2020-04-19
2020-11-29
2023-10-22
2021-11-21
2022-06-12
2022-09-25
2023-07-30
2020-06-28
2020-04-12
2020-07-05
2023-03-26
2019-12-29
2022-06-05
2023-01-15
2024-02-11
2024-01-14
2024-07-28
2019-10-20
2020-08-16
2024-05-26
2023-09-24
2024-04-14
2021-02-21
2021-10-17
2021-04-25
2020-07-12
2020-07-26
2022-04-17
2020-08-09
2020-02-16
2020-10-18
2021-02-07
2023-02-26
2022-12-18
2022-10-09
2021-01-03
2023-10-15
2019-09-01
2023-11-26
2020-02-02
2024-05-12
2022-02-20
2019-12-01
2024-06-09
2024-01-28
2021-05-16
2020-05-03
2021-12-05
2022-07-17
2023-07-16
2023-01-29
2023-09-10
2020-03-15
2020-03-08
2022-11-20
2023-06-11
2021-08-08
2024-06-23
2024-06-30
2021-10-31
2021-03-07
2022-04-03
2022-12-25
2023-04-09
2021-09-12
2020-08-30
2021-07-25
2023-08-06
2024-03-03
2020-02-23
Query:
SELECT t."dma_name", SUM(t."score") AS "total_score"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_TERMS t
WHERE t."term" IN (
    SELECT DISTINCT "term"
    FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_RISING_TERMS
    WHERE "week" = '2022-10-09'
)
AND t."week" = '2022-10-09'
GROUP BY t."dma_name"
ORDER BY "total_score" DESC
LIMIT 1;
Answer:
dma_name,total_score
Ottumwa IA-Kirksville MO,
Query:
-- Query 3: Get top rising terms and their percent gain from one year ago
SELECT "term", "percent_gain"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_RISING_TERMS
WHERE "week" = '2022-10-09'
ORDER BY "percent_gain" DESC
LIMIT 100
Answer:
term,percent_gain
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
Query:
-- Query 4: Retrieve distinct DMA names and IDs from TOP_TERMS
SELECT DISTINCT "dma_name", "dma_id"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_TERMS
LIMIT 100
Answer:
dma_name,dma_id
Columbus-Tupelo-West Point MS,673
Albany GA,525
Madison WI,669
Clarksburg-Weston WV,598
Reno NV,811
Ottumwa IA-Kirksville MO,631
Casper-Riverton WY,767
Traverse City-Cadillac MI,540
Joplin MO-Pittsburg KS,603
Utica NY,526
Boston MA-Manchester NH,506
Colorado Springs-Pueblo CO,752
Lafayette IN,582
Topeka KS,605
Lake Charles LA,643
Springfield-Holyoke MA,543
Sioux Falls(Mitchell) SD,725
Minot-Bismarck-Dickinson(Williston) ND,687
Great Falls MT,755
Salt Lake City UT,770
Davenport IA-Rock Island-Moline IL,682
Rochester NY,538
Wilmington NC,550
Beaumont-Port Arthur TX,692
Bend OR,821
Indianapolis IN,527
Columbus GA,522
Victoria TX,626
South Bend-Elkhart IN,588
Cincinnati OH,515
Tulsa OK,671
Chico-Redding CA,868
Greenville-Spartanburg-Asheville-Anderson,567
Monterey-Salinas CA,828
Monroe LA-El Dorado AR,628
Austin TX,635
Jacksonville FL,561
Philadelphia PA,504
Ft. Myers-Naples FL,571
Kansas City MO,616
Syracuse NY,555
New Orleans LA,622
Baltimore MD,512
Glendive MT,798
Elmira (Corning) NY,565
Presque Isle ME,552
Flint-Saginaw-Bay City MI,513
Wheeling WV-Steubenville OH,554
Mankato MN,737
Boise ID,757
Rochester-Mason City-Austin IA,611
Baton Rouge LA,716
Toledo OH,547
La Crosse-Eau Claire WI,702
Portland OR,820
Washington DC (Hagerstown MD),511
Lincoln & Hastings-Kearney NE,722
Greensboro-High Point-Winston Salem NC,518
Wichita Falls TX & Lawton OK,627
Seattle-Tacoma WA,819
Johnstown-Altoona-State College PA,574
Oklahoma City OK,650
Lansing MI,551
Fresno-Visalia CA,866
Charleston-Huntington WV,564
Richmond-Petersburg VA,556
Phoenix AZ,753
Burlington VT-Plattsburgh NY,523
Panama City FL,656
Roanoke-Lynchburg VA,573
Hartford & New Haven CT,533
Hattiesburg-Laurel MS,710
Youngstown OH,536
Greenville-New Bern-Washington NC,545
Lubbock TX,651
Bluefield-Beckley-Oak Hill WV,559
Abilene-Sweetwater TX,662
Macon GA,503
St. Louis MO,609
Omaha NE,652
Raleigh-Durham (Fayetteville) NC,560
Eugene OR,801
Juneau AK,747
Marquette MI,553
Fairbanks AK,745
Jackson TN,639
Missoula MT,762
Bangor ME,537
Norfolk-Portsmouth-Newport News VA,544
Des Moines-Ames IA,679
Minneapolis-St. Paul MN,613
Memphis TN,640
Tallahassee FL-Thomasville GA,530
Louisville KY,529
Honolulu HI,744
Evansville IN,649
Grand Junction-Montrose CO,773
Denver CO,751
El Paso TX,765
Dallas-Ft. Worth TX,623
Query:
-- Query 5: Get search scores per term and DMA from TOP_TERMS for one year ago
SELECT "dma_name", "term", "score"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_TERMS
WHERE "week" = '2022-10-09'
LIMIT 100
Answer:
dma_name,term,score
Portland-Auburn ME,49ers,9.0
Charlotte NC,49ers,22.0
Wilmington NC,49ers,7.0
Dothan AL,49ers,
Portland-Auburn ME,Brandon McManus,
Greenville-New Bern-Washington NC,Brandon McManus,
Dothan AL,Brandon McManus,
Baltimore MD,Brandon McManus,
Marquette MI,Brandon McManus,
Evansville IN,Brandon McManus,
Portland-Auburn ME,Aurora forecast,
Charlotte NC,Aurora forecast,
Wilmington NC,Aurora forecast,
Chattanooga TN,Aurora forecast,
Dothan AL,Aurora forecast,
Baltimore MD,Aurora forecast,
Rapid City SD,Aurora forecast,
Kansas City MO,Tom Brady,18.0
Charlotte NC,Andy Beshear,
Greenville-New Bern-Washington NC,Andy Beshear,
Wilmington NC,Andy Beshear,
Chattanooga TN,Andy Beshear,
Chattanooga TN,Aidan Hutchinson,
Portland-Auburn ME,Bad boys,
Portland-Auburn ME,ABC news,12.0
Charlotte NC,ABC news,11.0
Greenville-New Bern-Washington NC,Aurora forecast,
Atlanta GA,Aurora forecast,
Marquette MI,Aurora forecast,
Grand Rapids-Kalamazoo-Battle Creek MI,Aurora forecast,
Wilkes Barre-Scranton PA,Aurora forecast,
Evansville IN,Aurora forecast,
Philadelphia PA,Aurora forecast,
Las Vegas NV,Brandon McManus,
Columbus-Tupelo-West Point MS,Brandon McManus,
Juneau AK,Brandon McManus,
Seattle-Tacoma WA,Brandon McManus,
Burlington VT-Plattsburgh NY,Brandon McManus,
Baltimore MD,Aidan Hutchinson,
Atlanta GA,Aidan Hutchinson,
Marquette MI,Aidan Hutchinson,
Grand Rapids-Kalamazoo-Battle Creek MI,Aidan Hutchinson,
Rapid City SD,Aidan Hutchinson,
Buffalo NY,Aurora forecast,
Ft. Myers-Naples FL,Aurora forecast,
Lake Charles LA,Aurora forecast,
Huntsville-Decatur (Florence) AL,Aurora forecast,
Seattle-Tacoma WA,Aurora forecast,1.0
Orlando-Daytona Beach-Melbourne FL,Aurora forecast,
Columbia-Jefferson City MO,Aurora forecast,
Palm Springs CA,Aurora forecast,
Charleston SC,Tom Brady,15.0
Butte-Bozeman MT,Tom Brady,18.0
Providence-New Bedford MA,Tom Brady,12.0
Atlanta GA,Andy Beshear,
Marquette MI,Andy Beshear,
Grand Rapids-Kalamazoo-Battle Creek MI,Andy Beshear,
Wilkes Barre-Scranton PA,Andy Beshear,
Rapid City SD,Andy Beshear,
Buffalo NY,Aidan Hutchinson,
Ft. Myers-Naples FL,Aidan Hutchinson,
Lake Charles LA,Aidan Hutchinson,
Las Vegas NV,Aidan Hutchinson,
Huntsville-Decatur (Florence) AL,Aidan Hutchinson,
Seattle-Tacoma WA,Aidan Hutchinson,
Cleveland-Akron (Canton) OH,Aidan Hutchinson,
Palm Springs CA,Aidan Hutchinson,
Greenville-New Bern-Washington NC,Bad boys,
Chattanooga TN,Bad boys,
Dothan AL,Bad boys,
Portland-Auburn ME,Ana de Armas,
Portland-Auburn ME,49ers vs Seahawks,
Charlotte NC,49ers vs Seahawks,
Greenville-New Bern-Washington NC,49ers vs Seahawks,
Marquette MI,49ers vs Seahawks,
Wilkes Barre-Scranton PA,49ers vs Seahawks,
Rapid City SD,49ers vs Seahawks,
Philadelphia PA,49ers vs Seahawks,
Ft. Wayne IN,Tom Brady,15.0
Memphis TN,Tom Brady,15.0
Helena MT,Tom Brady,
St. Louis MO,Tom Brady,11.0
Albuquerque-Santa Fe NM,Brandon McManus,
Bend OR,Brandon McManus,
Little Rock-Pine Bluff AR,Brandon McManus,
Kansas City MO,Brandon McManus,
Providence-New Bedford MA,Brandon McManus,
Amarillo TX,Brandon McManus,
Grand Junction-Montrose CO,Brandon McManus,
Richmond-Petersburg VA,Brandon McManus,
Johnstown-Altoona-State College PA,Brandon McManus,
St. Louis MO,Brandon McManus,
Laredo TX,Brandon McManus,
Tallahassee FL-Thomasville GA,Brandon McManus,
Springfield-Holyoke MA,Brandon McManus,
Greenville-New Bern-Washington NC,ABC news,17.0
Chattanooga TN,ABC news,16.0
Albuquerque-Santa Fe NM,Aidan Hutchinson,
Wausau-Rhinelander WI,Aidan Hutchinson,
Kansas City MO,Aidan Hutchinson,
Query:
-- Query 6: Find search scores for terms that were top rising one year ago
SELECT t."dma_name", t."term", t."score"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_TERMS t
WHERE t."term" IN (
    SELECT DISTINCT "term"
    FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_RISING_TERMS
    WHERE "week" = '2022-10-09'
)
AND t."week" = '2022-10-09'
LIMIT 100
Answer:
dma_name,term,score
Albany GA,49ers,9.0
Nashville TN,49ers,9.0
Colorado Springs-Pueblo CO,49ers,10.0
Wichita Falls TX & Lawton OK,49ers,7.0
Sioux City IA,49ers,10.0
St. Louis MO,49ers,6.0
Charlottesville VA,49ers,
Abilene-Sweetwater TX,49ers,9.0
Milwaukee WI,49ers,6.0
Spokane WA,49ers,17.0
Charleston-Huntington WV,49ers,8.0
Columbus-Tupelo-West Point MS,49ers,12.0
Parkersburg WV,49ers,
Lafayette LA,49ers,10.0
Huntsville-Decatur (Florence) AL,49ers,4.0
Sacramento-Stockton-Modesto CA,49ers,27.0
Ft. Smith-Fayetteville-Springdale-Rogers AR,49ers,7.0
Atlanta GA,49ers,11.0
Evansville IN,49ers,7.0
Columbus GA,49ers,9.0
Syracuse NY,49ers,9.0
Macon GA,49ers,9.0
Tulsa OK,49ers,8.0
Alpena MI,49ers,
Providence-New Bedford MA,49ers,9.0
Phoenix AZ,49ers,15.0
Greenwood-Greenville MS,49ers,19.0
Bakersfield CA,49ers,22.0
Greenwood-Greenville MS,49ers,16.0
Columbus OH,49ers,6.0
Pittsburgh PA,49ers,5.0
Tallahassee FL-Thomasville GA,49ers,6.0
Victoria TX,49ers,
San Diego CA,49ers,13.0
Memphis TN,49ers,15.0
Cedar Rapids-Waterloo-Iowa City & Dubuque IA,49ers,10.0
Springfield MO,49ers,4.0
Toledo OH,49ers,9.0
Boston MA-Manchester NH,49ers,7.0
Greenville-New Bern-Washington NC,49ers,9.0
Wheeling WV-Steubenville OH,49ers,8.0
Bend OR,49ers,21.0
Savannah GA,49ers,8.0
Albany-Schenectady-Troy NY,49ers,10.0
St. Louis MO,49ers,6.0
Anchorage AK,49ers,15.0
Bowling Green KY,49ers,
Utica NY,49ers,16.0
Rochester-Mason City-Austin IA,49ers,4.0
Jackson TN,49ers,16.0
Dayton OH,49ers,11.0
Mobile AL-Pensacola (Ft. Walton Beach) FL,49ers,8.0
Jacksonville FL,49ers,7.0
Yuma AZ-El Centro CA,49ers,19.0
Chico-Redding CA,49ers,35.0
Monroe LA-El Dorado AR,49ers,9.0
Columbia SC,49ers,17.0
Harrisonburg VA,49ers,7.0
Charlottesville VA,49ers,4.0
Dothan AL,49ers,
Philadelphia PA,49ers,7.0
Sherman-Ada OK,49ers,8.0
Alexandria LA,49ers,
Victoria TX,49ers,
Lafayette IN,49ers,
Monroe LA-El Dorado AR,49ers,5.0
Roanoke-Lynchburg VA,49ers,11.0
Tucson (Sierra Vista) AZ,49ers,16.0
Cedar Rapids-Waterloo-Iowa City & Dubuque IA,49ers,10.0
Terre Haute IN,49ers,7.0
Harlingen-Weslaco-Brownsville-McAllen TX,49ers,10.0
Waco-Temple-Bryan TX,49ers,10.0
West Palm Beach-Ft. Pierce FL,49ers,9.0
Wichita Falls TX & Lawton OK,49ers,9.0
Chicago IL,49ers,6.0
Ft. Myers-Naples FL,49ers,7.0
Phoenix AZ,49ers,15.0
Lima OH,49ers,
Jonesboro AR,49ers,
Minneapolis-St. Paul MN,49ers,4.0
Chattanooga TN,49ers,8.0
Yuma AZ-El Centro CA,49ers,18.0
El Paso TX,49ers,23.0
Wilkes Barre-Scranton PA,49ers,10.0
La Crosse-Eau Claire WI,49ers,5.0
Indianapolis IN,49ers,6.0
Paducah KY-Cape Girardeau MO-Harrisburg-Mount Vernon IL,49ers,4.0
Grand Junction-Montrose CO,49ers,14.0
Glendive MT,49ers,
Corpus Christi TX,49ers,9.0
Tucson (Sierra Vista) AZ,49ers,16.0
Youngstown OH,49ers,10.0
Joplin MO-Pittsburg KS,49ers,4.0
Wichita-Hutchinson KS,49ers,7.0
Detroit MI,49ers,3.0
Tyler-Longview(Lufkin & Nacogdoches) TX,49ers,8.0
Providence-New Bedford MA,49ers,9.0
Tyler-Longview(Lufkin & Nacogdoches) TX,49ers,8.0
Fargo-Valley City ND,49ers,9.0
San Francisco-Oakland-San Jose CA,49ers,24.0
Query:
-- Query 7: Sum the search scores per DMA for top rising terms from one year ago
SELECT t."dma_name", SUM(t."score") AS "total_score"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_TERMS t
WHERE t."term" IN (
    SELECT DISTINCT "term"
    FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_RISING_TERMS
    WHERE "week" = '2022-10-09'
)
AND t."week" = '2022-10-09'
GROUP BY t."dma_name"
ORDER BY "total_score" DESC
LIMIT 100
Answer:
dma_name,total_score
Gainesville FL,
Quincy IL-Hannibal MO-Keokuk IA,
Victoria TX,
Ottumwa IA-Kirksville MO,
Dothan AL,
Meridian MS,
Columbia-Jefferson City MO,
Zanesville OH,
Alpena MI,
St. Joseph MO,
Fairbanks AK,
Presque Isle ME,
Panama City FL,
Glendive MT,
Bowling Green KY,
Mankato MN,
North Platte NE,
Marquette MI,
Juneau AK,
Parkersburg WV,
Jonesboro AR,
Alexandria LA,
Lima OH,
Chico-Redding CA,71.0
Medford-Klamath Falls OR,69.0
Fresno-Visalia CA,68.0
Eureka CA,63.0
Sacramento-Stockton-Modesto CA,55.0
Monterey-Salinas CA,52.0
Reno NV,47.0
San Francisco-Oakland-San Jose CA,47.0
Santa Barbara-Santa Maria-San Luis Obispo CA,45.0
El Paso TX,45.0
Charlotte NC,44.0
Bakersfield CA,44.0
Bend OR,43.0
Palm Springs CA,42.0
Great Falls MT,42.0
Helena MT,41.0
Eugene OR,39.0
Albuquerque-Santa Fe NM,38.0
Yuma AZ-El Centro CA,37.0
Boise ID,37.0
Honolulu HI,37.0
Bluefield-Beckley-Oak Hill WV,37.0
Casper-Riverton WY,36.0
Greenwood-Greenville MS,35.0
Columbia SC,35.0
Las Vegas NV,34.0
Anchorage AK,34.0
Spokane WA,34.0
Idaho Falls-Pocatello ID,33.0
Twin Falls ID,33.0
Portland OR,32.0
Tucson (Sierra Vista) AZ,32.0
Hattiesburg-Laurel MS,31.0
Phoenix AZ,30.0
Utica NY,30.0
Memphis TN,29.0
Greensboro-High Point-Winston Salem NC,28.0
Los Angeles CA,28.0
Jackson MS,28.0
Jackson TN,28.0
Norfolk-Portsmouth-Newport News VA,28.0
Watertown NY,27.0
Sioux Falls(Mitchell) SD,27.0
Erie PA,27.0
Shreveport LA,27.0
Baton Rouge LA,26.0
Florence-Myrtle Beach SC,26.0
Richmond-Petersburg VA,26.0
Salt Lake City UT,26.0
San Diego CA,26.0
Lubbock TX,26.0
Grand Junction-Montrose CO,25.0
Charleston SC,25.0
Odessa-Midland TX,25.0
Missoula MT,25.0
Butte-Bozeman MT,25.0
Rochester NY,24.0
Augusta GA,24.0
Raleigh-Durham (Fayetteville) NC,23.0
Minot-Bismarck-Dickinson(Williston) ND,23.0
Yakima-Pasco-Richland-Kennewick WA,23.0
Lake Charles LA,23.0
Austin TX,23.0
Roanoke-Lynchburg VA,22.0
Amarillo TX,22.0
Youngstown OH,22.0
Davenport IA-Rock Island-Moline IL,22.0
Columbus-Tupelo-West Point MS,22.0
San Angelo TX,22.0
Colorado Springs-Pueblo CO,21.0
Dayton OH,21.0
Lafayette LA,21.0
Salisbury MD,21.0
Atlanta GA,21.0
Elmira (Corning) NY,21.0
Wilkes Barre-Scranton PA,20.0
Harlingen-Weslaco-Brownsville-McAllen TX,20.0
Query:
-- Query 8: Get counts of distinct terms per DMA in TOP_TERMS for one year ago
SELECT "dma_name", COUNT(DISTINCT "term") AS "term_count"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_TERMS
WHERE "week" = '2022-10-09'
GROUP BY "dma_name"
ORDER BY "term_count" DESC
LIMIT 100
Answer:
dma_name,term_count
Knoxville TN,660
Springfield-Holyoke MA,660
Ottumwa IA-Kirksville MO,660
Traverse City-Cadillac MI,660
Lubbock TX,660
Bend OR,660
Johnstown-Altoona-State College PA,660
Lafayette IN,660
Grand Rapids-Kalamazoo-Battle Creek MI,660
Fargo-Valley City ND,660
Seattle-Tacoma WA,660
Topeka KS,660
Presque Isle ME,660
Portland-Auburn ME,660
Utica NY,660
Cheyenne WY-Scottsbluff NE,660
San Francisco-Oakland-San Jose CA,660
Mankato MN,660
Cleveland-Akron (Canton) OH,660
Nashville TN,660
Fresno-Visalia CA,660
El Paso TX,660
Elmira (Corning) NY,660
Mobile AL-Pensacola (Ft. Walton Beach) FL,660
Huntsville-Decatur (Florence) AL,660
Columbia SC,660
Rockford IL,660
Los Angeles CA,660
Champaign & Springfield-Decatur IL,660
Laredo TX,660
Kansas City MO,660
Greenville-Spartanburg-Asheville-Anderson,660
Milwaukee WI,660
Houston TX,660
Portland OR,660
Evansville IN,660
Casper-Riverton WY,660
Bowling Green KY,660
Syracuse NY,660
Greenwood-Greenville MS,660
Butte-Bozeman MT,660
Phoenix AZ,660
Springfield MO,660
Meridian MS,660
Billings MT,660
Peoria-Bloomington IL,660
La Crosse-Eau Claire WI,660
Toledo OH,660
Hattiesburg-Laurel MS,660
Burlington VT-Plattsburgh NY,660
Joplin MO-Pittsburg KS,660
Juneau AK,660
Tucson (Sierra Vista) AZ,660
Bluefield-Beckley-Oak Hill WV,660
South Bend-Elkhart IN,660
Chattanooga TN,660
Louisville KY,660
Pittsburgh PA,660
Las Vegas NV,660
Washington DC (Hagerstown MD),660
Yuma AZ-El Centro CA,660
Rochester-Mason City-Austin IA,660
Sioux Falls(Mitchell) SD,660
Tallahassee FL-Thomasville GA,660
Tampa-St. Petersburg (Sarasota) FL,660
Great Falls MT,660
San Antonio TX,660
Honolulu HI,660
Roanoke-Lynchburg VA,660
Jacksonville FL,660
Ft. Wayne IN,660
New York NY,660
Flint-Saginaw-Bay City MI,660
Idaho Falls-Pocatello ID,660
Monterey-Salinas CA,660
Eureka CA,660
Madison WI,660
Columbus-Tupelo-West Point MS,660
Youngstown OH,660
Wausau-Rhinelander WI,660
Columbus OH,660
Quincy IL-Hannibal MO-Keokuk IA,660
San Angelo TX,660
Marquette MI,660
Helena MT,660
Indianapolis IN,660
Macon GA,660
Santa Barbara-Santa Maria-San Luis Obispo CA,660
Glendive MT,660
Reno NV,660
Terre Haute IN,660
Green Bay-Appleton WI,660
Sioux City IA,660
Baltimore MD,660
Philadelphia PA,660
Paducah KY-Cape Girardeau MO-Harrisburg-Mount Vernon IL,660
Wheeling WV-Steubenville OH,660
Alpena MI,660
Detroit MI,660
Harrisonburg VA,660
Query:
-- Query 9: Calculate average search score per DMA in TOP_TERMS for one year ago
SELECT "dma_name", AVG("score") AS "average_score"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_TERMS
WHERE "week" = '2022-10-09'
GROUP BY "dma_name"
ORDER BY "average_score" DESC
LIMIT 100
Answer:
dma_name,average_score
Glendive MT,66.500000
North Platte NE,58.700000
Alpena MI,53.000000
Helena MT,48.700000
Ottumwa IA-Kirksville MO,46.860465
Juneau AK,45.900000
Meridian MS,45.557692
Presque Isle ME,43.222222
Jonesboro AR,41.736842
Greenwood-Greenville MS,40.868852
Zanesville OH,40.810811
Fairbanks AK,40.195652
Bowling Green KY,39.434783
Great Falls MT,38.757576
Utica NY,38.535088
Mankato MN,38.245283
Elmira (Corning) NY,37.920000
Watertown NY,37.168317
Binghamton NY,37.157025
Jackson TN,37.093750
Dothan AL,36.677083
Lima OH,36.515625
Harrisonburg VA,36.283186
Erie PA,36.281690
Victoria TX,35.535714
Lafayette IN,35.506173
Biloxi-Gulfport MS,35.417910
Grand Junction-Montrose CO,35.101266
Cheyenne WY-Scottsbluff NE,35.016393
San Angelo TX,34.388889
St. Joseph MO,34.384615
Wilmington NC,34.331395
Casper-Riverton WY,34.309524
Clarksburg-Weston WV,34.219512
Bluefield-Beckley-Oak Hill WV,34.164835
Salisbury MD,33.907407
Parkersburg WV,33.826923
Bend OR,33.821782
Hattiesburg-Laurel MS,33.519608
Abilene-Sweetwater TX,33.500000
Albany GA,33.460177
Laredo TX,33.310345
Gainesville FL,33.224242
Rochester-Mason City-Austin IA,33.178082
Sioux City IA,33.146154
Santa Barbara-Santa Maria-San Luis Obispo CA,33.128866
Panama City FL,33.006452
Florence-Myrtle Beach SC,33.004762
Eureka CA,33.000000
Terre Haute IN,32.802083
Anchorage AK,32.783582
Rapid City SD,32.719101
Lubbock TX,32.691358
Palm Springs CA,32.644295
Montgomery-Selma AL,32.603659
Twin Falls ID,32.582278
Evansville IN,32.493750
Bangor ME,32.351351
Alexandria LA,32.343284
Augusta GA,32.324176
Tri-Cities TN-VA,32.306358
Knoxville TN,32.261224
Macon GA,32.085366
Columbus-Tupelo-West Point MS,32.057377
Johnstown-Altoona-State College PA,32.052910
Columbus GA,32.034286
Minot-Bismarck-Dickinson(Williston) ND,31.976000
Beaumont-Port Arthur TX,31.932331
Wichita Falls TX & Lawton OK,31.866071
Roanoke-Lynchburg VA,31.865801
Butte-Bozeman MT,31.794393
Memphis TN,31.761134
Wheeling WV-Steubenville OH,31.760000
Sherman-Ada OK,31.640777
Amarillo TX,31.524476
Peoria-Bloomington IL,31.496855
Quincy IL-Hannibal MO-Keokuk IA,31.430380
Ft. Wayne IN,31.417989
Rockford IL,31.411348
Jackson MS,31.353261
Baton Rouge LA,31.312500
Wilkes Barre-Scranton PA,31.309013
Lake Charles LA,31.190476
Burlington VT-Plattsburgh NY,31.158416
Medford-Klamath Falls OR,31.148936
Sioux Falls(Mitchell) SD,31.084270
Savannah GA,31.056769
Yuma AZ-El Centro CA,31.017241
Reno NV,31.015873
Missoula MT,31.000000
Lincoln & Hastings-Kearney NE,30.963351
Charleston SC,30.957265
Odessa-Midland TX,30.944828
Tulsa OK,30.723684
Cedar Rapids-Waterloo-Iowa City & Dubuque IA,30.721154
Monroe LA-El Dorado AR,30.666667
Greensboro-High Point-Winston Salem NC,30.609195
Colorado Springs-Pueblo CO,30.603687
Chattanooga TN,30.584906
Tyler-Longview(Lufkin & Nacogdoches) TX,30.578947
Query:
-- Query 10: List terms with the highest percent gain one year ago
SELECT "term", "percent_gain"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_RISING_TERMS
WHERE "week" = '2022-10-09'
ORDER BY "percent_gain" DESC
LIMIT 100
Answer:
term,percent_gain
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
emerson romero,44850
End Exploring Related Columns
Task: Identify which DMA had the highest search scores for the terms that were top rising one year ago

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
dma_name,total_search_score
dma_name1:str,score1:int
(Attention: answer in one row)
```

**Explanation:**

The DMA (Designated Market Area) with the highest search scores for the terms that were top rising one year ago is identified by aggregating the search scores of those terms for each DMA. The DMA with the highest total search score across these terms is presented in the result..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'GOOGLE_TRENDS': {'GOOGLE_TRENDS': ['INTERNATIONAL_TOP_RISING_TERMS', 'INTERNATIONAL_TOP_TERMS', 'TOP_RISING_TERMS', 'TOP_TERMS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-24 06:51:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 06:51:02 - root - INFO - ```sql
SELECT t."dma_name", SUM(t."score") AS "total_search_score"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_TERMS t
WHERE t."term" IN (
    SELECT DISTINCT "term"
    FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_RISING_TERMS
    WHERE "week" = '2022-10-09'
)
AND t."week" = '2022-10-09'
GROUP BY t."dma_name"
ORDER BY "total_search_score" DESC NULLS LAST
LIMIT 1;
```
2025-01-24 06:51:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:51:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:51:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:51:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 06:51:03 - snowflake.connector.connection - INFO - closed
2025-01-24 06:51:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:51:04 - root - INFO - itercount: 1
2025-01-24 06:51:04 - root - INFO - 0
2025-01-24 06:51:04 - root - INFO - results: 
dma_name,total_search_score
Chico-Redding CA,71


2025-01-24 06:51:04 - root - INFO - Please check the answer again by reviewing Identify which DMA had the highest search scores for the terms that were top rising one year ago, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
dma_name,total_search_score
dma_name1:str,score1:int
(Attention: answer in one row)
```

**Explanation:**

The DMA (Designated Market Area) with the highest search scores for the terms that were top rising one year ago is identified by aggregating the search scores of those terms for each DMA. The DMA with the highest total search score across these terms is presented in the result. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
dma_name,total_search_score
Chico-Redding CA,71
Current sql:
SELECT t."dma_name", SUM(t."score") AS "total_search_score"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_TERMS t
WHERE t."term" IN (
    SELECT DISTINCT "term"
    FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_RISING_TERMS
    WHERE "week" = '2022-10-09'
)
AND t."week" = '2022-10-09'
GROUP BY t."dma_name"
ORDER BY "total_search_score" DESC NULLS LAST
LIMIT 1;
2025-01-24 06:51:50 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 06:51:50 - root - INFO - ```sql
SELECT t."dma_name", SUM(t."score") AS "total_search_score"
FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_TERMS t
WHERE t."term" IN (
    SELECT DISTINCT "term"
    FROM GOOGLE_TRENDS.GOOGLE_TRENDS.TOP_RISING_TERMS
    WHERE "week" = '2022-10-09'
)
AND t."week" = '2022-10-09'
GROUP BY t."dma_name"
ORDER BY "total_search_score" DESC NULLS LAST
LIMIT 1;
```

```csv
dma_name,total_search_score
Chico-Redding CA:str,71:int
```
2025-01-24 06:51:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:51:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:51:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:51:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 06:51:52 - snowflake.connector.connection - INFO - closed
2025-01-24 06:51:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:51:52 - root - INFO - itercount: 2
2025-01-24 06:51:52 - root - INFO - 0
2025-01-24 06:51:52 - root - INFO - Total iteration counts: 2
