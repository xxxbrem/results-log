2025-01-23 02:05:15 - openai._base_client - INFO - Retrying request to /chat/completions in 0.476261 seconds
2025-01-23 02:07:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 02:07:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:07:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:07:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:07:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 50
2025-01-23 02:07:07 - snowflake.connector.connection - INFO - closed
2025-01-23 02:07:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:07:07 - root - INFO - SQL:
SELECT DISTINCT "plot_inventory_year"
   FROM "USFS_FIA"."USFS_FIA"."PLOT"
   LIMIT 100;
Results:
plot_inventory_year
1997
1998
2011
2014
2009
1995
1994
1999
1989
1982
1992
2004
2005
2016
2018
2013
2012
2020
1984
1996
1991
1987
1977
1970
1990
1968
1975
1976
2007
2002
2008
1993
1980
1974
1981
9999
1986
1988
2006
2000
2017
2015
2019
2010
2003
2001
1985
1972
1983
1978

2025-01-23 02:07:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:07:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:07:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:07:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 02:07:09 - snowflake.connector.connection - INFO - closed
2025-01-23 02:07:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:07:10 - root - INFO - SQL:
SELECT "plot_sequence_number", "plot_inventory_year", "plot_state_code", "plot_state_code_name"
   FROM "USFS_FIA"."USFS_FIA"."PLOT"
   WHERE "plot_inventory_year" IN (2015, 2016, 2017)
   LIMIT 100;
Results:
plot_sequence_number,plot_inventory_year,plot_state_code,plot_state_code_name
304151043489998,2016,19,Iowa
304151457489998,2016,19,Iowa
304151402489998,2016,19,Iowa
304150932489998,2016,19,Iowa
304151601489998,2016,19,Iowa
304150964489998,2016,19,Iowa
304151264489998,2016,19,Iowa
304151257489998,2016,19,Iowa
304150981489998,2016,19,Iowa
304151111489998,2016,19,Iowa
304150769489998,2016,19,Iowa
304151081489998,2016,19,Iowa
304150996489998,2016,19,Iowa
304151223489998,2016,19,Iowa
304151009489998,2016,19,Iowa
304151428489998,2016,19,Iowa
304150966489998,2016,19,Iowa
304151714489998,2016,19,Iowa
304151561489998,2016,19,Iowa
304150956489998,2016,19,Iowa
304151293489998,2016,19,Iowa
304151388489998,2016,19,Iowa
304151565489998,2016,19,Iowa
304151072489998,2016,19,Iowa
304151521489998,2016,19,Iowa
304151095489998,2016,19,Iowa
304150950489998,2016,19,Iowa
304151387489998,2016,19,Iowa
386054421489998,2015,21,Kentucky
386054408489998,2015,21,Kentucky
386054465489998,2015,21,Kentucky
386054459489998,2015,21,Kentucky
386053973489998,2015,21,Kentucky
386054471489998,2015,21,Kentucky
386054200489998,2015,21,Kentucky
386054053489998,2015,21,Kentucky
386054234489998,2015,21,Kentucky
386054433489998,2015,21,Kentucky
386054222489998,2015,21,Kentucky
386054212489998,2015,21,Kentucky
386054437489998,2015,21,Kentucky
386054070489998,2015,21,Kentucky
386054434489998,2015,21,Kentucky
386054179489998,2015,21,Kentucky
386054132489998,2015,21,Kentucky
386054093489998,2015,21,Kentucky
386054350489998,2015,21,Kentucky
386054345489998,2015,21,Kentucky
386054346489998,2015,21,Kentucky
386054422489998,2015,21,Kentucky
386053763489998,2015,21,Kentucky
386054395489998,2015,21,Kentucky
386054455489998,2015,21,Kentucky
386054442489998,2015,21,Kentucky
386054011489998,2015,21,Kentucky
386054207489998,2015,21,Kentucky
386053911489998,2015,21,Kentucky
386054226489998,2015,21,Kentucky
386053762489998,2015,21,Kentucky
386053765489998,2015,21,Kentucky
386053985489998,2015,21,Kentucky
386054467489998,2015,21,Kentucky
386054004489998,2015,21,Kentucky
386054379489998,2015,21,Kentucky
386054477489998,2015,21,Kentucky
386054363489998,2015,21,Kentucky
386054028489998,2015,21,Kentucky
386053786489998,2015,21,Kentucky
386053772489998,2015,21,Kentucky
386053927489998,2015,21,Kentucky
386054343489998,2015,21,Kentucky
386054087489998,2015,21,Kentucky
386054342489998,2015,21,Kentucky
386054384489998,2015,21,Kentucky
386054461489998,2015,21,Kentucky
386053983489998,2015,21,Kentucky
386054319489998,2015,21,Kentucky
386054411489998,2015,21,Kentucky
386054197489998,2015,21,Kentucky
386054449489998,2015,21,Kentucky
386054230489998,2015,21,Kentucky
386054008489998,2015,21,Kentucky
386054001489998,2015,21,Kentucky
386054424489998,2015,21,Kentucky
386054126489998,2015,21,Kentucky
386054215489998,2015,21,Kentucky
306265453489998,2016,36,New York
306265483489998,2016,36,New York
306265391489998,2016,36,New York
306265653489998,2016,36,New York
306265578489998,2016,36,New York
306265346489998,2016,36,New York
305281789489998,2016,36,New York
306265955489998,2016,36,New York
306265441489998,2016,36,New York
306265682489998,2016,36,New York
306265756489998,2016,36,New York
306265392489998,2016,36,New York
306265729489998,2016,36,New York
306265586489998,2016,36,New York

2025-01-23 02:07:10 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:07:10 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:07:10 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:07:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 02:07:11 - snowflake.connector.connection - INFO - closed
2025-01-23 02:07:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:07:12 - root - INFO - SQL:
SELECT "plot_sequence_number", "proportion_basis", "condition_proportion_unadjusted"
   FROM "USFS_FIA"."USFS_FIA"."CONDITION"
   WHERE "inventory_year" IN (2015, 2016, 2017)
   LIMIT 100;
Results:
plot_sequence_number,proportion_basis,condition_proportion_unadjusted
243882539489998,SUBP,0.7372329831123352
473804170489998,SUBP,1.0
40420834010690,SUBP,1.0
40416232010690,SUBP,1.0
40420846010690,SUBP,0.6484389901161194
40420916010690,SUBP,0.7871590256690979
375823541489998,SUBP,1.0
373753093489998,SUBP,0.25
297166923489998,SUBP,1.0
548477642126144,SUBP,1.0
297165454489998,SUBP,1.0
40425224010690,SUBP,0.25
40424740010690,SUBP,1.0
14549421020004,SUBP,1.0
273640965489998,MACR,1.0
345933490489998,MACR,0.20356899499893188
304200046489998,SUBP,0.17712299525737762
251983319489998,SUBP,1.0
373681105489998,SUBP,1.0
346864370489998,MACR,1.0
346864323489998,MACR,0.75
412222539489998,MACR,1.0
412222541489998,MACR,1.0
273642079489998,MACR,0.903007984161377
444202473489998,MACR,1.0
375823166489998,SUBP,1.0
304030413489998,SUBP,1.0
290008836489998,MACR,0.190201997756958
290008725489998,MACR,0.856889009475708
290008194489998,MACR,0.8888540267944336
346864418489998,MACR,0.9024969935417175
444202475489998,MACR,1.0
305230755489998,SUBP,1.0
245012952489998,SUBP,1.0
305230735489998,SUBP,1.0
414839441489998,SUBP,0.1600240021944046
412223119489998,MACR,1.0
273642269489998,MACR,1.0
412223019489998,MACR,0.17835299670696259
290008727489998,MACR,1.0
480976653489998,SUBP,0.25
335445281489998,SUBP,0.75
258657240489998,SUBP,0.25
335445616489998,SUBP,0.75
480977056489998,SUBP,0.4457870125770569
335445190489998,SUBP,0.7512500286102295
335445288489998,SUBP,0.25
353325750489998,SUBP,0.75
443867609489998,SUBP,1.0
289515746489998,SUBP,1.0
289515932489998,SUBP,0.9108930230140686
480976558489998,SUBP,0.25
264160208489998,SUBP,1.0
264160249489998,SUBP,0.75
258657100489998,SUBP,1.0
258657268489998,SUBP,0.75
385729174489998,SUBP,0.050978999584913254
282502210489998,SUBP,0.75
282501930489998,SUBP,1.0
451136198489998,SUBP,0.5
451136276489998,SUBP,0.4592779874801636
448940952489998,SUBP,1.0
289515011489998,SUBP,1.0
374861589489998,SUBP,1.0
372786341489998,SUBP,0.75
373753897489998,SUBP,1.0
231734643020004,SUBP,0.25
282500988489998,SUBP,1.0
443867786489998,SUBP,0.25
351508573489998,SUBP,0.006535000167787075
351508721489998,SUBP,0.75
351508742489998,SUBP,0.25
264160396489998,SUBP,1.0
264160403489998,SUBP,1.0
264160130489998,SUBP,0.5112789869308472
264159873489998,SUBP,0.25
386107196489998,SUBP,0.5
480977035489998,SUBP,0.9446899890899658
480976963489998,SUBP,0.7452430129051208
433034415489998,SUBP,1.0
433032842489998,SUBP,0.75
385729279489998,SUBP,0.75
347395225489998,SUBP,1.0
282501495489998,SUBP,1.0
264160213489998,SUBP,1.0
451134524489998,SUBP,0.4283530116081238
264152886489998,SUBP,0.25
351508428489998,SUBP,0.40249699354171753
480977044489998,SUBP,1.0
335232054489998,SUBP,0.8957149982452393
385729825489998,SUBP,0.5
335445684489998,SUBP,0.3216469883918762
451136774489998,SUBP,0.13332599401474
385729275489998,SUBP,1.0
451136182489998,SUBP,0.75
335231282489998,SUBP,1.0
433033921489998,SUBP,0.75
480976351489998,SUBP,1.0
347395069489998,SUBP,0.46974000334739685
335231950489998,SUBP,0.8835620284080505

2025-01-23 02:07:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:07:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:07:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:07:13 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 02:07:13 - snowflake.connector.connection - INFO - closed
2025-01-23 02:07:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:07:14 - root - INFO - SQL:
SELECT P."plot_state_code", P."plot_state_code_name", P."plot_inventory_year", C."proportion_basis", C."condition_proportion_unadjusted"
   FROM "USFS_FIA"."USFS_FIA"."PLOT" P
   JOIN "USFS_FIA"."USFS_FIA"."CONDITION" C
       ON P."plot_sequence_number" = C."plot_sequence_number"
   WHERE P."plot_inventory_year" IN (2015, 2016, 2017)
   LIMIT 100;
Results:
plot_state_code,plot_state_code_name,plot_inventory_year,proportion_basis,condition_proportion_unadjusted
16,Idaho,2015,SUBP,1.0
47,Tennessee,2015,SUBP,0.75
4,Arizona,2016,SUBP,1.0
18,Indiana,2017,SUBP,1.0
19,Iowa,2016,SUBP,1.0
8,Colorado,2017,SUBP,1.0
8,Colorado,2016,SUBP,1.0
8,Colorado,2016,SUBP,1.0
39,Ohio,2017,SUBP,0.25
39,Ohio,2016,SUBP,1.0
39,Ohio,2016,SUBP,0.25
19,Iowa,2016,SUBP,0.5371590256690979
17,Illinois,2015,SUBP,1.0
36,New York,2017,SUBP,0.25
31,Nebraska,2015,SUBP,1.0
31,Nebraska,2016,SUBP,1.0
18,Indiana,2015,SUBP,1.0
47,Tennessee,2016,SUBP,0.75
8,Colorado,2017,SUBP,0.5
31,Nebraska,2016,SUBP,0.7674340009689331
41,Oregon,2015,MACR,0.036042001098394394
41,Oregon,2015,MACR,0.03350900113582611
41,Oregon,2015,MACR,0.3420650064945221
2,Alaska,2016,SUBP,1.0
2,Alaska,2016,SUBP,0.8284940123558044
16,Idaho,2016,SUBP,1.0
16,Idaho,2017,SUBP,1.0
53,Washington,2015,MACR,0.02265699952840805
18,Indiana,2017,SUBP,1.0
19,Iowa,2017,SUBP,0.684158980846405
19,Iowa,2017,SUBP,1.0
39,Ohio,2016,SUBP,1.0
30,Montana,2015,SUBP,0.25
30,Montana,2017,SUBP,0.75
30,Montana,2015,SUBP,0.75
30,Montana,2016,SUBP,0.75
31,Nebraska,2016,SUBP,1.0
31,Nebraska,2015,SUBP,1.0
4,Arizona,2017,SUBP,1.0
39,Ohio,2016,SUBP,0.75
39,Ohio,2016,SUBP,1.0
16,Idaho,2017,SUBP,1.0
16,Idaho,2015,SUBP,0.5
16,Idaho,2017,SUBP,0.75
16,Idaho,2015,SUBP,0.25
31,Nebraska,2017,SUBP,0.274848997592926
19,Iowa,2016,SUBP,1.0
19,Iowa,2017,SUBP,1.0
8,Colorado,2015,SUBP,1.0
8,Colorado,2016,SUBP,1.0
8,Colorado,2017,SUBP,0.25
18,Indiana,2017,SUBP,0.75
39,Ohio,2015,SUBP,0.75
30,Montana,2016,SUBP,1.0
30,Montana,2015,SUBP,0.32661300897598267
4,Arizona,2015,SUBP,1.0
39,Ohio,2015,SUBP,0.6457149982452393
39,Ohio,2016,SUBP,0.3120979964733124
2,Alaska,2017,SUBP,0.2811119854450226
16,Idaho,2016,SUBP,1.0
16,Idaho,2015,SUBP,0.5
16,Idaho,2015,SUBP,1.0
19,Iowa,2017,SUBP,1.0
41,Oregon,2015,MACR,0.7213810086250305
41,Oregon,2015,MACR,0.694890022277832
8,Colorado,2016,SUBP,0.75
8,Colorado,2015,SUBP,1.0
8,Colorado,2016,SUBP,1.0
30,Montana,2017,SUBP,1.0
30,Montana,2017,SUBP,1.0
30,Montana,2017,SUBP,0.25
30,Montana,2015,SUBP,1.0
30,Montana,2017,SUBP,0.1746399998664856
2,Alaska,2015,SUBP,1.0
2,Alaska,2017,SUBP,1.0
2,Alaska,2016,SUBP,1.0
2,Alaska,2017,SUBP,1.0
2,Alaska,2016,SUBP,1.0
2,Alaska,2016,SUBP,1.0
42,Pennsylvania,2016,SUBP,1.0
42,Pennsylvania,2016,SUBP,0.25
42,Pennsylvania,2016,SUBP,1.0
12,Florida,2015,SUBP,1.0
49,Utah,2017,SUBP,1.0
53,Washington,2015,MACR,0.75
53,Washington,2017,MACR,0.05844400078058243
53,Washington,2017,MACR,0.014170999638736248
56,Wyoming,2017,SUBP,1.0
56,Wyoming,2017,SUBP,1.0
56,Wyoming,2017,SUBP,1.0
53,Washington,2016,MACR,0.4145030081272125
53,Washington,2015,MACR,0.12338300049304962
53,Washington,2016,MACR,1.0
8,Colorado,2017,SUBP,1.0
8,Colorado,2016,SUBP,0.75
8,Colorado,2017,SUBP,1.0
29,Missouri,2015,SUBP,1.0
19,Iowa,2016,SUBP,1.0
16,Idaho,2017,SUBP,1.0
16,Idaho,2016,SUBP,1.0

2025-01-23 02:07:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:07:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:07:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:07:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 02:07:16 - snowflake.connector.connection - INFO - closed
2025-01-23 02:07:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:08:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 02:08:39 - root - INFO - ```sql
SELECT
    "plot_type",
    "year",
    "state",
    "average_size"
FROM (
    SELECT
        CASE
            WHEN C."proportion_basis" = 'SUBP' THEN 'subplot'
            WHEN C."proportion_basis" = 'MACR' THEN 'macroplot'
            ELSE 'unknown'
        END AS "plot_type",
        P."plot_inventory_year" AS "year",
        P."plot_state_code_name" AS "state",
        AVG(
            PS."expansion_factor" * C."condition_proportion_unadjusted" *
            CASE
                WHEN C."proportion_basis" = 'SUBP' THEN COALESCE(PS."adjustment_factor_for_the_subplot", 1.0)
                WHEN C."proportion_basis" = 'MACR' THEN COALESCE(PS."adjustment_factor_for_the_macroplot", 1.0)
                ELSE 1.0
            END
        ) AS "average_size",
        ROW_NUMBER() OVER (
            PARTITION BY
                CASE
                    WHEN C."proportion_basis" = 'SUBP' THEN 'subplot'
                    WHEN C."proportion_basis" = 'MACR' THEN 'macroplot'
                    ELSE 'unknown'
                END,
                P."plot_inventory_year"
            ORDER BY AVG(
                PS."expansion_factor" * C."condition_proportion_unadjusted" *
                CASE
                    WHEN C."proportion_basis" = 'SUBP' THEN COALESCE(PS."adjustment_factor_for_the_subplot", 1.0)
                    WHEN C."proportion_basis" = 'MACR' THEN COALESCE(PS."adjustment_factor_for_the_macroplot", 1.0)
                    ELSE 1.0
                END
            ) DESC
        ) AS "rn"
    FROM "USFS_FIA"."USFS_FIA"."PLOT" P
    JOIN "USFS_FIA"."USFS_FIA"."CONDITION" C
        ON P."plot_sequence_number" = C."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" PSA
        ON P."plot_sequence_number" = PSA."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
        ON PSA."stratum_sequence_number" = PS."stratum_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" PE
        ON PS."evaluation_sequence_number" = PE."evaluation_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" PET
        ON PE."evaluation_sequence_number" = PET."evaluation_sequence_number"
    WHERE
        P."plot_inventory_year" IN (2015, 2016, 2017)
        AND PET."evaluation_type" = 'EXPCURR'
        AND C."condition_status_code" = 1  -- Assuming '1' represents accessible forest land
        AND (
            (C."proportion_basis" = 'SUBP' AND COALESCE(PS."adjustment_factor_for_the_subplot", 0) > 0)
            OR (C."proportion_basis" = 'MACR' AND COALESCE(PS."adjustment_factor_for_the_macroplot", 0) > 0)
        )
    GROUP BY
        "plot_type", "year", "state"
)
WHERE "rn" = 1
ORDER BY "plot_type", "year";
```

**Note:** This query calculates the average subplot and macroplot sizes for each state and year based on accessible forest land (assuming `condition_status_code = 1` represents accessible land) and current evaluations (`evaluation_type = 'EXPCURR'`). It handles missing values by using `COALESCE` to default null adjustment factors to `1.0`. The query selects the state with the largest average size for each plot type (`subplot` or `macroplot`) and each year (2015, 2016, 2017).
2025-01-23 02:08:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:08:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:08:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:08:40 - snowflake.connector.connection - INFO - closed
2025-01-23 02:08:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:09:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 02:09:40 - root - INFO - ```sql
SELECT
    "plot_type",
    "year",
    "state",
    "average_size"
FROM (
    SELECT
        CASE
            WHEN C."proportion_basis" = 'SUBP' THEN 'subplot'
            WHEN C."proportion_basis" = 'MACR' THEN 'macroplot'
            ELSE 'unknown'
        END AS "plot_type",
        P."plot_inventory_year" AS "year",
        P."plot_state_code_name" AS "state",
        AVG(
            PS."expansion_factor" * C."condition_proportion_unadjusted" *
            CASE
                WHEN C."proportion_basis" = 'SUBP' THEN COALESCE(PS."adjustment_factor_for_the_subplot", 1.0)
                WHEN C."proportion_basis" = 'MACR' THEN COALESCE(PS."adjustment_factor_for_the_macroplot", 1.0)
                ELSE 1.0
            END
        ) AS "average_size",
        ROW_NUMBER() OVER (
            PARTITION BY
                CASE
                    WHEN C."proportion_basis" = 'SUBP' THEN 'subplot'
                    WHEN C."proportion_basis" = 'MACR' THEN 'macroplot'
                    ELSE 'unknown'
                END,
                P."plot_inventory_year"
            ORDER BY AVG(
                PS."expansion_factor" * C."condition_proportion_unadjusted" *
                CASE
                    WHEN C."proportion_basis" = 'SUBP' THEN COALESCE(PS."adjustment_factor_for_the_subplot", 1.0)
                    WHEN C."proportion_basis" = 'MACR' THEN COALESCE(PS."adjustment_factor_for_the_macroplot", 1.0)
                    ELSE 1.0
                END
            ) DESC
        ) AS "rn"
    FROM "USFS_FIA"."USFS_FIA"."PLOT" P
    JOIN "USFS_FIA"."USFS_FIA"."CONDITION" C
        ON P."plot_sequence_number" = C."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" PSA
        ON P."plot_sequence_number" = PSA."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
        ON PSA."stratum_sequence_number" = PS."stratum_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_ESTIMATION_UNIT" PEU
        ON PS."estimation_unit_sequence_number" = PEU."estimation_unit_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" PE
        ON PEU."evaluation_sequence_number" = PE."evaluation_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" PET
        ON PE."evaluation_sequence_number" = PET."evaluation_sequence_number"
    WHERE
        P."plot_inventory_year" IN (2015, 2016, 2017)
        AND PET."evaluation_type" = 'EXPCURR'
        AND C."condition_status_code" = 1
        AND (
            (C."proportion_basis" = 'SUBP' AND COALESCE(PS."adjustment_factor_for_the_subplot", 0) > 0)
            OR (C."proportion_basis" = 'MACR' AND COALESCE(PS."adjustment_factor_for_the_macroplot", 0) > 0)
        )
    GROUP BY
        "plot_type", "year", "state"
)
WHERE "rn" = 1
ORDER BY "plot_type", "year;
```
2025-01-23 02:09:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:09:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:09:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:09:42 - snowflake.connector.connection - INFO - closed
2025-01-23 02:09:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:10:51 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 02:10:51 - root - INFO - ```sql
SELECT
    "plot_type",
    "year",
    "state",
    "average_size"
FROM (
    SELECT
        "plot_type",
        "year",
        "state",
        "average_size",
        ROW_NUMBER() OVER (
            PARTITION BY "plot_type", "year"
            ORDER BY "average_size" DESC
        ) AS "rn"
    FROM (
        SELECT
            CASE
                WHEN C."proportion_basis" = 'SUBP' THEN 'subplot'
                WHEN C."proportion_basis" = 'MACR' THEN 'macroplot'
                ELSE 'unknown'
            END AS "plot_type",
            P."plot_inventory_year" AS "year",
            P."plot_state_code_name" AS "state",
            AVG(
                PS."expansion_factor" * C."condition_proportion_unadjusted" *
                CASE
                    WHEN C."proportion_basis" = 'SUBP' THEN COALESCE(PS."adjustment_factor_for_the_subplot", 1.0)
                    WHEN C."proportion_basis" = 'MACR' THEN COALESCE(PS."adjustment_factor_for_the_macroplot", 1.0)
                    ELSE 1.0
                END
            ) AS "average_size"
        FROM "USFS_FIA"."USFS_FIA"."PLOT" P
        JOIN "USFS_FIA"."USFS_FIA"."CONDITION" C
            ON P."plot_sequence_number" = C."plot_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" PSA
            ON P."plot_sequence_number" = PSA."plot_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
            ON PSA."stratum_sequence_number" = PS."stratum_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_ESTIMATION_UNIT" PEU
            ON PS."estimation_unit_sequence_number" = PEU."estimation_unit_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" PE
            ON PEU."evaluation_sequence_number" = PE."evaluation_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" PET
            ON PE."evaluation_sequence_number" = PET."evaluation_sequence_number"
        WHERE
            P."plot_inventory_year" IN (2015, 2016, 2017)
            AND PET."evaluation_type" = 'EXPCURR'
            AND C."condition_status_code" = 1  -- Accessible forest land
            AND (
                (C."proportion_basis" = 'SUBP' AND COALESCE(PS."adjustment_factor_for_the_subplot", 0) > 0)
                OR (C."proportion_basis" = 'MACR' AND COALESCE(PS."adjustment_factor_for_the_macroplot", 0) > 0)
            )
        GROUP BY
            "plot_type", "year", "state"
    ) AS "avg_sizes"
) AS "ranked_states"
WHERE "rn" = 1
ORDER BY "plot_type", "year";
```

**Explanation:**

This SQL query calculates the largest average subplot size and macroplot size for each state in the years 2015, 2016, and 2017, based on accessible forest land and current evaluations (`'EXPCURR'`).

**Key Points:**

- **Subquery `avg_sizes`:** Calculates the average size for each plot type (`subplot` or `macroplot`), year, and state.
  - Uses the formula provided for calculating subplot and macroplot sizes.
  - Filters data for the specified years and accessible forest land (`condition_status_code = 1`).
  - Joins relevant tables to access necessary data.

- **Subquery `ranked_states`:** Assigns a rank to each state within each plot type and year, ordering by `average_size` in descending order.
  - Uses `ROW_NUMBER()` window function partitioned by `plot_type` and `year`.

- **Final Selection:** Retrieves only the top-ranked state (`rn = 1`) for each plot type and year, resulting in the states with the largest average sizes.

- **Ordering:** The final results are ordered by `plot_type` and `year` for clarity.

**Notes:**

- **Syntax Correction:** Ensured that all SQL syntax is correct, including matching parentheses and quotation marks.
- **Aggregation in Window Function:** Restructured the query to avoid nesting aggregate functions within window functions by calculating aggregates in a subquery.

This query should run without syntax errors and provide the desired results in the specified format.
2025-01-23 02:10:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:10:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:10:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:10:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-23 02:10:54 - snowflake.connector.connection - INFO - closed
2025-01-23 02:10:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:12:21 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 02:12:21 - root - INFO - SQL:
SELECT
    "plot_type",
    "year",
    "state",
    "average_size"
FROM (
    SELECT
        "plot_type",
        "year",
        "state",
        "average_size",
        ROW_NUMBER() OVER (
            PARTITION BY "plot_type", "year"
            ORDER BY "average_size" DESC
        ) AS "rn"
    FROM (
        SELECT
            CASE
                WHEN C."proportion_basis" = 'SUBP' THEN 'subplot'
                WHEN C."proportion_basis" = 'MACR' THEN 'macroplot'
                ELSE 'unknown'
            END AS "plot_type",
            P."plot_inventory_year" AS "year",
            P."plot_state_code_name" AS "state",
            AVG(
                PS."expansion_factor" * C."condition_proportion_unadjusted" *
                CASE
                    WHEN C."proportion_basis" = 'SUBP' THEN COALESCE(PS."adjustment_factor_for_the_subplot", 1.0)
                    WHEN C."proportion_basis" = 'MACR' THEN COALESCE(PS."adjustment_factor_for_the_macroplot", 1.0)
                    ELSE 1.0
                END
            ) AS "average_size"
        FROM "USFS_FIA"."USFS_FIA"."PLOT" P
        JOIN "USFS_FIA"."USFS_FIA"."CONDITION" C
            ON P."plot_sequence_number" = C."plot_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" PSA
            ON P."plot_sequence_number" = PSA."plot_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
            ON PSA."stratum_sequence_number" = PS."stratum_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_ESTIMATION_UNIT" PEU
            ON PS."estimation_unit_sequence_number" = PEU."estimation_unit_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" PE
            ON PEU."evaluation_sequence_number" = PE."evaluation_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" PET
            ON PE."evaluation_sequence_number" = PET."evaluation_sequence_number"
        WHERE
            P."plot_inventory_year" IN (2015, 2016, 2017)
            AND PET."evaluation_type" = 'EXPCURR'
            AND C."condition_status_code" = 1  -- Accessible forest land
            AND (
                (C."proportion_basis" = 'SUBP' AND COALESCE(PS."adjustment_factor_for_the_subplot", 0) > 0)
                OR (C."proportion_basis" = 'MACR' AND COALESCE(PS."adjustment_factor_for_the_macroplot", 0) > 0)
            )
        GROUP BY
            "plot_type", "year", "state"
    ) AS "avg_sizes"
) AS "ranked_states"
WHERE "rn" = 1
ORDER BY "plot_type", "year";
Results:
plot_type,year,state,average_size
macroplot,2015,California,4937.295863300523
macroplot,2016,California,5128.199385365012
macroplot,2017,California,5043.9370607363635
subplot,2015,Wyoming,7634.419129440116
subplot,2016,Wyoming,7054.171375211551
subplot,2017,Hawaii,7812.384403896898

2025-01-23 02:12:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:12:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:12:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:12:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 02:12:23 - snowflake.connector.connection - INFO - closed
2025-01-23 02:12:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:12:24 - root - INFO - SQL:
-- Corrected SQL 1
SELECT "plot_sequence_number", "stratum_sequence_number"
FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN"
LIMIT 100
Results:
plot_sequence_number,stratum_sequence_number
10672090010497,13319170010497
10670280010497,13319182010497
10669067010497,13319402010497
10669091010497,13319402010497
10670452010497,13319374010497
10668523010497,13319335010497
10669051010497,13319283010497
10668717010497,13319393010497
10671724010497,13319399010497
10669560010497,13319373010497
10668366010497,13319408010497
10668530010497,13319408010497
10668946010497,13319196010497
10667628010497,13319364010497
10668111010497,13319268010497
10668044010497,13319268010497
10667924010497,13319268010497
10667911010497,13319268010497
10668720010497,13319403010497
10668790010497,13319403010497
10671886010497,13319268010497
10672088010497,13319404010497
10669300010497,13319265010497
10669100010497,13319261010497
10668050010497,13319409010497
10667754010497,13319409010497
10671796010497,13319260010497
10671462010497,13319321010497
10671723010497,13319258010497
10670413010497,13319239010497
10668673010497,13319201010497
10668525010497,13319175010497
10668985010497,13319238010497
10668047010497,13319409010497
10669737010497,13319405010497
10670090010497,13319405010497
10671684010497,13319398010497
10669003010497,13319163010497
10667433010497,13319236010497
10670703010497,13319407010497
10670975010497,13319145010497
10668378010497,13319160010497
10670671010497,13319165010497
10670786010497,13319298010497
10669301010497,13319247010497
10670804010497,13319386010497
10671390010497,13319386010497
10672027010497,13319267010497
10671533010497,13319249010497
10668425010497,13319267010497
10667646010497,13319254010497
10671131010497,13319380010497
10667861010497,13319268010497
10669587010497,13319248010497
10670918010497,13319259010497
10671209010497,13319262010497
10670253010497,13319379010497
10669528010497,13319365010497
10668416010497,13319408010497
10668902010497,13319382010497
10668246010497,13319357010497
10669290010497,13319406010497
10671290010497,13319404010497
10671325010497,13319404010497
10671364010497,13319401010497
10669211010497,13319402010497
10670616010497,13319141010497
10667618010497,13319260010497
10669377010497,13319269010497
10670682010497,13319133010497
10672077010497,13319169010497
10669768010497,13319273010497
10669207010497,13319313010497
10670472010497,13319252010497
10667939010497,13319409010497
10668011010497,13319409010497
10671416010497,13319206010497
10670368010497,13319265010497
10670347010497,13319262010497
10670418010497,13319262010497
10672360010497,13319206010497
10671166010497,13319265010497
10668513010497,13319267010497
10667971010497,13319409010497
10668043010497,13319409010497
10670571010497,13319227010497
10669731010497,13319213010497
10669082010497,13319263010497
10672310010497,13319161010497
10671677010497,13319205010497
10667905010497,13319409010497
10667562010497,13319251010497
10669094010497,13319254010497
10669804010497,13319211010497
10671733010497,13319388010497
10670150010497,13319406010497
10672145010497,13319404010497
10668096010497,13319244010497
10670943010497,13319259010497
10669693010497,13319259010497

2025-01-23 02:12:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:12:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:12:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:12:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 02:12:25 - snowflake.connector.connection - INFO - closed
2025-01-23 02:12:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:12:26 - root - INFO - SQL:
-- Corrected SQL 2
SELECT
    C."plot_sequence_number",
    C."proportion_basis",
    C."condition_proportion_unadjusted",
    PSA."stratum_sequence_number"
FROM "USFS_FIA"."USFS_FIA"."CONDITION" C
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" PSA
    ON C."plot_sequence_number" = PSA."plot_sequence_number"
LIMIT 100
Results:
plot_sequence_number,proportion_basis,condition_proportion_unadjusted,stratum_sequence_number
14532098020004,SUBP,1.0,498381135126144
306350180489998,SUBP,0.25,498381146126144
306350180489998,SUBP,0.75,498381146126144
245790975010661,SUBP,1.0,638563474126144
245791388010661,SUBP,0.17957599461078644,638563455126144
245791388010661,SUBP,0.8204240202903748,638563455126144
14532544020004,SUBP,1.0,638563458126144
249881659489998,SUBP,0.34028300642967224,498392876126144
249881659489998,SUBP,0.6597170233726501,498392876126144
373753096489998,SUBP,1.0,498392890126144
168271692020004,SUBP,1.0,498381121126144
465277209489998,SUBP,1.0,638563467126144
306349629489998,SUBP,1.0,498368825126144
306349918489998,SUBP,0.8916059732437134,498381138126144
306349918489998,SUBP,0.10839399695396423,498381138126144
14531868020004,SUBP,0.5072090029716492,498368807126144
14531868020004,SUBP,0.25,498368807126144
14531868020004,SUBP,0.24279099702835083,498368807126144
14531809020004,SUBP,1.0,638563457126144
168272711020004,SUBP,1.0,498381130126144
245791328010661,SUBP,0.25,498381115126144
245791328010661,SUBP,0.75,498381115126144
465277036489998,SUBP,1.0,638563462126144
245792183010661,SUBP,0.75,498368815126144
245792183010661,SUBP,0.25,498368815126144
14532266020004,SUBP,1.0,638551250126144
168271169020004,SUBP,0.39571499824523926,638563459126144
168271169020004,SUBP,0.6042850017547607,638563459126144
245791945010661,SUBP,1.0,638590090126144
373753673489998,SUBP,1.0,498368793126144
168271382020004,SUBP,1.0,498392880126144
373753849489998,SUBP,1.0,638563461126144
14533270020004,SUBP,1.0,498381130126144
245792568010661,SUBP,1.0,498381145126144
168272262020004,SUBP,1.0,638563467126144
168272932020004,SUBP,1.0,638551242126144
373753909489998,SUBP,0.75,498381115126144
373753909489998,SUBP,0.25,498381115126144
465276586489998,SUBP,1.0,638575218126144
14531338020004,SUBP,0.25,498392875126144
14531338020004,SUBP,0.38986900448799133,498392875126144
14531338020004,SUBP,0.36013099551200867,498392875126144
168272185020004,SUBP,1.0,498368797126144
168270809020004,SUBP,1.0,692745515126144
168272234020004,SUBP,1.0,498368826126144
249881801489998,SUBP,1.0,638563460126144
168270781020004,SUBP,1.0,638575190126144
14532680020004,SUBP,1.0,638575195126144
245792236010661,SUBP,0.5,498368816126144
245792236010661,SUBP,0.5,498368816126144
249881318489998,SUBP,1.0,498381135126144
168272616020004,SUBP,1.0,638575188126144
373753690489998,SUBP,0.5,498381134126144
373753690489998,SUBP,0.5,498381134126144
14532223020004,SUBP,1.0,498381146126144
168271820020004,SUBP,1.0,638551241126144
249880804489998,SUBP,1.0,498392880126144
168271009020004,SUBP,0.824757993221283,498405256126144
168271009020004,SUBP,0.17524200677871704,498405256126144
168271259020004,SUBP,1.0,638590092126144
465276822489998,SUBP,0.30612099170684814,692744807126144
465276822489998,SUBP,0.6938790082931519,692744807126144
373752673489998,SUBP,1.0,692744804126144
14531485020004,SUBP,1.0,692745512126144
245792920010661,SUBP,1.0,638575200126144
249881978489998,SUBP,1.0,638563447126144
245791945010661,SUBP,1.0,638575204126144
306350267489998,SUBP,1.0,498392890126144
168272095020004,SUBP,1.0,498392890126144
465277887489998,SUBP,1.0,638551245126144
168271692020004,SUBP,1.0,498392866126144
306349738489998,SUBP,0.1388539969921112,638563459126144
306349738489998,SUBP,0.8611459732055664,638563459126144
373753471489998,SUBP,1.0,498368827126144
14531456020004,SUBP,0.75,498381119126144
14531456020004,SUBP,0.25,498381119126144
373753719489998,SUBP,1.0,498392903126144
168272656020004,SUBP,1.0,498368808126144
249881634489998,SUBP,1.0,498368821126144
373753212489998,SUBP,1.0,638575178126144
245791199010661,SUBP,1.0,498368813126144
306349629489998,SUBP,1.0,638551250126144
168270801020004,SUBP,0.3570219874382019,638575199126144
168270801020004,SUBP,0.6429780125617981,638575199126144
14531310020004,SUBP,1.0,498392873126144
14533144020004,SUBP,0.25,498368810126144
14533144020004,SUBP,0.75,498368810126144
249881964489998,SUBP,1.0,638551250126144
168272740020004,SUBP,1.0,498368816126144
14531490020004,SUBP,1.0,498368837126144
373752573489998,SUBP,0.25,498368812126144
373752573489998,SUBP,0.75,498368812126144
14532020020004,SUBP,1.0,498368828126144
14532423020004,SUBP,0.5263350009918213,498381136126144
14532423020004,SUBP,0.4736649990081787,498381136126144
168271621020004,SUBP,1.0,638551250126144
220870919010661,SUBP,1.0,498392890126144
168272542020004,SUBP,0.6511480212211609,638575200126144
168272542020004,SUBP,0.3488520085811615,638575200126144
306350035489998,SUBP,0.25,638563468126144

2025-01-23 02:12:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:12:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:12:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:12:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 02:12:27 - snowflake.connector.connection - INFO - closed
2025-01-23 02:12:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:12:28 - root - INFO - SQL:
-- Corrected SQL 3
SELECT
    PSA."plot_sequence_number",
    PSA."stratum_sequence_number",
    PS."expansion_factor",
    PS."adjustment_factor_for_the_macroplot",
    PS."adjustment_factor_for_the_subplot",
    PS."estimation_unit_sequence_number"
FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" PSA
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
    ON PSA."stratum_sequence_number" = PS."stratum_sequence_number"
LIMIT 100
Results:
Too long, hard cut:
plot_sequence_number,stratum_sequence_number,expansion_factor,adjustment_factor_for_the_macroplot,adjustment_factor_for_the_subplot,estimation_unit_sequence_number
40422786010690,669083399126144,8065.7055959314785,0.0,1.0057142857142858,669949200126144
40419875010690,669083347126144,7695.584540789055,0.0,1.0,669949201126144
40418484010690,669083316126144,7387.998037856348,0.0,1.0,669949188126144
40407011010690,669083379126144,7739.88133781454,0.0,1.0,669949196126144
40421995010690,669083393126144,7386.489548954895,0.0,1.0,669953194126144
40419083010690,669083330126144,7724.701588152994,0.0,1.0033444816053512,669953195126144
40419454010690,669083337126144,7611.466865560241,,1.0,669953144126144
40423315010690,669083416126144,7454.2638776279,0.0,1.002816824299737,669949187126144
40407833010690,669083416126144,7454.2638776279,0.0,1.002816824299737,669949187126144
40416574010690,669083276126144,7400.759375087548,0.0,1.0052356020942408,669949195126144
40416605010690,669083276126144,7400.759375087548,0.0,1.0052356020942408,669949195126144
40418057010690,669083308126144,8191.260148103494,0.0,1.0,669949203126144
40420031010690,669083355126144,7692.417044782939,0.0,1.0,669949204126144
40420174010690,669083357126144,7692.417044782939,0.0,1.0,669953207126144
40406503010690,669083357126144,7692.417044782939,0.0,1.0,669953207126144
40407476010690,669083393126144,7386.489548954895,0.0,1.0,669953194126144
40422488010690,669083393126144,7386.489548954895,0.0,1.0,669953194126144
40422568010690,669083392126144,7386.489548954895,,1.0,669953136126144
40419324010690,669083338126144,7611.466865560241,0.0,1.0,669953202126144
40419345010690,669083338126144,7611.466865560241,0.0,1.0,669953202126144
40419360010690,669083338126144,7611.466865560241,0.0,1.0,669953202126144
40420838010690,669083365126144,7865.370343574823,0.0,1.0119595216191353,669953196126144
40407714010690,669083403126144,7678.35632183908,0.0,1.0,669949186126144
40421087010690,669083371126144,7946.876470588235,0.0,1.0,669949189126144
40418218010690,669083312126144,7998.301935120591,0.0,1.0086206896551724,669949188126144
40416395010690,669083276126144,7400.759375087548,0.0,1.0052356020942408,669949195126144
40404887010690,669083276126144,7400.759375087548,0.0,1.0052356020942408,669949195126144
40416431010690,669083276126144,7400.759375087548,0.0,1.0052356020942408,669949195126144
40419424010690,669083336126144,7611.466865560241,0.0,1.0,669949199126144
40419228010690,669083336126144,7611.466865560241,0.0,1.0,669949199126144
40406217010690,669083341126144,7478.582608695652,,1.0,669953129126144
40417720010690,669083302126144,7808.21468381549,0.0,1.0023346303501945,669953200126144
40406472010690,669083357126144,7692.417044782939,0.0,1.0,669953207126144
40406557010690,669083356126144,7692.417044782939,,1.0,669953149126144
40419379010690,669083338126144,7611.466865560241,0.0,1.0,669953202126144
40406734010690,669083365126144,7865.370343574823,0.0,1.0119595216191353,669953196126144
40421190010690,669083371126144,7946.876470588235,0.0,1.0,669949189126144
40422102010690,669083391126144,7386.489548954895,0.0,1.0,669949191126144
40407212010690,669083391126144,7386.489548954895,0.0,1.0,669949191126144
40416515010690,669083272126144,8184.891665966285,0.0,1.0169491525423728,669949195126144
40416557010690,669083276126144,7400.759375087548,0.0,1.0052356020942408,669949195126144
40406402010690,669083357126144,7692.417044782939,0.0,1.0,669953207126144
40423048010690,669083404126144,7678.35632183908,,1.0,669953131126144
40423056010690,669083404126144,7678.35632183908,,1.0,669953131126144
40418206010690,669083318126144,7387.998037856348,0.0,1.0,669953191126144
40418550010690,669083313126144,7998.301935120591,,1.0086206896551724,669953133126144
40422115010690,669083392126144,7386.489548954895,,1.0,669953136126144
40421980010690,669083392126144,7386.489548954895,,1.0,669953136126144
40423129010690,669083407126144,8345.06976744186,0.0,1.0,669949194126144
40418865010690,669083320126144,7639.459893048128,0.0,1.0,669949198126144
40405063010690,669083284126144,7807.480284457689,0.0,1.0,669949202126144
40416906010690,669083284126144,7807.480284457689,0.0,1.0,669949202126144
40419654010690,669083341126144,7478.582608695652,,1.0,669953129126144
40418514010690,669083318126144,7387.998037856348,0.0,1.0,669953191126144
40418735010690,669083318126144,7387.998037856348,0.0,1.0,669953191126144
40422754010690,669083397126144,7662.149644453961,0.0,1.008729388942774,669953203126144
40406901010690,669083373126144,7946.876470588235,0.0,1.0,669953192126144
40421228010690,669083373126144,7946.876470588235,0.0,1.0,669953192126144
40417863010690,534083500126144,8979.446886387814,0.0,1.000893655049151,548830624126144
40417469010690,534083486126144,9993.788004500993,0.0,1.0064516129032257,548830447126144
40406241010690,534083540126144,8515.217821782178,0.0,1.0,548830630126144
40419135010690,534083527126144,8712.069460322926,0.0,1.0,548830554126144
40406831010690,669083369126144,7733.498840124323,0.0,1.0008424599831

2025-01-23 02:12:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:12:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:12:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:12:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 02:12:29 - snowflake.connector.connection - INFO - closed
2025-01-23 02:12:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:12:30 - root - INFO - SQL:
-- Corrected SQL 4
SELECT "evaluation_sequence_number", "evaluation_type"
FROM "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE"
LIMIT 100
Results:
evaluation_sequence_number,evaluation_type
247334062010854,EXPGROW
247334062010854,EXPREMV
247334062010854,EXPMORT
209643345010854,EXPCURR
209643346010854,EXPVOL
209674547010854,EXPCURR
209674548010854,EXPVOL
209714893010854,EXPCURR
209714894010854,EXPVOL
209643347010854,EXPGROW
209643347010854,EXPMORT
209643347010854,EXPREMV
209674549010854,EXPGROW
209674549010854,EXPMORT
209674549010854,EXPREMV
209714895010854,EXPGROW
209714895010854,EXPMORT
209714895010854,EXPREMV
209773767010854,EXPVOL
209773766010854,EXPCURR
209773768010854,EXPGROW
209773768010854,EXPMORT
209773768010854,EXPREMV
230391507010661,EXPGROW
230391507010661,EXPMORT
230391507010661,EXPREMV
231112004010661,EXPGROW
231112004010661,EXPMORT
231112004010661,EXPREMV
233707236010661,EXPALL
233707240010661,EXPCURR
233707240010661,EXPVOL
233712063010661,EXPALL
233712067010661,EXPCURR
233712067010661,EXPVOL
230279589010661,EXPGROW
230279589010661,EXPMORT
230279589010661,EXPREMV
224235185010661,EXPGROW
224235185010661,EXPMORT
224235185010661,EXPREMV
231112036010661,EXPGROW
231112036010661,EXPMORT
231112036010661,EXPREMV
225364684010661,EXPGROW
225364684010661,EXPMORT
225364684010661,EXPREMV
233717055010661,EXPALL
233717056010661,EXPCURR
233717056010661,EXPVOL
192188648010661,EXPCURR
192188648010661,EXPVOL
192206266010661,EXPALL
211656531010854,EXPCURR
211656532010854,EXPVOL
211656533010854,EXPGROW
211656533010854,EXPMORT
211656533010854,EXPREMV
248888957010854,EXPGROW
248888957010854,EXPREMV
248888957010854,EXPMORT
193273593010661,EXPALL
193273594010661,EXPCURR
193273594010661,EXPVOL
446220010839,EXPCURR
446221010839,EXPVOL
90469759010854,EXPGROW
90469759010854,EXPMORT
90469759010854,EXPREMV
90421492010854,EXPCURR
90421493010854,EXPVOL
90468516010854,EXPGROW
90468516010854,EXPMORT
90468516010854,EXPREMV
243033750010661,EXPCHNG
242926700010661,EXPCHNG
243697690010661,EXPCHNG
242933179010661,EXPCHNG
246814723010661,EXPCHNG
234609613010661,EXPCHNG
234609625010661,EXPCHNG
245826102010661,EXPCHNG
234609565010661,EXPCHNG
234609577010661,EXPCHNG
234609589010661,EXPCHNG
234609601010661,EXPCHNG
195928477010661,EXPCHNG
195929050010661,EXPCHNG
195935990010661,EXPCHNG
195935943010661,EXPCHNG
209534468010661,EXPCHNG
229909644010661,EXPCHNG
243694200010661,EXPCHNG
209499749010661,EXPCHNG
233255404010661,EXPCHNG
4069034020004,EXPCHNG
195951867010661,EXPCHNG
195951883010661,EXPCHNG
195976252010661,EXPCHNG
243034185010661,EXPCHNG

2025-01-23 02:12:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:12:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:12:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:12:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 02:12:32 - snowflake.connector.connection - INFO - closed
2025-01-23 02:12:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:12:32 - root - INFO - SQL:
-- Corrected SQL 5
SELECT
    PS."stratum_sequence_number",
    PE."evaluation_sequence_number",
    PET."evaluation_type"
FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_ESTIMATION_UNIT" PEU
    ON PS."estimation_unit_sequence_number" = PEU."estimation_unit_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" PE
    ON PEU."evaluation_sequence_number" = PE."evaluation_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" PET
    ON PE."evaluation_sequence_number" = PET."evaluation_sequence_number"
LIMIT 100
Results:
stratum_sequence_number,evaluation_sequence_number,evaluation_type
2171,1,EXPCURR
2171,1,EXPVOL
2172,1,EXPCURR
2172,1,EXPVOL
2173,1,EXPCURR
2173,1,EXPVOL
2174,1,EXPCURR
2174,1,EXPVOL
2175,1,EXPCURR
2175,1,EXPVOL
2176,1,EXPCURR
2176,1,EXPVOL
2177,1,EXPCURR
2177,1,EXPVOL
2178,1,EXPCURR
2178,1,EXPVOL
2179,1,EXPCURR
2179,1,EXPVOL
218,1,EXPCURR
218,1,EXPVOL
2180,1,EXPCURR
2180,1,EXPVOL
2181,1,EXPCURR
2181,1,EXPVOL
2182,1,EXPCURR
2182,1,EXPVOL
2183,1,EXPCURR
2183,1,EXPVOL
2184,1,EXPCURR
2184,1,EXPVOL
2185,1,EXPCURR
2185,1,EXPVOL
2186,1,EXPCURR
2186,1,EXPVOL
2187,1,EXPCURR
2187,1,EXPVOL
2188,1,EXPCURR
2188,1,EXPVOL
2189,1,EXPCURR
2189,1,EXPVOL
219,1,EXPCURR
219,1,EXPVOL
2190,1,EXPCURR
2190,1,EXPVOL
2191,1,EXPCURR
2191,1,EXPVOL
2192,1,EXPCURR
2192,1,EXPVOL
2193,1,EXPCURR
2193,1,EXPVOL
2194,1,EXPCURR
2194,1,EXPVOL
2195,1,EXPCURR
2195,1,EXPVOL
2196,1,EXPCURR
2196,1,EXPVOL
2197,1,EXPCURR
2197,1,EXPVOL
2198,1,EXPCURR
2198,1,EXPVOL
2096,1,EXPCURR
2096,1,EXPVOL
2097,1,EXPCURR
2097,1,EXPVOL
2098,1,EXPCURR
2098,1,EXPVOL
2099,1,EXPCURR
2099,1,EXPVOL
210,1,EXPCURR
210,1,EXPVOL
2100,1,EXPCURR
2100,1,EXPVOL
2101,1,EXPCURR
2101,1,EXPVOL
2102,1,EXPCURR
2102,1,EXPVOL
2103,1,EXPCURR
2103,1,EXPVOL
2104,1,EXPCURR
2104,1,EXPVOL
2105,1,EXPCURR
2105,1,EXPVOL
2106,1,EXPCURR
2106,1,EXPVOL
2107,1,EXPCURR
2107,1,EXPVOL
2108,1,EXPCURR
2108,1,EXPVOL
2109,1,EXPCURR
2109,1,EXPVOL
211,1,EXPCURR
211,1,EXPVOL
2110,1,EXPCURR
2110,1,EXPVOL
2111,1,EXPCURR
2111,1,EXPVOL
2112,1,EXPCURR
2112,1,EXPVOL
2113,1,EXPCURR
2113,1,EXPVOL

2025-01-23 02:12:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:12:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:12:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:12:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 02:12:33 - snowflake.connector.connection - INFO - closed
2025-01-23 02:12:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:12:34 - root - INFO - SQL:
-- Corrected SQL 6
SELECT
    PS."stratum_sequence_number",
    PE."evaluation_sequence_number",
    PET."evaluation_type"
FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_ESTIMATION_UNIT" PEU
    ON PS."estimation_unit_sequence_number" = PEU."estimation_unit_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" PE
    ON PEU."evaluation_sequence_number" = PE."evaluation_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" PET
    ON PE."evaluation_sequence_number" = PET."evaluation_sequence_number"
WHERE PET."evaluation_type" = 'EXPCURR'
LIMIT 100
Results:
stratum_sequence_number,evaluation_sequence_number,evaluation_type
2171,1,EXPCURR
2172,1,EXPCURR
2173,1,EXPCURR
2174,1,EXPCURR
2175,1,EXPCURR
2176,1,EXPCURR
2177,1,EXPCURR
2178,1,EXPCURR
2179,1,EXPCURR
218,1,EXPCURR
2180,1,EXPCURR
2181,1,EXPCURR
2182,1,EXPCURR
2183,1,EXPCURR
2184,1,EXPCURR
2185,1,EXPCURR
2186,1,EXPCURR
2187,1,EXPCURR
2188,1,EXPCURR
2189,1,EXPCURR
219,1,EXPCURR
2190,1,EXPCURR
2191,1,EXPCURR
2192,1,EXPCURR
2193,1,EXPCURR
2194,1,EXPCURR
2195,1,EXPCURR
2196,1,EXPCURR
2197,1,EXPCURR
2198,1,EXPCURR
2096,1,EXPCURR
2097,1,EXPCURR
2098,1,EXPCURR
2099,1,EXPCURR
210,1,EXPCURR
2100,1,EXPCURR
2101,1,EXPCURR
2102,1,EXPCURR
2103,1,EXPCURR
2104,1,EXPCURR
2105,1,EXPCURR
2106,1,EXPCURR
2107,1,EXPCURR
2108,1,EXPCURR
2109,1,EXPCURR
211,1,EXPCURR
2110,1,EXPCURR
2111,1,EXPCURR
2112,1,EXPCURR
2113,1,EXPCURR
2114,1,EXPCURR
2115,1,EXPCURR
2116,1,EXPCURR
2117,1,EXPCURR
2118,1,EXPCURR
2119,1,EXPCURR
212,1,EXPCURR
2120,1,EXPCURR
2121,1,EXPCURR
2122,1,EXPCURR
2123,1,EXPCURR
2124,1,EXPCURR
2125,1,EXPCURR
2126,1,EXPCURR
2127,1,EXPCURR
2128,1,EXPCURR
2129,1,EXPCURR
213,1,EXPCURR
2130,1,EXPCURR
2131,1,EXPCURR
2132,1,EXPCURR
2133,1,EXPCURR
2063,1,EXPCURR
2134,1,EXPCURR
2135,1,EXPCURR
2136,1,EXPCURR
2137,1,EXPCURR
2138,1,EXPCURR
2139,1,EXPCURR
214,1,EXPCURR
2140,1,EXPCURR
2141,1,EXPCURR
2142,1,EXPCURR
2143,1,EXPCURR
2144,1,EXPCURR
2145,1,EXPCURR
2146,1,EXPCURR
2147,1,EXPCURR
2148,1,EXPCURR
2149,1,EXPCURR
215,1,EXPCURR
2150,1,EXPCURR
2151,1,EXPCURR
2152,1,EXPCURR
2153,1,EXPCURR
220,1,EXPCURR
2200,1,EXPCURR
2201,1,EXPCURR
2202,1,EXPCURR
2203,1,EXPCURR

2025-01-23 02:12:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:12:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:12:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:12:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 02:12:36 - snowflake.connector.connection - INFO - closed
2025-01-23 02:12:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:12:36 - root - INFO - SQL:
-- Corrected SQL 7
SELECT
    P."plot_state_code",
    P."plot_state_code_name",
    P."plot_inventory_year",
    C."proportion_basis",
    C."condition_proportion_unadjusted",
    PS."expansion_factor",
    PS."adjustment_factor_for_the_macroplot",
    PS."adjustment_factor_for_the_subplot",
    PET."evaluation_type"
FROM "USFS_FIA"."USFS_FIA"."PLOT" P
JOIN "USFS_FIA"."USFS_FIA"."CONDITION" C
    ON P."plot_sequence_number" = C."plot_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" PSA
    ON P."plot_sequence_number" = PSA."plot_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
    ON PSA."stratum_sequence_number" = PS."stratum_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_ESTIMATION_UNIT" PEU
    ON PS."estimation_unit_sequence_number" = PEU."estimation_unit_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" PE
    ON PEU."evaluation_sequence_number" = PE."evaluation_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" PET
    ON PE."evaluation_sequence_number" = PET."evaluation_sequence_number"
WHERE P."plot_inventory_year" IN (2015, 2016, 2017)
  AND PET."evaluation_type" = 'EXPCURR'
LIMIT 100
Results:
Too long, hard cut:
plot_state_code,plot_state_code_name,plot_inventory_year,proportion_basis,condition_proportion_unadjusted,expansion_factor,adjustment_factor_for_the_macroplot,adjustment_factor_for_the_subplot,evaluation_type
56,Wyoming,2016,SUBP,1.0,8065.7055959314785,0.0,1.0057142857142858,EXPCURR
56,Wyoming,2017,SUBP,1.0,7695.584540789055,0.0,1.0,EXPCURR
56,Wyoming,2016,SUBP,1.0,7454.2638776279,0.0,1.002816824299737,EXPCURR
56,Wyoming,2015,SUBP,1.0,7400.759375087548,0.0,1.0052356020942408,EXPCURR
56,Wyoming,2015,SUBP,1.0,8191.260148103494,0.0,1.0,EXPCURR
56,Wyoming,2015,SUBP,1.0,7400.759375087548,0.0,1.0052356020942408,EXPCURR
56,Wyoming,2015,SUBP,1.0,7946.876470588235,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,7807.480284457689,0.0,1.0,EXPCURR
56,Wyoming,2016,SUBP,1.0,9993.788004500993,0.0,1.0064516129032257,EXPCURR
56,Wyoming,2016,SUBP,1.0,9993.788004500993,0.0,1.0064516129032257,EXPCURR
56,Wyoming,2016,SUBP,1.0,8549.393139898857,0.0,1.0009910802775024,EXPCURR
56,Wyoming,2017,SUBP,1.0,9085.449770962225,0.0,1.0098039215686274,EXPCURR
56,Wyoming,2015,SUBP,1.0,9178.858889364199,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,8775.499263296768,0.0,1.0,EXPCURR
56,Wyoming,2016,SUBP,1.0,8775.499263296768,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,8551.860742450155,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,0.25,8947.411555503631,0.0,1.018181818181818,EXPCURR
56,Wyoming,2017,SUBP,0.75,8947.411555503631,0.0,1.018181818181818,EXPCURR
56,Wyoming,2017,SUBP,0.5,8758.600723045814,0.0,1.0056497175141244,EXPCURR
56,Wyoming,2017,SUBP,0.5,8758.600723045814,0.0,1.0056497175141244,EXPCURR
56,Wyoming,2016,SUBP,1.0,8382.420724094882,0.0,1.0,EXPCURR
56,Wyoming,2016,SUBP,1.0,8551.860742450155,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,8580.862244897959,0.0,1.0,EXPCURR
56,Wyoming,2016,SUBP,1.0,8902.516106654743,0.0,1.0009699321047527,EXPCURR
56,Wyoming,2015,SUBP,1.0,8968.44853729221,0.0,1.0029498525073746,EXPCURR
56,Wyoming,2016,SUBP,1.0,8382.420724094882,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,8382.420724094882,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,7639.459893048128,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,7865.370343574823,0.0,1.0119595216191353,EXPCURR
56,Wyoming,2016,SUBP,1.0,7808.21468381549,0.0,1.0023346303501945,EXPCURR
56,Wyoming,2015,SUBP,1.0,7639.459893048128,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,7387.998037856348,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,7386.489548954895,0.0,1.0,EXPCURR
56,Wyoming,2015,SUBP,1.0,7808.21468381549,0.0,1.0023346303501945,EXPCURR
56,Wyoming,2017,SUBP,1.0,7544.773568041673,0.0,1.0024650780608053,EXPCURR
56,Wyoming,2017,SUBP,1.0,7739.88133781454,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,7387.998037856348,0.0,1.0,EXPCURR
56,Wyoming,2016,SUBP,1.0,7946.876470588235,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,7386.489548954895,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,7386.489548954895,0.0,1.0,EXPCURR
56,Wyoming,2016,SUBP,1.0,7386.489548954895,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,8661.560467643609,0.0,1.0076670317634173,EXPCURR
56,Wyoming,2017,SUBP,1.0,8549.393139898857,0.0,1.0009910802775024,EXPCURR
56,Wyoming,2015,SUBP,1.0,8426.559166014149,0.0,1.0031854065210715,EXPCURR
56,Wyoming,2015,SUBP,1.0,7495.561693834935,0.0,1.000868809730669,EXPCURR
56,Wyoming,2017,SUBP,1.0,7516.455420469176,0.0,1.0,EXPCURR
56,Wyoming,2016,SUBP,1.0,7516.455420469176,0.0,1.0,EXPCURR
56,Wyoming,2015,SUBP,1.0,8551.860742450155,0.0,1.0,EXPCURR
56,Wyoming,2015,SUBP,1.0,8742.300735934416,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,8742.300735934416,0.0,1.0,EXPCURR
56,Wyoming,2016,SUBP,1.0,9099.770415922694,0.0,1.0064516129032257,EXPCURR
56,Wyoming,2017,SUBP,1.0,8902.516106654743,0.0,1.0009699321047527,EXPCURR
56,Wyoming,2015,SUBP,1.0,7575.896396396396,0.0,1.0,EXPCURR
56,Wyoming,2015,SUBP,1.0,7575.896396396396,0.0,1.0,EXPCURR
56,Wyoming,2015,SUBP,1.0,8546.709098295678,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,8417.925355549818,0.0,1.0059594755661503,EXPCURR
56,Wyoming,2016,SUBP,1.0,8902.516106654743,0.0,1.0009699321047527,EXPCURR
56,Wyoming,2017,SUBP,1.0,8829.862745098038,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,8382.420724094882,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,8558.061602331945,0.0,1.0,EXPCURR
56,Wyoming,2016,SUBP,1.0,8382.420724094882,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,7387.998037856348,0.0,1.0,EXPCURR
56,Wyoming,2016,SUBP,1.0,7662.149644453961,0.0,1.008729388942774,EXPCURR
56,Wyoming,2016,SUBP,1.0,7662.149644453961,0.0,1.008729388942774,EXPCURR
56,Wyoming,2015,SUBP,1.0,8191.260148103494,0.0,1.0,EXPCURR
56,Wyoming,2015,SUBP,1.0,7386.489548954895,0.0,1.0,EXPCURR
56,Wyoming,2015,SUBP,1.0,7386.489548954895,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,7386.489548954895,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,7495.561693834935,0.0,1.000868809730669,EXPCURR
56,Wyoming,2017,SUBP,1.0,8522.799771306334,0.0,1.0027855153203342,EXPCURR
56,Wyoming,2015,SUBP,1.0,8661.560467643609,0.0,1.0076670317634173,EXPCURR
56,Wyoming,2017,SUBP,1.0,8732.248366013071,0.0,1.0,EXPCURR
56,Wyoming,2015,SUBP,1.0,8979.446886387814,0.0,1.000893655049151,EXPCURR
56,Wyoming,2016

2025-01-23 02:12:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:12:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:12:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:12:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-23 02:12:37 - snowflake.connector.connection - INFO - closed
2025-01-23 02:12:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:12:38 - root - INFO - SQL:
-- Corrected SQL 8
SELECT DISTINCT "proportion_basis"
FROM "USFS_FIA"."USFS_FIA"."CONDITION"
LIMIT 100
Results:
proportion_basis
SUBP
""
MACR

2025-01-23 02:12:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:12:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:12:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:12:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 02:12:39 - snowflake.connector.connection - INFO - closed
2025-01-23 02:12:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:12:39 - root - INFO - SQL:
-- Corrected SQL 9
SELECT
    "plot_sequence_number",
    "proportion_basis",
    "condition_proportion_unadjusted"
FROM "USFS_FIA"."USFS_FIA"."CONDITION"
WHERE "proportion_basis" IN ('SUBP', 'MACR')
LIMIT 100
Results:
plot_sequence_number,proportion_basis,condition_proportion_unadjusted
495147849126144,SUBP,0.5
43542784010478,SUBP,0.25
79204355010478,SUBP,1.0
100186090010478,SUBP,0.24230000376701355
43771636010478,SUBP,1.0
30586762010478,SUBP,0.25
43647553010478,SUBP,1.0
535843807126144,SUBP,0.9873560070991516
214888727010854,SUBP,0.25
100180355010478,SUBP,0.25
220500722010854,SUBP,0.3515999913215637
480976653489998,SUBP,0.25
30875192010478,SUBP,1.0
43084647010478,SUBP,0.3610999882221222
335445281489998,SUBP,0.75
43166825010478,SUBP,0.75
22304784010478,SUBP,0.928600013256073
22302886010478,SUBP,0.38749998807907104
559478436126144,SUBP,1.0
22336428010478,SUBP,0.75
43357912010478,SUBP,1.0
495148119126144,SUBP,1.0
106316002010478,SUBP,1.0
259119045010854,SUBP,0.5
258657240489998,SUBP,0.25
85129133010478,SUBP,1.0
76401058010478,SUBP,1.0
61445255010478,SUBP,0.5
43119341010478,SUBP,0.75
22301243010478,SUBP,0.25
335445616489998,SUBP,0.75
236617724010854,SUBP,0.5
43789508010478,SUBP,0.25
43899199010478,SUBP,1.0
259204408010854,SUBP,1.0
259204976010854,SUBP,0.25
252281636010854,SUBP,0.210999995470047
30586627010478,SUBP,0.6467000246047974
30652282010478,SUBP,1.0
43626187010478,SUBP,1.0
480977056489998,SUBP,0.4457870125770569
335445190489998,SUBP,0.7512500286102295
698001372126144,SUBP,1.0
22338112010478,SUBP,1.0
43217862010478,SUBP,1.0
335445288489998,SUBP,0.25
22339053010478,SUBP,0.25
20005707010478,SUBP,1.0
17548640010478,SUBP,1.0
132065303010478,SUBP,0.29887500405311584
20011377010478,SUBP,1.0
17552516010478,SUBP,1.0
353325750489998,SUBP,0.75
17490475010478,SUBP,0.8175039887428284
17501384010478,SUBP,0.625
484310856489998,SUBP,1.0
17549083010478,SUBP,1.0
443867609489998,SUBP,1.0
218218854020004,SUBP,0.75
259178253010854,SUBP,0.5
249673508010854,SUBP,0.7458000183105469
176859679010854,SUBP,0.24860000610351562
218218020020004,SUBP,1.0
140592502010478,SUBP,0.030300000682473183
289515746489998,SUBP,1.0
289515932489998,SUBP,0.9108930230140686
259178250010854,SUBP,0.25
20349085010478,SUBP,1.0
43646445010478,SUBP,1.0
43662566010478,SUBP,1.0
52253743020004,SUBP,0.25
43717945010478,SUBP,0.11389999836683273
43697750010478,SUBP,1.0
43901399010478,SUBP,0.25
480976558489998,SUBP,0.25
252281550010854,SUBP,0.45010000467300415
52253027020004,SUBP,0.25
678976501126144,SUBP,0.5684900283813477
100657370010478,SUBP,1.0
85173384010478,SUBP,0.8945000171661377
548083678126144,SUBP,0.5
548083167126144,SUBP,1.0
548083419126144,SUBP,0.37222298979759216
264160208489998,SUBP,1.0
264160249489998,SUBP,0.75
258657100489998,SUBP,1.0
30197092010478,SUBP,0.43389999866485596
523738296126144,SUBP,0.75
145789406010478,SUBP,0.25
43872068010478,SUBP,0.34439998865127563
43277599010478,SUBP,0.75
43091837010478,SUBP,1.0
175742259010854,SUBP,0.9930999875068665
85157074010478,SUBP,0.5468000173568726
258657268489998,SUBP,0.75
495147935126144,SUBP,1.0
43488309010478,SUBP,0.23250000178813934
61573335010478,SUBP,0.75
385729174489998,SUBP,0.050978999584913254
282502210489998,SUBP,0.75

2025-01-23 02:12:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:12:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:12:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:12:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 02:12:41 - snowflake.connector.connection - INFO - closed
2025-01-23 02:12:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:13:47 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 02:13:47 - root - INFO - ```sql
SELECT
    "plot_type",
    "year",
    "state",
    "average_size"
FROM (
    SELECT
        "plot_type",
        "year",
        "state",
        "average_size",
        ROW_NUMBER() OVER (
            PARTITION BY "plot_type", "year"
            ORDER BY "average_size" DESC
        ) AS "rn"
    FROM (
        SELECT
            CASE
                WHEN C."proportion_basis" = 'SUBP' THEN 'subplot'
                WHEN C."proportion_basis" = 'MACR' THEN 'macroplot'
                ELSE 'unknown'
            END AS "plot_type",
            P."plot_inventory_year" AS "year",
            P."plot_state_code_name" AS "state",
            AVG(
                PS."expansion_factor" * C."condition_proportion_unadjusted" *
                CASE
                    WHEN C."proportion_basis" = 'SUBP' AND COALESCE(PS."adjustment_factor_for_the_subplot", 0) > 0 THEN
                        PS."adjustment_factor_for_the_subplot"
                    WHEN C."proportion_basis" = 'MACR' AND COALESCE(PS."adjustment_factor_for_the_macroplot", 0) > 0 THEN
                        PS."adjustment_factor_for_the_macroplot"
                    ELSE 0
                END
            ) AS "average_size"
        FROM "USFS_FIA"."USFS_FIA"."PLOT" P
        JOIN "USFS_FIA"."USFS_FIA"."CONDITION" C
            ON P."plot_sequence_number" = C."plot_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" PSA
            ON P."plot_sequence_number" = PSA."plot_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
            ON PSA."stratum_sequence_number" = PS."stratum_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_ESTIMATION_UNIT" PEU
            ON PS."estimation_unit_sequence_number" = PEU."estimation_unit_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" PE
            ON PEU."evaluation_sequence_number" = PE."evaluation_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" PET
            ON PE."evaluation_sequence_number" = PET."evaluation_sequence_number"
        WHERE
            P."plot_inventory_year" IN (2015, 2016, 2017)
            AND PET."evaluation_type" = 'EXPCURR'
            AND C."condition_status_code" = 1  -- Accessible forest land
        GROUP BY
            "plot_type", "year", "state"
    ) AS "avg_sizes"
) AS "ranked_states"
WHERE "average_size" > 0 AND "rn" = 1
ORDER BY "plot_type", "year";
```

**Note:** In this corrected SQL query, we've adjusted the calculation to handle empty (null) values in the adjustment factors:

- For **Subplots**:
  - If `PS."adjustment_factor_for_the_subplot"` is **not null** and greater than zero, we include it in the calculation.
  - If it's null or zero, the multiplication results in zero, effectively excluding those records from the average size.
  
- For **Macroplots**:
  - Since `PS."adjustment_factor_for_the_macroplot"` contains empty (null) values, the condition `COALESCE(PS."adjustment_factor_for_the_macroplot", 0) > 0` evaluates to **false**, setting the size to zero.
  - This means macroplots without a valid adjustment factor are excluded from the average size calculation.

Additionally, we've added a condition `WHERE "average_size" > 0` to exclude any plot types and states where the average size could not be calculated due to missing data.
2025-01-23 02:13:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:13:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:13:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:13:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-23 02:13:50 - snowflake.connector.connection - INFO - closed
2025-01-23 02:13:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:14:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 02:14:39 - root - INFO - SQL:
SELECT
    "plot_type",
    "year",
    "state",
    "average_size"
FROM (
    SELECT
        "plot_type",
        "year",
        "state",
        "average_size",
        ROW_NUMBER() OVER (
            PARTITION BY "plot_type", "year"
            ORDER BY "average_size" DESC
        ) AS "rn"
    FROM (
        SELECT
            CASE
                WHEN C."proportion_basis" = 'SUBP' THEN 'subplot'
                WHEN C."proportion_basis" = 'MACR' THEN 'macroplot'
                ELSE 'unknown'
            END AS "plot_type",
            P."plot_inventory_year" AS "year",
            P."plot_state_code_name" AS "state",
            AVG(
                PS."expansion_factor" * C."condition_proportion_unadjusted" *
                CASE
                    WHEN C."proportion_basis" = 'SUBP' AND COALESCE(PS."adjustment_factor_for_the_subplot", 0) > 0 THEN
                        PS."adjustment_factor_for_the_subplot"
                    WHEN C."proportion_basis" = 'MACR' AND COALESCE(PS."adjustment_factor_for_the_macroplot", 0) > 0 THEN
                        PS."adjustment_factor_for_the_macroplot"
                    ELSE 0
                END
            ) AS "average_size"
        FROM "USFS_FIA"."USFS_FIA"."PLOT" P
        JOIN "USFS_FIA"."USFS_FIA"."CONDITION" C
            ON P."plot_sequence_number" = C."plot_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" PSA
            ON P."plot_sequence_number" = PSA."plot_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
            ON PSA."stratum_sequence_number" = PS."stratum_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_ESTIMATION_UNIT" PEU
            ON PS."estimation_unit_sequence_number" = PEU."estimation_unit_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" PE
            ON PEU."evaluation_sequence_number" = PE."evaluation_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" PET
            ON PE."evaluation_sequence_number" = PET."evaluation_sequence_number"
        WHERE
            P."plot_inventory_year" IN (2015, 2016, 2017)
            AND PET."evaluation_type" = 'EXPCURR'
            AND C."condition_status_code" = 1  -- Accessible forest land
        GROUP BY
            "plot_type", "year", "state"
    ) AS "avg_sizes"
) AS "ranked_states"
WHERE "average_size" > 0 AND "rn" = 1
ORDER BY "plot_type", "year";
Results:
plot_type,year,state,average_size
macroplot,2015,California,4937.295863300523
macroplot,2016,California,5128.199385365012
macroplot,2017,California,5043.9370607363635
subplot,2015,Wyoming,7634.419129440116
subplot,2016,Wyoming,7054.171375211551
subplot,2017,Hawaii,7812.384403896898

2025-01-23 02:14:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:14:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:14:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:14:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-23 02:14:40 - snowflake.connector.connection - INFO - closed
2025-01-23 02:14:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:14:40 - root - INFO - SQL:
-- Corrected SQL 11
SELECT DISTINCT
    "condition_status_code",
    "condition_status_code_name"
FROM "USFS_FIA"."USFS_FIA"."CONDITION"
WHERE "condition_status_code" IS NOT NULL
  AND "condition_status_code_name" IS NOT NULL
LIMIT 100
Results:
condition_status_code,condition_status_code_name
2,Nonforest land
1,Accessible forest land

2025-01-23 02:14:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:14:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:14:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:14:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-23 02:14:42 - snowflake.connector.connection - INFO - closed
2025-01-23 02:14:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:14:43 - root - INFO - SQL:
-- Corrected SQL 12
SELECT DISTINCT
    "plot_status_code",
    "plot_status_code_name"
FROM "USFS_FIA"."USFS_FIA"."PLOT"
WHERE "plot_status_code" IS NOT NULL
  AND "plot_status_code_name" IS NOT NULL
LIMIT 100
Results:
plot_status_code,plot_status_code_name
2,Sampled - no accessible forest land condition present on plot
3,Nonsampled
1,Sampled - at least one accessible forest land condition present on plot

2025-01-23 02:14:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:14:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:14:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:14:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 02:14:44 - snowflake.connector.connection - INFO - closed
2025-01-23 02:14:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:14:44 - root - INFO - SQL:
-- Corrected SQL 13
SELECT
    "plot_sequence_number",
    "plot_status_code",
    "plot_status_code_name"
FROM "USFS_FIA"."USFS_FIA"."PLOT"
WHERE "plot_status_code" = 1
  AND "plot_sequence_number" IS NOT NULL
LIMIT 100
Results:
Too long, hard cut:
plot_sequence_number,plot_status_code,plot_status_code_name
56877929010478,1,Sampled - at least one accessible forest land condition present on plot
56823539010478,1,Sampled - at least one accessible forest land condition present on plot
56634683010478,1,Sampled - at least one accessible forest land condition present on plot
56948771010478,1,Sampled - at least one accessible forest land condition present on plot
56799233010478,1,Sampled - at least one accessible forest land condition present on plot
216089991010854,1,Sampled - at least one accessible forest land condition present on plot
56623914010478,1,Sampled - at least one accessible forest land condition present on plot
216089358010854,1,Sampled - at least one accessible forest land condition present on plot
216091521010854,1,Sampled - at least one accessible forest land condition present on plot
56836738010478,1,Sampled - at least one accessible forest land condition present on plot
56811826010478,1,Sampled - at least one accessible forest land condition present on plot
216089632010854,1,Sampled - at least one accessible forest land condition present on plot
56789731010478,1,Sampled - at least one accessible forest land condition present on plot
56887969010478,1,Sampled - at least one accessible forest land condition present on plot
56922547010478,1,Sampled - at least one accessible forest land condition present on plot
216092635010854,1,Sampled - at least one accessible forest land condition present on plot
56816672010478,1,Sampled - at least one accessible forest land condition present on plot
56853324010478,1,Sampled - at least one accessible forest land condition present on plot
216091982010854,1,Sampled - at least one accessible forest land condition present on plot
56972948010478,1,Sampled - at least one accessible forest land condition present on plot
56808547010478,1,Sampled - at least one accessible forest land condition present on plot
56965977010478,1,Sampled - at least one accessible forest land condition present on plot
56891176010478,1,Sampled - at least one accessible forest land condition present on plot
56953649010478,1,Sampled - at least one accessible forest land condition present on plot
56611632010478,1,Sampled - at least one accessible forest land condition present on plot
56811550010478,1,Sampled - at least one accessible forest land condition present on plot
56862195010478,1,Sampled - at least one accessible forest land condition present on plot
56835189010478,1,Sampled - at least one accessible forest land condition present on plot
56836411010478,1,Sampled - at least one accessible forest land condition present on plot
56824207010478,1,Sampled - at least one accessible forest land condition present on plot
56818558010478,1,Sampled - at least one accessible forest land condition present on plot
56750180010478,1,Sampled - at least one accessible forest land condition present on plot
56909932010478,1,Sampled - at least one accessible forest land condition present on plot
216090990010854,1,Sampled - at least one accessible forest land condition present on plot
56625554010478,1,Sampled - at least one accessible forest land condition present on plot
56672926010478,1,Sampled - at least one accessible forest land condition present on plot
56613948010478,1,Sampled - at least one accessible forest land condition present on plot
216089499010854,1,Sampled - at least one accessible forest land condition present on plot
56661230010478,1,Sampled - at least one accessible forest land condition present on plot
56672813010478,1,Sampled - at least one accessible forest land condition present on plot
56659176010478,1,Sampled - at least one accessible forest land condition present on plot
216091478010854,1,Sampled - at least one accessible forest land condition present on plot
56862568010478,1,Sampled - at least one accessible forest land condition present on plot
56781195010478,1,Sampled - at least one accessible forest land condition present on plot
56755640010478,1,Sampled - at least one accessible forest land condition present on plot
216091520010854,1,Sampled - at least one accessible forest land condition present on plot
56686025010478,1,Sampled - at least one accessible forest land condition present on plot
216092555010854,1,Sampled - at least one accessible forest land condition present on plot
56935437010478,1,Sampled - at least one accessible forest land condition present on plot
216089188010854,1,Sampled - at least one accessible forest land condition present on plot
56708684010478,1,Sampled - at least one accessible forest land condition present on plot
56590292010478,1,Sampled - at least one accessible forest land condition present on plot
216091539010854,1,Sampled - at least one accessible forest land condition present on plot
216089795010854,1,Sampled - at least one accessible forest land condition present on plot
216089455010854,1,Sampled - at least one accessible forest land condition present on plot
56917769010478,1,Sampled - at 

2025-01-23 02:14:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:14:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:14:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:14:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 57
2025-01-23 02:14:46 - snowflake.connector.connection - INFO - closed
2025-01-23 02:14:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:14:46 - root - INFO - SQL:
-- Corrected SQL 14
SELECT DISTINCT
    "plot_state_code",
    "plot_state_code_name"
FROM "USFS_FIA"."USFS_FIA"."PLOT"
WHERE "plot_state_code" IS NOT NULL
  AND "plot_state_code_name" IS NOT NULL
LIMIT 100
Results:
plot_state_code,plot_state_code_name
10,Delaware
8,Colorado
64,Federated States of Micronesia
60,American Samoa
41,Oregon
6,California
70,Palau
34,New Jersey
50,Vermont
40,Oklahoma
24,Maryland
30,Montana
21,Kentucky
1,Alabama
47,Tennessee
48,Texas
22,Louisiana
17,Illinois
42,Pennsylvania
26,Michigan
28,Mississippi
78,U.S. Virgin Islands
35,New Mexico
16,Idaho
12,Florida
2,Alaska
20,Kansas
5,Arkansas
33,New Hampshire
31,Nebraska
25,Massachusetts
23,Maine
46,South Dakota
39,Ohio
18,Indiana
49,Utah
56,Wyoming
66,Guam
69,Northern Mariana Islands
19,Iowa
13,Georgia
37,North Carolina
51,Virginia
55,Wisconsin
44,Rhode Island
4,Arizona
45,South Carolina
72,Puerto Rico
9,Connecticut
54,West Virginia
29,Missouri
27,Minnesota
38,North Dakota
15,Hawaii
53,Washington
36,New York
32,Nevada

2025-01-23 02:14:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:14:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:14:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:14:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-23 02:14:48 - snowflake.connector.connection - INFO - closed
2025-01-23 02:14:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:14:48 - root - INFO - SQL:
-- Corrected SQL 15
SELECT
    P."plot_state_code",
    P."plot_state_code_name",
    P."plot_inventory_year",
    COUNT(*) AS "condition_count"
FROM "USFS_FIA"."USFS_FIA"."PLOT" P
JOIN "USFS_FIA"."USFS_FIA"."CONDITION" C
    ON P."plot_sequence_number" = C."plot_sequence_number"
WHERE P."plot_sequence_number" IS NOT NULL
  AND C."plot_sequence_number" IS NOT NULL
GROUP BY
    P."plot_state_code",
    P."plot_state_code_name",
    P."plot_inventory_year"
HAVING COUNT(*) > 0
ORDER BY "condition_count" DESC
LIMIT 100
Results:
plot_state_code,plot_state_code_name,plot_inventory_year,condition_count
27,Minnesota,1990,43957
27,Minnesota,1977,36478
20,Kansas,1981,23705
46,South Dakota,1980,23206
26,Michigan,1993,18484
38,North Dakota,1980,18214
20,Kansas,1994,18142
29,Missouri,1989,17270
55,Wisconsin,1983,15908
46,South Dakota,1995,15773
30,Montana,1989,15432
26,Michigan,1980,14958
32,Nevada,1989,14788
31,Nebraska,1983,14449
12,Florida,1995,13712
55,Wisconsin,1996,13635
13,Georgia,1997,13296
19,Iowa,1990,12767
17,Illinois,1998,12608
12,Florida,1987,12441
13,Georgia,1989,12015
13,Georgia,1982,11820
35,New Mexico,1999,11626
18,Indiana,1986,11440
56,Wyoming,2000,11267
12,Florida,1980,11130
17,Illinois,1985,10957
38,North Dakota,1995,10816
35,New Mexico,1987,10095
37,North Carolina,1990,10018
37,North Carolina,1984,9373
16,Idaho,1991,9160
4,Arizona,1999,9074
37,North Carolina,2002,8715
1,Alabama,2000,8543
49,Utah,1993,8515
37,North Carolina,1974,8398
4,Arizona,1985,8269
56,Wyoming,1984,7724
51,Virginia,1992,7652
51,Virginia,1985,7652
6,California,1994,7587
41,Oregon,1999,7517
28,Mississippi,2006,7293
18,Indiana,1998,7254
51,Virginia,1977,7116
31,Nebraska,1994,7092
45,South Carolina,1993,7031
45,South Carolina,1986,7020
13,Georgia,1972,6712
45,South Carolina,1978,6627
8,Colorado,1984,6535
47,Tennessee,1999,6389
5,Arkansas,1995,6002
5,Arkansas,1988,5968
5,Arkansas,1978,5941
1,Alabama,1982,5848
1,Alabama,1990,5827
42,Pennsylvania,1989,5447
36,New York,1993,5406
28,Mississippi,1994,5375
28,Mississippi,1987,5371
12,Florida,1970,5207
39,Ohio,1991,5056
26,Michigan,2000,4884
26,Michigan,2005,4802
26,Michigan,2007,4734
47,Tennessee,1989,4698
26,Michigan,2006,4694
26,Michigan,2002,4634
26,Michigan,2003,4595
26,Michigan,2004,4574
26,Michigan,2001,4571
55,Wisconsin,2003,4484
22,Louisiana,1984,4475
22,Louisiana,1991,4471
45,South Carolina,1968,4450
27,Minnesota,2017,4429
27,Minnesota,2018,4416
27,Minnesota,2012,4390
27,Minnesota,2015,4382
27,Minnesota,2014,4375
27,Minnesota,2010,4366
27,Minnesota,2013,4358
27,Minnesota,2016,4354
27,Minnesota,2011,4321
27,Minnesota,2005,4294
27,Minnesota,2007,4280
27,Minnesota,2009,4261
27,Minnesota,2000,4259
27,Minnesota,2001,4239
27,Minnesota,2008,4225
27,Minnesota,2006,4201
27,Minnesota,2003,4175
27,Minnesota,2004,4165
27,Minnesota,2002,4114
48,Texas,2011,4048
48,Texas,2013,4006
48,Texas,2010,3997
48,Texas,2014,3950

2025-01-23 02:14:48 - root - INFO - itercount: 0
2025-01-23 02:14:48 - root - INFO - Database Name: USFS_FIA
Schema Name: USFS_FIA
DDL describes table information.
,0
table_name,POPULATION
description,
DDL,"create or replace TABLE POPULATION (
	""stratum_assign_sequence_number"" VARCHAR(16777216),
	""stratum_sequence_number"" NUMBER(38,0),
	""plot_sequence_number"" NUMBER(38,0),
	""state_code"" NUMBER(38,0),
	""inventory_year"" NUMBER(38,0),
	""survey_unit_code"" NUMBER(38,0),
	""county_code"" NUMBER(38,0),
	""phase_2_plot_number"" NUMBER(38,0),
	""region_or_station_code"" NUMBER(38,0),
	""evaluation_identifier"" NUMBER(38,0),
	""estimation_unit"" NUMBER(38,0),
	""stratum_code"" NUMBER(38,0),
	""stratum_assign_created_by"" VARCHAR(16777216),
	""stratum_assign_created_date"" DATE,
	""stratum_assign_created_in_instance"" NUMBER(38,0),
	""stratum_assign_modified_by"" VARCHAR(16777216),
	""stratum_assign_modified_date"" DATE,
	""stratum_assign_modified_in_instance"" NUMBER(38,0),
	""estimation_unit_sequence_number"" NUMBER(38,0),
	""evaluation_sequence_number"" NUMBER(38,0),
	""estimation_unit_description"" VARCHAR(16777216),
	""land_area_within_the_estimation_unit"" FLOAT,
	""total_area_within_the_estimation_unit"" FLOAT,
	""area_used_to_calculate_all_expansion_factors"" FLOAT,
	""area_source"" VARCHAR(16777216),
	""phase_1_point_count_for_the_estimation_unit"" NUMBER(38,0),
	""phase_1_source"" VARCHAR(16777216),
	""eval_unit_created_by"" VARCHAR(16777216),
	""eval_unit_created_date"" DATE,
	""eval_unit_created_in_instance"" NUMBER(38,0),
	""eval_unit_modified_by"" VARCHAR(16777216),
	""eval_unit_modified_date"" DATE,
	""eval_unit_modified_in_instance"" NUMBER(38,0),
	""evaluation_group_sequence_number"" NUMBER(38,0),
	""evaluation_description"" VARCHAR(16777216),
	""location_name"" VARCHAR(16777216),
	""report_year_name"" VARCHAR(16777216),
	""start_inventory_year"" VARCHAR(16777216),
	""end_inventory_year"" VARCHAR(16777216),
	""land_only"" VARCHAR(16777216),
	""timberland_only"" VARCHAR(16777216),
	""growth_accounting"" VARCHAR(16777216),
	""estimation_method"" VARCHAR(16777216),
	""notes"" VARCHAR(16777216),
	""pop_evaluation_created_by"" VARCHAR(16777216),
	""pop_evaluation_created_date"" DATE,
	""pop_evaluation_created_in_instance"" NUMBER(38,0),
	""pop_evaluation_modified_by"" VARCHAR(16777216),
	""pop_evaluation_modified_date"" DATE,
	""pop_evaluation_modified_in_instance"" NUMBER(38,0),
	""evaluation_type_sequence_number"" NUMBER(38,0),
	""evaluation_type"" VARCHAR(16777216),
	""eval_type_created_by"" VARCHAR(16777216),
	""eval_type_created_date"" DATE,
	""eval_type_created_in_instance"" NUMBER(38,0),
	""eval_type_modified_by"" VARCHAR(16777216),
	""eval_type_modified_date"" DATE,
	""eval_type_modified_in_instance"" NUMBER(38,0),
	""stratum_description"" VARCHAR(16777216),
	""phase_1_point_count"" NUMBER(38,0),
	""phase_2_point_count"" NUMBER(38,0),
	""expansion_factor"" FLOAT,
	""adjustment_factor_for_the_macroplot"" FLOAT,
	""adjustment_factor_for_the_subplot"" FLOAT,
	""adjustment_factor_for_the_microplot"" FLOAT,
	""adjustment_factor_for_coarse_woody_debris"" FLOAT,
	""adjustment_factor_for_small_fine_woody_debris"" FLOAT,
	""adjustment_factor_for_large_fine_woody_debris"" FLOAT,
	""adjustment_factor_for_the_duff_and_litter_layer"" FLOAT,
	""pop_stratum_created_by"" VARCHAR(16777216),
	""pop_stratum_created_date"" DATE,
	""pop_stratum_created_in_instance"" NUMBER(38,0),
	""pop_stratum_modified_by"" VARCHAR(16777216),
	""pop_stratum_modified_date"" DATE,
	""pop_stratum_modified_in_instance"" NUMBER(38,0),
	""pop_stratum_adjustment_factor_for_piles"" FLOAT,
	""evaluation_group"" NUMBER(38,0),
	""evaluation_group_description"" VARCHAR(16777216),
	""pop_evaluation_group_created_by"" VARCHAR(16777216),
	""pop_evaluation_group_created_date"" DATE,
	""pop_evaluation_group_created_in_instance"" NUMBER(38,0),
	""pop_evaluation_group_modified_by"" VARCHAR(16777216),
	""pop_evaluation_group_modified_date"" DATE,
	""pop_evaluation_group_modified_in_instance"" NUMBER(38,0)
);"

,1
table_name,POPULATION_EVALUATION_GROUP
description,
DDL,"create or replace TABLE POPULATION_EVALUATION_GROUP (
	""evaluation_group_sequence_number"" NUMBER(38,0),
	""region_or_station_code"" NUMBER(38,0),
	""evaluation_group"" NUMBER(38,0),
	""evaluation_group_description"" VARCHAR(16777216),
	""state_code"" NUMBER(38,0),
	""notes"" VARCHAR(16777216),
	""pop_evaluation_group_created_by"" VARCHAR(16777216),
	""pop_evaluation_group_created_date"" DATE,
	""pop_evaluation_group_created_in_instance"" NUMBER(38,0),
	""pop_evaluation_group_modified_by"" VARCHAR(16777216),
	""pop_evaluation_group_modified_date"" DATE,
	""pop_evaluation_group_modified_in_instance"" NUMBER(38,0)
);"

,2
table_name,CONDITION
description,
DDL,"create or replace TABLE CONDITION (
	""sequence_number"" NUMBER(38,0),
	""plot_sequence_number"" NUMBER(38,0),
	""inventory_year"" NUMBER(38,0),
	""state_code"" NUMBER(38,0),
	""state_code_name"" VARCHAR(16777216),
	""survey_unit_code"" NUMBER(38,0),
	""survey_unit_code_name"" VARCHAR(16777216),
	""county_code"" NUMBER(38,0),
	""county_code_name"" VARCHAR(16777216),
	""phase_2_plot_number"" NUMBER(38,0),
	""condition_class_number"" NUMBER(38,0),
	""condition_status_code"" NUMBER(38,0),
	""condition_status_code_name"" VARCHAR(16777216),
	""condition_nonsampled_reason_code"" NUMBER(38,0),
	""condition_nonsampled_reason_code_name"" VARCHAR(16777216),
	""reserved_status_code"" NUMBER(38,0),
	""reserved_status_code_name"" VARCHAR(16777216),
	""owner_class_code"" NUMBER(38,0),
	""owner_class_code_name"" VARCHAR(16777216),
	""owner_group_code"" NUMBER(38,0),
	""owner_group_code_name"" VARCHAR(16777216),
	""private_owner_industrial_status_code"" BOOLEAN,
	""private_owner_industrial_status_code_name"" VARCHAR(16777216),
	""administrative_forest_code"" NUMBER(38,0),
	""administrative_forest_code_name"" VARCHAR(16777216),
	""forest_type_code"" NUMBER(38,0),
	""forest_type_code_name"" VARCHAR(16777216),
	""field_forest_type_code"" NUMBER(38,0),
	""field_forest_type_code_name"" VARCHAR(16777216),
	""mapping_density"" NUMBER(38,0),
	""mapping_density_name"" VARCHAR(16777216),
	""stand_age"" NUMBER(38,0),
	""standsize_class_code"" NUMBER(38,0),
	""standsize_class_code_name"" VARCHAR(16777216),
	""field_standsize_class_code"" NUMBER(38,0),
	""field_standsize_class_code_name"" VARCHAR(16777216),
	""site_productivity_class_code"" NUMBER(38,0),
	""site_productivity_class_code_name"" VARCHAR(16777216),
	""site_index_for_the_condition"" NUMBER(38,0),
	""site_index_base_age"" NUMBER(38,0),
	""site_index_species_code"" NUMBER(38,0),
	""stand_origin_code"" BOOLEAN,
	""stand_origin_code_name"" VARCHAR(16777216),
	""stand_origin_species_code"" NUMBER(38,0),
	""stand_origin_species_code_name"" VARCHAR(16777216),
	""proportion_basis"" VARCHAR(16777216),
	""condition_proportion_unadjusted"" FLOAT,
	""microplot_proportion_unadjusted"" FLOAT,
	""subplot_proportion_unadjusted"" FLOAT,
	""macroplot_proportion_unadjusted"" FLOAT,
	""slope"" NUMBER(38,0),
	""aspect"" NUMBER(38,0),
	""physiographic_class_code"" NUMBER(38,0),
	""physiographic_class_code_name"" VARCHAR(16777216),
	""growingstock_stocking_code"" VARCHAR(16777216),
	""growingstock_stocking_code_name"" VARCHAR(16777216),
	""all_live_stocking_code"" NUMBER(38,0),
	""disturbance_code_1"" NUMBER(38,0),
	""disturbance_code_1_name"" VARCHAR(16777216),
	""disturbance_year_1"" NUMBER(38,0),
	""disturbance_code_2"" NUMBER(38,0),
	""disturbance_year_2"" NUMBER(38,0),
	""disturbance_code_3"" NUMBER(38,0),
	""disturbance_year_3"" NUMBER(38,0),
	""treatment_code_1"" NUMBER(38,0),
	""treatment_code_1_name"" VARCHAR(16777216),
	""treatment_year_1"" NUMBER(38,0),
	""treatment_code_2"" NUMBER(38,0),
	""treatment_year_2"" NUMBER(38,0),
	""treatment_code_3"" NUMBER(38,0),
	""treatment_year_3"" NUMBER(38,0),
	""present_nonforest_code"" NUMBER(38,0),
	""present_nonforest_code_name"" VARCHAR(16777216),
	""basal_area_per_acre_of_live_trees"" FLOAT,
	""fieldrecorded_stand_age"" NUMBER(38,0),
	""alllivetree_stocking_percent"" FLOAT,
	""growingstock_stocking_percent"" FLOAT,
	""forest_type_code_calculated"" NUMBER(38,0),
	""habitat_type_code_1"" VARCHAR(16777216),
	""habitat_type_code_1_publication_code"" VARCHAR(16777216),
	""habitat_type_code_1_description_publication_code"" VARCHAR(16777216),
	""habitat_type_code_2"" VARCHAR(16777216),
	""habitat_type_code_2_publication_code"" VARCHAR(16777216),
	""habitat_type_code_2_description_publication_code"" VARCHAR(16777216),
	""mixed_conifer_code"" VARCHAR(16777216),
	""mixed_conifer_code_name"" VARCHAR(16777216),
	""volume_location_group"" VARCHAR(16777216),
	""volume_location_group_name"" VARCHAR(16777216),
	""site_productivity_class_code_estimated"" NUMBER(38,0),
	""site_productivity_class_code_estimated_name"" VARCHAR(16777216),
	""site_tree_tree_number"" NUMBER(38,0),
	""site_class_method"" NUMBER(38,0),
	""site_class_method_name"" VARCHAR(16777216),
	""carbon_in_down_dead"" FLOAT,
	""carbon_in_litter"" FLOAT,
	""carbon_in_soil_organic_material"" FLOAT,
	""carbon_in_standing_dead_trees"" FLOAT,
	""carbon_in_understory_aboveground"" FLOAT,
	""carbon_in_understory_belowground"" FLOAT,
	""created_by"" VARCHAR(16777216),
	""created_date"" DATE,
	""created_in_instance"" NUMBER(38,0),
	""modified_by"" VARCHAR(16777216),
	""modified_date"" DATE,
	""modified_in_instance"" NUMBER(38,0),
	""inventory_cycle_number"" NUMBER(38,0),
	""inventory_subcycle_number"" NUMBER(38,0),
	""soil_rooting_depth_pacific_northwest_research_station"" NUMBER(38,0),
	""soil_rooting_depth_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""present_ground_land_class_pacific_northwest_research_station"" NUMBER(38,0),
	""present_ground_land_class_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""plant_stockability_factor_pacific_northwest_research_station"" FLOAT,
	""stand_condition_code_pacific_northwest_research_station"" NUMBER(38,0),
	""stand_condition_code_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""stand_structure_code_pacific_northwest_research_station"" NUMBER(38,0),
	""stand_structure_code_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""stump_code_pacific_northwest_research_station"" VARCHAR(16777216),
	""stump_code_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""fire_southern_research_station"" BOOLEAN,
	""fire_southern_research_station_name"" VARCHAR(16777216),
	""grazing_southern_research_station"" BOOLEAN,
	""grazing_southern_research_station_name"" VARCHAR(16777216),
	""harvest_type_code_1_southern_research_station"" NUMBER(38,0),
	""harvest_type_code_1_southern_research_station_name"" VARCHAR(16777216),
	""harvest_type_code_2_southern_research_station"" NUMBER(38,0),
	""harvest_type_code_3_southern_research_station"" NUMBER(38,0),
	""land_use_southern_research_station"" NUMBER(38,0),
	""land_use_southern_research_station_name"" VARCHAR(16777216),
	""operability_southern_research_station"" NUMBER(38,0),
	""operability_southern_research_station_name"" VARCHAR(16777216),
	""stand_structure_southern_research_station"" NUMBER(38,0),
	""stand_structure_southern_research_station_name"" VARCHAR(16777216),
	""nonforest_condition_status_code"" NUMBER(38,0),
	""nonforest_condition_status_code_name"" VARCHAR(16777216),
	""nonforest_condition_nonsampled_reason_code"" NUMBER(38,0),
	""nonforest_condition_nonsampled_reason_code_name"" VARCHAR(16777216),
	""canopy_cover_sample_method_code"" NUMBER(38,0),
	""canopy_cover_sample_method_code_name"" VARCHAR(16777216),
	""live_canopy_cover_percent"" NUMBER(38,0),
	""live_plus_missing_canopy_cover_percent"" NUMBER(38,0),
	""number_of_live_stems"" NUMBER(38,0),
	""owner_subclass_code"" VARCHAR(16777216),
	""owner_subclass_code_name"" VARCHAR(16777216),
	""industrial_code_in_fiadb"" VARCHAR(16777216),
	""industrial_code_in_fiadb_name"" VARCHAR(16777216),
	""reserve_code_field"" BOOLEAN,
	""reserve_code_field_name"" VARCHAR(16777216),
	""administratively_withdrawn_code"" VARCHAR(16777216),
	""administratively_withdrawn_code_name"" VARCHAR(16777216),
	""chaining_code"" BOOLEAN,
	""chaining_code_name"" VARCHAR(16777216),
	""land_cover_class"" NUMBER(38,0),
	""land_cover_class_name"" VARCHAR(16777216),
	""current_afforestation_code"" BOOLEAN,
	""current_afforestation_code_name"" VARCHAR(16777216),
	""previous_afforestation_code"" BOOLEAN,
	""previous_afforestation_code_name"" VARCHAR(16777216),
	""dwm_condition_fuelbed_type_code"" VARCHAR(16777216),
	""dwm_condition_fuelbed_type_code_name"" VARCHAR(16777216),
	""unique_condition"" VARCHAR(16777216)
);"

,3
table_name,ESTIMATED_TIMBERLAND_ACRES
description,
DDL,"create or replace TABLE ESTIMATED_TIMBERLAND_ACRES (
	""plot_sequence_number"" NUMBER(38,0),
	""evaluation_type"" VARCHAR(16777216),
	""evaluation_group"" NUMBER(38,0),
	""evaluation_description"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""inventory_year"" NUMBER(38,0),
	""state_code"" NUMBER(38,0),
	""macroplot_acres"" FLOAT,
	""subplot_acres"" FLOAT
);"

,4
table_name,POPULATION_STRATUM
description,
DDL,"create or replace TABLE POPULATION_STRATUM (
	""stratum_sequence_number"" NUMBER(38,0),
	""estimation_unit_sequence_number"" NUMBER(38,0),
	""region_or_station_code"" NUMBER(38,0),
	""evaluation_identifier"" NUMBER(38,0),
	""estimation_unit"" NUMBER(38,0),
	""stratum_code"" NUMBER(38,0),
	""stratum_description"" VARCHAR(16777216),
	""state_code"" NUMBER(38,0),
	""phase_1_point_count"" NUMBER(38,0),
	""phase_2_point_count"" NUMBER(38,0),
	""expansion_factor"" FLOAT,
	""adjustment_factor_for_the_macroplot"" FLOAT,
	""adjustment_factor_for_the_subplot"" FLOAT,
	""adjustment_factor_for_the_microplot"" FLOAT,
	""adjustment_factor_for_coarse_woody_debris"" FLOAT,
	""adjustment_factor_for_small_fine_woody_debris"" FLOAT,
	""adjustment_factor_for_large_fine_woody_debris"" FLOAT,
	""adjustment_factor_for_the_duff_and_litter_layer"" FLOAT,
	""pop_stratum_created_by"" VARCHAR(16777216),
	""pop_stratum_created_date"" DATE,
	""pop_stratum_created_in_instance"" NUMBER(38,0),
	""pop_stratum_modified_by"" VARCHAR(16777216),
	""pop_stratum_modified_date"" DATE,
	""pop_stratum_modified_in_instance"" NUMBER(38,0),
	""pop_stratum_adjustment_factor_for_piles"" FLOAT,
	""adj_factor_regen_micr"" VARCHAR(16777216),
	""adj_factor_inv_subp"" VARCHAR(16777216),
	""adj_factor_p2veg_subp"" VARCHAR(16777216),
	""adj_factor_grndlyr_quad"" VARCHAR(16777216)
);"

,5
table_name,PLOT
description,
DDL,"create or replace TABLE PLOT (
	""plot_sequence_number"" NUMBER(38,0),
	""survey_sequence_number"" NUMBER(38,0),
	""county_sequence_number"" NUMBER(38,0),
	""previous_plot_sequence_number"" NUMBER(38,0),
	""plot_inventory_year"" NUMBER(38,0),
	""plot_state_code"" NUMBER(38,0),
	""plot_state_code_name"" VARCHAR(16777216),
	""plot_survey_unit_code"" NUMBER(38,0),
	""plot_county_code"" NUMBER(38,0),
	""plot_phase_2_plot_number"" NUMBER(38,0),
	""plot_status_code"" NUMBER(38,0),
	""plot_status_code_name"" VARCHAR(16777216),
	""plot_nonsampled_reason_code"" NUMBER(38,0),
	""plot_nonsampled_reason_code_name"" VARCHAR(16777216),
	""measurement_year"" NUMBER(38,0),
	""measurement_month"" NUMBER(38,0),
	""measurement_month_name"" VARCHAR(16777216),
	""measurement_day"" NUMBER(38,0),
	""remeasurement_period"" FLOAT,
	""sample_kind_code"" NUMBER(38,0),
	""sample_kind_code_name"" VARCHAR(16777216),
	""plot_design_code"" NUMBER(38,0),
	""horizontal_distance_to_improved_road_code"" NUMBER(38,0),
	""horizontal_distance_to_improved_road_code_name"" VARCHAR(16777216),
	""water_on_plot_code"" NUMBER(38,0),
	""water_on_plot_code_name"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""elevation"" NUMBER(38,0),
	""type_of_annual_volume_growth_code"" NUMBER(38,0),
	""type_of_annual_volume_growth_code_name"" VARCHAR(16777216),
	""type_of_annual_mortality_volume_code"" NUMBER(38,0),
	""type_of_annual_mortality_volume_code_name"" VARCHAR(16777216),
	""phase_2_panel_number"" NUMBER(38,0),
	""phase_3_panel_number"" NUMBER(38,0),
	""ecological_subsection_code"" VARCHAR(16777216),
	""congressional_district_code"" NUMBER(38,0),
	""manual_version_number"" FLOAT,
	""sample_kind_code_north_central"" NUMBER(38,0),
	""quality_assurance_status"" NUMBER(38,0),
	""quality_assurance_status_name"" VARCHAR(16777216),
	""plot_created_by"" VARCHAR(16777216),
	""plot_created_date"" DATE,
	""plot_created_in_instance"" NUMBER(38,0),
	""plot_modified_by"" VARCHAR(16777216),
	""plot_modified_date"" DATE,
	""plot_modified_in_instance"" NUMBER(38,0),
	""microplot_location"" VARCHAR(16777216),
	""declination"" FLOAT,
	""emap_hexagon"" NUMBER(38,0),
	""sample_method_code"" NUMBER(38,0),
	""sample_method_code_name"" VARCHAR(16777216),
	""subplots_examined_code"" NUMBER(38,0),
	""subplots_examined_code_name"" VARCHAR(16777216),
	""macroplot_breakpoint_diameter"" NUMBER(38,0),
	""intensity"" NUMBER(38,0),
	""plot_inventory_cycle_number"" NUMBER(38,0),
	""plot_inventory_subcycle_number"" NUMBER(38,0),
	""ecological_unit_pacific_northwest_research_station"" VARCHAR(16777216),
	""topographic_position_pacific_northwest_research_station"" NUMBER(38,0),
	""topographic_position_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""nonforest_sampling_status_code"" NUMBER(38,0),
	""nonforest_sampling_status_code_name"" VARCHAR(16777216),
	""nonforest_plot_status_code"" NUMBER(38,0),
	""nonforest_plot_status_code_name"" VARCHAR(16777216),
	""nonforest_plot_nonsampled_reason_code"" NUMBER(38,0),
	""nonforest_plot_nonsampled_reason_code_name"" VARCHAR(16777216),
	""p2_vegetation_sampling_status_code"" NUMBER(38,0),
	""p2_vegetation_sampling_status_code_name"" VARCHAR(16777216),
	""p2_vegetation_sampling_level_detail_code"" NUMBER(38,0),
	""p2_vegetation_sampling_level_detail_code_name"" VARCHAR(16777216),
	""invasive_sampling_status_code"" NUMBER(38,0),
	""invasive_sampling_status_code_name"" VARCHAR(16777216),
	""invasive_specimen_rule_code"" NUMBER(38,0),
	""invasive_specimen_rule_code_name"" VARCHAR(16777216),
	""design_code_periodic_to_annual"" NUMBER(38,0),
	""manual_version_of_the_data"" FLOAT,
	""subpanel"" NUMBER(38,0),
	""subpanel_name"" VARCHAR(16777216),
	""unique_plot"" VARCHAR(16777216),
	""colocated_code_rmrs"" VARCHAR(16777216),
	""condchng_code_rmrs"" VARCHAR(16777216),
	""futfor_code_rmrs"" VARCHAR(16777216),
	""manual_ncrs"" VARCHAR(16777216),
	""manual_ners"" VARCHAR(16777216),
	""manual_rmrs"" VARCHAR(16777216),
	""pac_island_pnwrs"" VARCHAR(16777216),
	""plot_season_ners"" VARCHAR(16777216),
	""precipitation"" VARCHAR(16777216),
	""prev_microplot_loc_rmrs"" VARCHAR(16777216),
	""prev_plot_status_code_rmrs"" VARCHAR(16777216),
	""reuse_code_1"" VARCHAR(16777216),
	""reuse_code_2"" VARCHAR(16777216),
	""reuse_code_3"" VARCHAR(16777216)
);"

,6
table_name,POPULATION_EVALUATION_TYPE
description,
DDL,"create or replace TABLE POPULATION_EVALUATION_TYPE (
	""evaluation_type_sequence_number"" NUMBER(38,0),
	""evaluation_group_sequence_number"" NUMBER(38,0),
	""evaluation_sequence_number"" NUMBER(38,0),
	""evaluation_type"" VARCHAR(16777216),
	""eval_type_created_by"" VARCHAR(16777216),
	""eval_type_created_date"" DATE,
	""eval_type_created_in_instance"" NUMBER(38,0),
	""eval_type_modified_by"" VARCHAR(16777216),
	""eval_type_modified_date"" DATE,
	""eval_type_modified_in_instance"" NUMBER(38,0)
);"

,7
table_name,POPULATION_STRATUM_ASSIGN
description,
DDL,"create or replace TABLE POPULATION_STRATUM_ASSIGN (
	""stratum_assign_sequence_number"" VARCHAR(16777216),
	""stratum_sequence_number"" NUMBER(38,0),
	""plot_sequence_number"" NUMBER(38,0),
	""state_code"" NUMBER(38,0),
	""inventory_year"" NUMBER(38,0),
	""survey_unit_code"" NUMBER(38,0),
	""county_code"" NUMBER(38,0),
	""phase_2_plot_number"" NUMBER(38,0),
	""region_or_station_code"" NUMBER(38,0),
	""evaluation_identifier"" NUMBER(38,0),
	""estimation_unit"" NUMBER(38,0),
	""stratum_code"" NUMBER(38,0),
	""stratum_assign_created_by"" VARCHAR(16777216),
	""stratum_assign_created_date"" DATE,
	""stratum_assign_created_in_instance"" NUMBER(38,0),
	""stratum_assign_modified_by"" VARCHAR(16777216),
	""stratum_assign_modified_date"" DATE,
	""stratum_assign_modified_in_instance"" NUMBER(38,0)
);"

,8
table_name,ESTIMATED_FORESTLAND_ACRES
description,
DDL,"create or replace TABLE ESTIMATED_FORESTLAND_ACRES (
	""plot_sequence_number"" NUMBER(38,0),
	""evaluation_type"" VARCHAR(16777216),
	""evaluation_group"" NUMBER(38,0),
	""evaluation_description"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""inventory_year"" NUMBER(38,0),
	""state_code"" NUMBER(38,0),
	""macroplot_acres"" FLOAT,
	""subplot_acres"" FLOAT
);"

,9
table_name,PLOT_TREE
description,
DDL,"create or replace TABLE PLOT_TREE (
	""plot_sequence_number"" NUMBER(38,0),
	""survey_sequence_number"" NUMBER(38,0),
	""county_sequence_number"" NUMBER(38,0),
	""previous_plot_sequence_number"" NUMBER(38,0),
	""plot_inventory_year"" NUMBER(38,0),
	""plot_state_code"" NUMBER(38,0),
	""plot_state_code_name"" VARCHAR(16777216),
	""plot_survey_unit_code"" NUMBER(38,0),
	""plot_county_code"" NUMBER(38,0),
	""plot_phase_2_plot_number"" NUMBER(38,0),
	""plot_status_code"" NUMBER(38,0),
	""plot_status_code_name"" VARCHAR(16777216),
	""plot_nonsampled_reason_code"" NUMBER(38,0),
	""plot_nonsampled_reason_code_name"" VARCHAR(16777216),
	""measurement_year"" NUMBER(38,0),
	""measurement_month"" NUMBER(38,0),
	""measurement_month_name"" VARCHAR(16777216),
	""measurement_day"" NUMBER(38,0),
	""remeasurement_period"" FLOAT,
	""sample_kind_code"" NUMBER(38,0),
	""sample_kind_code_name"" VARCHAR(16777216),
	""plot_design_code"" NUMBER(38,0),
	""horizontal_distance_to_improved_road_code"" NUMBER(38,0),
	""horizontal_distance_to_improved_road_code_name"" VARCHAR(16777216),
	""water_on_plot_code"" NUMBER(38,0),
	""water_on_plot_code_name"" VARCHAR(16777216),
	""latitude"" FLOAT,
	""longitude"" FLOAT,
	""elevation"" NUMBER(38,0),
	""type_of_annual_volume_growth_code"" NUMBER(38,0),
	""type_of_annual_volume_growth_code_name"" VARCHAR(16777216),
	""type_of_annual_mortality_volume_code"" NUMBER(38,0),
	""type_of_annual_mortality_volume_code_name"" VARCHAR(16777216),
	""phase_2_panel_number"" NUMBER(38,0),
	""phase_3_panel_number"" NUMBER(38,0),
	""ecological_subsection_code"" VARCHAR(16777216),
	""congressional_district_code"" NUMBER(38,0),
	""manual_version_number"" FLOAT,
	""sample_kind_code_north_central"" NUMBER(38,0),
	""quality_assurance_status"" NUMBER(38,0),
	""quality_assurance_status_name"" VARCHAR(16777216),
	""plot_created_by"" VARCHAR(16777216),
	""plot_created_date"" DATE,
	""plot_created_in_instance"" NUMBER(38,0),
	""plot_modified_by"" VARCHAR(16777216),
	""plot_modified_date"" DATE,
	""plot_modified_in_instance"" NUMBER(38,0),
	""microplot_location"" VARCHAR(16777216),
	""declination"" FLOAT,
	""emap_hexagon"" NUMBER(38,0),
	""sample_method_code"" NUMBER(38,0),
	""sample_method_code_name"" VARCHAR(16777216),
	""subplots_examined_code"" NUMBER(38,0),
	""subplots_examined_code_name"" VARCHAR(16777216),
	""macroplot_breakpoint_diameter"" NUMBER(38,0),
	""intensity"" NUMBER(38,0),
	""plot_inventory_cycle_number"" NUMBER(38,0),
	""plot_inventory_subcycle_number"" NUMBER(38,0),
	""ecological_unit_pacific_northwest_research_station"" VARCHAR(16777216),
	""topographic_position_pacific_northwest_research_station"" NUMBER(38,0),
	""topographic_position_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""nonforest_sampling_status_code"" NUMBER(38,0),
	""nonforest_sampling_status_code_name"" VARCHAR(16777216),
	""nonforest_plot_status_code"" NUMBER(38,0),
	""nonforest_plot_status_code_name"" VARCHAR(16777216),
	""nonforest_plot_nonsampled_reason_code"" NUMBER(38,0),
	""nonforest_plot_nonsampled_reason_code_name"" VARCHAR(16777216),
	""p2_vegetation_sampling_status_code"" NUMBER(38,0),
	""p2_vegetation_sampling_status_code_name"" VARCHAR(16777216),
	""p2_vegetation_sampling_level_detail_code"" NUMBER(38,0),
	""p2_vegetation_sampling_level_detail_code_name"" VARCHAR(16777216),
	""invasive_sampling_status_code"" NUMBER(38,0),
	""invasive_sampling_status_code_name"" VARCHAR(16777216),
	""invasive_specimen_rule_code"" NUMBER(38,0),
	""invasive_specimen_rule_code_name"" VARCHAR(16777216),
	""design_code_periodic_to_annual"" NUMBER(38,0),
	""manual_version_of_the_data"" FLOAT,
	""subpanel"" NUMBER(38,0),
	""subpanel_name"" VARCHAR(16777216),
	""unique_plot"" VARCHAR(16777216),
	""colocated_code_rmrs"" VARCHAR(16777216),
	""condchng_code_rmrs"" VARCHAR(16777216),
	""futfor_code_rmrs"" VARCHAR(16777216),
	""manual_ncrs"" VARCHAR(16777216),
	""manual_ners"" VARCHAR(16777216),
	""manual_rmrs"" VARCHAR(16777216),
	""pac_island_pnwrs"" VARCHAR(16777216),
	""plot_season_ners"" VARCHAR(16777216),
	""precipitation"" VARCHAR(16777216),
	""prev_microplot_loc_rmrs"" VARCHAR(16777216),
	""prev_plot_status_code_rmrs"" VARCHAR(16777216),
	""reuse_code_1"" VARCHAR(16777216),
	""reuse_code_2"" VARCHAR(16777216),
	""reuse_code_3"" VARCHAR(16777216),
	""tree_sequence_number"" NUMBER(38,0),
	""previous_tree_sequence_number"" NUMBER(38,0),
	""tree_inventory_year"" NUMBER(38,0),
	""tree_state_code"" NUMBER(38,0),
	""tree_survey_unit_code"" NUMBER(38,0),
	""tree_county_code"" NUMBER(38,0),
	""tree_phase_2_plot_number"" NUMBER(38,0),
	""subplot_number"" NUMBER(38,0),
	""tree_record_number"" NUMBER(38,0),
	""condition_class_number"" NUMBER(38,0),
	""azimuth"" NUMBER(38,0),
	""horizontal_distance"" FLOAT,
	""previous_condition_number"" NUMBER(38,0),
	""tree_status_code"" NUMBER(38,0),
	""tree_status_code_name"" VARCHAR(16777216),
	""species_code"" NUMBER(38,0),
	""species_common_name"" VARCHAR(16777216),
	""species_scientific_name"" VARCHAR(16777216),
	""species_group_code"" NUMBER(38,0),
	""species_group_code_name"" VARCHAR(16777216),
	""current_diameter"" FLOAT,
	""diameter_height_code"" NUMBER(38,0),
	""diameter_height_code_name"" VARCHAR(16777216),
	""total_height"" NUMBER(38,0),
	""height_method_code"" NUMBER(38,0),
	""height_method_code_name"" VARCHAR(16777216),
	""actual_height"" NUMBER(38,0),
	""tree_class_code"" NUMBER(38,0),
	""tree_class_code_name"" VARCHAR(16777216),
	""compacted_crown_ratio"" NUMBER(38,0),
	""crown_class_code"" NUMBER(38,0),
	""crown_class_code_name"" VARCHAR(16777216),
	""tree_grade_code"" NUMBER(38,0),
	""cause_death_agent_code"" NUMBER(38,0),
	""cause_death_agent_code_name"" VARCHAR(16777216),
	""rotten_and_missing_cull"" NUMBER(38,0),
	""damage_location_1"" NUMBER(38,0),
	""damage_location_1_name"" VARCHAR(16777216),
	""damage_type_1"" NUMBER(38,0),
	""damage_type_1_name"" VARCHAR(16777216),
	""damage_severity_1"" NUMBER(38,0),
	""damage_severity_1_name"" VARCHAR(16777216),
	""damage_location_2"" NUMBER(38,0),
	""damage_location_2_name"" VARCHAR(16777216),
	""damage_type_2"" NUMBER(38,0),
	""damage_type_2_name"" VARCHAR(16777216),
	""damage_severity_2"" NUMBER(38,0),
	""damage_severity_2_name"" VARCHAR(16777216),
	""decay_class_code"" NUMBER(38,0),
	""decay_class_code_name"" VARCHAR(16777216),
	""tree_stocking"" FLOAT,
	""woodland_tree_species_stem_count"" NUMBER(38,0),
	""net_cubicfoot_volume"" FLOAT,
	""gross_cubicfoot_volume"" FLOAT,
	""net_cubicfoot_volume_sawlog_portion_sawtimber_tree"" FLOAT,
	""gross_cubicfoot_volume_sawlog_portion_sawtimber_tree"" FLOAT,
	""net_boardfoot_volume_sawlog_portion_sawtimber_tree"" FLOAT,
	""gross_boardfoot_volume_sawlog_portion_sawtimber_tree"" FLOAT,
	""sound_cubicfoot_volume"" FLOAT,
	""net_annual_merchantable_cubicfoot_growth_growingstock_tree_timberland"" FLOAT,
	""net_annual_merchantable_boardfoot_growth_sawtimber_tree_timberland"" FLOAT,
	""net_annual_sound_cubicfoot_growth_live_tree_timberland"" FLOAT,
	""merchantable_cubicfoot_volume_growingstock_tree_timberland_mortality_purposes"" FLOAT,
	""merchantable_boardfoot_volume_sawtimber_tree_timberland_mortality_purposes"" FLOAT,
	""sound_cubicfoot_volume_tree_timberland_mortality_purposes"" FLOAT,
	""merchantable_cubicfoot_volume_growingstock_tree_timberland_removal_purposes"" FLOAT,
	""merchantable_boardfoot_volume_sawtimber_tree_timberland_removal_purposes"" FLOAT,
	""sound_cubicfoot_volume_live_tree_timberland_removal_purposes"" FLOAT,
	""diameter_check_code"" NUMBER(38,0),
	""diameter_check_code_name"" VARCHAR(16777216),
	""mortality_year"" NUMBER(38,0),
	""salvable_dead_code"" NUMBER(38,0),
	""salvable_dead_code_name"" VARCHAR(16777216),
	""uncompacted_live_crown_ratio"" NUMBER(38,0),
	""crown_position_code"" NUMBER(38,0),
	""crown_position_code_name"" VARCHAR(16777216),
	""crown_light_exposure_code"" NUMBER(38,0),
	""crown_light_exposure_code_name"" VARCHAR(16777216),
	""crown_vigor_code_sapling"" NUMBER(38,0),
	""crown_vigor_code_sapling_name"" VARCHAR(16777216),
	""crown_density_code"" NUMBER(38,0),
	""crown_density_code_name"" VARCHAR(16777216),
	""crown_dieback_code"" NUMBER(38,0),
	""crown_dieback_code_name"" VARCHAR(16777216),
	""foliage_transparency_code"" NUMBER(38,0),
	""foliage_transparency_code_name"" VARCHAR(16777216),
	""tree_history_code"" NUMBER(38,0),
	""current_diameter_calculated"" FLOAT,
	""breast_height_age"" NUMBER(38,0),
	""total_age"" NUMBER(38,0),
	""dead_cull"" NUMBER(38,0),
	""form_cull"" NUMBER(38,0),
	""missing_top_cull_field_recorded"" NUMBER(38,0),
	""boardfoot_cull"" NUMBER(38,0),
	""cubicfoot_cull"" NUMBER(38,0),
	""boardfootcull_soundness"" NUMBER(38,0),
	""cubicfootcull_soundness"" NUMBER(38,0),
	""sawlog_height"" NUMBER(38,0),
	""bole_height"" NUMBER(38,0),
	""form_class"" NUMBER(38,0),
	""form_class_name"" VARCHAR(16777216),
	""current_height_calculated"" NUMBER(38,0),
	""hardwood_clump_code"" NUMBER(38,0),
	""calculated_site_index"" NUMBER(38,0),
	""tree_created_by"" NUMBER(38,0),
	""tree_created_date"" DATE,
	""tree_created_in_instance"" NUMBER(38,0),
	""tree_modified_by"" NUMBER(38,0),
	""tree_modified_date"" DATE,
	""tree_modified_in_instance"" NUMBER(38,0),
	""mortality_code"" NUMBER(38,0),
	""mortality_code_name"" VARCHAR(16777216),
	""height_to_diameter_measurement_point"" FLOAT,
	""rough_cull"" NUMBER(38,0),
	""mistletoe_class_code"" NUMBER(38,0),
	""mistletoe_class_code_name"" VARCHAR(16777216),
	""rotten_missing_cull_field_recorded"" NUMBER(38,0),
	""reconcile_code"" NUMBER(38,0),
	""reconcile_code_name"" VARCHAR(16777216),
	""previous_diameter"" FLOAT,
	""net_annual_merchantable_cubicfoot_growth_growingstock_tree_forest_land"" FLOAT,
	""net_annual_merchantable_boardfoot_growth_sawtimber_tree_forest_land"" FLOAT,
	""net_annual_sound_cubicfoot_growth_live_tree_forest_land"" FLOAT,
	""merchantable_cubicfoot_volume_growingstock_tree_forest_land_mortality_purposes"" FLOAT,
	""merchantable_boardfoot_volume_sawtimber_tree_forest_land_mortality_purposes"" FLOAT,
	""sound_cubicfoot_volume_tree_forest_land_mortality_purposes"" FLOAT,
	""merchantable_cubicfoot_volume_growingstock_tree_forest_land_removal_purposes"" FLOAT,
	""merchantable_boardfoot_volume_sawtimber_tree_forest_land_removal_purposes"" FLOAT,
	""sound_cubicfoot_volume_live_tree_forest_land_removal_purposes"" FLOAT,
	""periodic_annual_growth_removal_mortality_flag"" VARCHAR(16777216),
	""tree_class_code_northeastern_research_station"" NUMBER(38,0),
	""tree_class_code_northeastern_research_station_name"" VARCHAR(16777216),
	""tree_class_code_southern_research_station"" NUMBER(38,0),
	""tree_class_code_southern_research_station_name"" VARCHAR(16777216),
	""tree_class_code_north_central_research_station"" NUMBER(38,0),
	""tree_class_code_north_central_research_station_name"" VARCHAR(16777216),
	""tree_class_code_rocky_mountain_research_station"" NUMBER(38,0),
	""tree_class_code_rocky_mountain_research_station_name"" VARCHAR(16777216),
	""standing_dead_code"" NUMBER(38,0),
	""standing_dead_code_name"" VARCHAR(16777216),
	""previous_tree_status_code"" NUMBER(38,0),
	""previous_tree_status_code_name"" VARCHAR(16777216),
	""previous_woodland_stem_count"" VARCHAR(16777216),
	""trees_per_acre_unadjusted"" FLOAT,
	""mortality_trees_per_acre_per_year_unadjusted"" FLOAT,
	""removal_trees_per_acre_per_year_unadjusted"" FLOAT,
	""growth_trees_per_acre_unadjusted"" FLOAT,
	""dry_biomass_in_the_merchantable_bole"" FLOAT,
	""dry_biomass_top_limbs_tree"" FLOAT,
	""dry_biomass_tree_stump_at_T_1"" FLOAT,
	""aboveground_dry_biomass_saplings"" FLOAT,
	""aboveground_dry_biomass_woodland_tree_species"" FLOAT,
	""belowground_dry_biomass"" FLOAT,
	""aboveground_carbon"" FLOAT,
	""belowground_carbon"" FLOAT,
	""tree_inventory_cycle_number"" NUMBER(38,0),
	""tree_inventory_subcycle_number"" NUMBER(38,0),
	""tree_bored_code_pacific_northwest_research_station"" NUMBER(38,0),
	""tree_bored_code_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""damage_location_1_pacific_northwest_research_station"" NUMBER(38,0),
	""damage_location_1_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""damage_location_2_pacific_northwest_research_station"" NUMBER(38,0),
	""damage_location_2_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""diameter_check_pacific_northwest_research_station"" NUMBER(38,0),
	""diameter_check_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""damage_agent_1_pacific_northwest_research_station"" NUMBER(38,0),
	""damage_agent_2_pacific_northwest_research_station"" NUMBER(38,0),
	""damage_agent_3_pacific_northwest_research_station"" NUMBER(38,0),
	""leafy_mistletoe_class_code_pacific_northwest_research_station"" NUMBER(38,0),
	""leafy_mistletoe_class_code_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""damage_severity_1_pacific_northwest_research_station_years_2001_2004"" NUMBER(38,0),
	""damage_severity_1_a_pacific_northwest_research_station"" NUMBER(38,0),
	""damage_severity_1_b_pacific_northwest_research_station"" NUMBER(38,0),
	""damage_severity_1_b_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""damage_severity_2_pacific_northwest_research_station_years_2001_2004"" NUMBER(38,0),
	""damage_severity_2_a_pacific_northwest_research_station_starting_2005"" NUMBER(38,0),
	""damage_severity_2_b_pacific_northwest_research_station_starting_2005"" VARCHAR(16777216),
	""damage_severity_3_pacific_northwest_research_station_years_2001_2004"" NUMBER(38,0),
	""unknown_damage_type_1_pacific_northwest_research_station"" NUMBER(38,0),
	""unknown_damage_type_1_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""unknown_damage_type_2_pacific_northwest_research_station"" NUMBER(38,0),
	""unknown_damage_type_2_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""previous_periodic_prism_point_tree_number_southern_research_station"" NUMBER(38,0),
	""disease_southern_research_station"" NUMBER(38,0),
	""disease_southern_research_station_name"" VARCHAR(16777216),
	""dieback_severity_southern_research_station"" NUMBER(38,0),
	""dieback_severity_southern_research_station_name"" VARCHAR(16777216),
	""damage_agent_code_1"" NUMBER(38,0),
	""damage_agent_code_1_name"" VARCHAR(16777216),
	""damage_agent_code_2"" VARCHAR(16777216),
	""damage_agent_code_2_name"" VARCHAR(16777216),
	""damage_agent_code_3"" NUMBER(38,0),
	""damage_agent_code_3_name"" VARCHAR(16777216),
	""centroid_diameter"" FLOAT,
	""calculated_centroid_diameter_height"" FLOAT,
	""actual_centroid_diameter_height"" FLOAT,
	""upper_stem_diameter"" NUMBER(38,0),
	""upper_stem_diameter_height"" NUMBER(38,0),
	""sound_cubicfoot_volume_sawlog_portion"" FLOAT,
	""dry_biomass_sawlog_portion_sawtimber_tree"" FLOAT,
	""damage_agent_code_1_southern_research_station"" NUMBER(38,0),
	""damage_agent_code_2_southern_research_station"" NUMBER(38,0),
	""damage_agent_code_3_southern_research_station"" VARCHAR(16777216),
	""aboveground_dry_biomass"" FLOAT,
	""unique_tree"" VARCHAR(16777216),
	""actualht_calc"" VARCHAR(16777216),
	""actualht_calc_code"" VARCHAR(16777216),
	""cull_bf_rotten"" VARCHAR(16777216),
	""cull_bf_rotten_code"" VARCHAR(16777216),
	""cull_bf_rough"" VARCHAR(16777216),
	""cull_bf_rough_code"" VARCHAR(16777216),
	""prevdia_fld"" VARCHAR(16777216),
	""treecl_code_31_ncrs"" VARCHAR(16777216),
	""tree_grade_ncrs"" VARCHAR(16777216),
	""boughs_available_ncrs"" VARCHAR(16777216),
	""boughs_hrvst_ncrs"" VARCHAR(16777216),
	""treecl_code_31_ners"" VARCHAR(16777216),
	""agent_code_ners"" VARCHAR(16777216),
	""bfsnd_code_ners"" VARCHAR(16777216),
	""agechk_code_rmrs"" VARCHAR(16777216),
	""dia_1yrago_rmrs"" VARCHAR(16777216),
	""growbfscr_rmrs"" VARCHAR(16777216),
	""growcfsawlog_rmrs"" VARCHAR(16777216),
	""ht_1yrago_rmrs"" VARCHAR(16777216),
	""prev_actualht_rmrs"" VARCHAR(16777216),
	""prev_agechk_code_rmrs"" VARCHAR(16777216),
	""prev_bhage_rmrs"" VARCHAR(16777216),
	""prev_ht_rmrs"" VARCHAR(16777216),
	""prev_totage_rmrs"" VARCHAR(16777216),
	""prev_treecl_code_rmrs"" VARCHAR(16777216),
	""radage_code_rmrs"" VARCHAR(16777216),
	""radgrw_rmrs"" VARCHAR(16777216),
	""volbfscrgrs_rmrs"" VARCHAR(16777216),
	""volbfscrnet_rmrs"" VARCHAR(16777216),
	""volcfdeadgrs_rmrs"" VARCHAR(16777216),
	""volcfsawgrs_rmrs"" VARCHAR(16777216),
	""volcfsawnet_rmrs"" VARCHAR(16777216),
	""volcftotnet_rmrs"" VARCHAR(16777216),
	""volcfuppgrs_rmrs"" VARCHAR(16777216),
	""volcfuppnet_rmrs"" VARCHAR(16777216),
	""sapling_fusiform_srs"" VARCHAR(16777216),
	""epiphyte_pnwrs"" VARCHAR(16777216),
	""root_ht_pnwrs"" VARCHAR(16777216),
	""cavity_use_pnwrs"" VARCHAR(16777216),
	""core_length_pnwrs"" VARCHAR(16777216),
	""culturally_killed_pnwrs"" VARCHAR(16777216),
	""dia_est_pnwrs"" VARCHAR(16777216),
	""gst_pnwrs"" VARCHAR(16777216),
	""inc10yr_pnwrs"" VARCHAR(16777216),
	""inc5yrht_pnwrs"" VARCHAR(16777216),
	""inc5yr_pnwrs"" VARCHAR(16777216),
	""ring_count_inner_2inches_pnwrs"" VARCHAR(16777216),
	""ring_count_pnwrs"" VARCHAR(16777216),
	""snag_dis_code_pnwrs"" VARCHAR(16777216)
);"

,10
table_name,POPULATION_ESTIMATION_UNIT
description,
DDL,"create or replace TABLE POPULATION_ESTIMATION_UNIT (
	""estimation_unit_sequence_number"" NUMBER(38,0),
	""evaluation_sequence_number"" NUMBER(38,0),
	""region_or_station_code"" NUMBER(38,0),
	""evaluation_identifier"" NUMBER(38,0),
	""estimation_unit"" NUMBER(38,0),
	""estimation_unit_description"" VARCHAR(16777216),
	""state_code"" NUMBER(38,0),
	""land_area_within_the_estimation_unit"" FLOAT,
	""total_area_within_the_estimation_unit"" FLOAT,
	""area_used_to_calculate_all_expansion_factors"" FLOAT,
	""area_source"" VARCHAR(16777216),
	""phase_1_point_count_for_the_estimation_unit"" NUMBER(38,0),
	""phase_1_source"" VARCHAR(16777216),
	""eval_unit_created_by"" VARCHAR(16777216),
	""eval_unit_created_date"" DATE,
	""eval_unit_created_in_instance"" NUMBER(38,0),
	""eval_unit_modified_by"" VARCHAR(16777216),
	""eval_unit_modified_date"" DATE,
	""eval_unit_modified_in_instance"" NUMBER(38,0)
);"

,11
table_name,POPULATION_EVALUATION
description,
DDL,"create or replace TABLE POPULATION_EVALUATION (
	""evaluation_sequence_number"" NUMBER(38,0),
	""evaluation_group_sequence_number"" NUMBER(38,0),
	""region_or_station_code"" NUMBER(38,0),
	""evaluation_identifier"" NUMBER(38,0),
	""evaluation_description"" VARCHAR(16777216),
	""state_code"" NUMBER(38,0),
	""location_name"" VARCHAR(16777216),
	""report_year_name"" VARCHAR(16777216),
	""start_inventory_year"" VARCHAR(16777216),
	""end_inventory_year"" VARCHAR(16777216),
	""land_only"" VARCHAR(16777216),
	""timberland_only"" VARCHAR(16777216),
	""growth_accounting"" VARCHAR(16777216),
	""estimation_method"" VARCHAR(16777216),
	""notes"" VARCHAR(16777216),
	""pop_evaluation_created_by"" VARCHAR(16777216),
	""pop_evaluation_created_date"" DATE,
	""pop_evaluation_created_in_instance"" NUMBER(38,0),
	""pop_evaluation_modified_by"" VARCHAR(16777216),
	""pop_evaluation_modified_date"" DATE,
	""pop_evaluation_modified_in_instance"" NUMBER(38,0)
);"

,12
table_name,TREE
description,
DDL,"create or replace TABLE TREE (
	""tree_sequence_number"" NUMBER(38,0),
	""plot_sequence_number"" NUMBER(38,0),
	""previous_tree_sequence_number"" NUMBER(38,0),
	""tree_inventory_year"" NUMBER(38,0),
	""tree_state_code"" NUMBER(38,0),
	""tree_survey_unit_code"" NUMBER(38,0),
	""tree_county_code"" NUMBER(38,0),
	""tree_phase_2_plot_number"" NUMBER(38,0),
	""subplot_number"" NUMBER(38,0),
	""tree_record_number"" NUMBER(38,0),
	""condition_class_number"" NUMBER(38,0),
	""azimuth"" NUMBER(38,0),
	""horizontal_distance"" FLOAT,
	""previous_condition_number"" NUMBER(38,0),
	""tree_status_code"" NUMBER(38,0),
	""tree_status_code_name"" VARCHAR(16777216),
	""species_code"" NUMBER(38,0),
	""species_common_name"" VARCHAR(16777216),
	""species_scientific_name"" VARCHAR(16777216),
	""species_group_code"" NUMBER(38,0),
	""species_group_code_name"" VARCHAR(16777216),
	""current_diameter"" FLOAT,
	""diameter_height_code"" NUMBER(38,0),
	""diameter_height_code_name"" VARCHAR(16777216),
	""total_height"" NUMBER(38,0),
	""height_method_code"" NUMBER(38,0),
	""height_method_code_name"" VARCHAR(16777216),
	""actual_height"" NUMBER(38,0),
	""tree_class_code"" NUMBER(38,0),
	""tree_class_code_name"" VARCHAR(16777216),
	""compacted_crown_ratio"" NUMBER(38,0),
	""crown_class_code"" NUMBER(38,0),
	""crown_class_code_name"" VARCHAR(16777216),
	""tree_grade_code"" NUMBER(38,0),
	""cause_death_agent_code"" NUMBER(38,0),
	""cause_death_agent_code_name"" VARCHAR(16777216),
	""rotten_and_missing_cull"" NUMBER(38,0),
	""damage_location_1"" NUMBER(38,0),
	""damage_location_1_name"" VARCHAR(16777216),
	""damage_type_1"" NUMBER(38,0),
	""damage_type_1_name"" VARCHAR(16777216),
	""damage_severity_1"" NUMBER(38,0),
	""damage_severity_1_name"" VARCHAR(16777216),
	""damage_location_2"" NUMBER(38,0),
	""damage_location_2_name"" VARCHAR(16777216),
	""damage_type_2"" NUMBER(38,0),
	""damage_type_2_name"" VARCHAR(16777216),
	""damage_severity_2"" NUMBER(38,0),
	""damage_severity_2_name"" VARCHAR(16777216),
	""decay_class_code"" NUMBER(38,0),
	""decay_class_code_name"" VARCHAR(16777216),
	""tree_stocking"" FLOAT,
	""woodland_tree_species_stem_count"" NUMBER(38,0),
	""net_cubicfoot_volume"" FLOAT,
	""gross_cubicfoot_volume"" FLOAT,
	""net_cubicfoot_volume_sawlog_portion_sawtimber_tree"" FLOAT,
	""gross_cubicfoot_volume_sawlog_portion_sawtimber_tree"" FLOAT,
	""net_boardfoot_volume_sawlog_portion_sawtimber_tree"" FLOAT,
	""gross_boardfoot_volume_sawlog_portion_sawtimber_tree"" FLOAT,
	""sound_cubicfoot_volume"" FLOAT,
	""net_annual_merchantable_cubicfoot_growth_growingstock_tree_timberland"" FLOAT,
	""net_annual_merchantable_boardfoot_growth_sawtimber_tree_timberland"" FLOAT,
	""net_annual_sound_cubicfoot_growth_live_tree_timberland"" FLOAT,
	""merchantable_cubicfoot_volume_growingstock_tree_timberland_mortality_purposes"" FLOAT,
	""merchantable_boardfoot_volume_sawtimber_tree_timberland_mortality_purposes"" FLOAT,
	""sound_cubicfoot_volume_tree_timberland_mortality_purposes"" FLOAT,
	""merchantable_cubicfoot_volume_growingstock_tree_timberland_removal_purposes"" FLOAT,
	""merchantable_boardfoot_volume_sawtimber_tree_timberland_removal_purposes"" FLOAT,
	""sound_cubicfoot_volume_live_tree_timberland_removal_purposes"" FLOAT,
	""diameter_check_code"" NUMBER(38,0),
	""diameter_check_code_name"" VARCHAR(16777216),
	""mortality_year"" NUMBER(38,0),
	""salvable_dead_code"" NUMBER(38,0),
	""salvable_dead_code_name"" VARCHAR(16777216),
	""uncompacted_live_crown_ratio"" NUMBER(38,0),
	""crown_position_code"" NUMBER(38,0),
	""crown_position_code_name"" VARCHAR(16777216),
	""crown_light_exposure_code"" NUMBER(38,0),
	""crown_light_exposure_code_name"" VARCHAR(16777216),
	""crown_vigor_code_sapling"" NUMBER(38,0),
	""crown_vigor_code_sapling_name"" VARCHAR(16777216),
	""crown_density_code"" NUMBER(38,0),
	""crown_density_code_name"" VARCHAR(16777216),
	""crown_dieback_code"" NUMBER(38,0),
	""crown_dieback_code_name"" VARCHAR(16777216),
	""foliage_transparency_code"" NUMBER(38,0),
	""foliage_transparency_code_name"" VARCHAR(16777216),
	""tree_history_code"" NUMBER(38,0),
	""current_diameter_calculated"" FLOAT,
	""breast_height_age"" NUMBER(38,0),
	""total_age"" NUMBER(38,0),
	""dead_cull"" NUMBER(38,0),
	""form_cull"" NUMBER(38,0),
	""missing_top_cull_field_recorded"" NUMBER(38,0),
	""boardfoot_cull"" NUMBER(38,0),
	""cubicfoot_cull"" NUMBER(38,0),
	""boardfootcull_soundness"" NUMBER(38,0),
	""cubicfootcull_soundness"" NUMBER(38,0),
	""sawlog_height"" NUMBER(38,0),
	""bole_height"" NUMBER(38,0),
	""form_class"" NUMBER(38,0),
	""form_class_name"" VARCHAR(16777216),
	""current_height_calculated"" NUMBER(38,0),
	""hardwood_clump_code"" NUMBER(38,0),
	""calculated_site_index"" NUMBER(38,0),
	""tree_created_by"" NUMBER(38,0),
	""tree_created_date"" DATE,
	""tree_created_in_instance"" NUMBER(38,0),
	""tree_modified_by"" NUMBER(38,0),
	""tree_modified_date"" DATE,
	""tree_modified_in_instance"" NUMBER(38,0),
	""mortality_code"" NUMBER(38,0),
	""mortality_code_name"" VARCHAR(16777216),
	""height_to_diameter_measurement_point"" FLOAT,
	""rough_cull"" NUMBER(38,0),
	""mistletoe_class_code"" NUMBER(38,0),
	""mistletoe_class_code_name"" VARCHAR(16777216),
	""rotten_missing_cull_field_recorded"" NUMBER(38,0),
	""reconcile_code"" NUMBER(38,0),
	""reconcile_code_name"" VARCHAR(16777216),
	""previous_diameter"" FLOAT,
	""net_annual_merchantable_cubicfoot_growth_growingstock_tree_forest_land"" FLOAT,
	""net_annual_merchantable_boardfoot_growth_sawtimber_tree_forest_land"" FLOAT,
	""net_annual_sound_cubicfoot_growth_live_tree_forest_land"" FLOAT,
	""merchantable_cubicfoot_volume_growingstock_tree_forest_land_mortality_purposes"" FLOAT,
	""merchantable_boardfoot_volume_sawtimber_tree_forest_land_mortality_purposes"" FLOAT,
	""sound_cubicfoot_volume_tree_forest_land_mortality_purposes"" FLOAT,
	""merchantable_cubicfoot_volume_growingstock_tree_forest_land_removal_purposes"" FLOAT,
	""merchantable_boardfoot_volume_sawtimber_tree_forest_land_removal_purposes"" FLOAT,
	""sound_cubicfoot_volume_live_tree_forest_land_removal_purposes"" FLOAT,
	""periodic_annual_growth_removal_mortality_flag"" VARCHAR(16777216),
	""tree_class_code_northeastern_research_station"" NUMBER(38,0),
	""tree_class_code_northeastern_research_station_name"" VARCHAR(16777216),
	""tree_class_code_southern_research_station"" NUMBER(38,0),
	""tree_class_code_southern_research_station_name"" VARCHAR(16777216),
	""tree_class_code_north_central_research_station"" NUMBER(38,0),
	""tree_class_code_north_central_research_station_name"" VARCHAR(16777216),
	""tree_class_code_rocky_mountain_research_station"" NUMBER(38,0),
	""tree_class_code_rocky_mountain_research_station_name"" VARCHAR(16777216),
	""standing_dead_code"" NUMBER(38,0),
	""standing_dead_code_name"" VARCHAR(16777216),
	""previous_tree_status_code"" NUMBER(38,0),
	""previous_tree_status_code_name"" VARCHAR(16777216),
	""previous_woodland_stem_count"" VARCHAR(16777216),
	""trees_per_acre_unadjusted"" FLOAT,
	""mortality_trees_per_acre_per_year_unadjusted"" FLOAT,
	""removal_trees_per_acre_per_year_unadjusted"" FLOAT,
	""growth_trees_per_acre_unadjusted"" FLOAT,
	""dry_biomass_in_the_merchantable_bole"" FLOAT,
	""dry_biomass_top_limbs_tree"" FLOAT,
	""dry_biomass_tree_stump_at_t_1"" FLOAT,
	""aboveground_dry_biomass_saplings"" FLOAT,
	""aboveground_dry_biomass_woodland_tree_species"" FLOAT,
	""belowground_dry_biomass"" FLOAT,
	""aboveground_carbon"" FLOAT,
	""belowground_carbon"" FLOAT,
	""tree_inventory_cycle_number"" NUMBER(38,0),
	""tree_inventory_subcycle_number"" NUMBER(38,0),
	""tree_bored_code_pacific_northwest_research_station"" NUMBER(38,0),
	""tree_bored_code_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""damage_location_1_pacific_northwest_research_station"" NUMBER(38,0),
	""damage_location_1_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""damage_location_2_pacific_northwest_research_station"" NUMBER(38,0),
	""damage_location_2_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""diameter_check_pacific_northwest_research_station"" NUMBER(38,0),
	""diameter_check_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""damage_agent_1_pacific_northwest_research_station"" NUMBER(38,0),
	""damage_agent_2_pacific_northwest_research_station"" NUMBER(38,0),
	""damage_agent_3_pacific_northwest_research_station"" NUMBER(38,0),
	""leafy_mistletoe_class_code_pacific_northwest_research_station"" NUMBER(38,0),
	""leafy_mistletoe_class_code_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""damage_severity_1_pacific_northwest_research_station_years_2001_2004"" NUMBER(38,0),
	""damage_severity_1_a_pacific_northwest_research_station"" NUMBER(38,0),
	""damage_severity_1_b_pacific_northwest_research_station"" NUMBER(38,0),
	""damage_severity_1_b_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""damage_severity_2_pacific_northwest_research_station_years_2001_2004"" NUMBER(38,0),
	""damage_severity_2_a_pacific_northwest_research_station_starting_2005"" NUMBER(38,0),
	""damage_severity_2_b_pacific_northwest_research_station_starting_2005"" VARCHAR(16777216),
	""damage_severity_3_pacific_northwest_research_station_years_2001_2004"" NUMBER(38,0),
	""unknown_damage_type_1_pacific_northwest_research_station"" NUMBER(38,0),
	""unknown_damage_type_1_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""unknown_damage_type_2_pacific_northwest_research_station"" NUMBER(38,0),
	""unknown_damage_type_2_pacific_northwest_research_station_name"" VARCHAR(16777216),
	""previous_periodic_prism_point_tree_number_southern_research_station"" NUMBER(38,0),
	""disease_southern_research_station"" NUMBER(38,0),
	""disease_southern_research_station_name"" VARCHAR(16777216),
	""dieback_severity_southern_research_station"" NUMBER(38,0),
	""dieback_severity_southern_research_station_name"" VARCHAR(16777216),
	""damage_agent_code_1"" NUMBER(38,0),
	""damage_agent_code_1_name"" VARCHAR(16777216),
	""damage_agent_code_2"" VARCHAR(16777216),
	""damage_agent_code_2_name"" VARCHAR(16777216),
	""damage_agent_code_3"" NUMBER(38,0),
	""damage_agent_code_3_name"" VARCHAR(16777216),
	""centroid_diameter"" FLOAT,
	""calculated_centroid_diameter_height"" FLOAT,
	""actual_centroid_diameter_height"" FLOAT,
	""upper_stem_diameter"" NUMBER(38,0),
	""upper_stem_diameter_height"" NUMBER(38,0),
	""sound_cubicfoot_volume_sawlog_portion"" FLOAT,
	""dry_biomass_sawlog_portion_sawtimber_tree"" FLOAT,
	""damage_agent_code_1_southern_research_station"" NUMBER(38,0),
	""damage_agent_code_2_southern_research_station"" NUMBER(38,0),
	""damage_agent_code_3_southern_research_station"" VARCHAR(16777216),
	""aboveground_dry_biomass"" FLOAT,
	""unique_tree"" VARCHAR(16777216),
	""actualht_calc"" VARCHAR(16777216),
	""actualht_calc_code"" VARCHAR(16777216),
	""cull_bf_rotten"" VARCHAR(16777216),
	""cull_bf_rotten_code"" VARCHAR(16777216),
	""cull_bf_rough"" VARCHAR(16777216),
	""cull_bf_rough_code"" VARCHAR(16777216),
	""prevdia_fld"" VARCHAR(16777216),
	""treecl_code_31_ncrs"" VARCHAR(16777216),
	""tree_grade_ncrs"" VARCHAR(16777216),
	""boughs_available_ncrs"" VARCHAR(16777216),
	""boughs_hrvst_ncrs"" VARCHAR(16777216),
	""treecl_code_31_ners"" VARCHAR(16777216),
	""agent_code_ners"" VARCHAR(16777216),
	""bfsnd_code_ners"" VARCHAR(16777216),
	""agechk_code_rmrs"" VARCHAR(16777216),
	""dia_1yrago_rmrs"" VARCHAR(16777216),
	""growbfscr_rmrs"" VARCHAR(16777216),
	""growcfsawlog_rmrs"" VARCHAR(16777216),
	""ht_1yrago_rmrs"" VARCHAR(16777216),
	""prev_actualht_rmrs"" VARCHAR(16777216),
	""prev_agechk_code_rmrs"" VARCHAR(16777216),
	""prev_bhage_rmrs"" VARCHAR(16777216),
	""prev_ht_rmrs"" VARCHAR(16777216),
	""prev_totage_rmrs"" VARCHAR(16777216),
	""prev_treecl_code_rmrs"" VARCHAR(16777216),
	""radage_code_rmrs"" VARCHAR(16777216),
	""radgrw_rmrs"" VARCHAR(16777216),
	""volbfscrgrs_rmrs"" VARCHAR(16777216),
	""volbfscrnet_rmrs"" VARCHAR(16777216),
	""volcfdeadgrs_rmrs"" VARCHAR(16777216),
	""volcfsawgrs_rmrs"" VARCHAR(16777216),
	""volcfsawnet_rmrs"" VARCHAR(16777216),
	""volcftotnet_rmrs"" VARCHAR(16777216),
	""volcfuppgrs_rmrs"" VARCHAR(16777216),
	""volcfuppnet_rmrs"" VARCHAR(16777216),
	""sapling_fusiform_srs"" VARCHAR(16777216),
	""epiphyte_pnwrs"" VARCHAR(16777216),
	""root_ht_pnwrs"" VARCHAR(16777216),
	""cavity_use_pnwrs"" VARCHAR(16777216),
	""core_length_pnwrs"" VARCHAR(16777216),
	""culturally_killed_pnwrs"" VARCHAR(16777216),
	""dia_est_pnwrs"" VARCHAR(16777216),
	""gst_pnwrs"" VARCHAR(16777216),
	""inc10yr_pnwrs"" VARCHAR(16777216),
	""inc5yrht_pnwrs"" VARCHAR(16777216),
	""inc5yr_pnwrs"" VARCHAR(16777216),
	""ring_count_inner_2inches_pnwrs"" VARCHAR(16777216),
	""ring_count_pnwrs"" VARCHAR(16777216),
	""snag_dis_code_pnwrs"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
# Subplot Size and Macroplot Size Calculation Methods

## Overview

In forest inventory analysis, different types of plots are used to estimate forest characteristics. Two commonly used plot sizes are **subplot** and **macroplot**, each serving a distinct purpose for data collection at different scales.

This document provides a detailed explanation of the **subplot size** and **macroplot size** calculation methods using mathematical formulas.

## Subplot Size Calculation

### Definition
A **subplot** is a smaller area within a larger plot, often used to collect more detailed forest data. Subplots are utilized when fine-grained measurements are needed for specific forest conditions.

### Calculation Formula
The size of a subplot is calculated as follows:

\[
\text{Subplot Area} = 
\begin{cases} 
E \times P \times A_s, & \text{if proportion basis} = \text{'SUBP'} \text{ and } A_s > 0 \\
0, & \text{otherwise}
\end{cases}
\]

### Explanation of Terms:
- **E** (Expansion Factor): A multiplier used to adjust the size of the subplot to account for its proportion within a larger area.
- **P** (Condition Proportion Unadjusted): Represents the unadjusted proportion of the forest condition within the subplot.
- **A_s** (Adjustment Factor for Subplot): A factor applied to adjust the subplot size based on specific conditions or measurements.

### Interpretation:
If the **proportion basis** is `'SUBP'` and the **adjustment factor for the subplot** \( A_s \) is greater than 0, the subplot size is calculated by multiplying the **expansion factor** \( E \), **condition proportion** \( P \), and the **adjustment factor** \( A_s \):

\[
\text{Subplot Area} = E \times P \times A_s
\]

If these conditions are not met, the subplot size is set to 0.

## Macroplot Size Calculation

### Definition
A **macroplot** is a larger area within a forest inventory used for broader data collection. Macroplots cover more extensive areas compared to subplots and are used to estimate forest characteristics applicable to large sections of the forest.

### Calculation Formula
The size of a macroplot is calculated as follows:

\[
\text{Macroplot Area} = 
\begin{cases} 
E \times P \times A_m, & \text{if proportion basis} = \text{'MACR'} \text{ and } A_m > 0 \\
0, & \text{otherwise}
\end{cases}
\]

### Explanation of Terms:
- **E** (Expansion Factor): A factor that adjusts the macroplot size to reflect its relative size within the larger forest area.
- **P** (Condition Proportion Unadjusted): The unadjusted proportion of the forest condition within the macroplot.
- **A_m** (Adjustment Factor for Macroplot): A factor used to adjust the macroplot size based on specific forest conditions or measurements.

### Interpretation:
If the **proportion basis** is `'MACR'` and the **adjustment factor for the macroplot** \( A_m \) is greater than 0, the macroplot size is calculated using the following formula:

\[
\text{Macroplot Area} = E \times P \times A_m
\]

If these conditions are not met, the macroplot size is set to 0.

## Summary of Key Differences

| Parameter                     | Subplot Size Calculation                   | Macroplot Size Calculation                  |
|--------------------------------|--------------------------------------------|---------------------------------------------|
| **Proportion Basis**           | `'SUBP'`                                   | `'MACR'`                                    |
| **Adjustment Factor Applied**  | Adjustment Factor for Subplot \( A_s \)     | Adjustment Factor for Macroplot \( A_m \)   |
| **Applicability**              | Used for fine-grained data collection       | Used for broader, large-scale data collection |

### Common Calculation Components:
Both **subplot** and **macroplot** calculations use:
- **E** (Expansion Factor): Reflects how much area the plot represents in the larger forest.
- **P** (Condition Proportion Unadjusted): The proportion of the forest condition applicable to the plot.

These components are scaled based on whether the condition applies to a subplot or macroplot.

The table structure information is ({database name: {schema name: {table name}}}): 
{'USFS_FIA': {'USFS_FIA': ['CONDITION', 'ESTIMATED_FORESTLAND_ACRES', 'ESTIMATED_TIMBERLAND_ACRES', 'PLOT', 'PLOT_TREE', 'POPULATION', 'POPULATION_ESTIMATION_UNIT', 'POPULATION_EVALUATION', 'POPULATION_EVALUATION_GROUP', 'POPULATION_EVALUATION_TYPE', 'POPULATION_STRATUM', 'POPULATION_STRATUM_ASSIGN', 'TREE']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **PLOT Table**
  - `"plot_sequence_number"`: Used to join with the CONDITION table.
  - `"plot_inventory_year"`: Filter plots for the years 2015, 2016, and 2017.
  - `"plot_state_code"`: State code for grouping and identification.
  - `"plot_state_code_name"`: State name for display.

- **CONDITION Table**
  - `"plot_sequence_number"`: Used to join with the PLOT table.
  - `"condition_proportion_unadjusted"`: Represents **P** in the calculation formula.
  - `"proportion_basis"`: Determines if the calculation is for 'SUBP' (subplot) or 'MACR' (macroplot).
  - `"condition_status_code"`: Used to filter for accessible forest land.
  - `"condition_status_code_name"`: Description of the condition status code.

- **POPULATION_STRATUM_ASSIGN Table**
  - `"plot_sequence_number"`: Used to join with the CONDITION and PLOT tables.
  - `"stratum_sequence_number"`: Used to join with the POPULATION_STRATUM table.

- **POPULATION_STRATUM Table**
  - `"stratum_sequence_number"`: Used to join with the POPULATION_STRATUM_ASSIGN table.
  - `"expansion_factor"`: Represents **E** in the calculation formula.
  - `"adjustment_factor_for_the_macroplot"`: Represents **A_m** in the calculation formula.
  - `"adjustment_factor_for_the_subplot"`: Represents **A_s** in the calculation formula.
  - `"evaluation_sequence_number"`: Used to join with the POPULATION_EVALUATION table.

- **POPULATION_EVALUATION Table**
  - `"evaluation_sequence_number"`: Used to join with the POPULATION_STRATUM table.
  - `"evaluation_group_sequence_number"`: Used to join with the POPULATION_EVALUATION_TYPE table.

- **POPULATION_EVALUATION_TYPE Table**
  - `"evaluation_sequence_number"`: Used to join with the POPULATION_EVALUATION table.
  - `"evaluation_type"`: Used to filter for current evaluations (`'EXPCURR'`).

**Conditions That May Be Used:**

- Filter plots and conditions for the years **2015**, **2016**, and **2017** using `"plot_inventory_year"` and `"inventory_year"`.
- Filter for **accessible forest land** by checking `"condition_status_code"` and related descriptions.
- Filter for **current evaluations** where `"evaluation_type"` equals `'EXPCURR'`.

---

**SQL Queries:**

1. **Get Distinct Inventory Years from the PLOT Table**
   ```sql
   SELECT DISTINCT "plot_inventory_year"
   FROM "USFS_FIA"."USFS_FIA"."PLOT"
   LIMIT 100;
   ```

2. **Retrieve Plots for Years 2015-2017**
   ```sql
   SELECT "plot_sequence_number", "plot_inventory_year", "plot_state_code", "plot_state_code_name"
   FROM "USFS_FIA"."USFS_FIA"."PLOT"
   WHERE "plot_inventory_year" IN (2015, 2016, 2017)
   LIMIT 100;
   ```

3. **Get Conditions for Plots in Years 2015-2017**
   ```sql
   SELECT "plot_sequence_number", "proportion_basis", "condition_proportion_unadjusted"
   FROM "USFS_FIA"."USFS_FIA"."CONDITION"
   WHERE "inventory_year" IN (2015, 2016, 2017)
   LIMIT 100;
   ```

4. **Join PLOT and CONDITION to Retrieve State and Proportion Data**
   ```sql
   SELECT P."plot_state_code", P."plot_state_code_name", P."plot_inventory_year", C."proportion_basis", C."condition_proportion_unadjusted"
   FROM "USFS_FIA"."USFS_FIA"."PLOT" P
   JOIN "USFS_FIA"."USFS_FIA"."CONDITION" C
       ON P."plot_sequence_number" = C."plot_sequence_number"
   WHERE P."plot_inventory_year" IN (2015, 2016, 2017)
   LIMIT 100;
   ```

5. **Retrieve Expansion Factors and Adjustment Factors**
   ```sql
   SELECT "stratum_sequence_number", "expansion_factor", "adjustment_factor_for_the_macroplot", "adjustment_factor_for_the_subplot"
   FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM"
   LIMIT 100;
   ```

6. **Get Stratum Assignments**
   ```sql
   SELECT "plot_sequence_number", "stratum_sequence_number"
   FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN"
   LIMIT 100;
   ```

7. **Join CONDITION with POPULATION_STRATUM_ASSIGN**
   ```sql
   SELECT C."plot_sequence_number", C."proportion_basis", C."condition_proportion_unadjusted", PSA."stratum_sequence_number"
   FROM "USFS_FIA"."USFS_FIA"."CONDITION" C
   JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" PSA
       ON C."plot_sequence_number" = PSA."plot_sequence_number"
   LIMIT 100;
   ```

8. **Join POPULATION_STRATUM_ASSIGN with POPULATION_STRATUM**
   ```sql
   SELECT PSA."plot_sequence_number", PSA."stratum_sequence_number", PS."expansion_factor", PS."adjustment_factor_for_the_macroplot", PS."adjustment_factor_for_the_subplot", PS."evaluation_sequence_number"
   FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" PSA
   JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
       ON PSA."stratum_sequence_number" = PS."stratum_sequence_number"
   LIMIT 100;
   ```

9. **Retrieve Evaluation Types**
   ```sql
   SELECT "evaluation_sequence_number", "evaluation_type"
   FROM "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE"
   LIMIT 100;
   ```

10. **Join POPULATION_STRATUM with POPULATION_EVALUATION_TYPE**
    ```sql
    SELECT PS."stratum_sequence_number", PE."evaluation_sequence_number", PET."evaluation_type"
    FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" PE
        ON PS."evaluation_sequence_number" = PE."evaluation_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" PET
        ON PE."evaluation_sequence_number" = PET."evaluation_sequence_number"
    LIMIT 100;
    ```

11. **Filter for Current Evaluations (`'EXPCURR'`)**
    ```sql
    SELECT PS."stratum_sequence_number", PE."evaluation_sequence_number", PET."evaluation_type"
    FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" PE
        ON PS."evaluation_sequence_number" = PE."evaluation_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" PET
        ON PE."evaluation_sequence_number" = PET."evaluation_sequence_number"
    WHERE PET."evaluation_type" = 'EXPCURR'
    LIMIT 100;
    ```

12. **Combine Tables to Retrieve All Necessary Data**
    ```sql
    SELECT P."plot_state_code", P."plot_state_code_name", P."plot_inventory_year",
           C."proportion_basis", C."condition_proportion_unadjusted",
           PS."expansion_factor", PS."adjustment_factor_for_the_macroplot", PS."adjustment_factor_for_the_subplot",
           PET."evaluation_type"
    FROM "USFS_FIA"."USFS_FIA"."PLOT" P
    JOIN "USFS_FIA"."USFS_FIA"."CONDITION" C
        ON P."plot_sequence_number" = C."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" PSA
        ON P."plot_sequence_number" = PSA."plot_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
        ON PSA."stratum_sequence_number" = PS."stratum_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" PE
        ON PS."evaluation_sequence_number" = PE."evaluation_sequence_number"
    JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" PET
        ON PE."evaluation_sequence_number" = PET."evaluation_sequence_number"
    WHERE P."plot_inventory_year" IN (2015, 2016, 2017)
      AND PET."evaluation_type" = 'EXPCURR'
    LIMIT 100;
    ```

13. **Get Unique Proportion Basis Values**
    ```sql
    SELECT DISTINCT "proportion_basis"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION"
    LIMIT 100;
    ```

14. **Retrieve Conditions with 'SUBP' or 'MACR' Proportion Basis**
    ```sql
    SELECT "plot_sequence_number", "proportion_basis", "condition_proportion_unadjusted"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION"
    WHERE "proportion_basis" IN ('SUBP', 'MACR')
    LIMIT 100;
    ```

15. **Find Adjustment Factors Greater Than Zero**
    ```sql
    SELECT "stratum_sequence_number", "adjustment_factor_for_the_macroplot", "adjustment_factor_for_the_subplot"
    FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM"
    WHERE "adjustment_factor_for_the_macroplot" > 0 OR "adjustment_factor_for_the_subplot" > 0
    LIMIT 100;
    ```

16. **View Condition Status Codes**
    ```sql
    SELECT DISTINCT "condition_status_code", "condition_status_code_name"
    FROM "USFS_FIA"."USFS_FIA"."CONDITION"
    LIMIT 100;
    ```

17. **View Plot Status Codes**
    ```sql
    SELECT DISTINCT "plot_status_code", "plot_status_code_name"
    FROM "USFS_FIA"."USFS_FIA"."PLOT"
    LIMIT 100;
    ```

18. **Retrieve Accessible Plots (Assuming Code 1 Represents Accessibility)**
    ```sql
    SELECT "plot_sequence_number", "plot_status_code", "plot_status_code_name"
    FROM "USFS_FIA"."USFS_FIA"."PLOT"
    WHERE "plot_status_code" = 1
    LIMIT 100;
    ```

19. **List Distinct States in the Dataset**
    ```sql
    SELECT DISTINCT "plot_state_code", "plot_state_code_name"
    FROM "USFS_FIA"."USFS_FIA"."PLOT"
    LIMIT 100;
    ```

20. **Count Conditions per State and Year**
    ```sql
    SELECT P."plot_state_code", P."plot_state_code_name", P."plot_inventory_year", COUNT(*) AS "condition_count"
    FROM "USFS_FIA"."USFS_FIA"."PLOT" P
    JOIN "USFS_FIA"."USFS_FIA"."CONDITION" C
        ON P."plot_sequence_number" = C."plot_sequence_number"
    GROUP BY P."plot_state_code", P."plot_state_code_name", P."plot_inventory_year"
    ORDER BY "condition_count" DESC
    LIMIT 100;
    ```

These queries explore the relevant tables and columns to understand the data needed for the task. By examining the results of these queries, you can gain insights into the values within the columns, the relationships between tables, and prepare to calculate the largest average subplot and macroplot sizes per state for the specified years based on the accessible forest land and current evaluations (`'EXPCURR'`).Query:
SELECT DISTINCT "plot_inventory_year"
   FROM "USFS_FIA"."USFS_FIA"."PLOT"
   LIMIT 100;
Answer:
plot_inventory_year
1997
1998
2011
2014
2009
1995
1994
1999
1989
1982
1992
2004
2005
2016
2018
2013
2012
2020
1984
1996
1991
1987
1977
1970
1990
1968
1975
1976
2007
2002
2008
1993
1980
1974
1981
9999
1986
1988
2006
2000
2017
2015
2019
2010
2003
2001
1985
1972
1983
1978
Query:
SELECT "plot_sequence_number", "plot_inventory_year", "plot_state_code", "plot_state_code_name"
   FROM "USFS_FIA"."USFS_FIA"."PLOT"
   WHERE "plot_inventory_year" IN (2015, 2016, 2017)
   LIMIT 100;
Answer:
plot_sequence_number,plot_inventory_year,plot_state_code,plot_state_code_name
304151043489998,2016,19,Iowa
304151457489998,2016,19,Iowa
304151402489998,2016,19,Iowa
304150932489998,2016,19,Iowa
304151601489998,2016,19,Iowa
304150964489998,2016,19,Iowa
304151264489998,2016,19,Iowa
304151257489998,2016,19,Iowa
304150981489998,2016,19,Iowa
304151111489998,2016,19,Iowa
304150769489998,2016,19,Iowa
304151081489998,2016,19,Iowa
304150996489998,2016,19,Iowa
304151223489998,2016,19,Iowa
304151009489998,2016,19,Iowa
304151428489998,2016,19,Iowa
304150966489998,2016,19,Iowa
304151714489998,2016,19,Iowa
304151561489998,2016,19,Iowa
304150956489998,2016,19,Iowa
304151293489998,2016,19,Iowa
304151388489998,2016,19,Iowa
304151565489998,2016,19,Iowa
304151072489998,2016,19,Iowa
304151521489998,2016,19,Iowa
304151095489998,2016,19,Iowa
304150950489998,2016,19,Iowa
304151387489998,2016,19,Iowa
386054421489998,2015,21,Kentucky
386054408489998,2015,21,Kentucky
386054465489998,2015,21,Kentucky
386054459489998,2015,21,Kentucky
386053973489998,2015,21,Kentucky
386054471489998,2015,21,Kentucky
386054200489998,2015,21,Kentucky
386054053489998,2015,21,Kentucky
386054234489998,2015,21,Kentucky
386054433489998,2015,21,Kentucky
386054222489998,2015,21,Kentucky
386054212489998,2015,21,Kentucky
386054437489998,2015,21,Kentucky
386054070489998,2015,21,Kentucky
386054434489998,2015,21,Kentucky
386054179489998,2015,21,Kentucky
386054132489998,2015,21,Kentucky
386054093489998,2015,21,Kentucky
386054350489998,2015,21,Kentucky
386054345489998,2015,21,Kentucky
386054346489998,2015,21,Kentucky
386054422489998,2015,21,Kentucky
386053763489998,2015,21,Kentucky
386054395489998,2015,21,Kentucky
386054455489998,2015,21,Kentucky
386054442489998,2015,21,Kentucky
386054011489998,2015,21,Kentucky
386054207489998,2015,21,Kentucky
386053911489998,2015,21,Kentucky
386054226489998,2015,21,Kentucky
386053762489998,2015,21,Kentucky
386053765489998,2015,21,Kentucky
386053985489998,2015,21,Kentucky
386054467489998,2015,21,Kentucky
386054004489998,2015,21,Kentucky
386054379489998,2015,21,Kentucky
386054477489998,2015,21,Kentucky
386054363489998,2015,21,Kentucky
386054028489998,2015,21,Kentucky
386053786489998,2015,21,Kentucky
386053772489998,2015,21,Kentucky
386053927489998,2015,21,Kentucky
386054343489998,2015,21,Kentucky
386054087489998,2015,21,Kentucky
386054342489998,2015,21,Kentucky
386054384489998,2015,21,Kentucky
386054461489998,2015,21,Kentucky
386053983489998,2015,21,Kentucky
386054319489998,2015,21,Kentucky
386054411489998,2015,21,Kentucky
386054197489998,2015,21,Kentucky
386054449489998,2015,21,Kentucky
386054230489998,2015,21,Kentucky
386054008489998,2015,21,Kentucky
386054001489998,2015,21,Kentucky
386054424489998,2015,21,Kentucky
386054126489998,2015,21,Kentucky
386054215489998,2015,21,Kentucky
306265453489998,2016,36,New York
306265483489998,2016,36,New York
306265391489998,2016,36,New York
306265653489998,2016,36,New York
306265578489998,2016,36,New York
306265346489998,2016,36,New York
305281789489998,2016,36,New York
306265955489998,2016,36,New York
306265441489998,2016,36,New York
306265682489998,2016,36,New York
306265756489998,2016,36,New York
306265392489998,2016,36,New York
306265729489998,2016,36,New York
306265586489998,2016,36,New York
Query:
SELECT "plot_sequence_number", "proportion_basis", "condition_proportion_unadjusted"
   FROM "USFS_FIA"."USFS_FIA"."CONDITION"
   WHERE "inventory_year" IN (2015, 2016, 2017)
   LIMIT 100;
Answer:
plot_sequence_number,proportion_basis,condition_proportion_unadjusted
243882539489998,SUBP,0.7372329831123352
473804170489998,SUBP,1.0
40420834010690,SUBP,1.0
40416232010690,SUBP,1.0
40420846010690,SUBP,0.6484389901161194
40420916010690,SUBP,0.7871590256690979
375823541489998,SUBP,1.0
373753093489998,SUBP,0.25
297166923489998,SUBP,1.0
548477642126144,SUBP,1.0
297165454489998,SUBP,1.0
40425224010690,SUBP,0.25
40424740010690,SUBP,1.0
14549421020004,SUBP,1.0
273640965489998,MACR,1.0
345933490489998,MACR,0.20356899499893188
304200046489998,SUBP,0.17712299525737762
251983319489998,SUBP,1.0
373681105489998,SUBP,1.0
346864370489998,MACR,1.0
346864323489998,MACR,0.75
412222539489998,MACR,1.0
412222541489998,MACR,1.0
273642079489998,MACR,0.903007984161377
444202473489998,MACR,1.0
375823166489998,SUBP,1.0
304030413489998,SUBP,1.0
290008836489998,MACR,0.190201997756958
290008725489998,MACR,0.856889009475708
290008194489998,MACR,0.8888540267944336
346864418489998,MACR,0.9024969935417175
444202475489998,MACR,1.0
305230755489998,SUBP,1.0
245012952489998,SUBP,1.0
305230735489998,SUBP,1.0
414839441489998,SUBP,0.1600240021944046
412223119489998,MACR,1.0
273642269489998,MACR,1.0
412223019489998,MACR,0.17835299670696259
290008727489998,MACR,1.0
480976653489998,SUBP,0.25
335445281489998,SUBP,0.75
258657240489998,SUBP,0.25
335445616489998,SUBP,0.75
480977056489998,SUBP,0.4457870125770569
335445190489998,SUBP,0.7512500286102295
335445288489998,SUBP,0.25
353325750489998,SUBP,0.75
443867609489998,SUBP,1.0
289515746489998,SUBP,1.0
289515932489998,SUBP,0.9108930230140686
480976558489998,SUBP,0.25
264160208489998,SUBP,1.0
264160249489998,SUBP,0.75
258657100489998,SUBP,1.0
258657268489998,SUBP,0.75
385729174489998,SUBP,0.050978999584913254
282502210489998,SUBP,0.75
282501930489998,SUBP,1.0
451136198489998,SUBP,0.5
451136276489998,SUBP,0.4592779874801636
448940952489998,SUBP,1.0
289515011489998,SUBP,1.0
374861589489998,SUBP,1.0
372786341489998,SUBP,0.75
373753897489998,SUBP,1.0
231734643020004,SUBP,0.25
282500988489998,SUBP,1.0
443867786489998,SUBP,0.25
351508573489998,SUBP,0.006535000167787075
351508721489998,SUBP,0.75
351508742489998,SUBP,0.25
264160396489998,SUBP,1.0
264160403489998,SUBP,1.0
264160130489998,SUBP,0.5112789869308472
264159873489998,SUBP,0.25
386107196489998,SUBP,0.5
480977035489998,SUBP,0.9446899890899658
480976963489998,SUBP,0.7452430129051208
433034415489998,SUBP,1.0
433032842489998,SUBP,0.75
385729279489998,SUBP,0.75
347395225489998,SUBP,1.0
282501495489998,SUBP,1.0
264160213489998,SUBP,1.0
451134524489998,SUBP,0.4283530116081238
264152886489998,SUBP,0.25
351508428489998,SUBP,0.40249699354171753
480977044489998,SUBP,1.0
335232054489998,SUBP,0.8957149982452393
385729825489998,SUBP,0.5
335445684489998,SUBP,0.3216469883918762
451136774489998,SUBP,0.13332599401474
385729275489998,SUBP,1.0
451136182489998,SUBP,0.75
335231282489998,SUBP,1.0
433033921489998,SUBP,0.75
480976351489998,SUBP,1.0
347395069489998,SUBP,0.46974000334739685
335231950489998,SUBP,0.8835620284080505
Query:
SELECT P."plot_state_code", P."plot_state_code_name", P."plot_inventory_year", C."proportion_basis", C."condition_proportion_unadjusted"
   FROM "USFS_FIA"."USFS_FIA"."PLOT" P
   JOIN "USFS_FIA"."USFS_FIA"."CONDITION" C
       ON P."plot_sequence_number" = C."plot_sequence_number"
   WHERE P."plot_inventory_year" IN (2015, 2016, 2017)
   LIMIT 100;
Answer:
plot_state_code,plot_state_code_name,plot_inventory_year,proportion_basis,condition_proportion_unadjusted
16,Idaho,2015,SUBP,1.0
47,Tennessee,2015,SUBP,0.75
4,Arizona,2016,SUBP,1.0
18,Indiana,2017,SUBP,1.0
19,Iowa,2016,SUBP,1.0
8,Colorado,2017,SUBP,1.0
8,Colorado,2016,SUBP,1.0
8,Colorado,2016,SUBP,1.0
39,Ohio,2017,SUBP,0.25
39,Ohio,2016,SUBP,1.0
39,Ohio,2016,SUBP,0.25
19,Iowa,2016,SUBP,0.5371590256690979
17,Illinois,2015,SUBP,1.0
36,New York,2017,SUBP,0.25
31,Nebraska,2015,SUBP,1.0
31,Nebraska,2016,SUBP,1.0
18,Indiana,2015,SUBP,1.0
47,Tennessee,2016,SUBP,0.75
8,Colorado,2017,SUBP,0.5
31,Nebraska,2016,SUBP,0.7674340009689331
41,Oregon,2015,MACR,0.036042001098394394
41,Oregon,2015,MACR,0.03350900113582611
41,Oregon,2015,MACR,0.3420650064945221
2,Alaska,2016,SUBP,1.0
2,Alaska,2016,SUBP,0.8284940123558044
16,Idaho,2016,SUBP,1.0
16,Idaho,2017,SUBP,1.0
53,Washington,2015,MACR,0.02265699952840805
18,Indiana,2017,SUBP,1.0
19,Iowa,2017,SUBP,0.684158980846405
19,Iowa,2017,SUBP,1.0
39,Ohio,2016,SUBP,1.0
30,Montana,2015,SUBP,0.25
30,Montana,2017,SUBP,0.75
30,Montana,2015,SUBP,0.75
30,Montana,2016,SUBP,0.75
31,Nebraska,2016,SUBP,1.0
31,Nebraska,2015,SUBP,1.0
4,Arizona,2017,SUBP,1.0
39,Ohio,2016,SUBP,0.75
39,Ohio,2016,SUBP,1.0
16,Idaho,2017,SUBP,1.0
16,Idaho,2015,SUBP,0.5
16,Idaho,2017,SUBP,0.75
16,Idaho,2015,SUBP,0.25
31,Nebraska,2017,SUBP,0.274848997592926
19,Iowa,2016,SUBP,1.0
19,Iowa,2017,SUBP,1.0
8,Colorado,2015,SUBP,1.0
8,Colorado,2016,SUBP,1.0
8,Colorado,2017,SUBP,0.25
18,Indiana,2017,SUBP,0.75
39,Ohio,2015,SUBP,0.75
30,Montana,2016,SUBP,1.0
30,Montana,2015,SUBP,0.32661300897598267
4,Arizona,2015,SUBP,1.0
39,Ohio,2015,SUBP,0.6457149982452393
39,Ohio,2016,SUBP,0.3120979964733124
2,Alaska,2017,SUBP,0.2811119854450226
16,Idaho,2016,SUBP,1.0
16,Idaho,2015,SUBP,0.5
16,Idaho,2015,SUBP,1.0
19,Iowa,2017,SUBP,1.0
41,Oregon,2015,MACR,0.7213810086250305
41,Oregon,2015,MACR,0.694890022277832
8,Colorado,2016,SUBP,0.75
8,Colorado,2015,SUBP,1.0
8,Colorado,2016,SUBP,1.0
30,Montana,2017,SUBP,1.0
30,Montana,2017,SUBP,1.0
30,Montana,2017,SUBP,0.25
30,Montana,2015,SUBP,1.0
30,Montana,2017,SUBP,0.1746399998664856
2,Alaska,2015,SUBP,1.0
2,Alaska,2017,SUBP,1.0
2,Alaska,2016,SUBP,1.0
2,Alaska,2017,SUBP,1.0
2,Alaska,2016,SUBP,1.0
2,Alaska,2016,SUBP,1.0
42,Pennsylvania,2016,SUBP,1.0
42,Pennsylvania,2016,SUBP,0.25
42,Pennsylvania,2016,SUBP,1.0
12,Florida,2015,SUBP,1.0
49,Utah,2017,SUBP,1.0
53,Washington,2015,MACR,0.75
53,Washington,2017,MACR,0.05844400078058243
53,Washington,2017,MACR,0.014170999638736248
56,Wyoming,2017,SUBP,1.0
56,Wyoming,2017,SUBP,1.0
56,Wyoming,2017,SUBP,1.0
53,Washington,2016,MACR,0.4145030081272125
53,Washington,2015,MACR,0.12338300049304962
53,Washington,2016,MACR,1.0
8,Colorado,2017,SUBP,1.0
8,Colorado,2016,SUBP,0.75
8,Colorado,2017,SUBP,1.0
29,Missouri,2015,SUBP,1.0
19,Iowa,2016,SUBP,1.0
16,Idaho,2017,SUBP,1.0
16,Idaho,2016,SUBP,1.0
Query:
SELECT
    "plot_type",
    "year",
    "state",
    "average_size"
FROM (
    SELECT
        "plot_type",
        "year",
        "state",
        "average_size",
        ROW_NUMBER() OVER (
            PARTITION BY "plot_type", "year"
            ORDER BY "average_size" DESC
        ) AS "rn"
    FROM (
        SELECT
            CASE
                WHEN C."proportion_basis" = 'SUBP' THEN 'subplot'
                WHEN C."proportion_basis" = 'MACR' THEN 'macroplot'
                ELSE 'unknown'
            END AS "plot_type",
            P."plot_inventory_year" AS "year",
            P."plot_state_code_name" AS "state",
            AVG(
                PS."expansion_factor" * C."condition_proportion_unadjusted" *
                CASE
                    WHEN C."proportion_basis" = 'SUBP' THEN COALESCE(PS."adjustment_factor_for_the_subplot", 1.0)
                    WHEN C."proportion_basis" = 'MACR' THEN COALESCE(PS."adjustment_factor_for_the_macroplot", 1.0)
                    ELSE 1.0
                END
            ) AS "average_size"
        FROM "USFS_FIA"."USFS_FIA"."PLOT" P
        JOIN "USFS_FIA"."USFS_FIA"."CONDITION" C
            ON P."plot_sequence_number" = C."plot_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" PSA
            ON P."plot_sequence_number" = PSA."plot_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
            ON PSA."stratum_sequence_number" = PS."stratum_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_ESTIMATION_UNIT" PEU
            ON PS."estimation_unit_sequence_number" = PEU."estimation_unit_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" PE
            ON PEU."evaluation_sequence_number" = PE."evaluation_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" PET
            ON PE."evaluation_sequence_number" = PET."evaluation_sequence_number"
        WHERE
            P."plot_inventory_year" IN (2015, 2016, 2017)
            AND PET."evaluation_type" = 'EXPCURR'
            AND C."condition_status_code" = 1  -- Accessible forest land
            AND (
                (C."proportion_basis" = 'SUBP' AND COALESCE(PS."adjustment_factor_for_the_subplot", 0) > 0)
                OR (C."proportion_basis" = 'MACR' AND COALESCE(PS."adjustment_factor_for_the_macroplot", 0) > 0)
            )
        GROUP BY
            "plot_type", "year", "state"
    ) AS "avg_sizes"
) AS "ranked_states"
WHERE "rn" = 1
ORDER BY "plot_type", "year";
Answer:
plot_type,year,state,average_size
macroplot,2015,California,4937.295863300523
macroplot,2016,California,5128.199385365012
macroplot,2017,California,5043.9370607363635
subplot,2015,Wyoming,7634.419129440116
subplot,2016,Wyoming,7054.171375211551
subplot,2017,Hawaii,7812.384403896898
Query:
-- Corrected SQL 1
SELECT "plot_sequence_number", "stratum_sequence_number"
FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN"
LIMIT 100
Answer:
plot_sequence_number,stratum_sequence_number
10672090010497,13319170010497
10670280010497,13319182010497
10669067010497,13319402010497
10669091010497,13319402010497
10670452010497,13319374010497
10668523010497,13319335010497
10669051010497,13319283010497
10668717010497,13319393010497
10671724010497,13319399010497
10669560010497,13319373010497
10668366010497,13319408010497
10668530010497,13319408010497
10668946010497,13319196010497
10667628010497,13319364010497
10668111010497,13319268010497
10668044010497,13319268010497
10667924010497,13319268010497
10667911010497,13319268010497
10668720010497,13319403010497
10668790010497,13319403010497
10671886010497,13319268010497
10672088010497,13319404010497
10669300010497,13319265010497
10669100010497,13319261010497
10668050010497,13319409010497
10667754010497,13319409010497
10671796010497,13319260010497
10671462010497,13319321010497
10671723010497,13319258010497
10670413010497,13319239010497
10668673010497,13319201010497
10668525010497,13319175010497
10668985010497,13319238010497
10668047010497,13319409010497
10669737010497,13319405010497
10670090010497,13319405010497
10671684010497,13319398010497
10669003010497,13319163010497
10667433010497,13319236010497
10670703010497,13319407010497
10670975010497,13319145010497
10668378010497,13319160010497
10670671010497,13319165010497
10670786010497,13319298010497
10669301010497,13319247010497
10670804010497,13319386010497
10671390010497,13319386010497
10672027010497,13319267010497
10671533010497,13319249010497
10668425010497,13319267010497
10667646010497,13319254010497
10671131010497,13319380010497
10667861010497,13319268010497
10669587010497,13319248010497
10670918010497,13319259010497
10671209010497,13319262010497
10670253010497,13319379010497
10669528010497,13319365010497
10668416010497,13319408010497
10668902010497,13319382010497
10668246010497,13319357010497
10669290010497,13319406010497
10671290010497,13319404010497
10671325010497,13319404010497
10671364010497,13319401010497
10669211010497,13319402010497
10670616010497,13319141010497
10667618010497,13319260010497
10669377010497,13319269010497
10670682010497,13319133010497
10672077010497,13319169010497
10669768010497,13319273010497
10669207010497,13319313010497
10670472010497,13319252010497
10667939010497,13319409010497
10668011010497,13319409010497
10671416010497,13319206010497
10670368010497,13319265010497
10670347010497,13319262010497
10670418010497,13319262010497
10672360010497,13319206010497
10671166010497,13319265010497
10668513010497,13319267010497
10667971010497,13319409010497
10668043010497,13319409010497
10670571010497,13319227010497
10669731010497,13319213010497
10669082010497,13319263010497
10672310010497,13319161010497
10671677010497,13319205010497
10667905010497,13319409010497
10667562010497,13319251010497
10669094010497,13319254010497
10669804010497,13319211010497
10671733010497,13319388010497
10670150010497,13319406010497
10672145010497,13319404010497
10668096010497,13319244010497
10670943010497,13319259010497
10669693010497,13319259010497
Query:
-- Corrected SQL 2
SELECT
    C."plot_sequence_number",
    C."proportion_basis",
    C."condition_proportion_unadjusted",
    PSA."stratum_sequence_number"
FROM "USFS_FIA"."USFS_FIA"."CONDITION" C
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" PSA
    ON C."plot_sequence_number" = PSA."plot_sequence_number"
LIMIT 100
Answer:
plot_sequence_number,proportion_basis,condition_proportion_unadjusted,stratum_sequence_number
14532098020004,SUBP,1.0,498381135126144
306350180489998,SUBP,0.25,498381146126144
306350180489998,SUBP,0.75,498381146126144
245790975010661,SUBP,1.0,638563474126144
245791388010661,SUBP,0.17957599461078644,638563455126144
245791388010661,SUBP,0.8204240202903748,638563455126144
14532544020004,SUBP,1.0,638563458126144
249881659489998,SUBP,0.34028300642967224,498392876126144
249881659489998,SUBP,0.6597170233726501,498392876126144
373753096489998,SUBP,1.0,498392890126144
168271692020004,SUBP,1.0,498381121126144
465277209489998,SUBP,1.0,638563467126144
306349629489998,SUBP,1.0,498368825126144
306349918489998,SUBP,0.8916059732437134,498381138126144
306349918489998,SUBP,0.10839399695396423,498381138126144
14531868020004,SUBP,0.5072090029716492,498368807126144
14531868020004,SUBP,0.25,498368807126144
14531868020004,SUBP,0.24279099702835083,498368807126144
14531809020004,SUBP,1.0,638563457126144
168272711020004,SUBP,1.0,498381130126144
245791328010661,SUBP,0.25,498381115126144
245791328010661,SUBP,0.75,498381115126144
465277036489998,SUBP,1.0,638563462126144
245792183010661,SUBP,0.75,498368815126144
245792183010661,SUBP,0.25,498368815126144
14532266020004,SUBP,1.0,638551250126144
168271169020004,SUBP,0.39571499824523926,638563459126144
168271169020004,SUBP,0.6042850017547607,638563459126144
245791945010661,SUBP,1.0,638590090126144
373753673489998,SUBP,1.0,498368793126144
168271382020004,SUBP,1.0,498392880126144
373753849489998,SUBP,1.0,638563461126144
14533270020004,SUBP,1.0,498381130126144
245792568010661,SUBP,1.0,498381145126144
168272262020004,SUBP,1.0,638563467126144
168272932020004,SUBP,1.0,638551242126144
373753909489998,SUBP,0.75,498381115126144
373753909489998,SUBP,0.25,498381115126144
465276586489998,SUBP,1.0,638575218126144
14531338020004,SUBP,0.25,498392875126144
14531338020004,SUBP,0.38986900448799133,498392875126144
14531338020004,SUBP,0.36013099551200867,498392875126144
168272185020004,SUBP,1.0,498368797126144
168270809020004,SUBP,1.0,692745515126144
168272234020004,SUBP,1.0,498368826126144
249881801489998,SUBP,1.0,638563460126144
168270781020004,SUBP,1.0,638575190126144
14532680020004,SUBP,1.0,638575195126144
245792236010661,SUBP,0.5,498368816126144
245792236010661,SUBP,0.5,498368816126144
249881318489998,SUBP,1.0,498381135126144
168272616020004,SUBP,1.0,638575188126144
373753690489998,SUBP,0.5,498381134126144
373753690489998,SUBP,0.5,498381134126144
14532223020004,SUBP,1.0,498381146126144
168271820020004,SUBP,1.0,638551241126144
249880804489998,SUBP,1.0,498392880126144
168271009020004,SUBP,0.824757993221283,498405256126144
168271009020004,SUBP,0.17524200677871704,498405256126144
168271259020004,SUBP,1.0,638590092126144
465276822489998,SUBP,0.30612099170684814,692744807126144
465276822489998,SUBP,0.6938790082931519,692744807126144
373752673489998,SUBP,1.0,692744804126144
14531485020004,SUBP,1.0,692745512126144
245792920010661,SUBP,1.0,638575200126144
249881978489998,SUBP,1.0,638563447126144
245791945010661,SUBP,1.0,638575204126144
306350267489998,SUBP,1.0,498392890126144
168272095020004,SUBP,1.0,498392890126144
465277887489998,SUBP,1.0,638551245126144
168271692020004,SUBP,1.0,498392866126144
306349738489998,SUBP,0.1388539969921112,638563459126144
306349738489998,SUBP,0.8611459732055664,638563459126144
373753471489998,SUBP,1.0,498368827126144
14531456020004,SUBP,0.75,498381119126144
14531456020004,SUBP,0.25,498381119126144
373753719489998,SUBP,1.0,498392903126144
168272656020004,SUBP,1.0,498368808126144
249881634489998,SUBP,1.0,498368821126144
373753212489998,SUBP,1.0,638575178126144
245791199010661,SUBP,1.0,498368813126144
306349629489998,SUBP,1.0,638551250126144
168270801020004,SUBP,0.3570219874382019,638575199126144
168270801020004,SUBP,0.6429780125617981,638575199126144
14531310020004,SUBP,1.0,498392873126144
14533144020004,SUBP,0.25,498368810126144
14533144020004,SUBP,0.75,498368810126144
249881964489998,SUBP,1.0,638551250126144
168272740020004,SUBP,1.0,498368816126144
14531490020004,SUBP,1.0,498368837126144
373752573489998,SUBP,0.25,498368812126144
373752573489998,SUBP,0.75,498368812126144
14532020020004,SUBP,1.0,498368828126144
14532423020004,SUBP,0.5263350009918213,498381136126144
14532423020004,SUBP,0.4736649990081787,498381136126144
168271621020004,SUBP,1.0,638551250126144
220870919010661,SUBP,1.0,498392890126144
168272542020004,SUBP,0.6511480212211609,638575200126144
168272542020004,SUBP,0.3488520085811615,638575200126144
306350035489998,SUBP,0.25,638563468126144
Query:
-- Corrected SQL 3
SELECT
    PSA."plot_sequence_number",
    PSA."stratum_sequence_number",
    PS."expansion_factor",
    PS."adjustment_factor_for_the_macroplot",
    PS."adjustment_factor_for_the_subplot",
    PS."estimation_unit_sequence_number"
FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" PSA
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
    ON PSA."stratum_sequence_number" = PS."stratum_sequence_number"
LIMIT 100
Answer:
Too long, hard cut:
plot_sequence_number,stratum_sequence_number,expansion_factor,adjustment_factor_for_the_macroplot,adjustment_factor_for_the_subplot,estimation_unit_sequence_number
40422786010690,669083399126144,8065.7055959314785,0.0,1.0057142857142858,669949200126144
40419875010690,669083347126144,7695.584540789055,0.0,1.0,669949201126144
40418484010690,669083316126144,7387.998037856348,0.0,1.0,669949188126144
40407011010690,669083379126144,7739.88133781454,0.0,1.0,669949196126144
40421995010690,669083393126144,7386.489548954895,0.0,1.0,669953194126144
40419083010690,669083330126144,7724.701588152994,0.0,1.0033444816053512,669953195126144
40419454010690,669083337126144,7611.466865560241,,1.0,669953144126144
40423315010690,669083416126144,7454.2638776279,0.0,1.002816824299737,669949187126144
40407833010690,669083416126144,7454.2638776279,0.0,1.002816824299737,669949187126144
40416574010690,669083276126144,7400.759375087548,0.0,1.0052356020942408,669949195126144
40416605010690,669083276126144,7400.759375087548,0.0,1.0052356020942408,669949195126144
40418057010690,669083308126144,8191.260148103494,0.0,1.0,669949203126144
40420031010690,669083355126144,7692.417044782939,0.0,1.0,669949204126144
40420174010690,669083357126144,7692.417044782939,0.0,1.0,669953207126144
40406503010690,669083357126144,7692.417044782939,0.0,1.0,669953207126144
40407476010690,669083393126144,7386.489548954895,0.0,1.0,669953194126144
40422488010690,669083393126144,7386.489548954895,0.0,1.0,669953194126144
40422568010690,669083392126144,7386.489548954895,,1.0,669953136126144
40419324010690,669083338126144,7611.466865560241,0.0,1.0,669953202126144
40419345010690,669083338126144,7611.466865560241,0.0,1.0,669953202126144
40419360010690,669083338126144,7611.466865560241,0.0,1.0,669953202126144
40420838010690,669083365126144,7865.370343574823,0.0,1.0119595216191353,669953196126144
40407714010690,669083403126144,7678.35632183908,0.0,1.0,669949186126144
40421087010690,669083371126144,7946.876470588235,0.0,1.0,669949189126144
40418218010690,669083312126144,7998.301935120591,0.0,1.0086206896551724,669949188126144
40416395010690,669083276126144,7400.759375087548,0.0,1.0052356020942408,669949195126144
40404887010690,669083276126144,7400.759375087548,0.0,1.0052356020942408,669949195126144
40416431010690,669083276126144,7400.759375087548,0.0,1.0052356020942408,669949195126144
40419424010690,669083336126144,7611.466865560241,0.0,1.0,669949199126144
40419228010690,669083336126144,7611.466865560241,0.0,1.0,669949199126144
40406217010690,669083341126144,7478.582608695652,,1.0,669953129126144
40417720010690,669083302126144,7808.21468381549,0.0,1.0023346303501945,669953200126144
40406472010690,669083357126144,7692.417044782939,0.0,1.0,669953207126144
40406557010690,669083356126144,7692.417044782939,,1.0,669953149126144
40419379010690,669083338126144,7611.466865560241,0.0,1.0,669953202126144
40406734010690,669083365126144,7865.370343574823,0.0,1.0119595216191353,669953196126144
40421190010690,669083371126144,7946.876470588235,0.0,1.0,669949189126144
40422102010690,669083391126144,7386.489548954895,0.0,1.0,669949191126144
40407212010690,669083391126144,7386.489548954895,0.0,1.0,669949191126144
40416515010690,669083272126144,8184.891665966285,0.0,1.0169491525423728,669949195126144
40416557010690,669083276126144,7400.759375087548,0.0,1.0052356020942408,669949195126144
40406402010690,669083357126144,7692.417044782939,0.0,1.0,669953207126144
40423048010690,669083404126144,7678.35632183908,,1.0,669953131126144
40423056010690,669083404126144,7678.35632183908,,1.0,669953131126144
40418206010690,669083318126144,7387.998037856348,0.0,1.0,669953191126144
40418550010690,669083313126144,7998.301935120591,,1.0086206896551724,669953133126144
40422115010690,669083392126144,7386.489548954895,,1.0,669953136126144
40421980010690,669083392126144,7386.489548954895,,1.0,669953136126144
40423129010690,669083407126144,8345.06976744186,0.0,1.0,669949194126144
40418865010690,669083320126144,7639.459893048128,0.0,1.0,669949198126144
40405063010690,669083284126144,7807.480284457689,0.0,1.0,669949202126144
40416906010690,669083284126144,7807.480284457689,0.0,1.0,669949202126144
40419654010690,669083341126144,7478.582608695652,,1.0,669953129126144
40418514010690,669083318126144,7387.998037856348,0.0,1.0,669953191126144
40418735010690,669083318126144,7387.998037856348,0.0,1.0,669953191126144
40422754010690,669083397126144,7662.149644453961,0.0,1.008729388942774,669953203126144
40406901010690,669083373126144,7946.876470588235,0.0,1.0,669953192126144
40421228010690,669083373126144,7946.876470588235,0.0,1.0,669953192126144
40417863010690,534083500126144,8979.446886387814,0.0,1.000893655049151,548830624126144
40417469010690,534083486126144,9993.788004500993,0.0,1.0064516129032257,548830447126144
40406241010690,534083540126144,8515.217821782178,0.0,1.0,548830630126144
40419135010690,534083527126144,8712.069460322926,0.0,1.0,548830554126144
40406831010690,669083369126144,7733.498840124323,0.0,1.0008424599831
Query:
-- Corrected SQL 4
SELECT "evaluation_sequence_number", "evaluation_type"
FROM "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE"
LIMIT 100
Answer:
evaluation_sequence_number,evaluation_type
247334062010854,EXPGROW
247334062010854,EXPREMV
247334062010854,EXPMORT
209643345010854,EXPCURR
209643346010854,EXPVOL
209674547010854,EXPCURR
209674548010854,EXPVOL
209714893010854,EXPCURR
209714894010854,EXPVOL
209643347010854,EXPGROW
209643347010854,EXPMORT
209643347010854,EXPREMV
209674549010854,EXPGROW
209674549010854,EXPMORT
209674549010854,EXPREMV
209714895010854,EXPGROW
209714895010854,EXPMORT
209714895010854,EXPREMV
209773767010854,EXPVOL
209773766010854,EXPCURR
209773768010854,EXPGROW
209773768010854,EXPMORT
209773768010854,EXPREMV
230391507010661,EXPGROW
230391507010661,EXPMORT
230391507010661,EXPREMV
231112004010661,EXPGROW
231112004010661,EXPMORT
231112004010661,EXPREMV
233707236010661,EXPALL
233707240010661,EXPCURR
233707240010661,EXPVOL
233712063010661,EXPALL
233712067010661,EXPCURR
233712067010661,EXPVOL
230279589010661,EXPGROW
230279589010661,EXPMORT
230279589010661,EXPREMV
224235185010661,EXPGROW
224235185010661,EXPMORT
224235185010661,EXPREMV
231112036010661,EXPGROW
231112036010661,EXPMORT
231112036010661,EXPREMV
225364684010661,EXPGROW
225364684010661,EXPMORT
225364684010661,EXPREMV
233717055010661,EXPALL
233717056010661,EXPCURR
233717056010661,EXPVOL
192188648010661,EXPCURR
192188648010661,EXPVOL
192206266010661,EXPALL
211656531010854,EXPCURR
211656532010854,EXPVOL
211656533010854,EXPGROW
211656533010854,EXPMORT
211656533010854,EXPREMV
248888957010854,EXPGROW
248888957010854,EXPREMV
248888957010854,EXPMORT
193273593010661,EXPALL
193273594010661,EXPCURR
193273594010661,EXPVOL
446220010839,EXPCURR
446221010839,EXPVOL
90469759010854,EXPGROW
90469759010854,EXPMORT
90469759010854,EXPREMV
90421492010854,EXPCURR
90421493010854,EXPVOL
90468516010854,EXPGROW
90468516010854,EXPMORT
90468516010854,EXPREMV
243033750010661,EXPCHNG
242926700010661,EXPCHNG
243697690010661,EXPCHNG
242933179010661,EXPCHNG
246814723010661,EXPCHNG
234609613010661,EXPCHNG
234609625010661,EXPCHNG
245826102010661,EXPCHNG
234609565010661,EXPCHNG
234609577010661,EXPCHNG
234609589010661,EXPCHNG
234609601010661,EXPCHNG
195928477010661,EXPCHNG
195929050010661,EXPCHNG
195935990010661,EXPCHNG
195935943010661,EXPCHNG
209534468010661,EXPCHNG
229909644010661,EXPCHNG
243694200010661,EXPCHNG
209499749010661,EXPCHNG
233255404010661,EXPCHNG
4069034020004,EXPCHNG
195951867010661,EXPCHNG
195951883010661,EXPCHNG
195976252010661,EXPCHNG
243034185010661,EXPCHNG
Query:
-- Corrected SQL 5
SELECT
    PS."stratum_sequence_number",
    PE."evaluation_sequence_number",
    PET."evaluation_type"
FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_ESTIMATION_UNIT" PEU
    ON PS."estimation_unit_sequence_number" = PEU."estimation_unit_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" PE
    ON PEU."evaluation_sequence_number" = PE."evaluation_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" PET
    ON PE."evaluation_sequence_number" = PET."evaluation_sequence_number"
LIMIT 100
Answer:
stratum_sequence_number,evaluation_sequence_number,evaluation_type
2171,1,EXPCURR
2171,1,EXPVOL
2172,1,EXPCURR
2172,1,EXPVOL
2173,1,EXPCURR
2173,1,EXPVOL
2174,1,EXPCURR
2174,1,EXPVOL
2175,1,EXPCURR
2175,1,EXPVOL
2176,1,EXPCURR
2176,1,EXPVOL
2177,1,EXPCURR
2177,1,EXPVOL
2178,1,EXPCURR
2178,1,EXPVOL
2179,1,EXPCURR
2179,1,EXPVOL
218,1,EXPCURR
218,1,EXPVOL
2180,1,EXPCURR
2180,1,EXPVOL
2181,1,EXPCURR
2181,1,EXPVOL
2182,1,EXPCURR
2182,1,EXPVOL
2183,1,EXPCURR
2183,1,EXPVOL
2184,1,EXPCURR
2184,1,EXPVOL
2185,1,EXPCURR
2185,1,EXPVOL
2186,1,EXPCURR
2186,1,EXPVOL
2187,1,EXPCURR
2187,1,EXPVOL
2188,1,EXPCURR
2188,1,EXPVOL
2189,1,EXPCURR
2189,1,EXPVOL
219,1,EXPCURR
219,1,EXPVOL
2190,1,EXPCURR
2190,1,EXPVOL
2191,1,EXPCURR
2191,1,EXPVOL
2192,1,EXPCURR
2192,1,EXPVOL
2193,1,EXPCURR
2193,1,EXPVOL
2194,1,EXPCURR
2194,1,EXPVOL
2195,1,EXPCURR
2195,1,EXPVOL
2196,1,EXPCURR
2196,1,EXPVOL
2197,1,EXPCURR
2197,1,EXPVOL
2198,1,EXPCURR
2198,1,EXPVOL
2096,1,EXPCURR
2096,1,EXPVOL
2097,1,EXPCURR
2097,1,EXPVOL
2098,1,EXPCURR
2098,1,EXPVOL
2099,1,EXPCURR
2099,1,EXPVOL
210,1,EXPCURR
210,1,EXPVOL
2100,1,EXPCURR
2100,1,EXPVOL
2101,1,EXPCURR
2101,1,EXPVOL
2102,1,EXPCURR
2102,1,EXPVOL
2103,1,EXPCURR
2103,1,EXPVOL
2104,1,EXPCURR
2104,1,EXPVOL
2105,1,EXPCURR
2105,1,EXPVOL
2106,1,EXPCURR
2106,1,EXPVOL
2107,1,EXPCURR
2107,1,EXPVOL
2108,1,EXPCURR
2108,1,EXPVOL
2109,1,EXPCURR
2109,1,EXPVOL
211,1,EXPCURR
211,1,EXPVOL
2110,1,EXPCURR
2110,1,EXPVOL
2111,1,EXPCURR
2111,1,EXPVOL
2112,1,EXPCURR
2112,1,EXPVOL
2113,1,EXPCURR
2113,1,EXPVOL
Query:
-- Corrected SQL 6
SELECT
    PS."stratum_sequence_number",
    PE."evaluation_sequence_number",
    PET."evaluation_type"
FROM "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_ESTIMATION_UNIT" PEU
    ON PS."estimation_unit_sequence_number" = PEU."estimation_unit_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" PE
    ON PEU."evaluation_sequence_number" = PE."evaluation_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" PET
    ON PE."evaluation_sequence_number" = PET."evaluation_sequence_number"
WHERE PET."evaluation_type" = 'EXPCURR'
LIMIT 100
Answer:
stratum_sequence_number,evaluation_sequence_number,evaluation_type
2171,1,EXPCURR
2172,1,EXPCURR
2173,1,EXPCURR
2174,1,EXPCURR
2175,1,EXPCURR
2176,1,EXPCURR
2177,1,EXPCURR
2178,1,EXPCURR
2179,1,EXPCURR
218,1,EXPCURR
2180,1,EXPCURR
2181,1,EXPCURR
2182,1,EXPCURR
2183,1,EXPCURR
2184,1,EXPCURR
2185,1,EXPCURR
2186,1,EXPCURR
2187,1,EXPCURR
2188,1,EXPCURR
2189,1,EXPCURR
219,1,EXPCURR
2190,1,EXPCURR
2191,1,EXPCURR
2192,1,EXPCURR
2193,1,EXPCURR
2194,1,EXPCURR
2195,1,EXPCURR
2196,1,EXPCURR
2197,1,EXPCURR
2198,1,EXPCURR
2096,1,EXPCURR
2097,1,EXPCURR
2098,1,EXPCURR
2099,1,EXPCURR
210,1,EXPCURR
2100,1,EXPCURR
2101,1,EXPCURR
2102,1,EXPCURR
2103,1,EXPCURR
2104,1,EXPCURR
2105,1,EXPCURR
2106,1,EXPCURR
2107,1,EXPCURR
2108,1,EXPCURR
2109,1,EXPCURR
211,1,EXPCURR
2110,1,EXPCURR
2111,1,EXPCURR
2112,1,EXPCURR
2113,1,EXPCURR
2114,1,EXPCURR
2115,1,EXPCURR
2116,1,EXPCURR
2117,1,EXPCURR
2118,1,EXPCURR
2119,1,EXPCURR
212,1,EXPCURR
2120,1,EXPCURR
2121,1,EXPCURR
2122,1,EXPCURR
2123,1,EXPCURR
2124,1,EXPCURR
2125,1,EXPCURR
2126,1,EXPCURR
2127,1,EXPCURR
2128,1,EXPCURR
2129,1,EXPCURR
213,1,EXPCURR
2130,1,EXPCURR
2131,1,EXPCURR
2132,1,EXPCURR
2133,1,EXPCURR
2063,1,EXPCURR
2134,1,EXPCURR
2135,1,EXPCURR
2136,1,EXPCURR
2137,1,EXPCURR
2138,1,EXPCURR
2139,1,EXPCURR
214,1,EXPCURR
2140,1,EXPCURR
2141,1,EXPCURR
2142,1,EXPCURR
2143,1,EXPCURR
2144,1,EXPCURR
2145,1,EXPCURR
2146,1,EXPCURR
2147,1,EXPCURR
2148,1,EXPCURR
2149,1,EXPCURR
215,1,EXPCURR
2150,1,EXPCURR
2151,1,EXPCURR
2152,1,EXPCURR
2153,1,EXPCURR
220,1,EXPCURR
2200,1,EXPCURR
2201,1,EXPCURR
2202,1,EXPCURR
2203,1,EXPCURR
Query:
-- Corrected SQL 7
SELECT
    P."plot_state_code",
    P."plot_state_code_name",
    P."plot_inventory_year",
    C."proportion_basis",
    C."condition_proportion_unadjusted",
    PS."expansion_factor",
    PS."adjustment_factor_for_the_macroplot",
    PS."adjustment_factor_for_the_subplot",
    PET."evaluation_type"
FROM "USFS_FIA"."USFS_FIA"."PLOT" P
JOIN "USFS_FIA"."USFS_FIA"."CONDITION" C
    ON P."plot_sequence_number" = C."plot_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" PSA
    ON P."plot_sequence_number" = PSA."plot_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
    ON PSA."stratum_sequence_number" = PS."stratum_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_ESTIMATION_UNIT" PEU
    ON PS."estimation_unit_sequence_number" = PEU."estimation_unit_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" PE
    ON PEU."evaluation_sequence_number" = PE."evaluation_sequence_number"
JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" PET
    ON PE."evaluation_sequence_number" = PET."evaluation_sequence_number"
WHERE P."plot_inventory_year" IN (2015, 2016, 2017)
  AND PET."evaluation_type" = 'EXPCURR'
LIMIT 100
Answer:
Too long, hard cut:
plot_state_code,plot_state_code_name,plot_inventory_year,proportion_basis,condition_proportion_unadjusted,expansion_factor,adjustment_factor_for_the_macroplot,adjustment_factor_for_the_subplot,evaluation_type
56,Wyoming,2016,SUBP,1.0,8065.7055959314785,0.0,1.0057142857142858,EXPCURR
56,Wyoming,2017,SUBP,1.0,7695.584540789055,0.0,1.0,EXPCURR
56,Wyoming,2016,SUBP,1.0,7454.2638776279,0.0,1.002816824299737,EXPCURR
56,Wyoming,2015,SUBP,1.0,7400.759375087548,0.0,1.0052356020942408,EXPCURR
56,Wyoming,2015,SUBP,1.0,8191.260148103494,0.0,1.0,EXPCURR
56,Wyoming,2015,SUBP,1.0,7400.759375087548,0.0,1.0052356020942408,EXPCURR
56,Wyoming,2015,SUBP,1.0,7946.876470588235,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,7807.480284457689,0.0,1.0,EXPCURR
56,Wyoming,2016,SUBP,1.0,9993.788004500993,0.0,1.0064516129032257,EXPCURR
56,Wyoming,2016,SUBP,1.0,9993.788004500993,0.0,1.0064516129032257,EXPCURR
56,Wyoming,2016,SUBP,1.0,8549.393139898857,0.0,1.0009910802775024,EXPCURR
56,Wyoming,2017,SUBP,1.0,9085.449770962225,0.0,1.0098039215686274,EXPCURR
56,Wyoming,2015,SUBP,1.0,9178.858889364199,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,8775.499263296768,0.0,1.0,EXPCURR
56,Wyoming,2016,SUBP,1.0,8775.499263296768,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,8551.860742450155,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,0.25,8947.411555503631,0.0,1.018181818181818,EXPCURR
56,Wyoming,2017,SUBP,0.75,8947.411555503631,0.0,1.018181818181818,EXPCURR
56,Wyoming,2017,SUBP,0.5,8758.600723045814,0.0,1.0056497175141244,EXPCURR
56,Wyoming,2017,SUBP,0.5,8758.600723045814,0.0,1.0056497175141244,EXPCURR
56,Wyoming,2016,SUBP,1.0,8382.420724094882,0.0,1.0,EXPCURR
56,Wyoming,2016,SUBP,1.0,8551.860742450155,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,8580.862244897959,0.0,1.0,EXPCURR
56,Wyoming,2016,SUBP,1.0,8902.516106654743,0.0,1.0009699321047527,EXPCURR
56,Wyoming,2015,SUBP,1.0,8968.44853729221,0.0,1.0029498525073746,EXPCURR
56,Wyoming,2016,SUBP,1.0,8382.420724094882,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,8382.420724094882,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,7639.459893048128,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,7865.370343574823,0.0,1.0119595216191353,EXPCURR
56,Wyoming,2016,SUBP,1.0,7808.21468381549,0.0,1.0023346303501945,EXPCURR
56,Wyoming,2015,SUBP,1.0,7639.459893048128,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,7387.998037856348,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,7386.489548954895,0.0,1.0,EXPCURR
56,Wyoming,2015,SUBP,1.0,7808.21468381549,0.0,1.0023346303501945,EXPCURR
56,Wyoming,2017,SUBP,1.0,7544.773568041673,0.0,1.0024650780608053,EXPCURR
56,Wyoming,2017,SUBP,1.0,7739.88133781454,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,7387.998037856348,0.0,1.0,EXPCURR
56,Wyoming,2016,SUBP,1.0,7946.876470588235,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,7386.489548954895,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,7386.489548954895,0.0,1.0,EXPCURR
56,Wyoming,2016,SUBP,1.0,7386.489548954895,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,8661.560467643609,0.0,1.0076670317634173,EXPCURR
56,Wyoming,2017,SUBP,1.0,8549.393139898857,0.0,1.0009910802775024,EXPCURR
56,Wyoming,2015,SUBP,1.0,8426.559166014149,0.0,1.0031854065210715,EXPCURR
56,Wyoming,2015,SUBP,1.0,7495.561693834935,0.0,1.000868809730669,EXPCURR
56,Wyoming,2017,SUBP,1.0,7516.455420469176,0.0,1.0,EXPCURR
56,Wyoming,2016,SUBP,1.0,7516.455420469176,0.0,1.0,EXPCURR
56,Wyoming,2015,SUBP,1.0,8551.860742450155,0.0,1.0,EXPCURR
56,Wyoming,2015,SUBP,1.0,8742.300735934416,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,8742.300735934416,0.0,1.0,EXPCURR
56,Wyoming,2016,SUBP,1.0,9099.770415922694,0.0,1.0064516129032257,EXPCURR
56,Wyoming,2017,SUBP,1.0,8902.516106654743,0.0,1.0009699321047527,EXPCURR
56,Wyoming,2015,SUBP,1.0,7575.896396396396,0.0,1.0,EXPCURR
56,Wyoming,2015,SUBP,1.0,7575.896396396396,0.0,1.0,EXPCURR
56,Wyoming,2015,SUBP,1.0,8546.709098295678,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,8417.925355549818,0.0,1.0059594755661503,EXPCURR
56,Wyoming,2016,SUBP,1.0,8902.516106654743,0.0,1.0009699321047527,EXPCURR
56,Wyoming,2017,SUBP,1.0,8829.862745098038,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,8382.420724094882,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,8558.061602331945,0.0,1.0,EXPCURR
56,Wyoming,2016,SUBP,1.0,8382.420724094882,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,7387.998037856348,0.0,1.0,EXPCURR
56,Wyoming,2016,SUBP,1.0,7662.149644453961,0.0,1.008729388942774,EXPCURR
56,Wyoming,2016,SUBP,1.0,7662.149644453961,0.0,1.008729388942774,EXPCURR
56,Wyoming,2015,SUBP,1.0,8191.260148103494,0.0,1.0,EXPCURR
56,Wyoming,2015,SUBP,1.0,7386.489548954895,0.0,1.0,EXPCURR
56,Wyoming,2015,SUBP,1.0,7386.489548954895,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,7386.489548954895,0.0,1.0,EXPCURR
56,Wyoming,2017,SUBP,1.0,7495.561693834935,0.0,1.000868809730669,EXPCURR
56,Wyoming,2017,SUBP,1.0,8522.799771306334,0.0,1.0027855153203342,EXPCURR
56,Wyoming,2015,SUBP,1.0,8661.560467643609,0.0,1.0076670317634173,EXPCURR
56,Wyoming,2017,SUBP,1.0,8732.248366013071,0.0,1.0,EXPCURR
56,Wyoming,2015,SUBP,1.0,8979.446886387814,0.0,1.000893655049151,EXPCURR
56,Wyoming,2016
Query:
-- Corrected SQL 8
SELECT DISTINCT "proportion_basis"
FROM "USFS_FIA"."USFS_FIA"."CONDITION"
LIMIT 100
Answer:
proportion_basis
SUBP
""
MACR
Query:
-- Corrected SQL 9
SELECT
    "plot_sequence_number",
    "proportion_basis",
    "condition_proportion_unadjusted"
FROM "USFS_FIA"."USFS_FIA"."CONDITION"
WHERE "proportion_basis" IN ('SUBP', 'MACR')
LIMIT 100
Answer:
plot_sequence_number,proportion_basis,condition_proportion_unadjusted
495147849126144,SUBP,0.5
43542784010478,SUBP,0.25
79204355010478,SUBP,1.0
100186090010478,SUBP,0.24230000376701355
43771636010478,SUBP,1.0
30586762010478,SUBP,0.25
43647553010478,SUBP,1.0
535843807126144,SUBP,0.9873560070991516
214888727010854,SUBP,0.25
100180355010478,SUBP,0.25
220500722010854,SUBP,0.3515999913215637
480976653489998,SUBP,0.25
30875192010478,SUBP,1.0
43084647010478,SUBP,0.3610999882221222
335445281489998,SUBP,0.75
43166825010478,SUBP,0.75
22304784010478,SUBP,0.928600013256073
22302886010478,SUBP,0.38749998807907104
559478436126144,SUBP,1.0
22336428010478,SUBP,0.75
43357912010478,SUBP,1.0
495148119126144,SUBP,1.0
106316002010478,SUBP,1.0
259119045010854,SUBP,0.5
258657240489998,SUBP,0.25
85129133010478,SUBP,1.0
76401058010478,SUBP,1.0
61445255010478,SUBP,0.5
43119341010478,SUBP,0.75
22301243010478,SUBP,0.25
335445616489998,SUBP,0.75
236617724010854,SUBP,0.5
43789508010478,SUBP,0.25
43899199010478,SUBP,1.0
259204408010854,SUBP,1.0
259204976010854,SUBP,0.25
252281636010854,SUBP,0.210999995470047
30586627010478,SUBP,0.6467000246047974
30652282010478,SUBP,1.0
43626187010478,SUBP,1.0
480977056489998,SUBP,0.4457870125770569
335445190489998,SUBP,0.7512500286102295
698001372126144,SUBP,1.0
22338112010478,SUBP,1.0
43217862010478,SUBP,1.0
335445288489998,SUBP,0.25
22339053010478,SUBP,0.25
20005707010478,SUBP,1.0
17548640010478,SUBP,1.0
132065303010478,SUBP,0.29887500405311584
20011377010478,SUBP,1.0
17552516010478,SUBP,1.0
353325750489998,SUBP,0.75
17490475010478,SUBP,0.8175039887428284
17501384010478,SUBP,0.625
484310856489998,SUBP,1.0
17549083010478,SUBP,1.0
443867609489998,SUBP,1.0
218218854020004,SUBP,0.75
259178253010854,SUBP,0.5
249673508010854,SUBP,0.7458000183105469
176859679010854,SUBP,0.24860000610351562
218218020020004,SUBP,1.0
140592502010478,SUBP,0.030300000682473183
289515746489998,SUBP,1.0
289515932489998,SUBP,0.9108930230140686
259178250010854,SUBP,0.25
20349085010478,SUBP,1.0
43646445010478,SUBP,1.0
43662566010478,SUBP,1.0
52253743020004,SUBP,0.25
43717945010478,SUBP,0.11389999836683273
43697750010478,SUBP,1.0
43901399010478,SUBP,0.25
480976558489998,SUBP,0.25
252281550010854,SUBP,0.45010000467300415
52253027020004,SUBP,0.25
678976501126144,SUBP,0.5684900283813477
100657370010478,SUBP,1.0
85173384010478,SUBP,0.8945000171661377
548083678126144,SUBP,0.5
548083167126144,SUBP,1.0
548083419126144,SUBP,0.37222298979759216
264160208489998,SUBP,1.0
264160249489998,SUBP,0.75
258657100489998,SUBP,1.0
30197092010478,SUBP,0.43389999866485596
523738296126144,SUBP,0.75
145789406010478,SUBP,0.25
43872068010478,SUBP,0.34439998865127563
43277599010478,SUBP,0.75
43091837010478,SUBP,1.0
175742259010854,SUBP,0.9930999875068665
85157074010478,SUBP,0.5468000173568726
258657268489998,SUBP,0.75
495147935126144,SUBP,1.0
43488309010478,SUBP,0.23250000178813934
61573335010478,SUBP,0.75
385729174489998,SUBP,0.050978999584913254
282502210489998,SUBP,0.75
Query:
SELECT
    "plot_type",
    "year",
    "state",
    "average_size"
FROM (
    SELECT
        "plot_type",
        "year",
        "state",
        "average_size",
        ROW_NUMBER() OVER (
            PARTITION BY "plot_type", "year"
            ORDER BY "average_size" DESC
        ) AS "rn"
    FROM (
        SELECT
            CASE
                WHEN C."proportion_basis" = 'SUBP' THEN 'subplot'
                WHEN C."proportion_basis" = 'MACR' THEN 'macroplot'
                ELSE 'unknown'
            END AS "plot_type",
            P."plot_inventory_year" AS "year",
            P."plot_state_code_name" AS "state",
            AVG(
                PS."expansion_factor" * C."condition_proportion_unadjusted" *
                CASE
                    WHEN C."proportion_basis" = 'SUBP' AND COALESCE(PS."adjustment_factor_for_the_subplot", 0) > 0 THEN
                        PS."adjustment_factor_for_the_subplot"
                    WHEN C."proportion_basis" = 'MACR' AND COALESCE(PS."adjustment_factor_for_the_macroplot", 0) > 0 THEN
                        PS."adjustment_factor_for_the_macroplot"
                    ELSE 0
                END
            ) AS "average_size"
        FROM "USFS_FIA"."USFS_FIA"."PLOT" P
        JOIN "USFS_FIA"."USFS_FIA"."CONDITION" C
            ON P."plot_sequence_number" = C."plot_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" PSA
            ON P."plot_sequence_number" = PSA."plot_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
            ON PSA."stratum_sequence_number" = PS."stratum_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_ESTIMATION_UNIT" PEU
            ON PS."estimation_unit_sequence_number" = PEU."estimation_unit_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" PE
            ON PEU."evaluation_sequence_number" = PE."evaluation_sequence_number"
        JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" PET
            ON PE."evaluation_sequence_number" = PET."evaluation_sequence_number"
        WHERE
            P."plot_inventory_year" IN (2015, 2016, 2017)
            AND PET."evaluation_type" = 'EXPCURR'
            AND C."condition_status_code" = 1  -- Accessible forest land
        GROUP BY
            "plot_type", "year", "state"
    ) AS "avg_sizes"
) AS "ranked_states"
WHERE "average_size" > 0 AND "rn" = 1
ORDER BY "plot_type", "year";
Answer:
plot_type,year,state,average_size
macroplot,2015,California,4937.295863300523
macroplot,2016,California,5128.199385365012
macroplot,2017,California,5043.9370607363635
subplot,2015,Wyoming,7634.419129440116
subplot,2016,Wyoming,7054.171375211551
subplot,2017,Hawaii,7812.384403896898
Query:
-- Corrected SQL 11
SELECT DISTINCT
    "condition_status_code",
    "condition_status_code_name"
FROM "USFS_FIA"."USFS_FIA"."CONDITION"
WHERE "condition_status_code" IS NOT NULL
  AND "condition_status_code_name" IS NOT NULL
LIMIT 100
Answer:
condition_status_code,condition_status_code_name
2,Nonforest land
1,Accessible forest land
Query:
-- Corrected SQL 12
SELECT DISTINCT
    "plot_status_code",
    "plot_status_code_name"
FROM "USFS_FIA"."USFS_FIA"."PLOT"
WHERE "plot_status_code" IS NOT NULL
  AND "plot_status_code_name" IS NOT NULL
LIMIT 100
Answer:
plot_status_code,plot_status_code_name
2,Sampled - no accessible forest land condition present on plot
3,Nonsampled
1,Sampled - at least one accessible forest land condition present on plot
Query:
-- Corrected SQL 13
SELECT
    "plot_sequence_number",
    "plot_status_code",
    "plot_status_code_name"
FROM "USFS_FIA"."USFS_FIA"."PLOT"
WHERE "plot_status_code" = 1
  AND "plot_sequence_number" IS NOT NULL
LIMIT 100
Answer:
Too long, hard cut:
plot_sequence_number,plot_status_code,plot_status_code_name
56877929010478,1,Sampled - at least one accessible forest land condition present on plot
56823539010478,1,Sampled - at least one accessible forest land condition present on plot
56634683010478,1,Sampled - at least one accessible forest land condition present on plot
56948771010478,1,Sampled - at least one accessible forest land condition present on plot
56799233010478,1,Sampled - at least one accessible forest land condition present on plot
216089991010854,1,Sampled - at least one accessible forest land condition present on plot
56623914010478,1,Sampled - at least one accessible forest land condition present on plot
216089358010854,1,Sampled - at least one accessible forest land condition present on plot
216091521010854,1,Sampled - at least one accessible forest land condition present on plot
56836738010478,1,Sampled - at least one accessible forest land condition present on plot
56811826010478,1,Sampled - at least one accessible forest land condition present on plot
216089632010854,1,Sampled - at least one accessible forest land condition present on plot
56789731010478,1,Sampled - at least one accessible forest land condition present on plot
56887969010478,1,Sampled - at least one accessible forest land condition present on plot
56922547010478,1,Sampled - at least one accessible forest land condition present on plot
216092635010854,1,Sampled - at least one accessible forest land condition present on plot
56816672010478,1,Sampled - at least one accessible forest land condition present on plot
56853324010478,1,Sampled - at least one accessible forest land condition present on plot
216091982010854,1,Sampled - at least one accessible forest land condition present on plot
56972948010478,1,Sampled - at least one accessible forest land condition present on plot
56808547010478,1,Sampled - at least one accessible forest land condition present on plot
56965977010478,1,Sampled - at least one accessible forest land condition present on plot
56891176010478,1,Sampled - at least one accessible forest land condition present on plot
56953649010478,1,Sampled - at least one accessible forest land condition present on plot
56611632010478,1,Sampled - at least one accessible forest land condition present on plot
56811550010478,1,Sampled - at least one accessible forest land condition present on plot
56862195010478,1,Sampled - at least one accessible forest land condition present on plot
56835189010478,1,Sampled - at least one accessible forest land condition present on plot
56836411010478,1,Sampled - at least one accessible forest land condition present on plot
56824207010478,1,Sampled - at least one accessible forest land condition present on plot
56818558010478,1,Sampled - at least one accessible forest land condition present on plot
56750180010478,1,Sampled - at least one accessible forest land condition present on plot
56909932010478,1,Sampled - at least one accessible forest land condition present on plot
216090990010854,1,Sampled - at least one accessible forest land condition present on plot
56625554010478,1,Sampled - at least one accessible forest land condition present on plot
56672926010478,1,Sampled - at least one accessible forest land condition present on plot
56613948010478,1,Sampled - at least one accessible forest land condition present on plot
216089499010854,1,Sampled - at least one accessible forest land condition present on plot
56661230010478,1,Sampled - at least one accessible forest land condition present on plot
56672813010478,1,Sampled - at least one accessible forest land condition present on plot
56659176010478,1,Sampled - at least one accessible forest land condition present on plot
216091478010854,1,Sampled - at least one accessible forest land condition present on plot
56862568010478,1,Sampled - at least one accessible forest land condition present on plot
56781195010478,1,Sampled - at least one accessible forest land condition present on plot
56755640010478,1,Sampled - at least one accessible forest land condition present on plot
216091520010854,1,Sampled - at least one accessible forest land condition present on plot
56686025010478,1,Sampled - at least one accessible forest land condition present on plot
216092555010854,1,Sampled - at least one accessible forest land condition present on plot
56935437010478,1,Sampled - at least one accessible forest land condition present on plot
216089188010854,1,Sampled - at least one accessible forest land condition present on plot
56708684010478,1,Sampled - at least one accessible forest land condition present on plot
56590292010478,1,Sampled - at least one accessible forest land condition present on plot
216091539010854,1,Sampled - at least one accessible forest land condition present on plot
216089795010854,1,Sampled - at least one accessible forest land condition present on plot
216089455010854,1,Sampled - at least one accessible forest land condition present on plot
56917769010478,1,Sampled - at 
Query:
-- Corrected SQL 14
SELECT DISTINCT
    "plot_state_code",
    "plot_state_code_name"
FROM "USFS_FIA"."USFS_FIA"."PLOT"
WHERE "plot_state_code" IS NOT NULL
  AND "plot_state_code_name" IS NOT NULL
LIMIT 100
Answer:
plot_state_code,plot_state_code_name
10,Delaware
8,Colorado
64,Federated States of Micronesia
60,American Samoa
41,Oregon
6,California
70,Palau
34,New Jersey
50,Vermont
40,Oklahoma
24,Maryland
30,Montana
21,Kentucky
1,Alabama
47,Tennessee
48,Texas
22,Louisiana
17,Illinois
42,Pennsylvania
26,Michigan
28,Mississippi
78,U.S. Virgin Islands
35,New Mexico
16,Idaho
12,Florida
2,Alaska
20,Kansas
5,Arkansas
33,New Hampshire
31,Nebraska
25,Massachusetts
23,Maine
46,South Dakota
39,Ohio
18,Indiana
49,Utah
56,Wyoming
66,Guam
69,Northern Mariana Islands
19,Iowa
13,Georgia
37,North Carolina
51,Virginia
55,Wisconsin
44,Rhode Island
4,Arizona
45,South Carolina
72,Puerto Rico
9,Connecticut
54,West Virginia
29,Missouri
27,Minnesota
38,North Dakota
15,Hawaii
53,Washington
36,New York
32,Nevada
Query:
-- Corrected SQL 15
SELECT
    P."plot_state_code",
    P."plot_state_code_name",
    P."plot_inventory_year",
    COUNT(*) AS "condition_count"
FROM "USFS_FIA"."USFS_FIA"."PLOT" P
JOIN "USFS_FIA"."USFS_FIA"."CONDITION" C
    ON P."plot_sequence_number" = C."plot_sequence_number"
WHERE P."plot_sequence_number" IS NOT NULL
  AND C."plot_sequence_number" IS NOT NULL
GROUP BY
    P."plot_state_code",
    P."plot_state_code_name",
    P."plot_inventory_year"
HAVING COUNT(*) > 0
ORDER BY "condition_count" DESC
LIMIT 100
Answer:
plot_state_code,plot_state_code_name,plot_inventory_year,condition_count
27,Minnesota,1990,43957
27,Minnesota,1977,36478
20,Kansas,1981,23705
46,South Dakota,1980,23206
26,Michigan,1993,18484
38,North Dakota,1980,18214
20,Kansas,1994,18142
29,Missouri,1989,17270
55,Wisconsin,1983,15908
46,South Dakota,1995,15773
30,Montana,1989,15432
26,Michigan,1980,14958
32,Nevada,1989,14788
31,Nebraska,1983,14449
12,Florida,1995,13712
55,Wisconsin,1996,13635
13,Georgia,1997,13296
19,Iowa,1990,12767
17,Illinois,1998,12608
12,Florida,1987,12441
13,Georgia,1989,12015
13,Georgia,1982,11820
35,New Mexico,1999,11626
18,Indiana,1986,11440
56,Wyoming,2000,11267
12,Florida,1980,11130
17,Illinois,1985,10957
38,North Dakota,1995,10816
35,New Mexico,1987,10095
37,North Carolina,1990,10018
37,North Carolina,1984,9373
16,Idaho,1991,9160
4,Arizona,1999,9074
37,North Carolina,2002,8715
1,Alabama,2000,8543
49,Utah,1993,8515
37,North Carolina,1974,8398
4,Arizona,1985,8269
56,Wyoming,1984,7724
51,Virginia,1992,7652
51,Virginia,1985,7652
6,California,1994,7587
41,Oregon,1999,7517
28,Mississippi,2006,7293
18,Indiana,1998,7254
51,Virginia,1977,7116
31,Nebraska,1994,7092
45,South Carolina,1993,7031
45,South Carolina,1986,7020
13,Georgia,1972,6712
45,South Carolina,1978,6627
8,Colorado,1984,6535
47,Tennessee,1999,6389
5,Arkansas,1995,6002
5,Arkansas,1988,5968
5,Arkansas,1978,5941
1,Alabama,1982,5848
1,Alabama,1990,5827
42,Pennsylvania,1989,5447
36,New York,1993,5406
28,Mississippi,1994,5375
28,Mississippi,1987,5371
12,Florida,1970,5207
39,Ohio,1991,5056
26,Michigan,2000,4884
26,Michigan,2005,4802
26,Michigan,2007,4734
47,Tennessee,1989,4698
26,Michigan,2006,4694
26,Michigan,2002,4634
26,Michigan,2003,4595
26,Michigan,2004,4574
26,Michigan,2001,4571
55,Wisconsin,2003,4484
22,Louisiana,1984,4475
22,Louisiana,1991,4471
45,South Carolina,1968,4450
27,Minnesota,2017,4429
27,Minnesota,2018,4416
27,Minnesota,2012,4390
27,Minnesota,2015,4382
27,Minnesota,2014,4375
27,Minnesota,2010,4366
27,Minnesota,2013,4358
27,Minnesota,2016,4354
27,Minnesota,2011,4321
27,Minnesota,2005,4294
27,Minnesota,2007,4280
27,Minnesota,2009,4261
27,Minnesota,2000,4259
27,Minnesota,2001,4239
27,Minnesota,2008,4225
27,Minnesota,2006,4201
27,Minnesota,2003,4175
27,Minnesota,2004,4165
27,Minnesota,2002,4114
48,Texas,2011,4048
48,Texas,2013,4006
48,Texas,2010,3997
48,Texas,2014,3950
End Exploring Related Columns
Task: Which states had the largest average subplot size and the largest average macroplot size respectively for each of the years 2015, 2016, and 2017, based on accessible forest land and current evaluations (EXPCURR)? Display the type of plot (subplot or macroplot), the year, the state, and the corresponding average size for each type and each specific year.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
plot_type,year,state,average_size
subplot,2015,state1:str,average_size:float
subplot,2016,state2:str,average_size:float
subplot,2017,state3:str,average_size:float
macroplot,2015,state4:str,average_size:float
macroplot,2016,state5:str,average_size:float
macroplot,2017,state6:str,average_size:float
(Attention: answer in six rows)
```

**Explanation:**

For each of the years 2015, 2016, and 2017, we calculated the average subplot size and average macroplot size for each state based on accessible forest land and current evaluations (EXPCURR). We then identified the state with the largest average size for each plot type and year. The table above displays the type of plot (subplot or macroplot), the year, the state with the largest average size, and the corresponding average size..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'USFS_FIA': {'USFS_FIA': ['CONDITION', 'ESTIMATED_FORESTLAND_ACRES', 'ESTIMATED_TIMBERLAND_ACRES', 'PLOT', 'PLOT_TREE', 'POPULATION', 'POPULATION_ESTIMATION_UNIT', 'POPULATION_EVALUATION', 'POPULATION_EVALUATION_GROUP', 'POPULATION_EVALUATION_TYPE', 'POPULATION_STRATUM', 'POPULATION_STRATUM_ASSIGN', 'TREE']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-23 02:15:51 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 02:15:51 - root - INFO - ```sql
SELECT
    "plot_type",
    "year",
    "state",
    "average_size"
FROM (
    SELECT
        "plot_type",
        "year",
        "state",
        "average_size",
        ROW_NUMBER() OVER (
            PARTITION BY "plot_type", "year"
            ORDER BY "average_size" DESC
        ) AS "rn"
    FROM (
        SELECT
            CASE
                WHEN C."proportion_basis" = 'SUBP' THEN 'subplot'
                WHEN C."proportion_basis" = 'MACR' THEN 'macroplot'
                ELSE 'unknown'
            END AS "plot_type",
            P."plot_inventory_year" AS "year",
            P."plot_state_code_name" AS "state",
            AVG(area) AS "average_size"
        FROM (
            SELECT
                P."plot_sequence_number",
                P."plot_inventory_year",
                P."plot_state_code_name",
                C."proportion_basis",
                C."condition_proportion_unadjusted",
                PS."expansion_factor",
                PS."adjustment_factor_for_the_macroplot",
                PS."adjustment_factor_for_the_subplot",
                CASE
                    WHEN C."proportion_basis" = 'SUBP' AND COALESCE(PS."adjustment_factor_for_the_subplot", 0) > 0
                    THEN PS."expansion_factor" * C."condition_proportion_unadjusted" * PS."adjustment_factor_for_the_subplot"
                    WHEN C."proportion_basis" = 'MACR' AND COALESCE(PS."adjustment_factor_for_the_macroplot", 0) > 0
                    THEN PS."expansion_factor" * C."condition_proportion_unadjusted" * PS."adjustment_factor_for_the_macroplot"
                    ELSE NULL
                END AS area
            FROM "USFS_FIA"."USFS_FIA"."PLOT" P
            JOIN "USFS_FIA"."USFS_FIA"."CONDITION" C
                ON P."plot_sequence_number" = C."plot_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" PSA
                ON P."plot_sequence_number" = PSA."plot_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
                ON PSA."stratum_sequence_number" = PS."stratum_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_ESTIMATION_UNIT" PEU
                ON PS."estimation_unit_sequence_number" = PEU."estimation_unit_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" PE
                ON PEU."evaluation_sequence_number" = PE."evaluation_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" PET
                ON PE."evaluation_sequence_number" = PET."evaluation_sequence_number"
            WHERE
                P."plot_inventory_year" IN (2015, 2016, 2017)
                AND PET."evaluation_type" = 'EXPCURR'
                AND C."condition_status_code" = 1  -- Accessible forest land
        ) AS sub
        GROUP BY
            "plot_type", "year", "state"
    ) AS avg_sizes
) AS ranked
WHERE rn = 1
ORDER BY "plot_type", "year";
```
2025-01-23 02:15:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:15:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:15:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:15:53 - snowflake.connector.connection - INFO - closed
2025-01-23 02:15:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:15:53 - root - INFO - itercount: 1
2025-01-23 02:15:53 - root - INFO - 000904 (42000): 01b9e4e7-0004-8054-0001-11c300f5c24e: SQL compilation error: error line 19 at position 21
invalid identifier 'C."proportion_basis"'
2025-01-23 02:15:53 - root - INFO - Input sql:
SELECT
    "plot_type",
    "year",
    "state",
    "average_size"
FROM (
    SELECT
        "plot_type",
        "year",
        "state",
        "average_size",
        ROW_NUMBER() OVER (
            PARTITION BY "plot_type", "year"
            ORDER BY "average_size" DESC
        ) AS "rn"
    FROM (
        SELECT
            CASE
                WHEN C."proportion_basis" = 'SUBP' THEN 'subplot'
                WHEN C."proportion_basis" = 'MACR' THEN 'macroplot'
                ELSE 'unknown'
            END AS "plot_type",
            P."plot_inventory_year" AS "year",
            P."plot_state_code_name" AS "state",
            AVG(area) AS "average_size"
        FROM (
            SELECT
                P."plot_sequence_number",
                P."plot_inventory_year",
                P."plot_state_code_name",
                C."proportion_basis",
                C."condition_proportion_unadjusted",
                PS."expansion_factor",
                PS."adjustment_factor_for_the_macroplot",
                PS."adjustment_factor_for_the_subplot",
                CASE
                    WHEN C."proportion_basis" = 'SUBP' AND COALESCE(PS."adjustment_factor_for_the_subplot", 0) > 0
                    THEN PS."expansion_factor" * C."condition_proportion_unadjusted" * PS."adjustment_factor_for_the_subplot"
                    WHEN C."proportion_basis" = 'MACR' AND COALESCE(PS."adjustment_factor_for_the_macroplot", 0) > 0
                    THEN PS."expansion_factor" * C."condition_proportion_unadjusted" * PS."adjustment_factor_for_the_macroplot"
                    ELSE NULL
                END AS area
            FROM "USFS_FIA"."USFS_FIA"."PLOT" P
            JOIN "USFS_FIA"."USFS_FIA"."CONDITION" C
                ON P."plot_sequence_number" = C."plot_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" PSA
                ON P."plot_sequence_number" = PSA."plot_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
                ON PSA."stratum_sequence_number" = PS."stratum_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_ESTIMATION_UNIT" PEU
                ON PS."estimation_unit_sequence_number" = PEU."estimation_unit_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" PE
                ON PEU."evaluation_sequence_number" = PE."evaluation_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" PET
                ON PE."evaluation_sequence_number" = PET."evaluation_sequence_number"
            WHERE
                P."plot_inventory_year" IN (2015, 2016, 2017)
                AND PET."evaluation_type" = 'EXPCURR'
                AND C."condition_status_code" = 1  -- Accessible forest land
        ) AS sub
        GROUP BY
            "plot_type", "year", "state"
    ) AS avg_sizes
) AS ranked
WHERE rn = 1
ORDER BY "plot_type", "year";
The error information is:
000904 (42000): 01b9e4e7-0004-8054-0001-11c300f5c24e: SQL compilation error: error line 19 at position 21
invalid identifier 'C."proportion_basis"'
Please correct it and output only 1 complete SQL query.When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-23 02:17:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 02:17:08 - root - INFO - ```sql
SELECT
    "plot_type",
    "year",
    "state",
    "average_size"
FROM (
    SELECT
        "plot_type",
        "year",
        "state",
        "average_size",
        ROW_NUMBER() OVER (
            PARTITION BY "plot_type", "year"
            ORDER BY "average_size" DESC NULLS LAST
        ) AS "rn"
    FROM (
        SELECT
            sub."plot_type",
            sub."plot_inventory_year" AS "year",
            sub."plot_state_code_name" AS "state",
            AVG(sub.area) AS "average_size"
        FROM (
            SELECT
                P."plot_sequence_number",
                P."plot_inventory_year",
                P."plot_state_code_name",
                CASE
                    WHEN C."proportion_basis" = 'SUBP' THEN 'subplot'
                    WHEN C."proportion_basis" = 'MACR' THEN 'macroplot'
                    ELSE 'unknown'
                END AS "plot_type",
                CASE
                    WHEN C."proportion_basis" = 'SUBP' AND COALESCE(PS."adjustment_factor_for_the_subplot", 0) > 0
                        THEN PS."expansion_factor" * C."condition_proportion_unadjusted" * PS."adjustment_factor_for_the_subplot"
                    WHEN C."proportion_basis" = 'MACR' AND COALESCE(PS."adjustment_factor_for_the_macroplot", 0) > 0
                        THEN PS."expansion_factor" * C."condition_proportion_unadjusted" * PS."adjustment_factor_for_the_macroplot"
                    ELSE NULL
                END AS area
            FROM "USFS_FIA"."USFS_FIA"."PLOT" P
            JOIN "USFS_FIA"."USFS_FIA"."CONDITION" C
                ON P."plot_sequence_number" = C."plot_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" PSA
                ON P."plot_sequence_number" = PSA."plot_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
                ON PSA."stratum_sequence_number" = PS."stratum_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_ESTIMATION_UNIT" PEU
                ON PS."estimation_unit_sequence_number" = PEU."estimation_unit_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" PE
                ON PEU."evaluation_sequence_number" = PE."evaluation_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" PET
                ON PE."evaluation_sequence_number" = PET."evaluation_sequence_number"
            WHERE
                P."plot_inventory_year" IN (2015, 2016, 2017)
                AND PET."evaluation_type" = 'EXPCURR'
                AND C."condition_status_code" = 1  -- Accessible forest land
        ) AS sub
        WHERE sub.area IS NOT NULL
        GROUP BY
            sub."plot_type",
            sub."plot_inventory_year",
            sub."plot_state_code_name"
    ) AS avg_sizes
) AS ranked
WHERE rn = 1
ORDER BY "plot_type", "year";
```
2025-01-23 02:17:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:17:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:17:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:17:09 - snowflake.connector.connection - INFO - closed
2025-01-23 02:17:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:17:10 - root - INFO - itercount: 2
2025-01-23 02:17:10 - root - INFO - 000904 (42000): 01b9e4e9-0004-7ed2-0001-11c300f593c2: SQL compilation error: error line 64 at position 6
invalid identifier 'RN'
2025-01-23 02:17:10 - root - INFO - Input sql:
SELECT
    "plot_type",
    "year",
    "state",
    "average_size"
FROM (
    SELECT
        "plot_type",
        "year",
        "state",
        "average_size",
        ROW_NUMBER() OVER (
            PARTITION BY "plot_type", "year"
            ORDER BY "average_size" DESC NULLS LAST
        ) AS "rn"
    FROM (
        SELECT
            sub."plot_type",
            sub."plot_inventory_year" AS "year",
            sub."plot_state_code_name" AS "state",
            AVG(sub.area) AS "average_size"
        FROM (
            SELECT
                P."plot_sequence_number",
                P."plot_inventory_year",
                P."plot_state_code_name",
                CASE
                    WHEN C."proportion_basis" = 'SUBP' THEN 'subplot'
                    WHEN C."proportion_basis" = 'MACR' THEN 'macroplot'
                    ELSE 'unknown'
                END AS "plot_type",
                CASE
                    WHEN C."proportion_basis" = 'SUBP' AND COALESCE(PS."adjustment_factor_for_the_subplot", 0) > 0
                        THEN PS."expansion_factor" * C."condition_proportion_unadjusted" * PS."adjustment_factor_for_the_subplot"
                    WHEN C."proportion_basis" = 'MACR' AND COALESCE(PS."adjustment_factor_for_the_macroplot", 0) > 0
                        THEN PS."expansion_factor" * C."condition_proportion_unadjusted" * PS."adjustment_factor_for_the_macroplot"
                    ELSE NULL
                END AS area
            FROM "USFS_FIA"."USFS_FIA"."PLOT" P
            JOIN "USFS_FIA"."USFS_FIA"."CONDITION" C
                ON P."plot_sequence_number" = C."plot_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" PSA
                ON P."plot_sequence_number" = PSA."plot_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
                ON PSA."stratum_sequence_number" = PS."stratum_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_ESTIMATION_UNIT" PEU
                ON PS."estimation_unit_sequence_number" = PEU."estimation_unit_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" PE
                ON PEU."evaluation_sequence_number" = PE."evaluation_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" PET
                ON PE."evaluation_sequence_number" = PET."evaluation_sequence_number"
            WHERE
                P."plot_inventory_year" IN (2015, 2016, 2017)
                AND PET."evaluation_type" = 'EXPCURR'
                AND C."condition_status_code" = 1  -- Accessible forest land
        ) AS sub
        WHERE sub.area IS NOT NULL
        GROUP BY
            sub."plot_type",
            sub."plot_inventory_year",
            sub."plot_state_code_name"
    ) AS avg_sizes
) AS ranked
WHERE rn = 1
ORDER BY "plot_type", "year";
The error information is:
000904 (42000): 01b9e4e9-0004-7ed2-0001-11c300f593c2: SQL compilation error: error line 64 at position 6
invalid identifier 'RN'
Please correct it and output only 1 complete SQL query.
2025-01-23 02:17:53 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 02:17:53 - root - INFO - ```sql
SELECT
    ranked."plot_type",
    ranked."year",
    ranked."state",
    ranked."average_size"
FROM (
    SELECT
        "plot_type",
        "year",
        "state",
        "average_size",
        ROW_NUMBER() OVER (
            PARTITION BY "plot_type", "year"
            ORDER BY "average_size" DESC NULLS LAST
        ) AS "rn"
    FROM (
        SELECT
            sub."plot_type",
            sub."plot_inventory_year" AS "year",
            sub."plot_state_code_name" AS "state",
            AVG(sub.area) AS "average_size"
        FROM (
            SELECT
                P."plot_sequence_number",
                P."plot_inventory_year",
                P."plot_state_code_name",
                CASE
                    WHEN C."proportion_basis" = 'SUBP' THEN 'subplot'
                    WHEN C."proportion_basis" = 'MACR' THEN 'macroplot'
                    ELSE 'unknown'
                END AS "plot_type",
                CASE
                    WHEN C."proportion_basis" = 'SUBP' AND COALESCE(PS."adjustment_factor_for_the_subplot", 0) > 0
                        THEN PS."expansion_factor" * C."condition_proportion_unadjusted" * PS."adjustment_factor_for_the_subplot"
                    WHEN C."proportion_basis" = 'MACR' AND COALESCE(PS."adjustment_factor_for_the_macroplot", 0) > 0
                        THEN PS."expansion_factor" * C."condition_proportion_unadjusted" * PS."adjustment_factor_for_the_macroplot"
                    ELSE NULL
                END AS area
            FROM "USFS_FIA"."USFS_FIA"."PLOT" P
            JOIN "USFS_FIA"."USFS_FIA"."CONDITION" C
                ON P."plot_sequence_number" = C."plot_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" PSA
                ON P."plot_sequence_number" = PSA."plot_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
                ON PSA."stratum_sequence_number" = PS."stratum_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_ESTIMATION_UNIT" PEU
                ON PS."estimation_unit_sequence_number" = PEU."estimation_unit_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" PE
                ON PEU."evaluation_sequence_number" = PE."evaluation_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" PET
                ON PE."evaluation_sequence_number" = PET."evaluation_sequence_number"
            WHERE
                P."plot_inventory_year" IN (2015, 2016, 2017)
                AND PET."evaluation_type" = 'EXPCURR'
                AND C."condition_status_code" = 1  -- Accessible forest land
        ) AS sub
        WHERE sub.area IS NOT NULL
        GROUP BY
            sub."plot_type",
            sub."plot_inventory_year",
            sub."plot_state_code_name"
    ) AS avg_sizes
) AS ranked
WHERE ranked."rn" = 1
ORDER BY "plot_type", "year";
```
2025-01-23 02:17:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:17:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:17:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:17:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-23 02:17:55 - snowflake.connector.connection - INFO - closed
2025-01-23 02:17:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:17:55 - root - INFO - itercount: 3
2025-01-23 02:17:55 - root - INFO - 0
2025-01-23 02:17:55 - root - INFO - results: 
plot_type,year,state,average_size
macroplot,2015,California,4937.295863300523
macroplot,2016,California,5128.199385365012
macroplot,2017,California,5043.9370607363635
subplot,2015,Wyoming,7634.419129440116
subplot,2016,Wyoming,7054.171375211551
subplot,2017,Hawaii,7812.384403896898


2025-01-23 02:17:55 - root - INFO - Please check the answer again by reviewing Which states had the largest average subplot size and the largest average macroplot size respectively for each of the years 2015, 2016, and 2017, based on accessible forest land and current evaluations (EXPCURR)? Display the type of plot (subplot or macroplot), the year, the state, and the corresponding average size for each type and each specific year., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
plot_type,year,state,average_size
subplot,2015,state1:str,average_size:float
subplot,2016,state2:str,average_size:float
subplot,2017,state3:str,average_size:float
macroplot,2015,state4:str,average_size:float
macroplot,2016,state5:str,average_size:float
macroplot,2017,state6:str,average_size:float
(Attention: answer in six rows)
```

**Explanation:**

For each of the years 2015, 2016, and 2017, we calculated the average subplot size and average macroplot size for each state based on accessible forest land and current evaluations (EXPCURR). We then identified the state with the largest average size for each plot type and year. The table above displays the type of plot (subplot or macroplot), the year, the state with the largest average size, and the corresponding average size. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
plot_type,year,state,average_size
macroplot,2015,California,4937.295863300523
macroplot,2016,California,5128.199385365012
macroplot,2017,California,5043.9370607363635
subplot,2015,Wyoming,7634.419129440116
subplot,2016,Wyoming,7054.171375211551
subplot,2017,Hawaii,7812.384403896898
Current sql:
SELECT
    ranked."plot_type",
    ranked."year",
    ranked."state",
    ranked."average_size"
FROM (
    SELECT
        "plot_type",
        "year",
        "state",
        "average_size",
        ROW_NUMBER() OVER (
            PARTITION BY "plot_type", "year"
            ORDER BY "average_size" DESC NULLS LAST
        ) AS "rn"
    FROM (
        SELECT
            sub."plot_type",
            sub."plot_inventory_year" AS "year",
            sub."plot_state_code_name" AS "state",
            AVG(sub.area) AS "average_size"
        FROM (
            SELECT
                P."plot_sequence_number",
                P."plot_inventory_year",
                P."plot_state_code_name",
                CASE
                    WHEN C."proportion_basis" = 'SUBP' THEN 'subplot'
                    WHEN C."proportion_basis" = 'MACR' THEN 'macroplot'
                    ELSE 'unknown'
                END AS "plot_type",
                CASE
                    WHEN C."proportion_basis" = 'SUBP' AND COALESCE(PS."adjustment_factor_for_the_subplot", 0) > 0
                        THEN PS."expansion_factor" * C."condition_proportion_unadjusted" * PS."adjustment_factor_for_the_subplot"
                    WHEN C."proportion_basis" = 'MACR' AND COALESCE(PS."adjustment_factor_for_the_macroplot", 0) > 0
                        THEN PS."expansion_factor" * C."condition_proportion_unadjusted" * PS."adjustment_factor_for_the_macroplot"
                    ELSE NULL
                END AS area
            FROM "USFS_FIA"."USFS_FIA"."PLOT" P
            JOIN "USFS_FIA"."USFS_FIA"."CONDITION" C
                ON P."plot_sequence_number" = C."plot_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" PSA
                ON P."plot_sequence_number" = PSA."plot_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
                ON PSA."stratum_sequence_number" = PS."stratum_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_ESTIMATION_UNIT" PEU
                ON PS."estimation_unit_sequence_number" = PEU."estimation_unit_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" PE
                ON PEU."evaluation_sequence_number" = PE."evaluation_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" PET
                ON PE."evaluation_sequence_number" = PET."evaluation_sequence_number"
            WHERE
                P."plot_inventory_year" IN (2015, 2016, 2017)
                AND PET."evaluation_type" = 'EXPCURR'
                AND C."condition_status_code" = 1  -- Accessible forest land
        ) AS sub
        WHERE sub.area IS NOT NULL
        GROUP BY
            sub."plot_type",
            sub."plot_inventory_year",
            sub."plot_state_code_name"
    ) AS avg_sizes
) AS ranked
WHERE ranked."rn" = 1
ORDER BY "plot_type", "year";
2025-01-23 02:18:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-23 02:18:39 - root - INFO - ```sql
SELECT
    ranked."plot_type",
    ranked."year",
    ranked."state",
    ROUND(ranked."average_size", 4) AS "average_size"
FROM (
    SELECT
        "plot_type",
        "year",
        "state",
        "average_size",
        ROW_NUMBER() OVER (
            PARTITION BY "plot_type", "year"
            ORDER BY "average_size" DESC NULLS LAST
        ) AS "rn"
    FROM (
        SELECT
            sub."plot_type",
            sub."plot_inventory_year" AS "year",
            sub."plot_state_code_name" AS "state",
            AVG(sub.area) AS "average_size"
        FROM (
            SELECT
                P."plot_sequence_number",
                P."plot_inventory_year",
                P."plot_state_code_name",
                CASE
                    WHEN C."proportion_basis" = 'SUBP' THEN 'subplot'
                    WHEN C."proportion_basis" = 'MACR' THEN 'macroplot'
                    ELSE 'unknown'
                END AS "plot_type",
                CASE
                    WHEN C."proportion_basis" = 'SUBP' AND COALESCE(PS."adjustment_factor_for_the_subplot", 0) > 0
                        THEN PS."expansion_factor" * C."condition_proportion_unadjusted" * PS."adjustment_factor_for_the_subplot"
                    WHEN C."proportion_basis" = 'MACR' AND COALESCE(PS."adjustment_factor_for_the_macroplot", 0) > 0
                        THEN PS."expansion_factor" * C."condition_proportion_unadjusted" * PS."adjustment_factor_for_the_macroplot"
                    ELSE NULL
                END AS area
            FROM "USFS_FIA"."USFS_FIA"."PLOT" P
            JOIN "USFS_FIA"."USFS_FIA"."CONDITION" C
                ON P."plot_sequence_number" = C."plot_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM_ASSIGN" PSA
                ON P."plot_sequence_number" = PSA."plot_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_STRATUM" PS
                ON PSA."stratum_sequence_number" = PS."stratum_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_ESTIMATION_UNIT" PEU
                ON PS."estimation_unit_sequence_number" = PEU."estimation_unit_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION" PE
                ON PEU."evaluation_sequence_number" = PE."evaluation_sequence_number"
            JOIN "USFS_FIA"."USFS_FIA"."POPULATION_EVALUATION_TYPE" PET
                ON PE."evaluation_sequence_number" = PET."evaluation_sequence_number"
            WHERE
                P."plot_inventory_year" IN (2015, 2016, 2017)
                AND PET."evaluation_type" = 'EXPCURR'
                AND C."condition_status_code" = 1  -- Accessible forest land
        ) AS sub
        WHERE sub.area IS NOT NULL
        GROUP BY
            sub."plot_type",
            sub."plot_inventory_year",
            sub."plot_state_code_name"
    ) AS avg_sizes
) AS ranked
WHERE ranked."rn" = 1
ORDER BY "plot_type", "year";
```
2025-01-23 02:18:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-23 02:18:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-23 02:18:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-23 02:18:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-23 02:18:41 - snowflake.connector.connection - INFO - closed
2025-01-23 02:18:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-23 02:18:41 - root - INFO - itercount: 4
2025-01-23 02:18:41 - root - INFO - 0
2025-01-23 02:18:41 - root - INFO - Total iteration counts: 4
