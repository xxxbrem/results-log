2025-01-24 04:21:22 - openai._base_client - INFO - Retrying request to /chat/completions in 0.424987 seconds
2025-01-24 04:22:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 04:22:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 04:22:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 04:22:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 04:22:09 - snowflake.connector.connection - INFO - closed
2025-01-24 04:22:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 04:22:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 04:22:33 - root - INFO - The error you're encountering is due to a type mismatch between the `"user_first_touch_timestamp"` column and the value returned by `TO_TIMESTAMP_NTZ('2018-07-02')`. The column `"user_first_touch_timestamp"` is a **NUMBER** representing microseconds since the Unix epoch (January 1, 1970), whereas `TO_TIMESTAMP_NTZ('2018-07-02')` returns a **TIMESTAMP_NTZ** data type. Comparing a NUMBER to a TIMESTAMP_NTZ directly results in a compilation error.

To resolve this issue, you need to convert `"user_first_touch_timestamp"` to a date or timestamp before performing the comparison. Here's the corrected SQL query:

```sql
SELECT DISTINCT "user_pseudo_id", "user_first_touch_timestamp"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
WHERE TO_DATE(TO_TIMESTAMP_NTZ("user_first_touch_timestamp" / 1000000)) >= TO_DATE('2018-07-02')
LIMIT 100;
```

**Explanation:**

- **Conversion of "user_first_touch_timestamp":**
  - Divide `"user_first_touch_timestamp"` by **1,000,000** to convert microseconds to seconds.
  - Use `TO_TIMESTAMP_NTZ` to convert the epoch seconds to a timestamp.
  - Use `TO_DATE` to extract the date from the timestamp for comparison.

- **Comparison:**
  - Convert `'2018-07-02'` to a date using `TO_DATE`.
  - Now both sides of the comparison are of the **DATE** data type.

**Alternative Approach:**

Alternatively, you can convert the date `'2018-07-02'` to epoch time in microseconds and compare it directly with `"user_first_touch_timestamp"`:

```sql
SELECT DISTINCT "user_pseudo_id", "user_first_touch_timestamp"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
WHERE "user_first_touch_timestamp" >= (DATE_PART(EPOCH_SECOND, TO_TIMESTAMP_NTZ('2018-07-02')) * 1000000)
LIMIT 100;
```

**Explanation:**

- **Conversion of Date to Microseconds:**
  - Use `TO_TIMESTAMP_NTZ('2018-07-02')` to get the timestamp.
  - Use `DATE_PART(EPOCH_SECOND, ...)` to get the epoch time in seconds.
  - Multiply by **1,000,000** to convert seconds to microseconds.

By ensuring that both sides of the comparison are of the same data type (either **DATE** or **NUMBER**), the query should execute without errors.

**Recommendation:**

Using the first query is generally more readable and straightforward, as it directly converts the timestamp to a date for comparison.
2025-01-24 04:22:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 04:22:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 04:22:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 04:22:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 32
2025-01-24 04:22:34 - snowflake.connector.connection - INFO - closed
2025-01-24 04:22:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 04:23:55 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 04:23:55 - root - INFO - SQL:
SELECT DISTINCT "user_pseudo_id", "user_first_touch_timestamp"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
WHERE TO_DATE(TO_TIMESTAMP_NTZ("user_first_touch_timestamp" / 1000000)) >= TO_DATE('2018-07-02')
LIMIT 100;
Results:
user_pseudo_id,user_first_touch_timestamp
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
92BF054A90804B6D65F11D7CDFCDDEFC,1530499836284000
D7D49CC32C4A23AD56E8DEAE6878EC7B,1530569048608000
DDAE59D1F0DCF18D15A1BA723158614C,1530573184490000
41F62B68F0D1C05B6F17CFACD42913C5,1530574826826000
0232A0C6A31572DBA6D6CB0F2592ABCE,1530600406887000
3E8023DB1D342304C2D6BD56705C4687,1530575672486000
011068A78F16C35DE89A649B12D640DA,1530493700080000
F470625FCD13350142D1FAB619BEDE53,1530492987920000
B1A46F0467C18F539094677527CB116F,1530518122853000
50D8D0C89D69EDAE2F04E43E90DB59C1,1530535341338000
FFA9AE78B23263835F8AAED57713EBE9,1530544624770000
E2CD12EE286D97AF7174B8AB91391200,1530598381079000
5E2C595CFDF94553EBF5B05F626CB4C8,1530599848170000
2153C36F9ABADBC957F8403899AE4B0B,1530572148244000
4A81FE8E75C780C97EEE73A7574F0B4F,1530591617148000
4C24B12A477BD284ED0304487600B8D2,1530559366404000
60A18C651D23E2866F761919F140EFBD,1530563231267000
AC103055E83E587CED6353022475BC46,1530558762549000
6933934F877244F44E681554B2BE6CED,1530553841845000
E99D4AD5E5663BABE4AC08C027C775EF,1530589432127000
530F22FBF57DF2EB8416BA94E7A43393,1530523835133000
47055E61DA0D1DF28229E1096D48492A,1530586477187000
26E433620D4C61C3082CF472C0528789,1530565816013000
782911F9743463E6A2D8771F0ABDEF7E,1530589347671000
50F9ECC02D5198369DEC190502867F73,1530594957247000
85549E512A7BB6B13BD956D427B86C74,1530595374289000
077BC7302275F4E34731C2780C166C02,1530583008354000
AFE22459EBDA201861C54CDFF294D8F9,1530498271011000
9FEE80E475ED50AAF174B4F17563C16D,1530546373086000
012A1B5594934B98BD38FDD68C560702,1530589144528000
23FE2E728CBE5ECDAE567700B4021340,1530565617533000

2025-01-24 04:23:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 04:23:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 04:23:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 04:23:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 04:23:57 - snowflake.connector.connection - INFO - closed
2025-01-24 04:23:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 04:23:57 - root - INFO - SQL:
-- 1. Count the number of events per user
SELECT "user_pseudo_id", COUNT(*) AS "event_count"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
GROUP BY "user_pseudo_id"
ORDER BY "event_count" DESC
LIMIT 100
Results:
user_pseudo_id,event_count
CC88655DF7CDE5E8225BA20B5D6EC59B,2759
C8685B0DFA2C4B4E6E6EA72894C30F6F,2145
39A0592805168E5D5B3C3687A7472628,2043
0B08423CCD5F1503B5A8B306FFED999C,1244
DDF187DB0391034487C7D3B8C681E0B0,1228
FFA9AE78B23263835F8AAED57713EBE9,1066
10B0D468B5E036E16D13DB53A65F2D49,960
12E5626928FE0885DEEF068683E8BD63,819
AD85E945EC909FEF07A21ECB3EFC0693,774
48AB910A8DE8485D4C34238EA61F782C,745
DF0E6C6C5E4F3F34FEC6EE54FD945B05,720
2F74E23BEA1E45E3897274EE4903DCC5,699
4EF964D59282E5A2C8692D30F011256B,685
CABE7E24215A5C36862658A36AE5CE12,674
B63075B53A750A67A12F7F19ED5AA835,646
E99D4AD5E5663BABE4AC08C027C775EF,593
F5DAD8DD17B689CF672D65A0A81CF4AC,529
47216088A078D06F9220263FAF964F10,516
B37EDF42306464D3D96E5A56A03A8CBA,496
92BF054A90804B6D65F11D7CDFCDDEFC,490
53A5A4C271525BAA74298747E100C376,487
472451071AED6FF801BC0FE66706FD27,485
0D17D0247F158FA3E40D21EFF46D1651,478
00D49153E0790E34D76523EEBEF459B2,478
03A9D32C44665A9E15CFCCEDC9F68EDB,459
E53BC2A0AD86417B443AF14EE3082C0F,450
5E09265F12D64B9FA85FF9427A0A7FB0,439
A9C876F6262995184453B40AB7C5233C,422
C6EAD483A8AF7EE9B0ADE6D7CE5DD698,391
F2A1FD8B142EB4C6CAAE415FA1917F50,385
C6DE585349744A40725DB0AB17041BA3,381
1B3AD9683D475EFB398E131DFE65AE61,355
3DEB0C12C49AD19D7ACE68FA59E7ACD6,354
D0F280B12652EB0D74F6BC74AB13606F,347
BE74418BE7B7466F6FE2969CA79FA919,314
0CAAA1B6F161BA4D363EB7A2DEF64A08,312
187F3053F04D9D7EF93DF21DBDB59684,307
79C6CEA7189615EF5319ED1BA55DDE9D,305
D7D49CC32C4A23AD56E8DEAE6878EC7B,303
9FEE80E475ED50AAF174B4F17563C16D,298
08D399C66188D9A356AFAD5E2B2BA45E,287
A37AD550BCBF8C8B1D5616BB5A47770D,286
3875A92B5F5C2BBA1355CED06A986079,261
487DE902636DD8A9844A2D61FE7BD568,258
E080406D26F71C9B8F331779CE8B82BA,253
C639CACA07D03F536F537ED779CF6599,235
4D33ED6DCCD63BBED146B6060B307CAF,232
EBFE0623EF1109A89B392B9DF4375951,232
E2D6E7FE36B7CDD0789CC8F03CC747E0,225
2F5BBABE9DD0271DCD62E501F76DA736,225
D7EA8E3645EFFBD6443946179ED704A6,220
654F30C1312F6C1A26DFDA9F076A62D8,212
EF500E0CF578004836D1D38C8901862B,211
09FCF0FC0E0F04B3DD8DFE96DA57DDF6,209
CFA0F8C5E25A71062E573EF8E6BC9F76,203
74375465CD17299EBC7C75A1B4047EE0,196
38D4084307B6D1CEA37A48981753428E,195
1213ED1E96B0A49B51C0F7683DB2ACCC,193
42E6A7C3536775E3B8C3DB919AE9A452,189
05FB3382D94C7E963B408FD6CC357D33,187
9DE945166BCD4709696C5836317DDE47,186
5217AB1A454DAED6243E1C9818BE6A20,186
0AF862AFEB5358EBFDA7AFE3AC908844,183
418C1FE4FF01EA36F511E5D9073F11BD,179
193D4BFCCCDED344EE4C2A2809BF685F,178
372D9BB5088C4E9000C65B06459B403A,177
5CC434A43CB09640FC6BE2D7A18183E4,176
091770A1325101155A651F90D283DA35,175
FC48EDE912EDD9F8D7ED45F697EE7193,175
78119035B1798D27E62402E7ADB498BC,172
50D8D0C89D69EDAE2F04E43E90DB59C1,168
8320FC247A1967E7C0CDFC1502241310,167
16B0F6645F896C16F83EF56A99868801,166
898B790ACC7834117A9B2C98A8B6F1F5,162
83D8C7F90DAF2C832F05A9DDD8693135,151
3D03A380687FE3369E93915D50C572CB,150
B9BC9A430E79917967EFBEF5B1915199,146
19DEEA6B15B314DB0ED2A4936959D8F9,146
64BA3BB3BD757CE7000D38CB7125E6DA,142
31D7BB4CF721D8676B85F73077F4304E,142
2304B486B11E4CFFA0BB8AC8F2F5F4B6,141
1F0D27B8A7E058446D4A6409E2E73B19,141
FE46EFC1DA3F3159AD9343EC53466F3F,141
2B7787A34C362AA51FF8E4DD031A2F70,140
018F03084C88E944163F76A0D0C2FBA1,138
BBDAFE02F8160B43C105F79EFFD0DF7F,138
FA30269453141794E79B8F15EE0BA5B9,137
D4F4DAEF5BE38E5C67FD72BB1F082EBF,131
B1A46F0467C18F539094677527CB116F,129
EECDCA8076D5842922767F5C08957B17,127
A87A30159D909E2356F72AAC76F26707,124
1D7DE8A95370FDCB698B25F1E424C91D,120
A0616D4E494DC3BCCB94B8B6E5B48380,120
62D571096D5393BFB10F2D55DA2FC28C,117
7AE4084BAA29B1987E51BF2964646805,117
CA04708DA02378999ECB402481FF1AE4,110
C089DEEB2EA27CF072D17A89C956AFF3,110
D4C8E3E0EFC45C3D60AB3F0F305489AF,109
5E694DE02688C2FDDEA38A6946A4CC3F,108
6EDA0BB1611F7E5AB409221AE13ED52E,107

2025-01-24 04:23:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 04:23:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 04:23:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 04:23:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 32
2025-01-24 04:23:59 - snowflake.connector.connection - INFO - closed
2025-01-24 04:23:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 04:23:59 - root - INFO - SQL:
-- 2. Get the event names and their occurrence counts
SELECT "event_name", COUNT(*) AS "occurrences"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
GROUP BY "event_name"
ORDER BY "occurrences" DESC
LIMIT 100
Results:
event_name,occurrences
screen_view,20378
user_engagement,11605
level_start_quickplay,4493
level_end_quickplay,3068
post_score,2144
level_complete_quickplay,1896
level_fail_quickplay,1173
select_content,942
level_reset_quickplay,916
session_start,621
level_start,560
level_end,396
level_retry_quickplay,387
level_retry,357
level_up,248
level_complete,229
level_fail,148
spend_virtual_currency,85
level_reset,72
use_extra_steps,55
app_exception,54
firebase_campaign,38
first_open,27
no_more_extra_steps,22
os_update,19
ad_reward,18
error,15
app_remove,13
completed_5_levels,11
app_update,8
app_clear_data,1
challenge_a_friend,1

2025-01-24 04:23:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 04:23:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 04:23:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 04:24:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 04:24:00 - snowflake.connector.connection - INFO - closed
2025-01-24 04:24:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 04:24:01 - root - INFO - SQL:
-- 3. Extract user properties
SELECT f.value
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 t,
     LATERAL FLATTEN(input => t."user_properties") f
LIMIT 100
Results:
Too long, hard cut:
VALUE
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482378805491000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1477369230231000,
    ""string_value"": ""3""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1476908488411000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1530589570174000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1494813899942000,
    ""string_value"": ""4857993083614758445""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1530589572284000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1476917467314000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1530589572283000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1476908354977000,
    ""set_timestamp_micros"": 1476908266977000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482378833491000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1477369258231000,
    ""string_value"": ""3""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1476908516411000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1530592265519000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1494813927942000,
    ""string_value"": ""4857993083614758445""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1530589600284000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1476917495314000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1530589600283000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1476908354977000,
    ""set_timestamp_micros"": 1476908294977000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482378862491000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1477369287231000,
    ""string_value"": ""3""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1476908545411000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1530592294519000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1494813956942000,
    ""string_value"": ""4857993083614758445""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1530589629284000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1476917524314000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1530589629283000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1476908354977000,
    ""set_timestamp_micros"": 1476908323977000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482378809491000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1477369234231000,
    ""string_value"": ""3""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1476908492411000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1530589574174000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1494813903942000,
    ""string_value"": ""4857993083614758445""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1530589576284000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1476917471314000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1530589576283000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1476908354977000,
    ""set_timestamp_micros"": 1476908270977000
  }
}"
"{
  "

2025-01-24 04:24:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 04:24:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 04:24:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 04:24:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-24 04:24:02 - snowflake.connector.connection - INFO - closed
2025-01-24 04:24:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 04:24:02 - root - INFO - SQL:
-- 4. Show distinct platforms used by users
SELECT DISTINCT "platform"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
LIMIT 100
Results:
platform
ANDROID
IOS

2025-01-24 04:24:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 04:24:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 04:24:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 04:24:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 04:24:04 - snowflake.connector.connection - INFO - closed
2025-01-24 04:24:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 04:24:04 - root - INFO - SQL:
-- 5. Find users who performed 'user_engagement' event
SELECT DISTINCT "user_pseudo_id"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
WHERE "event_name" = 'user_engagement'
LIMIT 100
Results:
user_pseudo_id
654F30C1312F6C1A26DFDA9F076A62D8
65D7715C409E6A38667447CE2B52AFFE
B205B117C82A24AA95E663FFB7D04718
EF9E8CCCCBBB015CAE0C334AB1745417
83D8C7F90DAF2C832F05A9DDD8693135
093642BD46204EB5F950303CE696BC18
0F67E233B19D2898229CD156974A93AE
5217AB1A454DAED6243E1C9818BE6A20
C6EAD483A8AF7EE9B0ADE6D7CE5DD698
38D4084307B6D1CEA37A48981753428E
0373DF7959F6867CDFB1C905D39CE67C
5D5895B1267014C54ECBE08864420979
D34924C19421D7E083FD387D97765F94
C136A7CE1D0A52B8D4E5F144DF114EB7
49309C5759610DBF6C829C0D4AB23943
4BF98D09CA8359FC59ADAF56D00338F8
08D399C66188D9A356AFAD5E2B2BA45E
92B0B6F48ECE132C7E502F94798FE205
3A58859E074B02E8FB1CAEA291636112
706C748E6D1E0768BFEFE6362B5D3F67
D0F280B12652EB0D74F6BC74AB13606F
3EF8FC940E379D53BBD3FEFDAF626BB2
E2D6E7FE36B7CDD0789CC8F03CC747E0
50FEAE9ECFE22E951E8810622A2E8F66
7101B4232F5B26A9C987C54F8717DCDC
4948BEDE78FC6EBA9899F26BF5C53897
7842C62D45ECE888132F21C9F4417B21
672B24B51143CC66DCBAA0FA88C38D57
7AE4084BAA29B1987E51BF2964646805
DE4912FBC5F915C027000A8A6FF44F85
88A41BFED275BB69125BE1F5524F3B42
A87A30159D909E2356F72AAC76F26707
29845B6298FB882DF53607D21F0E1DF7
4BDC831A6940071E2461D0B5293A329E
037DAC225F0C1E54657770CD201CDDA7
E50F7AC0680FD87AD6CE6B6700D209A7
D7EA8E3645EFFBD6443946179ED704A6
59454BAC415BB1F18517C6FD2C023E49
60CFF65B640769B6FD3BC9593EDF7C1D
CA04708DA02378999ECB402481FF1AE4
C87CDC0C4F86B10B7467281D516929B5
EA9A16D9042286D55399A418CC7A28F3
8040FC9C0479C3B9A74ED298DD8F357D
D7D49CC32C4A23AD56E8DEAE6878EC7B
CE7404D5A8831F2DE46BD0A013A8ED64
332FF17A7140DA319A07A72CA1CB6A5A
98742B903F6249E1C5D72DED34CCAE13
0AAA02628D6A75EEC75D37DA84D04426
011068A78F16C35DE89A649B12D640DA
7BABAD7F0F40294269AD80C0232C2814
B1A46F0467C18F539094677527CB116F
004D2DFEB866BFB00427DB2F530C1F3D
58230465C695B0FDDDAE08A481FAEECC
3031EAD1E9D35306A37A0F3DC3B84A0A
05407E04B9FA64CB63D8FA1D966AD6A2
5CDFC86835249BE3DB5E9F6778E344AD
F815B0069F973BFA743EF90A85224109
4D084D38156128AAA060303AA91E689D
E6FEE8B98E75EA5311FE004F98559A27
48AB910A8DE8485D4C34238EA61F782C
2F5B044B41268F6643EB4D0EF15D4E87
E8710E77072D6674A93E46DFEF725587
A064A84CD3CF7058F39333D6212E8615
2F8E2DBB938D2E43C2D171AF5F35EEF8
4A47422A455E62E3529DE4F9F3BFAF66
3DEB0C12C49AD19D7ACE68FA59E7ACD6
AE920B86560554C0BE3F888EDBA2BBF7
64BA3BB3BD757CE7000D38CB7125E6DA
7D613AF4DA0F508C7090E96FD73B7E6D
C795AFA7F574C2BB09D3647AD90A9719
E451D416F972019604F1456533FF3858
AFE7A3E11C66E71FA9EA7B138700EC44
5E694DE02688C2FDDEA38A6946A4CC3F
B75F91EB6C7FDA9A329567E763CF9E44
D739D483CCD20D4651E4A75ADEE94064
53866E32BA0ABFD846772D4B7B9B5921
8EDB9A9856CDB5AFC42546106EE46734
3EDE8E7A50DE76AA2EC12DDD2AE3F9F4
84D135997D8A4D9CB35D4ECA46EF6861
EBFE0623EF1109A89B392B9DF4375951
664F913ED3B54941B5F0886D94E01623
028CAE01A9F16A228177C973451441A1
4CE503AE5B4C4F67A00474CE380CCC39
3D03A380687FE3369E93915D50C572CB
117AD1627465CC9E03AB5D8825D42E07
8320FC247A1967E7C0CDFC1502241310
7480AE90D76538F44A066A153F448198
2F5BBABE9DD0271DCD62E501F76DA736
D3F06F9B7BD9D7FC8758BF78BF0705E9
97E7144B7FA861C3C8DB7424D7039832
DD695F4DCB9694F4E026B78E17BD7945
41F62B68F0D1C05B6F17CFACD42913C5
C3D7BA97E184ABF0A446F35DE12BACF9
B75FCD833DE643B45B326D2E7AC413E4
932AAF56DDE9C55359B9CCFA18E7FB95
E512079B53179DF9A608CF4ADE47DE9D
C09F04828B07E4DFEF39DA5C4A976A90
0232A0C6A31572DBA6D6CB0F2592ABCE
A9C876F6262995184453B40AB7C5233C
19DEEA6B15B314DB0ED2A4936959D8F9

2025-01-24 04:24:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 04:24:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 04:24:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 04:24:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 04:24:05 - snowflake.connector.connection - INFO - closed
2025-01-24 04:24:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 04:24:06 - root - INFO - SQL:
-- 6. List users by their first touch date
SELECT DISTINCT "user_pseudo_id",
       DATE(TO_TIMESTAMP_NTZ("user_first_touch_timestamp" / 1000000)) AS "first_touch_date"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
LIMIT 100
Results:
user_pseudo_id,first_touch_date
654F30C1312F6C1A26DFDA9F076A62D8,2016-10-19
65D7715C409E6A38667447CE2B52AFFE,2018-06-14
B205B117C82A24AA95E663FFB7D04718,2016-07-21
EF9E8CCCCBBB015CAE0C334AB1745417,2018-06-19
83D8C7F90DAF2C832F05A9DDD8693135,2018-06-24
093642BD46204EB5F950303CE696BC18,2018-06-30
0F67E233B19D2898229CD156974A93AE,2016-09-15
5217AB1A454DAED6243E1C9818BE6A20,2018-06-24
C6EAD483A8AF7EE9B0ADE6D7CE5DD698,2018-07-01
58230465C695B0FDDDAE08A481FAEECC,2016-11-07
38D4084307B6D1CEA37A48981753428E,2016-08-14
0373DF7959F6867CDFB1C905D39CE67C,2018-06-21
D34924C19421D7E083FD387D97765F94,2017-11-18
C136A7CE1D0A52B8D4E5F144DF114EB7,2016-06-15
92B0B6F48ECE132C7E502F94798FE205,2016-11-29
4BF98D09CA8359FC59ADAF56D00338F8,2018-05-12
909A16079F7183140ACF4C71A6CCDF3D,2017-07-06
3031EAD1E9D35306A37A0F3DC3B84A0A,2017-01-23
5CDFC86835249BE3DB5E9F6778E344AD,2017-02-27
F815B0069F973BFA743EF90A85224109,2016-09-03
D0F280B12652EB0D74F6BC74AB13606F,2018-06-18
4D084D38156128AAA060303AA91E689D,2018-01-14
3EF8FC940E379D53BBD3FEFDAF626BB2,2018-06-07
DE4912FBC5F915C027000A8A6FF44F85,2018-06-08
48AB910A8DE8485D4C34238EA61F782C,2017-10-04
E8710E77072D6674A93E46DFEF725587,2018-05-17
4948BEDE78FC6EBA9899F26BF5C53897,2018-01-05
A064A84CD3CF7058F39333D6212E8615,2017-07-24
7842C62D45ECE888132F21C9F4417B21,2018-01-06
7AE4084BAA29B1987E51BF2964646805,2018-06-29
7101B4232F5B26A9C987C54F8717DCDC,2018-04-02
29845B6298FB882DF53607D21F0E1DF7,2018-05-15
76BB576278338D2E508DE5D705241B47,2016-07-17
4BDC831A6940071E2461D0B5293A329E,2017-03-03
B7701369F8598A25DED0499DAD3BE85D,2017-09-29
A74EFE8BDAC26101B308D57A18B746CF,2018-05-23
AE920B86560554C0BE3F888EDBA2BBF7,2017-02-21
037DAC225F0C1E54657770CD201CDDA7,2017-04-28
E50F7AC0680FD87AD6CE6B6700D209A7,2018-06-19
7D613AF4DA0F508C7090E96FD73B7E6D,2016-06-03
FEDC59699D8832A11B88BFCCCAD0951D,2017-05-16
E451D416F972019604F1456533FF3858,2018-07-01
5E694DE02688C2FDDEA38A6946A4CC3F,2018-03-11
B75F91EB6C7FDA9A329567E763CF9E44,2018-05-21
53866E32BA0ABFD846772D4B7B9B5921,2018-06-20
7480AE90D76538F44A066A153F448198,2018-05-01
8EDB9A9856CDB5AFC42546106EE46734,2017-01-17
60FAC27D8495BF33C2AE5283A7B07005,2018-05-13
EBFE0623EF1109A89B392B9DF4375951,2016-05-29
D7D49CC32C4A23AD56E8DEAE6878EC7B,2018-07-02
8320FC247A1967E7C0CDFC1502241310,2017-06-05
D739D483CCD20D4651E4A75ADEE94064,2018-07-01
3D03A380687FE3369E93915D50C572CB,2017-08-10
5D5895B1267014C54ECBE08864420979,2018-02-22
08D399C66188D9A356AFAD5E2B2BA45E,2018-06-18
49309C5759610DBF6C829C0D4AB23943,2016-08-24
3A58859E074B02E8FB1CAEA291636112,2016-12-02
706C748E6D1E0768BFEFE6362B5D3F67,2016-09-29
E6FEE8B98E75EA5311FE004F98559A27,2018-03-25
50FEAE9ECFE22E951E8810622A2E8F66,2018-05-29
A87A30159D909E2356F72AAC76F26707,2018-06-27
05407E04B9FA64CB63D8FA1D966AD6A2,2016-06-19
88A41BFED275BB69125BE1F5524F3B42,2017-09-07
2F8E2DBB938D2E43C2D171AF5F35EEF8,2018-06-29
92BF054A90804B6D65F11D7CDFCDDEFC,2018-07-02
7207044281C74501C14233463AAD9A71,2018-06-19
3DEB0C12C49AD19D7ACE68FA59E7ACD6,2017-06-20
920DB84FCC0F4421650B9E257E33180B,2018-06-09
64BA3BB3BD757CE7000D38CB7125E6DA,2018-05-22
C795AFA7F574C2BB09D3647AD90A9719,2017-04-06
936906C2CB90CE437DBFC01BBD96BA39,2016-05-29
59454BAC415BB1F18517C6FD2C023E49,2018-01-08
60CFF65B640769B6FD3BC9593EDF7C1D,2016-06-13
AFE7A3E11C66E71FA9EA7B138700EC44,2018-05-23
3EDE8E7A50DE76AA2EC12DDD2AE3F9F4,2018-05-01
257A35EA0A92B4B2F8FB4BA3F8B4C3D8,2017-03-11
84D135997D8A4D9CB35D4ECA46EF6861,2018-06-23
11A8D6037368A4C4508B11ADB4353BC4,2018-03-13
CA04708DA02378999ECB402481FF1AE4,2016-06-12
664F913ED3B54941B5F0886D94E01623,2017-11-04
C87CDC0C4F86B10B7467281D516929B5,2017-12-23
2F5BBABE9DD0271DCD62E501F76DA736,2018-06-29
4CE503AE5B4C4F67A00474CE380CCC39,2016-07-07
EA9A16D9042286D55399A418CC7A28F3,2018-04-24
8040FC9C0479C3B9A74ED298DD8F357D,2016-10-18
DD695F4DCB9694F4E026B78E17BD7945,2018-04-27
4DA8863CD8D2C860F6BB73579BC6F5C9,2018-01-29
117AD1627465CC9E03AB5D8825D42E07,2017-12-19
2304B486B11E4CFFA0BB8AC8F2F5F4B6,2017-06-04
CE7404D5A8831F2DE46BD0A013A8ED64,2016-10-10
4A47422A455E62E3529DE4F9F3BFAF66,2018-06-13
2F5B044B41268F6643EB4D0EF15D4E87,2018-06-30
E2D6E7FE36B7CDD0789CC8F03CC747E0,2018-07-03
672B24B51143CC66DCBAA0FA88C38D57,2018-03-10
D7EA8E3645EFFBD6443946179ED704A6,2017-01-20
27859DA5E38F4C681DA4FBF0CFB9F306,2018-06-25
028CAE01A9F16A228177C973451441A1,2018-06-24
D3F06F9B7BD9D7FC8758BF78BF0705E9,2016-12-03
01562149DD13E75D732F0A9CA2D8CF5C,2018-06-26
97E7144B7FA861C3C8DB7424D7039832,2017-06-30

2025-01-24 04:24:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 04:24:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 04:24:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 04:24:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 04:24:07 - snowflake.connector.connection - INFO - closed
2025-01-24 04:24:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 04:24:07 - root - INFO - SQL:
-- 7. Extract event parameters
SELECT f.value
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 t,
     LATERAL FLATTEN(input => t."event_params") f
LIMIT 100
Results:
Too long, hard cut:
VALUE
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8126232848982224228
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8126232848982224228
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490845
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FloodItActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490838
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490838
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""FloodItActivity""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""ExtraStepsActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490799
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490799
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""shop_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490798
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""ExtraStepsActivity""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490798
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""shop_menu""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""GameFinishedActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490785
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490785
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_over""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"

2025-01-24 04:24:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 04:24:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 04:24:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 04:24:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 04:24:09 - snowflake.connector.connection - INFO - closed
2025-01-24 04:24:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 04:24:09 - root - INFO - SQL:
-- 8. List users along with their geographic information
SELECT t."user_pseudo_id", t."geo"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 t
LIMIT 100
Results:
Too long, hard cut:
user_pseudo_id,geo
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
 

2025-01-24 04:24:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 04:24:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 04:24:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 04:24:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 56
2025-01-24 04:24:11 - snowflake.connector.connection - INFO - closed
2025-01-24 04:24:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 04:24:11 - root - INFO - SQL:
-- 9. Count the number of users per 'platform' and 'event_name'
SELECT "platform", "event_name", COUNT(DISTINCT "user_pseudo_id") AS "user_count"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
GROUP BY "platform", "event_name"
ORDER BY "user_count" DESC
LIMIT 100
Results:
platform,event_name,user_count
ANDROID,user_engagement,271
ANDROID,screen_view,263
ANDROID,session_start,248
ANDROID,select_content,237
ANDROID,level_start_quickplay,204
ANDROID,post_score,194
ANDROID,level_end_quickplay,176
IOS,screen_view,165
IOS,user_engagement,163
IOS,session_start,160
ANDROID,level_complete_quickplay,156
IOS,level_start_quickplay,155
IOS,select_content,150
IOS,level_end_quickplay,118
IOS,post_score,106
IOS,level_complete_quickplay,102
ANDROID,level_fail_quickplay,88
IOS,level_fail_quickplay,74
ANDROID,level_retry_quickplay,64
ANDROID,level_start,58
ANDROID,level_end,51
ANDROID,level_retry,48
ANDROID,level_complete,42
ANDROID,level_up,42
ANDROID,level_reset_quickplay,42
ANDROID,level_fail,30
IOS,level_reset_quickplay,25
ANDROID,spend_virtual_currency,20
ANDROID,app_exception,20
ANDROID,first_open,19
ANDROID,firebase_campaign,19
ANDROID,level_reset,19
ANDROID,use_extra_steps,18
IOS,level_retry_quickplay,17
ANDROID,app_remove,13
ANDROID,completed_5_levels,11
ANDROID,no_more_extra_steps,11
IOS,os_update,11
IOS,level_start,10
ANDROID,ad_reward,9
IOS,first_open,8
IOS,level_end,8
IOS,app_update,8
ANDROID,os_update,8
IOS,spend_virtual_currency,6
IOS,level_up,5
IOS,level_fail,5
IOS,app_exception,4
IOS,error,3
IOS,no_more_extra_steps,3
IOS,level_retry,3
IOS,level_reset,2
IOS,use_extra_steps,1
ANDROID,challenge_a_friend,1
ANDROID,app_clear_data,1
IOS,level_complete,1

2025-01-24 04:24:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 04:24:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 04:24:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 04:24:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 32
2025-01-24 04:24:12 - snowflake.connector.connection - INFO - closed
2025-01-24 04:24:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 04:24:13 - root - INFO - SQL:
-- 10. Identify users who first used the app in the week starting July 2, 2018
SELECT DISTINCT "user_pseudo_id"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
WHERE DATE_TRUNC('week', TO_DATE(TO_TIMESTAMP_NTZ("user_first_touch_timestamp" / 1000000))) = TO_DATE('2018-07-02')
LIMIT 100
Results:
user_pseudo_id
E2D6E7FE36B7CDD0789CC8F03CC747E0
92BF054A90804B6D65F11D7CDFCDDEFC
D7D49CC32C4A23AD56E8DEAE6878EC7B
DDAE59D1F0DCF18D15A1BA723158614C
41F62B68F0D1C05B6F17CFACD42913C5
0232A0C6A31572DBA6D6CB0F2592ABCE
011068A78F16C35DE89A649B12D640DA
F470625FCD13350142D1FAB619BEDE53
50D8D0C89D69EDAE2F04E43E90DB59C1
B1A46F0467C18F539094677527CB116F
FFA9AE78B23263835F8AAED57713EBE9
077BC7302275F4E34731C2780C166C02
E2CD12EE286D97AF7174B8AB91391200
5E2C595CFDF94553EBF5B05F626CB4C8
2153C36F9ABADBC957F8403899AE4B0B
4A81FE8E75C780C97EEE73A7574F0B4F
4C24B12A477BD284ED0304487600B8D2
AFE22459EBDA201861C54CDFF294D8F9
6933934F877244F44E681554B2BE6CED
E99D4AD5E5663BABE4AC08C027C775EF
9FEE80E475ED50AAF174B4F17563C16D
23FE2E728CBE5ECDAE567700B4021340
530F22FBF57DF2EB8416BA94E7A43393
012A1B5594934B98BD38FDD68C560702
47055E61DA0D1DF28229E1096D48492A
26E433620D4C61C3082CF472C0528789
782911F9743463E6A2D8771F0ABDEF7E
50F9ECC02D5198369DEC190502867F73
3E8023DB1D342304C2D6BD56705C4687
85549E512A7BB6B13BD956D427B86C74
AC103055E83E587CED6353022475BC46
60A18C651D23E2866F761919F140EFBD

2025-01-24 04:24:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 04:24:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 04:24:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 04:24:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 04:24:14 - snowflake.connector.connection - INFO - closed
2025-01-24 04:24:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 04:24:14 - root - INFO - SQL:
-- 11. List the most common devices used by users
SELECT t."user_pseudo_id", t."device"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 t
LIMIT 100
Results:
Too long, hard cut:
user_pseudo_id,device
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo da

2025-01-24 04:24:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 04:24:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 04:24:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 04:24:16 - snowflake.connector.connection - INFO - closed
2025-01-24 04:24:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 04:24:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 04:24:39 - root - INFO - The error you're encountering is due to attempting to cast a JSON object directly to a `FLOAT`. Specifically, the expression `ep.value:"value"::FLOAT` is trying to cast a VARIANT type that contains a nested JSON object (like `{"int_value":3771}`) directly to a `FLOAT`, which is not allowed.

To fix this, you need to extract the numeric value from the nested JSON by accessing the `"int_value"` or `"double_value"` fields within `"value"` before casting it to `FLOAT`.

Here's the corrected SQL query:

```sql
SELECT
    t."event_name",
    (
        CASE
            WHEN ep.value:"value":"int_value" IS NOT NULL THEN ep.value:"value":"int_value"::FLOAT
            WHEN ep.value:"value":"double_value" IS NOT NULL THEN ep.value:"value":"double_value"::FLOAT
            ELSE NULL
        END
    ) AS "duration"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 t,
     LATERAL FLATTEN(input => t."event_params") ep
WHERE ep.value:"key"::STRING = 'engagement_time_msec'
ORDER BY "duration" DESC
LIMIT 100;
```

**Explanation:**

- **Accessing Nested Values:**
  - `ep.value:"value":"int_value"` accesses the `"int_value"` field inside the `"value"` object.
  - Similarly, `ep.value:"value":"double_value"` accesses the `"double_value"` field if it exists.
- **Handling Different Numeric Types:**
  - The `CASE` statement checks whether `"int_value"` or `"double_value"` is present and uses the available one.
  - This accounts for cases where the numeric value could be stored as an integer or a double.
- **Casting to FLOAT:**
  - Once the numeric value is extracted, we cast it to `FLOAT` using `::FLOAT`.

**Alternate Simplification Using `COALESCE`:**

You can also simplify the `CASE` statement using the `COALESCE` function:

```sql
SELECT
    t."event_name",
    COALESCE(
        ep.value:"value":"int_value"::FLOAT,
        ep.value:"value":"double_value"::FLOAT
    ) AS "duration"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 t,
     LATERAL FLATTEN(input => t."event_params") ep
WHERE ep.value:"key"::STRING = 'engagement_time_msec'
ORDER BY "duration" DESC
LIMIT 100;
```

**Explanation:**

- `COALESCE` returns the first non-NULL value in the list.
- This attempts to get the `"int_value"` first; if it's `NULL`, it then tries `"double_value"`.

**Result Interpretation:**

Running the corrected query should provide you with the top events that have the longest engagement durations. The `"duration"` field will represent the `engagement_time_msec` for each event.

**Sample Result:**

```csv
event_name,duration
"user_engagement", 3771
"user_engagement", 3600
"user_engagement", 3599
"user_engagement", 3500
"user_engagement", 3400
"user_engagement", 3300
"user_engagement", 3200
"user_engagement", 3100
"user_engagement", 3000
"user_engagement", 2900
...
```

*(Attention: The actual durations and event names may vary based on the data)*

**Additional Notes:**

- Ensure that the `"event_params"` column actually contains the `engagement_time_msec` key for the events you're analyzing.
- The `LIMIT 100` will return up to 100 records; adjust as needed for your analysis.

By making these adjustments, your query should execute successfully without casting errors, and you'll be able to identify the events with the longest engagement durations.
2025-01-24 04:24:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 04:24:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 04:24:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 04:24:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 04:24:41 - snowflake.connector.connection - INFO - closed
2025-01-24 04:24:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 04:25:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 04:25:29 - root - INFO - SQL:
SELECT
    t."event_name",
    (
        CASE
            WHEN ep.value:"value":"int_value" IS NOT NULL THEN ep.value:"value":"int_value"::FLOAT
            WHEN ep.value:"value":"double_value" IS NOT NULL THEN ep.value:"value":"double_value"::FLOAT
            ELSE NULL
        END
    ) AS "duration"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 t,
     LATERAL FLATTEN(input => t."event_params") ep
WHERE ep.value:"key"::STRING = 'engagement_time_msec'
ORDER BY "duration" DESC
LIMIT 100;
Results:
event_name,duration
user_engagement,3598367.0
user_engagement,3598360.0
user_engagement,3598358.0
user_engagement,3598356.0
user_engagement,3598352.0
user_engagement,3598343.0
user_engagement,3598276.0
user_engagement,3598268.0
user_engagement,3598261.0
user_engagement,3598260.0
user_engagement,3598258.0
user_engagement,3598253.0
user_engagement,3598218.0
user_engagement,3598217.0
user_engagement,3598207.0
user_engagement,3598204.0
user_engagement,3598203.0
user_engagement,3598194.0
user_engagement,3598168.0
user_engagement,3598160.0
user_engagement,3598157.0
user_engagement,3598148.0
user_engagement,3598142.0
user_engagement,3598134.0
user_engagement,830650.0
user_engagement,715537.0
user_engagement,702985.0
user_engagement,659514.0
user_engagement,645601.0
user_engagement,644579.0
user_engagement,600447.0
user_engagement,582006.0
user_engagement,572865.0
user_engagement,526544.0
user_engagement,507752.0
user_engagement,507169.0
user_engagement,496624.0
user_engagement,475485.0
user_engagement,470826.0
user_engagement,443244.0
user_engagement,430251.0
user_engagement,429162.0
user_engagement,419741.0
user_engagement,415302.0
user_engagement,412092.0
user_engagement,384064.0
user_engagement,378352.0
user_engagement,374681.0
user_engagement,374323.0
user_engagement,366151.0
user_engagement,351504.0
user_engagement,344973.0
user_engagement,338869.0
user_engagement,329348.0
user_engagement,328278.0
user_engagement,326226.0
user_engagement,324175.0
user_engagement,323975.0
user_engagement,321768.0
user_engagement,313191.0
user_engagement,310760.0
user_engagement,307100.0
user_engagement,300422.0
user_engagement,291955.0
user_engagement,289861.0
user_engagement,282940.0
user_engagement,282844.0
user_engagement,273924.0
user_engagement,273049.0
user_engagement,272231.0
user_engagement,262634.0
user_engagement,260084.0
user_engagement,257221.0
user_engagement,256929.0
user_engagement,253804.0
user_engagement,248646.0
user_engagement,247732.0
user_engagement,246044.0
user_engagement,243176.0
user_engagement,241349.0
user_engagement,241149.0
user_engagement,240836.0
user_engagement,239362.0
user_engagement,236552.0
user_engagement,236314.0
user_engagement,236022.0
user_engagement,233375.0
user_engagement,231908.0
user_engagement,231636.0
user_engagement,230535.0
user_engagement,230093.0
user_engagement,226106.0
user_engagement,224804.0
user_engagement,223691.0
user_engagement,223383.0
user_engagement,223284.0
user_engagement,221503.0
user_engagement,220943.0
user_engagement,219141.0
user_engagement,218903.0

2025-01-24 04:25:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 04:25:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 04:25:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 04:25:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 24
2025-01-24 04:25:31 - snowflake.connector.connection - INFO - closed
2025-01-24 04:25:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 04:25:31 - root - INFO - SQL:
-- 13. Get the number of events per hour (Corrected if necessary)
SELECT
    DATE_TRUNC('hour', TO_TIMESTAMP_NTZ("event_timestamp" / 1e6)) AS "event_hour",
    COUNT(*) AS "event_count"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
GROUP BY "event_hour"
ORDER BY "event_hour"
LIMIT 100
Results:
event_hour,event_count
2018-07-02 07:00:00,790
2018-07-02 08:00:00,626
2018-07-02 09:00:00,2452
2018-07-02 10:00:00,1260
2018-07-02 11:00:00,1089
2018-07-02 12:00:00,1294
2018-07-02 13:00:00,1990
2018-07-02 14:00:00,1990
2018-07-02 15:00:00,2249
2018-07-02 16:00:00,3124
2018-07-02 17:00:00,1851
2018-07-02 18:00:00,1671
2018-07-02 19:00:00,2496
2018-07-02 20:00:00,2335
2018-07-02 21:00:00,3286
2018-07-02 22:00:00,3189
2018-07-02 23:00:00,3279
2018-07-03 00:00:00,4336
2018-07-03 01:00:00,2874
2018-07-03 02:00:00,2541
2018-07-03 03:00:00,1722
2018-07-03 04:00:00,1869
2018-07-03 05:00:00,1005
2018-07-03 06:00:00,682

2025-01-24 04:25:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 04:25:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 04:25:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 04:25:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 04:25:32 - snowflake.connector.connection - INFO - closed
2025-01-24 04:25:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 04:25:33 - root - INFO - SQL:
-- 14. Extract user demographic information (Corrected)
SELECT
    t."user_pseudo_id",
    up.value:"key"::STRING AS "property_key",
    COALESCE(
        up.value:"value":"string_value"::STRING,
        TO_VARCHAR(up.value:"value":"int_value"),
        TO_VARCHAR(up.value:"value":"double_value")
    ) AS "property_value"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 t,
     LATERAL FLATTEN(input => t."user_properties") up
LIMIT 100
Results:
Too long, hard cut:
user_pseudo_id,property_key,property_value
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26D

2025-01-24 04:25:33 - root - INFO - itercount: 0
2025-01-24 04:25:33 - root - INFO - Database Name: FIREBASE
Schema Name: ANALYTICS_153293282
DDL describes table information.
,0
table_name,EVENTS_20180613
description,
DDL,"create or replace TABLE EVENTS_20180613 (
	""event_date"" VARCHAR(16777216),
	""event_timestamp"" NUMBER(38,0),
	""event_name"" VARCHAR(16777216),
	""event_params"" VARIANT,
	""event_previous_timestamp"" NUMBER(38,0),
	""user_id"" VARCHAR(16777216),
	""user_pseudo_id"" VARCHAR(16777216),
	""user_properties"" VARIANT,
	""user_first_touch_timestamp"" NUMBER(38,0),
	""user_ltv"" VARIANT,
	""device"" VARIANT,
	""geo"" VARIANT,
	""app_info"" VARIANT,
	""traffic_source"" VARIANT,
	""stream_id"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']
External knowledge that might be helpful: 
How to Calculate User Retention in Big Query from Google Demo Game Analytics Data

As a Product / Website Analyst, I was pretty psyched to discover Google’s public Google Analytics 4 (GA4) gaming event dataset called `firebase-public-project.analytics_153293282.events_*`. The table allows experienced developers and learners alike to experiment with raw GA4 data in Big Query for free. Event data is basically a log of user interactions with your product for analysis .For newbies interested in learning more about event data and GA4, visit my prior blog. This article provides SQL queries for a quick table overview and explains how to utilize Google Big Query to calculate user retention.


What is Retention?
User retention rates are key indicators for whether your product team meets user needs. Improving retention is often central to long term growth strategies.

**Retention measure’s how often and for how long users tend to return to your product.**

The metric can be a powerful proxy for product usefulness and user opinion. Its analysis can reveal critical information like how well your site converts new visitors to users and which items and features are associated with users coming back. If user data is available, retention can also help a business understand the profiles of its most active users (power users). Finally, retention is a great guardrail metric for A/B tests. Successful, product oriented companies prioritize a healthy user bases over short term profits.


**Common Retention Calculation Strategies**

Two common strategies to calculate retention are: 

a) N-Day retention

b) Unbounded Retention.


a) For N-Day retention, analysts calculate how many users with certain characteristics return over successive periods. It is called N days because we define the length of each period. For example, with N=7 day retention, if User A becomes part of our cohort of interest on day 0 and returns to the product day 5 and day 15, they are counted as retained for week 1 (1–7 days) and week 3 (15–21 days) but not week 2 (8–14 days).


b) For Unbounded Retention, a user is counted as retained each week so long as their most recent product contact was after the week. For example, if User A becomes part of the cohort on day 0 and last returned to the site on day 21, they will be counted as retained in week 1 (1–7 days), week 2 (8–14 days), and week 3 (15–21 days) but not week 4 (22–28 days).

By calculating these metrics, companies can evaluate how well their products hold users’ interests. It also them closer to identifying the patterns that generate return users.



The table structure information is ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}
Begin Exploring Related Columns
**Columns and Potential Usage:**

- **"event_date"**: Date of the event; useful for filtering events by date.
- **"event_timestamp"**: Timestamp of the event; can help order events chronologically.
- **"user_pseudo_id"**: Unique identifier for users; used to group and count users.
- **"user_first_touch_timestamp"**: Timestamp when the user first used the app; essential for determining the week of first use.
- **"event_name"**: Name of the event; can be used to identify active usage events.
- **"event_params"**: Contains event parameters in JSON format; may hold additional details about events.
- **"user_properties"**: Contains user properties in JSON format; may include user attributes.
- **"platform"**: Platform information; useful if filtering by device type.
- **"geo"**: Geographic information in JSON format; could be used for location-based analysis.

**Conditions that May Be Used:**

- Filtering events starting from **'2018-07-02'**.
- Grouping users by the week of their first app use using **"user_first_touch_timestamp"**.
- Identifying active users who remained active in the following four weeks.
- Extracting and flattening JSON fields from **"event_params"**, **"user_properties"**, and **"geo"**.
- Converting timestamps to date formats for grouping and filtering.

---

**SQL Queries:**

1. **Retrieve distinct users and their first touch timestamps starting from July 2, 2018:**

   ```sql
   SELECT DISTINCT "user_pseudo_id", "user_first_touch_timestamp"
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
   WHERE "user_first_touch_timestamp" >= TO_TIMESTAMP_NTZ('2018-07-02')
   LIMIT 100;
   ```

2. **List the number of events per user on July 2, 2018:**

   ```sql
   SELECT "user_pseudo_id", COUNT(*) AS "event_count"
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
   GROUP BY "user_pseudo_id"
   ORDER BY "event_count" DESC
   LIMIT 100;
   ```

3. **Get the event names and their occurrence counts on July 2, 2018:**

   ```sql
   SELECT "event_name", COUNT(*) AS "occurrences"
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
   GROUP BY "event_name"
   ORDER BY "occurrences" DESC
   LIMIT 100;
   ```

4. **Extract user properties to see available user attributes:**

   ```sql
   SELECT f.value
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 t,
        LATERAL FLATTEN(input => t."user_properties") f
   LIMIT 100;
   ```

5. **Show distinct platforms used by users on July 2, 2018:**

   ```sql
   SELECT DISTINCT "platform"
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
   LIMIT 100;
   ```

6. **Find users who performed a specific event (e.g., 'user_engagement') on July 2, 2018:**

   ```sql
   SELECT DISTINCT "user_pseudo_id"
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
   WHERE "event_name" = 'user_engagement'
   LIMIT 100;
   ```

7. **Convert 'user_first_touch_timestamp' to date and list users by their first touch date:**

   ```sql
   SELECT DISTINCT "user_pseudo_id",
       DATE(TO_TIMESTAMP_NTZ("user_first_touch_timestamp" / 1000000)) AS "first_touch_date"
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
   LIMIT 100;
   ```

8. **Extract event parameters to see additional event details:**

   ```sql
   SELECT f.value
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 t,
        LATERAL FLATTEN(input => t."event_params") f
   LIMIT 100;
   ```

9. **List users along with their geographic information:**

   ```sql
   SELECT t."user_pseudo_id", t."geo"
   FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 t
   LIMIT 100;
   ```

10. **Count the number of users per 'platform' and 'event_name' on July 2, 2018:**

    ```sql
    SELECT "platform", "event_name", COUNT(DISTINCT "user_pseudo_id") AS "user_count"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
    GROUP BY "platform", "event_name"
    ORDER BY "user_count" DESC
    LIMIT 100;
    ```

11. **Identify users who first used the app in the week starting July 2, 2018:**

    ```sql
    SELECT DISTINCT "user_pseudo_id"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
    WHERE DATE_TRUNC('week', TO_TIMESTAMP_NTZ("user_first_touch_timestamp" / 1000000)) = '2018-07-02'
    LIMIT 100;
    ```

12. **List the most common devices used by users on July 2, 2018:**

    ```sql
    SELECT t."user_pseudo_id", t."device"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 t
    LIMIT 100;
    ```

13. **Find the top 10 events with the longest durations from 'event_params':**

    ```sql
    SELECT t."event_name", ep.value:"value"::FLOAT AS "duration"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 t,
         LATERAL FLATTEN(input => t."event_params") ep
    WHERE ep.value:"key"::STRING = 'engagement_time_msec'
    ORDER BY "duration" DESC
    LIMIT 100;
    ```

14. **Get the number of events per hour on July 2, 2018:**

    ```sql
    SELECT DATE_TRUNC('hour', TO_TIMESTAMP_NTZ("event_timestamp" / 1000000)) AS "event_hour",
           COUNT(*) AS "event_count"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
    GROUP BY "event_hour"
    ORDER BY "event_hour"
    LIMIT 100;
    ```

15. **Extract and list user demographic information from 'user_properties':**

    ```sql
    SELECT t."user_pseudo_id", up.value
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 t,
         LATERAL FLATTEN(input => t."user_properties") up
    LIMIT 100;
    ```

---

These queries are designed to explore different aspects of the data, such as user activity, event details, user properties, platforms, and timestamps. By analyzing the results of these queries, you can gain a better understanding of the dataset and prepare to perform more complex analyses related to user retention over time.Query:
SELECT DISTINCT "user_pseudo_id", "user_first_touch_timestamp"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
WHERE TO_DATE(TO_TIMESTAMP_NTZ("user_first_touch_timestamp" / 1000000)) >= TO_DATE('2018-07-02')
LIMIT 100;
Answer:
user_pseudo_id,user_first_touch_timestamp
E2D6E7FE36B7CDD0789CC8F03CC747E0,1530584740063000
92BF054A90804B6D65F11D7CDFCDDEFC,1530499836284000
D7D49CC32C4A23AD56E8DEAE6878EC7B,1530569048608000
DDAE59D1F0DCF18D15A1BA723158614C,1530573184490000
41F62B68F0D1C05B6F17CFACD42913C5,1530574826826000
0232A0C6A31572DBA6D6CB0F2592ABCE,1530600406887000
3E8023DB1D342304C2D6BD56705C4687,1530575672486000
011068A78F16C35DE89A649B12D640DA,1530493700080000
F470625FCD13350142D1FAB619BEDE53,1530492987920000
B1A46F0467C18F539094677527CB116F,1530518122853000
50D8D0C89D69EDAE2F04E43E90DB59C1,1530535341338000
FFA9AE78B23263835F8AAED57713EBE9,1530544624770000
E2CD12EE286D97AF7174B8AB91391200,1530598381079000
5E2C595CFDF94553EBF5B05F626CB4C8,1530599848170000
2153C36F9ABADBC957F8403899AE4B0B,1530572148244000
4A81FE8E75C780C97EEE73A7574F0B4F,1530591617148000
4C24B12A477BD284ED0304487600B8D2,1530559366404000
60A18C651D23E2866F761919F140EFBD,1530563231267000
AC103055E83E587CED6353022475BC46,1530558762549000
6933934F877244F44E681554B2BE6CED,1530553841845000
E99D4AD5E5663BABE4AC08C027C775EF,1530589432127000
530F22FBF57DF2EB8416BA94E7A43393,1530523835133000
47055E61DA0D1DF28229E1096D48492A,1530586477187000
26E433620D4C61C3082CF472C0528789,1530565816013000
782911F9743463E6A2D8771F0ABDEF7E,1530589347671000
50F9ECC02D5198369DEC190502867F73,1530594957247000
85549E512A7BB6B13BD956D427B86C74,1530595374289000
077BC7302275F4E34731C2780C166C02,1530583008354000
AFE22459EBDA201861C54CDFF294D8F9,1530498271011000
9FEE80E475ED50AAF174B4F17563C16D,1530546373086000
012A1B5594934B98BD38FDD68C560702,1530589144528000
23FE2E728CBE5ECDAE567700B4021340,1530565617533000
Query:
-- 1. Count the number of events per user
SELECT "user_pseudo_id", COUNT(*) AS "event_count"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
GROUP BY "user_pseudo_id"
ORDER BY "event_count" DESC
LIMIT 100
Answer:
user_pseudo_id,event_count
CC88655DF7CDE5E8225BA20B5D6EC59B,2759
C8685B0DFA2C4B4E6E6EA72894C30F6F,2145
39A0592805168E5D5B3C3687A7472628,2043
0B08423CCD5F1503B5A8B306FFED999C,1244
DDF187DB0391034487C7D3B8C681E0B0,1228
FFA9AE78B23263835F8AAED57713EBE9,1066
10B0D468B5E036E16D13DB53A65F2D49,960
12E5626928FE0885DEEF068683E8BD63,819
AD85E945EC909FEF07A21ECB3EFC0693,774
48AB910A8DE8485D4C34238EA61F782C,745
DF0E6C6C5E4F3F34FEC6EE54FD945B05,720
2F74E23BEA1E45E3897274EE4903DCC5,699
4EF964D59282E5A2C8692D30F011256B,685
CABE7E24215A5C36862658A36AE5CE12,674
B63075B53A750A67A12F7F19ED5AA835,646
E99D4AD5E5663BABE4AC08C027C775EF,593
F5DAD8DD17B689CF672D65A0A81CF4AC,529
47216088A078D06F9220263FAF964F10,516
B37EDF42306464D3D96E5A56A03A8CBA,496
92BF054A90804B6D65F11D7CDFCDDEFC,490
53A5A4C271525BAA74298747E100C376,487
472451071AED6FF801BC0FE66706FD27,485
0D17D0247F158FA3E40D21EFF46D1651,478
00D49153E0790E34D76523EEBEF459B2,478
03A9D32C44665A9E15CFCCEDC9F68EDB,459
E53BC2A0AD86417B443AF14EE3082C0F,450
5E09265F12D64B9FA85FF9427A0A7FB0,439
A9C876F6262995184453B40AB7C5233C,422
C6EAD483A8AF7EE9B0ADE6D7CE5DD698,391
F2A1FD8B142EB4C6CAAE415FA1917F50,385
C6DE585349744A40725DB0AB17041BA3,381
1B3AD9683D475EFB398E131DFE65AE61,355
3DEB0C12C49AD19D7ACE68FA59E7ACD6,354
D0F280B12652EB0D74F6BC74AB13606F,347
BE74418BE7B7466F6FE2969CA79FA919,314
0CAAA1B6F161BA4D363EB7A2DEF64A08,312
187F3053F04D9D7EF93DF21DBDB59684,307
79C6CEA7189615EF5319ED1BA55DDE9D,305
D7D49CC32C4A23AD56E8DEAE6878EC7B,303
9FEE80E475ED50AAF174B4F17563C16D,298
08D399C66188D9A356AFAD5E2B2BA45E,287
A37AD550BCBF8C8B1D5616BB5A47770D,286
3875A92B5F5C2BBA1355CED06A986079,261
487DE902636DD8A9844A2D61FE7BD568,258
E080406D26F71C9B8F331779CE8B82BA,253
C639CACA07D03F536F537ED779CF6599,235
4D33ED6DCCD63BBED146B6060B307CAF,232
EBFE0623EF1109A89B392B9DF4375951,232
E2D6E7FE36B7CDD0789CC8F03CC747E0,225
2F5BBABE9DD0271DCD62E501F76DA736,225
D7EA8E3645EFFBD6443946179ED704A6,220
654F30C1312F6C1A26DFDA9F076A62D8,212
EF500E0CF578004836D1D38C8901862B,211
09FCF0FC0E0F04B3DD8DFE96DA57DDF6,209
CFA0F8C5E25A71062E573EF8E6BC9F76,203
74375465CD17299EBC7C75A1B4047EE0,196
38D4084307B6D1CEA37A48981753428E,195
1213ED1E96B0A49B51C0F7683DB2ACCC,193
42E6A7C3536775E3B8C3DB919AE9A452,189
05FB3382D94C7E963B408FD6CC357D33,187
9DE945166BCD4709696C5836317DDE47,186
5217AB1A454DAED6243E1C9818BE6A20,186
0AF862AFEB5358EBFDA7AFE3AC908844,183
418C1FE4FF01EA36F511E5D9073F11BD,179
193D4BFCCCDED344EE4C2A2809BF685F,178
372D9BB5088C4E9000C65B06459B403A,177
5CC434A43CB09640FC6BE2D7A18183E4,176
091770A1325101155A651F90D283DA35,175
FC48EDE912EDD9F8D7ED45F697EE7193,175
78119035B1798D27E62402E7ADB498BC,172
50D8D0C89D69EDAE2F04E43E90DB59C1,168
8320FC247A1967E7C0CDFC1502241310,167
16B0F6645F896C16F83EF56A99868801,166
898B790ACC7834117A9B2C98A8B6F1F5,162
83D8C7F90DAF2C832F05A9DDD8693135,151
3D03A380687FE3369E93915D50C572CB,150
B9BC9A430E79917967EFBEF5B1915199,146
19DEEA6B15B314DB0ED2A4936959D8F9,146
64BA3BB3BD757CE7000D38CB7125E6DA,142
31D7BB4CF721D8676B85F73077F4304E,142
2304B486B11E4CFFA0BB8AC8F2F5F4B6,141
1F0D27B8A7E058446D4A6409E2E73B19,141
FE46EFC1DA3F3159AD9343EC53466F3F,141
2B7787A34C362AA51FF8E4DD031A2F70,140
018F03084C88E944163F76A0D0C2FBA1,138
BBDAFE02F8160B43C105F79EFFD0DF7F,138
FA30269453141794E79B8F15EE0BA5B9,137
D4F4DAEF5BE38E5C67FD72BB1F082EBF,131
B1A46F0467C18F539094677527CB116F,129
EECDCA8076D5842922767F5C08957B17,127
A87A30159D909E2356F72AAC76F26707,124
1D7DE8A95370FDCB698B25F1E424C91D,120
A0616D4E494DC3BCCB94B8B6E5B48380,120
62D571096D5393BFB10F2D55DA2FC28C,117
7AE4084BAA29B1987E51BF2964646805,117
CA04708DA02378999ECB402481FF1AE4,110
C089DEEB2EA27CF072D17A89C956AFF3,110
D4C8E3E0EFC45C3D60AB3F0F305489AF,109
5E694DE02688C2FDDEA38A6946A4CC3F,108
6EDA0BB1611F7E5AB409221AE13ED52E,107
Query:
-- 2. Get the event names and their occurrence counts
SELECT "event_name", COUNT(*) AS "occurrences"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
GROUP BY "event_name"
ORDER BY "occurrences" DESC
LIMIT 100
Answer:
event_name,occurrences
screen_view,20378
user_engagement,11605
level_start_quickplay,4493
level_end_quickplay,3068
post_score,2144
level_complete_quickplay,1896
level_fail_quickplay,1173
select_content,942
level_reset_quickplay,916
session_start,621
level_start,560
level_end,396
level_retry_quickplay,387
level_retry,357
level_up,248
level_complete,229
level_fail,148
spend_virtual_currency,85
level_reset,72
use_extra_steps,55
app_exception,54
firebase_campaign,38
first_open,27
no_more_extra_steps,22
os_update,19
ad_reward,18
error,15
app_remove,13
completed_5_levels,11
app_update,8
app_clear_data,1
challenge_a_friend,1
Query:
-- 3. Extract user properties
SELECT f.value
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 t,
     LATERAL FLATTEN(input => t."user_properties") f
LIMIT 100
Answer:
Too long, hard cut:
VALUE
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482378805491000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1477369230231000,
    ""string_value"": ""3""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1476908488411000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1530589570174000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1494813899942000,
    ""string_value"": ""4857993083614758445""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1530589572284000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1476917467314000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1530589572283000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1476908354977000,
    ""set_timestamp_micros"": 1476908266977000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482378833491000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1477369258231000,
    ""string_value"": ""3""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1476908516411000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1530592265519000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1494813927942000,
    ""string_value"": ""4857993083614758445""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1530589600284000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1476917495314000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1530589600283000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1476908354977000,
    ""set_timestamp_micros"": 1476908294977000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482378862491000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1477369287231000,
    ""string_value"": ""3""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1476908545411000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1530592294519000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1494813956942000,
    ""string_value"": ""4857993083614758445""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1530589629284000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1476917524314000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1530589629283000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1476908354977000,
    ""set_timestamp_micros"": 1476908323977000
  }
}"
"{
  ""key"": ""ad_frequency"",
  ""value"": {
    ""set_timestamp_micros"": 1482378809491000,
    ""string_value"": ""2""
  }
}"
"{
  ""key"": ""initial_extra_steps"",
  ""value"": {
    ""set_timestamp_micros"": 1477369234231000,
    ""string_value"": ""3""
  }
}"
"{
  ""key"": ""plays_quickplay"",
  ""value"": {
    ""set_timestamp_micros"": 1476908492411000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""num_levels_available"",
  ""value"": {
    ""set_timestamp_micros"": 1530589574174000,
    ""string_value"": ""30""
  }
}"
"{
  ""key"": ""firebase_last_notification"",
  ""value"": {
    ""set_timestamp_micros"": 1494813903942000,
    ""string_value"": ""4857993083614758445""
  }
}"
"{
  ""key"": ""firebase_exp_4"",
  ""value"": {
    ""set_timestamp_micros"": 1530589576284000,
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""plays_progressive"",
  ""value"": {
    ""set_timestamp_micros"": 1476917471314000,
    ""string_value"": ""true""
  }
}"
"{
  ""key"": ""firebase_exp_1"",
  ""value"": {
    ""set_timestamp_micros"": 1530589576283000,
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""first_open_time"",
  ""value"": {
    ""int_value"": 1476908354977000,
    ""set_timestamp_micros"": 1476908270977000
  }
}"
"{
  "
Query:
-- 4. Show distinct platforms used by users
SELECT DISTINCT "platform"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
LIMIT 100
Answer:
platform
ANDROID
IOS
Query:
-- 5. Find users who performed 'user_engagement' event
SELECT DISTINCT "user_pseudo_id"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
WHERE "event_name" = 'user_engagement'
LIMIT 100
Answer:
user_pseudo_id
654F30C1312F6C1A26DFDA9F076A62D8
65D7715C409E6A38667447CE2B52AFFE
B205B117C82A24AA95E663FFB7D04718
EF9E8CCCCBBB015CAE0C334AB1745417
83D8C7F90DAF2C832F05A9DDD8693135
093642BD46204EB5F950303CE696BC18
0F67E233B19D2898229CD156974A93AE
5217AB1A454DAED6243E1C9818BE6A20
C6EAD483A8AF7EE9B0ADE6D7CE5DD698
38D4084307B6D1CEA37A48981753428E
0373DF7959F6867CDFB1C905D39CE67C
5D5895B1267014C54ECBE08864420979
D34924C19421D7E083FD387D97765F94
C136A7CE1D0A52B8D4E5F144DF114EB7
49309C5759610DBF6C829C0D4AB23943
4BF98D09CA8359FC59ADAF56D00338F8
08D399C66188D9A356AFAD5E2B2BA45E
92B0B6F48ECE132C7E502F94798FE205
3A58859E074B02E8FB1CAEA291636112
706C748E6D1E0768BFEFE6362B5D3F67
D0F280B12652EB0D74F6BC74AB13606F
3EF8FC940E379D53BBD3FEFDAF626BB2
E2D6E7FE36B7CDD0789CC8F03CC747E0
50FEAE9ECFE22E951E8810622A2E8F66
7101B4232F5B26A9C987C54F8717DCDC
4948BEDE78FC6EBA9899F26BF5C53897
7842C62D45ECE888132F21C9F4417B21
672B24B51143CC66DCBAA0FA88C38D57
7AE4084BAA29B1987E51BF2964646805
DE4912FBC5F915C027000A8A6FF44F85
88A41BFED275BB69125BE1F5524F3B42
A87A30159D909E2356F72AAC76F26707
29845B6298FB882DF53607D21F0E1DF7
4BDC831A6940071E2461D0B5293A329E
037DAC225F0C1E54657770CD201CDDA7
E50F7AC0680FD87AD6CE6B6700D209A7
D7EA8E3645EFFBD6443946179ED704A6
59454BAC415BB1F18517C6FD2C023E49
60CFF65B640769B6FD3BC9593EDF7C1D
CA04708DA02378999ECB402481FF1AE4
C87CDC0C4F86B10B7467281D516929B5
EA9A16D9042286D55399A418CC7A28F3
8040FC9C0479C3B9A74ED298DD8F357D
D7D49CC32C4A23AD56E8DEAE6878EC7B
CE7404D5A8831F2DE46BD0A013A8ED64
332FF17A7140DA319A07A72CA1CB6A5A
98742B903F6249E1C5D72DED34CCAE13
0AAA02628D6A75EEC75D37DA84D04426
011068A78F16C35DE89A649B12D640DA
7BABAD7F0F40294269AD80C0232C2814
B1A46F0467C18F539094677527CB116F
004D2DFEB866BFB00427DB2F530C1F3D
58230465C695B0FDDDAE08A481FAEECC
3031EAD1E9D35306A37A0F3DC3B84A0A
05407E04B9FA64CB63D8FA1D966AD6A2
5CDFC86835249BE3DB5E9F6778E344AD
F815B0069F973BFA743EF90A85224109
4D084D38156128AAA060303AA91E689D
E6FEE8B98E75EA5311FE004F98559A27
48AB910A8DE8485D4C34238EA61F782C
2F5B044B41268F6643EB4D0EF15D4E87
E8710E77072D6674A93E46DFEF725587
A064A84CD3CF7058F39333D6212E8615
2F8E2DBB938D2E43C2D171AF5F35EEF8
4A47422A455E62E3529DE4F9F3BFAF66
3DEB0C12C49AD19D7ACE68FA59E7ACD6
AE920B86560554C0BE3F888EDBA2BBF7
64BA3BB3BD757CE7000D38CB7125E6DA
7D613AF4DA0F508C7090E96FD73B7E6D
C795AFA7F574C2BB09D3647AD90A9719
E451D416F972019604F1456533FF3858
AFE7A3E11C66E71FA9EA7B138700EC44
5E694DE02688C2FDDEA38A6946A4CC3F
B75F91EB6C7FDA9A329567E763CF9E44
D739D483CCD20D4651E4A75ADEE94064
53866E32BA0ABFD846772D4B7B9B5921
8EDB9A9856CDB5AFC42546106EE46734
3EDE8E7A50DE76AA2EC12DDD2AE3F9F4
84D135997D8A4D9CB35D4ECA46EF6861
EBFE0623EF1109A89B392B9DF4375951
664F913ED3B54941B5F0886D94E01623
028CAE01A9F16A228177C973451441A1
4CE503AE5B4C4F67A00474CE380CCC39
3D03A380687FE3369E93915D50C572CB
117AD1627465CC9E03AB5D8825D42E07
8320FC247A1967E7C0CDFC1502241310
7480AE90D76538F44A066A153F448198
2F5BBABE9DD0271DCD62E501F76DA736
D3F06F9B7BD9D7FC8758BF78BF0705E9
97E7144B7FA861C3C8DB7424D7039832
DD695F4DCB9694F4E026B78E17BD7945
41F62B68F0D1C05B6F17CFACD42913C5
C3D7BA97E184ABF0A446F35DE12BACF9
B75FCD833DE643B45B326D2E7AC413E4
932AAF56DDE9C55359B9CCFA18E7FB95
E512079B53179DF9A608CF4ADE47DE9D
C09F04828B07E4DFEF39DA5C4A976A90
0232A0C6A31572DBA6D6CB0F2592ABCE
A9C876F6262995184453B40AB7C5233C
19DEEA6B15B314DB0ED2A4936959D8F9
Query:
-- 6. List users by their first touch date
SELECT DISTINCT "user_pseudo_id",
       DATE(TO_TIMESTAMP_NTZ("user_first_touch_timestamp" / 1000000)) AS "first_touch_date"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
LIMIT 100
Answer:
user_pseudo_id,first_touch_date
654F30C1312F6C1A26DFDA9F076A62D8,2016-10-19
65D7715C409E6A38667447CE2B52AFFE,2018-06-14
B205B117C82A24AA95E663FFB7D04718,2016-07-21
EF9E8CCCCBBB015CAE0C334AB1745417,2018-06-19
83D8C7F90DAF2C832F05A9DDD8693135,2018-06-24
093642BD46204EB5F950303CE696BC18,2018-06-30
0F67E233B19D2898229CD156974A93AE,2016-09-15
5217AB1A454DAED6243E1C9818BE6A20,2018-06-24
C6EAD483A8AF7EE9B0ADE6D7CE5DD698,2018-07-01
58230465C695B0FDDDAE08A481FAEECC,2016-11-07
38D4084307B6D1CEA37A48981753428E,2016-08-14
0373DF7959F6867CDFB1C905D39CE67C,2018-06-21
D34924C19421D7E083FD387D97765F94,2017-11-18
C136A7CE1D0A52B8D4E5F144DF114EB7,2016-06-15
92B0B6F48ECE132C7E502F94798FE205,2016-11-29
4BF98D09CA8359FC59ADAF56D00338F8,2018-05-12
909A16079F7183140ACF4C71A6CCDF3D,2017-07-06
3031EAD1E9D35306A37A0F3DC3B84A0A,2017-01-23
5CDFC86835249BE3DB5E9F6778E344AD,2017-02-27
F815B0069F973BFA743EF90A85224109,2016-09-03
D0F280B12652EB0D74F6BC74AB13606F,2018-06-18
4D084D38156128AAA060303AA91E689D,2018-01-14
3EF8FC940E379D53BBD3FEFDAF626BB2,2018-06-07
DE4912FBC5F915C027000A8A6FF44F85,2018-06-08
48AB910A8DE8485D4C34238EA61F782C,2017-10-04
E8710E77072D6674A93E46DFEF725587,2018-05-17
4948BEDE78FC6EBA9899F26BF5C53897,2018-01-05
A064A84CD3CF7058F39333D6212E8615,2017-07-24
7842C62D45ECE888132F21C9F4417B21,2018-01-06
7AE4084BAA29B1987E51BF2964646805,2018-06-29
7101B4232F5B26A9C987C54F8717DCDC,2018-04-02
29845B6298FB882DF53607D21F0E1DF7,2018-05-15
76BB576278338D2E508DE5D705241B47,2016-07-17
4BDC831A6940071E2461D0B5293A329E,2017-03-03
B7701369F8598A25DED0499DAD3BE85D,2017-09-29
A74EFE8BDAC26101B308D57A18B746CF,2018-05-23
AE920B86560554C0BE3F888EDBA2BBF7,2017-02-21
037DAC225F0C1E54657770CD201CDDA7,2017-04-28
E50F7AC0680FD87AD6CE6B6700D209A7,2018-06-19
7D613AF4DA0F508C7090E96FD73B7E6D,2016-06-03
FEDC59699D8832A11B88BFCCCAD0951D,2017-05-16
E451D416F972019604F1456533FF3858,2018-07-01
5E694DE02688C2FDDEA38A6946A4CC3F,2018-03-11
B75F91EB6C7FDA9A329567E763CF9E44,2018-05-21
53866E32BA0ABFD846772D4B7B9B5921,2018-06-20
7480AE90D76538F44A066A153F448198,2018-05-01
8EDB9A9856CDB5AFC42546106EE46734,2017-01-17
60FAC27D8495BF33C2AE5283A7B07005,2018-05-13
EBFE0623EF1109A89B392B9DF4375951,2016-05-29
D7D49CC32C4A23AD56E8DEAE6878EC7B,2018-07-02
8320FC247A1967E7C0CDFC1502241310,2017-06-05
D739D483CCD20D4651E4A75ADEE94064,2018-07-01
3D03A380687FE3369E93915D50C572CB,2017-08-10
5D5895B1267014C54ECBE08864420979,2018-02-22
08D399C66188D9A356AFAD5E2B2BA45E,2018-06-18
49309C5759610DBF6C829C0D4AB23943,2016-08-24
3A58859E074B02E8FB1CAEA291636112,2016-12-02
706C748E6D1E0768BFEFE6362B5D3F67,2016-09-29
E6FEE8B98E75EA5311FE004F98559A27,2018-03-25
50FEAE9ECFE22E951E8810622A2E8F66,2018-05-29
A87A30159D909E2356F72AAC76F26707,2018-06-27
05407E04B9FA64CB63D8FA1D966AD6A2,2016-06-19
88A41BFED275BB69125BE1F5524F3B42,2017-09-07
2F8E2DBB938D2E43C2D171AF5F35EEF8,2018-06-29
92BF054A90804B6D65F11D7CDFCDDEFC,2018-07-02
7207044281C74501C14233463AAD9A71,2018-06-19
3DEB0C12C49AD19D7ACE68FA59E7ACD6,2017-06-20
920DB84FCC0F4421650B9E257E33180B,2018-06-09
64BA3BB3BD757CE7000D38CB7125E6DA,2018-05-22
C795AFA7F574C2BB09D3647AD90A9719,2017-04-06
936906C2CB90CE437DBFC01BBD96BA39,2016-05-29
59454BAC415BB1F18517C6FD2C023E49,2018-01-08
60CFF65B640769B6FD3BC9593EDF7C1D,2016-06-13
AFE7A3E11C66E71FA9EA7B138700EC44,2018-05-23
3EDE8E7A50DE76AA2EC12DDD2AE3F9F4,2018-05-01
257A35EA0A92B4B2F8FB4BA3F8B4C3D8,2017-03-11
84D135997D8A4D9CB35D4ECA46EF6861,2018-06-23
11A8D6037368A4C4508B11ADB4353BC4,2018-03-13
CA04708DA02378999ECB402481FF1AE4,2016-06-12
664F913ED3B54941B5F0886D94E01623,2017-11-04
C87CDC0C4F86B10B7467281D516929B5,2017-12-23
2F5BBABE9DD0271DCD62E501F76DA736,2018-06-29
4CE503AE5B4C4F67A00474CE380CCC39,2016-07-07
EA9A16D9042286D55399A418CC7A28F3,2018-04-24
8040FC9C0479C3B9A74ED298DD8F357D,2016-10-18
DD695F4DCB9694F4E026B78E17BD7945,2018-04-27
4DA8863CD8D2C860F6BB73579BC6F5C9,2018-01-29
117AD1627465CC9E03AB5D8825D42E07,2017-12-19
2304B486B11E4CFFA0BB8AC8F2F5F4B6,2017-06-04
CE7404D5A8831F2DE46BD0A013A8ED64,2016-10-10
4A47422A455E62E3529DE4F9F3BFAF66,2018-06-13
2F5B044B41268F6643EB4D0EF15D4E87,2018-06-30
E2D6E7FE36B7CDD0789CC8F03CC747E0,2018-07-03
672B24B51143CC66DCBAA0FA88C38D57,2018-03-10
D7EA8E3645EFFBD6443946179ED704A6,2017-01-20
27859DA5E38F4C681DA4FBF0CFB9F306,2018-06-25
028CAE01A9F16A228177C973451441A1,2018-06-24
D3F06F9B7BD9D7FC8758BF78BF0705E9,2016-12-03
01562149DD13E75D732F0A9CA2D8CF5C,2018-06-26
97E7144B7FA861C3C8DB7424D7039832,2017-06-30
Query:
-- 7. Extract event parameters
SELECT f.value
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 t,
     LATERAL FLATTEN(input => t."event_params") f
LIMIT 100
Answer:
Too long, hard cut:
VALUE
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8126232848982224228
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""value"",
  ""value"": {
    ""int_value"": 22
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""app+gtm""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": 8126232848982224228
  }
}"
"{
  ""key"": ""board"",
  ""value"": {
    ""string_value"": ""S""
  }
}"
"{
  ""key"": ""firebase_conversion"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490845
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""FloodItActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490838
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""main_menu""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490838
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""FloodItActivity""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""ExtraStepsActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490799
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490799
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""shop_menu""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490798
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""ExtraStepsActivity""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490798
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""shop_menu""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490837
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""GameFinishedActivity""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"": ""auto""
  }
}"
"{
  ""key"": ""firebase_screen_id"",
  ""value"": {
    ""int_value"": -3260873074173490785
  }
}"
"{
  ""key"": ""firebase_previous_class"",
  ""value"": {
    ""string_value"": ""game_board""
  }
}"
"{
  ""key"": ""firebase_previous_id"",
  ""value"": {
    ""int_value"": -3260873074173490785
  }
}"
"{
  ""key"": ""firebase_screen_class"",
  ""value"": {
    ""string_value"": ""game_over""
  }
}"
"{
  ""key"": ""firebase_event_origin"",
  ""value"": {
    ""string_value"
Query:
-- 8. List users along with their geographic information
SELECT t."user_pseudo_id", t."geo"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 t
LIMIT 100
Answer:
Too long, hard cut:
user_pseudo_id,geo
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
 
Query:
-- 9. Count the number of users per 'platform' and 'event_name'
SELECT "platform", "event_name", COUNT(DISTINCT "user_pseudo_id") AS "user_count"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
GROUP BY "platform", "event_name"
ORDER BY "user_count" DESC
LIMIT 100
Answer:
platform,event_name,user_count
ANDROID,user_engagement,271
ANDROID,screen_view,263
ANDROID,session_start,248
ANDROID,select_content,237
ANDROID,level_start_quickplay,204
ANDROID,post_score,194
ANDROID,level_end_quickplay,176
IOS,screen_view,165
IOS,user_engagement,163
IOS,session_start,160
ANDROID,level_complete_quickplay,156
IOS,level_start_quickplay,155
IOS,select_content,150
IOS,level_end_quickplay,118
IOS,post_score,106
IOS,level_complete_quickplay,102
ANDROID,level_fail_quickplay,88
IOS,level_fail_quickplay,74
ANDROID,level_retry_quickplay,64
ANDROID,level_start,58
ANDROID,level_end,51
ANDROID,level_retry,48
ANDROID,level_complete,42
ANDROID,level_up,42
ANDROID,level_reset_quickplay,42
ANDROID,level_fail,30
IOS,level_reset_quickplay,25
ANDROID,spend_virtual_currency,20
ANDROID,app_exception,20
ANDROID,first_open,19
ANDROID,firebase_campaign,19
ANDROID,level_reset,19
ANDROID,use_extra_steps,18
IOS,level_retry_quickplay,17
ANDROID,app_remove,13
ANDROID,completed_5_levels,11
ANDROID,no_more_extra_steps,11
IOS,os_update,11
IOS,level_start,10
ANDROID,ad_reward,9
IOS,first_open,8
IOS,level_end,8
IOS,app_update,8
ANDROID,os_update,8
IOS,spend_virtual_currency,6
IOS,level_up,5
IOS,level_fail,5
IOS,app_exception,4
IOS,error,3
IOS,no_more_extra_steps,3
IOS,level_retry,3
IOS,level_reset,2
IOS,use_extra_steps,1
ANDROID,challenge_a_friend,1
ANDROID,app_clear_data,1
IOS,level_complete,1
Query:
-- 10. Identify users who first used the app in the week starting July 2, 2018
SELECT DISTINCT "user_pseudo_id"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
WHERE DATE_TRUNC('week', TO_DATE(TO_TIMESTAMP_NTZ("user_first_touch_timestamp" / 1000000))) = TO_DATE('2018-07-02')
LIMIT 100
Answer:
user_pseudo_id
E2D6E7FE36B7CDD0789CC8F03CC747E0
92BF054A90804B6D65F11D7CDFCDDEFC
D7D49CC32C4A23AD56E8DEAE6878EC7B
DDAE59D1F0DCF18D15A1BA723158614C
41F62B68F0D1C05B6F17CFACD42913C5
0232A0C6A31572DBA6D6CB0F2592ABCE
011068A78F16C35DE89A649B12D640DA
F470625FCD13350142D1FAB619BEDE53
50D8D0C89D69EDAE2F04E43E90DB59C1
B1A46F0467C18F539094677527CB116F
FFA9AE78B23263835F8AAED57713EBE9
077BC7302275F4E34731C2780C166C02
E2CD12EE286D97AF7174B8AB91391200
5E2C595CFDF94553EBF5B05F626CB4C8
2153C36F9ABADBC957F8403899AE4B0B
4A81FE8E75C780C97EEE73A7574F0B4F
4C24B12A477BD284ED0304487600B8D2
AFE22459EBDA201861C54CDFF294D8F9
6933934F877244F44E681554B2BE6CED
E99D4AD5E5663BABE4AC08C027C775EF
9FEE80E475ED50AAF174B4F17563C16D
23FE2E728CBE5ECDAE567700B4021340
530F22FBF57DF2EB8416BA94E7A43393
012A1B5594934B98BD38FDD68C560702
47055E61DA0D1DF28229E1096D48492A
26E433620D4C61C3082CF472C0528789
782911F9743463E6A2D8771F0ABDEF7E
50F9ECC02D5198369DEC190502867F73
3E8023DB1D342304C2D6BD56705C4687
85549E512A7BB6B13BD956D427B86C74
AC103055E83E587CED6353022475BC46
60A18C651D23E2866F761919F140EFBD
Query:
-- 11. List the most common devices used by users
SELECT t."user_pseudo_id", t."device"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 t
LIMIT 100
Answer:
Too long, hard cut:
user_pseudo_id,device
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo dataset"",
  ""mobile_model_name"": ""not available in demo dataset"",
  ""mobile_os_hardware_model"": ""not available in demo dataset"",
  ""operating_system"": ""ANDROID"",
  ""operating_system_version"": ""not available in demo dataset"",
  ""time_zone_offset_seconds"": -14400
}"
654F30C1312F6C1A26DFDA9F076A62D8,"{
  ""category"": ""mobile"",
  ""is_limited_ad_tracking"": ""No"",
  ""language"": ""en-us"",
  ""mobile_brand_name"": ""not available in demo dataset"",
  ""mobile_marketing_name"": ""not available in demo da
Query:
SELECT
    t."event_name",
    (
        CASE
            WHEN ep.value:"value":"int_value" IS NOT NULL THEN ep.value:"value":"int_value"::FLOAT
            WHEN ep.value:"value":"double_value" IS NOT NULL THEN ep.value:"value":"double_value"::FLOAT
            ELSE NULL
        END
    ) AS "duration"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 t,
     LATERAL FLATTEN(input => t."event_params") ep
WHERE ep.value:"key"::STRING = 'engagement_time_msec'
ORDER BY "duration" DESC
LIMIT 100;
Answer:
event_name,duration
user_engagement,3598367.0
user_engagement,3598360.0
user_engagement,3598358.0
user_engagement,3598356.0
user_engagement,3598352.0
user_engagement,3598343.0
user_engagement,3598276.0
user_engagement,3598268.0
user_engagement,3598261.0
user_engagement,3598260.0
user_engagement,3598258.0
user_engagement,3598253.0
user_engagement,3598218.0
user_engagement,3598217.0
user_engagement,3598207.0
user_engagement,3598204.0
user_engagement,3598203.0
user_engagement,3598194.0
user_engagement,3598168.0
user_engagement,3598160.0
user_engagement,3598157.0
user_engagement,3598148.0
user_engagement,3598142.0
user_engagement,3598134.0
user_engagement,830650.0
user_engagement,715537.0
user_engagement,702985.0
user_engagement,659514.0
user_engagement,645601.0
user_engagement,644579.0
user_engagement,600447.0
user_engagement,582006.0
user_engagement,572865.0
user_engagement,526544.0
user_engagement,507752.0
user_engagement,507169.0
user_engagement,496624.0
user_engagement,475485.0
user_engagement,470826.0
user_engagement,443244.0
user_engagement,430251.0
user_engagement,429162.0
user_engagement,419741.0
user_engagement,415302.0
user_engagement,412092.0
user_engagement,384064.0
user_engagement,378352.0
user_engagement,374681.0
user_engagement,374323.0
user_engagement,366151.0
user_engagement,351504.0
user_engagement,344973.0
user_engagement,338869.0
user_engagement,329348.0
user_engagement,328278.0
user_engagement,326226.0
user_engagement,324175.0
user_engagement,323975.0
user_engagement,321768.0
user_engagement,313191.0
user_engagement,310760.0
user_engagement,307100.0
user_engagement,300422.0
user_engagement,291955.0
user_engagement,289861.0
user_engagement,282940.0
user_engagement,282844.0
user_engagement,273924.0
user_engagement,273049.0
user_engagement,272231.0
user_engagement,262634.0
user_engagement,260084.0
user_engagement,257221.0
user_engagement,256929.0
user_engagement,253804.0
user_engagement,248646.0
user_engagement,247732.0
user_engagement,246044.0
user_engagement,243176.0
user_engagement,241349.0
user_engagement,241149.0
user_engagement,240836.0
user_engagement,239362.0
user_engagement,236552.0
user_engagement,236314.0
user_engagement,236022.0
user_engagement,233375.0
user_engagement,231908.0
user_engagement,231636.0
user_engagement,230535.0
user_engagement,230093.0
user_engagement,226106.0
user_engagement,224804.0
user_engagement,223691.0
user_engagement,223383.0
user_engagement,223284.0
user_engagement,221503.0
user_engagement,220943.0
user_engagement,219141.0
user_engagement,218903.0
Query:
-- 13. Get the number of events per hour (Corrected if necessary)
SELECT
    DATE_TRUNC('hour', TO_TIMESTAMP_NTZ("event_timestamp" / 1e6)) AS "event_hour",
    COUNT(*) AS "event_count"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
GROUP BY "event_hour"
ORDER BY "event_hour"
LIMIT 100
Answer:
event_hour,event_count
2018-07-02 07:00:00,790
2018-07-02 08:00:00,626
2018-07-02 09:00:00,2452
2018-07-02 10:00:00,1260
2018-07-02 11:00:00,1089
2018-07-02 12:00:00,1294
2018-07-02 13:00:00,1990
2018-07-02 14:00:00,1990
2018-07-02 15:00:00,2249
2018-07-02 16:00:00,3124
2018-07-02 17:00:00,1851
2018-07-02 18:00:00,1671
2018-07-02 19:00:00,2496
2018-07-02 20:00:00,2335
2018-07-02 21:00:00,3286
2018-07-02 22:00:00,3189
2018-07-02 23:00:00,3279
2018-07-03 00:00:00,4336
2018-07-03 01:00:00,2874
2018-07-03 02:00:00,2541
2018-07-03 03:00:00,1722
2018-07-03 04:00:00,1869
2018-07-03 05:00:00,1005
2018-07-03 06:00:00,682
Query:
-- 14. Extract user demographic information (Corrected)
SELECT
    t."user_pseudo_id",
    up.value:"key"::STRING AS "property_key",
    COALESCE(
        up.value:"value":"string_value"::STRING,
        TO_VARCHAR(up.value:"value":"int_value"),
        TO_VARCHAR(up.value:"value":"double_value")
    ) AS "property_value"
FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702 t,
     LATERAL FLATTEN(input => t."user_properties") up
LIMIT 100
Answer:
Too long, hard cut:
user_pseudo_id,property_key,property_value
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_4,1
654F30C1312F6C1A26DFDA9F076A62D8,plays_progressive,true
654F30C1312F6C1A26DFDA9F076A62D8,firebase_exp_1,0
654F30C1312F6C1A26DFDA9F076A62D8,first_open_time,1476908354977000
654F30C1312F6C1A26DFDA9F076A62D8,ad_frequency,2
654F30C1312F6C1A26DFDA9F076A62D8,initial_extra_steps,3
654F30C1312F6C1A26DFDA9F076A62D8,plays_quickplay,true
654F30C1312F6C1A26DFDA9F076A62D8,num_levels_available,30
654F30C1312F6C1A26DFDA9F076A62D8,firebase_last_notification,4857993083614758445
654F30C1312F6C1A26D
End Exploring Related Columns
Task: Can you group users by the week they first used the app starting from July 2, 2018 and show which group has the most active users remained in the next four weeks, with each group named by the Monday date of that week? Please answer in the format of " YYYY-MM-DD".

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: After analyzing the data, the group of users who first used the app in the week starting on **2018-07-02** had the most active users remained in the next four weeks.

```csv
Week_Start_Date
2018-07-02
(Attention: answer in one row)
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-24 04:28:07 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 04:28:07 - root - INFO - ```sql
WITH all_events AS (
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180703
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180704
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180705
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180706
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180707
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180708
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180709
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180710
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180711
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180712
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180713
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180714
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180715
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180716
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180717
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180718
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180719
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180720
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180721
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180722
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180723
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180724
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180725
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180726
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180727
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180728
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180729
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180730
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180731
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180801
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180802
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180803
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180804
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180805
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180806
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180807
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180808
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180809
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180810
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180811
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180812
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180813
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180814
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180815
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180816
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180817
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180818
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180819
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180820
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180821
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180822
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180823
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180824
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180825
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180826
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180827
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180828
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180829
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180830
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180831
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180902
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180903
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180904
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180905
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180906
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180907
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180908
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180909
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180910
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180911
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180912
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180913
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180914
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180915
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180916
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180917
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180918
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180919
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180920
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180921
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180922
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180923
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180924
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180925
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180926
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180927
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180928
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180929
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180930
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20181001
),
user_events AS (
    SELECT
        "user_pseudo_id",
        DATE_TRUNC('week', TO_DATE(TO_TIMESTAMP_NTZ("user_first_touch_timestamp" / 1000000))) AS "user_first_touch_week",
        DATE_TRUNC('week', TO_DATE(TO_TIMESTAMP_NTZ("event_timestamp" / 1000000))) AS "event_week"
    FROM all_events
    WHERE TO_DATE(TO_TIMESTAMP_NTZ("user_first_touch_timestamp" / 1000000)) >= '2018-07-02'
),
active_users AS (
    SELECT DISTINCT
        "user_pseudo_id",
        "user_first_touch_week"
    FROM user_events
    WHERE "event_week" > "user_first_touch_week"
      AND "event_week" <= DATEADD('week', 4, "user_first_touch_week")
),
active_users_count AS (
    SELECT
        "user_first_touch_week" AS "Week_Start_Date",
        COUNT(DISTINCT "user_pseudo_id") AS "active_users_remained"
    FROM active_users
    GROUP BY "user_first_touch_week"
),
max_active_users AS (
    SELECT
        "Week_Start_Date",
        "active_users_remained",
        RANK() OVER (ORDER BY "active_users_remained" DESC) AS "rank"
    FROM active_users_count
)
SELECT
    "Week_Start_Date"
FROM max_active_users
WHERE "rank" = 1;
```
2025-01-24 04:28:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 04:28:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 04:28:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 04:28:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 04:28:37 - snowflake.connector.connection - INFO - closed
2025-01-24 04:28:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 04:28:37 - root - INFO - itercount: 1
2025-01-24 04:28:37 - root - INFO - 0
2025-01-24 04:28:37 - root - INFO - results: 
Week_Start_Date
2018-09-03


2025-01-24 04:28:37 - root - INFO - Please check the answer again by reviewing Can you group users by the week they first used the app starting from July 2, 2018 and show which group has the most active users remained in the next four weeks, with each group named by the Monday date of that week? Please answer in the format of " YYYY-MM-DD"., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: After analyzing the data, the group of users who first used the app in the week starting on **2018-07-02** had the most active users remained in the next four weeks.

```csv
Week_Start_Date
2018-07-02
(Attention: answer in one row)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Week_Start_Date
2018-09-03
Current sql:
WITH all_events AS (
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180703
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180704
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180705
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180706
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180707
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180708
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180709
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180710
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180711
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180712
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180713
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180714
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180715
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180716
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180717
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180718
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180719
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180720
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180721
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180722
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180723
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180724
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180725
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180726
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180727
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180728
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180729
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180730
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180731
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180801
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180802
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180803
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180804
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180805
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180806
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180807
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180808
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180809
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180810
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180811
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180812
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180813
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180814
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180815
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180816
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180817
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180818
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180819
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180820
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180821
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180822
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180823
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180824
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180825
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180826
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180827
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180828
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180829
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180830
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180831
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180902
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180903
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180904
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180905
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180906
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180907
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180908
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180909
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180910
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180911
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180912
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180913
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180914
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180915
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180916
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180917
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180918
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180919
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180920
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180921
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180922
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180923
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180924
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180925
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180926
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180927
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180928
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180929
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180930
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20181001
),
user_events AS (
    SELECT
        "user_pseudo_id",
        DATE_TRUNC('week', TO_DATE(TO_TIMESTAMP_NTZ("user_first_touch_timestamp" / 1000000))) AS "user_first_touch_week",
        DATE_TRUNC('week', TO_DATE(TO_TIMESTAMP_NTZ("event_timestamp" / 1000000))) AS "event_week"
    FROM all_events
    WHERE TO_DATE(TO_TIMESTAMP_NTZ("user_first_touch_timestamp" / 1000000)) >= '2018-07-02'
),
active_users AS (
    SELECT DISTINCT
        "user_pseudo_id",
        "user_first_touch_week"
    FROM user_events
    WHERE "event_week" > "user_first_touch_week"
      AND "event_week" <= DATEADD('week', 4, "user_first_touch_week")
),
active_users_count AS (
    SELECT
        "user_first_touch_week" AS "Week_Start_Date",
        COUNT(DISTINCT "user_pseudo_id") AS "active_users_remained"
    FROM active_users
    GROUP BY "user_first_touch_week"
),
max_active_users AS (
    SELECT
        "Week_Start_Date",
        "active_users_remained",
        RANK() OVER (ORDER BY "active_users_remained" DESC) AS "rank"
    FROM active_users_count
)
SELECT
    "Week_Start_Date"
FROM max_active_users
WHERE "rank" = 1;When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-24 04:30:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 04:30:25 - root - INFO - ```sql
WITH all_events AS (
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180702
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180703
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180704
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180705
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180706
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180707
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180708
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180709
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180710
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180711
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180712
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180713
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180714
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180715
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180716
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180717
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180718
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180719
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180720
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180721
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180722
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180723
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180724
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180725
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180726
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180727
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180728
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180729
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180730
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180731
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180801
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180802
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180803
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180804
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180805
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180806
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180807
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180808
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180809
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180810
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180811
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180812
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180813
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180814
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180815
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180816
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180817
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180818
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180819
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180820
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180821
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180822
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180823
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180824
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180825
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180826
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180827
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180828
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180829
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180830
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180831
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180901
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180902
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180903
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180904
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180905
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180906
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180907
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180908
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180909
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180910
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180911
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180912
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180913
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180914
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180915
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180916
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180917
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180918
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180919
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180920
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180921
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180922
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180923
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180924
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180925
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180926
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180927
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180928
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180929
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20180930
    UNION ALL
    SELECT "user_pseudo_id", "user_first_touch_timestamp", "event_name", "event_timestamp"
    FROM FIREBASE.ANALYTICS_153293282.EVENTS_20181001
),
user_events AS (
    SELECT
        "user_pseudo_id",
        DATE_TRUNC('week', TO_DATE(TO_TIMESTAMP_NTZ("user_first_touch_timestamp" / 1000000))) AS "user_first_touch_week",
        DATE_TRUNC('week', TO_DATE(TO_TIMESTAMP_NTZ("event_timestamp" / 1000000))) AS "event_week"
    FROM all_events
    WHERE TO_DATE(TO_TIMESTAMP_NTZ("user_first_touch_timestamp" / 1000000)) >= '2018-07-02'
),
active_users AS (
    SELECT DISTINCT
        "user_pseudo_id",
        "user_first_touch_week"
    FROM user_events
    WHERE "event_week" > "user_first_touch_week"
      AND "event_week" <= DATEADD('week', 4, "user_first_touch_week")
),
active_users_count AS (
    SELECT
        "user_first_touch_week" AS "Week_Start_Date",
        COUNT(DISTINCT "user_pseudo_id") AS "active_users_remained"
    FROM active_users
    GROUP BY "user_first_touch_week"
),
max_active_users AS (
    SELECT
        "Week_Start_Date",
        "active_users_remained",
        RANK() OVER (ORDER BY "active_users_remained" DESC NULLS LAST) AS "rank"
    FROM active_users_count
)
SELECT
    "Week_Start_Date"
FROM max_active_users
WHERE "rank" = 1;
```
2025-01-24 04:30:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 04:30:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 04:30:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 04:30:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 04:30:31 - snowflake.connector.connection - INFO - closed
2025-01-24 04:30:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 04:30:31 - root - INFO - itercount: 2
2025-01-24 04:30:31 - root - INFO - 0
2025-01-24 04:30:31 - root - INFO - Total iteration counts: 2
