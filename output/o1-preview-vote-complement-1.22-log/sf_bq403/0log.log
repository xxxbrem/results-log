2025-01-26 15:54:56 - openai._base_client - INFO - Retrying request to /chat/completions in 0.426101 seconds
2025-01-26 15:55:36 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 15:55:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:55:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:55:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:55:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:55:37 - snowflake.connector.connection - INFO - closed
2025-01-26 15:55:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:55:38 - root - INFO - SQL:
SELECT "totrevenue", "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2012
   LIMIT 100;
Results:
totrevenue,totfuncexpns
615689,411785
123398,32238
339132,311067
184876,207063
194999,297198
208324,212964
110370,107165
294294,297732
252440,284339
231889,187672
816862,815407
374605,389064
2176110,151050
57648,59937
250907,284529
326516,359690
565417,618228
6191901,6218539
1259941,1250365
368550,324536
6263,8214
887518,1001492
554010,497729
1160268,1271154
217092,208543
402615,230297
267402,251667
142654,117215
3985749,4102352
1014987,1021620
214898,160544
132489,160207
404491,391474
6853798,6799007
48737,43220
205291,225232
239009,190988
799303,270969
68693,35754
41147,36410
101615,96660
117983,68471
592366,513896
246612,244557
242673,233804
245441,223841
123757,141771
106452,79804
634918,362207
1193694,1303953
391600,294020
2334422,2485470
247695,216432
162491,172476
4679679,4859870
3711792,3472054
235470,226950
2898551,5896441
153916,169319
527281,620516
1104162,1123922
19557978,17211156
1951296,1873849
4805178,5291470
652855,654718
2125329,1863484
13852889,8561969
1192197,1208690
42612778,42332740
2812483,2529356
160381,284045
1857316,1769797
346849,310173
2727976,3553978
7554730,8188232
774388,755686
11156787,5718623
1250968,1486237
21248493,18429612
493438,421330
24018285,25819923
24409280,22917045
2730287,2323595
22424056,18408798
10006131,4267681
2221319,3254942
105775719,117647554
19299093,19402388
17980075,11696894
70036549,64883363
33508177,9120070
3183041,3410875
2788432,2870740
205587007,231386633
997037763,852695208
2783164,3971812
49034556,43567769
694874,635558
21623111,12041922
2458179,3641992

2025-01-26 15:55:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:55:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:55:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:55:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 66
2025-01-26 15:55:39 - snowflake.connector.connection - INFO - closed
2025-01-26 15:55:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:55:40 - root - INFO - SQL:
SELECT DISTINCT "tax_pd"
   FROM IRS_990.IRS_990.IRS_990_2013
   LIMIT 100;
Results:
tax_pd
201211
201204
201304
201306
201203
201210
201301
201012
201109
201105
201010
201108
201102
201107
201101
201004
201003
201011
200902
200910
200905
201303
201104
201007
200904
200907
200801
201112
201205
201009
201202
201305
200812
201110
201005
201008
201307
201308
200906
200901
200806
201212
201209
201106
201310
201201
201006
201111
201103
200909
200903
200808
200112
201311
201206
201208
201207
201302
201309
200912
200908
201002
200911
200810
200712
201001

2025-01-26 15:55:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:55:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:55:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:55:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:55:41 - snowflake.connector.connection - INFO - closed
2025-01-26 15:55:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:55:42 - root - INFO - SQL:
SELECT "ein", "totrevenue", "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2014
   WHERE "totrevenue" IS NOT NULL AND "totfuncexpns" IS NOT NULL
   LIMIT 100;
Results:
ein,totrevenue,totfuncexpns
953771529,20694,19468
420309398,236657,301343
236390504,19819,26396
840633742,655125,578163
593773427,847870,826451
222570855,712182,712459
237424858,366711,353922
370287741,3447721,2909079
363189150,2621632,1366326
411557904,2871588,2928131
203045114,1015877,1001174
141658870,863595,530667
46292891,51218,153153
232134479,1185460,1172599
316032186,6830751,6142934
232196098,411892,506446
222701258,117976,109535
541994706,16330,25661
820445263,527676,508423
521813311,3996068,3814139
222453223,31462,15677
460560244,110869,75381
546052315,196609,192972
450310153,4856006,4435095
362170128,646143,882350
581510455,55653,54446
340733165,36255767,37918684
621833867,13401,42833
453947399,2497066,1966300
930955296,592497,579233
592029480,526551,542168
41699540,7598454,7415237
453781713,688824,695361
562129912,592390,548554
270607089,1899805,1721268
237154063,5275560,5094916
450418966,29024,4300
541682144,1430082,1180962
611328603,10618,12506
570314423,9344697,11265328
450489921,150016,225798
426018990,160825,162894
274629198,177716,173485
133564301,0,5280
66011964,355783,341269
263876220,200313,196189
134324477,84804,318702
330995500,988630,258610
363503578,299418,164213
580958641,721665,649140
371200920,27944,19206
432008066,375326,263299
200293876,213389,214720
222850706,205349,108411
42600042,7323005,7706633
133860474,504245,473816
222923921,2893102,2718660
582339007,469484,436588
452549443,460476,713786
251225480,309001,155099
530027063,447640,439713
561878125,27065,49924
210390650,631519,656660
620855416,156588,134766
743236898,559483,141491
112300840,8659447,8527621
43015339,10947718,10717634
650927702,1436783,1036703
331148100,73239,66127
541621932,2415779,2634196
521295844,601371,740935
274348285,135726,122830
237149667,90930,63194
311626159,8888752,9015272
631233068,439578,315975
770273199,466928,481516
362615996,11389699,11169785
521219436,8312329,6808366
954383228,609859,516240
951643324,20097194,17307341
113218155,1079509,1091845
841479819,1600525,1127166
760657114,64356,87744
886082809,9233,8946
860040446,120116,123827
420680411,21760972,20973199
133030322,1327524,1299522
205839315,104555,100085
450375763,134958,15702
421385723,1372261,157833
366919591,684340,373909
860127380,61713,0
383872234,0,157
521959441,152717,173234
521853211,138876,157099
222229995,2295981,2056378
271454515,194497,193369
820291797,244112,323411
383407798,1200,5900
581340880,571539,543849

2025-01-26 15:55:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:55:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:55:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:55:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:55:43 - snowflake.connector.connection - INFO - closed
2025-01-26 15:55:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:55:44 - root - INFO - SQL:
SELECT "totrevenue", "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2015
   WHERE "totrevenue" > 0 AND "totfuncexpns" > 0
   LIMIT 100;
Results:
totrevenue,totfuncexpns
79226,10716
69691,46507
565470,594117
919660,876681
196640,197060
287456,272165
1154253,1430994
329502,348482
1061767,670985
744619,636569
612222,575987
82274,427257
306876,290320
94153,133298
98428,68050
505005,244806
37341,27068
1025577,1029167
945745,999468
210093,179073
212718,181273
470522,737360
7501,48490
505289,570585
2032606,1884198
1069654,924002
2838381,3129743
133646,137182
609485,569610
5370,18058
253779,232749
63253,89266
104948,108652
882351,809780
24637,941
155723,123735
64817,88605
106594,60800
279975,193619
226465,207768
328848,355041
124183,107342
816800,797013
100878,72622
190755,139962
24672,52647
1641309,1500961
310359,330017
206001,274282
47417,50076
368629,318900
673623,558674
758987,650023
1582431,1516017
396441,466113
181133,217177
487579,485138
194563,213503
1223061,1163971
83384,86856
22808,46233
87125,95958
80515,128335
647283,610870
535465,363258
772400,817531
286326,302695
1486394,1374849
619001,435669
1854971,1901997
1954243,1793279
38272,36322
1122938,930460
301441,294166
192371,165038
46564,83168
102743,101312
1197018,1109017
66739,54980
768398,761949
897069,853500
291097,234324
124942,107684
161294,98428
174181,174181
920345,873721
86011,97990
105446,84737
194076,181084
63461,205446
221133,147009
1728910,1451817
498912,465316
601096,182145
51364,27895
393324,333606
1081819,1051561
146760,51121
99386,90148
474380,485665

2025-01-26 15:55:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:55:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:55:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:55:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:55:45 - snowflake.connector.connection - INFO - closed
2025-01-26 15:55:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:55:45 - root - INFO - SQL:
SELECT "tax_pd", "totrevenue", "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2016
   LIMIT 100;
Results:
tax_pd,totrevenue,totfuncexpns
201506,281124,330710
201412,235819,238967
201506,2552190,2669341
201506,32425648,32098696
201506,320525,351666
201509,71895,88763
201511,324899,254431
201506,2837482,2807835
201506,418695,416577
201506,3588013,3541336
201508,954519,875799
201506,2522077,2424594
201506,213962,195282
201506,441877,465581
201508,297098,303187
201506,8630374,4068797
201506,401595,0
201506,812435,825952
201506,8800916,8804399
201412,222935,222095
201505,227088,198487
201506,14444601,13631662
201506,497791,414382
201506,288044,276583
201506,105620,97393
201505,1284111,641602
201506,1835152,1839043
201412,63799,133204
201412,454367,375392
201412,91105,94542
201506,224728,240526
201508,64428,80427
201506,413658,445372
201511,507249,550897
201506,93946,63512
201506,547229,419381
201506,209016,229679
201510,280108,255848
201507,216013,254466
201506,1798994,1751480
201506,5626,12614
201506,71,59091
201506,3780480,3566181
201506,432724,382554
201502,11784947,11725715
201312,135815,130383
201509,52800,37588
201508,32124,26660
201506,685972,629551
201509,129973,68528
201509,1554893,1471006
201506,120359,137802
201507,288407,248291
201606,448341,523784
201606,241561,239939
201606,254246,246314
201606,488981,500976
201606,110749,237498
201606,3616528,3612680
201606,323944,460823
201606,121076,202241
201606,19216873,19742993
201606,844831,931294
201609,53268,55790
201606,1631969,1543597
201606,149544,151816
201606,5292225,1345468
201606,80738,164288
201512,403099,399965
201605,2775480,2737154
201606,2280475,2204248
201606,2180401,1036111
201606,1004649,1048471
201606,1216653,1303975
201607,605128,691163
201603,165213,141815
201606,429152,296555
201606,114657,186185
201605,26812005,24130681
201606,248058,226483
201608,1164303,1349813
201606,3165282,4348921
201606,98526,178756
201609,554244,531574
201606,115273,119078
201609,118461,103036
201605,15771,0
201606,452171,437574
201606,99733,70758
201606,158926,112974
201608,2797845,2862377
201603,3986674,4059124
201606,248791,244005
201606,390191,159212
201609,34277,62275
201606,194544,84289
201606,629384,627025
201606,479677,494719
201606,1357145,1120765
201606,1168966,1366751

2025-01-26 15:55:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:55:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:55:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:55:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:55:47 - snowflake.connector.connection - INFO - closed
2025-01-26 15:55:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:55:48 - root - INFO - SQL:
SELECT "ein", "totrevenue"
   FROM IRS_990.IRS_990.IRS_990_2017
   ORDER BY "totrevenue" DESC
   LIMIT 100;
Results:
ein,totrevenue
941340523,51065716534
941105628,24251778809
208295721,11695858422
900656139,11297001725
941196203,10193378790
390123480,9680842150
390123480,9587415035
912153073,8907956801
113153422,8438339064
720502505,7216705808
941156365,6965956577
311143265,6440829493
450233470,6326720478
231352685,6286195000
520595110,6046472000
135562308,6043438258
133783732,6011909761
510216586,5953431215
941461312,5859550187
942854057,5619049200
133957095,5317043380
416011702,5152134383
980380092,5128139561
131828429,4931402574
951642394,4895423051
60646973,4807997730
314379427,4789153691
110303001,4780943595
135598093,4708225588
753052953,4658343974
611649250,4629361219
364724966,4620705638
362169147,4581585962
42103580,4458905923
431491162,4381625623
150532082,4369242548
741152597,4282066839
710569421,4236821221
311161086,4226007193
363261413,4103552249
42103594,3961420000
912154267,3938149398
840591617,3805780718
930798039,3757404559
351955872,3721532076
946174066,3705341644
453791176,3621661130
580566256,3589561177
131740114,3583255101
980123241,3557087000
440545275,3539081870
900059117,3535304000
382359234,3509403557
133971298,3507764725
410991680,3487488197
362154936,3452950120
520954463,3414413304
951644600,3319765238
590624458,3316774822
362177139,3244736644
160743209,3231905703
311774905,3231802694
910511770,3229090548
430653611,3185323683
562070036,3133177470
203674498,3126468204
611740292,3046771758
351330472,2877065236
581954432,2874233046
362167817,2833160505
381357020,2830348248
951643307,2793425000
560532129,2786082190
134115686,2785766626
951684089,2760691880
60646652,2709762778
381459362,2705865475
821406555,2686418339
382715520,2682911106
870409820,2681376558
530196605,2676037116
113601529,2668766064
314394942,2643979320
112241326,2634373351
900424876,2621279561
530196605,2618203252
540620889,2586420494
136171197,2583763337
651301877,2577123705
42932021,2564072884
411242261,2538424327
42674079,2526498562
141640868,2520075502
210634501,2495283000
910939479,2492720447
10649794,2490406503
382113393,2481440397
111562701,2467441460
131624096,2450589608
363673599,2437618536

2025-01-26 15:55:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:55:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:55:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:55:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:55:49 - snowflake.connector.connection - INFO - closed
2025-01-26 15:55:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:55:49 - root - INFO - SQL:
SELECT "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2012
   ORDER BY "totfuncexpns" DESC
   LIMIT 100;
Results:
totfuncexpns
37041211778
16443912529
9131545261
8701072466
7244673016
6117763783
5517019377
5344051581
4686679000
4638328477
4520548000
4197626485
4157267513
4069533735
3804792280
3653388442
3620553745
3581388880
3526508318
3512493322
3485031938
3474366437
3460710538
3422010386
3413595379
3112881210
3111526301
3059475524
3035845418
2966657595
2850317675
2837998618
2797927000
2766894614
2757435936
2736880074
2713748836
2698544256
2692888700
2604869229
2592740275
2570609650
2568925946
2518677674
2517198955
2514063483
2496181509
2479293211
2447711613
2437873000
2336248588
2334233360
2324828193
2323983967
2286135000
2274506179
2272350000
2236526717
2214236984
2189725759
2181124931
2173863888
2158297038
2122063387
2098358480
2095286493
2091022623
2060343951
2052587368
2005746734
1979383823
1920411752
1912210407
1910001000
1881550752
1840738438
1834777716
1793910932
1771052414
1751216792
1729488163
1728486881
1694911848
1691468150
1670790109
1667945588
1655312269
1651985387
1651672224
1647183606
1647110438
1612025535
1606064927
1596754493
1585460186
1559944605
1559486335
1542366662
1525529919
1520134146

2025-01-26 15:55:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:55:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:55:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:55:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:55:51 - snowflake.connector.connection - INFO - closed
2025-01-26 15:55:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:55:51 - root - INFO - SQL:
SELECT "ein", "tax_pd"
   FROM IRS_990.IRS_990.IRS_990_2013
   LIMIT 100;
Results:
ein,tax_pd
237244328,201212
522385104,201112
311017154,201212
521135824,201212
237222193,201212
246021385,201205
990213908,201212
716076840,201206
866052021,201211
237122650,201204
436158894,201212
592719781,201009
200946697,201303
561412117,201212
411376272,201209
651300847,201212
460253627,201212
363183692,201212
222842803,201303
636050522,201212
362987519,201206
251559261,201212
316064918,201304
450493921,201212
656088549,201306
990269654,201208
436921041,201202
363489253,201212
776224948,201112
876128290,201209
910853746,201212
521937919,201112
203631134,201212
386090659,201206
300397278,201206
750275625,201209
043821981,201207
630759180,201206
916037678,201305
237373972,201306
341385441,201106
911766944,201212
591986067,201212
346528417,201212
050382356,201212
391848508,201212
721060866,201302
956107034,201207
943048491,201206
237069111,201209
486110616,201212
382319307,201206
486107677,201212
236265518,201212
586055206,201206
486111957,201211
931077620,201209
203109607,201206
231944161,201212
366191936,201212
942375212,201206
522305267,201208
571140642,201212
376044257,201212
130970295,201212
931204757,201212
596134291,201204
920018710,201204
237348596,201306
996046220,201205
133810146,201212
526047277,201212
841103552,201212
593131383,201212
351101396,201206
237104346,201203
481165594,201112
363978082,201212
956049026,201209
562295120,200812
431790141,201306
943039825,201206
550572568,201212
460404634,201210
161353961,201212
237371642,201309
560652336,201306
382896174,201212
132623436,201209
910834167,201209
470789065,201206
753188156,201212
231736288,201205
770645010,201212
251313893,201206
760681919,201212
460434618,201306
592915336,201306
930547601,201209
943172727,201212

2025-01-26 15:55:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:55:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:55:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:55:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:55:53 - snowflake.connector.connection - INFO - closed
2025-01-26 15:55:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:55:53 - root - INFO - SQL:
SELECT "ein", "totrevenue", "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2014
   WHERE "totrevenue" < 0 OR "totfuncexpns" < 0
   LIMIT 100;
Results:
ein,totrevenue,totfuncexpns
956125330,-275593,248343
460593439,-1983,71355
311662841,-27284,95204
951826783,-7453,0
470560336,-5708,0
203524992,-763279,1031441
208484447,-4692,4185
452634394,-271755,2009
640360675,-4651,21142
530069164,-2457601,79012
421176386,-36252,0
570631624,-30438,5900
810594113,-56854,0
743069497,-58817,344290
571075500,-86148,3056
261353085,222245,-31919
203532215,-6550510,2155349
751524706,-88175,0
751529771,-528,14120
460404242,-216848,74635
591646837,-36077,157026
940450791,-15951,68895
590910619,-32033,0
593051579,-182107,23800
463952066,-46469,4039
205115820,-69302,6751
112144505,-62798,1460
390438276,-34541,104756
382267508,-185,0
222255864,-1020,167222
750984861,-211701,0
470717982,-7796,0
237141735,-1212,5576
133732466,-3039,0
363833118,-1899322,1078809
133392387,-60796,44765
146030267,-5219,11801
237091584,-24235,26426
943343089,60,-2900
841009656,-151315,129423
942577738,-37807,0
232149355,-964625,623532
911919708,-28689,3050
760298571,-15472,394013
416036377,-5457,20957
910814189,-28873,8473
940850320,-21450,0
630827490,-552,50
640685564,-5790,7321
953732959,-82704,3930
942760230,-52854,524919
330833706,-404117,308637
146030267,-3040,15063
954526527,-6898626,24147751
203654537,-335083,30444
742309072,-113958,224919
275467925,-1019,0
131740105,-564180,1914
232021978,556495,-101428
116009410,-27162,137663
201569879,-281767,129885
274351821,-29764,0
200681593,-42218,0
590320101,-52298,507125
300023422,-95317,0
611191888,-1599,1737
200038224,-110019,0
860003379,145336,-100901
522266221,-332040,18882
752054018,-871,39333
720686155,-149112,6769
208084551,-8206,0
940850340,-31645,0
43105469,53391554,-4849713
202907894,-141408,65871
350144170,-14414,0
202499420,2990722,-29310
330700485,-185919,0
237273639,-34570,0
161566797,-1075,0
346938115,138268,-326560
920168590,-81780,72390
410672019,-12597,46464
310956326,-276072,1231185
946052335,-445,3758
946096171,-4313,9188
237263694,-28968,50990
237128170,-16310,3666
382913202,-257059,128780
866181471,-378,21614
232345116,-23731,0
943434487,-23214,0
431672233,-121680,2848
251439732,-2604307,2087389
752825223,-145633,79684
311807203,-11664,39823
421446447,-2043,97492
204571122,-33793790,9067616
330821549,-3052549,534435
261252578,-5685,17735

2025-01-26 15:55:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:55:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:55:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:55:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:55:54 - snowflake.connector.connection - INFO - closed
2025-01-26 15:55:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:55:55 - root - INFO - SQL:
SELECT "totrevenue", "totfuncexpns", "tax_pd"
    FROM IRS_990.IRS_990.IRS_990_2015
    LIMIT 100;
Results:
totrevenue,totfuncexpns,tax_pd
79226,10716,201412
69691,46507,201412
565470,594117,201412
919660,876681,201408
196640,197060,201504
287456,272165,201407
1154253,1430994,201412
329502,348482,201412
1061767,670985,201412
744619,636569,201412
612222,575987,201312
82274,427257,201506
306876,290320,201412
94153,133298,201412
98428,68050,201412
505005,244806,201406
37341,27068,201412
1025577,1029167,201412
945745,999468,201412
210093,179073,201412
212718,181273,201407
470522,737360,201412
7501,48490,201406
505289,570585,201406
2032606,1884198,201406
1069654,924002,201506
2838381,3129743,201412
133646,137182,201212
609485,569610,201412
5370,18058,201409
253779,232749,201412
63253,89266,201407
104948,108652,201406
882351,809780,201412
24637,941,201412
155723,123735,201503
64817,88605,201412
106594,60800,201412
279975,193619,201412
226465,207768,201403
328848,355041,201412
124183,107342,201412
816800,797013,201406
100878,72622,201506
190755,139962,201406
24672,52647,201412
1641309,1500961,201412
310359,330017,201412
206001,274282,201404
47417,50076,201412
368629,318900,201406
673623,558674,201412
758987,650023,201412
1582431,1516017,201506
396441,466113,201412
181133,217177,201312
487579,485138,201412
194563,213503,201412
1223061,1163971,201406
83384,86856,201409
22808,46233,201406
87125,95958,201408
80515,128335,201411
647283,610870,201412
535465,363258,201412
772400,817531,201406
286326,302695,201409
1486394,1374849,201505
619001,435669,201412
1854971,1901997,201408
1954243,1793279,201412
38272,36322,201506
1122938,930460,201412
301441,294166,201409
192371,165038,201503
46564,83168,201408
102743,101312,201412
1197018,1109017,201412
66739,54980,201409
768398,761949,201412
897069,853500,201412
291097,234324,201412
124942,107684,201412
161294,98428,201412
174181,174181,201412
920345,873721,201506
86011,97990,201412
105446,84737,201402
194076,181084,201506
63461,205446,201412
221133,147009,201412
1728910,1451817,201312
498912,465316,201504
601096,182145,201412
51364,27895,201412
393324,333606,201407
1081819,1051561,201412
146760,51121,201506
99386,90148,201409
474380,485665,201409

2025-01-26 15:55:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:55:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:55:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:55:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:55:56 - snowflake.connector.connection - INFO - closed
2025-01-26 15:55:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:55:56 - root - INFO - SQL:
SELECT "ein", "totrevenue", "totfuncexpns"
    FROM IRS_990.IRS_990.IRS_990_2016
    WHERE "totrevenue" IS NOT NULL AND "totfuncexpns" IS NOT NULL
    LIMIT 100;
Results:
ein,totrevenue,totfuncexpns
382032501,281124,330710
263010938,235819,238967
942746487,2552190,2669341
112889774,32425648,32098696
263416084,320525,351666
270131664,71895,88763
160820608,324899,254431
680475602,2837482,2807835
411631246,418695,416577
470585186,3588013,3541336
202799021,954519,875799
363032700,2522077,2424594
263817958,213962,195282
720485727,441877,465581
943059287,297098,303187
237075704,8630374,4068797
461720815,401595,0
841606735,812435,825952
113237992,8800916,8804399
590876627,222935,222095
202966170,227088,198487
133008074,14444601,13631662
590626226,497791,414382
710916426,288044,276583
746062862,105620,97393
431307672,1284111,641602
720805656,1835152,1839043
721079718,63799,133204
464691123,454367,375392
911230960,91105,94542
463115731,224728,240526
911296139,64428,80427
421132140,413658,445372
10104905,507249,550897
223576391,93946,63512
731383156,547229,419381
742267667,209016,229679
232133293,280108,255848
510178981,216013,254466
460252876,1798994,1751480
237544345,5626,12614
133976090,71,59091
133559130,3780480,3566181
371307763,432724,382554
650321678,11784947,11725715
841408649,135815,130383
131825916,52800,37588
36010565,32124,26660
810471246,685972,629551
593753956,129973,68528
521792074,1554893,1471006
710615370,120359,137802
751806426,288407,248291
942497039,448341,523784
411618333,241561,239939
742383678,254246,246314
943309906,488981,500976
363526646,110749,237498
237155203,3616528,3612680
237043276,323944,460823
620452087,121076,202241
952480624,19216873,19742993
465215702,844831,931294
956131453,53268,55790
20669356,1631969,1543597
226082961,149544,151816
841149609,5292225,1345468
232595475,80738,164288
270232682,403099,399965
363264898,2775480,2737154
930594506,2280475,2204248
592120945,2180401,1036111
310784671,1004649,1048471
581295404,1216653,1303975
743068174,605128,691163
208675368,165213,141815
363586462,429152,296555
364026048,114657,186185
931329158,26812005,24130681
743041358,248058,226483
520891628,1164303,1349813
382959692,3165282,4348921
364412796,98526,178756
311012363,554244,531574
454845389,115273,119078
510238382,118461,103036
311234216,15771,0
741827630,452171,437574
237174336,99733,70758
274167030,158926,112974
860090134,2797845,2862377
390989783,3986674,4059124
310944769,248791,244005
421375644,390191,159212
161102449,34277,62275
541788059,194544,84289
363431222,629384,627025
621660029,479677,494719
861009613,1357145,1120765
430725282,1168966,1366751

2025-01-26 15:55:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:55:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:55:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:55:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 6
2025-01-26 15:55:58 - snowflake.connector.connection - INFO - closed
2025-01-26 15:55:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:55:58 - root - INFO - SQL:
SELECT '2012' AS "Year", COUNT(*) AS "Record_Count"
    FROM IRS_990.IRS_990.IRS_990_2012
    UNION ALL
    SELECT '2013', COUNT(*)
    FROM IRS_990.IRS_990.IRS_990_2013
    UNION ALL
    SELECT '2014', COUNT(*)
    FROM IRS_990.IRS_990.IRS_990_2014
    UNION ALL
    SELECT '2015', COUNT(*)
    FROM IRS_990.IRS_990.IRS_990_2015
    UNION ALL
    SELECT '2016', COUNT(*)
    FROM IRS_990.IRS_990.IRS_990_2016
    UNION ALL
    SELECT '2017', COUNT(*)
    FROM IRS_990.IRS_990.IRS_990_2017;
Results:
Year,Record_Count
2012,294019
2013,289603
2014,299405
2015,294782
2016,307483
2017,300910

2025-01-26 15:55:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:55:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:55:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:55:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:55:59 - snowflake.connector.connection - INFO - closed
2025-01-26 15:56:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:56:00 - root - INFO - SQL:
SELECT DISTINCT "ein"
    FROM IRS_990.IRS_990.IRS_990_2017
    LIMIT 100;
Results:
ein
370947122
461571045
621755294
840752351
731161116
452739722
41032811
943320293
631130709
232200495
113289644
273315236
232745935
731619985
41729080
204530754
421321802
366148078
680317456
260886401
237060038
237193419
430653311
311009270
261117549
550171648
350340035
416079427
416025126
10018923
510195404
474225234
236464308
760393661
237306464
436048958
942692163
460418841
264647567
237171916
251405655
340233212
60646770
473124959
43424018
426079037
751661509
810486053
474307235
752805332
363372067
271342162
450914398
850102948
60443433
475519384
451256761
580536060
260510741
470724415
131740515
756022218
541252930
560952340
260624806
593461164
270583447
150579975
951654782
231489899
480646424
870777242
344444246
311310256
264625767
231353340
112876688
473245305
232088189
223317754
460606366
237204876
426061348
50258888
474103808
941212141
381052830
251155608
222147463
232013068
237181129
956050121
910647440
270049012
251381800
742329384
581028915
131624065
131825916
131740468

2025-01-26 15:56:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:56:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:56:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:56:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 15:56:01 - snowflake.connector.connection - INFO - closed
2025-01-26 15:56:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:56:01 - root - INFO - SQL:
SELECT "ein", "totrevenue", "totfuncexpns"
    FROM IRS_990.IRS_990.IRS_990_2012
    WHERE "totrevenue" > "totfuncexpns"
    LIMIT 100;
Results:
ein,totrevenue,totfuncexpns
436573653,229881,168906
237216299,138871,90456
636148130,288001,50882
430797972,323399,0
946435946,247128,130374
066034315,67755,19183
046033783,102778,95036
046192657,147961,129036
203253993,25216,16101
236769238,97086,29370
346631885,287928,90289
026012755,106662,97225
556097705,5745,3464
846016069,394488,250924
386041332,1092237,367982
367073513,177213,56292
376087588,61274,35099
366060578,31306,24337
226281670,139578,113026
746047007,40025,36920
640882596,12884,5775
740759040,117998,38132
066056634,171086,34156
226123267,139012,113254
136144570,213205,26201
596750976,27470,12671
566038362,85588,57819
204751145,336254,6410
746050350,121490,63207
616232334,67900,25768
470676013,14050,8120
352092866,66981,37090
341405580,58601,42265
236725090,92854,81128
251267387,67424,33323
272760078,220070,25754
256859412,39191,21985
550779671,133131,30816
232862545,137345,82318
746363179,34447,16422
436908806,26939,22810
416025817,22709,22363
680252546,78806,70532
221406741,197336,52973
387018886,21829,2630
066063718,11209,10062
752760800,16655,7923
363911981,111415,0
611258444,21324,18266
621664812,39530,7491
616027697,36310,6463
756082891,19787,13718
710671700,47634,40346
746228363,11606,5590
742652030,50545,26567
546356752,109978,26945
951661066,49487,45769
046033826,22545,16484
356609838,160863,99240
576067739,13039,11392
166232131,30103,8432
010320500,18758,18435
236629638,168545,32804
846180066,26158,17996
756348887,25002,4823
026013525,31426,27625
756012243,97086,25728
570387430,36246,25879
756208263,47746,27440
481200003,52683,37211
586037761,135806,60095
636055790,23682,17462
386243829,95774,54981
756009928,137163,68232
746420722,34387,16145
256051490,113239,36119
510235093,104192,30097
746031870,9539,2100
752566906,23590,13100
046027355,98858,25736
136122177,94989,52512
030183365,72153,30176
546038161,84288,43742
150579975,43416,30590
066221206,7684,7365
556014991,38530,3806
586062618,251605,28445
586037595,97890,6860
756009138,40178,13032
570692399,42757,12778
041647690,12602966,4349414
366066772,234563674,182283744
540580175,1957213,1892238
621120233,13820836,11177652
060628242,79530,75511
980459574,540125,369178
660470314,375876,149760
716057734,92605,52215
980459574,388486,224605
990040331,160600,154818

2025-01-26 15:56:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:56:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:56:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:56:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-26 15:56:03 - snowflake.connector.connection - INFO - closed
2025-01-26 15:56:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:56:03 - root - INFO - SQL:
SELECT
      MAX("totrevenue") AS "Max_Total_Revenue",
      MIN("totrevenue") AS "Min_Total_Revenue",
      MAX("totfuncexpns") AS "Max_Total_Expenses",
      MIN("totfuncexpns") AS "Min_Total_Expenses"
    FROM IRS_990.IRS_990.IRS_990_2013;
Results:
Max_Total_Revenue,Min_Total_Revenue,Max_Total_Expenses,Min_Total_Expenses
40148558254,-218265025,39582829686,-59804875

2025-01-26 15:56:03 - root - INFO - itercount: 0
2025-01-26 15:56:03 - root - INFO - Database Name: IRS_990
Schema Name: IRS_990
DDL describes table information.
,0
table_name,IRS_990_2012
description,
DDL,"create or replace TABLE IRS_990_2012 (
	""ein"" VARCHAR(16777216),
	""tax_pd"" VARCHAR(16777216),
	""subseccd"" VARCHAR(16777216),
	""unrelbusinccd"" VARCHAR(16777216),
	""initiationfees"" NUMBER(38,0),
	""grsrcptspublicuse"" NUMBER(38,0),
	""grsincmembers"" NUMBER(38,0),
	""grsincother"" NUMBER(38,0),
	""totcntrbgfts"" NUMBER(38,0),
	""totprgmrevnue"" NUMBER(38,0),
	""invstmntinc"" NUMBER(38,0),
	""txexmptbndsproceeds"" NUMBER(38,0),
	""royaltsinc"" NUMBER(38,0),
	""grsrntsreal"" NUMBER(38,0),
	""grsrntsprsnl"" NUMBER(38,0),
	""rntlexpnsreal"" NUMBER(38,0),
	""rntlexpnsprsnl"" NUMBER(38,0),
	""rntlincreal"" NUMBER(38,0),
	""rntlincprsnl"" NUMBER(38,0),
	""netrntlinc"" NUMBER(38,0),
	""grsalesecur"" NUMBER(38,0),
	""grsalesothr"" NUMBER(38,0),
	""cstbasisecur"" NUMBER(38,0),
	""cstbasisothr"" NUMBER(38,0),
	""gnlsecur"" NUMBER(38,0),
	""gnlsothr"" NUMBER(38,0),
	""netgnls"" NUMBER(38,0),
	""grsincfndrsng"" NUMBER(38,0),
	""lessdirfndrsng"" NUMBER(38,0),
	""netincfndrsng"" NUMBER(38,0),
	""grsincgaming"" NUMBER(38,0),
	""lessdirgaming"" NUMBER(38,0),
	""netincgaming"" NUMBER(38,0),
	""grsalesinvent"" NUMBER(38,0),
	""lesscstofgoods"" NUMBER(38,0),
	""netincsales"" NUMBER(38,0),
	""miscrevtot11e"" NUMBER(38,0),
	""totrevenue"" NUMBER(38,0),
	""compnsatncurrofcr"" NUMBER(38,0),
	""othrsalwages"" NUMBER(38,0),
	""payrolltx"" NUMBER(38,0),
	""profndraising"" NUMBER(38,0),
	""totfuncexpns"" NUMBER(38,0),
	""totassetsend"" NUMBER(38,0),
	""txexmptbndsend"" NUMBER(38,0),
	""secrdmrtgsend"" NUMBER(38,0),
	""unsecurednotesend"" NUMBER(38,0),
	""totliabend"" NUMBER(38,0),
	""retainedearnend"" NUMBER(38,0),
	""totnetassetend"" NUMBER(38,0),
	""nonpfrea"" VARCHAR(16777216),
	""gftgrntsrcvd170"" NUMBER(38,0),
	""txrevnuelevied170"" NUMBER(38,0),
	""srvcsval170"" NUMBER(38,0),
	""grsinc170"" NUMBER(38,0),
	""grsrcptsrelated170"" NUMBER(38,0),
	""totgftgrntrcvd509"" NUMBER(38,0),
	""grsrcptsadmissn509"" NUMBER(38,0),
	""txrevnuelevied509"" NUMBER(38,0),
	""srvcsval509"" NUMBER(38,0),
	""subtotsuppinc509"" NUMBER(38,0),
	""totsupp509"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['IRS_990_2012', 'IRS_990_2016', 'IRS_990_2013', 'IRS_990_2014', 'IRS_990_2017', 'IRS_990_2015']
,1
table_name,IRS_990_EZ_2015
description,
DDL,"create or replace TABLE IRS_990_EZ_2015 (
	""ein"" VARCHAR(16777216),
	""elf"" VARCHAR(16777216),
	""tax_pd"" NUMBER(38,0),
	""subseccd"" NUMBER(38,0),
	""totcntrbs"" NUMBER(38,0),
	""prgmservrev"" NUMBER(38,0),
	""duesassesmnts"" NUMBER(38,0),
	""othrinvstinc"" NUMBER(38,0),
	""grsamtsalesastothr"" NUMBER(38,0),
	""basisalesexpnsothr"" NUMBER(38,0),
	""gnsaleofastothr"" NUMBER(38,0),
	""grsincgaming"" NUMBER(38,0),
	""grsrevnuefndrsng"" NUMBER(38,0),
	""direxpns"" NUMBER(38,0),
	""netincfndrsng"" NUMBER(38,0),
	""grsalesminusret"" NUMBER(38,0),
	""costgoodsold"" NUMBER(38,0),
	""grsprft"" NUMBER(38,0),
	""othrevnue"" NUMBER(38,0),
	""totrevnue"" NUMBER(38,0),
	""totexpns"" NUMBER(38,0),
	""totexcessyr"" NUMBER(38,0),
	""othrchgsnetassetfnd"" NUMBER(38,0),
	""networthend"" NUMBER(38,0),
	""totassetsend"" NUMBER(38,0),
	""totliabend"" NUMBER(38,0),
	""totnetassetsend"" NUMBER(38,0),
	""actvtynotprevrptcd"" VARCHAR(16777216),
	""chngsinorgcd"" VARCHAR(16777216),
	""unrelbusincd"" VARCHAR(16777216),
	""filedf990tcd"" VARCHAR(16777216),
	""contractioncd"" VARCHAR(16777216),
	""politicalexpend"" NUMBER(38,0),
	""filedf1120polcd"" VARCHAR(16777216),
	""loanstoofficerscd"" VARCHAR(16777216),
	""loanstoofficers"" NUMBER(38,0),
	""initiationfee"" NUMBER(38,0),
	""grspublicrcpts"" NUMBER(38,0),
	""s4958excessbenefcd"" VARCHAR(16777216),
	""prohibtdtxshltrcd"" VARCHAR(16777216),
	""nonpfrea"" NUMBER(38,0),
	""totnooforgscnt"" NUMBER(38,0),
	""totsupport"" NUMBER(38,0),
	""gftgrntsrcvd170"" NUMBER(38,0),
	""txrevnuelevied170"" NUMBER(38,0),
	""srvcsval170"" NUMBER(38,0),
	""pubsuppsubtot170"" NUMBER(38,0),
	""exceeds2pct170"" NUMBER(38,0),
	""pubsupplesspct170"" NUMBER(38,0),
	""samepubsuppsubtot170"" NUMBER(38,0),
	""grsinc170"" NUMBER(38,0),
	""netincunreltd170"" NUMBER(38,0),
	""othrinc170"" NUMBER(38,0),
	""totsupp170"" NUMBER(38,0),
	""grsrcptsrelated170"" NUMBER(38,0),
	""totgftgrntrcvd509"" NUMBER(38,0),
	""grsrcptsadmissn509"" NUMBER(38,0),
	""grsrcptsactivities509"" NUMBER(38,0),
	""txrevnuelevied509"" NUMBER(38,0),
	""srvcsval509"" NUMBER(38,0),
	""pubsuppsubtot509"" NUMBER(38,0),
	""rcvdfrmdisqualsub509"" NUMBER(38,0),
	""exceeds1pct509"" NUMBER(38,0),
	""subtotpub509"" NUMBER(38,0),
	""pubsupplesub509"" NUMBER(38,0),
	""samepubsuppsubtot509"" NUMBER(38,0),
	""grsinc509"" NUMBER(38,0),
	""unreltxincls511tx509"" NUMBER(38,0),
	""subtotsuppinc509"" NUMBER(38,0),
	""netincunrelatd509"" NUMBER(38,0),
	""othrinc509"" NUMBER(38,0),
	""totsupp509"" NUMBER(38,0)
);"

Some other tables have the similar structure: ['IRS_990_EZ_2015', 'IRS_990_EZ_2013', 'IRS_990_EZ_2016', 'IRS_990_EZ_2012', 'IRS_990_EZ_2017', 'IRS_990_EZ_2014']
,2
table_name,IRS_990_PF_2015
description,
DDL,"create or replace TABLE IRS_990_PF_2015 (
	""ein"" VARCHAR(16777216),
	""elf"" VARCHAR(16777216),
	""tax_prd"" VARCHAR(16777216),
	""eostatus"" VARCHAR(16777216),
	""tax_yr"" NUMBER(38,0),
	""operatingcd"" VARCHAR(16777216),
	""subcd"" VARCHAR(16777216),
	""fairmrktvalamt"" NUMBER(38,0),
	""grscontrgifts"" NUMBER(38,0),
	""schedbind"" VARCHAR(16777216),
	""intrstrvnue"" NUMBER(38,0),
	""dividndsamt"" NUMBER(38,0),
	""grsrents"" NUMBER(38,0),
	""grsslspramt"" NUMBER(38,0),
	""costsold"" NUMBER(38,0),
	""grsprofitbus"" NUMBER(38,0),
	""otherincamt"" NUMBER(38,0),
	""totrcptperbks"" NUMBER(38,0),
	""compofficers"" NUMBER(38,0),
	""pensplemplbenf"" NUMBER(38,0),
	""legalfeesamt"" NUMBER(38,0),
	""accountingfees"" NUMBER(38,0),
	""interestamt"" NUMBER(38,0),
	""depreciationamt"" NUMBER(38,0),
	""occupancyamt"" NUMBER(38,0),
	""travlconfmtngs"" NUMBER(38,0),
	""printingpubl"" NUMBER(38,0),
	""topradmnexpnsa"" NUMBER(38,0),
	""contrpdpbks"" NUMBER(38,0),
	""totexpnspbks"" NUMBER(38,0),
	""excessrcpts"" NUMBER(38,0),
	""totrcptnetinc"" NUMBER(38,0),
	""topradmnexpnsb"" NUMBER(38,0),
	""totexpnsnetinc"" NUMBER(38,0),
	""netinvstinc"" NUMBER(38,0),
	""trcptadjnetinc"" NUMBER(38,0),
	""totexpnsadjnet"" NUMBER(38,0),
	""adjnetinc"" NUMBER(38,0),
	""topradmnexpnsd"" NUMBER(38,0),
	""totexpnsexempt"" NUMBER(38,0),
	""othrcashamt"" NUMBER(38,0),
	""invstgovtoblig"" NUMBER(38,0),
	""invstcorpstk"" NUMBER(38,0),
	""invstcorpbnd"" NUMBER(38,0),
	""totinvstsec"" NUMBER(38,0),
	""mrtgloans"" NUMBER(38,0),
	""othrinvstend"" NUMBER(38,0),
	""othrassetseoy"" NUMBER(38,0),
	""totassetsend"" NUMBER(38,0),
	""mrtgnotespay"" NUMBER(38,0),
	""othrliabltseoy"" NUMBER(38,0),
	""totliabend"" NUMBER(38,0),
	""tfundnworth"" NUMBER(38,0),
	""fairmrktvaleoy"" NUMBER(38,0),
	""totexcapgnls"" NUMBER(38,0),
	""totexcapgn"" NUMBER(38,0),
	""totexcapls"" NUMBER(38,0),
	""invstexcisetx"" NUMBER(38,0),
	""sec4940notxcd"" VARCHAR(16777216),
	""sec4940redtxcd"" VARCHAR(16777216),
	""sect511tx"" NUMBER(38,0),
	""subtitleatx"" NUMBER(38,0),
	""totaxpyr"" NUMBER(38,0),
	""esttaxcr"" NUMBER(38,0),
	""txwithldsrc"" NUMBER(38,0),
	""txpaidf2758"" NUMBER(38,0),
	""erronbkupwthld"" NUMBER(38,0),
	""estpnlty"" NUMBER(38,0),
	""taxdue"" NUMBER(38,0),
	""overpay"" NUMBER(38,0),
	""crelamt"" NUMBER(38,0),
	""infleg"" VARCHAR(16777216),
	""actnotpr"" VARCHAR(16777216),
	""chgnprvrptcd"" VARCHAR(16777216),
	""filedf990tcd"" VARCHAR(16777216),
	""contractncd"" VARCHAR(16777216),
	""furnishcpycd"" VARCHAR(16777216),
	""claimstatcd"" VARCHAR(16777216),
	""cntrbtrstxyrcd"" VARCHAR(16777216),
	""distribdafcd"" VARCHAR(16777216),
	""orgcmplypubcd"" VARCHAR(16777216),
	""filedlf1041ind"" VARCHAR(16777216),
	""propexchcd"" VARCHAR(16777216),
	""brwlndmnycd"" VARCHAR(16777216),
	""furngoodscd"" VARCHAR(16777216),
	""paidcmpncd"" VARCHAR(16777216),
	""transfercd"" VARCHAR(16777216),
	""agremkpaycd"" VARCHAR(16777216),
	""exceptactsind"" VARCHAR(16777216),
	""prioractvcd"" VARCHAR(16777216),
	""undistrinccd"" VARCHAR(16777216),
	""applyprovind"" VARCHAR(16777216),
	""dirindirintcd"" VARCHAR(16777216),
	""excesshldcd"" VARCHAR(16777216),
	""invstjexmptcd"" VARCHAR(16777216),
	""prevjexmptcd"" VARCHAR(16777216),
	""propgndacd"" VARCHAR(16777216),
	""ipubelectcd"" VARCHAR(16777216),
	""grntindivcd"" VARCHAR(16777216),
	""nchrtygrntcd"" VARCHAR(16777216),
	""nreligiouscd"" VARCHAR(16777216),
	""excptransind"" VARCHAR(16777216),
	""rfprsnlbnftind"" VARCHAR(16777216),
	""pyprsnlbnftind"" VARCHAR(16777216),
	""tfairmrktunuse"" NUMBER(38,0),
	""valncharitassets"" NUMBER(38,0),
	""cmpmininvstret"" NUMBER(38,0),
	""distribamt"" NUMBER(38,0),
	""undistribincyr"" NUMBER(38,0),
	""adjnetinccola"" NUMBER(38,0),
	""adjnetinccolb"" NUMBER(38,0),
	""adjnetinccolc"" NUMBER(38,0),
	""adjnetinccold"" NUMBER(38,0),
	""adjnetinctot"" NUMBER(38,0),
	""qlfydistriba"" NUMBER(38,0),
	""qlfydistribb"" NUMBER(38,0),
	""qlfydistribc"" NUMBER(38,0),
	""qlfydistribd"" NUMBER(38,0),
	""qlfydistribtot"" NUMBER(38,0),
	""valassetscola"" NUMBER(38,0),
	""valassetscolb"" NUMBER(38,0),
	""valassetscolc"" NUMBER(38,0),
	""valassetscold"" NUMBER(38,0),
	""valassetstot"" NUMBER(38,0),
	""qlfyasseta"" NUMBER(38,0),
	""qlfyassetb"" NUMBER(38,0),
	""qlfyassetc"" NUMBER(38,0),
	""qlfyassetd"" NUMBER(38,0),
	""qlfyassettot"" NUMBER(38,0),
	""endwmntscola"" NUMBER(38,0),
	""endwmntscolb"" NUMBER(38,0),
	""endwmntscolc"" NUMBER(38,0),
	""endwmntscold"" NUMBER(38,0),
	""endwmntstot"" NUMBER(38,0),
	""totsuprtcola"" NUMBER(38,0),
	""totsuprtcolb"" NUMBER(38,0),
	""totsuprtcolc"" NUMBER(38,0),
	""totsuprtcold"" NUMBER(38,0),
	""totsuprttot"" NUMBER(38,0),
	""pubsuprtcola"" NUMBER(38,0),
	""pubsuprtcolb"" NUMBER(38,0),
	""pubsuprtcolc"" NUMBER(38,0),
	""pubsuprtcold"" NUMBER(38,0),
	""pubsuprttot"" NUMBER(38,0),
	""grsinvstinca"" NUMBER(38,0),
	""grsinvstincb"" NUMBER(38,0),
	""grsinvstincc"" NUMBER(38,0),
	""grsinvstincd"" NUMBER(38,0),
	""grsinvstinctot"" NUMBER(38,0),
	""grntapprvfut"" NUMBER(38,0),
	""progsrvcacold"" NUMBER(38,0),
	""progsrvcacole"" NUMBER(38,0),
	""progsrvcbcold"" NUMBER(38,0),
	""progsrvcbcole"" NUMBER(38,0),
	""progsrvcccold"" NUMBER(38,0),
	""progsrvcccole"" NUMBER(38,0),
	""progsrvcdcold"" NUMBER(38,0),
	""progsrvcdcole"" NUMBER(38,0),
	""progsrvcecold"" NUMBER(38,0),
	""progsrvcecole"" NUMBER(38,0),
	""progsrvcfcold"" NUMBER(38,0),
	""progsrvcfcole"" NUMBER(38,0),
	""progsrvcgcold"" NUMBER(38,0),
	""progsrvcgcole"" NUMBER(38,0),
	""membershpduesd"" NUMBER(38,0),
	""membershpduese"" NUMBER(38,0),
	""intonsvngsd"" NUMBER(38,0),
	""intonsvngse"" NUMBER(38,0),
	""dvdndsintd"" NUMBER(38,0),
	""dvdndsinte"" NUMBER(38,0),
	""trnsfrcashcd"" VARCHAR(16777216),
	""trnsothasstscd"" VARCHAR(16777216),
	""salesasstscd"" VARCHAR(16777216),
	""prchsasstscd"" VARCHAR(16777216),
	""rentlsfacltscd"" VARCHAR(16777216),
	""reimbrsmntscd"" VARCHAR(16777216),
	""loansguarcd"" VARCHAR(16777216),
	""perfservicescd"" VARCHAR(16777216),
	""sharngasstscd"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['IRS_990_PF_2015', 'IRS_990_PF_2016', 'IRS_990_PF_2012', 'IRS_990_PF_2014', 'IRS_990_PF_2013']
,3
table_name,IRS_990_EIN
description,
DDL,"create or replace TABLE IRS_990_EIN (
	""ein"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""ico"" VARCHAR(16777216),
	""street"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""state"" VARCHAR(16777216),
	""zip"" VARCHAR(16777216),
	""group"" NUMBER(38,0),
	""subsection"" NUMBER(38,0),
	""affiliation"" NUMBER(38,0),
	""classification"" NUMBER(38,0),
	""ruling"" NUMBER(38,0),
	""deductibility"" NUMBER(38,0),
	""foundation"" NUMBER(38,0),
	""activity"" NUMBER(38,0),
	""organization"" NUMBER(38,0),
	""status"" NUMBER(38,0),
	""tax_period"" NUMBER(38,0),
	""asset_cd"" NUMBER(38,0),
	""income_cd"" NUMBER(38,0),
	""filing_req_cd"" NUMBER(38,0),
	""pf_filing_req_cd"" NUMBER(38,0),
	""acct_pd"" NUMBER(38,0),
	""asset_amt"" NUMBER(38,0),
	""income_amt"" NUMBER(38,0),
	""revenue_amt"" NUMBER(38,0),
	""ntee_cd"" VARCHAR(16777216),
	""sort_name"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'IRS_990': {'IRS_990': ['IRS_990_2012', 'IRS_990_2013', 'IRS_990_2014', 'IRS_990_2015', 'IRS_990_2016', 'IRS_990_2017', 'IRS_990_EIN', 'IRS_990_EZ_2012', 'IRS_990_EZ_2013', 'IRS_990_EZ_2014', 'IRS_990_EZ_2015', 'IRS_990_EZ_2016', 'IRS_990_EZ_2017', 'IRS_990_PF_2012', 'IRS_990_PF_2013', 'IRS_990_PF_2014', 'IRS_990_PF_2015', 'IRS_990_PF_2016']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Tables:**

  - `"IRS_990_2012"`
  - `"IRS_990_2013"`
  - `"IRS_990_2014"`
  - `"IRS_990_2015"`
  - `"IRS_990_2016"`
  - `"IRS_990_2017"`

- **Columns:**

  - **`"totrevenue"`**: Potential usage - total revenue of each organization; used to calculate the median revenue per year.
  - **`"totfuncexpns"`**: Potential usage - total functional expenses of each organization; used to calculate the median expenses per year.
  - **`"tax_pd"`**: Potential usage - tax period; used to determine the year of the filing.

**Conditions that may be used:**

- **Exclude** organizations filing **EZ** and **PF** forms; only consider standard **IRS 990** forms.
- **Filter** data for the years **2012** to **2017**.
- **Exclude** records where `"totrevenue"` or `"totfuncexpns"` is **NULL** or **negative**.
- **Calculate** the absolute difference between median revenue and median expenses for each year.

---

**SQL Queries:**

1. **View sample total revenue and expenses from the 2012 filings:**

   ```sql
   SELECT "totrevenue", "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2012
   LIMIT 100;
   ```

2. **Check the distinct tax periods in the 2013 filings to understand date formats:**

   ```sql
   SELECT DISTINCT "tax_pd"
   FROM IRS_990.IRS_990.IRS_990_2013
   LIMIT 100;
   ```

3. **Select organizations with non-null revenues and expenses from 2014 filings:**

   ```sql
   SELECT "ein", "totrevenue", "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2014
   WHERE "totrevenue" IS NOT NULL AND "totfuncexpns" IS NOT NULL
   LIMIT 100;
   ```

4. **Retrieve total revenue and functional expenses from the 2015 filings where both are greater than zero:**

   ```sql
   SELECT "totrevenue", "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2015
   WHERE "totrevenue" > 0 AND "totfuncexpns" > 0
   LIMIT 100;
   ```

5. **Inspect the format of the "tax_pd" field in the 2016 filings:**

   ```sql
   SELECT "tax_pd", "totrevenue", "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2016
   LIMIT 100;
   ```

6. **List the top 100 organizations by total revenue in 2017:**

   ```sql
   SELECT "ein", "totrevenue"
   FROM IRS_990.IRS_990.IRS_990_2017
   ORDER BY "totrevenue" DESC
   LIMIT 100;
   ```

7. **Find the distribution of total functional expenses in the 2012 filings:**

   ```sql
   SELECT "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2012
   ORDER BY "totfuncexpns" DESC
   LIMIT 100;
   ```

8. **Select the EIN and tax period from the 2013 filings to understand how organizations are identified:**

   ```sql
   SELECT "ein", "tax_pd"
   FROM IRS_990.IRS_990.IRS_990_2013
   LIMIT 100;
   ```

9. **Check for any negative values in total revenue or expenses in the 2014 filings:**

   ```sql
   SELECT "ein", "totrevenue", "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2014
   WHERE "totrevenue" < 0 OR "totfuncexpns" < 0
   LIMIT 100;
   ```

10. **Select total revenue, functional expenses, and tax period from 2015 filings for further analysis:**

    ```sql
    SELECT "totrevenue", "totfuncexpns", "tax_pd"
    FROM IRS_990.IRS_990.IRS_990_2015
    LIMIT 100;
    ```

11. **Retrieve non-null revenues and expenses from 2016 filings for data quality assessment:**

    ```sql
    SELECT "ein", "totrevenue", "totfuncexpns"
    FROM IRS_990.IRS_990.IRS_990_2016
    WHERE "totrevenue" IS NOT NULL AND "totfuncexpns" IS NOT NULL
    LIMIT 100;
    ```

12. **Identify the count of records in each year's filings to understand data size:**

    ```sql
    SELECT '2012' AS "Year", COUNT(*) AS "Record_Count"
    FROM IRS_990.IRS_990.IRS_990_2012
    UNION ALL
    SELECT '2013', COUNT(*)
    FROM IRS_990.IRS_990.IRS_990_2013
    UNION ALL
    SELECT '2014', COUNT(*)
    FROM IRS_990.IRS_990.IRS_990_2014
    UNION ALL
    SELECT '2015', COUNT(*)
    FROM IRS_990.IRS_990.IRS_990_2015
    UNION ALL
    SELECT '2016', COUNT(*)
    FROM IRS_990.IRS_990.IRS_990_2016
    UNION ALL
    SELECT '2017', COUNT(*)
    FROM IRS_990.IRS_990.IRS_990_2017;
    ```

13. **Extract distinct EINs to check for duplicates in the 2017 filings:**

    ```sql
    SELECT DISTINCT "ein"
    FROM IRS_990.IRS_990.IRS_990_2017
    LIMIT 100;
    ```

14. **Select organizations with total revenue greater than total functional expenses in 2012:**

    ```sql
    SELECT "ein", "totrevenue", "totfuncexpns"
    FROM IRS_990.IRS_990.IRS_990_2012
    WHERE "totrevenue" > "totfuncexpns"
    LIMIT 100;
    ```

15. **Check the maximum and minimum values of total revenue and expenses in 2013 filings:**

    ```sql
    SELECT
      MAX("totrevenue") AS "Max_Total_Revenue",
      MIN("totrevenue") AS "Min_Total_Revenue",
      MAX("totfuncexpns") AS "Max_Total_Expenses",
      MIN("totfuncexpns") AS "Min_Total_Expenses"
    FROM IRS_990.IRS_990.IRS_990_2013;
    ```

---

These queries help in understanding the data structure, the format of important columns, and any data quality issues that may affect the calculation of medians. By exploring the data with these queries, we can prepare to compute the median total revenue and median total functional expenses for each year from 2012 to 2017, ultimately determining the three years with the smallest absolute differences.Query:
SELECT "totrevenue", "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2012
   LIMIT 100;
Answer:
totrevenue,totfuncexpns
615689,411785
123398,32238
339132,311067
184876,207063
194999,297198
208324,212964
110370,107165
294294,297732
252440,284339
231889,187672
816862,815407
374605,389064
2176110,151050
57648,59937
250907,284529
326516,359690
565417,618228
6191901,6218539
1259941,1250365
368550,324536
6263,8214
887518,1001492
554010,497729
1160268,1271154
217092,208543
402615,230297
267402,251667
142654,117215
3985749,4102352
1014987,1021620
214898,160544
132489,160207
404491,391474
6853798,6799007
48737,43220
205291,225232
239009,190988
799303,270969
68693,35754
41147,36410
101615,96660
117983,68471
592366,513896
246612,244557
242673,233804
245441,223841
123757,141771
106452,79804
634918,362207
1193694,1303953
391600,294020
2334422,2485470
247695,216432
162491,172476
4679679,4859870
3711792,3472054
235470,226950
2898551,5896441
153916,169319
527281,620516
1104162,1123922
19557978,17211156
1951296,1873849
4805178,5291470
652855,654718
2125329,1863484
13852889,8561969
1192197,1208690
42612778,42332740
2812483,2529356
160381,284045
1857316,1769797
346849,310173
2727976,3553978
7554730,8188232
774388,755686
11156787,5718623
1250968,1486237
21248493,18429612
493438,421330
24018285,25819923
24409280,22917045
2730287,2323595
22424056,18408798
10006131,4267681
2221319,3254942
105775719,117647554
19299093,19402388
17980075,11696894
70036549,64883363
33508177,9120070
3183041,3410875
2788432,2870740
205587007,231386633
997037763,852695208
2783164,3971812
49034556,43567769
694874,635558
21623111,12041922
2458179,3641992
Query:
SELECT DISTINCT "tax_pd"
   FROM IRS_990.IRS_990.IRS_990_2013
   LIMIT 100;
Answer:
tax_pd
201211
201204
201304
201306
201203
201210
201301
201012
201109
201105
201010
201108
201102
201107
201101
201004
201003
201011
200902
200910
200905
201303
201104
201007
200904
200907
200801
201112
201205
201009
201202
201305
200812
201110
201005
201008
201307
201308
200906
200901
200806
201212
201209
201106
201310
201201
201006
201111
201103
200909
200903
200808
200112
201311
201206
201208
201207
201302
201309
200912
200908
201002
200911
200810
200712
201001
Query:
SELECT "ein", "totrevenue", "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2014
   WHERE "totrevenue" IS NOT NULL AND "totfuncexpns" IS NOT NULL
   LIMIT 100;
Answer:
ein,totrevenue,totfuncexpns
953771529,20694,19468
420309398,236657,301343
236390504,19819,26396
840633742,655125,578163
593773427,847870,826451
222570855,712182,712459
237424858,366711,353922
370287741,3447721,2909079
363189150,2621632,1366326
411557904,2871588,2928131
203045114,1015877,1001174
141658870,863595,530667
46292891,51218,153153
232134479,1185460,1172599
316032186,6830751,6142934
232196098,411892,506446
222701258,117976,109535
541994706,16330,25661
820445263,527676,508423
521813311,3996068,3814139
222453223,31462,15677
460560244,110869,75381
546052315,196609,192972
450310153,4856006,4435095
362170128,646143,882350
581510455,55653,54446
340733165,36255767,37918684
621833867,13401,42833
453947399,2497066,1966300
930955296,592497,579233
592029480,526551,542168
41699540,7598454,7415237
453781713,688824,695361
562129912,592390,548554
270607089,1899805,1721268
237154063,5275560,5094916
450418966,29024,4300
541682144,1430082,1180962
611328603,10618,12506
570314423,9344697,11265328
450489921,150016,225798
426018990,160825,162894
274629198,177716,173485
133564301,0,5280
66011964,355783,341269
263876220,200313,196189
134324477,84804,318702
330995500,988630,258610
363503578,299418,164213
580958641,721665,649140
371200920,27944,19206
432008066,375326,263299
200293876,213389,214720
222850706,205349,108411
42600042,7323005,7706633
133860474,504245,473816
222923921,2893102,2718660
582339007,469484,436588
452549443,460476,713786
251225480,309001,155099
530027063,447640,439713
561878125,27065,49924
210390650,631519,656660
620855416,156588,134766
743236898,559483,141491
112300840,8659447,8527621
43015339,10947718,10717634
650927702,1436783,1036703
331148100,73239,66127
541621932,2415779,2634196
521295844,601371,740935
274348285,135726,122830
237149667,90930,63194
311626159,8888752,9015272
631233068,439578,315975
770273199,466928,481516
362615996,11389699,11169785
521219436,8312329,6808366
954383228,609859,516240
951643324,20097194,17307341
113218155,1079509,1091845
841479819,1600525,1127166
760657114,64356,87744
886082809,9233,8946
860040446,120116,123827
420680411,21760972,20973199
133030322,1327524,1299522
205839315,104555,100085
450375763,134958,15702
421385723,1372261,157833
366919591,684340,373909
860127380,61713,0
383872234,0,157
521959441,152717,173234
521853211,138876,157099
222229995,2295981,2056378
271454515,194497,193369
820291797,244112,323411
383407798,1200,5900
581340880,571539,543849
Query:
SELECT "totrevenue", "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2015
   WHERE "totrevenue" > 0 AND "totfuncexpns" > 0
   LIMIT 100;
Answer:
totrevenue,totfuncexpns
79226,10716
69691,46507
565470,594117
919660,876681
196640,197060
287456,272165
1154253,1430994
329502,348482
1061767,670985
744619,636569
612222,575987
82274,427257
306876,290320
94153,133298
98428,68050
505005,244806
37341,27068
1025577,1029167
945745,999468
210093,179073
212718,181273
470522,737360
7501,48490
505289,570585
2032606,1884198
1069654,924002
2838381,3129743
133646,137182
609485,569610
5370,18058
253779,232749
63253,89266
104948,108652
882351,809780
24637,941
155723,123735
64817,88605
106594,60800
279975,193619
226465,207768
328848,355041
124183,107342
816800,797013
100878,72622
190755,139962
24672,52647
1641309,1500961
310359,330017
206001,274282
47417,50076
368629,318900
673623,558674
758987,650023
1582431,1516017
396441,466113
181133,217177
487579,485138
194563,213503
1223061,1163971
83384,86856
22808,46233
87125,95958
80515,128335
647283,610870
535465,363258
772400,817531
286326,302695
1486394,1374849
619001,435669
1854971,1901997
1954243,1793279
38272,36322
1122938,930460
301441,294166
192371,165038
46564,83168
102743,101312
1197018,1109017
66739,54980
768398,761949
897069,853500
291097,234324
124942,107684
161294,98428
174181,174181
920345,873721
86011,97990
105446,84737
194076,181084
63461,205446
221133,147009
1728910,1451817
498912,465316
601096,182145
51364,27895
393324,333606
1081819,1051561
146760,51121
99386,90148
474380,485665
Query:
SELECT "tax_pd", "totrevenue", "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2016
   LIMIT 100;
Answer:
tax_pd,totrevenue,totfuncexpns
201506,281124,330710
201412,235819,238967
201506,2552190,2669341
201506,32425648,32098696
201506,320525,351666
201509,71895,88763
201511,324899,254431
201506,2837482,2807835
201506,418695,416577
201506,3588013,3541336
201508,954519,875799
201506,2522077,2424594
201506,213962,195282
201506,441877,465581
201508,297098,303187
201506,8630374,4068797
201506,401595,0
201506,812435,825952
201506,8800916,8804399
201412,222935,222095
201505,227088,198487
201506,14444601,13631662
201506,497791,414382
201506,288044,276583
201506,105620,97393
201505,1284111,641602
201506,1835152,1839043
201412,63799,133204
201412,454367,375392
201412,91105,94542
201506,224728,240526
201508,64428,80427
201506,413658,445372
201511,507249,550897
201506,93946,63512
201506,547229,419381
201506,209016,229679
201510,280108,255848
201507,216013,254466
201506,1798994,1751480
201506,5626,12614
201506,71,59091
201506,3780480,3566181
201506,432724,382554
201502,11784947,11725715
201312,135815,130383
201509,52800,37588
201508,32124,26660
201506,685972,629551
201509,129973,68528
201509,1554893,1471006
201506,120359,137802
201507,288407,248291
201606,448341,523784
201606,241561,239939
201606,254246,246314
201606,488981,500976
201606,110749,237498
201606,3616528,3612680
201606,323944,460823
201606,121076,202241
201606,19216873,19742993
201606,844831,931294
201609,53268,55790
201606,1631969,1543597
201606,149544,151816
201606,5292225,1345468
201606,80738,164288
201512,403099,399965
201605,2775480,2737154
201606,2280475,2204248
201606,2180401,1036111
201606,1004649,1048471
201606,1216653,1303975
201607,605128,691163
201603,165213,141815
201606,429152,296555
201606,114657,186185
201605,26812005,24130681
201606,248058,226483
201608,1164303,1349813
201606,3165282,4348921
201606,98526,178756
201609,554244,531574
201606,115273,119078
201609,118461,103036
201605,15771,0
201606,452171,437574
201606,99733,70758
201606,158926,112974
201608,2797845,2862377
201603,3986674,4059124
201606,248791,244005
201606,390191,159212
201609,34277,62275
201606,194544,84289
201606,629384,627025
201606,479677,494719
201606,1357145,1120765
201606,1168966,1366751
Query:
SELECT "ein", "totrevenue"
   FROM IRS_990.IRS_990.IRS_990_2017
   ORDER BY "totrevenue" DESC
   LIMIT 100;
Answer:
ein,totrevenue
941340523,51065716534
941105628,24251778809
208295721,11695858422
900656139,11297001725
941196203,10193378790
390123480,9680842150
390123480,9587415035
912153073,8907956801
113153422,8438339064
720502505,7216705808
941156365,6965956577
311143265,6440829493
450233470,6326720478
231352685,6286195000
520595110,6046472000
135562308,6043438258
133783732,6011909761
510216586,5953431215
941461312,5859550187
942854057,5619049200
133957095,5317043380
416011702,5152134383
980380092,5128139561
131828429,4931402574
951642394,4895423051
60646973,4807997730
314379427,4789153691
110303001,4780943595
135598093,4708225588
753052953,4658343974
611649250,4629361219
364724966,4620705638
362169147,4581585962
42103580,4458905923
431491162,4381625623
150532082,4369242548
741152597,4282066839
710569421,4236821221
311161086,4226007193
363261413,4103552249
42103594,3961420000
912154267,3938149398
840591617,3805780718
930798039,3757404559
351955872,3721532076
946174066,3705341644
453791176,3621661130
580566256,3589561177
131740114,3583255101
980123241,3557087000
440545275,3539081870
900059117,3535304000
382359234,3509403557
133971298,3507764725
410991680,3487488197
362154936,3452950120
520954463,3414413304
951644600,3319765238
590624458,3316774822
362177139,3244736644
160743209,3231905703
311774905,3231802694
910511770,3229090548
430653611,3185323683
562070036,3133177470
203674498,3126468204
611740292,3046771758
351330472,2877065236
581954432,2874233046
362167817,2833160505
381357020,2830348248
951643307,2793425000
560532129,2786082190
134115686,2785766626
951684089,2760691880
60646652,2709762778
381459362,2705865475
821406555,2686418339
382715520,2682911106
870409820,2681376558
530196605,2676037116
113601529,2668766064
314394942,2643979320
112241326,2634373351
900424876,2621279561
530196605,2618203252
540620889,2586420494
136171197,2583763337
651301877,2577123705
42932021,2564072884
411242261,2538424327
42674079,2526498562
141640868,2520075502
210634501,2495283000
910939479,2492720447
10649794,2490406503
382113393,2481440397
111562701,2467441460
131624096,2450589608
363673599,2437618536
Query:
SELECT "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2012
   ORDER BY "totfuncexpns" DESC
   LIMIT 100;
Answer:
totfuncexpns
37041211778
16443912529
9131545261
8701072466
7244673016
6117763783
5517019377
5344051581
4686679000
4638328477
4520548000
4197626485
4157267513
4069533735
3804792280
3653388442
3620553745
3581388880
3526508318
3512493322
3485031938
3474366437
3460710538
3422010386
3413595379
3112881210
3111526301
3059475524
3035845418
2966657595
2850317675
2837998618
2797927000
2766894614
2757435936
2736880074
2713748836
2698544256
2692888700
2604869229
2592740275
2570609650
2568925946
2518677674
2517198955
2514063483
2496181509
2479293211
2447711613
2437873000
2336248588
2334233360
2324828193
2323983967
2286135000
2274506179
2272350000
2236526717
2214236984
2189725759
2181124931
2173863888
2158297038
2122063387
2098358480
2095286493
2091022623
2060343951
2052587368
2005746734
1979383823
1920411752
1912210407
1910001000
1881550752
1840738438
1834777716
1793910932
1771052414
1751216792
1729488163
1728486881
1694911848
1691468150
1670790109
1667945588
1655312269
1651985387
1651672224
1647183606
1647110438
1612025535
1606064927
1596754493
1585460186
1559944605
1559486335
1542366662
1525529919
1520134146
Query:
SELECT "ein", "tax_pd"
   FROM IRS_990.IRS_990.IRS_990_2013
   LIMIT 100;
Answer:
ein,tax_pd
237244328,201212
522385104,201112
311017154,201212
521135824,201212
237222193,201212
246021385,201205
990213908,201212
716076840,201206
866052021,201211
237122650,201204
436158894,201212
592719781,201009
200946697,201303
561412117,201212
411376272,201209
651300847,201212
460253627,201212
363183692,201212
222842803,201303
636050522,201212
362987519,201206
251559261,201212
316064918,201304
450493921,201212
656088549,201306
990269654,201208
436921041,201202
363489253,201212
776224948,201112
876128290,201209
910853746,201212
521937919,201112
203631134,201212
386090659,201206
300397278,201206
750275625,201209
043821981,201207
630759180,201206
916037678,201305
237373972,201306
341385441,201106
911766944,201212
591986067,201212
346528417,201212
050382356,201212
391848508,201212
721060866,201302
956107034,201207
943048491,201206
237069111,201209
486110616,201212
382319307,201206
486107677,201212
236265518,201212
586055206,201206
486111957,201211
931077620,201209
203109607,201206
231944161,201212
366191936,201212
942375212,201206
522305267,201208
571140642,201212
376044257,201212
130970295,201212
931204757,201212
596134291,201204
920018710,201204
237348596,201306
996046220,201205
133810146,201212
526047277,201212
841103552,201212
593131383,201212
351101396,201206
237104346,201203
481165594,201112
363978082,201212
956049026,201209
562295120,200812
431790141,201306
943039825,201206
550572568,201212
460404634,201210
161353961,201212
237371642,201309
560652336,201306
382896174,201212
132623436,201209
910834167,201209
470789065,201206
753188156,201212
231736288,201205
770645010,201212
251313893,201206
760681919,201212
460434618,201306
592915336,201306
930547601,201209
943172727,201212
Query:
SELECT "ein", "totrevenue", "totfuncexpns"
   FROM IRS_990.IRS_990.IRS_990_2014
   WHERE "totrevenue" < 0 OR "totfuncexpns" < 0
   LIMIT 100;
Answer:
ein,totrevenue,totfuncexpns
956125330,-275593,248343
460593439,-1983,71355
311662841,-27284,95204
951826783,-7453,0
470560336,-5708,0
203524992,-763279,1031441
208484447,-4692,4185
452634394,-271755,2009
640360675,-4651,21142
530069164,-2457601,79012
421176386,-36252,0
570631624,-30438,5900
810594113,-56854,0
743069497,-58817,344290
571075500,-86148,3056
261353085,222245,-31919
203532215,-6550510,2155349
751524706,-88175,0
751529771,-528,14120
460404242,-216848,74635
591646837,-36077,157026
940450791,-15951,68895
590910619,-32033,0
593051579,-182107,23800
463952066,-46469,4039
205115820,-69302,6751
112144505,-62798,1460
390438276,-34541,104756
382267508,-185,0
222255864,-1020,167222
750984861,-211701,0
470717982,-7796,0
237141735,-1212,5576
133732466,-3039,0
363833118,-1899322,1078809
133392387,-60796,44765
146030267,-5219,11801
237091584,-24235,26426
943343089,60,-2900
841009656,-151315,129423
942577738,-37807,0
232149355,-964625,623532
911919708,-28689,3050
760298571,-15472,394013
416036377,-5457,20957
910814189,-28873,8473
940850320,-21450,0
630827490,-552,50
640685564,-5790,7321
953732959,-82704,3930
942760230,-52854,524919
330833706,-404117,308637
146030267,-3040,15063
954526527,-6898626,24147751
203654537,-335083,30444
742309072,-113958,224919
275467925,-1019,0
131740105,-564180,1914
232021978,556495,-101428
116009410,-27162,137663
201569879,-281767,129885
274351821,-29764,0
200681593,-42218,0
590320101,-52298,507125
300023422,-95317,0
611191888,-1599,1737
200038224,-110019,0
860003379,145336,-100901
522266221,-332040,18882
752054018,-871,39333
720686155,-149112,6769
208084551,-8206,0
940850340,-31645,0
43105469,53391554,-4849713
202907894,-141408,65871
350144170,-14414,0
202499420,2990722,-29310
330700485,-185919,0
237273639,-34570,0
161566797,-1075,0
346938115,138268,-326560
920168590,-81780,72390
410672019,-12597,46464
310956326,-276072,1231185
946052335,-445,3758
946096171,-4313,9188
237263694,-28968,50990
237128170,-16310,3666
382913202,-257059,128780
866181471,-378,21614
232345116,-23731,0
943434487,-23214,0
431672233,-121680,2848
251439732,-2604307,2087389
752825223,-145633,79684
311807203,-11664,39823
421446447,-2043,97492
204571122,-33793790,9067616
330821549,-3052549,534435
261252578,-5685,17735
Query:
SELECT "totrevenue", "totfuncexpns", "tax_pd"
    FROM IRS_990.IRS_990.IRS_990_2015
    LIMIT 100;
Answer:
totrevenue,totfuncexpns,tax_pd
79226,10716,201412
69691,46507,201412
565470,594117,201412
919660,876681,201408
196640,197060,201504
287456,272165,201407
1154253,1430994,201412
329502,348482,201412
1061767,670985,201412
744619,636569,201412
612222,575987,201312
82274,427257,201506
306876,290320,201412
94153,133298,201412
98428,68050,201412
505005,244806,201406
37341,27068,201412
1025577,1029167,201412
945745,999468,201412
210093,179073,201412
212718,181273,201407
470522,737360,201412
7501,48490,201406
505289,570585,201406
2032606,1884198,201406
1069654,924002,201506
2838381,3129743,201412
133646,137182,201212
609485,569610,201412
5370,18058,201409
253779,232749,201412
63253,89266,201407
104948,108652,201406
882351,809780,201412
24637,941,201412
155723,123735,201503
64817,88605,201412
106594,60800,201412
279975,193619,201412
226465,207768,201403
328848,355041,201412
124183,107342,201412
816800,797013,201406
100878,72622,201506
190755,139962,201406
24672,52647,201412
1641309,1500961,201412
310359,330017,201412
206001,274282,201404
47417,50076,201412
368629,318900,201406
673623,558674,201412
758987,650023,201412
1582431,1516017,201506
396441,466113,201412
181133,217177,201312
487579,485138,201412
194563,213503,201412
1223061,1163971,201406
83384,86856,201409
22808,46233,201406
87125,95958,201408
80515,128335,201411
647283,610870,201412
535465,363258,201412
772400,817531,201406
286326,302695,201409
1486394,1374849,201505
619001,435669,201412
1854971,1901997,201408
1954243,1793279,201412
38272,36322,201506
1122938,930460,201412
301441,294166,201409
192371,165038,201503
46564,83168,201408
102743,101312,201412
1197018,1109017,201412
66739,54980,201409
768398,761949,201412
897069,853500,201412
291097,234324,201412
124942,107684,201412
161294,98428,201412
174181,174181,201412
920345,873721,201506
86011,97990,201412
105446,84737,201402
194076,181084,201506
63461,205446,201412
221133,147009,201412
1728910,1451817,201312
498912,465316,201504
601096,182145,201412
51364,27895,201412
393324,333606,201407
1081819,1051561,201412
146760,51121,201506
99386,90148,201409
474380,485665,201409
Query:
SELECT "ein", "totrevenue", "totfuncexpns"
    FROM IRS_990.IRS_990.IRS_990_2016
    WHERE "totrevenue" IS NOT NULL AND "totfuncexpns" IS NOT NULL
    LIMIT 100;
Answer:
ein,totrevenue,totfuncexpns
382032501,281124,330710
263010938,235819,238967
942746487,2552190,2669341
112889774,32425648,32098696
263416084,320525,351666
270131664,71895,88763
160820608,324899,254431
680475602,2837482,2807835
411631246,418695,416577
470585186,3588013,3541336
202799021,954519,875799
363032700,2522077,2424594
263817958,213962,195282
720485727,441877,465581
943059287,297098,303187
237075704,8630374,4068797
461720815,401595,0
841606735,812435,825952
113237992,8800916,8804399
590876627,222935,222095
202966170,227088,198487
133008074,14444601,13631662
590626226,497791,414382
710916426,288044,276583
746062862,105620,97393
431307672,1284111,641602
720805656,1835152,1839043
721079718,63799,133204
464691123,454367,375392
911230960,91105,94542
463115731,224728,240526
911296139,64428,80427
421132140,413658,445372
10104905,507249,550897
223576391,93946,63512
731383156,547229,419381
742267667,209016,229679
232133293,280108,255848
510178981,216013,254466
460252876,1798994,1751480
237544345,5626,12614
133976090,71,59091
133559130,3780480,3566181
371307763,432724,382554
650321678,11784947,11725715
841408649,135815,130383
131825916,52800,37588
36010565,32124,26660
810471246,685972,629551
593753956,129973,68528
521792074,1554893,1471006
710615370,120359,137802
751806426,288407,248291
942497039,448341,523784
411618333,241561,239939
742383678,254246,246314
943309906,488981,500976
363526646,110749,237498
237155203,3616528,3612680
237043276,323944,460823
620452087,121076,202241
952480624,19216873,19742993
465215702,844831,931294
956131453,53268,55790
20669356,1631969,1543597
226082961,149544,151816
841149609,5292225,1345468
232595475,80738,164288
270232682,403099,399965
363264898,2775480,2737154
930594506,2280475,2204248
592120945,2180401,1036111
310784671,1004649,1048471
581295404,1216653,1303975
743068174,605128,691163
208675368,165213,141815
363586462,429152,296555
364026048,114657,186185
931329158,26812005,24130681
743041358,248058,226483
520891628,1164303,1349813
382959692,3165282,4348921
364412796,98526,178756
311012363,554244,531574
454845389,115273,119078
510238382,118461,103036
311234216,15771,0
741827630,452171,437574
237174336,99733,70758
274167030,158926,112974
860090134,2797845,2862377
390989783,3986674,4059124
310944769,248791,244005
421375644,390191,159212
161102449,34277,62275
541788059,194544,84289
363431222,629384,627025
621660029,479677,494719
861009613,1357145,1120765
430725282,1168966,1366751
Query:
SELECT '2012' AS "Year", COUNT(*) AS "Record_Count"
    FROM IRS_990.IRS_990.IRS_990_2012
    UNION ALL
    SELECT '2013', COUNT(*)
    FROM IRS_990.IRS_990.IRS_990_2013
    UNION ALL
    SELECT '2014', COUNT(*)
    FROM IRS_990.IRS_990.IRS_990_2014
    UNION ALL
    SELECT '2015', COUNT(*)
    FROM IRS_990.IRS_990.IRS_990_2015
    UNION ALL
    SELECT '2016', COUNT(*)
    FROM IRS_990.IRS_990.IRS_990_2016
    UNION ALL
    SELECT '2017', COUNT(*)
    FROM IRS_990.IRS_990.IRS_990_2017;
Answer:
Year,Record_Count
2012,294019
2013,289603
2014,299405
2015,294782
2016,307483
2017,300910
Query:
SELECT DISTINCT "ein"
    FROM IRS_990.IRS_990.IRS_990_2017
    LIMIT 100;
Answer:
ein
370947122
461571045
621755294
840752351
731161116
452739722
41032811
943320293
631130709
232200495
113289644
273315236
232745935
731619985
41729080
204530754
421321802
366148078
680317456
260886401
237060038
237193419
430653311
311009270
261117549
550171648
350340035
416079427
416025126
10018923
510195404
474225234
236464308
760393661
237306464
436048958
942692163
460418841
264647567
237171916
251405655
340233212
60646770
473124959
43424018
426079037
751661509
810486053
474307235
752805332
363372067
271342162
450914398
850102948
60443433
475519384
451256761
580536060
260510741
470724415
131740515
756022218
541252930
560952340
260624806
593461164
270583447
150579975
951654782
231489899
480646424
870777242
344444246
311310256
264625767
231353340
112876688
473245305
232088189
223317754
460606366
237204876
426061348
50258888
474103808
941212141
381052830
251155608
222147463
232013068
237181129
956050121
910647440
270049012
251381800
742329384
581028915
131624065
131825916
131740468
Query:
SELECT "ein", "totrevenue", "totfuncexpns"
    FROM IRS_990.IRS_990.IRS_990_2012
    WHERE "totrevenue" > "totfuncexpns"
    LIMIT 100;
Answer:
ein,totrevenue,totfuncexpns
436573653,229881,168906
237216299,138871,90456
636148130,288001,50882
430797972,323399,0
946435946,247128,130374
066034315,67755,19183
046033783,102778,95036
046192657,147961,129036
203253993,25216,16101
236769238,97086,29370
346631885,287928,90289
026012755,106662,97225
556097705,5745,3464
846016069,394488,250924
386041332,1092237,367982
367073513,177213,56292
376087588,61274,35099
366060578,31306,24337
226281670,139578,113026
746047007,40025,36920
640882596,12884,5775
740759040,117998,38132
066056634,171086,34156
226123267,139012,113254
136144570,213205,26201
596750976,27470,12671
566038362,85588,57819
204751145,336254,6410
746050350,121490,63207
616232334,67900,25768
470676013,14050,8120
352092866,66981,37090
341405580,58601,42265
236725090,92854,81128
251267387,67424,33323
272760078,220070,25754
256859412,39191,21985
550779671,133131,30816
232862545,137345,82318
746363179,34447,16422
436908806,26939,22810
416025817,22709,22363
680252546,78806,70532
221406741,197336,52973
387018886,21829,2630
066063718,11209,10062
752760800,16655,7923
363911981,111415,0
611258444,21324,18266
621664812,39530,7491
616027697,36310,6463
756082891,19787,13718
710671700,47634,40346
746228363,11606,5590
742652030,50545,26567
546356752,109978,26945
951661066,49487,45769
046033826,22545,16484
356609838,160863,99240
576067739,13039,11392
166232131,30103,8432
010320500,18758,18435
236629638,168545,32804
846180066,26158,17996
756348887,25002,4823
026013525,31426,27625
756012243,97086,25728
570387430,36246,25879
756208263,47746,27440
481200003,52683,37211
586037761,135806,60095
636055790,23682,17462
386243829,95774,54981
756009928,137163,68232
746420722,34387,16145
256051490,113239,36119
510235093,104192,30097
746031870,9539,2100
752566906,23590,13100
046027355,98858,25736
136122177,94989,52512
030183365,72153,30176
546038161,84288,43742
150579975,43416,30590
066221206,7684,7365
556014991,38530,3806
586062618,251605,28445
586037595,97890,6860
756009138,40178,13032
570692399,42757,12778
041647690,12602966,4349414
366066772,234563674,182283744
540580175,1957213,1892238
621120233,13820836,11177652
060628242,79530,75511
980459574,540125,369178
660470314,375876,149760
716057734,92605,52215
980459574,388486,224605
990040331,160600,154818
Query:
SELECT
      MAX("totrevenue") AS "Max_Total_Revenue",
      MIN("totrevenue") AS "Min_Total_Revenue",
      MAX("totfuncexpns") AS "Max_Total_Expenses",
      MIN("totfuncexpns") AS "Min_Total_Expenses"
    FROM IRS_990.IRS_990.IRS_990_2013;
Answer:
Max_Total_Revenue,Min_Total_Revenue,Max_Total_Expenses,Min_Total_Expenses
40148558254,-218265025,39582829686,-59804875
End Exploring Related Columns
Task: Which three years in 2012-2017 have the smallest absolute difference between median revenue and median functional expenses for organizations filing IRS 990 forms? Please output three years and respective differences.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Year,Difference
year1:int,diff1:float>=0
year2:int,diff2:float>=0
year3:int,diff3:float>=0
(Attention: answer in three rows)
```

To determine the three years between 2012 and 2017 with the smallest absolute difference between median revenue and median functional expenses for organizations filing IRS 990 forms, we calculated the absolute difference between the medians of revenue and expenses for each year. The three years with the smallest differences are listed above..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'IRS_990': {'IRS_990': ['IRS_990_2012', 'IRS_990_2013', 'IRS_990_2014', 'IRS_990_2015', 'IRS_990_2016', 'IRS_990_2017', 'IRS_990_EIN', 'IRS_990_EZ_2012', 'IRS_990_EZ_2013', 'IRS_990_EZ_2014', 'IRS_990_EZ_2015', 'IRS_990_EZ_2016', 'IRS_990_EZ_2017', 'IRS_990_PF_2012', 'IRS_990_PF_2013', 'IRS_990_PF_2014', 'IRS_990_PF_2015', 'IRS_990_PF_2016']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-26 15:56:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 15:56:37 - root - INFO - ```sql
SELECT
  "Year",
  ABS(MEDIAN("totrevenue") - MEDIAN("totfuncexpns")) AS "Difference"
FROM (
  SELECT
    '2012' AS "Year",
    "totrevenue",
    "totfuncexpns"
  FROM IRS_990.IRS_990."IRS_990_2012"
  WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

  UNION ALL

  SELECT
    '2013' AS "Year",
    "totrevenue",
    "totfuncexpns"
  FROM IRS_990.IRS_990."IRS_990_2013"
  WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

  UNION ALL

  SELECT
    '2014' AS "Year",
    "totrevenue",
    "totfuncexpns"
  FROM IRS_990.IRS_990."IRS_990_2014"
  WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

  UNION ALL

  SELECT
    '2015' AS "Year",
    "totrevenue",
    "totfuncexpns"
  FROM IRS_990.IRS_990."IRS_990_2015"
  WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

  UNION ALL

  SELECT
    '2016' AS "Year",
    "totrevenue",
    "totfuncexpns"
  FROM IRS_990.IRS_990."IRS_990_2016"
  WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

  UNION ALL

  SELECT
    '2017' AS "Year",
    "totrevenue",
    "totfuncexpns"
  FROM IRS_990.IRS_990."IRS_990_2017"
  WHERE "totrevenue" > 0 AND "totfuncexpns" > 0
) AS AllData
GROUP BY "Year"
ORDER BY "Difference" ASC
LIMIT 3;
```
2025-01-26 15:56:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:56:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:56:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:56:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-26 15:56:39 - snowflake.connector.connection - INFO - closed
2025-01-26 15:56:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:56:39 - root - INFO - itercount: 1
2025-01-26 15:56:39 - root - INFO - 0
2025-01-26 15:56:39 - root - INFO - results: 
Year,Difference
2012,20757.000
2013,21535.000
2017,26879.000


2025-01-26 15:56:39 - root - INFO - Please check the answer again by reviewing Which three years in 2012-2017 have the smallest absolute difference between median revenue and median functional expenses for organizations filing IRS 990 forms? Please output three years and respective differences., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Year,Difference
year1:int,diff1:float>=0
year2:int,diff2:float>=0
year3:int,diff3:float>=0
(Attention: answer in three rows)
```

To determine the three years between 2012 and 2017 with the smallest absolute difference between median revenue and median functional expenses for organizations filing IRS 990 forms, we calculated the absolute difference between the medians of revenue and expenses for each year. The three years with the smallest differences are listed above. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Year,Difference
2012,20757.000
2013,21535.000
2017,26879.000
Current sql:
SELECT
  "Year",
  ABS(MEDIAN("totrevenue") - MEDIAN("totfuncexpns")) AS "Difference"
FROM (
  SELECT
    '2012' AS "Year",
    "totrevenue",
    "totfuncexpns"
  FROM IRS_990.IRS_990."IRS_990_2012"
  WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

  UNION ALL

  SELECT
    '2013' AS "Year",
    "totrevenue",
    "totfuncexpns"
  FROM IRS_990.IRS_990."IRS_990_2013"
  WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

  UNION ALL

  SELECT
    '2014' AS "Year",
    "totrevenue",
    "totfuncexpns"
  FROM IRS_990.IRS_990."IRS_990_2014"
  WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

  UNION ALL

  SELECT
    '2015' AS "Year",
    "totrevenue",
    "totfuncexpns"
  FROM IRS_990.IRS_990."IRS_990_2015"
  WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

  UNION ALL

  SELECT
    '2016' AS "Year",
    "totrevenue",
    "totfuncexpns"
  FROM IRS_990.IRS_990."IRS_990_2016"
  WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

  UNION ALL

  SELECT
    '2017' AS "Year",
    "totrevenue",
    "totfuncexpns"
  FROM IRS_990.IRS_990."IRS_990_2017"
  WHERE "totrevenue" > 0 AND "totfuncexpns" > 0
) AS AllData
GROUP BY "Year"
ORDER BY "Difference" ASC
LIMIT 3;
2025-01-26 15:56:59 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 15:56:59 - root - INFO - ```sql
SELECT
  "Year",
  ROUND(ABS(MEDIAN("totrevenue") - MEDIAN("totfuncexpns")), 4) AS "Difference"
FROM (
  SELECT
    '2012' AS "Year",
    "totrevenue",
    "totfuncexpns"
  FROM IRS_990.IRS_990."IRS_990_2012"
  WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

  UNION ALL

  SELECT
    '2013' AS "Year",
    "totrevenue",
    "totfuncexpns"
  FROM IRS_990.IRS_990."IRS_990_2013"
  WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

  UNION ALL

  SELECT
    '2014' AS "Year",
    "totrevenue",
    "totfuncexpns"
  FROM IRS_990.IRS_990."IRS_990_2014"
  WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

  UNION ALL

  SELECT
    '2015' AS "Year",
    "totrevenue",
    "totfuncexpns"
  FROM IRS_990.IRS_990."IRS_990_2015"
  WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

  UNION ALL

  SELECT
    '2016' AS "Year",
    "totrevenue",
    "totfuncexpns"
  FROM IRS_990.IRS_990."IRS_990_2016"
  WHERE "totrevenue" > 0 AND "totfuncexpns" > 0

  UNION ALL

  SELECT
    '2017' AS "Year",
    "totrevenue",
    "totfuncexpns"
  FROM IRS_990.IRS_990."IRS_990_2017"
  WHERE "totrevenue" > 0 AND "totfuncexpns" > 0
) AS AllData
GROUP BY "Year"
ORDER BY "Difference" ASC
LIMIT 3;
```
2025-01-26 15:56:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 15:56:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 15:56:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 15:57:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-26 15:57:01 - snowflake.connector.connection - INFO - closed
2025-01-26 15:57:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 15:57:01 - root - INFO - itercount: 2
2025-01-26 15:57:01 - root - INFO - 0
2025-01-26 15:57:01 - root - INFO - Total iteration counts: 2
