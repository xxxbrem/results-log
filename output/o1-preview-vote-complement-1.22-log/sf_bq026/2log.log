2025-01-26 04:29:32 - openai._base_client - INFO - Retrying request to /chat/completions in 0.376675 seconds
2025-01-26 04:30:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:30:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:30:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:30:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:30:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:30:35 - snowflake.connector.connection - INFO - closed
2025-01-26 04:30:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:30:35 - root - INFO - SQL:
SELECT t."cpc"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 100;
Results:
Too long, hard cut:
cpc
[]
[]
[]
"[
  {
    ""code"": ""H02M5/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""A01N47/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D521/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""Y02A40/81"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""Y02E30/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""Y10T83/465"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""B26F1/42"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""B22D11/086"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""C07D471/16"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D471/22"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""G01N33/48728"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""C11B5/0064"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/35"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C11B5/0035"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M135/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C09K15/30"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D263/56"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/44"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D235/12"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/3447"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/48"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/46"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D277/64"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/47"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/224"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/102"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/106"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/104"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/10"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/221"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/226"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/225"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/22"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10L1/14"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""E02D5/808"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/385"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/26"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/28"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/54"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
[]
[]
"[
  {
    ""code"": ""C07D213/32"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/51"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/51"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/22"",
    ""first"": true,
    ""inventive"": true,
    ""t

2025-01-26 04:30:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:30:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:30:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:30:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:30:36 - snowflake.connector.connection - INFO - closed
2025-01-26 04:30:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:30:51 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:30:51 - root - INFO - ```sql
SELECT
  t."publication_number",
  cpc_code_f."code" AS "cpc_code",
  SUBSTRING(cpc_code_f."code", 1, 1) AS "cpc_section",
  SUBSTRING(cpc_code_f."code", 2, 2) AS "cpc_class",
  SUBSTRING(cpc_code_f."code", 4, 1) AS "cpc_subclass",
  REGEXP_SUBSTR(cpc_code_f."code", '[0-9]+') AS "cpc_main_group",
  REGEXP_SUBSTR(cpc_code_f."code", '(?<=/)[0-9]+') AS "cpc_subgroup"
FROM
  PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."cpc") AS cpc_f,
  LATERAL (
    SELECT cpc_f.value::VARIANT:"code"::STRING AS "code"
  ) AS cpc_code_f
LIMIT 100;
```

This corrected SQL query:

- **Flattens** the `"cpc"` column, which contains an array of CPC classification objects.
- **Extracts** the `"code"` field from each CPC classification object.
- **Parses** the `"code"` to obtain the CPC section, class, subclass, main group, and subgroup by using string functions and regular expressions.
  - `SUBSTRING` functions extract fixed positions in the code.
  - `REGEXP_SUBSTR` functions extract numeric parts before and after the `/` character.
- **Displays** the results, including the publication number and the parsed CPC classification components.

This query addresses the issue of empty columns by correctly parsing the `"code"` field from the `"cpc"` JSON array and extracting the relevant classification parts.
2025-01-26 04:30:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:30:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:30:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:30:53 - snowflake.connector.connection - INFO - closed
2025-01-26 04:30:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:31:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:31:33 - root - INFO - You're encountering an error with the regular expression in your SQL query because the lookbehind assertion `(?<=/)` is not supported in some SQL dialects, including Snowflake's variant of SQL. To fix this, we can modify the query to extract the subgroup without using lookbehinds.

Below is the corrected SQL query:

```sql
SELECT
  t."publication_number",
  cpc_code_f."code" AS "cpc_code",
  SUBSTRING(cpc_code_f."code", 1, 1) AS "cpc_section",
  SUBSTRING(cpc_code_f."code", 2, 2) AS "cpc_class",
  SUBSTRING(cpc_code_f."code", 4, 1) AS "cpc_subclass",
  REGEXP_SUBSTR(cpc_code_f."code", '[0-9]+') AS "cpc_main_group",
  SPLIT_PART(cpc_code_f."code", '/', 2) AS "cpc_subgroup"
FROM
  PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."cpc") AS cpc_f,
  LATERAL (
    SELECT cpc_f.value::VARIANT:"code"::STRING AS "code"
  ) AS cpc_code_f
LIMIT 100;
```

**Explanation:**

- **Extracting the CPC Code Components:**

  - **"cpc_section":** The first character of the code.
    ```sql
    SUBSTRING(cpc_code_f."code", 1, 1) AS "cpc_section"
    ```
  - **"cpc_class":** The second and third characters of the code.
    ```sql
    SUBSTRING(cpc_code_f."code", 2, 2) AS "cpc_class"
    ```
  - **"cpc_subclass":** The fourth character of the code.
    ```sql
    SUBSTRING(cpc_code_f."code", 4, 1) AS "cpc_subclass"
    ```
  - **"cpc_main_group":** The sequence of digits after the subclass and before the slash `/`.
    ```sql
    REGEXP_SUBSTR(cpc_code_f."code", '[0-9]+') AS "cpc_main_group"
    ```
  - **"cpc_subgroup":** The sequence of digits after the slash `/`.
    ```sql
    SPLIT_PART(cpc_code_f."code", '/', 2) AS "cpc_subgroup"
    ```

- **Why the Error Occurred and How We Fixed It:**

  - The error message indicates that the regular expression `(?<=/)[0-9]+` is invalid because lookbehind assertions like `(?<=/)` are not supported.
  - We replaced the use of lookbehind with the `SPLIT_PART` function to extract the subgroup.
    - `SPLIT_PART(cpc_code_f."code", '/', 2)` splits the code at the slash `/` and returns the second part, which is the subgroup.
  - The `REGEXP_SUBSTR` function is still used to extract the main group by matching the first sequence of digits in the code.

- **Sample Data Transformation:**

  Assuming we have a CPC code like `'A61B5/00'`, the query will extract:
  
  - **"cpc_code":** `'A61B5/00'`
  - **"cpc_section":** `'A'`
  - **"cpc_class":** `'61'`
  - **"cpc_subclass":** `'B'`
  - **"cpc_main_group":** `'5'`
  - **"cpc_subgroup":** `'00'`

**Note:**

- Ensure that the `"cpc"` column in your table contains data in the expected format.
- This query will correctly parse the CPC codes and should not produce empty columns unless the data itself is missing or improperly formatted.
- If you still encounter empty columns after running this query, it may be due to missing or malformed data in the `"cpc"` column of your table.

**Next Steps:**

Now that we have a working query to extract the CPC classification components, you can proceed to use these components to filter patents in the 'A61' category and perform the analysis required for your task.

For example, to filter patents in the 'A61' category:

```sql
SELECT
  t."publication_number",
  assignee_f.value::VARIANT:"name"::STRING AS "assignee_name",
  SUBSTRING(cpc_code_f."code", 1, 1) AS "cpc_section",
  SUBSTRING(cpc_code_f."code", 2, 2) AS "cpc_class",
  SUBSTRING(cpc_code_f."code", 4, 1) AS "cpc_subclass",
  REGEXP_SUBSTR(cpc_code_f."code", '[0-9]+') AS "cpc_main_group",
  SPLIT_PART(cpc_code_f."code", '/', 2) AS "cpc_subgroup",
  SUBSTR(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
  t."country_code"
FROM
  PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."cpc") AS cpc_f,
  LATERAL (
    SELECT cpc_f.value::VARIANT:"code"::STRING AS "code"
  ) AS cpc_code_f,
  LATERAL FLATTEN(input => t."assignee_harmonized") AS assignee_f
WHERE
  SUBSTRING(cpc_code_f."code", 1, 1) = 'A'
  AND SUBSTRING(cpc_code_f."code", 2, 2) = '61'
LIMIT 100;
```

This query will help you identify all patents in the 'A61' category along with their assignees, filing years, and jurisdiction codes, which are necessary to determine:

- The most active assignee in the 'A61' category.
- Their busiest year based on the number of filings.
- The top five jurisdiction codes where they filed the most patents during that year.

**Final Output Format:**

Once you've aggregated the data, present the final results in the following format:

```csv
Jurisdiction_Codes
code1:str,code2:str,code3:str,code4:str,code5:str
(Attention: answer in one row)
```

Remember to separate the jurisdiction codes with commas and ensure that the result is limited to just one row, as per your original task requirements.
2025-01-26 04:31:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:31:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:31:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:31:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:31:34 - snowflake.connector.connection - INFO - closed
2025-01-26 04:31:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:33:02 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:33:02 - root - INFO - SQL:
SELECT
  t."publication_number",
  cpc_code_f."code" AS "cpc_code",
  SUBSTRING(cpc_code_f."code", 1, 1) AS "cpc_section",
  SUBSTRING(cpc_code_f."code", 2, 2) AS "cpc_class",
  SUBSTRING(cpc_code_f."code", 4, 1) AS "cpc_subclass",
  REGEXP_SUBSTR(cpc_code_f."code", '[0-9]+') AS "cpc_main_group",
  SPLIT_PART(cpc_code_f."code", '/', 2) AS "cpc_subgroup"
FROM
  PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."cpc") AS cpc_f,
  LATERAL (
    SELECT cpc_f.value::VARIANT:"code"::STRING AS "code"
  ) AS cpc_code_f
LIMIT 100;
Results:
publication_number,cpc_code,cpc_section,cpc_class,cpc_subclass,cpc_main_group,cpc_subgroup
AU-2011273409-A1,A61P31/04,A,61,P,61,04
AU-2011273409-A1,A61P37/06,A,61,P,61,06
AU-2011273409-A1,A61P33/02,A,61,P,61,02
AU-2011273409-A1,A61P33/00,A,61,P,61,00
AU-2011273409-A1,A61P37/00,A,61,P,61,00
AU-2011273409-A1,A61P35/00,A,61,P,61,00
AU-2011273409-A1,A61P31/12,A,61,P,61,12
AU-2011273409-A1,A61P25/00,A,61,P,61,00
AU-2011273409-A1,A61P25/28,A,61,P,61,28
AU-2011273409-A1,A61P27/02,A,61,P,61,02
AU-2011273409-A1,A61P29/00,A,61,P,61,00
AU-2011273409-A1,C07C233/59,C,07,C,07,59
AU-2011273409-A1,A61P19/04,A,61,P,61,04
AU-2011273409-A1,C07C255/60,C,07,C,07,60
AU-2011273409-A1,A61P11/06,A,61,P,61,06
AU-2011273409-A1,C07D307/30,C,07,D,07,30
AU-2011273409-A1,C07C233/60,C,07,C,07,60
AU-2011273409-A1,C07D307/30,C,07,D,07,30
AU-2011273409-A1,C07C233/59,C,07,C,07,59
AU-2011273409-A1,A61P17/02,A,61,P,61,02
AU-2011273409-A1,A61P17/00,A,61,P,61,00
AU-2011273409-A1,C07D333/38,C,07,D,07,38
AU-2011273409-A1,C07D333/38,C,07,D,07,38
AU-2011273409-A1,A61P1/04,A,61,P,61,04
AU-2011273409-A1,C07D333/58,C,07,D,07,58
AU-2011273409-A1,A61P1/00,A,61,P,61,00
AU-2011273409-A1,A61P11/02,A,61,P,61,02
AU-2011273409-A1,A61P19/02,A,61,P,61,02
AU-2011273409-A1,A61P17/06,A,61,P,61,06
AU-2011273409-A1,C07C2601/10,C,07,C,07,10
AU-2011273409-A1,C07C233/58,C,07,C,07,58
AU-2011273409-A1,C07D333/38,C,07,D,07,38
AU-2011273409-A1,C07C233/60,C,07,C,07,60
AU-2011273409-A1,C07C255/60,C,07,C,07,60
AU-2011273409-A1,C07C233/59,C,07,C,07,59
AU-2011273409-A1,C07D307/30,C,07,D,07,30
AU-2011273409-A1,C07D333/58,C,07,D,07,58
AU-2011273409-A1,C07C2601/10,C,07,C,07,10
AU-2011309865-A1,A61M16/0443,A,61,M,61,0443
AU-2011309865-A1,A61M16/0463,A,61,M,61,0463
AU-2011309865-A1,A61M16/0409,A,61,M,61,0409
AU-2011309865-A1,A61M16/0415,A,61,M,61,0415
AU-2011309865-A1,A61M16/0493,A,61,M,61,0493
AU-2011309865-A1,A61M16/0409,A,61,M,61,0409
AU-2011309865-A1,A61M16/0493,A,61,M,61,0493
AU-2011309865-A1,A61M16/0488,A,61,M,61,0488
AU-2011309865-A1,A61M16/0488,A,61,M,61,0488
AU-2011309865-A1,A61M16/0443,A,61,M,61,0443
AU-2011316476-A1,E01F13/12,E,01,F,01,12
AU-2011316476-A1,E01F13/022,E,01,F,01,022
AU-2011316476-A1,E04H17/18,E,04,H,04,18
AU-2011316476-A1,E04H17/163,E,04,H,04,163
AU-2011316476-A1,E04H17/163,E,04,H,04,163
AU-2011318232-A1,H04R1/26,H,04,R,04,26
AU-2011318232-A1,H04R1/02,H,04,R,04,02
AU-2011318232-A1,G10K11/20,G,10,K,10,20
AU-2011318232-A1,H04R1/24,H,04,R,04,24
AU-2011318232-A1,H04R1/025,H,04,R,04,025
AU-2011318232-A1,H04R7/127,H,04,R,04,127
AU-2011318232-A1,H04R1/345,H,04,R,04,345
AU-2011318232-A1,H04R2203/12,H,04,R,04,12
AU-2011318232-A1,H04R5/04,H,04,R,04,04
AU-2011318232-A1,H04R1/403,H,04,R,04,403
AU-2011318232-A1,H04R1/345,H,04,R,04,345
AU-2011318232-A1,G10K11/20,G,10,K,10,20
AU-2011318232-A1,G10K11/20,G,10,K,10,20
AU-2011318232-A1,H04R19/02,H,04,R,04,02
AU-2011318232-A1,G10K11/28,G,10,K,10,28
AU-2012271450-A1,A61K41/0038,A,61,K,61,0038
AU-2012271450-A1,A61K2039/505,A,61,K,61,505
AU-2012271450-A1,A61P43/00,A,61,P,61,00
AU-2012271450-A1,A61P35/00,A,61,P,61,00
AU-2012271450-A1,A61P35/04,A,61,P,61,04
AU-2012271450-A1,C07K16/28,C,07,K,07,28
AU-2012271450-A1,A61P9/00,A,61,P,61,00
AU-2012271450-A1,A61K41/0038,A,61,K,61,0038
AU-2012271450-A1,A61K2039/505,A,61,K,61,505
AU-2012271450-A1,C07K16/28,C,07,K,07,28
AU-2012275974-A1,C10G29/205,C,10,G,10,205
AU-2012275974-A1,B01J31/0284,B,01,J,01,0284
AU-2012275974-A1,C10G29/26,C,10,G,10,26
AU-2012275974-A1,C10G25/00,C,10,G,10,00
AU-2012275974-A1,C10G2300/1081,C,10,G,10,1081
AU-2012275974-A1,C10G2400/08,C,10,G,10,08
AU-2012275974-A1,C10G2400/10,C,10,G,10,10
AU-2012275974-A1,C10G25/12,C,10,G,10,12
AU-2012275974-A1,C10G2300/1088,C,10,G,10,1088
AU-2012275974-A1,C10G2400/02,C,10,G,10,02
AU-2012275974-A1,C10G2300/4018,C,10,G,10,4018
AU-2012275974-A1,C10G2400/04,C,10,G,10,04
AU-2012275974-A1,B01J20/34,B,01,J,01,34
AU-2012275974-A1,B01J20/22,B,01,J,01,22
AU-2012275974-A1,B01J20/18,B,01,J,01,18
AU-2012275974-A1,B01J31/0284,B,01,J,01,0284
AU-2012275974-A1,C10G29/26,C,10,G,10,26
AU-2012275974-A1,C10G25/12,C,10,G,10,12
AU-2012275974-A1,C10G2300/4018,C,10,G,10,4018
AU-2012275974-A1,C10G25/00,C,10,G,10,00
AU-2012275974-A1,C10G2300/1088,C,10,G,10,1088
AU-2012275974-A1,C10G2300/1081,C,10,G,10,1081

2025-01-26 04:33:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:33:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:33:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:33:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:33:03 - snowflake.connector.connection - INFO - closed
2025-01-26 04:33:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:33:27 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:33:27 - root - INFO - ```sql
SELECT
  t."publication_number",
  cpc_f.value:"code"::STRING AS "cpc_code",
  SUBSTRING(cpc_f.value:"code"::STRING, 1, 1) AS "cpc_section",
  SUBSTRING(cpc_f.value:"code"::STRING, 2, 2) AS "cpc_class",
  SUBSTRING(cpc_f.value:"code"::STRING, 4, 1) AS "cpc_subclass",
  REGEXP_SUBSTR(cpc_f.value:"code"::STRING, '[0-9]+') AS "cpc_main_group",
  SPLIT_PART(cpc_f.value:"code"::STRING, '/', 2) AS "cpc_subgroup"
FROM
  PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."cpc") AS cpc_f
WHERE
  cpc_f.value:"code"::STRING IS NOT NULL
LIMIT 100;
```
2025-01-26 04:33:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:33:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:33:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:33:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:33:28 - snowflake.connector.connection - INFO - closed
2025-01-26 04:33:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:34:18 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:34:18 - root - INFO - SQL:
SELECT
  t."publication_number",
  cpc_f.value:"code"::STRING AS "cpc_code",
  SUBSTRING(cpc_f.value:"code"::STRING, 1, 1) AS "cpc_section",
  SUBSTRING(cpc_f.value:"code"::STRING, 2, 2) AS "cpc_class",
  SUBSTRING(cpc_f.value:"code"::STRING, 4, 1) AS "cpc_subclass",
  REGEXP_SUBSTR(cpc_f.value:"code"::STRING, '[0-9]+') AS "cpc_main_group",
  SPLIT_PART(cpc_f.value:"code"::STRING, '/', 2) AS "cpc_subgroup"
FROM
  PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."cpc") AS cpc_f
WHERE
  cpc_f.value:"code"::STRING IS NOT NULL
LIMIT 100;
Results:
publication_number,cpc_code,cpc_section,cpc_class,cpc_subclass,cpc_main_group,cpc_subgroup
CN-216675802-U,A61B17/50,A,61,B,61,50
CN-216675802-U,A61B17/00,A,61,B,61,00
CN-216675802-U,A61B10/04,A,61,B,61,04
CN-216941023-U,Y02P70/50,Y,02,P,02,50
CN-216587632-U,Y02A40/25,Y,02,A,02,25
CN-217773534-U,Y02E50/30,Y,02,E,02,30
CN-217773534-U,Y02E50/10,Y,02,E,02,10
CN-216633597-U,Y02P70/10,Y,02,P,02,10
CN-216664325-U,Y02A20/00,Y,02,A,02,00
CN-216874023-U,Y02P60/12,Y,02,P,02,12
CN-217449500-U,Y02P70/10,Y,02,P,02,10
CN-216634960-U,Y02P70/10,Y,02,P,02,10
CN-217275293-U,Y02P70/10,Y,02,P,02,10
CN-217288905-U,Y02P70/10,Y,02,P,02,10
CN-218951157-U,Y02W10/10,Y,02,W,02,10
CN-216361969-U,Y02E10/50,Y,02,E,02,50
CN-217195488-U,Y02A40/81,Y,02,A,02,81
CN-216637581-U,Y02W90/10,Y,02,W,02,10
CN-216887342-U,Y02W30/80,Y,02,W,02,80
CN-217318772-U,Y02W30/62,Y,02,W,02,62
CN-216633247-U,Y02P70/50,Y,02,P,02,50
CN-216521063-U,Y02B20/40,Y,02,B,02,40
CN-216647911-U,Y02A30/14,Y,02,A,02,14
CN-216808647-U,Y02W30/40,Y,02,W,02,40
CN-217169415-U,Y02P70/62,Y,02,P,02,62
CN-216697169-U,Y02E60/10,Y,02,E,02,10
CN-217240100-U,Y02E10/50,Y,02,E,02,50
CN-216825439-U,Y02P70/10,Y,02,P,02,10
CN-216825439-U,Y02E10/50,Y,02,E,02,50
CN-217291789-U,Y02W30/62,Y,02,W,02,62
CN-218335793-U,Y02T10/64,Y,02,T,02,64
CN-216937316-U,Y02P70/50,Y,02,P,02,50
CN-217167538-U,Y02T90/00,Y,02,T,02,00
CN-217282288-U,Y02E60/10,Y,02,E,02,10
CN-217230856-U,Y02P10/20,Y,02,P,02,20
CN-216936156-U,Y02A50/2351,Y,02,A,02,2351
CN-217273540-U,Y02E60/32,Y,02,E,02,32
CN-217250506-U,Y02W30/62,Y,02,W,02,62
CN-217403757-U,Y02A10/40,Y,02,A,02,40
CN-216906732-U,Y02A40/90,Y,02,A,02,90
CN-216958049-U,Y02E10/50,Y,02,E,02,50
CN-217262114-U,Y02W90/10,Y,02,W,02,10
CN-217444585-U,Y02E60/10,Y,02,E,02,10
CN-217444585-U,Y02P70/50,Y,02,P,02,50
CN-217364212-U,Y02P60/87,Y,02,P,02,87
CN-216920098-U,Y02E10/50,Y,02,E,02,50
CN-217270196-U,Y02E10/20,Y,02,E,02,20
CN-217434729-U,Y02W30/62,Y,02,W,02,62
CN-217497168-U,Y02W30/80,Y,02,W,02,80
CN-217276550-U,Y02P10/25,Y,02,P,02,25
CN-217288114-U,Y02W10/10,Y,02,W,02,10
CN-216937347-U,Y02A40/81,Y,02,A,02,81
CN-217156472-U,Y02B30/70,Y,02,B,02,70
CN-217334034-U,Y02P70/50,Y,02,P,02,50
CN-217270467-U,Y02T10/12,Y,02,T,02,12
CN-217312500-U,Y02E60/10,Y,02,E,02,10
CN-217613367-U,Y02P10/20,Y,02,P,02,20
CN-218942555-U,Y02D10/00,Y,02,D,02,00
CN-217439994-U,Y02A20/00,Y,02,A,02,00
CN-217386843-U,Y02E40/30,Y,02,E,02,30
CN-217343465-U,Y02E10/20,Y,02,E,02,20
CN-217475571-U,Y02W30/60,Y,02,W,02,60
CN-217752268-U,Y02W30/62,Y,02,W,02,62
CN-217163521-U,Y02A40/20,Y,02,A,02,20
CN-217397113-U,Y02A50/20,Y,02,A,02,20
CN-217252471-U,Y02E10/728,Y,02,E,02,728
CN-217517262-U,Y02A30/30,Y,02,A,02,30
CN-217782329-U,Y02E10/20,Y,02,E,02,20
CN-217307452-U,Y02T10/64,Y,02,T,02,64
CN-217152872-U,Y02E10/50,Y,02,E,02,50
CN-218162281-U,Y02E10/50,Y,02,E,02,50
CN-217229396-U,Y02E30/30,Y,02,E,02,30
CN-218916914-U,Y02A20/20,Y,02,A,02,20
CN-218016264-U,Y02P70/10,Y,02,P,02,10
CN-217729205-U,Y02W30/91,Y,02,W,02,91
CN-217341437-U,Y02A20/00,Y,02,A,02,00
CN-217152121-U,Y02P70/10,Y,02,P,02,10
CN-217352353-U,Y02E10/20,Y,02,E,02,20
CN-217667764-U,Y02P70/10,Y,02,P,02,10
CN-218376178-U,Y02B80/22,Y,02,B,02,22
CN-218376178-U,Y02A30/249,Y,02,A,02,249
CN-217383915-U,Y02E60/10,Y,02,E,02,10
CN-218506003-U,Y02T10/82,Y,02,T,02,82
CN-217677004-U,Y02W10/10,Y,02,W,02,10
CN-218711270-U,Y02P70/62,Y,02,P,02,62
CN-217679715-U,Y02B30/90,Y,02,B,02,90
CN-217679715-U,Y02A30/00,Y,02,A,02,00
CN-217502971-U,Y02A50/20,Y,02,A,02,20
CN-217888607-U,Y02P60/87,Y,02,P,02,87
CN-217741069-U,Y02B20/40,Y,02,B,02,40
CN-217805994-U,Y02W30/80,Y,02,W,02,80
CN-218887001-U,Y02E40/30,Y,02,E,02,30
CN-218887001-U,Y02E40/40,Y,02,E,02,40
CN-218479456-U,Y02A30/244,Y,02,A,02,244
CN-218900211-U,Y02P60/80,Y,02,P,02,80
CN-218853167-U,Y02A50/20,Y,02,A,02,20
CN-219775735-U,Y02E20/34,Y,02,E,02,34
CN-219322133-U,Y02E10/50,Y,02,E,02,50
CN-218089130-U,Y02W10/10,Y,02,W,02,10
CN-217921870-U,Y02W30/40,Y,02,W,02,40

2025-01-26 04:34:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:34:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:34:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:34:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:34:20 - snowflake.connector.connection - INFO - closed
2025-01-26 04:34:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:34:20 - root - INFO - SQL:
SELECT
  t."publication_number",
  SUBSTRING(cpc_f.value:"code"::STRING, 1, 1) AS "cpc_section",
  SUBSTRING(cpc_f.value:"code"::STRING, 2, 2) AS "cpc_class",
  SUBSTRING(cpc_f.value:"code"::STRING, 4, 1) AS "cpc_subclass"
FROM PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."cpc") cpc_f
WHERE
  SUBSTRING(cpc_f.value:"code"::STRING, 1, 1) = 'A'
  AND SUBSTRING(cpc_f.value:"code"::STRING, 2, 2) = '61'
LIMIT 100
Results:
publication_number,cpc_section,cpc_class,cpc_subclass
US-2001010465-A1,A,61,B
US-2001035503-A1,A,61,B
US-2001035503-A1,A,61,B
US-2001035503-A1,A,61,B
US-2001035503-A1,A,61,B
US-2002040191-A1,A,61,B
US-2002040191-A1,A,61,N
US-2002040191-A1,A,61,B
US-2002040191-A1,A,61,N
US-2002040191-A1,A,61,B
US-2002040191-A1,A,61,B
US-2007218026-A1,A,61,P
US-2007218026-A1,A,61,P
US-2007218026-A1,A,61,K
US-2007218026-A1,A,61,K
US-2002151787-A1,A,61,B
US-2002151787-A1,A,61,K
US-2002151787-A1,A,61,K
US-2002151787-A1,A,61,B
US-2004016004-A1,A,61,K
US-2004016004-A1,A,61,K
US-2004016004-A1,A,61,P
US-2004016004-A1,A,61,K
US-2004016004-A1,A,61,K
US-2003180864-A1,A,61,K
US-2003180864-A1,A,61,K
US-2003180864-A1,A,61,K
US-2003180864-A1,A,61,K
US-2003180864-A1,A,61,K
US-2003180864-A1,A,61,K
US-2003180864-A1,A,61,K
US-2003180864-A1,A,61,K
US-2003180864-A1,A,61,K
US-2003180864-A1,A,61,K
US-2003180864-A1,A,61,K
US-2003180864-A1,A,61,K
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2004019030-A1,A,61,K
US-2004019030-A1,A,61,K
US-2004019030-A1,A,61,K
US-2004019030-A1,A,61,K
US-2004019030-A1,A,61,K
US-2004019030-A1,A,61,K
US-2003114552-A1,A,61,L
US-2003114552-A1,A,61,L
US-2003114552-A1,A,61,L
US-2003114552-A1,A,61,L
US-2003114552-A1,A,61,L
US-2003114552-A1,A,61,L
US-2003131380-A1,A,61,Q
US-2003131380-A1,A,61,K
US-2003131380-A1,A,61,P
US-2003131380-A1,A,61,K
US-2003131380-A1,A,61,K
US-2003131380-A1,A,61,K
US-2003131380-A1,A,61,Q
US-2004009906-A1,A,61,P
US-2004009906-A1,A,61,P
US-2004009906-A1,A,61,P
US-2004009906-A1,A,61,P
US-2004009906-A1,A,61,P
US-2004009906-A1,A,61,K
US-2004009906-A1,A,61,K
US-2004009906-A1,A,61,K
US-2004009906-A1,A,61,K
US-2004009906-A1,A,61,K
US-2004009906-A1,A,61,P
US-2004009906-A1,A,61,K
US-2004009906-A1,A,61,K
US-2004009906-A1,A,61,K
US-2004009906-A1,A,61,K
US-2004009906-A1,A,61,K
US-2004009906-A1,A,61,K
US-2004009906-A1,A,61,K
US-2004006039-A1,A,61,K
US-2004006039-A1,A,61,K
US-2004122350-A1,A,61,B
US-2004122350-A1,A,61,B
US-2004122350-A1,A,61,B
US-2004122350-A1,A,61,B
US-2004122350-A1,A,61,B
US-2004122350-A1,A,61,B
US-2004122350-A1,A,61,B

2025-01-26 04:34:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:34:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:34:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:34:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:34:21 - snowflake.connector.connection - INFO - closed
2025-01-26 04:34:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:34:22 - root - INFO - SQL:
SELECT
  t."publication_number",
  assignee_f.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f
LIMIT 100
Results:
publication_number,assignee_name
US-2018247292-A1,NCR CORP
US-2017261139-A1,STAUBLI SA ETS
US-2017264027-A1,SWITCHLAB INC
US-2017264027-A1,SWITCHLAB (SHANGHAI) CO LTD
US-2017260782-A1,HARTWELL CORP
US-2017353393-A1,COMCAST CABLE COMM LLC
US-2017278633-A1,TAIYO YUDEN KK
US-2017195921-A1,APPLE INC
US-2018272493-A1,TRAINA JOHN
US-2018272493-A1,MCCALL EDWARD L
US-2018272493-A1,LEHNING JEREMY
US-2018272493-A1,NCRX OPTICAL SOLUTIONS INC
US-2017200241-A1,NIPPON GAS CO LTD
US-2017289656-A1,LUO ALEX
US-2017289656-A1,BUSH TERRY W
US-2017282443-A1,GIANADDA PAUL H
US-2017293799-A1,TOBII AB
US-2017259523-A1,TOTAL RES & TECHNOLOGY FELUY
US-2017259523-A1,POLYNT COMPOSITES FRANCE
US-2017248791-A1,REICHERT ABRAHAM
US-2017235069-A1,RISCH BRIAN G
US-2017235069-A1,COLLADO DENISE
US-2017235069-A1,PRYSMIAN SPA
US-2018016555-A1,FIVE PRIME THERAPEUTICS INC
US-2017329169-A1,SHARP KK
US-2017305344-A1,MITSUBISHI ELECTRIC CORP
US-2018004217-A1,BOSCH GMBH ROBERT
US-2018274585-A1,CANON KK
US-2018154711-A1,KOSE SADI
US-2018154711-A1,LAWSON ROBERT CECIL
US-2018154711-A1,MORGAN DAVID SCOTT
US-2018154711-A1,MICHELIN & CIE
US-2018158316-A1,LG ELECTRONICS INC
US-2018100108-A1,SAGE & TIME LLP
US-2018124578-A1,ERICSSON TELEFON AB L M
US-2018350148-A1,PERFECTFIT SYSTEMS PVT LTD
US-2017363542-A1,SCHLUMBERGER TECHNOLOGY CORP
US-2018144132-A1,UNIV SICHUAN
US-2018027472-A1,SILERGY SEMICONDUCTOR TECH (HANGZHOU) LTD
US-2017312009-A1,ST JUDE MEDICAL ATRIAL FIBRILLATION DIV INC
US-2018020543-A1,SAMSUNG DISPLAY CO LTD
US-2017331573-A1,HUAWEI TECH CO LTD
US-2018056157-A1,COHEN BERNARD
US-2018056157-A1,RICCIARDI JOSEPH
US-2017358178-A1,KING SHOW GAMES INC
US-2018234160-A1,REALTEK SEMICONDUCTOR CORP
US-2019080618-A1,BOEING CO
US-2018104635-A1,NGK INSULATORS LTD
US-2018025593-A1,NOVAR ED&S LTD
US-2018247678-A1,VERGIS GEORGE
US-2018247678-A1,LE DAT
US-2018064440-A1,ETHICON LLC
US-2018124149-A1,INSTART LOGIC INC
US-2019019479-A1,STRICKLAND MATHEW EPHRAM
US-2019177377-A1,SYNGENTA PARTICIPATIONS AG
US-2018180555-A1,SHELL OIL CO
US-2018180555-A1,UNIV CHINA PETROLEUM
US-2019187138-A1,NANOSNIFF TECH PVT LTD
US-2018211505-A1,KONINKLIJKE PHILIPS NV
US-2018369831-A1,DH TECHNOLOGIES DEV PTE LTD
US-2018039078-A1,OSTENDO TECHNOLOGIES INC
US-2018070387-A1,IRIDIUM SATELLITE LLC
US-2018062285-A1,EATON CORP
US-2019129962-A1,ADOBE SYSTEMS INC
US-2018127725-A1,UNIV WAYNE STATE
US-2018073963-A1,OLYMPUS CORP
US-2018222783-A1,TIMMONS MARK STEPHEN
US-2018222783-A1,BENZ JEFFREY ALLEN
US-2018234779-A1,WINBOND ELECTRONICS CORP
US-2019164859-A1,ADVANCED SEMICONDUCTOR ENG
US-2018154845-A1,BOSCH GMBH ROBERT
US-2018109714-A1,IBM
US-2018170733-A1,JUNGHEINRICH AG
US-2018205546-A1,ASSETVAULT LTD
US-2019208025-A1,FACEBOOK INC
US-2018280336-A1,ENZYCHEM LIFESCIENCES CORP
US-2018280336-A1,KOREA RES INSTITUTE OF BIO SCIENCE AND BIOTECHNOLOGY
US-2018195257-A1,XIAMEN RUNNER IND CORPORATION
US-2019212770-A1,NXP BV
US-2018144605-A1,CERNER INNOVATION INC
US-2018326219-A1,WOLF II ERICH W
US-2018218898-A1,HITACHI INT ELECTRIC INC
US-2019240737-A1,ISCAR LTD
US-2018238660-A1,ADVANCED BLAST & BALLISTIC SYSTEMS LTD
US-2019273364-A1,CISCO TECH INC
US-2018194441-A1,FALCK LEE
US-2018261780-A1,SAMSUNG ELECTRONICS CO LTD
US-2018261780-A1,SAMSUNG SDI CO LTD
US-2018212109-A1,SEOUL VIOSYS CO LTD
US-2020365844-A1,SK INNOVATION CO LTD
US-2018221420-A1,UNIV UNITED ARAB EMIRATES
US-2019104107-A1,FISHER ROSEMOUNT SYSTEMS INC
US-2018230177-A1,IMMUNE SENSOR LLC
US-2018230177-A1,UNIV TEXAS
US-2019318282-A1,BANK OF AMERICA
US-2018307833-A1,Level Effect LLC
US-2018242172-A1,LG ELECTRONICS INC
US-2019199611-A1,APPLE INC
US-2019131878-A1,MITSUBISHI ELECTRIC CORP
US-2018246979-A1,EBAY INC

2025-01-26 04:34:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:34:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:34:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:34:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:34:23 - snowflake.connector.connection - INFO - closed
2025-01-26 04:34:23 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:34:24 - root - INFO - SQL:
SELECT
  t."publication_number",
  assignee_f.value:"name"::STRING AS "assignee_name",
  SUBSTRING(cpc_f.value:"code"::STRING, 1, 1) AS "cpc_section",
  SUBSTRING(cpc_f.value:"code"::STRING, 2, 2) AS "cpc_class"
FROM PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
  LATERAL FLATTEN(input => t."cpc") cpc_f
WHERE
  SUBSTRING(cpc_f.value:"code"::STRING, 1, 1) = 'A'
  AND SUBSTRING(cpc_f.value:"code"::STRING, 2, 2) = '61'
LIMIT 100
Results:
publication_number,assignee_name,cpc_section,cpc_class
US-2007071679-A1,HILAKIVI ILKKA T,A,61
US-2007071679-A1,HILAKIVI ILKKA T,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2006199768-A1,UNIV NORTH CAROLINA,A,61
US-2006199768-A1,UNIV NORTH CAROLINA,A,61
US-2006199768-A1,UNIV NORTH CAROLINA,A,61
US-2006199768-A1,UNIV NORTH CAROLINA,A,61
US-2006199768-A1,UNIV NORTH CAROLINA,A,61
US-2006199768-A1,UNIV NORTH CAROLINA,A,61
US-2006199768-A1,UNIV NORTH CAROLINA,A,61
US-2006199768-A1,UNIV NORTH CAROLINA,A,61
US-2006199768-A1,UNIV NORTH CAROLINA,A,61
US-2006199768-A1,UNIV NORTH CAROLINA,A,61
US-2006199768-A1,UNIV NORTH CAROLINA,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006293245-A1,CYCLACEL LTD,A,61
US-2006293245-A1,CYCLACEL LTD,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258950-A1,SYNERGISTIC NEUROTHERAPY ADJUS,A,61
US-2006258950-A1,SYNERGISTIC NEUROTHERAPY ADJUS,A,61
US-2006258950-A1,SYNERGISTIC NEUROTHERAPY ADJUS,A,61
US-2006258950-A1,SYNERGISTIC NEUROTHERAPY ADJUS,A,61
US-2006258950-A1,SYNERGISTIC NEUROTHERAPY ADJUS,A,61
US-2006258950-A1,SYNERGISTIC NEUROTHERAPY ADJUS,A,61
US-2006258950-A1,SYNERGISTIC NEUROTHERAPY ADJUS,A,61
US-2006258950-A1,SYNERGISTIC NEUROTHERAPY ADJUS,A,61
US-2007260229-A1,NAVARRO LUIS,A,61
US-2007260229-A1,NAVARRO LUIS,A,61
US-2007260229-A1,NAVARRO LUIS,A,61

2025-01-26 04:34:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:34:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:34:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:34:25 - snowflake.connector.connection - INFO - closed
2025-01-26 04:34:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:34:43 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:34:43 - root - INFO - ```sql
SELECT
  t."filing_date",
  EXTRACT(year FROM TO_DATE(TO_VARCHAR(t."filing_date"), 'YYYYMMDD')) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
LIMIT 100;
```
2025-01-26 04:34:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:34:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:34:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:34:44 - snowflake.connector.connection - INFO - closed
2025-01-26 04:34:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:35:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:35:08 - root - INFO - You're encountering this error because some records in the `"filing_date"` column have the value `0` or invalid dates that cannot be parsed using the `'YYYYMMDD'` format. To resolve this issue, you can:

1. **Filter out invalid dates** by adding a `WHERE` clause to exclude rows where `"filing_date"` is `0` or `NULL`.

2. **Convert the numeric date to a string** before parsing it into a date format.

Here is the corrected SQL query:

```sql
SELECT
  t."filing_date",
  EXTRACT(year FROM TO_DATE(TO_CHAR(t."filing_date"), 'YYYYMMDD')) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE t."filing_date" > 0
LIMIT 100;
```

**Explanation:**

- **`TO_CHAR(t."filing_date")`:** Converts the numeric filing date to a string.
- **`TO_DATE(..., 'YYYYMMDD')`:** Parses the string into a date using the `'YYYYMMDD'` format.
- **`EXTRACT(year FROM ...)`:** Extracts the year component from the date.
- **`WHERE t."filing_date" > 0`:** Filters out records with invalid filing dates (e.g., `0`).

**Alternative Solution:**

If you prefer a simpler approach without date parsing, you can extract the first four digits of the filing date to obtain the year:

```sql
SELECT
  t."filing_date",
  SUBSTRING(TO_CHAR(t."filing_date"), 1, 4) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE t."filing_date" > 0
LIMIT 100;
```

**Explanation:**

- **`TO_CHAR(t."filing_date")`:** Converts the numeric filing date to a string.
- **`SUBSTRING(..., 1, 4)`:** Extracts the first four characters, representing the year.
- **`WHERE t."filing_date" > 0`:** Filters out records with invalid filing dates.

**Note:** Ensure that you exclude any records where `"filing_date"` is `0` or does not conform to the expected `YYYYMMDD` format to prevent parsing errors.

**Next Steps:**

With this corrected query, you should be able to retrieve the filing year without encountering errors. You can now proceed to use the `"filing_year"` in your analyses, such as determining the busiest year for the most active assignee in the 'A61' patent category.
2025-01-26 04:35:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:35:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:35:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:35:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:35:10 - snowflake.connector.connection - INFO - closed
2025-01-26 04:35:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:36:03 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:36:03 - root - INFO - SQL:
SELECT
  t."filing_date",
  EXTRACT(year FROM TO_DATE(TO_CHAR(t."filing_date"), 'YYYYMMDD')) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE t."filing_date" > 0
LIMIT 100;
Results:
filing_date,filing_year
20080425,2008
19950404,1995
19931103,1993
19990929,1999
19910125,1991
19920416,1992
19951018,1995
19960503,1996
19920325,1992
19991210,1999
19910204,1991
19911113,1991
19920625,1992
19950531,1995
19990607,1999
19910129,1991
19910725,1991
19920701,1992
19960919,1996
19961112,1996
19990910,1999
20121119,2012
20160610,2016
20171227,2017
20190724,2019
20201229,2020
19770131,1977
19780213,1978
19801003,1980
19820512,1982
19831018,1983
19831109,1983
19890718,1989
19891102,1989
19901229,1990
19931122,1993
19980526,1998
19970520,1997
19990119,1999
19991231,1999
20011003,2001
20031104,2003
20031211,2003
20030808,2003
20070716,2007
20070917,2007
20080430,2008
20111215,2011
20120706,2012
20140702,2014
20150629,2015
20180427,2018
20201006,2020
20050406,2005
20050408,2005
20050414,2005
20080422,2008
20050415,2005
20050414,2005
20050418,2005
20050421,2005
20080430,2008
20020327,2002
20020405,2002
20050503,2005
20080516,2008
20050506,2005
20050511,2005
20080603,2008
20050519,2005
20080611,2008
20020508,2002
20080619,2008
20020510,2002
20080623,2008
20050609,2005
20050620,2005
20050621,2005
20061212,2006
20020530,2002
20050729,2005
20020605,2002
20020604,2002
20080702,2008
20080702,2008
20050629,2005
20050708,2005
20010214,2001
20080730,2008
20050721,2005
20050722,2005
20080806,2008
20020703,2002
20020703,2002
20020702,2002
20050726,2005
20050728,2005
20080814,2008
20050729,2005
20050801,2005

2025-01-26 04:36:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:36:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:36:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:36:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:36:04 - snowflake.connector.connection - INFO - closed
2025-01-26 04:36:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:36:05 - root - INFO - SQL:
SELECT
  t."publication_number",
  assignee_f.value:"name"::STRING AS "assignee_name",
  SUBSTRING(cpc_f.value:"code"::STRING, 1, 1) AS "cpc_section",
  SUBSTRING(cpc_f.value:"code"::STRING, 2, 2) AS "cpc_class",
  SUBSTRING(TO_CHAR(t."filing_date"), 1, 4) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
  LATERAL FLATTEN(input => t."cpc") cpc_f
WHERE
  SUBSTRING(cpc_f.value:"code"::STRING, 1, 1) = 'A'
  AND SUBSTRING(cpc_f.value:"code"::STRING, 2, 2) = '61'
  AND t."filing_date" > 0
LIMIT 100
Results:
publication_number,assignee_name,cpc_section,cpc_class,filing_year
US-2018235635-A1,NORWEGIAN UNIV SCI & TECH NTNU,A,61,2017
US-2018235635-A1,NORWEGIAN UNIV SCI & TECH NTNU,A,61,2017
US-2018235635-A1,NORWEGIAN UNIV SCI & TECH NTNU,A,61,2017
US-2018235635-A1,NORWEGIAN UNIV SCI & TECH NTNU,A,61,2017
US-2018235635-A1,NORWEGIAN UNIV SCI & TECH NTNU,A,61,2017
US-2018235635-A1,NORWEGIAN UNIV SCI & TECH NTNU,A,61,2017
US-2018235635-A1,NORWEGIAN UNIV SCI & TECH NTNU,A,61,2017
US-2018235635-A1,NORWEGIAN UNIV SCI & TECH NTNU,A,61,2017
US-2018235635-A1,NORWEGIAN UNIV SCI & TECH NTNU,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2018021729-A1,COLLINS CONOR,A,61,2017
US-2018021729-A1,COLLINS CONOR,A,61,2017
US-2018021729-A1,COLLINS CONOR,A,61,2017
US-2018021729-A1,COLLINS CONOR,A,61,2017
US-2018021729-A1,COLLINS CONOR,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018308237-A1,SAMSUNG ELECTRONICS CO LTD,A,61,2017
US-2018308237-A1,SAMSUNG ELECTRONICS CO LTD,A,61,2017
US-2018308237-A1,SAMSUNG ELECTRONICS CO LTD,A,61,2017
US-2018308237-A1,SAMSUNG ELECTRONICS CO LTD,A,61,2017
US-2018308237-A1,SAMSUNG ELECTRONICS CO LTD,A,61,2017
US-2018055834-A1,AROG PHARMACEUTICALS INC,A,61,2017
US-2018055834-A1,AROG PHARMACEUTICALS INC,A,61,2017

2025-01-26 04:36:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:36:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:36:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:36:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:36:07 - snowflake.connector.connection - INFO - closed
2025-01-26 04:36:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:36:07 - root - INFO - SQL:
SELECT
  assignee_f.value:"name"::STRING AS "assignee_name",
  COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
  LATERAL FLATTEN(input => t."cpc") cpc_f
WHERE
  SUBSTRING(cpc_f.value:"code"::STRING, 1, 1) = 'A'
  AND SUBSTRING(cpc_f.value:"code"::STRING, 2, 2) = '61'
GROUP BY assignee_f.value:"name"::STRING
ORDER BY "patent_count" DESC
LIMIT 100
Results:
assignee_name,patent_count
PROCTER & GAMBLE,197
HOFFMANN LA ROCHE,189
OREAL,150
NOVARTIS AG,147
LILLY CO ELI,140
PFIZER,125
UNIV CALIFORNIA,98
BRISTOL MYERS SQUIBB CO,90
COLGATE PALMOLIVE CO,89
COVIDIEN LP,84
BAYER AG,82
KIMBERLY CLARK CO,79
HOECHST AG,78
GENENTECH INC,78
MERCK & CO INC,77
ASTRAZENECA AB,75
JANSSEN PHARMACEUTICA NV,75
MERCK PATENT GMBH,73
KONINKLIJKE PHILIPS NV,68
BECTON DICKINSON CO,67
OLYMPUS CORP,65
MEDTRONIC INC,63
BOEHRINGER INGELHEIM INT,60
FUJIFILM CORP,60
CENTRE NAT RECH SCIENT,55
AMGEN INC,54
SCHERING AG,54
SIEMENS AG,53
BOSTON SCIENT SCIMED INC,52
UNI CHARM CORP,48
GEN ELECTRIC,46
ABBOTT LAB,46
MERCK SHARP & DOHME,44
KONINKL PHILIPS ELECTRONICS NV,44
ETHICON INC,44
PFIZER PROD INC,43
GLAXO GROUP LTD,43
SANOFI AVENTIS DEUTSCHLAND,43
BAXTER INT,42
WARNER LAMBERT CO,42
TERUMO CORP,41
INST NAT SANTE RECH MED,41
3M INNOVATIVE PROPERTIES CO,41
UNIV TEXAS,40
ALLERGAN INC,38
SMITHKLINE BEECHAM CORP,38
SAMSUNG ELECTRONICS CO LTD,37
SANOFI SA,37
AMERICAN CYANAMID CO,37
UNIV LELAND STANFORD JUNIOR,36
UNILEVER NV,36
WYETH CORP,35
ETHICON ENDO SURGERY INC,35
OTSUKA PHARMA CO LTD,35
SCHERING CORP,35
CIBA GEIGY AG,35
NOVO NORDISK AS,34
ALCON INC,34
CANON KK,34
KAO CORP,34
GRUENENTHAL GMBH,33
BEIERSDORF AG,33
US HEALTH,33
SANOFI AVENTIS,32
REGENERON PHARMA,31
SERVIER LAB,31
UPJOHN CO,31
BIOSENSE WEBSTER ISRAEL LTD,30
EDWARDS LIFESCIENCES CORP,30
UNIV PENNSYLVANIA,29
BOEHRINGER INGELHEIM PHARMA,28
OLYMPUS MEDICAL SYSTEMS CORP,28
TYCO HEALTHCARE,28
VERTEX PHARMA,28
UNILEVER PLC,28
UNIV FLORIDA,26
NESTEC SA,26
CARDIAC PACEMAKERS INC,26
ETHICON LLC,26
UNIV JOHNS HOPKINS,26
GILEAD SCIENCES INC,26
PHILIP MORRIS PRODUCTS SA,25
MASSACHUSETTS INST TECHNOLOGY,25
ALZA CORP,25
THOMAE GMBH DR K,25
AVENTIS PHARMA SA,25
MASSACHUSETTS GEN HOSPITAL,25
CHUGAI PHARMACEUTICAL CO LTD,25
BASF AG,25
TAKEDA CHEMICAL INDUSTRIES LTD,24
AMOREPACIFIC CORP,24
SIEMENS HEALTHCARE GMBH,24
MCNEIL PPC INC,24
HENKEL KGAA,23
SMITH & NEPHEW INC,23
SMITHKLINE BEECHAM PLC,23
GENZYME CORP,23
INTUITIVE SURGICAL OPERATIONS,22
BAXTER HEALTHCARE SA,22
SHISEIDO CO LTD,22

2025-01-26 04:36:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:36:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:36:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:36:08 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:36:08 - snowflake.connector.connection - INFO - closed
2025-01-26 04:36:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:36:09 - root - INFO - SQL:
SELECT
  assignee_f.value:"name"::STRING AS "assignee_name",
  SUBSTRING(TO_CHAR(t."filing_date"), 1, 4) AS "filing_year",
  COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
  LATERAL FLATTEN(input => t."cpc") cpc_f
WHERE
  SUBSTRING(cpc_f.value:"code"::STRING, 1, 1) = 'A'
  AND SUBSTRING(cpc_f.value:"code"::STRING, 2, 2) = '61'
  AND t."filing_date" > 0
GROUP BY
  assignee_f.value:"name"::STRING,
  SUBSTRING(TO_CHAR(t."filing_date"), 1, 4)
ORDER BY "patent_count" DESC
LIMIT 100
Results:
assignee_name,filing_year,patent_count
PROCTER & GAMBLE,1997,15
KONINKLIJKE PHILIPS NV,2018,15
NOVARTIS AG,2006,13
UNIV CALIFORNIA,2020,12
NOVARTIS AG,2011,11
OLYMPUS CORP,2016,11
FUJIFILM CORP,2019,11
PROCTER & GAMBLE,2000,11
COVIDIEN LP,2020,11
PROCTER & GAMBLE,1998,10
UNIV CALIFORNIA,2019,10
PROCTER & GAMBLE,1999,10
NOVARTIS AG,2014,10
COVIDIEN LP,2016,10
COVIDIEN LP,2017,9
HOFFMANN LA ROCHE,2008,9
GENENTECH INC,2002,9
ETHICON LLC,2019,9
HOFFMANN LA ROCHE,2003,9
KONINKLIJKE PHILIPS NV,2016,9
NOVARTIS AG,2008,9
HOFFMANN LA ROCHE,2006,9
PFIZER,2015,9
NOVARTIS AG,2007,9
KONINKL PHILIPS ELECTRONICS NV,2010,9
OREAL,1995,9
KONINKLIJKE PHILIPS NV,2019,8
SMITHKLINE BEECHAM CORP,1998,8
PROCTER & GAMBLE,2016,8
SIEMENS HEALTHCARE GMBH,2019,8
HOFFMANN LA ROCHE,2002,8
BAYER AG,2001,8
LILLY CO ELI,1998,8
OLYMPUS CORP,2017,8
HOFFMANN LA ROCHE,2001,8
PROCTER & GAMBLE,1996,8
SANOFI AVENTIS,2007,8
COVIDIEN LP,2019,8
ASTRAZENECA AB,2001,8
BOEHRINGER INGELHEIM INT,2009,8
HOFFMANN LA ROCHE,2004,8
OLYMPUS MEDICAL SYSTEMS CORP,2008,8
HOECHST AG,1992,7
HOFFMANN LA ROCHE,2009,7
UNIV CALIFORNIA,2018,7
PROCTER & GAMBLE,2008,7
BAYER AG,1993,7
HOFFMANN LA ROCHE,2019,7
PROCTER & GAMBLE,2007,7
GENENTECH INC,2018,7
LILLY CO ELI,1994,7
ASTRAZENECA AB,2007,7
WYETH CORP,2006,7
PFIZER PROD INC,2001,7
NOVARTIS AG,2005,7
KONINKLIJKE PHILIPS NV,2021,7
PROCTER & GAMBLE,2017,7
ASTRAZENECA AB,2005,7
KIMBERLY CLARK CO,1999,7
US HEALTH,2018,7
KONINKLIJKE PHILIPS NV,2020,7
PFIZER,1990,7
TYCO HEALTHCARE,2010,7
KONINKL PHILIPS ELECTRONICS NV,2008,7
NOVARTIS AG,2020,7
ETHICON ENDO SURGERY INC,2014,7
PFIZER,1993,7
FUJIFILM CORP,2020,7
PROCTER & GAMBLE,2006,7
BRISTOL MYERS SQUIBB CO,2002,7
PROCTER & GAMBLE,2012,7
OREAL,2005,7
NOVARTIS AG,2015,7
HOFFMANN LA ROCHE,2021,6
OREAL,1999,6
ETHICON LLC,2017,6
BRISTOL MYERS SQUIBB CO,2013,6
TYCO HEALTHCARE,2009,6
HOFFMANN LA ROCHE,2015,6
GLAXOSMITHKLINE IP DEV LTD,2015,6
JANSSEN PHARMACEUTICA NV,1998,6
PFIZER PROD INC,1999,6
ETHICON ENDO SURGERY LLC,2016,6
OREAL,2002,6
CANON KK,2017,6
HOFFMANN LA ROCHE,2018,6
MEDTRONIC INC,2021,6
OREAL,2019,6
GENENTECH INC,2008,6
BRISTOL MYERS SQUIBB CO,2003,6
HOFFMANN LA ROCHE,2007,6
SANOFI AVENTIS,2009,6
NOVARTIS AG,2004,6
SMITHKLINE BEECHAM PLC,1998,6
EDWARDS LIFESCIENCES CORP,2023,6
LILLY CO ELI,1996,6
NOVARTIS AG,2019,6
OREAL,2015,6
PROCTER & GAMBLE,1995,6
BIOSENSE WEBSTER ISRAEL LTD,2019,6

2025-01-26 04:36:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:36:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:36:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:36:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-26 04:36:10 - snowflake.connector.connection - INFO - closed
2025-01-26 04:36:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:36:27 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:36:27 - root - INFO - ```sql
SELECT
  assignee_f.value:"name"::STRING AS "assignee_name",
  SUBSTRING(TO_CHAR(t."filing_date"), 1, 4) AS "filing_year",
  COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
  LATERAL FLATTEN(input => t."cpc") cpc_f
WHERE
  cpc_f.value:"code"::STRING LIKE 'A61%'
  AND t."filing_date" > 0
GROUP BY
  assignee_f.value:"name"::STRING,
  SUBSTRING(TO_CHAR(t."filing_date"), 1, 4)
ORDER BY "patent_count" DESC
LIMIT 100;
```
2025-01-26 04:36:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:36:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:36:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:36:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:36:29 - snowflake.connector.connection - INFO - closed
2025-01-26 04:36:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:37:19 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:37:19 - root - INFO - SQL:
SELECT
  assignee_f.value:"name"::STRING AS "assignee_name",
  SUBSTRING(TO_CHAR(t."filing_date"), 1, 4) AS "filing_year",
  COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
  LATERAL FLATTEN(input => t."cpc") cpc_f
WHERE
  cpc_f.value:"code"::STRING LIKE 'A61%'
  AND t."filing_date" > 0
GROUP BY
  assignee_f.value:"name"::STRING,
  SUBSTRING(TO_CHAR(t."filing_date"), 1, 4)
ORDER BY "patent_count" DESC
LIMIT 100;
Results:
assignee_name,filing_year,patent_count
KONINKLIJKE PHILIPS NV,2018,15
PROCTER & GAMBLE,1997,15
NOVARTIS AG,2006,13
UNIV CALIFORNIA,2020,12
COVIDIEN LP,2020,11
FUJIFILM CORP,2019,11
NOVARTIS AG,2011,11
OLYMPUS CORP,2016,11
PROCTER & GAMBLE,2000,11
COVIDIEN LP,2016,10
PROCTER & GAMBLE,1998,10
NOVARTIS AG,2014,10
PROCTER & GAMBLE,1999,10
UNIV CALIFORNIA,2019,10
NOVARTIS AG,2008,9
GENENTECH INC,2002,9
HOFFMANN LA ROCHE,2003,9
HOFFMANN LA ROCHE,2008,9
NOVARTIS AG,2007,9
KONINKLIJKE PHILIPS NV,2016,9
HOFFMANN LA ROCHE,2006,9
OREAL,1995,9
PFIZER,2015,9
KONINKL PHILIPS ELECTRONICS NV,2010,9
ETHICON LLC,2019,9
COVIDIEN LP,2017,9
LILLY CO ELI,1998,8
OLYMPUS CORP,2017,8
HOFFMANN LA ROCHE,2001,8
KONINKLIJKE PHILIPS NV,2019,8
ASTRAZENECA AB,2001,8
HOFFMANN LA ROCHE,2004,8
COVIDIEN LP,2019,8
BOEHRINGER INGELHEIM INT,2009,8
HOFFMANN LA ROCHE,2002,8
PROCTER & GAMBLE,1996,8
SANOFI AVENTIS,2007,8
SIEMENS HEALTHCARE GMBH,2019,8
PROCTER & GAMBLE,2016,8
BAYER AG,2001,8
SMITHKLINE BEECHAM CORP,1998,8
OLYMPUS MEDICAL SYSTEMS CORP,2008,8
BRISTOL MYERS SQUIBB CO,2002,7
ETHICON ENDO SURGERY INC,2014,7
PFIZER,1993,7
NOVARTIS AG,2005,7
KONINKL PHILIPS ELECTRONICS NV,2008,7
PFIZER,1990,7
PROCTER & GAMBLE,2017,7
HOECHST AG,1992,7
WYETH CORP,2006,7
BAYER AG,1993,7
PROCTER & GAMBLE,2006,7
KONINKLIJKE PHILIPS NV,2020,7
NOVARTIS AG,2015,7
PROCTER & GAMBLE,2008,7
FUJIFILM CORP,2020,7
TYCO HEALTHCARE,2010,7
ASTRAZENECA AB,2007,7
PROCTER & GAMBLE,2007,7
LILLY CO ELI,1994,7
KONINKLIJKE PHILIPS NV,2021,7
HOFFMANN LA ROCHE,2009,7
KIMBERLY CLARK CO,1999,7
OREAL,2005,7
PFIZER PROD INC,2001,7
GENENTECH INC,2018,7
PROCTER & GAMBLE,2012,7
ASTRAZENECA AB,2005,7
NOVARTIS AG,2020,7
US HEALTH,2018,7
UNIV CALIFORNIA,2018,7
HOFFMANN LA ROCHE,2019,7
TOSHIBA MEDICAL SYS CORP,2012,6
PFIZER,2004,6
COVIDIEN LP,2018,6
UNIV CALIFORNIA,2017,6
NOVARTIS AG,2003,6
LILLY CO ELI,2017,6
UNIV LELAND STANFORD JUNIOR,2019,6
MERCK & CO INC,2003,6
HOFFMANN LA ROCHE,2021,6
MERCK PATENT GMBH,2002,6
ETHICON ENDO SURGERY INC,2011,6
HOFFMANN LA ROCHE,2015,6
GENENTECH INC,2008,6
OREAL,1999,6
BRISTOL MYERS SQUIBB CO,2013,6
HOFFMANN LA ROCHE,2007,6
OLYMPUS CORP,2018,6
ETHICON ENDO SURGERY LLC,2016,6
MEDTRONIC INC,2021,6
NOVARTIS AG,2002,6
PHILIP MORRIS PRODUCTS SA,2016,6
BIOSENSE WEBSTER ISRAEL LTD,2019,6
PFIZER PROD INC,2002,6
CANON KK,2017,6
HOFFMANN LA ROCHE,2018,6
NOVARTIS AG,2019,6
OREAL,2015,6

2025-01-26 04:37:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:37:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:37:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:37:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-26 04:37:20 - snowflake.connector.connection - INFO - closed
2025-01-26 04:37:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:37:57 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:37:57 - root - INFO - ```sql
SELECT
  assignee_f.value:"name"::STRING AS "assignee_name",
  SUBSTRING(TO_CHAR(t."filing_date"), 1, 4) AS "filing_year",
  COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
  LATERAL FLATTEN(input => t."cpc") cpc_f
WHERE
  cpc_f.value:"code"::STRING ILIKE '%A61%'
GROUP BY
  assignee_f.value:"name"::STRING,
  SUBSTRING(TO_CHAR(t."filing_date"), 1, 4)
ORDER BY "patent_count" DESC
LIMIT 100;
```
2025-01-26 04:37:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:37:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:37:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:37:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:37:58 - snowflake.connector.connection - INFO - closed
2025-01-26 04:37:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:38:31 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:38:31 - root - INFO - SQL:
SELECT
  assignee_f.value:"name"::STRING AS "assignee_name",
  SUBSTRING(TO_CHAR(t."filing_date"), 1, 4) AS "filing_year",
  COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
  LATERAL FLATTEN(input => t."cpc") cpc_f
WHERE
  cpc_f.value:"code"::STRING ILIKE '%A61%'
GROUP BY
  assignee_f.value:"name"::STRING,
  SUBSTRING(TO_CHAR(t."filing_date"), 1, 4)
ORDER BY "patent_count" DESC
LIMIT 100;
Results:
assignee_name,filing_year,patent_count
KONINKLIJKE PHILIPS NV,2018,15
PROCTER & GAMBLE,1997,15
NOVARTIS AG,2006,13
UNIV CALIFORNIA,2020,12
OLYMPUS CORP,2016,11
COVIDIEN LP,2020,11
NOVARTIS AG,2011,11
PROCTER & GAMBLE,2000,11
FUJIFILM CORP,2019,11
NOVARTIS AG,2014,10
PROCTER & GAMBLE,1998,10
UNIV CALIFORNIA,2019,10
COVIDIEN LP,2016,10
PROCTER & GAMBLE,1999,10
OREAL,1995,9
HOFFMANN LA ROCHE,2003,9
NOVARTIS AG,2008,9
GENENTECH INC,2002,9
KONINKL PHILIPS ELECTRONICS NV,2010,9
PFIZER,2015,9
KONINKLIJKE PHILIPS NV,2016,9
NOVARTIS AG,2007,9
HOFFMANN LA ROCHE,2006,9
COVIDIEN LP,2017,9
ETHICON LLC,2019,9
HOFFMANN LA ROCHE,2008,9
BAYER AG,2001,8
SANOFI AVENTIS,2007,8
PROCTER & GAMBLE,2016,8
COVIDIEN LP,2019,8
PROCTER & GAMBLE,1996,8
HOFFMANN LA ROCHE,2001,8
BOEHRINGER INGELHEIM INT,2009,8
KONINKLIJKE PHILIPS NV,2019,8
SMITHKLINE BEECHAM CORP,1998,8
LILLY CO ELI,1998,8
HOFFMANN LA ROCHE,2004,8
OLYMPUS CORP,2017,8
OLYMPUS MEDICAL SYSTEMS CORP,2008,8
HOFFMANN LA ROCHE,2002,8
ASTRAZENECA AB,2001,8
SIEMENS HEALTHCARE GMBH,2019,8
ASTRAZENECA AB,2007,7
NOVARTIS AG,2020,7
PROCTER & GAMBLE,2006,7
US HEALTH,2018,7
PFIZER PROD INC,2001,7
OREAL,2005,7
KIMBERLY CLARK CO,1999,7
HOFFMANN LA ROCHE,2009,7
PROCTER & GAMBLE,2012,7
ASTRAZENECA AB,2005,7
KONINKL PHILIPS ELECTRONICS NV,2008,7
PFIZER,1990,7
PROCTER & GAMBLE,2017,7
NOVARTIS AG,2015,7
FUJIFILM CORP,2020,7
BRISTOL MYERS SQUIBB CO,2002,7
HOFFMANN LA ROCHE,2019,7
UNIV CALIFORNIA,2018,7
PFIZER,1993,7
ETHICON ENDO SURGERY INC,2014,7
BAYER AG,1993,7
WYETH CORP,2006,7
KONINKLIJKE PHILIPS NV,2020,7
HOECHST AG,1992,7
GENENTECH INC,2018,7
KONINKLIJKE PHILIPS NV,2021,7
PROCTER & GAMBLE,2008,7
TYCO HEALTHCARE,2010,7
LILLY CO ELI,1994,7
NOVARTIS AG,2005,7
PROCTER & GAMBLE,2007,7
UNI CHARM CORP,2003,6
HOFFMANN LA ROCHE,2021,6
OREAL,2002,6
BOEHRINGER INGELHEIM PHARMA,2002,6
OREAL,2006,6
WYETH CORP,2004,6
NOVARTIS AG,2019,6
ETHICON LLC,2017,6
MERCK PATENT GMBH,2003,6
UNIV TEXAS,2021,6
HOFFMANN LA ROCHE,1985,6
UNIV CALIFORNIA,2023,6
JANSSEN PHARMACEUTICA NV,1998,6
COVIDIEN LP,2014,6
GLAXOSMITHKLINE IP DEV LTD,2015,6
COVIDIEN LP,2012,6
CENTRE NAT RECH SCIENT,2014,6
PHILIP MORRIS PRODUCTS SA,2016,6
HOFFMANN LA ROCHE,2020,6
OLYMPUS CORP,2018,6
LILLY CO ELI,2012,6
PFIZER PROD INC,2002,6
EDWARDS LIFESCIENCES CORP,2023,6
BRISTOL MYERS SQUIBB CO,2003,6
COVIDIEN LP,2018,6
CANON KK,2017,6
NOVARTIS AG,2003,6

2025-01-26 04:38:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:38:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:38:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:38:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:38:32 - snowflake.connector.connection - INFO - closed
2025-01-26 04:38:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:38:33 - root - INFO - SQL:
SELECT DISTINCT assignee_f.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
  LATERAL FLATTEN(input => t."cpc") cpc_f
WHERE
  cpc_f.value:"code"::STRING ILIKE '%A61%'
LIMIT 100
Results:
assignee_name
ALPS SOUTH EUROPE S R O
CAREFUSION 2200 INC
MONTGOMERY ROBERT E
SIRIMANNE LAKSEN
MAQUET CARDIOPULMONARY AG
POOL SCOTT
MCCOY JAY R
INVACARE CORP
AMERICAN CYANAMID CO
VASCULAR SOLUTIONS INC
ZOLL MEDICAL CORP
SCINNOHUB PHARMACEUTICAL CO LTD
ALCON INC
GRAF IRINA V
GOLD NANCY
MICHELSON GARY K
GAROFALO ALBERT W
BRAINLAB AG
SUMITOMO SEIKA CHEMICALS
SYK TECH LLC
MEDTRONIC MINIMED INC
THESAN PHARMACEUTICALS INC
XU GUOZHANG
TIAN GONGLU
BAGARIA SANJAY
OULUN SEUDUN AMMATTIKORKEAKOUL
GERVAIS DANONE SA
JCE BIOTECHNOLOGY
SAMUELSON CONNOR E
KPR US LLC
HEARTFLOW INC
SCRAS
HOPE MEDICAL ENTPR INC
ALLERGAN INC
SYNAGEVA BIOPHARMA CORP
BHATTACHARYA BHAIRAB C
KYORIN SEIYAKU KK
RAYONIER INC
PARDES SPEZIALSTRUMPFE GMBH
NUTRINOVA GMBH
NAKAMURA MITSUHIRO
GUNDU RAMAKANT KASHINATH
UROVANT SCIENCES GMBH
WITHINGS
FAMECCANICA DATA SPA
A AHILA MISS
ATR ADVANCED TELECOMM RES INST
SUZUKI AKIRA
UTLEY DAVID S
TARGEGEN INC
SPEEDEL EXPERIMENTA AG
SLOAN KETTERING INST CANCER
YANG FENG
STROB WOLFGANG
GOERTEK INC
BARRESI FRANCESCO
SATO PHARMA
ALZCHEM TROSTBERG GMBH
BALU-IYER SATHY V
ZUERCHER WILLIAM J
BARNEA OFER
LYSTER THOMAS D
POLI DI TORINOTECNICO
AMNIOTICS AB
AUGUSTINE BIOMEDICAL DESIGN LLC
IFREMER
MEDJET INC
WHEEL RING INC
REVLON
RAYA ROBERT
YU SHUQIN
UNIV OF LEEDS INNOVATIONS LIMITED
HISHINUMA IEHARU
OKANO KAZUO
CLARUS THERAPEUTICS INC
ECOLE NAT SUPERIEURE DE LELECTRONIQUE ET DE SES APPLICATIONS
DRESSLER MATTHEW R
OMORI MACHINERY
BERGER HANS
FRIMLINE PRIVATE LTD
OSRAM OPTO SEMICONDUCTORS GMBH
2SEVENTY BIO INC
BRADFORD PHARMA LTD
ZENECA LTD
FIM MEDICAL
SHANGHAI MICROPORT ENDOVASCULAR MEDTECH GROUP CO LTD
EDWARDS LIFESCIENCES CARDIAQ LLC
ROQUETTE FRERES
NAUTILUS SUBSIDIARY INC
DOU ZULIN
LAM ERIC
DICERNA PHARMACEUTICALS INC
ORTHOFIX INC
SEDDON JON
DEIETSUTAA HAIAA
CHRISTOPHER JOHNS LYON
HUBER CORP J M
TOYO EIZAI KK
YICHUN JINQIU NATURAL BEVERAGE LTD LIABILITY CO
ADVERIO PHARMA GMBH

2025-01-26 04:38:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:38:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:38:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:38:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:38:34 - snowflake.connector.connection - INFO - closed
2025-01-26 04:38:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:38:35 - root - INFO - SQL:
SELECT
  SUBSTRING(TO_CHAR(t."filing_date"), 1, 4) AS "filing_year",
  COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."cpc") cpc_f
WHERE
  cpc_f.value:"code"::STRING ILIKE '%A61%'
  AND t."filing_date" > 0
GROUP BY SUBSTRING(TO_CHAR(t."filing_date"), 1, 4)
ORDER BY SUBSTRING(TO_CHAR(t."filing_date"), 1, 4) ASC
LIMIT 100
Results:
filing_year,patent_count
1899,2
1900,1
1903,1
1905,1
1906,2
1907,2
1908,1
1909,1
1910,2
1911,3
1913,5
1914,5
1915,3
1916,3
1917,1
1920,2
1921,4
1922,1
1923,3
1924,2
1926,2
1927,3
1928,6
1929,4
1930,1
1931,6
1932,3
1933,2
1934,4
1935,9
1936,10
1937,4
1938,3
1939,4
1940,6
1941,7
1942,2
1943,5
1944,4
1945,7
1946,6
1947,3
1948,8
1949,6
1950,9
1951,6
1952,7
1953,10
1954,7
1955,11
1956,7
1957,11
1958,15
1959,10
1960,11
1961,20
1962,17
1963,22
1964,22
1965,24
1966,34
1967,19
1968,32
1969,42
1970,47
1971,38
1972,64
1973,84
1974,89
1975,82
1976,94
1977,102
1978,112
1979,95
1980,104
1981,133
1982,122
1983,144
1984,117
1985,156
1986,179
1987,169
1988,212
1989,217
1990,249
1991,245
1992,281
1993,296
1994,303
1995,327
1996,363
1997,413
1998,445
1999,505
2000,511
2001,633
2002,640
2003,761
2004,756
2005,781

2025-01-26 04:38:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:38:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:38:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:38:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-26 04:38:36 - snowflake.connector.connection - INFO - closed
2025-01-26 04:38:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:38:37 - root - INFO - SQL:
SELECT
  t."publication_number",
  t."country_code",
  t."filing_date",
  assignee_f.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f
WHERE
  t."filing_date" > 0
LIMIT 100
Results:
Too long, hard cut:
publication_number,country_code,filing_date,assignee_name
US-2021279799-A1,US,20210520,Santeri Holdings LLC
US-2021280503-A1,US,20210524,MURATA MANUFACTURING CO
US-2021370805-A1,US,20210526,HONDA MOTOR CO LTD
US-2022115377-A1,US,20210527,SAMSUNG ELECTRONICS CO LTD
US-2021337708-A1,US,20210527,NORTHERN DIGITAL INC
US-2021301668-A1,US,20210611,RAYTHEON TECH CORP
US-2021309110-A1,US,20210615,BETA AIR LLC
US-2021329128-A1,US,20210628,UIPATH INC
US-2021393975-A1,US,20210628,AZUITE INC
US-2022058027-A1,US,20210708,PEGATRON CORP
US-2022019872-A1,US,20210713,UNITED MICROELECTRONICS CENTRE HONG KONG LTD
US-2021342874-A1,US,20210713,GROUPON INC
US-2023024156-A1,US,20210720,RAYTHEON CO
US-2022039139-A1,US,20210727,QUALCOMM INC
US-2022032466-A1,US,20210728,SEIKO EPSON CORP
US-2022104677-A1,US,20210729,IROBOT CORP
US-2023045347-A1,US,20210729,INTUIT INC
US-2023044499-A1,US,20210803,SALESFORCE COM INC
US-2021374177-A1,US,20210811,ALIPAY HANGZHOU INF TECH CO LTD
US-2021375401-A1,US,20210811,HEARTFLOW INC
US-2021375576-A1,US,20210817,UNIV KING FAHD PET & MINERALS
US-2022064817-A1,US,20210823,SENIC INC
US-2022171395-A1,US,20210722,UNIV CHONGQING
US-2021373958-A1,US,20210809,RED HAT INC
US-2023063525-A1,US,20210831,SIEMENS MOBILITY INC
US-2022108484-A1,US,20210927,QUALCOMM INC
US-2022027366-A1,US,20211005,BEIJING BAIDU NETCOM SCI & TECH CO LTD
US-2022140971-A1,US,20211101,APPLE INC
US-2021391241-A1,US,20210827,LAPIS SEMICONDUCTOR CO LTD
US-2023068910-A1,US,20210827,UCHICAGO ARGONNE LLC
US-2022083785-A1,US,20210910,SENSORMATIC ELECTRONICS LLC
US-2022074631-A1,US,20210910,UNIV CALIFORNIA
US-2023082670-A1,US,20210915,INTEL CORP
US-2022005035-A1,US,20210917,MASTERCARD INTERNATIONAL INC
US-2022103060-A1,US,20210920,ENPHASE ENERGY INC
US-2022155382-A1,US,20210921,TOYOTA MOTOR CO LTD
US-2023100952-A1,US,20210924,INTEL CORP
US-2022104887-A1,US,20211006,ASENSUS SURGICAL US INC
US-2022050484-A1,US,20211008,GRACO MINNESOTA INC
US-2022182297-A1,US,20211018,AMAZON TECH INC
US-2022144659-A1,US,20211026,SHIRAISHI CENTRAL LABORATORIES CO LTD
US-2022209647-A1,US,20211026,FUJI ELECTRIC CO LTD
US-2023140322-A1,US,20211102,MONSANTO TECHNOLOGY LLC
US-2022176513-A1,US,20211111,EBARA CORP
US-2023160349-A1,US,20211123,HAMILTON SUNDSTRAND CORP
US-2022189186-A1,US,20211130,CANON KK
US-2022091034-A1,US,20211202,OLYMPUS CORP
US-2022114746-A1,US,20211222,HUAWEI TECH CO LTD
US-2022116478-A1,US,20211223,BIEDERMAN DAN
US-2022116478-A1,US,20211223,TAN HAICHUAN
US-2022116478-A1,US,20211223,SAKHAMOORI PRADEEP
US-2022116478-A1,US,20211223,ARROBO VIDAL GABRIEL
US-2023191340-A1,US,20211220,SAUDI ARABIAN OIL CO
US-2023191340-A1,US,20211220,UNIV KING FAHD PET & MINERALS
US-2023136885-A1,US,20210205,LILLY CO ELI
US-2023106542-A1,US,20210215,KOBE STEEL LTD
US-2023091233-A1,US,20210309,EXXONMOBIL CHEMICAL PATENTS INC
US-2023115316-A1,US,20210319,DOLBY LABORATORIES LICENSING CORP
US-2023126843-A1,US,20210412,SUMITOMO ELECTRIC OPTIFRONTIER CO LTD
US-2023183444-A1,US,20210512,HUNTSMAN INT LLC
US-2023211524-A1,US,20210708,POLYTEX SPORTBELAEGE PRODUKTIONS GMBH
US-2023263221-A1,US,20211122,KT & G CORP
US-2023363113-A1,US,20210714,ERICSSON TELEFON AB L M
US-2023223535-A1,US,20210916,LG ENERGY SOLUTION LTD
US-2023310356-A1,US,20210325,NAT UNIV GYEONGSANG IACF
US-2023349229-A1,US,20211020,BLINDSPACE AB
US-2023379266-A1,US,20211130,ZTE CORP
US-2024007963-A1,US,20210126,ERICSSON TELEFON AB L M
US-2024017020-A1,US,20211119,SHL MEDICAL AG
US-2023343919-A1,US,20211005,FASTCAP SYSTEMS CORP
US-2023422615-A1,US,20211103,SAMSUNG DISPLAY CO LTD
US-2024016410-A1,US,20211117,SHENZHEN LIFETECH RESPIRATION SCIENT CO LTD
US-2024026309-A1,US,20211208,UNIV NORTH CAROLINA CHAPEL HILL
US-2024102954-A1,US,20211213,HYPERSONIQ B V
US-2022130404-A1,US,20220110,FRAUNHOFER GES FORSCHUNG
US-2022140065-A1,US,20220119,TAIWAN SEMICONDUCTOR MFG CO LTD
US-2023246093-A1,US,20220128,GLOBALFOUNDRIES US INC
US-2023242128-A1,US,20220128,BONDI TECH LIMITED
US-2024251645-A1,US,20220110,WUHAN CHINA STAR OPTOELECTRONICS SEMICONDUCTOR DISPLAY TECH CO LTD
US-2022215027-A1,US,20220329,SNOWFLAKE INC
US-2022356838-A1,US,20220505,CAELI LLC
US-2022237714-A1,US,20220330,MUKHERJEE GAUTAM
US-2023320231-A1,US,20220331,IBM
US-2023320231-A1,US,20220331,SAMSUNG ELECTRONICS CO LTD
US-2022241010-A1,US,20220413,TRANSSEPTAL SOLUTIONS LTD
US-2022250494-A1,US,20220429,HUAWEI DIGITAL POWER TECH CO LTD
US-2023353384-A1,US,20220502,BRUSO KELSEY L
US-2023353384-A1,US,20220502,WEGLEITNER BRIAN A
US-2023353384-A1,US,20220502,KAIN MICHAEL T
US-2023353384-A1,US,20220502,UNISYS CORP
US-2022322628-A1,US,20220511,RIJK ZWAAN ZAADTEELT EN ZAADHANDEL BV
US-2023367041-A1,US,20220513,META PLATFORMS TECH LLC
US-2022270320-A1,US,20220513,IMAGINATION TECH LTD
US-2022386575-A1,US,20220722,REGENERON PHARMA
US-2023118651-A1,US,20220831,APPLIED MATERIALS INC
US-2022292849-A1,US,20220527,HUAWEI TECH CO LTD
US-2023394297-A1,US,20220601,TOYOTA RES INST INC
US-2023394297-A1,US,20220601,TOYOTA MOTOR CO LTD
US-2023397296-A1,US,20220606,CISCO TECH INC
US-202230014

2025-01-26 04:38:37 - root - INFO - itercount: 0
2025-01-26 04:38:37 - root - INFO - Database Name: PATENTS
Schema Name: PATENTS
DDL describes table information.
,0
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,1
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""spif_publication_number"" VARCHAR(16777216),
	""spif_application_number"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""claims_localized_html"" VARIANT,
	""description_localized"" VARIANT,
	""description_localized_html"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""locarno"" VARIANT,
	""citation"" VARIANT,
	""parent"" VARIANT,
	""child"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,2
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

*Table:* `PATENTS.PATENTS.PUBLICATIONS`

- **"cpc"** (VARIANT): Potential usage - Extract CPC classification codes to identify patents classified under 'A61'.
- **"assignee_harmonized"** (VARIANT): Potential usage - Extract assignee names to find the most active assignee.
- **"filing_date"** (NUMBER): Potential usage - Determine the filing year to identify the busiest year for the assignee.
- **"country_code"** (VARCHAR): Potential usage - Identify the jurisdiction codes where patents were filed.
- **"publication_number"** (VARCHAR): Potential usage - Unique identifier for patents to count the number of filings.

**Conditions That May Be Used:**

- Filter patents where the "cpc" column contains CPC classification code 'A61'.
- Extract and aggregate patent counts per assignee to find the most active assignee.
- Extract the filing year from "filing_date" to determine the busiest year.
- Aggregate patent counts per "country_code" to identify top jurisdictions.
- Use string matching with `ILIKE` and `%` for fuzzy matching of assignee names.

---

**SQL Queries:**

1. **View the "cpc" Column Structure:**

   ```sql
   SELECT t."cpc"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 100;
   ```

2. **Extract Individual CPC Codes from the "cpc" Column:**

   ```sql
   SELECT
     f.value::VARIANT:"section"::STRING AS "cpc_section",
     f.value::VARIANT:"class"::STRING AS "cpc_class",
     f.value::VARIANT:"subclass"::STRING AS "cpc_subclass",
     f.value::VARIANT:"mainGroup"::STRING AS "cpc_main_group",
     f.value::VARIANT:"subGroup"::STRING AS "cpc_sub_group"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") f
   LIMIT 100;
   ```

3. **List Publication Numbers with Extracted CPC Codes:**

   ```sql
   SELECT
     t."publication_number",
     f.value::VARIANT:"section"::STRING AS "cpc_section",
     f.value::VARIANT:"class"::STRING AS "cpc_class",
     f.value::VARIANT:"subclass"::STRING AS "cpc_subclass"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") f
   LIMIT 100;
   ```

4. **Filter Patents Classified Under 'A61':**

   ```sql
   SELECT
     t."publication_number",
     f.value::VARIANT:"section"::STRING AS "cpc_section",
     f.value::VARIANT:"class"::STRING AS "cpc_class",
     f.value::VARIANT:"subclass"::STRING AS "cpc_subclass"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."cpc") f
   WHERE f.value::VARIANT:"section"::STRING = 'A'
     AND f.value::VARIANT:"class"::STRING = '61'
   LIMIT 100;
   ```

5. **Extract Assignee Names from "assignee_harmonized" Column:**

   ```sql
   SELECT
     t."publication_number",
     f.value::VARIANT:"name"::STRING AS "assignee_name"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f
   LIMIT 100;
   ```

6. **Combine Assignee Names with CPC Codes for 'A61' Patents:**

   ```sql
   SELECT
     t."publication_number",
     assignee_f.value::VARIANT:"name"::STRING AS "assignee_name",
     cpc_f.value::VARIANT:"section"::STRING AS "cpc_section",
     cpc_f.value::VARIANT:"class"::STRING AS "cpc_class"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
     LATERAL FLATTEN(input => t."cpc") cpc_f
   WHERE cpc_f.value::VARIANT:"section"::STRING = 'A'
     AND cpc_f.value::VARIANT:"class"::STRING = '61'
   LIMIT 100;
   ```

7. **Extract Filing Year from "filing_date":**

   Assuming "filing_date" is in YYYYMMDD format:

   ```sql
   SELECT
     t."filing_date",
     SUBSTR(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 100;
   ```

8. **Combine Assignee Names, CPC Codes, and Filing Year:**

   ```sql
   SELECT
     t."publication_number",
     assignee_f.value::VARIANT:"name"::STRING AS "assignee_name",
     cpc_f.value::VARIANT:"section"::STRING AS "cpc_section",
     cpc_f.value::VARIANT:"class"::STRING AS "cpc_class",
     SUBSTR(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
     LATERAL FLATTEN(input => t."cpc") cpc_f
   WHERE cpc_f.value::VARIANT:"section"::STRING = 'A'
     AND cpc_f.value::VARIANT:"class"::STRING = '61'
   LIMIT 100;
   ```

9. **Count Patents per Assignee in 'A61' Category:**

   ```sql
   SELECT
     assignee_f.value::VARIANT:"name"::STRING AS "assignee_name",
     COUNT(DISTINCT t."publication_number") AS "patent_count"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
     LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
     LATERAL FLATTEN(input => t."cpc") cpc_f
   WHERE cpc_f.value::VARIANT:"section"::STRING = 'A'
     AND cpc_f.value::VARIANT:"class"::STRING = '61'
   GROUP BY "assignee_name"
   ORDER BY "patent_count" DESC
   LIMIT 100;
   ```

10. **Count Patents per Assignee per Year in 'A61' Category:**

    ```sql
    SELECT
      assignee_f.value::VARIANT:"name"::STRING AS "assignee_name",
      SUBSTR(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
      COUNT(DISTINCT t."publication_number") AS "patent_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
      LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
      LATERAL FLATTEN(input => t."cpc") cpc_f
    WHERE cpc_f.value::VARIANT:"section"::STRING = 'A'
      AND cpc_f.value::VARIANT:"class"::STRING = '61'
    GROUP BY "assignee_name", "filing_year"
    ORDER BY "patent_count" DESC
    LIMIT 100;
    ```

11. **List Jurisdiction Codes for Patents Filed by an Assignee in a Specific Year:**

    Replace `'assignee_name_here'` and `'year_here'` with actual values.

    ```sql
    SELECT DISTINCT t."country_code"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
      LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f
    WHERE assignee_f.value::VARIANT:"name"::STRING ILIKE '%assignee_name_here%'
      AND SUBSTR(TO_VARCHAR(t."filing_date"), 1, 4) = 'year_here'
    LIMIT 100;
    ```

12. **Count Patents per Country Code for the Assignee's Busiest Year in 'A61' Category:**

    Replace `'assignee_name_here'` and `'year_here'` with actual values.

    ```sql
    SELECT
      t."country_code",
      COUNT(DISTINCT t."publication_number") AS "patent_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
      LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
      LATERAL FLATTEN(input => t."cpc") cpc_f
    WHERE assignee_f.value::VARIANT:"name"::STRING ILIKE '%assignee_name_here%'
      AND SUBSTR(TO_VARCHAR(t."filing_date"), 1, 4) = 'year_here'
      AND cpc_f.value::VARIANT:"section"::STRING = 'A'
      AND cpc_f.value::VARIANT:"class"::STRING = '61'
    GROUP BY t."country_code"
    ORDER BY "patent_count" DESC
    LIMIT 100;
    ```

13. **List All Assignees with Patents in 'A61' Category:**

    ```sql
    SELECT DISTINCT assignee_f.value::VARIANT:"name"::STRING AS "assignee_name"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
      LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
      LATERAL FLATTEN(input => t."cpc") cpc_f
    WHERE cpc_f.value::VARIANT:"section"::STRING = 'A'
      AND cpc_f.value::VARIANT:"class"::STRING = '61'
    LIMIT 100;
    ```

14. **Count Total Patents per Filing Year in 'A61' Category:**

    ```sql
    SELECT
      SUBSTR(TO_VARCHAR(t."filing_date"), 1, 4) AS "filing_year",
      COUNT(DISTINCT t."publication_number") AS "patent_count"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
      LATERAL FLATTEN(input => t."cpc") cpc_f
    WHERE cpc_f.value::VARIANT:"section"::STRING = 'A'
      AND cpc_f.value::VARIANT:"class"::STRING = '61'
    GROUP BY "filing_year"
    ORDER BY "filing_year" ASC
    LIMIT 100;
    ```

15. **List Patents Filed by the Most Active Assignee in Their Busiest Year:**

    Replace `'assignee_name_here'` and `'year_here'` with actual values.

    ```sql
    SELECT
      t."publication_number",
      t."country_code",
      t."filing_date"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
      LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f
    WHERE assignee_f.value::VARIANT:"name"::STRING ILIKE '%assignee_name_here%'
      AND SUBSTR(TO_VARCHAR(t."filing_date"), 1, 4) = 'year_here'
    LIMIT 100;
    ```

---

These queries help in understanding how to extract and manipulate the data required to identify the most active assignee in the 'A61' patent category, determine their busiest year, and find the top five jurisdiction codes where they filed the most patents during that year.Query:
SELECT t."cpc"
   FROM PATENTS.PATENTS.PUBLICATIONS t
   LIMIT 100;
Answer:
Too long, hard cut:
cpc
[]
[]
[]
"[
  {
    ""code"": ""H02M5/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""A01N47/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D521/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""Y02A40/81"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""Y02E30/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""Y10T83/465"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""B26F1/42"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""B22D11/086"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""C07D471/16"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D471/22"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""G01N33/48728"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""C11B5/0064"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/35"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C11B5/0035"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M135/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C09K15/30"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D263/56"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/44"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D235/12"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/3447"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/48"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/46"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D277/64"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/47"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/224"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/102"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/106"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/104"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/10"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/221"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/226"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/225"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/22"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10L1/14"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
"[
  {
    ""code"": ""E02D5/808"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/385"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/26"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/28"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/54"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
[]
[]
"[
  {
    ""code"": ""C07D213/32"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/51"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/51"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/22"",
    ""first"": true,
    ""inventive"": true,
    ""t
Query:
SELECT
  t."publication_number",
  cpc_code_f."code" AS "cpc_code",
  SUBSTRING(cpc_code_f."code", 1, 1) AS "cpc_section",
  SUBSTRING(cpc_code_f."code", 2, 2) AS "cpc_class",
  SUBSTRING(cpc_code_f."code", 4, 1) AS "cpc_subclass",
  REGEXP_SUBSTR(cpc_code_f."code", '[0-9]+') AS "cpc_main_group",
  SPLIT_PART(cpc_code_f."code", '/', 2) AS "cpc_subgroup"
FROM
  PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."cpc") AS cpc_f,
  LATERAL (
    SELECT cpc_f.value::VARIANT:"code"::STRING AS "code"
  ) AS cpc_code_f
LIMIT 100;
Answer:
publication_number,cpc_code,cpc_section,cpc_class,cpc_subclass,cpc_main_group,cpc_subgroup
AU-2011273409-A1,A61P31/04,A,61,P,61,04
AU-2011273409-A1,A61P37/06,A,61,P,61,06
AU-2011273409-A1,A61P33/02,A,61,P,61,02
AU-2011273409-A1,A61P33/00,A,61,P,61,00
AU-2011273409-A1,A61P37/00,A,61,P,61,00
AU-2011273409-A1,A61P35/00,A,61,P,61,00
AU-2011273409-A1,A61P31/12,A,61,P,61,12
AU-2011273409-A1,A61P25/00,A,61,P,61,00
AU-2011273409-A1,A61P25/28,A,61,P,61,28
AU-2011273409-A1,A61P27/02,A,61,P,61,02
AU-2011273409-A1,A61P29/00,A,61,P,61,00
AU-2011273409-A1,C07C233/59,C,07,C,07,59
AU-2011273409-A1,A61P19/04,A,61,P,61,04
AU-2011273409-A1,C07C255/60,C,07,C,07,60
AU-2011273409-A1,A61P11/06,A,61,P,61,06
AU-2011273409-A1,C07D307/30,C,07,D,07,30
AU-2011273409-A1,C07C233/60,C,07,C,07,60
AU-2011273409-A1,C07D307/30,C,07,D,07,30
AU-2011273409-A1,C07C233/59,C,07,C,07,59
AU-2011273409-A1,A61P17/02,A,61,P,61,02
AU-2011273409-A1,A61P17/00,A,61,P,61,00
AU-2011273409-A1,C07D333/38,C,07,D,07,38
AU-2011273409-A1,C07D333/38,C,07,D,07,38
AU-2011273409-A1,A61P1/04,A,61,P,61,04
AU-2011273409-A1,C07D333/58,C,07,D,07,58
AU-2011273409-A1,A61P1/00,A,61,P,61,00
AU-2011273409-A1,A61P11/02,A,61,P,61,02
AU-2011273409-A1,A61P19/02,A,61,P,61,02
AU-2011273409-A1,A61P17/06,A,61,P,61,06
AU-2011273409-A1,C07C2601/10,C,07,C,07,10
AU-2011273409-A1,C07C233/58,C,07,C,07,58
AU-2011273409-A1,C07D333/38,C,07,D,07,38
AU-2011273409-A1,C07C233/60,C,07,C,07,60
AU-2011273409-A1,C07C255/60,C,07,C,07,60
AU-2011273409-A1,C07C233/59,C,07,C,07,59
AU-2011273409-A1,C07D307/30,C,07,D,07,30
AU-2011273409-A1,C07D333/58,C,07,D,07,58
AU-2011273409-A1,C07C2601/10,C,07,C,07,10
AU-2011309865-A1,A61M16/0443,A,61,M,61,0443
AU-2011309865-A1,A61M16/0463,A,61,M,61,0463
AU-2011309865-A1,A61M16/0409,A,61,M,61,0409
AU-2011309865-A1,A61M16/0415,A,61,M,61,0415
AU-2011309865-A1,A61M16/0493,A,61,M,61,0493
AU-2011309865-A1,A61M16/0409,A,61,M,61,0409
AU-2011309865-A1,A61M16/0493,A,61,M,61,0493
AU-2011309865-A1,A61M16/0488,A,61,M,61,0488
AU-2011309865-A1,A61M16/0488,A,61,M,61,0488
AU-2011309865-A1,A61M16/0443,A,61,M,61,0443
AU-2011316476-A1,E01F13/12,E,01,F,01,12
AU-2011316476-A1,E01F13/022,E,01,F,01,022
AU-2011316476-A1,E04H17/18,E,04,H,04,18
AU-2011316476-A1,E04H17/163,E,04,H,04,163
AU-2011316476-A1,E04H17/163,E,04,H,04,163
AU-2011318232-A1,H04R1/26,H,04,R,04,26
AU-2011318232-A1,H04R1/02,H,04,R,04,02
AU-2011318232-A1,G10K11/20,G,10,K,10,20
AU-2011318232-A1,H04R1/24,H,04,R,04,24
AU-2011318232-A1,H04R1/025,H,04,R,04,025
AU-2011318232-A1,H04R7/127,H,04,R,04,127
AU-2011318232-A1,H04R1/345,H,04,R,04,345
AU-2011318232-A1,H04R2203/12,H,04,R,04,12
AU-2011318232-A1,H04R5/04,H,04,R,04,04
AU-2011318232-A1,H04R1/403,H,04,R,04,403
AU-2011318232-A1,H04R1/345,H,04,R,04,345
AU-2011318232-A1,G10K11/20,G,10,K,10,20
AU-2011318232-A1,G10K11/20,G,10,K,10,20
AU-2011318232-A1,H04R19/02,H,04,R,04,02
AU-2011318232-A1,G10K11/28,G,10,K,10,28
AU-2012271450-A1,A61K41/0038,A,61,K,61,0038
AU-2012271450-A1,A61K2039/505,A,61,K,61,505
AU-2012271450-A1,A61P43/00,A,61,P,61,00
AU-2012271450-A1,A61P35/00,A,61,P,61,00
AU-2012271450-A1,A61P35/04,A,61,P,61,04
AU-2012271450-A1,C07K16/28,C,07,K,07,28
AU-2012271450-A1,A61P9/00,A,61,P,61,00
AU-2012271450-A1,A61K41/0038,A,61,K,61,0038
AU-2012271450-A1,A61K2039/505,A,61,K,61,505
AU-2012271450-A1,C07K16/28,C,07,K,07,28
AU-2012275974-A1,C10G29/205,C,10,G,10,205
AU-2012275974-A1,B01J31/0284,B,01,J,01,0284
AU-2012275974-A1,C10G29/26,C,10,G,10,26
AU-2012275974-A1,C10G25/00,C,10,G,10,00
AU-2012275974-A1,C10G2300/1081,C,10,G,10,1081
AU-2012275974-A1,C10G2400/08,C,10,G,10,08
AU-2012275974-A1,C10G2400/10,C,10,G,10,10
AU-2012275974-A1,C10G25/12,C,10,G,10,12
AU-2012275974-A1,C10G2300/1088,C,10,G,10,1088
AU-2012275974-A1,C10G2400/02,C,10,G,10,02
AU-2012275974-A1,C10G2300/4018,C,10,G,10,4018
AU-2012275974-A1,C10G2400/04,C,10,G,10,04
AU-2012275974-A1,B01J20/34,B,01,J,01,34
AU-2012275974-A1,B01J20/22,B,01,J,01,22
AU-2012275974-A1,B01J20/18,B,01,J,01,18
AU-2012275974-A1,B01J31/0284,B,01,J,01,0284
AU-2012275974-A1,C10G29/26,C,10,G,10,26
AU-2012275974-A1,C10G25/12,C,10,G,10,12
AU-2012275974-A1,C10G2300/4018,C,10,G,10,4018
AU-2012275974-A1,C10G25/00,C,10,G,10,00
AU-2012275974-A1,C10G2300/1088,C,10,G,10,1088
AU-2012275974-A1,C10G2300/1081,C,10,G,10,1081
Query:
SELECT
  t."publication_number",
  cpc_f.value:"code"::STRING AS "cpc_code",
  SUBSTRING(cpc_f.value:"code"::STRING, 1, 1) AS "cpc_section",
  SUBSTRING(cpc_f.value:"code"::STRING, 2, 2) AS "cpc_class",
  SUBSTRING(cpc_f.value:"code"::STRING, 4, 1) AS "cpc_subclass",
  REGEXP_SUBSTR(cpc_f.value:"code"::STRING, '[0-9]+') AS "cpc_main_group",
  SPLIT_PART(cpc_f.value:"code"::STRING, '/', 2) AS "cpc_subgroup"
FROM
  PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."cpc") AS cpc_f
WHERE
  cpc_f.value:"code"::STRING IS NOT NULL
LIMIT 100;
Answer:
publication_number,cpc_code,cpc_section,cpc_class,cpc_subclass,cpc_main_group,cpc_subgroup
CN-216675802-U,A61B17/50,A,61,B,61,50
CN-216675802-U,A61B17/00,A,61,B,61,00
CN-216675802-U,A61B10/04,A,61,B,61,04
CN-216941023-U,Y02P70/50,Y,02,P,02,50
CN-216587632-U,Y02A40/25,Y,02,A,02,25
CN-217773534-U,Y02E50/30,Y,02,E,02,30
CN-217773534-U,Y02E50/10,Y,02,E,02,10
CN-216633597-U,Y02P70/10,Y,02,P,02,10
CN-216664325-U,Y02A20/00,Y,02,A,02,00
CN-216874023-U,Y02P60/12,Y,02,P,02,12
CN-217449500-U,Y02P70/10,Y,02,P,02,10
CN-216634960-U,Y02P70/10,Y,02,P,02,10
CN-217275293-U,Y02P70/10,Y,02,P,02,10
CN-217288905-U,Y02P70/10,Y,02,P,02,10
CN-218951157-U,Y02W10/10,Y,02,W,02,10
CN-216361969-U,Y02E10/50,Y,02,E,02,50
CN-217195488-U,Y02A40/81,Y,02,A,02,81
CN-216637581-U,Y02W90/10,Y,02,W,02,10
CN-216887342-U,Y02W30/80,Y,02,W,02,80
CN-217318772-U,Y02W30/62,Y,02,W,02,62
CN-216633247-U,Y02P70/50,Y,02,P,02,50
CN-216521063-U,Y02B20/40,Y,02,B,02,40
CN-216647911-U,Y02A30/14,Y,02,A,02,14
CN-216808647-U,Y02W30/40,Y,02,W,02,40
CN-217169415-U,Y02P70/62,Y,02,P,02,62
CN-216697169-U,Y02E60/10,Y,02,E,02,10
CN-217240100-U,Y02E10/50,Y,02,E,02,50
CN-216825439-U,Y02P70/10,Y,02,P,02,10
CN-216825439-U,Y02E10/50,Y,02,E,02,50
CN-217291789-U,Y02W30/62,Y,02,W,02,62
CN-218335793-U,Y02T10/64,Y,02,T,02,64
CN-216937316-U,Y02P70/50,Y,02,P,02,50
CN-217167538-U,Y02T90/00,Y,02,T,02,00
CN-217282288-U,Y02E60/10,Y,02,E,02,10
CN-217230856-U,Y02P10/20,Y,02,P,02,20
CN-216936156-U,Y02A50/2351,Y,02,A,02,2351
CN-217273540-U,Y02E60/32,Y,02,E,02,32
CN-217250506-U,Y02W30/62,Y,02,W,02,62
CN-217403757-U,Y02A10/40,Y,02,A,02,40
CN-216906732-U,Y02A40/90,Y,02,A,02,90
CN-216958049-U,Y02E10/50,Y,02,E,02,50
CN-217262114-U,Y02W90/10,Y,02,W,02,10
CN-217444585-U,Y02E60/10,Y,02,E,02,10
CN-217444585-U,Y02P70/50,Y,02,P,02,50
CN-217364212-U,Y02P60/87,Y,02,P,02,87
CN-216920098-U,Y02E10/50,Y,02,E,02,50
CN-217270196-U,Y02E10/20,Y,02,E,02,20
CN-217434729-U,Y02W30/62,Y,02,W,02,62
CN-217497168-U,Y02W30/80,Y,02,W,02,80
CN-217276550-U,Y02P10/25,Y,02,P,02,25
CN-217288114-U,Y02W10/10,Y,02,W,02,10
CN-216937347-U,Y02A40/81,Y,02,A,02,81
CN-217156472-U,Y02B30/70,Y,02,B,02,70
CN-217334034-U,Y02P70/50,Y,02,P,02,50
CN-217270467-U,Y02T10/12,Y,02,T,02,12
CN-217312500-U,Y02E60/10,Y,02,E,02,10
CN-217613367-U,Y02P10/20,Y,02,P,02,20
CN-218942555-U,Y02D10/00,Y,02,D,02,00
CN-217439994-U,Y02A20/00,Y,02,A,02,00
CN-217386843-U,Y02E40/30,Y,02,E,02,30
CN-217343465-U,Y02E10/20,Y,02,E,02,20
CN-217475571-U,Y02W30/60,Y,02,W,02,60
CN-217752268-U,Y02W30/62,Y,02,W,02,62
CN-217163521-U,Y02A40/20,Y,02,A,02,20
CN-217397113-U,Y02A50/20,Y,02,A,02,20
CN-217252471-U,Y02E10/728,Y,02,E,02,728
CN-217517262-U,Y02A30/30,Y,02,A,02,30
CN-217782329-U,Y02E10/20,Y,02,E,02,20
CN-217307452-U,Y02T10/64,Y,02,T,02,64
CN-217152872-U,Y02E10/50,Y,02,E,02,50
CN-218162281-U,Y02E10/50,Y,02,E,02,50
CN-217229396-U,Y02E30/30,Y,02,E,02,30
CN-218916914-U,Y02A20/20,Y,02,A,02,20
CN-218016264-U,Y02P70/10,Y,02,P,02,10
CN-217729205-U,Y02W30/91,Y,02,W,02,91
CN-217341437-U,Y02A20/00,Y,02,A,02,00
CN-217152121-U,Y02P70/10,Y,02,P,02,10
CN-217352353-U,Y02E10/20,Y,02,E,02,20
CN-217667764-U,Y02P70/10,Y,02,P,02,10
CN-218376178-U,Y02B80/22,Y,02,B,02,22
CN-218376178-U,Y02A30/249,Y,02,A,02,249
CN-217383915-U,Y02E60/10,Y,02,E,02,10
CN-218506003-U,Y02T10/82,Y,02,T,02,82
CN-217677004-U,Y02W10/10,Y,02,W,02,10
CN-218711270-U,Y02P70/62,Y,02,P,02,62
CN-217679715-U,Y02B30/90,Y,02,B,02,90
CN-217679715-U,Y02A30/00,Y,02,A,02,00
CN-217502971-U,Y02A50/20,Y,02,A,02,20
CN-217888607-U,Y02P60/87,Y,02,P,02,87
CN-217741069-U,Y02B20/40,Y,02,B,02,40
CN-217805994-U,Y02W30/80,Y,02,W,02,80
CN-218887001-U,Y02E40/30,Y,02,E,02,30
CN-218887001-U,Y02E40/40,Y,02,E,02,40
CN-218479456-U,Y02A30/244,Y,02,A,02,244
CN-218900211-U,Y02P60/80,Y,02,P,02,80
CN-218853167-U,Y02A50/20,Y,02,A,02,20
CN-219775735-U,Y02E20/34,Y,02,E,02,34
CN-219322133-U,Y02E10/50,Y,02,E,02,50
CN-218089130-U,Y02W10/10,Y,02,W,02,10
CN-217921870-U,Y02W30/40,Y,02,W,02,40
Query:
SELECT
  t."publication_number",
  SUBSTRING(cpc_f.value:"code"::STRING, 1, 1) AS "cpc_section",
  SUBSTRING(cpc_f.value:"code"::STRING, 2, 2) AS "cpc_class",
  SUBSTRING(cpc_f.value:"code"::STRING, 4, 1) AS "cpc_subclass"
FROM PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."cpc") cpc_f
WHERE
  SUBSTRING(cpc_f.value:"code"::STRING, 1, 1) = 'A'
  AND SUBSTRING(cpc_f.value:"code"::STRING, 2, 2) = '61'
LIMIT 100
Answer:
publication_number,cpc_section,cpc_class,cpc_subclass
US-2001010465-A1,A,61,B
US-2001035503-A1,A,61,B
US-2001035503-A1,A,61,B
US-2001035503-A1,A,61,B
US-2001035503-A1,A,61,B
US-2002040191-A1,A,61,B
US-2002040191-A1,A,61,N
US-2002040191-A1,A,61,B
US-2002040191-A1,A,61,N
US-2002040191-A1,A,61,B
US-2002040191-A1,A,61,B
US-2007218026-A1,A,61,P
US-2007218026-A1,A,61,P
US-2007218026-A1,A,61,K
US-2007218026-A1,A,61,K
US-2002151787-A1,A,61,B
US-2002151787-A1,A,61,K
US-2002151787-A1,A,61,K
US-2002151787-A1,A,61,B
US-2004016004-A1,A,61,K
US-2004016004-A1,A,61,K
US-2004016004-A1,A,61,P
US-2004016004-A1,A,61,K
US-2004016004-A1,A,61,K
US-2003180864-A1,A,61,K
US-2003180864-A1,A,61,K
US-2003180864-A1,A,61,K
US-2003180864-A1,A,61,K
US-2003180864-A1,A,61,K
US-2003180864-A1,A,61,K
US-2003180864-A1,A,61,K
US-2003180864-A1,A,61,K
US-2003180864-A1,A,61,K
US-2003180864-A1,A,61,K
US-2003180864-A1,A,61,K
US-2003180864-A1,A,61,K
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2003080854-A1,A,61,J
US-2004019030-A1,A,61,K
US-2004019030-A1,A,61,K
US-2004019030-A1,A,61,K
US-2004019030-A1,A,61,K
US-2004019030-A1,A,61,K
US-2004019030-A1,A,61,K
US-2003114552-A1,A,61,L
US-2003114552-A1,A,61,L
US-2003114552-A1,A,61,L
US-2003114552-A1,A,61,L
US-2003114552-A1,A,61,L
US-2003114552-A1,A,61,L
US-2003131380-A1,A,61,Q
US-2003131380-A1,A,61,K
US-2003131380-A1,A,61,P
US-2003131380-A1,A,61,K
US-2003131380-A1,A,61,K
US-2003131380-A1,A,61,K
US-2003131380-A1,A,61,Q
US-2004009906-A1,A,61,P
US-2004009906-A1,A,61,P
US-2004009906-A1,A,61,P
US-2004009906-A1,A,61,P
US-2004009906-A1,A,61,P
US-2004009906-A1,A,61,K
US-2004009906-A1,A,61,K
US-2004009906-A1,A,61,K
US-2004009906-A1,A,61,K
US-2004009906-A1,A,61,K
US-2004009906-A1,A,61,P
US-2004009906-A1,A,61,K
US-2004009906-A1,A,61,K
US-2004009906-A1,A,61,K
US-2004009906-A1,A,61,K
US-2004009906-A1,A,61,K
US-2004009906-A1,A,61,K
US-2004009906-A1,A,61,K
US-2004006039-A1,A,61,K
US-2004006039-A1,A,61,K
US-2004122350-A1,A,61,B
US-2004122350-A1,A,61,B
US-2004122350-A1,A,61,B
US-2004122350-A1,A,61,B
US-2004122350-A1,A,61,B
US-2004122350-A1,A,61,B
US-2004122350-A1,A,61,B
Query:
SELECT
  t."publication_number",
  assignee_f.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f
LIMIT 100
Answer:
publication_number,assignee_name
US-2018247292-A1,NCR CORP
US-2017261139-A1,STAUBLI SA ETS
US-2017264027-A1,SWITCHLAB INC
US-2017264027-A1,SWITCHLAB (SHANGHAI) CO LTD
US-2017260782-A1,HARTWELL CORP
US-2017353393-A1,COMCAST CABLE COMM LLC
US-2017278633-A1,TAIYO YUDEN KK
US-2017195921-A1,APPLE INC
US-2018272493-A1,TRAINA JOHN
US-2018272493-A1,MCCALL EDWARD L
US-2018272493-A1,LEHNING JEREMY
US-2018272493-A1,NCRX OPTICAL SOLUTIONS INC
US-2017200241-A1,NIPPON GAS CO LTD
US-2017289656-A1,LUO ALEX
US-2017289656-A1,BUSH TERRY W
US-2017282443-A1,GIANADDA PAUL H
US-2017293799-A1,TOBII AB
US-2017259523-A1,TOTAL RES & TECHNOLOGY FELUY
US-2017259523-A1,POLYNT COMPOSITES FRANCE
US-2017248791-A1,REICHERT ABRAHAM
US-2017235069-A1,RISCH BRIAN G
US-2017235069-A1,COLLADO DENISE
US-2017235069-A1,PRYSMIAN SPA
US-2018016555-A1,FIVE PRIME THERAPEUTICS INC
US-2017329169-A1,SHARP KK
US-2017305344-A1,MITSUBISHI ELECTRIC CORP
US-2018004217-A1,BOSCH GMBH ROBERT
US-2018274585-A1,CANON KK
US-2018154711-A1,KOSE SADI
US-2018154711-A1,LAWSON ROBERT CECIL
US-2018154711-A1,MORGAN DAVID SCOTT
US-2018154711-A1,MICHELIN & CIE
US-2018158316-A1,LG ELECTRONICS INC
US-2018100108-A1,SAGE & TIME LLP
US-2018124578-A1,ERICSSON TELEFON AB L M
US-2018350148-A1,PERFECTFIT SYSTEMS PVT LTD
US-2017363542-A1,SCHLUMBERGER TECHNOLOGY CORP
US-2018144132-A1,UNIV SICHUAN
US-2018027472-A1,SILERGY SEMICONDUCTOR TECH (HANGZHOU) LTD
US-2017312009-A1,ST JUDE MEDICAL ATRIAL FIBRILLATION DIV INC
US-2018020543-A1,SAMSUNG DISPLAY CO LTD
US-2017331573-A1,HUAWEI TECH CO LTD
US-2018056157-A1,COHEN BERNARD
US-2018056157-A1,RICCIARDI JOSEPH
US-2017358178-A1,KING SHOW GAMES INC
US-2018234160-A1,REALTEK SEMICONDUCTOR CORP
US-2019080618-A1,BOEING CO
US-2018104635-A1,NGK INSULATORS LTD
US-2018025593-A1,NOVAR ED&S LTD
US-2018247678-A1,VERGIS GEORGE
US-2018247678-A1,LE DAT
US-2018064440-A1,ETHICON LLC
US-2018124149-A1,INSTART LOGIC INC
US-2019019479-A1,STRICKLAND MATHEW EPHRAM
US-2019177377-A1,SYNGENTA PARTICIPATIONS AG
US-2018180555-A1,SHELL OIL CO
US-2018180555-A1,UNIV CHINA PETROLEUM
US-2019187138-A1,NANOSNIFF TECH PVT LTD
US-2018211505-A1,KONINKLIJKE PHILIPS NV
US-2018369831-A1,DH TECHNOLOGIES DEV PTE LTD
US-2018039078-A1,OSTENDO TECHNOLOGIES INC
US-2018070387-A1,IRIDIUM SATELLITE LLC
US-2018062285-A1,EATON CORP
US-2019129962-A1,ADOBE SYSTEMS INC
US-2018127725-A1,UNIV WAYNE STATE
US-2018073963-A1,OLYMPUS CORP
US-2018222783-A1,TIMMONS MARK STEPHEN
US-2018222783-A1,BENZ JEFFREY ALLEN
US-2018234779-A1,WINBOND ELECTRONICS CORP
US-2019164859-A1,ADVANCED SEMICONDUCTOR ENG
US-2018154845-A1,BOSCH GMBH ROBERT
US-2018109714-A1,IBM
US-2018170733-A1,JUNGHEINRICH AG
US-2018205546-A1,ASSETVAULT LTD
US-2019208025-A1,FACEBOOK INC
US-2018280336-A1,ENZYCHEM LIFESCIENCES CORP
US-2018280336-A1,KOREA RES INSTITUTE OF BIO SCIENCE AND BIOTECHNOLOGY
US-2018195257-A1,XIAMEN RUNNER IND CORPORATION
US-2019212770-A1,NXP BV
US-2018144605-A1,CERNER INNOVATION INC
US-2018326219-A1,WOLF II ERICH W
US-2018218898-A1,HITACHI INT ELECTRIC INC
US-2019240737-A1,ISCAR LTD
US-2018238660-A1,ADVANCED BLAST & BALLISTIC SYSTEMS LTD
US-2019273364-A1,CISCO TECH INC
US-2018194441-A1,FALCK LEE
US-2018261780-A1,SAMSUNG ELECTRONICS CO LTD
US-2018261780-A1,SAMSUNG SDI CO LTD
US-2018212109-A1,SEOUL VIOSYS CO LTD
US-2020365844-A1,SK INNOVATION CO LTD
US-2018221420-A1,UNIV UNITED ARAB EMIRATES
US-2019104107-A1,FISHER ROSEMOUNT SYSTEMS INC
US-2018230177-A1,IMMUNE SENSOR LLC
US-2018230177-A1,UNIV TEXAS
US-2019318282-A1,BANK OF AMERICA
US-2018307833-A1,Level Effect LLC
US-2018242172-A1,LG ELECTRONICS INC
US-2019199611-A1,APPLE INC
US-2019131878-A1,MITSUBISHI ELECTRIC CORP
US-2018246979-A1,EBAY INC
Query:
SELECT
  t."publication_number",
  assignee_f.value:"name"::STRING AS "assignee_name",
  SUBSTRING(cpc_f.value:"code"::STRING, 1, 1) AS "cpc_section",
  SUBSTRING(cpc_f.value:"code"::STRING, 2, 2) AS "cpc_class"
FROM PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
  LATERAL FLATTEN(input => t."cpc") cpc_f
WHERE
  SUBSTRING(cpc_f.value:"code"::STRING, 1, 1) = 'A'
  AND SUBSTRING(cpc_f.value:"code"::STRING, 2, 2) = '61'
LIMIT 100
Answer:
publication_number,assignee_name,cpc_section,cpc_class
US-2007071679-A1,HILAKIVI ILKKA T,A,61
US-2007071679-A1,HILAKIVI ILKKA T,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2007233220-A1,MEDTRONIC VASCULAR INC,A,61
US-2006199768-A1,UNIV NORTH CAROLINA,A,61
US-2006199768-A1,UNIV NORTH CAROLINA,A,61
US-2006199768-A1,UNIV NORTH CAROLINA,A,61
US-2006199768-A1,UNIV NORTH CAROLINA,A,61
US-2006199768-A1,UNIV NORTH CAROLINA,A,61
US-2006199768-A1,UNIV NORTH CAROLINA,A,61
US-2006199768-A1,UNIV NORTH CAROLINA,A,61
US-2006199768-A1,UNIV NORTH CAROLINA,A,61
US-2006199768-A1,UNIV NORTH CAROLINA,A,61
US-2006199768-A1,UNIV NORTH CAROLINA,A,61
US-2006199768-A1,UNIV NORTH CAROLINA,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006287223-A1,NEOSE TECHNOLOGIES INC,A,61
US-2006293245-A1,CYCLACEL LTD,A,61
US-2006293245-A1,CYCLACEL LTD,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258976-A1,SHTURMAN CARDIOLOGY SYSTEMS,A,61
US-2006258950-A1,SYNERGISTIC NEUROTHERAPY ADJUS,A,61
US-2006258950-A1,SYNERGISTIC NEUROTHERAPY ADJUS,A,61
US-2006258950-A1,SYNERGISTIC NEUROTHERAPY ADJUS,A,61
US-2006258950-A1,SYNERGISTIC NEUROTHERAPY ADJUS,A,61
US-2006258950-A1,SYNERGISTIC NEUROTHERAPY ADJUS,A,61
US-2006258950-A1,SYNERGISTIC NEUROTHERAPY ADJUS,A,61
US-2006258950-A1,SYNERGISTIC NEUROTHERAPY ADJUS,A,61
US-2006258950-A1,SYNERGISTIC NEUROTHERAPY ADJUS,A,61
US-2007260229-A1,NAVARRO LUIS,A,61
US-2007260229-A1,NAVARRO LUIS,A,61
US-2007260229-A1,NAVARRO LUIS,A,61
Query:
SELECT
  t."filing_date",
  EXTRACT(year FROM TO_DATE(TO_CHAR(t."filing_date"), 'YYYYMMDD')) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t
WHERE t."filing_date" > 0
LIMIT 100;
Answer:
filing_date,filing_year
20080425,2008
19950404,1995
19931103,1993
19990929,1999
19910125,1991
19920416,1992
19951018,1995
19960503,1996
19920325,1992
19991210,1999
19910204,1991
19911113,1991
19920625,1992
19950531,1995
19990607,1999
19910129,1991
19910725,1991
19920701,1992
19960919,1996
19961112,1996
19990910,1999
20121119,2012
20160610,2016
20171227,2017
20190724,2019
20201229,2020
19770131,1977
19780213,1978
19801003,1980
19820512,1982
19831018,1983
19831109,1983
19890718,1989
19891102,1989
19901229,1990
19931122,1993
19980526,1998
19970520,1997
19990119,1999
19991231,1999
20011003,2001
20031104,2003
20031211,2003
20030808,2003
20070716,2007
20070917,2007
20080430,2008
20111215,2011
20120706,2012
20140702,2014
20150629,2015
20180427,2018
20201006,2020
20050406,2005
20050408,2005
20050414,2005
20080422,2008
20050415,2005
20050414,2005
20050418,2005
20050421,2005
20080430,2008
20020327,2002
20020405,2002
20050503,2005
20080516,2008
20050506,2005
20050511,2005
20080603,2008
20050519,2005
20080611,2008
20020508,2002
20080619,2008
20020510,2002
20080623,2008
20050609,2005
20050620,2005
20050621,2005
20061212,2006
20020530,2002
20050729,2005
20020605,2002
20020604,2002
20080702,2008
20080702,2008
20050629,2005
20050708,2005
20010214,2001
20080730,2008
20050721,2005
20050722,2005
20080806,2008
20020703,2002
20020703,2002
20020702,2002
20050726,2005
20050728,2005
20080814,2008
20050729,2005
20050801,2005
Query:
SELECT
  t."publication_number",
  assignee_f.value:"name"::STRING AS "assignee_name",
  SUBSTRING(cpc_f.value:"code"::STRING, 1, 1) AS "cpc_section",
  SUBSTRING(cpc_f.value:"code"::STRING, 2, 2) AS "cpc_class",
  SUBSTRING(TO_CHAR(t."filing_date"), 1, 4) AS "filing_year"
FROM PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
  LATERAL FLATTEN(input => t."cpc") cpc_f
WHERE
  SUBSTRING(cpc_f.value:"code"::STRING, 1, 1) = 'A'
  AND SUBSTRING(cpc_f.value:"code"::STRING, 2, 2) = '61'
  AND t."filing_date" > 0
LIMIT 100
Answer:
publication_number,assignee_name,cpc_section,cpc_class,filing_year
US-2018235635-A1,NORWEGIAN UNIV SCI & TECH NTNU,A,61,2017
US-2018235635-A1,NORWEGIAN UNIV SCI & TECH NTNU,A,61,2017
US-2018235635-A1,NORWEGIAN UNIV SCI & TECH NTNU,A,61,2017
US-2018235635-A1,NORWEGIAN UNIV SCI & TECH NTNU,A,61,2017
US-2018235635-A1,NORWEGIAN UNIV SCI & TECH NTNU,A,61,2017
US-2018235635-A1,NORWEGIAN UNIV SCI & TECH NTNU,A,61,2017
US-2018235635-A1,NORWEGIAN UNIV SCI & TECH NTNU,A,61,2017
US-2018235635-A1,NORWEGIAN UNIV SCI & TECH NTNU,A,61,2017
US-2018235635-A1,NORWEGIAN UNIV SCI & TECH NTNU,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2018344618-A1,OREAL,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2017312220-A1,DELCOR ASSET CORP,A,61,2017
US-2018021729-A1,COLLINS CONOR,A,61,2017
US-2018021729-A1,COLLINS CONOR,A,61,2017
US-2018021729-A1,COLLINS CONOR,A,61,2017
US-2018021729-A1,COLLINS CONOR,A,61,2017
US-2018021729-A1,COLLINS CONOR,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018043016-A1,XTL BIOPHARMACEUTICALS LTD,A,61,2017
US-2018308237-A1,SAMSUNG ELECTRONICS CO LTD,A,61,2017
US-2018308237-A1,SAMSUNG ELECTRONICS CO LTD,A,61,2017
US-2018308237-A1,SAMSUNG ELECTRONICS CO LTD,A,61,2017
US-2018308237-A1,SAMSUNG ELECTRONICS CO LTD,A,61,2017
US-2018308237-A1,SAMSUNG ELECTRONICS CO LTD,A,61,2017
US-2018055834-A1,AROG PHARMACEUTICALS INC,A,61,2017
US-2018055834-A1,AROG PHARMACEUTICALS INC,A,61,2017
Query:
SELECT
  assignee_f.value:"name"::STRING AS "assignee_name",
  COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
  LATERAL FLATTEN(input => t."cpc") cpc_f
WHERE
  SUBSTRING(cpc_f.value:"code"::STRING, 1, 1) = 'A'
  AND SUBSTRING(cpc_f.value:"code"::STRING, 2, 2) = '61'
GROUP BY assignee_f.value:"name"::STRING
ORDER BY "patent_count" DESC
LIMIT 100
Answer:
assignee_name,patent_count
PROCTER & GAMBLE,197
HOFFMANN LA ROCHE,189
OREAL,150
NOVARTIS AG,147
LILLY CO ELI,140
PFIZER,125
UNIV CALIFORNIA,98
BRISTOL MYERS SQUIBB CO,90
COLGATE PALMOLIVE CO,89
COVIDIEN LP,84
BAYER AG,82
KIMBERLY CLARK CO,79
HOECHST AG,78
GENENTECH INC,78
MERCK & CO INC,77
ASTRAZENECA AB,75
JANSSEN PHARMACEUTICA NV,75
MERCK PATENT GMBH,73
KONINKLIJKE PHILIPS NV,68
BECTON DICKINSON CO,67
OLYMPUS CORP,65
MEDTRONIC INC,63
BOEHRINGER INGELHEIM INT,60
FUJIFILM CORP,60
CENTRE NAT RECH SCIENT,55
AMGEN INC,54
SCHERING AG,54
SIEMENS AG,53
BOSTON SCIENT SCIMED INC,52
UNI CHARM CORP,48
GEN ELECTRIC,46
ABBOTT LAB,46
MERCK SHARP & DOHME,44
KONINKL PHILIPS ELECTRONICS NV,44
ETHICON INC,44
PFIZER PROD INC,43
GLAXO GROUP LTD,43
SANOFI AVENTIS DEUTSCHLAND,43
BAXTER INT,42
WARNER LAMBERT CO,42
TERUMO CORP,41
INST NAT SANTE RECH MED,41
3M INNOVATIVE PROPERTIES CO,41
UNIV TEXAS,40
ALLERGAN INC,38
SMITHKLINE BEECHAM CORP,38
SAMSUNG ELECTRONICS CO LTD,37
SANOFI SA,37
AMERICAN CYANAMID CO,37
UNIV LELAND STANFORD JUNIOR,36
UNILEVER NV,36
WYETH CORP,35
ETHICON ENDO SURGERY INC,35
OTSUKA PHARMA CO LTD,35
SCHERING CORP,35
CIBA GEIGY AG,35
NOVO NORDISK AS,34
ALCON INC,34
CANON KK,34
KAO CORP,34
GRUENENTHAL GMBH,33
BEIERSDORF AG,33
US HEALTH,33
SANOFI AVENTIS,32
REGENERON PHARMA,31
SERVIER LAB,31
UPJOHN CO,31
BIOSENSE WEBSTER ISRAEL LTD,30
EDWARDS LIFESCIENCES CORP,30
UNIV PENNSYLVANIA,29
BOEHRINGER INGELHEIM PHARMA,28
OLYMPUS MEDICAL SYSTEMS CORP,28
TYCO HEALTHCARE,28
VERTEX PHARMA,28
UNILEVER PLC,28
UNIV FLORIDA,26
NESTEC SA,26
CARDIAC PACEMAKERS INC,26
ETHICON LLC,26
UNIV JOHNS HOPKINS,26
GILEAD SCIENCES INC,26
PHILIP MORRIS PRODUCTS SA,25
MASSACHUSETTS INST TECHNOLOGY,25
ALZA CORP,25
THOMAE GMBH DR K,25
AVENTIS PHARMA SA,25
MASSACHUSETTS GEN HOSPITAL,25
CHUGAI PHARMACEUTICAL CO LTD,25
BASF AG,25
TAKEDA CHEMICAL INDUSTRIES LTD,24
AMOREPACIFIC CORP,24
SIEMENS HEALTHCARE GMBH,24
MCNEIL PPC INC,24
HENKEL KGAA,23
SMITH & NEPHEW INC,23
SMITHKLINE BEECHAM PLC,23
GENZYME CORP,23
INTUITIVE SURGICAL OPERATIONS,22
BAXTER HEALTHCARE SA,22
SHISEIDO CO LTD,22
Query:
SELECT
  assignee_f.value:"name"::STRING AS "assignee_name",
  SUBSTRING(TO_CHAR(t."filing_date"), 1, 4) AS "filing_year",
  COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
  LATERAL FLATTEN(input => t."cpc") cpc_f
WHERE
  SUBSTRING(cpc_f.value:"code"::STRING, 1, 1) = 'A'
  AND SUBSTRING(cpc_f.value:"code"::STRING, 2, 2) = '61'
  AND t."filing_date" > 0
GROUP BY
  assignee_f.value:"name"::STRING,
  SUBSTRING(TO_CHAR(t."filing_date"), 1, 4)
ORDER BY "patent_count" DESC
LIMIT 100
Answer:
assignee_name,filing_year,patent_count
PROCTER & GAMBLE,1997,15
KONINKLIJKE PHILIPS NV,2018,15
NOVARTIS AG,2006,13
UNIV CALIFORNIA,2020,12
NOVARTIS AG,2011,11
OLYMPUS CORP,2016,11
FUJIFILM CORP,2019,11
PROCTER & GAMBLE,2000,11
COVIDIEN LP,2020,11
PROCTER & GAMBLE,1998,10
UNIV CALIFORNIA,2019,10
PROCTER & GAMBLE,1999,10
NOVARTIS AG,2014,10
COVIDIEN LP,2016,10
COVIDIEN LP,2017,9
HOFFMANN LA ROCHE,2008,9
GENENTECH INC,2002,9
ETHICON LLC,2019,9
HOFFMANN LA ROCHE,2003,9
KONINKLIJKE PHILIPS NV,2016,9
NOVARTIS AG,2008,9
HOFFMANN LA ROCHE,2006,9
PFIZER,2015,9
NOVARTIS AG,2007,9
KONINKL PHILIPS ELECTRONICS NV,2010,9
OREAL,1995,9
KONINKLIJKE PHILIPS NV,2019,8
SMITHKLINE BEECHAM CORP,1998,8
PROCTER & GAMBLE,2016,8
SIEMENS HEALTHCARE GMBH,2019,8
HOFFMANN LA ROCHE,2002,8
BAYER AG,2001,8
LILLY CO ELI,1998,8
OLYMPUS CORP,2017,8
HOFFMANN LA ROCHE,2001,8
PROCTER & GAMBLE,1996,8
SANOFI AVENTIS,2007,8
COVIDIEN LP,2019,8
ASTRAZENECA AB,2001,8
BOEHRINGER INGELHEIM INT,2009,8
HOFFMANN LA ROCHE,2004,8
OLYMPUS MEDICAL SYSTEMS CORP,2008,8
HOECHST AG,1992,7
HOFFMANN LA ROCHE,2009,7
UNIV CALIFORNIA,2018,7
PROCTER & GAMBLE,2008,7
BAYER AG,1993,7
HOFFMANN LA ROCHE,2019,7
PROCTER & GAMBLE,2007,7
GENENTECH INC,2018,7
LILLY CO ELI,1994,7
ASTRAZENECA AB,2007,7
WYETH CORP,2006,7
PFIZER PROD INC,2001,7
NOVARTIS AG,2005,7
KONINKLIJKE PHILIPS NV,2021,7
PROCTER & GAMBLE,2017,7
ASTRAZENECA AB,2005,7
KIMBERLY CLARK CO,1999,7
US HEALTH,2018,7
KONINKLIJKE PHILIPS NV,2020,7
PFIZER,1990,7
TYCO HEALTHCARE,2010,7
KONINKL PHILIPS ELECTRONICS NV,2008,7
NOVARTIS AG,2020,7
ETHICON ENDO SURGERY INC,2014,7
PFIZER,1993,7
FUJIFILM CORP,2020,7
PROCTER & GAMBLE,2006,7
BRISTOL MYERS SQUIBB CO,2002,7
PROCTER & GAMBLE,2012,7
OREAL,2005,7
NOVARTIS AG,2015,7
HOFFMANN LA ROCHE,2021,6
OREAL,1999,6
ETHICON LLC,2017,6
BRISTOL MYERS SQUIBB CO,2013,6
TYCO HEALTHCARE,2009,6
HOFFMANN LA ROCHE,2015,6
GLAXOSMITHKLINE IP DEV LTD,2015,6
JANSSEN PHARMACEUTICA NV,1998,6
PFIZER PROD INC,1999,6
ETHICON ENDO SURGERY LLC,2016,6
OREAL,2002,6
CANON KK,2017,6
HOFFMANN LA ROCHE,2018,6
MEDTRONIC INC,2021,6
OREAL,2019,6
GENENTECH INC,2008,6
BRISTOL MYERS SQUIBB CO,2003,6
HOFFMANN LA ROCHE,2007,6
SANOFI AVENTIS,2009,6
NOVARTIS AG,2004,6
SMITHKLINE BEECHAM PLC,1998,6
EDWARDS LIFESCIENCES CORP,2023,6
LILLY CO ELI,1996,6
NOVARTIS AG,2019,6
OREAL,2015,6
PROCTER & GAMBLE,1995,6
BIOSENSE WEBSTER ISRAEL LTD,2019,6
Query:
SELECT
  assignee_f.value:"name"::STRING AS "assignee_name",
  SUBSTRING(TO_CHAR(t."filing_date"), 1, 4) AS "filing_year",
  COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
  LATERAL FLATTEN(input => t."cpc") cpc_f
WHERE
  cpc_f.value:"code"::STRING LIKE 'A61%'
  AND t."filing_date" > 0
GROUP BY
  assignee_f.value:"name"::STRING,
  SUBSTRING(TO_CHAR(t."filing_date"), 1, 4)
ORDER BY "patent_count" DESC
LIMIT 100;
Answer:
assignee_name,filing_year,patent_count
KONINKLIJKE PHILIPS NV,2018,15
PROCTER & GAMBLE,1997,15
NOVARTIS AG,2006,13
UNIV CALIFORNIA,2020,12
COVIDIEN LP,2020,11
FUJIFILM CORP,2019,11
NOVARTIS AG,2011,11
OLYMPUS CORP,2016,11
PROCTER & GAMBLE,2000,11
COVIDIEN LP,2016,10
PROCTER & GAMBLE,1998,10
NOVARTIS AG,2014,10
PROCTER & GAMBLE,1999,10
UNIV CALIFORNIA,2019,10
NOVARTIS AG,2008,9
GENENTECH INC,2002,9
HOFFMANN LA ROCHE,2003,9
HOFFMANN LA ROCHE,2008,9
NOVARTIS AG,2007,9
KONINKLIJKE PHILIPS NV,2016,9
HOFFMANN LA ROCHE,2006,9
OREAL,1995,9
PFIZER,2015,9
KONINKL PHILIPS ELECTRONICS NV,2010,9
ETHICON LLC,2019,9
COVIDIEN LP,2017,9
LILLY CO ELI,1998,8
OLYMPUS CORP,2017,8
HOFFMANN LA ROCHE,2001,8
KONINKLIJKE PHILIPS NV,2019,8
ASTRAZENECA AB,2001,8
HOFFMANN LA ROCHE,2004,8
COVIDIEN LP,2019,8
BOEHRINGER INGELHEIM INT,2009,8
HOFFMANN LA ROCHE,2002,8
PROCTER & GAMBLE,1996,8
SANOFI AVENTIS,2007,8
SIEMENS HEALTHCARE GMBH,2019,8
PROCTER & GAMBLE,2016,8
BAYER AG,2001,8
SMITHKLINE BEECHAM CORP,1998,8
OLYMPUS MEDICAL SYSTEMS CORP,2008,8
BRISTOL MYERS SQUIBB CO,2002,7
ETHICON ENDO SURGERY INC,2014,7
PFIZER,1993,7
NOVARTIS AG,2005,7
KONINKL PHILIPS ELECTRONICS NV,2008,7
PFIZER,1990,7
PROCTER & GAMBLE,2017,7
HOECHST AG,1992,7
WYETH CORP,2006,7
BAYER AG,1993,7
PROCTER & GAMBLE,2006,7
KONINKLIJKE PHILIPS NV,2020,7
NOVARTIS AG,2015,7
PROCTER & GAMBLE,2008,7
FUJIFILM CORP,2020,7
TYCO HEALTHCARE,2010,7
ASTRAZENECA AB,2007,7
PROCTER & GAMBLE,2007,7
LILLY CO ELI,1994,7
KONINKLIJKE PHILIPS NV,2021,7
HOFFMANN LA ROCHE,2009,7
KIMBERLY CLARK CO,1999,7
OREAL,2005,7
PFIZER PROD INC,2001,7
GENENTECH INC,2018,7
PROCTER & GAMBLE,2012,7
ASTRAZENECA AB,2005,7
NOVARTIS AG,2020,7
US HEALTH,2018,7
UNIV CALIFORNIA,2018,7
HOFFMANN LA ROCHE,2019,7
TOSHIBA MEDICAL SYS CORP,2012,6
PFIZER,2004,6
COVIDIEN LP,2018,6
UNIV CALIFORNIA,2017,6
NOVARTIS AG,2003,6
LILLY CO ELI,2017,6
UNIV LELAND STANFORD JUNIOR,2019,6
MERCK & CO INC,2003,6
HOFFMANN LA ROCHE,2021,6
MERCK PATENT GMBH,2002,6
ETHICON ENDO SURGERY INC,2011,6
HOFFMANN LA ROCHE,2015,6
GENENTECH INC,2008,6
OREAL,1999,6
BRISTOL MYERS SQUIBB CO,2013,6
HOFFMANN LA ROCHE,2007,6
OLYMPUS CORP,2018,6
ETHICON ENDO SURGERY LLC,2016,6
MEDTRONIC INC,2021,6
NOVARTIS AG,2002,6
PHILIP MORRIS PRODUCTS SA,2016,6
BIOSENSE WEBSTER ISRAEL LTD,2019,6
PFIZER PROD INC,2002,6
CANON KK,2017,6
HOFFMANN LA ROCHE,2018,6
NOVARTIS AG,2019,6
OREAL,2015,6
Query:
SELECT
  assignee_f.value:"name"::STRING AS "assignee_name",
  SUBSTRING(TO_CHAR(t."filing_date"), 1, 4) AS "filing_year",
  COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
  LATERAL FLATTEN(input => t."cpc") cpc_f
WHERE
  cpc_f.value:"code"::STRING ILIKE '%A61%'
GROUP BY
  assignee_f.value:"name"::STRING,
  SUBSTRING(TO_CHAR(t."filing_date"), 1, 4)
ORDER BY "patent_count" DESC
LIMIT 100;
Answer:
assignee_name,filing_year,patent_count
KONINKLIJKE PHILIPS NV,2018,15
PROCTER & GAMBLE,1997,15
NOVARTIS AG,2006,13
UNIV CALIFORNIA,2020,12
OLYMPUS CORP,2016,11
COVIDIEN LP,2020,11
NOVARTIS AG,2011,11
PROCTER & GAMBLE,2000,11
FUJIFILM CORP,2019,11
NOVARTIS AG,2014,10
PROCTER & GAMBLE,1998,10
UNIV CALIFORNIA,2019,10
COVIDIEN LP,2016,10
PROCTER & GAMBLE,1999,10
OREAL,1995,9
HOFFMANN LA ROCHE,2003,9
NOVARTIS AG,2008,9
GENENTECH INC,2002,9
KONINKL PHILIPS ELECTRONICS NV,2010,9
PFIZER,2015,9
KONINKLIJKE PHILIPS NV,2016,9
NOVARTIS AG,2007,9
HOFFMANN LA ROCHE,2006,9
COVIDIEN LP,2017,9
ETHICON LLC,2019,9
HOFFMANN LA ROCHE,2008,9
BAYER AG,2001,8
SANOFI AVENTIS,2007,8
PROCTER & GAMBLE,2016,8
COVIDIEN LP,2019,8
PROCTER & GAMBLE,1996,8
HOFFMANN LA ROCHE,2001,8
BOEHRINGER INGELHEIM INT,2009,8
KONINKLIJKE PHILIPS NV,2019,8
SMITHKLINE BEECHAM CORP,1998,8
LILLY CO ELI,1998,8
HOFFMANN LA ROCHE,2004,8
OLYMPUS CORP,2017,8
OLYMPUS MEDICAL SYSTEMS CORP,2008,8
HOFFMANN LA ROCHE,2002,8
ASTRAZENECA AB,2001,8
SIEMENS HEALTHCARE GMBH,2019,8
ASTRAZENECA AB,2007,7
NOVARTIS AG,2020,7
PROCTER & GAMBLE,2006,7
US HEALTH,2018,7
PFIZER PROD INC,2001,7
OREAL,2005,7
KIMBERLY CLARK CO,1999,7
HOFFMANN LA ROCHE,2009,7
PROCTER & GAMBLE,2012,7
ASTRAZENECA AB,2005,7
KONINKL PHILIPS ELECTRONICS NV,2008,7
PFIZER,1990,7
PROCTER & GAMBLE,2017,7
NOVARTIS AG,2015,7
FUJIFILM CORP,2020,7
BRISTOL MYERS SQUIBB CO,2002,7
HOFFMANN LA ROCHE,2019,7
UNIV CALIFORNIA,2018,7
PFIZER,1993,7
ETHICON ENDO SURGERY INC,2014,7
BAYER AG,1993,7
WYETH CORP,2006,7
KONINKLIJKE PHILIPS NV,2020,7
HOECHST AG,1992,7
GENENTECH INC,2018,7
KONINKLIJKE PHILIPS NV,2021,7
PROCTER & GAMBLE,2008,7
TYCO HEALTHCARE,2010,7
LILLY CO ELI,1994,7
NOVARTIS AG,2005,7
PROCTER & GAMBLE,2007,7
UNI CHARM CORP,2003,6
HOFFMANN LA ROCHE,2021,6
OREAL,2002,6
BOEHRINGER INGELHEIM PHARMA,2002,6
OREAL,2006,6
WYETH CORP,2004,6
NOVARTIS AG,2019,6
ETHICON LLC,2017,6
MERCK PATENT GMBH,2003,6
UNIV TEXAS,2021,6
HOFFMANN LA ROCHE,1985,6
UNIV CALIFORNIA,2023,6
JANSSEN PHARMACEUTICA NV,1998,6
COVIDIEN LP,2014,6
GLAXOSMITHKLINE IP DEV LTD,2015,6
COVIDIEN LP,2012,6
CENTRE NAT RECH SCIENT,2014,6
PHILIP MORRIS PRODUCTS SA,2016,6
HOFFMANN LA ROCHE,2020,6
OLYMPUS CORP,2018,6
LILLY CO ELI,2012,6
PFIZER PROD INC,2002,6
EDWARDS LIFESCIENCES CORP,2023,6
BRISTOL MYERS SQUIBB CO,2003,6
COVIDIEN LP,2018,6
CANON KK,2017,6
NOVARTIS AG,2003,6
Query:
SELECT DISTINCT assignee_f.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
  LATERAL FLATTEN(input => t."cpc") cpc_f
WHERE
  cpc_f.value:"code"::STRING ILIKE '%A61%'
LIMIT 100
Answer:
assignee_name
ALPS SOUTH EUROPE S R O
CAREFUSION 2200 INC
MONTGOMERY ROBERT E
SIRIMANNE LAKSEN
MAQUET CARDIOPULMONARY AG
POOL SCOTT
MCCOY JAY R
INVACARE CORP
AMERICAN CYANAMID CO
VASCULAR SOLUTIONS INC
ZOLL MEDICAL CORP
SCINNOHUB PHARMACEUTICAL CO LTD
ALCON INC
GRAF IRINA V
GOLD NANCY
MICHELSON GARY K
GAROFALO ALBERT W
BRAINLAB AG
SUMITOMO SEIKA CHEMICALS
SYK TECH LLC
MEDTRONIC MINIMED INC
THESAN PHARMACEUTICALS INC
XU GUOZHANG
TIAN GONGLU
BAGARIA SANJAY
OULUN SEUDUN AMMATTIKORKEAKOUL
GERVAIS DANONE SA
JCE BIOTECHNOLOGY
SAMUELSON CONNOR E
KPR US LLC
HEARTFLOW INC
SCRAS
HOPE MEDICAL ENTPR INC
ALLERGAN INC
SYNAGEVA BIOPHARMA CORP
BHATTACHARYA BHAIRAB C
KYORIN SEIYAKU KK
RAYONIER INC
PARDES SPEZIALSTRUMPFE GMBH
NUTRINOVA GMBH
NAKAMURA MITSUHIRO
GUNDU RAMAKANT KASHINATH
UROVANT SCIENCES GMBH
WITHINGS
FAMECCANICA DATA SPA
A AHILA MISS
ATR ADVANCED TELECOMM RES INST
SUZUKI AKIRA
UTLEY DAVID S
TARGEGEN INC
SPEEDEL EXPERIMENTA AG
SLOAN KETTERING INST CANCER
YANG FENG
STROB WOLFGANG
GOERTEK INC
BARRESI FRANCESCO
SATO PHARMA
ALZCHEM TROSTBERG GMBH
BALU-IYER SATHY V
ZUERCHER WILLIAM J
BARNEA OFER
LYSTER THOMAS D
POLI DI TORINOTECNICO
AMNIOTICS AB
AUGUSTINE BIOMEDICAL DESIGN LLC
IFREMER
MEDJET INC
WHEEL RING INC
REVLON
RAYA ROBERT
YU SHUQIN
UNIV OF LEEDS INNOVATIONS LIMITED
HISHINUMA IEHARU
OKANO KAZUO
CLARUS THERAPEUTICS INC
ECOLE NAT SUPERIEURE DE LELECTRONIQUE ET DE SES APPLICATIONS
DRESSLER MATTHEW R
OMORI MACHINERY
BERGER HANS
FRIMLINE PRIVATE LTD
OSRAM OPTO SEMICONDUCTORS GMBH
2SEVENTY BIO INC
BRADFORD PHARMA LTD
ZENECA LTD
FIM MEDICAL
SHANGHAI MICROPORT ENDOVASCULAR MEDTECH GROUP CO LTD
EDWARDS LIFESCIENCES CARDIAQ LLC
ROQUETTE FRERES
NAUTILUS SUBSIDIARY INC
DOU ZULIN
LAM ERIC
DICERNA PHARMACEUTICALS INC
ORTHOFIX INC
SEDDON JON
DEIETSUTAA HAIAA
CHRISTOPHER JOHNS LYON
HUBER CORP J M
TOYO EIZAI KK
YICHUN JINQIU NATURAL BEVERAGE LTD LIABILITY CO
ADVERIO PHARMA GMBH
Query:
SELECT
  SUBSTRING(TO_CHAR(t."filing_date"), 1, 4) AS "filing_year",
  COUNT(DISTINCT t."publication_number") AS "patent_count"
FROM PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."cpc") cpc_f
WHERE
  cpc_f.value:"code"::STRING ILIKE '%A61%'
  AND t."filing_date" > 0
GROUP BY SUBSTRING(TO_CHAR(t."filing_date"), 1, 4)
ORDER BY SUBSTRING(TO_CHAR(t."filing_date"), 1, 4) ASC
LIMIT 100
Answer:
filing_year,patent_count
1899,2
1900,1
1903,1
1905,1
1906,2
1907,2
1908,1
1909,1
1910,2
1911,3
1913,5
1914,5
1915,3
1916,3
1917,1
1920,2
1921,4
1922,1
1923,3
1924,2
1926,2
1927,3
1928,6
1929,4
1930,1
1931,6
1932,3
1933,2
1934,4
1935,9
1936,10
1937,4
1938,3
1939,4
1940,6
1941,7
1942,2
1943,5
1944,4
1945,7
1946,6
1947,3
1948,8
1949,6
1950,9
1951,6
1952,7
1953,10
1954,7
1955,11
1956,7
1957,11
1958,15
1959,10
1960,11
1961,20
1962,17
1963,22
1964,22
1965,24
1966,34
1967,19
1968,32
1969,42
1970,47
1971,38
1972,64
1973,84
1974,89
1975,82
1976,94
1977,102
1978,112
1979,95
1980,104
1981,133
1982,122
1983,144
1984,117
1985,156
1986,179
1987,169
1988,212
1989,217
1990,249
1991,245
1992,281
1993,296
1994,303
1995,327
1996,363
1997,413
1998,445
1999,505
2000,511
2001,633
2002,640
2003,761
2004,756
2005,781
Query:
SELECT
  t."publication_number",
  t."country_code",
  t."filing_date",
  assignee_f.value:"name"::STRING AS "assignee_name"
FROM PATENTS.PATENTS.PUBLICATIONS t,
  LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f
WHERE
  t."filing_date" > 0
LIMIT 100
Answer:
Too long, hard cut:
publication_number,country_code,filing_date,assignee_name
US-2021279799-A1,US,20210520,Santeri Holdings LLC
US-2021280503-A1,US,20210524,MURATA MANUFACTURING CO
US-2021370805-A1,US,20210526,HONDA MOTOR CO LTD
US-2022115377-A1,US,20210527,SAMSUNG ELECTRONICS CO LTD
US-2021337708-A1,US,20210527,NORTHERN DIGITAL INC
US-2021301668-A1,US,20210611,RAYTHEON TECH CORP
US-2021309110-A1,US,20210615,BETA AIR LLC
US-2021329128-A1,US,20210628,UIPATH INC
US-2021393975-A1,US,20210628,AZUITE INC
US-2022058027-A1,US,20210708,PEGATRON CORP
US-2022019872-A1,US,20210713,UNITED MICROELECTRONICS CENTRE HONG KONG LTD
US-2021342874-A1,US,20210713,GROUPON INC
US-2023024156-A1,US,20210720,RAYTHEON CO
US-2022039139-A1,US,20210727,QUALCOMM INC
US-2022032466-A1,US,20210728,SEIKO EPSON CORP
US-2022104677-A1,US,20210729,IROBOT CORP
US-2023045347-A1,US,20210729,INTUIT INC
US-2023044499-A1,US,20210803,SALESFORCE COM INC
US-2021374177-A1,US,20210811,ALIPAY HANGZHOU INF TECH CO LTD
US-2021375401-A1,US,20210811,HEARTFLOW INC
US-2021375576-A1,US,20210817,UNIV KING FAHD PET & MINERALS
US-2022064817-A1,US,20210823,SENIC INC
US-2022171395-A1,US,20210722,UNIV CHONGQING
US-2021373958-A1,US,20210809,RED HAT INC
US-2023063525-A1,US,20210831,SIEMENS MOBILITY INC
US-2022108484-A1,US,20210927,QUALCOMM INC
US-2022027366-A1,US,20211005,BEIJING BAIDU NETCOM SCI & TECH CO LTD
US-2022140971-A1,US,20211101,APPLE INC
US-2021391241-A1,US,20210827,LAPIS SEMICONDUCTOR CO LTD
US-2023068910-A1,US,20210827,UCHICAGO ARGONNE LLC
US-2022083785-A1,US,20210910,SENSORMATIC ELECTRONICS LLC
US-2022074631-A1,US,20210910,UNIV CALIFORNIA
US-2023082670-A1,US,20210915,INTEL CORP
US-2022005035-A1,US,20210917,MASTERCARD INTERNATIONAL INC
US-2022103060-A1,US,20210920,ENPHASE ENERGY INC
US-2022155382-A1,US,20210921,TOYOTA MOTOR CO LTD
US-2023100952-A1,US,20210924,INTEL CORP
US-2022104887-A1,US,20211006,ASENSUS SURGICAL US INC
US-2022050484-A1,US,20211008,GRACO MINNESOTA INC
US-2022182297-A1,US,20211018,AMAZON TECH INC
US-2022144659-A1,US,20211026,SHIRAISHI CENTRAL LABORATORIES CO LTD
US-2022209647-A1,US,20211026,FUJI ELECTRIC CO LTD
US-2023140322-A1,US,20211102,MONSANTO TECHNOLOGY LLC
US-2022176513-A1,US,20211111,EBARA CORP
US-2023160349-A1,US,20211123,HAMILTON SUNDSTRAND CORP
US-2022189186-A1,US,20211130,CANON KK
US-2022091034-A1,US,20211202,OLYMPUS CORP
US-2022114746-A1,US,20211222,HUAWEI TECH CO LTD
US-2022116478-A1,US,20211223,BIEDERMAN DAN
US-2022116478-A1,US,20211223,TAN HAICHUAN
US-2022116478-A1,US,20211223,SAKHAMOORI PRADEEP
US-2022116478-A1,US,20211223,ARROBO VIDAL GABRIEL
US-2023191340-A1,US,20211220,SAUDI ARABIAN OIL CO
US-2023191340-A1,US,20211220,UNIV KING FAHD PET & MINERALS
US-2023136885-A1,US,20210205,LILLY CO ELI
US-2023106542-A1,US,20210215,KOBE STEEL LTD
US-2023091233-A1,US,20210309,EXXONMOBIL CHEMICAL PATENTS INC
US-2023115316-A1,US,20210319,DOLBY LABORATORIES LICENSING CORP
US-2023126843-A1,US,20210412,SUMITOMO ELECTRIC OPTIFRONTIER CO LTD
US-2023183444-A1,US,20210512,HUNTSMAN INT LLC
US-2023211524-A1,US,20210708,POLYTEX SPORTBELAEGE PRODUKTIONS GMBH
US-2023263221-A1,US,20211122,KT & G CORP
US-2023363113-A1,US,20210714,ERICSSON TELEFON AB L M
US-2023223535-A1,US,20210916,LG ENERGY SOLUTION LTD
US-2023310356-A1,US,20210325,NAT UNIV GYEONGSANG IACF
US-2023349229-A1,US,20211020,BLINDSPACE AB
US-2023379266-A1,US,20211130,ZTE CORP
US-2024007963-A1,US,20210126,ERICSSON TELEFON AB L M
US-2024017020-A1,US,20211119,SHL MEDICAL AG
US-2023343919-A1,US,20211005,FASTCAP SYSTEMS CORP
US-2023422615-A1,US,20211103,SAMSUNG DISPLAY CO LTD
US-2024016410-A1,US,20211117,SHENZHEN LIFETECH RESPIRATION SCIENT CO LTD
US-2024026309-A1,US,20211208,UNIV NORTH CAROLINA CHAPEL HILL
US-2024102954-A1,US,20211213,HYPERSONIQ B V
US-2022130404-A1,US,20220110,FRAUNHOFER GES FORSCHUNG
US-2022140065-A1,US,20220119,TAIWAN SEMICONDUCTOR MFG CO LTD
US-2023246093-A1,US,20220128,GLOBALFOUNDRIES US INC
US-2023242128-A1,US,20220128,BONDI TECH LIMITED
US-2024251645-A1,US,20220110,WUHAN CHINA STAR OPTOELECTRONICS SEMICONDUCTOR DISPLAY TECH CO LTD
US-2022215027-A1,US,20220329,SNOWFLAKE INC
US-2022356838-A1,US,20220505,CAELI LLC
US-2022237714-A1,US,20220330,MUKHERJEE GAUTAM
US-2023320231-A1,US,20220331,IBM
US-2023320231-A1,US,20220331,SAMSUNG ELECTRONICS CO LTD
US-2022241010-A1,US,20220413,TRANSSEPTAL SOLUTIONS LTD
US-2022250494-A1,US,20220429,HUAWEI DIGITAL POWER TECH CO LTD
US-2023353384-A1,US,20220502,BRUSO KELSEY L
US-2023353384-A1,US,20220502,WEGLEITNER BRIAN A
US-2023353384-A1,US,20220502,KAIN MICHAEL T
US-2023353384-A1,US,20220502,UNISYS CORP
US-2022322628-A1,US,20220511,RIJK ZWAAN ZAADTEELT EN ZAADHANDEL BV
US-2023367041-A1,US,20220513,META PLATFORMS TECH LLC
US-2022270320-A1,US,20220513,IMAGINATION TECH LTD
US-2022386575-A1,US,20220722,REGENERON PHARMA
US-2023118651-A1,US,20220831,APPLIED MATERIALS INC
US-2022292849-A1,US,20220527,HUAWEI TECH CO LTD
US-2023394297-A1,US,20220601,TOYOTA RES INST INC
US-2023394297-A1,US,20220601,TOYOTA MOTOR CO LTD
US-2023397296-A1,US,20220606,CISCO TECH INC
US-202230014
End Exploring Related Columns
Task: For the assignee who has been the most active in the patent category 'A61', I'd like to know the five patent jurisdictions code where they filed the most patents during their busiest year, separated by commas.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To determine the five patent jurisdiction codes where the most active assignee in the patent category 'A61' filed the most patents during their busiest year, we first identify the assignee with the highest number of patents classified under 'A61'. Next, we find the year in which this assignee filed the most patents. Finally, we list the top five jurisdiction codes where they filed the most patents in that year.

```csv
Jurisdiction_Codes
code1:str,code2:str,code3:str,code4:str,code5:str
(Attention: answer in one row)
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-26 04:39:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:39:25 - root - INFO - To determine the five patent jurisdiction codes where the most active assignee in the patent category 'A61' filed the most patents during their busiest year, we perform the following steps:

1. Identify the assignee with the highest number of patents classified under 'A61'.
2. Find the year in which this assignee filed the most patents.
3. Retrieve the top five jurisdiction codes where they filed the most patents in that year.

Here is the SQL query to achieve this:

```sql
WITH most_active_assignee AS (
  SELECT
    assignee_f.value:"name"::STRING AS "assignee_name",
    COUNT(DISTINCT t."publication_number") AS "patent_count"
  FROM
    "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
    LATERAL FLATTEN(input => t."cpc") cpc_f
  WHERE
    SUBSTRING(cpc_f.value:"code"::STRING, 1, 3) = 'A61'
  GROUP BY
    assignee_f.value:"name"::STRING
  ORDER BY
    "patent_count" DESC
  LIMIT 1
),
busiest_year AS (
  SELECT
    SUBSTRING(TO_CHAR(t."filing_date"), 1, 4) AS "filing_year",
    COUNT(DISTINCT t."publication_number") AS "patent_count"
  FROM
    "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
    LATERAL FLATTEN(input => t."cpc") cpc_f,
    most_active_assignee maa
  WHERE
    SUBSTRING(cpc_f.value:"code"::STRING, 1, 3) = 'A61'
    AND assignee_f.value:"name"::STRING = maa."assignee_name"
    AND t."filing_date" IS NOT NULL AND t."filing_date" > 0
  GROUP BY
    SUBSTRING(TO_CHAR(t."filing_date"), 1, 4)
  ORDER BY
    "patent_count" DESC
  LIMIT 1
),
top_jurisdictions AS (
  SELECT
    t."country_code",
    COUNT(DISTINCT t."publication_number") AS "patent_count"
  FROM
    "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
    LATERAL FLATTEN(input => t."cpc") cpc_f,
    most_active_assignee maa,
    busiest_year byear
  WHERE
    SUBSTRING(cpc_f.value:"code"::STRING, 1, 3) = 'A61'
    AND assignee_f.value:"name"::STRING = maa."assignee_name"
    AND SUBSTRING(TO_CHAR(t."filing_date"), 1, 4) = byear."filing_year"
  GROUP BY
    t."country_code"
  ORDER BY
    "patent_count" DESC
  LIMIT 5
)
SELECT
  LISTAGG("country_code", ',') AS "Jurisdiction_Codes"
FROM
  top_jurisdictions;
```
2025-01-26 04:39:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:39:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:39:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:39:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-26 04:39:27 - snowflake.connector.connection - INFO - closed
2025-01-26 04:39:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:39:28 - root - INFO - itercount: 1
2025-01-26 04:39:28 - root - INFO - 0
2025-01-26 04:39:28 - root - INFO - results: 
Jurisdiction_Codes
"CA,US,AU,PE,HU"


2025-01-26 04:39:28 - root - INFO - Please check the answer again by reviewing For the assignee who has been the most active in the patent category 'A61', I'd like to know the five patent jurisdictions code where they filed the most patents during their busiest year, separated by commas., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To determine the five patent jurisdiction codes where the most active assignee in the patent category 'A61' filed the most patents during their busiest year, we first identify the assignee with the highest number of patents classified under 'A61'. Next, we find the year in which this assignee filed the most patents. Finally, we list the top five jurisdiction codes where they filed the most patents in that year.

```csv
Jurisdiction_Codes
code1:str,code2:str,code3:str,code4:str,code5:str
(Attention: answer in one row)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Jurisdiction_Codes
"CA,US,AU,PE,HU"
Current sql:
WITH most_active_assignee AS (
  SELECT
    assignee_f.value:"name"::STRING AS "assignee_name",
    COUNT(DISTINCT t."publication_number") AS "patent_count"
  FROM
    "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
    LATERAL FLATTEN(input => t."cpc") cpc_f
  WHERE
    SUBSTRING(cpc_f.value:"code"::STRING, 1, 3) = 'A61'
  GROUP BY
    assignee_f.value:"name"::STRING
  ORDER BY
    "patent_count" DESC
  LIMIT 1
),
busiest_year AS (
  SELECT
    SUBSTRING(TO_CHAR(t."filing_date"), 1, 4) AS "filing_year",
    COUNT(DISTINCT t."publication_number") AS "patent_count"
  FROM
    "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
    LATERAL FLATTEN(input => t."cpc") cpc_f,
    most_active_assignee maa
  WHERE
    SUBSTRING(cpc_f.value:"code"::STRING, 1, 3) = 'A61'
    AND assignee_f.value:"name"::STRING = maa."assignee_name"
    AND t."filing_date" IS NOT NULL AND t."filing_date" > 0
  GROUP BY
    SUBSTRING(TO_CHAR(t."filing_date"), 1, 4)
  ORDER BY
    "patent_count" DESC
  LIMIT 1
),
top_jurisdictions AS (
  SELECT
    t."country_code",
    COUNT(DISTINCT t."publication_number") AS "patent_count"
  FROM
    "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
    LATERAL FLATTEN(input => t."cpc") cpc_f,
    most_active_assignee maa,
    busiest_year byear
  WHERE
    SUBSTRING(cpc_f.value:"code"::STRING, 1, 3) = 'A61'
    AND assignee_f.value:"name"::STRING = maa."assignee_name"
    AND SUBSTRING(TO_CHAR(t."filing_date"), 1, 4) = byear."filing_year"
  GROUP BY
    t."country_code"
  ORDER BY
    "patent_count" DESC
  LIMIT 5
)
SELECT
  LISTAGG("country_code", ',') AS "Jurisdiction_Codes"
FROM
  top_jurisdictions;When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-26 04:40:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:40:13 - root - INFO - To determine the five patent jurisdiction codes where the most active assignee in the patent category 'A61' filed the most patents during their busiest year, we first identify the assignee with the highest number of patents classified under 'A61'. Next, we find the year in which this assignee filed the most patents. Finally, we list the top five jurisdiction codes where they filed the most patents in that year.

```csv
Jurisdiction_Codes
CA,US,AU,PE,HU
```

Here is the SQL query:

```sql
WITH most_active_assignee AS (
  SELECT
    assignee_f.value:"name"::STRING AS "assignee_name",
    COUNT(DISTINCT t."publication_number") AS "patent_count"
  FROM
    "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
    LATERAL FLATTEN(input => t."cpc") cpc_f
  WHERE
    SUBSTRING(cpc_f.value:"code"::STRING, 1, 3) = 'A61'
  GROUP BY
    assignee_f.value:"name"::STRING
  ORDER BY
    "patent_count" DESC NULLS LAST
  LIMIT 1
),
busiest_year AS (
  SELECT
    SUBSTRING(TO_CHAR(t."filing_date"), 1, 4) AS "filing_year",
    COUNT(DISTINCT t."publication_number") AS "patent_count"
  FROM
    "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
    LATERAL FLATTEN(input => t."cpc") cpc_f,
    most_active_assignee maa
  WHERE
    SUBSTRING(cpc_f.value:"code"::STRING, 1, 3) = 'A61'
    AND assignee_f.value:"name"::STRING = maa."assignee_name"
    AND t."filing_date" IS NOT NULL AND t."filing_date" > 0
  GROUP BY
    SUBSTRING(TO_CHAR(t."filing_date"), 1, 4)
  ORDER BY
    "patent_count" DESC NULLS LAST
  LIMIT 1
),
top_jurisdictions AS (
  SELECT
    t."country_code",
    COUNT(DISTINCT t."publication_number") AS "patent_count"
  FROM
    "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
    LATERAL FLATTEN(input => t."cpc") cpc_f,
    most_active_assignee maa,
    busiest_year byear
  WHERE
    SUBSTRING(cpc_f.value:"code"::STRING, 1, 3) = 'A61'
    AND assignee_f.value:"name"::STRING = maa."assignee_name"
    AND SUBSTRING(TO_CHAR(t."filing_date"), 1, 4) = byear."filing_year"
  GROUP BY
    t."country_code"
  ORDER BY
    "patent_count" DESC NULLS LAST
  LIMIT 5
)
SELECT
  LISTAGG("country_code", ',') AS "Jurisdiction_Codes"
FROM
  top_jurisdictions;
```

In this query, we have added `NULLS LAST` to the `ORDER BY` clauses to exclude null records, as per your instruction.
2025-01-26 04:40:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:40:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:40:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:40:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-26 04:40:14 - snowflake.connector.connection - INFO - closed
2025-01-26 04:40:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:40:15 - root - INFO - itercount: 2
2025-01-26 04:40:15 - root - INFO - 0
2025-01-26 04:40:15 - root - INFO - results: 
Jurisdiction_Codes
"CA,US,ZA,PE,AU"


2025-01-26 04:40:15 - root - INFO - Please check the answer again by reviewing For the assignee who has been the most active in the patent category 'A61', I'd like to know the five patent jurisdictions code where they filed the most patents during their busiest year, separated by commas., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To determine the five patent jurisdiction codes where the most active assignee in the patent category 'A61' filed the most patents during their busiest year, we first identify the assignee with the highest number of patents classified under 'A61'. Next, we find the year in which this assignee filed the most patents. Finally, we list the top five jurisdiction codes where they filed the most patents in that year.

```csv
Jurisdiction_Codes
code1:str,code2:str,code3:str,code4:str,code5:str
(Attention: answer in one row)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Jurisdiction_Codes
"CA,US,ZA,PE,AU"
Current sql:
WITH most_active_assignee AS (
  SELECT
    assignee_f.value:"name"::STRING AS "assignee_name",
    COUNT(DISTINCT t."publication_number") AS "patent_count"
  FROM
    "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
    LATERAL FLATTEN(input => t."cpc") cpc_f
  WHERE
    SUBSTRING(cpc_f.value:"code"::STRING, 1, 3) = 'A61'
  GROUP BY
    assignee_f.value:"name"::STRING
  ORDER BY
    "patent_count" DESC NULLS LAST
  LIMIT 1
),
busiest_year AS (
  SELECT
    SUBSTRING(TO_CHAR(t."filing_date"), 1, 4) AS "filing_year",
    COUNT(DISTINCT t."publication_number") AS "patent_count"
  FROM
    "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
    LATERAL FLATTEN(input => t."cpc") cpc_f,
    most_active_assignee maa
  WHERE
    SUBSTRING(cpc_f.value:"code"::STRING, 1, 3) = 'A61'
    AND assignee_f.value:"name"::STRING = maa."assignee_name"
    AND t."filing_date" IS NOT NULL AND t."filing_date" > 0
  GROUP BY
    SUBSTRING(TO_CHAR(t."filing_date"), 1, 4)
  ORDER BY
    "patent_count" DESC NULLS LAST
  LIMIT 1
),
top_jurisdictions AS (
  SELECT
    t."country_code",
    COUNT(DISTINCT t."publication_number") AS "patent_count"
  FROM
    "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
    LATERAL FLATTEN(input => t."cpc") cpc_f,
    most_active_assignee maa,
    busiest_year byear
  WHERE
    SUBSTRING(cpc_f.value:"code"::STRING, 1, 3) = 'A61'
    AND assignee_f.value:"name"::STRING = maa."assignee_name"
    AND SUBSTRING(TO_CHAR(t."filing_date"), 1, 4) = byear."filing_year"
  GROUP BY
    t."country_code"
  ORDER BY
    "patent_count" DESC NULLS LAST
  LIMIT 5
)
SELECT
  LISTAGG("country_code", ',') AS "Jurisdiction_Codes"
FROM
  top_jurisdictions;
2025-01-26 04:40:57 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-26 04:40:57 - root - INFO - ```sql
WITH most_active_assignee AS (
  SELECT
    assignee_f.value:"name"::STRING AS "assignee_name",
    COUNT(DISTINCT t."publication_number") AS "patent_count"
  FROM
    "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
    LATERAL FLATTEN(input => t."cpc") cpc_f
  WHERE
    SUBSTRING(cpc_f.value:"code"::STRING, 1, 3) = 'A61'
  GROUP BY
    assignee_f.value:"name"::STRING
  ORDER BY
    "patent_count" DESC NULLS LAST
  LIMIT 1
),
busiest_year AS (
  SELECT
    SUBSTRING(TO_CHAR(t."filing_date"), 1, 4) AS "filing_year",
    COUNT(DISTINCT t."publication_number") AS "patent_count"
  FROM
    "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
    LATERAL FLATTEN(input => t."cpc") cpc_f,
    most_active_assignee maa
  WHERE
    SUBSTRING(cpc_f.value:"code"::STRING, 1, 3) = 'A61'
    AND assignee_f.value:"name"::STRING = maa."assignee_name"
    AND t."filing_date" IS NOT NULL AND t."filing_date" > 0
  GROUP BY
    SUBSTRING(TO_CHAR(t."filing_date"), 1, 4)
  ORDER BY
    "patent_count" DESC NULLS LAST
  LIMIT 1
),
top_jurisdictions AS (
  SELECT
    t."country_code",
    COUNT(DISTINCT t."publication_number") AS "patent_count"
  FROM
    "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(input => t."assignee_harmonized") assignee_f,
    LATERAL FLATTEN(input => t."cpc") cpc_f,
    most_active_assignee maa,
    busiest_year byear
  WHERE
    SUBSTRING(cpc_f.value:"code"::STRING, 1, 3) = 'A61'
    AND assignee_f.value:"name"::STRING = maa."assignee_name"
    AND SUBSTRING(TO_CHAR(t."filing_date"), 1, 4) = byear."filing_year"
  GROUP BY
    t."country_code"
  ORDER BY
    "patent_count" DESC NULLS LAST
  LIMIT 5
)
SELECT
  LISTAGG("country_code", ',') AS "Jurisdiction_Codes"
FROM
  top_jurisdictions;
```
2025-01-26 04:40:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-26 04:40:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-26 04:40:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-26 04:40:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-26 04:40:59 - snowflake.connector.connection - INFO - closed
2025-01-26 04:40:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-26 04:40:59 - root - INFO - itercount: 3
2025-01-26 04:40:59 - root - INFO - 0
2025-01-26 04:40:59 - root - INFO - Total iteration counts: 3
