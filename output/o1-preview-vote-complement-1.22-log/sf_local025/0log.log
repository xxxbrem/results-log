2025-01-24 06:29:00 - openai._base_client - INFO - Retrying request to /chat/completions in 0.384045 seconds
2025-01-24 06:30:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 06:30:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:30:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:30:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:30:30 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:30:30 - snowflake.connector.connection - INFO - closed
2025-01-24 06:30:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:30:31 - root - INFO - SQL:
SELECT "match_id", "innings_no", "over_id", "ball_id", "runs_scored"
FROM IPL.IPL."BATSMAN_SCORED"
LIMIT 100;
Results:
match_id,innings_no,over_id,ball_id,runs_scored
335987,2,1,1,1
335987,1,1,2,0
335987,2,1,3,0
335987,1,1,4,0
335987,2,1,4,1
335987,1,1,5,0
335987,2,1,5,1
335987,1,1,6,0
335987,2,1,6,0
335987,1,1,7,0
335987,2,1,7,0
335987,1,2,1,0
335987,2,2,1,0
335987,1,2,2,4
335987,2,2,2,0
335987,1,2,3,4
335987,2,2,3,0
335987,1,2,4,6
335987,2,2,4,1
335987,1,2,5,4
335987,2,2,5,0
335987,1,2,6,0
335987,2,2,6,0
335987,1,3,1,0
335987,2,3,1,0
335987,1,3,2,0
335987,2,3,2,0
335987,1,3,3,0
335987,2,3,3,1
335987,1,3,4,4
335987,2,3,4,0
335987,1,3,5,1
335987,1,3,6,0
335987,2,3,6,0
335987,2,3,7,1
335987,2,4,1,2
335987,1,4,2,6
335987,2,4,2,1
335987,1,4,3,0
335987,2,4,3,0
335987,1,4,4,4
335987,2,4,4,0
335987,1,4,5,0
335987,2,4,5,0
335987,1,4,6,1
335987,2,4,6,0
335987,1,4,7,6
335987,1,5,1,4
335987,2,5,1,1
335987,1,5,2,1
335987,2,5,2,1
335987,1,5,3,4
335987,2,5,3,0
335987,1,5,4,0
335987,2,5,4,6
335987,1,5,5,1
335987,2,5,5,0
335987,1,5,6,0
335987,2,5,6,0
335987,1,6,1,1
335987,2,6,1,0
335987,1,6,2,0
335987,2,6,2,0
335987,1,6,3,0
335987,2,6,3,0
335987,1,6,4,0
335987,2,6,4,1
335987,1,6,5,0
335987,2,6,5,1
335987,1,6,6,0
335987,2,6,6,0
335987,1,7,1,1
335987,2,7,1,0
335987,1,7,2,1
335987,2,7,2,0
335987,1,7,3,1
335987,2,7,3,1
335987,1,7,4,2
335987,1,7,5,1
335987,1,7,6,1
335987,2,7,6,0
335987,2,7,7,0
335987,2,7,8,4
335987,1,8,1,0
335987,2,8,1,1
335987,1,8,2,1
335987,2,8,2,0
335987,1,8,3,1
335987,2,8,3,1
335987,1,8,4,1
335987,2,8,4,2
335987,1,8,5,1
335987,2,8,5,0
335987,1,8,6,1
335987,2,8,6,0
335987,1,9,1,0
335987,2,9,1,0
335987,1,9,2,0
335987,2,9,2,0
335987,1,9,3,0

2025-01-24 06:30:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:30:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:30:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:30:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:30:32 - snowflake.connector.connection - INFO - closed
2025-01-24 06:30:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:30:32 - root - INFO - SQL:
SELECT "match_id", "innings_no", "over_id", "ball_id", "extra_type", "extra_runs"
FROM IPL.IPL."EXTRA_RUNS"
LIMIT 100;
Results:
match_id,innings_no,over_id,ball_id,extra_type,extra_runs
501229,1,16,3,legbyes,1
501229,2,18,1,legbyes,1
501229,2,18,6,legbyes,4
392239,2,18,6,legbyes,1
501229,1,20,3,legbyes,1
501230,1,1,4,legbyes,4
829714,1,18,4,legbyes,1
829816,2,3,3,legbyes,1
501230,2,3,4,legbyes,1
829816,1,2,3,legbyes,4
980962,2,18,2,legbyes,1
829714,2,18,1,legbyes,1
829714,1,9,6,legbyes,1
501231,2,1,1,legbyes,1
335994,2,4,6,legbyes,1
501231,2,2,6,legbyes,1
829714,1,9,3,legbyes,2
980962,2,17,5,legbyes,2
336045,2,3,5,legbyes,4
392240,1,3,7,legbyes,1
336045,1,4,1,legbyes,1
829714,1,3,6,legbyes,1
501231,2,20,5,legbyes,1
501232,2,1,1,legbyes,1
501232,1,1,2,legbyes,1
336045,1,8,3,legbyes,1
336017,2,4,4,legbyes,1
829814,1,18,1,legbyes,1
501232,2,4,3,legbyes,1
501232,1,4,6,legbyes,1
501232,2,7,2,legbyes,1
829714,1,1,1,legbyes,4
336045,2,9,3,legbyes,1
501232,2,14,3,legbyes,1
501232,1,14,7,legbyes,1
829712,1,18,5,legbyes,1
829712,1,3,1,legbyes,4
829712,1,2,6,legbyes,1
392240,1,10,2,legbyes,2
829712,1,1,3,legbyes,4
392240,1,11,2,legbyes,1
335991,1,2,1,legbyes,1
980962,2,14,1,legbyes,1
335988,2,17,1,legbyes,1
392240,1,13,3,legbyes,1
829814,1,14,3,legbyes,1
501232,1,20,7,legbyes,1
829812,1,4,5,legbyes,1
392240,1,15,3,legbyes,1
980960,1,7,5,legbyes,1
829710,2,4,2,legbyes,1
501233,2,6,1,legbyes,1
501233,2,6,3,legbyes,1
981018,2,2,1,legbyes,1
336045,2,18,8,legbyes,1
501233,1,13,1,legbyes,1
829812,1,1,4,legbyes,1
392241,2,3,6,legbyes,1
392241,2,4,6,legbyes,1
981018,1,1,3,legbyes,1
829810,1,12,6,legbyes,1
501234,2,2,1,legbyes,1
980958,1,3,2,legbyes,1
829710,1,1,5,legbyes,1
829710,2,1,3,legbyes,1
392241,2,8,3,legbyes,1
980956,1,20,3,legbyes,1
336017,2,7,5,legbyes,1
392186,1,2,1,legbyes,1
501234,2,14,5,legbyes,2
501234,1,16,2,legbyes,1
336001,2,20,3,legbyes,1
734054,1,19,6,legbyes,1
392186,2,6,1,legbyes,4
392241,1,19,4,legbyes,1
392186,2,6,2,legbyes,1
980986,1,18,2,legbyes,1
392186,2,10,3,legbyes,1
501235,1,12,3,legbyes,1
734054,1,17,6,legbyes,1
829808,1,9,2,legbyes,1
335994,1,9,3,legbyes,1
829808,2,8,2,legbyes,2
829808,2,7,3,legbyes,1
829808,2,7,1,legbyes,1
734054,1,13,2,legbyes,1
501235,1,18,4,legbyes,1
980956,1,16,2,legbyes,1
335994,1,10,2,legbyes,1
335991,2,2,5,legbyes,4
501236,1,13,2,legbyes,1
392187,1,2,2,legbyes,1
501236,1,13,5,legbyes,1
501236,1,15,1,legbyes,1
829808,2,3,1,legbyes,1
501236,2,17,2,legbyes,1
392243,1,4,4,legbyes,1
829806,1,19,6,legbyes,1
392243,2,10,1,legbyes,1
501237,2,5,6,legbyes,1

2025-01-24 06:30:32 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:30:32 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:30:32 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:30:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-24 06:30:33 - snowflake.connector.connection - INFO - closed
2025-01-24 06:30:34 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:30:34 - root - INFO - SQL:
SELECT DISTINCT "extra_type"
FROM IPL.IPL."EXTRA_RUNS"
LIMIT 100;
Results:
extra_type
legbyes
wides
byes
noballs
penalty

2025-01-24 06:30:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:30:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:30:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:30:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:30:35 - snowflake.connector.connection - INFO - closed
2025-01-24 06:30:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:30:36 - root - INFO - SQL:
SELECT bs."match_id", bs."innings_no", bs."over_id", bs."ball_id",
       bs."runs_scored", er."extra_runs"
FROM IPL.IPL."BATSMAN_SCORED" bs
LEFT JOIN IPL.IPL."EXTRA_RUNS" er
  ON bs."match_id" = er."match_id"
  AND bs."innings_no" = er."innings_no"
  AND bs."over_id" = er."over_id"
  AND bs."ball_id" = er."ball_id"
LIMIT 100;
Results:
match_id,innings_no,over_id,ball_id,runs_scored,extra_runs
335987,2,1,1,1,
335987,1,1,2,0,
335987,2,1,3,0,
335987,1,1,4,0,
335987,2,1,4,1,
335987,1,1,5,0,
335987,2,1,5,1,
335987,1,1,6,0,
335987,2,1,6,0,
335987,1,1,7,0,1.0
335987,2,1,7,0,
335987,1,2,1,0,
335987,2,2,1,0,
335987,1,2,2,4,
335987,2,2,2,0,
335987,1,2,3,4,
335987,2,2,3,0,4.0
335987,1,2,4,6,
335987,2,2,4,1,
335987,1,2,5,4,
335987,2,2,5,0,
335987,1,2,6,0,
335987,2,2,6,0,
335987,1,3,1,0,
335987,2,3,1,0,
335987,1,3,2,0,
335987,2,3,2,0,
335987,1,3,3,0,1.0
335987,2,3,3,1,
335987,1,3,4,4,
335987,2,3,4,0,
335987,1,3,5,1,
335987,1,3,6,0,
335987,2,3,6,0,
335987,2,3,7,1,
335987,2,4,1,2,
335987,1,4,2,6,
335987,2,4,2,1,
335987,1,4,3,0,1.0
335987,2,4,3,0,
335987,1,4,4,4,
335987,2,4,4,0,1.0
335987,1,4,5,0,
335987,2,4,5,0,
335987,1,4,6,1,
335987,2,4,6,0,
335987,1,4,7,6,
335987,1,5,1,4,
335987,2,5,1,1,
335987,1,5,2,1,
335987,2,5,2,1,
335987,1,5,3,4,
335987,2,5,3,0,
335987,1,5,4,0,
335987,2,5,4,6,
335987,1,5,5,1,
335987,2,5,5,0,
335987,1,5,6,0,
335987,2,5,6,0,
335987,1,6,1,1,
335987,2,6,1,0,
335987,1,6,2,0,
335987,2,6,2,0,
335987,1,6,3,0,
335987,2,6,3,0,
335987,1,6,4,0,
335987,2,6,4,1,
335987,1,6,5,0,
335987,2,6,5,1,
335987,1,6,6,0,
335987,2,6,6,0,
335987,1,7,1,1,
335987,2,7,1,0,
335987,1,7,2,1,
335987,2,7,2,0,
335987,1,7,3,1,
335987,2,7,3,1,
335987,1,7,4,2,
335987,1,7,5,1,
335987,1,7,6,1,
335987,2,7,6,0,
335987,2,7,7,0,
335987,2,7,8,4,
335987,1,8,1,0,
335987,2,8,1,1,
335987,1,8,2,1,
335987,2,8,2,0,1.0
335987,1,8,3,1,
335987,2,8,3,1,
335987,1,8,4,1,
335987,2,8,4,2,
335987,1,8,5,1,
335987,2,8,5,0,
335987,1,8,6,1,
335987,2,8,6,0,
335987,1,9,1,0,
335987,2,9,1,0,
335987,1,9,2,0,
335987,2,9,2,0,
335987,1,9,3,0,

2025-01-24 06:30:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:30:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:30:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:30:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:30:37 - snowflake.connector.connection - INFO - closed
2025-01-24 06:30:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:30:37 - root - INFO - SQL:
SELECT bs."match_id", bs."innings_no", bs."over_id", bs."ball_id",
       (bs."runs_scored" + COALESCE(er."extra_runs", 0)) AS "total_runs"
FROM IPL.IPL."BATSMAN_SCORED" bs
LEFT JOIN IPL.IPL."EXTRA_RUNS" er
  ON bs."match_id" = er."match_id"
  AND bs."innings_no" = er."innings_no"
  AND bs."over_id" = er."over_id"
  AND bs."ball_id" = er."ball_id"
LIMIT 100;
Results:
match_id,innings_no,over_id,ball_id,total_runs
335987,2,1,1,1
335987,1,1,2,0
335987,2,1,3,0
335987,1,1,4,0
335987,2,1,4,1
335987,1,1,5,0
335987,2,1,5,1
335987,1,1,6,0
335987,2,1,6,0
335987,1,1,7,1
335987,2,1,7,0
335987,1,2,1,0
335987,2,2,1,0
335987,1,2,2,4
335987,2,2,2,0
335987,1,2,3,4
335987,2,2,3,4
335987,1,2,4,6
335987,2,2,4,1
335987,1,2,5,4
335987,2,2,5,0
335987,1,2,6,0
335987,2,2,6,0
335987,1,3,1,0
335987,2,3,1,0
335987,1,3,2,0
335987,2,3,2,0
335987,1,3,3,1
335987,2,3,3,1
335987,1,3,4,4
335987,2,3,4,0
335987,1,3,5,1
335987,1,3,6,0
335987,2,3,6,0
335987,2,3,7,1
335987,2,4,1,2
335987,1,4,2,6
335987,2,4,2,1
335987,1,4,3,1
335987,2,4,3,0
335987,1,4,4,4
335987,2,4,4,1
335987,1,4,5,0
335987,2,4,5,0
335987,1,4,6,1
335987,2,4,6,0
335987,1,4,7,6
335987,1,5,1,4
335987,2,5,1,1
335987,1,5,2,1
335987,2,5,2,1
335987,1,5,3,4
335987,2,5,3,0
335987,1,5,4,0
335987,2,5,4,6
335987,1,5,5,1
335987,2,5,5,0
335987,1,5,6,0
335987,2,5,6,0
335987,1,6,1,1
335987,2,6,1,0
335987,1,6,2,0
335987,2,6,2,0
335987,1,6,3,0
335987,2,6,3,0
335987,1,6,4,0
335987,2,6,4,1
335987,1,6,5,0
335987,2,6,5,1
335987,1,6,6,0
335987,2,6,6,0
335987,1,7,1,1
335987,2,7,1,0
335987,1,7,2,1
335987,2,7,2,0
335987,1,7,3,1
335987,2,7,3,1
335987,1,7,4,2
335987,1,7,5,1
335987,1,7,6,1
335987,2,7,6,0
335987,2,7,7,0
335987,2,7,8,4
335987,1,8,1,0
335987,2,8,1,1
335987,1,8,2,1
335987,2,8,2,1
335987,1,8,3,1
335987,2,8,3,1
335987,1,8,4,1
335987,2,8,4,2
335987,1,8,5,1
335987,2,8,5,0
335987,1,8,6,1
335987,2,8,6,0
335987,1,9,1,0
335987,2,9,1,0
335987,1,9,2,0
335987,2,9,2,0
335987,1,9,3,0

2025-01-24 06:30:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:30:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:30:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:30:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-24 06:30:38 - snowflake.connector.connection - INFO - closed
2025-01-24 06:30:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:31:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 06:31:09 - root - INFO - ```sql
SELECT AVG("max_runs_in_match") AS "average_runs_conceded_per_over"
FROM (
  SELECT "match_id", MAX("total_runs_in_over") AS "max_runs_in_match"
  FROM (
    SELECT bs."match_id", bs."innings_no", bs."over_id",
           SUM(bs."runs_scored" + COALESCE(er."extra_runs", 0)) AS "total_runs_in_over"
    FROM IPL.IPL."BATSMAN_SCORED" bs
    LEFT JOIN IPL.IPL."EXTRA_RUNS" er
      ON bs."match_id" = er."match_id"
      AND bs."innings_no" = er."innings_no"
      AND bs."over_id" = er."over_id"
      AND bs."ball_id" = er."ball_id"
    GROUP BY bs."match_id", bs."innings_no", bs."over_id"
  ) per_over
  GROUP BY "match_id"
) max_over_per_match;
```
2025-01-24 06:31:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:31:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:31:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:31:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 06:31:10 - snowflake.connector.connection - INFO - closed
2025-01-24 06:31:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:32:58 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 06:32:58 - root - INFO - SQL:
SELECT AVG("max_runs_in_match") AS "average_runs_conceded_per_over"
FROM (
  SELECT "match_id", MAX("total_runs_in_over") AS "max_runs_in_match"
  FROM (
    SELECT bs."match_id", bs."innings_no", bs."over_id",
           SUM(bs."runs_scored" + COALESCE(er."extra_runs", 0)) AS "total_runs_in_over"
    FROM IPL.IPL."BATSMAN_SCORED" bs
    LEFT JOIN IPL.IPL."EXTRA_RUNS" er
      ON bs."match_id" = er."match_id"
      AND bs."innings_no" = er."innings_no"
      AND bs."over_id" = er."over_id"
      AND bs."ball_id" = er."ball_id"
    GROUP BY bs."match_id", bs."innings_no", bs."over_id"
  ) per_over
  GROUP BY "match_id"
) max_over_per_match;
Results:
average_runs_conceded_per_over
19.086268

2025-01-24 06:32:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:32:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:32:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:33:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:33:00 - snowflake.connector.connection - INFO - closed
2025-01-24 06:33:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:33:00 - root - INFO - SQL:
SELECT
   COALESCE(bs."match_id", er."match_id") AS "match_id",
   COALESCE(bs."innings_no", er."innings_no") AS "innings_no",
   COALESCE(bs."over_id", er."over_id") AS "over_id",
   COALESCE(bs."batsman_runs", 0) + COALESCE(er."extra_runs", 0) AS "total_runs_in_over"
FROM
   (
     SELECT "match_id", "innings_no", "over_id", SUM("runs_scored") AS "batsman_runs"
     FROM IPL.IPL."BATSMAN_SCORED"
     GROUP BY "match_id", "innings_no", "over_id"
   ) bs
FULL OUTER JOIN
   (
     SELECT "match_id", "innings_no", "over_id", SUM("extra_runs") AS "extra_runs"
     FROM IPL.IPL."EXTRA_RUNS"
     GROUP BY "match_id", "innings_no", "over_id"
   ) er
ON bs."match_id" = er."match_id"
   AND bs."innings_no" = er."innings_no"
   AND bs."over_id" = er."over_id"
ORDER BY "total_runs_in_over" DESC
LIMIT 100
Results:
match_id,innings_no,over_id,total_runs_in_over
501252,2,3,37
734052,2,6,33
419144,1,13,33
548332,2,13,31
980992,1,19,30
501265,1,15,30
335993,2,13,30
980992,1,18,30
598065,2,17,29
598032,1,8,29
548323,2,19,28
598032,1,5,28
980912,1,19,28
733988,2,3,28
598032,1,15,28
392233,1,19,28
729296,2,18,27
734010,1,20,27
501275,1,1,27
501246,1,19,27
729322,2,17,27
548344,2,19,27
336020,1,19,27
548318,1,19,27
598042,1,20,27
392233,2,20,26
598034,1,1,26
335997,2,14,26
734042,2,13,26
734012,1,5,26
734012,1,19,26
598069,2,15,26
335993,1,18,26
336023,2,14,26
733996,1,16,26
501218,1,20,26
829734,1,14,26
980928,1,14,26
419142,1,16,26
419112,2,12,26
598047,1,20,26
335988,1,20,25
548353,1,18,25
598055,1,20,25
392242,2,6,25
980942,2,6,25
419141,2,17,25
829794,2,19,25
548385,1,19,25
598056,1,17,25
501262,1,13,25
829800,1,17,25
729300,1,13,25
419157,1,20,25
501225,1,3,25
392235,1,19,25
336041,1,20,25
548353,1,19,25
548367,1,6,25
980936,2,18,25
419117,2,13,25
336024,1,17,25
336031,1,20,24
733996,2,11,24
548381,2,2,24
548372,1,20,24
980954,2,3,24
392207,1,18,24
829742,2,13,24
829742,1,17,24
734052,1,4,24
598059,1,18,24
336001,1,19,24
392228,1,6,24
392194,2,7,24
501237,1,18,24
733988,1,19,24
548329,1,17,24
548360,1,5,24
392219,1,15,24
419134,2,5,24
419128,1,19,24
336033,2,2,24
598004,2,17,24
829796,2,14,24
548329,1,14,24
335987,1,15,24
981024,1,20,24
419122,1,2,24
598072,1,19,24
734032,1,15,24
419138,2,3,24
829790,1,3,24
829812,2,2,24
733982,2,19,24
734034,1,20,24
501229,1,20,24
980964,2,17,24
548332,2,20,24
419142,2,15,23

2025-01-24 06:33:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:33:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:33:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:33:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:33:02 - snowflake.connector.connection - INFO - closed
2025-01-24 06:33:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:33:02 - root - INFO - SQL:
SELECT
   "match_id",
   "innings_no",
   "over_id",
   SUM("total_runs") AS "total_runs_in_over"
FROM (
   SELECT "match_id", "innings_no", "over_id", SUM("runs_scored") AS "total_runs"
   FROM IPL.IPL."BATSMAN_SCORED"
   GROUP BY "match_id", "innings_no", "over_id"
   UNION ALL
   SELECT "match_id", "innings_no", "over_id", SUM("extra_runs") AS "total_runs"
   FROM IPL.IPL."EXTRA_RUNS"
   GROUP BY "match_id", "innings_no", "over_id"
) combined_runs
GROUP BY "match_id", "innings_no", "over_id"
HAVING SUM("total_runs") > 20
ORDER BY "total_runs_in_over" DESC
LIMIT 100
Results:
match_id,innings_no,over_id,total_runs_in_over
501252,2,3,37
734052,2,6,33
419144,1,13,33
548332,2,13,31
980992,1,19,30
335993,2,13,30
501265,1,15,30
980992,1,18,30
598065,2,17,29
598032,1,8,29
392233,1,19,28
980912,1,19,28
733988,2,3,28
548323,2,19,28
598032,1,5,28
598032,1,15,28
501275,1,1,27
548344,2,19,27
729322,2,17,27
734010,1,20,27
501246,1,19,27
548318,1,19,27
336020,1,19,27
729296,2,18,27
598042,1,20,27
501218,1,20,26
734012,1,19,26
598034,1,1,26
598047,1,20,26
733996,1,16,26
419112,2,12,26
734042,2,13,26
392233,2,20,26
336023,2,14,26
734012,1,5,26
419142,1,16,26
335997,2,14,26
598069,2,15,26
335993,1,18,26
980928,1,14,26
829734,1,14,26
548353,1,19,25
548353,1,18,25
980942,2,6,25
980936,2,18,25
419141,2,17,25
392235,1,19,25
829800,1,17,25
335988,1,20,25
419117,2,13,25
598056,1,17,25
501225,1,3,25
829794,2,19,25
419157,1,20,25
392242,2,6,25
548385,1,19,25
548367,1,6,25
729300,1,13,25
501262,1,13,25
598055,1,20,25
336024,1,17,25
336041,1,20,25
419138,2,3,24
419134,2,5,24
829812,2,2,24
598072,1,19,24
980964,2,17,24
419128,1,19,24
548329,1,17,24
336001,1,19,24
829796,2,14,24
336031,1,20,24
829790,1,3,24
336033,2,2,24
829742,1,17,24
392207,1,18,24
392194,2,7,24
501237,1,18,24
501229,1,20,24
548372,1,20,24
734032,1,15,24
734034,1,20,24
335987,1,15,24
598059,1,18,24
548332,2,20,24
598004,2,17,24
392219,1,15,24
733996,2,11,24
734052,1,4,24
981024,1,20,24
392228,1,6,24
548360,1,5,24
829742,2,13,24
980954,2,3,24
548381,2,2,24
733988,1,19,24
548329,1,14,24
733982,2,19,24
419122,1,2,24
335987,1,4,23

2025-01-24 06:33:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:33:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:33:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:33:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:33:04 - snowflake.connector.connection - INFO - closed
2025-01-24 06:33:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:33:04 - root - INFO - SQL:
SELECT "match_id", MAX("total_runs_in_over") AS "max_runs_conceded_in_over"
FROM (
   SELECT
      "match_id",
      "over_id",
      SUM("total_runs") AS "total_runs_in_over"
   FROM (
      SELECT "match_id", "over_id", SUM("runs_scored") AS "total_runs"
      FROM IPL.IPL."BATSMAN_SCORED"
      GROUP BY "match_id", "over_id"
      UNION ALL
      SELECT "match_id", "over_id", SUM("extra_runs") AS "total_runs"
      FROM IPL.IPL."EXTRA_RUNS"
      GROUP BY "match_id", "over_id"
   ) per_over_runs
   GROUP BY "match_id", "over_id"
) max_runs_per_match
GROUP BY "match_id"
LIMIT 100
Results:
match_id,max_runs_conceded_in_over
335987,28
335988,34
335989,23
335990,39
335991,23
335992,25
335993,32
335996,31
335997,28
336006,30
335994,34
335998,26
335995,39
336002,22
335999,31
336009,28
336016,26
336007,38
336008,30
336012,35
336015,29
336031,32
336040,32
336019,41
336023,36
336028,34
336030,18
336036,31
336037,25
392187,18
336024,40
336029,30
336033,35
392191,31
392207,28
392224,24
419123,22
336041,40
392229,27
392243,25
419134,30
419157,37
501234,20
336003,33
336010,24
336039,29
336027,39
336044,21
336038,33
392188,30
392190,29
392197,27
336032,26
419117,40
419130,30
392218,20
392236,34
419154,25
392209,34
392244,24
419131,31
501243,29
501261,38
598046,30
336017,34
336011,23
336021,24
336014,36
336013,22
336022,19
336042,26
336045,25
392194,32
392200,19
392214,30
392233,40
392216,38
392240,25
392227,33
392204,29
392217,23
419162,32
336001,32
336025,37
336004,32
336020,32
336026,27
336034,24
336043,29
392193,26
392221,36
392223,30
392230,29
392219,35
392201,36
392208,25
392212,28
392237,22
419136,27
392220,35

2025-01-24 06:33:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:33:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:33:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:33:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 06:33:05 - snowflake.connector.connection - INFO - closed
2025-01-24 06:33:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:33:06 - root - INFO - SQL:
SELECT
   COALESCE(bs."match_id", er."match_id") AS "match_id",
   COALESCE(bs."total_batsman_runs", 0) + COALESCE(er."total_extra_runs", 0) AS "total_runs"
FROM
   (
     SELECT "match_id", SUM("runs_scored") AS "total_batsman_runs"
     FROM IPL.IPL."BATSMAN_SCORED"
     GROUP BY "match_id"
   ) bs
FULL OUTER JOIN
   (
     SELECT "match_id", SUM("extra_runs") AS "total_extra_runs"
     FROM IPL.IPL."EXTRA_RUNS"
     GROUP BY "match_id"
   ) er
ON bs."match_id" = er."match_id"
ORDER BY "total_runs" DESC
LIMIT 100
Results:
match_id,total_runs
419142,469
335988,447
501228,433
829800,431
335995,431
734052,428
419112,420
733992,418
734012,416
548323,413
336038,412
729288,411
335994,410
548377,409
980912,409
981024,408
419117,407
419144,404
336024,401
829742,400
734054,399
598032,396
829792,395
548331,393
980954,391
829816,389
419164,387
980974,386
598039,386
729296,384
734046,384
598069,384
548371,384
980926,383
548386,382
734004,381
501211,381
548334,380
336019,379
392236,377
501218,377
548347,377
336033,377
336025,376
336014,375
980914,375
419121,375
598011,374
734034,374
980964,374
980958,373
829716,373
829734,372
336003,372
598030,371
598031,371
829720,370
419150,370
598056,369
392194,369
981000,369
548332,368
548322,367
829796,367
548361,366
829774,366
501215,366
829804,365
419141,365
829782,364
548338,364
729306,364
733996,364
829828,363
980942,362
598065,362
829778,362
598059,362
419130,361
598052,360
734032,360
501259,359
733986,359
980996,359
392219,359
548353,359
548385,358
980936,357
598047,357
598046,357
829718,356
734010,356
336037,355
733988,355
501248,354
336036,353
980976,353
501265,353
501272,353
980946,353

2025-01-24 06:33:06 - root - INFO - itercount: 0
2025-01-24 06:33:06 - root - INFO - Database Name: IPL
Schema Name: IPL
DDL describes table information.
,0
table_name,PLAYER_MATCH
description,
DDL,"create or replace TABLE PLAYER_MATCH (
	""match_id"" NUMBER(38,0),
	""player_id"" NUMBER(38,0),
	""role"" VARCHAR(16777216),
	""team_id"" NUMBER(38,0)
);"

,1
table_name,PLAYER
description,
DDL,"create or replace TABLE PLAYER (
	""player_id"" NUMBER(38,0),
	""player_name"" VARCHAR(16777216),
	""dob"" VARCHAR(16777216),
	""batting_hand"" VARCHAR(16777216),
	""bowling_skill"" VARCHAR(16777216),
	""country_name"" VARCHAR(16777216)
);"

,2
table_name,BATSMAN_SCORED
description,
DDL,"create or replace TABLE BATSMAN_SCORED (
	""match_id"" NUMBER(38,0),
	""over_id"" NUMBER(38,0),
	""ball_id"" NUMBER(38,0),
	""runs_scored"" NUMBER(38,0),
	""innings_no"" NUMBER(38,0)
);"

,3
table_name,WICKET_TAKEN
description,
DDL,"create or replace TABLE WICKET_TAKEN (
	""match_id"" NUMBER(38,0),
	""over_id"" NUMBER(38,0),
	""ball_id"" NUMBER(38,0),
	""player_out"" NUMBER(38,0),
	""kind_out"" VARCHAR(16777216),
	""innings_no"" NUMBER(38,0)
);"

,4
table_name,BALL_BY_BALL
description,
DDL,"create or replace TABLE BALL_BY_BALL (
	""match_id"" NUMBER(38,0),
	""over_id"" NUMBER(38,0),
	""ball_id"" NUMBER(38,0),
	""innings_no"" NUMBER(38,0),
	""team_batting"" NUMBER(38,0),
	""team_bowling"" NUMBER(38,0),
	""striker_batting_position"" NUMBER(38,0),
	""striker"" NUMBER(38,0),
	""non_striker"" NUMBER(38,0),
	""bowler"" NUMBER(38,0)
);"

,5
table_name,EXTRA_RUNS
description,
DDL,"create or replace TABLE EXTRA_RUNS (
	""match_id"" NUMBER(38,0),
	""over_id"" NUMBER(38,0),
	""ball_id"" NUMBER(38,0),
	""extra_type"" VARCHAR(16777216),
	""extra_runs"" NUMBER(38,0),
	""innings_no"" NUMBER(38,0)
);"

,6
table_name,MATCH
description,
DDL,"create or replace TABLE MATCH (
	""match_id"" NUMBER(38,0),
	""team_1"" NUMBER(38,0),
	""team_2"" NUMBER(38,0),
	""match_date"" VARCHAR(16777216),
	""season_id"" NUMBER(38,0),
	""venue"" VARCHAR(16777216),
	""toss_winner"" NUMBER(38,0),
	""toss_decision"" VARCHAR(16777216),
	""win_type"" VARCHAR(16777216),
	""win_margin"" NUMBER(38,0),
	""outcome_type"" VARCHAR(16777216),
	""match_winner"" NUMBER(38,0),
	""man_of_the_match"" NUMBER(38,0)
);"

,7
table_name,TEAM
description,
DDL,"create or replace TABLE TEAM (
	""team_id"" NUMBER(38,0),
	""name"" VARCHAR(16777216)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'IPL': {'IPL': ['BALL_BY_BALL', 'BATSMAN_SCORED', 'EXTRA_RUNS', 'MATCH', 'PLAYER', 'PLAYER_MATCH', 'TEAM', 'WICKET_TAKEN']}}
Begin Exploring Related Columns
To calculate the average of the highest runs conceded in a single over for each match, we need to identify the relevant tables and columns and understand how they can be utilized.

**Relevant Tables and Columns:**

1. **BATSMAN_SCORED**
   - `"match_id"`: Identifies each match.
   - `"innings_no"`: Identifies each innings within a match.
   - `"over_id"`: Identifies each over within an innings.
   - `"ball_id"`: Identifies each ball within an over.
   - `"runs_scored"`: Runs scored by the batsman on each ball.

   **Potential Usage:** Provides the runs scored by the batsman on each ball, which can be aggregated to calculate the total runs per over in a match.

2. **EXTRA_RUNS**
   - `"match_id"`: Identifies each match.
   - `"innings_no"`: Identifies each innings within a match.
   - `"over_id"`: Identifies each over within an innings.
   - `"ball_id"`: Identifies each ball within an over.
   - `"extra_type"`: Type of extra run (e.g., wide, no-ball).
   - `"extra_runs"`: Number of extra runs conceded on each ball.

   **Potential Usage:** Provides extra runs conceded on each ball, which should be added to the batsman's runs to get the total runs conceded per ball.

**Conditions that may be used:**

- **Joining Conditions:** To combine batsman runs and extra runs per ball, we can join `BATSMAN_SCORED` and `EXTRA_RUNS` on `"match_id"`, `"innings_no"`, `"over_id"`, and `"ball_id"`.
- **Aggregation:** Summing the runs per ball to get total runs per over by grouping on `"match_id"`, `"innings_no"`, and `"over_id"`.
- **Filtering:** We may want to look at specific matches or overs by applying `WHERE` conditions.

---

**SQL Queries:**

Here are 10 different SQL queries, from simple to complex, to help understand the values in the related columns.

---

**Query 1:** Select runs scored by batsmen on each ball.

```sql
SELECT "match_id", "innings_no", "over_id", "ball_id", "runs_scored"
FROM IPL.IPL."BATSMAN_SCORED"
LIMIT 100;
```

**Purpose:** Retrieve a sample of runs scored by batsmen on each ball to understand the distribution of runs.

---

**Query 2:** Select extra runs conceded on each ball.

```sql
SELECT "match_id", "innings_no", "over_id", "ball_id", "extra_type", "extra_runs"
FROM IPL.IPL."EXTRA_RUNS"
LIMIT 100;
```

**Purpose:** View the types and amounts of extra runs conceded to understand their impact on total runs.

---

**Query 3:** List distinct types of extra runs.

```sql
SELECT DISTINCT "extra_type"
FROM IPL.IPL."EXTRA_RUNS"
LIMIT 100;
```

**Purpose:** Identify the different types of extra runs present in the data.

---

**Query 4:** Combine batsman runs and extra runs for each ball.

```sql
SELECT bs."match_id", bs."innings_no", bs."over_id", bs."ball_id",
       bs."runs_scored", er."extra_runs"
FROM IPL.IPL."BATSMAN_SCORED" bs
LEFT JOIN IPL.IPL."EXTRA_RUNS" er
  ON bs."match_id" = er."match_id"
  AND bs."innings_no" = er."innings_no"
  AND bs."over_id" = er."over_id"
  AND bs."ball_id" = er."ball_id"
LIMIT 100;
```

**Purpose:** Merge batsman runs and extra runs per ball to prepare for calculating total runs per ball.

---

**Query 5:** Calculate total runs per ball.

```sql
SELECT bs."match_id", bs."innings_no", bs."over_id", bs."ball_id",
       (bs."runs_scored" + COALESCE(er."extra_runs", 0)) AS "total_runs"
FROM IPL.IPL."BATSMAN_SCORED" bs
LEFT JOIN IPL.IPL."EXTRA_RUNS" er
  ON bs."match_id" = er."match_id"
  AND bs."innings_no" = er."innings_no"
  AND bs."over_id" = er."over_id"
  AND bs."ball_id" = er."ball_id"
LIMIT 100;
```

**Purpose:** Compute the total runs conceded on each ball by adding batsman runs and extra runs.

---

**Query 6:** Calculate total runs per over in a specific match (e.g., `match_id` = 1).

```sql
SELECT bs."match_id", bs."innings_no", bs."over_id",
       SUM(bs."runs_scored" + COALESCE(er."extra_runs", 0)) AS "total_runs_in_over"
FROM IPL.IPL."BATSMAN_SCORED" bs
LEFT JOIN IPL.IPL."EXTRA_RUNS" er
  ON bs."match_id" = er."match_id"
  AND bs."innings_no" = er."innings_no"
  AND bs."over_id" = er."over_id"
  AND bs."ball_id" = er."ball_id"
WHERE bs."match_id" = 1
GROUP BY bs."match_id", bs."innings_no", bs."over_id"
ORDER BY "total_runs_in_over" DESC
LIMIT 100;
```

**Purpose:** View the total runs conceded in each over for a specific match to identify high-scoring overs.

---

**Query 7:** List total runs per over across all matches.

```sql
SELECT bs."match_id", bs."innings_no", bs."over_id",
       SUM(bs."runs_scored" + COALESCE(er."extra_runs", 0)) AS "total_runs_in_over"
FROM IPL.IPL."BATSMAN_SCORED" bs
LEFT JOIN IPL.IPL."EXTRA_RUNS" er
  ON bs."match_id" = er."match_id"
  AND bs."innings_no" = er."innings_no"
  AND bs."over_id" = er."over_id"
  AND bs."ball_id" = er."ball_id"
GROUP BY bs."match_id", bs."innings_no", bs."over_id"
ORDER BY "total_runs_in_over" DESC
LIMIT 100;
```

**Purpose:** Compute total runs per over for all matches to understand the overall distribution of runs per over.

---

**Query 8:** Find overs where total runs conceded exceed 20 runs.

```sql
SELECT bs."match_id", bs."innings_no", bs."over_id",
       SUM(bs."runs_scored" + COALESCE(er."extra_runs", 0)) AS "total_runs_in_over"
FROM IPL.IPL."BATSMAN_SCORED" bs
LEFT JOIN IPL.IPL."EXTRA_RUNS" er
  ON bs."match_id" = er."match_id"
  AND bs."innings_no" = er."innings_no"
  AND bs."over_id" = er."over_id"
  AND bs."ball_id" = er."ball_id"
GROUP BY bs."match_id", bs."innings_no", bs."over_id"
HAVING SUM(bs."runs_scored" + COALESCE(er."extra_runs", 0)) > 20
ORDER BY "total_runs_in_over" DESC
LIMIT 100;
```

**Purpose:** Identify overs with exceptionally high runs conceded to analyze performance.

---

**Query 9:** Retrieve the maximum runs conceded in a single over per match.

```sql
SELECT per_over."match_id", MAX(per_over."total_runs_in_over") AS "max_runs_conceded_in_over"
FROM (
  SELECT bs."match_id", bs."over_id",
         SUM(bs."runs_scored" + COALESCE(er."extra_runs", 0)) AS "total_runs_in_over"
  FROM IPL.IPL."BATSMAN_SCORED" bs
  LEFT JOIN IPL.IPL."EXTRA_RUNS" er
    ON bs."match_id" = er."match_id"
    AND bs."innings_no" = er."innings_no"
    AND bs."over_id" = er."over_id"
    AND bs."ball_id" = er."ball_id"
  GROUP BY bs."match_id", bs."over_id"
) per_over
GROUP BY per_over."match_id"
LIMIT 100;
```

**Purpose:** Determine the highest runs conceded in any over for each match to prepare for calculating the average.

---

**Query 10:** Calculate total runs scored by batsmen per match.

```sql
SELECT bs."match_id", SUM(bs."runs_scored") AS "total_batsman_runs"
FROM IPL.IPL."BATSMAN_SCORED" bs
GROUP BY bs."match_id"
ORDER BY "total_batsman_runs" DESC
LIMIT 100;
```

**Purpose:** Summarize the total runs scored by batsmen in each match to analyze overall performance.

---

These queries incrementally build an understanding of how runs are distributed across balls, overs, and matches. By exploring the data with these queries, we can proceed to calculate the average of the highest runs conceded in a single over for each match.

***Note:*** These queries are written based on the information provided in the tables and the structure of the IPL database. All column names are enclosed in double quotations, and the database, schema, and table names have been adjusted accordingly.Query:
SELECT "match_id", "innings_no", "over_id", "ball_id", "runs_scored"
FROM IPL.IPL."BATSMAN_SCORED"
LIMIT 100;
Answer:
match_id,innings_no,over_id,ball_id,runs_scored
335987,2,1,1,1
335987,1,1,2,0
335987,2,1,3,0
335987,1,1,4,0
335987,2,1,4,1
335987,1,1,5,0
335987,2,1,5,1
335987,1,1,6,0
335987,2,1,6,0
335987,1,1,7,0
335987,2,1,7,0
335987,1,2,1,0
335987,2,2,1,0
335987,1,2,2,4
335987,2,2,2,0
335987,1,2,3,4
335987,2,2,3,0
335987,1,2,4,6
335987,2,2,4,1
335987,1,2,5,4
335987,2,2,5,0
335987,1,2,6,0
335987,2,2,6,0
335987,1,3,1,0
335987,2,3,1,0
335987,1,3,2,0
335987,2,3,2,0
335987,1,3,3,0
335987,2,3,3,1
335987,1,3,4,4
335987,2,3,4,0
335987,1,3,5,1
335987,1,3,6,0
335987,2,3,6,0
335987,2,3,7,1
335987,2,4,1,2
335987,1,4,2,6
335987,2,4,2,1
335987,1,4,3,0
335987,2,4,3,0
335987,1,4,4,4
335987,2,4,4,0
335987,1,4,5,0
335987,2,4,5,0
335987,1,4,6,1
335987,2,4,6,0
335987,1,4,7,6
335987,1,5,1,4
335987,2,5,1,1
335987,1,5,2,1
335987,2,5,2,1
335987,1,5,3,4
335987,2,5,3,0
335987,1,5,4,0
335987,2,5,4,6
335987,1,5,5,1
335987,2,5,5,0
335987,1,5,6,0
335987,2,5,6,0
335987,1,6,1,1
335987,2,6,1,0
335987,1,6,2,0
335987,2,6,2,0
335987,1,6,3,0
335987,2,6,3,0
335987,1,6,4,0
335987,2,6,4,1
335987,1,6,5,0
335987,2,6,5,1
335987,1,6,6,0
335987,2,6,6,0
335987,1,7,1,1
335987,2,7,1,0
335987,1,7,2,1
335987,2,7,2,0
335987,1,7,3,1
335987,2,7,3,1
335987,1,7,4,2
335987,1,7,5,1
335987,1,7,6,1
335987,2,7,6,0
335987,2,7,7,0
335987,2,7,8,4
335987,1,8,1,0
335987,2,8,1,1
335987,1,8,2,1
335987,2,8,2,0
335987,1,8,3,1
335987,2,8,3,1
335987,1,8,4,1
335987,2,8,4,2
335987,1,8,5,1
335987,2,8,5,0
335987,1,8,6,1
335987,2,8,6,0
335987,1,9,1,0
335987,2,9,1,0
335987,1,9,2,0
335987,2,9,2,0
335987,1,9,3,0
Query:
SELECT "match_id", "innings_no", "over_id", "ball_id", "extra_type", "extra_runs"
FROM IPL.IPL."EXTRA_RUNS"
LIMIT 100;
Answer:
match_id,innings_no,over_id,ball_id,extra_type,extra_runs
501229,1,16,3,legbyes,1
501229,2,18,1,legbyes,1
501229,2,18,6,legbyes,4
392239,2,18,6,legbyes,1
501229,1,20,3,legbyes,1
501230,1,1,4,legbyes,4
829714,1,18,4,legbyes,1
829816,2,3,3,legbyes,1
501230,2,3,4,legbyes,1
829816,1,2,3,legbyes,4
980962,2,18,2,legbyes,1
829714,2,18,1,legbyes,1
829714,1,9,6,legbyes,1
501231,2,1,1,legbyes,1
335994,2,4,6,legbyes,1
501231,2,2,6,legbyes,1
829714,1,9,3,legbyes,2
980962,2,17,5,legbyes,2
336045,2,3,5,legbyes,4
392240,1,3,7,legbyes,1
336045,1,4,1,legbyes,1
829714,1,3,6,legbyes,1
501231,2,20,5,legbyes,1
501232,2,1,1,legbyes,1
501232,1,1,2,legbyes,1
336045,1,8,3,legbyes,1
336017,2,4,4,legbyes,1
829814,1,18,1,legbyes,1
501232,2,4,3,legbyes,1
501232,1,4,6,legbyes,1
501232,2,7,2,legbyes,1
829714,1,1,1,legbyes,4
336045,2,9,3,legbyes,1
501232,2,14,3,legbyes,1
501232,1,14,7,legbyes,1
829712,1,18,5,legbyes,1
829712,1,3,1,legbyes,4
829712,1,2,6,legbyes,1
392240,1,10,2,legbyes,2
829712,1,1,3,legbyes,4
392240,1,11,2,legbyes,1
335991,1,2,1,legbyes,1
980962,2,14,1,legbyes,1
335988,2,17,1,legbyes,1
392240,1,13,3,legbyes,1
829814,1,14,3,legbyes,1
501232,1,20,7,legbyes,1
829812,1,4,5,legbyes,1
392240,1,15,3,legbyes,1
980960,1,7,5,legbyes,1
829710,2,4,2,legbyes,1
501233,2,6,1,legbyes,1
501233,2,6,3,legbyes,1
981018,2,2,1,legbyes,1
336045,2,18,8,legbyes,1
501233,1,13,1,legbyes,1
829812,1,1,4,legbyes,1
392241,2,3,6,legbyes,1
392241,2,4,6,legbyes,1
981018,1,1,3,legbyes,1
829810,1,12,6,legbyes,1
501234,2,2,1,legbyes,1
980958,1,3,2,legbyes,1
829710,1,1,5,legbyes,1
829710,2,1,3,legbyes,1
392241,2,8,3,legbyes,1
980956,1,20,3,legbyes,1
336017,2,7,5,legbyes,1
392186,1,2,1,legbyes,1
501234,2,14,5,legbyes,2
501234,1,16,2,legbyes,1
336001,2,20,3,legbyes,1
734054,1,19,6,legbyes,1
392186,2,6,1,legbyes,4
392241,1,19,4,legbyes,1
392186,2,6,2,legbyes,1
980986,1,18,2,legbyes,1
392186,2,10,3,legbyes,1
501235,1,12,3,legbyes,1
734054,1,17,6,legbyes,1
829808,1,9,2,legbyes,1
335994,1,9,3,legbyes,1
829808,2,8,2,legbyes,2
829808,2,7,3,legbyes,1
829808,2,7,1,legbyes,1
734054,1,13,2,legbyes,1
501235,1,18,4,legbyes,1
980956,1,16,2,legbyes,1
335994,1,10,2,legbyes,1
335991,2,2,5,legbyes,4
501236,1,13,2,legbyes,1
392187,1,2,2,legbyes,1
501236,1,13,5,legbyes,1
501236,1,15,1,legbyes,1
829808,2,3,1,legbyes,1
501236,2,17,2,legbyes,1
392243,1,4,4,legbyes,1
829806,1,19,6,legbyes,1
392243,2,10,1,legbyes,1
501237,2,5,6,legbyes,1
Query:
SELECT DISTINCT "extra_type"
FROM IPL.IPL."EXTRA_RUNS"
LIMIT 100;
Answer:
extra_type
legbyes
wides
byes
noballs
penalty
Query:
SELECT bs."match_id", bs."innings_no", bs."over_id", bs."ball_id",
       bs."runs_scored", er."extra_runs"
FROM IPL.IPL."BATSMAN_SCORED" bs
LEFT JOIN IPL.IPL."EXTRA_RUNS" er
  ON bs."match_id" = er."match_id"
  AND bs."innings_no" = er."innings_no"
  AND bs."over_id" = er."over_id"
  AND bs."ball_id" = er."ball_id"
LIMIT 100;
Answer:
match_id,innings_no,over_id,ball_id,runs_scored,extra_runs
335987,2,1,1,1,
335987,1,1,2,0,
335987,2,1,3,0,
335987,1,1,4,0,
335987,2,1,4,1,
335987,1,1,5,0,
335987,2,1,5,1,
335987,1,1,6,0,
335987,2,1,6,0,
335987,1,1,7,0,1.0
335987,2,1,7,0,
335987,1,2,1,0,
335987,2,2,1,0,
335987,1,2,2,4,
335987,2,2,2,0,
335987,1,2,3,4,
335987,2,2,3,0,4.0
335987,1,2,4,6,
335987,2,2,4,1,
335987,1,2,5,4,
335987,2,2,5,0,
335987,1,2,6,0,
335987,2,2,6,0,
335987,1,3,1,0,
335987,2,3,1,0,
335987,1,3,2,0,
335987,2,3,2,0,
335987,1,3,3,0,1.0
335987,2,3,3,1,
335987,1,3,4,4,
335987,2,3,4,0,
335987,1,3,5,1,
335987,1,3,6,0,
335987,2,3,6,0,
335987,2,3,7,1,
335987,2,4,1,2,
335987,1,4,2,6,
335987,2,4,2,1,
335987,1,4,3,0,1.0
335987,2,4,3,0,
335987,1,4,4,4,
335987,2,4,4,0,1.0
335987,1,4,5,0,
335987,2,4,5,0,
335987,1,4,6,1,
335987,2,4,6,0,
335987,1,4,7,6,
335987,1,5,1,4,
335987,2,5,1,1,
335987,1,5,2,1,
335987,2,5,2,1,
335987,1,5,3,4,
335987,2,5,3,0,
335987,1,5,4,0,
335987,2,5,4,6,
335987,1,5,5,1,
335987,2,5,5,0,
335987,1,5,6,0,
335987,2,5,6,0,
335987,1,6,1,1,
335987,2,6,1,0,
335987,1,6,2,0,
335987,2,6,2,0,
335987,1,6,3,0,
335987,2,6,3,0,
335987,1,6,4,0,
335987,2,6,4,1,
335987,1,6,5,0,
335987,2,6,5,1,
335987,1,6,6,0,
335987,2,6,6,0,
335987,1,7,1,1,
335987,2,7,1,0,
335987,1,7,2,1,
335987,2,7,2,0,
335987,1,7,3,1,
335987,2,7,3,1,
335987,1,7,4,2,
335987,1,7,5,1,
335987,1,7,6,1,
335987,2,7,6,0,
335987,2,7,7,0,
335987,2,7,8,4,
335987,1,8,1,0,
335987,2,8,1,1,
335987,1,8,2,1,
335987,2,8,2,0,1.0
335987,1,8,3,1,
335987,2,8,3,1,
335987,1,8,4,1,
335987,2,8,4,2,
335987,1,8,5,1,
335987,2,8,5,0,
335987,1,8,6,1,
335987,2,8,6,0,
335987,1,9,1,0,
335987,2,9,1,0,
335987,1,9,2,0,
335987,2,9,2,0,
335987,1,9,3,0,
Query:
SELECT bs."match_id", bs."innings_no", bs."over_id", bs."ball_id",
       (bs."runs_scored" + COALESCE(er."extra_runs", 0)) AS "total_runs"
FROM IPL.IPL."BATSMAN_SCORED" bs
LEFT JOIN IPL.IPL."EXTRA_RUNS" er
  ON bs."match_id" = er."match_id"
  AND bs."innings_no" = er."innings_no"
  AND bs."over_id" = er."over_id"
  AND bs."ball_id" = er."ball_id"
LIMIT 100;
Answer:
match_id,innings_no,over_id,ball_id,total_runs
335987,2,1,1,1
335987,1,1,2,0
335987,2,1,3,0
335987,1,1,4,0
335987,2,1,4,1
335987,1,1,5,0
335987,2,1,5,1
335987,1,1,6,0
335987,2,1,6,0
335987,1,1,7,1
335987,2,1,7,0
335987,1,2,1,0
335987,2,2,1,0
335987,1,2,2,4
335987,2,2,2,0
335987,1,2,3,4
335987,2,2,3,4
335987,1,2,4,6
335987,2,2,4,1
335987,1,2,5,4
335987,2,2,5,0
335987,1,2,6,0
335987,2,2,6,0
335987,1,3,1,0
335987,2,3,1,0
335987,1,3,2,0
335987,2,3,2,0
335987,1,3,3,1
335987,2,3,3,1
335987,1,3,4,4
335987,2,3,4,0
335987,1,3,5,1
335987,1,3,6,0
335987,2,3,6,0
335987,2,3,7,1
335987,2,4,1,2
335987,1,4,2,6
335987,2,4,2,1
335987,1,4,3,1
335987,2,4,3,0
335987,1,4,4,4
335987,2,4,4,1
335987,1,4,5,0
335987,2,4,5,0
335987,1,4,6,1
335987,2,4,6,0
335987,1,4,7,6
335987,1,5,1,4
335987,2,5,1,1
335987,1,5,2,1
335987,2,5,2,1
335987,1,5,3,4
335987,2,5,3,0
335987,1,5,4,0
335987,2,5,4,6
335987,1,5,5,1
335987,2,5,5,0
335987,1,5,6,0
335987,2,5,6,0
335987,1,6,1,1
335987,2,6,1,0
335987,1,6,2,0
335987,2,6,2,0
335987,1,6,3,0
335987,2,6,3,0
335987,1,6,4,0
335987,2,6,4,1
335987,1,6,5,0
335987,2,6,5,1
335987,1,6,6,0
335987,2,6,6,0
335987,1,7,1,1
335987,2,7,1,0
335987,1,7,2,1
335987,2,7,2,0
335987,1,7,3,1
335987,2,7,3,1
335987,1,7,4,2
335987,1,7,5,1
335987,1,7,6,1
335987,2,7,6,0
335987,2,7,7,0
335987,2,7,8,4
335987,1,8,1,0
335987,2,8,1,1
335987,1,8,2,1
335987,2,8,2,1
335987,1,8,3,1
335987,2,8,3,1
335987,1,8,4,1
335987,2,8,4,2
335987,1,8,5,1
335987,2,8,5,0
335987,1,8,6,1
335987,2,8,6,0
335987,1,9,1,0
335987,2,9,1,0
335987,1,9,2,0
335987,2,9,2,0
335987,1,9,3,0
Query:
SELECT AVG("max_runs_in_match") AS "average_runs_conceded_per_over"
FROM (
  SELECT "match_id", MAX("total_runs_in_over") AS "max_runs_in_match"
  FROM (
    SELECT bs."match_id", bs."innings_no", bs."over_id",
           SUM(bs."runs_scored" + COALESCE(er."extra_runs", 0)) AS "total_runs_in_over"
    FROM IPL.IPL."BATSMAN_SCORED" bs
    LEFT JOIN IPL.IPL."EXTRA_RUNS" er
      ON bs."match_id" = er."match_id"
      AND bs."innings_no" = er."innings_no"
      AND bs."over_id" = er."over_id"
      AND bs."ball_id" = er."ball_id"
    GROUP BY bs."match_id", bs."innings_no", bs."over_id"
  ) per_over
  GROUP BY "match_id"
) max_over_per_match;
Answer:
average_runs_conceded_per_over
19.086268
Query:
SELECT
   COALESCE(bs."match_id", er."match_id") AS "match_id",
   COALESCE(bs."innings_no", er."innings_no") AS "innings_no",
   COALESCE(bs."over_id", er."over_id") AS "over_id",
   COALESCE(bs."batsman_runs", 0) + COALESCE(er."extra_runs", 0) AS "total_runs_in_over"
FROM
   (
     SELECT "match_id", "innings_no", "over_id", SUM("runs_scored") AS "batsman_runs"
     FROM IPL.IPL."BATSMAN_SCORED"
     GROUP BY "match_id", "innings_no", "over_id"
   ) bs
FULL OUTER JOIN
   (
     SELECT "match_id", "innings_no", "over_id", SUM("extra_runs") AS "extra_runs"
     FROM IPL.IPL."EXTRA_RUNS"
     GROUP BY "match_id", "innings_no", "over_id"
   ) er
ON bs."match_id" = er."match_id"
   AND bs."innings_no" = er."innings_no"
   AND bs."over_id" = er."over_id"
ORDER BY "total_runs_in_over" DESC
LIMIT 100
Answer:
match_id,innings_no,over_id,total_runs_in_over
501252,2,3,37
734052,2,6,33
419144,1,13,33
548332,2,13,31
980992,1,19,30
501265,1,15,30
335993,2,13,30
980992,1,18,30
598065,2,17,29
598032,1,8,29
548323,2,19,28
598032,1,5,28
980912,1,19,28
733988,2,3,28
598032,1,15,28
392233,1,19,28
729296,2,18,27
734010,1,20,27
501275,1,1,27
501246,1,19,27
729322,2,17,27
548344,2,19,27
336020,1,19,27
548318,1,19,27
598042,1,20,27
392233,2,20,26
598034,1,1,26
335997,2,14,26
734042,2,13,26
734012,1,5,26
734012,1,19,26
598069,2,15,26
335993,1,18,26
336023,2,14,26
733996,1,16,26
501218,1,20,26
829734,1,14,26
980928,1,14,26
419142,1,16,26
419112,2,12,26
598047,1,20,26
335988,1,20,25
548353,1,18,25
598055,1,20,25
392242,2,6,25
980942,2,6,25
419141,2,17,25
829794,2,19,25
548385,1,19,25
598056,1,17,25
501262,1,13,25
829800,1,17,25
729300,1,13,25
419157,1,20,25
501225,1,3,25
392235,1,19,25
336041,1,20,25
548353,1,19,25
548367,1,6,25
980936,2,18,25
419117,2,13,25
336024,1,17,25
336031,1,20,24
733996,2,11,24
548381,2,2,24
548372,1,20,24
980954,2,3,24
392207,1,18,24
829742,2,13,24
829742,1,17,24
734052,1,4,24
598059,1,18,24
336001,1,19,24
392228,1,6,24
392194,2,7,24
501237,1,18,24
733988,1,19,24
548329,1,17,24
548360,1,5,24
392219,1,15,24
419134,2,5,24
419128,1,19,24
336033,2,2,24
598004,2,17,24
829796,2,14,24
548329,1,14,24
335987,1,15,24
981024,1,20,24
419122,1,2,24
598072,1,19,24
734032,1,15,24
419138,2,3,24
829790,1,3,24
829812,2,2,24
733982,2,19,24
734034,1,20,24
501229,1,20,24
980964,2,17,24
548332,2,20,24
419142,2,15,23
Query:
SELECT
   "match_id",
   "innings_no",
   "over_id",
   SUM("total_runs") AS "total_runs_in_over"
FROM (
   SELECT "match_id", "innings_no", "over_id", SUM("runs_scored") AS "total_runs"
   FROM IPL.IPL."BATSMAN_SCORED"
   GROUP BY "match_id", "innings_no", "over_id"
   UNION ALL
   SELECT "match_id", "innings_no", "over_id", SUM("extra_runs") AS "total_runs"
   FROM IPL.IPL."EXTRA_RUNS"
   GROUP BY "match_id", "innings_no", "over_id"
) combined_runs
GROUP BY "match_id", "innings_no", "over_id"
HAVING SUM("total_runs") > 20
ORDER BY "total_runs_in_over" DESC
LIMIT 100
Answer:
match_id,innings_no,over_id,total_runs_in_over
501252,2,3,37
734052,2,6,33
419144,1,13,33
548332,2,13,31
980992,1,19,30
335993,2,13,30
501265,1,15,30
980992,1,18,30
598065,2,17,29
598032,1,8,29
392233,1,19,28
980912,1,19,28
733988,2,3,28
548323,2,19,28
598032,1,5,28
598032,1,15,28
501275,1,1,27
548344,2,19,27
729322,2,17,27
734010,1,20,27
501246,1,19,27
548318,1,19,27
336020,1,19,27
729296,2,18,27
598042,1,20,27
501218,1,20,26
734012,1,19,26
598034,1,1,26
598047,1,20,26
733996,1,16,26
419112,2,12,26
734042,2,13,26
392233,2,20,26
336023,2,14,26
734012,1,5,26
419142,1,16,26
335997,2,14,26
598069,2,15,26
335993,1,18,26
980928,1,14,26
829734,1,14,26
548353,1,19,25
548353,1,18,25
980942,2,6,25
980936,2,18,25
419141,2,17,25
392235,1,19,25
829800,1,17,25
335988,1,20,25
419117,2,13,25
598056,1,17,25
501225,1,3,25
829794,2,19,25
419157,1,20,25
392242,2,6,25
548385,1,19,25
548367,1,6,25
729300,1,13,25
501262,1,13,25
598055,1,20,25
336024,1,17,25
336041,1,20,25
419138,2,3,24
419134,2,5,24
829812,2,2,24
598072,1,19,24
980964,2,17,24
419128,1,19,24
548329,1,17,24
336001,1,19,24
829796,2,14,24
336031,1,20,24
829790,1,3,24
336033,2,2,24
829742,1,17,24
392207,1,18,24
392194,2,7,24
501237,1,18,24
501229,1,20,24
548372,1,20,24
734032,1,15,24
734034,1,20,24
335987,1,15,24
598059,1,18,24
548332,2,20,24
598004,2,17,24
392219,1,15,24
733996,2,11,24
734052,1,4,24
981024,1,20,24
392228,1,6,24
548360,1,5,24
829742,2,13,24
980954,2,3,24
548381,2,2,24
733988,1,19,24
548329,1,14,24
733982,2,19,24
419122,1,2,24
335987,1,4,23
Query:
SELECT "match_id", MAX("total_runs_in_over") AS "max_runs_conceded_in_over"
FROM (
   SELECT
      "match_id",
      "over_id",
      SUM("total_runs") AS "total_runs_in_over"
   FROM (
      SELECT "match_id", "over_id", SUM("runs_scored") AS "total_runs"
      FROM IPL.IPL."BATSMAN_SCORED"
      GROUP BY "match_id", "over_id"
      UNION ALL
      SELECT "match_id", "over_id", SUM("extra_runs") AS "total_runs"
      FROM IPL.IPL."EXTRA_RUNS"
      GROUP BY "match_id", "over_id"
   ) per_over_runs
   GROUP BY "match_id", "over_id"
) max_runs_per_match
GROUP BY "match_id"
LIMIT 100
Answer:
match_id,max_runs_conceded_in_over
335987,28
335988,34
335989,23
335990,39
335991,23
335992,25
335993,32
335996,31
335997,28
336006,30
335994,34
335998,26
335995,39
336002,22
335999,31
336009,28
336016,26
336007,38
336008,30
336012,35
336015,29
336031,32
336040,32
336019,41
336023,36
336028,34
336030,18
336036,31
336037,25
392187,18
336024,40
336029,30
336033,35
392191,31
392207,28
392224,24
419123,22
336041,40
392229,27
392243,25
419134,30
419157,37
501234,20
336003,33
336010,24
336039,29
336027,39
336044,21
336038,33
392188,30
392190,29
392197,27
336032,26
419117,40
419130,30
392218,20
392236,34
419154,25
392209,34
392244,24
419131,31
501243,29
501261,38
598046,30
336017,34
336011,23
336021,24
336014,36
336013,22
336022,19
336042,26
336045,25
392194,32
392200,19
392214,30
392233,40
392216,38
392240,25
392227,33
392204,29
392217,23
419162,32
336001,32
336025,37
336004,32
336020,32
336026,27
336034,24
336043,29
392193,26
392221,36
392223,30
392230,29
392219,35
392201,36
392208,25
392212,28
392237,22
419136,27
392220,35
Query:
SELECT
   COALESCE(bs."match_id", er."match_id") AS "match_id",
   COALESCE(bs."total_batsman_runs", 0) + COALESCE(er."total_extra_runs", 0) AS "total_runs"
FROM
   (
     SELECT "match_id", SUM("runs_scored") AS "total_batsman_runs"
     FROM IPL.IPL."BATSMAN_SCORED"
     GROUP BY "match_id"
   ) bs
FULL OUTER JOIN
   (
     SELECT "match_id", SUM("extra_runs") AS "total_extra_runs"
     FROM IPL.IPL."EXTRA_RUNS"
     GROUP BY "match_id"
   ) er
ON bs."match_id" = er."match_id"
ORDER BY "total_runs" DESC
LIMIT 100
Answer:
match_id,total_runs
419142,469
335988,447
501228,433
829800,431
335995,431
734052,428
419112,420
733992,418
734012,416
548323,413
336038,412
729288,411
335994,410
548377,409
980912,409
981024,408
419117,407
419144,404
336024,401
829742,400
734054,399
598032,396
829792,395
548331,393
980954,391
829816,389
419164,387
980974,386
598039,386
729296,384
734046,384
598069,384
548371,384
980926,383
548386,382
734004,381
501211,381
548334,380
336019,379
392236,377
501218,377
548347,377
336033,377
336025,376
336014,375
980914,375
419121,375
598011,374
734034,374
980964,374
980958,373
829716,373
829734,372
336003,372
598030,371
598031,371
829720,370
419150,370
598056,369
392194,369
981000,369
548332,368
548322,367
829796,367
548361,366
829774,366
501215,366
829804,365
419141,365
829782,364
548338,364
729306,364
733996,364
829828,363
980942,362
598065,362
829778,362
598059,362
419130,361
598052,360
734032,360
501259,359
733986,359
980996,359
392219,359
548353,359
548385,358
980936,357
598047,357
598046,357
829718,356
734010,356
336037,355
733988,355
501248,354
336036,353
980976,353
501265,353
501272,353
980946,353
End Exploring Related Columns
Task: Please calculate the average of the highest runs conceded in a single over for each match.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To calculate the average of the highest runs conceded in a single over for each match, we consider the following steps:

1. **For each match**, identify the over with the **maximum runs conceded**.
2. **Collect** these maximum runs from each match.
3. **Calculate** the average of these values across all matches to find the desired result.

The expected output format is as follows:

```csv
average_runs_conceded_per_over
value:float
(Attention: answer in one row)
```.
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'IPL': {'IPL': ['BALL_BY_BALL', 'BATSMAN_SCORED', 'EXTRA_RUNS', 'MATCH', 'PLAYER', 'PLAYER_MATCH', 'TEAM', 'WICKET_TAKEN']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-24 06:33:42 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 06:33:42 - root - INFO - ```sql
WITH batsman_runs AS (
  SELECT
    "match_id",
    "innings_no",
    "over_id",
    SUM("runs_scored") AS "batsman_runs_in_over"
  FROM IPL.IPL."BATSMAN_SCORED"
  GROUP BY "match_id", "innings_no", "over_id"
),
extra_runs AS (
  SELECT
    "match_id",
    "innings_no",
    "over_id",
    SUM("extra_runs") AS "extra_runs_in_over"
  FROM IPL.IPL."EXTRA_RUNS"
  GROUP BY "match_id", "innings_no", "over_id"
),
total_runs_per_over AS (
  SELECT
    COALESCE(br."match_id", er."match_id") AS "match_id",
    COALESCE(br."innings_no", er."innings_no") AS "innings_no",
    COALESCE(br."over_id", er."over_id") AS "over_id",
    COALESCE(br."batsman_runs_in_over", 0) + COALESCE(er."extra_runs_in_over", 0) AS "total_runs_in_over"
  FROM batsman_runs br
  FULL OUTER JOIN extra_runs er
    ON br."match_id" = er."match_id"
    AND br."innings_no" = er."innings_no"
    AND br."over_id" = er."over_id"
),
max_runs_per_match AS (
  SELECT
    "match_id",
    MAX("total_runs_in_over") AS "max_runs_in_match"
  FROM total_runs_per_over
  GROUP BY "match_id"
)
SELECT
  AVG("max_runs_in_match") AS "average_runs_conceded_per_over"
FROM max_runs_per_match;
```
2025-01-24 06:33:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:33:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:33:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:33:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 06:33:43 - snowflake.connector.connection - INFO - closed
2025-01-24 06:33:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:33:44 - root - INFO - itercount: 1
2025-01-24 06:33:44 - root - INFO - 0
2025-01-24 06:33:44 - root - INFO - results: 
average_runs_conceded_per_over
19.426056


2025-01-24 06:33:44 - root - INFO - Please check the answer again by reviewing Please calculate the average of the highest runs conceded in a single over for each match., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To calculate the average of the highest runs conceded in a single over for each match, we consider the following steps:

1. **For each match**, identify the over with the **maximum runs conceded**.
2. **Collect** these maximum runs from each match.
3. **Calculate** the average of these values across all matches to find the desired result.

The expected output format is as follows:

```csv
average_runs_conceded_per_over
value:float
(Attention: answer in one row)
``` The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
average_runs_conceded_per_over
19.426056
Current sql:
WITH batsman_runs AS (
  SELECT
    "match_id",
    "innings_no",
    "over_id",
    SUM("runs_scored") AS "batsman_runs_in_over"
  FROM IPL.IPL."BATSMAN_SCORED"
  GROUP BY "match_id", "innings_no", "over_id"
),
extra_runs AS (
  SELECT
    "match_id",
    "innings_no",
    "over_id",
    SUM("extra_runs") AS "extra_runs_in_over"
  FROM IPL.IPL."EXTRA_RUNS"
  GROUP BY "match_id", "innings_no", "over_id"
),
total_runs_per_over AS (
  SELECT
    COALESCE(br."match_id", er."match_id") AS "match_id",
    COALESCE(br."innings_no", er."innings_no") AS "innings_no",
    COALESCE(br."over_id", er."over_id") AS "over_id",
    COALESCE(br."batsman_runs_in_over", 0) + COALESCE(er."extra_runs_in_over", 0) AS "total_runs_in_over"
  FROM batsman_runs br
  FULL OUTER JOIN extra_runs er
    ON br."match_id" = er."match_id"
    AND br."innings_no" = er."innings_no"
    AND br."over_id" = er."over_id"
),
max_runs_per_match AS (
  SELECT
    "match_id",
    MAX("total_runs_in_over") AS "max_runs_in_match"
  FROM total_runs_per_over
  GROUP BY "match_id"
)
SELECT
  AVG("max_runs_in_match") AS "average_runs_conceded_per_over"
FROM max_runs_per_match;
2025-01-24 06:34:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 06:34:30 - root - INFO - ```sql
WITH batsman_runs AS (
  SELECT
    "match_id",
    "innings_no",
    "over_id",
    SUM("runs_scored") AS "batsman_runs_in_over"
  FROM IPL.IPL."BATSMAN_SCORED"
  GROUP BY "match_id", "innings_no", "over_id"
),
extra_runs AS (
  SELECT
    "match_id",
    "innings_no",
    "over_id",
    SUM("extra_runs") AS "extra_runs_in_over"
  FROM IPL.IPL."EXTRA_RUNS"
  GROUP BY "match_id", "innings_no", "over_id"
),
total_runs_per_over AS (
  SELECT
    COALESCE(br."match_id", er."match_id") AS "match_id",
    COALESCE(br."innings_no", er."innings_no") AS "innings_no",
    COALESCE(br."over_id", er."over_id") AS "over_id",
    COALESCE(br."batsman_runs_in_over", 0) + COALESCE(er."extra_runs_in_over", 0) AS "total_runs_in_over"
  FROM batsman_runs br
  FULL OUTER JOIN extra_runs er
    ON br."match_id" = er."match_id"
    AND br."innings_no" = er."innings_no"
    AND br."over_id" = er."over_id"
),
max_runs_per_match AS (
  SELECT
    "match_id",
    MAX("total_runs_in_over") AS "max_runs_in_match"
  FROM total_runs_per_over
  GROUP BY "match_id"
)
SELECT
  ROUND(AVG("max_runs_in_match"), 4) AS "average_runs_conceded_per_over"
FROM max_runs_per_match;
```
2025-01-24 06:34:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 06:34:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 06:34:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 06:34:32 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 06:34:32 - snowflake.connector.connection - INFO - closed
2025-01-24 06:34:32 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 06:34:32 - root - INFO - itercount: 2
2025-01-24 06:34:32 - root - INFO - 0
2025-01-24 06:34:32 - root - INFO - Total iteration counts: 2
