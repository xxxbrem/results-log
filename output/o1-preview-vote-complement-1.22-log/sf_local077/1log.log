2025-01-24 07:42:14 - openai._base_client - INFO - Retrying request to /chat/completions in 0.474516 seconds
2025-01-24 07:43:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 07:43:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 07:43:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 07:43:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 07:43:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 07:43:27 - snowflake.connector.connection - INFO - closed
2025-01-24 07:43:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 07:43:28 - root - INFO - SQL:
SELECT *
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS"
   WHERE ("_year" = 2018 AND "_month" >= 9) OR ("_year" = 2019 AND "_month" <= 8)
   LIMIT 100;
Results:
_month,_year,month_year,interest_id,composition,index_value,ranking,percentile_ranking
9.0,2018.0,09-2018,6218.0,4.61,2.84,1,99.87
9.0,2018.0,09-2018,6285.0,7.06,2.82,2,99.74
9.0,2018.0,09-2018,22502.0,6.49,2.76,3,99.62
9.0,2018.0,09-2018,115.0,6.81,2.74,4,99.49
9.0,2018.0,09-2018,6013.0,4.9,2.73,5,99.36
9.0,2018.0,09-2018,6206.0,7.49,2.67,6,99.23
9.0,2018.0,09-2018,4.0,6.05,2.58,7,99.1
9.0,2018.0,09-2018,171.0,6.36,2.49,8,98.97
9.0,2018.0,09-2018,38.0,4.67,2.46,9,98.85
9.0,2018.0,09-2018,6219.0,4.28,2.36,10,98.72
9.0,2018.0,09-2018,35904.0,5.19,2.34,11,98.59
9.0,2018.0,09-2018,16137.0,5.25,2.31,12,98.46
9.0,2018.0,09-2018,6110.0,4.48,2.3,13,98.33
9.0,2018.0,09-2018,19250.0,6.62,2.29,14,98.21
9.0,2018.0,09-2018,16.0,3.66,2.28,15,98.08
9.0,2018.0,09-2018,5970.0,6.95,2.28,15,98.08
9.0,2018.0,09-2018,21242.0,5.84,2.28,15,98.08
9.0,2018.0,09-2018,17269.0,5.28,2.28,15,98.08
9.0,2018.0,09-2018,21057.0,18.18,2.2,19,97.56
9.0,2018.0,09-2018,32486.0,4.86,2.19,20,97.44
9.0,2018.0,09-2018,19613.0,5.1,2.19,20,97.44
9.0,2018.0,09-2018,6107.0,4.4,2.17,22,97.18
9.0,2018.0,09-2018,151.0,5.57,2.16,23,97.05
9.0,2018.0,09-2018,6023.0,5.85,2.16,23,97.05
9.0,2018.0,09-2018,6232.0,4.48,2.15,25,96.79
9.0,2018.0,09-2018,17320.0,2.8,2.14,26,96.67
9.0,2018.0,09-2018,35903.0,5.23,2.14,26,96.67
9.0,2018.0,09-2018,33.0,5.16,2.12,28,96.41
9.0,2018.0,09-2018,12133.0,12.8,2.1,29,96.28
9.0,2018.0,09-2018,4897.0,6.35,2.1,29,96.28
9.0,2018.0,09-2018,31.0,4.09,2.09,31,96.03
9.0,2018.0,09-2018,19423.0,5.04,2.08,32,95.9
9.0,2018.0,09-2018,6.0,9.48,2.07,33,95.77
9.0,2018.0,09-2018,12025.0,7.83,2.07,33,95.77
9.0,2018.0,09-2018,21061.0,7.06,2.07,33,95.77
9.0,2018.0,09-2018,6284.0,11.06,2.04,36,95.38
9.0,2018.0,09-2018,5968.0,5.79,2.03,37,95.26
9.0,2018.0,09-2018,6378.0,5.01,2.03,37,95.26
9.0,2018.0,09-2018,5969.0,14.29,2.03,37,95.26
9.0,2018.0,09-2018,17.0,3.07,2.01,40,94.87
9.0,2018.0,09-2018,6144.0,4.53,1.99,41,94.74
9.0,2018.0,09-2018,6286.0,11.18,1.99,41,94.74
9.0,2018.0,09-2018,17786.0,5.83,1.98,43,94.49
9.0,2018.0,09-2018,77.0,10.28,1.98,43,94.49
9.0,2018.0,09-2018,19298.0,11.74,1.97,45,94.23
9.0,2018.0,09-2018,17785.0,5.93,1.97,45,94.23
9.0,2018.0,09-2018,79.0,3.32,1.95,47,93.97
9.0,2018.0,09-2018,39.0,9.93,1.95,47,93.97
9.0,2018.0,09-2018,64.0,11.93,1.94,49,93.72
9.0,2018.0,09-2018,49.0,3.58,1.93,50,93.59
9.0,2018.0,09-2018,16138.0,5.01,1.93,50,93.59
9.0,2018.0,09-2018,6184.0,4.87,1.93,50,93.59
9.0,2018.0,09-2018,11067.0,6.71,1.91,53,93.21
9.0,2018.0,09-2018,4943.0,9.91,1.91,53,93.21
9.0,2018.0,09-2018,34465.0,2.83,1.88,55,92.95
9.0,2018.0,09-2018,32704.0,5.74,1.87,56,92.82
9.0,2018.0,09-2018,18923.0,3.14,1.87,56,92.82
9.0,2018.0,09-2018,88.0,3.23,1.86,58,92.56
9.0,2018.0,09-2018,10008.0,5.45,1.86,58,92.56
9.0,2018.0,09-2018,6029.0,7.9,1.86,58,92.56
9.0,2018.0,09-2018,17730.0,5.95,1.86,58,92.56
9.0,2018.0,09-2018,147.0,3.68,1.84,62,92.05
9.0,2018.0,09-2018,11974.0,3.43,1.84,62,92.05
9.0,2018.0,09-2018,158.0,8.43,1.83,64,91.79
9.0,2018.0,09-2018,4902.0,3.71,1.83,64,91.79
9.0,2018.0,09-2018,6304.0,4.51,1.83,64,91.79
9.0,2018.0,09-2018,34463.0,2.69,1.83,64,91.79
9.0,2018.0,09-2018,19295.0,5.84,1.83,64,91.79
9.0,2018.0,09-2018,21060.0,7.03,1.82,69,91.15
9.0,2018.0,09-2018,6210.0,4.31,1.82,69,91.15
9.0,2018.0,09-2018,18347.0,4.95,1.81,71,90.9
9.0,2018.0,09-2018,33971.0,4.75,1.81,71,90.9
9.0,2018.0,09-2018,56.0,3.55,1.8,73,90.64
9.0,2018.0,09-2018,7537.0,3.79,1.79,74,90.51
9.0,2018.0,09-2018,35.0,3.27,1.79,74,90.51
9.0,2018.0,09-2018,10980.0,5.21,1.78,76,90.26
9.0,2018.0,09-2018,5896.0,4.55,1.77,77,90.13
9.0,2018.0,09-2018,6305.0,5.38,1.77,77,90.13
9.0,2018.0,09-2018,98.0,3.71,1.77,77,90.13
9.0,2018.0,09-2018,12031.0,5.1,1.75,80,89.74
9.0,2018.0,09-2018,35953.0,4.17,1.75,80,89.74
9.0,2018.0,09-2018,4914.0,2.89,1.75,80,89.74
9.0,2018.0,09-2018,6142.0,4.35,1.74,83,89.36
9.0,2018.0,09-2018,19603.0,4.45,1.74,83,89.36
9.0,2018.0,09-2018,21062.0,5.68,1.73,85,89.1
9.0,2018.0,09-2018,6315.0,3.16,1.73,85,89.1
9.0,2018.0,09-2018,7557.0,4.0,1.73,85,89.1
9.0,2018.0,09-2018,6250.0,3.64,1.72,88,88.72
9.0,2018.0,09-2018,4924.0,3.75,1.71,89,88.59
9.0,2018.0,09-2018,19621.0,9.86,1.71,89,88.59
9.0,2018.0,09-2018,33959.0,2.53,1.71,89,88.59
9.0,2018.0,09-2018,22427.0,3.88,1.71,89,88.59
9.0,2018.0,09-2018,21059.0,5.11,1.7,93,88.08
9.0,2018.0,09-2018,7527.0,4.39,1.69,94,87.95
9.0,2018.0,09-2018,83.0,3.04,1.68,95,87.82
9.0,2018.0,09-2018,22403.0,5.42,1.67,96,87.69
9.0,2018.0,09-2018,113.0,3.91,1.67,96,87.69
9.0,2018.0,09-2018,18204.0,4.94,1.67,96,87.69
9.0,2018.0,09-2018,137.0,4.06,1.67,96,87.69
9.0,2018.0,09-2018,6340.0,4.58,1.67,96,87.69

2025-01-24 07:43:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 07:43:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 07:43:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 07:43:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 07:43:29 - snowflake.connector.connection - INFO - closed
2025-01-24 07:43:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 07:43:30 - root - INFO - SQL:
SELECT DISTINCT im."interest_id", im."ranking", m."interest_name"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
   JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
     ON im."interest_id" = m."id"
   LIMIT 100;
Results:
interest_id,ranking,interest_name
32486.0,1,Vacation Rental Accommodation Researchers
6106.0,2,Luxury Second Home Owners
18923.0,3,Online Home Decor Shoppers
6344.0,4,Hair Care Shoppers
69.0,6,Healthy Eaters
79.0,7,Luxury Travel Researchers
6214.0,8,Home Remodelers
4895.0,12,Mature Parents
6123.0,16,Misc-Deal Seekers or Coupon Shoppers
4870.0,22,Tech-Savvy Moms
19423.0,23,Kitchen Appliance Shoppers
6219.0,79,Cycling Enthusiasts
6378.0,100,Luggage Shoppers
6087.0,132,Metal and Rock Music Fans
6278.0,202,Junk Food Lovers
6217.0,13,Weight Loss Researchers
4.0,14,Luxury Retail Researchers
17.0,19,MLB Fans
4914.0,39,Mens Health Researchers
60.0,51,Online Health Researchers
4902.0,73,Yogis
16197.0,88,Financial Business Intelligence Researchers
22427.0,142,Yale University Fans
7453.0,178,Pilots
67.0,193,Lawyers
4940.0,158,Auto-Looking for New Car Purchase or Lease
19422.0,10,Home Design and Living Publication Readers
4911.0,75,Dieters
11974.0,79,Price Conscious Home Shoppers
115.0,42,Mens Shoe Shoppers
1.0,46,Fitness Enthusiasts
16137.0,62,Olympics Fans
4913.0,90,Womens Health Researchers
6227.0,105,Personal Stock Portfolio Managers
89.0,126,Travel Researchers
7605.0,189,Organic Food Buyers
5914.0,213,Career Focused Individuals
6143.0,229,College Football Fans
5930.0,241,Tax Filers
12820.0,241,Commercial Contractors & Designers
4910.0,77,Cholesterol Researchers
18996.0,126,Investment Banking Professionals
6076.0,208,Horse Owners
88.0,217,Ski and Snowboard Enthusiasts
75.0,235,Ink & Toner Shoppers
4894.0,287,Credit Union Researchers
48.0,416,Charitable Donors
6305.0,423,Identity Theft Protection Researchers
10980.0,93,Hanukkah Decorations Shoppers
4909.0,158,First Aid Researchers
18648.0,153,Architecture Enthusiasts
20731.0,163,Readers of South Asian Content
6162.0,179,Healthy Snacks Shoppers
20764.0,101,Entertainment Industry Decision Makers
11975.0,113,Landscape Architects
6127.0,167,LED Lighting Shoppers
4920.0,245,LGBT Activists
65.0,298,Hands-On Parents
19296.0,298,BBQ Enthusiasts
6229.0,309,Sweet Tooths
6024.0,416,Joint Pain Health Care Professionals
21059.0,63,Executive Travelers
7425.0,294,Life Insurance Researchers
6089.0,24,Mens Fitness Publication Readers
6184.0,29,Reusable Drinkware Shoppers
36.0,44,Baby Products Buyers
3.0,174,Car Enthusiasts
5960.0,193,New Zealand Trip Planners
6164.0,390,Microsoft Friendly Developers
6218.0,15,Running Enthusiasts
19613.0,18,Land Rover Shoppers
133.0,46,High End Camera Shoppers - Dupe
40.0,54,Bed & Bath Shoppers
132.0,98,Apple Fans
5938.0,57,Costa Rica Trip Planners
6315.0,63,Boston Trip Planners
6341.0,92,Pharmacy Shoppers
6284.0,132,Gym Equipment Owners
135.0,149,Major Appliance Shoppers
21293.0,182,Home Wifi Researchers
17785.0,182,Luxury Womens Brands Shoppers
17803.0,92,TV Advertising Professionals
44.0,105,Home Buyers
6172.0,121,Camera Review Readers
13.0,126,Advertising Professionals
138.0,155,Home Kitchen Bakers
90.0,199,Coupon Researchers
147.0,210,Broadway Fans
19879.0,221,Personal Investment Researchers
49.0,229,NHL Fans
22096.0,249,Camping Enthusiasts
6265.0,249,Pharmacists
150.0,49,TV Junkies
18622.0,257,Las Vegas Nightlife Researchers
12132.0,263,Last Minute Travelers
5907.0,296,Budget Small Business Researchers
6220.0,298,Eyeglasses & Contact Lens Buyers
6321.0,443,Nashville Trip Planners
6325.0,555,Orlando Trip Planners
118.0,578,Sleep Disorder Researchers

2025-01-24 07:43:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 07:43:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 07:43:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 07:43:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 12
2025-01-24 07:43:31 - snowflake.connector.connection - INFO - closed
2025-01-24 07:43:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 07:43:31 - root - INFO - SQL:
SELECT im."_year", im."_month", MAX(im."composition") AS "max_composition"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
   WHERE ("_year" = 2018 AND "_month" >= 9) OR ("_year" = 2019 AND "_month" <= 8)
   GROUP BY im."_year", im."_month"
   ORDER BY im."_year", im."_month"
   LIMIT 100;
Results:
_year,_month,max_composition
2018.0,9.0,18.18
2018.0,10.0,20.28
2018.0,11.0,19.45
2018.0,12.0,21.2
2019.0,1.0,18.99
2019.0,2.0,18.39
2019.0,3.0,12.64
2019.0,4.0,11.01
2019.0,5.0,7.53
2019.0,6.0,6.94
2019.0,7.0,7.19
2019.0,8.0,7.1

2025-01-24 07:43:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 07:43:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 07:43:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 07:43:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 07:43:33 - snowflake.connector.connection - INFO - closed
2025-01-24 07:43:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 07:43:33 - root - INFO - SQL:
SELECT im."_year", im."_month", im."composition", m."interest_name"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
   JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
     ON im."interest_id" = m."id"
   WHERE ("_year" = 2018 AND "_month" >= 9) OR ("_year" = 2019 AND "_month" <= 8)
   ORDER BY im."_year", im."_month", im."composition" DESC
   LIMIT 100;
Results:
_year,_month,composition,interest_name
2018.0,9.0,18.18,Work Comes First Travelers
2018.0,9.0,14.29,Luxury Bedding Shoppers
2018.0,9.0,12.8,Luxury Boutique Hotel Researchers
2018.0,9.0,11.93,High-End Kids Furniture and Clothes Shoppers
2018.0,9.0,11.74,Beach Supplies Shoppers
2018.0,9.0,11.18,Luxury Hotel Guests
2018.0,9.0,11.06,Gym Equipment Owners
2018.0,9.0,10.61,Christmas Celebration Researchers
2018.0,9.0,10.28,Luxury Retail Shoppers
2018.0,9.0,9.96,Patio Furniture Shoppers
2018.0,9.0,9.93,Furniture Shoppers
2018.0,9.0,9.91,Online Grocery Shoppers
2018.0,9.0,9.86,Portugal Trip Planners
2018.0,9.0,9.48,Vacation Planners
2018.0,9.0,9.33,Halloween Costume Shoppers
2018.0,9.0,9.23,Alabama Trip Planners
2018.0,9.0,9.08,Teen Girl Clothing Shoppers
2018.0,9.0,9.06,Skin Care Researchers
2018.0,9.0,8.77,New Years Eve Party Ticket Purchasers
2018.0,9.0,8.7,New Zealand Trip Planners
2018.0,9.0,8.66,Chelsea Fans
2018.0,9.0,8.51,Nursing and Physicians Assistant Journal Researchers
2018.0,9.0,8.43,Flight and Hotel Shoppers
2018.0,9.0,8.25,Pre-Measured Grocery Shoppers
2018.0,9.0,8.12,Restaurant Supply Shoppers
2018.0,9.0,8.12,Financial Advisors
2018.0,9.0,7.92,Travel Researchers
2018.0,9.0,7.9,Indoor Cycling & Spinning Enthusiasts
2018.0,9.0,7.83,Urban Skateboarding Sneaker Shoppers
2018.0,9.0,7.49,Preppy Clothing Shoppers
2018.0,9.0,7.46,Life Insurance Researchers
2018.0,9.0,7.45,Food Safety Decision Makers
2018.0,9.0,7.18,Investment Services Intenders
2018.0,9.0,7.17,Real Estate Decision Makers
2018.0,9.0,7.12,North Carolina Travel Researchers
2018.0,9.0,7.1,Las Vegas Trip Planners
2018.0,9.0,7.06,"Work Hard, Play Hard Travelers"
2018.0,9.0,7.06,Competitive Tri-Athletes
2018.0,9.0,7.03,Family Adventures Travelers
2018.0,9.0,7.0,Freelancers
2018.0,9.0,6.97,Natural Pet Food Shoppers
2018.0,9.0,6.95,Luxury Home Fixture Shoppers
2018.0,9.0,6.92,Healthcare Provider Education Researchers
2018.0,9.0,6.81,Mens Shoe Shoppers
2018.0,9.0,6.8,Credit Score Researchers
2018.0,9.0,6.76,Non-Profit Volunteers
2018.0,9.0,6.71,NCAA Football Fans
2018.0,9.0,6.67,Healthcare Discount Shoppers
2018.0,9.0,6.63,Norfolk and Virginia Beach Trip Planners
2018.0,9.0,6.62,World Cup Enthusiasts
2018.0,9.0,6.59,Arsenal Fans
2018.0,9.0,6.57,Russia Trip Planners
2018.0,9.0,6.56,Vacuum Shoppers
2018.0,9.0,6.53,Nissan Vehicle Shoppers
2018.0,9.0,6.49,Lacrosse Enthusiasts
2018.0,9.0,6.48,Home Healthcare Researchers
2018.0,9.0,6.36,Shoe Shoppers
2018.0,9.0,6.36,Teachers
2018.0,9.0,6.35,Parents of Teenagers Going to College
2018.0,9.0,6.33,Competitive Car Brand Shoppers
2018.0,9.0,6.33,Cosmetics and Beauty Shoppers
2018.0,9.0,6.18,Food Industry Professionals
2018.0,9.0,6.07,Property and Facility Managers
2018.0,9.0,6.05,Luxury Retail Researchers
2018.0,9.0,6.0,Military Families
2018.0,9.0,5.95,Luxury Department Store Shoppers
2018.0,9.0,5.94,Seasonal Allergy Sufferers
2018.0,9.0,5.93,Luxury Womens Brands Shoppers
2018.0,9.0,5.91,Atlanta Trip Planners
2018.0,9.0,5.89,Business Incorporating & LLC Filing Researchers
2018.0,9.0,5.88,Department Store Shoppers
2018.0,9.0,5.85,Sports Medicine Health Care Professionals
2018.0,9.0,5.84,Fishing Equipment Shoppers
2018.0,9.0,5.84,World Cup Apparel Shoppers
2018.0,9.0,5.83,Womens Fashion Brands Shoppers
2018.0,9.0,5.79,Commercial Contractors & Designers
2018.0,9.0,5.79,Luxury Kitchen Goods Shoppers
2018.0,9.0,5.78,Online Education Intenders
2018.0,9.0,5.74,Major Airline Customers
2018.0,9.0,5.68,Recently Retired Individuals
2018.0,9.0,5.68,Getting Off the Grid Travelers
2018.0,9.0,5.65,Web Design Researchers
2018.0,9.0,5.61,Diner and Ice Cream Lovers
2018.0,9.0,5.61,Pain Management Researchers
2018.0,9.0,5.6,HDTV Researchers
2018.0,9.0,5.58,Weight Loss Researchers
2018.0,9.0,5.57,Online Health Researchers
2018.0,9.0,5.57,Big & Tall Men
2018.0,9.0,5.52,Military Personal Finance Researchers
2018.0,9.0,5.48,Countdown to the Beach Travelers
2018.0,9.0,5.46,Medical Advice Researchers
2018.0,9.0,5.45,Japanese Luxury Car Enthusiasts
2018.0,9.0,5.45,Credit Union Researchers
2018.0,9.0,5.42,Pandora Jewelry Shoppers
2018.0,9.0,5.38,Identity Theft Protection Researchers
2018.0,9.0,5.36,Soccer Fans
2018.0,9.0,5.35,Digital Antenna Users
2018.0,9.0,5.28,At-Home Gym Intenders
2018.0,9.0,5.25,Olympics Fans
2018.0,9.0,5.24,Classic Car Shoppers

2025-01-24 07:43:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 07:43:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 07:43:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 07:43:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 07:43:34 - snowflake.connector.connection - INFO - closed
2025-01-24 07:43:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 07:43:35 - root - INFO - SQL:
SELECT im."_year", im."_month", im."interest_id", AVG(im."composition") AS "avg_composition"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
   WHERE ("_year" = 2018 AND "_month" >= 9) OR ("_year" = 2019 AND "_month" <= 8)
   GROUP BY im."_year", im."_month", im."interest_id"
   ORDER BY im."_year", im."_month"
   LIMIT 100;
Results:
_year,_month,interest_id,avg_composition
2018.0,9.0,171.0,6.36
2018.0,9.0,6285.0,7.06
2018.0,9.0,6206.0,7.49
2018.0,9.0,35904.0,5.19
2018.0,9.0,38.0,4.67
2018.0,9.0,16137.0,5.25
2018.0,9.0,19250.0,6.62
2018.0,9.0,17269.0,5.28
2018.0,9.0,5970.0,6.95
2018.0,9.0,21057.0,18.18
2018.0,9.0,17320.0,2.8
2018.0,9.0,32486.0,4.86
2018.0,9.0,35903.0,5.23
2018.0,9.0,12133.0,12.8
2018.0,9.0,31.0,4.09
2018.0,9.0,19423.0,5.04
2018.0,9.0,12025.0,7.83
2018.0,9.0,21061.0,7.06
2018.0,9.0,5968.0,5.79
2018.0,9.0,17.0,3.07
2018.0,9.0,17785.0,5.93
2018.0,9.0,32704.0,5.74
2018.0,9.0,79.0,3.32
2018.0,9.0,19621.0,9.86
2018.0,9.0,6340.0,4.58
2018.0,9.0,18352.0,4.12
2018.0,9.0,6085.0,3.29
2018.0,9.0,6237.0,6.76
2018.0,9.0,19613.0,5.1
2018.0,9.0,6023.0,5.85
2018.0,9.0,6284.0,11.06
2018.0,9.0,17786.0,5.83
2018.0,9.0,77.0,10.28
2018.0,9.0,64.0,11.93
2018.0,9.0,16138.0,5.01
2018.0,9.0,6029.0,7.9
2018.0,9.0,11974.0,3.43
2018.0,9.0,98.0,3.71
2018.0,9.0,19603.0,4.45
2018.0,9.0,11975.0,3.5
2018.0,9.0,60.0,5.57
2018.0,9.0,33474.0,3.2
2018.0,9.0,10250.0,9.33
2018.0,9.0,12821.0,4.24
2018.0,9.0,21058.0,5.48
2018.0,9.0,6171.0,3.84
2018.0,9.0,96.0,2.62
2018.0,9.0,82.0,5.6
2018.0,9.0,10976.0,3.8
2018.0,9.0,34461.0,3.02
2018.0,9.0,6314.0,2.18
2018.0,9.0,134.0,3.71
2018.0,9.0,33959.0,2.53
2018.0,9.0,16.0,3.66
2018.0,9.0,33.0,5.16
2018.0,9.0,4897.0,6.35
2018.0,9.0,88.0,3.23
2018.0,9.0,6.0,9.48
2018.0,9.0,34463.0,2.69
2018.0,9.0,21060.0,7.03
2018.0,9.0,35.0,3.27
2018.0,9.0,7557.0,4.0
2018.0,9.0,6250.0,3.64
2018.0,9.0,22427.0,3.88
2018.0,9.0,7527.0,4.39
2018.0,9.0,83.0,3.04
2018.0,9.0,155.0,3.53
2018.0,9.0,10977.0,10.61
2018.0,9.0,101.0,3.37
2018.0,9.0,6343.0,9.96
2018.0,9.0,5933.0,4.13
2018.0,9.0,18648.0,2.95
2018.0,9.0,6220.0,4.34
2018.0,9.0,6177.0,3.27
2018.0,9.0,21293.0,3.41
2018.0,9.0,6110.0,4.48
2018.0,9.0,151.0,5.57
2018.0,9.0,6232.0,4.48
2018.0,9.0,6144.0,4.53
2018.0,9.0,6286.0,11.18
2018.0,9.0,39.0,9.93
2018.0,9.0,49.0,3.58
2018.0,9.0,18923.0,3.14
2018.0,9.0,17730.0,5.95
2018.0,9.0,158.0,8.43
2018.0,9.0,19295.0,5.84
2018.0,9.0,18347.0,4.95
2018.0,9.0,10980.0,5.21
2018.0,9.0,157.0,4.13
2018.0,9.0,34465.0,2.83
2018.0,9.0,21242.0,5.84
2018.0,9.0,4.0,6.05
2018.0,9.0,22502.0,6.49
2018.0,9.0,6218.0,4.61
2018.0,9.0,4943.0,9.91
2018.0,9.0,21237.0,8.66
2018.0,9.0,6107.0,4.4
2018.0,9.0,6219.0,4.28
2018.0,9.0,6013.0,4.9
2018.0,9.0,115.0,6.81

2025-01-24 07:43:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 07:43:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 07:43:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 07:43:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 12
2025-01-24 07:43:36 - snowflake.connector.connection - INFO - closed
2025-01-24 07:43:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 07:43:37 - root - INFO - SQL:
SELECT im."_year", im."_month", im."ranking", m."interest_name"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
   JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
     ON im."interest_id" = m."id"
   WHERE im."ranking" = 1 AND (("_year" = 2018 AND "_month" >= 9) OR ("_year" = 2019 AND "_month" <= 8))
   ORDER BY im."_year", im."_month"
   LIMIT 100;
Results:
_year,_month,ranking,interest_name
2018.0,9.0,1,Running Enthusiasts
2018.0,10.0,1,Running Enthusiasts
2018.0,11.0,1,Competitive Tri-Athletes
2018.0,12.0,1,Winter Apparel Shoppers
2019.0,1.0,1,Winter Apparel Shoppers
2019.0,2.0,1,Winter Apparel Shoppers
2019.0,3.0,1,Winter Apparel Shoppers
2019.0,4.0,1,Winter Apparel Shoppers
2019.0,5.0,1,Winter Apparel Shoppers
2019.0,6.0,1,Winter Apparel Shoppers
2019.0,7.0,1,Winter Apparel Shoppers
2019.0,8.0,1,Winter Apparel Shoppers

2025-01-24 07:43:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 07:43:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 07:43:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 07:43:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 15
2025-01-24 07:43:38 - snowflake.connector.connection - INFO - closed
2025-01-24 07:43:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 07:43:38 - root - INFO - SQL:
SELECT DISTINCT im."_year", im."_month"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
   ORDER BY im."_year", im."_month"
   LIMIT 100;
Results:
_year,_month
2018.0,7.0
2018.0,8.0
2018.0,9.0
2018.0,10.0
2018.0,11.0
2018.0,12.0
2019.0,1.0
2019.0,2.0
2019.0,3.0
2019.0,4.0
2019.0,5.0
2019.0,6.0
2019.0,7.0
2019.0,8.0
,

2025-01-24 07:43:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 07:43:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 07:43:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 07:43:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 07:43:39 - snowflake.connector.connection - INFO - closed
2025-01-24 07:43:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 07:43:40 - root - INFO - SQL:
SELECT im."interest_id", im."percentile_ranking", m."interest_name"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
   JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
     ON im."interest_id" = m."id"
   WHERE im."_year" = 2019 AND im."_month" = 6
   ORDER BY im."percentile_ranking" DESC
   LIMIT 100;
Results:
interest_id,percentile_ranking,interest_name
41548.0,99.88,Winter Apparel Shoppers
22502.0,99.76,Lacrosse Enthusiasts
42203.0,99.64,Fitness Activity Tracker Users
115.0,99.51,Mens Shoe Shoppers
6206.0,99.39,Preppy Clothing Shoppers
19250.0,99.27,World Cup Enthusiasts
44272.0,99.15,Rowing Enthusiasts
151.0,99.03,Big & Tall Men
41854.0,98.91,Swimming Enthusiasts
45518.0,98.79,Volleyball Enthusiasts
35904.0,98.67,Utility Workwear Shoppers
48154.0,98.54,Elite Cycling Gear Shoppers
6285.0,98.42,Competitive Tri-Athletes
12133.0,98.3,Luxury Boutique Hotel Researchers
40439.0,98.3,Ski and Snowboard Apparel Shoppers
39665.0,98.06,Aspen Skiers and Snowboarders
19298.0,97.94,Beach Supplies Shoppers
47713.0,97.82,High School Sports Researchers
47130.0,97.69,Home Lending Researchers
44588.0,97.69,Softball Enthusiasts
17269.0,97.45,At-Home Gym Intenders
4.0,97.33,Luxury Retail Researchers
6232.0,97.21,Golf Enthusiasts
6286.0,97.21,Luxury Hotel Guests
19295.0,96.97,Fishing Equipment Shoppers
37875.0,96.84,Vermont Trip Planners
171.0,96.84,Shoe Shoppers
38.0,96.6,Sporting Goods Shoppers
5970.0,96.48,Luxury Home Fixture Shoppers
41191.0,96.36,Sports Memorabilia Shoppers
41069.0,96.36,Big East Fans
10008.0,96.12,Japanese Luxury Car Enthusiasts
44446.0,96.0,Home Rug Shoppers
45678.0,95.87,Mens Underwear Shoppers
44489.0,95.87,Home Goods Supercenter Shoppers
6219.0,95.63,Cycling Enthusiasts
5969.0,95.51,Luxury Bedding Shoppers
6378.0,95.39,Luggage Shoppers
38990.0,95.39,Colorado Skiers and Snowboarders
44453.0,95.15,Mens Business Clothes Shoppers
31.0,95.02,Home Decor Shoppers
6013.0,95.02,Competitive Sports Participants
16.0,94.78,NCAA Fans
49979.0,94.78,Cape Cod News Readers
44469.0,94.54,Home Interior Design Enthusiasts
6284.0,94.42,Gym Equipment Owners
44585.0,94.3,Ballet Enthusiasts
6023.0,94.17,Sports Medicine Health Care Professionals
16137.0,94.17,Olympics Fans
19423.0,93.93,Kitchen Appliance Shoppers
6.0,93.93,Vacation Planners
4897.0,93.69,Parents of Teenagers Going to College
18347.0,93.57,Affordable Hotel Bookers
12025.0,93.45,Urban Skateboarding Sneaker Shoppers
33.0,93.45,Kids Clothing Shoppers
6107.0,93.2,Ski House Second Home Owners
21242.0,93.08,World Cup Apparel Shoppers
5968.0,92.96,Luxury Kitchen Goods Shoppers
44476.0,92.84,New York City Events Researchers
11067.0,92.84,NCAA Football Fans
10980.0,92.84,Hanukkah Decorations Shoppers
40183.0,92.48,Canoeing and Kayaking Enthusiasts
6218.0,92.48,Running Enthusiasts
44587.0,92.23,Baseball Enthusiasts
4943.0,92.11,Online Grocery Shoppers
21237.0,92.11,Chelsea Fans
79.0,91.87,Luxury Travel Researchers
39.0,91.87,Furniture Shoppers
36879.0,91.87,Embroidery Enthusiasts
5960.0,91.5,New Zealand Trip Planners
6305.0,91.38,Identity Theft Protection Researchers
101.0,91.38,Flower & Gift Basket Shoppers
6144.0,91.38,North Carolina Football Fans
18996.0,91.02,Investment Banking Professionals
6184.0,90.9,Reusable Drinkware Shoppers
17320.0,90.9,March Madness Enthusiasts
19613.0,90.9,Land Rover Shoppers
6304.0,90.9,New York Trip Planners
4912.0,90.41,Vitamin Shoppers
37423.0,90.41,Promotional Products Purchasers
41080.0,90.17,New York Mets Fans
6110.0,90.17,Apartment Furniture Shoppers
141.0,90.17,Skin Care Researchers
38994.0,89.81,Western Canada Skiers and Snowboarders
32704.0,89.81,Major Airline Customers
32486.0,89.81,Vacation Rental Accommodation Researchers
39657.0,89.44,Kansas City Royals Fans
44455.0,89.44,Kitchen Stove Shoppers
41083.0,89.2,Cininnati Reds Fans
34465.0,89.2,Toronto Blue Jays Fans
18202.0,89.2,Real Estate Decision Makers
6142.0,88.83,European Trip Planners
49.0,88.83,NHL Fans
39649.0,88.59,Duke Blue Devils Fans
19621.0,88.59,Portugal Trip Planners
6343.0,88.35,Patio Furniture Shoppers
6029.0,88.35,Indoor Cycling & Spinning Enthusiasts
134.0,88.35,Home Printer Shoppers
35903.0,88.35,Trendy Denim Shoppers
4924.0,88.35,Surfers

2025-01-24 07:43:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 07:43:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 07:43:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 07:43:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 07:43:41 - snowflake.connector.connection - INFO - closed
2025-01-24 07:43:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 07:43:42 - root - INFO - SQL:
SELECT im."interest_id", AVG(im."composition") AS "avg_composition", m."interest_name"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
   JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
     ON im."interest_id" = m."id"
   WHERE ("_year" = 2018 AND "_month" >= 9) OR ("_year" = 2019 AND "_month" <= 8)
   GROUP BY im."interest_id", m."interest_name"
   ORDER BY "avg_composition" DESC
   LIMIT 100;
Results:
interest_id,avg_composition,interest_name
21057.0,19.415,Work Comes First Travelers
5969.0,11.109166666666667,Luxury Bedding Shoppers
12133.0,10.418333333333333,Luxury Boutique Hotel Researchers
6284.0,9.5075,Gym Equipment Owners
19298.0,9.485833333333334,Beach Supplies Shoppers
6286.0,8.990833333333333,Luxury Hotel Guests
64.0,8.906666666666666,High-End Kids Furniture and Clothes Shoppers
77.0,8.895833333333334,Luxury Retail Shoppers
10977.0,8.7575,Christmas Celebration Researchers
39.0,8.636666666666667,Furniture Shoppers
6.0,8.14,Vacation Planners
6343.0,8.035,Patio Furniture Shoppers
21061.0,7.906666666666666,"Work Hard, Play Hard Travelers"
10981.0,7.808333333333334,New Years Eve Party Ticket Purchasers
19621.0,7.8075,Portugal Trip Planners
5960.0,7.713333333333334,New Zealand Trip Planners
41548.0,7.58,Winter Apparel Shoppers
21060.0,7.576666666666667,Family Adventures Travelers
7541.0,7.444166666666667,Alabama Trip Planners
158.0,7.439166666666666,Flight and Hotel Shoppers
34.0,7.394166666666667,Teen Girl Clothing Shoppers
10250.0,7.343333333333334,Halloween Costume Shoppers
4943.0,7.3308333333333335,Online Grocery Shoppers
18783.0,7.044999999999999,Nursing and Physicians Assistant Journal Researchers
21237.0,7.039166666666667,Chelsea Fans
141.0,6.986666666666667,Skin Care Researchers
5944.0,6.760833333333333,Financial Advisors
4944.0,6.6308333333333325,Pre-Measured Grocery Shoppers
89.0,6.595,Travel Researchers
13497.0,6.460833333333333,Restaurant Supply Shoppers
5970.0,6.425,Luxury Home Fixture Shoppers
12025.0,6.3875,Urban Skateboarding Sneaker Shoppers
115.0,6.350833333333333,Mens Shoe Shoppers
6206.0,6.2124999999999995,Preppy Clothing Shoppers
6029.0,6.0825,Indoor Cycling & Spinning Enthusiasts
6324.0,6.0825,Las Vegas Trip Planners
21062.0,6.0683333333333325,Getting Off the Grid Travelers
6285.0,5.9875,Competitive Tri-Athletes
7425.0,5.915,Life Insurance Researchers
19250.0,5.898333333333333,World Cup Enthusiasts
18202.0,5.855833333333333,Real Estate Decision Makers
21059.0,5.685,Executive Travelers
11067.0,5.648333333333333,NCAA Football Fans
7685.0,5.6258333333333335,Home Healthcare Researchers
15879.0,5.6191666666666675,Freelancers
7540.0,5.615833333333334,North Carolina Travel Researchers
22502.0,5.586666666666667,Lacrosse Enthusiasts
6308.0,5.509166666666666,Food Safety Decision Makers
5911.0,5.5025,Credit Score Researchers
171.0,5.5008333333333335,Shoe Shoppers
124.0,5.460833333333333,Healthcare Discount Shoppers
19617.0,5.446666666666666,Nissan Vehicle Shoppers
18784.0,5.4425,Healthcare Provider Education Researchers
4898.0,5.425833333333333,Cosmetics and Beauty Shoppers
6208.0,5.384166666666666,Recently Retired Individuals
4.0,5.3758333333333335,Luxury Retail Researchers
82.0,5.350833333333333,HDTV Researchers
17540.0,5.338333333333334,Vacuum Shoppers
4897.0,5.338333333333334,Parents of Teenagers Going to College
10009.0,5.299166666666667,Investment Services Intenders
107.0,5.283333333333333,Cruise Travel Intenders
6023.0,5.265,Sports Medicine Health Care Professionals
7535.0,5.251666666666667,Medicare Provider Researchers
30.0,5.241666666666666,Department Store Shoppers
19757.0,5.1925,Natural Pet Food Shoppers
19295.0,5.190833333333333,Fishing Equipment Shoppers
21058.0,5.166666666666667,Countdown to the Beach Travelers
6237.0,5.155833333333333,Non-Profit Volunteers
10008.0,5.1499999999999995,Japanese Luxury Car Enthusiasts
5968.0,5.138333333333333,Luxury Kitchen Goods Shoppers
151.0,5.0825000000000005,Big & Tall Men
28.0,5.066666666666666,Teachers
17786.0,5.025833333333334,Womens Fashion Brands Shoppers
39665.0,5.025,Aspen Skiers and Snowboarders
5925.0,5.0225,Business Incorporating & LLC Filing Researchers
17730.0,4.988333333333333,Luxury Department Store Shoppers
19519.0,4.986666666666667,Property and Facility Managers
42203.0,4.963333333333334,Fitness Activity Tracker Users
10834.0,4.96,Norfolk and Virginia Beach Trip Planners
19623.0,4.895833333333333,Russia Trip Planners
55.0,4.895833333333333,Seasonal Allergy Sufferers
5957.0,4.88,Online Education Intenders
60.0,4.875,Online Health Researchers
5909.0,4.8741666666666665,Web Design Researchers
6303.0,4.846666666666667,Atlanta Trip Planners
17269.0,4.8374999999999995,At-Home Gym Intenders
7461.0,4.826666666666667,Food Industry Professionals
22403.0,4.823333333333333,Pandora Jewelry Shoppers
38368.0,4.811111111111111,Volvo Vehicle Shoppers
4919.0,4.795833333333333,Military Families
17674.0,4.781666666666667,Medical Advice Researchers
4894.0,4.754545454545454,Credit Union Researchers
17729.0,4.75,Competitive Car Brand Shoppers
33.0,4.7491666666666665,Kids Clothing Shoppers
6217.0,4.748333333333334,Weight Loss Researchers
40439.0,4.748,Ski and Snowboard Apparel Shoppers
37875.0,4.742727272727273,Vermont Trip Planners
6378.0,4.738333333333333,Luggage Shoppers
6111.0,4.736,Wine Lovers
10980.0,4.695,Hanukkah Decorations Shoppers

2025-01-24 07:43:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 07:43:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 07:43:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 07:43:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 07:43:43 - snowflake.connector.connection - INFO - closed
2025-01-24 07:43:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 07:43:43 - root - INFO - SQL:
SELECT im."_year", im."_month", im."composition"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
    WHERE ("_year" = 2018 AND "_month" >= 6) OR ("_year" = 2019 AND "_month" <= 8)
    ORDER BY im."_year", im."_month"
    LIMIT 100;
Results:
_year,_month,composition
2018.0,7.0,10.71
2018.0,7.0,9.93
2018.0,7.0,10.82
2018.0,7.0,11.57
2018.0,7.0,9.71
2018.0,7.0,9.47
2018.0,7.0,10.8
2018.0,7.0,9.49
2018.0,7.0,13.97
2018.0,7.0,14.91
2018.0,7.0,11.99
2018.0,7.0,12.62
2018.0,7.0,9.35
2018.0,7.0,10.29
2018.0,7.0,12.22
2018.0,7.0,6.97
2018.0,7.0,11.48
2018.0,7.0,14.1
2018.0,7.0,11.04
2018.0,7.0,9.77
2018.0,7.0,13.35
2018.0,7.0,6.61
2018.0,7.0,11.61
2018.0,7.0,9.48
2018.0,7.0,13.67
2018.0,7.0,6.09
2018.0,7.0,9.97
2018.0,7.0,6.9
2018.0,7.0,10.43
2018.0,7.0,6.83
2018.0,7.0,7.42
2018.0,7.0,11.68
2018.0,7.0,12.87
2018.0,7.0,9.27
2018.0,7.0,6.37
2018.0,7.0,10.91
2018.0,7.0,7.02
2018.0,7.0,6.25
2018.0,7.0,8.84
2018.0,7.0,5.3
2018.0,7.0,6.71
2018.0,7.0,7.21
2018.0,7.0,12.27
2018.0,7.0,10.86
2018.0,7.0,6.28
2018.0,7.0,11.38
2018.0,7.0,11.63
2018.0,7.0,6.47
2018.0,7.0,12.93
2018.0,7.0,8.72
2018.0,7.0,7.9
2018.0,7.0,11.63
2018.0,7.0,9.65
2018.0,7.0,8.14
2018.0,7.0,6.77
2018.0,7.0,6.24
2018.0,7.0,6.26
2018.0,7.0,6.65
2018.0,7.0,10.22
2018.0,7.0,6.53
2018.0,7.0,8.17
2018.0,7.0,11.72
2018.0,7.0,10.95
2018.0,7.0,6.87
2018.0,7.0,6.09
2018.0,7.0,9.97
2018.0,7.0,7.19
2018.0,7.0,6.37
2018.0,7.0,11.4
2018.0,7.0,6.28
2018.0,7.0,5.99
2018.0,7.0,7.46
2018.0,7.0,9.13
2018.0,7.0,5.99
2018.0,7.0,6.88
2018.0,7.0,6.13
2018.0,7.0,5.14
2018.0,7.0,6.25
2018.0,7.0,6.76
2018.0,7.0,7.09
2018.0,7.0,5.68
2018.0,7.0,6.52
2018.0,7.0,6.45
2018.0,7.0,6.21
2018.0,7.0,5.41
2018.0,7.0,7.48
2018.0,7.0,6.45
2018.0,7.0,9.64
2018.0,7.0,6.82
2018.0,7.0,9.37
2018.0,7.0,9.29
2018.0,7.0,11.21
2018.0,7.0,10.85
2018.0,7.0,11.89
2018.0,7.0,10.76
2018.0,7.0,6.05
2018.0,7.0,7.89
2018.0,7.0,10.11
2018.0,7.0,10.77
2018.0,7.0,10.32

2025-01-24 07:43:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 07:43:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 07:43:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 07:43:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-24 07:43:45 - snowflake.connector.connection - INFO - closed
2025-01-24 07:43:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 07:44:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 07:44:39 - root - INFO - ```sql
WITH Monthly_Max AS (
  SELECT
    im."_year",
    im."_month",
    im."interest_id",
    AVG(im."composition") AS avg_composition
  FROM
    "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
  WHERE
    (im."_year" = 2018 AND im."_month" >= 9) OR (im."_year" = 2019 AND im."_month" <= 8)
  GROUP BY
    im."_year",
    im."_month",
    im."interest_id"
),
Max_Per_Month AS (
  SELECT
    mm.*,
    ROW_NUMBER() OVER (PARTITION BY mm."_year", mm."_month" ORDER BY mm.avg_composition DESC) AS rank
  FROM
    Monthly_Max mm
),
Top_Interest_Per_Month AS (
  SELECT
    mpm."_year",
    mpm."_month",
    mpm."interest_id",
    mpm.avg_composition
  FROM
    Max_Per_Month mpm
  WHERE
    mpm.rank = 1
),
Top_Interest_With_Names AS (
  SELECT
    tipm."_year",
    tipm."_month",
    tipm."interest_id",
    imap."interest_name",
    tipm.avg_composition
  FROM
    Top_Interest_Per_Month tipm
    JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" imap
      ON tipm."interest_id" = imap."id"
),
Rolling_Avg AS (
  SELECT
    tipm.*,
    AVG(tipm.avg_composition) OVER (
      ORDER BY tipm."_year", tipm."_month"
      ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
    ) AS rolling_avg
  FROM
    Top_Interest_With_Names tipm
),
Previous_Month_Interests AS (
  SELECT
    tipm.*,
    LAG(tipm."interest_name", 1) OVER (ORDER BY tipm."_year", tipm."_month") AS "Top_Ranking_Interest_Minus1Month",
    LAG(tipm."interest_name", 2) OVER (ORDER BY tipm."_year", tipm."_month") AS "Top_Ranking_Interest_Minus2Months"
  FROM
    Rolling_Avg tipm
)
SELECT
  DATE_FROM_PARTS(pmi."_year", pmi."_month", 1) AS "Date",
  pmi."interest_name" AS "Interest_Name",
  pmi.avg_composition AS "Max_Index_Composition",
  pmi.rolling_avg AS "Rolling_Average",
  pmi."Top_Ranking_Interest_Minus1Month",
  pmi."Top_Ranking_Interest_Minus2Months"
FROM
  Previous_Month_Interests pmi
ORDER BY
  pmi."_year",
  pmi."_month";
```

This SQL query retrieves the required data by:

- Calculating the average composition per interest per month (`Monthly_Max`).
- Identifying the interest with the maximum average composition for each month (`Max_Per_Month`).
- Joining with `INTEREST_MAP` to get the interest names (`Top_Interest_With_Names`).
- Computing the three-month rolling average of the maximum compositions (`Rolling_Avg`).
- Retrieving the top-ranking interests from the previous one and two months (`Previous_Month_Interests`).
- Selecting and ordering the final output to include the date, interest name, max index composition, rolling average, and the top-ranking interests from one and two months ago.
2025-01-24 07:44:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 07:44:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 07:44:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 07:44:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 12
2025-01-24 07:44:41 - snowflake.connector.connection - INFO - closed
2025-01-24 07:44:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 07:45:49 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 07:45:49 - root - INFO - SQL:
WITH Monthly_Max AS (
  SELECT
    im."_year",
    im."_month",
    im."interest_id",
    AVG(im."composition") AS avg_composition
  FROM
    "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
  WHERE
    (im."_year" = 2018 AND im."_month" >= 9) OR (im."_year" = 2019 AND im."_month" <= 8)
  GROUP BY
    im."_year",
    im."_month",
    im."interest_id"
),
Max_Per_Month AS (
  SELECT
    mm.*,
    ROW_NUMBER() OVER (PARTITION BY mm."_year", mm."_month" ORDER BY mm.avg_composition DESC) AS rank
  FROM
    Monthly_Max mm
),
Top_Interest_Per_Month AS (
  SELECT
    mpm."_year",
    mpm."_month",
    mpm."interest_id",
    mpm.avg_composition
  FROM
    Max_Per_Month mpm
  WHERE
    mpm.rank = 1
),
Top_Interest_With_Names AS (
  SELECT
    tipm."_year",
    tipm."_month",
    tipm."interest_id",
    imap."interest_name",
    tipm.avg_composition
  FROM
    Top_Interest_Per_Month tipm
    JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" imap
      ON tipm."interest_id" = imap."id"
),
Rolling_Avg AS (
  SELECT
    tipm.*,
    AVG(tipm.avg_composition) OVER (
      ORDER BY tipm."_year", tipm."_month"
      ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
    ) AS rolling_avg
  FROM
    Top_Interest_With_Names tipm
),
Previous_Month_Interests AS (
  SELECT
    tipm.*,
    LAG(tipm."interest_name", 1) OVER (ORDER BY tipm."_year", tipm."_month") AS "Top_Ranking_Interest_Minus1Month",
    LAG(tipm."interest_name", 2) OVER (ORDER BY tipm."_year", tipm."_month") AS "Top_Ranking_Interest_Minus2Months"
  FROM
    Rolling_Avg tipm
)
SELECT
  DATE_FROM_PARTS(pmi."_year", pmi."_month", 1) AS "Date",
  pmi."interest_name" AS "Interest_Name",
  pmi.avg_composition AS "Max_Index_Composition",
  pmi.rolling_avg AS "Rolling_Average",
  pmi."Top_Ranking_Interest_Minus1Month",
  pmi."Top_Ranking_Interest_Minus2Months"
FROM
  Previous_Month_Interests pmi
ORDER BY
  pmi."_year",
  pmi."_month";
Results:
Date,Interest_Name,Max_Index_Composition,Rolling_Average,Top_Ranking_Interest_Minus1Month,Top_Ranking_Interest_Minus2Months
2018-09-01,Work Comes First Travelers,18.18,18.18,,
2018-10-01,Work Comes First Travelers,20.28,19.23,Work Comes First Travelers,
2018-11-01,Work Comes First Travelers,19.45,19.30333333333333,Work Comes First Travelers,Work Comes First Travelers
2018-12-01,Work Comes First Travelers,21.2,20.31,Work Comes First Travelers,Work Comes First Travelers
2019-01-01,Work Comes First Travelers,18.99,19.88,Work Comes First Travelers,Work Comes First Travelers
2019-02-01,Work Comes First Travelers,18.39,19.526666666666667,Work Comes First Travelers,Work Comes First Travelers
2019-03-01,Luxury Boutique Hotel Researchers,12.64,16.673333333333332,Work Comes First Travelers,Work Comes First Travelers
2019-04-01,Luxury Bedding Shoppers,11.01,14.01333333333333,Luxury Boutique Hotel Researchers,Work Comes First Travelers
2019-05-01,Luxury Bedding Shoppers,7.53,10.39333333333333,Luxury Bedding Shoppers,Luxury Boutique Hotel Researchers
2019-06-01,Gym Equipment Owners,6.94,8.49333333333333,Luxury Bedding Shoppers,Luxury Bedding Shoppers
2019-07-01,Gym Equipment Owners,7.19,7.219999999999996,Gym Equipment Owners,Luxury Bedding Shoppers
2019-08-01,Gym Equipment Owners,7.1,7.0766666666666636,Gym Equipment Owners,Gym Equipment Owners

2025-01-24 07:45:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 07:45:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 07:45:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 07:45:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 07:45:50 - snowflake.connector.connection - INFO - closed
2025-01-24 07:45:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 07:45:51 - root - INFO - SQL:
SELECT m."interest_name", m."interest_summary"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
LIMIT 100
Results:
Too long, hard cut:
interest_name,interest_summary
Fitness Enthusiasts,Consumers using fitness tracking apps and websites.
Gamers,Consumers researching game reviews and cheat codes.
Car Enthusiasts,Readers of automotive news and car reviews.
Luxury Retail Researchers,Consumers researching luxury product reviews and gift ideas.
Brides & Wedding Planners,People researching wedding ideas and vendors.
Vacation Planners,Consumers reading reviews of vacation destinations and accommodations.
Motorcycle Enthusiasts,Readers of motorcycle news and reviews.
Business News Readers,Readers of online business news content.
Thrift Store Shoppers,Consumers shopping online for clothing at thrift stores and researching locations.
Advertising Professionals,People who read advertising industry news.
NFL Fans,People reading articles and websites about football and the NFL.
NBA Fans,People reading articles and websites about basketball and the NBA.
NCAA Fans,People reading articles and websites about college sports and the NCAA.
MLB Fans,People reading articles and websites about baseball and the MLB.
Nascar Fans,People reading articles and websites about nascar.
Eco-Conscious Consumers,People researching climate change and sustainable living.
Moviegoers,Consumers researching box office listings and buying movie tickets.
DIYers,Consumers researching DIY projects.
Grill Masters,Grill owners researching new recipes.
Techies,Readers of tech news and gadget reviews.
Home Design Enthusiasts,Consumers researching home design styles and trends.
Doctors,People reading medical journals and using online prescribing services.
Streaming Video Fans,Consumers streaming feature length movies and TV shows.
Auto Insurance Shoppers,Consumers shopping for auto insurance.
Teachers,People reading education industry publications and teaching advice websites.
College Students,People visiting university websites.
Department Store Shoppers,Consumes shopping at multi-category department stores.
Home Decor Shoppers,"Consumers shopping for home design, art and accessories."
Kids Clothing Shoppers,Consumers shopping for childrens apparel.
Teen Girl Clothing Shoppers,Consumers in-market for clothing for teenage girls.
Mens Clothing Shoppers,Consumers in-market for mens clothing.
Baby Products Buyers,Consumers shopping for baby-related products.
Jewelry & Watch Shoppers,Consumers researching high-end watch and jewelry brands.
Sporting Goods Shoppers,Consumers shopping for sporting goods and activewear apparel.
Furniture Shoppers,Consumers shopping for major home furnishings.
Bed & Bath Shoppers,Consumers shopping for bed and bath products.
Intimates Shoppers,Consumers shopping for lingerie.
Fast Fashion Shoppers,Consumers shopping for apparel that mimics current runway trends.
Apartment Hunters,People reading real estate rental listings.
Home Buyers,People reading real estate sales listings.
Moving Services Shoppers,Consumers who are shopping for moving services.
Job Seekers,People researching job boards.
Charitable Donors,People researching major charitable organizations.
NHL Fans,People reading articles and websites about hockey and the NHL.
Discount Big Box Shoppers,Consumers shopping at big box retailers.
Black Friday Deal Shoppers,Consumers researching holiday sales events.
Hip Hop Fans,People reading about hip hop music and hip hop stars.
Online Investors,Consumers with an active online trading account.
Seasonal Allergy Sufferers,People researching allergy trends and treatment options.
Discount Device Shoppers,Consumers shopping for discounted electronics.
Mobile Phone Comparison Shoppers,Consumers researching alternative mobile phones and wireless plans.
Budget Wireless Shoppers,Consumers researching discount wireless service plans.
Menopause Researchers,People researching menopause symptoms.
Online Health Researchers,People researching general health questions.
Beauty & Skincare Buyers,Consumers shopping for beauty and skincare products.
Streaming Device Shoppers,Consumers shopping for connected TV products.
New & Expecting Parents,People researching pregnancy issues and baby names.
High-End Kids Furniture and Clothes Shoppers,People shopping at high end childrens clothing and toy retailers.
Hands-On Parents,"People reading about family cooking, parenting advice and childrens activities."
Fantasy & Comic Fans,Consumers of online comics and fantasy novels.
Lawyers,People reading legal journals and industry publications.
Healthy Eaters,People researching healthy eating options.
Drug Store Shoppers,Consumers shopping online or searching for a local drug store.
Lawn & Garden Enthusiasts,Consumers reseraching lawn and garden maintenance techniques.
Nurses,People reading websites about nursing lifestyle and career advice.
Mailing & Shipping Shoppers,Consumers shopping for shipping supplies and postage.
Office Supply Shoppers,Individuals in-market for office supplies.
Ink & Toner Shoppers,Consumers shopping for printer ink.
Luxury Retail Shoppers,Consumers shopping for high end 

2025-01-24 07:45:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 07:45:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 07:45:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 07:45:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 07:45:52 - snowflake.connector.connection - INFO - closed
2025-01-24 07:45:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 07:45:52 - root - INFO - SQL:
SELECT m."interest_name", m."created_at"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
ORDER BY m."created_at"
LIMIT 100
Results:
interest_name,created_at
Business News Readers,2016-05-26 14:57:59
Gamers,2016-05-26 14:57:59
Vacation Planners,2016-05-26 14:57:59
NFL Fans,2016-05-26 14:57:59
Thrift Store Shoppers,2016-05-26 14:57:59
NBA Fans,2016-05-26 14:57:59
NCAA Fans,2016-05-26 14:57:59
Eco-Conscious Consumers,2016-05-26 14:57:59
MLB Fans,2016-05-26 14:57:59
Moviegoers,2016-05-26 14:57:59
Techies,2016-05-26 14:57:59
DIYers,2016-05-26 14:57:59
Home Design Enthusiasts,2016-05-26 14:57:59
Doctors,2016-05-26 14:57:59
Streaming Video Fans,2016-05-26 14:57:59
Auto Insurance Shoppers,2016-05-26 14:57:59
Teachers,2016-05-26 14:57:59
College Students,2016-05-26 14:57:59
Department Store Shoppers,2016-05-26 14:57:59
Home Decor Shoppers,2016-05-26 14:57:59
Kids Clothing Shoppers,2016-05-26 14:57:59
Baby Products Buyers,2016-05-26 14:57:59
Teen Girl Clothing Shoppers,2016-05-26 14:57:59
Jewelry & Watch Shoppers,2016-05-26 14:57:59
Sporting Goods Shoppers,2016-05-26 14:57:59
Intimates Shoppers,2016-05-26 14:57:59
Furniture Shoppers,2016-05-26 14:57:59
Fast Fashion Shoppers,2016-05-26 14:57:59
Apartment Hunters,2016-05-26 14:57:59
Home Buyers,2016-05-26 14:57:59
Moving Services Shoppers,2016-05-26 14:57:59
Job Seekers,2016-05-26 14:57:59
Charitable Donors,2016-05-26 14:57:59
NHL Fans,2016-05-26 14:57:59
Discount Big Box Shoppers,2016-05-26 14:57:59
Black Friday Deal Shoppers,2016-05-26 14:57:59
Hip Hop Fans,2016-05-26 14:57:59
Online Investors,2016-05-26 14:57:59
Seasonal Allergy Sufferers,2016-05-26 14:57:59
Discount Device Shoppers,2016-05-26 14:57:59
Mobile Phone Comparison Shoppers,2016-05-26 14:57:59
Budget Wireless Shoppers,2016-05-26 14:57:59
Menopause Researchers,2016-05-26 14:57:59
Online Health Researchers,2016-05-26 14:57:59
Beauty & Skincare Buyers,2016-05-26 14:57:59
Streaming Device Shoppers,2016-05-26 14:57:59
New & Expecting Parents,2016-05-26 14:57:59
High-End Kids Furniture and Clothes Shoppers,2016-05-26 14:57:59
Hands-On Parents,2016-05-26 14:57:59
Fantasy & Comic Fans,2016-05-26 14:57:59
Lawyers,2016-05-26 14:57:59
Lawn & Garden Enthusiasts,2016-05-26 14:57:59
Healthy Eaters,2016-05-26 14:57:59
Nurses,2016-05-26 14:57:59
Mailing & Shipping Shoppers,2016-05-26 14:57:59
Office Supply Shoppers,2016-05-26 14:57:59
Contractors & Construction Professionals,2016-05-26 14:57:59
Ink & Toner Shoppers,2016-05-26 14:57:59
Luxury Travel Researchers,2016-05-26 14:57:59
Democrats,2016-05-26 14:57:59
Republicans,2016-05-26 14:57:59
HDTV Researchers,2016-05-26 14:57:59
Hardware Shoppers,2016-05-26 14:57:59
Reggaeton Fans,2016-05-26 14:57:59
Online Movie Downloaders,2016-05-26 14:57:59
Sale Seekers,2016-05-26 14:57:59
Theme Park Researchers,2016-05-26 14:57:59
Ski and Snowboard Enthusiasts,2016-05-26 14:57:59
Travel Researchers,2016-05-26 14:57:59
Coupon Researchers,2016-05-26 14:57:59
Parents with Toddlers,2016-05-26 14:57:59
Parents with Kids,2016-05-26 14:57:59
Young Boomers,2016-05-26 14:57:59
Day Care Users,2016-05-26 14:57:59
Stay-at-Home Parents,2016-05-26 14:57:59
Exercise and Gym Researchers,2016-05-26 14:57:59
Home Kitchen Chefs,2016-05-26 14:57:59
Restaurant Researchers,2016-05-26 14:57:59
Order-in Eaters,2016-05-26 14:57:59
Nutrition Conscious Eaters,2016-05-26 14:57:59
Flower & Gift Basket Shoppers,2016-05-26 14:57:59
Plus Size Women,2016-05-26 14:57:59
Live Concert Fans,2016-05-26 14:57:59
Country Music Fans,2016-05-26 14:57:59
Comedy Fans,2016-05-26 14:57:59
Cruise Travel Intenders,2016-05-26 14:57:59
Pain Medication Users,2016-05-26 14:57:59
Joint Pain Sufferers,2016-05-26 14:57:59
Drug Store Shoppers,2016-05-26 14:57:59
Mens Clothing Shoppers,2016-05-26 14:57:59
Nascar Fans,2016-05-26 14:57:59
Motorcycle Enthusiasts,2016-05-26 14:57:59
Car Enthusiasts,2016-05-26 14:57:59
Fitness Enthusiasts,2016-05-26 14:57:59
Luxury Retail Shoppers,2016-05-26 14:57:59
Bed & Bath Shoppers,2016-05-26 14:57:59
Grill Masters,2016-05-26 14:57:59
Advertising Professionals,2016-05-26 14:57:59
Brides & Wedding Planners,2016-05-26 14:57:59
Luxury Retail Researchers,2016-05-26 14:57:59

2025-01-24 07:45:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 07:45:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 07:45:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 07:45:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 07:45:54 - snowflake.connector.connection - INFO - closed
2025-01-24 07:45:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 07:45:54 - root - INFO - SQL:
SELECT im."_year", im."_month", im."index_value", m."interest_name"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
INNER JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
  ON im."interest_id" = m."id"
WHERE (im."_year" = 2018 AND im."_month" >= 9) OR (im."_year" = 2019 AND im."_month" <= 8)
ORDER BY im."_year", im."_month"
LIMIT 100
Results:
_year,_month,index_value,interest_name
2018.0,9.0,2.49,Shoe Shoppers
2018.0,9.0,2.82,Competitive Tri-Athletes
2018.0,9.0,2.67,Preppy Clothing Shoppers
2018.0,9.0,2.34,Utility Workwear Shoppers
2018.0,9.0,2.46,Sporting Goods Shoppers
2018.0,9.0,2.31,Olympics Fans
2018.0,9.0,2.3,Apartment Furniture Shoppers
2018.0,9.0,2.28,Luxury Home Fixture Shoppers
2018.0,9.0,2.29,World Cup Enthusiasts
2018.0,9.0,2.28,World Cup Apparel Shoppers
2018.0,9.0,2.19,Vacation Rental Accommodation Researchers
2018.0,9.0,2.28,At-Home Gym Intenders
2018.0,9.0,2.19,Land Rover Shoppers
2018.0,9.0,2.17,Ski House Second Home Owners
2018.0,9.0,2.16,Big & Tall Men
2018.0,9.0,2.16,Sports Medicine Health Care Professionals
2018.0,9.0,2.15,Golf Enthusiasts
2018.0,9.0,2.14,March Madness Enthusiasts
2018.0,9.0,2.14,Trendy Denim Shoppers
2018.0,9.0,2.12,Kids Clothing Shoppers
2018.0,9.0,2.1,Luxury Boutique Hotel Researchers
2018.0,9.0,2.08,Kitchen Appliance Shoppers
2018.0,9.0,2.1,Parents of Teenagers Going to College
2018.0,9.0,2.07,Vacation Planners
2018.0,9.0,2.07,Urban Skateboarding Sneaker Shoppers
2018.0,9.0,2.03,Luxury Kitchen Goods Shoppers
2018.0,9.0,2.07,"Work Hard, Play Hard Travelers"
2018.0,9.0,2.03,Luggage Shoppers
2018.0,9.0,2.03,Luxury Bedding Shoppers
2018.0,9.0,2.01,MLB Fans
2018.0,9.0,1.99,North Carolina Football Fans
2018.0,9.0,1.99,Luxury Hotel Guests
2018.0,9.0,1.98,Womens Fashion Brands Shoppers
2018.0,9.0,1.98,Luxury Retail Shoppers
2018.0,9.0,1.97,Beach Supplies Shoppers
2018.0,9.0,1.97,Luxury Womens Brands Shoppers
2018.0,9.0,1.95,Luxury Travel Researchers
2018.0,9.0,1.95,Furniture Shoppers
2018.0,9.0,1.94,High-End Kids Furniture and Clothes Shoppers
2018.0,9.0,1.93,NHL Fans
2018.0,9.0,1.93,Special Olympics Fans
2018.0,9.0,1.93,Reusable Drinkware Shoppers
2018.0,9.0,1.91,NCAA Football Fans
2018.0,9.0,1.91,Online Grocery Shoppers
2018.0,9.0,1.88,Toronto Blue Jays Fans
2018.0,9.0,1.87,Major Airline Customers
2018.0,9.0,1.87,Online Home Decor Shoppers
2018.0,9.0,1.86,Ski and Snowboard Enthusiasts
2018.0,9.0,1.86,Japanese Luxury Car Enthusiasts
2018.0,9.0,1.86,Indoor Cycling & Spinning Enthusiasts
2018.0,9.0,1.86,Luxury Department Store Shoppers
2018.0,9.0,1.83,Flight and Hotel Shoppers
2018.0,9.0,1.84,Broadway Fans
2018.0,9.0,1.83,Yogis
2018.0,9.0,1.83,New York Trip Planners
2018.0,9.0,1.83,Boston Red Sox Fans
2018.0,9.0,1.82,College Aspirants
2018.0,9.0,1.83,Fishing Equipment Shoppers
2018.0,9.0,1.81,Affordable Hotel Bookers
2018.0,9.0,1.81,Sun Protection Shoppers
2018.0,9.0,1.8,Discount Device Shoppers
2018.0,9.0,1.79,Ecommerce Platform Researchers
2018.0,9.0,1.79,Mens Clothing Shoppers
2018.0,9.0,1.78,Hanukkah Decorations Shoppers
2018.0,9.0,1.77,Orthopedic Health Researchers
2018.0,9.0,1.77,Identity Theft Protection Researchers
2018.0,9.0,1.77,Restaurant Researchers
2018.0,9.0,1.75,Neurologists
2018.0,9.0,1.75,Kitchen and Bath Professionals
2018.0,9.0,1.75,Mens Health Researchers
2018.0,9.0,1.74,European Trip Planners
2018.0,9.0,1.74,France Trip Planners
2018.0,9.0,1.73,Getting Off the Grid Travelers
2018.0,9.0,1.73,Boston Trip Planners
2018.0,9.0,1.73,Tailgaters
2018.0,9.0,1.72,Tennis Players
2018.0,9.0,1.71,Surfers
2018.0,9.0,1.71,Portugal Trip Planners
2018.0,9.0,1.71,Boston Bruins Fans
2018.0,9.0,1.71,Yale University Fans
2018.0,9.0,1.7,Executive Travelers
2018.0,9.0,1.69,Democratic Donors
2018.0,9.0,1.68,Hardware Shoppers
2018.0,9.0,1.67,Pandora Jewelry Shoppers
2018.0,9.0,1.67,Avid Readers
2018.0,9.0,1.67,Healthcare Thought Leaders
2018.0,9.0,1.67,Online Alcohol Shoppers
2018.0,9.0,1.67,Kitchen and Home Goods Shoppers
2018.0,9.0,1.84,Price Conscious Home Shoppers
2018.0,9.0,2.09,Home Decor Shoppers
2018.0,9.0,2.28,NCAA Fans
2018.0,9.0,2.58,Luxury Retail Researchers
2018.0,9.0,2.76,Lacrosse Enthusiasts
2018.0,9.0,2.84,Running Enthusiasts
2018.0,9.0,1.82,Family Adventures Travelers
2018.0,9.0,2.04,Gym Equipment Owners
2018.0,9.0,2.2,Work Comes First Travelers
2018.0,9.0,2.36,Cycling Enthusiasts
2018.0,9.0,2.73,Competitive Sports Participants
2018.0,9.0,2.74,Mens Shoe Shoppers

2025-01-24 07:45:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 07:45:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 07:45:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 07:45:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 62
2025-01-24 07:45:56 - snowflake.connector.connection - INFO - closed
2025-01-24 07:45:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 07:45:56 - root - INFO - SQL:
SELECT im."_year", im."_month", im."interest_id", im."ranking", m."interest_name"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
INNER JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
  ON im."interest_id" = m."id"
WHERE im."ranking" <= 5
  AND ((im."_year" = 2018 AND im."_month" >= 9) OR (im."_year" = 2019 AND im."_month" <= 8))
ORDER BY im."interest_id", im."_year", im."_month"
LIMIT 100
Results:
_year,_month,interest_id,ranking,interest_name
2018.0,12.0,4.0,5,Luxury Retail Researchers
2019.0,1.0,4.0,4,Luxury Retail Researchers
2019.0,2.0,4.0,3,Luxury Retail Researchers
2018.0,9.0,115.0,4,Mens Shoe Shoppers
2018.0,10.0,115.0,4,Mens Shoe Shoppers
2018.0,12.0,115.0,5,Mens Shoe Shoppers
2019.0,1.0,115.0,2,Mens Shoe Shoppers
2019.0,2.0,115.0,2,Mens Shoe Shoppers
2019.0,3.0,115.0,2,Mens Shoe Shoppers
2019.0,4.0,115.0,2,Mens Shoe Shoppers
2019.0,5.0,115.0,2,Mens Shoe Shoppers
2019.0,6.0,115.0,4,Mens Shoe Shoppers
2019.0,7.0,115.0,2,Mens Shoe Shoppers
2019.0,8.0,115.0,2,Mens Shoe Shoppers
2019.0,5.0,151.0,5,Big & Tall Men
2018.0,10.0,171.0,5,Shoe Shoppers
2018.0,11.0,171.0,4,Shoe Shoppers
2019.0,2.0,171.0,4,Shoe Shoppers
2019.0,5.0,171.0,5,Shoe Shoppers
2019.0,2.0,5970.0,5,Luxury Home Fixture Shoppers
2019.0,4.0,5970.0,3,Luxury Home Fixture Shoppers
2018.0,9.0,6013.0,5,Competitive Sports Participants
2018.0,10.0,6013.0,3,Competitive Sports Participants
2018.0,11.0,6013.0,3,Competitive Sports Participants
2019.0,3.0,6206.0,5,Preppy Clothing Shoppers
2019.0,6.0,6206.0,5,Preppy Clothing Shoppers
2019.0,7.0,6206.0,5,Preppy Clothing Shoppers
2019.0,8.0,6206.0,5,Preppy Clothing Shoppers
2018.0,9.0,6218.0,1,Running Enthusiasts
2018.0,10.0,6218.0,1,Running Enthusiasts
2018.0,11.0,6218.0,2,Running Enthusiasts
2018.0,12.0,6218.0,4,Running Enthusiasts
2018.0,11.0,6219.0,5,Cycling Enthusiasts
2018.0,9.0,6285.0,2,Competitive Tri-Athletes
2018.0,10.0,6285.0,2,Competitive Tri-Athletes
2018.0,11.0,6285.0,1,Competitive Tri-Athletes
2018.0,12.0,6285.0,3,Competitive Tri-Athletes
2019.0,1.0,6285.0,5,Competitive Tri-Athletes
2018.0,9.0,22502.0,3,Lacrosse Enthusiasts
2019.0,3.0,22502.0,3,Lacrosse Enthusiasts
2019.0,4.0,22502.0,4,Lacrosse Enthusiasts
2019.0,5.0,22502.0,3,Lacrosse Enthusiasts
2019.0,6.0,22502.0,2,Lacrosse Enthusiasts
2019.0,7.0,22502.0,3,Lacrosse Enthusiasts
2019.0,8.0,22502.0,3,Lacrosse Enthusiasts
2018.0,12.0,41548.0,1,Winter Apparel Shoppers
2019.0,1.0,41548.0,1,Winter Apparel Shoppers
2019.0,2.0,41548.0,1,Winter Apparel Shoppers
2019.0,3.0,41548.0,1,Winter Apparel Shoppers
2019.0,4.0,41548.0,1,Winter Apparel Shoppers
2019.0,5.0,41548.0,1,Winter Apparel Shoppers
2019.0,6.0,41548.0,1,Winter Apparel Shoppers
2019.0,7.0,41548.0,1,Winter Apparel Shoppers
2019.0,8.0,41548.0,1,Winter Apparel Shoppers
2018.0,12.0,42203.0,2,Fitness Activity Tracker Users
2019.0,1.0,42203.0,3,Fitness Activity Tracker Users
2019.0,3.0,42203.0,4,Fitness Activity Tracker Users
2019.0,4.0,42203.0,5,Fitness Activity Tracker Users
2019.0,5.0,42203.0,3,Fitness Activity Tracker Users
2019.0,6.0,42203.0,3,Fitness Activity Tracker Users
2019.0,7.0,42203.0,4,Fitness Activity Tracker Users
2019.0,8.0,42203.0,4,Fitness Activity Tracker Users

2025-01-24 07:45:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 07:45:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 07:45:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 07:45:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 07:45:57 - snowflake.connector.connection - INFO - closed
2025-01-24 07:45:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 07:45:58 - root - INFO - SQL:
SELECT im."interest_id", MAX(im."composition") AS "max_composition", m."interest_name"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
INNER JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
  ON im."interest_id" = m."id"
GROUP BY im."interest_id", m."interest_name"
ORDER BY "max_composition" DESC
LIMIT 100
Results:
interest_id,max_composition,interest_name
21057.0,21.2,Work Comes First Travelers
6284.0,18.82,Gym Equipment Owners
39.0,17.44,Furniture Shoppers
77.0,17.19,Luxury Retail Shoppers
12133.0,15.15,Luxury Boutique Hotel Researchers
5969.0,15.05,Luxury Bedding Shoppers
171.0,14.91,Shoe Shoppers
4898.0,14.23,Cosmetics and Beauty Shoppers
6286.0,14.1,Luxury Hotel Guests
4.0,13.97,Luxury Retail Researchers
17786.0,13.67,Womens Fashion Brands Shoppers
6184.0,13.35,Reusable Drinkware Shoppers
19298.0,13.03,Beach Supplies Shoppers
4897.0,12.93,Parents of Teenagers Going to College
5968.0,12.87,Luxury Kitchen Goods Shoppers
19613.0,12.62,Land Rover Shoppers
6.0,12.56,Vacation Planners
64.0,12.41,High-End Kids Furniture and Clothes Shoppers
22403.0,12.27,Pandora Jewelry Shoppers
19423.0,12.22,Kitchen Appliance Shoppers
10977.0,12.16,Christmas Celebration Researchers
158.0,11.97,Flight and Hotel Shoppers
32486.0,11.89,Vacation Rental Accommodation Researchers
6277.0,11.72,Harry Potter Fans
115.0,11.68,Mens Shoe Shoppers
5938.0,11.63,Costa Rica Trip Planners
6334.0,11.63,Supermarket Shoppers
19621.0,11.61,Portugal Trip Planners
6110.0,11.57,Apartment Furniture Shoppers
161.0,11.48,Travel Reward Points Enthusiasts
10250.0,11.4,Halloween Costume Shoppers
17730.0,11.38,Luxury Department Store Shoppers
34.0,11.23,Teen Girl Clothing Shoppers
79.0,11.21,Luxury Travel Researchers
5991.0,11.04,Gluten-Free Recipe Researchers
19757.0,10.95,Natural Pet Food Shoppers
133.0,10.91,High End Camera Shoppers - Dupe
40.0,10.86,Bed & Bath Shoppers
18923.0,10.85,Online Home Decor Shoppers
69.0,10.82,Healthy Eaters
5.0,10.82,Brides & Wedding Planners
6217.0,10.8,Weight Loss Researchers
100.0,10.77,Nutrition Conscious Eaters
6206.0,10.76,Preppy Clothing Shoppers
6111.0,10.71,Wine Lovers
4943.0,10.7,Online Grocery Shoppers
10981.0,10.62,New Years Eve Party Ticket Purchasers
5960.0,10.61,New Zealand Trip Planners
6343.0,10.54,Patio Furniture Shoppers
41548.0,10.46,Winter Apparel Shoppers
17314.0,10.43,Lobbyists
21237.0,10.36,Chelsea Fans
6344.0,10.32,Hair Care Shoppers
6324.0,10.3,Las Vegas Trip Planners
4870.0,10.29,Tech-Savvy Moms
5944.0,10.24,Financial Advisors
6228.0,10.22,Paleo Eaters
89.0,10.14,Travel Researchers
19422.0,10.11,Home Design and Living Publication Readers
6029.0,10.05,Indoor Cycling & Spinning Enthusiasts
82.0,9.99,HDTV Researchers
7541.0,9.98,Alabama Trip Planners
6285.0,9.97,Competitive Tri-Athletes
6232.0,9.97,Golf Enthusiasts
6106.0,9.93,Luxury Second Home Owners
18783.0,9.83,Nursing and Physicians Assistant Journal Researchers
92.0,9.77,Parents with Kids
6214.0,9.71,Home Remodelers
6208.0,9.67,Recently Retired Individuals
16137.0,9.65,Olympics Fans
6378.0,9.64,Luggage Shoppers
6123.0,9.49,Misc-Deal Seekers or Coupon Shoppers
38.0,9.48,Sporting Goods Shoppers
4895.0,9.47,Mature Parents
10008.0,9.46,Japanese Luxury Car Enthusiasts
4944.0,9.46,Pre-Measured Grocery Shoppers
141.0,9.46,Skin Care Researchers
63.0,9.37,New & Expecting Parents
6013.0,9.35,Competitive Sports Participants
6308.0,9.33,Food Safety Decision Makers
6218.0,9.29,Running Enthusiasts
36.0,9.27,Baby Products Buyers
6112.0,9.22,Olympic Sports Enthusiasts
5970.0,9.21,Luxury Home Fixture Shoppers
18619.0,9.15,Asian Food Enthusiasts
15935.0,9.13,Pregnancy Resources Researchers
13497.0,9.03,Restaurant Supply Shoppers
21061.0,8.97,"Work Hard, Play Hard Travelers"
10009.0,8.95,Investment Services Intenders
6107.0,8.84,Ski House Second Home Owners
16138.0,8.81,Special Olympics Fans
5911.0,8.69,Credit Score Researchers
60.0,8.66,Online Health Researchers
15879.0,8.65,Freelancers
17269.0,8.64,At-Home Gym Intenders
21060.0,8.58,Family Adventures Travelers
30.0,8.56,Department Store Shoppers
7425.0,8.54,Life Insurance Researchers
21058.0,8.5,Countdown to the Beach Travelers
6336.0,8.5,Mid-Range Grocery Shoppers

2025-01-24 07:45:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 07:45:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 07:45:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 07:45:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 07:45:59 - snowflake.connector.connection - INFO - closed
2025-01-24 07:45:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 07:45:59 - root - INFO - SQL:
SELECT im."percentile_ranking", COUNT(*) AS "count"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
GROUP BY im."percentile_ranking"
ORDER BY im."percentile_ranking" DESC
LIMIT 100
Results:
percentile_ranking,count
99.92,1
99.91,4
99.9,2
99.89,1
99.88,4
99.87,2
99.86,1
99.83,2
99.82,3
99.8,1
99.79,1
99.78,1
99.77,3
99.76,1
99.75,1
99.74,4
99.73,3
99.7,1
99.69,1
99.68,1
99.66,1
99.65,6
99.64,3
99.62,1
99.61,1
99.6,1
99.59,2
99.58,1
99.57,1
99.56,2
99.55,2
99.54,1
99.53,1
99.51,1
99.5,3
99.49,2
99.48,2
99.47,1
99.46,2
99.45,4
99.42,4
99.41,1
99.39,2
99.38,3
99.36,1
99.35,2
99.33,1
99.31,2
99.3,4
99.29,1
99.28,1
99.27,1
99.25,2
99.23,1
99.22,2
99.21,1
99.2,3
99.19,1
99.18,6
99.16,1
99.15,1
99.14,1
99.13,2
99.12,1
99.11,1
99.1,1
99.09,2
99.08,2
99.07,2
99.04,1
99.03,3
99.02,1
99.0,1
98.99,3
98.97,2
98.96,4
98.95,3
98.94,1
98.93,3
98.92,1
98.91,4
98.9,2
98.87,1
98.86,1
98.85,1
98.84,1
98.83,2
98.82,1
98.81,1
98.79,2
98.78,2
98.77,5
98.74,2
98.73,3
98.72,3
98.71,2
98.7,1
98.69,1
98.67,1
98.66,1

2025-01-24 07:45:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 07:45:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 07:45:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 07:46:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 07:46:00 - snowflake.connector.connection - INFO - closed
2025-01-24 07:46:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 07:46:01 - root - INFO - SQL:
SELECT im."_year", im."_month", im."index_value", m."interest_name"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
INNER JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
  ON im."interest_id" = m."id"
WHERE im."_year" = 2019 AND im."_month" = 5
ORDER BY im."index_value" DESC
LIMIT 100
Results:
_year,_month,index_value,interest_name
2019.0,5.0,3.96,Winter Apparel Shoppers
2019.0,5.0,3.13,Mens Shoe Shoppers
2019.0,5.0,3.08,Lacrosse Enthusiasts
2019.0,5.0,3.08,Fitness Activity Tracker Users
2019.0,5.0,3.0,Big & Tall Men
2019.0,5.0,3.0,Shoe Shoppers
2019.0,5.0,2.92,Elite Cycling Gear Shoppers
2019.0,5.0,2.92,Home Lending Researchers
2019.0,5.0,2.91,Vermont Trip Planners
2019.0,5.0,2.91,Competitive Tri-Athletes
2019.0,5.0,2.87,World Cup Enthusiasts
2019.0,5.0,2.86,Luxury Home Fixture Shoppers
2019.0,5.0,2.84,Softball Enthusiasts
2019.0,5.0,2.8,Swimming Enthusiasts
2019.0,5.0,2.8,Preppy Clothing Shoppers
2019.0,5.0,2.75,Beach Supplies Shoppers
2019.0,5.0,2.74,Sports Memorabilia Shoppers
2019.0,5.0,2.72,Aspen Skiers and Snowboarders
2019.0,5.0,2.71,Fishing Equipment Shoppers
2019.0,5.0,2.71,At-Home Gym Intenders
2019.0,5.0,2.69,Home Decor Shoppers
2019.0,5.0,2.68,High School Sports Researchers
2019.0,5.0,2.67,Utility Workwear Shoppers
2019.0,5.0,2.66,Golf Enthusiasts
2019.0,5.0,2.65,Luxury Boutique Hotel Researchers
2019.0,5.0,2.65,Sporting Goods Shoppers
2019.0,5.0,2.63,Ski and Snowboard Apparel Shoppers
2019.0,5.0,2.63,Home Rug Shoppers
2019.0,5.0,2.63,Home Goods Supercenter Shoppers
2019.0,5.0,2.62,Luxury Retail Researchers
2019.0,5.0,2.6,Rowing Enthusiasts
2019.0,5.0,2.6,Kids Clothing Shoppers
2019.0,5.0,2.57,Japanese Luxury Car Enthusiasts
2019.0,5.0,2.57,Volleyball Enthusiasts
2019.0,5.0,2.57,Vacation Planners
2019.0,5.0,2.55,Gym Equipment Owners
2019.0,5.0,2.55,Colorado Skiers and Snowboarders
2019.0,5.0,2.53,Luxury Kitchen Goods Shoppers
2019.0,5.0,2.53,Vacation Rental Accommodation Researchers
2019.0,5.0,2.52,Parents of Teenagers Going to College
2019.0,5.0,2.52,Luggage Shoppers
2019.0,5.0,2.5,Apartment Furniture Shoppers
2019.0,5.0,2.5,Ski House Second Home Owners
2019.0,5.0,2.5,Olympics Fans
2019.0,5.0,2.47,Luxury Hotel Guests
2019.0,5.0,2.47,Reusable Drinkware Shoppers
2019.0,5.0,2.45,Kitchen Appliance Shoppers
2019.0,5.0,2.44,Cycling Enthusiasts
2019.0,5.0,2.43,World Cup Apparel Shoppers
2019.0,5.0,2.43,Chandelier and Lamp Shoppers
2019.0,5.0,2.4,Flight and Hotel Shoppers
2019.0,5.0,2.4,High-End Kids Furniture and Clothes Shoppers
2019.0,5.0,2.39,Home Interior Design Enthusiasts
2019.0,5.0,2.38,Baseball Enthusiasts
2019.0,5.0,2.38,Embroidery Enthusiasts
2019.0,5.0,2.38,Canoeing and Kayaking Enthusiasts
2019.0,5.0,2.37,Sports Medicine Health Care Professionals
2019.0,5.0,2.37,Hanukkah Decorations Shoppers
2019.0,5.0,2.37,Trendy Denim Shoppers
2019.0,5.0,2.37,Competitive Sports Participants
2019.0,5.0,2.36,Kitchen Stove Shoppers
2019.0,5.0,2.36,Big East Fans
2019.0,5.0,2.36,Running Enthusiasts
2019.0,5.0,2.35,Affordable Hotel Bookers
2019.0,5.0,2.35,Land Rover Shoppers
2019.0,5.0,2.34,Home Printer Shoppers
2019.0,5.0,2.33,Patio Furniture Shoppers
2019.0,5.0,2.32,Urban Skateboarding Sneaker Shoppers
2019.0,5.0,2.32,Luxury Bedding Shoppers
2019.0,5.0,2.32,Cape Cod News Readers
2019.0,5.0,2.3,Western Canada Skiers and Snowboarders
2019.0,5.0,2.29,MLB Fans
2019.0,5.0,2.29,Promotional Products Purchasers
2019.0,5.0,2.29,Mens Business Clothes Shoppers
2019.0,5.0,2.28,Flooring Shoppers
2019.0,5.0,2.27,March Madness Enthusiasts
2019.0,5.0,2.26,Mens Underwear Shoppers
2019.0,5.0,2.26,Cleveland Indians Fans
2019.0,5.0,2.26,Online Alcohol Shoppers
2019.0,5.0,2.26,Cininnati Reds Fans
2019.0,5.0,2.25,Furniture Shoppers
2019.0,5.0,2.24,New York Trip Planners
2019.0,5.0,2.23,NCAA Fans
2019.0,5.0,2.22,Major Airline Customers
2019.0,5.0,2.22,North Carolina Football Fans
2019.0,5.0,2.21,Christmas Celebration Researchers
2019.0,5.0,2.21,Womens Fashion Brands Shoppers
2019.0,5.0,2.21,Department Store Shoppers
2019.0,5.0,2.2,NCAA Football Fans
2019.0,5.0,2.2,Price Conscious Home Shoppers
2019.0,5.0,2.2,Luxury Retail Shoppers
2019.0,5.0,2.2,Financial Advisors
2019.0,5.0,2.2,Luxury Womens Brands Shoppers
2019.0,5.0,2.2,Home Buyers
2019.0,5.0,2.19,Ballet Enthusiasts
2019.0,5.0,2.17,Identity Theft Protection Researchers
2019.0,5.0,2.16,Pandora Jewelry Shoppers
2019.0,5.0,2.16,NHL Fans
2019.0,5.0,2.15,Vitamin Shoppers
2019.0,5.0,2.15,Online Shoppers

2025-01-24 07:46:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 07:46:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 07:46:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 07:46:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 07:46:02 - snowflake.connector.connection - INFO - closed
2025-01-24 07:46:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 07:46:03 - root - INFO - SQL:
SELECT m."id", m."interest_name", m."last_modified"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
ORDER BY m."last_modified" DESC
LIMIT 100
Results:
Too long, hard cut:
id,interest_name,last_modified
6030,Spa and Pool Owners,2019-08-26 11:24:45
5913,Spa Goers,2019-08-26 11:24:44
6366,Rideshare App Users,2019-08-20 11:34:51
44457,New York City Fine Theatre Enthusiasts,2019-08-15 10:14:58
49502,Veterinarians,2019-07-09 13:57:13
51678,Plumbers,2019-05-07 18:50:04
51120,Foot Health Researchers,2019-04-29 14:20:04
51119,Skin Disorder Researchers,2019-04-29 14:20:04
50860,Food Delivery Service Users,2019-04-24 18:30:04
49975,Cattlemen and Pork Producers,2019-04-24 17:40:05
49976,Agriculture and Climate Advocates,2019-04-24 17:40:04
49974,Agricultural and Food Issues Researchers,2019-04-24 17:40:04
49978,Homeschooling Parents,2019-04-24 17:40:04
49972,Horseback Riding Enthusiasts,2019-04-24 17:40:04
49973,Farm Finance Researchers,2019-04-24 17:40:04
49977,DIY Upcycle Home Project Planners,2019-04-24 17:40:04
41085,Pittsburgh Pirates Fans,2019-04-22 13:23:52
49979,Cape Cod News Readers,2019-04-18 09:00:05
5999,Readers of African American Content,2019-04-17 08:49:16
44384,Action Figure and Collectibles Shoppers,2019-04-02 16:17:29
48465,HGTV Enthusiasts,2019-04-02 16:17:29
47789,Israel Trip Planners,2019-04-02 16:17:29
40427,Model Aircraft and Rocket Hobbyists,2019-03-29 14:26:28
48462,Self Storage Shoppers,2019-03-28 16:40:23
48459,Work Visa Researchers,2019-03-28 16:40:23
48463,PBS Enthusiasts,2019-03-28 16:40:22
48460,Online Payroll Services Users,2019-03-28 16:40:22
48154,Elite Cycling Gear Shoppers,2019-03-22 15:31:46
47850,Asheville Trip Planners,2019-03-21 15:33:09
48022,Sushi Lovers,2019-03-21 15:33:09
47713,High School Sports Researchers,2019-03-15 15:47:10
45678,Mens Underwear Shoppers,2019-03-12 13:05:06
44385,Sudoku Players,2019-03-12 12:57:18
44388,Board Game Enthusiasts,2019-03-12 12:57:18
47130,Home Lending Researchers,2019-03-11 12:36:24
45675,Home Medical Supplies Shoppers,2019-03-11 12:36:24
45673,Fundraising Advocates,2019-03-11 12:36:24
47115,Electric Vehicle Shoppers,2019-03-11 12:36:24
44580,Home Cleaning Researchers,2019-03-11 12:36:24
47065,Diabetes Support Forum Readers,2019-03-07 11:46:12
46567,Bigfoot Folklore Enthusiasts,2019-02-26 15:01:48
46566,Fertility Treatment Researchers,2019-02-26 15:01:48
46132,Counseling Researchers,2019-02-25 14:00:17
46134,Pontoon Boat Researchers,2019-02-25 14:00:17
19578,Sports Gamblers,2019-02-13 17:05:19
45725,Trampoline Shoppers,2019-02-12 10:52:31
45685,Cosmetic Surgery Intenders,2019-02-12 10:52:20
45676,Scrubs Uniforms Shoppers,2019-02-07 15:17:14
45677,Sleepwear Shoppers,2019-02-07 15:17:14
45679,Government Student Loan Researchers,2019-02-07 15:17:14
45674,Medical Technology News Readers,2019-02-07 15:17:13
45671,Mens Suit Shoppers,2019-02-07 15:17:13
45672,Bible Study Researchers,2019-02-07 15:17:13
45668,Pizza Lovers,2019-02-07 15:17:12
45670,Womens Swimsuit Shoppers,2019-02-07 15:17:12
45669,Cocktail Recipe Researchers,2019-02-07 15:17:12
45667,Blades and Hunting Knife Shoppers,2019-02-07 15:17:11
45666,Bird and Parrot Lovers,2019-02-07 15:17:11
45665,Reptile Enthusiasts,2019-02-07 15:17:11
45662,Psychiatrists,2019-02-07 15:17:10
45664,Headphone Shoppers,2019-02-07 15:17:10
45527,CBD Oils Shoppers,2019-02-06 16:21:50
45528,Cannabis News Readers,2019-02-06 16:21:50
45526,Dairy Industry New Readers,2019-02-06 16:21:49
45525,Cattle Industry New Readers,2019-02-06 16:21:49
45524,Mowing Equipment Shoppers,2019-02-06 16:21:49
45523,Welding Tools and Supplies Shoppers,2019-02-06 16:21:48
45522,Hair Color Shoppers,2019-02-06 16:21:48
45521,Rock Climbing Enthusiasts,2019-02-06 16:21:48
45518,Volleyball Enthusiasts,2019-02-06 16:21:47
45519,Competitive Wrestling Enthusiasts,2019-02-06 16:21:47
45520,Cricket Enthusiasts,2019-02-06 16:21:47
45515,US Judiciary System Researchers,2019-02-06 16:21:46
45516,Basketball Enthusiasts,2019-02-06 16:21:46
45517,Football Enthusiasts,2019-02-06 16:21:46
44390,Background Check Users,2019-02-06 16:21:45
44585,Ballet Enthusiasts,2019-02-06 16:21:45
44589,Brooklyn Nets Fans,2019-02-01 14:13:33
44588,Softball Enthusiasts,2019-02-01 14:13:14
44587,Baseball Enthusiasts,2019-02-01 14:13:05
44586,Opera Enthusiasts,2019-02-01 14:12:57
44584,Child Car Seat Researchers,2019-02-01 14:12:49
44583,Sustainable Lifestyle Enthusiasts,2019-02-01 14:12:40
44582,Spy Gadgets Shoppers,2019-02-01 14:12:30
44581,Darts Enthusiasts,2019-02-01 14:12:20
44579,Koi Pond Enthusiasts,2019-02-01 14:06:48
44391,Spanish Language Learners,2019-01-31 14:07:58
44389,Mahjong Players,2019-01-31 14:07:51
44387,Puzzle Enthusiasts,2019-01-31 14:07:45
44386,Crossword Puzzles Players,2019-01-31 14:07:37
44383,Guitar Music Researchers,2019-01-31 14:07:29
44382,Lyrics Researchers,2019-01-31 14:07:22
44381,Symphony Music Enthusiasts,2019-01-31 14:07:14
44380,Home Heating and Cooling Researchers,2019-01-31 14:07:07
44379,French Language Learners,2019-01-31 14:07:00
44378,Internet Speed Testers,2019-01-31 14:06:53
42368,Online Thesaurus Users,2019-01-31 13:50:37
42238,Online Calculator Users,2019-01-31 13:49:10
42239,ESPN Enthusiasts,20

2025-01-24 07:46:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 07:46:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 07:46:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 07:46:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 12
2025-01-24 07:46:04 - snowflake.connector.connection - INFO - closed
2025-01-24 07:46:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 07:46:04 - root - INFO - SQL:
SELECT im."_year", im."_month", COUNT(DISTINCT im."interest_id") AS "interest_count"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
WHERE (im."_year" = 2018 AND im."_month" >= 9) OR (im."_year" = 2019 AND im."_month" <= 8)
GROUP BY im."_year", im."_month"
ORDER BY im."_year", im."_month"
LIMIT 100
Results:
_year,_month,interest_count
2018.0,9.0,780
2018.0,10.0,857
2018.0,11.0,928
2018.0,12.0,995
2019.0,1.0,973
2019.0,2.0,1121
2019.0,3.0,1136
2019.0,4.0,1099
2019.0,5.0,857
2019.0,6.0,824
2019.0,7.0,864
2019.0,8.0,1149

2025-01-24 07:46:04 - root - INFO - itercount: 0
2025-01-24 07:46:04 - root - INFO - Database Name: BANK_SALES_TRADING
Schema Name: BANK_SALES_TRADING
DDL describes table information.
,0
table_name,INTEREST_MAP
description,
DDL,"create or replace TABLE INTEREST_MAP (
	""id"" NUMBER(38,0),
	""interest_name"" VARCHAR(16777216),
	""interest_summary"" VARCHAR(16777216),
	""created_at"" VARCHAR(16777216),
	""last_modified"" VARCHAR(16777216)
);"

,1
table_name,INTEREST_METRICS
description,
DDL,"create or replace TABLE INTEREST_METRICS (
	""_month"" FLOAT,
	""_year"" FLOAT,
	""month_year"" VARCHAR(16777216),
	""interest_id"" FLOAT,
	""composition"" FLOAT,
	""index_value"" FLOAT,
	""ranking"" NUMBER(38,0),
	""percentile_ranking"" FLOAT
);"

,2
table_name,BITCOIN_PRICES
description,
DDL,"create or replace TABLE BITCOIN_PRICES (
	""ticker"" VARCHAR(16777216),
	""market_date"" VARCHAR(16777216),
	""price"" FLOAT,
	""open"" FLOAT,
	""high"" FLOAT,
	""low"" FLOAT,
	""volume"" VARCHAR(16777216),
	""change"" VARCHAR(16777216)
);"

,3
table_name,SHOPPING_CART_CAMPAIGN_IDENTIFIER
description,
DDL,"create or replace TABLE SHOPPING_CART_CAMPAIGN_IDENTIFIER (
	""campaign_id"" NUMBER(38,0),
	""products"" VARCHAR(16777216),
	""campaign_name"" VARCHAR(16777216),
	""start_date"" VARCHAR(16777216),
	""end_date"" VARCHAR(16777216)
);"

,4
table_name,SHOPPING_CART_EVENT_IDENTIFIER
description,
DDL,"create or replace TABLE SHOPPING_CART_EVENT_IDENTIFIER (
	""event_type"" NUMBER(38,0),
	""event_name"" VARCHAR(16777216)
);"

,5
table_name,VEG_CAT
description,
DDL,"create or replace TABLE VEG_CAT (
	""index"" NUMBER(38,0),
	""item_code"" NUMBER(38,0),
	""item_name"" VARCHAR(16777216),
	""category_code"" NUMBER(38,0),
	""category_name"" VARCHAR(16777216)
);"

,6
table_name,VEG_WHSLE_DF
description,
DDL,"create or replace TABLE VEG_WHSLE_DF (
	""index"" NUMBER(38,0),
	""whsle_date"" VARCHAR(16777216),
	""item_code"" NUMBER(38,0),
	""whsle_px_rmb-kg"" FLOAT
);"

,7
table_name,BITCOIN_TRANSACTIONS
description,
DDL,"create or replace TABLE BITCOIN_TRANSACTIONS (
	""txn_id"" NUMBER(38,0),
	""member_id"" VARCHAR(16777216),
	""ticker"" VARCHAR(16777216),
	""txn_date"" VARCHAR(16777216),
	""txn_type"" VARCHAR(16777216),
	""quantity"" FLOAT,
	""percentage_fee"" FLOAT,
	""txn_time"" VARCHAR(16777216)
);"

,8
table_name,SHOPPING_CART_EVENTS
description,
DDL,"create or replace TABLE SHOPPING_CART_EVENTS (
	""visit_id"" VARCHAR(16777216),
	""cookie_id"" VARCHAR(16777216),
	""page_id"" NUMBER(38,0),
	""event_type"" NUMBER(38,0),
	""sequence_number"" NUMBER(38,0),
	""event_time"" VARCHAR(16777216)
);"

,9
table_name,VEG_LOSS_RATE_DF
description,
DDL,"create or replace TABLE VEG_LOSS_RATE_DF (
	""index"" NUMBER(38,0),
	""item_code"" NUMBER(38,0),
	""item_name"" VARCHAR(16777216),
	""loss_rate_%"" FLOAT
);"

,10
table_name,CUSTOMER_NODES
description,
DDL,"create or replace TABLE CUSTOMER_NODES (
	""customer_id"" NUMBER(38,0),
	""region_id"" NUMBER(38,0),
	""node_id"" NUMBER(38,0),
	""start_date"" VARCHAR(16777216),
	""end_date"" VARCHAR(16777216)
);"

,11
table_name,WEEKLY_SALES
description,
DDL,"create or replace TABLE WEEKLY_SALES (
	""week_date"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216),
	""segment"" VARCHAR(16777216),
	""customer_type"" VARCHAR(16777216),
	""transactions"" NUMBER(38,0),
	""sales"" NUMBER(38,0)
);"

,12
table_name,BITCOIN_MEMBERS
description,
DDL,"create or replace TABLE BITCOIN_MEMBERS (
	""member_id"" VARCHAR(16777216),
	""first_name"" VARCHAR(16777216),
	""region"" VARCHAR(16777216)
);"

,13
table_name,CLEANED_WEEKLY_SALES
description,
DDL,"create or replace TABLE CLEANED_WEEKLY_SALES (
	""week_date_formatted"" VARCHAR(16777216),
	""week_date"" VARCHAR(16777216),
	""region"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216),
	""segment"" VARCHAR(16777216),
	""customer_type"" VARCHAR(16777216),
	""transactions"" NUMBER(38,0),
	""sales"" NUMBER(38,0),
	""week_number"" NUMBER(38,0),
	""month_number"" NUMBER(38,0),
	""calendar_year"" NUMBER(38,0),
	""age_band"" VARCHAR(16777216),
	""demographic"" VARCHAR(16777216),
	""avg_transaction"" FLOAT
);"

,14
table_name,CUSTOMER_REGIONS
description,
DDL,"create or replace TABLE CUSTOMER_REGIONS (
	""region_id"" NUMBER(38,0),
	""region_name"" VARCHAR(16777216)
);"

,15
table_name,CUSTOMER_TRANSACTIONS
description,
DDL,"create or replace TABLE CUSTOMER_TRANSACTIONS (
	""customer_id"" NUMBER(38,0),
	""txn_date"" VARCHAR(16777216),
	""txn_type"" VARCHAR(16777216),
	""txn_amount"" NUMBER(38,0)
);"

,16
table_name,SHOPPING_CART_USERS
description,
DDL,"create or replace TABLE SHOPPING_CART_USERS (
	""user_id"" NUMBER(38,0),
	""cookie_id"" VARCHAR(16777216),
	""start_date"" VARCHAR(16777216)
);"

,17
table_name,VEG_TXN_DF
description,
DDL,"create or replace TABLE VEG_TXN_DF (
	""index"" NUMBER(38,0),
	""txn_date"" VARCHAR(16777216),
	""txn_time"" VARCHAR(16777216),
	""item_code"" NUMBER(38,0),
	""qty_sold(kg)"" FLOAT,
	""unit_selling_px_rmb/kg"" FLOAT,
	""sale/return"" VARCHAR(16777216),
	""discount(%)"" NUMBER(38,0),
	""day_of_week"" VARCHAR(16777216)
);"

,18
table_name,SHOPPING_CART_PAGE_HIERARCHY
description,
DDL,"create or replace TABLE SHOPPING_CART_PAGE_HIERARCHY (
	""page_id"" NUMBER(38,0),
	""page_name"" VARCHAR(16777216),
	""product_category"" VARCHAR(16777216),
	""product_id"" FLOAT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'BANK_SALES_TRADING': {'BANK_SALES_TRADING': ['BITCOIN_MEMBERS', 'BITCOIN_PRICES', 'BITCOIN_TRANSACTIONS', 'CLEANED_WEEKLY_SALES', 'CUSTOMER_NODES', 'CUSTOMER_REGIONS', 'CUSTOMER_TRANSACTIONS', 'INTEREST_MAP', 'INTEREST_METRICS', 'SHOPPING_CART_CAMPAIGN_IDENTIFIER', 'SHOPPING_CART_EVENTS', 'SHOPPING_CART_EVENT_IDENTIFIER', 'SHOPPING_CART_PAGE_HIERARCHY', 'SHOPPING_CART_USERS', 'VEG_CAT', 'VEG_LOSS_RATE_DF', 'VEG_TXN_DF', 'VEG_WHSLE_DF', 'WEEKLY_SALES']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table:** `BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_METRICS`
  - **"_month"**: Represents the month (as FLOAT). Potential usage: To filter data between September 2018 and August 2019 and group data by month.
  - **"_year"**: Represents the year (as FLOAT). Potential usage: To filter data between September 2018 and August 2019 and group data by year.
  - **"month_year"**: Represents the month and year as a string (VARCHAR). Potential usage: For displaying dates and grouping.
  - **"interest_id"**: Identifier for the interest (as FLOAT). Potential usage: To join with `INTEREST_MAP` to get interest names.
  - **"composition"**: The composition value (as FLOAT). Potential usage: To calculate average compositions and find maximum values per month.
  - **"index_value"**: Index value (as FLOAT). Potential usage: Additional metric for analysis.
  - **"ranking"**: Ranking of the interest for that month (as NUMBER). Potential usage: To identify top-ranking interests.
  - **"percentile_ranking"**: Percentile ranking (as FLOAT). Potential usage: To find interests in specific percentile ranges.

- **Table:** `BANK_SALES_TRADING.BANK_SALES_TRADING.INTEREST_MAP`
  - **"id"**: Identifier for the interest (as NUMBER). Potential usage: To join with `INTEREST_METRICS` on `interest_id`.
  - **"interest_name"**: Name of the interest (VARCHAR). Potential usage: To display the interest names in the output.
  - **"interest_summary"**: Summary of the interest (VARCHAR). Potential usage: Additional context if needed.

**Conditions that may be used:**

- Date Range Filter:
  - For data from **September 2018 to August 2019**:
    - `("_year" = 2018 AND "_month" >= 9)`
    - `("_year" = 2019 AND "_month" <= 8)`
- Joining Tables:
  - Join `INTEREST_METRICS` and `INTEREST_MAP` on `interest_id` and `id`.

---

**Sample SQL Queries:**

1. **Select all columns from INTEREST_METRICS within the date range:**

   ```sql
   SELECT *
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS"
   WHERE ("_year" = 2018 AND "_month" >= 9) OR ("_year" = 2019 AND "_month" <= 8)
   LIMIT 100;
   ```

2. **Get distinct interest IDs and names:**

   ```sql
   SELECT DISTINCT im."interest_id", im."ranking", m."interest_name"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
   JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
     ON im."interest_id" = m."id"
   LIMIT 100;
   ```

3. **Find the maximum composition value per month and year:**

   ```sql
   SELECT im."_year", im."_month", MAX(im."composition") AS "max_composition"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
   WHERE ("_year" = 2018 AND "_month" >= 9) OR ("_year" = 2019 AND "_month" <= 8)
   GROUP BY im."_year", im."_month"
   ORDER BY im."_year", im."_month"
   LIMIT 100;
   ```

4. **Retrieve interest names with their composition for each month:**

   ```sql
   SELECT im."_year", im."_month", im."composition", m."interest_name"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
   JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
     ON im."interest_id" = m."id"
   WHERE ("_year" = 2018 AND "_month" >= 9) OR ("_year" = 2019 AND "_month" <= 8)
   ORDER BY im."_year", im."_month", im."composition" DESC
   LIMIT 100;
   ```

5. **Calculate average composition per interest per month:**

   ```sql
   SELECT im."_year", im."_month", im."interest_id", AVG(im."composition") AS "avg_composition"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
   WHERE ("_year" = 2018 AND "_month" >= 9) OR ("_year" = 2019 AND "_month" <= 8)
   GROUP BY im."_year", im."_month", im."interest_id"
   ORDER BY im."_year", im."_month"
   LIMIT 100;
   ```

6. **Get top-ranking interests for each month:**

   ```sql
   SELECT im."_year", im."_month", im."ranking", m."interest_name"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
   JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
     ON im."interest_id" = m."id"
   WHERE im."ranking" = 1 AND (("_year" = 2018 AND "_month" >= 9) OR ("_year" = 2019 AND "_month" <= 8))
   ORDER BY im."_year", im."_month"
   LIMIT 100;
   ```

7. **List distinct months and years available:**

   ```sql
   SELECT DISTINCT im."_year", im."_month"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
   ORDER BY im."_year", im."_month"
   LIMIT 100;
   ```

8. **Retrieve percentile rankings for interests in June 2019:**

   ```sql
   SELECT im."interest_id", im."percentile_ranking", m."interest_name"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
   JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
     ON im."interest_id" = m."id"
   WHERE im."_year" = 2019 AND im."_month" = 6
   ORDER BY im."percentile_ranking" DESC
   LIMIT 100;
   ```

9. **Find the interest with the maximum average composition over the entire period:**

   ```sql
   SELECT im."interest_id", AVG(im."composition") AS "avg_composition", m."interest_name"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
   JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
     ON im."interest_id" = m."id"
   WHERE ("_year" = 2018 AND "_month" >= 9) OR ("_year" = 2019 AND "_month" <= 8)
   GROUP BY im."interest_id", m."interest_name"
   ORDER BY "avg_composition" DESC
   LIMIT 100;
   ```

10. **Calculate the rolling average composition value (conceptual exploration):**

    *(Since rolling averages require window functions and more complex SQL, this query begins exploration without directly calculating the rolling average.)*

    ```sql
    SELECT im."_year", im."_month", im."composition"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
    WHERE ("_year" = 2018 AND "_month" >= 6) OR ("_year" = 2019 AND "_month" <= 8)
    ORDER BY im."_year", im."_month"
    LIMIT 100;
    ```

11. **Check for any missing or NULL composition values:**

    ```sql
    SELECT *
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
    WHERE im."composition" IS NULL
    LIMIT 100;
    ```

12. **Explore the interest summaries from INTEREST_MAP:**

    ```sql
    SELECT m."interest_name", m."interest_summary"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
    LIMIT 100;
    ```

13. **List interests along with their creation dates:**

    ```sql
    SELECT m."interest_name", m."created_at"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
    ORDER BY m."created_at"
    LIMIT 100;
    ```

14. **Get index values for interests over time:**

    ```sql
    SELECT im."_year", im."_month", im."index_value", m."interest_name"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
    INNER JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
      ON im."interest_id" = m."id"
    WHERE ("_year" = 2018 AND "_month" >= 9) OR ("_year" = 2019 AND "_month" <= 8)
    ORDER BY im."_year", im."_month"
    LIMIT 100;
    ```

15. **Find interests that have improved in ranking over the months:**

    *(This query selects interest rankings over time to spot trends.)*

    ```sql
    SELECT im."_year", im."_month", im."interest_id", im."ranking", m."interest_name"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
    INNER JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
      ON im."interest_id" = m."id"
    WHERE im."ranking" <= 5 AND (("_year" = 2018 AND "_month" >= 9) OR ("_year" = 2019 AND "_month" <= 8))
    ORDER BY im."interest_id", im."_year", im."_month"
    LIMIT 100;
    ```

16. **List interests with their maximum composition value:**

    ```sql
    SELECT im."interest_id", MAX(im."composition") AS "max_composition", m."interest_name"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
    INNER JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
      ON im."interest_id" = m."id"
    GROUP BY im."interest_id", m."interest_name"
    ORDER BY "max_composition" DESC
    LIMIT 100;
    ```

17. **Explore the percentile rankings across all interests and dates:**

    ```sql
    SELECT im."percentile_ranking", COUNT(*) AS "count"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
    GROUP BY im."percentile_ranking"
    ORDER BY im."percentile_ranking" DESC
    LIMIT 100;
    ```

18. **Identify the interests with the highest index values in a specific month:**

    ```sql
    SELECT im."_year", im."_month", im."index_value", m."interest_name"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
    INNER JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
      ON im."interest_id" = m."id"
    WHERE im."_year" = 2019 AND im."_month" = 5
    ORDER BY im."index_value" DESC
    LIMIT 100;
    ```

19. **Get a list of interest IDs with their last modified dates from INTEREST_MAP:**

    ```sql
    SELECT m."id", m."interest_name", m."last_modified"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
    ORDER BY m."last_modified" DESC
    LIMIT 100;
    ```

20. **Find the number of interests per month in the date range:**

    ```sql
    SELECT im."_year", im."_month", COUNT(DISTINCT im."interest_id") AS "interest_count"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
    WHERE ("_year" = 2018 AND "_month" >= 9) OR ("_year" = 2019 AND "_month" <= 8)
    GROUP BY im."_year", im."_month"
    ORDER BY im."_year", im."_month"
    LIMIT 100;
    ```

---

These queries help in exploring and understanding the data related to interests, compositions, rankings, and dates within the specified timeframe. By analyzing the outputs of these queries, we can gain insights into how to structure the final query to meet the requirements of calculating maximum average compositions, rolling averages, and identifying top-ranking interests from previous months.

Feel free to adjust the queries or expand upon them based on the data and specific analysis needs.Query:
SELECT *
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS"
   WHERE ("_year" = 2018 AND "_month" >= 9) OR ("_year" = 2019 AND "_month" <= 8)
   LIMIT 100;
Answer:
_month,_year,month_year,interest_id,composition,index_value,ranking,percentile_ranking
9.0,2018.0,09-2018,6218.0,4.61,2.84,1,99.87
9.0,2018.0,09-2018,6285.0,7.06,2.82,2,99.74
9.0,2018.0,09-2018,22502.0,6.49,2.76,3,99.62
9.0,2018.0,09-2018,115.0,6.81,2.74,4,99.49
9.0,2018.0,09-2018,6013.0,4.9,2.73,5,99.36
9.0,2018.0,09-2018,6206.0,7.49,2.67,6,99.23
9.0,2018.0,09-2018,4.0,6.05,2.58,7,99.1
9.0,2018.0,09-2018,171.0,6.36,2.49,8,98.97
9.0,2018.0,09-2018,38.0,4.67,2.46,9,98.85
9.0,2018.0,09-2018,6219.0,4.28,2.36,10,98.72
9.0,2018.0,09-2018,35904.0,5.19,2.34,11,98.59
9.0,2018.0,09-2018,16137.0,5.25,2.31,12,98.46
9.0,2018.0,09-2018,6110.0,4.48,2.3,13,98.33
9.0,2018.0,09-2018,19250.0,6.62,2.29,14,98.21
9.0,2018.0,09-2018,16.0,3.66,2.28,15,98.08
9.0,2018.0,09-2018,5970.0,6.95,2.28,15,98.08
9.0,2018.0,09-2018,21242.0,5.84,2.28,15,98.08
9.0,2018.0,09-2018,17269.0,5.28,2.28,15,98.08
9.0,2018.0,09-2018,21057.0,18.18,2.2,19,97.56
9.0,2018.0,09-2018,32486.0,4.86,2.19,20,97.44
9.0,2018.0,09-2018,19613.0,5.1,2.19,20,97.44
9.0,2018.0,09-2018,6107.0,4.4,2.17,22,97.18
9.0,2018.0,09-2018,151.0,5.57,2.16,23,97.05
9.0,2018.0,09-2018,6023.0,5.85,2.16,23,97.05
9.0,2018.0,09-2018,6232.0,4.48,2.15,25,96.79
9.0,2018.0,09-2018,17320.0,2.8,2.14,26,96.67
9.0,2018.0,09-2018,35903.0,5.23,2.14,26,96.67
9.0,2018.0,09-2018,33.0,5.16,2.12,28,96.41
9.0,2018.0,09-2018,12133.0,12.8,2.1,29,96.28
9.0,2018.0,09-2018,4897.0,6.35,2.1,29,96.28
9.0,2018.0,09-2018,31.0,4.09,2.09,31,96.03
9.0,2018.0,09-2018,19423.0,5.04,2.08,32,95.9
9.0,2018.0,09-2018,6.0,9.48,2.07,33,95.77
9.0,2018.0,09-2018,12025.0,7.83,2.07,33,95.77
9.0,2018.0,09-2018,21061.0,7.06,2.07,33,95.77
9.0,2018.0,09-2018,6284.0,11.06,2.04,36,95.38
9.0,2018.0,09-2018,5968.0,5.79,2.03,37,95.26
9.0,2018.0,09-2018,6378.0,5.01,2.03,37,95.26
9.0,2018.0,09-2018,5969.0,14.29,2.03,37,95.26
9.0,2018.0,09-2018,17.0,3.07,2.01,40,94.87
9.0,2018.0,09-2018,6144.0,4.53,1.99,41,94.74
9.0,2018.0,09-2018,6286.0,11.18,1.99,41,94.74
9.0,2018.0,09-2018,17786.0,5.83,1.98,43,94.49
9.0,2018.0,09-2018,77.0,10.28,1.98,43,94.49
9.0,2018.0,09-2018,19298.0,11.74,1.97,45,94.23
9.0,2018.0,09-2018,17785.0,5.93,1.97,45,94.23
9.0,2018.0,09-2018,79.0,3.32,1.95,47,93.97
9.0,2018.0,09-2018,39.0,9.93,1.95,47,93.97
9.0,2018.0,09-2018,64.0,11.93,1.94,49,93.72
9.0,2018.0,09-2018,49.0,3.58,1.93,50,93.59
9.0,2018.0,09-2018,16138.0,5.01,1.93,50,93.59
9.0,2018.0,09-2018,6184.0,4.87,1.93,50,93.59
9.0,2018.0,09-2018,11067.0,6.71,1.91,53,93.21
9.0,2018.0,09-2018,4943.0,9.91,1.91,53,93.21
9.0,2018.0,09-2018,34465.0,2.83,1.88,55,92.95
9.0,2018.0,09-2018,32704.0,5.74,1.87,56,92.82
9.0,2018.0,09-2018,18923.0,3.14,1.87,56,92.82
9.0,2018.0,09-2018,88.0,3.23,1.86,58,92.56
9.0,2018.0,09-2018,10008.0,5.45,1.86,58,92.56
9.0,2018.0,09-2018,6029.0,7.9,1.86,58,92.56
9.0,2018.0,09-2018,17730.0,5.95,1.86,58,92.56
9.0,2018.0,09-2018,147.0,3.68,1.84,62,92.05
9.0,2018.0,09-2018,11974.0,3.43,1.84,62,92.05
9.0,2018.0,09-2018,158.0,8.43,1.83,64,91.79
9.0,2018.0,09-2018,4902.0,3.71,1.83,64,91.79
9.0,2018.0,09-2018,6304.0,4.51,1.83,64,91.79
9.0,2018.0,09-2018,34463.0,2.69,1.83,64,91.79
9.0,2018.0,09-2018,19295.0,5.84,1.83,64,91.79
9.0,2018.0,09-2018,21060.0,7.03,1.82,69,91.15
9.0,2018.0,09-2018,6210.0,4.31,1.82,69,91.15
9.0,2018.0,09-2018,18347.0,4.95,1.81,71,90.9
9.0,2018.0,09-2018,33971.0,4.75,1.81,71,90.9
9.0,2018.0,09-2018,56.0,3.55,1.8,73,90.64
9.0,2018.0,09-2018,7537.0,3.79,1.79,74,90.51
9.0,2018.0,09-2018,35.0,3.27,1.79,74,90.51
9.0,2018.0,09-2018,10980.0,5.21,1.78,76,90.26
9.0,2018.0,09-2018,5896.0,4.55,1.77,77,90.13
9.0,2018.0,09-2018,6305.0,5.38,1.77,77,90.13
9.0,2018.0,09-2018,98.0,3.71,1.77,77,90.13
9.0,2018.0,09-2018,12031.0,5.1,1.75,80,89.74
9.0,2018.0,09-2018,35953.0,4.17,1.75,80,89.74
9.0,2018.0,09-2018,4914.0,2.89,1.75,80,89.74
9.0,2018.0,09-2018,6142.0,4.35,1.74,83,89.36
9.0,2018.0,09-2018,19603.0,4.45,1.74,83,89.36
9.0,2018.0,09-2018,21062.0,5.68,1.73,85,89.1
9.0,2018.0,09-2018,6315.0,3.16,1.73,85,89.1
9.0,2018.0,09-2018,7557.0,4.0,1.73,85,89.1
9.0,2018.0,09-2018,6250.0,3.64,1.72,88,88.72
9.0,2018.0,09-2018,4924.0,3.75,1.71,89,88.59
9.0,2018.0,09-2018,19621.0,9.86,1.71,89,88.59
9.0,2018.0,09-2018,33959.0,2.53,1.71,89,88.59
9.0,2018.0,09-2018,22427.0,3.88,1.71,89,88.59
9.0,2018.0,09-2018,21059.0,5.11,1.7,93,88.08
9.0,2018.0,09-2018,7527.0,4.39,1.69,94,87.95
9.0,2018.0,09-2018,83.0,3.04,1.68,95,87.82
9.0,2018.0,09-2018,22403.0,5.42,1.67,96,87.69
9.0,2018.0,09-2018,113.0,3.91,1.67,96,87.69
9.0,2018.0,09-2018,18204.0,4.94,1.67,96,87.69
9.0,2018.0,09-2018,137.0,4.06,1.67,96,87.69
9.0,2018.0,09-2018,6340.0,4.58,1.67,96,87.69
Query:
SELECT DISTINCT im."interest_id", im."ranking", m."interest_name"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
   JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
     ON im."interest_id" = m."id"
   LIMIT 100;
Answer:
interest_id,ranking,interest_name
32486.0,1,Vacation Rental Accommodation Researchers
6106.0,2,Luxury Second Home Owners
18923.0,3,Online Home Decor Shoppers
6344.0,4,Hair Care Shoppers
69.0,6,Healthy Eaters
79.0,7,Luxury Travel Researchers
6214.0,8,Home Remodelers
4895.0,12,Mature Parents
6123.0,16,Misc-Deal Seekers or Coupon Shoppers
4870.0,22,Tech-Savvy Moms
19423.0,23,Kitchen Appliance Shoppers
6219.0,79,Cycling Enthusiasts
6378.0,100,Luggage Shoppers
6087.0,132,Metal and Rock Music Fans
6278.0,202,Junk Food Lovers
6217.0,13,Weight Loss Researchers
4.0,14,Luxury Retail Researchers
17.0,19,MLB Fans
4914.0,39,Mens Health Researchers
60.0,51,Online Health Researchers
4902.0,73,Yogis
16197.0,88,Financial Business Intelligence Researchers
22427.0,142,Yale University Fans
7453.0,178,Pilots
67.0,193,Lawyers
4940.0,158,Auto-Looking for New Car Purchase or Lease
19422.0,10,Home Design and Living Publication Readers
4911.0,75,Dieters
11974.0,79,Price Conscious Home Shoppers
115.0,42,Mens Shoe Shoppers
1.0,46,Fitness Enthusiasts
16137.0,62,Olympics Fans
4913.0,90,Womens Health Researchers
6227.0,105,Personal Stock Portfolio Managers
89.0,126,Travel Researchers
7605.0,189,Organic Food Buyers
5914.0,213,Career Focused Individuals
6143.0,229,College Football Fans
5930.0,241,Tax Filers
12820.0,241,Commercial Contractors & Designers
4910.0,77,Cholesterol Researchers
18996.0,126,Investment Banking Professionals
6076.0,208,Horse Owners
88.0,217,Ski and Snowboard Enthusiasts
75.0,235,Ink & Toner Shoppers
4894.0,287,Credit Union Researchers
48.0,416,Charitable Donors
6305.0,423,Identity Theft Protection Researchers
10980.0,93,Hanukkah Decorations Shoppers
4909.0,158,First Aid Researchers
18648.0,153,Architecture Enthusiasts
20731.0,163,Readers of South Asian Content
6162.0,179,Healthy Snacks Shoppers
20764.0,101,Entertainment Industry Decision Makers
11975.0,113,Landscape Architects
6127.0,167,LED Lighting Shoppers
4920.0,245,LGBT Activists
65.0,298,Hands-On Parents
19296.0,298,BBQ Enthusiasts
6229.0,309,Sweet Tooths
6024.0,416,Joint Pain Health Care Professionals
21059.0,63,Executive Travelers
7425.0,294,Life Insurance Researchers
6089.0,24,Mens Fitness Publication Readers
6184.0,29,Reusable Drinkware Shoppers
36.0,44,Baby Products Buyers
3.0,174,Car Enthusiasts
5960.0,193,New Zealand Trip Planners
6164.0,390,Microsoft Friendly Developers
6218.0,15,Running Enthusiasts
19613.0,18,Land Rover Shoppers
133.0,46,High End Camera Shoppers - Dupe
40.0,54,Bed & Bath Shoppers
132.0,98,Apple Fans
5938.0,57,Costa Rica Trip Planners
6315.0,63,Boston Trip Planners
6341.0,92,Pharmacy Shoppers
6284.0,132,Gym Equipment Owners
135.0,149,Major Appliance Shoppers
21293.0,182,Home Wifi Researchers
17785.0,182,Luxury Womens Brands Shoppers
17803.0,92,TV Advertising Professionals
44.0,105,Home Buyers
6172.0,121,Camera Review Readers
13.0,126,Advertising Professionals
138.0,155,Home Kitchen Bakers
90.0,199,Coupon Researchers
147.0,210,Broadway Fans
19879.0,221,Personal Investment Researchers
49.0,229,NHL Fans
22096.0,249,Camping Enthusiasts
6265.0,249,Pharmacists
150.0,49,TV Junkies
18622.0,257,Las Vegas Nightlife Researchers
12132.0,263,Last Minute Travelers
5907.0,296,Budget Small Business Researchers
6220.0,298,Eyeglasses & Contact Lens Buyers
6321.0,443,Nashville Trip Planners
6325.0,555,Orlando Trip Planners
118.0,578,Sleep Disorder Researchers
Query:
SELECT im."_year", im."_month", MAX(im."composition") AS "max_composition"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
   WHERE ("_year" = 2018 AND "_month" >= 9) OR ("_year" = 2019 AND "_month" <= 8)
   GROUP BY im."_year", im."_month"
   ORDER BY im."_year", im."_month"
   LIMIT 100;
Answer:
_year,_month,max_composition
2018.0,9.0,18.18
2018.0,10.0,20.28
2018.0,11.0,19.45
2018.0,12.0,21.2
2019.0,1.0,18.99
2019.0,2.0,18.39
2019.0,3.0,12.64
2019.0,4.0,11.01
2019.0,5.0,7.53
2019.0,6.0,6.94
2019.0,7.0,7.19
2019.0,8.0,7.1
Query:
SELECT im."_year", im."_month", im."composition", m."interest_name"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
   JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
     ON im."interest_id" = m."id"
   WHERE ("_year" = 2018 AND "_month" >= 9) OR ("_year" = 2019 AND "_month" <= 8)
   ORDER BY im."_year", im."_month", im."composition" DESC
   LIMIT 100;
Answer:
_year,_month,composition,interest_name
2018.0,9.0,18.18,Work Comes First Travelers
2018.0,9.0,14.29,Luxury Bedding Shoppers
2018.0,9.0,12.8,Luxury Boutique Hotel Researchers
2018.0,9.0,11.93,High-End Kids Furniture and Clothes Shoppers
2018.0,9.0,11.74,Beach Supplies Shoppers
2018.0,9.0,11.18,Luxury Hotel Guests
2018.0,9.0,11.06,Gym Equipment Owners
2018.0,9.0,10.61,Christmas Celebration Researchers
2018.0,9.0,10.28,Luxury Retail Shoppers
2018.0,9.0,9.96,Patio Furniture Shoppers
2018.0,9.0,9.93,Furniture Shoppers
2018.0,9.0,9.91,Online Grocery Shoppers
2018.0,9.0,9.86,Portugal Trip Planners
2018.0,9.0,9.48,Vacation Planners
2018.0,9.0,9.33,Halloween Costume Shoppers
2018.0,9.0,9.23,Alabama Trip Planners
2018.0,9.0,9.08,Teen Girl Clothing Shoppers
2018.0,9.0,9.06,Skin Care Researchers
2018.0,9.0,8.77,New Years Eve Party Ticket Purchasers
2018.0,9.0,8.7,New Zealand Trip Planners
2018.0,9.0,8.66,Chelsea Fans
2018.0,9.0,8.51,Nursing and Physicians Assistant Journal Researchers
2018.0,9.0,8.43,Flight and Hotel Shoppers
2018.0,9.0,8.25,Pre-Measured Grocery Shoppers
2018.0,9.0,8.12,Restaurant Supply Shoppers
2018.0,9.0,8.12,Financial Advisors
2018.0,9.0,7.92,Travel Researchers
2018.0,9.0,7.9,Indoor Cycling & Spinning Enthusiasts
2018.0,9.0,7.83,Urban Skateboarding Sneaker Shoppers
2018.0,9.0,7.49,Preppy Clothing Shoppers
2018.0,9.0,7.46,Life Insurance Researchers
2018.0,9.0,7.45,Food Safety Decision Makers
2018.0,9.0,7.18,Investment Services Intenders
2018.0,9.0,7.17,Real Estate Decision Makers
2018.0,9.0,7.12,North Carolina Travel Researchers
2018.0,9.0,7.1,Las Vegas Trip Planners
2018.0,9.0,7.06,"Work Hard, Play Hard Travelers"
2018.0,9.0,7.06,Competitive Tri-Athletes
2018.0,9.0,7.03,Family Adventures Travelers
2018.0,9.0,7.0,Freelancers
2018.0,9.0,6.97,Natural Pet Food Shoppers
2018.0,9.0,6.95,Luxury Home Fixture Shoppers
2018.0,9.0,6.92,Healthcare Provider Education Researchers
2018.0,9.0,6.81,Mens Shoe Shoppers
2018.0,9.0,6.8,Credit Score Researchers
2018.0,9.0,6.76,Non-Profit Volunteers
2018.0,9.0,6.71,NCAA Football Fans
2018.0,9.0,6.67,Healthcare Discount Shoppers
2018.0,9.0,6.63,Norfolk and Virginia Beach Trip Planners
2018.0,9.0,6.62,World Cup Enthusiasts
2018.0,9.0,6.59,Arsenal Fans
2018.0,9.0,6.57,Russia Trip Planners
2018.0,9.0,6.56,Vacuum Shoppers
2018.0,9.0,6.53,Nissan Vehicle Shoppers
2018.0,9.0,6.49,Lacrosse Enthusiasts
2018.0,9.0,6.48,Home Healthcare Researchers
2018.0,9.0,6.36,Shoe Shoppers
2018.0,9.0,6.36,Teachers
2018.0,9.0,6.35,Parents of Teenagers Going to College
2018.0,9.0,6.33,Competitive Car Brand Shoppers
2018.0,9.0,6.33,Cosmetics and Beauty Shoppers
2018.0,9.0,6.18,Food Industry Professionals
2018.0,9.0,6.07,Property and Facility Managers
2018.0,9.0,6.05,Luxury Retail Researchers
2018.0,9.0,6.0,Military Families
2018.0,9.0,5.95,Luxury Department Store Shoppers
2018.0,9.0,5.94,Seasonal Allergy Sufferers
2018.0,9.0,5.93,Luxury Womens Brands Shoppers
2018.0,9.0,5.91,Atlanta Trip Planners
2018.0,9.0,5.89,Business Incorporating & LLC Filing Researchers
2018.0,9.0,5.88,Department Store Shoppers
2018.0,9.0,5.85,Sports Medicine Health Care Professionals
2018.0,9.0,5.84,Fishing Equipment Shoppers
2018.0,9.0,5.84,World Cup Apparel Shoppers
2018.0,9.0,5.83,Womens Fashion Brands Shoppers
2018.0,9.0,5.79,Commercial Contractors & Designers
2018.0,9.0,5.79,Luxury Kitchen Goods Shoppers
2018.0,9.0,5.78,Online Education Intenders
2018.0,9.0,5.74,Major Airline Customers
2018.0,9.0,5.68,Recently Retired Individuals
2018.0,9.0,5.68,Getting Off the Grid Travelers
2018.0,9.0,5.65,Web Design Researchers
2018.0,9.0,5.61,Diner and Ice Cream Lovers
2018.0,9.0,5.61,Pain Management Researchers
2018.0,9.0,5.6,HDTV Researchers
2018.0,9.0,5.58,Weight Loss Researchers
2018.0,9.0,5.57,Online Health Researchers
2018.0,9.0,5.57,Big & Tall Men
2018.0,9.0,5.52,Military Personal Finance Researchers
2018.0,9.0,5.48,Countdown to the Beach Travelers
2018.0,9.0,5.46,Medical Advice Researchers
2018.0,9.0,5.45,Japanese Luxury Car Enthusiasts
2018.0,9.0,5.45,Credit Union Researchers
2018.0,9.0,5.42,Pandora Jewelry Shoppers
2018.0,9.0,5.38,Identity Theft Protection Researchers
2018.0,9.0,5.36,Soccer Fans
2018.0,9.0,5.35,Digital Antenna Users
2018.0,9.0,5.28,At-Home Gym Intenders
2018.0,9.0,5.25,Olympics Fans
2018.0,9.0,5.24,Classic Car Shoppers
Query:
SELECT im."_year", im."_month", im."interest_id", AVG(im."composition") AS "avg_composition"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
   WHERE ("_year" = 2018 AND "_month" >= 9) OR ("_year" = 2019 AND "_month" <= 8)
   GROUP BY im."_year", im."_month", im."interest_id"
   ORDER BY im."_year", im."_month"
   LIMIT 100;
Answer:
_year,_month,interest_id,avg_composition
2018.0,9.0,171.0,6.36
2018.0,9.0,6285.0,7.06
2018.0,9.0,6206.0,7.49
2018.0,9.0,35904.0,5.19
2018.0,9.0,38.0,4.67
2018.0,9.0,16137.0,5.25
2018.0,9.0,19250.0,6.62
2018.0,9.0,17269.0,5.28
2018.0,9.0,5970.0,6.95
2018.0,9.0,21057.0,18.18
2018.0,9.0,17320.0,2.8
2018.0,9.0,32486.0,4.86
2018.0,9.0,35903.0,5.23
2018.0,9.0,12133.0,12.8
2018.0,9.0,31.0,4.09
2018.0,9.0,19423.0,5.04
2018.0,9.0,12025.0,7.83
2018.0,9.0,21061.0,7.06
2018.0,9.0,5968.0,5.79
2018.0,9.0,17.0,3.07
2018.0,9.0,17785.0,5.93
2018.0,9.0,32704.0,5.74
2018.0,9.0,79.0,3.32
2018.0,9.0,19621.0,9.86
2018.0,9.0,6340.0,4.58
2018.0,9.0,18352.0,4.12
2018.0,9.0,6085.0,3.29
2018.0,9.0,6237.0,6.76
2018.0,9.0,19613.0,5.1
2018.0,9.0,6023.0,5.85
2018.0,9.0,6284.0,11.06
2018.0,9.0,17786.0,5.83
2018.0,9.0,77.0,10.28
2018.0,9.0,64.0,11.93
2018.0,9.0,16138.0,5.01
2018.0,9.0,6029.0,7.9
2018.0,9.0,11974.0,3.43
2018.0,9.0,98.0,3.71
2018.0,9.0,19603.0,4.45
2018.0,9.0,11975.0,3.5
2018.0,9.0,60.0,5.57
2018.0,9.0,33474.0,3.2
2018.0,9.0,10250.0,9.33
2018.0,9.0,12821.0,4.24
2018.0,9.0,21058.0,5.48
2018.0,9.0,6171.0,3.84
2018.0,9.0,96.0,2.62
2018.0,9.0,82.0,5.6
2018.0,9.0,10976.0,3.8
2018.0,9.0,34461.0,3.02
2018.0,9.0,6314.0,2.18
2018.0,9.0,134.0,3.71
2018.0,9.0,33959.0,2.53
2018.0,9.0,16.0,3.66
2018.0,9.0,33.0,5.16
2018.0,9.0,4897.0,6.35
2018.0,9.0,88.0,3.23
2018.0,9.0,6.0,9.48
2018.0,9.0,34463.0,2.69
2018.0,9.0,21060.0,7.03
2018.0,9.0,35.0,3.27
2018.0,9.0,7557.0,4.0
2018.0,9.0,6250.0,3.64
2018.0,9.0,22427.0,3.88
2018.0,9.0,7527.0,4.39
2018.0,9.0,83.0,3.04
2018.0,9.0,155.0,3.53
2018.0,9.0,10977.0,10.61
2018.0,9.0,101.0,3.37
2018.0,9.0,6343.0,9.96
2018.0,9.0,5933.0,4.13
2018.0,9.0,18648.0,2.95
2018.0,9.0,6220.0,4.34
2018.0,9.0,6177.0,3.27
2018.0,9.0,21293.0,3.41
2018.0,9.0,6110.0,4.48
2018.0,9.0,151.0,5.57
2018.0,9.0,6232.0,4.48
2018.0,9.0,6144.0,4.53
2018.0,9.0,6286.0,11.18
2018.0,9.0,39.0,9.93
2018.0,9.0,49.0,3.58
2018.0,9.0,18923.0,3.14
2018.0,9.0,17730.0,5.95
2018.0,9.0,158.0,8.43
2018.0,9.0,19295.0,5.84
2018.0,9.0,18347.0,4.95
2018.0,9.0,10980.0,5.21
2018.0,9.0,157.0,4.13
2018.0,9.0,34465.0,2.83
2018.0,9.0,21242.0,5.84
2018.0,9.0,4.0,6.05
2018.0,9.0,22502.0,6.49
2018.0,9.0,6218.0,4.61
2018.0,9.0,4943.0,9.91
2018.0,9.0,21237.0,8.66
2018.0,9.0,6107.0,4.4
2018.0,9.0,6219.0,4.28
2018.0,9.0,6013.0,4.9
2018.0,9.0,115.0,6.81
Query:
SELECT im."_year", im."_month", im."ranking", m."interest_name"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
   JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
     ON im."interest_id" = m."id"
   WHERE im."ranking" = 1 AND (("_year" = 2018 AND "_month" >= 9) OR ("_year" = 2019 AND "_month" <= 8))
   ORDER BY im."_year", im."_month"
   LIMIT 100;
Answer:
_year,_month,ranking,interest_name
2018.0,9.0,1,Running Enthusiasts
2018.0,10.0,1,Running Enthusiasts
2018.0,11.0,1,Competitive Tri-Athletes
2018.0,12.0,1,Winter Apparel Shoppers
2019.0,1.0,1,Winter Apparel Shoppers
2019.0,2.0,1,Winter Apparel Shoppers
2019.0,3.0,1,Winter Apparel Shoppers
2019.0,4.0,1,Winter Apparel Shoppers
2019.0,5.0,1,Winter Apparel Shoppers
2019.0,6.0,1,Winter Apparel Shoppers
2019.0,7.0,1,Winter Apparel Shoppers
2019.0,8.0,1,Winter Apparel Shoppers
Query:
SELECT DISTINCT im."_year", im."_month"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
   ORDER BY im."_year", im."_month"
   LIMIT 100;
Answer:
_year,_month
2018.0,7.0
2018.0,8.0
2018.0,9.0
2018.0,10.0
2018.0,11.0
2018.0,12.0
2019.0,1.0
2019.0,2.0
2019.0,3.0
2019.0,4.0
2019.0,5.0
2019.0,6.0
2019.0,7.0
2019.0,8.0
,
Query:
SELECT im."interest_id", im."percentile_ranking", m."interest_name"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
   JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
     ON im."interest_id" = m."id"
   WHERE im."_year" = 2019 AND im."_month" = 6
   ORDER BY im."percentile_ranking" DESC
   LIMIT 100;
Answer:
interest_id,percentile_ranking,interest_name
41548.0,99.88,Winter Apparel Shoppers
22502.0,99.76,Lacrosse Enthusiasts
42203.0,99.64,Fitness Activity Tracker Users
115.0,99.51,Mens Shoe Shoppers
6206.0,99.39,Preppy Clothing Shoppers
19250.0,99.27,World Cup Enthusiasts
44272.0,99.15,Rowing Enthusiasts
151.0,99.03,Big & Tall Men
41854.0,98.91,Swimming Enthusiasts
45518.0,98.79,Volleyball Enthusiasts
35904.0,98.67,Utility Workwear Shoppers
48154.0,98.54,Elite Cycling Gear Shoppers
6285.0,98.42,Competitive Tri-Athletes
12133.0,98.3,Luxury Boutique Hotel Researchers
40439.0,98.3,Ski and Snowboard Apparel Shoppers
39665.0,98.06,Aspen Skiers and Snowboarders
19298.0,97.94,Beach Supplies Shoppers
47713.0,97.82,High School Sports Researchers
47130.0,97.69,Home Lending Researchers
44588.0,97.69,Softball Enthusiasts
17269.0,97.45,At-Home Gym Intenders
4.0,97.33,Luxury Retail Researchers
6232.0,97.21,Golf Enthusiasts
6286.0,97.21,Luxury Hotel Guests
19295.0,96.97,Fishing Equipment Shoppers
37875.0,96.84,Vermont Trip Planners
171.0,96.84,Shoe Shoppers
38.0,96.6,Sporting Goods Shoppers
5970.0,96.48,Luxury Home Fixture Shoppers
41191.0,96.36,Sports Memorabilia Shoppers
41069.0,96.36,Big East Fans
10008.0,96.12,Japanese Luxury Car Enthusiasts
44446.0,96.0,Home Rug Shoppers
45678.0,95.87,Mens Underwear Shoppers
44489.0,95.87,Home Goods Supercenter Shoppers
6219.0,95.63,Cycling Enthusiasts
5969.0,95.51,Luxury Bedding Shoppers
6378.0,95.39,Luggage Shoppers
38990.0,95.39,Colorado Skiers and Snowboarders
44453.0,95.15,Mens Business Clothes Shoppers
31.0,95.02,Home Decor Shoppers
6013.0,95.02,Competitive Sports Participants
16.0,94.78,NCAA Fans
49979.0,94.78,Cape Cod News Readers
44469.0,94.54,Home Interior Design Enthusiasts
6284.0,94.42,Gym Equipment Owners
44585.0,94.3,Ballet Enthusiasts
6023.0,94.17,Sports Medicine Health Care Professionals
16137.0,94.17,Olympics Fans
19423.0,93.93,Kitchen Appliance Shoppers
6.0,93.93,Vacation Planners
4897.0,93.69,Parents of Teenagers Going to College
18347.0,93.57,Affordable Hotel Bookers
12025.0,93.45,Urban Skateboarding Sneaker Shoppers
33.0,93.45,Kids Clothing Shoppers
6107.0,93.2,Ski House Second Home Owners
21242.0,93.08,World Cup Apparel Shoppers
5968.0,92.96,Luxury Kitchen Goods Shoppers
44476.0,92.84,New York City Events Researchers
11067.0,92.84,NCAA Football Fans
10980.0,92.84,Hanukkah Decorations Shoppers
40183.0,92.48,Canoeing and Kayaking Enthusiasts
6218.0,92.48,Running Enthusiasts
44587.0,92.23,Baseball Enthusiasts
4943.0,92.11,Online Grocery Shoppers
21237.0,92.11,Chelsea Fans
79.0,91.87,Luxury Travel Researchers
39.0,91.87,Furniture Shoppers
36879.0,91.87,Embroidery Enthusiasts
5960.0,91.5,New Zealand Trip Planners
6305.0,91.38,Identity Theft Protection Researchers
101.0,91.38,Flower & Gift Basket Shoppers
6144.0,91.38,North Carolina Football Fans
18996.0,91.02,Investment Banking Professionals
6184.0,90.9,Reusable Drinkware Shoppers
17320.0,90.9,March Madness Enthusiasts
19613.0,90.9,Land Rover Shoppers
6304.0,90.9,New York Trip Planners
4912.0,90.41,Vitamin Shoppers
37423.0,90.41,Promotional Products Purchasers
41080.0,90.17,New York Mets Fans
6110.0,90.17,Apartment Furniture Shoppers
141.0,90.17,Skin Care Researchers
38994.0,89.81,Western Canada Skiers and Snowboarders
32704.0,89.81,Major Airline Customers
32486.0,89.81,Vacation Rental Accommodation Researchers
39657.0,89.44,Kansas City Royals Fans
44455.0,89.44,Kitchen Stove Shoppers
41083.0,89.2,Cininnati Reds Fans
34465.0,89.2,Toronto Blue Jays Fans
18202.0,89.2,Real Estate Decision Makers
6142.0,88.83,European Trip Planners
49.0,88.83,NHL Fans
39649.0,88.59,Duke Blue Devils Fans
19621.0,88.59,Portugal Trip Planners
6343.0,88.35,Patio Furniture Shoppers
6029.0,88.35,Indoor Cycling & Spinning Enthusiasts
134.0,88.35,Home Printer Shoppers
35903.0,88.35,Trendy Denim Shoppers
4924.0,88.35,Surfers
Query:
SELECT im."interest_id", AVG(im."composition") AS "avg_composition", m."interest_name"
   FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
   JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
     ON im."interest_id" = m."id"
   WHERE ("_year" = 2018 AND "_month" >= 9) OR ("_year" = 2019 AND "_month" <= 8)
   GROUP BY im."interest_id", m."interest_name"
   ORDER BY "avg_composition" DESC
   LIMIT 100;
Answer:
interest_id,avg_composition,interest_name
21057.0,19.415,Work Comes First Travelers
5969.0,11.109166666666667,Luxury Bedding Shoppers
12133.0,10.418333333333333,Luxury Boutique Hotel Researchers
6284.0,9.5075,Gym Equipment Owners
19298.0,9.485833333333334,Beach Supplies Shoppers
6286.0,8.990833333333333,Luxury Hotel Guests
64.0,8.906666666666666,High-End Kids Furniture and Clothes Shoppers
77.0,8.895833333333334,Luxury Retail Shoppers
10977.0,8.7575,Christmas Celebration Researchers
39.0,8.636666666666667,Furniture Shoppers
6.0,8.14,Vacation Planners
6343.0,8.035,Patio Furniture Shoppers
21061.0,7.906666666666666,"Work Hard, Play Hard Travelers"
10981.0,7.808333333333334,New Years Eve Party Ticket Purchasers
19621.0,7.8075,Portugal Trip Planners
5960.0,7.713333333333334,New Zealand Trip Planners
41548.0,7.58,Winter Apparel Shoppers
21060.0,7.576666666666667,Family Adventures Travelers
7541.0,7.444166666666667,Alabama Trip Planners
158.0,7.439166666666666,Flight and Hotel Shoppers
34.0,7.394166666666667,Teen Girl Clothing Shoppers
10250.0,7.343333333333334,Halloween Costume Shoppers
4943.0,7.3308333333333335,Online Grocery Shoppers
18783.0,7.044999999999999,Nursing and Physicians Assistant Journal Researchers
21237.0,7.039166666666667,Chelsea Fans
141.0,6.986666666666667,Skin Care Researchers
5944.0,6.760833333333333,Financial Advisors
4944.0,6.6308333333333325,Pre-Measured Grocery Shoppers
89.0,6.595,Travel Researchers
13497.0,6.460833333333333,Restaurant Supply Shoppers
5970.0,6.425,Luxury Home Fixture Shoppers
12025.0,6.3875,Urban Skateboarding Sneaker Shoppers
115.0,6.350833333333333,Mens Shoe Shoppers
6206.0,6.2124999999999995,Preppy Clothing Shoppers
6029.0,6.0825,Indoor Cycling & Spinning Enthusiasts
6324.0,6.0825,Las Vegas Trip Planners
21062.0,6.0683333333333325,Getting Off the Grid Travelers
6285.0,5.9875,Competitive Tri-Athletes
7425.0,5.915,Life Insurance Researchers
19250.0,5.898333333333333,World Cup Enthusiasts
18202.0,5.855833333333333,Real Estate Decision Makers
21059.0,5.685,Executive Travelers
11067.0,5.648333333333333,NCAA Football Fans
7685.0,5.6258333333333335,Home Healthcare Researchers
15879.0,5.6191666666666675,Freelancers
7540.0,5.615833333333334,North Carolina Travel Researchers
22502.0,5.586666666666667,Lacrosse Enthusiasts
6308.0,5.509166666666666,Food Safety Decision Makers
5911.0,5.5025,Credit Score Researchers
171.0,5.5008333333333335,Shoe Shoppers
124.0,5.460833333333333,Healthcare Discount Shoppers
19617.0,5.446666666666666,Nissan Vehicle Shoppers
18784.0,5.4425,Healthcare Provider Education Researchers
4898.0,5.425833333333333,Cosmetics and Beauty Shoppers
6208.0,5.384166666666666,Recently Retired Individuals
4.0,5.3758333333333335,Luxury Retail Researchers
82.0,5.350833333333333,HDTV Researchers
17540.0,5.338333333333334,Vacuum Shoppers
4897.0,5.338333333333334,Parents of Teenagers Going to College
10009.0,5.299166666666667,Investment Services Intenders
107.0,5.283333333333333,Cruise Travel Intenders
6023.0,5.265,Sports Medicine Health Care Professionals
7535.0,5.251666666666667,Medicare Provider Researchers
30.0,5.241666666666666,Department Store Shoppers
19757.0,5.1925,Natural Pet Food Shoppers
19295.0,5.190833333333333,Fishing Equipment Shoppers
21058.0,5.166666666666667,Countdown to the Beach Travelers
6237.0,5.155833333333333,Non-Profit Volunteers
10008.0,5.1499999999999995,Japanese Luxury Car Enthusiasts
5968.0,5.138333333333333,Luxury Kitchen Goods Shoppers
151.0,5.0825000000000005,Big & Tall Men
28.0,5.066666666666666,Teachers
17786.0,5.025833333333334,Womens Fashion Brands Shoppers
39665.0,5.025,Aspen Skiers and Snowboarders
5925.0,5.0225,Business Incorporating & LLC Filing Researchers
17730.0,4.988333333333333,Luxury Department Store Shoppers
19519.0,4.986666666666667,Property and Facility Managers
42203.0,4.963333333333334,Fitness Activity Tracker Users
10834.0,4.96,Norfolk and Virginia Beach Trip Planners
19623.0,4.895833333333333,Russia Trip Planners
55.0,4.895833333333333,Seasonal Allergy Sufferers
5957.0,4.88,Online Education Intenders
60.0,4.875,Online Health Researchers
5909.0,4.8741666666666665,Web Design Researchers
6303.0,4.846666666666667,Atlanta Trip Planners
17269.0,4.8374999999999995,At-Home Gym Intenders
7461.0,4.826666666666667,Food Industry Professionals
22403.0,4.823333333333333,Pandora Jewelry Shoppers
38368.0,4.811111111111111,Volvo Vehicle Shoppers
4919.0,4.795833333333333,Military Families
17674.0,4.781666666666667,Medical Advice Researchers
4894.0,4.754545454545454,Credit Union Researchers
17729.0,4.75,Competitive Car Brand Shoppers
33.0,4.7491666666666665,Kids Clothing Shoppers
6217.0,4.748333333333334,Weight Loss Researchers
40439.0,4.748,Ski and Snowboard Apparel Shoppers
37875.0,4.742727272727273,Vermont Trip Planners
6378.0,4.738333333333333,Luggage Shoppers
6111.0,4.736,Wine Lovers
10980.0,4.695,Hanukkah Decorations Shoppers
Query:
SELECT im."_year", im."_month", im."composition"
    FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
    WHERE ("_year" = 2018 AND "_month" >= 6) OR ("_year" = 2019 AND "_month" <= 8)
    ORDER BY im."_year", im."_month"
    LIMIT 100;
Answer:
_year,_month,composition
2018.0,7.0,10.71
2018.0,7.0,9.93
2018.0,7.0,10.82
2018.0,7.0,11.57
2018.0,7.0,9.71
2018.0,7.0,9.47
2018.0,7.0,10.8
2018.0,7.0,9.49
2018.0,7.0,13.97
2018.0,7.0,14.91
2018.0,7.0,11.99
2018.0,7.0,12.62
2018.0,7.0,9.35
2018.0,7.0,10.29
2018.0,7.0,12.22
2018.0,7.0,6.97
2018.0,7.0,11.48
2018.0,7.0,14.1
2018.0,7.0,11.04
2018.0,7.0,9.77
2018.0,7.0,13.35
2018.0,7.0,6.61
2018.0,7.0,11.61
2018.0,7.0,9.48
2018.0,7.0,13.67
2018.0,7.0,6.09
2018.0,7.0,9.97
2018.0,7.0,6.9
2018.0,7.0,10.43
2018.0,7.0,6.83
2018.0,7.0,7.42
2018.0,7.0,11.68
2018.0,7.0,12.87
2018.0,7.0,9.27
2018.0,7.0,6.37
2018.0,7.0,10.91
2018.0,7.0,7.02
2018.0,7.0,6.25
2018.0,7.0,8.84
2018.0,7.0,5.3
2018.0,7.0,6.71
2018.0,7.0,7.21
2018.0,7.0,12.27
2018.0,7.0,10.86
2018.0,7.0,6.28
2018.0,7.0,11.38
2018.0,7.0,11.63
2018.0,7.0,6.47
2018.0,7.0,12.93
2018.0,7.0,8.72
2018.0,7.0,7.9
2018.0,7.0,11.63
2018.0,7.0,9.65
2018.0,7.0,8.14
2018.0,7.0,6.77
2018.0,7.0,6.24
2018.0,7.0,6.26
2018.0,7.0,6.65
2018.0,7.0,10.22
2018.0,7.0,6.53
2018.0,7.0,8.17
2018.0,7.0,11.72
2018.0,7.0,10.95
2018.0,7.0,6.87
2018.0,7.0,6.09
2018.0,7.0,9.97
2018.0,7.0,7.19
2018.0,7.0,6.37
2018.0,7.0,11.4
2018.0,7.0,6.28
2018.0,7.0,5.99
2018.0,7.0,7.46
2018.0,7.0,9.13
2018.0,7.0,5.99
2018.0,7.0,6.88
2018.0,7.0,6.13
2018.0,7.0,5.14
2018.0,7.0,6.25
2018.0,7.0,6.76
2018.0,7.0,7.09
2018.0,7.0,5.68
2018.0,7.0,6.52
2018.0,7.0,6.45
2018.0,7.0,6.21
2018.0,7.0,5.41
2018.0,7.0,7.48
2018.0,7.0,6.45
2018.0,7.0,9.64
2018.0,7.0,6.82
2018.0,7.0,9.37
2018.0,7.0,9.29
2018.0,7.0,11.21
2018.0,7.0,10.85
2018.0,7.0,11.89
2018.0,7.0,10.76
2018.0,7.0,6.05
2018.0,7.0,7.89
2018.0,7.0,10.11
2018.0,7.0,10.77
2018.0,7.0,10.32
Query:
WITH Monthly_Max AS (
  SELECT
    im."_year",
    im."_month",
    im."interest_id",
    AVG(im."composition") AS avg_composition
  FROM
    "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
  WHERE
    (im."_year" = 2018 AND im."_month" >= 9) OR (im."_year" = 2019 AND im."_month" <= 8)
  GROUP BY
    im."_year",
    im."_month",
    im."interest_id"
),
Max_Per_Month AS (
  SELECT
    mm.*,
    ROW_NUMBER() OVER (PARTITION BY mm."_year", mm."_month" ORDER BY mm.avg_composition DESC) AS rank
  FROM
    Monthly_Max mm
),
Top_Interest_Per_Month AS (
  SELECT
    mpm."_year",
    mpm."_month",
    mpm."interest_id",
    mpm.avg_composition
  FROM
    Max_Per_Month mpm
  WHERE
    mpm.rank = 1
),
Top_Interest_With_Names AS (
  SELECT
    tipm."_year",
    tipm."_month",
    tipm."interest_id",
    imap."interest_name",
    tipm.avg_composition
  FROM
    Top_Interest_Per_Month tipm
    JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" imap
      ON tipm."interest_id" = imap."id"
),
Rolling_Avg AS (
  SELECT
    tipm.*,
    AVG(tipm.avg_composition) OVER (
      ORDER BY tipm."_year", tipm."_month"
      ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
    ) AS rolling_avg
  FROM
    Top_Interest_With_Names tipm
),
Previous_Month_Interests AS (
  SELECT
    tipm.*,
    LAG(tipm."interest_name", 1) OVER (ORDER BY tipm."_year", tipm."_month") AS "Top_Ranking_Interest_Minus1Month",
    LAG(tipm."interest_name", 2) OVER (ORDER BY tipm."_year", tipm."_month") AS "Top_Ranking_Interest_Minus2Months"
  FROM
    Rolling_Avg tipm
)
SELECT
  DATE_FROM_PARTS(pmi."_year", pmi."_month", 1) AS "Date",
  pmi."interest_name" AS "Interest_Name",
  pmi.avg_composition AS "Max_Index_Composition",
  pmi.rolling_avg AS "Rolling_Average",
  pmi."Top_Ranking_Interest_Minus1Month",
  pmi."Top_Ranking_Interest_Minus2Months"
FROM
  Previous_Month_Interests pmi
ORDER BY
  pmi."_year",
  pmi."_month";
Answer:
Date,Interest_Name,Max_Index_Composition,Rolling_Average,Top_Ranking_Interest_Minus1Month,Top_Ranking_Interest_Minus2Months
2018-09-01,Work Comes First Travelers,18.18,18.18,,
2018-10-01,Work Comes First Travelers,20.28,19.23,Work Comes First Travelers,
2018-11-01,Work Comes First Travelers,19.45,19.30333333333333,Work Comes First Travelers,Work Comes First Travelers
2018-12-01,Work Comes First Travelers,21.2,20.31,Work Comes First Travelers,Work Comes First Travelers
2019-01-01,Work Comes First Travelers,18.99,19.88,Work Comes First Travelers,Work Comes First Travelers
2019-02-01,Work Comes First Travelers,18.39,19.526666666666667,Work Comes First Travelers,Work Comes First Travelers
2019-03-01,Luxury Boutique Hotel Researchers,12.64,16.673333333333332,Work Comes First Travelers,Work Comes First Travelers
2019-04-01,Luxury Bedding Shoppers,11.01,14.01333333333333,Luxury Boutique Hotel Researchers,Work Comes First Travelers
2019-05-01,Luxury Bedding Shoppers,7.53,10.39333333333333,Luxury Bedding Shoppers,Luxury Boutique Hotel Researchers
2019-06-01,Gym Equipment Owners,6.94,8.49333333333333,Luxury Bedding Shoppers,Luxury Bedding Shoppers
2019-07-01,Gym Equipment Owners,7.19,7.219999999999996,Gym Equipment Owners,Luxury Bedding Shoppers
2019-08-01,Gym Equipment Owners,7.1,7.0766666666666636,Gym Equipment Owners,Gym Equipment Owners
Query:
SELECT m."interest_name", m."interest_summary"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
LIMIT 100
Answer:
Too long, hard cut:
interest_name,interest_summary
Fitness Enthusiasts,Consumers using fitness tracking apps and websites.
Gamers,Consumers researching game reviews and cheat codes.
Car Enthusiasts,Readers of automotive news and car reviews.
Luxury Retail Researchers,Consumers researching luxury product reviews and gift ideas.
Brides & Wedding Planners,People researching wedding ideas and vendors.
Vacation Planners,Consumers reading reviews of vacation destinations and accommodations.
Motorcycle Enthusiasts,Readers of motorcycle news and reviews.
Business News Readers,Readers of online business news content.
Thrift Store Shoppers,Consumers shopping online for clothing at thrift stores and researching locations.
Advertising Professionals,People who read advertising industry news.
NFL Fans,People reading articles and websites about football and the NFL.
NBA Fans,People reading articles and websites about basketball and the NBA.
NCAA Fans,People reading articles and websites about college sports and the NCAA.
MLB Fans,People reading articles and websites about baseball and the MLB.
Nascar Fans,People reading articles and websites about nascar.
Eco-Conscious Consumers,People researching climate change and sustainable living.
Moviegoers,Consumers researching box office listings and buying movie tickets.
DIYers,Consumers researching DIY projects.
Grill Masters,Grill owners researching new recipes.
Techies,Readers of tech news and gadget reviews.
Home Design Enthusiasts,Consumers researching home design styles and trends.
Doctors,People reading medical journals and using online prescribing services.
Streaming Video Fans,Consumers streaming feature length movies and TV shows.
Auto Insurance Shoppers,Consumers shopping for auto insurance.
Teachers,People reading education industry publications and teaching advice websites.
College Students,People visiting university websites.
Department Store Shoppers,Consumes shopping at multi-category department stores.
Home Decor Shoppers,"Consumers shopping for home design, art and accessories."
Kids Clothing Shoppers,Consumers shopping for childrens apparel.
Teen Girl Clothing Shoppers,Consumers in-market for clothing for teenage girls.
Mens Clothing Shoppers,Consumers in-market for mens clothing.
Baby Products Buyers,Consumers shopping for baby-related products.
Jewelry & Watch Shoppers,Consumers researching high-end watch and jewelry brands.
Sporting Goods Shoppers,Consumers shopping for sporting goods and activewear apparel.
Furniture Shoppers,Consumers shopping for major home furnishings.
Bed & Bath Shoppers,Consumers shopping for bed and bath products.
Intimates Shoppers,Consumers shopping for lingerie.
Fast Fashion Shoppers,Consumers shopping for apparel that mimics current runway trends.
Apartment Hunters,People reading real estate rental listings.
Home Buyers,People reading real estate sales listings.
Moving Services Shoppers,Consumers who are shopping for moving services.
Job Seekers,People researching job boards.
Charitable Donors,People researching major charitable organizations.
NHL Fans,People reading articles and websites about hockey and the NHL.
Discount Big Box Shoppers,Consumers shopping at big box retailers.
Black Friday Deal Shoppers,Consumers researching holiday sales events.
Hip Hop Fans,People reading about hip hop music and hip hop stars.
Online Investors,Consumers with an active online trading account.
Seasonal Allergy Sufferers,People researching allergy trends and treatment options.
Discount Device Shoppers,Consumers shopping for discounted electronics.
Mobile Phone Comparison Shoppers,Consumers researching alternative mobile phones and wireless plans.
Budget Wireless Shoppers,Consumers researching discount wireless service plans.
Menopause Researchers,People researching menopause symptoms.
Online Health Researchers,People researching general health questions.
Beauty & Skincare Buyers,Consumers shopping for beauty and skincare products.
Streaming Device Shoppers,Consumers shopping for connected TV products.
New & Expecting Parents,People researching pregnancy issues and baby names.
High-End Kids Furniture and Clothes Shoppers,People shopping at high end childrens clothing and toy retailers.
Hands-On Parents,"People reading about family cooking, parenting advice and childrens activities."
Fantasy & Comic Fans,Consumers of online comics and fantasy novels.
Lawyers,People reading legal journals and industry publications.
Healthy Eaters,People researching healthy eating options.
Drug Store Shoppers,Consumers shopping online or searching for a local drug store.
Lawn & Garden Enthusiasts,Consumers reseraching lawn and garden maintenance techniques.
Nurses,People reading websites about nursing lifestyle and career advice.
Mailing & Shipping Shoppers,Consumers shopping for shipping supplies and postage.
Office Supply Shoppers,Individuals in-market for office supplies.
Ink & Toner Shoppers,Consumers shopping for printer ink.
Luxury Retail Shoppers,Consumers shopping for high end 
Query:
SELECT m."interest_name", m."created_at"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
ORDER BY m."created_at"
LIMIT 100
Answer:
interest_name,created_at
Business News Readers,2016-05-26 14:57:59
Gamers,2016-05-26 14:57:59
Vacation Planners,2016-05-26 14:57:59
NFL Fans,2016-05-26 14:57:59
Thrift Store Shoppers,2016-05-26 14:57:59
NBA Fans,2016-05-26 14:57:59
NCAA Fans,2016-05-26 14:57:59
Eco-Conscious Consumers,2016-05-26 14:57:59
MLB Fans,2016-05-26 14:57:59
Moviegoers,2016-05-26 14:57:59
Techies,2016-05-26 14:57:59
DIYers,2016-05-26 14:57:59
Home Design Enthusiasts,2016-05-26 14:57:59
Doctors,2016-05-26 14:57:59
Streaming Video Fans,2016-05-26 14:57:59
Auto Insurance Shoppers,2016-05-26 14:57:59
Teachers,2016-05-26 14:57:59
College Students,2016-05-26 14:57:59
Department Store Shoppers,2016-05-26 14:57:59
Home Decor Shoppers,2016-05-26 14:57:59
Kids Clothing Shoppers,2016-05-26 14:57:59
Baby Products Buyers,2016-05-26 14:57:59
Teen Girl Clothing Shoppers,2016-05-26 14:57:59
Jewelry & Watch Shoppers,2016-05-26 14:57:59
Sporting Goods Shoppers,2016-05-26 14:57:59
Intimates Shoppers,2016-05-26 14:57:59
Furniture Shoppers,2016-05-26 14:57:59
Fast Fashion Shoppers,2016-05-26 14:57:59
Apartment Hunters,2016-05-26 14:57:59
Home Buyers,2016-05-26 14:57:59
Moving Services Shoppers,2016-05-26 14:57:59
Job Seekers,2016-05-26 14:57:59
Charitable Donors,2016-05-26 14:57:59
NHL Fans,2016-05-26 14:57:59
Discount Big Box Shoppers,2016-05-26 14:57:59
Black Friday Deal Shoppers,2016-05-26 14:57:59
Hip Hop Fans,2016-05-26 14:57:59
Online Investors,2016-05-26 14:57:59
Seasonal Allergy Sufferers,2016-05-26 14:57:59
Discount Device Shoppers,2016-05-26 14:57:59
Mobile Phone Comparison Shoppers,2016-05-26 14:57:59
Budget Wireless Shoppers,2016-05-26 14:57:59
Menopause Researchers,2016-05-26 14:57:59
Online Health Researchers,2016-05-26 14:57:59
Beauty & Skincare Buyers,2016-05-26 14:57:59
Streaming Device Shoppers,2016-05-26 14:57:59
New & Expecting Parents,2016-05-26 14:57:59
High-End Kids Furniture and Clothes Shoppers,2016-05-26 14:57:59
Hands-On Parents,2016-05-26 14:57:59
Fantasy & Comic Fans,2016-05-26 14:57:59
Lawyers,2016-05-26 14:57:59
Lawn & Garden Enthusiasts,2016-05-26 14:57:59
Healthy Eaters,2016-05-26 14:57:59
Nurses,2016-05-26 14:57:59
Mailing & Shipping Shoppers,2016-05-26 14:57:59
Office Supply Shoppers,2016-05-26 14:57:59
Contractors & Construction Professionals,2016-05-26 14:57:59
Ink & Toner Shoppers,2016-05-26 14:57:59
Luxury Travel Researchers,2016-05-26 14:57:59
Democrats,2016-05-26 14:57:59
Republicans,2016-05-26 14:57:59
HDTV Researchers,2016-05-26 14:57:59
Hardware Shoppers,2016-05-26 14:57:59
Reggaeton Fans,2016-05-26 14:57:59
Online Movie Downloaders,2016-05-26 14:57:59
Sale Seekers,2016-05-26 14:57:59
Theme Park Researchers,2016-05-26 14:57:59
Ski and Snowboard Enthusiasts,2016-05-26 14:57:59
Travel Researchers,2016-05-26 14:57:59
Coupon Researchers,2016-05-26 14:57:59
Parents with Toddlers,2016-05-26 14:57:59
Parents with Kids,2016-05-26 14:57:59
Young Boomers,2016-05-26 14:57:59
Day Care Users,2016-05-26 14:57:59
Stay-at-Home Parents,2016-05-26 14:57:59
Exercise and Gym Researchers,2016-05-26 14:57:59
Home Kitchen Chefs,2016-05-26 14:57:59
Restaurant Researchers,2016-05-26 14:57:59
Order-in Eaters,2016-05-26 14:57:59
Nutrition Conscious Eaters,2016-05-26 14:57:59
Flower & Gift Basket Shoppers,2016-05-26 14:57:59
Plus Size Women,2016-05-26 14:57:59
Live Concert Fans,2016-05-26 14:57:59
Country Music Fans,2016-05-26 14:57:59
Comedy Fans,2016-05-26 14:57:59
Cruise Travel Intenders,2016-05-26 14:57:59
Pain Medication Users,2016-05-26 14:57:59
Joint Pain Sufferers,2016-05-26 14:57:59
Drug Store Shoppers,2016-05-26 14:57:59
Mens Clothing Shoppers,2016-05-26 14:57:59
Nascar Fans,2016-05-26 14:57:59
Motorcycle Enthusiasts,2016-05-26 14:57:59
Car Enthusiasts,2016-05-26 14:57:59
Fitness Enthusiasts,2016-05-26 14:57:59
Luxury Retail Shoppers,2016-05-26 14:57:59
Bed & Bath Shoppers,2016-05-26 14:57:59
Grill Masters,2016-05-26 14:57:59
Advertising Professionals,2016-05-26 14:57:59
Brides & Wedding Planners,2016-05-26 14:57:59
Luxury Retail Researchers,2016-05-26 14:57:59
Query:
SELECT im."_year", im."_month", im."index_value", m."interest_name"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
INNER JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
  ON im."interest_id" = m."id"
WHERE (im."_year" = 2018 AND im."_month" >= 9) OR (im."_year" = 2019 AND im."_month" <= 8)
ORDER BY im."_year", im."_month"
LIMIT 100
Answer:
_year,_month,index_value,interest_name
2018.0,9.0,2.49,Shoe Shoppers
2018.0,9.0,2.82,Competitive Tri-Athletes
2018.0,9.0,2.67,Preppy Clothing Shoppers
2018.0,9.0,2.34,Utility Workwear Shoppers
2018.0,9.0,2.46,Sporting Goods Shoppers
2018.0,9.0,2.31,Olympics Fans
2018.0,9.0,2.3,Apartment Furniture Shoppers
2018.0,9.0,2.28,Luxury Home Fixture Shoppers
2018.0,9.0,2.29,World Cup Enthusiasts
2018.0,9.0,2.28,World Cup Apparel Shoppers
2018.0,9.0,2.19,Vacation Rental Accommodation Researchers
2018.0,9.0,2.28,At-Home Gym Intenders
2018.0,9.0,2.19,Land Rover Shoppers
2018.0,9.0,2.17,Ski House Second Home Owners
2018.0,9.0,2.16,Big & Tall Men
2018.0,9.0,2.16,Sports Medicine Health Care Professionals
2018.0,9.0,2.15,Golf Enthusiasts
2018.0,9.0,2.14,March Madness Enthusiasts
2018.0,9.0,2.14,Trendy Denim Shoppers
2018.0,9.0,2.12,Kids Clothing Shoppers
2018.0,9.0,2.1,Luxury Boutique Hotel Researchers
2018.0,9.0,2.08,Kitchen Appliance Shoppers
2018.0,9.0,2.1,Parents of Teenagers Going to College
2018.0,9.0,2.07,Vacation Planners
2018.0,9.0,2.07,Urban Skateboarding Sneaker Shoppers
2018.0,9.0,2.03,Luxury Kitchen Goods Shoppers
2018.0,9.0,2.07,"Work Hard, Play Hard Travelers"
2018.0,9.0,2.03,Luggage Shoppers
2018.0,9.0,2.03,Luxury Bedding Shoppers
2018.0,9.0,2.01,MLB Fans
2018.0,9.0,1.99,North Carolina Football Fans
2018.0,9.0,1.99,Luxury Hotel Guests
2018.0,9.0,1.98,Womens Fashion Brands Shoppers
2018.0,9.0,1.98,Luxury Retail Shoppers
2018.0,9.0,1.97,Beach Supplies Shoppers
2018.0,9.0,1.97,Luxury Womens Brands Shoppers
2018.0,9.0,1.95,Luxury Travel Researchers
2018.0,9.0,1.95,Furniture Shoppers
2018.0,9.0,1.94,High-End Kids Furniture and Clothes Shoppers
2018.0,9.0,1.93,NHL Fans
2018.0,9.0,1.93,Special Olympics Fans
2018.0,9.0,1.93,Reusable Drinkware Shoppers
2018.0,9.0,1.91,NCAA Football Fans
2018.0,9.0,1.91,Online Grocery Shoppers
2018.0,9.0,1.88,Toronto Blue Jays Fans
2018.0,9.0,1.87,Major Airline Customers
2018.0,9.0,1.87,Online Home Decor Shoppers
2018.0,9.0,1.86,Ski and Snowboard Enthusiasts
2018.0,9.0,1.86,Japanese Luxury Car Enthusiasts
2018.0,9.0,1.86,Indoor Cycling & Spinning Enthusiasts
2018.0,9.0,1.86,Luxury Department Store Shoppers
2018.0,9.0,1.83,Flight and Hotel Shoppers
2018.0,9.0,1.84,Broadway Fans
2018.0,9.0,1.83,Yogis
2018.0,9.0,1.83,New York Trip Planners
2018.0,9.0,1.83,Boston Red Sox Fans
2018.0,9.0,1.82,College Aspirants
2018.0,9.0,1.83,Fishing Equipment Shoppers
2018.0,9.0,1.81,Affordable Hotel Bookers
2018.0,9.0,1.81,Sun Protection Shoppers
2018.0,9.0,1.8,Discount Device Shoppers
2018.0,9.0,1.79,Ecommerce Platform Researchers
2018.0,9.0,1.79,Mens Clothing Shoppers
2018.0,9.0,1.78,Hanukkah Decorations Shoppers
2018.0,9.0,1.77,Orthopedic Health Researchers
2018.0,9.0,1.77,Identity Theft Protection Researchers
2018.0,9.0,1.77,Restaurant Researchers
2018.0,9.0,1.75,Neurologists
2018.0,9.0,1.75,Kitchen and Bath Professionals
2018.0,9.0,1.75,Mens Health Researchers
2018.0,9.0,1.74,European Trip Planners
2018.0,9.0,1.74,France Trip Planners
2018.0,9.0,1.73,Getting Off the Grid Travelers
2018.0,9.0,1.73,Boston Trip Planners
2018.0,9.0,1.73,Tailgaters
2018.0,9.0,1.72,Tennis Players
2018.0,9.0,1.71,Surfers
2018.0,9.0,1.71,Portugal Trip Planners
2018.0,9.0,1.71,Boston Bruins Fans
2018.0,9.0,1.71,Yale University Fans
2018.0,9.0,1.7,Executive Travelers
2018.0,9.0,1.69,Democratic Donors
2018.0,9.0,1.68,Hardware Shoppers
2018.0,9.0,1.67,Pandora Jewelry Shoppers
2018.0,9.0,1.67,Avid Readers
2018.0,9.0,1.67,Healthcare Thought Leaders
2018.0,9.0,1.67,Online Alcohol Shoppers
2018.0,9.0,1.67,Kitchen and Home Goods Shoppers
2018.0,9.0,1.84,Price Conscious Home Shoppers
2018.0,9.0,2.09,Home Decor Shoppers
2018.0,9.0,2.28,NCAA Fans
2018.0,9.0,2.58,Luxury Retail Researchers
2018.0,9.0,2.76,Lacrosse Enthusiasts
2018.0,9.0,2.84,Running Enthusiasts
2018.0,9.0,1.82,Family Adventures Travelers
2018.0,9.0,2.04,Gym Equipment Owners
2018.0,9.0,2.2,Work Comes First Travelers
2018.0,9.0,2.36,Cycling Enthusiasts
2018.0,9.0,2.73,Competitive Sports Participants
2018.0,9.0,2.74,Mens Shoe Shoppers
Query:
SELECT im."_year", im."_month", im."interest_id", im."ranking", m."interest_name"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
INNER JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
  ON im."interest_id" = m."id"
WHERE im."ranking" <= 5
  AND ((im."_year" = 2018 AND im."_month" >= 9) OR (im."_year" = 2019 AND im."_month" <= 8))
ORDER BY im."interest_id", im."_year", im."_month"
LIMIT 100
Answer:
_year,_month,interest_id,ranking,interest_name
2018.0,12.0,4.0,5,Luxury Retail Researchers
2019.0,1.0,4.0,4,Luxury Retail Researchers
2019.0,2.0,4.0,3,Luxury Retail Researchers
2018.0,9.0,115.0,4,Mens Shoe Shoppers
2018.0,10.0,115.0,4,Mens Shoe Shoppers
2018.0,12.0,115.0,5,Mens Shoe Shoppers
2019.0,1.0,115.0,2,Mens Shoe Shoppers
2019.0,2.0,115.0,2,Mens Shoe Shoppers
2019.0,3.0,115.0,2,Mens Shoe Shoppers
2019.0,4.0,115.0,2,Mens Shoe Shoppers
2019.0,5.0,115.0,2,Mens Shoe Shoppers
2019.0,6.0,115.0,4,Mens Shoe Shoppers
2019.0,7.0,115.0,2,Mens Shoe Shoppers
2019.0,8.0,115.0,2,Mens Shoe Shoppers
2019.0,5.0,151.0,5,Big & Tall Men
2018.0,10.0,171.0,5,Shoe Shoppers
2018.0,11.0,171.0,4,Shoe Shoppers
2019.0,2.0,171.0,4,Shoe Shoppers
2019.0,5.0,171.0,5,Shoe Shoppers
2019.0,2.0,5970.0,5,Luxury Home Fixture Shoppers
2019.0,4.0,5970.0,3,Luxury Home Fixture Shoppers
2018.0,9.0,6013.0,5,Competitive Sports Participants
2018.0,10.0,6013.0,3,Competitive Sports Participants
2018.0,11.0,6013.0,3,Competitive Sports Participants
2019.0,3.0,6206.0,5,Preppy Clothing Shoppers
2019.0,6.0,6206.0,5,Preppy Clothing Shoppers
2019.0,7.0,6206.0,5,Preppy Clothing Shoppers
2019.0,8.0,6206.0,5,Preppy Clothing Shoppers
2018.0,9.0,6218.0,1,Running Enthusiasts
2018.0,10.0,6218.0,1,Running Enthusiasts
2018.0,11.0,6218.0,2,Running Enthusiasts
2018.0,12.0,6218.0,4,Running Enthusiasts
2018.0,11.0,6219.0,5,Cycling Enthusiasts
2018.0,9.0,6285.0,2,Competitive Tri-Athletes
2018.0,10.0,6285.0,2,Competitive Tri-Athletes
2018.0,11.0,6285.0,1,Competitive Tri-Athletes
2018.0,12.0,6285.0,3,Competitive Tri-Athletes
2019.0,1.0,6285.0,5,Competitive Tri-Athletes
2018.0,9.0,22502.0,3,Lacrosse Enthusiasts
2019.0,3.0,22502.0,3,Lacrosse Enthusiasts
2019.0,4.0,22502.0,4,Lacrosse Enthusiasts
2019.0,5.0,22502.0,3,Lacrosse Enthusiasts
2019.0,6.0,22502.0,2,Lacrosse Enthusiasts
2019.0,7.0,22502.0,3,Lacrosse Enthusiasts
2019.0,8.0,22502.0,3,Lacrosse Enthusiasts
2018.0,12.0,41548.0,1,Winter Apparel Shoppers
2019.0,1.0,41548.0,1,Winter Apparel Shoppers
2019.0,2.0,41548.0,1,Winter Apparel Shoppers
2019.0,3.0,41548.0,1,Winter Apparel Shoppers
2019.0,4.0,41548.0,1,Winter Apparel Shoppers
2019.0,5.0,41548.0,1,Winter Apparel Shoppers
2019.0,6.0,41548.0,1,Winter Apparel Shoppers
2019.0,7.0,41548.0,1,Winter Apparel Shoppers
2019.0,8.0,41548.0,1,Winter Apparel Shoppers
2018.0,12.0,42203.0,2,Fitness Activity Tracker Users
2019.0,1.0,42203.0,3,Fitness Activity Tracker Users
2019.0,3.0,42203.0,4,Fitness Activity Tracker Users
2019.0,4.0,42203.0,5,Fitness Activity Tracker Users
2019.0,5.0,42203.0,3,Fitness Activity Tracker Users
2019.0,6.0,42203.0,3,Fitness Activity Tracker Users
2019.0,7.0,42203.0,4,Fitness Activity Tracker Users
2019.0,8.0,42203.0,4,Fitness Activity Tracker Users
Query:
SELECT im."interest_id", MAX(im."composition") AS "max_composition", m."interest_name"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
INNER JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
  ON im."interest_id" = m."id"
GROUP BY im."interest_id", m."interest_name"
ORDER BY "max_composition" DESC
LIMIT 100
Answer:
interest_id,max_composition,interest_name
21057.0,21.2,Work Comes First Travelers
6284.0,18.82,Gym Equipment Owners
39.0,17.44,Furniture Shoppers
77.0,17.19,Luxury Retail Shoppers
12133.0,15.15,Luxury Boutique Hotel Researchers
5969.0,15.05,Luxury Bedding Shoppers
171.0,14.91,Shoe Shoppers
4898.0,14.23,Cosmetics and Beauty Shoppers
6286.0,14.1,Luxury Hotel Guests
4.0,13.97,Luxury Retail Researchers
17786.0,13.67,Womens Fashion Brands Shoppers
6184.0,13.35,Reusable Drinkware Shoppers
19298.0,13.03,Beach Supplies Shoppers
4897.0,12.93,Parents of Teenagers Going to College
5968.0,12.87,Luxury Kitchen Goods Shoppers
19613.0,12.62,Land Rover Shoppers
6.0,12.56,Vacation Planners
64.0,12.41,High-End Kids Furniture and Clothes Shoppers
22403.0,12.27,Pandora Jewelry Shoppers
19423.0,12.22,Kitchen Appliance Shoppers
10977.0,12.16,Christmas Celebration Researchers
158.0,11.97,Flight and Hotel Shoppers
32486.0,11.89,Vacation Rental Accommodation Researchers
6277.0,11.72,Harry Potter Fans
115.0,11.68,Mens Shoe Shoppers
5938.0,11.63,Costa Rica Trip Planners
6334.0,11.63,Supermarket Shoppers
19621.0,11.61,Portugal Trip Planners
6110.0,11.57,Apartment Furniture Shoppers
161.0,11.48,Travel Reward Points Enthusiasts
10250.0,11.4,Halloween Costume Shoppers
17730.0,11.38,Luxury Department Store Shoppers
34.0,11.23,Teen Girl Clothing Shoppers
79.0,11.21,Luxury Travel Researchers
5991.0,11.04,Gluten-Free Recipe Researchers
19757.0,10.95,Natural Pet Food Shoppers
133.0,10.91,High End Camera Shoppers - Dupe
40.0,10.86,Bed & Bath Shoppers
18923.0,10.85,Online Home Decor Shoppers
69.0,10.82,Healthy Eaters
5.0,10.82,Brides & Wedding Planners
6217.0,10.8,Weight Loss Researchers
100.0,10.77,Nutrition Conscious Eaters
6206.0,10.76,Preppy Clothing Shoppers
6111.0,10.71,Wine Lovers
4943.0,10.7,Online Grocery Shoppers
10981.0,10.62,New Years Eve Party Ticket Purchasers
5960.0,10.61,New Zealand Trip Planners
6343.0,10.54,Patio Furniture Shoppers
41548.0,10.46,Winter Apparel Shoppers
17314.0,10.43,Lobbyists
21237.0,10.36,Chelsea Fans
6344.0,10.32,Hair Care Shoppers
6324.0,10.3,Las Vegas Trip Planners
4870.0,10.29,Tech-Savvy Moms
5944.0,10.24,Financial Advisors
6228.0,10.22,Paleo Eaters
89.0,10.14,Travel Researchers
19422.0,10.11,Home Design and Living Publication Readers
6029.0,10.05,Indoor Cycling & Spinning Enthusiasts
82.0,9.99,HDTV Researchers
7541.0,9.98,Alabama Trip Planners
6285.0,9.97,Competitive Tri-Athletes
6232.0,9.97,Golf Enthusiasts
6106.0,9.93,Luxury Second Home Owners
18783.0,9.83,Nursing and Physicians Assistant Journal Researchers
92.0,9.77,Parents with Kids
6214.0,9.71,Home Remodelers
6208.0,9.67,Recently Retired Individuals
16137.0,9.65,Olympics Fans
6378.0,9.64,Luggage Shoppers
6123.0,9.49,Misc-Deal Seekers or Coupon Shoppers
38.0,9.48,Sporting Goods Shoppers
4895.0,9.47,Mature Parents
10008.0,9.46,Japanese Luxury Car Enthusiasts
4944.0,9.46,Pre-Measured Grocery Shoppers
141.0,9.46,Skin Care Researchers
63.0,9.37,New & Expecting Parents
6013.0,9.35,Competitive Sports Participants
6308.0,9.33,Food Safety Decision Makers
6218.0,9.29,Running Enthusiasts
36.0,9.27,Baby Products Buyers
6112.0,9.22,Olympic Sports Enthusiasts
5970.0,9.21,Luxury Home Fixture Shoppers
18619.0,9.15,Asian Food Enthusiasts
15935.0,9.13,Pregnancy Resources Researchers
13497.0,9.03,Restaurant Supply Shoppers
21061.0,8.97,"Work Hard, Play Hard Travelers"
10009.0,8.95,Investment Services Intenders
6107.0,8.84,Ski House Second Home Owners
16138.0,8.81,Special Olympics Fans
5911.0,8.69,Credit Score Researchers
60.0,8.66,Online Health Researchers
15879.0,8.65,Freelancers
17269.0,8.64,At-Home Gym Intenders
21060.0,8.58,Family Adventures Travelers
30.0,8.56,Department Store Shoppers
7425.0,8.54,Life Insurance Researchers
21058.0,8.5,Countdown to the Beach Travelers
6336.0,8.5,Mid-Range Grocery Shoppers
Query:
SELECT im."percentile_ranking", COUNT(*) AS "count"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
GROUP BY im."percentile_ranking"
ORDER BY im."percentile_ranking" DESC
LIMIT 100
Answer:
percentile_ranking,count
99.92,1
99.91,4
99.9,2
99.89,1
99.88,4
99.87,2
99.86,1
99.83,2
99.82,3
99.8,1
99.79,1
99.78,1
99.77,3
99.76,1
99.75,1
99.74,4
99.73,3
99.7,1
99.69,1
99.68,1
99.66,1
99.65,6
99.64,3
99.62,1
99.61,1
99.6,1
99.59,2
99.58,1
99.57,1
99.56,2
99.55,2
99.54,1
99.53,1
99.51,1
99.5,3
99.49,2
99.48,2
99.47,1
99.46,2
99.45,4
99.42,4
99.41,1
99.39,2
99.38,3
99.36,1
99.35,2
99.33,1
99.31,2
99.3,4
99.29,1
99.28,1
99.27,1
99.25,2
99.23,1
99.22,2
99.21,1
99.2,3
99.19,1
99.18,6
99.16,1
99.15,1
99.14,1
99.13,2
99.12,1
99.11,1
99.1,1
99.09,2
99.08,2
99.07,2
99.04,1
99.03,3
99.02,1
99.0,1
98.99,3
98.97,2
98.96,4
98.95,3
98.94,1
98.93,3
98.92,1
98.91,4
98.9,2
98.87,1
98.86,1
98.85,1
98.84,1
98.83,2
98.82,1
98.81,1
98.79,2
98.78,2
98.77,5
98.74,2
98.73,3
98.72,3
98.71,2
98.7,1
98.69,1
98.67,1
98.66,1
Query:
SELECT im."_year", im."_month", im."index_value", m."interest_name"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
INNER JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
  ON im."interest_id" = m."id"
WHERE im."_year" = 2019 AND im."_month" = 5
ORDER BY im."index_value" DESC
LIMIT 100
Answer:
_year,_month,index_value,interest_name
2019.0,5.0,3.96,Winter Apparel Shoppers
2019.0,5.0,3.13,Mens Shoe Shoppers
2019.0,5.0,3.08,Lacrosse Enthusiasts
2019.0,5.0,3.08,Fitness Activity Tracker Users
2019.0,5.0,3.0,Big & Tall Men
2019.0,5.0,3.0,Shoe Shoppers
2019.0,5.0,2.92,Elite Cycling Gear Shoppers
2019.0,5.0,2.92,Home Lending Researchers
2019.0,5.0,2.91,Vermont Trip Planners
2019.0,5.0,2.91,Competitive Tri-Athletes
2019.0,5.0,2.87,World Cup Enthusiasts
2019.0,5.0,2.86,Luxury Home Fixture Shoppers
2019.0,5.0,2.84,Softball Enthusiasts
2019.0,5.0,2.8,Swimming Enthusiasts
2019.0,5.0,2.8,Preppy Clothing Shoppers
2019.0,5.0,2.75,Beach Supplies Shoppers
2019.0,5.0,2.74,Sports Memorabilia Shoppers
2019.0,5.0,2.72,Aspen Skiers and Snowboarders
2019.0,5.0,2.71,Fishing Equipment Shoppers
2019.0,5.0,2.71,At-Home Gym Intenders
2019.0,5.0,2.69,Home Decor Shoppers
2019.0,5.0,2.68,High School Sports Researchers
2019.0,5.0,2.67,Utility Workwear Shoppers
2019.0,5.0,2.66,Golf Enthusiasts
2019.0,5.0,2.65,Luxury Boutique Hotel Researchers
2019.0,5.0,2.65,Sporting Goods Shoppers
2019.0,5.0,2.63,Ski and Snowboard Apparel Shoppers
2019.0,5.0,2.63,Home Rug Shoppers
2019.0,5.0,2.63,Home Goods Supercenter Shoppers
2019.0,5.0,2.62,Luxury Retail Researchers
2019.0,5.0,2.6,Rowing Enthusiasts
2019.0,5.0,2.6,Kids Clothing Shoppers
2019.0,5.0,2.57,Japanese Luxury Car Enthusiasts
2019.0,5.0,2.57,Volleyball Enthusiasts
2019.0,5.0,2.57,Vacation Planners
2019.0,5.0,2.55,Gym Equipment Owners
2019.0,5.0,2.55,Colorado Skiers and Snowboarders
2019.0,5.0,2.53,Luxury Kitchen Goods Shoppers
2019.0,5.0,2.53,Vacation Rental Accommodation Researchers
2019.0,5.0,2.52,Parents of Teenagers Going to College
2019.0,5.0,2.52,Luggage Shoppers
2019.0,5.0,2.5,Apartment Furniture Shoppers
2019.0,5.0,2.5,Ski House Second Home Owners
2019.0,5.0,2.5,Olympics Fans
2019.0,5.0,2.47,Luxury Hotel Guests
2019.0,5.0,2.47,Reusable Drinkware Shoppers
2019.0,5.0,2.45,Kitchen Appliance Shoppers
2019.0,5.0,2.44,Cycling Enthusiasts
2019.0,5.0,2.43,World Cup Apparel Shoppers
2019.0,5.0,2.43,Chandelier and Lamp Shoppers
2019.0,5.0,2.4,Flight and Hotel Shoppers
2019.0,5.0,2.4,High-End Kids Furniture and Clothes Shoppers
2019.0,5.0,2.39,Home Interior Design Enthusiasts
2019.0,5.0,2.38,Baseball Enthusiasts
2019.0,5.0,2.38,Embroidery Enthusiasts
2019.0,5.0,2.38,Canoeing and Kayaking Enthusiasts
2019.0,5.0,2.37,Sports Medicine Health Care Professionals
2019.0,5.0,2.37,Hanukkah Decorations Shoppers
2019.0,5.0,2.37,Trendy Denim Shoppers
2019.0,5.0,2.37,Competitive Sports Participants
2019.0,5.0,2.36,Kitchen Stove Shoppers
2019.0,5.0,2.36,Big East Fans
2019.0,5.0,2.36,Running Enthusiasts
2019.0,5.0,2.35,Affordable Hotel Bookers
2019.0,5.0,2.35,Land Rover Shoppers
2019.0,5.0,2.34,Home Printer Shoppers
2019.0,5.0,2.33,Patio Furniture Shoppers
2019.0,5.0,2.32,Urban Skateboarding Sneaker Shoppers
2019.0,5.0,2.32,Luxury Bedding Shoppers
2019.0,5.0,2.32,Cape Cod News Readers
2019.0,5.0,2.3,Western Canada Skiers and Snowboarders
2019.0,5.0,2.29,MLB Fans
2019.0,5.0,2.29,Promotional Products Purchasers
2019.0,5.0,2.29,Mens Business Clothes Shoppers
2019.0,5.0,2.28,Flooring Shoppers
2019.0,5.0,2.27,March Madness Enthusiasts
2019.0,5.0,2.26,Mens Underwear Shoppers
2019.0,5.0,2.26,Cleveland Indians Fans
2019.0,5.0,2.26,Online Alcohol Shoppers
2019.0,5.0,2.26,Cininnati Reds Fans
2019.0,5.0,2.25,Furniture Shoppers
2019.0,5.0,2.24,New York Trip Planners
2019.0,5.0,2.23,NCAA Fans
2019.0,5.0,2.22,Major Airline Customers
2019.0,5.0,2.22,North Carolina Football Fans
2019.0,5.0,2.21,Christmas Celebration Researchers
2019.0,5.0,2.21,Womens Fashion Brands Shoppers
2019.0,5.0,2.21,Department Store Shoppers
2019.0,5.0,2.2,NCAA Football Fans
2019.0,5.0,2.2,Price Conscious Home Shoppers
2019.0,5.0,2.2,Luxury Retail Shoppers
2019.0,5.0,2.2,Financial Advisors
2019.0,5.0,2.2,Luxury Womens Brands Shoppers
2019.0,5.0,2.2,Home Buyers
2019.0,5.0,2.19,Ballet Enthusiasts
2019.0,5.0,2.17,Identity Theft Protection Researchers
2019.0,5.0,2.16,Pandora Jewelry Shoppers
2019.0,5.0,2.16,NHL Fans
2019.0,5.0,2.15,Vitamin Shoppers
2019.0,5.0,2.15,Online Shoppers
Query:
SELECT m."id", m."interest_name", m."last_modified"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" m
ORDER BY m."last_modified" DESC
LIMIT 100
Answer:
Too long, hard cut:
id,interest_name,last_modified
6030,Spa and Pool Owners,2019-08-26 11:24:45
5913,Spa Goers,2019-08-26 11:24:44
6366,Rideshare App Users,2019-08-20 11:34:51
44457,New York City Fine Theatre Enthusiasts,2019-08-15 10:14:58
49502,Veterinarians,2019-07-09 13:57:13
51678,Plumbers,2019-05-07 18:50:04
51120,Foot Health Researchers,2019-04-29 14:20:04
51119,Skin Disorder Researchers,2019-04-29 14:20:04
50860,Food Delivery Service Users,2019-04-24 18:30:04
49975,Cattlemen and Pork Producers,2019-04-24 17:40:05
49976,Agriculture and Climate Advocates,2019-04-24 17:40:04
49974,Agricultural and Food Issues Researchers,2019-04-24 17:40:04
49978,Homeschooling Parents,2019-04-24 17:40:04
49972,Horseback Riding Enthusiasts,2019-04-24 17:40:04
49973,Farm Finance Researchers,2019-04-24 17:40:04
49977,DIY Upcycle Home Project Planners,2019-04-24 17:40:04
41085,Pittsburgh Pirates Fans,2019-04-22 13:23:52
49979,Cape Cod News Readers,2019-04-18 09:00:05
5999,Readers of African American Content,2019-04-17 08:49:16
44384,Action Figure and Collectibles Shoppers,2019-04-02 16:17:29
48465,HGTV Enthusiasts,2019-04-02 16:17:29
47789,Israel Trip Planners,2019-04-02 16:17:29
40427,Model Aircraft and Rocket Hobbyists,2019-03-29 14:26:28
48462,Self Storage Shoppers,2019-03-28 16:40:23
48459,Work Visa Researchers,2019-03-28 16:40:23
48463,PBS Enthusiasts,2019-03-28 16:40:22
48460,Online Payroll Services Users,2019-03-28 16:40:22
48154,Elite Cycling Gear Shoppers,2019-03-22 15:31:46
47850,Asheville Trip Planners,2019-03-21 15:33:09
48022,Sushi Lovers,2019-03-21 15:33:09
47713,High School Sports Researchers,2019-03-15 15:47:10
45678,Mens Underwear Shoppers,2019-03-12 13:05:06
44385,Sudoku Players,2019-03-12 12:57:18
44388,Board Game Enthusiasts,2019-03-12 12:57:18
47130,Home Lending Researchers,2019-03-11 12:36:24
45675,Home Medical Supplies Shoppers,2019-03-11 12:36:24
45673,Fundraising Advocates,2019-03-11 12:36:24
47115,Electric Vehicle Shoppers,2019-03-11 12:36:24
44580,Home Cleaning Researchers,2019-03-11 12:36:24
47065,Diabetes Support Forum Readers,2019-03-07 11:46:12
46567,Bigfoot Folklore Enthusiasts,2019-02-26 15:01:48
46566,Fertility Treatment Researchers,2019-02-26 15:01:48
46132,Counseling Researchers,2019-02-25 14:00:17
46134,Pontoon Boat Researchers,2019-02-25 14:00:17
19578,Sports Gamblers,2019-02-13 17:05:19
45725,Trampoline Shoppers,2019-02-12 10:52:31
45685,Cosmetic Surgery Intenders,2019-02-12 10:52:20
45676,Scrubs Uniforms Shoppers,2019-02-07 15:17:14
45677,Sleepwear Shoppers,2019-02-07 15:17:14
45679,Government Student Loan Researchers,2019-02-07 15:17:14
45674,Medical Technology News Readers,2019-02-07 15:17:13
45671,Mens Suit Shoppers,2019-02-07 15:17:13
45672,Bible Study Researchers,2019-02-07 15:17:13
45668,Pizza Lovers,2019-02-07 15:17:12
45670,Womens Swimsuit Shoppers,2019-02-07 15:17:12
45669,Cocktail Recipe Researchers,2019-02-07 15:17:12
45667,Blades and Hunting Knife Shoppers,2019-02-07 15:17:11
45666,Bird and Parrot Lovers,2019-02-07 15:17:11
45665,Reptile Enthusiasts,2019-02-07 15:17:11
45662,Psychiatrists,2019-02-07 15:17:10
45664,Headphone Shoppers,2019-02-07 15:17:10
45527,CBD Oils Shoppers,2019-02-06 16:21:50
45528,Cannabis News Readers,2019-02-06 16:21:50
45526,Dairy Industry New Readers,2019-02-06 16:21:49
45525,Cattle Industry New Readers,2019-02-06 16:21:49
45524,Mowing Equipment Shoppers,2019-02-06 16:21:49
45523,Welding Tools and Supplies Shoppers,2019-02-06 16:21:48
45522,Hair Color Shoppers,2019-02-06 16:21:48
45521,Rock Climbing Enthusiasts,2019-02-06 16:21:48
45518,Volleyball Enthusiasts,2019-02-06 16:21:47
45519,Competitive Wrestling Enthusiasts,2019-02-06 16:21:47
45520,Cricket Enthusiasts,2019-02-06 16:21:47
45515,US Judiciary System Researchers,2019-02-06 16:21:46
45516,Basketball Enthusiasts,2019-02-06 16:21:46
45517,Football Enthusiasts,2019-02-06 16:21:46
44390,Background Check Users,2019-02-06 16:21:45
44585,Ballet Enthusiasts,2019-02-06 16:21:45
44589,Brooklyn Nets Fans,2019-02-01 14:13:33
44588,Softball Enthusiasts,2019-02-01 14:13:14
44587,Baseball Enthusiasts,2019-02-01 14:13:05
44586,Opera Enthusiasts,2019-02-01 14:12:57
44584,Child Car Seat Researchers,2019-02-01 14:12:49
44583,Sustainable Lifestyle Enthusiasts,2019-02-01 14:12:40
44582,Spy Gadgets Shoppers,2019-02-01 14:12:30
44581,Darts Enthusiasts,2019-02-01 14:12:20
44579,Koi Pond Enthusiasts,2019-02-01 14:06:48
44391,Spanish Language Learners,2019-01-31 14:07:58
44389,Mahjong Players,2019-01-31 14:07:51
44387,Puzzle Enthusiasts,2019-01-31 14:07:45
44386,Crossword Puzzles Players,2019-01-31 14:07:37
44383,Guitar Music Researchers,2019-01-31 14:07:29
44382,Lyrics Researchers,2019-01-31 14:07:22
44381,Symphony Music Enthusiasts,2019-01-31 14:07:14
44380,Home Heating and Cooling Researchers,2019-01-31 14:07:07
44379,French Language Learners,2019-01-31 14:07:00
44378,Internet Speed Testers,2019-01-31 14:06:53
42368,Online Thesaurus Users,2019-01-31 13:50:37
42238,Online Calculator Users,2019-01-31 13:49:10
42239,ESPN Enthusiasts,20
Query:
SELECT im."_year", im."_month", COUNT(DISTINCT im."interest_id") AS "interest_count"
FROM "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
WHERE (im."_year" = 2018 AND im."_month" >= 9) OR (im."_year" = 2019 AND im."_month" <= 8)
GROUP BY im."_year", im."_month"
ORDER BY im."_year", im."_month"
LIMIT 100
Answer:
_year,_month,interest_count
2018.0,9.0,780
2018.0,10.0,857
2018.0,11.0,928
2018.0,12.0,995
2019.0,1.0,973
2019.0,2.0,1121
2019.0,3.0,1136
2019.0,4.0,1099
2019.0,5.0,857
2019.0,6.0,824
2019.0,7.0,864
2019.0,8.0,1149
End Exploring Related Columns
Task: Please review our interest data from September 2018 to August 2019. I need to know the max average composition value for each month, as well as the three-month rolling average. Ensure the output includes the date, the interest name, the max index composition for that month, the rolling average, and the top-ranking interests from the one month ago and two months ago with their names.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Date,Interest_Name,Max_Index_Composition,Rolling_Average,Top_Ranking_Interest_Minus1Month,Top_Ranking_Interest_Minus2Months
date1:str,interest_name1:str,max_comp_value1:float,rolling_avg1:float,interest_prev_month1:str,interest_prev_month2:str
date2:str,interest_name2:str,max_comp_value2:float,rolling_avg2:float,interest_prev_month1:str,interest_prev_month2:str
...
```

The table above shows, for each month from September 2018 to August 2019, the interest with the maximum average composition value, the maximum index composition for that month, the three-month rolling average of these maximum compositions, and the top-ranking interests from one month ago and two months ago with their names..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'BANK_SALES_TRADING': {'BANK_SALES_TRADING': ['BITCOIN_MEMBERS', 'BITCOIN_PRICES', 'BITCOIN_TRANSACTIONS', 'CLEANED_WEEKLY_SALES', 'CUSTOMER_NODES', 'CUSTOMER_REGIONS', 'CUSTOMER_TRANSACTIONS', 'INTEREST_MAP', 'INTEREST_METRICS', 'SHOPPING_CART_CAMPAIGN_IDENTIFIER', 'SHOPPING_CART_EVENTS', 'SHOPPING_CART_EVENT_IDENTIFIER', 'SHOPPING_CART_PAGE_HIERARCHY', 'SHOPPING_CART_USERS', 'VEG_CAT', 'VEG_LOSS_RATE_DF', 'VEG_TXN_DF', 'VEG_WHSLE_DF', 'WEEKLY_SALES']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-24 07:46:48 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 07:46:48 - root - INFO - ```sql
WITH Monthly_Compositions AS (
  SELECT
    im."_year",
    im."_month",
    im."interest_id",
    AVG(im."composition") AS "avg_composition"
  FROM
    "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
  WHERE
    (im."_year" = 2018 AND im."_month" >= 9)
    OR (im."_year" = 2019 AND im."_month" <= 8)
  GROUP BY
    im."_year",
    im."_month",
    im."interest_id"
),
Max_Compositions_Per_Month AS (
  SELECT
    mc.*,
    ROW_NUMBER() OVER (PARTITION BY mc."_year", mc."_month" ORDER BY mc."avg_composition" DESC) AS "rank"
  FROM
    Monthly_Compositions mc
),
Top_Interests_Per_Month AS (
  SELECT
    mpm."_year",
    mpm."_month",
    mpm."interest_id",
    mpm."avg_composition"
  FROM
    Max_Compositions_Per_Month mpm
  WHERE
    mpm."rank" = 1
),
Top_Interests_With_Names AS (
  SELECT
    tipm."_year",
    tipm."_month",
    tipm."interest_id",
    imap."interest_name",
    tipm."avg_composition"
  FROM
    Top_Interests_Per_Month tipm
    JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" imap
      ON tipm."interest_id" = imap."id"
),
Rolling_Averages AS (
  SELECT
    tipn.*,
    AVG(tipn."avg_composition") OVER (
      ORDER BY tipn."_year", tipn."_month"
      ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
    ) AS "Rolling_Average"
  FROM
    Top_Interests_With_Names tipn
),
Final_Output AS (
  SELECT
    ra.*,
    LAG(ra."interest_name", 1) OVER (ORDER BY ra."_year", ra."_month") AS "Top_Ranking_Interest_Minus1Month",
    LAG(ra."interest_name", 2) OVER (ORDER BY ra."_year", ra."_month") AS "Top_Ranking_Interest_Minus2Months"
  FROM
    Rolling_Averages ra
)
SELECT
  DATE_FROM_PARTS(fo."_year", fo."_month", 1) AS "Date",
  fo."interest_name" AS "Interest_Name",
  fo."avg_composition" AS "Max_Index_Composition",
  fo."Rolling_Average",
  fo."Top_Ranking_Interest_Minus1Month",
  fo."Top_Ranking_Interest_Minus2Months"
FROM
  Final_Output fo
ORDER BY
  fo."_year",
  fo."_month";
```
2025-01-24 07:46:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 07:46:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 07:46:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 07:46:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 12
2025-01-24 07:46:49 - snowflake.connector.connection - INFO - closed
2025-01-24 07:46:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 07:46:50 - root - INFO - itercount: 1
2025-01-24 07:46:50 - root - INFO - 0
2025-01-24 07:46:50 - root - INFO - results: 
Date,Interest_Name,Max_Index_Composition,Rolling_Average,Top_Ranking_Interest_Minus1Month,Top_Ranking_Interest_Minus2Months
2018-09-01,Work Comes First Travelers,18.18,18.18,,
2018-10-01,Work Comes First Travelers,20.28,19.23,Work Comes First Travelers,
2018-11-01,Work Comes First Travelers,19.45,19.30333333333333,Work Comes First Travelers,Work Comes First Travelers
2018-12-01,Work Comes First Travelers,21.2,20.31,Work Comes First Travelers,Work Comes First Travelers
2019-01-01,Work Comes First Travelers,18.99,19.88,Work Comes First Travelers,Work Comes First Travelers
2019-02-01,Work Comes First Travelers,18.39,19.526666666666667,Work Comes First Travelers,Work Comes First Travelers
2019-03-01,Luxury Boutique Hotel Researchers,12.64,16.673333333333332,Work Comes First Travelers,Work Comes First Travelers
2019-04-01,Luxury Bedding Shoppers,11.01,14.01333333333333,Luxury Boutique Hotel Researchers,Work Comes First Travelers
2019-05-01,Luxury Bedding Shoppers,7.53,10.39333333333333,Luxury Bedding Shoppers,Luxury Boutique Hotel Researchers
2019-06-01,Gym Equipment Owners,6.94,8.49333333333333,Luxury Bedding Shoppers,Luxury Bedding Shoppers
2019-07-01,Gym Equipment Owners,7.19,7.219999999999996,Gym Equipment Owners,Luxury Bedding Shoppers
2019-08-01,Gym Equipment Owners,7.1,7.0766666666666636,Gym Equipment Owners,Gym Equipment Owners


2025-01-24 07:46:50 - root - INFO - Please check the answer again by reviewing Please review our interest data from September 2018 to August 2019. I need to know the max average composition value for each month, as well as the three-month rolling average. Ensure the output includes the date, the interest name, the max index composition for that month, the rolling average, and the top-ranking interests from the one month ago and two months ago with their names., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Date,Interest_Name,Max_Index_Composition,Rolling_Average,Top_Ranking_Interest_Minus1Month,Top_Ranking_Interest_Minus2Months
date1:str,interest_name1:str,max_comp_value1:float,rolling_avg1:float,interest_prev_month1:str,interest_prev_month2:str
date2:str,interest_name2:str,max_comp_value2:float,rolling_avg2:float,interest_prev_month1:str,interest_prev_month2:str
...
```

The table above shows, for each month from September 2018 to August 2019, the interest with the maximum average composition value, the maximum index composition for that month, the three-month rolling average of these maximum compositions, and the top-ranking interests from one month ago and two months ago with their names. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Date,Interest_Name,Max_Index_Composition,Rolling_Average,Top_Ranking_Interest_Minus1Month,Top_Ranking_Interest_Minus2Months
2018-09-01,Work Comes First Travelers,18.18,18.18,,
2018-10-01,Work Comes First Travelers,20.28,19.23,Work Comes First Travelers,
2018-11-01,Work Comes First Travelers,19.45,19.30333333333333,Work Comes First Travelers,Work Comes First Travelers
2018-12-01,Work Comes First Travelers,21.2,20.31,Work Comes First Travelers,Work Comes First Travelers
2019-01-01,Work Comes First Travelers,18.99,19.88,Work Comes First Travelers,Work Comes First Travelers
2019-02-01,Work Comes First Travelers,18.39,19.526666666666667,Work Comes First Travelers,Work Comes First Travelers
2019-03-01,Luxury Boutique Hotel Researchers,12.64,16.673333333333332,Work Comes First Travelers,Work Comes First Travelers
2019-04-01,Luxury Bedding Shoppers,11.01,14.01333333333333,Luxury Boutique Hotel Researchers,Work Comes First Travelers
2019-05-01,Luxury Bedding Shoppers,7.53,10.39333333333333,Luxury Bedding Shoppers,Luxury Boutique Hotel Researchers
2019-06-01,Gym Equipment Owners,6.94,8.49333333333333,Luxury Bedding Shoppers,Luxury Bedding Shoppers
2019-07-01,Gym Equipment Owners,7.19,7.219999999999996,Gym Equipment Owners,Luxury Bedding Shoppers
2019-08-01,Gym Equipment Owners,7.1,7.0766666666666636,Gym Equipment Owners,Gym Equipment Owners
Current sql:
WITH Monthly_Compositions AS (
  SELECT
    im."_year",
    im."_month",
    im."interest_id",
    AVG(im."composition") AS "avg_composition"
  FROM
    "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
  WHERE
    (im."_year" = 2018 AND im."_month" >= 9)
    OR (im."_year" = 2019 AND im."_month" <= 8)
  GROUP BY
    im."_year",
    im."_month",
    im."interest_id"
),
Max_Compositions_Per_Month AS (
  SELECT
    mc.*,
    ROW_NUMBER() OVER (PARTITION BY mc."_year", mc."_month" ORDER BY mc."avg_composition" DESC) AS "rank"
  FROM
    Monthly_Compositions mc
),
Top_Interests_Per_Month AS (
  SELECT
    mpm."_year",
    mpm."_month",
    mpm."interest_id",
    mpm."avg_composition"
  FROM
    Max_Compositions_Per_Month mpm
  WHERE
    mpm."rank" = 1
),
Top_Interests_With_Names AS (
  SELECT
    tipm."_year",
    tipm."_month",
    tipm."interest_id",
    imap."interest_name",
    tipm."avg_composition"
  FROM
    Top_Interests_Per_Month tipm
    JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" imap
      ON tipm."interest_id" = imap."id"
),
Rolling_Averages AS (
  SELECT
    tipn.*,
    AVG(tipn."avg_composition") OVER (
      ORDER BY tipn."_year", tipn."_month"
      ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
    ) AS "Rolling_Average"
  FROM
    Top_Interests_With_Names tipn
),
Final_Output AS (
  SELECT
    ra.*,
    LAG(ra."interest_name", 1) OVER (ORDER BY ra."_year", ra."_month") AS "Top_Ranking_Interest_Minus1Month",
    LAG(ra."interest_name", 2) OVER (ORDER BY ra."_year", ra."_month") AS "Top_Ranking_Interest_Minus2Months"
  FROM
    Rolling_Averages ra
)
SELECT
  DATE_FROM_PARTS(fo."_year", fo."_month", 1) AS "Date",
  fo."interest_name" AS "Interest_Name",
  fo."avg_composition" AS "Max_Index_Composition",
  fo."Rolling_Average",
  fo."Top_Ranking_Interest_Minus1Month",
  fo."Top_Ranking_Interest_Minus2Months"
FROM
  Final_Output fo
ORDER BY
  fo."_year",
  fo."_month";For tasks asking fullname or name, you may combine first name and last name into one column called name.
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-24 07:47:49 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 07:47:49 - root - INFO - ```sql
WITH Monthly_Compositions AS (
  SELECT
    im."_year",
    im."_month",
    im."interest_id",
    AVG(im."composition") AS "avg_composition"
  FROM
    "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_METRICS" im
  WHERE
    (im."_year" = 2018 AND im."_month" >= 9)
    OR (im."_year" = 2019 AND im."_month" <= 8)
  GROUP BY
    im."_year",
    im."_month",
    im."interest_id"
),
Max_Compositions_Per_Month AS (
  SELECT
    mc.*,
    ROW_NUMBER() OVER (
      PARTITION BY mc."_year", mc."_month"
      ORDER BY mc."avg_composition" DESC
    ) AS "rank"
  FROM
    Monthly_Compositions mc
),
Top_Interests_Per_Month AS (
  SELECT
    mpm."_year",
    mpm."_month",
    mpm."interest_id",
    mpm."avg_composition"
  FROM
    Max_Compositions_Per_Month mpm
  WHERE
    mpm."rank" = 1
),
Top_Interests_With_Names AS (
  SELECT
    tipm."_year",
    tipm."_month",
    tipm."interest_id",
    imap."interest_name",
    tipm."avg_composition"
  FROM
    Top_Interests_Per_Month tipm
    JOIN "BANK_SALES_TRADING"."BANK_SALES_TRADING"."INTEREST_MAP" imap
      ON tipm."interest_id" = imap."id"
),
Rolling_Averages AS (
  SELECT
    tipn.*,
    AVG(tipn."avg_composition") OVER (
      ORDER BY tipn."_year", tipn."_month"
      ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
    ) AS "Rolling_Average"
  FROM
    Top_Interests_With_Names tipn
),
Final_Output AS (
  SELECT
    ra.*,
    LAG(ra."interest_name", 1) OVER (
      ORDER BY ra."_year", ra."_month"
    ) AS "Top_Ranking_Interest_Minus1Month",
    LAG(ra."interest_name", 2) OVER (
      ORDER BY ra."_year", ra."_month"
    ) AS "Top_Ranking_Interest_Minus2Months"
  FROM
    Rolling_Averages ra
)
SELECT
  DATE_FROM_PARTS(fo."_year", fo."_month", 1) AS "Date",
  fo."interest_name" AS "Interest_Name",
  ROUND(fo."avg_composition", 4) AS "Max_Index_Composition",
  ROUND(fo."Rolling_Average", 4) AS "Rolling_Average",
  fo."Top_Ranking_Interest_Minus1Month",
  fo."Top_Ranking_Interest_Minus2Months"
FROM
  Final_Output fo
ORDER BY
  fo."_year",
  fo."_month";
```
2025-01-24 07:47:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 07:47:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 07:47:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 07:47:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 12
2025-01-24 07:47:50 - snowflake.connector.connection - INFO - closed
2025-01-24 07:47:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 07:47:51 - root - INFO - itercount: 2
2025-01-24 07:47:51 - root - INFO - 0
2025-01-24 07:47:51 - root - INFO - Total iteration counts: 2
