2025-01-27 06:28:01 - openai._base_client - INFO - Retrying request to /chat/completions in 0.419163 seconds
2025-01-27 06:29:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 06:29:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:29:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:29:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:29:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 69
2025-01-27 06:29:09 - snowflake.connector.connection - INFO - closed
2025-01-27 06:29:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:29:09 - root - INFO - SQL:
SELECT DISTINCT "state_name"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   LIMIT 100;
Results:
state_name
Pennsylvania
District of Columbia
Indiana
Texas
California
South Carolina
New Jersey
New York
Minnesota
Ohio
Michigan
Colorado
Connecticut
Virginia
Wisconsin
Missouri
Nebraska
New Hampshire
Maryland
Arizona
West Virginia
Alabama
Illinois
Maine
Kentucky
Iowa
Wyoming
North Carolina
Florida
Oregon
Alaska
Tennessee
Ponce
Louisiana
Vermont
Arkansas
Guaynabo
San Juan
Cataño
New Mexico
Mississippi
Bayamón
Carolina
Aguadilla
Arecibo
Canóvanas
Baja California
Massachusetts
Delaware
Washington
Rhode Island
Georgia
Oklahoma
Utah
South Dakota
Idaho
Nevada
Toa Baja
Toa Alta
Mayagüez
Hormigueros
Dorado
Corozal
Moca
Montana
North Dakota
Trujillo Alto
Hawaii
Kansas

2025-01-27 06:29:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:29:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:29:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:29:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 69
2025-01-27 06:29:11 - snowflake.connector.connection - INFO - closed
2025-01-27 06:29:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:29:11 - root - INFO - SQL:
SELECT "state_name", SUM("count_qualified") AS "total_buildings_available"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   GROUP BY "state_name"
   LIMIT 100;
Results:
state_name,total_buildings_available
Pennsylvania,1954585
District of Columbia,76385
Indiana,1116413
Texas,5476777
California,8607224
South Carolina,907878
New Jersey,1629714
Maryland,705396
Ohio,2192109
Illinois,2052522
Colorado,1031389
Massachusetts,1000732
Maine,99960
Connecticut,607976
Virginia,963270
West Virginia,154869
Wisconsin,900028
Missouri,1031097
Washington,1510869
Rhode Island,202865
New Hampshire,107012
New York,2502541
Alabama,813312
Nebraska,283330
Kentucky,577255
North Carolina,1416043
Georgia,1502091
Oregon,772441
Oklahoma,700888
South Dakota,72847
San Juan,44665
New Mexico,365713
Mississippi,324867
Toa Baja,6976
Trujillo Alto,2854
Carolina,19237
Dorado,3064
Baja California,1
Minnesota,769481
Michigan,1846232
Delaware,147431
Montana,118654
Wyoming,53068
Kansas,417118
Florida,4814177
Alaska,57138
Tennessee,1102947
Ponce,18706
Louisiana,864431
Vermont,19504
Arkansas,369725
Guaynabo,12113
Idaho,311671
Nevada,569104
Cataño,2860
Bayamón,33260
Aguadilla,5844
Arecibo,4433
Hawaii,204227
Hormigueros,1194
Corozal,15
Moca,1
Arizona,1753531
Iowa,350073
Utah,572530
North Dakota,77117
Toa Alta,1123
Canóvanas,2182
Mayagüez,7348

2025-01-27 06:29:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:29:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:29:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:29:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 70
2025-01-27 06:29:12 - snowflake.connector.connection - INFO - closed
2025-01-27 06:29:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:29:13 - root - INFO - SQL:
SELECT "state_name", AVG("percent_covered") AS "average_percent_covered"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
   GROUP BY "state_name"
   LIMIT 100;
Results:
state_name,average_percent_covered
Pennsylvania,92.68306466974033
District of Columbia,85.3173154619042
New York,87.01654666423346
Delaware,85.27792503329306
Maryland,80.0363051672659
New Jersey,124.22007839679854
Virginia,90.98671520397548
Florida,99.63463369538297
Illinois,91.65385121185507
Indiana,102.884568973642
Louisiana,113.44943038082381
Michigan,96.3166332425792
New Hampshire,82.68678043934634
Arizona,109.64577014936981
California,93.2219977518554
Colorado,90.80594676965518
Georgia,96.55458334148544
Wisconsin,93.1936525385241
Alaska,83.1343291892894
Kansas,89.95113875826729
Nebraska,93.41757348883557
West Virginia,134.7040655714731
Kentucky,94.62267354085364
Maine,85.24301426648185
Missouri,89.17689216788044
South Dakota,82.78193284825554
Washington,102.21900785046996
Rhode Island,91.74013630607047
Mississippi,110.38685412641186
Oregon,92.07550262671663
San Juan,361.1600438845385
Oklahoma,90.58936275851072
Carolina,118.61155203088131
Trujillo Alto,2040.5624934431328
New Mexico,90.19310294856498
Toa Baja,108.02498418769798
Dorado,133.8421632605731
Loíza,85.48387096774194
Minnesota,90.42832750511015
South Carolina,95.47395975225123
Iowa,92.50237522834108
Ohio,100.1957983798897
Mayagüez,129.1771202642994
North Carolina,111.00378212601817
North Dakota,88.55661024596189
Connecticut,87.30600764926567
Massachusetts,87.21982464135493
Utah,93.12673983869175
Idaho,84.46661050804317
Nevada,98.16257499733608
Wyoming,75.8881197240555
Ponce,91.56236721318227
Aguadilla,95.93904539313895
Vermont,102.79805757806194
Alabama,118.15181543509537
Bayamón,98.86868696240633
Arkansas,94.08798696727425
Canóvanas,111.11231184290489
Cataño,1977.1135751398201
Guaynabo,111.26805227548675
Hawaii,92.40890122239371
Hormigueros,72.03823210284625
Arecibo,239.5516220035041
Hatillo,38.851761427901465
Cabo Rojo,5.0
Moca,0.8264462809917356
Texas,89.86343251034103
Tennessee,96.22961807019112
Montana,80.417314727058
Toa Alta,1710.7408116079803

2025-01-27 06:29:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:29:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:29:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:29:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 06:29:14 - snowflake.connector.connection - INFO - closed
2025-01-27 06:29:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:29:14 - root - INFO - SQL:
SELECT "region_name", "state_name", "percent_qualified"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   ORDER BY "percent_qualified" DESC
   LIMIT 100;
Results:
region_name,state_name,percent_qualified
80262,Colorado,100.0
68430,Nebraska,100.0
86011,Arizona,100.0
11252,New York,100.0
32887,Florida,100.0
23273,Virginia,100.0
60117,Illinois,100.0
21250,Maryland,100.0
14653,New York,100.0
73125,Oklahoma,100.0
46706,Indiana,100.0
76078,Texas,100.0
92132,California,100.0
07699,New Jersey,100.0
20722,Maryland,100.0
56393,Minnesota,100.0
19383,Pennsylvania,100.0
29409,South Carolina,100.0
70504,Louisiana,100.0
39595,Mississippi,100.0
35899,Alabama,100.0
74141,Oklahoma,100.0
83725,Idaho,100.0
72183,Arkansas,100.0
46118,Indiana,100.0
50012,Iowa,100.0
92249,California,100.0
57197,South Dakota,100.0
45750,Ohio,100.0
12222,New York,100.0
25306,West Virginia,100.0
99258,Washington,100.0
55020,Minnesota,100.0
80938,Colorado,100.0
13220,New York,100.0
48916,Michigan,100.0
07097,New Jersey,100.0
20748,Maryland,100.0
32511,Florida,100.0
47141,Indiana,100.0
20064,District of Columbia,100.0
38356,Tennessee,100.0
38132,Tennessee,100.0
78152,Texas,100.0
27110,North Carolina,100.0
75033,Texas,100.0
56563,Minnesota,100.0
28810,North Carolina,100.0
75799,Texas,100.0
66621,Kansas,100.0
11953,New York,100.0
24022,Virginia,100.0
23668,Virginia,100.0
79525,Texas,100.0
08544,New Jersey,100.0
98353,Washington,100.0
26506,West Virginia,100.0
17604,Pennsylvania,100.0
38166,Tennessee,100.0
50319,Iowa,100.0
95343,California,100.0
78150,Texas,100.0
63167,Missouri,100.0
32307,Florida,100.0
16565,Pennsylvania,100.0
36115,Alabama,100.0
10545,New York,100.0
30090,Georgia,100.0
76129,Texas,100.0
37310,Tennessee,100.0
37243,Tennessee,100.0
29217,South Carolina,100.0
25909,West Virginia,100.0
65216,Missouri,100.0
60173,Illinois,100.0
66050,Kansas,100.0
15082,Pennsylvania,100.0
99260,Washington,100.0
95381,California,100.0
77844,Texas,100.0
76574,Texas,100.0
50013,Iowa,100.0
77968,Texas,100.0
64170,Missouri,100.0
31999,Georgia,100.0
48436,Michigan,100.0
33321,Florida,100.0
33744,Florida,100.0
90073,California,100.0
45422,Ohio,100.0
79697,Texas,100.0
84132,Utah,100.0
84150,Utah,100.0
20418,District of Columbia,100.0
28228,North Carolina,100.0
76909,Texas,100.0
28394,North Carolina,100.0
73097,Oklahoma,100.0
78135,Texas,100.0
40041,Kentucky,100.0

2025-01-27 06:29:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:29:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:29:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:29:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 70
2025-01-27 06:29:16 - snowflake.connector.connection - INFO - closed
2025-01-27 06:29:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:29:16 - root - INFO - SQL:
SELECT "state_name", SUM("number_of_panels_total") AS "total_panel_count"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
   GROUP BY "state_name"
   LIMIT 100;
Results:
state_name,total_panel_count
Pennsylvania,133691622
District of Columbia,3983844
New York,158794563
Delaware,10771425
Maryland,47690643
New Jersey,117024321
Virginia,74914378
Florida,463123814
Illinois,164256874
Indiana,93311273
Louisiana,80308875
Michigan,147876313
New Hampshire,9054358
Arizona,147450436
California,654784266
Colorado,69425443
Georgia,140138439
Wisconsin,82459475
Alaska,5462549
Kansas,36827430
Nebraska,21582607
West Virginia,11387665
Kentucky,47393349
Maine,7720530
Missouri,84085928
South Dakota,6377373
Washington,107938035
Rhode Island,13001474
Mississippi,32218920
Oregon,61617355
San Juan,3375014
Oklahoma,60560124
Carolina,1554053
Trujillo Alto,197851
New Mexico,29605361
Toa Baja,362967
Dorado,199501
Loíza,1693
Minnesota,65662303
South Carolina,79312131
Iowa,29953011
Ohio,171901350
Mayagüez,567212
North Carolina,124233257
North Dakota,8138951
Connecticut,43575214
Massachusetts,69012277
Utah,44105531
Idaho,23093899
Nevada,43616656
Wyoming,3848056
Ponce,1165041
Aguadilla,432711
Vermont,2012472
Alabama,77644088
Bayamón,2134598
Arkansas,36012747
Canóvanas,139475
Cataño,168020
Guaynabo,984133
Hawaii,19873246
Hormigueros,59807
Arecibo,306604
Hatillo,25246
Cabo Rojo,668
Moca,28
Texas,481747719
Tennessee,101762224
Montana,9189162
Toa Alta,73394

2025-01-27 06:29:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:29:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:29:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:29:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 69
2025-01-27 06:29:17 - snowflake.connector.connection - INFO - closed
2025-01-27 06:29:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:29:18 - root - INFO - SQL:
SELECT "state_name", SUM("kw_total") AS "total_kw_capacity"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   GROUP BY "state_name"
   LIMIT 100;
Results:
state_name,total_kw_capacity
Pennsylvania,33251159.25
District of Columbia,984405.75
Indiana,23262116.25
Texas,120126382.5
California,163245792.0
South Carolina,19795985.0
New Jersey,29062474.25
New York,39464453.0
Minnesota,16366038.5
Ohio,42755588.25
Michigan,36847956.75
Colorado,17287707.0
Connecticut,10817473.0
Virginia,18683826.25
Wisconsin,20565986.75
Missouri,20954082.0
Nebraska,5373970.5
New Hampshire,2259352.25
Maryland,11890221.5
Arizona,36809602.0
West Virginia,2834139.75
Alabama,19324636.5
Illinois,40809249.25
Maine,1922317.75
Kentucky,11892554.0
Iowa,7477739.5
Wyoming,960816.75
North Carolina,30990744.25
Florida,115526433.0
Oregon,15377712.0
Alaska,1361806.25
Tennessee,25277072.25
Ponce,290701.5
Louisiana,20033662.5
Vermont,497191.0
Arkansas,8983466.75
Guaynabo,246735.75
San Juan,855785.75
Cataño,46577.75
New Mexico,7388077.0
Mississippi,8031754.25
Bayamón,524720.0
Carolina,370356.75
Aguadilla,108012.25
Arecibo,86303.5
Canóvanas,40117.75
Baja California,5.75
Massachusetts,17152331.0
Delaware,2685709.75
Washington,26939156.25
Rhode Island,3228525.0
Georgia,34913435.25
Oklahoma,15113975.5
Utah,10997189.0
South Dakota,1593092.75
Idaho,5756500.25
Nevada,10885004.0
Toa Baja,92763.0
Toa Alta,22168.75
Mayagüez,142803.0
Hormigueros,13652.0
Dorado,49813.5
Corozal,416.75
Moca,7.0
Montana,2295402.5
North Dakota,2032056.5
Trujillo Alto,49031.5
Hawaii,4958941.25
Kansas,9180990.0

2025-01-27 06:29:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:29:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:29:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:29:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 70
2025-01-27 06:29:19 - snowflake.connector.connection - INFO - closed
2025-01-27 06:29:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:29:19 - root - INFO - SQL:
SELECT "state_name", SUM("yearly_sunlight_kwh_total") AS "total_energy_potential_kwh"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
   GROUP BY "state_name"
   LIMIT 100;
Results:
state_name,total_energy_potential_kwh
Pennsylvania,38210009215.75753
District of Columbia,1209717858.796045
New York,45100394878.669464
Delaware,3222438352.7232113
Maryland,14399236326.491217
New Jersey,34132296027.414562
Virginia,23169044381.25027
Florida,157971622252.88788
Illinois,47344747566.82309
Indiana,26928123257.6459
Louisiana,25885642034.581642
Michigan,40976609871.52639
Minnesota,18673751434.616875
New Hampshire,2555251276.171985
Texas,160458070556.08868
Arizona,59127893265.42813
California,243304846869.2128
Colorado,24667013678.519062
Mayagüez,202552659.3214233
Georgia,44737933517.87483
South Carolina,25692275291.33939
Iowa,8843145869.399496
Tennessee,31169276299.068554
Wisconsin,23542559983.903282
Alaska,1092118868.9737976
Kansas,11882464352.008951
Nebraska,6725165429.183444
West Virginia,3272165883.9079347
Kentucky,14048103923.893398
Connecticut,12438466928.172298
Idaho,7526956885.239657
Nevada,17236108170.27167
Wyoming,1302268164.5376706
Oregon,16514535968.386444
Mississippi,10408673466.612555
Aguadilla,160079112.7508179
Vermont,551942863.0689392
Carolina,553262399.3939757
Alabama,24759196398.25475
Bayamón,751085531.8753113
Arkansas,11362387314.959013
Canóvanas,49976173.3744995
Cataño,59578578.59686889
Guaynabo,342005084.6763794
New Mexico,12208818476.493713
Arecibo,110110577.36539914
Cabo Rojo,236279.58453979492
Ohio,48300160986.35466
North Carolina,39607264848.0049
Maine,2197957054.097583
Missouri,26123174340.937077
Massachusetts,19514148116.75344
North Dakota,2299032486.195364
South Dakota,1966083346.8824432
Utah,15249940379.663124
Rhode Island,3726814813.7138762
Ponce,385731295.9626892
San Juan,1177674698.0644774
Oklahoma,20218586198.69937
Toa Baja,128650286.23981933
Hormigueros,21266625.235290524
Dorado,70542741.78618774
Hatillo,9067192.223126221
Loíza,595043.1626098631
Moca,8580.857080078125
Montana,2711943864.901141
Washington,27475803851.394146
Toa Alta,25725431.5722229
Trujillo Alto,69008952.58372192
Hawaii,7415195492.54585

2025-01-27 06:29:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:29:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:29:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:29:21 - snowflake.connector.cursor - INFO - Number of results in first chunk: 69
2025-01-27 06:29:21 - snowflake.connector.connection - INFO - closed
2025-01-27 06:29:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:29:21 - root - INFO - SQL:
SELECT "state_name", SUM("carbon_offset_metric_tons") AS "total_carbon_offset"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   GROUP BY "state_name"
   LIMIT 100;
Results:
state_name,total_carbon_offset
Pennsylvania,25546821.485438112
District of Columbia,759829.5491657511
Indiana,22222230.940975703
Texas,79820466.39724964
California,66878632.22406632
South Carolina,15057615.542086853
New Jersey,21299363.239696037
New York,21798509.3083663
Minnesota,9432736.4318702
Ohio,39776810.4632109
Michigan,32063411.389291123
Colorado,14960304.146578383
Connecticut,5347366.443614538
Virginia,14534537.81879123
Wisconsin,18493486.25400976
Missouri,20922455.46777513
Nebraska,3393835.347755131
New Hampshire,1104316.148032614
Maryland,9317029.141011486
Arizona,25357559.299180172
West Virginia,2696642.54367634
Alabama,15723425.934489228
Illinois,38776748.30638688
Maine,947591.4564713892
Kentucky,10935523.832197247
Iowa,4474350.521690872
Wyoming,399141.77153828304
North Carolina,23311951.92699679
Florida,84572912.49373843
Oregon,4384028.977048002
Alaska,448709.5001029908
Tennessee,23508638.5761802
Ponce,258970.92094872272
Louisiana,16083222.605670767
Vermont,236132.86981235372
Arkansas,7146339.221664687
Guaynabo,230594.4901825723
San Juan,804284.1778948521
Cataño,44405.254583877424
New Mexico,5184507.904926238
Mississippi,6657377.0431828415
Bayamón,497071.83661161206
Carolina,354839.38441194326
Aguadilla,107574.99307295939
Arecibo,83422.88329775061
Canóvanas,38726.67058507054
Baja California,0.0
Massachusetts,8399385.428188125
Delaware,2042260.7933182444
Washington,7293347.185103217
Rhode Island,1602800.1897457635
Georgia,26673519.941978436
Oklahoma,13653148.546175597
Utah,4044369.724602101
South Dakota,1047147.0385288498
Idaho,1995437.83571835
Nevada,6541464.54058874
Toa Baja,88532.11963429808
Toa Alta,21050.91074946186
Mayagüez,137284.59180836374
Hormigueros,13057.408935665711
Dorado,47415.8990148845
Corozal,395.7097278391667
Moca,5.774905113871622
Montana,720554.5926224514
North Dakota,1163339.1647784072
Trujillo Alto,46041.3645230469
Hawaii,4657525.910539113
Kansas,8225046.27693307

2025-01-27 06:29:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:29:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:29:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:29:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 70
2025-01-27 06:29:22 - snowflake.connector.connection - INFO - closed
2025-01-27 06:29:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:29:23 - root - INFO - SQL:
SELECT 
     "state_name", 
     SUM("count_qualified") AS "total_count_qualified",
     SUM("existing_installs_count") AS "total_existing_installs",
     (SUM("count_qualified") - SUM("existing_installs_count")) AS "gap_in_potential_installations"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
   GROUP BY "state_name"
   LIMIT 100;
Results:
state_name,total_count_qualified,total_existing_installs,gap_in_potential_installations
Pennsylvania,1956097,4408,1951689
District of Columbia,76464,442,76022
New York,2506035,18795,2487240
Delaware,147535,88,147447
Maryland,705813,6071,699742
New Jersey,1632773,12655,1620118
Virginia,963792,2409,961383
Florida,4817871,105364,4712507
Illinois,2055456,2453,2053003
Indiana,1117000,988,1116012
Louisiana,865003,8223,856780
Michigan,1847255,1720,1845535
New Hampshire,107103,262,106841
Arizona,1754534,39726,1714808
California,8617901,331818,8286083
Colorado,1032067,24362,1007705
Georgia,1503687,1907,1501780
Wisconsin,900707,1914,898793
Alaska,57169,83,57086
Kansas,417333,738,416595
Nebraska,283467,210,283257
West Virginia,155047,80,154967
Kentucky,575985,723,575262
Maine,100065,360,99705
Missouri,1032104,2864,1029240
South Dakota,72867,21,72846
Washington,1511814,5759,1506055
Rhode Island,203167,371,202796
Mississippi,325095,356,324739
Oregon,773130,8653,764477
San Juan,44341,0,44341
Oklahoma,701280,802,700478
Carolina,19688,0,19688
Trujillo Alto,2873,0,2873
New Mexico,365962,3749,362213
Toa Baja,6517,0,6517
Dorado,3067,0,3067
Loíza,40,0,40
Minnesota,770077,1518,768559
South Carolina,908394,1266,907128
Iowa,350284,248,350036
Ohio,2194900,2845,2192055
Mayagüez,7284,0,7284
North Carolina,1416843,2911,1413932
North Dakota,77129,24,77105
Connecticut,608869,5284,603585
Massachusetts,1002203,15369,986834
Utah,573155,3166,569989
Idaho,311878,529,311349
Nevada,569461,12746,556715
Wyoming,53090,29,53061
Ponce,18091,0,18091
Aguadilla,5852,0,5852
Vermont,19530,131,19399
Alabama,814213,547,813666
Bayamón,33466,0,33466
Arkansas,370016,239,369777
Canóvanas,2099,0,2099
Cataño,2764,0,2764
Guaynabo,11603,0,11603
Hawaii,204390,25392,178998
Hormigueros,1264,0,1264
Arecibo,3962,0,3962
Hatillo,224,0,224
Cabo Rojo,2,0,2
Moca,1,0,1
Texas,5480573,14139,5466434
Tennessee,1105463,1312,1104151
Montana,118683,262,118421
Toa Alta,1345,0,1345

2025-01-27 06:29:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:29:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:29:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:29:24 - snowflake.connector.connection - INFO - closed
2025-01-27 06:29:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:29:55 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 06:29:55 - root - INFO - The error message you received indicates that your SQL execution environment expects only one statement per execution. In your input, you have two `SELECT` statements, which the system cannot process together in a single run.

**Error Explanation:**

```
Actual statement count 2 did not match the desired statement count 1.
```

This error occurs because the SQL environment does not support multiple statements in a single execution batch. To fix this, you can either execute each statement separately or combine them into a single query.

---

**Solution: Combine Queries Using `UNION ALL`**

You can combine the two queries into a single query using the `UNION ALL` operator. Here's the modified SQL:

```sql
SELECT 
  'Postal Code' AS "Level",
  "state_name", 
  AVG("percent_qualified") AS "average_percent_qualified"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
GROUP BY "state_name"

UNION ALL

SELECT 
  'Census Tract' AS "Level",
  "state_name", 
  AVG("percent_qualified") AS "average_percent_qualified"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
GROUP BY "state_name"
LIMIT 100;
```

**Notes:**

- **Removing Individual `LIMIT 100`:** When combining queries with `UNION ALL`, it's important to apply the `LIMIT` clause correctly. Placing `LIMIT 100` at the end of each subquery may limit each individual result set, but the final output might still exceed 100 rows after the union. By placing `LIMIT 100` at the end, it limits the total number of rows returned by the combined query.

---

**Alternative: Execute Queries Separately**

If combining the queries isn't suitable for your needs, you can execute each `SELECT` statement separately:

1. **First Query:**

   ```sql
   SELECT 
     'Postal Code' AS "Level",
     "state_name", 
     AVG("percent_qualified") AS "average_percent_qualified"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   GROUP BY "state_name"
   LIMIT 100;
   ```

2. **Second Query:**

   ```sql
   SELECT 
     'Census Tract' AS "Level",
     "state_name", 
     AVG("percent_qualified") AS "average_percent_qualified"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
   GROUP BY "state_name"
   LIMIT 100;
   ```

---

**Explanation:**

- **Cause of Error:** The SQL environment restricts execution to a single statement at a time. Submitting multiple statements without proper separation or combination leads to the error.
- **Combining with `UNION ALL`:** Using `UNION ALL` combines the results of both queries into a single result set, which is acceptable as one statement.
- **Limitation with `LIMIT`:** Applying `LIMIT` at the end ensures that the total number of rows returned does not exceed your desired count.

---

**Final Combined Query Example:**

Here's the complete combined query without individual `LIMIT` clauses:

```sql
SELECT 
  'Postal Code' AS "Level",
  "state_name", 
  AVG("percent_qualified") AS "average_percent_qualified"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
GROUP BY "state_name"

UNION ALL

SELECT 
  'Census Tract' AS "Level",
  "state_name", 
  AVG("percent_qualified") AS "average_percent_qualified"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
GROUP BY "state_name"

ORDER BY "state_name", "Level"
LIMIT 100;
```

**Optional Improvements:**

- **Ordering Results:** Adding an `ORDER BY` clause can help organize the results, making comparisons between levels clearer.
- **Aggregating Data:** If you want to see both levels side by side for each state, consider using a `JOIN` or pivot table approach. However, this would require more complex SQL and may not be necessary for your current task.

---

By adjusting your SQL query as suggested, you should be able to execute it without encountering the error and obtain the desired comparison of solar potential at both postal code and census tract levels for each state.
2025-01-27 06:29:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:29:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:29:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:29:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 06:29:56 - snowflake.connector.connection - INFO - closed
2025-01-27 06:29:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:30:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 06:30:39 - root - INFO - SQL:
SELECT 
  'Postal Code' AS "Level",
  "state_name", 
  AVG("percent_qualified") AS "average_percent_qualified"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
GROUP BY "state_name"

UNION ALL

SELECT 
  'Census Tract' AS "Level",
  "state_name", 
  AVG("percent_qualified") AS "average_percent_qualified"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
GROUP BY "state_name"
LIMIT 100;
Results:
Level,state_name,average_percent_qualified
Postal Code,Pennsylvania,79.50152162654109
Postal Code,District of Columbia,75.11488176242611
Postal Code,Indiana,80.98704273615954
Postal Code,Texas,89.34929795432053
Postal Code,California,88.4105249868377
Postal Code,South Carolina,80.08563002130781
Postal Code,New Jersey,76.2982184524033
Postal Code,Maryland,78.2143673837333
Postal Code,Ohio,82.39723759334927
Postal Code,Illinois,81.22551550568912
Postal Code,Colorado,83.07765032579091
Postal Code,Massachusetts,73.94909266069027
Postal Code,Maine,63.63666881149767
Postal Code,Connecticut,72.29881131803253
Postal Code,Virginia,77.44664178774818
Postal Code,West Virginia,82.71154300892732
Postal Code,Wisconsin,80.06679188975762
Postal Code,Missouri,82.55774214780111
Postal Code,Washington,84.03996306007777
Postal Code,Rhode Island,75.47806245993253
Postal Code,New Hampshire,68.14373199300624
Postal Code,New York,77.40818366695984
Postal Code,Alabama,81.88299169012126
Postal Code,Nebraska,86.8810104386528
Postal Code,Kentucky,86.85440770148307
Postal Code,North Carolina,76.831511026237
Postal Code,Georgia,76.48404856671779
Postal Code,Oregon,85.56283254708075
Postal Code,Oklahoma,90.6883086147428
Postal Code,South Dakota,76.16484077656688
Postal Code,San Juan,91.33009202920341
Postal Code,New Mexico,90.66469204457194
Postal Code,Mississippi,82.19166818603286
Postal Code,Toa Baja,89.3900563813429
Postal Code,Trujillo Alto,88.81837244579282
Postal Code,Carolina,93.41220105410265
Postal Code,Dorado,93.84379785604901
Postal Code,Baja California,20.0
Postal Code,Minnesota,72.02677785988112
Postal Code,Michigan,79.04143589637175
Postal Code,Delaware,79.87848539811428
Postal Code,Montana,74.89138821125225
Postal Code,Wyoming,78.76528710918183
Postal Code,Kansas,83.90980882904063
Postal Code,Florida,90.85016886522146
Postal Code,Alaska,78.00984454758942
Postal Code,Tennessee,83.65948527656543
Postal Code,Ponce,91.44872619683593
Postal Code,Louisiana,85.77600943642517
Postal Code,Vermont,79.5994775409519
Postal Code,Arkansas,80.53295880502695
Postal Code,Guaynabo,88.43952681035891
Postal Code,Idaho,85.81752126830317
Postal Code,Nevada,92.41557021018671
Postal Code,Cataño,91.19644888529244
Postal Code,Bayamón,91.28405960797262
Postal Code,Aguadilla,94.31143379125443
Postal Code,Arecibo,93.40742399641678
Postal Code,Hawaii,94.93133340007105
Postal Code,Hormigueros,91.84615384615384
Postal Code,Corozal,93.75
Postal Code,Moca,100.0
Postal Code,Arizona,93.81479777093914
Postal Code,Iowa,78.45999338382977
Postal Code,Utah,85.93581601402273
Postal Code,North Dakota,80.68802648949998
Postal Code,Toa Alta,89.33969769291966
Postal Code,Canóvanas,89.42622950819673
Postal Code,Mayagüez,91.3667202708606
Census Tract,Pennsylvania,68.85707992410286
Census Tract,District of Columbia,63.397058540850374
Census Tract,New York,70.3824007333638
Census Tract,Delaware,71.13500821025055
Census Tract,Maryland,69.81305560602681
Census Tract,New Jersey,72.49284036555349
Census Tract,Virginia,70.29803660202286
Census Tract,Florida,83.27936582037172
Census Tract,Illinois,75.0703988032207
Census Tract,Indiana,74.4162992494216
Census Tract,Louisiana,82.17435382731469
Census Tract,Michigan,72.87447311567932
Census Tract,New Hampshire,67.9415712418198
Census Tract,South Carolina,73.39684628969717
Census Tract,Arizona,90.40516782276116
Census Tract,California,84.42610938177201
Census Tract,Colorado,80.52159958927903
Census Tract,Iowa,67.55135102465916
Census Tract,Ohio,76.22748275975313
Census Tract,Georgia,68.60191456870614
Census Tract,Texas,83.60340471279187
Census Tract,Mayagüez,88.31524322675783
Census Tract,Tennessee,76.27267213792194
Census Tract,Wisconsin,74.55363214741563
Census Tract,Kansas,74.45838191092518
Census Tract,Maine,65.17547802899195
Census Tract,Nebraska,80.62010526352871
Census Tract,West Virginia,71.8114182883734
Census Tract,Missouri,76.3366899845083
Census Tract,Montana,72.27714051202193
Census Tract,South Dakota,73.1301178566635

2025-01-27 06:30:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:30:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:30:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:30:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 06:30:40 - snowflake.connector.connection - INFO - closed
2025-01-27 06:30:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:30:41 - root - INFO - SQL:
SELECT 
  "region_name", 
  "state_name", 
  "count_qualified", 
  "existing_installs_count",
  ("count_qualified" - "existing_installs_count") AS "gap_in_potential_installations"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
LIMIT 100
Results:
region_name,state_name,count_qualified,existing_installs_count,gap_in_potential_installations
19149,Pennsylvania,4602,3,4599
19120,Pennsylvania,6086,2,6084
19132,Pennsylvania,5157,0,5157
19134,Pennsylvania,7551,3,7548
19138,Pennsylvania,4256,3,4253
19143,Pennsylvania,7093,10,7083
19148,Pennsylvania,7885,2,7883
19131,Pennsylvania,4590,6,4584
19133,Pennsylvania,3545,2,3543
19139,Pennsylvania,4874,2,4872
19140,Pennsylvania,6871,2,6869
19141,Pennsylvania,3528,4,3524
19142,Pennsylvania,2701,12,2689
19145,Pennsylvania,6147,11,6136
19146,Pennsylvania,6749,1,6748
19150,Pennsylvania,3872,11,3861
19151,Pennsylvania,3518,4,3514
19125,Pennsylvania,4917,7,4910
19135,Pennsylvania,4824,10,4814
19147,Pennsylvania,6785,5,6780
20002,District of Columbia,6154,9,6145
20003,District of Columbia,1946,3,1943
46704,Indiana,23,0,23
75371,Texas,20,0,20
92386,California,172,0,172
15629,Pennsylvania,141,0,141
19023,Pennsylvania,3413,8,3405
19121,Pennsylvania,5961,2,5959
19124,Pennsylvania,7649,5,7644
19126,Pennsylvania,2172,5,2167
19144,Pennsylvania,6860,7,6853
20001,District of Columbia,3636,2,3634
29920,South Carolina,15,0,15
08104,New Jersey,3698,10,3688
12512,New York,16,0,16
19082,Pennsylvania,5331,7,5324
19119,Pennsylvania,4821,20,4801
19127,Pennsylvania,1830,3,1827
19130,Pennsylvania,3810,5,3805
19604,Pennsylvania,4723,3,4720
20010,District of Columbia,3021,8,3013
20011,District of Columbia,10516,36,10480
46393,Indiana,22,0,22
55417,Minnesota,4881,30,4851
08102,New Jersey,1005,1,1004
08103,New Jersey,2518,3,2515
08611,New Jersey,4735,4,4731
11215,New York,5972,10,5962
11233,New York,5046,2,5044
11379,New York,6142,1,6141
11419,New York,5702,4,5698
11428,New York,3702,2,3700
11451,New York,12,0,12
15224,Pennsylvania,2804,5,2799
17019,Pennsylvania,15,0,15
19122,Pennsylvania,2899,7,2892
19129,Pennsylvania,1621,5,1616
19602,Pennsylvania,2941,3,2938
20009,District of Columbia,3251,10,3241
21239,Maryland,6831,6,6825
55412,Minnesota,4693,14,4679
55805,Minnesota,2272,0,2272
55807,Minnesota,3931,0,3931
07756,New Jersey,1150,0,1150
11105,New York,3809,5,3804
11216,New York,4016,0,4016
11217,New York,2862,0,2862
11370,New York,2925,0,2925
11412,New York,6617,5,6612
11417,New York,4160,5,4155
11421,New York,4388,0,4388
11436,New York,2971,1,2970
11802,New York,13,0,13
14619,New York,3363,1,3362
15110,Pennsylvania,2079,4,2075
15203,Pennsylvania,3075,3,3072
15208,Pennsylvania,2766,8,2758
15210,Pennsylvania,7989,6,7983
18102,Pennsylvania,8980,2,8978
19079,Pennsylvania,1944,3,1941
19104,Pennsylvania,4612,15,4597
19601,Pennsylvania,6056,3,6053
20007,District of Columbia,4317,15,4302
20017,District of Columbia,3848,15,3833
20782,Maryland,351,2,349
21229,Maryland,12459,2,12457
21230,Maryland,11451,8,11443
35043,Alabama,8,0,8
43608,Ohio,5648,0,5648
43610,Ohio,1479,0,1479
44123,Ohio,4808,11,4797
45147,Ohio,9,0,9
48146,Michigan,13114,0,13114
48223,Michigan,5378,0,5378
48224,Michigan,12218,7,12211
48227,Michigan,12513,2,12511
48915,Michigan,2654,3,2651
49507,Michigan,7778,11,7767
55104,Minnesota,6959,33,6926
55406,Minnesota,6992,39,6953

2025-01-27 06:30:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:30:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:30:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:30:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 70
2025-01-27 06:30:42 - snowflake.connector.connection - INFO - closed
2025-01-27 06:30:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:30:43 - root - INFO - SQL:
SELECT "state_name", MEDIAN("number_of_panels_median") AS "median_number_of_panels"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
GROUP BY "state_name"
LIMIT 100
Results:
state_name,median_number_of_panels
Connecticut,31.000
Alabama,47.000
Louisiana,53.000
Cataño,30.000
Michigan,35.000
Missouri,38.000
New Mexico,54.000
Hatillo,64.500
Guaynabo,48.500
Arkansas,48.000
Hawaii,68.000
Hormigueros,41.000
Arecibo,45.000
Nebraska,36.000
Dorado,43.000
Illinois,31.000
Idaho,46.000
Alaska,39.000
San Juan,44.000
Kentucky,41.000
Trujillo Alto,41.500
Maine,27.000
West Virginia,36.000
Arizona,59.000
Washington,41.000
Montana,39.000
Bayamón,46.000
South Dakota,38.000
California,47.000
Kansas,38.000
Delaware,33.000
Pennsylvania,28.000
Oklahoma,53.000
Maryland,29.000
Carolina,52.000
Ohio,35.000
Wyoming,36.000
North Dakota,45.000
Iowa,33.000
Utah,43.000
Colorado,35.000
Oregon,46.000
Toa Baja,39.000
Moca,28.000
Vermont,30.500
Mississippi,51.000
Cabo Rojo,79.000
New York,28.000
Aguadilla,48.000
Georgia,41.000
Minnesota,34.000
Indiana,39.000
Canóvanas,49.000
Rhode Island,28.000
Tennessee,45.000
Mayagüez,39.000
Florida,63.000
Texas,50.000
Massachusetts,28.000
Toa Alta,44.000
North Carolina,38.000
District of Columbia,19.500
Nevada,48.000
New Hampshire,30.000
South Carolina,44.000
Virginia,33.000
Loíza,29.000
New Jersey,29.000
Wisconsin,36.000
Ponce,42.000

2025-01-27 06:30:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:30:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:30:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:30:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 06:30:44 - snowflake.connector.connection - INFO - closed
2025-01-27 06:30:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:30:45 - root - INFO - SQL:
SELECT "install_size_kw_buckets", COUNT(*) AS "bucket_count"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
GROUP BY "install_size_kw_buckets"
LIMIT 100
Results:
Too long, hard cut:
install_size_kw_buckets,bucket_count
"[[0,3888],[5,430],[10,80],[15,39],[20,24],[25,12],[30,7],[35,14],[40,7],[45,8],[50,3],[55,5],[60,6],[65,7],[70,1],[75,7],[80,2],[85,1],[90,4],[95,2],[100,4],[105,2],[110,1],[120,1],[125,3],[130,1],[135,1],[140,2],[145,1],[155,1],[160,2],[165,2],[190,2],[195,1],[220,1],[240,1],[285,2],[290,2],[300,1],[305,1],[320,1],[330,1],[340,1],[380,1],[385,1],[430,1],[445,1],[460,1],[475,1],[560,2],[565,1],[570,1],[575,1],[640,1],[735,1],[750,1],[830,1],[875,1],[1070,1],[1240,1],[1305,1],[1320,1]]",1
"[[0,4877],[5,722],[10,107],[15,67],[20,40],[25,37],[30,34],[35,18],[40,14],[45,11],[50,11],[55,8],[60,7],[65,9],[70,9],[75,5],[80,5],[85,6],[90,4],[95,5],[100,7],[105,3],[110,4],[115,1],[120,5],[125,5],[130,2],[135,1],[140,2],[145,3],[150,2],[155,3],[160,3],[165,1],[175,2],[180,3],[185,1],[190,1],[195,2],[200,1],[220,1],[230,1],[235,1],[240,3],[255,2],[265,1],[295,1],[300,2],[315,1],[320,2],[345,1],[350,1],[365,1],[385,1],[410,1],[415,1],[435,1],[445,1],[755,1],[810,1],[815,1],[820,1],[865,1],[960,1],[1110,1],[1140,1],[1180,1],[1230,1],[1300,1],[1345,1],[1995,1],[2220,1],[4045,1]]",1
"[[0,4250],[5,463],[10,78],[15,68],[20,37],[25,24],[30,22],[35,23],[40,18],[45,16],[50,12],[55,9],[60,14],[65,6],[70,7],[75,5],[80,4],[85,6],[90,7],[100,7],[105,2],[110,2],[115,2],[120,5],[125,3],[130,1],[135,3],[140,2],[150,2],[155,1],[160,3],[165,3],[170,2],[180,3],[185,1],[195,4],[200,1],[215,2],[235,1],[245,1],[250,1],[255,2],[260,1],[270,1],[285,3],[305,1],[315,1],[325,1],[355,1],[360,1],[375,2],[390,1],[400,1],[445,2],[450,2],[460,1],[470,1],[475,1],[480,1],[510,2],[525,1],[610,1],[680,1],[730,1],[790,1],[840,1],[845,1],[890,1],[1080,1],[1465,1]]",1
"[[0,3505],[5,529],[10,57],[15,29],[20,12],[25,16],[30,7],[35,8],[40,7],[45,10],[50,7],[55,7],[60,4],[65,5],[70,4],[75,3],[80,4],[85,3],[90,5],[95,4],[115,4],[125,2],[130,2],[140,1],[150,1],[165,1],[170,1],[185,1],[195,1],[210,1],[235,1],[240,1],[255,1],[265,1],[275,1],[285,1],[335,1],[355,1],[400,1],[485,1],[505,1],[630,1],[715,1],[780,1],[1445,1]]",1
"[[0,5598],[5,972],[10,126],[15,66],[20,38],[25,46],[30,27],[35,31],[40,22],[45,12],[50,15],[55,13],[60,4],[65,10],[70,9],[75,6],[80,5],[85,3],[90,8],[95,6],[100,6],[105,6],[110,3],[115,1],[120,3],[125,4],[130,2],[135,4],[140,2],[150,1],[165,2],[170,1],[175,3],[180,1],[185,1],[200,1],[210,2],[215,1],[225,1],[230,1],[250,1],[260,1],[270,1],[275,1],[285,3],[290,1],[295,1],[310,1],[325,2],[335,1],[340,2],[350,2],[480,1],[495,1],[505,1],[510,1],[560,1],[635,1],[690,1],[700,1],[830,1],[910,1],[1035,1],[1145,1],[2275,1]]",1
"[[0,6679],[5,727],[10,91],[15,40],[20,48],[25,30],[30,24],[35,27],[40,6],[45,13],[50,11],[55,11],[60,4],[65,12],[70,4],[75,3],[80,3],[85,3],[90,4],[95,3],[100,5],[105,5],[110,1],[115,1],[120,3],[125,5],[130,3],[135,4],[145,2],[150,2],[155,2],[160,1],[165,1],[170,3],[175,3],[180,1],[185,1],[190,1],[195,3],[210,1],[215,2],[220,1],[225,1],[230,1],[235,2],[240,1],[245,1],[260,1],[270,2],[285,3],[300,3],[310,1],[320,1],[335,1],[355,2],[360,3],[380,1],[410,1],[420,2],[425,2],[450,2],[475,2],[485,1],[495,1],[515,1],[525,1],[530,2],[590,3],[600,1],[630,1],[670,1],[675,1],[680,1],[690,1],[695,1],[720,1],[745,2],[760,1],[790,1],[800,1],[845,1],[875,1],[880,1],[885,1],[895,1],[955,1],[970,1],[1005,1],[1020,1],[1100,1],[1105,1],[1160,1],[1260,1],[1315,1],[1345,1],[1375,1],[1400,1],[1415,1],[1470,1],[1475,1],[1510,1],[1550,1],[1620,1],[1775,1],[1785,1],[1865,1],[1915,1],[2040,1],[2075,1],[2180,1],[2225,1],[2530,1],[2600,1],[2895,1],[3025,1],[3760,1]]",1
"[[0,3378],[5,690],[10,128],[15,48],[20,52],[25,31],[30,19],[35,23],[40,22],[45,18],[50,12],[55,14],[60,8],[65,7],[70,12],[75,4],[80,9],[85,9],[90,3],[95,2],[100,9],[105,3],[110,5],[115,2],[120,4],[125,2],[130,2],[135,1],[140,1],[145,1],[155,2],[160,1],[170,2],[175,1],[190,2],[195,1],[200,2],[205,1],[210,1],[215,3],[220,4],[230,1],[235,2],[240,3],[255,1],[260,1],[265,2],[275,1],[280,2],[285,2],[300,1],[310,3],[315,2],[325,1],[330,5],[340,1],[375,1],[430,1],[435,1],[450,1],[455,2],[475,1],[490,1],[505,1],[520,1],[535,1],[565,1],[570,1],[575,1],[600,1],[795,1],[1080,2],[1380,1],[1705,1],[1855,1],[1915,1],[2415,1]]",1
"[[0,2607],[5,487],[10,133],[15,72],[20,38],[25,27],[30,29],[35,12],[40,10],[45,12],[50,12],[55,10],[60,6],[65,9],[70,2],[75,7],[80,2],[85,4],[90,4],[95,4],[100,3],[105,4],[110,6],[115,3],[120,1],[125,2],[130,6],[135,1],[140,2],[145,1],[165,2],[170,2],[185,1],[195,1],[205,1],[220,2],[245,1],[250,1],[255,1],[265,2],[270,1],[285,1],[290,1],[310,1],[315,1],[345,2],[355,2],[405,1],[430,1],[470,1],[540,1],[665,1],[920,1]]",1
"[[0,3659],[5,731],[10,139],[15,59],[20,46],[25,38],[30,18],[35,18],[40,17],[45,19],[50,9],[55,9],[60,9],[65,4],[70,13],[75,2],[80,4],[85,9],[90,7],[95,3],[100,6],[105,3],[110,2],[115,5],[120,4],[125,2],[130,4],[140,3],[180,1],[185,3],[190,1],[200,1],[210,2],[215,1],[220,2],[225,3],[230,1],[245,1],[250,1],[255,1],[290,1],[305,1],[335,1],[380,2],[390,1],[395,1],[440,1],[550,1],[580,1],[585,1],[660,1],[665,1],[1175,1]]",1
"[[0,5115

2025-01-27 06:30:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:30:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:30:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:30:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 70
2025-01-27 06:30:46 - snowflake.connector.connection - INFO - closed
2025-01-27 06:30:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:30:47 - root - INFO - SQL:
SELECT "state_name", AVG("yearly_sunlight_kwh_median") AS "average_yearly_sunlight_kwh"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
GROUP BY "state_name"
LIMIT 100
Results:
state_name,average_yearly_sunlight_kwh
Pennsylvania,9643.047403007866
District of Columbia,9514.323124778663
New York,11093.792310801535
Delaware,10057.36443677757
Maryland,11161.535303257713
New Jersey,10394.262440316692
Virginia,13040.666091308594
Florida,24541.627243367817
Illinois,11417.816564532395
Indiana,12829.933978565334
Louisiana,19441.814748488323
Michigan,12534.093277310458
New Hampshire,11578.558432345919
Arizona,25071.09679438814
California,19149.373890872685
Colorado,14501.3668164782
Georgia,14416.70793691221
Wisconsin,11486.317770096628
Alaska,8789.765452332427
Kansas,15698.781374080365
Nebraska,13440.423525555927
West Virginia,10610.454969409904
Kentucky,13072.243304568385
Maine,25123.13149682247
Missouri,13973.240147076636
South Dakota,12645.321630859375
Washington,11385.175842700985
Rhode Island,9028.114988841826
Mississippi,17062.547867509795
Oregon,12711.51839672151
San Juan,19034.957988427734
Oklahoma,18208.698548691405
Carolina,24880.327637039987
Trujillo Alto,14657.183436075846
New Mexico,23045.631883087684
Toa Baja,16328.209805779707
Dorado,17231.117614746094
Loíza,9965.285552978516
Minnesota,10533.378695985572
South Carolina,17096.240484834998
Iowa,12093.35045615048
Ohio,10723.76020789242
Mayagüez,34079.73861296281
North Carolina,13966.617514012105
North Dakota,13461.913795922508
Connecticut,9978.567484160709
Massachusetts,9911.338083498946
Utah,16446.945985440118
Idaho,14673.610809881036
Nevada,21108.910752677915
Wyoming,15494.68604844835
Ponce,20463.974993739983
Aguadilla,16741.20799560547
Vermont,12335.584613240559
Alabama,16139.44835956338
Bayamón,16767.01608472921
Arkansas,15400.135863785516
Canóvanas,73916.76190795898
Cataño,27304.21228271484
Guaynabo,16762.037924194337
Hawaii,31333.417513658052
Hormigueros,14105.9359375
Arecibo,19544.431766764323
Hatillo,22895.611621093747
Cabo Rojo,25563.86807861328
Moca,8580.857080078125
Texas,19073.854749166654
Tennessee,15277.01999564612
Montana,11876.52265702681
Toa Alta,15929.254949273005

2025-01-27 06:30:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:30:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:30:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:30:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 06:30:48 - snowflake.connector.connection - INFO - closed
2025-01-27 06:30:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:30:48 - root - INFO - SQL:
SELECT "region_name", "state_name", "percent_covered"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
WHERE "percent_covered" < 50
LIMIT 100
Results:
region_name,state_name,percent_covered
29920,South Carolina,1.0338680926916222
17019,Pennsylvania,0.38022813688212925
20782,Maryland,7.551852508420493
35043,Alabama,0.21151586368977673
02668,Massachusetts,3.2061068702290076
20745,Maryland,6.007782101167315
86325,Arizona,0.5327019828351583
03905,Maine,30.904183535762485
06470,Connecticut,0.6816917084028937
08085,New Jersey,0.3257771141577304
22201,Virginia,2.104791759964174
49649,Michigan,2.2151898734177213
61731,Illinois,11.842105263157896
98323,Washington,14.502164502164502
02835,Rhode Island,11.750972762645915
18621,Pennsylvania,1.5924719507781397
56465,Minnesota,28.07017543859649
65631,Missouri,6.1686298822070675
02739,Massachusetts,4.464714354296688
04345,Maine,32.04930662557781
19464,Pennsylvania,0.48717948717948717
20912,Maryland,13.269465960048919
28125,North Carolina,1.2531328320802004
29850,South Carolina,34.883720930232556
55803,Minnesota,46.99020065328978
66012,Kansas,0.7031749414020882
02822,Rhode Island,5.445335584634867
03901,Maine,46.77980852915579
06782,Connecticut,4.930156121610517
07849,New Jersey,1.3465237702665567
15051,Pennsylvania,13.821138211382113
20712,Maryland,41.397495056031644
20816,Maryland,12.475859405175743
29696,South Carolina,0.5529225908372828
35147,Alabama,21.82244818146265
47932,Indiana,1.1637347767253046
61025,Illinois,37.66632548618219
02632,Massachusetts,16.295242611032084
02814,Rhode Island,6.1553653719552335
03303,New Hampshire,42.257897462454686
08020,New Jersey,3.504482477587612
10465,New York,9.297052154195011
10516,New York,41.46537842190016
11050,New York,44.93144769513117
13612,New York,4.738760631834751
19931,Delaware,43.90243902439025
20743,Maryland,20.33869165305596
27006,North Carolina,0.3709863118843546
32531,Florida,5.2631578947368425
48157,Michigan,35.22727272727273
59417,Montana,13.809854267869534
01982,Massachusetts,45.65077319587629
03870,New Hampshire,38.47389558232932
07843,New Jersey,23.407286790148586
20740,Maryland,46.65918923249479
20815,Maryland,20.863013698630137
21044,Maryland,13.403880070546737
35004,Alabama,3.033894287745911
50134,Iowa,24.07045009784736
52338,Iowa,2.542764678687009
54874,Wisconsin,3.7788663400979705
73007,Oklahoma,0.39281705948372614
77358,Texas,5.504345535949434
77363,Texas,0.8048937540244687
01237,Massachusetts,34.09090909090909
01238,Massachusetts,3.0885780885780885
01516,Massachusetts,24.22245651027939
01534,Massachusetts,4.6853468075333025
01588,Massachusetts,27.997546764796073
02673,Massachusetts,48.58019953952417
02770,Massachusetts,36.91470054446461
04252,Maine,4.492362982929021
08876,New Jersey,46.291246250340876
22832,Virginia,17.70334928229665
37710,Tennessee,21.267893660531698
47920,Indiana,7.818411097099622
49014,Michigan,43.90221402214022
75652,Texas,1.2139997417021826
80512,Colorado,18.83248730964467
01569,Massachusetts,47.31525784157363
03840,New Hampshire,48.887343532684284
04473,Maine,24.013157894736842
07035,New Jersey,45.06535947712418
07442,New Jersey,26.64092664092664
15840,Pennsylvania,44.26623897353649
15851,Pennsylvania,26.95302687766893
17268,Pennsylvania,0.8750163249314353
18077,Pennsylvania,4.964114832535885
21156,Maryland,14.754098360655737
22043,Virginia,36.265975180588995
24431,Virginia,18.444266238973537
26062,West Virginia,32.30444532383591
31636,Georgia,0.20261143628995948
40177,Kentucky,10.864745011086475
43443,Ohio,4.627249357326479
48161,Michigan,5.7652597670768975
49017,Michigan,48.85699641209636
53115,Wisconsin,0.20105820105820105
57730,South Dakota,45.19735341090577
64421,Missouri,2.088772845953003

2025-01-27 06:30:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:30:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:30:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:30:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 70
2025-01-27 06:30:50 - snowflake.connector.connection - INFO - closed
2025-01-27 06:30:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:30:50 - root - INFO - SQL:
SELECT "state_name", SUM("carbon_offset_metric_tons") AS "total_carbon_offset"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
GROUP BY "state_name"
ORDER BY "total_carbon_offset" DESC
LIMIT 100
Results:
state_name,total_carbon_offset
Florida,84762071.96637787
Texas,80026572.09620419
California,67060256.559903376
Ohio,39985118.69480568
Illinois,39019478.60061418
Michigan,32170938.26439564
Georgia,26767856.473523576
Pennsylvania,25679219.804377407
Arizona,25393752.120932452
Tennessee,23662867.396383427
North Carolina,23363984.23961253
Indiana,22286009.07525565
New York,21932730.052032903
New Jersey,21441825.25895091
Missouri,20988770.94279073
Wisconsin,18538719.211838692
Louisiana,16119065.632724501
Alabama,15792877.15528395
South Carolina,15082325.953191794
Colorado,15019343.801609265
Virginia,14570516.612738723
Oklahoma,13676736.482410647
Kentucky,10893849.027434926
Minnesota,9461269.60415691
Maryland,9341908.182602106
Massachusetts,8448829.99986072
Kansas,8248164.19414453
Washington,7305348.121577986
Arkansas,7162306.228122597
Mississippi,6675246.399348796
Nevada,6552267.614581583
Connecticut,5385610.014692117
New Mexico,5193766.818696551
Hawaii,4666457.0008377
Iowa,4480709.137428612
Oregon,4391352.901025
Utah,4055086.38298331
Nebraska,3407555.482436877
West Virginia,2708875.483437571
Delaware,2047732.7107329231
Idaho,2001480.6360385297
Rhode Island,1613670.238764769
North Dakota,1164890.4157271704
New Hampshire,1106392.337547703
South Dakota,1047973.7956763804
Maine,951467.7454093618
San Juan,792573.4658976337
District of Columbia,768728.0745405239
Montana,721128.5004524508
Bayamón,505479.538757477
Alaska,449958.7974072519
Wyoming,399567.8100756294
Carolina,372344.8403529482
Ponce,259596.63619231156
Vermont,238985.90700712064
Guaynabo,230168.9556225237
Mayagüez,136317.66351863468
Aguadilla,107733.02459435827
Toa Baja,86581.46720940567
Arecibo,74104.26841802277
Dorado,47475.16902867142
Trujillo Alto,46442.93098691624
Cataño,40096.302153202625
Canóvanas,33633.89653257158
Toa Alta,17313.180368415116
Hormigueros,14312.409783773295
Hatillo,6102.208001967081
Loíza,400.46323702419204
Cabo Rojo,159.01583819991797
Moca,5.774905113871622

2025-01-27 06:30:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:30:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:30:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:30:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 06:30:51 - snowflake.connector.connection - INFO - closed
2025-01-27 06:30:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:30:52 - root - INFO - SQL:
SELECT "region_name", "state_name", "percent_qualified"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
ORDER BY "percent_qualified" ASC
LIMIT 100
Results:
region_name,state_name,percent_qualified
60950,Illinois,0.0
10045,New York,0.0
49234,Michigan,0.0
21532,Maryland,0.0
24069,Virginia,0.0
80290,Colorado,0.0
24724,West Virginia,0.0
29058,South Carolina,0.0
80299,Colorado,0.0
92305,California,0.0
84310,Utah,0.0
33849,Florida,0.0
48674,Michigan,0.0
43002,Ohio,0.0
07456,New Jersey,0.0
28357,North Carolina,0.0
57032,South Dakota,0.0
37015,Tennessee,0.0
20303,District of Columbia,0.0
95007,California,2.7777777777777777
81415,Colorado,11.11111111111111
10173,New York,12.5
92391,California,12.987012987012987
92386,California,13.97238017871649
64060,Missouri,14.285714285714286
10123,New York,17.24137931034483
92325,California,17.906865098415746
86005,Arizona,18.272425249169434
15545,Pennsylvania,20.0
22400,Baja California,20.0
70764,Louisiana,20.0
10105,New York,20.0
46965,Indiana,20.0
92321,California,22.15435868961688
95389,California,22.519083969465647
92378,California,23.568281938325992
07878,New Jersey,24.216524216524217
10176,New York,25.0
50648,Iowa,25.0
30072,Georgia,25.0
02672,Massachusetts,25.0
59411,Montana,25.510204081632654
55090,Minnesota,25.700934579439252
92352,California,26.010973379394432
20880,Maryland,26.424870466321245
95959,California,27.04703832752613
62716,Illinois,27.272727272727273
19149,Pennsylvania,27.44349692885682
10155,New York,27.77777777777778
95006,California,27.88586251621271
06927,Connecticut,28.0
04351,Maine,28.571428571428573
10174,New York,28.571428571428573
19142,Pennsylvania,29.15272531030761
80025,Colorado,30.0
84773,Utah,30.0
46124,Indiana,30.357142857142858
10120,New York,30.434782608695652
21032,Maryland,30.778663396689147
19120,Pennsylvania,31.392170010832
27599,North Carolina,31.764705882352942
92315,California,31.798715203426124
12498,New York,32.18390804597701
92333,California,33.2511100148002
06338,Connecticut,33.333333333333336
18660,Pennsylvania,33.333333333333336
53167,Wisconsin,33.333333333333336
65738,Missouri,33.333333333333336
81334,Colorado,33.333333333333336
46937,Indiana,33.333333333333336
29697,South Carolina,33.333333333333336
32706,Florida,33.333333333333336
19110,Pennsylvania,33.333333333333336
20777,Maryland,33.333333333333336
19132,Pennsylvania,33.55019191984907
19143,Pennsylvania,33.79228203906622
66205,Kansas,33.839300445471046
19151,Pennsylvania,34.46654256882532
20896,Maryland,34.962406015037594
19139,Pennsylvania,35.15326361341507
19134,Pennsylvania,35.15690473973368
66208,Kansas,35.473707083876576
92314,California,35.84478222741888
18353,Pennsylvania,36.36363636363637
58505,North Dakota,36.36363636363637
10017,New York,36.458333333333336
12572,New York,36.69724770642202
95018,California,36.88656476267096
19138,Pennsylvania,37.186544342507645
03224,New Hampshire,37.5
84763,Utah,37.5
19131,Pennsylvania,38.040775733465935
59937,Montana,38.101788170563964
57751,South Dakota,38.20459290187891
56465,Minnesota,38.28125
19124,Pennsylvania,38.31012721626765
19145,Pennsylvania,38.368391486174396
23235,Virginia,38.400812881037986
19140,Pennsylvania,38.402638050525375
07046,New Jersey,38.43821076573162

2025-01-27 06:30:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:30:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:30:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:30:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 70
2025-01-27 06:30:53 - snowflake.connector.connection - INFO - closed
2025-01-27 06:30:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:30:53 - root - INFO - SQL:
SELECT "state_name", AVG("kw_total") AS "average_kw_capacity"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
GROUP BY "state_name"
LIMIT 100
Results:
state_name,average_kw_capacity
Pennsylvania,15416.469326568265
District of Columbia,5858.594117647059
New York,9892.509531522552
Delaware,17261.89903846154
Maryland,14244.517025089606
New Jersey,16172.515339966832
Virginia,17939.266762452105
Florida,32568.48199718706
Illinois,17609.01307890223
Indiana,25356.32418478261
Louisiana,26592.34271523179
Michigan,18958.501666666667
New Hampshire,15610.962068965517
Arizona,29372.596812749005
California,21814.50779584222
Colorado,18289.10511064278
Georgia,26723.577231121282
Wisconsin,23188.82874015748
Alaska,22026.407258064515
Kansas,23427.118320610687
Nebraska,19549.46286231884
West Virginia,16084.272598870057
Kentucky,23791.84186746988
Maine,15565.584677419354
Missouri,24995.81688466112
South Dakota,25307.035714285714
Washington,23322.825194468453
Rhode Island,16583.51275510204
Mississippi,27967.8125
Oregon,26977.826182136603
San Juan,6750.028
Oklahoma,25360.18592964824
Carolina,10224.032894736842
Trujillo Alto,4121.895833333333
New Mexico,27210.80974264706
Toa Baja,4775.881578947368
Dorado,7125.035714285715
Loíza,423.25
Minnesota,19472.80634638197
South Carolina,26021.040354330707
Iowa,22154.59393491124
Ohio,20681.10563041386
Mayagüez,6165.347826086957
North Carolina,22424.775631768953
North Dakota,31303.657692307694
Connecticut,16091.290251107828
Massachusetts,14377.557708333334
Utah,23510.410980810233
Idaho,34571.70508982036
Nevada,20809.47328244275
Wyoming,22905.095238095237
Ponce,7468.211538461538
Aguadilla,7211.85
Vermont,18634.0
Alabama,25574.469038208168
Bayamón,9200.853448275862
Arkansas,28949.15353697749
Canóvanas,4358.59375
Cataño,8401.0
Guaynabo,12301.6625
Hawaii,19715.521825396827
Hormigueros,3737.9375
Arecibo,8516.777777777777
Hatillo,3155.75
Cabo Rojo,167.0
Moca,7.0
Texas,30505.807940729483
Tennessee,26864.36747624076
Montana,22522.45588235294
Toa Alta,2038.7222222222222

2025-01-27 06:30:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:30:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:30:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:30:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 69
2025-01-27 06:30:55 - snowflake.connector.connection - INFO - closed
2025-01-27 06:30:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:30:55 - root - INFO - SQL:
SELECT "state_name", SUM("existing_installs_count") AS "total_existing_installations"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
GROUP BY "state_name"
LIMIT 100
Results:
state_name,total_existing_installations
Pennsylvania,4402
District of Columbia,442
Indiana,987
Texas,14127
California,331274
South Carolina,1263
New Jersey,12628
Maryland,6064
Ohio,2840
Illinois,2447
Colorado,24335
Massachusetts,15350
Maine,360
Connecticut,5268
Virginia,2407
West Virginia,80
Wisconsin,1913
Missouri,2854
Washington,5756
Rhode Island,371
New Hampshire,262
New York,18744
Alabama,544
Nebraska,209
Kentucky,725
North Carolina,2910
Georgia,1906
Oregon,8647
Oklahoma,802
South Dakota,21
San Juan,0
New Mexico,3749
Mississippi,356
Toa Baja,0
Trujillo Alto,0
Carolina,0
Dorado,0
Baja California,0
Minnesota,1517
Michigan,1717
Delaware,88
Montana,261
Wyoming,29
Kansas,737
Florida,105292
Alaska,83
Tennessee,1306
Ponce,0
Louisiana,8221
Vermont,131
Arkansas,239
Guaynabo,0
Idaho,529
Nevada,12738
Cataño,0
Bayamón,0
Aguadilla,0
Arecibo,0
Hawaii,25376
Hormigueros,0
Corozal,0
Moca,0
Arizona,39696
Iowa,248
Utah,3161
North Dakota,24
Toa Alta,0
Canóvanas,0
Mayagüez,0

2025-01-27 06:30:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:30:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:30:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:30:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 06:30:57 - snowflake.connector.connection - INFO - closed
2025-01-27 06:30:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:30:57 - root - INFO - SQL:
SELECT 
  "region_name", 
  "state_name", 
  ("count_qualified" - "existing_installs_count") AS "gap_in_potential_installations"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
WHERE ("count_qualified" - "existing_installs_count") > 1000
LIMIT 100
Results:
region_name,state_name,gap_in_potential_installations
42101003901,Pennsylvania,1001
42101002802,Pennsylvania,1220
42101003100,Pennsylvania,1145
42101004001,Pennsylvania,1016
42101004101,Pennsylvania,1070
42101017800,Pennsylvania,1052
42101016000,Pennsylvania,1415
42101016100,Pennsylvania,1034
42101020200,Pennsylvania,1052
42101025200,Pennsylvania,1150
34007602000,New Jersey,1039
42101001300,Pennsylvania,1001
42101002900,Pennsylvania,1076
42101008500,Pennsylvania,1201
42101015800,Pennsylvania,1291
42101032500,Pennsylvania,1071
24005420500,Maryland,1027
42071001400,Pennsylvania,1067
24005451500,Maryland,1140
24005492300,Maryland,1392
24510260302,Maryland,2179
24510270801,Maryland,1143
24510270803,Maryland,1294
24510270805,Maryland,1484
24510270902,Maryland,1246
26049000900,Michigan,1043
26163524800,Michigan,1004
26163551600,Michigan,1187
26163575200,Michigan,1357
26163577200,Michigan,1164
26163577300,Michigan,1084
39035121700,Ohio,1421
39035171104,Ohio,1514
39095005703,Ohio,1055
42071000300,Pennsylvania,1287
42101015200,Pennsylvania,1029
42101021000,Pennsylvania,1337
42101021400,Pennsylvania,1168
42101030600,Pennsylvania,1094
06037535902,California,1118
06075035100,California,1551
17031490902,Illinois,1081
19113001700,Iowa,1484
24005401301,Maryland,1181
24510010100,Maryland,1098
24510200600,Maryland,1154
24510250205,Maryland,1231
24510250402,Maryland,1184
24510260501,Maryland,1048
24510270401,Maryland,1131
26049004000,Michigan,1217
26163501100,Michigan,1134
26163577600,Michigan,1377
26163581900,Michigan,1896
27053101200,Minnesota,1038
27053110800,Minnesota,1042
27123030201,Minnesota,1044
27123030800,Minnesota,1097
27137000900,Minnesota,1174
27137015800,Minnesota,1584
34003054400,New Jersey,1097
34025807400,New Jersey,1150
36059303302,New York,1001
36081054200,New York,1045
36081084000,New York,1057
36081161700,New York,1046
36081162100,New York,1033
39035152501,Ohio,1296
42003562400,Pennsylvania,1020
42013101700,Pennsylvania,1243
42045402100,Pennsylvania,1306
42045402800,Pennsylvania,1099
42101034803,Pennsylvania,1066
42129801500,Pennsylvania,1071
06037535802,California,1046
06075026100,California,1117
06075035201,California,1114
06075035300,California,1579
06075035400,California,1489
08001008000,Colorado,1121
08031000301,Colorado,1288
08031000502,Colorado,1094
08031000903,Colorado,1140
08031002300,Colorado,1209
08031002902,Colorado,1215
08031003602,Colorado,1067
08031004104,Colorado,1184
10003000200,Delaware,1268
11001000100,District of Columbia,1082
17031740300,Illinois,1070
24005420401,Maryland,1579
24005491600,Maryland,1020
24027606704,Maryland,1178
24510240100,Maryland,1046
24510250103,Maryland,1058
24510260102,Maryland,1257
24510260202,Maryland,1318
24510261000,Maryland,1267
24510270501,Maryland,1465
24510270802,Maryland,1212

2025-01-27 06:30:57 - root - INFO - itercount: 0
2025-01-27 06:30:57 - root - INFO - Database Name: SUNROOF_SOLAR
Schema Name: SUNROOF_SOLAR
DDL describes table information.
,0
table_name,SOLAR_POTENTIAL_BY_POSTAL_CODE
description,
DDL,"create or replace TABLE SOLAR_POTENTIAL_BY_POSTAL_CODE (
	""region_name"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""lat_max"" FLOAT,
	""lat_min"" FLOAT,
	""lng_max"" FLOAT,
	""lng_min"" FLOAT,
	""lat_avg"" FLOAT,
	""lng_avg"" FLOAT,
	""yearly_sunlight_kwh_kw_threshold_avg"" FLOAT,
	""count_qualified"" NUMBER(38,0),
	""percent_covered"" FLOAT,
	""percent_qualified"" FLOAT,
	""number_of_panels_n"" NUMBER(38,0),
	""number_of_panels_s"" NUMBER(38,0),
	""number_of_panels_e"" NUMBER(38,0),
	""number_of_panels_w"" NUMBER(38,0),
	""number_of_panels_f"" NUMBER(38,0),
	""number_of_panels_median"" NUMBER(38,0),
	""number_of_panels_total"" NUMBER(38,0),
	""kw_median"" FLOAT,
	""kw_total"" FLOAT,
	""yearly_sunlight_kwh_n"" FLOAT,
	""yearly_sunlight_kwh_s"" FLOAT,
	""yearly_sunlight_kwh_e"" FLOAT,
	""yearly_sunlight_kwh_w"" FLOAT,
	""yearly_sunlight_kwh_f"" FLOAT,
	""yearly_sunlight_kwh_median"" FLOAT,
	""yearly_sunlight_kwh_total"" FLOAT,
	""install_size_kw_buckets"" VARCHAR(16777216),
	""carbon_offset_metric_tons"" FLOAT,
	""existing_installs_count"" NUMBER(38,0),
	""center_point"" BINARY(8388608)
);"

,1
table_name,SOLAR_POTENTIAL_BY_CENSUSTRACT
description,
DDL,"create or replace TABLE SOLAR_POTENTIAL_BY_CENSUSTRACT (
	""region_name"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""lat_max"" FLOAT,
	""lat_min"" FLOAT,
	""lng_max"" FLOAT,
	""lng_min"" FLOAT,
	""lat_avg"" FLOAT,
	""lng_avg"" FLOAT,
	""yearly_sunlight_kwh_kw_threshold_avg"" FLOAT,
	""count_qualified"" NUMBER(38,0),
	""percent_covered"" FLOAT,
	""percent_qualified"" FLOAT,
	""number_of_panels_n"" NUMBER(38,0),
	""number_of_panels_s"" NUMBER(38,0),
	""number_of_panels_e"" NUMBER(38,0),
	""number_of_panels_w"" NUMBER(38,0),
	""number_of_panels_f"" NUMBER(38,0),
	""number_of_panels_median"" NUMBER(38,0),
	""number_of_panels_total"" NUMBER(38,0),
	""kw_median"" FLOAT,
	""kw_total"" FLOAT,
	""yearly_sunlight_kwh_n"" FLOAT,
	""yearly_sunlight_kwh_s"" FLOAT,
	""yearly_sunlight_kwh_e"" FLOAT,
	""yearly_sunlight_kwh_w"" FLOAT,
	""yearly_sunlight_kwh_f"" FLOAT,
	""yearly_sunlight_kwh_median"" FLOAT,
	""yearly_sunlight_kwh_total"" FLOAT,
	""install_size_kw_buckets"" VARCHAR(16777216),
	""carbon_offset_metric_tons"" FLOAT,
	""existing_installs_count"" NUMBER(38,0),
	""center_point"" BINARY(8388608)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'SUNROOF_SOLAR': {'SUNROOF_SOLAR': ['SOLAR_POTENTIAL_BY_CENSUSTRACT', 'SOLAR_POTENTIAL_BY_POSTAL_CODE']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Table:** `SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE`
  - `"state_name"`: Used to identify each state.
  - `"count_qualified"`: Number of buildings available for solar installations.
  - `"percent_covered"`: Percentage covered by Project Sunroof.
  - `"percent_qualified"`: Percentage of buildings suitable for solar.
  - `"number_of_panels_total"`: Total potential panel count.
  - `"kw_total"`: Total kilowatt capacity.
  - `"yearly_sunlight_kwh_total"`: Energy generation potential.
  - `"carbon_offset_metric_tons"`: Carbon dioxide offset.
  - `"existing_installs_count"`: Number of existing solar installations.
  - **Calculated Column:** `"gap_in_potential_installations"`: Difference between `"count_qualified"` and `"existing_installs_count"`.

- **Table:** `SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT`
  - **Columns are the same as above, used for census tract level data.**

**Conditions That May Be Used:**

- Grouping data by `"state_name"` to compare across states.
- Differentiating data by levels using the respective tables.
- Calculating gaps in potential installations by subtracting `"existing_installs_count"` from `"count_qualified"`.
- Filtering data based on thresholds (e.g., `"percent_covered"` below 50%).

---

**SQL Queries:**

1. **Select distinct states from the postal code level:**
   ```sql
   SELECT DISTINCT "state_name"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   LIMIT 100;
   ```

2. **Retrieve the total number of buildings available for solar installations per state at the postal code level:**
   ```sql
   SELECT "state_name", SUM("count_qualified") AS "total_buildings_available"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   GROUP BY "state_name"
   LIMIT 100;
   ```

3. **Fetch the percentage of areas covered by Project Sunroof per state at the census tract level:**
   ```sql
   SELECT "state_name", AVG("percent_covered") AS "average_percent_covered"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
   GROUP BY "state_name"
   LIMIT 100;
   ```

4. **List regions with the highest percentage suitable for solar at the postal code level:**
   ```sql
   SELECT "region_name", "state_name", "percent_qualified"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   ORDER BY "percent_qualified" DESC
   LIMIT 100;
   ```

5. **Calculate the total potential panel count per state at the census tract level:**
   ```sql
   SELECT "state_name", SUM("number_of_panels_total") AS "total_panel_count"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
   GROUP BY "state_name"
   LIMIT 100;
   ```

6. **Determine the total kilowatt capacity per state at the postal code level:**
   ```sql
   SELECT "state_name", SUM("kw_total") AS "total_kw_capacity"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   GROUP BY "state_name"
   LIMIT 100;
   ```

7. **Get the total energy generation potential per state at the census tract level:**
   ```sql
   SELECT "state_name", SUM("yearly_sunlight_kwh_total") AS "total_energy_potential_kwh"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
   GROUP BY "state_name"
   LIMIT 100;
   ```

8. **Compute the total carbon dioxide offset per state at the postal code level:**
   ```sql
   SELECT "state_name", SUM("carbon_offset_metric_tons") AS "total_carbon_offset"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   GROUP BY "state_name"
   LIMIT 100;
   ```

9. **Identify the gap in potential installations per state at the census tract level:**
   ```sql
   SELECT 
     "state_name", 
     SUM("count_qualified") AS "total_count_qualified",
     SUM("existing_installs_count") AS "total_existing_installs",
     (SUM("count_qualified") - SUM("existing_installs_count")) AS "gap_in_potential_installations"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
   GROUP BY "state_name"
   LIMIT 100;
   ```

10. **Compare the percentage suitable for solar between postal code and census tract levels for each state:**
    ```sql
    SELECT 
      'Postal Code' AS "Level",
      "state_name", 
      AVG("percent_qualified") AS "average_percent_qualified"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
    GROUP BY "state_name"
    LIMIT 100;

    SELECT 
      'Census Tract' AS "Level",
      "state_name", 
      AVG("percent_qualified") AS "average_percent_qualified"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
    GROUP BY "state_name"
    LIMIT 100;
    ```

11. **Fetch regions with existing installations and potential gaps at the postal code level:**
    ```sql
    SELECT 
      "region_name", 
      "state_name", 
      "count_qualified", 
      "existing_installs_count",
      ("count_qualified" - "existing_installs_count") AS "gap_in_potential_installations"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
    LIMIT 100;
    ```

12. **List states with median number of panels at the census tract level:**
    ```sql
    SELECT "state_name", MEDIAN("number_of_panels_median") AS "median_number_of_panels"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
    GROUP BY "state_name"
    LIMIT 100;
    ```

13. **Retrieve install size kilowatt buckets and their counts at the postal code level:**
    ```sql
    SELECT "install_size_kw_buckets", COUNT(*) AS "bucket_count"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
    GROUP BY "install_size_kw_buckets"
    LIMIT 100;
    ```

14. **Find the average yearly sunlight kilowatt-hours per state at the census tract level:**
    ```sql
    SELECT "state_name", AVG("yearly_sunlight_kwh_median") AS "average_yearly_sunlight_kwh"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
    GROUP BY "state_name"
    LIMIT 100;
    ```

15. **Identify regions where the percentage covered is below 50% at the postal code level:**
    ```sql
    SELECT "region_name", "state_name", "percent_covered"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
    WHERE "percent_covered" < 50
    LIMIT 100;
    ```

16. **Select states with the highest carbon offset potential at the census tract level:**
    ```sql
    SELECT "state_name", SUM("carbon_offset_metric_tons") AS "total_carbon_offset"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
    GROUP BY "state_name"
    ORDER BY "total_carbon_offset" DESC
    LIMIT 100;
    ```

17. **List regions with the lowest percentage suitable for solar at the postal code level:**
    ```sql
    SELECT "region_name", "state_name", "percent_qualified"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
    ORDER BY "percent_qualified" ASC
    LIMIT 100;
    ```

18. **Calculate the average kilowatt capacity per state at the census tract level:**
    ```sql
    SELECT "state_name", AVG("kw_total") AS "average_kw_capacity"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
    GROUP BY "state_name"
    LIMIT 100;
    ```

19. **Determine the total number of existing installations per state at the postal code level:**
    ```sql
    SELECT "state_name", SUM("existing_installs_count") AS "total_existing_installations"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
    GROUP BY "state_name"
    LIMIT 100;
    ```

20. **Find regions where the gap in potential installations is greater than 1,000 at the census tract level:**
    ```sql
    SELECT 
      "region_name", 
      "state_name", 
      ("count_qualified" - "existing_installs_count") AS "gap_in_potential_installations"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
    WHERE ("count_qualified" - "existing_installs_count") > 1000
    LIMIT 100;
    ```

These queries provide insights into the relevant data and help in understanding the solar potential comparison for each state at both postal code and census tract levels.Query:
SELECT DISTINCT "state_name"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   LIMIT 100;
Answer:
state_name
Pennsylvania
District of Columbia
Indiana
Texas
California
South Carolina
New Jersey
New York
Minnesota
Ohio
Michigan
Colorado
Connecticut
Virginia
Wisconsin
Missouri
Nebraska
New Hampshire
Maryland
Arizona
West Virginia
Alabama
Illinois
Maine
Kentucky
Iowa
Wyoming
North Carolina
Florida
Oregon
Alaska
Tennessee
Ponce
Louisiana
Vermont
Arkansas
Guaynabo
San Juan
Cataño
New Mexico
Mississippi
Bayamón
Carolina
Aguadilla
Arecibo
Canóvanas
Baja California
Massachusetts
Delaware
Washington
Rhode Island
Georgia
Oklahoma
Utah
South Dakota
Idaho
Nevada
Toa Baja
Toa Alta
Mayagüez
Hormigueros
Dorado
Corozal
Moca
Montana
North Dakota
Trujillo Alto
Hawaii
Kansas
Query:
SELECT "state_name", SUM("count_qualified") AS "total_buildings_available"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   GROUP BY "state_name"
   LIMIT 100;
Answer:
state_name,total_buildings_available
Pennsylvania,1954585
District of Columbia,76385
Indiana,1116413
Texas,5476777
California,8607224
South Carolina,907878
New Jersey,1629714
Maryland,705396
Ohio,2192109
Illinois,2052522
Colorado,1031389
Massachusetts,1000732
Maine,99960
Connecticut,607976
Virginia,963270
West Virginia,154869
Wisconsin,900028
Missouri,1031097
Washington,1510869
Rhode Island,202865
New Hampshire,107012
New York,2502541
Alabama,813312
Nebraska,283330
Kentucky,577255
North Carolina,1416043
Georgia,1502091
Oregon,772441
Oklahoma,700888
South Dakota,72847
San Juan,44665
New Mexico,365713
Mississippi,324867
Toa Baja,6976
Trujillo Alto,2854
Carolina,19237
Dorado,3064
Baja California,1
Minnesota,769481
Michigan,1846232
Delaware,147431
Montana,118654
Wyoming,53068
Kansas,417118
Florida,4814177
Alaska,57138
Tennessee,1102947
Ponce,18706
Louisiana,864431
Vermont,19504
Arkansas,369725
Guaynabo,12113
Idaho,311671
Nevada,569104
Cataño,2860
Bayamón,33260
Aguadilla,5844
Arecibo,4433
Hawaii,204227
Hormigueros,1194
Corozal,15
Moca,1
Arizona,1753531
Iowa,350073
Utah,572530
North Dakota,77117
Toa Alta,1123
Canóvanas,2182
Mayagüez,7348
Query:
SELECT "state_name", AVG("percent_covered") AS "average_percent_covered"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
   GROUP BY "state_name"
   LIMIT 100;
Answer:
state_name,average_percent_covered
Pennsylvania,92.68306466974033
District of Columbia,85.3173154619042
New York,87.01654666423346
Delaware,85.27792503329306
Maryland,80.0363051672659
New Jersey,124.22007839679854
Virginia,90.98671520397548
Florida,99.63463369538297
Illinois,91.65385121185507
Indiana,102.884568973642
Louisiana,113.44943038082381
Michigan,96.3166332425792
New Hampshire,82.68678043934634
Arizona,109.64577014936981
California,93.2219977518554
Colorado,90.80594676965518
Georgia,96.55458334148544
Wisconsin,93.1936525385241
Alaska,83.1343291892894
Kansas,89.95113875826729
Nebraska,93.41757348883557
West Virginia,134.7040655714731
Kentucky,94.62267354085364
Maine,85.24301426648185
Missouri,89.17689216788044
South Dakota,82.78193284825554
Washington,102.21900785046996
Rhode Island,91.74013630607047
Mississippi,110.38685412641186
Oregon,92.07550262671663
San Juan,361.1600438845385
Oklahoma,90.58936275851072
Carolina,118.61155203088131
Trujillo Alto,2040.5624934431328
New Mexico,90.19310294856498
Toa Baja,108.02498418769798
Dorado,133.8421632605731
Loíza,85.48387096774194
Minnesota,90.42832750511015
South Carolina,95.47395975225123
Iowa,92.50237522834108
Ohio,100.1957983798897
Mayagüez,129.1771202642994
North Carolina,111.00378212601817
North Dakota,88.55661024596189
Connecticut,87.30600764926567
Massachusetts,87.21982464135493
Utah,93.12673983869175
Idaho,84.46661050804317
Nevada,98.16257499733608
Wyoming,75.8881197240555
Ponce,91.56236721318227
Aguadilla,95.93904539313895
Vermont,102.79805757806194
Alabama,118.15181543509537
Bayamón,98.86868696240633
Arkansas,94.08798696727425
Canóvanas,111.11231184290489
Cataño,1977.1135751398201
Guaynabo,111.26805227548675
Hawaii,92.40890122239371
Hormigueros,72.03823210284625
Arecibo,239.5516220035041
Hatillo,38.851761427901465
Cabo Rojo,5.0
Moca,0.8264462809917356
Texas,89.86343251034103
Tennessee,96.22961807019112
Montana,80.417314727058
Toa Alta,1710.7408116079803
Query:
SELECT "region_name", "state_name", "percent_qualified"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   ORDER BY "percent_qualified" DESC
   LIMIT 100;
Answer:
region_name,state_name,percent_qualified
80262,Colorado,100.0
68430,Nebraska,100.0
86011,Arizona,100.0
11252,New York,100.0
32887,Florida,100.0
23273,Virginia,100.0
60117,Illinois,100.0
21250,Maryland,100.0
14653,New York,100.0
73125,Oklahoma,100.0
46706,Indiana,100.0
76078,Texas,100.0
92132,California,100.0
07699,New Jersey,100.0
20722,Maryland,100.0
56393,Minnesota,100.0
19383,Pennsylvania,100.0
29409,South Carolina,100.0
70504,Louisiana,100.0
39595,Mississippi,100.0
35899,Alabama,100.0
74141,Oklahoma,100.0
83725,Idaho,100.0
72183,Arkansas,100.0
46118,Indiana,100.0
50012,Iowa,100.0
92249,California,100.0
57197,South Dakota,100.0
45750,Ohio,100.0
12222,New York,100.0
25306,West Virginia,100.0
99258,Washington,100.0
55020,Minnesota,100.0
80938,Colorado,100.0
13220,New York,100.0
48916,Michigan,100.0
07097,New Jersey,100.0
20748,Maryland,100.0
32511,Florida,100.0
47141,Indiana,100.0
20064,District of Columbia,100.0
38356,Tennessee,100.0
38132,Tennessee,100.0
78152,Texas,100.0
27110,North Carolina,100.0
75033,Texas,100.0
56563,Minnesota,100.0
28810,North Carolina,100.0
75799,Texas,100.0
66621,Kansas,100.0
11953,New York,100.0
24022,Virginia,100.0
23668,Virginia,100.0
79525,Texas,100.0
08544,New Jersey,100.0
98353,Washington,100.0
26506,West Virginia,100.0
17604,Pennsylvania,100.0
38166,Tennessee,100.0
50319,Iowa,100.0
95343,California,100.0
78150,Texas,100.0
63167,Missouri,100.0
32307,Florida,100.0
16565,Pennsylvania,100.0
36115,Alabama,100.0
10545,New York,100.0
30090,Georgia,100.0
76129,Texas,100.0
37310,Tennessee,100.0
37243,Tennessee,100.0
29217,South Carolina,100.0
25909,West Virginia,100.0
65216,Missouri,100.0
60173,Illinois,100.0
66050,Kansas,100.0
15082,Pennsylvania,100.0
99260,Washington,100.0
95381,California,100.0
77844,Texas,100.0
76574,Texas,100.0
50013,Iowa,100.0
77968,Texas,100.0
64170,Missouri,100.0
31999,Georgia,100.0
48436,Michigan,100.0
33321,Florida,100.0
33744,Florida,100.0
90073,California,100.0
45422,Ohio,100.0
79697,Texas,100.0
84132,Utah,100.0
84150,Utah,100.0
20418,District of Columbia,100.0
28228,North Carolina,100.0
76909,Texas,100.0
28394,North Carolina,100.0
73097,Oklahoma,100.0
78135,Texas,100.0
40041,Kentucky,100.0
Query:
SELECT "state_name", SUM("number_of_panels_total") AS "total_panel_count"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
   GROUP BY "state_name"
   LIMIT 100;
Answer:
state_name,total_panel_count
Pennsylvania,133691622
District of Columbia,3983844
New York,158794563
Delaware,10771425
Maryland,47690643
New Jersey,117024321
Virginia,74914378
Florida,463123814
Illinois,164256874
Indiana,93311273
Louisiana,80308875
Michigan,147876313
New Hampshire,9054358
Arizona,147450436
California,654784266
Colorado,69425443
Georgia,140138439
Wisconsin,82459475
Alaska,5462549
Kansas,36827430
Nebraska,21582607
West Virginia,11387665
Kentucky,47393349
Maine,7720530
Missouri,84085928
South Dakota,6377373
Washington,107938035
Rhode Island,13001474
Mississippi,32218920
Oregon,61617355
San Juan,3375014
Oklahoma,60560124
Carolina,1554053
Trujillo Alto,197851
New Mexico,29605361
Toa Baja,362967
Dorado,199501
Loíza,1693
Minnesota,65662303
South Carolina,79312131
Iowa,29953011
Ohio,171901350
Mayagüez,567212
North Carolina,124233257
North Dakota,8138951
Connecticut,43575214
Massachusetts,69012277
Utah,44105531
Idaho,23093899
Nevada,43616656
Wyoming,3848056
Ponce,1165041
Aguadilla,432711
Vermont,2012472
Alabama,77644088
Bayamón,2134598
Arkansas,36012747
Canóvanas,139475
Cataño,168020
Guaynabo,984133
Hawaii,19873246
Hormigueros,59807
Arecibo,306604
Hatillo,25246
Cabo Rojo,668
Moca,28
Texas,481747719
Tennessee,101762224
Montana,9189162
Toa Alta,73394
Query:
SELECT "state_name", SUM("kw_total") AS "total_kw_capacity"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   GROUP BY "state_name"
   LIMIT 100;
Answer:
state_name,total_kw_capacity
Pennsylvania,33251159.25
District of Columbia,984405.75
Indiana,23262116.25
Texas,120126382.5
California,163245792.0
South Carolina,19795985.0
New Jersey,29062474.25
New York,39464453.0
Minnesota,16366038.5
Ohio,42755588.25
Michigan,36847956.75
Colorado,17287707.0
Connecticut,10817473.0
Virginia,18683826.25
Wisconsin,20565986.75
Missouri,20954082.0
Nebraska,5373970.5
New Hampshire,2259352.25
Maryland,11890221.5
Arizona,36809602.0
West Virginia,2834139.75
Alabama,19324636.5
Illinois,40809249.25
Maine,1922317.75
Kentucky,11892554.0
Iowa,7477739.5
Wyoming,960816.75
North Carolina,30990744.25
Florida,115526433.0
Oregon,15377712.0
Alaska,1361806.25
Tennessee,25277072.25
Ponce,290701.5
Louisiana,20033662.5
Vermont,497191.0
Arkansas,8983466.75
Guaynabo,246735.75
San Juan,855785.75
Cataño,46577.75
New Mexico,7388077.0
Mississippi,8031754.25
Bayamón,524720.0
Carolina,370356.75
Aguadilla,108012.25
Arecibo,86303.5
Canóvanas,40117.75
Baja California,5.75
Massachusetts,17152331.0
Delaware,2685709.75
Washington,26939156.25
Rhode Island,3228525.0
Georgia,34913435.25
Oklahoma,15113975.5
Utah,10997189.0
South Dakota,1593092.75
Idaho,5756500.25
Nevada,10885004.0
Toa Baja,92763.0
Toa Alta,22168.75
Mayagüez,142803.0
Hormigueros,13652.0
Dorado,49813.5
Corozal,416.75
Moca,7.0
Montana,2295402.5
North Dakota,2032056.5
Trujillo Alto,49031.5
Hawaii,4958941.25
Kansas,9180990.0
Query:
SELECT "state_name", SUM("yearly_sunlight_kwh_total") AS "total_energy_potential_kwh"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
   GROUP BY "state_name"
   LIMIT 100;
Answer:
state_name,total_energy_potential_kwh
Pennsylvania,38210009215.75753
District of Columbia,1209717858.796045
New York,45100394878.669464
Delaware,3222438352.7232113
Maryland,14399236326.491217
New Jersey,34132296027.414562
Virginia,23169044381.25027
Florida,157971622252.88788
Illinois,47344747566.82309
Indiana,26928123257.6459
Louisiana,25885642034.581642
Michigan,40976609871.52639
Minnesota,18673751434.616875
New Hampshire,2555251276.171985
Texas,160458070556.08868
Arizona,59127893265.42813
California,243304846869.2128
Colorado,24667013678.519062
Mayagüez,202552659.3214233
Georgia,44737933517.87483
South Carolina,25692275291.33939
Iowa,8843145869.399496
Tennessee,31169276299.068554
Wisconsin,23542559983.903282
Alaska,1092118868.9737976
Kansas,11882464352.008951
Nebraska,6725165429.183444
West Virginia,3272165883.9079347
Kentucky,14048103923.893398
Connecticut,12438466928.172298
Idaho,7526956885.239657
Nevada,17236108170.27167
Wyoming,1302268164.5376706
Oregon,16514535968.386444
Mississippi,10408673466.612555
Aguadilla,160079112.7508179
Vermont,551942863.0689392
Carolina,553262399.3939757
Alabama,24759196398.25475
Bayamón,751085531.8753113
Arkansas,11362387314.959013
Canóvanas,49976173.3744995
Cataño,59578578.59686889
Guaynabo,342005084.6763794
New Mexico,12208818476.493713
Arecibo,110110577.36539914
Cabo Rojo,236279.58453979492
Ohio,48300160986.35466
North Carolina,39607264848.0049
Maine,2197957054.097583
Missouri,26123174340.937077
Massachusetts,19514148116.75344
North Dakota,2299032486.195364
South Dakota,1966083346.8824432
Utah,15249940379.663124
Rhode Island,3726814813.7138762
Ponce,385731295.9626892
San Juan,1177674698.0644774
Oklahoma,20218586198.69937
Toa Baja,128650286.23981933
Hormigueros,21266625.235290524
Dorado,70542741.78618774
Hatillo,9067192.223126221
Loíza,595043.1626098631
Moca,8580.857080078125
Montana,2711943864.901141
Washington,27475803851.394146
Toa Alta,25725431.5722229
Trujillo Alto,69008952.58372192
Hawaii,7415195492.54585
Query:
SELECT "state_name", SUM("carbon_offset_metric_tons") AS "total_carbon_offset"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   GROUP BY "state_name"
   LIMIT 100;
Answer:
state_name,total_carbon_offset
Pennsylvania,25546821.485438112
District of Columbia,759829.5491657511
Indiana,22222230.940975703
Texas,79820466.39724964
California,66878632.22406632
South Carolina,15057615.542086853
New Jersey,21299363.239696037
New York,21798509.3083663
Minnesota,9432736.4318702
Ohio,39776810.4632109
Michigan,32063411.389291123
Colorado,14960304.146578383
Connecticut,5347366.443614538
Virginia,14534537.81879123
Wisconsin,18493486.25400976
Missouri,20922455.46777513
Nebraska,3393835.347755131
New Hampshire,1104316.148032614
Maryland,9317029.141011486
Arizona,25357559.299180172
West Virginia,2696642.54367634
Alabama,15723425.934489228
Illinois,38776748.30638688
Maine,947591.4564713892
Kentucky,10935523.832197247
Iowa,4474350.521690872
Wyoming,399141.77153828304
North Carolina,23311951.92699679
Florida,84572912.49373843
Oregon,4384028.977048002
Alaska,448709.5001029908
Tennessee,23508638.5761802
Ponce,258970.92094872272
Louisiana,16083222.605670767
Vermont,236132.86981235372
Arkansas,7146339.221664687
Guaynabo,230594.4901825723
San Juan,804284.1778948521
Cataño,44405.254583877424
New Mexico,5184507.904926238
Mississippi,6657377.0431828415
Bayamón,497071.83661161206
Carolina,354839.38441194326
Aguadilla,107574.99307295939
Arecibo,83422.88329775061
Canóvanas,38726.67058507054
Baja California,0.0
Massachusetts,8399385.428188125
Delaware,2042260.7933182444
Washington,7293347.185103217
Rhode Island,1602800.1897457635
Georgia,26673519.941978436
Oklahoma,13653148.546175597
Utah,4044369.724602101
South Dakota,1047147.0385288498
Idaho,1995437.83571835
Nevada,6541464.54058874
Toa Baja,88532.11963429808
Toa Alta,21050.91074946186
Mayagüez,137284.59180836374
Hormigueros,13057.408935665711
Dorado,47415.8990148845
Corozal,395.7097278391667
Moca,5.774905113871622
Montana,720554.5926224514
North Dakota,1163339.1647784072
Trujillo Alto,46041.3645230469
Hawaii,4657525.910539113
Kansas,8225046.27693307
Query:
SELECT 
     "state_name", 
     SUM("count_qualified") AS "total_count_qualified",
     SUM("existing_installs_count") AS "total_existing_installs",
     (SUM("count_qualified") - SUM("existing_installs_count")) AS "gap_in_potential_installations"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
   GROUP BY "state_name"
   LIMIT 100;
Answer:
state_name,total_count_qualified,total_existing_installs,gap_in_potential_installations
Pennsylvania,1956097,4408,1951689
District of Columbia,76464,442,76022
New York,2506035,18795,2487240
Delaware,147535,88,147447
Maryland,705813,6071,699742
New Jersey,1632773,12655,1620118
Virginia,963792,2409,961383
Florida,4817871,105364,4712507
Illinois,2055456,2453,2053003
Indiana,1117000,988,1116012
Louisiana,865003,8223,856780
Michigan,1847255,1720,1845535
New Hampshire,107103,262,106841
Arizona,1754534,39726,1714808
California,8617901,331818,8286083
Colorado,1032067,24362,1007705
Georgia,1503687,1907,1501780
Wisconsin,900707,1914,898793
Alaska,57169,83,57086
Kansas,417333,738,416595
Nebraska,283467,210,283257
West Virginia,155047,80,154967
Kentucky,575985,723,575262
Maine,100065,360,99705
Missouri,1032104,2864,1029240
South Dakota,72867,21,72846
Washington,1511814,5759,1506055
Rhode Island,203167,371,202796
Mississippi,325095,356,324739
Oregon,773130,8653,764477
San Juan,44341,0,44341
Oklahoma,701280,802,700478
Carolina,19688,0,19688
Trujillo Alto,2873,0,2873
New Mexico,365962,3749,362213
Toa Baja,6517,0,6517
Dorado,3067,0,3067
Loíza,40,0,40
Minnesota,770077,1518,768559
South Carolina,908394,1266,907128
Iowa,350284,248,350036
Ohio,2194900,2845,2192055
Mayagüez,7284,0,7284
North Carolina,1416843,2911,1413932
North Dakota,77129,24,77105
Connecticut,608869,5284,603585
Massachusetts,1002203,15369,986834
Utah,573155,3166,569989
Idaho,311878,529,311349
Nevada,569461,12746,556715
Wyoming,53090,29,53061
Ponce,18091,0,18091
Aguadilla,5852,0,5852
Vermont,19530,131,19399
Alabama,814213,547,813666
Bayamón,33466,0,33466
Arkansas,370016,239,369777
Canóvanas,2099,0,2099
Cataño,2764,0,2764
Guaynabo,11603,0,11603
Hawaii,204390,25392,178998
Hormigueros,1264,0,1264
Arecibo,3962,0,3962
Hatillo,224,0,224
Cabo Rojo,2,0,2
Moca,1,0,1
Texas,5480573,14139,5466434
Tennessee,1105463,1312,1104151
Montana,118683,262,118421
Toa Alta,1345,0,1345
Query:
SELECT 
  'Postal Code' AS "Level",
  "state_name", 
  AVG("percent_qualified") AS "average_percent_qualified"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
GROUP BY "state_name"

UNION ALL

SELECT 
  'Census Tract' AS "Level",
  "state_name", 
  AVG("percent_qualified") AS "average_percent_qualified"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
GROUP BY "state_name"
LIMIT 100;
Answer:
Level,state_name,average_percent_qualified
Postal Code,Pennsylvania,79.50152162654109
Postal Code,District of Columbia,75.11488176242611
Postal Code,Indiana,80.98704273615954
Postal Code,Texas,89.34929795432053
Postal Code,California,88.4105249868377
Postal Code,South Carolina,80.08563002130781
Postal Code,New Jersey,76.2982184524033
Postal Code,Maryland,78.2143673837333
Postal Code,Ohio,82.39723759334927
Postal Code,Illinois,81.22551550568912
Postal Code,Colorado,83.07765032579091
Postal Code,Massachusetts,73.94909266069027
Postal Code,Maine,63.63666881149767
Postal Code,Connecticut,72.29881131803253
Postal Code,Virginia,77.44664178774818
Postal Code,West Virginia,82.71154300892732
Postal Code,Wisconsin,80.06679188975762
Postal Code,Missouri,82.55774214780111
Postal Code,Washington,84.03996306007777
Postal Code,Rhode Island,75.47806245993253
Postal Code,New Hampshire,68.14373199300624
Postal Code,New York,77.40818366695984
Postal Code,Alabama,81.88299169012126
Postal Code,Nebraska,86.8810104386528
Postal Code,Kentucky,86.85440770148307
Postal Code,North Carolina,76.831511026237
Postal Code,Georgia,76.48404856671779
Postal Code,Oregon,85.56283254708075
Postal Code,Oklahoma,90.6883086147428
Postal Code,South Dakota,76.16484077656688
Postal Code,San Juan,91.33009202920341
Postal Code,New Mexico,90.66469204457194
Postal Code,Mississippi,82.19166818603286
Postal Code,Toa Baja,89.3900563813429
Postal Code,Trujillo Alto,88.81837244579282
Postal Code,Carolina,93.41220105410265
Postal Code,Dorado,93.84379785604901
Postal Code,Baja California,20.0
Postal Code,Minnesota,72.02677785988112
Postal Code,Michigan,79.04143589637175
Postal Code,Delaware,79.87848539811428
Postal Code,Montana,74.89138821125225
Postal Code,Wyoming,78.76528710918183
Postal Code,Kansas,83.90980882904063
Postal Code,Florida,90.85016886522146
Postal Code,Alaska,78.00984454758942
Postal Code,Tennessee,83.65948527656543
Postal Code,Ponce,91.44872619683593
Postal Code,Louisiana,85.77600943642517
Postal Code,Vermont,79.5994775409519
Postal Code,Arkansas,80.53295880502695
Postal Code,Guaynabo,88.43952681035891
Postal Code,Idaho,85.81752126830317
Postal Code,Nevada,92.41557021018671
Postal Code,Cataño,91.19644888529244
Postal Code,Bayamón,91.28405960797262
Postal Code,Aguadilla,94.31143379125443
Postal Code,Arecibo,93.40742399641678
Postal Code,Hawaii,94.93133340007105
Postal Code,Hormigueros,91.84615384615384
Postal Code,Corozal,93.75
Postal Code,Moca,100.0
Postal Code,Arizona,93.81479777093914
Postal Code,Iowa,78.45999338382977
Postal Code,Utah,85.93581601402273
Postal Code,North Dakota,80.68802648949998
Postal Code,Toa Alta,89.33969769291966
Postal Code,Canóvanas,89.42622950819673
Postal Code,Mayagüez,91.3667202708606
Census Tract,Pennsylvania,68.85707992410286
Census Tract,District of Columbia,63.397058540850374
Census Tract,New York,70.3824007333638
Census Tract,Delaware,71.13500821025055
Census Tract,Maryland,69.81305560602681
Census Tract,New Jersey,72.49284036555349
Census Tract,Virginia,70.29803660202286
Census Tract,Florida,83.27936582037172
Census Tract,Illinois,75.0703988032207
Census Tract,Indiana,74.4162992494216
Census Tract,Louisiana,82.17435382731469
Census Tract,Michigan,72.87447311567932
Census Tract,New Hampshire,67.9415712418198
Census Tract,South Carolina,73.39684628969717
Census Tract,Arizona,90.40516782276116
Census Tract,California,84.42610938177201
Census Tract,Colorado,80.52159958927903
Census Tract,Iowa,67.55135102465916
Census Tract,Ohio,76.22748275975313
Census Tract,Georgia,68.60191456870614
Census Tract,Texas,83.60340471279187
Census Tract,Mayagüez,88.31524322675783
Census Tract,Tennessee,76.27267213792194
Census Tract,Wisconsin,74.55363214741563
Census Tract,Kansas,74.45838191092518
Census Tract,Maine,65.17547802899195
Census Tract,Nebraska,80.62010526352871
Census Tract,West Virginia,71.8114182883734
Census Tract,Missouri,76.3366899845083
Census Tract,Montana,72.27714051202193
Census Tract,South Dakota,73.1301178566635
Query:
SELECT 
  "region_name", 
  "state_name", 
  "count_qualified", 
  "existing_installs_count",
  ("count_qualified" - "existing_installs_count") AS "gap_in_potential_installations"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
LIMIT 100
Answer:
region_name,state_name,count_qualified,existing_installs_count,gap_in_potential_installations
19149,Pennsylvania,4602,3,4599
19120,Pennsylvania,6086,2,6084
19132,Pennsylvania,5157,0,5157
19134,Pennsylvania,7551,3,7548
19138,Pennsylvania,4256,3,4253
19143,Pennsylvania,7093,10,7083
19148,Pennsylvania,7885,2,7883
19131,Pennsylvania,4590,6,4584
19133,Pennsylvania,3545,2,3543
19139,Pennsylvania,4874,2,4872
19140,Pennsylvania,6871,2,6869
19141,Pennsylvania,3528,4,3524
19142,Pennsylvania,2701,12,2689
19145,Pennsylvania,6147,11,6136
19146,Pennsylvania,6749,1,6748
19150,Pennsylvania,3872,11,3861
19151,Pennsylvania,3518,4,3514
19125,Pennsylvania,4917,7,4910
19135,Pennsylvania,4824,10,4814
19147,Pennsylvania,6785,5,6780
20002,District of Columbia,6154,9,6145
20003,District of Columbia,1946,3,1943
46704,Indiana,23,0,23
75371,Texas,20,0,20
92386,California,172,0,172
15629,Pennsylvania,141,0,141
19023,Pennsylvania,3413,8,3405
19121,Pennsylvania,5961,2,5959
19124,Pennsylvania,7649,5,7644
19126,Pennsylvania,2172,5,2167
19144,Pennsylvania,6860,7,6853
20001,District of Columbia,3636,2,3634
29920,South Carolina,15,0,15
08104,New Jersey,3698,10,3688
12512,New York,16,0,16
19082,Pennsylvania,5331,7,5324
19119,Pennsylvania,4821,20,4801
19127,Pennsylvania,1830,3,1827
19130,Pennsylvania,3810,5,3805
19604,Pennsylvania,4723,3,4720
20010,District of Columbia,3021,8,3013
20011,District of Columbia,10516,36,10480
46393,Indiana,22,0,22
55417,Minnesota,4881,30,4851
08102,New Jersey,1005,1,1004
08103,New Jersey,2518,3,2515
08611,New Jersey,4735,4,4731
11215,New York,5972,10,5962
11233,New York,5046,2,5044
11379,New York,6142,1,6141
11419,New York,5702,4,5698
11428,New York,3702,2,3700
11451,New York,12,0,12
15224,Pennsylvania,2804,5,2799
17019,Pennsylvania,15,0,15
19122,Pennsylvania,2899,7,2892
19129,Pennsylvania,1621,5,1616
19602,Pennsylvania,2941,3,2938
20009,District of Columbia,3251,10,3241
21239,Maryland,6831,6,6825
55412,Minnesota,4693,14,4679
55805,Minnesota,2272,0,2272
55807,Minnesota,3931,0,3931
07756,New Jersey,1150,0,1150
11105,New York,3809,5,3804
11216,New York,4016,0,4016
11217,New York,2862,0,2862
11370,New York,2925,0,2925
11412,New York,6617,5,6612
11417,New York,4160,5,4155
11421,New York,4388,0,4388
11436,New York,2971,1,2970
11802,New York,13,0,13
14619,New York,3363,1,3362
15110,Pennsylvania,2079,4,2075
15203,Pennsylvania,3075,3,3072
15208,Pennsylvania,2766,8,2758
15210,Pennsylvania,7989,6,7983
18102,Pennsylvania,8980,2,8978
19079,Pennsylvania,1944,3,1941
19104,Pennsylvania,4612,15,4597
19601,Pennsylvania,6056,3,6053
20007,District of Columbia,4317,15,4302
20017,District of Columbia,3848,15,3833
20782,Maryland,351,2,349
21229,Maryland,12459,2,12457
21230,Maryland,11451,8,11443
35043,Alabama,8,0,8
43608,Ohio,5648,0,5648
43610,Ohio,1479,0,1479
44123,Ohio,4808,11,4797
45147,Ohio,9,0,9
48146,Michigan,13114,0,13114
48223,Michigan,5378,0,5378
48224,Michigan,12218,7,12211
48227,Michigan,12513,2,12511
48915,Michigan,2654,3,2651
49507,Michigan,7778,11,7767
55104,Minnesota,6959,33,6926
55406,Minnesota,6992,39,6953
Query:
SELECT "state_name", MEDIAN("number_of_panels_median") AS "median_number_of_panels"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
GROUP BY "state_name"
LIMIT 100
Answer:
state_name,median_number_of_panels
Connecticut,31.000
Alabama,47.000
Louisiana,53.000
Cataño,30.000
Michigan,35.000
Missouri,38.000
New Mexico,54.000
Hatillo,64.500
Guaynabo,48.500
Arkansas,48.000
Hawaii,68.000
Hormigueros,41.000
Arecibo,45.000
Nebraska,36.000
Dorado,43.000
Illinois,31.000
Idaho,46.000
Alaska,39.000
San Juan,44.000
Kentucky,41.000
Trujillo Alto,41.500
Maine,27.000
West Virginia,36.000
Arizona,59.000
Washington,41.000
Montana,39.000
Bayamón,46.000
South Dakota,38.000
California,47.000
Kansas,38.000
Delaware,33.000
Pennsylvania,28.000
Oklahoma,53.000
Maryland,29.000
Carolina,52.000
Ohio,35.000
Wyoming,36.000
North Dakota,45.000
Iowa,33.000
Utah,43.000
Colorado,35.000
Oregon,46.000
Toa Baja,39.000
Moca,28.000
Vermont,30.500
Mississippi,51.000
Cabo Rojo,79.000
New York,28.000
Aguadilla,48.000
Georgia,41.000
Minnesota,34.000
Indiana,39.000
Canóvanas,49.000
Rhode Island,28.000
Tennessee,45.000
Mayagüez,39.000
Florida,63.000
Texas,50.000
Massachusetts,28.000
Toa Alta,44.000
North Carolina,38.000
District of Columbia,19.500
Nevada,48.000
New Hampshire,30.000
South Carolina,44.000
Virginia,33.000
Loíza,29.000
New Jersey,29.000
Wisconsin,36.000
Ponce,42.000
Query:
SELECT "install_size_kw_buckets", COUNT(*) AS "bucket_count"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
GROUP BY "install_size_kw_buckets"
LIMIT 100
Answer:
Too long, hard cut:
install_size_kw_buckets,bucket_count
"[[0,3888],[5,430],[10,80],[15,39],[20,24],[25,12],[30,7],[35,14],[40,7],[45,8],[50,3],[55,5],[60,6],[65,7],[70,1],[75,7],[80,2],[85,1],[90,4],[95,2],[100,4],[105,2],[110,1],[120,1],[125,3],[130,1],[135,1],[140,2],[145,1],[155,1],[160,2],[165,2],[190,2],[195,1],[220,1],[240,1],[285,2],[290,2],[300,1],[305,1],[320,1],[330,1],[340,1],[380,1],[385,1],[430,1],[445,1],[460,1],[475,1],[560,2],[565,1],[570,1],[575,1],[640,1],[735,1],[750,1],[830,1],[875,1],[1070,1],[1240,1],[1305,1],[1320,1]]",1
"[[0,4877],[5,722],[10,107],[15,67],[20,40],[25,37],[30,34],[35,18],[40,14],[45,11],[50,11],[55,8],[60,7],[65,9],[70,9],[75,5],[80,5],[85,6],[90,4],[95,5],[100,7],[105,3],[110,4],[115,1],[120,5],[125,5],[130,2],[135,1],[140,2],[145,3],[150,2],[155,3],[160,3],[165,1],[175,2],[180,3],[185,1],[190,1],[195,2],[200,1],[220,1],[230,1],[235,1],[240,3],[255,2],[265,1],[295,1],[300,2],[315,1],[320,2],[345,1],[350,1],[365,1],[385,1],[410,1],[415,1],[435,1],[445,1],[755,1],[810,1],[815,1],[820,1],[865,1],[960,1],[1110,1],[1140,1],[1180,1],[1230,1],[1300,1],[1345,1],[1995,1],[2220,1],[4045,1]]",1
"[[0,4250],[5,463],[10,78],[15,68],[20,37],[25,24],[30,22],[35,23],[40,18],[45,16],[50,12],[55,9],[60,14],[65,6],[70,7],[75,5],[80,4],[85,6],[90,7],[100,7],[105,2],[110,2],[115,2],[120,5],[125,3],[130,1],[135,3],[140,2],[150,2],[155,1],[160,3],[165,3],[170,2],[180,3],[185,1],[195,4],[200,1],[215,2],[235,1],[245,1],[250,1],[255,2],[260,1],[270,1],[285,3],[305,1],[315,1],[325,1],[355,1],[360,1],[375,2],[390,1],[400,1],[445,2],[450,2],[460,1],[470,1],[475,1],[480,1],[510,2],[525,1],[610,1],[680,1],[730,1],[790,1],[840,1],[845,1],[890,1],[1080,1],[1465,1]]",1
"[[0,3505],[5,529],[10,57],[15,29],[20,12],[25,16],[30,7],[35,8],[40,7],[45,10],[50,7],[55,7],[60,4],[65,5],[70,4],[75,3],[80,4],[85,3],[90,5],[95,4],[115,4],[125,2],[130,2],[140,1],[150,1],[165,1],[170,1],[185,1],[195,1],[210,1],[235,1],[240,1],[255,1],[265,1],[275,1],[285,1],[335,1],[355,1],[400,1],[485,1],[505,1],[630,1],[715,1],[780,1],[1445,1]]",1
"[[0,5598],[5,972],[10,126],[15,66],[20,38],[25,46],[30,27],[35,31],[40,22],[45,12],[50,15],[55,13],[60,4],[65,10],[70,9],[75,6],[80,5],[85,3],[90,8],[95,6],[100,6],[105,6],[110,3],[115,1],[120,3],[125,4],[130,2],[135,4],[140,2],[150,1],[165,2],[170,1],[175,3],[180,1],[185,1],[200,1],[210,2],[215,1],[225,1],[230,1],[250,1],[260,1],[270,1],[275,1],[285,3],[290,1],[295,1],[310,1],[325,2],[335,1],[340,2],[350,2],[480,1],[495,1],[505,1],[510,1],[560,1],[635,1],[690,1],[700,1],[830,1],[910,1],[1035,1],[1145,1],[2275,1]]",1
"[[0,6679],[5,727],[10,91],[15,40],[20,48],[25,30],[30,24],[35,27],[40,6],[45,13],[50,11],[55,11],[60,4],[65,12],[70,4],[75,3],[80,3],[85,3],[90,4],[95,3],[100,5],[105,5],[110,1],[115,1],[120,3],[125,5],[130,3],[135,4],[145,2],[150,2],[155,2],[160,1],[165,1],[170,3],[175,3],[180,1],[185,1],[190,1],[195,3],[210,1],[215,2],[220,1],[225,1],[230,1],[235,2],[240,1],[245,1],[260,1],[270,2],[285,3],[300,3],[310,1],[320,1],[335,1],[355,2],[360,3],[380,1],[410,1],[420,2],[425,2],[450,2],[475,2],[485,1],[495,1],[515,1],[525,1],[530,2],[590,3],[600,1],[630,1],[670,1],[675,1],[680,1],[690,1],[695,1],[720,1],[745,2],[760,1],[790,1],[800,1],[845,1],[875,1],[880,1],[885,1],[895,1],[955,1],[970,1],[1005,1],[1020,1],[1100,1],[1105,1],[1160,1],[1260,1],[1315,1],[1345,1],[1375,1],[1400,1],[1415,1],[1470,1],[1475,1],[1510,1],[1550,1],[1620,1],[1775,1],[1785,1],[1865,1],[1915,1],[2040,1],[2075,1],[2180,1],[2225,1],[2530,1],[2600,1],[2895,1],[3025,1],[3760,1]]",1
"[[0,3378],[5,690],[10,128],[15,48],[20,52],[25,31],[30,19],[35,23],[40,22],[45,18],[50,12],[55,14],[60,8],[65,7],[70,12],[75,4],[80,9],[85,9],[90,3],[95,2],[100,9],[105,3],[110,5],[115,2],[120,4],[125,2],[130,2],[135,1],[140,1],[145,1],[155,2],[160,1],[170,2],[175,1],[190,2],[195,1],[200,2],[205,1],[210,1],[215,3],[220,4],[230,1],[235,2],[240,3],[255,1],[260,1],[265,2],[275,1],[280,2],[285,2],[300,1],[310,3],[315,2],[325,1],[330,5],[340,1],[375,1],[430,1],[435,1],[450,1],[455,2],[475,1],[490,1],[505,1],[520,1],[535,1],[565,1],[570,1],[575,1],[600,1],[795,1],[1080,2],[1380,1],[1705,1],[1855,1],[1915,1],[2415,1]]",1
"[[0,2607],[5,487],[10,133],[15,72],[20,38],[25,27],[30,29],[35,12],[40,10],[45,12],[50,12],[55,10],[60,6],[65,9],[70,2],[75,7],[80,2],[85,4],[90,4],[95,4],[100,3],[105,4],[110,6],[115,3],[120,1],[125,2],[130,6],[135,1],[140,2],[145,1],[165,2],[170,2],[185,1],[195,1],[205,1],[220,2],[245,1],[250,1],[255,1],[265,2],[270,1],[285,1],[290,1],[310,1],[315,1],[345,2],[355,2],[405,1],[430,1],[470,1],[540,1],[665,1],[920,1]]",1
"[[0,3659],[5,731],[10,139],[15,59],[20,46],[25,38],[30,18],[35,18],[40,17],[45,19],[50,9],[55,9],[60,9],[65,4],[70,13],[75,2],[80,4],[85,9],[90,7],[95,3],[100,6],[105,3],[110,2],[115,5],[120,4],[125,2],[130,4],[140,3],[180,1],[185,3],[190,1],[200,1],[210,2],[215,1],[220,2],[225,3],[230,1],[245,1],[250,1],[255,1],[290,1],[305,1],[335,1],[380,2],[390,1],[395,1],[440,1],[550,1],[580,1],[585,1],[660,1],[665,1],[1175,1]]",1
"[[0,5115
Query:
SELECT "state_name", AVG("yearly_sunlight_kwh_median") AS "average_yearly_sunlight_kwh"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
GROUP BY "state_name"
LIMIT 100
Answer:
state_name,average_yearly_sunlight_kwh
Pennsylvania,9643.047403007866
District of Columbia,9514.323124778663
New York,11093.792310801535
Delaware,10057.36443677757
Maryland,11161.535303257713
New Jersey,10394.262440316692
Virginia,13040.666091308594
Florida,24541.627243367817
Illinois,11417.816564532395
Indiana,12829.933978565334
Louisiana,19441.814748488323
Michigan,12534.093277310458
New Hampshire,11578.558432345919
Arizona,25071.09679438814
California,19149.373890872685
Colorado,14501.3668164782
Georgia,14416.70793691221
Wisconsin,11486.317770096628
Alaska,8789.765452332427
Kansas,15698.781374080365
Nebraska,13440.423525555927
West Virginia,10610.454969409904
Kentucky,13072.243304568385
Maine,25123.13149682247
Missouri,13973.240147076636
South Dakota,12645.321630859375
Washington,11385.175842700985
Rhode Island,9028.114988841826
Mississippi,17062.547867509795
Oregon,12711.51839672151
San Juan,19034.957988427734
Oklahoma,18208.698548691405
Carolina,24880.327637039987
Trujillo Alto,14657.183436075846
New Mexico,23045.631883087684
Toa Baja,16328.209805779707
Dorado,17231.117614746094
Loíza,9965.285552978516
Minnesota,10533.378695985572
South Carolina,17096.240484834998
Iowa,12093.35045615048
Ohio,10723.76020789242
Mayagüez,34079.73861296281
North Carolina,13966.617514012105
North Dakota,13461.913795922508
Connecticut,9978.567484160709
Massachusetts,9911.338083498946
Utah,16446.945985440118
Idaho,14673.610809881036
Nevada,21108.910752677915
Wyoming,15494.68604844835
Ponce,20463.974993739983
Aguadilla,16741.20799560547
Vermont,12335.584613240559
Alabama,16139.44835956338
Bayamón,16767.01608472921
Arkansas,15400.135863785516
Canóvanas,73916.76190795898
Cataño,27304.21228271484
Guaynabo,16762.037924194337
Hawaii,31333.417513658052
Hormigueros,14105.9359375
Arecibo,19544.431766764323
Hatillo,22895.611621093747
Cabo Rojo,25563.86807861328
Moca,8580.857080078125
Texas,19073.854749166654
Tennessee,15277.01999564612
Montana,11876.52265702681
Toa Alta,15929.254949273005
Query:
SELECT "region_name", "state_name", "percent_covered"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
WHERE "percent_covered" < 50
LIMIT 100
Answer:
region_name,state_name,percent_covered
29920,South Carolina,1.0338680926916222
17019,Pennsylvania,0.38022813688212925
20782,Maryland,7.551852508420493
35043,Alabama,0.21151586368977673
02668,Massachusetts,3.2061068702290076
20745,Maryland,6.007782101167315
86325,Arizona,0.5327019828351583
03905,Maine,30.904183535762485
06470,Connecticut,0.6816917084028937
08085,New Jersey,0.3257771141577304
22201,Virginia,2.104791759964174
49649,Michigan,2.2151898734177213
61731,Illinois,11.842105263157896
98323,Washington,14.502164502164502
02835,Rhode Island,11.750972762645915
18621,Pennsylvania,1.5924719507781397
56465,Minnesota,28.07017543859649
65631,Missouri,6.1686298822070675
02739,Massachusetts,4.464714354296688
04345,Maine,32.04930662557781
19464,Pennsylvania,0.48717948717948717
20912,Maryland,13.269465960048919
28125,North Carolina,1.2531328320802004
29850,South Carolina,34.883720930232556
55803,Minnesota,46.99020065328978
66012,Kansas,0.7031749414020882
02822,Rhode Island,5.445335584634867
03901,Maine,46.77980852915579
06782,Connecticut,4.930156121610517
07849,New Jersey,1.3465237702665567
15051,Pennsylvania,13.821138211382113
20712,Maryland,41.397495056031644
20816,Maryland,12.475859405175743
29696,South Carolina,0.5529225908372828
35147,Alabama,21.82244818146265
47932,Indiana,1.1637347767253046
61025,Illinois,37.66632548618219
02632,Massachusetts,16.295242611032084
02814,Rhode Island,6.1553653719552335
03303,New Hampshire,42.257897462454686
08020,New Jersey,3.504482477587612
10465,New York,9.297052154195011
10516,New York,41.46537842190016
11050,New York,44.93144769513117
13612,New York,4.738760631834751
19931,Delaware,43.90243902439025
20743,Maryland,20.33869165305596
27006,North Carolina,0.3709863118843546
32531,Florida,5.2631578947368425
48157,Michigan,35.22727272727273
59417,Montana,13.809854267869534
01982,Massachusetts,45.65077319587629
03870,New Hampshire,38.47389558232932
07843,New Jersey,23.407286790148586
20740,Maryland,46.65918923249479
20815,Maryland,20.863013698630137
21044,Maryland,13.403880070546737
35004,Alabama,3.033894287745911
50134,Iowa,24.07045009784736
52338,Iowa,2.542764678687009
54874,Wisconsin,3.7788663400979705
73007,Oklahoma,0.39281705948372614
77358,Texas,5.504345535949434
77363,Texas,0.8048937540244687
01237,Massachusetts,34.09090909090909
01238,Massachusetts,3.0885780885780885
01516,Massachusetts,24.22245651027939
01534,Massachusetts,4.6853468075333025
01588,Massachusetts,27.997546764796073
02673,Massachusetts,48.58019953952417
02770,Massachusetts,36.91470054446461
04252,Maine,4.492362982929021
08876,New Jersey,46.291246250340876
22832,Virginia,17.70334928229665
37710,Tennessee,21.267893660531698
47920,Indiana,7.818411097099622
49014,Michigan,43.90221402214022
75652,Texas,1.2139997417021826
80512,Colorado,18.83248730964467
01569,Massachusetts,47.31525784157363
03840,New Hampshire,48.887343532684284
04473,Maine,24.013157894736842
07035,New Jersey,45.06535947712418
07442,New Jersey,26.64092664092664
15840,Pennsylvania,44.26623897353649
15851,Pennsylvania,26.95302687766893
17268,Pennsylvania,0.8750163249314353
18077,Pennsylvania,4.964114832535885
21156,Maryland,14.754098360655737
22043,Virginia,36.265975180588995
24431,Virginia,18.444266238973537
26062,West Virginia,32.30444532383591
31636,Georgia,0.20261143628995948
40177,Kentucky,10.864745011086475
43443,Ohio,4.627249357326479
48161,Michigan,5.7652597670768975
49017,Michigan,48.85699641209636
53115,Wisconsin,0.20105820105820105
57730,South Dakota,45.19735341090577
64421,Missouri,2.088772845953003
Query:
SELECT "state_name", SUM("carbon_offset_metric_tons") AS "total_carbon_offset"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
GROUP BY "state_name"
ORDER BY "total_carbon_offset" DESC
LIMIT 100
Answer:
state_name,total_carbon_offset
Florida,84762071.96637787
Texas,80026572.09620419
California,67060256.559903376
Ohio,39985118.69480568
Illinois,39019478.60061418
Michigan,32170938.26439564
Georgia,26767856.473523576
Pennsylvania,25679219.804377407
Arizona,25393752.120932452
Tennessee,23662867.396383427
North Carolina,23363984.23961253
Indiana,22286009.07525565
New York,21932730.052032903
New Jersey,21441825.25895091
Missouri,20988770.94279073
Wisconsin,18538719.211838692
Louisiana,16119065.632724501
Alabama,15792877.15528395
South Carolina,15082325.953191794
Colorado,15019343.801609265
Virginia,14570516.612738723
Oklahoma,13676736.482410647
Kentucky,10893849.027434926
Minnesota,9461269.60415691
Maryland,9341908.182602106
Massachusetts,8448829.99986072
Kansas,8248164.19414453
Washington,7305348.121577986
Arkansas,7162306.228122597
Mississippi,6675246.399348796
Nevada,6552267.614581583
Connecticut,5385610.014692117
New Mexico,5193766.818696551
Hawaii,4666457.0008377
Iowa,4480709.137428612
Oregon,4391352.901025
Utah,4055086.38298331
Nebraska,3407555.482436877
West Virginia,2708875.483437571
Delaware,2047732.7107329231
Idaho,2001480.6360385297
Rhode Island,1613670.238764769
North Dakota,1164890.4157271704
New Hampshire,1106392.337547703
South Dakota,1047973.7956763804
Maine,951467.7454093618
San Juan,792573.4658976337
District of Columbia,768728.0745405239
Montana,721128.5004524508
Bayamón,505479.538757477
Alaska,449958.7974072519
Wyoming,399567.8100756294
Carolina,372344.8403529482
Ponce,259596.63619231156
Vermont,238985.90700712064
Guaynabo,230168.9556225237
Mayagüez,136317.66351863468
Aguadilla,107733.02459435827
Toa Baja,86581.46720940567
Arecibo,74104.26841802277
Dorado,47475.16902867142
Trujillo Alto,46442.93098691624
Cataño,40096.302153202625
Canóvanas,33633.89653257158
Toa Alta,17313.180368415116
Hormigueros,14312.409783773295
Hatillo,6102.208001967081
Loíza,400.46323702419204
Cabo Rojo,159.01583819991797
Moca,5.774905113871622
Query:
SELECT "region_name", "state_name", "percent_qualified"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
ORDER BY "percent_qualified" ASC
LIMIT 100
Answer:
region_name,state_name,percent_qualified
60950,Illinois,0.0
10045,New York,0.0
49234,Michigan,0.0
21532,Maryland,0.0
24069,Virginia,0.0
80290,Colorado,0.0
24724,West Virginia,0.0
29058,South Carolina,0.0
80299,Colorado,0.0
92305,California,0.0
84310,Utah,0.0
33849,Florida,0.0
48674,Michigan,0.0
43002,Ohio,0.0
07456,New Jersey,0.0
28357,North Carolina,0.0
57032,South Dakota,0.0
37015,Tennessee,0.0
20303,District of Columbia,0.0
95007,California,2.7777777777777777
81415,Colorado,11.11111111111111
10173,New York,12.5
92391,California,12.987012987012987
92386,California,13.97238017871649
64060,Missouri,14.285714285714286
10123,New York,17.24137931034483
92325,California,17.906865098415746
86005,Arizona,18.272425249169434
15545,Pennsylvania,20.0
22400,Baja California,20.0
70764,Louisiana,20.0
10105,New York,20.0
46965,Indiana,20.0
92321,California,22.15435868961688
95389,California,22.519083969465647
92378,California,23.568281938325992
07878,New Jersey,24.216524216524217
10176,New York,25.0
50648,Iowa,25.0
30072,Georgia,25.0
02672,Massachusetts,25.0
59411,Montana,25.510204081632654
55090,Minnesota,25.700934579439252
92352,California,26.010973379394432
20880,Maryland,26.424870466321245
95959,California,27.04703832752613
62716,Illinois,27.272727272727273
19149,Pennsylvania,27.44349692885682
10155,New York,27.77777777777778
95006,California,27.88586251621271
06927,Connecticut,28.0
04351,Maine,28.571428571428573
10174,New York,28.571428571428573
19142,Pennsylvania,29.15272531030761
80025,Colorado,30.0
84773,Utah,30.0
46124,Indiana,30.357142857142858
10120,New York,30.434782608695652
21032,Maryland,30.778663396689147
19120,Pennsylvania,31.392170010832
27599,North Carolina,31.764705882352942
92315,California,31.798715203426124
12498,New York,32.18390804597701
92333,California,33.2511100148002
06338,Connecticut,33.333333333333336
18660,Pennsylvania,33.333333333333336
53167,Wisconsin,33.333333333333336
65738,Missouri,33.333333333333336
81334,Colorado,33.333333333333336
46937,Indiana,33.333333333333336
29697,South Carolina,33.333333333333336
32706,Florida,33.333333333333336
19110,Pennsylvania,33.333333333333336
20777,Maryland,33.333333333333336
19132,Pennsylvania,33.55019191984907
19143,Pennsylvania,33.79228203906622
66205,Kansas,33.839300445471046
19151,Pennsylvania,34.46654256882532
20896,Maryland,34.962406015037594
19139,Pennsylvania,35.15326361341507
19134,Pennsylvania,35.15690473973368
66208,Kansas,35.473707083876576
92314,California,35.84478222741888
18353,Pennsylvania,36.36363636363637
58505,North Dakota,36.36363636363637
10017,New York,36.458333333333336
12572,New York,36.69724770642202
95018,California,36.88656476267096
19138,Pennsylvania,37.186544342507645
03224,New Hampshire,37.5
84763,Utah,37.5
19131,Pennsylvania,38.040775733465935
59937,Montana,38.101788170563964
57751,South Dakota,38.20459290187891
56465,Minnesota,38.28125
19124,Pennsylvania,38.31012721626765
19145,Pennsylvania,38.368391486174396
23235,Virginia,38.400812881037986
19140,Pennsylvania,38.402638050525375
07046,New Jersey,38.43821076573162
Query:
SELECT "state_name", AVG("kw_total") AS "average_kw_capacity"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
GROUP BY "state_name"
LIMIT 100
Answer:
state_name,average_kw_capacity
Pennsylvania,15416.469326568265
District of Columbia,5858.594117647059
New York,9892.509531522552
Delaware,17261.89903846154
Maryland,14244.517025089606
New Jersey,16172.515339966832
Virginia,17939.266762452105
Florida,32568.48199718706
Illinois,17609.01307890223
Indiana,25356.32418478261
Louisiana,26592.34271523179
Michigan,18958.501666666667
New Hampshire,15610.962068965517
Arizona,29372.596812749005
California,21814.50779584222
Colorado,18289.10511064278
Georgia,26723.577231121282
Wisconsin,23188.82874015748
Alaska,22026.407258064515
Kansas,23427.118320610687
Nebraska,19549.46286231884
West Virginia,16084.272598870057
Kentucky,23791.84186746988
Maine,15565.584677419354
Missouri,24995.81688466112
South Dakota,25307.035714285714
Washington,23322.825194468453
Rhode Island,16583.51275510204
Mississippi,27967.8125
Oregon,26977.826182136603
San Juan,6750.028
Oklahoma,25360.18592964824
Carolina,10224.032894736842
Trujillo Alto,4121.895833333333
New Mexico,27210.80974264706
Toa Baja,4775.881578947368
Dorado,7125.035714285715
Loíza,423.25
Minnesota,19472.80634638197
South Carolina,26021.040354330707
Iowa,22154.59393491124
Ohio,20681.10563041386
Mayagüez,6165.347826086957
North Carolina,22424.775631768953
North Dakota,31303.657692307694
Connecticut,16091.290251107828
Massachusetts,14377.557708333334
Utah,23510.410980810233
Idaho,34571.70508982036
Nevada,20809.47328244275
Wyoming,22905.095238095237
Ponce,7468.211538461538
Aguadilla,7211.85
Vermont,18634.0
Alabama,25574.469038208168
Bayamón,9200.853448275862
Arkansas,28949.15353697749
Canóvanas,4358.59375
Cataño,8401.0
Guaynabo,12301.6625
Hawaii,19715.521825396827
Hormigueros,3737.9375
Arecibo,8516.777777777777
Hatillo,3155.75
Cabo Rojo,167.0
Moca,7.0
Texas,30505.807940729483
Tennessee,26864.36747624076
Montana,22522.45588235294
Toa Alta,2038.7222222222222
Query:
SELECT "state_name", SUM("existing_installs_count") AS "total_existing_installations"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
GROUP BY "state_name"
LIMIT 100
Answer:
state_name,total_existing_installations
Pennsylvania,4402
District of Columbia,442
Indiana,987
Texas,14127
California,331274
South Carolina,1263
New Jersey,12628
Maryland,6064
Ohio,2840
Illinois,2447
Colorado,24335
Massachusetts,15350
Maine,360
Connecticut,5268
Virginia,2407
West Virginia,80
Wisconsin,1913
Missouri,2854
Washington,5756
Rhode Island,371
New Hampshire,262
New York,18744
Alabama,544
Nebraska,209
Kentucky,725
North Carolina,2910
Georgia,1906
Oregon,8647
Oklahoma,802
South Dakota,21
San Juan,0
New Mexico,3749
Mississippi,356
Toa Baja,0
Trujillo Alto,0
Carolina,0
Dorado,0
Baja California,0
Minnesota,1517
Michigan,1717
Delaware,88
Montana,261
Wyoming,29
Kansas,737
Florida,105292
Alaska,83
Tennessee,1306
Ponce,0
Louisiana,8221
Vermont,131
Arkansas,239
Guaynabo,0
Idaho,529
Nevada,12738
Cataño,0
Bayamón,0
Aguadilla,0
Arecibo,0
Hawaii,25376
Hormigueros,0
Corozal,0
Moca,0
Arizona,39696
Iowa,248
Utah,3161
North Dakota,24
Toa Alta,0
Canóvanas,0
Mayagüez,0
Query:
SELECT 
  "region_name", 
  "state_name", 
  ("count_qualified" - "existing_installs_count") AS "gap_in_potential_installations"
FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
WHERE ("count_qualified" - "existing_installs_count") > 1000
LIMIT 100
Answer:
region_name,state_name,gap_in_potential_installations
42101003901,Pennsylvania,1001
42101002802,Pennsylvania,1220
42101003100,Pennsylvania,1145
42101004001,Pennsylvania,1016
42101004101,Pennsylvania,1070
42101017800,Pennsylvania,1052
42101016000,Pennsylvania,1415
42101016100,Pennsylvania,1034
42101020200,Pennsylvania,1052
42101025200,Pennsylvania,1150
34007602000,New Jersey,1039
42101001300,Pennsylvania,1001
42101002900,Pennsylvania,1076
42101008500,Pennsylvania,1201
42101015800,Pennsylvania,1291
42101032500,Pennsylvania,1071
24005420500,Maryland,1027
42071001400,Pennsylvania,1067
24005451500,Maryland,1140
24005492300,Maryland,1392
24510260302,Maryland,2179
24510270801,Maryland,1143
24510270803,Maryland,1294
24510270805,Maryland,1484
24510270902,Maryland,1246
26049000900,Michigan,1043
26163524800,Michigan,1004
26163551600,Michigan,1187
26163575200,Michigan,1357
26163577200,Michigan,1164
26163577300,Michigan,1084
39035121700,Ohio,1421
39035171104,Ohio,1514
39095005703,Ohio,1055
42071000300,Pennsylvania,1287
42101015200,Pennsylvania,1029
42101021000,Pennsylvania,1337
42101021400,Pennsylvania,1168
42101030600,Pennsylvania,1094
06037535902,California,1118
06075035100,California,1551
17031490902,Illinois,1081
19113001700,Iowa,1484
24005401301,Maryland,1181
24510010100,Maryland,1098
24510200600,Maryland,1154
24510250205,Maryland,1231
24510250402,Maryland,1184
24510260501,Maryland,1048
24510270401,Maryland,1131
26049004000,Michigan,1217
26163501100,Michigan,1134
26163577600,Michigan,1377
26163581900,Michigan,1896
27053101200,Minnesota,1038
27053110800,Minnesota,1042
27123030201,Minnesota,1044
27123030800,Minnesota,1097
27137000900,Minnesota,1174
27137015800,Minnesota,1584
34003054400,New Jersey,1097
34025807400,New Jersey,1150
36059303302,New York,1001
36081054200,New York,1045
36081084000,New York,1057
36081161700,New York,1046
36081162100,New York,1033
39035152501,Ohio,1296
42003562400,Pennsylvania,1020
42013101700,Pennsylvania,1243
42045402100,Pennsylvania,1306
42045402800,Pennsylvania,1099
42101034803,Pennsylvania,1066
42129801500,Pennsylvania,1071
06037535802,California,1046
06075026100,California,1117
06075035201,California,1114
06075035300,California,1579
06075035400,California,1489
08001008000,Colorado,1121
08031000301,Colorado,1288
08031000502,Colorado,1094
08031000903,Colorado,1140
08031002300,Colorado,1209
08031002902,Colorado,1215
08031003602,Colorado,1067
08031004104,Colorado,1184
10003000200,Delaware,1268
11001000100,District of Columbia,1082
17031740300,Illinois,1070
24005420401,Maryland,1579
24005491600,Maryland,1020
24027606704,Maryland,1178
24510240100,Maryland,1046
24510250103,Maryland,1058
24510260102,Maryland,1257
24510260202,Maryland,1318
24510261000,Maryland,1267
24510270501,Maryland,1465
24510270802,Maryland,1212
End Exploring Related Columns
Task: Can you provide a detailed comparison of the solar potential for each state, distinguishing between postal code and census tract levels? Include the number of buildings available for solar installations, the percentage covered by Project Sunroof, the percentage suitable for solar, total potential panel count, total kilowatt capacity, energy generation potential, carbon dioxide offset, and the gap in potential installations.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
State,Level,Number of Buildings Available for Solar Installations,Percentage Covered by Project Sunroof,Percentage Suitable for Solar,Total Potential Panel Count,Total Kilowatt Capacity,Energy Generation Potential,Carbon Dioxide Offset,Gap in Potential Installations
state_name:str,Postal Code,count_qualified:int,percent_covered:float[0-100],percent_qualified:float[0-100],number_of_panels_total:int,kw_total:float,yearly_sunlight_kwh_total:float,carbon_offset_metric_tons:float,gap_in_potential_installations:int
state_name:str,Census Tract,count_qualified:int,percent_covered:float[0-100],percent_qualified:float[0-100],number_of_panels_total:int,kw_total:float,yearly_sunlight_kwh_total:float,carbon_offset_metric_tons:float,gap_in_potential_installations:int
...
```

This table provides a detailed comparison of the solar potential for each state at both postal code and census tract levels. It includes key metrics such as the number of buildings available for solar installations, percentages covered by Project Sunroof and suitable for solar, total potential panel count, total kilowatt capacity, energy generation potential, carbon dioxide offset, and the gap in potential installations (calculated as the difference between the number of qualified buildings and existing installations)..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'SUNROOF_SOLAR': {'SUNROOF_SOLAR': ['SOLAR_POTENTIAL_BY_CENSUSTRACT', 'SOLAR_POTENTIAL_BY_POSTAL_CODE']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-27 06:32:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 06:32:01 - root - INFO - ```sql
SELECT
    "state_name",
    "Level",
    SUM("count_qualified") AS "Number of Buildings Available for Solar Installations",
    AVG("percent_covered") AS "Percentage Covered by Project Sunroof",
    AVG("percent_qualified") AS "Percentage Suitable for Solar",
    SUM("number_of_panels_total") AS "Total Potential Panel Count",
    SUM("kw_total") AS "Total Kilowatt Capacity",
    SUM("yearly_sunlight_kwh_total") AS "Energy Generation Potential",
    SUM("carbon_offset_metric_tons") AS "Carbon Dioxide Offset",
    SUM("count_qualified") - SUM("existing_installs_count") AS "Gap in Potential Installations"
FROM
(
    SELECT
        "state_name",
        'Postal Code' AS "Level",
        "count_qualified",
        "percent_covered",
        "percent_qualified",
        "number_of_panels_total",
        "kw_total",
        "yearly_sunlight_kwh_total",
        "carbon_offset_metric_tons",
        "existing_installs_count"
    FROM
        SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
    UNION ALL
    SELECT
        "state_name",
        'Census Tract' AS "Level",
        "count_qualified",
        "percent_covered",
        "percent_qualified",
        "number_of_panels_total",
        "kw_total",
        "yearly_sunlight_kwh_total",
        "carbon_offset_metric_tons",
        "existing_installs_count"
    FROM
        SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
) AS combined_data
GROUP BY
    "state_name",
    "Level";
```
2025-01-27 06:32:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:32:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:32:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:32:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 139
2025-01-27 06:32:02 - snowflake.connector.connection - INFO - closed
2025-01-27 06:32:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:32:03 - root - INFO - itercount: 1
2025-01-27 06:32:03 - root - INFO - 0
2025-01-27 06:32:03 - root - INFO - results: 
state_name,Level,Number of Buildings Available for Solar Installations,Percentage Covered by Project Sunroof,Percentage Suitable for Solar,Total Potential Panel Count,Total Kilowatt Capacity,Energy Generation Potential,Carbon Dioxide Offset,Gap in Potential Installations
Pennsylvania,Postal Code,1954585,79.06967897178195,79.50152162654109,133004637,33251159.25,38013732231.37531,25546821.485438112,1950183
District of Columbia,Postal Code,76385,81.96327798463946,75.11488176242611,3937623,984405.75,1195714591.0355346,759829.5491657511,75943
Indiana,Postal Code,1116413,72.70729951623913,80.98704273615954,93048465,23262116.25,26851041383.54419,22222230.940975703,1115426
Texas,Postal Code,5476777,81.35349870837807,89.34929795432053,480505530,120126382.5,160039623751.7003,79820466.39724964,5462650
California,Postal Code,8607224,89.78070050159477,88.4105249868377,652983168,163245792.0,242638396940.61917,66878632.22406632,8275950
South Carolina,Postal Code,907878,68.29906526292937,80.08563002130781,79183940,19795985.0,25650182524.80312,15057615.542086853,906615
New Jersey,Postal Code,1629714,88.22893832760148,76.2982184524033,116249897,29062474.25,33904852397.547024,21299363.239696037,1617086
New York,Postal Code,2502541,85.27673962577262,77.40818366695984,157857812,39464453.0,44831446454.66716,21798509.3083663,2483797
Minnesota,Postal Code,769481,83.07005491274448,72.02677785988112,65464154,16366038.5,18617438249.156933,9432736.4318702,767964
Maryland,Postal Code,705396,71.16030669975414,78.2143673837333,47560886,11890221.5,14360334548.562885,9317029.141011486,699332
Maine,Postal Code,99960,63.10106887979923,63.63666881149767,7689271,1922317.75,2189004685.142859,947591.4564713892,99600
Arizona,Postal Code,1753531,87.4686382928109,93.81479777093914,147238408,36809602.0,59043009935.297775,25357559.299180172,1713835
Connecticut,Postal Code,607976,77.10327700263738,72.29881131803253,43269892,10817473.0,12350145123.452475,5347366.443614538,602708
Virginia,Postal Code,963270,70.44108422452733,77.44664178774818,74735305,18683826.25,23113080773.399204,14534537.81879123,960863
Wisconsin,Postal Code,900028,78.21393285262631,80.06679188975762,82263947,20565986.75,23486482672.1245,18493486.25400976,898115
Ohio,Postal Code,2192109,79.33516702608135,82.39723759334927,171022353,42755588.25,48048536615.677925,39776810.4632109,2189269
Illinois,Postal Code,2052522,81.52174935109403,81.22551550568912,163236997,40809249.25,47047851222.022064,38776748.30638688,2050075
West Virginia,Postal Code,154869,66.83908549978547,82.71154300892732,11336559,2834139.75,3257389195.7982965,2696642.54367634,154789
Nebraska,Postal Code,283330,80.3729482344542,86.8810104386528,21495882,5373970.5,6698087315.291831,3393835.347755131,283121
Delaware,Postal Code,147431,77.33200952927506,79.87848539811428,10742839,2685709.75,3213827406.3591805,2042260.7933182444,147343
Missouri,Postal Code,1031097,80.34422515005366,82.55774214780111,83816328,20954082.0,26038971734.14675,20922455.46777513,1028243
Rhode Island,Postal Code,202865,83.8420145651795,75.47806245993253,12914100,3228525.0,3701710212.139731,1602800.1897457635,202494
New Hampshire,Postal Code,107012,50.14231216128735,68.14373199300624,9037409,2259352.25,2550456273.8240113,1104316.148032614,106750
Iowa,Postal Code,350073,72.26174249883252,78.45999338382977,29910958,7477739.5,8830596479.387411,4474350.521690872,349825
North Carolina,Postal Code,1416043,63.194070914764936,76.831511026237,123962977,30990744.25,39519833527.20979,23311951.92699679,1413133
Kansas,Postal Code,417118,78.00151867237689,83.90980882904063,36723960,9180990.0,11849160234.790615,8225046.27693307,416381
Florida,Postal Code,4814177,82.9849507142317,90.85016886522146,462105732,115526433.0,157617914915.22406,84572912.49373843,4708885
Oregon,Postal Code,772441,76.67033698320569,85.56283254708075,61510848,15377712.0,16486992928.991991,4384028.977048002,763794
Tennessee,Postal Code,1102947,74.46006733391978,83.65948527656543,101108289,25277072.25,30966907026.81165,23508638.5761802,1101641
Oklahoma,Postal Code,700888,76.98000635053329,90.6883086147428,60455902,15113975.5,20183717271.261906,13653148.546175597,700086
Utah,Postal Code,572530,76.16223561464696,85.93581601402273,43988756,10997189.0,15209638303.221928,4044369.724602101,569369
South Dakota,Postal Code,72847,52.45083205685707,76.16484077656688,6372371,1593092.75,1964549826.5415552,1047147.0385288498,72826
Louisiana,Postal Code,864431,74.02401966050748,85.77600943642517,80134650,20033662.5,25827876726.134464,16083222.605670767,856210
Vermont,Postal Code,19504,79.35918973288327,79.5994775409519,1988764,497191.0,545353715.0415834,236132.86981235372,19373
Arkansas,Postal Code,369725,64.03184484226826,80.53295880502695,35933867,8983466.75,11336956069.406748,7146339.221664687,369486
Guaynabo,Postal Code,12113,96.69070837371876,88.43952681035891,986943,246735.75,342637380.9947451,230594.4901825723,12113
San Juan,Postal Code,44665,98.24550518972346,91.33009202920341,3423143,855785.75,1195075494.090149,804284.1778948521,44665
Nevada,Postal Code,569104,80.35806150420441,92.41557021018671,43540016,10885004.0,17206349924.622555,6541464.54058874,556366
Cataño,Postal Code,2860,95.55259585846524,91.19644888529244,186311,46577.75,65981195.478601106,44405.254583877424,2860
Toa Alta,Postal Code,1123,83.18994043679682,89.33969769291966,88675,22168.75,31279276.972485356,21050.91074946186,1123
Bayamón,Postal Code,33260,97.36410651881141,91.28405960797262,2098880,524720.0,738592635.6176331,497071.83661161206,33260
Carolina,Postal Code,19237,88.9530773741177,93.41220105410265,1481427,370356.75,527251268.02654415,354839.38441194326,19237
Arecibo,Postal Code,4433,77.87529184298847,93.40742399641678,345214,86303.5,123956987.1142212,83422.88329775061,4433
Hawaii,Postal Code,204227,85.77323256083754,94.93133340007105,19835765,4958941.25,7400954705.809179,4657525.910539113,178851
Baja California,Postal Code,1,0.06743088334457181,20.0,23,5.75,8322.02979736328,0.0,1
Moca,Postal Code,1,0.36900369003690037,100.0,28,7.0,8580.857080078125,5.774905113871622,1
Indiana,Census Tract,1117000,102.884568973642,74.4162992494216,93311273,23327818.25,26928123257.6459,22286009.07525565,1116012
California,Census Tract,8617901,93.2219977518554,84.42610938177201,654784266,163696066.5,243304846869.2128,67060256.559903376,8286083
Mayagüez,Census Tract,7284,129.1771202642994,88.31524322675783,567212,141803.0,202552659.3214233,136317.66351863468,7284
Georgia,Census Tract,1503687,96.55458334148544,68.60191456870614,140138439,35034609.75,44737933517.87483,26767856.473523576,1501780
Alabama,Postal Code,813312,65.3636415604924,81.88299169012126,77298546,19324636.5,24646969095.845936,15723425.934489228,812768
Michigan,Postal Code,1846232,76.11109096649125,79.04143589637175,147391827,36847956.75,40840033399.2527,32063411.389291123,1844515
Colorado,Postal Code,1031389,81.12936471319753,83.07765032579091,69150828,17287707.0,24570049923.14742,14960304.146578383,1007054
Massachusetts,Postal Code,1000732,81.69850341980235,73.94909266069027,68609324,17152331.0,19399236401.382404,8399385.428188125,985382
Kentucky,Postal Code,577255,75.34738154677153,86.85440770148307,47570216,11892554.0,14104070608.580994,10935523.832197247,576530
Wyoming,Postal Code,53068,78.96861340065533,78.76528710918183,3843267,960816.75,1300665963.824701,399141.77153828304,53039
Georgia,Postal Code,1502091,72.02704651939646,76.48404856671779,139653741,34913435.25,44581060812.036766,26673519.941978436,1500185
Alaska,Postal Code,57138,88.96629632261681,78.00984454758942,5447225,1361806.25,1089086633.2073152,448709.5001029908,57055
North Dakota,Postal Code,77117,78.53210718919708,80.68802648949998,8128226,2032056.5,2295970930.981845,1163339.1647784072,77093
Idaho,Postal Code,311671,77.44616743720587,85.81752126830317,23026001,5756500.25,7504231760.321072,1995437.83571835,311142
New Mexico,Postal Code,365713,73.56221925571542,90.66469204457194,29552308,7388077.0,12187002098.50356,5184507.904926238,361964
Toa Baja,Postal Code,6976,96.83583571162676,89.3900563813429,371052,92763.0,131548735.53740233,88532.11963429808,6976
Trujillo Alto,Postal Code,2854,93.46999728482216,88.81837244579282,196126,49031.5,68412270.15056156,46041.3645230469,2854
Aguadilla,Postal Code,5844,93.15526870442538,94.31143379125443,432049,108012.25,159844295.74992672,107574.99307295939,5844
Canóvanas,Postal Code,2182,66.34040239260467,89.42622950819673,160471,40117.75,57543460.70198363,38726.67058507054,2182
Mayagüez,Postal Code,7348,93.56904274340901,91.3667202708606,571212,142803.0,203989405.60508427,137284.59180836374,7348
Hormigueros,Postal Code,1194,58.690744920993225,91.84615384615384,54608,13652.0,19401835.649896257,13057.408935665711,1194
Dorado,Postal Code,3064,78.27859026612323,93.84379785604901,199254,49813.5,70454673.23659058,47415.8990148845,3064
Corozal,Postal Code,15,1.2121212121212122,93.75,1667,416.75,587979.9845764162,395.7097278391667,15
Pennsylvania,Census Tract,1956097,92.68306466974033,68.85707992410286,133691622,33422905.5,38210009215.75753,25679219.804377407,1951689
District of Columbia,Census Tract,76464,85.3173154619042,63.397058540850374,3983844,995961.0,1209717858.796045,768728.0745405239,76022
Delaware,Census Tract,147535,85.27792503329306,71.13500821025055,10771425,2692856.25,3222438352.7232113,2047732.7107329231,147447
Maryland,Census Tract,705813,80.0363051672659,69.81305560602681,47690643,11922660.75,14399236326.491217,9341908.182602106,699742
New Jersey,Census Tract,1632773,124.22007839679854,72.49284036555349,117024321,29256080.25,34132296027.414562,21441825.25895091,1620118
New York,Census Tract,2506035,87.01654666423346,70.3824007333638,158794563,39698640.75,45100394878.669464,21932730.052032903,2487240
Virginia,Census Tract,963792,90.98671520397548,70.29803660202286,74914378,18728594.5,23169044381.25027,14570516.612738723,961383
Florida,Census Tract,4817871,99.63463369538297,83.27936582037172,463123814,115780953.5,157971622252.88788,84762071.96637787,4712507
Illinois,Census Tract,2055456,91.65385121185507,75.0703988032207,164256874,41064218.5,47344747566.82309,39019478.60061418,2053003
Michigan,Census Tract,1847255,96.3166332425792,72.87447311567932,147876313,36969078.25,40976609871.52639,32170938.26439564,1845535
Minnesota,Census Tract,770077,90.42832750511015,64.55495274901153,65662303,16415575.75,18673751434.616875,9461269.60415691,768559
New Hampshire,Census Tract,107103,82.68678043934634,67.9415712418198,9054358,2263589.5,2555251276.171985,1106392.337547703,106841
South Carolina,Census Tract,908394,95.47395975225123,73.39684628969717,79312131,19828032.75,25692275291.33939,15082325.953191794,907128
Texas,Census Tract,5480573,89.86343251034103,83.60340471279187,481747719,120436929.75,160458070556.08868,80026572.09620419,5466434
Arizona,Census Tract,1754534,109.64577014936981,90.40516782276116,147450436,36862609.0,59127893265.42813,25393752.120932452,1714808
Iowa,Census Tract,350284,92.50237522834108,67.55135102465916,29953011,7488252.75,8843145869.399496,4480709.137428612,350036
Ohio,Census Tract,2194900,100.1957983798897,76.22748275975313,171901350,42975337.5,48300160986.35466,39985118.69480568,2192055
North Carolina,Census Tract,1416843,111.00378212601817,68.18277115519244,124233257,31058314.25,39607264848.0049,23363984.23961253,1413932
Wisconsin,Census Tract,900707,93.1936525385241,74.55363214741563,82459475,20614868.75,23542559983.903282,18538719.211838692,898793
Kansas,Census Tract,417333,89.95113875826729,74.45838191092518,36827430,9206857.5,11882464352.008951,8248164.19414453,416595
Connecticut,Census Tract,608869,87.30600764926567,65.75337434981022,43575214,10893803.5,12438466928.172298,5385610.014692117,603585
Montana,Census Tract,118683,80.417314727058,72.27714051202193,9189162,2297290.5,2711943864.901141,721128.5004524508,118421
Missouri,Census Tract,1032104,89.17689216788044,76.3366899845083,84085928,21021482.0,26123174340.937077,20988770.94279073,1029240
South Dakota,Census Tract,72867,82.78193284825554,73.1301178566635,6377373,1594343.25,1966083346.8824432,1047973.7956763804,72846
Montana,Postal Code,118654,69.92868695582884,74.89138821125225,9181610,2295402.5,2709785572.9772882,720554.5926224514,118393
Washington,Postal Code,1510869,83.21639552127759,84.03996306007777,107756625,26939156.25,27430232929.40039,7293347.185103217,1505113
Ponce,Postal Code,18706,87.87217710733272,91.44872619683593,1162806,290701.5,384801553.74663687,258970.92094872272,18706
Mississippi,Postal Code,324867,72.63111176104802,82.19166818603286,32127017,8031754.25,10378294594.571173,6657377.0431828415,324511
Louisiana,Census Tract,865003,113.44943038082381,82.17435382731469,80308875,20077218.75,25885642034.581642,16119065.632724501,856780
Colorado,Census Tract,1032067,90.80594676965518,80.52159958927903,69425443,17356360.75,24667013678.519062,15019343.801609265,1007705
Tennessee,Census Tract,1105463,96.22961807019112,76.27267213792194,101762224,25440556.0,31169276299.068554,23662867.396383427,1104151
Alaska,Census Tract,57169,83.1343291892894,67.3891486348244,5462549,1365637.25,1092118868.9737976,449958.7974072519,57086
Maine,Census Tract,100065,85.24301426648185,65.17547802899195,7720530,1930132.5,2197957054.097583,951467.7454093618,99705
Nebraska,Census Tract,283467,93.41757348883557,80.62010526352871,21582607,5395651.75,6725165429.183444,3407555.482436877,283257
North Dakota,Census Tract,77129,88.55661024596189,75.3665552162828,8138951,2034737.75,2299032486.195364,1164890.4157271704,77105
West Virginia,Census Tract,155047,134.7040655714731,71.8114182883734,11387665,2846916.25,3272165883.9079347,2708875.483437571,154967
Kentucky,Census Tract,575985,94.62267354085364,80.79952498243404,47393349,11848337.25,14048103923.893398,10893849.027434926,575262
Massachusetts,Census Tract,1002203,87.21982464135493,72.28938390680628,69012277,17253069.25,19514148116.75344,8448829.99986072,986834
Utah,Census Tract,573155,93.12673983869175,84.22705043917742,44105531,11026382.75,15249940379.663124,4055086.38298331,569989
Washington,Census Tract,1511814,102.21900785046996,74.3926663890639,107938035,26984508.75,27475803851.394146,7305348.121577986,1506055
Idaho,Census Tract,311878,84.46661050804317,75.91076792895495,23093899,5773474.75,7526956885.239657,2001480.6360385297,311349
Nevada,Census Tract,569461,98.16257499733608,90.79523059001976,43616656,10904164.0,17236108170.27167,6552267.614581583,556715
Rhode Island,Census Tract,203167,91.74013630607047,75.69773905575148,13001474,3250368.5,3726814813.7138762,1613670.238764769,202796
Wyoming,Census Tract,53090,75.8881197240555,78.68145154613299,3848056,962014.0,1302268164.5376706,399567.8100756294,53061
Mississippi,Census Tract,325095,110.38685412641186,70.47452389375442,32218920,8054730.0,10408673466.612555,6675246.399348796,324739
Oregon,Census Tract,773130,92.07550262671663,79.62664401997048,61617355,15404338.75,16514535968.386444,4391352.901025,764477
Aguadilla,Census Tract,5852,95.93904539313895,89.84303986917156,432711,108177.75,160079112.7508179,107733.02459435827,5852
San Juan,Census Tract,44341,361.1600438845385,90.2046719638303,3375014,843753.5,1177674698.0644774,792573.4658976337,44341
Oklahoma,Census Tract,701280,90.58936275851072,87.74299094697147,60560124,15140031.0,20218586198.69937,13676736.482410647,700478
Vermont,Census Tract,19530,102.79805757806194,68.89857488088953,2012472,503118.0,551942863.0689392,238985.90700712064,19399
Carolina,Census Tract,19688,118.61155203088131,91.95012311270571,1554053,388513.25,553262399.3939757,372344.8403529482,19688
Alabama,Census Tract,814213,118.15181543509537,75.7064689620111,77644088,19411022.0,24759196398.25475,15792877.15528395,813666
Arkansas,Census Tract,370016,94.08798696727425,73.5760827694726,36012747,9003186.75,11362387314.959013,7162306.228122597,369777
Toa Alta,Census Tract,1345,1710.7408116079803,87.95785274938673,73394,18348.5,25725431.5722229,17313.180368415116,1345
Trujillo Alto,Census Tract,2873,2040.5624934431328,86.22386755943712,197851,49462.75,69008952.58372192,46442.93098691624,2873
Canóvanas,Census Tract,2099,111.11231184290489,82.97908947936548,139475,34868.75,49976173.3744995,33633.89653257158,2099
Cataño,Census Tract,2764,1977.1135751398201,86.57358974659549,168020,42005.0,59578578.59686889,40096.302153202625,2764
Guaynabo,Census Tract,11603,111.26805227548675,89.7713593686313,984133,246033.25,342005084.6763794,230168.9556225237,11603
New Mexico,Census Tract,365962,90.19310294856498,87.26558195086373,29605361,7401340.25,12208818476.493713,5193766.818696551,362213
Toa Baja,Census Tract,6517,108.02498418769798,90.59109586594275,362967,90741.75,128650286.23981933,86581.46720940567,6517
Hawaii,Census Tract,204390,92.40890122239371,90.28828623458989,19873246,4968311.5,7415195492.54585,4666457.0008377,178998
Hormigueros,Census Tract,1264,72.03823210284625,91.17801424826256,59807,14951.75,21266625.235290524,14312.409783773295,1264
Dorado,Census Tract,3067,133.8421632605731,94.55205024605395,199501,49875.25,70542741.78618774,47475.16902867142,3067
Hatillo,Census Tract,224,38.851761427901465,91.4722740602506,25246,6311.5,9067192.223126221,6102.208001967081,224
Cabo Rojo,Census Tract,2,5.0,100.0,668,167.0,236279.58453979492,159.01583819991797,2
Loíza,Census Tract,40,85.48387096774194,75.47169811320755,1693,423.25,595043.1626098631,400.46323702419204,40
Moca,Census Tract,1,0.8264462809917356,100.0,28,7.0,8580.857080078125,5.774905113871622,1
Ponce,Census Tract,18091,91.56236721318227,89.9396040617879,1165041,291260.25,385731295.9626892,259596.63619231156,18091
Bayamón,Census Tract,33466,98.86868696240633,90.54093297303565,2134598,533649.5,751085531.8753113,505479.538757477,33466
Arecibo,Census Tract,3962,239.5516220035041,94.1909789661489,306604,76651.0,110110577.36539914,74104.26841802277,3962


2025-01-27 06:32:03 - root - INFO - Please check the answer again by reviewing Can you provide a detailed comparison of the solar potential for each state, distinguishing between postal code and census tract levels? Include the number of buildings available for solar installations, the percentage covered by Project Sunroof, the percentage suitable for solar, total potential panel count, total kilowatt capacity, energy generation potential, carbon dioxide offset, and the gap in potential installations., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
State,Level,Number of Buildings Available for Solar Installations,Percentage Covered by Project Sunroof,Percentage Suitable for Solar,Total Potential Panel Count,Total Kilowatt Capacity,Energy Generation Potential,Carbon Dioxide Offset,Gap in Potential Installations
state_name:str,Postal Code,count_qualified:int,percent_covered:float[0-100],percent_qualified:float[0-100],number_of_panels_total:int,kw_total:float,yearly_sunlight_kwh_total:float,carbon_offset_metric_tons:float,gap_in_potential_installations:int
state_name:str,Census Tract,count_qualified:int,percent_covered:float[0-100],percent_qualified:float[0-100],number_of_panels_total:int,kw_total:float,yearly_sunlight_kwh_total:float,carbon_offset_metric_tons:float,gap_in_potential_installations:int
...
```

This table provides a detailed comparison of the solar potential for each state at both postal code and census tract levels. It includes key metrics such as the number of buildings available for solar installations, percentages covered by Project Sunroof and suitable for solar, total potential panel count, total kilowatt capacity, energy generation potential, carbon dioxide offset, and the gap in potential installations (calculated as the difference between the number of qualified buildings and existing installations). The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Too long, hard cut:
state_name,Level,Number of Buildings Available for Solar Installations,Percentage Covered by Project Sunroof,Percentage Suitable for Solar,Total Potential Panel Count,Total Kilowatt Capacity,Energy Generation Potential,Carbon Dioxide Offset,Gap in Potential Installations
Pennsylvania,Postal Code,1954585,79.06967897178195,79.50152162654109,133004637,33251159.25,38013732231.37531,25546821.485438112,1950183
District of Columbia,Postal Code,76385,81.96327798463946,75.11488176242611,3937623,984405.75,1195714591.0355346,759829.5491657511,75943
Indiana,Postal Code,1116413,72.70729951623913,80.98704273615954,93048465,23262116.25,26851041383.54419,22222230.940975703,1115426
Texas,Postal Code,5476777,81.35349870837807,89.34929795432053,480505530,120126382.5,160039623751.7003,79820466.39724964,5462650
California,Postal Code,8607224,89.78070050159477,88.4105249868377,652983168,163245792.0,242638396940.61917,66878632.22406632,8275950
South Carolina,Postal Code,907878,68.29906526292937,80.08563002130781,79183940,19795985.0,25650182524.80312,15057615.542086853,906615
New Jersey,Postal Code,1629714,88.22893832760148,76.2982184524033,116249897,29062474.25,33904852397.547024,21299363.239696037,1617086
New York,Postal Code,2502541,85.27673962577262,77.40818366695984,157857812,39464453.0,44831446454.66716,21798509.3083663,2483797
Minnesota,Postal Code,769481,83.07005491274448,72.02677785988112,65464154,16366038.5,18617438249.156933,9432736.4318702,767964
Maryland,Postal Code,705396,71.16030669975414,78.2143673837333,47560886,11890221.5,14360334548.562885,9317029.141011486,699332
Maine,Postal Code,99960,63.10106887979923,63.63666881149767,7689271,1922317.75,2189004685.142859,947591.4564713892,99600
Arizona,Postal Code,1753531,87.4686382928109,93.81479777093914,147238408,36809602.0,59043009935.297775,25357559.299180172,1713835
Connecticut,Postal Code,607976,77.10327700263738,72.29881131803253,43269892,10817473.0,12350145123.452475,5347366.443614538,602708
Virginia,Postal Code,963270,70.44108422452733,77.44664178774818,74735305,18683826.25,23113080773.399204,14534537.81879123,960863
Wisconsin,Postal Code,900028,78.21393285262631,80.06679188975762,82263947,20565986.75,23486482672.1245,18493486.25400976,898115
Ohio,Postal Code,2192109,79.33516702608135,82.39723759334927,171022353,42755588.25,48048536615.677925,39776810.4632109,2189269
Illinois,Postal Code,2052522,81.52174935109403,81.22551550568912,163236997,40809249.25,47047851222.022064,38776748.30638688,2050075
West Virginia,Postal Code,154869,66.83908549978547,82.71154300892732,11336559,2834139.75,3257389195.7982965,2696642.54367634,154789
Nebraska,Postal Code,283330,80.3729482344542,86.8810104386528,21495882,5373970.5,6698087315.291831,3393835.347755131,283121
Delaware,Postal Code,147431,77.33200952927506,79.87848539811428,10742839,2685709.75,3213827406.3591805,2042260.7933182444,147343
Missouri,Postal Code,1031097,80.34422515005366,82.55774214780111,83816328,20954082.0,26038971734.14675,20922455.46777513,1028243
Rhode Island,Postal Code,202865,83.8420145651795,75.47806245993253,12914100,3228525.0,3701710212.139731,1602800.1897457635,202494
New Hampshire,Postal Code,107012,50.14231216128735,68.14373199300624,9037409,2259352.25,2550456273.8240113,1104316.148032614,106750
Iowa,Postal Code,350073,72.26174249883252,78.45999338382977,29910958,7477739.5,8830596479.387411,4474350.521690872,349825
North Carolina,Postal Code,1416043,63.194070914764936,76.831511026237,123962977,30990744.25,39519833527.20979,23311951.92699679,1413133
Kansas,Postal Code,417118,78.00151867237689,83.90980882904063,36723960,9180990.0,11849160234.790615,8225046.27693307,416381
Florida,Postal Code,4814177,82.9849507142317,90.85016886522146,462105732,115526433.0,157617914915.22406,84572912.49373843,4708885
Oregon,Postal Code,772441,76.67033698320569,85.56283254708075,61510848,15377712.0,16486992928.991991,4384028.977048002,763794
Tennessee,Postal Code,1102947,74.46006733391978,83.65948527656543,101108289,25277072.25,30966907026.81165,23508638.5761802,1101641
Oklahoma,Postal Code,700888,76.98000635053329,90.6883086147428,60455902,15113975.5,20183717271.261906,13653148.546175597,700086
Utah,Postal Code,572530,76.16223561464696,85.93581601402273,43988756,10997189.0,15209638303.221928,4044369.724602101,569369
South Dakota,Postal Code,72847,52.45083205685707,76.16484077656688,6372371,1593092.75,1964549826.5415552,1047147.0385288498,72826
Louisiana,Postal Code,864431,74.02401966050748,85.77600943642517,80134650,20033662.5,25827876726.134464,16083222.605670767,856210
Vermont,Postal Code,19504,79.35918973288327,79.5994775409519,1988764,497191.0,545353715.0415834,236132.86981235372,19373
Arkansas,Postal Code,369725,64.03184484226826,80.53295880502695,35933867,8983466.75,11336956069.406748,7146339.221664687,369486
Guaynabo,Postal Code,12113,96.69070837371876,88.43952681035891,986943,246735.75,342637380.9947451,230594.4901825723,12113
San Juan,Postal Code,44665,98.24550518972346,91.33009202920341,3423143,855785.75,1195075494.090149,804284.1778948521,44665
Nevada,Postal Code,569104,80.35806150420441,92.41557021018671,43540016,10885004.0,17206349924.622555,6541464.54058874,556366
Cataño,Postal Code,2860,95.55259585846524,91.19644888529244,186311,46577.75,65981195.478601106,44405.254583877424,2860
Toa Alta,Postal Code,1123,83.18994043679682,89.33969769291966,88675,22168.75,31279276.972485356,21050.91074946186,1123
Bayamón,Postal Code,33260,97.36410651881141,91.28405960797262,2098880,524720.0,738592635.6176331,497071.83661161206,33260
Carolina,Postal Code,19237,88.9530773741177,93.41220105410265,1481427,370356.75,527251268.02654415,354839.38441194326,19237
Arecibo,Postal Code,4433,77.87529184298847,93.40742399641678,345214,86303.5,123956987.1142212,83422.88329775061,4433
Hawaii,Postal Code,204227,85.77323256083754,94.93133340007105,19835765,4958941.25,7400954705.809179,4657525.910539113,178851
Baja California,Postal Code,1,0.06743088334457181,20.0,23,5.75,8322.02979736328,0.0,1
Moca,Postal Code,1,0.36900369003690037,100.0,28,7.0,8580.857080078125,5.774905113871622,1
Indiana,Census Tract,1117000,102.884568973642,74.4162992494216,93311273,23327818.25,26928123257.6459,22286009.07525565,1116012
California,Census Tract,8617901,93.2219977518554,84.42610938177201,654784266,163696066.5,243304846869.2128,67060256.559903376,8286083
Mayagüez,Census Tract,7284,129.1771202642994,88.31524322675783,567212,141803.0,202552659.3214233,136317.66351863468,7284
Georgia,Census Tract,1503687,96.55458334148544,68.60191456870614,140138439,35034609.75,44737933517.87483,26767856.473523576,1501780
Alabama,Postal Code,813312,65.3636415604924,81.88299169012126,77298546,19324636.5,24646969095.845936,15723425.934489228,812768
Michigan,Postal Code,1846232,76.11109096649125,79.04143589637175,147391827,36847956.75,40840033399.2527,32063411.389291123,1844515
Colorado,Postal Code,1031389,81.12936471319753,83.07765032579091,69150828,17287707.0,24570049923.14742,14960304.146578383,1007054
Massachusetts,Postal Code,1000732,81.69850341980235,73.94909266069027,68609324,17152331.0,19399236401.382404,8399385.428188125,985382
Kentucky,Postal Code,577255,75.34738154677153,86.85440770148307,47570216,11892554.0,14104070608.580994,10935523.832197247,576530
Wyoming,Postal Code,53068,78.96861340065533,78.76528710918183,3843267,960816.75,1300665963.824701,399141.77153828304,53039
Georgia,Postal Code,1502091,72.02704651939646,76.48404856671779,139653741,34913435.25,44581060812.036766,26673519.941978436,1500185
Alaska,Postal Code,57138,88.96629632261681,78.00984454758942,5447225,1361806.25,1089086633.2073152,448709.5001029908,57055
North Dakota,Postal Code,77117,78.53210718919708,80.68802648949998,8128226,2032056.5,2295970930.981845,1163339.1647784072,77093
Idaho,Postal Code,311671,77.44616743720587,85.81752126830317,23026001,5756500.25,7504231760.321072,1995437.83571835,311142
New Mexico,Postal Code,365713,73.56221925571542,90.66469204457194,29552308,7388077.0,12187002098.50356,5184507.904926238,361964
Toa Baja,Postal Code,6976,96.83583571162676,89.3900563813429,371052,92763.0,131548735.53740233,88532.11963429808,6976
Trujillo Alto,Postal Code,2854,93.46999728482216,88.81837244579282,196126,49031.5,68412270.15056156,46041.3645230469,2854
Aguadilla,Postal Code,5844,93.15526870442538,94.31143379125443,432049,108012.25,159844295.74992672,107574.99307295939,5844
Canóvanas,Postal Code,2182,66.34040239260467,89.42622950819673,160471,40117.75,57543460.70198363,38726.67058507054,2182
Mayagüez,Postal Code,7348,93.56904274340901,91.3667202708606,571212,142803.0,203989405.60508427,137284.59180836374,7348
Hormigueros,Postal Code,1194,58.690744920993225,91.84615384615384,54608,13652.0,19401835.649896257,13057.408935665711,1194
Dorado,Postal Code,3064,78.27859026612323,93.84379785604901,199254,49813.5,70454673.23659058,47415.8990148845,3064
Corozal,Postal Code,15,1.2121212121212122,93.75,1667,416.75,587979.9845764162,395.7097278391667,15
Pennsylvania,Census Tract,1956097,92.68306466974033,68.85707992410286,133691622,33422905.5,38210009215.75753,25679219.804377407,1951689
District of Columbia,Census Tract,76464,85.3173154619042,63.397058540850374,3983844,995961.0,1209717858.796045,768728.0745405239,76022
Delaware,Census Tract,147535,85.27792503329306,71.13500821025055,10771425,2692856.25,3222438352.7232113,2047732.7107329231,147447
Maryland,Census Tract,705813,80.0363051672659,69.81305560602681,47690643,11922660.75,14399236326.491217,9341908.182602106,699742
New Jersey,Census Tract,1632773,124.22007839679854,72.49284036555349,117024321,29256080.25,34132296027.414562,21441825.25895091,1620118
New York,Census Tract,2506035,87.01654666423346,70.3824007333638,158794563,39698640.75,45100394878.669464,21932730.052032903,2487240
Virginia,Census Tract,963792,90.98671520397548,70.29803660202286,74914378,18728594.5,23169044381.25027,14570516.612738723,961383
Florida,Census Tract,4817871,99.63463369538297,83.27936582037172,463123814,115780953.5,157971622252.88788,84762071.96637787,4712507
Illinois,Census 
Current sql:
SELECT
    "state_name",
    "Level",
    SUM("count_qualified") AS "Number of Buildings Available for Solar Installations",
    AVG("percent_covered") AS "Percentage Covered by Project Sunroof",
    AVG("percent_qualified") AS "Percentage Suitable for Solar",
    SUM("number_of_panels_total") AS "Total Potential Panel Count",
    SUM("kw_total") AS "Total Kilowatt Capacity",
    SUM("yearly_sunlight_kwh_total") AS "Energy Generation Potential",
    SUM("carbon_offset_metric_tons") AS "Carbon Dioxide Offset",
    SUM("count_qualified") - SUM("existing_installs_count") AS "Gap in Potential Installations"
FROM
(
    SELECT
        "state_name",
        'Postal Code' AS "Level",
        "count_qualified",
        "percent_covered",
        "percent_qualified",
        "number_of_panels_total",
        "kw_total",
        "yearly_sunlight_kwh_total",
        "carbon_offset_metric_tons",
        "existing_installs_count"
    FROM
        SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
    UNION ALL
    SELECT
        "state_name",
        'Census Tract' AS "Level",
        "count_qualified",
        "percent_covered",
        "percent_qualified",
        "number_of_panels_total",
        "kw_total",
        "yearly_sunlight_kwh_total",
        "carbon_offset_metric_tons",
        "existing_installs_count"
    FROM
        SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
) AS combined_data
GROUP BY
    "state_name",
    "Level";
2025-01-27 06:32:28 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 06:32:28 - root - INFO - ```sql
SELECT
    "state_name",
    "Level",
    SUM("count_qualified") AS "Number of Buildings Available for Solar Installations",
    ROUND(AVG("percent_covered"), 4) AS "Percentage Covered by Project Sunroof",
    ROUND(AVG("percent_qualified"), 4) AS "Percentage Suitable for Solar",
    SUM("number_of_panels_total") AS "Total Potential Panel Count",
    ROUND(SUM("kw_total"), 4) AS "Total Kilowatt Capacity",
    ROUND(SUM("yearly_sunlight_kwh_total"), 4) AS "Energy Generation Potential",
    ROUND(SUM("carbon_offset_metric_tons"), 4) AS "Carbon Dioxide Offset",
    SUM("count_qualified") - SUM("existing_installs_count") AS "Gap in Potential Installations"
FROM
(
    SELECT
        "state_name",
        'Postal Code' AS "Level",
        "count_qualified",
        "percent_covered",
        "percent_qualified",
        "number_of_panels_total",
        "kw_total",
        "yearly_sunlight_kwh_total",
        "carbon_offset_metric_tons",
        "existing_installs_count"
    FROM
        SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
    UNION ALL
    SELECT
        "state_name",
        'Census Tract' AS "Level",
        "count_qualified",
        "percent_covered",
        "percent_qualified",
        "number_of_panels_total",
        "kw_total",
        "yearly_sunlight_kwh_total",
        "carbon_offset_metric_tons",
        "existing_installs_count"
    FROM
        SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
) AS combined_data
GROUP BY
    "state_name",
    "Level"
ORDER BY
    "state_name",
    "Level";
```
2025-01-27 06:32:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:32:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:32:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:32:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 139
2025-01-27 06:32:29 - snowflake.connector.connection - INFO - closed
2025-01-27 06:32:30 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:32:30 - root - INFO - itercount: 2
2025-01-27 06:32:30 - root - INFO - 0
2025-01-27 06:32:30 - root - INFO - results: 
state_name,Level,Number of Buildings Available for Solar Installations,Percentage Covered by Project Sunroof,Percentage Suitable for Solar,Total Potential Panel Count,Total Kilowatt Capacity,Energy Generation Potential,Carbon Dioxide Offset,Gap in Potential Installations
Aguadilla,Census Tract,5852,95.939,89.843,432711,108177.75,160079112.7508,107733.0246,5852
Aguadilla,Postal Code,5844,93.1553,94.3114,432049,108012.25,159844295.7499,107574.9931,5844
Alabama,Census Tract,814213,118.1518,75.7065,77644088,19411022.0,24759196398.2548,15792877.1553,813666
Alabama,Postal Code,813312,65.3636,81.883,77298546,19324636.5,24646969095.8459,15723425.9345,812768
Alaska,Census Tract,57169,83.1343,67.3891,5462549,1365637.25,1092118868.9738,449958.7974,57086
Alaska,Postal Code,57138,88.9663,78.0098,5447225,1361806.25,1089086633.2073,448709.5001,57055
Arecibo,Census Tract,3962,239.5516,94.191,306604,76651.0,110110577.3654,74104.2684,3962
Arecibo,Postal Code,4433,77.8753,93.4074,345214,86303.5,123956987.1142,83422.8833,4433
Arizona,Census Tract,1754534,109.6458,90.4052,147450436,36862609.0,59127893265.4281,25393752.1209,1714808
Arizona,Postal Code,1753531,87.4686,93.8148,147238408,36809602.0,59043009935.2978,25357559.2992,1713835
Arkansas,Census Tract,370016,94.088,73.5761,36012747,9003186.75,11362387314.959,7162306.2281,369777
Arkansas,Postal Code,369725,64.0318,80.533,35933867,8983466.75,11336956069.4067,7146339.2217,369486
Baja California,Postal Code,1,0.0674,20.0,23,5.75,8322.0298,0.0,1
Bayamón,Census Tract,33466,98.8687,90.5409,2134598,533649.5,751085531.8753,505479.5388,33466
Bayamón,Postal Code,33260,97.3641,91.2841,2098880,524720.0,738592635.6176,497071.8366,33260
Cabo Rojo,Census Tract,2,5.0,100.0,668,167.0,236279.5845,159.0158,2
California,Census Tract,8617901,93.222,84.4261,654784266,163696066.5,243304846869.2128,67060256.5599,8286083
California,Postal Code,8607224,89.7807,88.4105,652983168,163245792.0,242638396940.6192,66878632.2241,8275950
Canóvanas,Census Tract,2099,111.1123,82.9791,139475,34868.75,49976173.3745,33633.8965,2099
Canóvanas,Postal Code,2182,66.3404,89.4262,160471,40117.75,57543460.702,38726.6706,2182
Carolina,Census Tract,19688,118.6116,91.9501,1554053,388513.25,553262399.394,372344.8404,19688
Carolina,Postal Code,19237,88.9531,93.4122,1481427,370356.75,527251268.0265,354839.3844,19237
Cataño,Census Tract,2764,1977.1136,86.5736,168020,42005.0,59578578.5969,40096.3022,2764
Cataño,Postal Code,2860,95.5526,91.1964,186311,46577.75,65981195.4786,44405.2546,2860
Colorado,Census Tract,1032067,90.8059,80.5216,69425443,17356360.75,24667013678.5191,15019343.8016,1007705
Colorado,Postal Code,1031389,81.1294,83.0777,69150828,17287707.0,24570049923.1474,14960304.1466,1007054
Connecticut,Census Tract,608869,87.306,65.7534,43575214,10893803.5,12438466928.1723,5385610.0147,603585
Connecticut,Postal Code,607976,77.1033,72.2988,43269892,10817473.0,12350145123.4525,5347366.4436,602708
Corozal,Postal Code,15,1.2121,93.75,1667,416.75,587979.9846,395.7097,15
Delaware,Census Tract,147535,85.2779,71.135,10771425,2692856.25,3222438352.7232,2047732.7107,147447
Delaware,Postal Code,147431,77.332,79.8785,10742839,2685709.75,3213827406.3592,2042260.7933,147343
District of Columbia,Census Tract,76464,85.3173,63.3971,3983844,995961.0,1209717858.796,768728.0745,76022
District of Columbia,Postal Code,76385,81.9633,75.1149,3937623,984405.75,1195714591.0355,759829.5492,75943
Dorado,Census Tract,3067,133.8422,94.5521,199501,49875.25,70542741.7862,47475.169,3067
Dorado,Postal Code,3064,78.2786,93.8438,199254,49813.5,70454673.2366,47415.899,3064
Florida,Census Tract,4817871,99.6346,83.2794,463123814,115780953.5,157971622252.8879,84762071.9664,4712507
Florida,Postal Code,4814177,82.985,90.8502,462105732,115526433.0,157617914915.2241,84572912.4937,4708885
Georgia,Census Tract,1503687,96.5546,68.6019,140138439,35034609.75,44737933517.8748,26767856.4735,1501780
Georgia,Postal Code,1502091,72.027,76.484,139653741,34913435.25,44581060812.0368,26673519.942,1500185
Guaynabo,Census Tract,11603,111.2681,89.7714,984133,246033.25,342005084.6764,230168.9556,11603
Guaynabo,Postal Code,12113,96.6907,88.4395,986943,246735.75,342637380.9947,230594.4902,12113
Hatillo,Census Tract,224,38.8518,91.4723,25246,6311.5,9067192.2231,6102.208,224
Hawaii,Census Tract,204390,92.4089,90.2883,19873246,4968311.5,7415195492.5459,4666457.0008,178998
Hawaii,Postal Code,204227,85.7732,94.9313,19835765,4958941.25,7400954705.8092,4657525.9105,178851
Hormigueros,Census Tract,1264,72.0382,91.178,59807,14951.75,21266625.2353,14312.4098,1264
Hormigueros,Postal Code,1194,58.6907,91.8462,54608,13652.0,19401835.6499,13057.4089,1194
Idaho,Census Tract,311878,84.4666,75.9108,23093899,5773474.75,7526956885.2397,2001480.636,311349
Idaho,Postal Code,311671,77.4462,85.8175,23026001,5756500.25,7504231760.3211,1995437.8357,311142
Illinois,Census Tract,2055456,91.6539,75.0704,164256874,41064218.5,47344747566.8231,39019478.6006,2053003
Illinois,Postal Code,2052522,81.5217,81.2255,163236997,40809249.25,47047851222.0221,38776748.3064,2050075
Indiana,Census Tract,1117000,102.8846,74.4163,93311273,23327818.25,26928123257.6459,22286009.0753,1116012
Indiana,Postal Code,1116413,72.7073,80.987,93048465,23262116.25,26851041383.5442,22222230.941,1115426
Iowa,Census Tract,350284,92.5024,67.5514,29953011,7488252.75,8843145869.3995,4480709.1374,350036
Iowa,Postal Code,350073,72.2617,78.46,29910958,7477739.5,8830596479.3874,4474350.5217,349825
Kansas,Census Tract,417333,89.9511,74.4584,36827430,9206857.5,11882464352.009,8248164.1941,416595
Kansas,Postal Code,417118,78.0015,83.9098,36723960,9180990.0,11849160234.7906,8225046.2769,416381
Kentucky,Census Tract,575985,94.6227,80.7995,47393349,11848337.25,14048103923.8934,10893849.0274,575262
Kentucky,Postal Code,577255,75.3474,86.8544,47570216,11892554.0,14104070608.581,10935523.8322,576530
Louisiana,Census Tract,865003,113.4494,82.1744,80308875,20077218.75,25885642034.5816,16119065.6327,856780
Louisiana,Postal Code,864431,74.024,85.776,80134650,20033662.5,25827876726.1345,16083222.6057,856210
Loíza,Census Tract,40,85.4839,75.4717,1693,423.25,595043.1626,400.4632,40
Maine,Census Tract,100065,85.243,65.1755,7720530,1930132.5,2197957054.0976,951467.7454,99705
Maine,Postal Code,99960,63.1011,63.6367,7689271,1922317.75,2189004685.1429,947591.4565,99600
Maryland,Census Tract,705813,80.0363,69.8131,47690643,11922660.75,14399236326.4912,9341908.1826,699742
Maryland,Postal Code,705396,71.1603,78.2144,47560886,11890221.5,14360334548.5629,9317029.141,699332
Massachusetts,Census Tract,1002203,87.2198,72.2894,69012277,17253069.25,19514148116.7534,8448829.9999,986834
Massachusetts,Postal Code,1000732,81.6985,73.9491,68609324,17152331.0,19399236401.3824,8399385.4282,985382
Mayagüez,Census Tract,7284,129.1771,88.3152,567212,141803.0,202552659.3214,136317.6635,7284
Mayagüez,Postal Code,7348,93.569,91.3667,571212,142803.0,203989405.6051,137284.5918,7348
Michigan,Census Tract,1847255,96.3166,72.8745,147876313,36969078.25,40976609871.5264,32170938.2644,1845535
Michigan,Postal Code,1846232,76.1111,79.0414,147391827,36847956.75,40840033399.2527,32063411.3893,1844515
Minnesota,Census Tract,770077,90.4283,64.555,65662303,16415575.75,18673751434.6169,9461269.6042,768559
Minnesota,Postal Code,769481,83.0701,72.0268,65464154,16366038.5,18617438249.1569,9432736.4319,767964
Mississippi,Census Tract,325095,110.3869,70.4745,32218920,8054730.0,10408673466.6126,6675246.3993,324739
Mississippi,Postal Code,324867,72.6311,82.1917,32127017,8031754.25,10378294594.5712,6657377.0432,324511
Missouri,Census Tract,1032104,89.1769,76.3367,84085928,21021482.0,26123174340.9371,20988770.9428,1029240
Missouri,Postal Code,1031097,80.3442,82.5577,83816328,20954082.0,26038971734.1468,20922455.4678,1028243
Moca,Census Tract,1,0.8264,100.0,28,7.0,8580.8571,5.7749,1
Moca,Postal Code,1,0.369,100.0,28,7.0,8580.8571,5.7749,1
Montana,Census Tract,118683,80.4173,72.2771,9189162,2297290.5,2711943864.9011,721128.5005,118421
Montana,Postal Code,118654,69.9287,74.8914,9181610,2295402.5,2709785572.9773,720554.5926,118393
Nebraska,Census Tract,283467,93.4176,80.6201,21582607,5395651.75,6725165429.1834,3407555.4824,283257
Nebraska,Postal Code,283330,80.3729,86.881,21495882,5373970.5,6698087315.2918,3393835.3478,283121
Nevada,Census Tract,569461,98.1626,90.7952,43616656,10904164.0,17236108170.2717,6552267.6146,556715
Nevada,Postal Code,569104,80.3581,92.4156,43540016,10885004.0,17206349924.6226,6541464.5406,556366
New Hampshire,Census Tract,107103,82.6868,67.9416,9054358,2263589.5,2555251276.172,1106392.3375,106841
New Hampshire,Postal Code,107012,50.1423,68.1437,9037409,2259352.25,2550456273.824,1104316.148,106750
New Jersey,Census Tract,1632773,124.2201,72.4928,117024321,29256080.25,34132296027.4146,21441825.259,1620118
New Jersey,Postal Code,1629714,88.2289,76.2982,116249897,29062474.25,33904852397.547,21299363.2397,1617086
New Mexico,Census Tract,365962,90.1931,87.2656,29605361,7401340.25,12208818476.4937,5193766.8187,362213
New Mexico,Postal Code,365713,73.5622,90.6647,29552308,7388077.0,12187002098.5036,5184507.9049,361964
New York,Census Tract,2506035,87.0165,70.3824,158794563,39698640.75,45100394878.6695,21932730.052,2487240
New York,Postal Code,2502541,85.2767,77.4082,157857812,39464453.0,44831446454.6672,21798509.3084,2483797
North Carolina,Census Tract,1416843,111.0038,68.1828,124233257,31058314.25,39607264848.0049,23363984.2396,1413932
North Carolina,Postal Code,1416043,63.1941,76.8315,123962977,30990744.25,39519833527.2098,23311951.927,1413133
North Dakota,Census Tract,77129,88.5566,75.3666,8138951,2034737.75,2299032486.1954,1164890.4157,77105
North Dakota,Postal Code,77117,78.5321,80.688,8128226,2032056.5,2295970930.9818,1163339.1648,77093
Ohio,Census Tract,2194900,100.1958,76.2275,171901350,42975337.5,48300160986.3547,39985118.6948,2192055
Ohio,Postal Code,2192109,79.3352,82.3972,171022353,42755588.25,48048536615.6779,39776810.4632,2189269
Oklahoma,Census Tract,701280,90.5894,87.743,60560124,15140031.0,20218586198.6994,13676736.4824,700478
Oklahoma,Postal Code,700888,76.98,90.6883,60455902,15113975.5,20183717271.2619,13653148.5462,700086
Oregon,Census Tract,773130,92.0755,79.6266,61617355,15404338.75,16514535968.3864,4391352.901,764477
Oregon,Postal Code,772441,76.6703,85.5628,61510848,15377712.0,16486992928.992,4384028.977,763794
Pennsylvania,Census Tract,1956097,92.6831,68.8571,133691622,33422905.5,38210009215.7575,25679219.8044,1951689
Pennsylvania,Postal Code,1954585,79.0697,79.5015,133004637,33251159.25,38013732231.3753,25546821.4854,1950183
Ponce,Census Tract,18091,91.5624,89.9396,1165041,291260.25,385731295.9627,259596.6362,18091
Ponce,Postal Code,18706,87.8722,91.4487,1162806,290701.5,384801553.7466,258970.9209,18706
Rhode Island,Census Tract,203167,91.7401,75.6977,13001474,3250368.5,3726814813.7139,1613670.2388,202796
Rhode Island,Postal Code,202865,83.842,75.4781,12914100,3228525.0,3701710212.1397,1602800.1897,202494
San Juan,Census Tract,44341,361.16,90.2047,3375014,843753.5,1177674698.0645,792573.4659,44341
San Juan,Postal Code,44665,98.2455,91.3301,3423143,855785.75,1195075494.0901,804284.1779,44665
South Carolina,Census Tract,908394,95.474,73.3968,79312131,19828032.75,25692275291.3394,15082325.9532,907128
South Carolina,Postal Code,907878,68.2991,80.0856,79183940,19795985.0,25650182524.8031,15057615.5421,906615
South Dakota,Census Tract,72867,82.7819,73.1301,6377373,1594343.25,1966083346.8824,1047973.7957,72846
South Dakota,Postal Code,72847,52.4508,76.1648,6372371,1593092.75,1964549826.5416,1047147.0385,72826
Tennessee,Census Tract,1105463,96.2296,76.2727,101762224,25440556.0,31169276299.0686,23662867.3964,1104151
Tennessee,Postal Code,1102947,74.4601,83.6595,101108289,25277072.25,30966907026.8117,23508638.5762,1101641
Texas,Census Tract,5480573,89.8634,83.6034,481747719,120436929.75,160458070556.0887,80026572.0962,5466434
Texas,Postal Code,5476777,81.3535,89.3493,480505530,120126382.5,160039623751.7003,79820466.3972,5462650
Toa Alta,Census Tract,1345,1710.7408,87.9579,73394,18348.5,25725431.5722,17313.1804,1345
Toa Alta,Postal Code,1123,83.1899,89.3397,88675,22168.75,31279276.9725,21050.9107,1123
Toa Baja,Census Tract,6517,108.025,90.5911,362967,90741.75,128650286.2398,86581.4672,6517
Toa Baja,Postal Code,6976,96.8358,89.3901,371052,92763.0,131548735.5374,88532.1196,6976
Trujillo Alto,Census Tract,2873,2040.5625,86.2239,197851,49462.75,69008952.5837,46442.931,2873
Trujillo Alto,Postal Code,2854,93.47,88.8184,196126,49031.5,68412270.1506,46041.3645,2854
Utah,Census Tract,573155,93.1267,84.2271,44105531,11026382.75,15249940379.6631,4055086.383,569989
Utah,Postal Code,572530,76.1622,85.9358,43988756,10997189.0,15209638303.2219,4044369.7246,569369
Vermont,Census Tract,19530,102.7981,68.8986,2012472,503118.0,551942863.0689,238985.907,19399
Vermont,Postal Code,19504,79.3592,79.5995,1988764,497191.0,545353715.0416,236132.8698,19373
Virginia,Census Tract,963792,90.9867,70.298,74914378,18728594.5,23169044381.2503,14570516.6127,961383
Virginia,Postal Code,963270,70.4411,77.4466,74735305,18683826.25,23113080773.3992,14534537.8188,960863
Washington,Census Tract,1511814,102.219,74.3927,107938035,26984508.75,27475803851.3941,7305348.1216,1506055
Washington,Postal Code,1510869,83.2164,84.04,107756625,26939156.25,27430232929.4004,7293347.1851,1505113
West Virginia,Census Tract,155047,134.7041,71.8114,11387665,2846916.25,3272165883.9079,2708875.4834,154967
West Virginia,Postal Code,154869,66.8391,82.7115,11336559,2834139.75,3257389195.7983,2696642.5437,154789
Wisconsin,Census Tract,900707,93.1937,74.5536,82459475,20614868.75,23542559983.9033,18538719.2118,898793
Wisconsin,Postal Code,900028,78.2139,80.0668,82263947,20565986.75,23486482672.1245,18493486.254,898115
Wyoming,Census Tract,53090,75.8881,78.6815,3848056,962014.0,1302268164.5377,399567.8101,53061
Wyoming,Postal Code,53068,78.9686,78.7653,3843267,960816.75,1300665963.8247,399141.7715,53039


2025-01-27 06:32:30 - root - INFO - Please check the answer again by reviewing Can you provide a detailed comparison of the solar potential for each state, distinguishing between postal code and census tract levels? Include the number of buildings available for solar installations, the percentage covered by Project Sunroof, the percentage suitable for solar, total potential panel count, total kilowatt capacity, energy generation potential, carbon dioxide offset, and the gap in potential installations., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
State,Level,Number of Buildings Available for Solar Installations,Percentage Covered by Project Sunroof,Percentage Suitable for Solar,Total Potential Panel Count,Total Kilowatt Capacity,Energy Generation Potential,Carbon Dioxide Offset,Gap in Potential Installations
state_name:str,Postal Code,count_qualified:int,percent_covered:float[0-100],percent_qualified:float[0-100],number_of_panels_total:int,kw_total:float,yearly_sunlight_kwh_total:float,carbon_offset_metric_tons:float,gap_in_potential_installations:int
state_name:str,Census Tract,count_qualified:int,percent_covered:float[0-100],percent_qualified:float[0-100],number_of_panels_total:int,kw_total:float,yearly_sunlight_kwh_total:float,carbon_offset_metric_tons:float,gap_in_potential_installations:int
...
```

This table provides a detailed comparison of the solar potential for each state at both postal code and census tract levels. It includes key metrics such as the number of buildings available for solar installations, percentages covered by Project Sunroof and suitable for solar, total potential panel count, total kilowatt capacity, energy generation potential, carbon dioxide offset, and the gap in potential installations (calculated as the difference between the number of qualified buildings and existing installations). The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Too long, hard cut:
state_name,Level,Number of Buildings Available for Solar Installations,Percentage Covered by Project Sunroof,Percentage Suitable for Solar,Total Potential Panel Count,Total Kilowatt Capacity,Energy Generation Potential,Carbon Dioxide Offset,Gap in Potential Installations
Aguadilla,Census Tract,5852,95.939,89.843,432711,108177.75,160079112.7508,107733.0246,5852
Aguadilla,Postal Code,5844,93.1553,94.3114,432049,108012.25,159844295.7499,107574.9931,5844
Alabama,Census Tract,814213,118.1518,75.7065,77644088,19411022.0,24759196398.2548,15792877.1553,813666
Alabama,Postal Code,813312,65.3636,81.883,77298546,19324636.5,24646969095.8459,15723425.9345,812768
Alaska,Census Tract,57169,83.1343,67.3891,5462549,1365637.25,1092118868.9738,449958.7974,57086
Alaska,Postal Code,57138,88.9663,78.0098,5447225,1361806.25,1089086633.2073,448709.5001,57055
Arecibo,Census Tract,3962,239.5516,94.191,306604,76651.0,110110577.3654,74104.2684,3962
Arecibo,Postal Code,4433,77.8753,93.4074,345214,86303.5,123956987.1142,83422.8833,4433
Arizona,Census Tract,1754534,109.6458,90.4052,147450436,36862609.0,59127893265.4281,25393752.1209,1714808
Arizona,Postal Code,1753531,87.4686,93.8148,147238408,36809602.0,59043009935.2978,25357559.2992,1713835
Arkansas,Census Tract,370016,94.088,73.5761,36012747,9003186.75,11362387314.959,7162306.2281,369777
Arkansas,Postal Code,369725,64.0318,80.533,35933867,8983466.75,11336956069.4067,7146339.2217,369486
Baja California,Postal Code,1,0.0674,20.0,23,5.75,8322.0298,0.0,1
Bayamón,Census Tract,33466,98.8687,90.5409,2134598,533649.5,751085531.8753,505479.5388,33466
Bayamón,Postal Code,33260,97.3641,91.2841,2098880,524720.0,738592635.6176,497071.8366,33260
Cabo Rojo,Census Tract,2,5.0,100.0,668,167.0,236279.5845,159.0158,2
California,Census Tract,8617901,93.222,84.4261,654784266,163696066.5,243304846869.2128,67060256.5599,8286083
California,Postal Code,8607224,89.7807,88.4105,652983168,163245792.0,242638396940.6192,66878632.2241,8275950
Canóvanas,Census Tract,2099,111.1123,82.9791,139475,34868.75,49976173.3745,33633.8965,2099
Canóvanas,Postal Code,2182,66.3404,89.4262,160471,40117.75,57543460.702,38726.6706,2182
Carolina,Census Tract,19688,118.6116,91.9501,1554053,388513.25,553262399.394,372344.8404,19688
Carolina,Postal Code,19237,88.9531,93.4122,1481427,370356.75,527251268.0265,354839.3844,19237
Cataño,Census Tract,2764,1977.1136,86.5736,168020,42005.0,59578578.5969,40096.3022,2764
Cataño,Postal Code,2860,95.5526,91.1964,186311,46577.75,65981195.4786,44405.2546,2860
Colorado,Census Tract,1032067,90.8059,80.5216,69425443,17356360.75,24667013678.5191,15019343.8016,1007705
Colorado,Postal Code,1031389,81.1294,83.0777,69150828,17287707.0,24570049923.1474,14960304.1466,1007054
Connecticut,Census Tract,608869,87.306,65.7534,43575214,10893803.5,12438466928.1723,5385610.0147,603585
Connecticut,Postal Code,607976,77.1033,72.2988,43269892,10817473.0,12350145123.4525,5347366.4436,602708
Corozal,Postal Code,15,1.2121,93.75,1667,416.75,587979.9846,395.7097,15
Delaware,Census Tract,147535,85.2779,71.135,10771425,2692856.25,3222438352.7232,2047732.7107,147447
Delaware,Postal Code,147431,77.332,79.8785,10742839,2685709.75,3213827406.3592,2042260.7933,147343
District of Columbia,Census Tract,76464,85.3173,63.3971,3983844,995961.0,1209717858.796,768728.0745,76022
District of Columbia,Postal Code,76385,81.9633,75.1149,3937623,984405.75,1195714591.0355,759829.5492,75943
Dorado,Census Tract,3067,133.8422,94.5521,199501,49875.25,70542741.7862,47475.169,3067
Dorado,Postal Code,3064,78.2786,93.8438,199254,49813.5,70454673.2366,47415.899,3064
Florida,Census Tract,4817871,99.6346,83.2794,463123814,115780953.5,157971622252.8879,84762071.9664,4712507
Florida,Postal Code,4814177,82.985,90.8502,462105732,115526433.0,157617914915.2241,84572912.4937,4708885
Georgia,Census Tract,1503687,96.5546,68.6019,140138439,35034609.75,44737933517.8748,26767856.4735,1501780
Georgia,Postal Code,1502091,72.027,76.484,139653741,34913435.25,44581060812.0368,26673519.942,1500185
Guaynabo,Census Tract,11603,111.2681,89.7714,984133,246033.25,342005084.6764,230168.9556,11603
Guaynabo,Postal Code,12113,96.6907,88.4395,986943,246735.75,342637380.9947,230594.4902,12113
Hatillo,Census Tract,224,38.8518,91.4723,25246,6311.5,9067192.2231,6102.208,224
Hawaii,Census Tract,204390,92.4089,90.2883,19873246,4968311.5,7415195492.5459,4666457.0008,178998
Hawaii,Postal Code,204227,85.7732,94.9313,19835765,4958941.25,7400954705.8092,4657525.9105,178851
Hormigueros,Census Tract,1264,72.0382,91.178,59807,14951.75,21266625.2353,14312.4098,1264
Hormigueros,Postal Code,1194,58.6907,91.8462,54608,13652.0,19401835.6499,13057.4089,1194
Idaho,Census Tract,311878,84.4666,75.9108,23093899,5773474.75,7526956885.2397,2001480.636,311349
Idaho,Postal Code,311671,77.4462,85.8175,23026001,5756500.25,7504231760.3211,1995437.8357,311142
Illinois,Census Tract,2055456,91.6539,75.0704,164256874,41064218.5,47344747566.8231,39019478.6006,2053003
Illinois,Postal Code,2052522,81.5217,81.2255,163236997,40809249.25,47047851222.0221,38776748.3064,2050075
Indiana,Census Tract,1117000,102.8846,74.4163,93311273,23327818.25,26928123257.6459,22286009.0753,1116012
Indiana,Postal Code,1116413,72.7073,80.987,93048465,23262116.25,26851041383.5442,22222230.941,1115426
Iowa,Census Tract,350284,92.5024,67.5514,29953011,7488252.75,8843145869.3995,4480709.1374,350036
Iowa,Postal Code,350073,72.2617,78.46,29910958,7477739.5,8830596479.3874,4474350.5217,349825
Kansas,Census Tract,417333,89.9511,74.4584,36827430,9206857.5,11882464352.009,8248164.1941,416595
Kansas,Postal Code,417118,78.0015,83.9098,36723960,9180990.0,11849160234.7906,8225046.2769,416381
Kentucky,Census Tract,575985,94.6227,80.7995,47393349,11848337.25,14048103923.8934,10893849.0274,575262
Kentucky,Postal Code,577255,75.3474,86.8544,47570216,11892554.0,14104070608.581,10935523.8322,576530
Louisiana,Census Tract,865003,113.4494,82.1744,80308875,20077218.75,25885642034.5816,16119065.6327,856780
Louisiana,Postal Code,864431,74.024,85.776,80134650,20033662.5,25827876726.1345,16083222.6057,856210
Loíza,Census Tract,40,85.4839,75.4717,1693,423.25,595043.1626,400.4632,40
Maine,Census Tract,100065,85.243,65.1755,7720530,1930132.5,2197957054.0976,951467.7454,99705
Maine,Postal Code,99960,63.1011,63.6367,7689271,1922317.75,2189004685.1429,947591.4565,99600
Maryland,Census Tract,705813,80.0363,69.8131,47690643,11922660.75,14399236326.4912,9341908.1826,699742
Maryland,Postal Code,705396,71.1603,78.2144,47560886,11890221.5,14360334548.5629,9317029.141,699332
Massachusetts,Census Tract,1002203,87.2198,72.2894,69012277,17253069.25,19514148116.7534,8448829.9999,986834
Massachusetts,Postal Code,1000732,81.6985,73.9491,68609324,17152331.0,19399236401.3824,8399385.4282,985382
Mayagüez,Census Tract,7284,129.1771,88.3152,567212,141803.0,202552659.3214,136317.6635,7284
Mayagüez,Postal Code,7348,93.569,91.3667,571212,142803.0,203989405.6051,137284.5918,7348
Michigan,Census Tract,1847255,96.3166,72.8745,147876313,36969078.25,40976609871.5264,32170938.2644,1845535
Michigan,Postal Code,1846232,76.1111,79.0414,147391827,36847956.75,40840033399.2527,32063411.3893,1844515
Minnesota,Census Tract,770077,90.4283,64.555,65662303,16415575.75,18673751434.6169,9461269.6042,768559
Minnesota,Postal Code,769481,83.0701,72.0268,65464154,16366038.5,18617438249.1569,9432736.4319,767964
Mississippi,Census Tract,325095,110.3869,70.4745,32218920,8054730.0,10408673466.6126,6675246.3993,324739
Mississippi,Postal Code,324867,72.6311,82.1917,32127017,8031754.25,10378294594.5712,6657377.0432,324511
Missouri,Census Tract,1032104,89.1769,76.3367,84085928,21021482.0,26123174340.9371,20988770.9428,1029240
Missouri,Postal Code,1031097,80.3442,82.5577,83816328,20954082.0,26038971734.1468,20922455.4678,1028243
Moca,Census Tract,1,0.8264,100.0,28,7.0,8580.8571,5.7749,1
Moca,Postal Code,1,0.369,100.0,28,7.0,8580.8571,5.7749,1
Montana,Census Tract,118683,80.4173,72.2771,9189162,2297290.5,2711943864.9011,721128.5005,118421
Montana,Postal Code,118654,69.9287,74.8914,9181610,2295402.5,2709785572.9773,720554.5926,118393
Nebraska,Census Tract,283467,93.4176,80.6201,21582607,5395651.75,6725165429.1834,3407555.4824,283257
Nebraska,Postal Code,283330,80.3729,86.881,21495882,5373970.5,6698087315.2918,3393835.3478,283121
Nevada,Census Tract,569461,98.1626,90.7952,43616656,10904164.0,17236108170.2717,6552267.6146,556715
Nevada,Postal Code,569104,80.3581,92.4156,43540016,10885004.0,17206349924.6226,6541464.5406,556366
New Hampshire,Census Tract,107103,82.6868,67.9416,9054358,2263589.5,2555251276.172,1106392.3375,106841
New Hampshire,Postal Code,107012,50.1423,68.1437,9037409,2259352.25,2550456273.824,1104316.148,106750
New Jersey,Census Tract,1632773,124.2201,72.4928,117024321,29256080.25,34132296027.4146,21441825.259,1620118
New Jersey,Postal Code,1629714,88.2289,76.2982,116249897,29062474.25,33904852397.547,21299363.2397,1617086
New Mexico,Census Tract,365962,90.1931,87.2656,29605361,7401340.25,12208818476.4937,5193766.8187,362213
New Mexico,Postal Code,365713,73.5622,90.6647,29552308,7388077.0,12187002098.5036,5184507.9049,361964
New York,Census Tract,2506035,87.0165,70.3824,158794563,39698640.75,45100394878.6695,21932730.052,2487240
New York,Postal Code,2502541,85.2767,77.4082,157857812,39464453.0,44831446454.6672,21798509.3084,2483797
North Carolina,Census Tract,1416843,111.0038,68.1828,124233257,31058314.25,39607264848.0049,23363984.2396,1413932
North Carolina,Postal Code,1416043,63.1941,76.8315,123962977,30990744.25,39519833527.2098,23311951.927,1413133
North Dakota,Census Tract,77129,88.5566,75.3666,8138951,2034737.75,2299032486.1954,1164890.4157,77105
North Dakota,Postal Code,77117,78.5321,80.688,8128226,2032056.5,2295970930.9818,1163339.1648,77093
Ohio,Census Tract,2194900,100.1958,76.2275,171901350,42975337.5,48300160986.3547,39985118.6948,2192055
Ohio,Postal Code,2192109,79.3352,82.3972,171022353,42755588.25,48048536615.6779,39776810.4632,2189269
Oklahoma,Census Tract,701280,90.5894,87.743,60560124,15140031.0,20218
Current sql:
SELECT
    "state_name",
    "Level",
    SUM("count_qualified") AS "Number of Buildings Available for Solar Installations",
    ROUND(AVG("percent_covered"), 4) AS "Percentage Covered by Project Sunroof",
    ROUND(AVG("percent_qualified"), 4) AS "Percentage Suitable for Solar",
    SUM("number_of_panels_total") AS "Total Potential Panel Count",
    ROUND(SUM("kw_total"), 4) AS "Total Kilowatt Capacity",
    ROUND(SUM("yearly_sunlight_kwh_total"), 4) AS "Energy Generation Potential",
    ROUND(SUM("carbon_offset_metric_tons"), 4) AS "Carbon Dioxide Offset",
    SUM("count_qualified") - SUM("existing_installs_count") AS "Gap in Potential Installations"
FROM
(
    SELECT
        "state_name",
        'Postal Code' AS "Level",
        "count_qualified",
        "percent_covered",
        "percent_qualified",
        "number_of_panels_total",
        "kw_total",
        "yearly_sunlight_kwh_total",
        "carbon_offset_metric_tons",
        "existing_installs_count"
    FROM
        SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
    UNION ALL
    SELECT
        "state_name",
        'Census Tract' AS "Level",
        "count_qualified",
        "percent_covered",
        "percent_qualified",
        "number_of_panels_total",
        "kw_total",
        "yearly_sunlight_kwh_total",
        "carbon_offset_metric_tons",
        "existing_installs_count"
    FROM
        SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
) AS combined_data
GROUP BY
    "state_name",
    "Level"
ORDER BY
    "state_name",
    "Level";
2025-01-27 06:33:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 06:33:17 - root - INFO - ```sql
SELECT
    "state_name",
    "Level",
    SUM("count_qualified") AS "Number of Buildings Available for Solar Installations",
    ROUND(AVG("percent_covered"), 4) AS "Percentage Covered by Project Sunroof",
    ROUND(AVG("percent_qualified"), 4) AS "Percentage Suitable for Solar",
    SUM("number_of_panels_total") AS "Total Potential Panel Count",
    ROUND(SUM("kw_total"), 4) AS "Total Kilowatt Capacity",
    ROUND(SUM("yearly_sunlight_kwh_total"), 4) AS "Energy Generation Potential",
    ROUND(SUM("carbon_offset_metric_tons"), 4) AS "Carbon Dioxide Offset",
    SUM("count_qualified") - SUM("existing_installs_count") AS "Gap in Potential Installations"
FROM
(
    SELECT
        "state_name",
        'Postal Code' AS "Level",
        "count_qualified",
        "percent_covered",
        "percent_qualified",
        "number_of_panels_total",
        "kw_total",
        "yearly_sunlight_kwh_total",
        "carbon_offset_metric_tons",
        "existing_installs_count"
    FROM
        SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
    UNION ALL
    SELECT
        "state_name",
        'Census Tract' AS "Level",
        "count_qualified",
        "percent_covered",
        "percent_qualified",
        "number_of_panels_total",
        "kw_total",
        "yearly_sunlight_kwh_total",
        "carbon_offset_metric_tons",
        "existing_installs_count"
    FROM
        SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
) AS combined_data
GROUP BY
    "state_name",
    "Level"
ORDER BY
    "state_name",
    "Level";
```
2025-01-27 06:33:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:33:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:33:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:33:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 139
2025-01-27 06:33:18 - snowflake.connector.connection - INFO - closed
2025-01-27 06:33:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:33:19 - root - INFO - itercount: 3
2025-01-27 06:33:19 - root - INFO - 0
2025-01-27 06:33:19 - root - INFO - Total iteration counts: 3
