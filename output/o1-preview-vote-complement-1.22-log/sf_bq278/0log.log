2025-01-27 06:28:01 - openai._base_client - INFO - Retrying request to /chat/completions in 0.485319 seconds
2025-01-27 06:28:55 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 06:28:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:28:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:28:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:28:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 06:28:57 - snowflake.connector.connection - INFO - closed
2025-01-27 06:28:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:28:58 - root - INFO - SQL:
SELECT "state_name", "region_name", "count_qualified"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   LIMIT 100;
Results:
state_name,region_name,count_qualified
Pennsylvania,19149,4602
Pennsylvania,19120,6086
Pennsylvania,19132,5157
Pennsylvania,19134,7551
Pennsylvania,19138,4256
Pennsylvania,19143,7093
Pennsylvania,19148,7885
Pennsylvania,19131,4590
Pennsylvania,19133,3545
Pennsylvania,19139,4874
Pennsylvania,19140,6871
Pennsylvania,19141,3528
Pennsylvania,19142,2701
Pennsylvania,19145,6147
Pennsylvania,19146,6749
Pennsylvania,19150,3872
Pennsylvania,19151,3518
Pennsylvania,19125,4917
Pennsylvania,19135,4824
Pennsylvania,19147,6785
District of Columbia,20002,6154
District of Columbia,20003,1946
Indiana,46704,23
Texas,75371,20
California,92386,172
Pennsylvania,15629,141
Pennsylvania,19023,3413
Pennsylvania,19121,5961
Pennsylvania,19124,7649
Pennsylvania,19126,2172
Pennsylvania,19144,6860
District of Columbia,20001,3636
South Carolina,29920,15
New Jersey,08104,3698
New York,12512,16
Pennsylvania,19082,5331
Pennsylvania,19119,4821
Pennsylvania,19127,1830
Pennsylvania,19130,3810
Pennsylvania,19604,4723
District of Columbia,20010,3021
District of Columbia,20011,10516
Indiana,46393,22
Minnesota,55417,4881
New Jersey,08102,1005
New Jersey,08103,2518
New Jersey,08611,4735
New York,11215,5972
New York,11233,5046
New York,11379,6142
New York,11419,5702
New York,11428,3702
New York,11451,12
Pennsylvania,15224,2804
Pennsylvania,17019,15
Pennsylvania,19122,2899
Pennsylvania,19129,1621
Pennsylvania,19602,2941
District of Columbia,20009,3251
Maryland,21239,6831
Minnesota,55412,4693
Minnesota,55805,2272
Minnesota,55807,3931
New Jersey,07756,1150
New York,11105,3809
New York,11216,4016
New York,11217,2862
New York,11370,2925
New York,11412,6617
New York,11417,4160
New York,11421,4388
New York,11436,2971
New York,11802,13
New York,14619,3363
Pennsylvania,15110,2079
Pennsylvania,15203,3075
Pennsylvania,15208,2766
Pennsylvania,15210,7989
Pennsylvania,18102,8980
Pennsylvania,19079,1944
Pennsylvania,19104,4612
Pennsylvania,19601,6056
District of Columbia,20007,4317
District of Columbia,20017,3848
Maryland,20782,351
Maryland,21229,12459
Maryland,21230,11451
Alabama,35043,8
Ohio,43608,5648
Ohio,43610,1479
Ohio,44123,4808
Ohio,45147,9
Michigan,48146,13114
Michigan,48223,5378
Michigan,48224,12218
Michigan,48227,12513
Michigan,48915,2654
Michigan,49507,7778
Minnesota,55104,6959
Minnesota,55406,6992

2025-01-27 06:28:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:28:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:28:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:28:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 70
2025-01-27 06:28:59 - snowflake.connector.connection - INFO - closed
2025-01-27 06:29:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:29:00 - root - INFO - SQL:
SELECT DISTINCT "state_name"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
   LIMIT 100;
Results:
state_name
Pennsylvania
District of Columbia
New York
Delaware
Maryland
New Jersey
Virginia
Florida
Illinois
Indiana
Louisiana
Michigan
Minnesota
New Hampshire
Texas
Arizona
California
Colorado
Mayagüez
Georgia
South Carolina
Iowa
Tennessee
Wisconsin
Alaska
Kansas
Nebraska
West Virginia
Kentucky
Connecticut
Idaho
Nevada
Wyoming
Oregon
Mississippi
Aguadilla
Vermont
Carolina
Alabama
Bayamón
Arkansas
Canóvanas
Cataño
Guaynabo
New Mexico
Arecibo
Cabo Rojo
Ohio
North Carolina
Maine
Missouri
Massachusetts
North Dakota
South Dakota
Utah
Rhode Island
Ponce
San Juan
Oklahoma
Toa Baja
Hormigueros
Dorado
Hatillo
Loíza
Moca
Montana
Washington
Toa Alta
Trujillo Alto
Hawaii

2025-01-27 06:29:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:29:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:29:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:29:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 69
2025-01-27 06:29:01 - snowflake.connector.connection - INFO - closed
2025-01-27 06:29:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:29:02 - root - INFO - SQL:
SELECT "state_name", SUM("count_qualified") AS "total_buildings"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   GROUP BY "state_name"
   ORDER BY "total_buildings" DESC
   LIMIT 100;
Results:
state_name,total_buildings
California,8607224
Texas,5476777
Florida,4814177
New York,2502541
Ohio,2192109
Illinois,2052522
Pennsylvania,1954585
Michigan,1846232
Arizona,1753531
New Jersey,1629714
Washington,1510869
Georgia,1502091
North Carolina,1416043
Indiana,1116413
Tennessee,1102947
Colorado,1031389
Missouri,1031097
Massachusetts,1000732
Virginia,963270
South Carolina,907878
Wisconsin,900028
Louisiana,864431
Alabama,813312
Oregon,772441
Minnesota,769481
Maryland,705396
Oklahoma,700888
Connecticut,607976
Kentucky,577255
Utah,572530
Nevada,569104
Kansas,417118
Arkansas,369725
New Mexico,365713
Iowa,350073
Mississippi,324867
Idaho,311671
Nebraska,283330
Hawaii,204227
Rhode Island,202865
West Virginia,154869
Delaware,147431
Montana,118654
New Hampshire,107012
Maine,99960
North Dakota,77117
District of Columbia,76385
South Dakota,72847
Alaska,57138
Wyoming,53068
San Juan,44665
Bayamón,33260
Vermont,19504
Carolina,19237
Ponce,18706
Guaynabo,12113
Mayagüez,7348
Toa Baja,6976
Aguadilla,5844
Arecibo,4433
Dorado,3064
Cataño,2860
Trujillo Alto,2854
Canóvanas,2182
Hormigueros,1194
Toa Alta,1123
Corozal,15
Baja California,1
Moca,1

2025-01-27 06:29:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:29:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:29:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:29:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 70
2025-01-27 06:29:03 - snowflake.connector.connection - INFO - closed
2025-01-27 06:29:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:29:04 - root - INFO - SQL:
SELECT "state_name", AVG("percent_qualified") AS "avg_percent_qualified"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
   GROUP BY "state_name"
   LIMIT 100;
Results:
state_name,avg_percent_qualified
Pennsylvania,68.85707992410286
District of Columbia,63.397058540850374
New York,70.3824007333638
Delaware,71.13500821025055
Maryland,69.81305560602681
New Jersey,72.49284036555349
Virginia,70.29803660202286
Florida,83.27936582037172
Illinois,75.0703988032207
Indiana,74.4162992494216
Louisiana,82.17435382731469
Michigan,72.87447311567932
New Hampshire,67.9415712418198
Arizona,90.40516782276116
California,84.42610938177201
Colorado,80.52159958927903
Georgia,68.60191456870614
Wisconsin,74.55363214741563
Alaska,67.3891486348244
Kansas,74.45838191092518
Nebraska,80.62010526352871
West Virginia,71.8114182883734
Kentucky,80.79952498243404
Maine,65.17547802899195
Missouri,76.3366899845083
South Dakota,73.1301178566635
Washington,74.3926663890639
Rhode Island,75.69773905575148
Mississippi,70.47452389375442
Oregon,79.62664401997048
San Juan,90.2046719638303
Oklahoma,87.74299094697147
Carolina,91.95012311270571
Trujillo Alto,86.22386755943712
New Mexico,87.26558195086373
Toa Baja,90.59109586594275
Dorado,94.55205024605395
Loíza,75.47169811320755
Minnesota,64.55495274901153
South Carolina,73.39684628969717
Iowa,67.55135102465916
Ohio,76.22748275975313
Mayagüez,88.31524322675783
North Carolina,68.18277115519244
North Dakota,75.3665552162828
Connecticut,65.75337434981022
Massachusetts,72.28938390680628
Utah,84.22705043917742
Idaho,75.91076792895495
Nevada,90.79523059001976
Wyoming,78.68145154613299
Ponce,89.9396040617879
Aguadilla,89.84303986917156
Vermont,68.89857488088953
Alabama,75.7064689620111
Bayamón,90.54093297303565
Arkansas,73.5760827694726
Canóvanas,82.97908947936548
Cataño,86.57358974659549
Guaynabo,89.7713593686313
Hawaii,90.28828623458989
Hormigueros,91.17801424826256
Arecibo,94.1909789661489
Hatillo,91.4722740602506
Cabo Rojo,100.0
Moca,100.0
Texas,83.60340471279187
Tennessee,76.27267213792194
Montana,72.27714051202193
Toa Alta,87.95785274938673

2025-01-27 06:29:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:29:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:29:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:29:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 06:29:05 - snowflake.connector.connection - INFO - closed
2025-01-27 06:29:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:29:05 - root - INFO - SQL:
SELECT "state_name", "region_name", "percent_covered"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   WHERE "percent_covered" < 100
   ORDER BY "percent_covered" ASC
   LIMIT 100;
Results:
state_name,region_name,percent_covered
Virginia,22630,0.0076120879957372305
Tennessee,37821,0.008841732979664015
South Carolina,29909,0.01056859015007398
Louisiana,70578,0.01088850174216028
California,92231,0.011906179307060364
Florida,34142,0.014690759512266784
Utah,84045,0.014961101137043686
North Carolina,28460,0.015715857300015717
Georgia,30680,0.01625223468226881
Pennsylvania,15044,0.017467248908296942
Arkansas,72753,0.01805706031058144
Georgia,30014,0.018409425625920472
Utah,84720,0.018889308651303362
Illinois,60950,0.019692792437967704
Kentucky,42420,0.020405387022173854
Maryland,21532,0.02081165452653486
Nevada,89044,0.02081165452653486
New Jersey,07456,0.021953896816684963
Kansas,67110,0.022634676324128564
Oregon,97457,0.0230361667818475
Louisiana,70584,0.023218017181332713
California,92231,0.02381235861412073
New York,13827,0.02462447672986949
South Carolina,29927,0.025913449080072558
North Carolina,28326,0.027658691743880515
South Dakota,57032,0.028760425654299683
Alabama,36312,0.029559562518474726
Alabama,35051,0.032175032175032175
Utah,84310,0.03324468085106383
Missouri,65738,0.033776176536816034
Pennsylvania,19565,0.034482758620689655
California,93646,0.035984166966534725
South Carolina,29440,0.03610629693818602
Washington,98629,0.03718854592785422
Michigan,48049,0.03979307600477517
Indiana,46001,0.04231908590774439
Delaware,19933,0.042863266180882986
Florida,32640,0.043010752688172046
South Carolina,29697,0.043202764976958526
Michigan,49331,0.043725404459991256
Oregon,97019,0.04679457182966776
Florida,33545,0.0474158368895211
Washington,98922,0.04795013186286262
Arkansas,72774,0.0488162069807176
Texas,78264,0.049172266841501396
Virginia,24149,0.0514668039114771
Pennsylvania,15644,0.05171165580721895
New York,13073,0.05305039787798409
Ohio,45895,0.054097917230186636
Florida,33523,0.05497526113249038
Louisiana,70764,0.05578489345085351
Ohio,43015,0.05705048968336978
Massachusetts,01007,0.057383320581484314
Texas,78596,0.05748928608759277
Maryland,20781,0.05856515373352855
Alabama,35044,0.05868544600938967
Massachusetts,01833,0.06016847172081829
Georgia,30180,0.06353240152477764
Florida,33321,0.06626277925028398
Baja California,22400,0.06743088334457181
Georgia,30738,0.06961364427427776
Colorado,80951,0.07012622720897616
Iowa,52333,0.07120816520294328
Pennsylvania,18436,0.07125552230297848
Kansas,66086,0.0721110510185686
Pennsylvania,17360,0.07256894049346879
Florida,32732,0.07342143906020558
Connecticut,06441,0.07479431563201197
New Jersey,08731,0.07526881720430108
Minnesota,56320,0.07651109410864575
Washington,99036,0.07680491551459294
Alabama,36376,0.07757951900698215
Missouri,64079,0.0782472613458529
Virginia,23314,0.08045052292839903
South Carolina,29691,0.08200754469411185
New Jersey,08533,0.08527572484366117
Florida,33935,0.08585796639273886
Florida,33469,0.08595495960116899
North Carolina,28357,0.08613264427217916
California,95045,0.08779631255487269
Florida,33033,0.08887673480549668
New York,14004,0.08986744551786116
Virginia,24069,0.09025270758122744
Texas,75755,0.09082652134423251
Texas,76574,0.09338036937123885
Louisiana,71006,0.0936768149882904
Tennessee,37861,0.09881422924901186
Indiana,46914,0.09910802775024777
South Dakota,57005,0.1003814495081309
Tennessee,37015,0.10109179134654266
Louisiana,70668,0.10131712259371833
Missouri,64060,0.10190711894016596
Michigan,49277,0.10319917440660474
Ohio,44904,0.10337698139214335
North Carolina,28168,0.10393466963622866
Alabama,36250,0.10604453870625663
North Carolina,28555,0.10643959552953698
Florida,32667,0.10649627263045794
New Hampshire,03867,0.10872941907424666
Texas,76008,0.1109193985703722

2025-01-27 06:29:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:29:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:29:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:29:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 70
2025-01-27 06:29:07 - snowflake.connector.connection - INFO - closed
2025-01-27 06:29:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:29:07 - root - INFO - SQL:
SELECT "state_name", SUM("number_of_panels_total") AS "total_panels"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
   GROUP BY "state_name"
   ORDER BY "total_panels" DESC
   LIMIT 100;
Results:
state_name,total_panels
California,654784266
Texas,481747719
Florida,463123814
Ohio,171901350
Illinois,164256874
New York,158794563
Michigan,147876313
Arizona,147450436
Georgia,140138439
Pennsylvania,133691622
North Carolina,124233257
New Jersey,117024321
Washington,107938035
Tennessee,101762224
Indiana,93311273
Missouri,84085928
Wisconsin,82459475
Louisiana,80308875
South Carolina,79312131
Alabama,77644088
Virginia,74914378
Colorado,69425443
Massachusetts,69012277
Minnesota,65662303
Oregon,61617355
Oklahoma,60560124
Maryland,47690643
Kentucky,47393349
Utah,44105531
Nevada,43616656
Connecticut,43575214
Kansas,36827430
Arkansas,36012747
Mississippi,32218920
Iowa,29953011
New Mexico,29605361
Idaho,23093899
Nebraska,21582607
Hawaii,19873246
Rhode Island,13001474
West Virginia,11387665
Delaware,10771425
Montana,9189162
New Hampshire,9054358
North Dakota,8138951
Maine,7720530
South Dakota,6377373
Alaska,5462549
District of Columbia,3983844
Wyoming,3848056
San Juan,3375014
Bayamón,2134598
Vermont,2012472
Carolina,1554053
Ponce,1165041
Guaynabo,984133
Mayagüez,567212
Aguadilla,432711
Toa Baja,362967
Arecibo,306604
Dorado,199501
Trujillo Alto,197851
Cataño,168020
Canóvanas,139475
Toa Alta,73394
Hormigueros,59807
Hatillo,25246
Loíza,1693
Cabo Rojo,668
Moca,28

2025-01-27 06:29:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:29:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:29:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:29:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 69
2025-01-27 06:29:09 - snowflake.connector.connection - INFO - closed
2025-01-27 06:29:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:29:09 - root - INFO - SQL:
SELECT "state_name", 
          SUM("kw_total") AS "total_kw_capacity", 
          SUM("yearly_sunlight_kwh_total") AS "total_energy_potential"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   GROUP BY "state_name"
   LIMIT 100;
Results:
state_name,total_kw_capacity,total_energy_potential
Pennsylvania,33251159.25,38013732231.37531
District of Columbia,984405.75,1195714591.0355346
Indiana,23262116.25,26851041383.54419
Texas,120126382.5,160039623751.7003
California,163245792.0,242638396940.61917
South Carolina,19795985.0,25650182524.80312
New Jersey,29062474.25,33904852397.547024
New York,39464453.0,44831446454.66716
Minnesota,16366038.5,18617438249.156933
Ohio,42755588.25,48048536615.677925
Michigan,36847956.75,40840033399.2527
Colorado,17287707.0,24570049923.14742
Connecticut,10817473.0,12350145123.452475
Virginia,18683826.25,23113080773.399204
Wisconsin,20565986.75,23486482672.1245
Missouri,20954082.0,26038971734.14675
Nebraska,5373970.5,6698087315.291831
New Hampshire,2259352.25,2550456273.8240113
Maryland,11890221.5,14360334548.562885
Arizona,36809602.0,59043009935.297775
West Virginia,2834139.75,3257389195.7982965
Alabama,19324636.5,24646969095.845936
Illinois,40809249.25,47047851222.022064
Maine,1922317.75,2189004685.142859
Kentucky,11892554.0,14104070608.580994
Iowa,7477739.5,8830596479.387411
Wyoming,960816.75,1300665963.824701
North Carolina,30990744.25,39519833527.20979
Florida,115526433.0,157617914915.22406
Oregon,15377712.0,16486992928.991991
Alaska,1361806.25,1089086633.2073152
Tennessee,25277072.25,30966907026.81165
Ponce,290701.5,384801553.74663687
Louisiana,20033662.5,25827876726.134464
Vermont,497191.0,545353715.0415834
Arkansas,8983466.75,11336956069.406748
Guaynabo,246735.75,342637380.9947451
San Juan,855785.75,1195075494.090149
Cataño,46577.75,65981195.478601106
New Mexico,7388077.0,12187002098.50356
Mississippi,8031754.25,10378294594.571173
Bayamón,524720.0,738592635.6176331
Carolina,370356.75,527251268.02654415
Aguadilla,108012.25,159844295.74992672
Arecibo,86303.5,123956987.1142212
Canóvanas,40117.75,57543460.70198363
Baja California,5.75,8322.02979736328
Massachusetts,17152331.0,19399236401.382404
Delaware,2685709.75,3213827406.3591805
Washington,26939156.25,27430232929.40039
Rhode Island,3228525.0,3701710212.139731
Georgia,34913435.25,44581060812.036766
Oklahoma,15113975.5,20183717271.261906
Utah,10997189.0,15209638303.221928
South Dakota,1593092.75,1964549826.5415552
Idaho,5756500.25,7504231760.321072
Nevada,10885004.0,17206349924.622555
Toa Baja,92763.0,131548735.53740233
Toa Alta,22168.75,31279276.972485356
Mayagüez,142803.0,203989405.60508427
Hormigueros,13652.0,19401835.649896257
Dorado,49813.5,70454673.23659058
Corozal,416.75,587979.9845764162
Moca,7.0,8580.857080078125
Montana,2295402.5,2709785572.9772882
North Dakota,2032056.5,2295970930.981845
Trujillo Alto,49031.5,68412270.15056156
Hawaii,4958941.25,7400954705.809179
Kansas,9180990.0,11849160234.790615

2025-01-27 06:29:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:29:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:29:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:29:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 70
2025-01-27 06:29:10 - snowflake.connector.connection - INFO - closed
2025-01-27 06:29:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:29:11 - root - INFO - SQL:
SELECT "state_name", 
          SUM("count_qualified") AS "total_qualified_buildings", 
          SUM("existing_installs_count") AS "total_existing_installs", 
          (SUM("count_qualified") - SUM("existing_installs_count")) AS "gap_in_potential_installations"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
   GROUP BY "state_name"
   LIMIT 100;
Results:
state_name,total_qualified_buildings,total_existing_installs,gap_in_potential_installations
Pennsylvania,1956097,4408,1951689
District of Columbia,76464,442,76022
New York,2506035,18795,2487240
Delaware,147535,88,147447
Maryland,705813,6071,699742
New Jersey,1632773,12655,1620118
Virginia,963792,2409,961383
Florida,4817871,105364,4712507
Illinois,2055456,2453,2053003
Indiana,1117000,988,1116012
Louisiana,865003,8223,856780
Michigan,1847255,1720,1845535
New Hampshire,107103,262,106841
Arizona,1754534,39726,1714808
California,8617901,331818,8286083
Colorado,1032067,24362,1007705
Georgia,1503687,1907,1501780
Wisconsin,900707,1914,898793
Alaska,57169,83,57086
Kansas,417333,738,416595
Nebraska,283467,210,283257
West Virginia,155047,80,154967
Kentucky,575985,723,575262
Maine,100065,360,99705
Missouri,1032104,2864,1029240
South Dakota,72867,21,72846
Washington,1511814,5759,1506055
Rhode Island,203167,371,202796
Mississippi,325095,356,324739
Oregon,773130,8653,764477
San Juan,44341,0,44341
Oklahoma,701280,802,700478
Carolina,19688,0,19688
Trujillo Alto,2873,0,2873
New Mexico,365962,3749,362213
Toa Baja,6517,0,6517
Dorado,3067,0,3067
Loíza,40,0,40
Minnesota,770077,1518,768559
South Carolina,908394,1266,907128
Iowa,350284,248,350036
Ohio,2194900,2845,2192055
Mayagüez,7284,0,7284
North Carolina,1416843,2911,1413932
North Dakota,77129,24,77105
Connecticut,608869,5284,603585
Massachusetts,1002203,15369,986834
Utah,573155,3166,569989
Idaho,311878,529,311349
Nevada,569461,12746,556715
Wyoming,53090,29,53061
Ponce,18091,0,18091
Aguadilla,5852,0,5852
Vermont,19530,131,19399
Alabama,814213,547,813666
Bayamón,33466,0,33466
Arkansas,370016,239,369777
Canóvanas,2099,0,2099
Cataño,2764,0,2764
Guaynabo,11603,0,11603
Hawaii,204390,25392,178998
Hormigueros,1264,0,1264
Arecibo,3962,0,3962
Hatillo,224,0,224
Cabo Rojo,2,0,2
Moca,1,0,1
Texas,5480573,14139,5466434
Tennessee,1105463,1312,1104151
Montana,118683,262,118421
Toa Alta,1345,0,1345

2025-01-27 06:29:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:29:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:29:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:29:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 06:29:12 - snowflake.connector.connection - INFO - closed
2025-01-27 06:29:12 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:29:12 - root - INFO - SQL:
SELECT "state_name", "region_name", "carbon_offset_metric_tons"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   ORDER BY "carbon_offset_metric_tons" DESC
   LIMIT 100;
Results:
state_name,region_name,carbon_offset_metric_tons
Tennessee,38118,801735.9490285052
Illinois,60007,621853.3593412824
Texas,77494,512610.66813091835
Missouri,65802,489006.13508212473
Ohio,43228,484721.2635178499
Missouri,63376,463178.9595687375
Missouri,65803,462634.5778919277
Oklahoma,73099,435565.2331024933
Oklahoma,74012,432735.0023913438
Michigan,49512,427055.38823365886
Florida,32162,426646.01324156235
Ohio,44060,425206.8886913309
Kentucky,41042,420818.85740560095
Texas,79936,417872.11847402947
Oklahoma,73013,416935.5260617598
Missouri,65807,416307.6468588007
Illinois,60638,415850.68522787036
Tennessee,37211,415360.03745234973
Florida,33619,413916.33040673943
Missouri,64801,409676.1841050299
Indiana,47130,397864.94890305185
North Carolina,28273,393586.7245210941
Tennessee,37421,393287.2250266976
Georgia,30336,390615.54834114376
Oklahoma,73160,389559.3592605198
Ohio,45069,388689.8219070208
Ohio,45011,383741.520219301
Ohio,45014,381237.27566523314
Georgia,30721,380669.3859522569
Illinois,60101,377562.60861743044
Arizona,85043,377052.24124040507
Texas,79424,375840.5251255896
Texas,75034,375417.04446259094
Tennessee,37040,375196.30049588287
Indiana,46241,373996.44664893625
Ohio,44130,369695.12177600845
Missouri,65203,368164.2642713727
Tennessee,37075,366776.06579666457
Georgia,30024,363550.9162361371
Tennessee,37013,362531.0922871441
Ohio,43551,361386.26235687756
Ohio,45241,360034.38750539644
Texas,77041,358487.5661938833
Missouri,64804,357744.0459940187
Illinois,60440,357609.172072142
Florida,32218,356715.857109372
Missouri,63026,356107.8813699734
Missouri,63301,355934.08830791584
Indiana,46268,355831.7883008441
Maryland,21740,355500.60504495894
Indiana,47150,354724.9617134193
South Carolina,29607,352880.4861307458
Louisiana,71111,351126.6830139867
Indiana,46143,347768.28126971936
Michigan,48150,346657.1108249868
Indiana,46168,346304.13416895224
Tennessee,37167,343292.9942358864
Georgia,30906,343182.0196101997
Alabama,35758,342086.7014838177
Arkansas,72401,341423.1299020018
Georgia,30349,340620.0182212812
Texas,77449,340298.67057107727
Michigan,48180,340155.13470222946
Illinois,60188,339087.61507753184
Michigan,49423,337702.0287617066
Mississippi,39503,337177.9995417756
Missouri,65804,336572.7661837482
Florida,33166,335395.37473141483
Kentucky,42101,335131.2104215428
Tennessee,37027,335128.28149573156
Ohio,43026,332375.2210404321
Wisconsin,53051,332343.606128664
Ohio,44720,331378.2711191536
Texas,77084,331011.95661238924
Tennessee,38305,330779.1957506412
Kansas,66062,330735.66256126645
Illinois,62040,330511.2430074255
Kentucky,40299,328895.088514075
Hawaii,96819,328755.8031071367
Florida,34135,328618.07906029915
Florida,32837,328436.84396507114
Florida,32824,328220.4731768592
Delaware,19720,326466.49565728224
California,91761,324694.82713887835
Missouri,65202,323114.5401054229
North Carolina,28027,321810.73089605564
Ohio,43207,321604.03503468464
Texas,78045,321591.29840352776
Indiana,46219,321056.8094740671
Tennessee,37042,319462.9942835971
Ohio,45044,319104.73003200995
Georgia,30096,319068.8038033476
Texas,78130,319064.8583093285
Missouri,65201,316671.6275513964
Georgia,30043,315118.69744142
Texas,78660,314448.2713558181
Arizona,85255,312658.2511876773
Hawaii,96797,312091.48516708426
Arizona,85142,311962.79156778596
Texas,78501,311731.3298957767

2025-01-27 06:29:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:29:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:29:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:29:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 70
2025-01-27 06:29:14 - snowflake.connector.connection - INFO - closed
2025-01-27 06:29:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:29:14 - root - INFO - SQL:
SELECT "state_name", 
           AVG("yearly_sunlight_kwh_kw_threshold_avg") AS "avg_yearly_sunlight_kwh_per_kw"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
    GROUP BY "state_name"
    LIMIT 100;
Results:
state_name,avg_yearly_sunlight_kwh_per_kw
Pennsylvania,972.8998930357591
District of Columbia,1037.0
New York,983.1302408757779
Delaware,1023.7587055224963
Maryland,1031.4112193987417
New Jersey,998.4470678469738
Virginia,1055.9271219276773
Florida,1154.3516158508824
Illinois,980.6246990729176
Indiana,979.0946624061636
Louisiana,1086.5072128009658
Michigan,946.6092157222581
New Hampshire,973.8185105933043
Arizona,1369.2885219801447
California,1306.8583712033615
Colorado,1241.2486171321523
Georgia,1084.171898085401
Wisconsin,978.1682978421251
Alaska,730.424193548387
Kansas,1097.5856267839697
Nebraska,1068.8503623188403
West Virginia,976.6017697514732
Kentucky,1003.9061101971671
Maine,980.3380082808059
Missouri,1061.3455584291792
South Dakota,1074.0761904761905
Washington,878.0124419083396
Rhode Island,989.2265306122449
Mississippi,1089.3930488850892
Oregon,911.3853435777987
San Juan,1097.4271089987385
Oklahoma,1132.1401967337713
Carolina,1103.4159042956571
Trujillo Alto,1087.980103740599
New Mexico,1416.8774150701727
Toa Baja,1101.3748488688575
Dorado,1099.1714285714284
Loíza,1101.6
Minnesota,985.0026893841965
South Carolina,1101.8108684526924
Iowa,1011.1000955374753
Ohio,953.7296101571129
Mayagüez,1122.352082999887
North Carolina,1086.5286595569235
North Dakota,972.4784615384615
Connecticut,988.8913573653107
Massachusetts,974.8743598821558
Utah,1192.0286720269792
Idaho,1119.8419161676645
Nevada,1368.7400763358778
Wyoming,1166.2809523809524
Ponce,1032.1708420774735
Aguadilla,1159.9691547578523
Vermont,943.5
Alabama,1080.3305597569645
Bayamón,1095.190637098807
Arkansas,1069.502270638848
Canóvanas,1108.2529023144075
Cataño,1099.8999999999999
Guaynabo,1091.5916910023598
Hawaii,1269.9401574803148
Hormigueros,1106.1976932472526
Arecibo,1113.4777023971055
Hatillo,1116.475
Cabo Rojo,1127.1
Moca,996.1999999999999
Texas,1126.4488085438838
Tennessee,1036.9506576249662
Montana,1022.5666666666667
Toa Alta,1090.5598545984565

2025-01-27 06:29:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:29:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:29:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:29:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 69
2025-01-27 06:29:15 - snowflake.connector.connection - INFO - closed
2025-01-27 06:29:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:29:16 - root - INFO - SQL:
SELECT "state_name", MEDIAN("kw_median") AS "median_kw_capacity"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
    GROUP BY "state_name"
    LIMIT 100;
Results:
state_name,median_kw_capacity
Virginia,9.0
Baja California,5.75
Delaware,9.5
Hormigueros,9.75
Oregon,12.0
Pennsylvania,8.25
Arizona,14.75
Arecibo,12.0
Hawaii,16.875
Alabama,12.25
Connecticut,8.0
Colorado,9.0
Vermont,9.25
Oklahoma,12.75
Louisiana,13.5
Toa Baja,9.0
Washington,10.5
Michigan,10.0
Florida,16.0
Mayagüez,9.25
Nebraska,10.5
Moca,7.0
Maryland,8.0
Cataño,10.25
Texas,12.75
Montana,9.875
Ohio,9.75
Dorado,11.25
New Jersey,7.5
Georgia,10.5
Wyoming,9.25
Illinois,9.5
North Dakota,11.0
Carolina,11.875
Iowa,10.25
Massachusetts,7.25
Missouri,10.0
Toa Alta,10.5
Wisconsin,10.5
Idaho,11.5
North Carolina,9.5
Mississippi,13.25
San Juan,11.25
Indiana,10.75
Canóvanas,8.25
Bayamón,11.5
Minnesota,9.75
District of Columbia,7.75
Alaska,10.25
Rhode Island,7.25
Nevada,12.375
South Dakota,9.0
New Hampshire,7.5
New York,8.0
Utah,11.0
South Carolina,11.0
California,12.25
New Mexico,13.0
Trujillo Alto,10.875
Kansas,10.75
Guaynabo,11.75
Tennessee,11.75
Arkansas,12.0
Kentucky,10.5
Ponce,10.75
Maine,6.25
Aguadilla,16.0
Corozal,14.25
West Virginia,9.5

2025-01-27 06:29:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:29:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:29:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:29:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 70
2025-01-27 06:29:17 - snowflake.connector.connection - INFO - closed
2025-01-27 06:29:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:29:18 - root - INFO - SQL:
SELECT "state_name", AVG("percent_covered") AS "avg_percent_covered"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
    GROUP BY "state_name"
    ORDER BY "avg_percent_covered" DESC
    LIMIT 100;
Results:
state_name,avg_percent_covered
Trujillo Alto,2040.5624934431328
Cataño,1977.1135751398201
Toa Alta,1710.7408116079803
San Juan,361.1600438845385
Arecibo,239.5516220035041
West Virginia,134.7040655714731
Dorado,133.8421632605731
Mayagüez,129.1771202642994
New Jersey,124.22007839679854
Carolina,118.61155203088131
Alabama,118.15181543509537
Louisiana,113.44943038082381
Guaynabo,111.26805227548675
Canóvanas,111.11231184290489
North Carolina,111.00378212601817
Mississippi,110.38685412641186
Arizona,109.64577014936981
Toa Baja,108.02498418769798
Indiana,102.884568973642
Vermont,102.79805757806194
Washington,102.21900785046996
Ohio,100.1957983798897
Florida,99.63463369538297
Bayamón,98.86868696240633
Nevada,98.16257499733608
Georgia,96.55458334148544
Michigan,96.3166332425792
Tennessee,96.22961807019112
Aguadilla,95.93904539313895
South Carolina,95.47395975225123
Kentucky,94.62267354085364
Arkansas,94.08798696727425
Nebraska,93.41757348883557
California,93.2219977518554
Wisconsin,93.1936525385241
Utah,93.12673983869175
Pennsylvania,92.68306466974033
Iowa,92.50237522834108
Hawaii,92.40890122239371
Oregon,92.07550262671663
Rhode Island,91.74013630607047
Illinois,91.65385121185507
Ponce,91.56236721318227
Virginia,90.98671520397548
Colorado,90.80594676965518
Oklahoma,90.58936275851072
Minnesota,90.42832750511015
New Mexico,90.19310294856498
Kansas,89.95113875826729
Texas,89.86343251034103
Missouri,89.17689216788044
North Dakota,88.55661024596189
Connecticut,87.30600764926567
Massachusetts,87.21982464135493
New York,87.01654666423346
Loíza,85.48387096774194
District of Columbia,85.3173154619042
Delaware,85.27792503329306
Maine,85.24301426648185
Idaho,84.46661050804317
Alaska,83.1343291892894
South Dakota,82.78193284825554
New Hampshire,82.68678043934634
Montana,80.417314727058
Maryland,80.0363051672659
Wyoming,75.8881197240555
Hormigueros,72.03823210284625
Hatillo,38.851761427901465
Cabo Rojo,5.0
Moca,0.8264462809917356

2025-01-27 06:29:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:29:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:29:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:29:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-27 06:29:19 - snowflake.connector.connection - INFO - closed
2025-01-27 06:29:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:29:19 - root - INFO - SQL:
SELECT "state_name", "region_name", "percent_qualified"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
    ORDER BY "percent_qualified" ASC
    LIMIT 100;
Results:
state_name,region_name,percent_qualified
Illinois,60950,0.0
New York,10045,0.0
Michigan,49234,0.0
Maryland,21532,0.0
Virginia,24069,0.0
Colorado,80290,0.0
West Virginia,24724,0.0
South Carolina,29058,0.0
Colorado,80299,0.0
California,92305,0.0
Utah,84310,0.0
Florida,33849,0.0
Michigan,48674,0.0
Ohio,43002,0.0
New Jersey,07456,0.0
North Carolina,28357,0.0
South Dakota,57032,0.0
Tennessee,37015,0.0
District of Columbia,20303,0.0
California,95007,2.7777777777777777
Colorado,81415,11.11111111111111
New York,10173,12.5
California,92391,12.987012987012987
California,92386,13.97238017871649
Missouri,64060,14.285714285714286
New York,10123,17.24137931034483
California,92325,17.906865098415746
Arizona,86005,18.272425249169434
Pennsylvania,15545,20.0
Baja California,22400,20.0
Louisiana,70764,20.0
New York,10105,20.0
Indiana,46965,20.0
California,92321,22.15435868961688
California,95389,22.519083969465647
California,92378,23.568281938325992
New Jersey,07878,24.216524216524217
New York,10176,25.0
Iowa,50648,25.0
Georgia,30072,25.0
Massachusetts,02672,25.0
Montana,59411,25.510204081632654
Minnesota,55090,25.700934579439252
California,92352,26.010973379394432
Maryland,20880,26.424870466321245
California,95959,27.04703832752613
Illinois,62716,27.272727272727273
Pennsylvania,19149,27.44349692885682
New York,10155,27.77777777777778
California,95006,27.88586251621271
Connecticut,06927,28.0
Maine,04351,28.571428571428573
New York,10174,28.571428571428573
Pennsylvania,19142,29.15272531030761
Colorado,80025,30.0
Utah,84773,30.0
Indiana,46124,30.357142857142858
New York,10120,30.434782608695652
Maryland,21032,30.778663396689147
Pennsylvania,19120,31.392170010832
North Carolina,27599,31.764705882352942
California,92315,31.798715203426124
New York,12498,32.18390804597701
California,92333,33.2511100148002
Connecticut,06338,33.333333333333336
Pennsylvania,18660,33.333333333333336
Wisconsin,53167,33.333333333333336
Missouri,65738,33.333333333333336
Colorado,81334,33.333333333333336
Indiana,46937,33.333333333333336
South Carolina,29697,33.333333333333336
Florida,32706,33.333333333333336
Pennsylvania,19110,33.333333333333336
Maryland,20777,33.333333333333336
Pennsylvania,19132,33.55019191984907
Pennsylvania,19143,33.79228203906622
Kansas,66205,33.839300445471046
Pennsylvania,19151,34.46654256882532
Maryland,20896,34.962406015037594
Pennsylvania,19139,35.15326361341507
Pennsylvania,19134,35.15690473973368
Kansas,66208,35.473707083876576
California,92314,35.84478222741888
Pennsylvania,18353,36.36363636363637
North Dakota,58505,36.36363636363637
New York,10017,36.458333333333336
New York,12572,36.69724770642202
California,95018,36.88656476267096
Pennsylvania,19138,37.186544342507645
New Hampshire,03224,37.5
Utah,84763,37.5
Pennsylvania,19131,38.040775733465935
Montana,59937,38.101788170563964
South Dakota,57751,38.20459290187891
Minnesota,56465,38.28125
Pennsylvania,19124,38.31012721626765
Pennsylvania,19145,38.368391486174396
Virginia,23235,38.400812881037986
Pennsylvania,19140,38.402638050525375
New Jersey,07046,38.43821076573162

2025-01-27 06:29:19 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:29:19 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:29:19 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:29:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 70
2025-01-27 06:29:20 - snowflake.connector.connection - INFO - closed
2025-01-27 06:29:21 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:29:21 - root - INFO - SQL:
SELECT "state_name", SUM("carbon_offset_metric_tons") AS "total_carbon_offset"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
    GROUP BY "state_name"
    LIMIT 100;
Results:
state_name,total_carbon_offset
Pennsylvania,25679219.804377407
District of Columbia,768728.0745405239
New York,21932730.052032903
Delaware,2047732.7107329231
Maryland,9341908.182602106
New Jersey,21441825.25895091
Virginia,14570516.612738723
Florida,84762071.96637787
Illinois,39019478.60061418
Indiana,22286009.07525565
Louisiana,16119065.632724501
Michigan,32170938.26439564
Minnesota,9461269.60415691
New Hampshire,1106392.337547703
Texas,80026572.09620419
Arizona,25393752.120932452
California,67060256.559903376
Colorado,15019343.801609265
Mayagüez,136317.66351863468
Georgia,26767856.473523576
South Carolina,15082325.953191794
Iowa,4480709.137428612
Tennessee,23662867.396383427
Wisconsin,18538719.211838692
Alaska,449958.7974072519
Kansas,8248164.19414453
Nebraska,3407555.482436877
West Virginia,2708875.483437571
Kentucky,10893849.027434926
Connecticut,5385610.014692117
Idaho,2001480.6360385297
Nevada,6552267.614581583
Wyoming,399567.8100756294
Oregon,4391352.901025
Mississippi,6675246.399348796
Aguadilla,107733.02459435827
Vermont,238985.90700712064
Carolina,372344.8403529482
Alabama,15792877.15528395
Bayamón,505479.538757477
Arkansas,7162306.228122597
Canóvanas,33633.89653257158
Cataño,40096.302153202625
Guaynabo,230168.9556225237
New Mexico,5193766.818696551
Arecibo,74104.26841802277
Cabo Rojo,159.01583819991797
Ohio,39985118.69480568
North Carolina,23363984.23961253
Maine,951467.7454093618
Missouri,20988770.94279073
Massachusetts,8448829.99986072
North Dakota,1164890.4157271704
South Dakota,1047973.7956763804
Utah,4055086.38298331
Rhode Island,1613670.238764769
Ponce,259596.63619231156
San Juan,792573.4658976337
Oklahoma,13676736.482410647
Toa Baja,86581.46720940567
Hormigueros,14312.409783773295
Dorado,47475.16902867142
Hatillo,6102.208001967081
Loíza,400.46323702419204
Moca,5.774905113871622
Montana,721128.5004524508
Washington,7305348.121577986
Toa Alta,17313.180368415116
Trujillo Alto,46442.93098691624
Hawaii,4666457.0008377

2025-01-27 06:29:21 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:29:21 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:29:21 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:29:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 69
2025-01-27 06:29:22 - snowflake.connector.connection - INFO - closed
2025-01-27 06:29:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:29:23 - root - INFO - SQL:
SELECT "state_name", MEDIAN("number_of_panels_median") AS "median_panels_per_installation"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
    GROUP BY "state_name"
    ORDER BY "median_panels_per_installation" DESC
    LIMIT 100;
Results:
state_name,median_panels_per_installation
Hawaii,67.500
Aguadilla,64.000
Florida,64.000
Arizona,59.000
Corozal,57.000
Louisiana,54.000
Mississippi,53.000
New Mexico,52.000
Texas,51.000
Oklahoma,51.000
Nevada,49.500
Alabama,49.000
California,49.000
Arecibo,48.000
Arkansas,48.000
Oregon,48.000
Carolina,47.500
Tennessee,47.000
Guaynabo,47.000
Idaho,46.000
Bayamón,46.000
Dorado,45.000
San Juan,45.000
Utah,44.000
South Carolina,44.000
North Dakota,44.000
Trujillo Alto,43.500
Ponce,43.000
Kansas,43.000
Indiana,43.000
Georgia,42.000
Washington,42.000
Toa Alta,42.000
Nebraska,42.000
Kentucky,42.000
Wisconsin,42.000
Cataño,41.000
Iowa,41.000
Alaska,41.000
Missouri,40.000
Michigan,40.000
Montana,39.500
Minnesota,39.000
Hormigueros,39.000
Ohio,39.000
Illinois,38.000
Delaware,38.000
North Carolina,38.000
West Virginia,38.000
Mayagüez,37.000
Vermont,37.000
Wyoming,37.000
Colorado,36.000
South Dakota,36.000
Toa Baja,36.000
Virginia,36.000
Pennsylvania,33.000
Canóvanas,33.000
Connecticut,32.000
New York,32.000
Maryland,32.000
District of Columbia,31.000
New Hampshire,30.000
New Jersey,30.000
Rhode Island,29.000
Massachusetts,29.000
Moca,28.000
Maine,25.000
Baja California,23.000

2025-01-27 06:29:23 - root - INFO - itercount: 0
2025-01-27 06:29:23 - root - INFO - Database Name: SUNROOF_SOLAR
Schema Name: SUNROOF_SOLAR
DDL describes table information.
,0
table_name,SOLAR_POTENTIAL_BY_POSTAL_CODE
description,
DDL,"create or replace TABLE SOLAR_POTENTIAL_BY_POSTAL_CODE (
	""region_name"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""lat_max"" FLOAT,
	""lat_min"" FLOAT,
	""lng_max"" FLOAT,
	""lng_min"" FLOAT,
	""lat_avg"" FLOAT,
	""lng_avg"" FLOAT,
	""yearly_sunlight_kwh_kw_threshold_avg"" FLOAT,
	""count_qualified"" NUMBER(38,0),
	""percent_covered"" FLOAT,
	""percent_qualified"" FLOAT,
	""number_of_panels_n"" NUMBER(38,0),
	""number_of_panels_s"" NUMBER(38,0),
	""number_of_panels_e"" NUMBER(38,0),
	""number_of_panels_w"" NUMBER(38,0),
	""number_of_panels_f"" NUMBER(38,0),
	""number_of_panels_median"" NUMBER(38,0),
	""number_of_panels_total"" NUMBER(38,0),
	""kw_median"" FLOAT,
	""kw_total"" FLOAT,
	""yearly_sunlight_kwh_n"" FLOAT,
	""yearly_sunlight_kwh_s"" FLOAT,
	""yearly_sunlight_kwh_e"" FLOAT,
	""yearly_sunlight_kwh_w"" FLOAT,
	""yearly_sunlight_kwh_f"" FLOAT,
	""yearly_sunlight_kwh_median"" FLOAT,
	""yearly_sunlight_kwh_total"" FLOAT,
	""install_size_kw_buckets"" VARCHAR(16777216),
	""carbon_offset_metric_tons"" FLOAT,
	""existing_installs_count"" NUMBER(38,0),
	""center_point"" BINARY(8388608)
);"

,1
table_name,SOLAR_POTENTIAL_BY_CENSUSTRACT
description,
DDL,"create or replace TABLE SOLAR_POTENTIAL_BY_CENSUSTRACT (
	""region_name"" VARCHAR(16777216),
	""state_name"" VARCHAR(16777216),
	""lat_max"" FLOAT,
	""lat_min"" FLOAT,
	""lng_max"" FLOAT,
	""lng_min"" FLOAT,
	""lat_avg"" FLOAT,
	""lng_avg"" FLOAT,
	""yearly_sunlight_kwh_kw_threshold_avg"" FLOAT,
	""count_qualified"" NUMBER(38,0),
	""percent_covered"" FLOAT,
	""percent_qualified"" FLOAT,
	""number_of_panels_n"" NUMBER(38,0),
	""number_of_panels_s"" NUMBER(38,0),
	""number_of_panels_e"" NUMBER(38,0),
	""number_of_panels_w"" NUMBER(38,0),
	""number_of_panels_f"" NUMBER(38,0),
	""number_of_panels_median"" NUMBER(38,0),
	""number_of_panels_total"" NUMBER(38,0),
	""kw_median"" FLOAT,
	""kw_total"" FLOAT,
	""yearly_sunlight_kwh_n"" FLOAT,
	""yearly_sunlight_kwh_s"" FLOAT,
	""yearly_sunlight_kwh_e"" FLOAT,
	""yearly_sunlight_kwh_w"" FLOAT,
	""yearly_sunlight_kwh_f"" FLOAT,
	""yearly_sunlight_kwh_median"" FLOAT,
	""yearly_sunlight_kwh_total"" FLOAT,
	""install_size_kw_buckets"" VARCHAR(16777216),
	""carbon_offset_metric_tons"" FLOAT,
	""existing_installs_count"" NUMBER(38,0),
	""center_point"" BINARY(8388608)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'SUNROOF_SOLAR': {'SUNROOF_SOLAR': ['SOLAR_POTENTIAL_BY_CENSUSTRACT', 'SOLAR_POTENTIAL_BY_POSTAL_CODE']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Tables:**
  - `SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE`: Contains solar potential data aggregated at the postal code level.
  - `SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT`: Contains solar potential data aggregated at the census tract level.

- **Columns and Their Potential Usage:**
  - `"state_name"`: Used to group data by state.
  - `"region_name"`: Identifies the postal code or census tract; helps distinguish between postal code and census tract levels.
  - `"count_qualified"`: Number of buildings available for solar installations.
  - `"percent_covered"`: Percentage covered by Project Sunroof.
  - `"percent_qualified"`: Percentage of buildings suitable for solar.
  - `"number_of_panels_total"`: Total potential panel count.
  - `"kw_total"`: Total kilowatt capacity.
  - `"yearly_sunlight_kwh_total"`: Energy generation potential.
  - `"carbon_offset_metric_tons"`: Carbon dioxide offset.
  - `"existing_installs_count"`: Number of existing installations.
  - **Gap in potential installations**: Calculated as `"count_qualified" - "existing_installs_count"`; represents the difference between available buildings and existing installations.

**Conditions That May Be Used:**

- Grouping data by `"state_name"` to compare states.
- Distinguishing between postal code and census tract levels using different tables.
- Calculating metrics using aggregate functions like `SUM`, `AVG`, etc.
- Limiting results with `LIMIT 100`.
- Ordering results with `ORDER BY`.

**SQL Queries:**

1. **List the number of qualified buildings for solar installations by postal code:**

   ```sql
   SELECT "state_name", "region_name", "count_qualified"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   LIMIT 100;
   ```

2. **Retrieve distinct state names from the census tract data:**

   ```sql
   SELECT DISTINCT "state_name"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
   LIMIT 100;
   ```

3. **Calculate total buildings available for solar installations per state (postal code level):**

   ```sql
   SELECT "state_name", SUM("count_qualified") AS "total_buildings"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   GROUP BY "state_name"
   ORDER BY "total_buildings" DESC
   LIMIT 100;
   ```

4. **Find average percentage of buildings suitable for solar per state (census tract level):**

   ```sql
   SELECT "state_name", AVG("percent_qualified") AS "avg_percent_qualified"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
   GROUP BY "state_name"
   LIMIT 100;
   ```

5. **List regions where Project Sunroof's coverage is less than 100% (postal code level):**

   ```sql
   SELECT "state_name", "region_name", "percent_covered"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   WHERE "percent_covered" < 100
   ORDER BY "percent_covered" ASC
   LIMIT 100;
   ```

6. **Calculate total potential panel count per state (census tract level):**

   ```sql
   SELECT "state_name", SUM("number_of_panels_total") AS "total_panels"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
   GROUP BY "state_name"
   ORDER BY "total_panels" DESC
   LIMIT 100;
   ```

7. **Retrieve total kilowatt capacity and energy generation potential per state (postal code level):**

   ```sql
   SELECT "state_name", 
          SUM("kw_total") AS "total_kw_capacity", 
          SUM("yearly_sunlight_kwh_total") AS "total_energy_potential"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   GROUP BY "state_name"
   LIMIT 100;
   ```

8. **Compute the gap in potential installations per state (census tract level):**

   ```sql
   SELECT "state_name", 
          SUM("count_qualified") AS "total_qualified_buildings", 
          SUM("existing_installs_count") AS "total_existing_installs", 
          (SUM("count_qualified") - SUM("existing_installs_count")) AS "gap_in_potential_installations"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
   GROUP BY "state_name"
   LIMIT 100;
   ```

9. **List regions with the highest carbon dioxide offset potential (postal code level):**

   ```sql
   SELECT "state_name", "region_name", "carbon_offset_metric_tons"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   ORDER BY "carbon_offset_metric_tons" DESC
   LIMIT 100;
   ```

10. **Calculate average yearly sunlight per kilowatt threshold per state (census tract level):**

    ```sql
    SELECT "state_name", 
           AVG("yearly_sunlight_kwh_kw_threshold_avg") AS "avg_yearly_sunlight_kwh_per_kw"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
    GROUP BY "state_name"
    LIMIT 100;
    ```

11. **Find the median kilowatt capacity per state (postal code level):**

    ```sql
    SELECT "state_name", MEDIAN("kw_median") AS "median_kw_capacity"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
    GROUP BY "state_name"
    LIMIT 100;
    ```

12. **List states with their average percentage coverage by Project Sunroof (census tract level):**

    ```sql
    SELECT "state_name", AVG("percent_covered") AS "avg_percent_covered"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
    GROUP BY "state_name"
    ORDER BY "avg_percent_covered" DESC
    LIMIT 100;
    ```

13. **Identify regions with the lowest percentage of buildings suitable for solar (postal code level):**

    ```sql
    SELECT "state_name", "region_name", "percent_qualified"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
    ORDER BY "percent_qualified" ASC
    LIMIT 100;
    ```

14. **Calculate total carbon dioxide offset per state (census tract level):**

    ```sql
    SELECT "state_name", SUM("carbon_offset_metric_tons") AS "total_carbon_offset"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
    GROUP BY "state_name"
    LIMIT 100;
    ```

15. **Retrieve states with the highest median number of panels per installation (postal code level):**

    ```sql
    SELECT "state_name", MEDIAN("number_of_panels_median") AS "median_panels_per_installation"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
    GROUP BY "state_name"
    ORDER BY "median_panels_per_installation" DESC
    LIMIT 100;
    ```

These queries provide insights into the solar potential across different states, distinguishing between postal code and census tract levels. By executing these queries, you can gather the necessary data to perform a detailed comparison as requested.Query:
SELECT "state_name", "region_name", "count_qualified"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   LIMIT 100;
Answer:
state_name,region_name,count_qualified
Pennsylvania,19149,4602
Pennsylvania,19120,6086
Pennsylvania,19132,5157
Pennsylvania,19134,7551
Pennsylvania,19138,4256
Pennsylvania,19143,7093
Pennsylvania,19148,7885
Pennsylvania,19131,4590
Pennsylvania,19133,3545
Pennsylvania,19139,4874
Pennsylvania,19140,6871
Pennsylvania,19141,3528
Pennsylvania,19142,2701
Pennsylvania,19145,6147
Pennsylvania,19146,6749
Pennsylvania,19150,3872
Pennsylvania,19151,3518
Pennsylvania,19125,4917
Pennsylvania,19135,4824
Pennsylvania,19147,6785
District of Columbia,20002,6154
District of Columbia,20003,1946
Indiana,46704,23
Texas,75371,20
California,92386,172
Pennsylvania,15629,141
Pennsylvania,19023,3413
Pennsylvania,19121,5961
Pennsylvania,19124,7649
Pennsylvania,19126,2172
Pennsylvania,19144,6860
District of Columbia,20001,3636
South Carolina,29920,15
New Jersey,08104,3698
New York,12512,16
Pennsylvania,19082,5331
Pennsylvania,19119,4821
Pennsylvania,19127,1830
Pennsylvania,19130,3810
Pennsylvania,19604,4723
District of Columbia,20010,3021
District of Columbia,20011,10516
Indiana,46393,22
Minnesota,55417,4881
New Jersey,08102,1005
New Jersey,08103,2518
New Jersey,08611,4735
New York,11215,5972
New York,11233,5046
New York,11379,6142
New York,11419,5702
New York,11428,3702
New York,11451,12
Pennsylvania,15224,2804
Pennsylvania,17019,15
Pennsylvania,19122,2899
Pennsylvania,19129,1621
Pennsylvania,19602,2941
District of Columbia,20009,3251
Maryland,21239,6831
Minnesota,55412,4693
Minnesota,55805,2272
Minnesota,55807,3931
New Jersey,07756,1150
New York,11105,3809
New York,11216,4016
New York,11217,2862
New York,11370,2925
New York,11412,6617
New York,11417,4160
New York,11421,4388
New York,11436,2971
New York,11802,13
New York,14619,3363
Pennsylvania,15110,2079
Pennsylvania,15203,3075
Pennsylvania,15208,2766
Pennsylvania,15210,7989
Pennsylvania,18102,8980
Pennsylvania,19079,1944
Pennsylvania,19104,4612
Pennsylvania,19601,6056
District of Columbia,20007,4317
District of Columbia,20017,3848
Maryland,20782,351
Maryland,21229,12459
Maryland,21230,11451
Alabama,35043,8
Ohio,43608,5648
Ohio,43610,1479
Ohio,44123,4808
Ohio,45147,9
Michigan,48146,13114
Michigan,48223,5378
Michigan,48224,12218
Michigan,48227,12513
Michigan,48915,2654
Michigan,49507,7778
Minnesota,55104,6959
Minnesota,55406,6992
Query:
SELECT DISTINCT "state_name"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
   LIMIT 100;
Answer:
state_name
Pennsylvania
District of Columbia
New York
Delaware
Maryland
New Jersey
Virginia
Florida
Illinois
Indiana
Louisiana
Michigan
Minnesota
New Hampshire
Texas
Arizona
California
Colorado
Mayagüez
Georgia
South Carolina
Iowa
Tennessee
Wisconsin
Alaska
Kansas
Nebraska
West Virginia
Kentucky
Connecticut
Idaho
Nevada
Wyoming
Oregon
Mississippi
Aguadilla
Vermont
Carolina
Alabama
Bayamón
Arkansas
Canóvanas
Cataño
Guaynabo
New Mexico
Arecibo
Cabo Rojo
Ohio
North Carolina
Maine
Missouri
Massachusetts
North Dakota
South Dakota
Utah
Rhode Island
Ponce
San Juan
Oklahoma
Toa Baja
Hormigueros
Dorado
Hatillo
Loíza
Moca
Montana
Washington
Toa Alta
Trujillo Alto
Hawaii
Query:
SELECT "state_name", SUM("count_qualified") AS "total_buildings"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   GROUP BY "state_name"
   ORDER BY "total_buildings" DESC
   LIMIT 100;
Answer:
state_name,total_buildings
California,8607224
Texas,5476777
Florida,4814177
New York,2502541
Ohio,2192109
Illinois,2052522
Pennsylvania,1954585
Michigan,1846232
Arizona,1753531
New Jersey,1629714
Washington,1510869
Georgia,1502091
North Carolina,1416043
Indiana,1116413
Tennessee,1102947
Colorado,1031389
Missouri,1031097
Massachusetts,1000732
Virginia,963270
South Carolina,907878
Wisconsin,900028
Louisiana,864431
Alabama,813312
Oregon,772441
Minnesota,769481
Maryland,705396
Oklahoma,700888
Connecticut,607976
Kentucky,577255
Utah,572530
Nevada,569104
Kansas,417118
Arkansas,369725
New Mexico,365713
Iowa,350073
Mississippi,324867
Idaho,311671
Nebraska,283330
Hawaii,204227
Rhode Island,202865
West Virginia,154869
Delaware,147431
Montana,118654
New Hampshire,107012
Maine,99960
North Dakota,77117
District of Columbia,76385
South Dakota,72847
Alaska,57138
Wyoming,53068
San Juan,44665
Bayamón,33260
Vermont,19504
Carolina,19237
Ponce,18706
Guaynabo,12113
Mayagüez,7348
Toa Baja,6976
Aguadilla,5844
Arecibo,4433
Dorado,3064
Cataño,2860
Trujillo Alto,2854
Canóvanas,2182
Hormigueros,1194
Toa Alta,1123
Corozal,15
Baja California,1
Moca,1
Query:
SELECT "state_name", AVG("percent_qualified") AS "avg_percent_qualified"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
   GROUP BY "state_name"
   LIMIT 100;
Answer:
state_name,avg_percent_qualified
Pennsylvania,68.85707992410286
District of Columbia,63.397058540850374
New York,70.3824007333638
Delaware,71.13500821025055
Maryland,69.81305560602681
New Jersey,72.49284036555349
Virginia,70.29803660202286
Florida,83.27936582037172
Illinois,75.0703988032207
Indiana,74.4162992494216
Louisiana,82.17435382731469
Michigan,72.87447311567932
New Hampshire,67.9415712418198
Arizona,90.40516782276116
California,84.42610938177201
Colorado,80.52159958927903
Georgia,68.60191456870614
Wisconsin,74.55363214741563
Alaska,67.3891486348244
Kansas,74.45838191092518
Nebraska,80.62010526352871
West Virginia,71.8114182883734
Kentucky,80.79952498243404
Maine,65.17547802899195
Missouri,76.3366899845083
South Dakota,73.1301178566635
Washington,74.3926663890639
Rhode Island,75.69773905575148
Mississippi,70.47452389375442
Oregon,79.62664401997048
San Juan,90.2046719638303
Oklahoma,87.74299094697147
Carolina,91.95012311270571
Trujillo Alto,86.22386755943712
New Mexico,87.26558195086373
Toa Baja,90.59109586594275
Dorado,94.55205024605395
Loíza,75.47169811320755
Minnesota,64.55495274901153
South Carolina,73.39684628969717
Iowa,67.55135102465916
Ohio,76.22748275975313
Mayagüez,88.31524322675783
North Carolina,68.18277115519244
North Dakota,75.3665552162828
Connecticut,65.75337434981022
Massachusetts,72.28938390680628
Utah,84.22705043917742
Idaho,75.91076792895495
Nevada,90.79523059001976
Wyoming,78.68145154613299
Ponce,89.9396040617879
Aguadilla,89.84303986917156
Vermont,68.89857488088953
Alabama,75.7064689620111
Bayamón,90.54093297303565
Arkansas,73.5760827694726
Canóvanas,82.97908947936548
Cataño,86.57358974659549
Guaynabo,89.7713593686313
Hawaii,90.28828623458989
Hormigueros,91.17801424826256
Arecibo,94.1909789661489
Hatillo,91.4722740602506
Cabo Rojo,100.0
Moca,100.0
Texas,83.60340471279187
Tennessee,76.27267213792194
Montana,72.27714051202193
Toa Alta,87.95785274938673
Query:
SELECT "state_name", "region_name", "percent_covered"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   WHERE "percent_covered" < 100
   ORDER BY "percent_covered" ASC
   LIMIT 100;
Answer:
state_name,region_name,percent_covered
Virginia,22630,0.0076120879957372305
Tennessee,37821,0.008841732979664015
South Carolina,29909,0.01056859015007398
Louisiana,70578,0.01088850174216028
California,92231,0.011906179307060364
Florida,34142,0.014690759512266784
Utah,84045,0.014961101137043686
North Carolina,28460,0.015715857300015717
Georgia,30680,0.01625223468226881
Pennsylvania,15044,0.017467248908296942
Arkansas,72753,0.01805706031058144
Georgia,30014,0.018409425625920472
Utah,84720,0.018889308651303362
Illinois,60950,0.019692792437967704
Kentucky,42420,0.020405387022173854
Maryland,21532,0.02081165452653486
Nevada,89044,0.02081165452653486
New Jersey,07456,0.021953896816684963
Kansas,67110,0.022634676324128564
Oregon,97457,0.0230361667818475
Louisiana,70584,0.023218017181332713
California,92231,0.02381235861412073
New York,13827,0.02462447672986949
South Carolina,29927,0.025913449080072558
North Carolina,28326,0.027658691743880515
South Dakota,57032,0.028760425654299683
Alabama,36312,0.029559562518474726
Alabama,35051,0.032175032175032175
Utah,84310,0.03324468085106383
Missouri,65738,0.033776176536816034
Pennsylvania,19565,0.034482758620689655
California,93646,0.035984166966534725
South Carolina,29440,0.03610629693818602
Washington,98629,0.03718854592785422
Michigan,48049,0.03979307600477517
Indiana,46001,0.04231908590774439
Delaware,19933,0.042863266180882986
Florida,32640,0.043010752688172046
South Carolina,29697,0.043202764976958526
Michigan,49331,0.043725404459991256
Oregon,97019,0.04679457182966776
Florida,33545,0.0474158368895211
Washington,98922,0.04795013186286262
Arkansas,72774,0.0488162069807176
Texas,78264,0.049172266841501396
Virginia,24149,0.0514668039114771
Pennsylvania,15644,0.05171165580721895
New York,13073,0.05305039787798409
Ohio,45895,0.054097917230186636
Florida,33523,0.05497526113249038
Louisiana,70764,0.05578489345085351
Ohio,43015,0.05705048968336978
Massachusetts,01007,0.057383320581484314
Texas,78596,0.05748928608759277
Maryland,20781,0.05856515373352855
Alabama,35044,0.05868544600938967
Massachusetts,01833,0.06016847172081829
Georgia,30180,0.06353240152477764
Florida,33321,0.06626277925028398
Baja California,22400,0.06743088334457181
Georgia,30738,0.06961364427427776
Colorado,80951,0.07012622720897616
Iowa,52333,0.07120816520294328
Pennsylvania,18436,0.07125552230297848
Kansas,66086,0.0721110510185686
Pennsylvania,17360,0.07256894049346879
Florida,32732,0.07342143906020558
Connecticut,06441,0.07479431563201197
New Jersey,08731,0.07526881720430108
Minnesota,56320,0.07651109410864575
Washington,99036,0.07680491551459294
Alabama,36376,0.07757951900698215
Missouri,64079,0.0782472613458529
Virginia,23314,0.08045052292839903
South Carolina,29691,0.08200754469411185
New Jersey,08533,0.08527572484366117
Florida,33935,0.08585796639273886
Florida,33469,0.08595495960116899
North Carolina,28357,0.08613264427217916
California,95045,0.08779631255487269
Florida,33033,0.08887673480549668
New York,14004,0.08986744551786116
Virginia,24069,0.09025270758122744
Texas,75755,0.09082652134423251
Texas,76574,0.09338036937123885
Louisiana,71006,0.0936768149882904
Tennessee,37861,0.09881422924901186
Indiana,46914,0.09910802775024777
South Dakota,57005,0.1003814495081309
Tennessee,37015,0.10109179134654266
Louisiana,70668,0.10131712259371833
Missouri,64060,0.10190711894016596
Michigan,49277,0.10319917440660474
Ohio,44904,0.10337698139214335
North Carolina,28168,0.10393466963622866
Alabama,36250,0.10604453870625663
North Carolina,28555,0.10643959552953698
Florida,32667,0.10649627263045794
New Hampshire,03867,0.10872941907424666
Texas,76008,0.1109193985703722
Query:
SELECT "state_name", SUM("number_of_panels_total") AS "total_panels"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
   GROUP BY "state_name"
   ORDER BY "total_panels" DESC
   LIMIT 100;
Answer:
state_name,total_panels
California,654784266
Texas,481747719
Florida,463123814
Ohio,171901350
Illinois,164256874
New York,158794563
Michigan,147876313
Arizona,147450436
Georgia,140138439
Pennsylvania,133691622
North Carolina,124233257
New Jersey,117024321
Washington,107938035
Tennessee,101762224
Indiana,93311273
Missouri,84085928
Wisconsin,82459475
Louisiana,80308875
South Carolina,79312131
Alabama,77644088
Virginia,74914378
Colorado,69425443
Massachusetts,69012277
Minnesota,65662303
Oregon,61617355
Oklahoma,60560124
Maryland,47690643
Kentucky,47393349
Utah,44105531
Nevada,43616656
Connecticut,43575214
Kansas,36827430
Arkansas,36012747
Mississippi,32218920
Iowa,29953011
New Mexico,29605361
Idaho,23093899
Nebraska,21582607
Hawaii,19873246
Rhode Island,13001474
West Virginia,11387665
Delaware,10771425
Montana,9189162
New Hampshire,9054358
North Dakota,8138951
Maine,7720530
South Dakota,6377373
Alaska,5462549
District of Columbia,3983844
Wyoming,3848056
San Juan,3375014
Bayamón,2134598
Vermont,2012472
Carolina,1554053
Ponce,1165041
Guaynabo,984133
Mayagüez,567212
Aguadilla,432711
Toa Baja,362967
Arecibo,306604
Dorado,199501
Trujillo Alto,197851
Cataño,168020
Canóvanas,139475
Toa Alta,73394
Hormigueros,59807
Hatillo,25246
Loíza,1693
Cabo Rojo,668
Moca,28
Query:
SELECT "state_name", 
          SUM("kw_total") AS "total_kw_capacity", 
          SUM("yearly_sunlight_kwh_total") AS "total_energy_potential"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   GROUP BY "state_name"
   LIMIT 100;
Answer:
state_name,total_kw_capacity,total_energy_potential
Pennsylvania,33251159.25,38013732231.37531
District of Columbia,984405.75,1195714591.0355346
Indiana,23262116.25,26851041383.54419
Texas,120126382.5,160039623751.7003
California,163245792.0,242638396940.61917
South Carolina,19795985.0,25650182524.80312
New Jersey,29062474.25,33904852397.547024
New York,39464453.0,44831446454.66716
Minnesota,16366038.5,18617438249.156933
Ohio,42755588.25,48048536615.677925
Michigan,36847956.75,40840033399.2527
Colorado,17287707.0,24570049923.14742
Connecticut,10817473.0,12350145123.452475
Virginia,18683826.25,23113080773.399204
Wisconsin,20565986.75,23486482672.1245
Missouri,20954082.0,26038971734.14675
Nebraska,5373970.5,6698087315.291831
New Hampshire,2259352.25,2550456273.8240113
Maryland,11890221.5,14360334548.562885
Arizona,36809602.0,59043009935.297775
West Virginia,2834139.75,3257389195.7982965
Alabama,19324636.5,24646969095.845936
Illinois,40809249.25,47047851222.022064
Maine,1922317.75,2189004685.142859
Kentucky,11892554.0,14104070608.580994
Iowa,7477739.5,8830596479.387411
Wyoming,960816.75,1300665963.824701
North Carolina,30990744.25,39519833527.20979
Florida,115526433.0,157617914915.22406
Oregon,15377712.0,16486992928.991991
Alaska,1361806.25,1089086633.2073152
Tennessee,25277072.25,30966907026.81165
Ponce,290701.5,384801553.74663687
Louisiana,20033662.5,25827876726.134464
Vermont,497191.0,545353715.0415834
Arkansas,8983466.75,11336956069.406748
Guaynabo,246735.75,342637380.9947451
San Juan,855785.75,1195075494.090149
Cataño,46577.75,65981195.478601106
New Mexico,7388077.0,12187002098.50356
Mississippi,8031754.25,10378294594.571173
Bayamón,524720.0,738592635.6176331
Carolina,370356.75,527251268.02654415
Aguadilla,108012.25,159844295.74992672
Arecibo,86303.5,123956987.1142212
Canóvanas,40117.75,57543460.70198363
Baja California,5.75,8322.02979736328
Massachusetts,17152331.0,19399236401.382404
Delaware,2685709.75,3213827406.3591805
Washington,26939156.25,27430232929.40039
Rhode Island,3228525.0,3701710212.139731
Georgia,34913435.25,44581060812.036766
Oklahoma,15113975.5,20183717271.261906
Utah,10997189.0,15209638303.221928
South Dakota,1593092.75,1964549826.5415552
Idaho,5756500.25,7504231760.321072
Nevada,10885004.0,17206349924.622555
Toa Baja,92763.0,131548735.53740233
Toa Alta,22168.75,31279276.972485356
Mayagüez,142803.0,203989405.60508427
Hormigueros,13652.0,19401835.649896257
Dorado,49813.5,70454673.23659058
Corozal,416.75,587979.9845764162
Moca,7.0,8580.857080078125
Montana,2295402.5,2709785572.9772882
North Dakota,2032056.5,2295970930.981845
Trujillo Alto,49031.5,68412270.15056156
Hawaii,4958941.25,7400954705.809179
Kansas,9180990.0,11849160234.790615
Query:
SELECT "state_name", 
          SUM("count_qualified") AS "total_qualified_buildings", 
          SUM("existing_installs_count") AS "total_existing_installs", 
          (SUM("count_qualified") - SUM("existing_installs_count")) AS "gap_in_potential_installations"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
   GROUP BY "state_name"
   LIMIT 100;
Answer:
state_name,total_qualified_buildings,total_existing_installs,gap_in_potential_installations
Pennsylvania,1956097,4408,1951689
District of Columbia,76464,442,76022
New York,2506035,18795,2487240
Delaware,147535,88,147447
Maryland,705813,6071,699742
New Jersey,1632773,12655,1620118
Virginia,963792,2409,961383
Florida,4817871,105364,4712507
Illinois,2055456,2453,2053003
Indiana,1117000,988,1116012
Louisiana,865003,8223,856780
Michigan,1847255,1720,1845535
New Hampshire,107103,262,106841
Arizona,1754534,39726,1714808
California,8617901,331818,8286083
Colorado,1032067,24362,1007705
Georgia,1503687,1907,1501780
Wisconsin,900707,1914,898793
Alaska,57169,83,57086
Kansas,417333,738,416595
Nebraska,283467,210,283257
West Virginia,155047,80,154967
Kentucky,575985,723,575262
Maine,100065,360,99705
Missouri,1032104,2864,1029240
South Dakota,72867,21,72846
Washington,1511814,5759,1506055
Rhode Island,203167,371,202796
Mississippi,325095,356,324739
Oregon,773130,8653,764477
San Juan,44341,0,44341
Oklahoma,701280,802,700478
Carolina,19688,0,19688
Trujillo Alto,2873,0,2873
New Mexico,365962,3749,362213
Toa Baja,6517,0,6517
Dorado,3067,0,3067
Loíza,40,0,40
Minnesota,770077,1518,768559
South Carolina,908394,1266,907128
Iowa,350284,248,350036
Ohio,2194900,2845,2192055
Mayagüez,7284,0,7284
North Carolina,1416843,2911,1413932
North Dakota,77129,24,77105
Connecticut,608869,5284,603585
Massachusetts,1002203,15369,986834
Utah,573155,3166,569989
Idaho,311878,529,311349
Nevada,569461,12746,556715
Wyoming,53090,29,53061
Ponce,18091,0,18091
Aguadilla,5852,0,5852
Vermont,19530,131,19399
Alabama,814213,547,813666
Bayamón,33466,0,33466
Arkansas,370016,239,369777
Canóvanas,2099,0,2099
Cataño,2764,0,2764
Guaynabo,11603,0,11603
Hawaii,204390,25392,178998
Hormigueros,1264,0,1264
Arecibo,3962,0,3962
Hatillo,224,0,224
Cabo Rojo,2,0,2
Moca,1,0,1
Texas,5480573,14139,5466434
Tennessee,1105463,1312,1104151
Montana,118683,262,118421
Toa Alta,1345,0,1345
Query:
SELECT "state_name", "region_name", "carbon_offset_metric_tons"
   FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
   ORDER BY "carbon_offset_metric_tons" DESC
   LIMIT 100;
Answer:
state_name,region_name,carbon_offset_metric_tons
Tennessee,38118,801735.9490285052
Illinois,60007,621853.3593412824
Texas,77494,512610.66813091835
Missouri,65802,489006.13508212473
Ohio,43228,484721.2635178499
Missouri,63376,463178.9595687375
Missouri,65803,462634.5778919277
Oklahoma,73099,435565.2331024933
Oklahoma,74012,432735.0023913438
Michigan,49512,427055.38823365886
Florida,32162,426646.01324156235
Ohio,44060,425206.8886913309
Kentucky,41042,420818.85740560095
Texas,79936,417872.11847402947
Oklahoma,73013,416935.5260617598
Missouri,65807,416307.6468588007
Illinois,60638,415850.68522787036
Tennessee,37211,415360.03745234973
Florida,33619,413916.33040673943
Missouri,64801,409676.1841050299
Indiana,47130,397864.94890305185
North Carolina,28273,393586.7245210941
Tennessee,37421,393287.2250266976
Georgia,30336,390615.54834114376
Oklahoma,73160,389559.3592605198
Ohio,45069,388689.8219070208
Ohio,45011,383741.520219301
Ohio,45014,381237.27566523314
Georgia,30721,380669.3859522569
Illinois,60101,377562.60861743044
Arizona,85043,377052.24124040507
Texas,79424,375840.5251255896
Texas,75034,375417.04446259094
Tennessee,37040,375196.30049588287
Indiana,46241,373996.44664893625
Ohio,44130,369695.12177600845
Missouri,65203,368164.2642713727
Tennessee,37075,366776.06579666457
Georgia,30024,363550.9162361371
Tennessee,37013,362531.0922871441
Ohio,43551,361386.26235687756
Ohio,45241,360034.38750539644
Texas,77041,358487.5661938833
Missouri,64804,357744.0459940187
Illinois,60440,357609.172072142
Florida,32218,356715.857109372
Missouri,63026,356107.8813699734
Missouri,63301,355934.08830791584
Indiana,46268,355831.7883008441
Maryland,21740,355500.60504495894
Indiana,47150,354724.9617134193
South Carolina,29607,352880.4861307458
Louisiana,71111,351126.6830139867
Indiana,46143,347768.28126971936
Michigan,48150,346657.1108249868
Indiana,46168,346304.13416895224
Tennessee,37167,343292.9942358864
Georgia,30906,343182.0196101997
Alabama,35758,342086.7014838177
Arkansas,72401,341423.1299020018
Georgia,30349,340620.0182212812
Texas,77449,340298.67057107727
Michigan,48180,340155.13470222946
Illinois,60188,339087.61507753184
Michigan,49423,337702.0287617066
Mississippi,39503,337177.9995417756
Missouri,65804,336572.7661837482
Florida,33166,335395.37473141483
Kentucky,42101,335131.2104215428
Tennessee,37027,335128.28149573156
Ohio,43026,332375.2210404321
Wisconsin,53051,332343.606128664
Ohio,44720,331378.2711191536
Texas,77084,331011.95661238924
Tennessee,38305,330779.1957506412
Kansas,66062,330735.66256126645
Illinois,62040,330511.2430074255
Kentucky,40299,328895.088514075
Hawaii,96819,328755.8031071367
Florida,34135,328618.07906029915
Florida,32837,328436.84396507114
Florida,32824,328220.4731768592
Delaware,19720,326466.49565728224
California,91761,324694.82713887835
Missouri,65202,323114.5401054229
North Carolina,28027,321810.73089605564
Ohio,43207,321604.03503468464
Texas,78045,321591.29840352776
Indiana,46219,321056.8094740671
Tennessee,37042,319462.9942835971
Ohio,45044,319104.73003200995
Georgia,30096,319068.8038033476
Texas,78130,319064.8583093285
Missouri,65201,316671.6275513964
Georgia,30043,315118.69744142
Texas,78660,314448.2713558181
Arizona,85255,312658.2511876773
Hawaii,96797,312091.48516708426
Arizona,85142,311962.79156778596
Texas,78501,311731.3298957767
Query:
SELECT "state_name", 
           AVG("yearly_sunlight_kwh_kw_threshold_avg") AS "avg_yearly_sunlight_kwh_per_kw"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
    GROUP BY "state_name"
    LIMIT 100;
Answer:
state_name,avg_yearly_sunlight_kwh_per_kw
Pennsylvania,972.8998930357591
District of Columbia,1037.0
New York,983.1302408757779
Delaware,1023.7587055224963
Maryland,1031.4112193987417
New Jersey,998.4470678469738
Virginia,1055.9271219276773
Florida,1154.3516158508824
Illinois,980.6246990729176
Indiana,979.0946624061636
Louisiana,1086.5072128009658
Michigan,946.6092157222581
New Hampshire,973.8185105933043
Arizona,1369.2885219801447
California,1306.8583712033615
Colorado,1241.2486171321523
Georgia,1084.171898085401
Wisconsin,978.1682978421251
Alaska,730.424193548387
Kansas,1097.5856267839697
Nebraska,1068.8503623188403
West Virginia,976.6017697514732
Kentucky,1003.9061101971671
Maine,980.3380082808059
Missouri,1061.3455584291792
South Dakota,1074.0761904761905
Washington,878.0124419083396
Rhode Island,989.2265306122449
Mississippi,1089.3930488850892
Oregon,911.3853435777987
San Juan,1097.4271089987385
Oklahoma,1132.1401967337713
Carolina,1103.4159042956571
Trujillo Alto,1087.980103740599
New Mexico,1416.8774150701727
Toa Baja,1101.3748488688575
Dorado,1099.1714285714284
Loíza,1101.6
Minnesota,985.0026893841965
South Carolina,1101.8108684526924
Iowa,1011.1000955374753
Ohio,953.7296101571129
Mayagüez,1122.352082999887
North Carolina,1086.5286595569235
North Dakota,972.4784615384615
Connecticut,988.8913573653107
Massachusetts,974.8743598821558
Utah,1192.0286720269792
Idaho,1119.8419161676645
Nevada,1368.7400763358778
Wyoming,1166.2809523809524
Ponce,1032.1708420774735
Aguadilla,1159.9691547578523
Vermont,943.5
Alabama,1080.3305597569645
Bayamón,1095.190637098807
Arkansas,1069.502270638848
Canóvanas,1108.2529023144075
Cataño,1099.8999999999999
Guaynabo,1091.5916910023598
Hawaii,1269.9401574803148
Hormigueros,1106.1976932472526
Arecibo,1113.4777023971055
Hatillo,1116.475
Cabo Rojo,1127.1
Moca,996.1999999999999
Texas,1126.4488085438838
Tennessee,1036.9506576249662
Montana,1022.5666666666667
Toa Alta,1090.5598545984565
Query:
SELECT "state_name", MEDIAN("kw_median") AS "median_kw_capacity"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
    GROUP BY "state_name"
    LIMIT 100;
Answer:
state_name,median_kw_capacity
Virginia,9.0
Baja California,5.75
Delaware,9.5
Hormigueros,9.75
Oregon,12.0
Pennsylvania,8.25
Arizona,14.75
Arecibo,12.0
Hawaii,16.875
Alabama,12.25
Connecticut,8.0
Colorado,9.0
Vermont,9.25
Oklahoma,12.75
Louisiana,13.5
Toa Baja,9.0
Washington,10.5
Michigan,10.0
Florida,16.0
Mayagüez,9.25
Nebraska,10.5
Moca,7.0
Maryland,8.0
Cataño,10.25
Texas,12.75
Montana,9.875
Ohio,9.75
Dorado,11.25
New Jersey,7.5
Georgia,10.5
Wyoming,9.25
Illinois,9.5
North Dakota,11.0
Carolina,11.875
Iowa,10.25
Massachusetts,7.25
Missouri,10.0
Toa Alta,10.5
Wisconsin,10.5
Idaho,11.5
North Carolina,9.5
Mississippi,13.25
San Juan,11.25
Indiana,10.75
Canóvanas,8.25
Bayamón,11.5
Minnesota,9.75
District of Columbia,7.75
Alaska,10.25
Rhode Island,7.25
Nevada,12.375
South Dakota,9.0
New Hampshire,7.5
New York,8.0
Utah,11.0
South Carolina,11.0
California,12.25
New Mexico,13.0
Trujillo Alto,10.875
Kansas,10.75
Guaynabo,11.75
Tennessee,11.75
Arkansas,12.0
Kentucky,10.5
Ponce,10.75
Maine,6.25
Aguadilla,16.0
Corozal,14.25
West Virginia,9.5
Query:
SELECT "state_name", AVG("percent_covered") AS "avg_percent_covered"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
    GROUP BY "state_name"
    ORDER BY "avg_percent_covered" DESC
    LIMIT 100;
Answer:
state_name,avg_percent_covered
Trujillo Alto,2040.5624934431328
Cataño,1977.1135751398201
Toa Alta,1710.7408116079803
San Juan,361.1600438845385
Arecibo,239.5516220035041
West Virginia,134.7040655714731
Dorado,133.8421632605731
Mayagüez,129.1771202642994
New Jersey,124.22007839679854
Carolina,118.61155203088131
Alabama,118.15181543509537
Louisiana,113.44943038082381
Guaynabo,111.26805227548675
Canóvanas,111.11231184290489
North Carolina,111.00378212601817
Mississippi,110.38685412641186
Arizona,109.64577014936981
Toa Baja,108.02498418769798
Indiana,102.884568973642
Vermont,102.79805757806194
Washington,102.21900785046996
Ohio,100.1957983798897
Florida,99.63463369538297
Bayamón,98.86868696240633
Nevada,98.16257499733608
Georgia,96.55458334148544
Michigan,96.3166332425792
Tennessee,96.22961807019112
Aguadilla,95.93904539313895
South Carolina,95.47395975225123
Kentucky,94.62267354085364
Arkansas,94.08798696727425
Nebraska,93.41757348883557
California,93.2219977518554
Wisconsin,93.1936525385241
Utah,93.12673983869175
Pennsylvania,92.68306466974033
Iowa,92.50237522834108
Hawaii,92.40890122239371
Oregon,92.07550262671663
Rhode Island,91.74013630607047
Illinois,91.65385121185507
Ponce,91.56236721318227
Virginia,90.98671520397548
Colorado,90.80594676965518
Oklahoma,90.58936275851072
Minnesota,90.42832750511015
New Mexico,90.19310294856498
Kansas,89.95113875826729
Texas,89.86343251034103
Missouri,89.17689216788044
North Dakota,88.55661024596189
Connecticut,87.30600764926567
Massachusetts,87.21982464135493
New York,87.01654666423346
Loíza,85.48387096774194
District of Columbia,85.3173154619042
Delaware,85.27792503329306
Maine,85.24301426648185
Idaho,84.46661050804317
Alaska,83.1343291892894
South Dakota,82.78193284825554
New Hampshire,82.68678043934634
Montana,80.417314727058
Maryland,80.0363051672659
Wyoming,75.8881197240555
Hormigueros,72.03823210284625
Hatillo,38.851761427901465
Cabo Rojo,5.0
Moca,0.8264462809917356
Query:
SELECT "state_name", "region_name", "percent_qualified"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
    ORDER BY "percent_qualified" ASC
    LIMIT 100;
Answer:
state_name,region_name,percent_qualified
Illinois,60950,0.0
New York,10045,0.0
Michigan,49234,0.0
Maryland,21532,0.0
Virginia,24069,0.0
Colorado,80290,0.0
West Virginia,24724,0.0
South Carolina,29058,0.0
Colorado,80299,0.0
California,92305,0.0
Utah,84310,0.0
Florida,33849,0.0
Michigan,48674,0.0
Ohio,43002,0.0
New Jersey,07456,0.0
North Carolina,28357,0.0
South Dakota,57032,0.0
Tennessee,37015,0.0
District of Columbia,20303,0.0
California,95007,2.7777777777777777
Colorado,81415,11.11111111111111
New York,10173,12.5
California,92391,12.987012987012987
California,92386,13.97238017871649
Missouri,64060,14.285714285714286
New York,10123,17.24137931034483
California,92325,17.906865098415746
Arizona,86005,18.272425249169434
Pennsylvania,15545,20.0
Baja California,22400,20.0
Louisiana,70764,20.0
New York,10105,20.0
Indiana,46965,20.0
California,92321,22.15435868961688
California,95389,22.519083969465647
California,92378,23.568281938325992
New Jersey,07878,24.216524216524217
New York,10176,25.0
Iowa,50648,25.0
Georgia,30072,25.0
Massachusetts,02672,25.0
Montana,59411,25.510204081632654
Minnesota,55090,25.700934579439252
California,92352,26.010973379394432
Maryland,20880,26.424870466321245
California,95959,27.04703832752613
Illinois,62716,27.272727272727273
Pennsylvania,19149,27.44349692885682
New York,10155,27.77777777777778
California,95006,27.88586251621271
Connecticut,06927,28.0
Maine,04351,28.571428571428573
New York,10174,28.571428571428573
Pennsylvania,19142,29.15272531030761
Colorado,80025,30.0
Utah,84773,30.0
Indiana,46124,30.357142857142858
New York,10120,30.434782608695652
Maryland,21032,30.778663396689147
Pennsylvania,19120,31.392170010832
North Carolina,27599,31.764705882352942
California,92315,31.798715203426124
New York,12498,32.18390804597701
California,92333,33.2511100148002
Connecticut,06338,33.333333333333336
Pennsylvania,18660,33.333333333333336
Wisconsin,53167,33.333333333333336
Missouri,65738,33.333333333333336
Colorado,81334,33.333333333333336
Indiana,46937,33.333333333333336
South Carolina,29697,33.333333333333336
Florida,32706,33.333333333333336
Pennsylvania,19110,33.333333333333336
Maryland,20777,33.333333333333336
Pennsylvania,19132,33.55019191984907
Pennsylvania,19143,33.79228203906622
Kansas,66205,33.839300445471046
Pennsylvania,19151,34.46654256882532
Maryland,20896,34.962406015037594
Pennsylvania,19139,35.15326361341507
Pennsylvania,19134,35.15690473973368
Kansas,66208,35.473707083876576
California,92314,35.84478222741888
Pennsylvania,18353,36.36363636363637
North Dakota,58505,36.36363636363637
New York,10017,36.458333333333336
New York,12572,36.69724770642202
California,95018,36.88656476267096
Pennsylvania,19138,37.186544342507645
New Hampshire,03224,37.5
Utah,84763,37.5
Pennsylvania,19131,38.040775733465935
Montana,59937,38.101788170563964
South Dakota,57751,38.20459290187891
Minnesota,56465,38.28125
Pennsylvania,19124,38.31012721626765
Pennsylvania,19145,38.368391486174396
Virginia,23235,38.400812881037986
Pennsylvania,19140,38.402638050525375
New Jersey,07046,38.43821076573162
Query:
SELECT "state_name", SUM("carbon_offset_metric_tons") AS "total_carbon_offset"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
    GROUP BY "state_name"
    LIMIT 100;
Answer:
state_name,total_carbon_offset
Pennsylvania,25679219.804377407
District of Columbia,768728.0745405239
New York,21932730.052032903
Delaware,2047732.7107329231
Maryland,9341908.182602106
New Jersey,21441825.25895091
Virginia,14570516.612738723
Florida,84762071.96637787
Illinois,39019478.60061418
Indiana,22286009.07525565
Louisiana,16119065.632724501
Michigan,32170938.26439564
Minnesota,9461269.60415691
New Hampshire,1106392.337547703
Texas,80026572.09620419
Arizona,25393752.120932452
California,67060256.559903376
Colorado,15019343.801609265
Mayagüez,136317.66351863468
Georgia,26767856.473523576
South Carolina,15082325.953191794
Iowa,4480709.137428612
Tennessee,23662867.396383427
Wisconsin,18538719.211838692
Alaska,449958.7974072519
Kansas,8248164.19414453
Nebraska,3407555.482436877
West Virginia,2708875.483437571
Kentucky,10893849.027434926
Connecticut,5385610.014692117
Idaho,2001480.6360385297
Nevada,6552267.614581583
Wyoming,399567.8100756294
Oregon,4391352.901025
Mississippi,6675246.399348796
Aguadilla,107733.02459435827
Vermont,238985.90700712064
Carolina,372344.8403529482
Alabama,15792877.15528395
Bayamón,505479.538757477
Arkansas,7162306.228122597
Canóvanas,33633.89653257158
Cataño,40096.302153202625
Guaynabo,230168.9556225237
New Mexico,5193766.818696551
Arecibo,74104.26841802277
Cabo Rojo,159.01583819991797
Ohio,39985118.69480568
North Carolina,23363984.23961253
Maine,951467.7454093618
Missouri,20988770.94279073
Massachusetts,8448829.99986072
North Dakota,1164890.4157271704
South Dakota,1047973.7956763804
Utah,4055086.38298331
Rhode Island,1613670.238764769
Ponce,259596.63619231156
San Juan,792573.4658976337
Oklahoma,13676736.482410647
Toa Baja,86581.46720940567
Hormigueros,14312.409783773295
Dorado,47475.16902867142
Hatillo,6102.208001967081
Loíza,400.46323702419204
Moca,5.774905113871622
Montana,721128.5004524508
Washington,7305348.121577986
Toa Alta,17313.180368415116
Trujillo Alto,46442.93098691624
Hawaii,4666457.0008377
Query:
SELECT "state_name", MEDIAN("number_of_panels_median") AS "median_panels_per_installation"
    FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
    GROUP BY "state_name"
    ORDER BY "median_panels_per_installation" DESC
    LIMIT 100;
Answer:
state_name,median_panels_per_installation
Hawaii,67.500
Aguadilla,64.000
Florida,64.000
Arizona,59.000
Corozal,57.000
Louisiana,54.000
Mississippi,53.000
New Mexico,52.000
Texas,51.000
Oklahoma,51.000
Nevada,49.500
Alabama,49.000
California,49.000
Arecibo,48.000
Arkansas,48.000
Oregon,48.000
Carolina,47.500
Tennessee,47.000
Guaynabo,47.000
Idaho,46.000
Bayamón,46.000
Dorado,45.000
San Juan,45.000
Utah,44.000
South Carolina,44.000
North Dakota,44.000
Trujillo Alto,43.500
Ponce,43.000
Kansas,43.000
Indiana,43.000
Georgia,42.000
Washington,42.000
Toa Alta,42.000
Nebraska,42.000
Kentucky,42.000
Wisconsin,42.000
Cataño,41.000
Iowa,41.000
Alaska,41.000
Missouri,40.000
Michigan,40.000
Montana,39.500
Minnesota,39.000
Hormigueros,39.000
Ohio,39.000
Illinois,38.000
Delaware,38.000
North Carolina,38.000
West Virginia,38.000
Mayagüez,37.000
Vermont,37.000
Wyoming,37.000
Colorado,36.000
South Dakota,36.000
Toa Baja,36.000
Virginia,36.000
Pennsylvania,33.000
Canóvanas,33.000
Connecticut,32.000
New York,32.000
Maryland,32.000
District of Columbia,31.000
New Hampshire,30.000
New Jersey,30.000
Rhode Island,29.000
Massachusetts,29.000
Moca,28.000
Maine,25.000
Baja California,23.000
End Exploring Related Columns
Task: Can you provide a detailed comparison of the solar potential for each state, distinguishing between postal code and census tract levels? Include the number of buildings available for solar installations, the percentage covered by Project Sunroof, the percentage suitable for solar, total potential panel count, total kilowatt capacity, energy generation potential, carbon dioxide offset, and the gap in potential installations.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
State,Level,Number of Buildings Available for Solar Installations,Percentage Covered by Project Sunroof,Percentage Suitable for Solar,Total Potential Panel Count,Total Kilowatt Capacity,Energy Generation Potential,Carbon Dioxide Offset,Gap in Potential Installations
state_name:str,Postal Code,count_qualified:int,percent_covered:float[0-100],percent_qualified:float[0-100],number_of_panels_total:int,kw_total:float,yearly_sunlight_kwh_total:float,carbon_offset_metric_tons:float,gap_in_potential_installations:int
state_name:str,Census Tract,count_qualified:int,percent_covered:float[0-100],percent_qualified:float[0-100],number_of_panels_total:int,kw_total:float,yearly_sunlight_kwh_total:float,carbon_offset_metric_tons:float,gap_in_potential_installations:int
...
```

This table provides a detailed comparison of the solar potential for each state at both postal code and census tract levels. It includes key metrics such as the number of buildings available for solar installations, percentages covered by Project Sunroof and suitable for solar, total potential panel count, total kilowatt capacity, energy generation potential, carbon dioxide offset, and the gap in potential installations (calculated as the difference between the number of qualified buildings and existing installations)..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'SUNROOF_SOLAR': {'SUNROOF_SOLAR': ['SOLAR_POTENTIAL_BY_CENSUSTRACT', 'SOLAR_POTENTIAL_BY_POSTAL_CODE']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-27 06:30:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 06:30:05 - root - INFO - ```sql
SELECT "state_name", "Level",
       SUM("count_qualified") AS "Number of Buildings Available for Solar Installations",
       AVG("percent_covered") AS "Percentage Covered by Project Sunroof",
       AVG("percent_qualified") AS "Percentage Suitable for Solar",
       SUM("number_of_panels_total") AS "Total Potential Panel Count",
       SUM("kw_total") AS "Total Kilowatt Capacity",
       SUM("yearly_sunlight_kwh_total") AS "Energy Generation Potential",
       SUM("carbon_offset_metric_tons") AS "Carbon Dioxide Offset",
       SUM("count_qualified") - SUM(COALESCE("existing_installs_count", 0)) AS "Gap in Potential Installations"
FROM (
  SELECT "state_name", "count_qualified", "percent_covered", "percent_qualified", "number_of_panels_total", "kw_total", "yearly_sunlight_kwh_total", "carbon_offset_metric_tons", "existing_installs_count", 'Postal Code' AS "Level"
  FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
  UNION ALL
  SELECT "state_name", "count_qualified", "percent_covered", "percent_qualified", "number_of_panels_total", "kw_total", "yearly_sunlight_kwh_total", "carbon_offset_metric_tons", "existing_installs_count", 'Census Tract' AS "Level"
  FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
) AS unioned_table
GROUP BY "state_name", "Level"
ORDER BY "state_name", "Level";
```
2025-01-27 06:30:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:30:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:30:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:30:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 139
2025-01-27 06:30:07 - snowflake.connector.connection - INFO - closed
2025-01-27 06:30:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:30:07 - root - INFO - itercount: 1
2025-01-27 06:30:07 - root - INFO - 0
2025-01-27 06:30:07 - root - INFO - results: 
state_name,Level,Number of Buildings Available for Solar Installations,Percentage Covered by Project Sunroof,Percentage Suitable for Solar,Total Potential Panel Count,Total Kilowatt Capacity,Energy Generation Potential,Carbon Dioxide Offset,Gap in Potential Installations
Aguadilla,Census Tract,5852,95.93904539313895,89.84303986917156,432711,108177.75,160079112.7508179,107733.02459435827,5852
Aguadilla,Postal Code,5844,93.15526870442538,94.31143379125443,432049,108012.25,159844295.74992672,107574.99307295939,5844
Alabama,Census Tract,814213,118.15181543509537,75.7064689620111,77644088,19411022.0,24759196398.25475,15792877.15528395,813666
Alabama,Postal Code,813312,65.3636415604924,81.88299169012126,77298546,19324636.5,24646969095.845936,15723425.934489228,812768
Alaska,Census Tract,57169,83.1343291892894,67.3891486348244,5462549,1365637.25,1092118868.9737976,449958.7974072519,57086
Alaska,Postal Code,57138,88.96629632261681,78.00984454758942,5447225,1361806.25,1089086633.2073152,448709.5001029908,57055
Arecibo,Census Tract,3962,239.5516220035041,94.1909789661489,306604,76651.0,110110577.36539914,74104.26841802277,3962
Arecibo,Postal Code,4433,77.87529184298847,93.40742399641678,345214,86303.5,123956987.1142212,83422.88329775061,4433
Arizona,Census Tract,1754534,109.64577014936981,90.40516782276116,147450436,36862609.0,59127893265.42813,25393752.120932452,1714808
Arizona,Postal Code,1753531,87.4686382928109,93.81479777093914,147238408,36809602.0,59043009935.297775,25357559.299180172,1713835
Arkansas,Census Tract,370016,94.08798696727425,73.5760827694726,36012747,9003186.75,11362387314.959013,7162306.228122597,369777
Arkansas,Postal Code,369725,64.03184484226826,80.53295880502695,35933867,8983466.75,11336956069.406748,7146339.221664687,369486
Baja California,Postal Code,1,0.06743088334457181,20.0,23,5.75,8322.02979736328,0.0,1
Bayamón,Census Tract,33466,98.86868696240633,90.54093297303565,2134598,533649.5,751085531.8753113,505479.538757477,33466
Bayamón,Postal Code,33260,97.36410651881141,91.28405960797262,2098880,524720.0,738592635.6176331,497071.83661161206,33260
Cabo Rojo,Census Tract,2,5.0,100.0,668,167.0,236279.58453979492,159.01583819991797,2
California,Census Tract,8617901,93.2219977518554,84.42610938177201,654784266,163696066.5,243304846869.2128,67060256.559903376,8286083
California,Postal Code,8607224,89.78070050159477,88.4105249868377,652983168,163245792.0,242638396940.61917,66878632.22406632,8275950
Canóvanas,Census Tract,2099,111.11231184290489,82.97908947936548,139475,34868.75,49976173.3744995,33633.89653257158,2099
Canóvanas,Postal Code,2182,66.34040239260467,89.42622950819673,160471,40117.75,57543460.70198363,38726.67058507054,2182
Carolina,Census Tract,19688,118.61155203088131,91.95012311270571,1554053,388513.25,553262399.3939757,372344.8403529482,19688
Carolina,Postal Code,19237,88.9530773741177,93.41220105410265,1481427,370356.75,527251268.02654415,354839.38441194326,19237
Cataño,Census Tract,2764,1977.1135751398201,86.57358974659549,168020,42005.0,59578578.59686889,40096.302153202625,2764
Cataño,Postal Code,2860,95.55259585846524,91.19644888529244,186311,46577.75,65981195.478601106,44405.254583877424,2860
Colorado,Census Tract,1032067,90.80594676965518,80.52159958927903,69425443,17356360.75,24667013678.519062,15019343.801609265,1007705
Colorado,Postal Code,1031389,81.12936471319753,83.07765032579091,69150828,17287707.0,24570049923.14742,14960304.146578383,1007054
Connecticut,Census Tract,608869,87.30600764926567,65.75337434981022,43575214,10893803.5,12438466928.172298,5385610.014692117,603585
Connecticut,Postal Code,607976,77.10327700263738,72.29881131803253,43269892,10817473.0,12350145123.452475,5347366.443614538,602708
Corozal,Postal Code,15,1.2121212121212122,93.75,1667,416.75,587979.9845764162,395.7097278391667,15
Delaware,Census Tract,147535,85.27792503329306,71.13500821025055,10771425,2692856.25,3222438352.7232113,2047732.7107329231,147447
Delaware,Postal Code,147431,77.33200952927506,79.87848539811428,10742839,2685709.75,3213827406.3591805,2042260.7933182444,147343
District of Columbia,Census Tract,76464,85.3173154619042,63.397058540850374,3983844,995961.0,1209717858.796045,768728.0745405239,76022
District of Columbia,Postal Code,76385,81.96327798463946,75.11488176242611,3937623,984405.75,1195714591.0355346,759829.5491657511,75943
Dorado,Census Tract,3067,133.8421632605731,94.55205024605395,199501,49875.25,70542741.78618774,47475.16902867142,3067
Dorado,Postal Code,3064,78.27859026612323,93.84379785604901,199254,49813.5,70454673.23659058,47415.8990148845,3064
Florida,Census Tract,4817871,99.63463369538297,83.27936582037172,463123814,115780953.5,157971622252.88788,84762071.96637787,4712507
Florida,Postal Code,4814177,82.9849507142317,90.85016886522146,462105732,115526433.0,157617914915.22406,84572912.49373843,4708885
Georgia,Census Tract,1503687,96.55458334148544,68.60191456870614,140138439,35034609.75,44737933517.87483,26767856.473523576,1501780
Georgia,Postal Code,1502091,72.02704651939646,76.48404856671779,139653741,34913435.25,44581060812.036766,26673519.941978436,1500185
Guaynabo,Census Tract,11603,111.26805227548675,89.7713593686313,984133,246033.25,342005084.6763794,230168.9556225237,11603
Guaynabo,Postal Code,12113,96.69070837371876,88.43952681035891,986943,246735.75,342637380.9947451,230594.4901825723,12113
Hatillo,Census Tract,224,38.851761427901465,91.4722740602506,25246,6311.5,9067192.223126221,6102.208001967081,224
Hawaii,Census Tract,204390,92.40890122239371,90.28828623458989,19873246,4968311.5,7415195492.54585,4666457.0008377,178998
Hawaii,Postal Code,204227,85.77323256083754,94.93133340007105,19835765,4958941.25,7400954705.809179,4657525.910539113,178851
Hormigueros,Census Tract,1264,72.03823210284625,91.17801424826256,59807,14951.75,21266625.235290524,14312.409783773295,1264
Hormigueros,Postal Code,1194,58.690744920993225,91.84615384615384,54608,13652.0,19401835.649896257,13057.408935665711,1194
Idaho,Census Tract,311878,84.46661050804317,75.91076792895495,23093899,5773474.75,7526956885.239657,2001480.6360385297,311349
Idaho,Postal Code,311671,77.44616743720587,85.81752126830317,23026001,5756500.25,7504231760.321072,1995437.83571835,311142
Illinois,Census Tract,2055456,91.65385121185507,75.0703988032207,164256874,41064218.5,47344747566.82309,39019478.60061418,2053003
Illinois,Postal Code,2052522,81.52174935109403,81.22551550568912,163236997,40809249.25,47047851222.022064,38776748.30638688,2050075
Indiana,Census Tract,1117000,102.884568973642,74.4162992494216,93311273,23327818.25,26928123257.6459,22286009.07525565,1116012
Indiana,Postal Code,1116413,72.70729951623913,80.98704273615954,93048465,23262116.25,26851041383.54419,22222230.940975703,1115426
Iowa,Census Tract,350284,92.50237522834108,67.55135102465916,29953011,7488252.75,8843145869.399496,4480709.137428612,350036
Iowa,Postal Code,350073,72.26174249883252,78.45999338382977,29910958,7477739.5,8830596479.387411,4474350.521690872,349825
Kansas,Census Tract,417333,89.95113875826729,74.45838191092518,36827430,9206857.5,11882464352.008951,8248164.19414453,416595
Kansas,Postal Code,417118,78.00151867237689,83.90980882904063,36723960,9180990.0,11849160234.790615,8225046.27693307,416381
Kentucky,Census Tract,575985,94.62267354085364,80.79952498243404,47393349,11848337.25,14048103923.893398,10893849.027434926,575262
Kentucky,Postal Code,577255,75.34738154677153,86.85440770148307,47570216,11892554.0,14104070608.580994,10935523.832197247,576530
Louisiana,Census Tract,865003,113.44943038082381,82.17435382731469,80308875,20077218.75,25885642034.581642,16119065.632724501,856780
Louisiana,Postal Code,864431,74.02401966050748,85.77600943642517,80134650,20033662.5,25827876726.134464,16083222.605670767,856210
Loíza,Census Tract,40,85.48387096774194,75.47169811320755,1693,423.25,595043.1626098631,400.46323702419204,40
Maine,Census Tract,100065,85.24301426648185,65.17547802899195,7720530,1930132.5,2197957054.097583,951467.7454093618,99705
Maine,Postal Code,99960,63.10106887979923,63.63666881149767,7689271,1922317.75,2189004685.142859,947591.4564713892,99600
Maryland,Census Tract,705813,80.0363051672659,69.81305560602681,47690643,11922660.75,14399236326.491217,9341908.182602106,699742
Maryland,Postal Code,705396,71.16030669975414,78.2143673837333,47560886,11890221.5,14360334548.562885,9317029.141011486,699332
Massachusetts,Census Tract,1002203,87.21982464135493,72.28938390680628,69012277,17253069.25,19514148116.75344,8448829.99986072,986834
Massachusetts,Postal Code,1000732,81.69850341980235,73.94909266069027,68609324,17152331.0,19399236401.382404,8399385.428188125,985382
Mayagüez,Census Tract,7284,129.1771202642994,88.31524322675783,567212,141803.0,202552659.3214233,136317.66351863468,7284
Mayagüez,Postal Code,7348,93.56904274340901,91.3667202708606,571212,142803.0,203989405.60508427,137284.59180836374,7348
Michigan,Census Tract,1847255,96.3166332425792,72.87447311567932,147876313,36969078.25,40976609871.52639,32170938.26439564,1845535
Michigan,Postal Code,1846232,76.11109096649125,79.04143589637175,147391827,36847956.75,40840033399.2527,32063411.389291123,1844515
Minnesota,Census Tract,770077,90.42832750511015,64.55495274901153,65662303,16415575.75,18673751434.616875,9461269.60415691,768559
Minnesota,Postal Code,769481,83.07005491274448,72.02677785988112,65464154,16366038.5,18617438249.156933,9432736.4318702,767964
Mississippi,Census Tract,325095,110.38685412641186,70.47452389375442,32218920,8054730.0,10408673466.612555,6675246.399348796,324739
Mississippi,Postal Code,324867,72.63111176104802,82.19166818603286,32127017,8031754.25,10378294594.571173,6657377.0431828415,324511
Missouri,Census Tract,1032104,89.17689216788044,76.3366899845083,84085928,21021482.0,26123174340.937077,20988770.94279073,1029240
Missouri,Postal Code,1031097,80.34422515005366,82.55774214780111,83816328,20954082.0,26038971734.14675,20922455.46777513,1028243
Moca,Census Tract,1,0.8264462809917356,100.0,28,7.0,8580.857080078125,5.774905113871622,1
Moca,Postal Code,1,0.36900369003690037,100.0,28,7.0,8580.857080078125,5.774905113871622,1
Montana,Census Tract,118683,80.417314727058,72.27714051202193,9189162,2297290.5,2711943864.901141,721128.5004524508,118421
Montana,Postal Code,118654,69.92868695582884,74.89138821125225,9181610,2295402.5,2709785572.9772882,720554.5926224514,118393
Nebraska,Census Tract,283467,93.41757348883557,80.62010526352871,21582607,5395651.75,6725165429.183444,3407555.482436877,283257
Nebraska,Postal Code,283330,80.3729482344542,86.8810104386528,21495882,5373970.5,6698087315.291831,3393835.347755131,283121
Nevada,Census Tract,569461,98.16257499733608,90.79523059001976,43616656,10904164.0,17236108170.27167,6552267.614581583,556715
Nevada,Postal Code,569104,80.35806150420441,92.41557021018671,43540016,10885004.0,17206349924.622555,6541464.54058874,556366
New Hampshire,Census Tract,107103,82.68678043934634,67.9415712418198,9054358,2263589.5,2555251276.171985,1106392.337547703,106841
New Hampshire,Postal Code,107012,50.14231216128735,68.14373199300624,9037409,2259352.25,2550456273.8240113,1104316.148032614,106750
New Jersey,Census Tract,1632773,124.22007839679854,72.49284036555349,117024321,29256080.25,34132296027.414562,21441825.25895091,1620118
New Jersey,Postal Code,1629714,88.22893832760148,76.2982184524033,116249897,29062474.25,33904852397.547024,21299363.239696037,1617086
New Mexico,Census Tract,365962,90.19310294856498,87.26558195086373,29605361,7401340.25,12208818476.493713,5193766.818696551,362213
New Mexico,Postal Code,365713,73.56221925571542,90.66469204457194,29552308,7388077.0,12187002098.50356,5184507.904926238,361964
New York,Census Tract,2506035,87.01654666423346,70.3824007333638,158794563,39698640.75,45100394878.669464,21932730.052032903,2487240
New York,Postal Code,2502541,85.27673962577262,77.40818366695984,157857812,39464453.0,44831446454.66716,21798509.3083663,2483797
North Carolina,Census Tract,1416843,111.00378212601817,68.18277115519244,124233257,31058314.25,39607264848.0049,23363984.23961253,1413932
North Carolina,Postal Code,1416043,63.194070914764936,76.831511026237,123962977,30990744.25,39519833527.20979,23311951.92699679,1413133
North Dakota,Census Tract,77129,88.55661024596189,75.3665552162828,8138951,2034737.75,2299032486.195364,1164890.4157271704,77105
North Dakota,Postal Code,77117,78.53210718919708,80.68802648949998,8128226,2032056.5,2295970930.981845,1163339.1647784072,77093
Ohio,Census Tract,2194900,100.1957983798897,76.22748275975313,171901350,42975337.5,48300160986.35466,39985118.69480568,2192055
Ohio,Postal Code,2192109,79.33516702608135,82.39723759334927,171022353,42755588.25,48048536615.677925,39776810.4632109,2189269
Oklahoma,Census Tract,701280,90.58936275851072,87.74299094697147,60560124,15140031.0,20218586198.69937,13676736.482410647,700478
Oklahoma,Postal Code,700888,76.98000635053329,90.6883086147428,60455902,15113975.5,20183717271.261906,13653148.546175597,700086
Oregon,Census Tract,773130,92.07550262671663,79.62664401997048,61617355,15404338.75,16514535968.386444,4391352.901025,764477
Oregon,Postal Code,772441,76.67033698320569,85.56283254708075,61510848,15377712.0,16486992928.991991,4384028.977048002,763794
Pennsylvania,Census Tract,1956097,92.68306466974033,68.85707992410286,133691622,33422905.5,38210009215.75753,25679219.804377407,1951689
Pennsylvania,Postal Code,1954585,79.06967897178195,79.50152162654109,133004637,33251159.25,38013732231.37531,25546821.485438112,1950183
Ponce,Census Tract,18091,91.56236721318227,89.9396040617879,1165041,291260.25,385731295.9626892,259596.63619231156,18091
Ponce,Postal Code,18706,87.87217710733272,91.44872619683593,1162806,290701.5,384801553.74663687,258970.92094872272,18706
Rhode Island,Census Tract,203167,91.74013630607047,75.69773905575148,13001474,3250368.5,3726814813.7138762,1613670.238764769,202796
Rhode Island,Postal Code,202865,83.8420145651795,75.47806245993253,12914100,3228525.0,3701710212.139731,1602800.1897457635,202494
San Juan,Census Tract,44341,361.1600438845385,90.2046719638303,3375014,843753.5,1177674698.0644774,792573.4658976337,44341
San Juan,Postal Code,44665,98.24550518972346,91.33009202920341,3423143,855785.75,1195075494.090149,804284.1778948521,44665
South Carolina,Census Tract,908394,95.47395975225123,73.39684628969717,79312131,19828032.75,25692275291.33939,15082325.953191794,907128
South Carolina,Postal Code,907878,68.29906526292937,80.08563002130781,79183940,19795985.0,25650182524.80312,15057615.542086853,906615
South Dakota,Census Tract,72867,82.78193284825554,73.1301178566635,6377373,1594343.25,1966083346.8824432,1047973.7956763804,72846
South Dakota,Postal Code,72847,52.45083205685707,76.16484077656688,6372371,1593092.75,1964549826.5415552,1047147.0385288498,72826
Tennessee,Census Tract,1105463,96.22961807019112,76.27267213792194,101762224,25440556.0,31169276299.068554,23662867.396383427,1104151
Tennessee,Postal Code,1102947,74.46006733391978,83.65948527656543,101108289,25277072.25,30966907026.81165,23508638.5761802,1101641
Texas,Census Tract,5480573,89.86343251034103,83.60340471279187,481747719,120436929.75,160458070556.08868,80026572.09620419,5466434
Texas,Postal Code,5476777,81.35349870837807,89.34929795432053,480505530,120126382.5,160039623751.7003,79820466.39724964,5462650
Toa Alta,Census Tract,1345,1710.7408116079803,87.95785274938673,73394,18348.5,25725431.5722229,17313.180368415116,1345
Toa Alta,Postal Code,1123,83.18994043679682,89.33969769291966,88675,22168.75,31279276.972485356,21050.91074946186,1123
Toa Baja,Census Tract,6517,108.02498418769798,90.59109586594275,362967,90741.75,128650286.23981933,86581.46720940567,6517
Toa Baja,Postal Code,6976,96.83583571162676,89.3900563813429,371052,92763.0,131548735.53740233,88532.11963429808,6976
Trujillo Alto,Census Tract,2873,2040.5624934431328,86.22386755943712,197851,49462.75,69008952.58372192,46442.93098691624,2873
Trujillo Alto,Postal Code,2854,93.46999728482216,88.81837244579282,196126,49031.5,68412270.15056156,46041.3645230469,2854
Utah,Census Tract,573155,93.12673983869175,84.22705043917742,44105531,11026382.75,15249940379.663124,4055086.38298331,569989
Utah,Postal Code,572530,76.16223561464696,85.93581601402273,43988756,10997189.0,15209638303.221928,4044369.724602101,569369
Vermont,Census Tract,19530,102.79805757806194,68.89857488088953,2012472,503118.0,551942863.0689392,238985.90700712064,19399
Vermont,Postal Code,19504,79.35918973288327,79.5994775409519,1988764,497191.0,545353715.0415834,236132.86981235372,19373
Virginia,Census Tract,963792,90.98671520397548,70.29803660202286,74914378,18728594.5,23169044381.25027,14570516.612738723,961383
Virginia,Postal Code,963270,70.44108422452733,77.44664178774818,74735305,18683826.25,23113080773.399204,14534537.81879123,960863
Washington,Census Tract,1511814,102.21900785046996,74.3926663890639,107938035,26984508.75,27475803851.394146,7305348.121577986,1506055
Washington,Postal Code,1510869,83.21639552127759,84.03996306007777,107756625,26939156.25,27430232929.40039,7293347.185103217,1505113
West Virginia,Census Tract,155047,134.7040655714731,71.8114182883734,11387665,2846916.25,3272165883.9079347,2708875.483437571,154967
West Virginia,Postal Code,154869,66.83908549978547,82.71154300892732,11336559,2834139.75,3257389195.7982965,2696642.54367634,154789
Wisconsin,Census Tract,900707,93.1936525385241,74.55363214741563,82459475,20614868.75,23542559983.903282,18538719.211838692,898793
Wisconsin,Postal Code,900028,78.21393285262631,80.06679188975762,82263947,20565986.75,23486482672.1245,18493486.25400976,898115
Wyoming,Census Tract,53090,75.8881197240555,78.68145154613299,3848056,962014.0,1302268164.5376706,399567.8100756294,53061
Wyoming,Postal Code,53068,78.96861340065533,78.76528710918183,3843267,960816.75,1300665963.824701,399141.77153828304,53039


2025-01-27 06:30:07 - root - INFO - Please check the answer again by reviewing Can you provide a detailed comparison of the solar potential for each state, distinguishing between postal code and census tract levels? Include the number of buildings available for solar installations, the percentage covered by Project Sunroof, the percentage suitable for solar, total potential panel count, total kilowatt capacity, energy generation potential, carbon dioxide offset, and the gap in potential installations., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
State,Level,Number of Buildings Available for Solar Installations,Percentage Covered by Project Sunroof,Percentage Suitable for Solar,Total Potential Panel Count,Total Kilowatt Capacity,Energy Generation Potential,Carbon Dioxide Offset,Gap in Potential Installations
state_name:str,Postal Code,count_qualified:int,percent_covered:float[0-100],percent_qualified:float[0-100],number_of_panels_total:int,kw_total:float,yearly_sunlight_kwh_total:float,carbon_offset_metric_tons:float,gap_in_potential_installations:int
state_name:str,Census Tract,count_qualified:int,percent_covered:float[0-100],percent_qualified:float[0-100],number_of_panels_total:int,kw_total:float,yearly_sunlight_kwh_total:float,carbon_offset_metric_tons:float,gap_in_potential_installations:int
...
```

This table provides a detailed comparison of the solar potential for each state at both postal code and census tract levels. It includes key metrics such as the number of buildings available for solar installations, percentages covered by Project Sunroof and suitable for solar, total potential panel count, total kilowatt capacity, energy generation potential, carbon dioxide offset, and the gap in potential installations (calculated as the difference between the number of qualified buildings and existing installations). The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Too long, hard cut:
state_name,Level,Number of Buildings Available for Solar Installations,Percentage Covered by Project Sunroof,Percentage Suitable for Solar,Total Potential Panel Count,Total Kilowatt Capacity,Energy Generation Potential,Carbon Dioxide Offset,Gap in Potential Installations
Aguadilla,Census Tract,5852,95.93904539313895,89.84303986917156,432711,108177.75,160079112.7508179,107733.02459435827,5852
Aguadilla,Postal Code,5844,93.15526870442538,94.31143379125443,432049,108012.25,159844295.74992672,107574.99307295939,5844
Alabama,Census Tract,814213,118.15181543509537,75.7064689620111,77644088,19411022.0,24759196398.25475,15792877.15528395,813666
Alabama,Postal Code,813312,65.3636415604924,81.88299169012126,77298546,19324636.5,24646969095.845936,15723425.934489228,812768
Alaska,Census Tract,57169,83.1343291892894,67.3891486348244,5462549,1365637.25,1092118868.9737976,449958.7974072519,57086
Alaska,Postal Code,57138,88.96629632261681,78.00984454758942,5447225,1361806.25,1089086633.2073152,448709.5001029908,57055
Arecibo,Census Tract,3962,239.5516220035041,94.1909789661489,306604,76651.0,110110577.36539914,74104.26841802277,3962
Arecibo,Postal Code,4433,77.87529184298847,93.40742399641678,345214,86303.5,123956987.1142212,83422.88329775061,4433
Arizona,Census Tract,1754534,109.64577014936981,90.40516782276116,147450436,36862609.0,59127893265.42813,25393752.120932452,1714808
Arizona,Postal Code,1753531,87.4686382928109,93.81479777093914,147238408,36809602.0,59043009935.297775,25357559.299180172,1713835
Arkansas,Census Tract,370016,94.08798696727425,73.5760827694726,36012747,9003186.75,11362387314.959013,7162306.228122597,369777
Arkansas,Postal Code,369725,64.03184484226826,80.53295880502695,35933867,8983466.75,11336956069.406748,7146339.221664687,369486
Baja California,Postal Code,1,0.06743088334457181,20.0,23,5.75,8322.02979736328,0.0,1
Bayamón,Census Tract,33466,98.86868696240633,90.54093297303565,2134598,533649.5,751085531.8753113,505479.538757477,33466
Bayamón,Postal Code,33260,97.36410651881141,91.28405960797262,2098880,524720.0,738592635.6176331,497071.83661161206,33260
Cabo Rojo,Census Tract,2,5.0,100.0,668,167.0,236279.58453979492,159.01583819991797,2
California,Census Tract,8617901,93.2219977518554,84.42610938177201,654784266,163696066.5,243304846869.2128,67060256.559903376,8286083
California,Postal Code,8607224,89.78070050159477,88.4105249868377,652983168,163245792.0,242638396940.61917,66878632.22406632,8275950
Canóvanas,Census Tract,2099,111.11231184290489,82.97908947936548,139475,34868.75,49976173.3744995,33633.89653257158,2099
Canóvanas,Postal Code,2182,66.34040239260467,89.42622950819673,160471,40117.75,57543460.70198363,38726.67058507054,2182
Carolina,Census Tract,19688,118.61155203088131,91.95012311270571,1554053,388513.25,553262399.3939757,372344.8403529482,19688
Carolina,Postal Code,19237,88.9530773741177,93.41220105410265,1481427,370356.75,527251268.02654415,354839.38441194326,19237
Cataño,Census Tract,2764,1977.1135751398201,86.57358974659549,168020,42005.0,59578578.59686889,40096.302153202625,2764
Cataño,Postal Code,2860,95.55259585846524,91.19644888529244,186311,46577.75,65981195.478601106,44405.254583877424,2860
Colorado,Census Tract,1032067,90.80594676965518,80.52159958927903,69425443,17356360.75,24667013678.519062,15019343.801609265,1007705
Colorado,Postal Code,1031389,81.12936471319753,83.07765032579091,69150828,17287707.0,24570049923.14742,14960304.146578383,1007054
Connecticut,Census Tract,608869,87.30600764926567,65.75337434981022,43575214,10893803.5,12438466928.172298,5385610.014692117,603585
Connecticut,Postal Code,607976,77.10327700263738,72.29881131803253,43269892,10817473.0,12350145123.452475,5347366.443614538,602708
Corozal,Postal Code,15,1.2121212121212122,93.75,1667,416.75,587979.9845764162,395.7097278391667,15
Delaware,Census Tract,147535,85.27792503329306,71.13500821025055,10771425,2692856.25,3222438352.7232113,2047732.7107329231,147447
Delaware,Postal Code,147431,77.33200952927506,79.87848539811428,10742839,2685709.75,3213827406.3591805,2042260.7933182444,147343
District of Columbia,Census Tract,76464,85.3173154619042,63.397058540850374,3983844,995961.0,1209717858.796045,768728.0745405239,76022
District of Columbia,Postal Code,76385,81.96327798463946,75.11488176242611,3937623,984405.75,1195714591.0355346,759829.5491657511,75943
Dorado,Census Tract,3067,133.8421632605731,94.55205024605395,199501,49875.25,70542741.78618774,47475.16902867142,3067
Dorado,Postal Code,3064,78.27859026612323,93.84379785604901,199254,49813.5,70454673.23659058,47415.8990148845,3064
Florida,Census Tract,4817871,99.63463369538297,83.27936582037172,463123814,115780953.5,157971622252.88788,84762071.96637787,4712507
Florida,Postal Code,4814177,82.9849507142317,90.85016886522146,462105732,115526433.0,157617914915.22406,84572912.49373843,4708885
Georgia,Census Tract,1503687,96.55458334148544,68.60191456870614,140138439,35034609.75,44737933517.87483,26767856.473523576,1501780
Georgia,Postal Code,1502091,72.02704651939646,76.48404856671779,139653741,34913435.25,44581060812.036766,26673519.941978436,1500185
Guaynabo,Census Tract,11603,111.26805227548675,89.7713593686313,984133,246033.25,342005084.6763794,230168.9556225237,11603
Guaynabo,Postal Code,12113,96.69070837371876,88.43952681035891,986943,246735.75,342637380.9947451,230594.4901825723,12113
Hatillo,Census Tract,224,38.851761427901465,91.4722740602506,25246,6311.5,9067192.223126221,6102.208001967081,224
Hawaii,Census Tract,204390,92.40890122239371,90.28828623458989,19873246,4968311.5,7415195492.54585,4666457.0008377,178998
Hawaii,Postal Code,204227,85.77323256083754,94.93133340007105,19835765,4958941.25,7400954705.809179,4657525.910539113,178851
Hormigueros,Census Tract,1264,72.03823210284625,91.17801424826256,59807,14951.75,21266625.235290524,14312.409783773295,1264
Hormigueros,Postal Code,1194,58.690744920993225,91.84615384615384,54608,13652.0,19401835.649896257,13057.408935665711,1194
Idaho,Census Tract,311878,84.46661050804317,75.91076792895495,23093899,5773474.75,7526956885.239657,2001480.6360385297,311349
Idaho,Postal Code,311671,77.44616743720587,85.81752126830317,23026001,5756500.25,7504231760.321072,1995437.83571835,311142
Illinois,Census Tract,2055456,91.65385121185507,75.0703988032207,164256874,41064218.5,47344747566.82309,39019478.60061418,2053003
Illinois,Postal Code,2052522,81.52174935109403,81.22551550568912,163236997,40809249.25,47047851222.022064,38776748.30638688,2050075
Indiana,Census Tract,1117000,102.884568973642,74.4162992494216,93311273,23327818.25,26928123257.6459,22286009.07525565,1116012
Indiana,Postal Code,1116413,72.70729951623913,80.98704273615954,93048465,23262116.25,26851041383.54419,22222230.940975703,1115426
Iowa,Census Tract,350284,92.50237522834108,67.55135102465916,29953011,7488252.75,8843145869.399496,4480709.137428612,350036
Iowa,Postal Code,350073,72.26174249883252,78.45999338382977,29910958,7477739.5,8830596479.387411,4474350.521690872,349825
Kansas,Census Tract,417333,89.95113875826729,74.45838191092518,36827430,9206857.5,11882464352.008951,8248164.19414453,416595
Kansas,Postal Code,417118,78.00151867237689,83.90980882904063,36723960,9180990.0,11849160234.790615,8225046.27693307,416381
Kentucky,Census Tract,575985,94.62267354085364,80.79952498243404,47393349,11848337.25,14048103923.893398,10893849.027434926,575262
Kentucky,Postal Code,577255,75.34738154677153,86.85440770148307,47570216,11892554.0,14104070608.580994,10935523.832197247,576530
Louisiana,Census Tract,865003,113.44943038082381,82.17435382731469,80308875,20077218.75,25885642034.581642,16119065.632724501,856780
Louisiana,Postal Code,864431,74.02401966050748,85.77600943642517,80134650,20033662.5,25827876726.134464,16083222.605670767,856210
Loíza,Census Tract,40,85.48387096774194,75.47169811320755,1693,423.25,595043.1626098631,400.46323702419204,40
Maine,Census Tract,100065,85.24301426648185,65.17547802899195,7720530,1930132.5,2197957054.097583,951467.7454093618,99705
Maine,Postal Code,99960,63.10106887979923,63.63666881149767,7689271,1922317.75,2189004685.142859,947591.4564713892,99600
Maryland,Census Tract,705813,80.0363051672659,69.81305560602681,47690643,11922660.75,14399236326.491217,9341908.182602106,699742
Maryland,Postal Code,705396,71.16030669975414,78.2143673837333,47560886,11890221.5,14360334548.562885,9317029.141011486,699332
Massachusetts,Census Tract,1002203,87.21982464135493,72.28938390680628,69012277,17253069.25,19514148116.75344,8448829.99986072,986834
Massachusetts,Postal Code,1000732,81.69850341980235,73.94909266069027,68609324,17152331.0,19399236401.382404,8399385.428188125,985382
Mayagüez,Census Tract,7284,129.1771202642994,88.31524322675783,567212,141803.0,202552659.3214233,136317.66351863468,7284
Mayagüez,Postal Code,7348,93.56904274340901,91.3667202708606,571212,142803.0,203989405.60508427,137284.59180836374,7348
Michigan,Census Tract,1847255,96.3166332425792,72.87447311567932,147876313,36969078.25,40976609871.52639,32170938.26439564,1845535
Michigan,Postal Code,1846232,76.11109096649125,79.04143589637175,147391827,36847956.75,40840033399.2527,32063411.389291123,1844515
Minnesota,Census Tract,770077,90.42832750511015,64.55495274901153,65662303,16415575.75,18673751434.616875,9461269.60415691,768559
Minnesota,Postal Code,769481,83.07005491274448,72.02677785988112,65464154,16366038.5,18617438249.156933,9432736.4318702,767964
Mississippi,Census Tract,325095,110.38685412641186,70.47452389375442,32218920,8054730.0,10408673466.612555,6675246.399348796,324739
Mississippi,Postal Code,324867,72.63111176104802,82.19166818603286,32127017,8031754.25,10378294594.571173,6657377.0431828415,324511
Missouri,Census Tract,1032104,89.17689216788044,76.3366899845083,84085928,21021482.0,26123174340.937077,20988770.94279073,1029240
Missouri,Postal Code,1031097,80.34422515005366,82.55774214780111,83816328,20954082.0,26038971734.14675,20922455.46777513,1028243
Moca,Census Tract,1,0.8264462809917356,100.0,28,7.0,8580.857080078125,5.774905113871622,1
Moca,Postal Code,1
Current sql:
SELECT "state_name", "Level",
       SUM("count_qualified") AS "Number of Buildings Available for Solar Installations",
       AVG("percent_covered") AS "Percentage Covered by Project Sunroof",
       AVG("percent_qualified") AS "Percentage Suitable for Solar",
       SUM("number_of_panels_total") AS "Total Potential Panel Count",
       SUM("kw_total") AS "Total Kilowatt Capacity",
       SUM("yearly_sunlight_kwh_total") AS "Energy Generation Potential",
       SUM("carbon_offset_metric_tons") AS "Carbon Dioxide Offset",
       SUM("count_qualified") - SUM(COALESCE("existing_installs_count", 0)) AS "Gap in Potential Installations"
FROM (
  SELECT "state_name", "count_qualified", "percent_covered", "percent_qualified", "number_of_panels_total", "kw_total", "yearly_sunlight_kwh_total", "carbon_offset_metric_tons", "existing_installs_count", 'Postal Code' AS "Level"
  FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
  UNION ALL
  SELECT "state_name", "count_qualified", "percent_covered", "percent_qualified", "number_of_panels_total", "kw_total", "yearly_sunlight_kwh_total", "carbon_offset_metric_tons", "existing_installs_count", 'Census Tract' AS "Level"
  FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
) AS unioned_table
GROUP BY "state_name", "Level"
ORDER BY "state_name", "Level";
2025-01-27 06:31:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 06:31:17 - root - INFO - ```sql
SELECT "state_name" AS "State",
       "Level",
       SUM("count_qualified") AS "Number of Buildings Available for Solar Installations",
       ROUND(AVG("percent_covered"), 4) AS "Percentage Covered by Project Sunroof",
       ROUND(AVG("percent_qualified"), 4) AS "Percentage Suitable for Solar",
       SUM("number_of_panels_total") AS "Total Potential Panel Count",
       SUM("kw_total") AS "Total Kilowatt Capacity",
       SUM("yearly_sunlight_kwh_total") AS "Energy Generation Potential",
       ROUND(SUM("carbon_offset_metric_tons"), 4) AS "Carbon Dioxide Offset",
       SUM("count_qualified") - SUM(COALESCE("existing_installs_count", 0)) AS "Gap in Potential Installations"
FROM (
  SELECT "state_name", "count_qualified", "percent_covered", "percent_qualified", "number_of_panels_total", "kw_total", "yearly_sunlight_kwh_total", "carbon_offset_metric_tons", "existing_installs_count", 'Postal Code' AS "Level"
  FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
  UNION ALL
  SELECT "state_name", "count_qualified", "percent_covered", "percent_qualified", "number_of_panels_total", "kw_total", "yearly_sunlight_kwh_total", "carbon_offset_metric_tons", "existing_installs_count", 'Census Tract' AS "Level"
  FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
) AS unioned_table
GROUP BY "state_name", "Level"
ORDER BY "state_name", "Level";
```
2025-01-27 06:31:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:31:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:31:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:31:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 139
2025-01-27 06:31:19 - snowflake.connector.connection - INFO - closed
2025-01-27 06:31:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:31:20 - root - INFO - itercount: 2
2025-01-27 06:31:20 - root - INFO - 0
2025-01-27 06:31:20 - root - INFO - results: 
State,Level,Number of Buildings Available for Solar Installations,Percentage Covered by Project Sunroof,Percentage Suitable for Solar,Total Potential Panel Count,Total Kilowatt Capacity,Energy Generation Potential,Carbon Dioxide Offset,Gap in Potential Installations
Aguadilla,Census Tract,5852,95.939,89.843,432711,108177.75,160079112.7508179,107733.0246,5852
Aguadilla,Postal Code,5844,93.1553,94.3114,432049,108012.25,159844295.74992672,107574.9931,5844
Alabama,Census Tract,814213,118.1518,75.7065,77644088,19411022.0,24759196398.25475,15792877.1553,813666
Alabama,Postal Code,813312,65.3636,81.883,77298546,19324636.5,24646969095.845936,15723425.9345,812768
Alaska,Census Tract,57169,83.1343,67.3891,5462549,1365637.25,1092118868.9737976,449958.7974,57086
Alaska,Postal Code,57138,88.9663,78.0098,5447225,1361806.25,1089086633.2073152,448709.5001,57055
Arecibo,Census Tract,3962,239.5516,94.191,306604,76651.0,110110577.36539914,74104.2684,3962
Arecibo,Postal Code,4433,77.8753,93.4074,345214,86303.5,123956987.1142212,83422.8833,4433
Arizona,Census Tract,1754534,109.6458,90.4052,147450436,36862609.0,59127893265.42813,25393752.1209,1714808
Arizona,Postal Code,1753531,87.4686,93.8148,147238408,36809602.0,59043009935.297775,25357559.2992,1713835
Arkansas,Census Tract,370016,94.088,73.5761,36012747,9003186.75,11362387314.959013,7162306.2281,369777
Arkansas,Postal Code,369725,64.0318,80.533,35933867,8983466.75,11336956069.406748,7146339.2217,369486
Baja California,Postal Code,1,0.0674,20.0,23,5.75,8322.02979736328,0.0,1
Bayamón,Census Tract,33466,98.8687,90.5409,2134598,533649.5,751085531.8753113,505479.5388,33466
Bayamón,Postal Code,33260,97.3641,91.2841,2098880,524720.0,738592635.6176331,497071.8366,33260
Cabo Rojo,Census Tract,2,5.0,100.0,668,167.0,236279.58453979492,159.0158,2
California,Census Tract,8617901,93.222,84.4261,654784266,163696066.5,243304846869.2128,67060256.5599,8286083
California,Postal Code,8607224,89.7807,88.4105,652983168,163245792.0,242638396940.61917,66878632.2241,8275950
Canóvanas,Census Tract,2099,111.1123,82.9791,139475,34868.75,49976173.3744995,33633.8965,2099
Canóvanas,Postal Code,2182,66.3404,89.4262,160471,40117.75,57543460.70198363,38726.6706,2182
Carolina,Census Tract,19688,118.6116,91.9501,1554053,388513.25,553262399.3939757,372344.8404,19688
Carolina,Postal Code,19237,88.9531,93.4122,1481427,370356.75,527251268.02654415,354839.3844,19237
Cataño,Census Tract,2764,1977.1136,86.5736,168020,42005.0,59578578.59686889,40096.3022,2764
Cataño,Postal Code,2860,95.5526,91.1964,186311,46577.75,65981195.478601106,44405.2546,2860
Colorado,Census Tract,1032067,90.8059,80.5216,69425443,17356360.75,24667013678.519062,15019343.8016,1007705
Colorado,Postal Code,1031389,81.1294,83.0777,69150828,17287707.0,24570049923.14742,14960304.1466,1007054
Connecticut,Census Tract,608869,87.306,65.7534,43575214,10893803.5,12438466928.172298,5385610.0147,603585
Connecticut,Postal Code,607976,77.1033,72.2988,43269892,10817473.0,12350145123.452475,5347366.4436,602708
Corozal,Postal Code,15,1.2121,93.75,1667,416.75,587979.9845764162,395.7097,15
Delaware,Census Tract,147535,85.2779,71.135,10771425,2692856.25,3222438352.7232113,2047732.7107,147447
Delaware,Postal Code,147431,77.332,79.8785,10742839,2685709.75,3213827406.3591805,2042260.7933,147343
District of Columbia,Census Tract,76464,85.3173,63.3971,3983844,995961.0,1209717858.796045,768728.0745,76022
District of Columbia,Postal Code,76385,81.9633,75.1149,3937623,984405.75,1195714591.0355346,759829.5492,75943
Dorado,Census Tract,3067,133.8422,94.5521,199501,49875.25,70542741.78618774,47475.169,3067
Dorado,Postal Code,3064,78.2786,93.8438,199254,49813.5,70454673.23659058,47415.899,3064
Florida,Census Tract,4817871,99.6346,83.2794,463123814,115780953.5,157971622252.88788,84762071.9664,4712507
Florida,Postal Code,4814177,82.985,90.8502,462105732,115526433.0,157617914915.22406,84572912.4937,4708885
Georgia,Census Tract,1503687,96.5546,68.6019,140138439,35034609.75,44737933517.87483,26767856.4735,1501780
Georgia,Postal Code,1502091,72.027,76.484,139653741,34913435.25,44581060812.036766,26673519.942,1500185
Guaynabo,Census Tract,11603,111.2681,89.7714,984133,246033.25,342005084.6763794,230168.9556,11603
Guaynabo,Postal Code,12113,96.6907,88.4395,986943,246735.75,342637380.9947451,230594.4902,12113
Hatillo,Census Tract,224,38.8518,91.4723,25246,6311.5,9067192.223126221,6102.208,224
Hawaii,Census Tract,204390,92.4089,90.2883,19873246,4968311.5,7415195492.54585,4666457.0008,178998
Hawaii,Postal Code,204227,85.7732,94.9313,19835765,4958941.25,7400954705.809179,4657525.9105,178851
Hormigueros,Census Tract,1264,72.0382,91.178,59807,14951.75,21266625.235290524,14312.4098,1264
Hormigueros,Postal Code,1194,58.6907,91.8462,54608,13652.0,19401835.649896257,13057.4089,1194
Idaho,Census Tract,311878,84.4666,75.9108,23093899,5773474.75,7526956885.239657,2001480.636,311349
Idaho,Postal Code,311671,77.4462,85.8175,23026001,5756500.25,7504231760.321072,1995437.8357,311142
Illinois,Census Tract,2055456,91.6539,75.0704,164256874,41064218.5,47344747566.82309,39019478.6006,2053003
Illinois,Postal Code,2052522,81.5217,81.2255,163236997,40809249.25,47047851222.022064,38776748.3064,2050075
Indiana,Census Tract,1117000,102.8846,74.4163,93311273,23327818.25,26928123257.6459,22286009.0753,1116012
Indiana,Postal Code,1116413,72.7073,80.987,93048465,23262116.25,26851041383.54419,22222230.941,1115426
Iowa,Census Tract,350284,92.5024,67.5514,29953011,7488252.75,8843145869.399496,4480709.1374,350036
Iowa,Postal Code,350073,72.2617,78.46,29910958,7477739.5,8830596479.387411,4474350.5217,349825
Kansas,Census Tract,417333,89.9511,74.4584,36827430,9206857.5,11882464352.008951,8248164.1941,416595
Kansas,Postal Code,417118,78.0015,83.9098,36723960,9180990.0,11849160234.790615,8225046.2769,416381
Kentucky,Census Tract,575985,94.6227,80.7995,47393349,11848337.25,14048103923.893398,10893849.0274,575262
Kentucky,Postal Code,577255,75.3474,86.8544,47570216,11892554.0,14104070608.580994,10935523.8322,576530
Louisiana,Census Tract,865003,113.4494,82.1744,80308875,20077218.75,25885642034.581642,16119065.6327,856780
Louisiana,Postal Code,864431,74.024,85.776,80134650,20033662.5,25827876726.134464,16083222.6057,856210
Loíza,Census Tract,40,85.4839,75.4717,1693,423.25,595043.1626098631,400.4632,40
Maine,Census Tract,100065,85.243,65.1755,7720530,1930132.5,2197957054.097583,951467.7454,99705
Maine,Postal Code,99960,63.1011,63.6367,7689271,1922317.75,2189004685.142859,947591.4565,99600
Maryland,Census Tract,705813,80.0363,69.8131,47690643,11922660.75,14399236326.491217,9341908.1826,699742
Maryland,Postal Code,705396,71.1603,78.2144,47560886,11890221.5,14360334548.562885,9317029.141,699332
Massachusetts,Census Tract,1002203,87.2198,72.2894,69012277,17253069.25,19514148116.75344,8448829.9999,986834
Massachusetts,Postal Code,1000732,81.6985,73.9491,68609324,17152331.0,19399236401.382404,8399385.4282,985382
Mayagüez,Census Tract,7284,129.1771,88.3152,567212,141803.0,202552659.3214233,136317.6635,7284
Mayagüez,Postal Code,7348,93.569,91.3667,571212,142803.0,203989405.60508427,137284.5918,7348
Michigan,Census Tract,1847255,96.3166,72.8745,147876313,36969078.25,40976609871.52639,32170938.2644,1845535
Michigan,Postal Code,1846232,76.1111,79.0414,147391827,36847956.75,40840033399.2527,32063411.3893,1844515
Minnesota,Census Tract,770077,90.4283,64.555,65662303,16415575.75,18673751434.616875,9461269.6042,768559
Minnesota,Postal Code,769481,83.0701,72.0268,65464154,16366038.5,18617438249.156933,9432736.4319,767964
Mississippi,Census Tract,325095,110.3869,70.4745,32218920,8054730.0,10408673466.612555,6675246.3993,324739
Mississippi,Postal Code,324867,72.6311,82.1917,32127017,8031754.25,10378294594.571173,6657377.0432,324511
Missouri,Census Tract,1032104,89.1769,76.3367,84085928,21021482.0,26123174340.937077,20988770.9428,1029240
Missouri,Postal Code,1031097,80.3442,82.5577,83816328,20954082.0,26038971734.14675,20922455.4678,1028243
Moca,Census Tract,1,0.8264,100.0,28,7.0,8580.857080078125,5.7749,1
Moca,Postal Code,1,0.369,100.0,28,7.0,8580.857080078125,5.7749,1
Montana,Census Tract,118683,80.4173,72.2771,9189162,2297290.5,2711943864.901141,721128.5005,118421
Montana,Postal Code,118654,69.9287,74.8914,9181610,2295402.5,2709785572.9772882,720554.5926,118393
Nebraska,Census Tract,283467,93.4176,80.6201,21582607,5395651.75,6725165429.183444,3407555.4824,283257
Nebraska,Postal Code,283330,80.3729,86.881,21495882,5373970.5,6698087315.291831,3393835.3478,283121
Nevada,Census Tract,569461,98.1626,90.7952,43616656,10904164.0,17236108170.27167,6552267.6146,556715
Nevada,Postal Code,569104,80.3581,92.4156,43540016,10885004.0,17206349924.622555,6541464.5406,556366
New Hampshire,Census Tract,107103,82.6868,67.9416,9054358,2263589.5,2555251276.171985,1106392.3375,106841
New Hampshire,Postal Code,107012,50.1423,68.1437,9037409,2259352.25,2550456273.8240113,1104316.148,106750
New Jersey,Census Tract,1632773,124.2201,72.4928,117024321,29256080.25,34132296027.414562,21441825.259,1620118
New Jersey,Postal Code,1629714,88.2289,76.2982,116249897,29062474.25,33904852397.547024,21299363.2397,1617086
New Mexico,Census Tract,365962,90.1931,87.2656,29605361,7401340.25,12208818476.493713,5193766.8187,362213
New Mexico,Postal Code,365713,73.5622,90.6647,29552308,7388077.0,12187002098.50356,5184507.9049,361964
New York,Census Tract,2506035,87.0165,70.3824,158794563,39698640.75,45100394878.669464,21932730.052,2487240
New York,Postal Code,2502541,85.2767,77.4082,157857812,39464453.0,44831446454.66716,21798509.3084,2483797
North Carolina,Census Tract,1416843,111.0038,68.1828,124233257,31058314.25,39607264848.0049,23363984.2396,1413932
North Carolina,Postal Code,1416043,63.1941,76.8315,123962977,30990744.25,39519833527.20979,23311951.927,1413133
North Dakota,Census Tract,77129,88.5566,75.3666,8138951,2034737.75,2299032486.195364,1164890.4157,77105
North Dakota,Postal Code,77117,78.5321,80.688,8128226,2032056.5,2295970930.981845,1163339.1648,77093
Ohio,Census Tract,2194900,100.1958,76.2275,171901350,42975337.5,48300160986.35466,39985118.6948,2192055
Ohio,Postal Code,2192109,79.3352,82.3972,171022353,42755588.25,48048536615.677925,39776810.4632,2189269
Oklahoma,Census Tract,701280,90.5894,87.743,60560124,15140031.0,20218586198.69937,13676736.4824,700478
Oklahoma,Postal Code,700888,76.98,90.6883,60455902,15113975.5,20183717271.261906,13653148.5462,700086
Oregon,Census Tract,773130,92.0755,79.6266,61617355,15404338.75,16514535968.386444,4391352.901,764477
Oregon,Postal Code,772441,76.6703,85.5628,61510848,15377712.0,16486992928.991991,4384028.977,763794
Pennsylvania,Census Tract,1956097,92.6831,68.8571,133691622,33422905.5,38210009215.75753,25679219.8044,1951689
Pennsylvania,Postal Code,1954585,79.0697,79.5015,133004637,33251159.25,38013732231.37531,25546821.4854,1950183
Ponce,Census Tract,18091,91.5624,89.9396,1165041,291260.25,385731295.9626892,259596.6362,18091
Ponce,Postal Code,18706,87.8722,91.4487,1162806,290701.5,384801553.74663687,258970.9209,18706
Rhode Island,Census Tract,203167,91.7401,75.6977,13001474,3250368.5,3726814813.7138762,1613670.2388,202796
Rhode Island,Postal Code,202865,83.842,75.4781,12914100,3228525.0,3701710212.139731,1602800.1897,202494
San Juan,Census Tract,44341,361.16,90.2047,3375014,843753.5,1177674698.0644774,792573.4659,44341
San Juan,Postal Code,44665,98.2455,91.3301,3423143,855785.75,1195075494.090149,804284.1779,44665
South Carolina,Census Tract,908394,95.474,73.3968,79312131,19828032.75,25692275291.33939,15082325.9532,907128
South Carolina,Postal Code,907878,68.2991,80.0856,79183940,19795985.0,25650182524.80312,15057615.5421,906615
South Dakota,Census Tract,72867,82.7819,73.1301,6377373,1594343.25,1966083346.8824432,1047973.7957,72846
South Dakota,Postal Code,72847,52.4508,76.1648,6372371,1593092.75,1964549826.5415552,1047147.0385,72826
Tennessee,Census Tract,1105463,96.2296,76.2727,101762224,25440556.0,31169276299.068554,23662867.3964,1104151
Tennessee,Postal Code,1102947,74.4601,83.6595,101108289,25277072.25,30966907026.81165,23508638.5762,1101641
Texas,Census Tract,5480573,89.8634,83.6034,481747719,120436929.75,160458070556.08868,80026572.0962,5466434
Texas,Postal Code,5476777,81.3535,89.3493,480505530,120126382.5,160039623751.7003,79820466.3972,5462650
Toa Alta,Census Tract,1345,1710.7408,87.9579,73394,18348.5,25725431.5722229,17313.1804,1345
Toa Alta,Postal Code,1123,83.1899,89.3397,88675,22168.75,31279276.972485356,21050.9107,1123
Toa Baja,Census Tract,6517,108.025,90.5911,362967,90741.75,128650286.23981933,86581.4672,6517
Toa Baja,Postal Code,6976,96.8358,89.3901,371052,92763.0,131548735.53740233,88532.1196,6976
Trujillo Alto,Census Tract,2873,2040.5625,86.2239,197851,49462.75,69008952.58372192,46442.931,2873
Trujillo Alto,Postal Code,2854,93.47,88.8184,196126,49031.5,68412270.15056156,46041.3645,2854
Utah,Census Tract,573155,93.1267,84.2271,44105531,11026382.75,15249940379.663124,4055086.383,569989
Utah,Postal Code,572530,76.1622,85.9358,43988756,10997189.0,15209638303.221928,4044369.7246,569369
Vermont,Census Tract,19530,102.7981,68.8986,2012472,503118.0,551942863.0689392,238985.907,19399
Vermont,Postal Code,19504,79.3592,79.5995,1988764,497191.0,545353715.0415834,236132.8698,19373
Virginia,Census Tract,963792,90.9867,70.298,74914378,18728594.5,23169044381.25027,14570516.6127,961383
Virginia,Postal Code,963270,70.4411,77.4466,74735305,18683826.25,23113080773.399204,14534537.8188,960863
Washington,Census Tract,1511814,102.219,74.3927,107938035,26984508.75,27475803851.394146,7305348.1216,1506055
Washington,Postal Code,1510869,83.2164,84.04,107756625,26939156.25,27430232929.40039,7293347.1851,1505113
West Virginia,Census Tract,155047,134.7041,71.8114,11387665,2846916.25,3272165883.9079347,2708875.4834,154967
West Virginia,Postal Code,154869,66.8391,82.7115,11336559,2834139.75,3257389195.7982965,2696642.5437,154789
Wisconsin,Census Tract,900707,93.1937,74.5536,82459475,20614868.75,23542559983.903282,18538719.2118,898793
Wisconsin,Postal Code,900028,78.2139,80.0668,82263947,20565986.75,23486482672.1245,18493486.254,898115
Wyoming,Census Tract,53090,75.8881,78.6815,3848056,962014.0,1302268164.5376706,399567.8101,53061
Wyoming,Postal Code,53068,78.9686,78.7653,3843267,960816.75,1300665963.824701,399141.7715,53039


2025-01-27 06:31:20 - root - INFO - Please check the answer again by reviewing Can you provide a detailed comparison of the solar potential for each state, distinguishing between postal code and census tract levels? Include the number of buildings available for solar installations, the percentage covered by Project Sunroof, the percentage suitable for solar, total potential panel count, total kilowatt capacity, energy generation potential, carbon dioxide offset, and the gap in potential installations., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
State,Level,Number of Buildings Available for Solar Installations,Percentage Covered by Project Sunroof,Percentage Suitable for Solar,Total Potential Panel Count,Total Kilowatt Capacity,Energy Generation Potential,Carbon Dioxide Offset,Gap in Potential Installations
state_name:str,Postal Code,count_qualified:int,percent_covered:float[0-100],percent_qualified:float[0-100],number_of_panels_total:int,kw_total:float,yearly_sunlight_kwh_total:float,carbon_offset_metric_tons:float,gap_in_potential_installations:int
state_name:str,Census Tract,count_qualified:int,percent_covered:float[0-100],percent_qualified:float[0-100],number_of_panels_total:int,kw_total:float,yearly_sunlight_kwh_total:float,carbon_offset_metric_tons:float,gap_in_potential_installations:int
...
```

This table provides a detailed comparison of the solar potential for each state at both postal code and census tract levels. It includes key metrics such as the number of buildings available for solar installations, percentages covered by Project Sunroof and suitable for solar, total potential panel count, total kilowatt capacity, energy generation potential, carbon dioxide offset, and the gap in potential installations (calculated as the difference between the number of qualified buildings and existing installations). The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Too long, hard cut:
State,Level,Number of Buildings Available for Solar Installations,Percentage Covered by Project Sunroof,Percentage Suitable for Solar,Total Potential Panel Count,Total Kilowatt Capacity,Energy Generation Potential,Carbon Dioxide Offset,Gap in Potential Installations
Aguadilla,Census Tract,5852,95.939,89.843,432711,108177.75,160079112.7508179,107733.0246,5852
Aguadilla,Postal Code,5844,93.1553,94.3114,432049,108012.25,159844295.74992672,107574.9931,5844
Alabama,Census Tract,814213,118.1518,75.7065,77644088,19411022.0,24759196398.25475,15792877.1553,813666
Alabama,Postal Code,813312,65.3636,81.883,77298546,19324636.5,24646969095.845936,15723425.9345,812768
Alaska,Census Tract,57169,83.1343,67.3891,5462549,1365637.25,1092118868.9737976,449958.7974,57086
Alaska,Postal Code,57138,88.9663,78.0098,5447225,1361806.25,1089086633.2073152,448709.5001,57055
Arecibo,Census Tract,3962,239.5516,94.191,306604,76651.0,110110577.36539914,74104.2684,3962
Arecibo,Postal Code,4433,77.8753,93.4074,345214,86303.5,123956987.1142212,83422.8833,4433
Arizona,Census Tract,1754534,109.6458,90.4052,147450436,36862609.0,59127893265.42813,25393752.1209,1714808
Arizona,Postal Code,1753531,87.4686,93.8148,147238408,36809602.0,59043009935.297775,25357559.2992,1713835
Arkansas,Census Tract,370016,94.088,73.5761,36012747,9003186.75,11362387314.959013,7162306.2281,369777
Arkansas,Postal Code,369725,64.0318,80.533,35933867,8983466.75,11336956069.406748,7146339.2217,369486
Baja California,Postal Code,1,0.0674,20.0,23,5.75,8322.02979736328,0.0,1
Bayamón,Census Tract,33466,98.8687,90.5409,2134598,533649.5,751085531.8753113,505479.5388,33466
Bayamón,Postal Code,33260,97.3641,91.2841,2098880,524720.0,738592635.6176331,497071.8366,33260
Cabo Rojo,Census Tract,2,5.0,100.0,668,167.0,236279.58453979492,159.0158,2
California,Census Tract,8617901,93.222,84.4261,654784266,163696066.5,243304846869.2128,67060256.5599,8286083
California,Postal Code,8607224,89.7807,88.4105,652983168,163245792.0,242638396940.61917,66878632.2241,8275950
Canóvanas,Census Tract,2099,111.1123,82.9791,139475,34868.75,49976173.3744995,33633.8965,2099
Canóvanas,Postal Code,2182,66.3404,89.4262,160471,40117.75,57543460.70198363,38726.6706,2182
Carolina,Census Tract,19688,118.6116,91.9501,1554053,388513.25,553262399.3939757,372344.8404,19688
Carolina,Postal Code,19237,88.9531,93.4122,1481427,370356.75,527251268.02654415,354839.3844,19237
Cataño,Census Tract,2764,1977.1136,86.5736,168020,42005.0,59578578.59686889,40096.3022,2764
Cataño,Postal Code,2860,95.5526,91.1964,186311,46577.75,65981195.478601106,44405.2546,2860
Colorado,Census Tract,1032067,90.8059,80.5216,69425443,17356360.75,24667013678.519062,15019343.8016,1007705
Colorado,Postal Code,1031389,81.1294,83.0777,69150828,17287707.0,24570049923.14742,14960304.1466,1007054
Connecticut,Census Tract,608869,87.306,65.7534,43575214,10893803.5,12438466928.172298,5385610.0147,603585
Connecticut,Postal Code,607976,77.1033,72.2988,43269892,10817473.0,12350145123.452475,5347366.4436,602708
Corozal,Postal Code,15,1.2121,93.75,1667,416.75,587979.9845764162,395.7097,15
Delaware,Census Tract,147535,85.2779,71.135,10771425,2692856.25,3222438352.7232113,2047732.7107,147447
Delaware,Postal Code,147431,77.332,79.8785,10742839,2685709.75,3213827406.3591805,2042260.7933,147343
District of Columbia,Census Tract,76464,85.3173,63.3971,3983844,995961.0,1209717858.796045,768728.0745,76022
District of Columbia,Postal Code,76385,81.9633,75.1149,3937623,984405.75,1195714591.0355346,759829.5492,75943
Dorado,Census Tract,3067,133.8422,94.5521,199501,49875.25,70542741.78618774,47475.169,3067
Dorado,Postal Code,3064,78.2786,93.8438,199254,49813.5,70454673.23659058,47415.899,3064
Florida,Census Tract,4817871,99.6346,83.2794,463123814,115780953.5,157971622252.88788,84762071.9664,4712507
Florida,Postal Code,4814177,82.985,90.8502,462105732,115526433.0,157617914915.22406,84572912.4937,4708885
Georgia,Census Tract,1503687,96.5546,68.6019,140138439,35034609.75,44737933517.87483,26767856.4735,1501780
Georgia,Postal Code,1502091,72.027,76.484,139653741,34913435.25,44581060812.036766,26673519.942,1500185
Guaynabo,Census Tract,11603,111.2681,89.7714,984133,246033.25,342005084.6763794,230168.9556,11603
Guaynabo,Postal Code,12113,96.6907,88.4395,986943,246735.75,342637380.9947451,230594.4902,12113
Hatillo,Census Tract,224,38.8518,91.4723,25246,6311.5,9067192.223126221,6102.208,224
Hawaii,Census Tract,204390,92.4089,90.2883,19873246,4968311.5,7415195492.54585,4666457.0008,178998
Hawaii,Postal Code,204227,85.7732,94.9313,19835765,4958941.25,7400954705.809179,4657525.9105,178851
Hormigueros,Census Tract,1264,72.0382,91.178,59807,14951.75,21266625.235290524,14312.4098,1264
Hormigueros,Postal Code,1194,58.6907,91.8462,54608,13652.0,19401835.649896257,13057.4089,1194
Idaho,Census Tract,311878,84.4666,75.9108,23093899,5773474.75,7526956885.239657,2001480.636,311349
Idaho,Postal Code,311671,77.4462,85.8175,23026001,5756500.25,7504231760.321072,1995437.8357,311142
Illinois,Census Tract,2055456,91.6539,75.0704,164256874,41064218.5,47344747566.82309,39019478.6006,2053003
Illinois,Postal Code,2052522,81.5217,81.2255,163236997,40809249.25,47047851222.022064,38776748.3064,2050075
Indiana,Census Tract,1117000,102.8846,74.4163,93311273,23327818.25,26928123257.6459,22286009.0753,1116012
Indiana,Postal Code,1116413,72.7073,80.987,93048465,23262116.25,26851041383.54419,22222230.941,1115426
Iowa,Census Tract,350284,92.5024,67.5514,29953011,7488252.75,8843145869.399496,4480709.1374,350036
Iowa,Postal Code,350073,72.2617,78.46,29910958,7477739.5,8830596479.387411,4474350.5217,349825
Kansas,Census Tract,417333,89.9511,74.4584,36827430,9206857.5,11882464352.008951,8248164.1941,416595
Kansas,Postal Code,417118,78.0015,83.9098,36723960,9180990.0,11849160234.790615,8225046.2769,416381
Kentucky,Census Tract,575985,94.6227,80.7995,47393349,11848337.25,14048103923.893398,10893849.0274,575262
Kentucky,Postal Code,577255,75.3474,86.8544,47570216,11892554.0,14104070608.580994,10935523.8322,576530
Louisiana,Census Tract,865003,113.4494,82.1744,80308875,20077218.75,25885642034.581642,16119065.6327,856780
Louisiana,Postal Code,864431,74.024,85.776,80134650,20033662.5,25827876726.134464,16083222.6057,856210
Loíza,Census Tract,40,85.4839,75.4717,1693,423.25,595043.1626098631,400.4632,40
Maine,Census Tract,100065,85.243,65.1755,7720530,1930132.5,2197957054.097583,951467.7454,99705
Maine,Postal Code,99960,63.1011,63.6367,7689271,1922317.75,2189004685.142859,947591.4565,99600
Maryland,Census Tract,705813,80.0363,69.8131,47690643,11922660.75,14399236326.491217,9341908.1826,699742
Maryland,Postal Code,705396,71.1603,78.2144,47560886,11890221.5,14360334548.562885,9317029.141,699332
Massachusetts,Census Tract,1002203,87.2198,72.2894,69012277,17253069.25,19514148116.75344,8448829.9999,986834
Massachusetts,Postal Code,1000732,81.6985,73.9491,68609324,17152331.0,19399236401.382404,8399385.4282,985382
Mayagüez,Census Tract,7284,129.1771,88.3152,567212,141803.0,202552659.3214233,136317.6635,7284
Mayagüez,Postal Code,7348,93.569,91.3667,571212,142803.0,203989405.60508427,137284.5918,7348
Michigan,Census Tract,1847255,96.3166,72.8745,147876313,36969078.25,40976609871.52639,32170938.2644,1845535
Michigan,Postal Code,1846232,76.1111,79.0414,147391827,36847956.75,40840033399.2527,32063411.3893,1844515
Minnesota,Census Tract,770077,90.4283,64.555,65662303,16415575.75,18673751434.616875,9461269.6042,768559
Minnesota,Postal Code,769481,83.0701,72.0268,65464154,16366038.5,18617438249.156933,9432736.4319,767964
Mississippi,Census Tract,325095,110.3869,70.4745,32218920,8054730.0,10408673466.612555,6675246.3993,324739
Mississippi,Postal Code,324867,72.6311,82.1917,32127017,8031754.25,10378294594.571173,6657377.0432,324511
Missouri,Census Tract,1032104,89.1769,76.3367,84085928,21021482.0,26123174340.937077,20988770.9428,1029240
Missouri,Postal Code,1031097,80.3442,82.5577,83816328,20954082.0,26038971734.14675,20922455.4678,1028243
Moca,Census Tract,1,0.8264,100.0,28,7.0,8580.857080078125,5.7749,1
Moca,Postal Code,1,0.369,100.0,28,7.0,8580.857080078125,5.7749,1
Montana,Census Tract,118683,80.4173,72.2771,9189162,2297290.5,2711943864.901141,721128.5005,118421
Montana,Postal Code,118654,69.9287,74.8914,9181610,2295402.5,2709785572.9772882,720554.5926,118393
Nebraska,Census Tract,283467,93.4176,80.6201,21582607,5395651.75,6725165429.183444,3407555.4824,283257
Nebraska,Postal Code,283330,80.3729,86.881,21495882,5373970.5,6698087315.291831,3393835.3478,283121
Nevada,Census Tract,569461,98.1626,90.7952,43616656,10904164.0,17236108170.27167,6552267.6146,556715
Nevada,Postal Code,569104,80.3581,92.4156,43540016,10885004.0,17206349924.622555,6541464.5406,556366
New Hampshire,Census Tract,107103,82.6868,67.9416,9054358,2263589.5,2555251276.171985,1106392.3375,106841
New Hampshire,Postal Code,107012,50.1423,68.1437,9037409,2259352.25,2550456273.8240113,1104316.148,106750
New Jersey,Census Tract,1632773,124.2201,72.4928,117024321,29256080.25,34132296027.414562,21441825.259,1620118
New Jersey,Postal Code,1629714,88.2289,76.2982,116249897,29062474.25,33904852397.547024,21299363.2397,1617086
New Mexico,Census Tract,365962,90.1931,87.2656,29605361,7401340.25,12208818476.493713,5193766.8187,362213
New Mexico,Postal Code,365713,73.5622,90.6647,29552308,7388077.0,12187002098.50356,5184507.9049,361964
New York,Census Tract,2506035,87.0165,70.3824,158794563,39698640.75,45100394878.669464,21932730.052,2487240
New York,Postal Code,2502541,85.2767,77.4082,157857812,39464453.0,44831446454.66716,21798509.3084,2483797
North Carolina,Census Tract,1416843,111.0038,68.1828,124233257,31058314.25,39607264848.0049,23363984.2396,1413932
North Carolina,Postal Code,1416043,63.1941,76.8315,123962977,30990744.25,39519833527.20979,23311951.927,1413133
North Dakota,Census Tract,77129,88.5566,75.3666,8138951,2034737.75,2299032486.195364,1164890.4157,77105
North Dakota,Postal Code,77117,78.5321,80.688,8128226,2032056.5,2295970930.981845,1163339.1648,77093
Ohio,Census Tract,2194900,1
Current sql:
SELECT "state_name" AS "State",
       "Level",
       SUM("count_qualified") AS "Number of Buildings Available for Solar Installations",
       ROUND(AVG("percent_covered"), 4) AS "Percentage Covered by Project Sunroof",
       ROUND(AVG("percent_qualified"), 4) AS "Percentage Suitable for Solar",
       SUM("number_of_panels_total") AS "Total Potential Panel Count",
       SUM("kw_total") AS "Total Kilowatt Capacity",
       SUM("yearly_sunlight_kwh_total") AS "Energy Generation Potential",
       ROUND(SUM("carbon_offset_metric_tons"), 4) AS "Carbon Dioxide Offset",
       SUM("count_qualified") - SUM(COALESCE("existing_installs_count", 0)) AS "Gap in Potential Installations"
FROM (
  SELECT "state_name", "count_qualified", "percent_covered", "percent_qualified", "number_of_panels_total", "kw_total", "yearly_sunlight_kwh_total", "carbon_offset_metric_tons", "existing_installs_count", 'Postal Code' AS "Level"
  FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
  UNION ALL
  SELECT "state_name", "count_qualified", "percent_covered", "percent_qualified", "number_of_panels_total", "kw_total", "yearly_sunlight_kwh_total", "carbon_offset_metric_tons", "existing_installs_count", 'Census Tract' AS "Level"
  FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
) AS unioned_table
GROUP BY "state_name", "Level"
ORDER BY "state_name", "Level";
2025-01-27 06:31:56 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-27 06:31:56 - root - INFO - ```sql
SELECT "state_name" AS "State",
       "Level",
       SUM("count_qualified") AS "Number of Buildings Available for Solar Installations",
       ROUND(AVG("percent_covered"), 4) AS "Percentage Covered by Project Sunroof",
       ROUND(AVG("percent_qualified"), 4) AS "Percentage Suitable for Solar",
       SUM("number_of_panels_total") AS "Total Potential Panel Count",
       SUM("kw_total") AS "Total Kilowatt Capacity",
       SUM("yearly_sunlight_kwh_total") AS "Energy Generation Potential",
       ROUND(SUM("carbon_offset_metric_tons"), 4) AS "Carbon Dioxide Offset",
       SUM("count_qualified") - SUM(COALESCE("existing_installs_count", 0)) AS "Gap in Potential Installations"
FROM (
  SELECT "state_name", "count_qualified", "percent_covered", "percent_qualified", "number_of_panels_total", "kw_total", "yearly_sunlight_kwh_total", "carbon_offset_metric_tons", "existing_installs_count", 'Postal Code' AS "Level"
  FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_POSTAL_CODE
  UNION ALL
  SELECT "state_name", "count_qualified", "percent_covered", "percent_qualified", "number_of_panels_total", "kw_total", "yearly_sunlight_kwh_total", "carbon_offset_metric_tons", "existing_installs_count", 'Census Tract' AS "Level"
  FROM SUNROOF_SOLAR.SUNROOF_SOLAR.SOLAR_POTENTIAL_BY_CENSUSTRACT
) AS unioned_table
GROUP BY "state_name", "Level"
ORDER BY "state_name", "Level";
```
2025-01-27 06:31:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-27 06:31:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-27 06:31:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-27 06:31:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 139
2025-01-27 06:31:57 - snowflake.connector.connection - INFO - closed
2025-01-27 06:31:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-27 06:31:58 - root - INFO - itercount: 3
2025-01-27 06:31:58 - root - INFO - 0
2025-01-27 06:31:58 - root - INFO - Total iteration counts: 3
