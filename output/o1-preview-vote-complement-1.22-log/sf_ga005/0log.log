2025-01-24 15:24:18 - openai._base_client - INFO - Retrying request to /chat/completions in 0.403429 seconds
2025-01-24 15:25:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 15:25:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 15:25:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 15:25:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 15:25:11 - snowflake.connector.cursor - INFO - Number of results in first chunk: 31
2025-01-24 15:25:11 - snowflake.connector.connection - INFO - closed
2025-01-24 15:25:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 15:25:11 - root - INFO - SQL:
SELECT DISTINCT "event_name"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
   LIMIT 100;
Results:
event_name
os_update
screen_view
user_engagement
post_score
level_up
level_end
level_retry
level_start
level_complete
completed_5_levels
session_start
level_complete_quickplay
level_fail_quickplay
level_start_quickplay
level_reset_quickplay
level_end_quickplay
select_content
level_retry_quickplay
level_fail
no_more_extra_steps
level_reset
app_remove
app_exception
firebase_campaign
error
app_update
use_extra_steps
spend_virtual_currency
ad_reward
challenge_a_friend
first_open

2025-01-24 15:25:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 15:25:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 15:25:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 15:25:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 15:25:12 - snowflake.connector.connection - INFO - closed
2025-01-24 15:25:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 15:25:13 - root - INFO - SQL:
SELECT COUNT(DISTINCT "user_pseudo_id") AS "unique_users"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709";
Results:
unique_users
422

2025-01-24 15:25:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 15:25:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 15:25:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 15:25:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 15:25:14 - snowflake.connector.connection - INFO - closed
2025-01-24 15:25:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 15:25:15 - root - INFO - SQL:
SELECT "user_pseudo_id", MIN("event_timestamp") AS "first_event_timestamp"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
   GROUP BY "user_pseudo_id"
   LIMIT 100;
Results:
Too long, hard cut:
user_pseudo_id,first_event_timestamp
AE9C7A5E358F2E0E0E90E4B8DD67AE76,1531155691549000
6E018CE86D4601A362A9154B2500348A,1531157428290000
23183C7A7E31451194345099C978F49E,1531137357029000
3B7AC9CAE2D7BB661BE66F3DE36DD005,1531167020160007
9D535D543FD07B8247DEADB4669FADE6,1531154642604000
22DC6A6AE86C0AA33EBB8C3164A26925,1531176809772000
EF9E8CCCCBBB015CAE0C334AB1745417,1531146872262008
85FD06F19EBB6097388EEE0B207598B7,1531178637538003
EF9C32CA65880162136061B25D24E05E,1531199850329001
295D9E24D8DE65A010313E667131EF19,1531127681156012
9603F4B5ABFC1E48B0BF68C83669F845,1531160115950006
5256B2B115955E80DDB7449775D92325,1531167930018000
E0F91AA200D6F12DBE53B0D166AFD87B,1531171938815010
2F0F260BD7B876C346B41977D0D03D62,1531176060469004
71746D859E4E6D655FEE8FFBC3B6C7E9,1531152119531008
F26EC6056E284FDDEA7771F203B6BB8F,1531200602308002
980DEC5BA17132A841D7D7A140333114,1531154922017002
C6B7ED4E2FA4AABE5693A61B9A07753C,1531132840311011
C136A7CE1D0A52B8D4E5F144DF114EB7,1531124847080000
49309C5759610DBF6C829C0D4AB23943,1531134364922003
5F824D23AE3CF750894A96098818E789,1531148101985001
9F3EAF490630617EF2CB47A8BD2CBBCC,1531125104805015
0373DF7959F6867CDFB1C905D39CE67C,1531147110873010
5C5A0787542CD24F1E19F9EB778BA766,1531138134022003
4BF98D09CA8359FC59ADAF56D00338F8,1531171413710007
D7D49CC32C4A23AD56E8DEAE6878EC7B,1531187258493001
B4394AD77C6DE7A5C7385C307F35F84F,1531136486713001
3827BA312204EA6F6847DFA4222C90CC,1531173866154012
4500595CA1FC3CBC6140A502240FB7B4,1531150981943003
1F25763EC8BCAEC7FB069E81659A2153,1531164918477000
706C748E6D1E0768BFEFE6362B5D3F67,1531140264102007
D0F280B12652EB0D74F6BC74AB13606F,1531202650095005
4D084D38156128AAA060303AA91E689D,1531180716941005
E6FEE8B98E75EA5311FE004F98559A27,1531164805054000
48AB910A8DE8485D4C34238EA61F782C,1531146334964000
EAFD6F2604C8351032764E5F8B4D389E,1531175315280000
0E05F56141200FF41FCC0C7FA297FF08,1531137965556001
75C683C1AE98FC6CCE6EA156C9E90A35,1531148035325000
AB32482D193E2CE166B59F82EF78D8BB,1531174848290000
A29EBFE2A58D7C4D6FDA23C3A53742FF,1531163474130004
B56E67847E1AE8D6411A5ECCA26585CA,1531166430271005
693EB525C74694F2E6990CA738F5E5D5,1531170222377000
60ACC539CFC3DB94C60921D5572C3A4D,1531200715189000
9B27F8491DC5DA23D369F31250BD8D65,1531137160916010
84AFEFA3875BA1F17232CB41D06B6EF4,1531194546968010
2F5B044B41268F6643EB4D0EF15D4E87,1531127055296010
4BDC831A6940071E2461D0B5293A329E,1531178825151005
9038CCC5F7D7ABDA6E296D18FFDD1AAA,1531125748229001
FFFE80A7B9667187D501CE6037876955,1531139414494000
FEDC59699D8832A11B88BFCCCAD0951D,1531137968342000
7480AE90D76538F44A066A153F448198,1531161431605000
E4196C5E0A92A22F69DE4E3AA288D6EE,1531187717563007
6D4F9673F3DADCB39EE913EFCA2AE282,1531184588390005
359B5B95C8B1DF723D939A5A8AFF0904,1531180884940003
F3917138A3D4B03ADA1C2E77E3B84649,1531159529474000
932AAF56DDE9C55359B9CCFA18E7FB95,1531146996028001
01E32D5F696E088F968DFD847C2A68D8,1531161921650003
FD9223BA1689E43F814C545A5FEBA7F4,1531134241750003
35DDC37EB72373793E703516725BB2FE,1531167896390004
84690B86D5DA141638BAC264173308B2,1531150063220000
16B0F6645F896C16F83EF56A99868801,1531140289094006
B2ED849BBB2D152DF245B09A41687D4F,1531200531430002
D55D4E5B60368F4BE64F16EFD78B2BE7,1531193449379003
261F6186CC817A991565A91C4C92CAFA,1531152470542008
5217AB1A454DAED6243E1C9818BE6A20,1531132346468008
DB9F0F2561524A9EE1436805AAD70675,1531187101483002
E2B530ADD7430BEA6BC7F3D431C8A6FF,1531167678572001
945DE7C965AFB12E35C3C992CF9847E2,1531197662268002
77F5E9A5630151C9E831156AEAB4DA11,1531141560542005
F815B0069F973BFA743EF90A85224109,1531148843600005
3EF8FC940E379D53BBD3FEFDAF626BB2,1531205386511007
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
88A41BFED275BB69125BE1F5524F3B42,1531176732028004
331C58F19DE71B2DE30DDC47ECE5CCA6,1531176289240000
17515C32D8E535AA8A1B18BA774BB90C,1531163883338003
B275DC380CF75B352381D5419E397047,1531166353795002
037DAC225F0C1E54657770CD201CDDA7,1531135928712008
7566596A1D6ACA781692A7A0B89B06EF,1531165614535002
4CFD4E167957842AFC9C7A6A5FF78827,1531131430919003
A05ACB383D79E187B98B95E9C749C416,1531175163469004
29845B6298FB882DF53607D21F0E1DF7,1531162210094001
6B9CFFB3E0DE6FA0C47B8410C4467F89,1531136975599007
1B2FC37816CC4DDAACA97A75E685756F,1531174721711004
7537C0AA6291AC7B99DC4D2D695EEF1D,1531153723583000
59BE43F3FE7AB3F91B016B56508D4C46,1531156956424000
6DC90DD09DF860E7C60C00BF36906CB3,1531174966708008
A65FAEAB5577A16B517735A9D9C54958,1531142587680001
38DEEAB5F723A89A66CF180A175808D5,1531202060674005
C795AFA7F574C2BB09D3647AD90A9719,1531133001494002
84F5D9204EDAE98B3B542AEA93F40BED,1531136090264005
D7EA8E3645EFFBD6443946179ED704A6,1531140127676000
59454BAC415BB1F18517C6FD2C023E49,1531187434594004
017CF202552235BBA4338E0D82A53F43,1531201172661011
F19B8122771D0514F440E914B722656A,1531199264817005
B75F91EB6C7FDA9A329567E763CF9E44,1531182645737005
AB6FCC6558326ADC858DE37C8D9EB7CD,1531178051576001
EBFE0623EF1109A89B392B9DF4375951,1531179511995001
0B99B2EC1247C09535717331F816D42D,1531190817201001
2F5BBABE9DD0271DCD62E501F76DA736,1531171792388001
10522BF919A45

2025-01-24 15:25:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 15:25:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 15:25:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 15:25:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 15:25:16 - snowflake.connector.connection - INFO - closed
2025-01-24 15:25:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 15:25:43 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 15:25:43 - root - INFO - ```sql
SELECT DISTINCT f.value:"key"::STRING AS "user_property_key"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709" t,
LATERAL FLATTEN(input => t."user_properties") f
WHERE f.value:"key" IS NOT NULL
LIMIT 100;
```
2025-01-24 15:25:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 15:25:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 15:25:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 15:25:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 12
2025-01-24 15:25:45 - snowflake.connector.connection - INFO - closed
2025-01-24 15:25:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 15:27:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 15:27:13 - root - INFO - SQL:
SELECT DISTINCT f.value:"key"::STRING AS "user_property_key"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709" t,
LATERAL FLATTEN(input => t."user_properties") f
WHERE f.value:"key" IS NOT NULL
LIMIT 100;
Results:
user_property_key
initial_extra_steps
plays_quickplay
num_levels_available
firebase_exp_4
plays_progressive
firebase_exp_1
first_open_time
ad_frequency
firebase_exp_5
firebase_exp_3
_ltv_USD
firebase_last_notification

2025-01-24 15:27:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 15:27:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 15:27:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 15:27:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 36
2025-01-24 15:27:14 - snowflake.connector.connection - INFO - closed
2025-01-24 15:27:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 15:27:15 - root - INFO - SQL:
-- Corrected Query 1:
SELECT DISTINCT f.value:"key"::STRING AS "event_param_key"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709" t,
LATERAL FLATTEN(input => t."event_params") f
WHERE f.value:"key" IS NOT NULL
LIMIT 100
Results:
event_param_key
firebase_event_origin
previous_os_version
firebase_previous_id
firebase_screen_class
firebase_screen_id
firebase_previous_class
engagement_time_msec
time
score
level_name
value
item_name
virtual_currency_name
board
content_type
item_id
ad_event_id
ad_unit_code
fatal
timestamp
firebase_previous_screen
firebase_screen
medium
source
firebase_error
previous_app_version
update_with_analytics
system_app
level
firebase_conversion
type
click_timestamp
error_value
gclid
system_app_update
previous_first_open_count

2025-01-24 15:27:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 15:27:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 15:27:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 15:27:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-24 15:27:16 - snowflake.connector.connection - INFO - closed
2025-01-24 15:27:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 15:27:17 - root - INFO - SQL:
-- Corrected Query 2:
SELECT t."platform", COUNT(*) AS "event_count"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709" t
WHERE t."platform" IS NOT NULL AND t."platform" != ''
GROUP BY t."platform"
LIMIT 100
Results:
platform,event_count
ANDROID,37765
IOS,12235

2025-01-24 15:27:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 15:27:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 15:27:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 15:27:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 15:27:18 - snowflake.connector.connection - INFO - closed
2025-01-24 15:27:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 15:27:18 - root - INFO - SQL:
-- Corrected Query 3:
SELECT DISTINCT "user_pseudo_id", "platform"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
WHERE "platform" IS NOT NULL AND "platform" != ''
LIMIT 100
Results:
user_pseudo_id,platform
AE9C7A5E358F2E0E0E90E4B8DD67AE76,ANDROID
6E018CE86D4601A362A9154B2500348A,ANDROID
23183C7A7E31451194345099C978F49E,ANDROID
9D535D543FD07B8247DEADB4669FADE6,ANDROID
22DC6A6AE86C0AA33EBB8C3164A26925,ANDROID
EF9E8CCCCBBB015CAE0C334AB1745417,ANDROID
85FD06F19EBB6097388EEE0B207598B7,ANDROID
EF9C32CA65880162136061B25D24E05E,ANDROID
295D9E24D8DE65A010313E667131EF19,ANDROID
9603F4B5ABFC1E48B0BF68C83669F845,ANDROID
5217AB1A454DAED6243E1C9818BE6A20,ANDROID
2F0F260BD7B876C346B41977D0D03D62,ANDROID
DB9F0F2561524A9EE1436805AAD70675,ANDROID
E2B530ADD7430BEA6BC7F3D431C8A6FF,ANDROID
71746D859E4E6D655FEE8FFBC3B6C7E9,ANDROID
F26EC6056E284FDDEA7771F203B6BB8F,ANDROID
945DE7C965AFB12E35C3C992CF9847E2,ANDROID
980DEC5BA17132A841D7D7A140333114,ANDROID
0373DF7959F6867CDFB1C905D39CE67C,ANDROID
49309C5759610DBF6C829C0D4AB23943,ANDROID
C136A7CE1D0A52B8D4E5F144DF114EB7,ANDROID
9F3EAF490630617EF2CB47A8BD2CBBCC,ANDROID
5F824D23AE3CF750894A96098818E789,ANDROID
5C5A0787542CD24F1E19F9EB778BA766,ANDROID
4BF98D09CA8359FC59ADAF56D00338F8,ANDROID
60603343AB8FEECD78B1009C957D193D,ANDROID
4500595CA1FC3CBC6140A502240FB7B4,ANDROID
706C748E6D1E0768BFEFE6362B5D3F67,ANDROID
F815B0069F973BFA743EF90A85224109,ANDROID
D0F280B12652EB0D74F6BC74AB13606F,ANDROID
3EF8FC940E379D53BBD3FEFDAF626BB2,ANDROID
75C683C1AE98FC6CCE6EA156C9E90A35,ANDROID
8E6F7A428C907165D78A2377ABEB7315,ANDROID
7566596A1D6ACA781692A7A0B89B06EF,ANDROID
A05ACB383D79E187B98B95E9C749C416,ANDROID
693EB525C74694F2E6990CA738F5E5D5,ANDROID
60ACC539CFC3DB94C60921D5572C3A4D,ANDROID
9B27F8491DC5DA23D369F31250BD8D65,ANDROID
17515C32D8E535AA8A1B18BA774BB90C,ANDROID
23A7E8D987ADCC38EB026096DC513F85,ANDROID
2F5B044B41268F6643EB4D0EF15D4E87,ANDROID
29845B6298FB882DF53607D21F0E1DF7,ANDROID
331C58F19DE71B2DE30DDC47ECE5CCA6,ANDROID
85A84EA2A3017D368F41519312C6D3A2,ANDROID
037DAC225F0C1E54657770CD201CDDA7,ANDROID
59BE43F3FE7AB3F91B016B56508D4C46,ANDROID
6DC90DD09DF860E7C60C00BF36906CB3,ANDROID
FFFE80A7B9667187D501CE6037876955,ANDROID
A65FAEAB5577A16B517735A9D9C54958,ANDROID
7D613AF4DA0F508C7090E96FD73B7E6D,ANDROID
38DEEAB5F723A89A66CF180A175808D5,ANDROID
FEDC59699D8832A11B88BFCCCAD0951D,ANDROID
59454BAC415BB1F18517C6FD2C023E49,ANDROID
7480AE90D76538F44A066A153F448198,ANDROID
8EDB9A9856CDB5AFC42546106EE46734,ANDROID
0B99B2EC1247C09535717331F816D42D,ANDROID
2F5BBABE9DD0271DCD62E501F76DA736,ANDROID
3B7AC9CAE2D7BB661BE66F3DE36DD005,ANDROID
5256B2B115955E80DDB7449775D92325,ANDROID
E0F91AA200D6F12DBE53B0D166AFD87B,ANDROID
0160043392B1572A375E5C3BE1BB0C31,ANDROID
C6B7ED4E2FA4AABE5693A61B9A07753C,ANDROID
77F5E9A5630151C9E831156AEAB4DA11,ANDROID
D7D49CC32C4A23AD56E8DEAE6878EC7B,ANDROID
B4394AD77C6DE7A5C7385C307F35F84F,ANDROID
3827BA312204EA6F6847DFA4222C90CC,ANDROID
1F25763EC8BCAEC7FB069E81659A2153,ANDROID
4D084D38156128AAA060303AA91E689D,ANDROID
E6FEE8B98E75EA5311FE004F98559A27,ANDROID
48AB910A8DE8485D4C34238EA61F782C,ANDROID
0E05F56141200FF41FCC0C7FA297FF08,ANDROID
AB32482D193E2CE166B59F82EF78D8BB,ANDROID
A29EBFE2A58D7C4D6FDA23C3A53742FF,ANDROID
4CFD4E167957842AFC9C7A6A5FF78827,ANDROID
B56E67847E1AE8D6411A5ECCA26585CA,ANDROID
8D31836A6C3C14CE71056BED8925F0A4,ANDROID
D5F9D9AF22EF5073E10342973D48FB2C,ANDROID
B275DC380CF75B352381D5419E397047,ANDROID
1B2FC37816CC4DDAACA97A75E685756F,ANDROID
6B9CFFB3E0DE6FA0C47B8410C4467F89,ANDROID
05F7B2C58D627CE948B06C10E39CDF91,ANDROID
88A41BFED275BB69125BE1F5524F3B42,ANDROID
7F2B633C86B765201C93FDB6FF261143,ANDROID
4BDC831A6940071E2461D0B5293A329E,ANDROID
9038CCC5F7D7ABDA6E296D18FFDD1AAA,ANDROID
84F5D9204EDAE98B3B542AEA93F40BED,ANDROID
F19B8122771D0514F440E914B722656A,ANDROID
B75F91EB6C7FDA9A329567E763CF9E44,ANDROID
AB6FCC6558326ADC858DE37C8D9EB7CD,ANDROID
EBFE0623EF1109A89B392B9DF4375951,ANDROID
E4196C5E0A92A22F69DE4E3AA288D6EE,ANDROID
CA04708DA02378999ECB402481FF1AE4,ANDROID
EAFD6F2604C8351032764E5F8B4D389E,ANDROID
84AFEFA3875BA1F17232CB41D06B6EF4,ANDROID
7537C0AA6291AC7B99DC4D2D695EEF1D,ANDROID
FEC117631F54C2699CB76603EBB98CF0,ANDROID
D7EA8E3645EFFBD6443946179ED704A6,ANDROID
017CF202552235BBA4338E0D82A53F43,ANDROID
10522BF919A454B898540F51FFDCB292,ANDROID
C795AFA7F574C2BB09D3647AD90A9719,ANDROID

2025-01-24 15:27:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 15:27:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 15:27:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 15:27:20 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 15:27:20 - snowflake.connector.connection - INFO - closed
2025-01-24 15:27:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 15:27:20 - root - INFO - SQL:
-- Corrected Query 4:
SELECT "user_pseudo_id", COUNT(*) AS "event_count"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
WHERE "user_pseudo_id" IS NOT NULL
GROUP BY "user_pseudo_id"
LIMIT 100
Results:
user_pseudo_id,event_count
AE9C7A5E358F2E0E0E90E4B8DD67AE76,4
6E018CE86D4601A362A9154B2500348A,89
23183C7A7E31451194345099C978F49E,4
3B7AC9CAE2D7BB661BE66F3DE36DD005,66
9D535D543FD07B8247DEADB4669FADE6,161
22DC6A6AE86C0AA33EBB8C3164A26925,632
EF9E8CCCCBBB015CAE0C334AB1745417,58
85FD06F19EBB6097388EEE0B207598B7,221
295D9E24D8DE65A010313E667131EF19,349
9603F4B5ABFC1E48B0BF68C83669F845,65
5217AB1A454DAED6243E1C9818BE6A20,538
5256B2B115955E80DDB7449775D92325,114
E0F91AA200D6F12DBE53B0D166AFD87B,56
2F0F260BD7B876C346B41977D0D03D62,113
DB9F0F2561524A9EE1436805AAD70675,31
E2B530ADD7430BEA6BC7F3D431C8A6FF,11
71746D859E4E6D655FEE8FFBC3B6C7E9,28
980DEC5BA17132A841D7D7A140333114,31
C6B7ED4E2FA4AABE5693A61B9A07753C,516
77F5E9A5630151C9E831156AEAB4DA11,27
49309C5759610DBF6C829C0D4AB23943,33
9F3EAF490630617EF2CB47A8BD2CBBCC,558
4BF98D09CA8359FC59ADAF56D00338F8,57
D7D49CC32C4A23AD56E8DEAE6878EC7B,31
4500595CA1FC3CBC6140A502240FB7B4,56
1F25763EC8BCAEC7FB069E81659A2153,44
706C748E6D1E0768BFEFE6362B5D3F67,80
F815B0069F973BFA743EF90A85224109,15
05F7B2C58D627CE948B06C10E39CDF91,73
3EF8FC940E379D53BBD3FEFDAF626BB2,8
E6FEE8B98E75EA5311FE004F98559A27,219
AB32482D193E2CE166B59F82EF78D8BB,45
B56E67847E1AE8D6411A5ECCA26585CA,23
29845B6298FB882DF53607D21F0E1DF7,33
9B27F8491DC5DA23D369F31250BD8D65,276
17515C32D8E535AA8A1B18BA774BB90C,184
85A84EA2A3017D368F41519312C6D3A2,4
037DAC225F0C1E54657770CD201CDDA7,51
4BDC831A6940071E2461D0B5293A329E,68
84AFEFA3875BA1F17232CB41D06B6EF4,23
6B9CFFB3E0DE6FA0C47B8410C4467F89,84
59BE43F3FE7AB3F91B016B56508D4C46,21
FFFE80A7B9667187D501CE6037876955,67
A65FAEAB5577A16B517735A9D9C54958,28
84F5D9204EDAE98B3B542AEA93F40BED,150
D7EA8E3645EFFBD6443946179ED704A6,109
F19B8122771D0514F440E914B722656A,10
8BE7BF90C971453A34C1FF6FF2A0ACAE,903
AB6FCC6558326ADC858DE37C8D9EB7CD,3
EBFE0623EF1109A89B392B9DF4375951,881
CA04708DA02378999ECB402481FF1AE4,102
CE7404D5A8831F2DE46BD0A013A8ED64,47
38C93052B6B68913A433591107F8662C,4
9CD32E150A48D09944338963BBE1EA18,109
B75FCD833DE643B45B326D2E7AC413E4,18
ADDE80C89BB3F6190538E50E541BACD5,19
2920B9D90561E521425DE4849FAAD1D7,1
B7E6580376A092AF1D8ED36A96EEF943,1
74375465CD17299EBC7C75A1B4047EE0,680
EE07F52A618BA7AACDCD6712B01F945A,255
B5395F8C2077B59B3D6C5719C0CA0339,162
F8EBD8316C0FAA906D1335B3D2C04C83,148
EBC3581ADA874D494FBE2C7CCF53BF99,58
27DCDEB27C0798022EEA48EBAB89D43B,186
EF9C32CA65880162136061B25D24E05E,193
F26EC6056E284FDDEA7771F203B6BB8F,29
945DE7C965AFB12E35C3C992CF9847E2,88
0160043392B1572A375E5C3BE1BB0C31,208
C136A7CE1D0A52B8D4E5F144DF114EB7,30
5F824D23AE3CF750894A96098818E789,21
5C5A0787542CD24F1E19F9EB778BA766,24
60603343AB8FEECD78B1009C957D193D,44
23A7E8D987ADCC38EB026096DC513F85,12
B4394AD77C6DE7A5C7385C307F35F84F,5
D0F280B12652EB0D74F6BC74AB13606F,6
48AB910A8DE8485D4C34238EA61F782C,737
EAFD6F2604C8351032764E5F8B4D389E,1
75C683C1AE98FC6CCE6EA156C9E90A35,4
88A41BFED275BB69125BE1F5524F3B42,50
8D31836A6C3C14CE71056BED8925F0A4,43
D5F9D9AF22EF5073E10342973D48FB2C,21
7566596A1D6ACA781692A7A0B89B06EF,35
A05ACB383D79E187B98B95E9C749C416,299
693EB525C74694F2E6990CA738F5E5D5,3
7F2B633C86B765201C93FDB6FF261143,25
331C58F19DE71B2DE30DDC47ECE5CCA6,1
B275DC380CF75B352381D5419E397047,64
7537C0AA6291AC7B99DC4D2D695EEF1D,358
9038CCC5F7D7ABDA6E296D18FFDD1AAA,243
6DC90DD09DF860E7C60C00BF36906CB3,63
7D613AF4DA0F508C7090E96FD73B7E6D,3
FEC117631F54C2699CB76603EBB98CF0,66
C795AFA7F574C2BB09D3647AD90A9719,51
FEDC59699D8832A11B88BFCCCAD0951D,25
017CF202552235BBA4338E0D82A53F43,47
B75F91EB6C7FDA9A329567E763CF9E44,120
8EDB9A9856CDB5AFC42546106EE46734,51
0B99B2EC1247C09535717331F816D42D,189
E4196C5E0A92A22F69DE4E3AA288D6EE,53
2F5BBABE9DD0271DCD62E501F76DA736,56

2025-01-24 15:27:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 15:27:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 15:27:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 15:27:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 15:27:22 - snowflake.connector.connection - INFO - closed
2025-01-24 15:27:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 15:27:22 - root - INFO - SQL:
-- Corrected Query 5:
SELECT "event_date", COUNT(*) AS "event_count"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
WHERE "event_date" IS NOT NULL
GROUP BY "event_date"
LIMIT 100
Results:
event_date,event_count
20180709,50000

2025-01-24 15:27:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 15:27:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 15:27:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 15:27:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 15:27:24 - snowflake.connector.connection - INFO - closed
2025-01-24 15:27:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 15:27:25 - root - INFO - SQL:
-- Corrected Query 6:
SELECT DISTINCT "user_pseudo_id"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
WHERE "user_pseudo_id" IS NOT NULL AND "user_pseudo_id" IN (
  SELECT DISTINCT "user_pseudo_id"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
  WHERE "user_pseudo_id" IS NOT NULL
)
LIMIT 100
Results:
user_pseudo_id
1CF315BC6864E7A71A81E47925E18A61
01B358175084B5B44F1C83C2A42FE33A
5217AB1A454DAED6243E1C9818BE6A20
CA51DAF1373B5C2A16C174AFBD2132A4
7566596A1D6ACA781692A7A0B89B06EF
EB1A430BACB37E6EA72592BF838E64A6
B141B75E5E5D48DAD8298F91B94A2E07
1B2A9E461E99FB1D165894AFE613AD73
472451071AED6FF801BC0FE66706FD27
1213ED1E96B0A49B51C0F7683DB2ACCC
9B18A1CBA96D52D05CFA7CB7C9011EDE
D924713CB1AF85AED83BC394B164B9DC
D9FEC4E4418413FCE771B203FD7D48D2
A0616D4E494DC3BCCB94B8B6E5B48380
3C58946C3178392A69D292F2F5A862E3
D8A6BDFA89F65FC9B5159A3031C33004
D5F9D9AF22EF5073E10342973D48FB2C
932AAF56DDE9C55359B9CCFA18E7FB95
D842320AECB686B41C2F8E8876794D34
4EF1041DB2A406750E4A46AFD78FB543
0CAAA1B6F161BA4D363EB7A2DEF64A08
B5F3D00E28A57C9522F2DEE3CB903DD1
D7EA8E3645EFFBD6443946179ED704A6
C80CEE0983AB5B21D3F4B46089FDD9EB
E84BFE62196E059C66D049BA9A14061C
620DA7A49F07368EBCB917DB113BCEDC
F815B0069F973BFA743EF90A85224109
B63075B53A750A67A12F7F19ED5AA835
C7E2273D8B11257FCCC915D27C1FCA24
EECDCA8076D5842922767F5C08957B17
3B4A6FCA6DCB4C2749409DC4188A306E
C639CACA07D03F536F537ED779CF6599
2B7787A34C362AA51FF8E4DD031A2F70
8BD465AC77DC9D8B4C597BF35950FDA3
89BD2B0E233951461CF06C9B4FDA0D81
EEBCB25D5F056CCF59DDE654388ACD2B
4AB0441290F6077849CBE9C74A828F0A
7386D239899D55E3D62DA619F359A7C0
CA04708DA02378999ECB402481FF1AE4
004D2DFEB866BFB00427DB2F530C1F3D
0C777BD44F304574371C97674DCD0702
8EDB9A9856CDB5AFC42546106EE46734
BE36C49B1AB3968D420923AEC4FDD7AE
7E38A396789F21724DDEFB0400305685
DB9D0368B6DC1CD2E03CDDBE7060DE31
9D535D543FD07B8247DEADB4669FADE6
4BDC831A6940071E2461D0B5293A329E
7EE035CA8E6132A8877C39656896BA41
A2B7DF97E146FC5AB4C8F89A94D85B4A
B458770ED6E295374FEEB3A68902CC28
788B593C9AFEBAEE6374CDA08F16FAC6
84E491A60BE52A4C6A438A89FADE283C
F5DAD8DD17B689CF672D65A0A81CF4AC
1F0D27B8A7E058446D4A6409E2E73B19
A65FAEAB5577A16B517735A9D9C54958
465B5DC1BA69633FE49EFA52F08CBB40
75C683C1AE98FC6CCE6EA156C9E90A35
E4196C5E0A92A22F69DE4E3AA288D6EE
8211CABE9A3F1FE1BF3154E0C8D30368
DA48D36D07835B1918BDF831AF83B5EF
5B888A06EFF60B86B10367EEC3B44E85
3D1B58553D2E2D4DD5DFCF251D5E23B2
5269565AB96D3D27ADEA4D7EF4DC2A88
0D791C00AF304C3BDDA26EF979A320C8
FEDC59699D8832A11B88BFCCCAD0951D
48AB910A8DE8485D4C34238EA61F782C
EBE661044C1949546986A852F35083A1
5CC434A43CB09640FC6BE2D7A18183E4
05FB3382D94C7E963B408FD6CC357D33
2B90CE94C6039DF03E72FE15B5320ABA
44A600997B9B6499325D518A19B51FEC
4500595CA1FC3CBC6140A502240FB7B4
E512079B53179DF9A608CF4ADE47DE9D
F91F493916395FE4E16DE98B24388985
03A9D32C44665A9E15CFCCEDC9F68EDB
D4F4DAEF5BE38E5C67FD72BB1F082EBF
3875A92B5F5C2BBA1355CED06A986079
9603F4B5ABFC1E48B0BF68C83669F845
225638B28A80341EEB04F1DFC144F30E
DB3B6E984B29883EA02F1A504A33730F
BBDCBE2491658165B7F20540DE652E3A
CABE7E24215A5C36862658A36AE5CE12
359B5B95C8B1DF723D939A5A8AFF0904
0E05F56141200FF41FCC0C7FA297FF08
037DAC225F0C1E54657770CD201CDDA7
12E5626928FE0885DEEF068683E8BD63
E2B530ADD7430BEA6BC7F3D431C8A6FF
8C7A0CAF2B29D568268B8D331E37ABF6
9DB59A6220E6D63AE53FD08FDDB59602
B5395F8C2077B59B3D6C5719C0CA0339
011A541DBC3D5ADB8450B051AC69A304
56E8EC9522573BD1BAD8E18AD2E33C9A
60603343AB8FEECD78B1009C957D193D
F3917138A3D4B03ADA1C2E77E3B84649
E6FEE8B98E75EA5311FE004F98559A27
74375465CD17299EBC7C75A1B4047EE0
85DB15BDADAB65F9CC1E33B872745B87
018F03084C88E944163F76A0D0C2FBA1
81BFFE61CAB181676917D75F1B617CB2
A74C05E503F6274BAA9457B2265471F5

2025-01-24 15:27:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 15:27:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 15:27:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 15:27:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 15:27:26 - snowflake.connector.connection - INFO - closed
2025-01-24 15:27:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 15:27:26 - root - INFO - SQL:
-- Corrected Query 7:
SELECT "user_pseudo_id", MIN("user_first_touch_timestamp") AS "first_touch_timestamp"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
WHERE "user_first_touch_timestamp" IS NOT NULL
GROUP BY "user_pseudo_id"
LIMIT 100
Results:
Too long, hard cut:
user_pseudo_id,first_touch_timestamp
AE9C7A5E358F2E0E0E90E4B8DD67AE76,1511766099520000
6E018CE86D4601A362A9154B2500348A,1506441128896000
23183C7A7E31451194345099C978F49E,1502291041184000
3B7AC9CAE2D7BB661BE66F3DE36DD005,1465054465301000
9D535D543FD07B8247DEADB4669FADE6,1464575838196000
22DC6A6AE86C0AA33EBB8C3164A26925,1530830330452000
EF9E8CCCCBBB015CAE0C334AB1745417,1529447876425000
85FD06F19EBB6097388EEE0B207598B7,1528677782238000
295D9E24D8DE65A010313E667131EF19,1531061434675000
9603F4B5ABFC1E48B0BF68C83669F845,1466462024189000
5217AB1A454DAED6243E1C9818BE6A20,1529861553949000
5256B2B115955E80DDB7449775D92325,1530995925757000
E0F91AA200D6F12DBE53B0D166AFD87B,1464425504029000
2F0F260BD7B876C346B41977D0D03D62,1467727817981000
DB9F0F2561524A9EE1436805AAD70675,1521413652498000
E2B530ADD7430BEA6BC7F3D431C8A6FF,1468606445788000
71746D859E4E6D655FEE8FFBC3B6C7E9,1484337748369000
980DEC5BA17132A841D7D7A140333114,1470347282362000
C6B7ED4E2FA4AABE5693A61B9A07753C,1531116497039000
77F5E9A5630151C9E831156AEAB4DA11,1468227579086000
49309C5759610DBF6C829C0D4AB23943,1472075042638000
9F3EAF490630617EF2CB47A8BD2CBBCC,1519485771522000
4BF98D09CA8359FC59ADAF56D00338F8,1526162138359000
D7D49CC32C4A23AD56E8DEAE6878EC7B,1530569048608000
4500595CA1FC3CBC6140A502240FB7B4,1525659098090000
1F25763EC8BCAEC7FB069E81659A2153,1507765625642000
706C748E6D1E0768BFEFE6362B5D3F67,1475151487594000
F815B0069F973BFA743EF90A85224109,1472922491594000
05F7B2C58D627CE948B06C10E39CDF91,1521087932799000
3EF8FC940E379D53BBD3FEFDAF626BB2,1528354153183000
E6FEE8B98E75EA5311FE004F98559A27,1521946646783000
AB32482D193E2CE166B59F82EF78D8BB,1465058160030000
B56E67847E1AE8D6411A5ECCA26585CA,1464515176979000
29845B6298FB882DF53607D21F0E1DF7,1526399609287000
9B27F8491DC5DA23D369F31250BD8D65,1530735588689000
17515C32D8E535AA8A1B18BA774BB90C,1464825069019000
85A84EA2A3017D368F41519312C6D3A2,1491040698768000
037DAC225F0C1E54657770CD201CDDA7,1493351752752000
4BDC831A6940071E2461D0B5293A329E,1488508268636000
84AFEFA3875BA1F17232CB41D06B6EF4,1501958646395000
6B9CFFB3E0DE6FA0C47B8410C4467F89,1517118728976000
59BE43F3FE7AB3F91B016B56508D4C46,1510253570533000
FFFE80A7B9667187D501CE6037876955,1502035332858000
A65FAEAB5577A16B517735A9D9C54958,1518749282042000
84F5D9204EDAE98B3B542AEA93F40BED,1531113646084000
D7EA8E3645EFFBD6443946179ED704A6,1484917445540000
F19B8122771D0514F440E914B722656A,1527565190179000
8BE7BF90C971453A34C1FF6FF2A0ACAE,1531082409656000
AB6FCC6558326ADC858DE37C8D9EB7CD,1492297822381000
EBFE0623EF1109A89B392B9DF4375951,1464524001165000
CA04708DA02378999ECB402481FF1AE4,1465775049218000
CE7404D5A8831F2DE46BD0A013A8ED64,1476102386762000
38C93052B6B68913A433591107F8662C,1513017212873000
9CD32E150A48D09944338963BBE1EA18,1531173893427000
B75FCD833DE643B45B326D2E7AC413E4,1529613021075000
ADDE80C89BB3F6190538E50E541BACD5,1513447410035000
2920B9D90561E521425DE4849FAAD1D7,1530616959546000
B7E6580376A092AF1D8ED36A96EEF943,1522050040217000
74375465CD17299EBC7C75A1B4047EE0,1464513671511000
EE07F52A618BA7AACDCD6712B01F945A,1531162130796000
B5395F8C2077B59B3D6C5719C0CA0339,1470997457644000
F8EBD8316C0FAA906D1335B3D2C04C83,1531126776662000
EBC3581ADA874D494FBE2C7CCF53BF99,1501257623221000
27DCDEB27C0798022EEA48EBAB89D43B,1523706758575000
EF9C32CA65880162136061B25D24E05E,1471062716915000
F26EC6056E284FDDEA7771F203B6BB8F,1480993040678000
945DE7C965AFB12E35C3C992CF9847E2,1526128911909000
0160043392B1572A375E5C3BE1BB0C31,1531045587866000
C136A7CE1D0A52B8D4E5F144DF114EB7,1465988331737000
5F824D23AE3CF750894A96098818E789,1464642394648000
5C5A0787542CD24F1E19F9EB778BA766,1473421832439000
60603343AB8FEECD78B1009C957D193D,1464708615777000
23A7E8D987ADCC38EB026096DC513F85,1469428476961000
B4394AD77C6DE7A5C7385C307F35F84F,1520634662709000
D0F280B12652EB0D74F6BC74AB13606F,1529344858634000
48AB910A8DE8485D4C34238EA61F782C,1507142733492000
EAFD6F2604C8351032764E5F8B4D389E,1493169854516000
75C683C1AE98FC6CCE6EA156C9E90A35,1530862552265000
88A41BFED275BB69125BE1F5524F3B42,1504797808179000
8D31836A6C3C14CE71056BED8925F0A4,1526410365873000
D5F9D9AF22EF5073E10342973D48FB2C,1465200081915000
7566596A1D6ACA781692A7A0B89B06EF,1516571320702000
A05ACB383D79E187B98B95E9C749C416,1531175192147000
693EB525C74694F2E6990CA738F5E5D5,1529538447357000
7F2B633C86B765201C93FDB6FF261143,1531113427644000
331C58F19DE71B2DE30DDC47ECE5CCA6,1529077736411000
B275DC380CF75B352381D5419E397047,1490038870683000
7537C0AA6291AC7B99DC4D2D695EEF1D,1531077611184000
9038CCC5F7D7ABDA6E296D18FFDD1AAA,1519756432112000
6DC90DD09DF860E7C60C00BF36906CB3,1531060349402000
7D613AF4DA0F508C7090E96FD73B7E6D,1464986660111000
FEC117631F54C2699CB76603EBB98CF0,1498005692687000
C795AFA7F574C2BB09D3647AD90A9719,1491444275215000
FEDC59699D8832A11B88BFCCCAD0951D,1494940564484000
017CF202552235BBA4338E0D82A53F43,1465053558350000
B75F91EB6C7FDA9A329567E763CF9E44,1526861938371000
8EDB9A9856CDB5AFC42546106EE46734,1484623632344000
0B99B2EC1247C09535717331F816D42D,1493684508941000
E4196C5E0A92A22F69DE4E3AA288D6EE,1465355988802000
2F5BBABE9DD02

2025-01-24 15:27:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 15:27:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 15:27:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 15:27:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 15:27:28 - snowflake.connector.connection - INFO - closed
2025-01-24 15:27:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 15:27:28 - root - INFO - SQL:
-- Corrected Query 8:
SELECT "event_date", COUNT(DISTINCT "user_pseudo_id") AS "new_users"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
WHERE "event_date" IS NOT NULL AND "user_pseudo_id" IS NOT NULL
GROUP BY "event_date"
LIMIT 100
Results:
event_date,new_users
20180709,422

2025-01-24 15:27:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 15:27:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 15:27:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 15:27:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-24 15:27:29 - snowflake.connector.connection - INFO - closed
2025-01-24 15:27:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 15:27:30 - root - INFO - SQL:
-- Corrected Query 9:
SELECT "user_pseudo_id", COUNT(*) AS "event_count"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
WHERE "user_pseudo_id" IS NOT NULL
GROUP BY "user_pseudo_id"
ORDER BY "event_count" DESC
LIMIT 10
Results:
user_pseudo_id,event_count
CC88655DF7CDE5E8225BA20B5D6EC59B,1704
C6DE585349744A40725DB0AB17041BA3,1455
10B0D468B5E036E16D13DB53A65F2D49,1234
B63075B53A750A67A12F7F19ED5AA835,1173
3BBC4DD5C8CA9027CECBEA5C39F80E3A,1049
BE74418BE7B7466F6FE2969CA79FA919,979
0E05F56141200FF41FCC0C7FA297FF08,977
2C84CF723999D48F8F069AFFC184C4DC,949
8040FC9C0479C3B9A74ED298DD8F357D,912
8BE7BF90C971453A34C1FF6FF2A0ACAE,903

2025-01-24 15:27:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 15:27:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 15:27:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 15:27:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-24 15:27:31 - snowflake.connector.connection - INFO - closed
2025-01-24 15:27:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 15:27:59 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 15:27:59 - root - INFO - ```sql
SELECT "user_pseudo_id", COUNT(*) AS "event_count"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
GROUP BY "user_pseudo_id"
ORDER BY "event_count" DESC
LIMIT 10;
```
2025-01-24 15:27:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 15:27:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 15:27:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 15:28:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-24 15:28:01 - snowflake.connector.connection - INFO - closed
2025-01-24 15:28:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 15:28:50 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 15:28:50 - root - INFO - SQL:
SELECT "user_pseudo_id", COUNT(*) AS "event_count"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
GROUP BY "user_pseudo_id"
ORDER BY "event_count" DESC
LIMIT 10;
Results:
user_pseudo_id,event_count
CC88655DF7CDE5E8225BA20B5D6EC59B,1704
C6DE585349744A40725DB0AB17041BA3,1455
10B0D468B5E036E16D13DB53A65F2D49,1234
B63075B53A750A67A12F7F19ED5AA835,1173
3BBC4DD5C8CA9027CECBEA5C39F80E3A,1049
BE74418BE7B7466F6FE2969CA79FA919,979
0E05F56141200FF41FCC0C7FA297FF08,977
2C84CF723999D48F8F069AFFC184C4DC,949
8040FC9C0479C3B9A74ED298DD8F357D,912
8BE7BF90C971453A34C1FF6FF2A0ACAE,903

2025-01-24 15:28:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 15:28:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 15:28:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 15:28:51 - snowflake.connector.cursor - INFO - Number of results in first chunk: 31
2025-01-24 15:28:51 - snowflake.connector.connection - INFO - closed
2025-01-24 15:28:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 15:28:52 - root - INFO - SQL:
-- Corrected Query 11:
SELECT "event_name", COUNT(*) AS "event_count"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
GROUP BY "event_name"
ORDER BY "event_count" DESC
LIMIT 100
Results:
event_name,event_count
screen_view,19976
user_engagement,11827
level_start_quickplay,4445
level_end_quickplay,2964
post_score,2190
level_complete_quickplay,1853
level_fail_quickplay,1111
select_content,1056
level_reset_quickplay,855
level_start,642
session_start,580
level_end,488
level_retry,439
level_up,337
level_complete,318
level_retry_quickplay,269
level_fail,151
spend_virtual_currency,98
level_reset,89
use_extra_steps,88
firebase_campaign,54
first_open,34
app_exception,28
os_update,23
no_more_extra_steps,23
app_remove,18
completed_5_levels,16
ad_reward,12
app_update,7
challenge_a_friend,5
error,4

2025-01-24 15:28:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 15:28:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 15:28:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 15:28:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-24 15:28:53 - snowflake.connector.connection - INFO - closed
2025-01-24 15:28:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 15:28:54 - root - INFO - SQL:
-- Corrected Query 12:
SELECT DISTINCT t."platform"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709" t
WHERE t."platform" IS NOT NULL AND t."platform" != ''
LIMIT 100
Results:
platform
ANDROID
IOS

2025-01-24 15:28:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 15:28:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 15:28:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 15:28:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 15:28:55 - snowflake.connector.connection - INFO - closed
2025-01-24 15:28:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 15:28:55 - root - INFO - SQL:
-- Corrected Query 13:
SELECT DISTINCT "user_pseudo_id"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
WHERE "event_name" = 'session_start'
LIMIT 100
Results:
user_pseudo_id
6E018CE86D4601A362A9154B2500348A
23183C7A7E31451194345099C978F49E
3B7AC9CAE2D7BB661BE66F3DE36DD005
9D535D543FD07B8247DEADB4669FADE6
22DC6A6AE86C0AA33EBB8C3164A26925
EF9E8CCCCBBB015CAE0C334AB1745417
85FD06F19EBB6097388EEE0B207598B7
9603F4B5ABFC1E48B0BF68C83669F845
5217AB1A454DAED6243E1C9818BE6A20
5256B2B115955E80DDB7449775D92325
E0F91AA200D6F12DBE53B0D166AFD87B
2F0F260BD7B876C346B41977D0D03D62
E2B530ADD7430BEA6BC7F3D431C8A6FF
71746D859E4E6D655FEE8FFBC3B6C7E9
945DE7C965AFB12E35C3C992CF9847E2
980DEC5BA17132A841D7D7A140333114
0373DF7959F6867CDFB1C905D39CE67C
C6B7ED4E2FA4AABE5693A61B9A07753C
49309C5759610DBF6C829C0D4AB23943
5F824D23AE3CF750894A96098818E789
0160043392B1572A375E5C3BE1BB0C31
77F5E9A5630151C9E831156AEAB4DA11
9F3EAF490630617EF2CB47A8BD2CBBCC
23A7E8D987ADCC38EB026096DC513F85
D7D49CC32C4A23AD56E8DEAE6878EC7B
3827BA312204EA6F6847DFA4222C90CC
4500595CA1FC3CBC6140A502240FB7B4
1F25763EC8BCAEC7FB069E81659A2153
706C748E6D1E0768BFEFE6362B5D3F67
05F7B2C58D627CE948B06C10E39CDF91
7566596A1D6ACA781692A7A0B89B06EF
A29EBFE2A58D7C4D6FDA23C3A53742FF
EF9C32CA65880162136061B25D24E05E
295D9E24D8DE65A010313E667131EF19
7F2B633C86B765201C93FDB6FF261143
60ACC539CFC3DB94C60921D5572C3A4D
4BDC831A6940071E2461D0B5293A329E
D5F9D9AF22EF5073E10342973D48FB2C
17515C32D8E535AA8A1B18BA774BB90C
B275DC380CF75B352381D5419E397047
88A41BFED275BB69125BE1F5524F3B42
1B2FC37816CC4DDAACA97A75E685756F
037DAC225F0C1E54657770CD201CDDA7
7537C0AA6291AC7B99DC4D2D695EEF1D
FFFE80A7B9667187D501CE6037876955
FEC117631F54C2699CB76603EBB98CF0
38DEEAB5F723A89A66CF180A175808D5
FEDC59699D8832A11B88BFCCCAD0951D
D7EA8E3645EFFBD6443946179ED704A6
8040FC9C0479C3B9A74ED298DD8F357D
DB9F0F2561524A9EE1436805AAD70675
F26EC6056E284FDDEA7771F203B6BB8F
C136A7CE1D0A52B8D4E5F144DF114EB7
5C5A0787542CD24F1E19F9EB778BA766
60603343AB8FEECD78B1009C957D193D
B4394AD77C6DE7A5C7385C307F35F84F
F815B0069F973BFA743EF90A85224109
D0F280B12652EB0D74F6BC74AB13606F
4D084D38156128AAA060303AA91E689D
48AB910A8DE8485D4C34238EA61F782C
AB32482D193E2CE166B59F82EF78D8BB
29845B6298FB882DF53607D21F0E1DF7
8D31836A6C3C14CE71056BED8925F0A4
6B9CFFB3E0DE6FA0C47B8410C4467F89
3EF8FC940E379D53BBD3FEFDAF626BB2
E6FEE8B98E75EA5311FE004F98559A27
2F5B044B41268F6643EB4D0EF15D4E87
8E6F7A428C907165D78A2377ABEB7315
B56E67847E1AE8D6411A5ECCA26585CA
0E05F56141200FF41FCC0C7FA297FF08
9038CCC5F7D7ABDA6E296D18FFDD1AAA
59BE43F3FE7AB3F91B016B56508D4C46
A65FAEAB5577A16B517735A9D9C54958
C795AFA7F574C2BB09D3647AD90A9719
84F5D9204EDAE98B3B542AEA93F40BED
017CF202552235BBA4338E0D82A53F43
F19B8122771D0514F440E914B722656A
EBFE0623EF1109A89B392B9DF4375951
CA04708DA02378999ECB402481FF1AE4
2F5BBABE9DD0271DCD62E501F76DA736
59454BAC415BB1F18517C6FD2C023E49
8BE7BF90C971453A34C1FF6FF2A0ACAE
6D4F9673F3DADCB39EE913EFCA2AE282
359B5B95C8B1DF723D939A5A8AFF0904
D299D5763E03F1CC4DA8550AF1B4CEE4
2C84CF723999D48F8F069AFFC184C4DC
F3917138A3D4B03ADA1C2E77E3B84649
97813C801E4E2F479172790F3F2E4071
CE7404D5A8831F2DE46BD0A013A8ED64
3BBC4DD5C8CA9027CECBEA5C39F80E3A
E84BFE62196E059C66D049BA9A14061C
9B18A1CBA96D52D05CFA7CB7C9011EDE
1B2A9E461E99FB1D165894AFE613AD73
4BF98D09CA8359FC59ADAF56D00338F8
B75F91EB6C7FDA9A329567E763CF9E44
8EDB9A9856CDB5AFC42546106EE46734
E4196C5E0A92A22F69DE4E3AA288D6EE
10522BF919A454B898540F51FFDCB292
D3F06F9B7BD9D7FC8758BF78BF0705E9
1F732B8A151B6C6249323BC65CA9C1F9

2025-01-24 15:28:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 15:28:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 15:28:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 15:28:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 15:28:57 - snowflake.connector.connection - INFO - closed
2025-01-24 15:28:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 15:28:57 - root - INFO - SQL:
-- Corrected Query 14:
SELECT COUNT(DISTINCT t."user_pseudo_id") AS "returning_users"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709" t
WHERE t."user_pseudo_id" IN (
  SELECT "user_pseudo_id"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180708"
)
Results:
returning_users
132

2025-01-24 15:28:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 15:28:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 15:28:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 15:28:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 15:28:59 - snowflake.connector.connection - INFO - closed
2025-01-24 15:28:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 15:28:59 - root - INFO - SQL:
-- Corrected Query 15:
SELECT t."user_pseudo_id", t."geo"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709" t
LIMIT 100
Results:
Too long, hard cut:
user_pseudo_id,geo
AE9C7A5E358F2E0E0E90E4B8DD67AE76,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
AE9C7A5E358F2E0E0E90E4B8DD67AE76,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
AE9C7A5E358F2E0E0E90E4B8DD67AE76,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
AE9C7A5E358F2E0E0E90E4B8DD67AE76,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": "

2025-01-24 15:28:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 15:28:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 15:28:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 15:29:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 15:29:01 - snowflake.connector.connection - INFO - closed
2025-01-24 15:29:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 15:29:01 - root - INFO - SQL:
-- Corrected Query 16:
SELECT t."user_pseudo_id", t."app_info"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709" t
LIMIT 100
Results:
Too long, hard cut:
user_pseudo_id,app_info
AE9C7A5E358F2E0E0E90E4B8DD67AE76,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
AE9C7A5E358F2E0E0E90E4B8DD67AE76,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
AE9C7A5E358F2E0E0E90E4B8DD67AE76,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
AE9C7A5E358F2E0E0E90E4B8DD67AE76,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:a

2025-01-24 15:29:01 - root - INFO - itercount: 0
2025-01-24 15:29:01 - root - INFO - Database Name: FIREBASE
Schema Name: ANALYTICS_153293282
DDL describes table information.
,0
table_name,EVENTS_20180613
description,
DDL,"create or replace TABLE EVENTS_20180613 (
	""event_date"" VARCHAR(16777216),
	""event_timestamp"" NUMBER(38,0),
	""event_name"" VARCHAR(16777216),
	""event_params"" VARIANT,
	""event_previous_timestamp"" NUMBER(38,0),
	""user_id"" VARCHAR(16777216),
	""user_pseudo_id"" VARCHAR(16777216),
	""user_properties"" VARIANT,
	""user_first_touch_timestamp"" NUMBER(38,0),
	""user_ltv"" VARIANT,
	""device"" VARIANT,
	""geo"" VARIANT,
	""app_info"" VARIANT,
	""traffic_source"" VARIANT,
	""stream_id"" VARCHAR(16777216),
	""platform"" VARCHAR(16777216)
);"

Some other tables have the similar structure: ['EVENTS_20180613', 'EVENTS_20180616', 'EVENTS_20180621', 'EVENTS_20180628', 'EVENTS_20180714', 'EVENTS_20180804', 'EVENTS_20180818', 'EVENTS_20180827', 'EVENTS_20180904', 'EVENTS_20180929', 'EVENTS_20180726', 'EVENTS_20180730', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180820', 'EVENTS_20180826', 'EVENTS_20180901', 'EVENTS_20180915', 'EVENTS_20180925', 'EVENTS_20180927', 'EVENTS_20180815', 'EVENTS_20180906', 'EVENTS_20180922', 'EVENTS_20180830', 'EVENTS_20180709', 'EVENTS_20180802', 'EVENTS_20180715', 'EVENTS_20180813', 'EVENTS_20180728', 'EVENTS_20180814', 'EVENTS_20180614', 'EVENTS_20180617', 'EVENTS_20180620', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180626', 'EVENTS_20180630', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180712', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180720', 'EVENTS_20180801', 'EVENTS_20180805', 'EVENTS_20180907', 'EVENTS_20180928', 'EVENTS_20180702', 'EVENTS_20180706', 'EVENTS_20180711', 'EVENTS_20180724', 'EVENTS_20180803', 'EVENTS_20180909', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180926', 'EVENTS_20180920', 'EVENTS_20181002', 'EVENTS_20180629', 'EVENTS_20180902', 'EVENTS_20180908', 'EVENTS_20180924', 'EVENTS_20180721', 'EVENTS_20180725', 'EVENTS_20180612', 'EVENTS_20180618', 'EVENTS_20180625', 'EVENTS_20180627', 'EVENTS_20180705', 'EVENTS_20180727', 'EVENTS_20180806', 'EVENTS_20180821', 'EVENTS_20180825', 'EVENTS_20180831', 'EVENTS_20180903', 'EVENTS_20181003', 'EVENTS_20180723', 'EVENTS_20180731', 'EVENTS_20180822', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180917', 'EVENTS_20180729', 'EVENTS_20180912', 'EVENTS_20180923', 'EVENTS_20180713', 'EVENTS_20180911', 'EVENTS_20180615', 'EVENTS_20180619', 'EVENTS_20180624', 'EVENTS_20180701', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180719', 'EVENTS_20180807', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180819', 'EVENTS_20180823', 'EVENTS_20180910', 'EVENTS_20180918', 'EVENTS_20180710', 'EVENTS_20180716', 'EVENTS_20180722', 'EVENTS_20180824', 'EVENTS_20180905', 'EVENTS_20180916', 'EVENTS_20180921', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20180812', 'EVENTS_20180919']
External knowledge that might be helpful: 
How to Calculate User Retention in Big Query from Google Demo Game Analytics Data

As a Product / Website Analyst, I was pretty psyched to discover Googles public Google Analytics 4 (GA4) gaming event dataset called `firebase-public-project.analytics_153293282.events_*`. The table allows experienced developers and learners alike to experiment with raw GA4 data in Big Query for free. Event data is basically a log of user interactions with your product for analysis .For newbies interested in learning more about event data and GA4, visit my prior blog. This article provides SQL queries for a quick table overview and explains how to utilize Google Big Query to calculate user retention.


What is Retention?
User retention rates are key indicators for whether your product team meets user needs. Improving retention is often central to long term growth strategies.

**Retention measures how often and for how long users tend to return to your product.**

The metric can be a powerful proxy for product usefulness and user opinion. Its analysis can reveal critical information like how well your site converts new visitors to users and which items and features are associated with users coming back. If user data is available, retention can also help a business understand the profiles of its most active users (power users). Finally, retention is a great guardrail metric for A/B tests. Successful, product oriented companies prioritize a healthy user bases over short term profits.


**Common Retention Calculation Strategies**

Two common strategies to calculate retention are: 

a) N-Day retention

b) Unbounded Retention.


a) For N-Day retention, analysts calculate how many users with certain characteristics return over successive periods. It is called N days because we define the length of each period. For example, with N=7 day retention, if User A becomes part of our cohort of interest on day 0 and returns to the product day 5 and day 15, they are counted as retained for week 1 (17 days) and week 3 (1521 days) but not week 2 (814 days).


b) For Unbounded Retention, a user is counted as retained each week so long as their most recent product contact was after the week. For example, if User A becomes part of the cohort on day 0 and last returned to the site on day 21, they will be counted as retained in week 1 (17 days), week 2 (814 days), and week 3 (1521 days) but not week 4 (2228 days).

By calculating these metrics, companies can evaluate how well their products hold users interests. It also them closer to identifying the patterns that generate return users.



The table structure information is ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}
Begin Exploring Related Columns
**Relevant Columns and Their Potential Usage:**

- **"event_date"**: Potential usage - Indicates the date of each event; used to group events by date and to determine the week of user activity.
- **"event_timestamp"**: Potential usage - Timestamp of the event; may be used for precise time calculations if needed.
- **"user_pseudo_id"**: Potential usage - An anonymous unique identifier for each user; used to track user activity and group users by cohorts.
- **"user_first_touch_timestamp"**: Potential usage - Timestamp of the user's first interaction with the app; can be used to determine the user's cohort (first week of app use).
- **"event_name"**: Potential usage - The name of the event; may be used to filter specific types of events if necessary.
- **"platform"**: Potential usage - Indicates the platform used (e.g., iOS or Android); could be used to segment data by platform.

**Conditions That May Be Used:**

- Filters to include data starting from **July 9, 2018**.
- Grouping users by the week of their **first app use** to form cohorts.
- Calculating retention by checking if users returned in the subsequent weeks.
- Using the tables within the **"FIREBASE"."ANALYTICS_153293282"** schema relevant to the date range.

---

**SQL Queries to Explore the Data:**

1. **List distinct event names on July 9, 2018:**

   ```sql
   SELECT DISTINCT "event_name"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
   LIMIT 100;
   ```

2. **Count the number of unique users on July 9, 2018:**

   ```sql
   SELECT COUNT(DISTINCT "user_pseudo_id") AS "unique_users"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709";
   ```

3. **Find the first event date for each user on July 9, 2018:**

   ```sql
   SELECT "user_pseudo_id", MIN("event_timestamp") AS "first_event_timestamp"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
   GROUP BY "user_pseudo_id"
   LIMIT 100;
   ```

4. **Extract keys from the "user_properties" column on July 9, 2018:**

   ```sql
   SELECT DISTINCT f.key AS "user_property_key"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709" t,
   LATERAL FLATTEN(input => t."user_properties") f
   LIMIT 100;
   ```

5. **Extract keys from the "event_params" column on July 9, 2018:**

   ```sql
   SELECT DISTINCT f.key AS "event_param_key"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709" t,
   LATERAL FLATTEN(input => t."event_params") f
   LIMIT 100;
   ```

6. **Count the number of events per platform on July 9, 2018:**

   ```sql
   SELECT "platform", COUNT(*) AS "event_count"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
   GROUP BY "platform"
   LIMIT 100;
   ```

7. **List distinct user IDs and their platforms on July 9, 2018:**

   ```sql
   SELECT DISTINCT "user_pseudo_id", "platform"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
   LIMIT 100;
   ```

8. **Count the number of events per user on July 9, 2018:**

   ```sql
   SELECT "user_pseudo_id", COUNT(*) AS "event_count"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
   GROUP BY "user_pseudo_id"
   LIMIT 100;
   ```

9. **Get the number of events for each event date starting from July 9, 2018:**

   ```sql
   SELECT "event_date", COUNT(*) AS "event_count"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
   GROUP BY "event_date"
   LIMIT 100;
   ```

10. **List unique users who had events on July 9 and July 16, 2018:**

    ```sql
    SELECT DISTINCT "user_pseudo_id"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
    WHERE "user_pseudo_id" IN (
      SELECT DISTINCT "user_pseudo_id"
      FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
    )
    LIMIT 100;
    ```

11. **Find the first week of app use for each user starting from July 9, 2018:**

    ```sql
    SELECT "user_pseudo_id", MIN("event_date") AS "first_event_date"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
    GROUP BY "user_pseudo_id"
    LIMIT 100;
    ```

12. **Count the number of users by their first event date starting from July 9, 2018:**

    ```sql
    SELECT "event_date", COUNT(DISTINCT "user_pseudo_id") AS "new_users"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
    GROUP BY "event_date"
    LIMIT 100;
    ```

13. **List the top 10 users with the most events on July 9, 2018:**

    ```sql
    SELECT "user_pseudo_id", COUNT(*) AS "event_count"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
    GROUP BY "user_pseudo_id"
    ORDER BY "event_count" DESC
    LIMIT 10;
    ```

14. **Extract event parameter values for a specific key (e.g., "level_name") on July 9, 2018:**

    ```sql
    SELECT f.value:"string_value"::STRING AS "level_name"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709" t,
    LATERAL FLATTEN(input => t."event_params") f
    WHERE f.key = 'level_name'
    LIMIT 100;
    ```

15. **Count the number of events per event name on July 9, 2018:**

    ```sql
    SELECT "event_name", COUNT(*) AS "event_count"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
    GROUP BY "event_name"
    LIMIT 100;
    ```

16. **List distinct platforms used by users who first used the app on July 9, 2018:**

    ```sql
    SELECT DISTINCT t."platform"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709" t
    WHERE t."user_pseudo_id" IN (
      SELECT "user_pseudo_id"
      FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
      GROUP BY "user_pseudo_id"
      HAVING MIN("event_date") = '20180709'
    )
    LIMIT 100;
    ```

17. **Find users who performed a specific event (e.g., "login") on July 9, 2018:**

    ```sql
    SELECT DISTINCT "user_pseudo_id"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
    WHERE "event_name" ILIKE '%login%'
    LIMIT 100;
    ```

18. **Calculate the number of returning users on July 9, 2018:**

    ```sql
    SELECT COUNT(DISTINCT t."user_pseudo_id") AS "returning_users"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709" t
    WHERE t."user_pseudo_id" IN (
      SELECT "user_pseudo_id"
      FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180708"
    )
    LIMIT 100;
    ```

19. **Extract geo-location data from the "geo" column on July 9, 2018:**

    ```sql
    SELECT t."user_pseudo_id", t."geo"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709" t
    LIMIT 100;
    ```

20. **List users and their corresponding app_info on July 9, 2018:**

    ```sql
    SELECT t."user_pseudo_id", t."app_info"
    FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709" t
    LIMIT 100;
    ```

---

These queries are designed to explore the dataset and understand the values within the relevant columns. They range from simple SELECT statements retrieving distinct values to more complex queries involving aggregation and data extraction from nested structures.

By examining the data using these queries, we can gain insights into user behavior, event distribution, and the structure of nested JSON fields such as `"event_params"` and `"user_properties"`. This exploration is essential for preparing to conduct the weekly cohort analysis for user retention as specified in the task.Query:
SELECT DISTINCT "event_name"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
   LIMIT 100;
Answer:
event_name
os_update
screen_view
user_engagement
post_score
level_up
level_end
level_retry
level_start
level_complete
completed_5_levels
session_start
level_complete_quickplay
level_fail_quickplay
level_start_quickplay
level_reset_quickplay
level_end_quickplay
select_content
level_retry_quickplay
level_fail
no_more_extra_steps
level_reset
app_remove
app_exception
firebase_campaign
error
app_update
use_extra_steps
spend_virtual_currency
ad_reward
challenge_a_friend
first_open
Query:
SELECT COUNT(DISTINCT "user_pseudo_id") AS "unique_users"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709";
Answer:
unique_users
422
Query:
SELECT "user_pseudo_id", MIN("event_timestamp") AS "first_event_timestamp"
   FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
   GROUP BY "user_pseudo_id"
   LIMIT 100;
Answer:
Too long, hard cut:
user_pseudo_id,first_event_timestamp
AE9C7A5E358F2E0E0E90E4B8DD67AE76,1531155691549000
6E018CE86D4601A362A9154B2500348A,1531157428290000
23183C7A7E31451194345099C978F49E,1531137357029000
3B7AC9CAE2D7BB661BE66F3DE36DD005,1531167020160007
9D535D543FD07B8247DEADB4669FADE6,1531154642604000
22DC6A6AE86C0AA33EBB8C3164A26925,1531176809772000
EF9E8CCCCBBB015CAE0C334AB1745417,1531146872262008
85FD06F19EBB6097388EEE0B207598B7,1531178637538003
EF9C32CA65880162136061B25D24E05E,1531199850329001
295D9E24D8DE65A010313E667131EF19,1531127681156012
9603F4B5ABFC1E48B0BF68C83669F845,1531160115950006
5256B2B115955E80DDB7449775D92325,1531167930018000
E0F91AA200D6F12DBE53B0D166AFD87B,1531171938815010
2F0F260BD7B876C346B41977D0D03D62,1531176060469004
71746D859E4E6D655FEE8FFBC3B6C7E9,1531152119531008
F26EC6056E284FDDEA7771F203B6BB8F,1531200602308002
980DEC5BA17132A841D7D7A140333114,1531154922017002
C6B7ED4E2FA4AABE5693A61B9A07753C,1531132840311011
C136A7CE1D0A52B8D4E5F144DF114EB7,1531124847080000
49309C5759610DBF6C829C0D4AB23943,1531134364922003
5F824D23AE3CF750894A96098818E789,1531148101985001
9F3EAF490630617EF2CB47A8BD2CBBCC,1531125104805015
0373DF7959F6867CDFB1C905D39CE67C,1531147110873010
5C5A0787542CD24F1E19F9EB778BA766,1531138134022003
4BF98D09CA8359FC59ADAF56D00338F8,1531171413710007
D7D49CC32C4A23AD56E8DEAE6878EC7B,1531187258493001
B4394AD77C6DE7A5C7385C307F35F84F,1531136486713001
3827BA312204EA6F6847DFA4222C90CC,1531173866154012
4500595CA1FC3CBC6140A502240FB7B4,1531150981943003
1F25763EC8BCAEC7FB069E81659A2153,1531164918477000
706C748E6D1E0768BFEFE6362B5D3F67,1531140264102007
D0F280B12652EB0D74F6BC74AB13606F,1531202650095005
4D084D38156128AAA060303AA91E689D,1531180716941005
E6FEE8B98E75EA5311FE004F98559A27,1531164805054000
48AB910A8DE8485D4C34238EA61F782C,1531146334964000
EAFD6F2604C8351032764E5F8B4D389E,1531175315280000
0E05F56141200FF41FCC0C7FA297FF08,1531137965556001
75C683C1AE98FC6CCE6EA156C9E90A35,1531148035325000
AB32482D193E2CE166B59F82EF78D8BB,1531174848290000
A29EBFE2A58D7C4D6FDA23C3A53742FF,1531163474130004
B56E67847E1AE8D6411A5ECCA26585CA,1531166430271005
693EB525C74694F2E6990CA738F5E5D5,1531170222377000
60ACC539CFC3DB94C60921D5572C3A4D,1531200715189000
9B27F8491DC5DA23D369F31250BD8D65,1531137160916010
84AFEFA3875BA1F17232CB41D06B6EF4,1531194546968010
2F5B044B41268F6643EB4D0EF15D4E87,1531127055296010
4BDC831A6940071E2461D0B5293A329E,1531178825151005
9038CCC5F7D7ABDA6E296D18FFDD1AAA,1531125748229001
FFFE80A7B9667187D501CE6037876955,1531139414494000
FEDC59699D8832A11B88BFCCCAD0951D,1531137968342000
7480AE90D76538F44A066A153F448198,1531161431605000
E4196C5E0A92A22F69DE4E3AA288D6EE,1531187717563007
6D4F9673F3DADCB39EE913EFCA2AE282,1531184588390005
359B5B95C8B1DF723D939A5A8AFF0904,1531180884940003
F3917138A3D4B03ADA1C2E77E3B84649,1531159529474000
932AAF56DDE9C55359B9CCFA18E7FB95,1531146996028001
01E32D5F696E088F968DFD847C2A68D8,1531161921650003
FD9223BA1689E43F814C545A5FEBA7F4,1531134241750003
35DDC37EB72373793E703516725BB2FE,1531167896390004
84690B86D5DA141638BAC264173308B2,1531150063220000
16B0F6645F896C16F83EF56A99868801,1531140289094006
B2ED849BBB2D152DF245B09A41687D4F,1531200531430002
D55D4E5B60368F4BE64F16EFD78B2BE7,1531193449379003
261F6186CC817A991565A91C4C92CAFA,1531152470542008
5217AB1A454DAED6243E1C9818BE6A20,1531132346468008
DB9F0F2561524A9EE1436805AAD70675,1531187101483002
E2B530ADD7430BEA6BC7F3D431C8A6FF,1531167678572001
945DE7C965AFB12E35C3C992CF9847E2,1531197662268002
77F5E9A5630151C9E831156AEAB4DA11,1531141560542005
F815B0069F973BFA743EF90A85224109,1531148843600005
3EF8FC940E379D53BBD3FEFDAF626BB2,1531205386511007
8E6F7A428C907165D78A2377ABEB7315,1531174371102000
88A41BFED275BB69125BE1F5524F3B42,1531176732028004
331C58F19DE71B2DE30DDC47ECE5CCA6,1531176289240000
17515C32D8E535AA8A1B18BA774BB90C,1531163883338003
B275DC380CF75B352381D5419E397047,1531166353795002
037DAC225F0C1E54657770CD201CDDA7,1531135928712008
7566596A1D6ACA781692A7A0B89B06EF,1531165614535002
4CFD4E167957842AFC9C7A6A5FF78827,1531131430919003
A05ACB383D79E187B98B95E9C749C416,1531175163469004
29845B6298FB882DF53607D21F0E1DF7,1531162210094001
6B9CFFB3E0DE6FA0C47B8410C4467F89,1531136975599007
1B2FC37816CC4DDAACA97A75E685756F,1531174721711004
7537C0AA6291AC7B99DC4D2D695EEF1D,1531153723583000
59BE43F3FE7AB3F91B016B56508D4C46,1531156956424000
6DC90DD09DF860E7C60C00BF36906CB3,1531174966708008
A65FAEAB5577A16B517735A9D9C54958,1531142587680001
38DEEAB5F723A89A66CF180A175808D5,1531202060674005
C795AFA7F574C2BB09D3647AD90A9719,1531133001494002
84F5D9204EDAE98B3B542AEA93F40BED,1531136090264005
D7EA8E3645EFFBD6443946179ED704A6,1531140127676000
59454BAC415BB1F18517C6FD2C023E49,1531187434594004
017CF202552235BBA4338E0D82A53F43,1531201172661011
F19B8122771D0514F440E914B722656A,1531199264817005
B75F91EB6C7FDA9A329567E763CF9E44,1531182645737005
AB6FCC6558326ADC858DE37C8D9EB7CD,1531178051576001
EBFE0623EF1109A89B392B9DF4375951,1531179511995001
0B99B2EC1247C09535717331F816D42D,1531190817201001
2F5BBABE9DD0271DCD62E501F76DA736,1531171792388001
10522BF919A45
Query:
SELECT DISTINCT f.value:"key"::STRING AS "user_property_key"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709" t,
LATERAL FLATTEN(input => t."user_properties") f
WHERE f.value:"key" IS NOT NULL
LIMIT 100;
Answer:
user_property_key
initial_extra_steps
plays_quickplay
num_levels_available
firebase_exp_4
plays_progressive
firebase_exp_1
first_open_time
ad_frequency
firebase_exp_5
firebase_exp_3
_ltv_USD
firebase_last_notification
Query:
-- Corrected Query 1:
SELECT DISTINCT f.value:"key"::STRING AS "event_param_key"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709" t,
LATERAL FLATTEN(input => t."event_params") f
WHERE f.value:"key" IS NOT NULL
LIMIT 100
Answer:
event_param_key
firebase_event_origin
previous_os_version
firebase_previous_id
firebase_screen_class
firebase_screen_id
firebase_previous_class
engagement_time_msec
time
score
level_name
value
item_name
virtual_currency_name
board
content_type
item_id
ad_event_id
ad_unit_code
fatal
timestamp
firebase_previous_screen
firebase_screen
medium
source
firebase_error
previous_app_version
update_with_analytics
system_app
level
firebase_conversion
type
click_timestamp
error_value
gclid
system_app_update
previous_first_open_count
Query:
-- Corrected Query 2:
SELECT t."platform", COUNT(*) AS "event_count"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709" t
WHERE t."platform" IS NOT NULL AND t."platform" != ''
GROUP BY t."platform"
LIMIT 100
Answer:
platform,event_count
ANDROID,37765
IOS,12235
Query:
-- Corrected Query 3:
SELECT DISTINCT "user_pseudo_id", "platform"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
WHERE "platform" IS NOT NULL AND "platform" != ''
LIMIT 100
Answer:
user_pseudo_id,platform
AE9C7A5E358F2E0E0E90E4B8DD67AE76,ANDROID
6E018CE86D4601A362A9154B2500348A,ANDROID
23183C7A7E31451194345099C978F49E,ANDROID
9D535D543FD07B8247DEADB4669FADE6,ANDROID
22DC6A6AE86C0AA33EBB8C3164A26925,ANDROID
EF9E8CCCCBBB015CAE0C334AB1745417,ANDROID
85FD06F19EBB6097388EEE0B207598B7,ANDROID
EF9C32CA65880162136061B25D24E05E,ANDROID
295D9E24D8DE65A010313E667131EF19,ANDROID
9603F4B5ABFC1E48B0BF68C83669F845,ANDROID
5217AB1A454DAED6243E1C9818BE6A20,ANDROID
2F0F260BD7B876C346B41977D0D03D62,ANDROID
DB9F0F2561524A9EE1436805AAD70675,ANDROID
E2B530ADD7430BEA6BC7F3D431C8A6FF,ANDROID
71746D859E4E6D655FEE8FFBC3B6C7E9,ANDROID
F26EC6056E284FDDEA7771F203B6BB8F,ANDROID
945DE7C965AFB12E35C3C992CF9847E2,ANDROID
980DEC5BA17132A841D7D7A140333114,ANDROID
0373DF7959F6867CDFB1C905D39CE67C,ANDROID
49309C5759610DBF6C829C0D4AB23943,ANDROID
C136A7CE1D0A52B8D4E5F144DF114EB7,ANDROID
9F3EAF490630617EF2CB47A8BD2CBBCC,ANDROID
5F824D23AE3CF750894A96098818E789,ANDROID
5C5A0787542CD24F1E19F9EB778BA766,ANDROID
4BF98D09CA8359FC59ADAF56D00338F8,ANDROID
60603343AB8FEECD78B1009C957D193D,ANDROID
4500595CA1FC3CBC6140A502240FB7B4,ANDROID
706C748E6D1E0768BFEFE6362B5D3F67,ANDROID
F815B0069F973BFA743EF90A85224109,ANDROID
D0F280B12652EB0D74F6BC74AB13606F,ANDROID
3EF8FC940E379D53BBD3FEFDAF626BB2,ANDROID
75C683C1AE98FC6CCE6EA156C9E90A35,ANDROID
8E6F7A428C907165D78A2377ABEB7315,ANDROID
7566596A1D6ACA781692A7A0B89B06EF,ANDROID
A05ACB383D79E187B98B95E9C749C416,ANDROID
693EB525C74694F2E6990CA738F5E5D5,ANDROID
60ACC539CFC3DB94C60921D5572C3A4D,ANDROID
9B27F8491DC5DA23D369F31250BD8D65,ANDROID
17515C32D8E535AA8A1B18BA774BB90C,ANDROID
23A7E8D987ADCC38EB026096DC513F85,ANDROID
2F5B044B41268F6643EB4D0EF15D4E87,ANDROID
29845B6298FB882DF53607D21F0E1DF7,ANDROID
331C58F19DE71B2DE30DDC47ECE5CCA6,ANDROID
85A84EA2A3017D368F41519312C6D3A2,ANDROID
037DAC225F0C1E54657770CD201CDDA7,ANDROID
59BE43F3FE7AB3F91B016B56508D4C46,ANDROID
6DC90DD09DF860E7C60C00BF36906CB3,ANDROID
FFFE80A7B9667187D501CE6037876955,ANDROID
A65FAEAB5577A16B517735A9D9C54958,ANDROID
7D613AF4DA0F508C7090E96FD73B7E6D,ANDROID
38DEEAB5F723A89A66CF180A175808D5,ANDROID
FEDC59699D8832A11B88BFCCCAD0951D,ANDROID
59454BAC415BB1F18517C6FD2C023E49,ANDROID
7480AE90D76538F44A066A153F448198,ANDROID
8EDB9A9856CDB5AFC42546106EE46734,ANDROID
0B99B2EC1247C09535717331F816D42D,ANDROID
2F5BBABE9DD0271DCD62E501F76DA736,ANDROID
3B7AC9CAE2D7BB661BE66F3DE36DD005,ANDROID
5256B2B115955E80DDB7449775D92325,ANDROID
E0F91AA200D6F12DBE53B0D166AFD87B,ANDROID
0160043392B1572A375E5C3BE1BB0C31,ANDROID
C6B7ED4E2FA4AABE5693A61B9A07753C,ANDROID
77F5E9A5630151C9E831156AEAB4DA11,ANDROID
D7D49CC32C4A23AD56E8DEAE6878EC7B,ANDROID
B4394AD77C6DE7A5C7385C307F35F84F,ANDROID
3827BA312204EA6F6847DFA4222C90CC,ANDROID
1F25763EC8BCAEC7FB069E81659A2153,ANDROID
4D084D38156128AAA060303AA91E689D,ANDROID
E6FEE8B98E75EA5311FE004F98559A27,ANDROID
48AB910A8DE8485D4C34238EA61F782C,ANDROID
0E05F56141200FF41FCC0C7FA297FF08,ANDROID
AB32482D193E2CE166B59F82EF78D8BB,ANDROID
A29EBFE2A58D7C4D6FDA23C3A53742FF,ANDROID
4CFD4E167957842AFC9C7A6A5FF78827,ANDROID
B56E67847E1AE8D6411A5ECCA26585CA,ANDROID
8D31836A6C3C14CE71056BED8925F0A4,ANDROID
D5F9D9AF22EF5073E10342973D48FB2C,ANDROID
B275DC380CF75B352381D5419E397047,ANDROID
1B2FC37816CC4DDAACA97A75E685756F,ANDROID
6B9CFFB3E0DE6FA0C47B8410C4467F89,ANDROID
05F7B2C58D627CE948B06C10E39CDF91,ANDROID
88A41BFED275BB69125BE1F5524F3B42,ANDROID
7F2B633C86B765201C93FDB6FF261143,ANDROID
4BDC831A6940071E2461D0B5293A329E,ANDROID
9038CCC5F7D7ABDA6E296D18FFDD1AAA,ANDROID
84F5D9204EDAE98B3B542AEA93F40BED,ANDROID
F19B8122771D0514F440E914B722656A,ANDROID
B75F91EB6C7FDA9A329567E763CF9E44,ANDROID
AB6FCC6558326ADC858DE37C8D9EB7CD,ANDROID
EBFE0623EF1109A89B392B9DF4375951,ANDROID
E4196C5E0A92A22F69DE4E3AA288D6EE,ANDROID
CA04708DA02378999ECB402481FF1AE4,ANDROID
EAFD6F2604C8351032764E5F8B4D389E,ANDROID
84AFEFA3875BA1F17232CB41D06B6EF4,ANDROID
7537C0AA6291AC7B99DC4D2D695EEF1D,ANDROID
FEC117631F54C2699CB76603EBB98CF0,ANDROID
D7EA8E3645EFFBD6443946179ED704A6,ANDROID
017CF202552235BBA4338E0D82A53F43,ANDROID
10522BF919A454B898540F51FFDCB292,ANDROID
C795AFA7F574C2BB09D3647AD90A9719,ANDROID
Query:
-- Corrected Query 4:
SELECT "user_pseudo_id", COUNT(*) AS "event_count"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
WHERE "user_pseudo_id" IS NOT NULL
GROUP BY "user_pseudo_id"
LIMIT 100
Answer:
user_pseudo_id,event_count
AE9C7A5E358F2E0E0E90E4B8DD67AE76,4
6E018CE86D4601A362A9154B2500348A,89
23183C7A7E31451194345099C978F49E,4
3B7AC9CAE2D7BB661BE66F3DE36DD005,66
9D535D543FD07B8247DEADB4669FADE6,161
22DC6A6AE86C0AA33EBB8C3164A26925,632
EF9E8CCCCBBB015CAE0C334AB1745417,58
85FD06F19EBB6097388EEE0B207598B7,221
295D9E24D8DE65A010313E667131EF19,349
9603F4B5ABFC1E48B0BF68C83669F845,65
5217AB1A454DAED6243E1C9818BE6A20,538
5256B2B115955E80DDB7449775D92325,114
E0F91AA200D6F12DBE53B0D166AFD87B,56
2F0F260BD7B876C346B41977D0D03D62,113
DB9F0F2561524A9EE1436805AAD70675,31
E2B530ADD7430BEA6BC7F3D431C8A6FF,11
71746D859E4E6D655FEE8FFBC3B6C7E9,28
980DEC5BA17132A841D7D7A140333114,31
C6B7ED4E2FA4AABE5693A61B9A07753C,516
77F5E9A5630151C9E831156AEAB4DA11,27
49309C5759610DBF6C829C0D4AB23943,33
9F3EAF490630617EF2CB47A8BD2CBBCC,558
4BF98D09CA8359FC59ADAF56D00338F8,57
D7D49CC32C4A23AD56E8DEAE6878EC7B,31
4500595CA1FC3CBC6140A502240FB7B4,56
1F25763EC8BCAEC7FB069E81659A2153,44
706C748E6D1E0768BFEFE6362B5D3F67,80
F815B0069F973BFA743EF90A85224109,15
05F7B2C58D627CE948B06C10E39CDF91,73
3EF8FC940E379D53BBD3FEFDAF626BB2,8
E6FEE8B98E75EA5311FE004F98559A27,219
AB32482D193E2CE166B59F82EF78D8BB,45
B56E67847E1AE8D6411A5ECCA26585CA,23
29845B6298FB882DF53607D21F0E1DF7,33
9B27F8491DC5DA23D369F31250BD8D65,276
17515C32D8E535AA8A1B18BA774BB90C,184
85A84EA2A3017D368F41519312C6D3A2,4
037DAC225F0C1E54657770CD201CDDA7,51
4BDC831A6940071E2461D0B5293A329E,68
84AFEFA3875BA1F17232CB41D06B6EF4,23
6B9CFFB3E0DE6FA0C47B8410C4467F89,84
59BE43F3FE7AB3F91B016B56508D4C46,21
FFFE80A7B9667187D501CE6037876955,67
A65FAEAB5577A16B517735A9D9C54958,28
84F5D9204EDAE98B3B542AEA93F40BED,150
D7EA8E3645EFFBD6443946179ED704A6,109
F19B8122771D0514F440E914B722656A,10
8BE7BF90C971453A34C1FF6FF2A0ACAE,903
AB6FCC6558326ADC858DE37C8D9EB7CD,3
EBFE0623EF1109A89B392B9DF4375951,881
CA04708DA02378999ECB402481FF1AE4,102
CE7404D5A8831F2DE46BD0A013A8ED64,47
38C93052B6B68913A433591107F8662C,4
9CD32E150A48D09944338963BBE1EA18,109
B75FCD833DE643B45B326D2E7AC413E4,18
ADDE80C89BB3F6190538E50E541BACD5,19
2920B9D90561E521425DE4849FAAD1D7,1
B7E6580376A092AF1D8ED36A96EEF943,1
74375465CD17299EBC7C75A1B4047EE0,680
EE07F52A618BA7AACDCD6712B01F945A,255
B5395F8C2077B59B3D6C5719C0CA0339,162
F8EBD8316C0FAA906D1335B3D2C04C83,148
EBC3581ADA874D494FBE2C7CCF53BF99,58
27DCDEB27C0798022EEA48EBAB89D43B,186
EF9C32CA65880162136061B25D24E05E,193
F26EC6056E284FDDEA7771F203B6BB8F,29
945DE7C965AFB12E35C3C992CF9847E2,88
0160043392B1572A375E5C3BE1BB0C31,208
C136A7CE1D0A52B8D4E5F144DF114EB7,30
5F824D23AE3CF750894A96098818E789,21
5C5A0787542CD24F1E19F9EB778BA766,24
60603343AB8FEECD78B1009C957D193D,44
23A7E8D987ADCC38EB026096DC513F85,12
B4394AD77C6DE7A5C7385C307F35F84F,5
D0F280B12652EB0D74F6BC74AB13606F,6
48AB910A8DE8485D4C34238EA61F782C,737
EAFD6F2604C8351032764E5F8B4D389E,1
75C683C1AE98FC6CCE6EA156C9E90A35,4
88A41BFED275BB69125BE1F5524F3B42,50
8D31836A6C3C14CE71056BED8925F0A4,43
D5F9D9AF22EF5073E10342973D48FB2C,21
7566596A1D6ACA781692A7A0B89B06EF,35
A05ACB383D79E187B98B95E9C749C416,299
693EB525C74694F2E6990CA738F5E5D5,3
7F2B633C86B765201C93FDB6FF261143,25
331C58F19DE71B2DE30DDC47ECE5CCA6,1
B275DC380CF75B352381D5419E397047,64
7537C0AA6291AC7B99DC4D2D695EEF1D,358
9038CCC5F7D7ABDA6E296D18FFDD1AAA,243
6DC90DD09DF860E7C60C00BF36906CB3,63
7D613AF4DA0F508C7090E96FD73B7E6D,3
FEC117631F54C2699CB76603EBB98CF0,66
C795AFA7F574C2BB09D3647AD90A9719,51
FEDC59699D8832A11B88BFCCCAD0951D,25
017CF202552235BBA4338E0D82A53F43,47
B75F91EB6C7FDA9A329567E763CF9E44,120
8EDB9A9856CDB5AFC42546106EE46734,51
0B99B2EC1247C09535717331F816D42D,189
E4196C5E0A92A22F69DE4E3AA288D6EE,53
2F5BBABE9DD0271DCD62E501F76DA736,56
Query:
-- Corrected Query 5:
SELECT "event_date", COUNT(*) AS "event_count"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
WHERE "event_date" IS NOT NULL
GROUP BY "event_date"
LIMIT 100
Answer:
event_date,event_count
20180709,50000
Query:
-- Corrected Query 6:
SELECT DISTINCT "user_pseudo_id"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
WHERE "user_pseudo_id" IS NOT NULL AND "user_pseudo_id" IN (
  SELECT DISTINCT "user_pseudo_id"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
  WHERE "user_pseudo_id" IS NOT NULL
)
LIMIT 100
Answer:
user_pseudo_id
1CF315BC6864E7A71A81E47925E18A61
01B358175084B5B44F1C83C2A42FE33A
5217AB1A454DAED6243E1C9818BE6A20
CA51DAF1373B5C2A16C174AFBD2132A4
7566596A1D6ACA781692A7A0B89B06EF
EB1A430BACB37E6EA72592BF838E64A6
B141B75E5E5D48DAD8298F91B94A2E07
1B2A9E461E99FB1D165894AFE613AD73
472451071AED6FF801BC0FE66706FD27
1213ED1E96B0A49B51C0F7683DB2ACCC
9B18A1CBA96D52D05CFA7CB7C9011EDE
D924713CB1AF85AED83BC394B164B9DC
D9FEC4E4418413FCE771B203FD7D48D2
A0616D4E494DC3BCCB94B8B6E5B48380
3C58946C3178392A69D292F2F5A862E3
D8A6BDFA89F65FC9B5159A3031C33004
D5F9D9AF22EF5073E10342973D48FB2C
932AAF56DDE9C55359B9CCFA18E7FB95
D842320AECB686B41C2F8E8876794D34
4EF1041DB2A406750E4A46AFD78FB543
0CAAA1B6F161BA4D363EB7A2DEF64A08
B5F3D00E28A57C9522F2DEE3CB903DD1
D7EA8E3645EFFBD6443946179ED704A6
C80CEE0983AB5B21D3F4B46089FDD9EB
E84BFE62196E059C66D049BA9A14061C
620DA7A49F07368EBCB917DB113BCEDC
F815B0069F973BFA743EF90A85224109
B63075B53A750A67A12F7F19ED5AA835
C7E2273D8B11257FCCC915D27C1FCA24
EECDCA8076D5842922767F5C08957B17
3B4A6FCA6DCB4C2749409DC4188A306E
C639CACA07D03F536F537ED779CF6599
2B7787A34C362AA51FF8E4DD031A2F70
8BD465AC77DC9D8B4C597BF35950FDA3
89BD2B0E233951461CF06C9B4FDA0D81
EEBCB25D5F056CCF59DDE654388ACD2B
4AB0441290F6077849CBE9C74A828F0A
7386D239899D55E3D62DA619F359A7C0
CA04708DA02378999ECB402481FF1AE4
004D2DFEB866BFB00427DB2F530C1F3D
0C777BD44F304574371C97674DCD0702
8EDB9A9856CDB5AFC42546106EE46734
BE36C49B1AB3968D420923AEC4FDD7AE
7E38A396789F21724DDEFB0400305685
DB9D0368B6DC1CD2E03CDDBE7060DE31
9D535D543FD07B8247DEADB4669FADE6
4BDC831A6940071E2461D0B5293A329E
7EE035CA8E6132A8877C39656896BA41
A2B7DF97E146FC5AB4C8F89A94D85B4A
B458770ED6E295374FEEB3A68902CC28
788B593C9AFEBAEE6374CDA08F16FAC6
84E491A60BE52A4C6A438A89FADE283C
F5DAD8DD17B689CF672D65A0A81CF4AC
1F0D27B8A7E058446D4A6409E2E73B19
A65FAEAB5577A16B517735A9D9C54958
465B5DC1BA69633FE49EFA52F08CBB40
75C683C1AE98FC6CCE6EA156C9E90A35
E4196C5E0A92A22F69DE4E3AA288D6EE
8211CABE9A3F1FE1BF3154E0C8D30368
DA48D36D07835B1918BDF831AF83B5EF
5B888A06EFF60B86B10367EEC3B44E85
3D1B58553D2E2D4DD5DFCF251D5E23B2
5269565AB96D3D27ADEA4D7EF4DC2A88
0D791C00AF304C3BDDA26EF979A320C8
FEDC59699D8832A11B88BFCCCAD0951D
48AB910A8DE8485D4C34238EA61F782C
EBE661044C1949546986A852F35083A1
5CC434A43CB09640FC6BE2D7A18183E4
05FB3382D94C7E963B408FD6CC357D33
2B90CE94C6039DF03E72FE15B5320ABA
44A600997B9B6499325D518A19B51FEC
4500595CA1FC3CBC6140A502240FB7B4
E512079B53179DF9A608CF4ADE47DE9D
F91F493916395FE4E16DE98B24388985
03A9D32C44665A9E15CFCCEDC9F68EDB
D4F4DAEF5BE38E5C67FD72BB1F082EBF
3875A92B5F5C2BBA1355CED06A986079
9603F4B5ABFC1E48B0BF68C83669F845
225638B28A80341EEB04F1DFC144F30E
DB3B6E984B29883EA02F1A504A33730F
BBDCBE2491658165B7F20540DE652E3A
CABE7E24215A5C36862658A36AE5CE12
359B5B95C8B1DF723D939A5A8AFF0904
0E05F56141200FF41FCC0C7FA297FF08
037DAC225F0C1E54657770CD201CDDA7
12E5626928FE0885DEEF068683E8BD63
E2B530ADD7430BEA6BC7F3D431C8A6FF
8C7A0CAF2B29D568268B8D331E37ABF6
9DB59A6220E6D63AE53FD08FDDB59602
B5395F8C2077B59B3D6C5719C0CA0339
011A541DBC3D5ADB8450B051AC69A304
56E8EC9522573BD1BAD8E18AD2E33C9A
60603343AB8FEECD78B1009C957D193D
F3917138A3D4B03ADA1C2E77E3B84649
E6FEE8B98E75EA5311FE004F98559A27
74375465CD17299EBC7C75A1B4047EE0
85DB15BDADAB65F9CC1E33B872745B87
018F03084C88E944163F76A0D0C2FBA1
81BFFE61CAB181676917D75F1B617CB2
A74C05E503F6274BAA9457B2265471F5
Query:
-- Corrected Query 7:
SELECT "user_pseudo_id", MIN("user_first_touch_timestamp") AS "first_touch_timestamp"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
WHERE "user_first_touch_timestamp" IS NOT NULL
GROUP BY "user_pseudo_id"
LIMIT 100
Answer:
Too long, hard cut:
user_pseudo_id,first_touch_timestamp
AE9C7A5E358F2E0E0E90E4B8DD67AE76,1511766099520000
6E018CE86D4601A362A9154B2500348A,1506441128896000
23183C7A7E31451194345099C978F49E,1502291041184000
3B7AC9CAE2D7BB661BE66F3DE36DD005,1465054465301000
9D535D543FD07B8247DEADB4669FADE6,1464575838196000
22DC6A6AE86C0AA33EBB8C3164A26925,1530830330452000
EF9E8CCCCBBB015CAE0C334AB1745417,1529447876425000
85FD06F19EBB6097388EEE0B207598B7,1528677782238000
295D9E24D8DE65A010313E667131EF19,1531061434675000
9603F4B5ABFC1E48B0BF68C83669F845,1466462024189000
5217AB1A454DAED6243E1C9818BE6A20,1529861553949000
5256B2B115955E80DDB7449775D92325,1530995925757000
E0F91AA200D6F12DBE53B0D166AFD87B,1464425504029000
2F0F260BD7B876C346B41977D0D03D62,1467727817981000
DB9F0F2561524A9EE1436805AAD70675,1521413652498000
E2B530ADD7430BEA6BC7F3D431C8A6FF,1468606445788000
71746D859E4E6D655FEE8FFBC3B6C7E9,1484337748369000
980DEC5BA17132A841D7D7A140333114,1470347282362000
C6B7ED4E2FA4AABE5693A61B9A07753C,1531116497039000
77F5E9A5630151C9E831156AEAB4DA11,1468227579086000
49309C5759610DBF6C829C0D4AB23943,1472075042638000
9F3EAF490630617EF2CB47A8BD2CBBCC,1519485771522000
4BF98D09CA8359FC59ADAF56D00338F8,1526162138359000
D7D49CC32C4A23AD56E8DEAE6878EC7B,1530569048608000
4500595CA1FC3CBC6140A502240FB7B4,1525659098090000
1F25763EC8BCAEC7FB069E81659A2153,1507765625642000
706C748E6D1E0768BFEFE6362B5D3F67,1475151487594000
F815B0069F973BFA743EF90A85224109,1472922491594000
05F7B2C58D627CE948B06C10E39CDF91,1521087932799000
3EF8FC940E379D53BBD3FEFDAF626BB2,1528354153183000
E6FEE8B98E75EA5311FE004F98559A27,1521946646783000
AB32482D193E2CE166B59F82EF78D8BB,1465058160030000
B56E67847E1AE8D6411A5ECCA26585CA,1464515176979000
29845B6298FB882DF53607D21F0E1DF7,1526399609287000
9B27F8491DC5DA23D369F31250BD8D65,1530735588689000
17515C32D8E535AA8A1B18BA774BB90C,1464825069019000
85A84EA2A3017D368F41519312C6D3A2,1491040698768000
037DAC225F0C1E54657770CD201CDDA7,1493351752752000
4BDC831A6940071E2461D0B5293A329E,1488508268636000
84AFEFA3875BA1F17232CB41D06B6EF4,1501958646395000
6B9CFFB3E0DE6FA0C47B8410C4467F89,1517118728976000
59BE43F3FE7AB3F91B016B56508D4C46,1510253570533000
FFFE80A7B9667187D501CE6037876955,1502035332858000
A65FAEAB5577A16B517735A9D9C54958,1518749282042000
84F5D9204EDAE98B3B542AEA93F40BED,1531113646084000
D7EA8E3645EFFBD6443946179ED704A6,1484917445540000
F19B8122771D0514F440E914B722656A,1527565190179000
8BE7BF90C971453A34C1FF6FF2A0ACAE,1531082409656000
AB6FCC6558326ADC858DE37C8D9EB7CD,1492297822381000
EBFE0623EF1109A89B392B9DF4375951,1464524001165000
CA04708DA02378999ECB402481FF1AE4,1465775049218000
CE7404D5A8831F2DE46BD0A013A8ED64,1476102386762000
38C93052B6B68913A433591107F8662C,1513017212873000
9CD32E150A48D09944338963BBE1EA18,1531173893427000
B75FCD833DE643B45B326D2E7AC413E4,1529613021075000
ADDE80C89BB3F6190538E50E541BACD5,1513447410035000
2920B9D90561E521425DE4849FAAD1D7,1530616959546000
B7E6580376A092AF1D8ED36A96EEF943,1522050040217000
74375465CD17299EBC7C75A1B4047EE0,1464513671511000
EE07F52A618BA7AACDCD6712B01F945A,1531162130796000
B5395F8C2077B59B3D6C5719C0CA0339,1470997457644000
F8EBD8316C0FAA906D1335B3D2C04C83,1531126776662000
EBC3581ADA874D494FBE2C7CCF53BF99,1501257623221000
27DCDEB27C0798022EEA48EBAB89D43B,1523706758575000
EF9C32CA65880162136061B25D24E05E,1471062716915000
F26EC6056E284FDDEA7771F203B6BB8F,1480993040678000
945DE7C965AFB12E35C3C992CF9847E2,1526128911909000
0160043392B1572A375E5C3BE1BB0C31,1531045587866000
C136A7CE1D0A52B8D4E5F144DF114EB7,1465988331737000
5F824D23AE3CF750894A96098818E789,1464642394648000
5C5A0787542CD24F1E19F9EB778BA766,1473421832439000
60603343AB8FEECD78B1009C957D193D,1464708615777000
23A7E8D987ADCC38EB026096DC513F85,1469428476961000
B4394AD77C6DE7A5C7385C307F35F84F,1520634662709000
D0F280B12652EB0D74F6BC74AB13606F,1529344858634000
48AB910A8DE8485D4C34238EA61F782C,1507142733492000
EAFD6F2604C8351032764E5F8B4D389E,1493169854516000
75C683C1AE98FC6CCE6EA156C9E90A35,1530862552265000
88A41BFED275BB69125BE1F5524F3B42,1504797808179000
8D31836A6C3C14CE71056BED8925F0A4,1526410365873000
D5F9D9AF22EF5073E10342973D48FB2C,1465200081915000
7566596A1D6ACA781692A7A0B89B06EF,1516571320702000
A05ACB383D79E187B98B95E9C749C416,1531175192147000
693EB525C74694F2E6990CA738F5E5D5,1529538447357000
7F2B633C86B765201C93FDB6FF261143,1531113427644000
331C58F19DE71B2DE30DDC47ECE5CCA6,1529077736411000
B275DC380CF75B352381D5419E397047,1490038870683000
7537C0AA6291AC7B99DC4D2D695EEF1D,1531077611184000
9038CCC5F7D7ABDA6E296D18FFDD1AAA,1519756432112000
6DC90DD09DF860E7C60C00BF36906CB3,1531060349402000
7D613AF4DA0F508C7090E96FD73B7E6D,1464986660111000
FEC117631F54C2699CB76603EBB98CF0,1498005692687000
C795AFA7F574C2BB09D3647AD90A9719,1491444275215000
FEDC59699D8832A11B88BFCCCAD0951D,1494940564484000
017CF202552235BBA4338E0D82A53F43,1465053558350000
B75F91EB6C7FDA9A329567E763CF9E44,1526861938371000
8EDB9A9856CDB5AFC42546106EE46734,1484623632344000
0B99B2EC1247C09535717331F816D42D,1493684508941000
E4196C5E0A92A22F69DE4E3AA288D6EE,1465355988802000
2F5BBABE9DD02
Query:
-- Corrected Query 8:
SELECT "event_date", COUNT(DISTINCT "user_pseudo_id") AS "new_users"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
WHERE "event_date" IS NOT NULL AND "user_pseudo_id" IS NOT NULL
GROUP BY "event_date"
LIMIT 100
Answer:
event_date,new_users
20180709,422
Query:
-- Corrected Query 9:
SELECT "user_pseudo_id", COUNT(*) AS "event_count"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
WHERE "user_pseudo_id" IS NOT NULL
GROUP BY "user_pseudo_id"
ORDER BY "event_count" DESC
LIMIT 10
Answer:
user_pseudo_id,event_count
CC88655DF7CDE5E8225BA20B5D6EC59B,1704
C6DE585349744A40725DB0AB17041BA3,1455
10B0D468B5E036E16D13DB53A65F2D49,1234
B63075B53A750A67A12F7F19ED5AA835,1173
3BBC4DD5C8CA9027CECBEA5C39F80E3A,1049
BE74418BE7B7466F6FE2969CA79FA919,979
0E05F56141200FF41FCC0C7FA297FF08,977
2C84CF723999D48F8F069AFFC184C4DC,949
8040FC9C0479C3B9A74ED298DD8F357D,912
8BE7BF90C971453A34C1FF6FF2A0ACAE,903
Query:
SELECT "user_pseudo_id", COUNT(*) AS "event_count"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
GROUP BY "user_pseudo_id"
ORDER BY "event_count" DESC
LIMIT 10;
Answer:
user_pseudo_id,event_count
CC88655DF7CDE5E8225BA20B5D6EC59B,1704
C6DE585349744A40725DB0AB17041BA3,1455
10B0D468B5E036E16D13DB53A65F2D49,1234
B63075B53A750A67A12F7F19ED5AA835,1173
3BBC4DD5C8CA9027CECBEA5C39F80E3A,1049
BE74418BE7B7466F6FE2969CA79FA919,979
0E05F56141200FF41FCC0C7FA297FF08,977
2C84CF723999D48F8F069AFFC184C4DC,949
8040FC9C0479C3B9A74ED298DD8F357D,912
8BE7BF90C971453A34C1FF6FF2A0ACAE,903
Query:
-- Corrected Query 11:
SELECT "event_name", COUNT(*) AS "event_count"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
GROUP BY "event_name"
ORDER BY "event_count" DESC
LIMIT 100
Answer:
event_name,event_count
screen_view,19976
user_engagement,11827
level_start_quickplay,4445
level_end_quickplay,2964
post_score,2190
level_complete_quickplay,1853
level_fail_quickplay,1111
select_content,1056
level_reset_quickplay,855
level_start,642
session_start,580
level_end,488
level_retry,439
level_up,337
level_complete,318
level_retry_quickplay,269
level_fail,151
spend_virtual_currency,98
level_reset,89
use_extra_steps,88
firebase_campaign,54
first_open,34
app_exception,28
os_update,23
no_more_extra_steps,23
app_remove,18
completed_5_levels,16
ad_reward,12
app_update,7
challenge_a_friend,5
error,4
Query:
-- Corrected Query 12:
SELECT DISTINCT t."platform"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709" t
WHERE t."platform" IS NOT NULL AND t."platform" != ''
LIMIT 100
Answer:
platform
ANDROID
IOS
Query:
-- Corrected Query 13:
SELECT DISTINCT "user_pseudo_id"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
WHERE "event_name" = 'session_start'
LIMIT 100
Answer:
user_pseudo_id
6E018CE86D4601A362A9154B2500348A
23183C7A7E31451194345099C978F49E
3B7AC9CAE2D7BB661BE66F3DE36DD005
9D535D543FD07B8247DEADB4669FADE6
22DC6A6AE86C0AA33EBB8C3164A26925
EF9E8CCCCBBB015CAE0C334AB1745417
85FD06F19EBB6097388EEE0B207598B7
9603F4B5ABFC1E48B0BF68C83669F845
5217AB1A454DAED6243E1C9818BE6A20
5256B2B115955E80DDB7449775D92325
E0F91AA200D6F12DBE53B0D166AFD87B
2F0F260BD7B876C346B41977D0D03D62
E2B530ADD7430BEA6BC7F3D431C8A6FF
71746D859E4E6D655FEE8FFBC3B6C7E9
945DE7C965AFB12E35C3C992CF9847E2
980DEC5BA17132A841D7D7A140333114
0373DF7959F6867CDFB1C905D39CE67C
C6B7ED4E2FA4AABE5693A61B9A07753C
49309C5759610DBF6C829C0D4AB23943
5F824D23AE3CF750894A96098818E789
0160043392B1572A375E5C3BE1BB0C31
77F5E9A5630151C9E831156AEAB4DA11
9F3EAF490630617EF2CB47A8BD2CBBCC
23A7E8D987ADCC38EB026096DC513F85
D7D49CC32C4A23AD56E8DEAE6878EC7B
3827BA312204EA6F6847DFA4222C90CC
4500595CA1FC3CBC6140A502240FB7B4
1F25763EC8BCAEC7FB069E81659A2153
706C748E6D1E0768BFEFE6362B5D3F67
05F7B2C58D627CE948B06C10E39CDF91
7566596A1D6ACA781692A7A0B89B06EF
A29EBFE2A58D7C4D6FDA23C3A53742FF
EF9C32CA65880162136061B25D24E05E
295D9E24D8DE65A010313E667131EF19
7F2B633C86B765201C93FDB6FF261143
60ACC539CFC3DB94C60921D5572C3A4D
4BDC831A6940071E2461D0B5293A329E
D5F9D9AF22EF5073E10342973D48FB2C
17515C32D8E535AA8A1B18BA774BB90C
B275DC380CF75B352381D5419E397047
88A41BFED275BB69125BE1F5524F3B42
1B2FC37816CC4DDAACA97A75E685756F
037DAC225F0C1E54657770CD201CDDA7
7537C0AA6291AC7B99DC4D2D695EEF1D
FFFE80A7B9667187D501CE6037876955
FEC117631F54C2699CB76603EBB98CF0
38DEEAB5F723A89A66CF180A175808D5
FEDC59699D8832A11B88BFCCCAD0951D
D7EA8E3645EFFBD6443946179ED704A6
8040FC9C0479C3B9A74ED298DD8F357D
DB9F0F2561524A9EE1436805AAD70675
F26EC6056E284FDDEA7771F203B6BB8F
C136A7CE1D0A52B8D4E5F144DF114EB7
5C5A0787542CD24F1E19F9EB778BA766
60603343AB8FEECD78B1009C957D193D
B4394AD77C6DE7A5C7385C307F35F84F
F815B0069F973BFA743EF90A85224109
D0F280B12652EB0D74F6BC74AB13606F
4D084D38156128AAA060303AA91E689D
48AB910A8DE8485D4C34238EA61F782C
AB32482D193E2CE166B59F82EF78D8BB
29845B6298FB882DF53607D21F0E1DF7
8D31836A6C3C14CE71056BED8925F0A4
6B9CFFB3E0DE6FA0C47B8410C4467F89
3EF8FC940E379D53BBD3FEFDAF626BB2
E6FEE8B98E75EA5311FE004F98559A27
2F5B044B41268F6643EB4D0EF15D4E87
8E6F7A428C907165D78A2377ABEB7315
B56E67847E1AE8D6411A5ECCA26585CA
0E05F56141200FF41FCC0C7FA297FF08
9038CCC5F7D7ABDA6E296D18FFDD1AAA
59BE43F3FE7AB3F91B016B56508D4C46
A65FAEAB5577A16B517735A9D9C54958
C795AFA7F574C2BB09D3647AD90A9719
84F5D9204EDAE98B3B542AEA93F40BED
017CF202552235BBA4338E0D82A53F43
F19B8122771D0514F440E914B722656A
EBFE0623EF1109A89B392B9DF4375951
CA04708DA02378999ECB402481FF1AE4
2F5BBABE9DD0271DCD62E501F76DA736
59454BAC415BB1F18517C6FD2C023E49
8BE7BF90C971453A34C1FF6FF2A0ACAE
6D4F9673F3DADCB39EE913EFCA2AE282
359B5B95C8B1DF723D939A5A8AFF0904
D299D5763E03F1CC4DA8550AF1B4CEE4
2C84CF723999D48F8F069AFFC184C4DC
F3917138A3D4B03ADA1C2E77E3B84649
97813C801E4E2F479172790F3F2E4071
CE7404D5A8831F2DE46BD0A013A8ED64
3BBC4DD5C8CA9027CECBEA5C39F80E3A
E84BFE62196E059C66D049BA9A14061C
9B18A1CBA96D52D05CFA7CB7C9011EDE
1B2A9E461E99FB1D165894AFE613AD73
4BF98D09CA8359FC59ADAF56D00338F8
B75F91EB6C7FDA9A329567E763CF9E44
8EDB9A9856CDB5AFC42546106EE46734
E4196C5E0A92A22F69DE4E3AA288D6EE
10522BF919A454B898540F51FFDCB292
D3F06F9B7BD9D7FC8758BF78BF0705E9
1F732B8A151B6C6249323BC65CA9C1F9
Query:
-- Corrected Query 14:
SELECT COUNT(DISTINCT t."user_pseudo_id") AS "returning_users"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709" t
WHERE t."user_pseudo_id" IN (
  SELECT "user_pseudo_id"
  FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180708"
)
Answer:
returning_users
132
Query:
-- Corrected Query 15:
SELECT t."user_pseudo_id", t."geo"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709" t
LIMIT 100
Answer:
Too long, hard cut:
user_pseudo_id,geo
AE9C7A5E358F2E0E0E90E4B8DD67AE76,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
AE9C7A5E358F2E0E0E90E4B8DD67AE76,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
AE9C7A5E358F2E0E0E90E4B8DD67AE76,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
AE9C7A5E358F2E0E0E90E4B8DD67AE76,"{
  ""continent"": ""Americas"",
  ""country"": ""United States""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": ""United Kingdom""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""continent"": ""Europe"",
  ""country"": "
Query:
-- Corrected Query 16:
SELECT t."user_pseudo_id", t."app_info"
FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709" t
LIMIT 100
Answer:
Too long, hard cut:
user_pseudo_id,app_info
AE9C7A5E358F2E0E0E90E4B8DD67AE76,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
AE9C7A5E358F2E0E0E90E4B8DD67AE76,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
AE9C7A5E358F2E0E0E90E4B8DD67AE76,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
AE9C7A5E358F2E0E0E90E4B8DD67AE76,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:android:9b9ba2ce17104d0c"",
  ""id"": ""com.labpixies.flood"",
  ""install_source"": ""com.android.vending"",
  ""version"": ""2.62""
}"
6E018CE86D4601A362A9154B2500348A,"{
  ""firebase_app_id"": ""1:300830567303:a
End Exploring Related Columns
Task: Please conduct a weekly cohort analysis for user retention starting July 9, 2018. Group users by their first week of app use and calculate the retention rates for each cohort over the next two weeks, showing the rate of the original cohort that returned each week. The data is available up to October 2, 2018.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Cohort_Week,Week0_Retention_Rate,Week1_Retention_Rate,Week2_Retention_Rate
2018-07-09 to 2018-07-15,100,rate1:0<=float<=100,rate2:0<=float<=100
2018-07-16 to 2018-07-22,100,rate1:0<=float<=100,rate2:0<=float<=100
...
```

This table presents the weekly cohorts of users starting from July 9, 2018. Each row represents users who first used the app during that week. The `Week0_Retention_Rate` is 100%, indicating the initial cohort size. The `Week1_Retention_Rate` and `Week2_Retention_Rate` columns show the percentage of the original cohort that returned in the subsequent two weeks..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'FIREBASE': {'ANALYTICS_153293282': ['EVENTS_20180612', 'EVENTS_20180613', 'EVENTS_20180614', 'EVENTS_20180615', 'EVENTS_20180616', 'EVENTS_20180617', 'EVENTS_20180618', 'EVENTS_20180619', 'EVENTS_20180620', 'EVENTS_20180621', 'EVENTS_20180622', 'EVENTS_20180623', 'EVENTS_20180624', 'EVENTS_20180625', 'EVENTS_20180626', 'EVENTS_20180627', 'EVENTS_20180628', 'EVENTS_20180629', 'EVENTS_20180630', 'EVENTS_20180701', 'EVENTS_20180702', 'EVENTS_20180703', 'EVENTS_20180704', 'EVENTS_20180705', 'EVENTS_20180706', 'EVENTS_20180707', 'EVENTS_20180708', 'EVENTS_20180709', 'EVENTS_20180710', 'EVENTS_20180711', 'EVENTS_20180712', 'EVENTS_20180713', 'EVENTS_20180714', 'EVENTS_20180715', 'EVENTS_20180716', 'EVENTS_20180717', 'EVENTS_20180718', 'EVENTS_20180719', 'EVENTS_20180720', 'EVENTS_20180721', 'EVENTS_20180722', 'EVENTS_20180723', 'EVENTS_20180724', 'EVENTS_20180725', 'EVENTS_20180726', 'EVENTS_20180727', 'EVENTS_20180728', 'EVENTS_20180729', 'EVENTS_20180730', 'EVENTS_20180731', 'EVENTS_20180801', 'EVENTS_20180802', 'EVENTS_20180803', 'EVENTS_20180804', 'EVENTS_20180805', 'EVENTS_20180806', 'EVENTS_20180807', 'EVENTS_20180808', 'EVENTS_20180809', 'EVENTS_20180810', 'EVENTS_20180811', 'EVENTS_20180812', 'EVENTS_20180813', 'EVENTS_20180814', 'EVENTS_20180815', 'EVENTS_20180816', 'EVENTS_20180817', 'EVENTS_20180818', 'EVENTS_20180819', 'EVENTS_20180820', 'EVENTS_20180821', 'EVENTS_20180822', 'EVENTS_20180823', 'EVENTS_20180824', 'EVENTS_20180825', 'EVENTS_20180826', 'EVENTS_20180827', 'EVENTS_20180828', 'EVENTS_20180829', 'EVENTS_20180830', 'EVENTS_20180831', 'EVENTS_20180901', 'EVENTS_20180902', 'EVENTS_20180903', 'EVENTS_20180904', 'EVENTS_20180905', 'EVENTS_20180906', 'EVENTS_20180907', 'EVENTS_20180908', 'EVENTS_20180909', 'EVENTS_20180910', 'EVENTS_20180911', 'EVENTS_20180912', 'EVENTS_20180913', 'EVENTS_20180914', 'EVENTS_20180915', 'EVENTS_20180916', 'EVENTS_20180917', 'EVENTS_20180918', 'EVENTS_20180919', 'EVENTS_20180920', 'EVENTS_20180921', 'EVENTS_20180922', 'EVENTS_20180923', 'EVENTS_20180924', 'EVENTS_20180925', 'EVENTS_20180926', 'EVENTS_20180927', 'EVENTS_20180928', 'EVENTS_20180929', 'EVENTS_20180930', 'EVENTS_20181001', 'EVENTS_20181002', 'EVENTS_20181003']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-24 15:31:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 15:31:38 - root - INFO - ```sql
WITH
all_events AS (
  SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180710"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180711"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180712"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180713"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180714"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180715"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180717"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180718"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180719"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180720"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180721"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180722"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180723"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180724"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180725"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180726"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180727"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180728"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180729"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180730"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180731"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180802"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180803"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180804"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180805"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180806"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180807"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180809"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180810"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180811"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180812"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180813"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180814"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180816"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180817"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180818"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180819"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180820"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180821"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180822"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180823"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180824"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180825"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180826"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180827"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180828"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180829"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180830"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180831"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180904"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180905"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180906"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180907"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180909"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180910"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180911"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180912"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180913"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180914"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180916"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180917"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180918"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180919"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180920"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180921"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180923"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180924"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180925"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180926"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180927"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180928"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180929"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180930"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20181001"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20181002"
),
all_events_with_weeks AS (
  SELECT "user_pseudo_id",
         TO_DATE("event_date", 'YYYYMMDD') AS "event_date",
         DATE_TRUNC('WEEK', TO_DATE("event_date", 'YYYYMMDD')) AS "event_week"
  FROM all_events
),
first_event_per_user AS (
  SELECT "user_pseudo_id", MIN("event_date") AS "first_event_date"
  FROM all_events_with_weeks
  GROUP BY "user_pseudo_id"
),
user_cohorts AS (
  SELECT "user_pseudo_id",
         "first_event_date",
         DATE_TRUNC('WEEK', "first_event_date") AS "cohort_week"
  FROM first_event_per_user
),
activity_weeks AS (
  SELECT uc."user_pseudo_id",
         uc."cohort_week",
         aw."event_week",
         DATE_DIFF('WEEK', uc."cohort_week", aw."event_week") AS "week_number"
  FROM user_cohorts uc
  JOIN all_events_with_weeks aw
    ON uc."user_pseudo_id" = aw."user_pseudo_id"
),
cohorts_data AS (
  SELECT "cohort_week", COUNT(DISTINCT "user_pseudo_id") AS "cohort_size"
  FROM user_cohorts
  GROUP BY "cohort_week"
),
retention_data AS (
  SELECT "cohort_week", "week_number", COUNT(DISTINCT "user_pseudo_id") AS "users_retained"
  FROM activity_weeks
  WHERE "week_number" IN (0,1,2)
  GROUP BY "cohort_week", "week_number"
),
final_table AS (
  SELECT
    cd."cohort_week",
    cd."cohort_size",
    COALESCE(MAX(CASE WHEN rd."week_number" = 0 THEN rd."users_retained" END), 0) AS "Week0_users",
    COALESCE(MAX(CASE WHEN rd."week_number" = 1 THEN rd."users_retained" END), 0) AS "Week1_users",
    COALESCE(MAX(CASE WHEN rd."week_number" = 2 THEN rd."users_retained" END), 0) AS "Week2_users"
  FROM
    cohorts_data cd
  LEFT JOIN
    retention_data rd
  ON
    cd."cohort_week" = rd."cohort_week"
  GROUP BY
    cd."cohort_week", cd."cohort_size"
)
SELECT
  TO_CHAR("cohort_week", 'YYYY-MM-DD') || ' to ' || TO_CHAR(DATEADD('day',6,"cohort_week"),'YYYY-MM-DD') AS "Cohort_Week",
  100 AS "Week0_Retention_Rate",
  ROUND(("Week1_users" / "cohort_size") * 100.0, 4) AS "Week1_Retention_Rate",
  ROUND(("Week2_users" / "cohort_size") * 100.0, 4) AS "Week2_Retention_Rate"
FROM final_table
ORDER BY "cohort_week";
```
2025-01-24 15:31:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 15:31:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 15:31:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 15:31:40 - snowflake.connector.connection - INFO - closed
2025-01-24 15:31:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 15:31:40 - root - INFO - itercount: 1
2025-01-24 15:31:40 - root - INFO - 002140 (42601): 01b9eda3-0004-7d15-0001-11c300f96a1a: SQL compilation error:
Unknown function DATE_DIFF
2025-01-24 15:31:40 - root - INFO - Input sql:
WITH
all_events AS (
  SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180710"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180711"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180712"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180713"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180714"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180715"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180717"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180718"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180719"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180720"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180721"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180722"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180723"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180724"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180725"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180726"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180727"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180728"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180729"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180730"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180731"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180802"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180803"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180804"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180805"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180806"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180807"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180809"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180810"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180811"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180812"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180813"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180814"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180816"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180817"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180818"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180819"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180820"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180821"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180822"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180823"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180824"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180825"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180826"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180827"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180828"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180829"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180830"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180831"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180904"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180905"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180906"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180907"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180909"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180910"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180911"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180912"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180913"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180914"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180916"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180917"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180918"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180919"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180920"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180921"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180923"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180924"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180925"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180926"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180927"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180928"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180929"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180930"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20181001"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20181002"
),
all_events_with_weeks AS (
  SELECT "user_pseudo_id",
         TO_DATE("event_date", 'YYYYMMDD') AS "event_date",
         DATE_TRUNC('WEEK', TO_DATE("event_date", 'YYYYMMDD')) AS "event_week"
  FROM all_events
),
first_event_per_user AS (
  SELECT "user_pseudo_id", MIN("event_date") AS "first_event_date"
  FROM all_events_with_weeks
  GROUP BY "user_pseudo_id"
),
user_cohorts AS (
  SELECT "user_pseudo_id",
         "first_event_date",
         DATE_TRUNC('WEEK', "first_event_date") AS "cohort_week"
  FROM first_event_per_user
),
activity_weeks AS (
  SELECT uc."user_pseudo_id",
         uc."cohort_week",
         aw."event_week",
         DATE_DIFF('WEEK', uc."cohort_week", aw."event_week") AS "week_number"
  FROM user_cohorts uc
  JOIN all_events_with_weeks aw
    ON uc."user_pseudo_id" = aw."user_pseudo_id"
),
cohorts_data AS (
  SELECT "cohort_week", COUNT(DISTINCT "user_pseudo_id") AS "cohort_size"
  FROM user_cohorts
  GROUP BY "cohort_week"
),
retention_data AS (
  SELECT "cohort_week", "week_number", COUNT(DISTINCT "user_pseudo_id") AS "users_retained"
  FROM activity_weeks
  WHERE "week_number" IN (0,1,2)
  GROUP BY "cohort_week", "week_number"
),
final_table AS (
  SELECT
    cd."cohort_week",
    cd."cohort_size",
    COALESCE(MAX(CASE WHEN rd."week_number" = 0 THEN rd."users_retained" END), 0) AS "Week0_users",
    COALESCE(MAX(CASE WHEN rd."week_number" = 1 THEN rd."users_retained" END), 0) AS "Week1_users",
    COALESCE(MAX(CASE WHEN rd."week_number" = 2 THEN rd."users_retained" END), 0) AS "Week2_users"
  FROM
    cohorts_data cd
  LEFT JOIN
    retention_data rd
  ON
    cd."cohort_week" = rd."cohort_week"
  GROUP BY
    cd."cohort_week", cd."cohort_size"
)
SELECT
  TO_CHAR("cohort_week", 'YYYY-MM-DD') || ' to ' || TO_CHAR(DATEADD('day',6,"cohort_week"),'YYYY-MM-DD') AS "Cohort_Week",
  100 AS "Week0_Retention_Rate",
  ROUND(("Week1_users" / "cohort_size") * 100.0, 4) AS "Week1_Retention_Rate",
  ROUND(("Week2_users" / "cohort_size") * 100.0, 4) AS "Week2_Retention_Rate"
FROM final_table
ORDER BY "cohort_week";
The error information is:
002140 (42601): 01b9eda3-0004-7d15-0001-11c300f96a1a: SQL compilation error:
Unknown function DATE_DIFF
Please correct it and output only 1 complete SQL query.
2025-01-24 15:33:23 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 15:33:23 - root - INFO - ```sql
WITH
all_events AS (
  SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180710"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180711"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180712"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180713"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180714"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180715"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180717"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180718"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180719"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180720"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180721"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180722"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180723"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180724"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180725"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180726"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180727"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180728"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180729"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180730"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180731"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180802"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180803"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180804"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180805"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180806"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180807"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180809"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180810"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180811"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180812"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180813"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180814"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180816"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180817"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180818"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180819"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180820"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180821"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180822"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180823"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180824"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180825"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180826"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180827"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180828"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180829"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180830"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180831"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180904"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180905"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180906"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180907"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180909"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180910"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180911"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180912"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180913"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180914"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180916"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180917"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180918"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180919"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180920"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180921"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180923"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180924"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180925"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180926"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180927"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180928"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180929"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180930"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20181001"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20181002"
),
all_events_with_weeks AS (
  SELECT "user_pseudo_id",
         TO_DATE("event_date", 'YYYYMMDD') AS "event_date",
         DATE_TRUNC('WEEK', TO_DATE("event_date", 'YYYYMMDD')) AS "event_week"
  FROM all_events
),
first_event_per_user AS (
  SELECT "user_pseudo_id", MIN("event_date") AS "first_event_date"
  FROM all_events_with_weeks
  GROUP BY "user_pseudo_id"
),
user_cohorts AS (
  SELECT "user_pseudo_id",
         "first_event_date",
         DATE_TRUNC('WEEK', "first_event_date") AS "cohort_week"
  FROM first_event_per_user
),
activity_weeks AS (
  SELECT uc."user_pseudo_id",
         uc."cohort_week",
         aw."event_week",
         DATEDIFF('WEEK', uc."cohort_week", aw."event_week") AS "week_number"
  FROM user_cohorts uc
  JOIN all_events_with_weeks aw
    ON uc."user_pseudo_id" = aw."user_pseudo_id"
),
cohorts_data AS (
  SELECT "cohort_week", COUNT(DISTINCT "user_pseudo_id") AS "cohort_size"
  FROM user_cohorts
  GROUP BY "cohort_week"
),
retention_data AS (
  SELECT "cohort_week", "week_number", COUNT(DISTINCT "user_pseudo_id") AS "users_retained"
  FROM activity_weeks
  WHERE "week_number" IN (0,1,2)
  GROUP BY "cohort_week", "week_number"
),
final_table AS (
  SELECT
    cd."cohort_week",
    cd."cohort_size",
    COALESCE(MAX(CASE WHEN rd."week_number" = 0 THEN rd."users_retained" END), 0) AS "Week0_users",
    COALESCE(MAX(CASE WHEN rd."week_number" = 1 THEN rd."users_retained" END), 0) AS "Week1_users",
    COALESCE(MAX(CASE WHEN rd."week_number" = 2 THEN rd."users_retained" END), 0) AS "Week2_users"
  FROM
    cohorts_data cd
  LEFT JOIN
    retention_data rd
  ON
    cd."cohort_week" = rd."cohort_week"
  GROUP BY
    cd."cohort_week", cd."cohort_size"
)
SELECT
  TO_CHAR("cohort_week", 'YYYY-MM-DD') || ' to ' || TO_CHAR(DATEADD('day',6,"cohort_week"),'YYYY-MM-DD') AS "Cohort_Week",
  100 AS "Week0_Retention_Rate",
  ROUND(("Week1_users" / "cohort_size") * 100.0, 4) AS "Week1_Retention_Rate",
  ROUND(("Week2_users" / "cohort_size") * 100.0, 4) AS "Week2_Retention_Rate"
FROM final_table
ORDER BY "cohort_week";
```
2025-01-24 15:33:23 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 15:33:23 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 15:33:23 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 15:33:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 13
2025-01-24 15:33:33 - snowflake.connector.connection - INFO - closed
2025-01-24 15:33:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 15:33:33 - root - INFO - itercount: 2
2025-01-24 15:33:33 - root - INFO - 0
2025-01-24 15:33:33 - root - INFO - results: 
Cohort_Week,Week0_Retention_Rate,Week1_Retention_Rate,Week2_Retention_Rate
2018-07-09 to 2018-07-15,100,39.6178,38.6624
2018-07-16 to 2018-07-22,100,27.1368,23.1838
2018-07-23 to 2018-07-29,100,22.3039,16.5441
2018-07-30 to 2018-08-05,100,19.1130,14.1499
2018-08-06 to 2018-08-12,100,19.9450,11.8294
2018-08-13 to 2018-08-19,100,22.9430,14.3987
2018-08-20 to 2018-08-26,100,15.9930,8.7873
2018-08-27 to 2018-09-02,100,22.9426,19.9501
2018-09-03 to 2018-09-09,100,27.1464,27.0646
2018-09-10 to 2018-09-16,100,17.8245,15.6307
2018-09-17 to 2018-09-23,100,19.7022,2.0619
2018-09-24 to 2018-09-30,100,7.7396,0.0000
2018-10-01 to 2018-10-07,100,0.0000,0.0000


2025-01-24 15:33:33 - root - INFO - Please check the answer again by reviewing Please conduct a weekly cohort analysis for user retention starting July 9, 2018. Group users by their first week of app use and calculate the retention rates for each cohort over the next two weeks, showing the rate of the original cohort that returned each week. The data is available up to October 2, 2018., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Cohort_Week,Week0_Retention_Rate,Week1_Retention_Rate,Week2_Retention_Rate
2018-07-09 to 2018-07-15,100,rate1:0<=float<=100,rate2:0<=float<=100
2018-07-16 to 2018-07-22,100,rate1:0<=float<=100,rate2:0<=float<=100
...
```

This table presents the weekly cohorts of users starting from July 9, 2018. Each row represents users who first used the app during that week. The `Week0_Retention_Rate` is 100%, indicating the initial cohort size. The `Week1_Retention_Rate` and `Week2_Retention_Rate` columns show the percentage of the original cohort that returned in the subsequent two weeks. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Cohort_Week,Week0_Retention_Rate,Week1_Retention_Rate,Week2_Retention_Rate
2018-07-09 to 2018-07-15,100,39.6178,38.6624
2018-07-16 to 2018-07-22,100,27.1368,23.1838
2018-07-23 to 2018-07-29,100,22.3039,16.5441
2018-07-30 to 2018-08-05,100,19.1130,14.1499
2018-08-06 to 2018-08-12,100,19.9450,11.8294
2018-08-13 to 2018-08-19,100,22.9430,14.3987
2018-08-20 to 2018-08-26,100,15.9930,8.7873
2018-08-27 to 2018-09-02,100,22.9426,19.9501
2018-09-03 to 2018-09-09,100,27.1464,27.0646
2018-09-10 to 2018-09-16,100,17.8245,15.6307
2018-09-17 to 2018-09-23,100,19.7022,2.0619
2018-09-24 to 2018-09-30,100,7.7396,0.0000
2018-10-01 to 2018-10-07,100,0.0000,0.0000
Current sql:
WITH
all_events AS (
  SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180710"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180711"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180712"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180713"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180714"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180715"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180717"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180718"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180719"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180720"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180721"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180722"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180723"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180724"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180725"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180726"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180727"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180728"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180729"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180730"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180731"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180802"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180803"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180804"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180805"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180806"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180807"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180809"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180810"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180811"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180812"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180813"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180814"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180816"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180817"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180818"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180819"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180820"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180821"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180822"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180823"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180824"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180825"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180826"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180827"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180828"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180829"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180830"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180831"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180904"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180905"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180906"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180907"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180909"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180910"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180911"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180912"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180913"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180914"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180916"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180917"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180918"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180919"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180920"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180921"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180923"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180924"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180925"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180926"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180927"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180928"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180929"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180930"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20181001"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20181002"
),
all_events_with_weeks AS (
  SELECT "user_pseudo_id",
         TO_DATE("event_date", 'YYYYMMDD') AS "event_date",
         DATE_TRUNC('WEEK', TO_DATE("event_date", 'YYYYMMDD')) AS "event_week"
  FROM all_events
),
first_event_per_user AS (
  SELECT "user_pseudo_id", MIN("event_date") AS "first_event_date"
  FROM all_events_with_weeks
  GROUP BY "user_pseudo_id"
),
user_cohorts AS (
  SELECT "user_pseudo_id",
         "first_event_date",
         DATE_TRUNC('WEEK', "first_event_date") AS "cohort_week"
  FROM first_event_per_user
),
activity_weeks AS (
  SELECT uc."user_pseudo_id",
         uc."cohort_week",
         aw."event_week",
         DATEDIFF('WEEK', uc."cohort_week", aw."event_week") AS "week_number"
  FROM user_cohorts uc
  JOIN all_events_with_weeks aw
    ON uc."user_pseudo_id" = aw."user_pseudo_id"
),
cohorts_data AS (
  SELECT "cohort_week", COUNT(DISTINCT "user_pseudo_id") AS "cohort_size"
  FROM user_cohorts
  GROUP BY "cohort_week"
),
retention_data AS (
  SELECT "cohort_week", "week_number", COUNT(DISTINCT "user_pseudo_id") AS "users_retained"
  FROM activity_weeks
  WHERE "week_number" IN (0,1,2)
  GROUP BY "cohort_week", "week_number"
),
final_table AS (
  SELECT
    cd."cohort_week",
    cd."cohort_size",
    COALESCE(MAX(CASE WHEN rd."week_number" = 0 THEN rd."users_retained" END), 0) AS "Week0_users",
    COALESCE(MAX(CASE WHEN rd."week_number" = 1 THEN rd."users_retained" END), 0) AS "Week1_users",
    COALESCE(MAX(CASE WHEN rd."week_number" = 2 THEN rd."users_retained" END), 0) AS "Week2_users"
  FROM
    cohorts_data cd
  LEFT JOIN
    retention_data rd
  ON
    cd."cohort_week" = rd."cohort_week"
  GROUP BY
    cd."cohort_week", cd."cohort_size"
)
SELECT
  TO_CHAR("cohort_week", 'YYYY-MM-DD') || ' to ' || TO_CHAR(DATEADD('day',6,"cohort_week"),'YYYY-MM-DD') AS "Cohort_Week",
  100 AS "Week0_Retention_Rate",
  ROUND(("Week1_users" / "cohort_size") * 100.0, 4) AS "Week1_Retention_Rate",
  ROUND(("Week2_users" / "cohort_size") * 100.0, 4) AS "Week2_Retention_Rate"
FROM final_table
ORDER BY "cohort_week";
2025-01-24 15:34:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 15:34:38 - root - INFO - ```sql
WITH
all_events AS (
  SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180709"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180710"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180711"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180712"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180713"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180714"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180715"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180716"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180717"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180718"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180719"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180720"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180721"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180722"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180723"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180724"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180725"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180726"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180727"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180728"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180729"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180730"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180731"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180801"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180802"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180803"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180804"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180805"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180806"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180807"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180808"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180809"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180810"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180811"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180812"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180813"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180814"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180815"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180816"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180817"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180818"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180819"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180820"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180821"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180822"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180823"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180824"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180825"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180826"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180827"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180828"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180829"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180830"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180831"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180901"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180902"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180903"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180904"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180905"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180906"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180907"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180908"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180909"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180910"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180911"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180912"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180913"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180914"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180915"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180916"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180917"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180918"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180919"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180920"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180921"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180922"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180923"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180924"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180925"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180926"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180927"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180928"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180929"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20180930"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20181001"
  UNION ALL SELECT "user_pseudo_id", "event_date" FROM "FIREBASE"."ANALYTICS_153293282"."EVENTS_20181002"
),
all_events_with_weeks AS (
  SELECT "user_pseudo_id",
         TO_DATE("event_date", 'YYYYMMDD') AS "event_date",
         DATE_TRUNC('WEEK', TO_DATE("event_date", 'YYYYMMDD')) AS "event_week"
  FROM all_events
),
first_event_per_user AS (
  SELECT "user_pseudo_id", MIN("event_date") AS "first_event_date"
  FROM all_events_with_weeks
  GROUP BY "user_pseudo_id"
),
user_cohorts AS (
  SELECT "user_pseudo_id",
         "first_event_date",
         DATE_TRUNC('WEEK', "first_event_date") AS "cohort_week"
  FROM first_event_per_user
),
activity_weeks AS (
  SELECT uc."user_pseudo_id",
         uc."cohort_week",
         aw."event_week",
         DATEDIFF('WEEK', uc."cohort_week", aw."event_week") AS "week_number"
  FROM user_cohorts uc
  JOIN all_events_with_weeks aw
    ON uc."user_pseudo_id" = aw."user_pseudo_id"
),
cohorts_data AS (
  SELECT "cohort_week", COUNT(DISTINCT "user_pseudo_id") AS "cohort_size"
  FROM user_cohorts
  GROUP BY "cohort_week"
),
retention_data AS (
  SELECT "cohort_week", "week_number", COUNT(DISTINCT "user_pseudo_id") AS "users_retained"
  FROM activity_weeks
  WHERE "week_number" IN (0,1,2)
  GROUP BY "cohort_week", "week_number"
),
final_table AS (
  SELECT
    cd."cohort_week",
    cd."cohort_size",
    COALESCE(MAX(CASE WHEN rd."week_number" = 0 THEN rd."users_retained" END), 0) AS "Week0_users",
    COALESCE(MAX(CASE WHEN rd."week_number" = 1 THEN rd."users_retained" END), 0) AS "Week1_users",
    COALESCE(MAX(CASE WHEN rd."week_number" = 2 THEN rd."users_retained" END), 0) AS "Week2_users"
  FROM
    cohorts_data cd
  LEFT JOIN
    retention_data rd
  ON
    cd."cohort_week" = rd."cohort_week"
  GROUP BY
    cd."cohort_week", cd."cohort_size"
)
SELECT
  TO_CHAR("cohort_week", 'YYYY-MM-DD') || ' to ' || TO_CHAR(DATEADD('day',6,"cohort_week"),'YYYY-MM-DD') AS "Cohort_Week",
  100 AS "Week0_Retention_Rate",
  ROUND(("Week1_users" / "cohort_size") * 100.0, 4) AS "Week1_Retention_Rate",
  ROUND(("Week2_users" / "cohort_size") * 100.0, 4) AS "Week2_Retention_Rate"
FROM final_table
ORDER BY "cohort_week";
```
2025-01-24 15:34:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 15:34:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 15:34:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 15:34:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 13
2025-01-24 15:34:39 - snowflake.connector.connection - INFO - closed
2025-01-24 15:34:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 15:34:40 - root - INFO - itercount: 3
2025-01-24 15:34:40 - root - INFO - 0
2025-01-24 15:34:40 - root - INFO - Total iteration counts: 3
