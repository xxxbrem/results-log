2025-01-25 10:25:23 - openai._base_client - INFO - Retrying request to /chat/completions in 0.389807 seconds
2025-01-25 10:26:24 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:26:24 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:26:24 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:26:24 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:26:26 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:26:26 - snowflake.connector.connection - INFO - closed
2025-01-25 10:26:26 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:26:26 - root - INFO - SQL:
SELECT "publication_number", "assignee_harmonized"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "assignee_harmonized" LIKE '%DENSO CORP%'
   LIMIT 100;
Results:
Too long, hard cut:
publication_number,assignee_harmonized
US-2003122645-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""DENSO CORP""
  }
]"
US-2009266335-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2007200067-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
WO-2018016219-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
WO-2018096760-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
WO-2020066482-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
DE-102004042762-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
DE-102004061882-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2007289384-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-7568400-B2,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""JTEKT CORP""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2016148856-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2021261142-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2021325116-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2022028029-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2022190113-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""TOYOTA MOTOR CO LTD""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""MIRISE Technologies Corporation""
  }
]"
US-2021276398-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2024167830-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
DE-10218083-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""NIPPON SOKEN""
  }
]"
US-2018004315-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2021010842-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2020361416-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2005046395-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2005209755-A1,"[
  {
    ""country_code"": """",
    ""name"": ""DENSO CORP""
  }
]"
US-2006057953-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
DE-102021120645-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2023394418-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2023207423-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""TOYOTA MOTOR CO LTD""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""MIRISE Technologies Corporation""
  }
]"
DE-10129321-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2019152298-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2021017924-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2021041508-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2019222810-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2006213254-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2009148329-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2011010085-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2014346853-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""ADVICS CO LTD""
  }
]"
US-2024010045-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2024004972-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2024017616-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2024123834-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2024246568-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
JP-H10209446-A,"[
  {
    ""country_code"": """",
    ""name"": ""DENSO CORP""
  }
]"
US-9127612-B2,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""NAKATA KENICHIRO""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""ISHIZUKA KOJI""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2004178870-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2006152215-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2008082260-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2008227599-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2022066210-A1,"[
  {
    ""country_code"": ""JP"",
 

2025-01-25 10:26:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:26:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:26:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:26:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:26:27 - snowflake.connector.connection - INFO - closed
2025-01-25 10:26:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:26:28 - root - INFO - SQL:
SELECT DISTINCT "publication_number"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "assignee_harmonized" LIKE '%DENSO CORP%'
   LIMIT 100;
Results:
publication_number
DE-69911567-T9
DE-102006000312-B4
JP-2000116145-A
US-2020303905-A1
JP-2011119585-A
JP-H09109037-A
DE-112015002407-T5
US-11067688-B2
JP-2008295110-A
US-2024123834-A1
US-2018340128-A1
JP-H0979783-A
JP-2005123257-A
JP-2020056752-A
CN-102770233-B
JP-2007183241-A
JP-2008240337-A
US-2005178609-A1
CN-107002235-A
US-9087924-B2
DE-102008036832-A1
JP-2004191321-A
US-2007200067-A1
US-2022190113-A1
JP-2012219767-A
JP-2006264404-A
CN-107950006-A
US-2024004972-A1
US-2024017616-A1
JP-2002174152-A
JP-2008215135-A
US-2019092325-A1
JP-2021163369-A
JP-2011228778-A
DE-69739014-D1
WO-2021033757-A1
WO-2024162212-A1
DE-102019101566-A1
JP-2000358305-A
US-2021325116-A1
JP-2003039931-A
JP-2014144497-A
JP-2013160905-A
CN-101413443-A
JP-2003300410-A
DE-102014209298-B4
WO-2018079560-A1
JP-2020061437-A
JP-2008293269-A
DE-102009004384-A1
DE-112014001661-T5
JP-2012086626-A
JP-2019166967-A
US-6989627-B2
JP-2008183499-A
JP-H10103210-A
JP-2007118830-A
JP-2018199473-A
JP-2020054063-A
SE-524656-C2
JP-2001143748-A
WO-2023054546-A1
JP-2009088350-A
US-2015314783-A1
JP-2000192874-A
JP-2001294036-A
JP-2004330961-A
US-2006152215-A1
US-2019152298-A1
JP-2005166291-A
CN-113646595-A
JP-2007040791-A
US-2018006520-A1
JP-2010083245-A
JP-2016133108-A
JP-2021110849-A
US-2020408440-A1
US-10790774-B2
US-2008227599-A1
BR-PI0714595-A2
JP-2016030554-A
JP-2010242621-A
JP-2001082835-A
JP-2010147228-A
JP-2011073503-A
JP-2015137587-A
US-2020361416-A1
WO-2021112035-A1
DE-112016001259-B4
WO-2018096760-A1
JP-2019002836-A
JP-2008116822-A
JP-2004023754-A
CN-102857275-A
JP-2023138787-A
DE-102007016068-A1
JP-2015173414-A
JP-2014149784-A
US-2018004315-A1
DE-112022002330-T5

2025-01-25 10:26:28 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:26:28 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:26:28 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:26:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:26:29 - snowflake.connector.connection - INFO - closed
2025-01-25 10:26:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:26:30 - root - INFO - SQL:
SELECT "publication_number", "citation"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100;
Results:
publication_number,citation
CR-5634-A,[]
CR-5990-A,[]
FI-429-A,[]
HK-6083-A,[]
HU-T52763-A,[]
JP-H03206829-A,[]
JP-S62159089-A,[]
US-416-A,[]
US-2528225-A,"[
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-1632271-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-1959660-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2013863-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2144669-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2154308-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2155785-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2190901-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2207418-A"",
    ""type"": """"
  }
]"
AT-A41580-A,[]
AT-A47682-A,[]
AT-A63682-A,[]
CA-920790-A,[]
CA-950907-A,[]
CA-920830-A,[]
CA-9086-A,[]
CH-3256-A,[]
CH-540255-A,[]
CH-433637-A,[]
CH-8494-A,[]
CH-9587-A,[]
CH-9968-A,[]
DD-8297-A,[]
FR-1334211-A,[]
FR-1444995-A,[]
FR-1474468-A,[]
FR-1478988-A,[]
FR-1485992-A,[]
FR-1487706-A,[]
FR-1508237-A,[]
GB-893001-A,[]
GB-873984-A,[]
GB-307790-A,[]
GB-534192-A,[]
HK-39487-A,[]
HK-52284-A,[]
HK-55992-A,[]
HK-60178-A,[]
HK-82486-A,[]
HU-T58725-A,[]
JP-S62157892-A,[]
JP-H06198910-A,[]
MA-42286-A,[]
OA-07542-A,[]
OA-08399-A,[]
PH-11723-A,[]
PH-15213-A,[]
PH-17928-A,[]
PH-23905-A,[]
TR-26506-A,[]
US-4613-A,[]
US-4234270-A,"[
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2187871-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2414011-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-3708987-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-3720066-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-3793842-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": ""Engineering News Record, May 10, 1973, p. 39."",
    ""publication_number"": """",
    ""type"": """"
  }
]"
US-6310-A,[]
US-8947-A,[]
YU-24971-A,[]
YU-51397-A,[]
YU-53588-A,[]
YU-94082-A,[]
AT-A134275-A,[]
AT-A160683-A,[]
AT-A168281-A,[]
AT-A179178-A,[]
AT-A196182-A,[]
AT-A202882-A,[]
AT-A205780-A,[]
AT-A245590-A,[]
AT-A250686-A,[]
AT-A269985-A,[]
AT-A272073-A,[]
AT-A312885-A,[]
AT-A404675-A,[]
AT-A482077-A,[]
AT-A519575-A,[]
AT-A710279-A,[]
AT-A735378-A,[]
AT-A876472-A,[]
AT-A906278-A,[]
BE-804534-A,[]
BE-806687-A,[]
BE-813367-A,[]
BE-823416-A,[]
BE-825816-A,[]
BE-833811-A,[]
BE-837312-A,[]
BE-837857-A,[]
BE-840231-A,[]
BE-848755-A,[]
BE-852837-A,[]
BE-853553-A,[]
BE-857395-A,[]
BE-861199-A,[]
BE-866723-A,[]
BE-868080-A,[]
BE-868938-A,[]
BE-869056-A,[]
BE-871421-A,[]
BE-873394-A,[]
BE-877768-A,[]
BE-885287-A,[]
BE-509322-A,[]

2025-01-25 10:26:30 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:26:30 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:26:30 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:26:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:26:31 - snowflake.connector.connection - INFO - closed
2025-01-25 10:26:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:26:31 - root - INFO - SQL:
SELECT f.value:"publication_number"::STRING AS "cited_publication_number"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."citation") f
   WHERE f.value:"publication_number" IS NOT NULL
   LIMIT 100;
Results:
cited_publication_number
JP-H06330535-A
JP-2007009256-A
JP-2009058640-A
JP-2013214059-A
WO-2014034720-A1
US-8974066-B2
JP-2016017083-A
JP-2009236404-A
JP-2017197822-A
""
""
""
DE-670840-C
US-6702245-B1
WO-2010015023-A1
US-2014263926-A1
JP-2016030087-A
CN-107411266-A
US-2608935-A
CH-390978-A
CH-432574-A
DE-1580888-A1
DE-3033601-A1
DE-69607479-T2
US-4848175-A
DE-4435601-A1
RU-76004-U1
CN-204551328-U
EP-1578580-A1
EP-2072205-A1
RU-2009101922-A
RU-156998-U1
""
JP-S5161019-A
SU-1155693-A1
RU-124763-U1
RU-155006-U1
DE-69912396-T2
CZ-278878-B6
CZ-285560-B6
DE-102004007758-A1
CZ-17947-U1
EP-0698568-B1
DE-102015113737-B3
US-5013300-A
US-5071418-A
US-5693044-A
US-2002019631-A1
US-6458125-B1
US-2007129722-A1
US-2009018539-A1
WO-2014032157-A1
US-2014081086-A1
US-7719055-B1
US-7872888-B2
US-9007117-B2
US-9048119-B2
US-9269711-B2
US-9350342-B2
US-4402477-A
US-4422604-A
US-6786451-B2
US-9145204-B2
GB-1227405-A
US-4243735-A
US-4277525-A
US-2002032318-A1
US-2002091059-A1
US-6695903-B1
US-2004057142-A1
US-2005031791-A1
US-2007019677-A1
US-2011155967-A1
US-2012313055-A1
""
""
""
US-4094444-A
US-4285444-A
US-4449642-A
US-6516733-B1
WO-2007064184-A2
US-2010282144-A1
US-2011178632-A1
US-2011271887-A1
US-2015059630-A1
US-2015282422-A1
US-2007101202-A1
US-2007136541-A1
US-7266718-B2
US-7587570-B2
US-7657796-B1
US-7694092-B2
US-2010318837-A1
US-8341121-B1
US-2013080823-A1
US-9003086-B1
US-9264494-B2
US-9304815-B1
US-2002156145-A1

2025-01-25 10:26:31 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:26:31 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:26:31 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:26:33 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:26:33 - snowflake.connector.connection - INFO - closed
2025-01-25 10:26:33 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:26:33 - root - INFO - SQL:
SELECT DISTINCT "assignee_harmonized"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "assignee_harmonized" IS NOT NULL
   LIMIT 100;
Results:
Too long, hard cut:
assignee_harmonized
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ZIMMER INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""NIBCO""
  }
]"
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""ARIANEGROUP SAS""
  }
]"
"[
  {
    ""country_code"": ""CA"",
    ""name"": ""MITEL NETWORKS CORP""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""PERMELEC ELCTRODE LTD""
  },
  {
    ""country_code"": ""IT"",
    ""name"": ""PERMELEC SPA NORA""
  }
]"
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""SHANGHAI BAOSTEEL EQUIP MAINT""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""MAGGINI MARIO""
  }
]"
"[
  {
    ""country_code"": ""IT"",
    ""name"": ""CAPOCCIA FRANCESCO""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""DOW AGROSCIENCES LLC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""QUICKPATH ANALYTICS INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""KERFLUMMOX HOLDINGS LLC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HUANG CHAO YANG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""GEPPERT CARL F""
  },
  {
    ""country_code"": """",
    ""name"": ""GEPPERT THEODORE R""
  },
  {
    ""country_code"": """",
    ""name"": ""RHOADES ROBERT A""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SKYLINE BIOMEDICAL INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MENTOR GRAPHICS CORP""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""GRACE CHARLOTTE""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ISE CORP""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ANEMIKOS THEODOROS E""
  },
  {
    ""country_code"": """",
    ""name"": ""CORSON PHILLIP L""
  },
  {
    ""country_code"": """",
    ""name"": ""ERTURK METE""
  },
  {
    ""country_code"": """",
    ""name"": ""HALL EZRA D B""
  },
  {
    ""country_code"": """",
    ""name"": ""PERRI ANTHONY J""
  },
  {
    ""country_code"": """",
    ""name"": ""VENTRONE SEBASTIAN T""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""LYNDE GERALD D""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""ROSENBLATT STEVE""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""BAKER HUGHES INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""OKIN KENNETH A""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""KARAMCHETI VIJAY""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""VIRIDENT SYSTEMS INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""KARAOGUZ JEYHAN""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""BROADCOM CORP""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ACME STEEL CO""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""EARNSHAW KNITTING COMPANY""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BRUEGGEMAN LOUIS W""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""PUTZMEISTER ENGINEERING GMBH""
  }
]"
"[
  {
    ""country_code"": ""SG"",
    ""name"": ""AGENCY FOR SCIENCE TECHNOLGY AND RES""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""DOLBY LABORATORIES LICENSING CORP""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SIEMENS MOBILITY INC""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""EBARA CORP""
  }
]"
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""LG ENERGY SOLUTION LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ZHANG FUMING""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""FUJIAN BEIDIAN NEW MATERIAL TECH CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""LU ZHANPING""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""KITCHEN AND BATH ELECTRIC APPLIANCE MFG LIMITED COMPANY OF TURNIP LAKE MEI""
  },
  {
    ""country_code"": """",
    ""name"": ""MIDEA GROUP CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HUANGSHI POWER SUPPLY COMPANY STATE GRID HUBEI ELECTRIC POWER CO LTD""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BAYER AG""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""AB INITIO TECHNOLOGY LLC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MAGNOLIA MEDICAL TECHNOLOGIES INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""BALL BROTHERS CO""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""EVEY JOHN M""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""PETROLEUM EQUIPMENT COMPANY""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""KPR US LLC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BLACK & DECKER INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ADEMCO INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PALO ALTO NETWORKS INC""
  }
]"
"[
  {
    ""country_code"": ""BE"",
    ""name"": ""FINUICK SA""
  }
]"
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""BAE SAM HOON""
  }
]"
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""KOREA ELEC

2025-01-25 10:26:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:26:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:26:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:26:35 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:26:35 - snowflake.connector.connection - INFO - closed
2025-01-25 10:26:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:26:35 - root - INFO - SQL:
SELECT t."publication_number", c.value:"code"::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c
   LIMIT 100;
Results:
publication_number,cpc_code
CN-214682489-U,Y02P70/10
CN-214477141-U,Y04S10/18
CN-214477141-U,Y02E60/00
CN-214715286-U,Y02P90/02
CN-214675809-U,Y02B20/40
CN-214682433-U,Y02P70/10
CN-214956910-U,Y02E10/50
CN-214956910-U,Y02P70/50
CN-213375840-U,Y02A50/20
CN-214700498-U,Y02A20/108
CN-214700498-U,Y02B20/72
CN-214477726-U,Y02E60/10
CN-215050574-U,Y02P10/25
CN-215495119-U,G06K19/07722
CN-215495119-U,G06V40/1318
CN-215495119-U,G06K19/07722
CN-215495119-U,G06K19/0718
CN-214657421-U,Y02A20/108
US-2004046148-A1,C23F1/26
US-2004046148-A1,H01L21/3212
US-2004046148-A1,C23F3/06
US-2004046148-A1,H01L21/32134
US-2004046148-A1,C23F3/06
US-2004046148-A1,C09G1/02
US-2004046148-A1,H01L21/32115
US-2004046148-A1,C23F3/04
US-2004046148-A1,C23F1/18
US-2004046148-A1,C09G1/02
US-2004046148-A1,C23F3/06
US-2004046148-A1,H01L21/32115
US-2004046148-A1,H01L21/3212
US-2004046148-A1,C23F1/18
US-2004046148-A1,C23F3/04
US-2004046148-A1,H01L21/32134
US-2004249430-A1,A61N1/05
US-2004249430-A1,A61N1/05
US-2004249430-A1,A61N1/056
US-2004249430-A1,A61N1/056
US-2004254481-A1,A61B7/04
US-2004254481-A1,A61B5/318
US-2004254481-A1,A61B7/04
US-2004254481-A1,A61B5/0816
US-2004254481-A1,A61B5/0816
US-2004254481-A1,A61B5/318
US-2004179568-A1,H01S5/0421
US-2004179568-A1,H01S5/3095
US-2004179568-A1,H01S5/3072
US-2004179568-A1,H01S5/02476
US-2004179568-A1,H01S5/0217
US-2004179568-A1,H01S5/18308
US-2004179568-A1,H01S5/18375
US-2004179568-A1,H01S5/18377
US-2004179568-A1,H01S5/04253
US-2004179568-A1,H01S5/04252
US-2004179568-A1,H01S5/18369
US-2004179568-A1,H01S5/18375
US-2004179568-A1,H01S5/18369
US-2004179568-A1,H01S5/18308
US-2004179568-A1,H01S5/0217
US-2004179568-A1,H01S5/3072
US-2004179568-A1,H01S5/02476
US-2004179568-A1,H01S5/18377
US-2004179568-A1,H01S5/0421
US-2004179568-A1,H01S5/3095
US-2004179568-A1,H01S5/04253
US-2004179568-A1,H01S5/04252
US-2004179568-A1,H01S5/18375
US-2004179568-A1,H01S5/3095
US-2004179568-A1,H01S5/18377
US-2004179568-A1,H01S5/02476
US-2004179568-A1,H01S5/0217
US-2004179568-A1,H01S5/18369
US-2004179568-A1,H01S5/18308
US-2004179568-A1,H01S5/0421
US-2004179568-A1,H01S5/3072
US-2004179568-A1,H01S5/04253
US-2004250894-A1,B27L7/00
US-2004250894-A1,B27L7/005
US-2004250894-A1,B27L7/00
US-2004250894-A1,B27L7/005
US-2005110223-A1,F16J15/0825
US-2005110223-A1,F16J15/0825
US-2005031765-A1,A23L7/126
US-2005031765-A1,A23L7/115
US-2005031765-A1,A23L7/126
US-2005031765-A1,A23L7/115
US-2005012526-A1,H03F3/45748
US-2005012526-A1,H03F2203/30015
US-2005012526-A1,H03F3/45179
US-2005012526-A1,H03F3/45941
US-2005012526-A1,H03F3/45941
US-2005012526-A1,H03F2203/45681
US-2005012526-A1,H03F2203/45292
US-2005012526-A1,H03F2203/30015
US-2005012526-A1,H03F2203/45082
US-2005012526-A1,H03F2203/45008
US-2005012526-A1,H03F3/45179
US-2005012526-A1,H03F3/45748
US-2005012526-A1,H03F3/3022
US-2005012526-A1,H03F2203/45082

2025-01-25 10:26:35 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:26:35 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:26:35 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:26:37 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:26:37 - snowflake.connector.connection - INFO - closed
2025-01-25 10:26:37 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:26:37 - root - INFO - SQL:
SELECT "symbol", "titleFull"
   FROM PATENTS.PATENTS.CPC_DEFINITION
   LIMIT 100;
Results:
Too long, hard cut:
symbol,titleFull
B,PERFORMING OPERATIONS; TRANSPORTING
H,ELECTRICITY
Y,GENERAL TAGGING OF NEW TECHNOLOGICAL DEVELOPMENTS; GENERAL TAGGING OF CROSS-SECTIONAL TECHNOLOGIES SPANNING OVER SEVERAL SECTIONS OF THE IPC; TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS
D,TEXTILES; PAPER
F,MECHANICAL ENGINEERING; LIGHTING; HEATING; WEAPONS; BLASTING
E,FIXED CONSTRUCTIONS
C,CHEMISTRY; METALLURGY
G,PHYSICS
A,HUMAN NECESSITIES
A45,HAND OR TRAVELLING ARTICLES
A24,TOBACCO; CIGARS; CIGARETTES; SIMULATED SMOKING DEVICES; SMOKERS' REQUISITES
A61,MEDICAL OR VETERINARY SCIENCE; HYGIENE
A63,SPORTS; GAMES; AMUSEMENTS
A22,BUTCHERING; MEAT TREATMENT; PROCESSING POULTRY OR FISH
A42,HEADWEAR
A99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
A43,FOOTWEAR
A01,AGRICULTURE; FORESTRY; ANIMAL HUSBANDRY; HUNTING; TRAPPING; FISHING
A62,LIFE-SAVING; FIRE-FIGHTING
A23,"FOODS OR FOODSTUFFS; TREATMENT THEREOF, NOT COVERED BY OTHER CLASSES"
A47,FURNITURE; DOMESTIC ARTICLES OR APPLIANCES; COFFEE MILLS; SPICE MILLS; SUCTION CLEANERS IN GENERAL
A46,BRUSHWARE
A44,HABERDASHERY; JEWELLERY
A21,BAKING; EDIBLE DOUGHS
A41,WEARING APPAREL
B27,WORKING OR PRESERVING WOOD OR SIMILAR MATERIAL; NAILING OR STAPLING MACHINES IN GENERAL
B68,SADDLERY; UPHOLSTERY
B04,CENTRIFUGAL APPARATUS OR MACHINES FOR CARRYING-OUT PHYSICAL OR CHEMICAL PROCESSES
B23,MACHINE TOOLS; METAL-WORKING NOT OTHERWISE PROVIDED FOR
B30,PRESSES
B21,MECHANICAL METAL-WORKING WITHOUT ESSENTIALLY REMOVING MATERIAL; PUNCHING METAL
B25,HAND TOOLS; PORTABLE POWER-DRIVEN TOOLS; MANIPULATORS
B99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
B29,WORKING OF PLASTICS; WORKING OF SUBSTANCES IN A PLASTIC STATE IN GENERAL
B31,"MAKING ARTICLES OF PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER; WORKING PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER"
B26,HAND CUTTING TOOLS; CUTTING; SEVERING
B66,HOISTING; LIFTING; HAULING
B02,"CRUSHING, PULVERISING, OR DISINTEGRATING; PREPARATORY TREATMENT OF GRAIN FOR MILLING"
B65,CONVEYING; PACKING; STORING; HANDLING THIN OR FILAMENTARY MATERIAL
B61,RAILWAYS
B24,GRINDING; POLISHING
B06,GENERATING OR TRANSMITTING MECHANICAL VIBRATIONS IN GENERAL
B43,WRITING OR DRAWING IMPLEMENTS; BUREAU ACCESSORIES
B62,LAND VEHICLES FOR TRAVELLING OTHERWISE THAN ON RAILS
B64,AIRCRAFT; AVIATION; COSMONAUTICS
B22,CASTING; POWDER METALLURGY
B28,"WORKING CEMENT, CLAY, OR STONE"
B09,DISPOSAL OF SOLID WASTE; RECLAMATION OF CONTAMINATED SOIL
B01,PHYSICAL OR CHEMICAL PROCESSES OR APPARATUS IN GENERAL
B63,SHIPS OR OTHER WATERBORNE VESSELS; RELATED EQUIPMENT
B60,VEHICLES IN GENERAL
B44,DECORATIVE ARTS
B07,SEPARATING SOLIDS FROM SOLIDS; SORTING
B08,CLEANING
B82,NANOTECHNOLOGY
B42,BOOKBINDING; ALBUMS; FILES; SPECIAL PRINTED MATTER
B32,LAYERED PRODUCTS
B81,MICROSTRUCTURAL TECHNOLOGY
B05,"SPRAYING OR ATOMISING IN GENERAL; APPLYING FLUENT MATERIALS TO SURFACES, IN GENERAL"
B41,PRINTING; LINING MACHINES; TYPEWRITERS; STAMPS
B03,SEPARATION OF SOLID MATERIALS USING LIQUIDS OR USING PNEUMATIC TABLES OR JIGS; MAGNETIC OR ELECTROSTATIC SEPARATION OF SOLID MATERIALS FROM SOLID MATERIALS OR FLUIDS; SEPARATION BY HIGH-VOLTAGE ELECTRIC FIELDS
B67,"OPENING, CLOSING OR CLEANING BOTTLES, JARS OR SIMILAR CONTAINERS; LIQUID HANDLING"
B33,ADDITIVE MANUFACTURING TECHNOLOGY
C22,METALLURGY; FERROUS OR NON-FERROUS ALLOYS; TREATMENT OF ALLOYS OR NON-FERROUS METALS
C23,"COATING METALLIC MATERIAL; COATING MATERIAL WITH METALLIC MATERIAL; CHEMICAL SURFACE TREATMENT; DIFFUSION TREATMENT OF METALLIC MATERIAL; COATING BY VACUUM EVAPORATION, BY SPUTTERING, BY ION IMPLANTATION OR BY CHEMICAL VAPOUR DEPOSITION, IN GENERAL; INHIBITING CORROSION OF METALLIC MATERIAL OR INCRUSTATION IN GENERAL"
C06,EXPLOSIVES; MATCHES
C02,"TREATMENT OF WATER, WASTE WATER, SEWAGE, OR SLUDGE"
C07,ORGANIC CHEMISTRY
C25,ELECTROLYTIC OR ELECTROPHORETIC PROCESSES; APPARATUS THEREFOR
C30,CRYSTAL GROWTH
C12,BIOCHEMISTRY; BEER; SPIRITS; WINE; VINEGAR; MICROBIOLOGY; ENZYMOLOGY; MUTATION OR GENETIC ENGINEERING
C99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
C05,FERTILISERS; MANUFACTURE THEREOF
C40,COMBINATORIAL TECHNOLOGY
C11,"ANIMAL OR VEGETABLE OILS, FATS, FATTY SUBSTANCES OR WAXES; FATTY ACIDS THEREFROM; DETERGENTS; CANDLES"
C08,ORGANIC MACROMOLECULAR COMPOUNDS; THEIR PREPARATION OR CHEMICAL WORKING-UP; COMPOSITIONS BASED THEREON
C10,"PETROLEUM, GAS OR COKE INDUSTRIES; TECHNICAL GASES CONTAINING CARBON MONOXIDE; FUELS; LUBRICANTS; PEAT"
C21,METALLURGY OF IRON
C04,CEMENTS; CONCRETE; ARTIFICIAL STONE; CERAMICS; REFRACTORIES
C09,DYES; PAINTS; POLISHES; NATURAL RESINS; ADHESIVES; COMPOSITIONS NOT OTHERWISE PROVIDED FOR; APPLICATIONS OF MATERIALS NOT OTHERWISE PROVIDED FOR
C03,GLASS; MINERAL OR SLAG WOOL
C13,SUGAR INDUSTRY
C14,SKINS; HIDES; PELTS; LEATHER
C01,INORGANIC CHEMISTRY
D02,YARNS; MECHANICAL FINISHING OF YARNS OR ROPES; WARPING OR BEAMING
D21,PAPER-MAKING; PRODUCTION OF CELLULOSE
D04,BRAIDING; LACE-MAKING; KNITTING; TRIMMINGS; NON-WOVEN F

2025-01-25 10:26:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:26:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:26:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:26:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:26:39 - snowflake.connector.connection - INFO - closed
2025-01-25 10:26:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:26:39 - root - INFO - SQL:
SELECT f.value:"publication_number"::STRING AS "cited_publication_number", COUNT(*) AS "citation_count"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."citation") f
   WHERE f.value:"publication_number" IS NOT NULL
   GROUP BY "cited_publication_number"
   ORDER BY "citation_count" DESC
   LIMIT 100;
Results:
cited_publication_number,citation_count
,230545
US-4816567-A,36
US-4683202-B1,23
US-4683202-A,23
US-5585089-A,21
US-4683195-B1,20
US-4683195-A,20
US-5223409-A,19
US-4733665-B1,18
US-4733665-C2,18
US-5530101-A,18
US-4733665-A,18
US-5892900-A,17
US-5225539-A,17
US-5523520-A,16
US-5624821-A,15
US-6175752-B1,15
US-5693762-A,15
JP-2007123861-A,14
US-5205459-A,14
US-4965188-A,14
US-5545806-A,14
US-7000818-B2,14
US-5565332-A,14
US-4522811-A,12
US-6698020-B1,12
US-4946778-A,12
US-5403312-A,12
US-5724521-A,12
US-6180370-B1,11
US-6177931-B1,11
US-5292053-A,11
US-5850009-A,11
US-5859205-A,11
US-4548202-A,11
US-5304719-A,11
US-7674650-B2,11
US-6988649-B2,11
US-2008258141-A1,11
US-5104025-A,11
US-2007108446-A1,11
US-5569825-A,11
US-2006110867-A1,11
US-5367109-A,11
US-5648260-A,11
US-2006208977-A1,11
US-5084057-A,11
US-6323846-B1,11
US-4399216-A,11
US-5034506-A,11
US-2014263552-A1,11
US-5391250-A,10
US-8393514-B2,10
US-9345481-B2,10
US-2003229900-A1,10
US-2005199959-A1,10
US-6727522-B1,10
US-2006113549-A1,10
US-2001046027-A1,10
US-2008296568-A1,10
US-7732819-B2,10
US-2007194379-A1,10
US-6746582-B2,10
US-2007175955-A1,10
US-5715314-A,10
US-2006113539-A1,10
US-2006108636-A1,10
US-5948061-A,10
US-5593852-A,10
US-7753245-B2,10
US-7422139-B2,10
US-2008258143-A1,10
US-7411209-B2,10
US-5821937-A,10
US-2008106191-A1,10
US-2007052025-A1,10
US-5633425-A,10
US-2007172591-A1,10
US-6120676-A,10
US-5794207-A,10
US-5383880-A,10
US-2006091793-A1,10
US-7845537-B2,10
US-5545807-A,10
US-5754939-A,10
US-5796952-A,10
US-2006244107-A1,10
US-2006238135-A1,10
US-2008182358-A1,9
US-7385224-B2,9
US-2006292777-A1,9
US-2007046191-A1,9
US-5867799-A,9
WO-2013176772-A1,9
US-5960411-A,9
JP-2004103957-A,9
US-5496312-A,9
US-7402506-B2,9
US-5954259-A,9
US-2007187760-A1,9

2025-01-25 10:26:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:26:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:26:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:26:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:26:40 - snowflake.connector.connection - INFO - closed
2025-01-25 10:26:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:26:41 - root - INFO - SQL:
SELECT t."publication_number", t."assignee_harmonized", c.value:"code"::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c
   WHERE t."assignee_harmonized" IS NOT NULL
   LIMIT 100;
Results:
Too long, hard cut:
publication_number,assignee_harmonized,cpc_code
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A""
  },
  {
    ""country_code"": """",
    ""name"": ""JOHNSON KENNETH U""
  },
  {
    ""country_code"": """",
    ""name"": ""ESCARCEGA ANTHONY J""
  }
]",G01N2030/202
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A""
  },
  {
    ""country_code"": """",
    ""name"": ""JOHNSON KENNETH U""
  },
  {
    ""country_code"": """",
    ""name"": ""ESCARCEGA ANTHONY J""
  }
]",Y10T137/86815
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A""
  },
  {
    ""country_code"": """",
    ""name"": ""JOHNSON KENNETH U""
  },
  {
    ""country_code"": """",
    ""name"": ""ESCARCEGA ANTHONY J""
  }
]",G01N2030/202
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A""
  },
  {
    ""country_code"": """",
    ""name"": ""JOHNSON KENNETH U""
  },
  {
    ""country_code"": """",
    ""name"": ""ESCARCEGA ANTHONY J""
  }
]",G01N30/6047
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A""
  },
  {
    ""country_code"": """",
    ""name"": ""JOHNSON KENNETH U""
  },
  {
    ""country_code"": """",
    ""name"": ""ESCARCEGA ANTHONY J""
  }
]",F16K11/074
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A""
  },
  {
    ""country_code"": """",
    ""name"": ""JOHNSON KENNETH U""
  },
  {
    ""country_code"": """",
    ""name"": ""ESCARCEGA ANTHONY J""
  }
]",G01N30/20
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A""
  },
  {
    ""country_code"": """",
    ""name"": ""JOHNSON KENNETH U""
  },
  {
    ""country_code"": """",
    ""name"": ""ESCARCEGA ANTHONY J""
  }
]",F16K11/074
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A""
  },
  {
    ""country_code"": """",
    ""name"": ""JOHNSON KENNETH U""
  },
  {
    ""country_code"": """",
    ""name"": ""ESCARCEGA ANTHONY J""
  }
]",B01D15/1821
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A""
  },
  {
    ""country_code"": """",
    ""name"": ""JOHNSON KENNETH U""
  },
  {
    ""country_code"": """",
    ""name"": ""ESCARCEGA ANTHONY J""
  }
]",G01N30/20
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A""
  },
  {
    ""country_code"": """",
    ""name"": ""JOHNSON KENNETH U""
  },
  {
    ""country_code"": """",
    ""name"": ""ESCARCEGA ANTHONY J""
  }
]",B01D15/1821
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A""
  },
  {
    ""country_code"": """",
    ""name"": ""JOHNSON KENNETH U""
  },
  {
    ""country_code"": """",
    ""name"": ""ESCARCEGA ANTHONY J""
  }
]",G01N30/6047
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A""
  },
  {
    ""country_code"": """",
    ""name"": ""JOHNSON KENNETH U""
  },
  {
    ""country_code"": """",
    ""name"": ""ESCARCEGA ANTHONY J""
  }
]",G01N2030/201
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A"

2025-01-25 10:26:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:26:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:26:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:26:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-25 10:26:42 - snowflake.connector.connection - INFO - closed
2025-01-25 10:26:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:27:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:27:17 - root - INFO - ```sql
SELECT 
    assignee.value:"name"::STRING AS "Citing_Assignee",
    def."titleFull" AS "CPC_Subclass_Title",
    COUNT(*) AS "Citation_Count"
FROM PATENTS.PATENTS.PUBLICATIONS t2
LATERAL FLATTEN(input => t2."assignee_harmonized") assignee
LATERAL FLATTEN(input => t2."cpc") cpc
LATERAL FLATTEN(input => t2."citation") c
LEFT JOIN PATENTS.PATENTS.CPC_DEFINITION def
   ON SUBSTR(cpc.value:"code"::STRING, 1, 3) = def."symbol"
WHERE c.value:"publication_number"::STRING IN (
    SELECT DISTINCT t1."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t1
    LATERAL FLATTEN(input => t1."assignee_harmonized") assignee1
    WHERE assignee1.value:"name"::STRING LIKE '%DENSO CORP%'
)
AND assignee.value:"name"::STRING NOT LIKE '%DENSO CORP%'
GROUP BY "Citing_Assignee", "CPC_Subclass_Title"
ORDER BY "Citation_Count" DESC;
```
2025-01-25 10:27:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:27:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:27:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:27:19 - snowflake.connector.connection - INFO - closed
2025-01-25 10:27:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:27:59 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:27:59 - root - INFO - ```sql
WITH DENSO_PUBS AS (
    SELECT DISTINCT t1."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t1,
         TABLE(FLATTEN(input => t1."assignee_harmonized")) assignee1
    WHERE assignee1.value:"name"::STRING LIKE '%DENSO CORP%'
)
SELECT 
    assignee2.value:"name"::STRING AS "Citing_Assignee",
    def."titleFull" AS "CPC_Subclass_Title",
    COUNT(*) AS "Citation_Count"
FROM PATENTS.PATENTS.PUBLICATIONS t2,
    TABLE(FLATTEN(input => t2."assignee_harmonized")) assignee2,
    TABLE(FLATTEN(input => t2."cpc")) cpc2,
    TABLE(FLATTEN(input => t2."citation")) c2
    JOIN DENSO_PUBS
       ON c2.value:"publication_number"::STRING = DENSO_PUBS."publication_number"
    JOIN PATENTS.PATENTS.CPC_DEFINITION def
       ON SUBSTR(cpc2.value:"code"::STRING, 1, 3) = def."symbol"
WHERE assignee2.value:"name"::STRING NOT LIKE '%DENSO CORP%'
GROUP BY "Citing_Assignee", "CPC_Subclass_Title"
ORDER BY "Citation_Count" DESC;
```
2025-01-25 10:27:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:27:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:27:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:28:00 - snowflake.connector.connection - INFO - closed
2025-01-25 10:28:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:29:12 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:29:12 - root - INFO - ```sql
WITH DENSO_PUBS AS (
    SELECT DISTINCT t1."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t1,
         LATERAL FLATTEN(input => t1."assignee_harmonized") assignee1
    WHERE assignee1.value:"name"::STRING LIKE '%DENSO CORP%'
)
SELECT 
    assignee2.value:"name"::STRING AS "Citing_Assignee",
    def."titleFull" AS "CPC_Subclass_Title",
    COUNT(DISTINCT t2."publication_number") AS "Citation_Count"
FROM PATENTS.PATENTS.PUBLICATIONS t2
    JOIN LATERAL FLATTEN(input => t2."citation") c2 ON TRUE
    JOIN DENSO_PUBS dp ON c2.value:"publication_number"::STRING = dp."publication_number"
    JOIN LATERAL FLATTEN(input => t2."assignee_harmonized") assignee2 ON TRUE
    JOIN LATERAL FLATTEN(input => t2."cpc") cpc2 ON TRUE
    JOIN PATENTS.PATENTS.CPC_DEFINITION def ON SUBSTR(cpc2.value:"code"::STRING, 1, 1) = def."symbol"
WHERE assignee2.value:"name"::STRING NOT LIKE '%DENSO CORP%'
GROUP BY "Citing_Assignee", "CPC_Subclass_Title"
ORDER BY "Citation_Count" DESC;
```

This SQL query performs the following steps:

1. **DENSO_PUBS CTE**: Selects all distinct publication numbers of patents assigned to **DENSO CORP** by flattening the `assignee_harmonized` field and filtering for `"%DENSO CORP%"`.

2. **Main Query**:
   - Joins the `PUBLICATIONS` table (`t2`) with its flattened `citation`, `assignee_harmonized`, and `cpc` fields.
   - Filters the records where the citations refer to the patents in `DENSO_PUBS`.
   - Excludes assignees named **DENSO CORP** from the citing patents.
   - Joins with the `CPC_DEFINITION` table to get the full title of the main CPC category (using the first character of the CPC code).
   - Groups the results by the citing assignee and the CPC subclass title.
   - Counts the number of unique citing publications in each group.
   - Orders the results by the citation count in descending order.

**Explanation:**

- **LATERAL FLATTEN**: Used to unpack the VARIANT columns (`assignee_harmonized`, `cpc`, and `citation`) to access their nested values.
  
- **SUBSTR(cpc2.value:"code"::STRING, 1, 1)**: Extracts the first character of the CPC code to focus on the main categories.

- **Filtering Assignees**: The `WHERE` clause ensures that the citing assignee is not **DENSO CORP** itself.

**Note:** This query should correctly execute in Snowflake without syntax errors, as it uses proper join syntax and handles the lateral flattening appropriately.
2025-01-25 10:29:12 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:29:12 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:29:12 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:29:13 - snowflake.connector.connection - INFO - closed
2025-01-25 10:29:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:29:14 - root - INFO - SQL:
WITH DENSO_PUBS AS (
    SELECT DISTINCT t1."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t1,
         LATERAL FLATTEN(input => t1."assignee_harmonized") assignee1
    WHERE assignee1.value:"name"::STRING LIKE '%DENSO CORP%'
)
SELECT 
    assignee2.value:"name"::STRING AS "Citing_Assignee",
    def."titleFull" AS "CPC_Subclass_Title",
    COUNT(DISTINCT t2."publication_number") AS "Citation_Count"
FROM PATENTS.PATENTS.PUBLICATIONS t2
    JOIN LATERAL FLATTEN(input => t2."citation") c2 ON TRUE
    JOIN DENSO_PUBS dp ON c2.value:"publication_number"::STRING = dp."publication_number"
    JOIN LATERAL FLATTEN(input => t2."assignee_harmonized") assignee2 ON TRUE
    JOIN LATERAL FLATTEN(input => t2."cpc") cpc2 ON TRUE
    JOIN PATENTS.PATENTS.CPC_DEFINITION def ON SUBSTR(cpc2.value:"code"::STRING, 1, 1) = def."symbol"
WHERE assignee2.value:"name"::STRING NOT LIKE '%DENSO CORP%'
GROUP BY "Citing_Assignee", "CPC_Subclass_Title"
ORDER BY "Citation_Count" DESC;
Results:
000002 (0A000): 01b9f215-0004-7d15-0001-11c300fa2ee2: Unsupported feature 'lateral table function called with OUTER JOIN syntax or a join predicate (ON clause)'.
2025-01-25 10:29:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:29:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:29:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:29:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-25 10:29:17 - snowflake.connector.connection - INFO - closed
2025-01-25 10:29:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:30:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:30:01 - root - INFO - ```sql
SELECT 
    assignee2.value:"name"::STRING AS "Citing_Assignee",
    COUNT(DISTINCT t2."publication_number") AS "Citation_Count"
FROM 
    PATENTS.PATENTS.PUBLICATIONS t2,
    LATERAL FLATTEN(input => t2."assignee_harmonized") assignee2,
    LATERAL FLATTEN(input => t2."citation") c2
WHERE 
    c2.value:"publication_number"::STRING IN (
        SELECT DISTINCT t1."publication_number"
        FROM PATENTS.PATENTS.PUBLICATIONS t1,
             LATERAL FLATTEN(input => t1."assignee_harmonized") assignee1
        WHERE assignee1.value:"name"::STRING LIKE '%DENSO CORP%'
    )
    AND assignee2.value:"name"::STRING NOT LIKE '%DENSO CORP%'
GROUP BY 
    "Citing_Assignee"
ORDER BY 
    "Citation_Count" DESC
LIMIT 100;
```
2025-01-25 10:30:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:30:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:30:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:30:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 10
2025-01-25 10:30:05 - snowflake.connector.connection - INFO - closed
2025-01-25 10:30:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:30:43 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:30:43 - root - INFO - SQL:
SELECT 
    assignee2.value:"name"::STRING AS "Citing_Assignee",
    COUNT(DISTINCT t2."publication_number") AS "Citation_Count"
FROM 
    PATENTS.PATENTS.PUBLICATIONS t2,
    LATERAL FLATTEN(input => t2."assignee_harmonized") assignee2,
    LATERAL FLATTEN(input => t2."citation") c2
WHERE 
    c2.value:"publication_number"::STRING IN (
        SELECT DISTINCT t1."publication_number"
        FROM PATENTS.PATENTS.PUBLICATIONS t1,
             LATERAL FLATTEN(input => t1."assignee_harmonized") assignee1
        WHERE assignee1.value:"name"::STRING LIKE '%DENSO CORP%'
    )
    AND assignee2.value:"name"::STRING NOT LIKE '%DENSO CORP%'
GROUP BY 
    "Citing_Assignee"
ORDER BY 
    "Citation_Count" DESC
LIMIT 100;
Results:
Citing_Assignee,Citation_Count
TOYOTA MOTOR CO LTD,2
MAHLE INT GMBH,2
SAHASHI HIDEO,1
YAZAKI CORP,1
HONDA MOTOR CO LTD,1
KIA MOTORS CORP,1
FUJI ELECTRIC CO LTD,1
SUZUKI HISAO,1
TOYOTA BOSHOKU KK,1
HYUNDAI MOTOR CO LTD,1

2025-01-25 10:30:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:30:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:30:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:30:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:30:45 - snowflake.connector.connection - INFO - closed
2025-01-25 10:30:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:30:46 - root - INFO - SQL:
-- Corrected SQL 1
SELECT t."publication_number", SUBSTR(c.value:"code"::STRING, 1, 4) AS "primary_cpc_subclass"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     TABLE(FLATTEN(input => t."cpc")) c
LIMIT 100
Results:
publication_number,primary_cpc_subclass
US-2022368427-A1,H04B
US-2022368427-A1,H04B
US-2022368427-A1,H04J
US-2022368427-A1,H04B
US-2022368427-A1,H04J
US-2022368427-A1,H04B
US-2022368427-A1,H04J
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022270260-A1,G06F
US-2022270260-A1,G06F
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022252052-A1,Y02E
US-2022252052-A1,F05B
US-2022252052-A1,G08B
US-2022252052-A1,F03D
US-2022252052-A1,F03D
US-2022252052-A1,F03D
US-2022252052-A1,F03D
US-2022252052-A1,G08B
US-2022252052-A1,F05B
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2024057379-A1,H10K
US-2024057379-A1,H10K
US-2024057379-A1,H10K
US-2024057379-A1,H10K
US-2024057379-A1,H10K
US-2024057379-A1,Y02E
US-2024057379-A1,H10K
US-2024057379-A1,H10K
US-2024057379-A1,H10K
US-2024057379-A1,H10K
US-2024057379-A1,H10K
US-2024057379-A1,H10K
US-2024057379-A1,H10K
US-2022114223-A1,H04L
US-2022114223-A1,G10L
US-2022114223-A1,H04L
US-2022114223-A1,G10L
US-2022114223-A1,H04L
US-2022114223-A1,G06F
US-2022114223-A1,G10L
US-2022114223-A1,G06F
US-2022114223-A1,H04L
US-2022114223-A1,H04L
US-2022114223-A1,G10L
US-2022114223-A1,G10L
US-2022114223-A1,G10L
US-2022114223-A1,G10L
US-2022114223-A1,G06F
US-2022114223-A1,H04L
US-2022114223-A1,H04M
US-2022114223-A1,G10L
US-2022114223-A1,G10L
US-2022114223-A1,G06F
US-2022114223-A1,G10L
US-2022114223-A1,G10L
US-2022114223-A1,G10L
US-2022114223-A1,G10L
US-2022114223-A1,H04L
US-2022114223-A1,G10L

2025-01-25 10:30:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:30:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:30:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:30:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:30:49 - snowflake.connector.connection - INFO - closed
2025-01-25 10:30:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:30:49 - root - INFO - SQL:
-- Corrected SQL 2
SELECT c_symbols."symbol", d."titleFull"
FROM PATENTS.PATENTS.CPC_DEFINITION d
JOIN (
  SELECT DISTINCT SUBSTR(c.value:"code"::STRING, 1, 4) AS "symbol"
  FROM PATENTS.PATENTS.PUBLICATIONS t,
       TABLE(FLATTEN(input => t."cpc")) c
  LIMIT 100
) AS c_symbols
ON c_symbols."symbol" = d."symbol"
LIMIT 100
Results:
Too long, hard cut:
symbol,titleFull
A01C,PLANTING; SOWING; FERTILISING
A21C,MACHINES OR EQUIPMENT FOR MAKING OR PROCESSING DOUGHS; HANDLING BAKED ARTICLES MADE FROM DOUGH
A21B,BAKERS' OVENS; MACHINES OR EQUIPMENT FOR BAKING
A23J,PROTEIN COMPOSITIONS FOR FOODSTUFFS; WORKING-UP PROTEINS FOR FOODSTUFFS; PHOSPHATIDE COMPOSITIONS FOR FOODSTUFFS
A23L,"FOODS, FOODSTUFFS, OR NON-ALCOHOLIC BEVERAGES, NOT COVERED BY SUBCLASSES A21D OR A23B-A23J; THEIR PREPARATION OR TREATMENT, e.g. COOKING, MODIFICATION OF NUTRITIVE QUALITIES, PHYSICAL TREATMENT; PRESERVATION OF FOODS OR FOODSTUFFS, IN GENERAL"
A23N,"MACHINES OR APPARATUS FOR TREATING HARVESTED FRUIT, VEGETABLES OR FLOWER BULBS IN BULK, NOT OTHERWISE PROVIDED FOR; PEELING VEGETABLES OR FRUIT IN BULK; APPARATUS FOR PREPARING ANIMAL FEEDING- STUFFS"
A41B,SHIRTS; UNDERWEAR; BABY LINEN; HANDKERCHIEFS
A43B,CHARACTERISTIC FEATURES OF FOOTWEAR; PARTS OF FOOTWEAR
A43C,FASTENINGS OR ATTACHMENTS OF FOOTWEAR; LACES IN GENERAL
A43D,"MACHINES, TOOLS, EQUIPMENT OR METHODS FOR MANUFACTURING OR REPAIRING FOOTWEAR"
A44C,"PERSONAL ADORNMENTS, e.g. JEWELLERY; COINS"
A46D,MANUFACTURE OF BRUSHES
A61J,CONTAINERS SPECIALLY ADAPTED FOR MEDICAL OR PHARMACEUTICAL PURPOSES; DEVICES OR METHODS SPECIALLY ADAPTED FOR BRINGING PHARMACEUTICAL PRODUCTS INTO PARTICULAR PHYSICAL OR ADMINISTERING FORMS; DEVICES FOR ADMINISTERING FOOD OR MEDICINES ORALLY; BABY COMFORTERS; DEVICES FOR RECEIVING SPITTLE
A61G,"TRANSPORT, PERSONAL CONVEYANCES, OR ACCOMMODATION SPECIALLY ADAPTED FOR PATIENTS OR DISABLED PERSONS; OPERATING TABLES OR CHAIRS; CHAIRS FOR DENTISTRY; FUNERAL DEVICES"
A63C,"SKATES; SKIS; ROLLER SKATES; DESIGN OR LAYOUT OF COURTS, RINKS OR THE LIKE"
B01D,SEPARATION
B02B,PREPARING GRAIN FOR MILLING; REFINING GRANULAR FRUIT TO COMMERCIAL PRODUCTS BY WORKING THE SURFACE
B04C,"APPARATUS USING FREE VORTEX FLOW, e.g. CYCLONES"
B09B,DISPOSAL OF SOLID WASTE NOT OTHERWISE PROVIDED FOR
B29B,PREPARATION OR PRETREATMENT OF THE MATERIAL TO BE SHAPED; MAKING GRANULES OR PREFORMS; RECOVERY OF PLASTICS OR OTHER CONSTITUENTS OF WASTE MATERIAL CONTAINING PLASTICS
B29L,"INDEXING SCHEME ASSOCIATED WITH SUBCLASS B29C, RELATING TO PARTICULAR ARTICLES"
B31B,"MAKING CONTAINERS OF PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER"
B42B,"PERMANENTLY ATTACHING TOGETHER SHEETS, QUIRES OR SIGNATURES OR PERMANENTLY ATTACHING OBJECTS THERETO"
B42D,BOOKS; BOOK COVERS; LOOSE LEAVES; PRINTED MATTER CHARACTERISED BY IDENTIFICATION OR SECURITY FEATURES; PRINTED MATTER OF SPECIAL FORMAT OR STYLE NOT OTHERWISE PROVIDED FOR; DEVICES FOR USE THEREWITH AND NOT OTHERWISE PROVIDED FOR; MOVABLE-STRIP WRITING OR READING APPARATUS
B44D,"PAINTING OR ARTISTIC DRAWING, NOT OTHERWISE PROVIDED FOR; PRESERVING PAINTINGS; SURFACE TREATMENT TO OBTAIN SPECIAL ARTISTIC SURFACE EFFECTS OR FINISHES"
B60D,VEHICLE CONNECTIONS
B60M,"POWER SUPPLY LINES, AND DEVICES ALONG RAILS, FOR ELECTRICALLY- PROPELLED VEHICLES"
B62K,"CYCLES; CYCLE FRAMES; CYCLE STEERING DEVICES; RIDER-OPERATED TERMINAL CONTROLS SPECIALLY ADAPTED FOR CYCLES; CYCLE AXLE SUSPENSIONS; CYCLE SIDE-CARS, FORECARS, OR THE LIKE"
B64U,UNMANNED AERIAL VEHICLES [UAV]; EQUIPMENT THEREFOR
B66C,"CRANES; LOAD-ENGAGING ELEMENTS OR DEVICES FOR CRANES, CAPSTANS, WINCHES, OR TACKLES"
B67D,"DISPENSING, DELIVERING OR TRANSFERRING LIQUIDS, NOT OTHERWISE PROVIDED FOR"
B81B,"MICROSTRUCTURAL DEVICES OR SYSTEMS, e.g. MICROMECHANICAL DEVICES"
C01B,NON-METALLIC ELEMENTS; COMPOUNDS THEREOF; METALLOIDS OR COMPOUNDS THEREOF NOT COVERED BY SUBCLASS C01C
C01F,"COMPOUNDS OF THE METALS BERYLLIUM, MAGNESIUM, ALUMINIUM, CALCIUM, STRONTIUM, BARIUM, RADIUM, THORIUM, OR OF THE RARE-EARTH METALS"
C08G,MACROMOLECULAR COMPOUNDS OBTAINED OTHERWISE THAN BY REACTIONS ONLY INVOLVING UNSATURATED CARBON-TO-CARBON BONDS
C09H,PREPARATION OF GLUE OR GELATINE
C09C,"TREATMENT OF INORGANIC MATERIALS, OTHER THAN FIBROUS FILLERS, TO ENHANCE THEIR PIGMENTING OR FILLING PROPERTIES; PREPARATION OF CARBON BLACK ; PREPARATION OF INORGANIC MATERIALS WHICH ARE NO SINGLE CHEMICAL COMPOUNDS AND WHICH ARE MAINLY USED AS PIGMENTS OR FILLERS"
C10M,LUBRICATING COMPOSITIONS; USE OF CHEMICAL SUBSTANCES EITHER ALONE OR AS LUBRICATING INGREDIENTS IN A LUBRICATING COMPOSITION
C10G,"CRACKING HYDROCARBON OILS; PRODUCTION OF LIQUID HYDROCARBON MIXTURES, e.g. BY DESTRUCTIVE HYDROGENATION, OLIGOMERISATION, POLYMERISATION; RECOVERY OF HYDROCARBON OILS FROM OIL-SHALE, OIL-SAND, OR GASES; REFINING MIXTURES MAINLY CONSISTING OF HYDROCARBONS; REFORMING OF NAPHTHA; MINERAL WAXES"
C10J,"PRODUCTION OF PRODUCER GAS, WATER-GAS, SYNTHESIS GAS FROM SOLID CARBONACEOUS MATERIAL, OR MIXTURES CONTAINING THESE GASES; CARBURETTING AIR OR OTHER GASES"
C11C,"FATTY ACIDS FROM FATS, OILS OR WAXES; CANDLES; FATS, OILS OR FATTY ACIDS BY CHEMICAL MODIFICATION OF FATS, OILS, OR FATTY ACIDS OBTAINED THEREFROM"
C12M,"APPARATUS FOR ENZYMOLOGY OR MICROBIOLOGY; APPARATUS FOR CULTURING MICROORGANISMS FOR PRODUCING BIOMASS, FOR GROWING CELLS OR FOR OBTAINING FERMENTATION OR METABOLIC PRODUCTS, i.e. BI

2025-01-25 10:30:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:30:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:30:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:30:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:30:53 - snowflake.connector.connection - INFO - closed
2025-01-25 10:30:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:30:53 - root - INFO - SQL:
-- Corrected SQL 3
SELECT t."publication_number", t."assignee_harmonized", d."titleFull" AS "cpc_title"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     TABLE(FLATTEN(input => t."cpc")) c,
     PATENTS.PATENTS.CPC_DEFINITION d
WHERE c.value:"code"::STRING = d."symbol"
  AND t."assignee_harmonized" IS NOT NULL
LIMIT 100
Results:
Too long, hard cut:
publication_number,assignee_harmonized,cpc_title
US-2020311356-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""MEPS REAL TIME INC""
  }
]","Methods or arrangements for sensing record carriers, e.g. for reading patterns by electromagnetic radiation, e.g. optical sensing; by corpuscular radiation sensing by radiation using wavelengths larger than 0.1 mm, e.g. radio-waves or microwaves methods and means used by the interrogation device for reliably powering the wireless record carriers using an electromagnetic interrogation field including auxiliary means for focusing, repeating or boosting the electromagnetic interrogation field"
US-2020311356-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""MEPS REAL TIME INC""
  }
]","Methods or arrangements for sensing record carriers, e.g. for reading patterns by electromagnetic radiation, e.g. optical sensing; by corpuscular radiation sensing by radiation using wavelengths larger than 0.1 mm, e.g. radio-waves or microwaves methods and means used by the interrogation device for reliably powering the wireless record carriers using an electromagnetic interrogation field including auxiliary means for focusing, repeating or boosting the electromagnetic interrogation field"
US-2020311356-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""MEPS REAL TIME INC""
  }
]","Methods or arrangements for sensing record carriers, e.g. for reading patterns by electromagnetic radiation, e.g. optical sensing; by corpuscular radiation sensing by radiation using wavelengths larger than 0.1 mm, e.g. radio-waves or microwaves methods and means used by the interrogation device for reliably powering the wireless record carriers using an electromagnetic interrogation field including auxiliary means for focusing, repeating or boosting the electromagnetic interrogation field"
US-10949711-B2,"[
  {
    ""country_code"": ""US"",
    ""name"": ""INTEL CORP""
  }
]","Processor architectures; Processor configuration, e.g. pipelining"
US-10949711-B2,"[
  {
    ""country_code"": ""US"",
    ""name"": ""INTEL CORP""
  }
]","Processor architectures; Processor configuration, e.g. pipelining"
US-89397-A,[],Slabs; Blocks; Pot sleepers; Fastening tie-rods to them
FR-1443904-A,"[
  {
    ""country_code"": """",
    ""name"": ""CALOR APP ELECTRO DOMESTIQUES""
  }
]",Independent devices characterised by heating the hair-curling or hair-waving means before use
FR-1443904-A,"[
  {
    ""country_code"": """",
    ""name"": ""CALOR APP ELECTRO DOMESTIQUES""
  }
]","Hair curlers or hair winders with incorporated heating or drying means, e.g. electric, using chemical reaction"
US-10220314-B2,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""IKEDA AKIO""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""KOBE NAOTO""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""NINTENDO CO LTD""
  }
]","Input arrangements for video game devices characterised by their sensors, purposes or types comprising photodetecting means, e.g. cameras, photodiodes or infrared cells"
US-2020401305-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""ROVI GUIDES INC""
  }
]","Interaction techniques based on graphical user interfaces [GUI] using specific features provided by the input device, e.g. functions controlled by the rotation of a mouse with dual sensing arrangements, or of the nature of the input device, e.g. tap gestures based on pressure sensed by a digitiser using a touch-screen or digitiser, e.g. input of commands through traced gestures for inputting data by handwriting, e.g. gesture or text"
US-2020401305-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""ROVI GUIDES INC""
  }
]","Interaction techniques based on graphical user interfaces [GUI] using specific features provided by the input device, e.g. functions controlled by the rotation of a mouse with dual sensing arrangements, or of the nature of the input device, e.g. tap gestures based on pressure sensed by a digitiser using a touch-screen or digitiser, e.g. input of commands through traced gestures for inputting data by handwriting, e.g. gesture or text"
US-2020401305-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""ROVI GUIDES INC""
  }
]","Interaction techniques based on graphical user interfaces [GUI] using specific features provided by the input device, e.g. functions controlled by the rotation of a mouse with dual sensing arrangements, or of the nature of the input device, e.g. tap gestures based on pressure sensed by a digitiser using a touch-screen or digitiser, e.g. input of commands through traced gestures for inputting data by handwriting, e.g. gesture or text"
US-10949711-B2,"[
  {
    ""country_code"": ""US"",
    ""name"": ""INTEL CORP""
  }
]","Selection of the most significant subset of features by evaluating different subsets according to an optimisation criterion, e.g. class separability, forward selection or backward elimination"
US-10949711-B2,"[
  {
    ""country_code"": ""US"",
    ""name"": ""INTEL CORP""
  }
]"

2025-01-25 10:30:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:30:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:30:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:30:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-25 10:30:57 - snowflake.connector.connection - INFO - closed
2025-01-25 10:30:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:30:57 - root - INFO - SQL:
-- Corrected SQL 4
SELECT DISTINCT f.value:"publication_number"::STRING AS "cited_publication_number", p."assignee_harmonized" AS "cited_assignee"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     TABLE(FLATTEN(input => t."citation")) f,
     PATENTS.PATENTS.PUBLICATIONS p
WHERE f.value:"publication_number"::STRING = p."publication_number"
  AND p."assignee_harmonized" IS NOT NULL
LIMIT 100
Results:
Too long, hard cut:
cited_publication_number,cited_assignee
JP-2006291469-A,"[
  {
    ""country_code"": """",
    ""name"": ""KUROSAWA KENSETSU KK""
  }
]"
JP-2007193854-A,"[
  {
    ""country_code"": """",
    ""name"": ""TOSHIBA CORP""
  }
]"
CN-101613346-A,"[
  {
    ""country_code"": """",
    ""name"": ""UNIV DALI""
  }
]"
US-9274095-B2,"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV SOUTHERN CALIFORNIA""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""DOHENY EYE INST""
  }
]"
JP-2012157476-A,"[
  {
    ""country_code"": """",
    ""name"": ""KAO CORP""
  }
]"
CN-104038880-A,"[
  {
    ""country_code"": """",
    ""name"": ""NANJING INST TECHNOLOGY""
  }
]"
CN-113638676-A,"[
  {
    ""country_code"": """",
    ""name"": ""SOUTHEAST UNIV SHENZHEN INSTITUTE""
  }
]"
US-3925910-A,"[
  {
    ""country_code"": """",
    ""name"": ""OLYMPUS OPTICAL CO""
  }
]"
JP-H11263147-A,"[
  {
    ""country_code"": """",
    ""name"": ""SUZUKI MOTOR CO""
  }
]"
CN-104088166-A,"[
  {
    ""country_code"": """",
    ""name"": ""SHANGHAI ANOKY TEXTILE CHEMICALS CO LTD""
  }
]"
CN-102669328-A,"[
  {
    ""country_code"": """",
    ""name"": ""ANHUI LOVE ON YOUR FOOD CO LTD""
  }
]"
CN-111347106-A,"[
  {
    ""country_code"": """",
    ""name"": ""ANHUI PHETOM INTELLIGENT TRAFFIC TECH CO LTD""
  }
]"
CN-210893210-U,"[
  {
    ""country_code"": """",
    ""name"": ""SHENZHEN ZHONGWU XINGHUA TECH DEVELOPMENT CO LTD""
  }
]"
US-2002136428-A1,[]
CN-102698580-A,"[
  {
    ""country_code"": """",
    ""name"": ""SHANGHAI FUZHEN TECHNOLOGY CO LTD""
  }
]"
US-8807431-B2,"[
  {
    ""country_code"": ""US"",
    ""name"": ""HAND HELD PROD INC""
  }
]"
US-5410993-A,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""YAMAHA MOTOR CO LTD""
  }
]"
US-5425546-A,[]
US-3821630-A,"[
  {
    ""country_code"": """",
    ""name"": ""GEN ELECTRIC""
  }
]"
JP-S5392717-A,"[
  {
    ""country_code"": """",
    ""name"": ""BRITISH PETROLEUM CO""
  }
]"
JP-H09222148-A,"[
  {
    ""country_code"": """",
    ""name"": ""NOK MEGULASTIK CO LTD""
  }
]"
JP-H03245910-A,"[
  {
    ""country_code"": """",
    ""name"": ""OPTON KK""
  }
]"
US-2291161-A,"[
  {
    ""country_code"": """",
    ""name"": ""MORRIS KATCHER""
  }
]"
US-2009245322-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""MASSACHUSETTS INST TECHNOLOGY""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""MOUNT HOLYOKE COLLEGE""
  }
]"
CN-209777651-U,"[
  {
    ""country_code"": """",
    ""name"": ""YANTAI JIATONG IND AUTOMATION CO LTD""
  }
]"
US-2002173144-A1,[]
US-6611248-B2,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""CASIO COMPUTER CO LTD""
  }
]"
US-5556357-A,[]
CN-101638749-A,"[
  {
    ""country_code"": """",
    ""name"": ""CENTRAL IRON & STEEL RES INST""
  }
]"
JP-H07252228-A,"[
  {
    ""country_code"": """",
    ""name"": ""FUJISAWA PHARMACEUTICAL CO""
  }
]"
US-2018366105-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""APPLE INC""
  }
]"
US-4095066-A,"[
  {
    ""country_code"": """",
    ""name"": ""IBM""
  }
]"
US-2005227703-A1,"[
  {
    ""country_code"": """",
    ""name"": ""CHENG STEVEN D""
  }
]"
DE-102006051376-A1,"[
  {
    ""country_code"": ""DE"",
    ""name"": ""ESKA FLOWFORM GMBH""
  }
]"
US-5396129-A,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""MATSUSHITA ELECTRONICS CORP""
  }
]"
US-2009285279-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""ATHEROS COMM INC""
  }
]"
US-6419729-B1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""3M INNOVATIVE PROPERTIES CO""
  }
]"
JP-H06210640-A,"[
  {
    ""country_code"": """",
    ""name"": ""AIRTECH INT INC""
  }
]"
KR-101758189-B1,"[
  {
    ""country_code"": ""KR"",
    ""name"": ""MOTORTRONICS INT'L KOREA CO LTD""
  }
]"
US-10275331-B1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""CAPITAL ONE SERVICES LLC""
  }
]"
US-2008307155-A1,"[
  {
    ""country_code"": """",
    ""name"": ""SINCLAIR ALAN W""
  }
]"
JP-H0459752-A,"[
  {
    ""country_code"": """",
    ""name"": ""SHOWA DENKO KK""
  }
]"
CN-103306799-A,"[
  {
    ""country_code"": """",
    ""name"": ""GREAT WALL MOTOR CO LTD""
  }
]"
CN-105631498-A,"[
  {
    ""country_code"": """",
    ""name"": ""GUANGXI ZHUANG AUTONOMOUS REGION INST OF METROLOGY & TEST""
  }
]"
CN-103295149-A,"[
  {
    ""country_code"": """",
    ""name"": ""MU SIGMA BUSINESS SOLUTIONS PVT LTD""
  }
]"
US-5523667-A,[]
US-4830006-A,"[
  {
    ""country_code"": ""US"",
    ""name"": ""INTERMEDICS INC""
  }
]"
JP-2008127472-A,"[
  {
    ""country_code"": """",
    ""name"": ""NIPPON STEEL CORP""
  }
]"
CN-105294667-A,"[
  {
    ""country_code"": """",
    ""name"": ""SHANGHAI INSITITUTE OF ORGANIC CHEMISTRY CHINESE ACADEMY OF SCIENCES""
  }
]"
US-4452846-A,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""FUJI PHOTO FILM CO LTD""
  }
]"
JP-H0855343-A,"[
  {
    ""country_code"": """",
    ""name"": ""MATSUSHITA ELECTRIC IND CO LTD""
  }
]"
US-2011055074-A1,"[
  {
    ""country_code"": """",
    ""name"": ""CHEN YONGHUI""
  },
  {
    ""country_code"

2025-01-25 10:30:57 - root - INFO - itercount: 0
2025-01-25 10:30:57 - root - INFO - Database Name: PATENTS
Schema Name: PATENTS
DDL describes table information.
,0
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,1
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""spif_publication_number"" VARCHAR(16777216),
	""spif_application_number"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""claims_localized_html"" VARIANT,
	""description_localized"" VARIANT,
	""description_localized_html"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""locarno"" VARIANT,
	""citation"" VARIANT,
	""parent"" VARIANT,
	""child"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,2
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

External knowledge that might be helpful: 
### IPC Codes: Handling Main IPC Code Selection

When dealing with the `ipc` field in the `patents-public-data.patents.publications` dataset, it is important to understand the structure of this field, especially the subfield `first`. This subfield is a boolean that indicates whether a given IPC code is the main code for the publication number in question. This is crucial because each patent publication can be associated with multiple IPC codes, signifying the various aspects of the technology covered by the patent.

However, not every publication in the dataset has a designated main IPC code. This lack of a clearly identified main IPC code complicates the process of determining the most relevant IPC code for each publication, as selecting a single IPC code from multiple possibilities without clear prioritization can lead to inconsistent or skewed analyses.

This approach ensures a more consistent and representative selection of IPC codes across the dataset, facilitating more accurate and meaningful analysis of patent trends and classifications. By focusing on the most frequently occurring 4-digit IPC code, the view helps overcome the limitations posed by the absence of a designated main IPC code, thereby enhancing the reliability of patent-related studies and insights derived from this data.

Here is an example

```
SELECT 
    t1.publication_number, 
    SUBSTR(ipc_u.code, 0, 4) as ipc4, 
    COUNT(
    SUBSTR(ipc_u.code, 0, 4)
    ) as ipc4_count 
FROM 
    `patents-public-data.patents.publications` t1, 
    UNNEST(ipc) AS ipc_u 
GROUP BY 
    t1.publication_number, 
    ipc4

```



# Text Embeddings (Similarity)

Patent documents are rich with textual data. In fact, most of the information contained in a patent document is text. This includes the `abstract_localized`, `description_localized`, and `claims_localized`. Textual data can be a powerful tool to analyze and compare patent scope and content across patents. However, before being able to use textual data, it needs to be vectorized or transformed into text embeddings that can be used by machine learning models. Therefore, creating text embeddings from the textual data of patents is necessary to compare patent contents. Technically speaking, running an NLP algorithm that creates embeddings for all U.S. patents is computationally difficult.

Nevertheless, Google runs their own machine learning algorithm which transforms patent text metadata into text embeddings which they report in `patents-public-data.google_patents_research.publications` table. The textual embeddings of one patent, without any knowledge on the algorithm being used to create them, are meaningless on their own. However, the embeddings are powerful when it comes to comparing textual content of two or more patents. Embeddings can be used to calculate a similarity score between any two patents. This similarity score is calculated by applying the dot product of the embeddings vector of the patents, as shown below:

The similarity \( \text{Similarty}_{i,k} \) between two patents \( i \) and \( k \) is calculated as the dot product of their embedding vectors:

\[
\text{Similarty}_{i,k} = \mathbf{v}_i \cdot \mathbf{v}_k
\]

where

\[
\mathbf{v}_i = [v_{i1}, v_{i2}, v_{i3}, \ldots, v_{iN}]
\]
and
\[
\mathbf{v}_k = [v_{k1}, v_{k2}, v_{k3}, \ldots, v_{kN}]
\]

are the embedding vectors for patents \( i \) and \( k \) respectively. The higher the dot product, the more similar the patents.





# Originality (Trajtenberg)

One of the most important measures of a patent is "basicness". The aspects of basicness are tough to measure. Nevertheless, some literature finds that important aspects of these measures are embodied in the relationship between the invention and the technological predcessors and successors it is connected to through, for example, patent citations. We can thus use patent citations to construct measures that identify basicness and appropriability. Trajtenberg et al. 1997 provide a number of these measures. They distinguish between:

1. Forward-looking measures: measures that are derived from the relationship between an invention and subsequent technologies that build upon it. These measures are thus constructed from the forward citations. One example of a forward-looking basicness measure they provide is Generality, which is calculated as:

\[
\text{GENERALITY}_i = 1 - \sum_{k=1}^{N_i} \left( \frac{\text{NCITING}_{G_k}}{\text{NCITING}_i} \right)
\]


2. Backward-looking measures: measures that are derived from the relationship between a given patent and the body of knowledge that preceded it. These measure are thus constructed from the backward citations. One example of a backward-looking basicness measure they provide is Orginality, which is calculated as:

\[
\text{ORIGINALITY}_i = 1 - \sum_{k=1}^{N_i} \left( \frac{\text{NCITED}_{i,k}}{\text{NCITED}_i} \right)
\]

With **NCITING** and **NCITED** defined as the number of patents citing the focal patent and the number of patents cited by the focal patent, respectively. Index `i` corresponds to the focal patent considered, and `k` is the index of patent classes. For example, **NCITED_2,3** refers to the number of patents in patent class 3 and cited by our focal patent 2.


The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

1. **PUBLICATIONS Table:**

   - **"publication_number"**: To identify individual patents.
   - **"assignee_harmonized"**: To determine the assignee of each patent; used to find patents assigned to DENSO CORP and to get the assignee names of citing patents.
   - **"citation"**: A VARIANT column containing citations made by the patent; used to find patents that cite DENSO CORP's patents.
   - **"cpc"**: A VARIANT column containing the CPC classification codes assigned to each patent; used to extract the primary CPC codes of citing patents.

2. **CPC_DEFINITION Table:**

   - **"symbol"**: The CPC code symbol; used to join with the CPC codes from the PUBLICATIONS table.
   - **"titleFull"**: The full title of the CPC subclass; provides the descriptive title of the CPC codes.

**SQL Queries:**

1. **Retrieve patents assigned to DENSO CORP:**

   ```sql
   SELECT "publication_number", "assignee_harmonized"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "assignee_harmonized" LIKE '%DENSO CORP%'
   LIMIT 100;
   ```

2. **List distinct publication numbers of DENSO CORP patents:**

   ```sql
   SELECT DISTINCT "publication_number"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "assignee_harmonized" LIKE '%DENSO CORP%'
   LIMIT 100;
   ```

3. **Explore the structure of the "citation" field:**

   ```sql
   SELECT "publication_number", "citation"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100;
   ```

4. **Extract cited publication numbers from the "citation" field:**

   ```sql
   SELECT f.value:"publication_number"::STRING AS "cited_publication_number"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."citation") f
   WHERE f.value:"publication_number" IS NOT NULL
   LIMIT 100;
   ```

5. **Retrieve distinct assignee names:**

   ```sql
   SELECT DISTINCT "assignee_harmonized"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "assignee_harmonized" IS NOT NULL
   LIMIT 100;
   ```

6. **Extract CPC codes associated with patents:**

   ```sql
   SELECT t."publication_number", c.value:"code"::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c
   LIMIT 100;
   ```

7. **Get CPC codes and their full titles from CPC_DEFINITION:**

   ```sql
   SELECT "symbol", "titleFull"
   FROM PATENTS.PATENTS.CPC_DEFINITION
   LIMIT 100;
   ```

8. **Find the number of times each patent has been cited:**

   ```sql
   SELECT f.value:"publication_number"::STRING AS "cited_publication_number", COUNT(*) AS "citation_count"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."citation") f
   WHERE f.value:"publication_number" IS NOT NULL
   GROUP BY "cited_publication_number"
   ORDER BY "citation_count" DESC
   LIMIT 100;
   ```

9. **List patents along with their assignees and CPC codes:**

   ```sql
   SELECT t."publication_number", t."assignee_harmonized", c.value:"code"::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c
   WHERE t."assignee_harmonized" IS NOT NULL
   LIMIT 100;
   ```

10. **Retrieve citations made by a specific patent (replace 'US1234567A' with actual publication number):**

    ```sql
    SELECT f.value:"publication_number"::STRING AS "cited_publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."citation") f
    WHERE t."publication_number" = 'US1234567A'
    LIMIT 100;
    ```

11. **Find patents that cite a specific patent (replace 'US1234567A' with actual publication number):**

    ```sql
    SELECT t."publication_number" AS "citing_publication_number", t."assignee_harmonized"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."citation") f
    WHERE f.value:"publication_number"::STRING = 'US1234567A'
    LIMIT 100;
    ```

12. **Extract primary CPC subclass codes (first four characters) for patents:**

    ```sql
    SELECT t."publication_number", SUBSTR(c.value:"code"::STRING, 1, 4) AS "primary_cpc_subclass"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") c
    LIMIT 100;
    ```

13. **Join CPC codes with their titles from CPC_DEFINITION table:**

    ```sql
    SELECT c."symbol", d."titleFull"
    FROM PATENTS.PATENTS.CPC_DEFINITION d
    JOIN (
      SELECT DISTINCT c.value:"code"::STRING AS "symbol"
      FROM PATENTS.PATENTS.PUBLICATIONS t,
      LATERAL FLATTEN(input => t."cpc") c
      LIMIT 100
    ) c
    ON c."symbol" = d."symbol"
    LIMIT 100;
    ```

14. **List patents with their assignees and the full title of their primary CPC subclass:**

    ```sql
    SELECT t."publication_number", t."assignee_harmonized", d."titleFull" AS "cpc_title"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."cpc") c
    JOIN PATENTS.PATENTS.CPC_DEFINITION d
    ON c.value:"code"::STRING = d."symbol"
    WHERE t."assignee_harmonized" IS NOT NULL
    LIMIT 100;
    ```

15. **Retrieve citations along with assignee of the cited patents:**

    ```sql
    SELECT DISTINCT f.value:"publication_number"::STRING AS "cited_publication_number", p."assignee_harmonized" AS "cited_assignee"
    FROM PATENTS.PATENTS.PUBLICATIONS t,
    LATERAL FLATTEN(input => t."citation") f
    LEFT JOIN PATENTS.PATENTS.PUBLICATIONS p
    ON f.value:"publication_number"::STRING = p."publication_number"
    WHERE p."assignee_harmonized" IS NOT NULL
    LIMIT 100;
    ```

**Explanation:**

The above queries are designed to explore the relevant data needed to address the task:

- Identifying patents assigned to DENSO CORP.
- Exploring the citations made by patents and retrieving cited publication numbers.
- Examining the assignees of citing patents.
- Extracting CPC codes and their corresponding full titles.
- Understanding the relationships between patents, their assignees, and their CPC classifications.

These queries help in understanding the structure and content of the tables and columns relevant to the task, particularly focusing on handling nested JSON structures in the VARIANT columns like "citation" and "cpc".Query:
SELECT "publication_number", "assignee_harmonized"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "assignee_harmonized" LIKE '%DENSO CORP%'
   LIMIT 100;
Answer:
Too long, hard cut:
publication_number,assignee_harmonized
US-2003122645-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""DENSO CORP""
  }
]"
US-2009266335-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2007200067-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
WO-2018016219-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
WO-2018096760-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
WO-2020066482-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
DE-102004042762-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
DE-102004061882-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2007289384-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-7568400-B2,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""JTEKT CORP""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2016148856-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2021261142-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2021325116-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2022028029-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2022190113-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""TOYOTA MOTOR CO LTD""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""MIRISE Technologies Corporation""
  }
]"
US-2021276398-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2024167830-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
DE-10218083-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""NIPPON SOKEN""
  }
]"
US-2018004315-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2021010842-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2020361416-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2005046395-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2005209755-A1,"[
  {
    ""country_code"": """",
    ""name"": ""DENSO CORP""
  }
]"
US-2006057953-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
DE-102021120645-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2023394418-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2023207423-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""TOYOTA MOTOR CO LTD""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""MIRISE Technologies Corporation""
  }
]"
DE-10129321-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2019152298-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2021017924-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2021041508-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2019222810-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2006213254-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2009148329-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2011010085-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2014346853-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""ADVICS CO LTD""
  }
]"
US-2024010045-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2024004972-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2024017616-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2024123834-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2024246568-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
JP-H10209446-A,"[
  {
    ""country_code"": """",
    ""name"": ""DENSO CORP""
  }
]"
US-9127612-B2,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""NAKATA KENICHIRO""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""ISHIZUKA KOJI""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2004178870-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2006152215-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2008082260-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2008227599-A1,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""DENSO CORP""
  }
]"
US-2022066210-A1,"[
  {
    ""country_code"": ""JP"",
 
Query:
SELECT DISTINCT "publication_number"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "assignee_harmonized" LIKE '%DENSO CORP%'
   LIMIT 100;
Answer:
publication_number
DE-69911567-T9
DE-102006000312-B4
JP-2000116145-A
US-2020303905-A1
JP-2011119585-A
JP-H09109037-A
DE-112015002407-T5
US-11067688-B2
JP-2008295110-A
US-2024123834-A1
US-2018340128-A1
JP-H0979783-A
JP-2005123257-A
JP-2020056752-A
CN-102770233-B
JP-2007183241-A
JP-2008240337-A
US-2005178609-A1
CN-107002235-A
US-9087924-B2
DE-102008036832-A1
JP-2004191321-A
US-2007200067-A1
US-2022190113-A1
JP-2012219767-A
JP-2006264404-A
CN-107950006-A
US-2024004972-A1
US-2024017616-A1
JP-2002174152-A
JP-2008215135-A
US-2019092325-A1
JP-2021163369-A
JP-2011228778-A
DE-69739014-D1
WO-2021033757-A1
WO-2024162212-A1
DE-102019101566-A1
JP-2000358305-A
US-2021325116-A1
JP-2003039931-A
JP-2014144497-A
JP-2013160905-A
CN-101413443-A
JP-2003300410-A
DE-102014209298-B4
WO-2018079560-A1
JP-2020061437-A
JP-2008293269-A
DE-102009004384-A1
DE-112014001661-T5
JP-2012086626-A
JP-2019166967-A
US-6989627-B2
JP-2008183499-A
JP-H10103210-A
JP-2007118830-A
JP-2018199473-A
JP-2020054063-A
SE-524656-C2
JP-2001143748-A
WO-2023054546-A1
JP-2009088350-A
US-2015314783-A1
JP-2000192874-A
JP-2001294036-A
JP-2004330961-A
US-2006152215-A1
US-2019152298-A1
JP-2005166291-A
CN-113646595-A
JP-2007040791-A
US-2018006520-A1
JP-2010083245-A
JP-2016133108-A
JP-2021110849-A
US-2020408440-A1
US-10790774-B2
US-2008227599-A1
BR-PI0714595-A2
JP-2016030554-A
JP-2010242621-A
JP-2001082835-A
JP-2010147228-A
JP-2011073503-A
JP-2015137587-A
US-2020361416-A1
WO-2021112035-A1
DE-112016001259-B4
WO-2018096760-A1
JP-2019002836-A
JP-2008116822-A
JP-2004023754-A
CN-102857275-A
JP-2023138787-A
DE-102007016068-A1
JP-2015173414-A
JP-2014149784-A
US-2018004315-A1
DE-112022002330-T5
Query:
SELECT "publication_number", "citation"
   FROM PATENTS.PATENTS.PUBLICATIONS
   LIMIT 100;
Answer:
publication_number,citation
CR-5634-A,[]
CR-5990-A,[]
FI-429-A,[]
HK-6083-A,[]
HU-T52763-A,[]
JP-H03206829-A,[]
JP-S62159089-A,[]
US-416-A,[]
US-2528225-A,"[
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-1632271-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-1959660-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2013863-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2144669-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2154308-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2155785-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2190901-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2207418-A"",
    ""type"": """"
  }
]"
AT-A41580-A,[]
AT-A47682-A,[]
AT-A63682-A,[]
CA-920790-A,[]
CA-950907-A,[]
CA-920830-A,[]
CA-9086-A,[]
CH-3256-A,[]
CH-540255-A,[]
CH-433637-A,[]
CH-8494-A,[]
CH-9587-A,[]
CH-9968-A,[]
DD-8297-A,[]
FR-1334211-A,[]
FR-1444995-A,[]
FR-1474468-A,[]
FR-1478988-A,[]
FR-1485992-A,[]
FR-1487706-A,[]
FR-1508237-A,[]
GB-893001-A,[]
GB-873984-A,[]
GB-307790-A,[]
GB-534192-A,[]
HK-39487-A,[]
HK-52284-A,[]
HK-55992-A,[]
HK-60178-A,[]
HK-82486-A,[]
HU-T58725-A,[]
JP-S62157892-A,[]
JP-H06198910-A,[]
MA-42286-A,[]
OA-07542-A,[]
OA-08399-A,[]
PH-11723-A,[]
PH-15213-A,[]
PH-17928-A,[]
PH-23905-A,[]
TR-26506-A,[]
US-4613-A,[]
US-4234270-A,"[
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2187871-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-2414011-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-3708987-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-3720066-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": """",
    ""publication_number"": ""US-3793842-A"",
    ""type"": """"
  },
  {
    ""application_number"": """",
    ""category"": ""SEA"",
    ""filing_date"": 0,
    ""npl_text"": ""Engineering News Record, May 10, 1973, p. 39."",
    ""publication_number"": """",
    ""type"": """"
  }
]"
US-6310-A,[]
US-8947-A,[]
YU-24971-A,[]
YU-51397-A,[]
YU-53588-A,[]
YU-94082-A,[]
AT-A134275-A,[]
AT-A160683-A,[]
AT-A168281-A,[]
AT-A179178-A,[]
AT-A196182-A,[]
AT-A202882-A,[]
AT-A205780-A,[]
AT-A245590-A,[]
AT-A250686-A,[]
AT-A269985-A,[]
AT-A272073-A,[]
AT-A312885-A,[]
AT-A404675-A,[]
AT-A482077-A,[]
AT-A519575-A,[]
AT-A710279-A,[]
AT-A735378-A,[]
AT-A876472-A,[]
AT-A906278-A,[]
BE-804534-A,[]
BE-806687-A,[]
BE-813367-A,[]
BE-823416-A,[]
BE-825816-A,[]
BE-833811-A,[]
BE-837312-A,[]
BE-837857-A,[]
BE-840231-A,[]
BE-848755-A,[]
BE-852837-A,[]
BE-853553-A,[]
BE-857395-A,[]
BE-861199-A,[]
BE-866723-A,[]
BE-868080-A,[]
BE-868938-A,[]
BE-869056-A,[]
BE-871421-A,[]
BE-873394-A,[]
BE-877768-A,[]
BE-885287-A,[]
BE-509322-A,[]
Query:
SELECT f.value:"publication_number"::STRING AS "cited_publication_number"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."citation") f
   WHERE f.value:"publication_number" IS NOT NULL
   LIMIT 100;
Answer:
cited_publication_number
JP-H06330535-A
JP-2007009256-A
JP-2009058640-A
JP-2013214059-A
WO-2014034720-A1
US-8974066-B2
JP-2016017083-A
JP-2009236404-A
JP-2017197822-A
""
""
""
DE-670840-C
US-6702245-B1
WO-2010015023-A1
US-2014263926-A1
JP-2016030087-A
CN-107411266-A
US-2608935-A
CH-390978-A
CH-432574-A
DE-1580888-A1
DE-3033601-A1
DE-69607479-T2
US-4848175-A
DE-4435601-A1
RU-76004-U1
CN-204551328-U
EP-1578580-A1
EP-2072205-A1
RU-2009101922-A
RU-156998-U1
""
JP-S5161019-A
SU-1155693-A1
RU-124763-U1
RU-155006-U1
DE-69912396-T2
CZ-278878-B6
CZ-285560-B6
DE-102004007758-A1
CZ-17947-U1
EP-0698568-B1
DE-102015113737-B3
US-5013300-A
US-5071418-A
US-5693044-A
US-2002019631-A1
US-6458125-B1
US-2007129722-A1
US-2009018539-A1
WO-2014032157-A1
US-2014081086-A1
US-7719055-B1
US-7872888-B2
US-9007117-B2
US-9048119-B2
US-9269711-B2
US-9350342-B2
US-4402477-A
US-4422604-A
US-6786451-B2
US-9145204-B2
GB-1227405-A
US-4243735-A
US-4277525-A
US-2002032318-A1
US-2002091059-A1
US-6695903-B1
US-2004057142-A1
US-2005031791-A1
US-2007019677-A1
US-2011155967-A1
US-2012313055-A1
""
""
""
US-4094444-A
US-4285444-A
US-4449642-A
US-6516733-B1
WO-2007064184-A2
US-2010282144-A1
US-2011178632-A1
US-2011271887-A1
US-2015059630-A1
US-2015282422-A1
US-2007101202-A1
US-2007136541-A1
US-7266718-B2
US-7587570-B2
US-7657796-B1
US-7694092-B2
US-2010318837-A1
US-8341121-B1
US-2013080823-A1
US-9003086-B1
US-9264494-B2
US-9304815-B1
US-2002156145-A1
Query:
SELECT DISTINCT "assignee_harmonized"
   FROM PATENTS.PATENTS.PUBLICATIONS
   WHERE "assignee_harmonized" IS NOT NULL
   LIMIT 100;
Answer:
Too long, hard cut:
assignee_harmonized
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ZIMMER INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""NIBCO""
  }
]"
"[
  {
    ""country_code"": ""FR"",
    ""name"": ""ARIANEGROUP SAS""
  }
]"
"[
  {
    ""country_code"": ""CA"",
    ""name"": ""MITEL NETWORKS CORP""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""PERMELEC ELCTRODE LTD""
  },
  {
    ""country_code"": ""IT"",
    ""name"": ""PERMELEC SPA NORA""
  }
]"
"[
  {
    ""country_code"": ""CN"",
    ""name"": ""SHANGHAI BAOSTEEL EQUIP MAINT""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""MAGGINI MARIO""
  }
]"
"[
  {
    ""country_code"": ""IT"",
    ""name"": ""CAPOCCIA FRANCESCO""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""DOW AGROSCIENCES LLC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""QUICKPATH ANALYTICS INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""KERFLUMMOX HOLDINGS LLC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HUANG CHAO YANG""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""GEPPERT CARL F""
  },
  {
    ""country_code"": """",
    ""name"": ""GEPPERT THEODORE R""
  },
  {
    ""country_code"": """",
    ""name"": ""RHOADES ROBERT A""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SKYLINE BIOMEDICAL INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MENTOR GRAPHICS CORP""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""GRACE CHARLOTTE""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ISE CORP""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ANEMIKOS THEODOROS E""
  },
  {
    ""country_code"": """",
    ""name"": ""CORSON PHILLIP L""
  },
  {
    ""country_code"": """",
    ""name"": ""ERTURK METE""
  },
  {
    ""country_code"": """",
    ""name"": ""HALL EZRA D B""
  },
  {
    ""country_code"": """",
    ""name"": ""PERRI ANTHONY J""
  },
  {
    ""country_code"": """",
    ""name"": ""VENTRONE SEBASTIAN T""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""LYNDE GERALD D""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""ROSENBLATT STEVE""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""BAKER HUGHES INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""OKIN KENNETH A""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""KARAMCHETI VIJAY""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""VIRIDENT SYSTEMS INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""KARAOGUZ JEYHAN""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""BROADCOM CORP""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ACME STEEL CO""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""EARNSHAW KNITTING COMPANY""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BRUEGGEMAN LOUIS W""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""PUTZMEISTER ENGINEERING GMBH""
  }
]"
"[
  {
    ""country_code"": ""SG"",
    ""name"": ""AGENCY FOR SCIENCE TECHNOLGY AND RES""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""DOLBY LABORATORIES LICENSING CORP""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""SIEMENS MOBILITY INC""
  }
]"
"[
  {
    ""country_code"": ""JP"",
    ""name"": ""EBARA CORP""
  }
]"
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""LG ENERGY SOLUTION LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""ZHANG FUMING""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""FUJIAN BEIDIAN NEW MATERIAL TECH CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""LU ZHANPING""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""KITCHEN AND BATH ELECTRIC APPLIANCE MFG LIMITED COMPANY OF TURNIP LAKE MEI""
  },
  {
    ""country_code"": """",
    ""name"": ""MIDEA GROUP CO LTD""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""HUANGSHI POWER SUPPLY COMPANY STATE GRID HUBEI ELECTRIC POWER CO LTD""
  }
]"
"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BAYER AG""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""AB INITIO TECHNOLOGY LLC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""MAGNOLIA MEDICAL TECHNOLOGIES INC""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""BALL BROTHERS CO""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""EVEY JOHN M""
  }
]"
"[
  {
    ""country_code"": """",
    ""name"": ""PETROLEUM EQUIPMENT COMPANY""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""KPR US LLC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""BLACK & DECKER INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""ADEMCO INC""
  }
]"
"[
  {
    ""country_code"": ""US"",
    ""name"": ""PALO ALTO NETWORKS INC""
  }
]"
"[
  {
    ""country_code"": ""BE"",
    ""name"": ""FINUICK SA""
  }
]"
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""BAE SAM HOON""
  }
]"
"[
  {
    ""country_code"": ""KR"",
    ""name"": ""KOREA ELEC
Query:
SELECT t."publication_number", c.value:"code"::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c
   LIMIT 100;
Answer:
publication_number,cpc_code
CN-214682489-U,Y02P70/10
CN-214477141-U,Y04S10/18
CN-214477141-U,Y02E60/00
CN-214715286-U,Y02P90/02
CN-214675809-U,Y02B20/40
CN-214682433-U,Y02P70/10
CN-214956910-U,Y02E10/50
CN-214956910-U,Y02P70/50
CN-213375840-U,Y02A50/20
CN-214700498-U,Y02A20/108
CN-214700498-U,Y02B20/72
CN-214477726-U,Y02E60/10
CN-215050574-U,Y02P10/25
CN-215495119-U,G06K19/07722
CN-215495119-U,G06V40/1318
CN-215495119-U,G06K19/07722
CN-215495119-U,G06K19/0718
CN-214657421-U,Y02A20/108
US-2004046148-A1,C23F1/26
US-2004046148-A1,H01L21/3212
US-2004046148-A1,C23F3/06
US-2004046148-A1,H01L21/32134
US-2004046148-A1,C23F3/06
US-2004046148-A1,C09G1/02
US-2004046148-A1,H01L21/32115
US-2004046148-A1,C23F3/04
US-2004046148-A1,C23F1/18
US-2004046148-A1,C09G1/02
US-2004046148-A1,C23F3/06
US-2004046148-A1,H01L21/32115
US-2004046148-A1,H01L21/3212
US-2004046148-A1,C23F1/18
US-2004046148-A1,C23F3/04
US-2004046148-A1,H01L21/32134
US-2004249430-A1,A61N1/05
US-2004249430-A1,A61N1/05
US-2004249430-A1,A61N1/056
US-2004249430-A1,A61N1/056
US-2004254481-A1,A61B7/04
US-2004254481-A1,A61B5/318
US-2004254481-A1,A61B7/04
US-2004254481-A1,A61B5/0816
US-2004254481-A1,A61B5/0816
US-2004254481-A1,A61B5/318
US-2004179568-A1,H01S5/0421
US-2004179568-A1,H01S5/3095
US-2004179568-A1,H01S5/3072
US-2004179568-A1,H01S5/02476
US-2004179568-A1,H01S5/0217
US-2004179568-A1,H01S5/18308
US-2004179568-A1,H01S5/18375
US-2004179568-A1,H01S5/18377
US-2004179568-A1,H01S5/04253
US-2004179568-A1,H01S5/04252
US-2004179568-A1,H01S5/18369
US-2004179568-A1,H01S5/18375
US-2004179568-A1,H01S5/18369
US-2004179568-A1,H01S5/18308
US-2004179568-A1,H01S5/0217
US-2004179568-A1,H01S5/3072
US-2004179568-A1,H01S5/02476
US-2004179568-A1,H01S5/18377
US-2004179568-A1,H01S5/0421
US-2004179568-A1,H01S5/3095
US-2004179568-A1,H01S5/04253
US-2004179568-A1,H01S5/04252
US-2004179568-A1,H01S5/18375
US-2004179568-A1,H01S5/3095
US-2004179568-A1,H01S5/18377
US-2004179568-A1,H01S5/02476
US-2004179568-A1,H01S5/0217
US-2004179568-A1,H01S5/18369
US-2004179568-A1,H01S5/18308
US-2004179568-A1,H01S5/0421
US-2004179568-A1,H01S5/3072
US-2004179568-A1,H01S5/04253
US-2004250894-A1,B27L7/00
US-2004250894-A1,B27L7/005
US-2004250894-A1,B27L7/00
US-2004250894-A1,B27L7/005
US-2005110223-A1,F16J15/0825
US-2005110223-A1,F16J15/0825
US-2005031765-A1,A23L7/126
US-2005031765-A1,A23L7/115
US-2005031765-A1,A23L7/126
US-2005031765-A1,A23L7/115
US-2005012526-A1,H03F3/45748
US-2005012526-A1,H03F2203/30015
US-2005012526-A1,H03F3/45179
US-2005012526-A1,H03F3/45941
US-2005012526-A1,H03F3/45941
US-2005012526-A1,H03F2203/45681
US-2005012526-A1,H03F2203/45292
US-2005012526-A1,H03F2203/30015
US-2005012526-A1,H03F2203/45082
US-2005012526-A1,H03F2203/45008
US-2005012526-A1,H03F3/45179
US-2005012526-A1,H03F3/45748
US-2005012526-A1,H03F3/3022
US-2005012526-A1,H03F2203/45082
Query:
SELECT "symbol", "titleFull"
   FROM PATENTS.PATENTS.CPC_DEFINITION
   LIMIT 100;
Answer:
Too long, hard cut:
symbol,titleFull
B,PERFORMING OPERATIONS; TRANSPORTING
H,ELECTRICITY
Y,GENERAL TAGGING OF NEW TECHNOLOGICAL DEVELOPMENTS; GENERAL TAGGING OF CROSS-SECTIONAL TECHNOLOGIES SPANNING OVER SEVERAL SECTIONS OF THE IPC; TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS
D,TEXTILES; PAPER
F,MECHANICAL ENGINEERING; LIGHTING; HEATING; WEAPONS; BLASTING
E,FIXED CONSTRUCTIONS
C,CHEMISTRY; METALLURGY
G,PHYSICS
A,HUMAN NECESSITIES
A45,HAND OR TRAVELLING ARTICLES
A24,TOBACCO; CIGARS; CIGARETTES; SIMULATED SMOKING DEVICES; SMOKERS' REQUISITES
A61,MEDICAL OR VETERINARY SCIENCE; HYGIENE
A63,SPORTS; GAMES; AMUSEMENTS
A22,BUTCHERING; MEAT TREATMENT; PROCESSING POULTRY OR FISH
A42,HEADWEAR
A99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
A43,FOOTWEAR
A01,AGRICULTURE; FORESTRY; ANIMAL HUSBANDRY; HUNTING; TRAPPING; FISHING
A62,LIFE-SAVING; FIRE-FIGHTING
A23,"FOODS OR FOODSTUFFS; TREATMENT THEREOF, NOT COVERED BY OTHER CLASSES"
A47,FURNITURE; DOMESTIC ARTICLES OR APPLIANCES; COFFEE MILLS; SPICE MILLS; SUCTION CLEANERS IN GENERAL
A46,BRUSHWARE
A44,HABERDASHERY; JEWELLERY
A21,BAKING; EDIBLE DOUGHS
A41,WEARING APPAREL
B27,WORKING OR PRESERVING WOOD OR SIMILAR MATERIAL; NAILING OR STAPLING MACHINES IN GENERAL
B68,SADDLERY; UPHOLSTERY
B04,CENTRIFUGAL APPARATUS OR MACHINES FOR CARRYING-OUT PHYSICAL OR CHEMICAL PROCESSES
B23,MACHINE TOOLS; METAL-WORKING NOT OTHERWISE PROVIDED FOR
B30,PRESSES
B21,MECHANICAL METAL-WORKING WITHOUT ESSENTIALLY REMOVING MATERIAL; PUNCHING METAL
B25,HAND TOOLS; PORTABLE POWER-DRIVEN TOOLS; MANIPULATORS
B99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
B29,WORKING OF PLASTICS; WORKING OF SUBSTANCES IN A PLASTIC STATE IN GENERAL
B31,"MAKING ARTICLES OF PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER; WORKING PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER"
B26,HAND CUTTING TOOLS; CUTTING; SEVERING
B66,HOISTING; LIFTING; HAULING
B02,"CRUSHING, PULVERISING, OR DISINTEGRATING; PREPARATORY TREATMENT OF GRAIN FOR MILLING"
B65,CONVEYING; PACKING; STORING; HANDLING THIN OR FILAMENTARY MATERIAL
B61,RAILWAYS
B24,GRINDING; POLISHING
B06,GENERATING OR TRANSMITTING MECHANICAL VIBRATIONS IN GENERAL
B43,WRITING OR DRAWING IMPLEMENTS; BUREAU ACCESSORIES
B62,LAND VEHICLES FOR TRAVELLING OTHERWISE THAN ON RAILS
B64,AIRCRAFT; AVIATION; COSMONAUTICS
B22,CASTING; POWDER METALLURGY
B28,"WORKING CEMENT, CLAY, OR STONE"
B09,DISPOSAL OF SOLID WASTE; RECLAMATION OF CONTAMINATED SOIL
B01,PHYSICAL OR CHEMICAL PROCESSES OR APPARATUS IN GENERAL
B63,SHIPS OR OTHER WATERBORNE VESSELS; RELATED EQUIPMENT
B60,VEHICLES IN GENERAL
B44,DECORATIVE ARTS
B07,SEPARATING SOLIDS FROM SOLIDS; SORTING
B08,CLEANING
B82,NANOTECHNOLOGY
B42,BOOKBINDING; ALBUMS; FILES; SPECIAL PRINTED MATTER
B32,LAYERED PRODUCTS
B81,MICROSTRUCTURAL TECHNOLOGY
B05,"SPRAYING OR ATOMISING IN GENERAL; APPLYING FLUENT MATERIALS TO SURFACES, IN GENERAL"
B41,PRINTING; LINING MACHINES; TYPEWRITERS; STAMPS
B03,SEPARATION OF SOLID MATERIALS USING LIQUIDS OR USING PNEUMATIC TABLES OR JIGS; MAGNETIC OR ELECTROSTATIC SEPARATION OF SOLID MATERIALS FROM SOLID MATERIALS OR FLUIDS; SEPARATION BY HIGH-VOLTAGE ELECTRIC FIELDS
B67,"OPENING, CLOSING OR CLEANING BOTTLES, JARS OR SIMILAR CONTAINERS; LIQUID HANDLING"
B33,ADDITIVE MANUFACTURING TECHNOLOGY
C22,METALLURGY; FERROUS OR NON-FERROUS ALLOYS; TREATMENT OF ALLOYS OR NON-FERROUS METALS
C23,"COATING METALLIC MATERIAL; COATING MATERIAL WITH METALLIC MATERIAL; CHEMICAL SURFACE TREATMENT; DIFFUSION TREATMENT OF METALLIC MATERIAL; COATING BY VACUUM EVAPORATION, BY SPUTTERING, BY ION IMPLANTATION OR BY CHEMICAL VAPOUR DEPOSITION, IN GENERAL; INHIBITING CORROSION OF METALLIC MATERIAL OR INCRUSTATION IN GENERAL"
C06,EXPLOSIVES; MATCHES
C02,"TREATMENT OF WATER, WASTE WATER, SEWAGE, OR SLUDGE"
C07,ORGANIC CHEMISTRY
C25,ELECTROLYTIC OR ELECTROPHORETIC PROCESSES; APPARATUS THEREFOR
C30,CRYSTAL GROWTH
C12,BIOCHEMISTRY; BEER; SPIRITS; WINE; VINEGAR; MICROBIOLOGY; ENZYMOLOGY; MUTATION OR GENETIC ENGINEERING
C99,SUBJECT MATTER NOT OTHERWISE PROVIDED FOR IN THIS SECTION
C05,FERTILISERS; MANUFACTURE THEREOF
C40,COMBINATORIAL TECHNOLOGY
C11,"ANIMAL OR VEGETABLE OILS, FATS, FATTY SUBSTANCES OR WAXES; FATTY ACIDS THEREFROM; DETERGENTS; CANDLES"
C08,ORGANIC MACROMOLECULAR COMPOUNDS; THEIR PREPARATION OR CHEMICAL WORKING-UP; COMPOSITIONS BASED THEREON
C10,"PETROLEUM, GAS OR COKE INDUSTRIES; TECHNICAL GASES CONTAINING CARBON MONOXIDE; FUELS; LUBRICANTS; PEAT"
C21,METALLURGY OF IRON
C04,CEMENTS; CONCRETE; ARTIFICIAL STONE; CERAMICS; REFRACTORIES
C09,DYES; PAINTS; POLISHES; NATURAL RESINS; ADHESIVES; COMPOSITIONS NOT OTHERWISE PROVIDED FOR; APPLICATIONS OF MATERIALS NOT OTHERWISE PROVIDED FOR
C03,GLASS; MINERAL OR SLAG WOOL
C13,SUGAR INDUSTRY
C14,SKINS; HIDES; PELTS; LEATHER
C01,INORGANIC CHEMISTRY
D02,YARNS; MECHANICAL FINISHING OF YARNS OR ROPES; WARPING OR BEAMING
D21,PAPER-MAKING; PRODUCTION OF CELLULOSE
D04,BRAIDING; LACE-MAKING; KNITTING; TRIMMINGS; NON-WOVEN F
Query:
SELECT f.value:"publication_number"::STRING AS "cited_publication_number", COUNT(*) AS "citation_count"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."citation") f
   WHERE f.value:"publication_number" IS NOT NULL
   GROUP BY "cited_publication_number"
   ORDER BY "citation_count" DESC
   LIMIT 100;
Answer:
cited_publication_number,citation_count
,230545
US-4816567-A,36
US-4683202-B1,23
US-4683202-A,23
US-5585089-A,21
US-4683195-B1,20
US-4683195-A,20
US-5223409-A,19
US-4733665-B1,18
US-4733665-C2,18
US-5530101-A,18
US-4733665-A,18
US-5892900-A,17
US-5225539-A,17
US-5523520-A,16
US-5624821-A,15
US-6175752-B1,15
US-5693762-A,15
JP-2007123861-A,14
US-5205459-A,14
US-4965188-A,14
US-5545806-A,14
US-7000818-B2,14
US-5565332-A,14
US-4522811-A,12
US-6698020-B1,12
US-4946778-A,12
US-5403312-A,12
US-5724521-A,12
US-6180370-B1,11
US-6177931-B1,11
US-5292053-A,11
US-5850009-A,11
US-5859205-A,11
US-4548202-A,11
US-5304719-A,11
US-7674650-B2,11
US-6988649-B2,11
US-2008258141-A1,11
US-5104025-A,11
US-2007108446-A1,11
US-5569825-A,11
US-2006110867-A1,11
US-5367109-A,11
US-5648260-A,11
US-2006208977-A1,11
US-5084057-A,11
US-6323846-B1,11
US-4399216-A,11
US-5034506-A,11
US-2014263552-A1,11
US-5391250-A,10
US-8393514-B2,10
US-9345481-B2,10
US-2003229900-A1,10
US-2005199959-A1,10
US-6727522-B1,10
US-2006113549-A1,10
US-2001046027-A1,10
US-2008296568-A1,10
US-7732819-B2,10
US-2007194379-A1,10
US-6746582-B2,10
US-2007175955-A1,10
US-5715314-A,10
US-2006113539-A1,10
US-2006108636-A1,10
US-5948061-A,10
US-5593852-A,10
US-7753245-B2,10
US-7422139-B2,10
US-2008258143-A1,10
US-7411209-B2,10
US-5821937-A,10
US-2008106191-A1,10
US-2007052025-A1,10
US-5633425-A,10
US-2007172591-A1,10
US-6120676-A,10
US-5794207-A,10
US-5383880-A,10
US-2006091793-A1,10
US-7845537-B2,10
US-5545807-A,10
US-5754939-A,10
US-5796952-A,10
US-2006244107-A1,10
US-2006238135-A1,10
US-2008182358-A1,9
US-7385224-B2,9
US-2006292777-A1,9
US-2007046191-A1,9
US-5867799-A,9
WO-2013176772-A1,9
US-5960411-A,9
JP-2004103957-A,9
US-5496312-A,9
US-7402506-B2,9
US-5954259-A,9
US-2007187760-A1,9
Query:
SELECT t."publication_number", t."assignee_harmonized", c.value:"code"::STRING AS "cpc_code"
   FROM PATENTS.PATENTS.PUBLICATIONS t,
   LATERAL FLATTEN(input => t."cpc") c
   WHERE t."assignee_harmonized" IS NOT NULL
   LIMIT 100;
Answer:
Too long, hard cut:
publication_number,assignee_harmonized,cpc_code
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A""
  },
  {
    ""country_code"": """",
    ""name"": ""JOHNSON KENNETH U""
  },
  {
    ""country_code"": """",
    ""name"": ""ESCARCEGA ANTHONY J""
  }
]",G01N2030/202
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A""
  },
  {
    ""country_code"": """",
    ""name"": ""JOHNSON KENNETH U""
  },
  {
    ""country_code"": """",
    ""name"": ""ESCARCEGA ANTHONY J""
  }
]",Y10T137/86815
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A""
  },
  {
    ""country_code"": """",
    ""name"": ""JOHNSON KENNETH U""
  },
  {
    ""country_code"": """",
    ""name"": ""ESCARCEGA ANTHONY J""
  }
]",G01N2030/202
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A""
  },
  {
    ""country_code"": """",
    ""name"": ""JOHNSON KENNETH U""
  },
  {
    ""country_code"": """",
    ""name"": ""ESCARCEGA ANTHONY J""
  }
]",G01N30/6047
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A""
  },
  {
    ""country_code"": """",
    ""name"": ""JOHNSON KENNETH U""
  },
  {
    ""country_code"": """",
    ""name"": ""ESCARCEGA ANTHONY J""
  }
]",F16K11/074
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A""
  },
  {
    ""country_code"": """",
    ""name"": ""JOHNSON KENNETH U""
  },
  {
    ""country_code"": """",
    ""name"": ""ESCARCEGA ANTHONY J""
  }
]",G01N30/20
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A""
  },
  {
    ""country_code"": """",
    ""name"": ""JOHNSON KENNETH U""
  },
  {
    ""country_code"": """",
    ""name"": ""ESCARCEGA ANTHONY J""
  }
]",F16K11/074
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A""
  },
  {
    ""country_code"": """",
    ""name"": ""JOHNSON KENNETH U""
  },
  {
    ""country_code"": """",
    ""name"": ""ESCARCEGA ANTHONY J""
  }
]",B01D15/1821
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A""
  },
  {
    ""country_code"": """",
    ""name"": ""JOHNSON KENNETH U""
  },
  {
    ""country_code"": """",
    ""name"": ""ESCARCEGA ANTHONY J""
  }
]",G01N30/20
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A""
  },
  {
    ""country_code"": """",
    ""name"": ""JOHNSON KENNETH U""
  },
  {
    ""country_code"": """",
    ""name"": ""ESCARCEGA ANTHONY J""
  }
]",B01D15/1821
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A""
  },
  {
    ""country_code"": """",
    ""name"": ""JOHNSON KENNETH U""
  },
  {
    ""country_code"": """",
    ""name"": ""ESCARCEGA ANTHONY J""
  }
]",G01N30/6047
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A""
  },
  {
    ""country_code"": """",
    ""name"": ""JOHNSON KENNETH U""
  },
  {
    ""country_code"": """",
    ""name"": ""ESCARCEGA ANTHONY J""
  }
]",G01N2030/201
US-2007068873-A1,"[
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ANIL R""
  },
  {
    ""country_code"": """",
    ""name"": ""PARIKH SAURABH P""
  },
  {
    ""country_code"": """",
    ""name"": ""OROSKAR ASHA A"
Query:
WITH DENSO_PUBS AS (
    SELECT DISTINCT t1."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t1,
         LATERAL FLATTEN(input => t1."assignee_harmonized") assignee1
    WHERE assignee1.value:"name"::STRING LIKE '%DENSO CORP%'
)
SELECT 
    assignee2.value:"name"::STRING AS "Citing_Assignee",
    def."titleFull" AS "CPC_Subclass_Title",
    COUNT(DISTINCT t2."publication_number") AS "Citation_Count"
FROM PATENTS.PATENTS.PUBLICATIONS t2
    JOIN LATERAL FLATTEN(input => t2."citation") c2 ON TRUE
    JOIN DENSO_PUBS dp ON c2.value:"publication_number"::STRING = dp."publication_number"
    JOIN LATERAL FLATTEN(input => t2."assignee_harmonized") assignee2 ON TRUE
    JOIN LATERAL FLATTEN(input => t2."cpc") cpc2 ON TRUE
    JOIN PATENTS.PATENTS.CPC_DEFINITION def ON SUBSTR(cpc2.value:"code"::STRING, 1, 1) = def."symbol"
WHERE assignee2.value:"name"::STRING NOT LIKE '%DENSO CORP%'
GROUP BY "Citing_Assignee", "CPC_Subclass_Title"
ORDER BY "Citation_Count" DESC;
Answer:
000002 (0A000): 01b9f215-0004-7d15-0001-11c300fa2ee2: Unsupported feature 'lateral table function called with OUTER JOIN syntax or a join predicate (ON clause)'.Query:
SELECT 
    assignee2.value:"name"::STRING AS "Citing_Assignee",
    COUNT(DISTINCT t2."publication_number") AS "Citation_Count"
FROM 
    PATENTS.PATENTS.PUBLICATIONS t2,
    LATERAL FLATTEN(input => t2."assignee_harmonized") assignee2,
    LATERAL FLATTEN(input => t2."citation") c2
WHERE 
    c2.value:"publication_number"::STRING IN (
        SELECT DISTINCT t1."publication_number"
        FROM PATENTS.PATENTS.PUBLICATIONS t1,
             LATERAL FLATTEN(input => t1."assignee_harmonized") assignee1
        WHERE assignee1.value:"name"::STRING LIKE '%DENSO CORP%'
    )
    AND assignee2.value:"name"::STRING NOT LIKE '%DENSO CORP%'
GROUP BY 
    "Citing_Assignee"
ORDER BY 
    "Citation_Count" DESC
LIMIT 100;
Answer:
Citing_Assignee,Citation_Count
TOYOTA MOTOR CO LTD,2
MAHLE INT GMBH,2
SAHASHI HIDEO,1
YAZAKI CORP,1
HONDA MOTOR CO LTD,1
KIA MOTORS CORP,1
FUJI ELECTRIC CO LTD,1
SUZUKI HISAO,1
TOYOTA BOSHOKU KK,1
HYUNDAI MOTOR CO LTD,1
Query:
-- Corrected SQL 1
SELECT t."publication_number", SUBSTR(c.value:"code"::STRING, 1, 4) AS "primary_cpc_subclass"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     TABLE(FLATTEN(input => t."cpc")) c
LIMIT 100
Answer:
publication_number,primary_cpc_subclass
US-2022368427-A1,H04B
US-2022368427-A1,H04B
US-2022368427-A1,H04J
US-2022368427-A1,H04B
US-2022368427-A1,H04J
US-2022368427-A1,H04B
US-2022368427-A1,H04J
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022270260-A1,G06F
US-2022270260-A1,G06F
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022270260-A1,G06T
US-2022252052-A1,Y02E
US-2022252052-A1,F05B
US-2022252052-A1,G08B
US-2022252052-A1,F03D
US-2022252052-A1,F03D
US-2022252052-A1,F03D
US-2022252052-A1,F03D
US-2022252052-A1,G08B
US-2022252052-A1,F05B
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022303223-A1,H04L
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2022273257-A1,A61B
US-2024057379-A1,H10K
US-2024057379-A1,H10K
US-2024057379-A1,H10K
US-2024057379-A1,H10K
US-2024057379-A1,H10K
US-2024057379-A1,Y02E
US-2024057379-A1,H10K
US-2024057379-A1,H10K
US-2024057379-A1,H10K
US-2024057379-A1,H10K
US-2024057379-A1,H10K
US-2024057379-A1,H10K
US-2024057379-A1,H10K
US-2022114223-A1,H04L
US-2022114223-A1,G10L
US-2022114223-A1,H04L
US-2022114223-A1,G10L
US-2022114223-A1,H04L
US-2022114223-A1,G06F
US-2022114223-A1,G10L
US-2022114223-A1,G06F
US-2022114223-A1,H04L
US-2022114223-A1,H04L
US-2022114223-A1,G10L
US-2022114223-A1,G10L
US-2022114223-A1,G10L
US-2022114223-A1,G10L
US-2022114223-A1,G06F
US-2022114223-A1,H04L
US-2022114223-A1,H04M
US-2022114223-A1,G10L
US-2022114223-A1,G10L
US-2022114223-A1,G06F
US-2022114223-A1,G10L
US-2022114223-A1,G10L
US-2022114223-A1,G10L
US-2022114223-A1,G10L
US-2022114223-A1,H04L
US-2022114223-A1,G10L
Query:
-- Corrected SQL 2
SELECT c_symbols."symbol", d."titleFull"
FROM PATENTS.PATENTS.CPC_DEFINITION d
JOIN (
  SELECT DISTINCT SUBSTR(c.value:"code"::STRING, 1, 4) AS "symbol"
  FROM PATENTS.PATENTS.PUBLICATIONS t,
       TABLE(FLATTEN(input => t."cpc")) c
  LIMIT 100
) AS c_symbols
ON c_symbols."symbol" = d."symbol"
LIMIT 100
Answer:
Too long, hard cut:
symbol,titleFull
A01C,PLANTING; SOWING; FERTILISING
A21C,MACHINES OR EQUIPMENT FOR MAKING OR PROCESSING DOUGHS; HANDLING BAKED ARTICLES MADE FROM DOUGH
A21B,BAKERS' OVENS; MACHINES OR EQUIPMENT FOR BAKING
A23J,PROTEIN COMPOSITIONS FOR FOODSTUFFS; WORKING-UP PROTEINS FOR FOODSTUFFS; PHOSPHATIDE COMPOSITIONS FOR FOODSTUFFS
A23L,"FOODS, FOODSTUFFS, OR NON-ALCOHOLIC BEVERAGES, NOT COVERED BY SUBCLASSES A21D OR A23B-A23J; THEIR PREPARATION OR TREATMENT, e.g. COOKING, MODIFICATION OF NUTRITIVE QUALITIES, PHYSICAL TREATMENT; PRESERVATION OF FOODS OR FOODSTUFFS, IN GENERAL"
A23N,"MACHINES OR APPARATUS FOR TREATING HARVESTED FRUIT, VEGETABLES OR FLOWER BULBS IN BULK, NOT OTHERWISE PROVIDED FOR; PEELING VEGETABLES OR FRUIT IN BULK; APPARATUS FOR PREPARING ANIMAL FEEDING- STUFFS"
A41B,SHIRTS; UNDERWEAR; BABY LINEN; HANDKERCHIEFS
A43B,CHARACTERISTIC FEATURES OF FOOTWEAR; PARTS OF FOOTWEAR
A43C,FASTENINGS OR ATTACHMENTS OF FOOTWEAR; LACES IN GENERAL
A43D,"MACHINES, TOOLS, EQUIPMENT OR METHODS FOR MANUFACTURING OR REPAIRING FOOTWEAR"
A44C,"PERSONAL ADORNMENTS, e.g. JEWELLERY; COINS"
A46D,MANUFACTURE OF BRUSHES
A61J,CONTAINERS SPECIALLY ADAPTED FOR MEDICAL OR PHARMACEUTICAL PURPOSES; DEVICES OR METHODS SPECIALLY ADAPTED FOR BRINGING PHARMACEUTICAL PRODUCTS INTO PARTICULAR PHYSICAL OR ADMINISTERING FORMS; DEVICES FOR ADMINISTERING FOOD OR MEDICINES ORALLY; BABY COMFORTERS; DEVICES FOR RECEIVING SPITTLE
A61G,"TRANSPORT, PERSONAL CONVEYANCES, OR ACCOMMODATION SPECIALLY ADAPTED FOR PATIENTS OR DISABLED PERSONS; OPERATING TABLES OR CHAIRS; CHAIRS FOR DENTISTRY; FUNERAL DEVICES"
A63C,"SKATES; SKIS; ROLLER SKATES; DESIGN OR LAYOUT OF COURTS, RINKS OR THE LIKE"
B01D,SEPARATION
B02B,PREPARING GRAIN FOR MILLING; REFINING GRANULAR FRUIT TO COMMERCIAL PRODUCTS BY WORKING THE SURFACE
B04C,"APPARATUS USING FREE VORTEX FLOW, e.g. CYCLONES"
B09B,DISPOSAL OF SOLID WASTE NOT OTHERWISE PROVIDED FOR
B29B,PREPARATION OR PRETREATMENT OF THE MATERIAL TO BE SHAPED; MAKING GRANULES OR PREFORMS; RECOVERY OF PLASTICS OR OTHER CONSTITUENTS OF WASTE MATERIAL CONTAINING PLASTICS
B29L,"INDEXING SCHEME ASSOCIATED WITH SUBCLASS B29C, RELATING TO PARTICULAR ARTICLES"
B31B,"MAKING CONTAINERS OF PAPER, CARDBOARD OR MATERIAL WORKED IN A MANNER ANALOGOUS TO PAPER"
B42B,"PERMANENTLY ATTACHING TOGETHER SHEETS, QUIRES OR SIGNATURES OR PERMANENTLY ATTACHING OBJECTS THERETO"
B42D,BOOKS; BOOK COVERS; LOOSE LEAVES; PRINTED MATTER CHARACTERISED BY IDENTIFICATION OR SECURITY FEATURES; PRINTED MATTER OF SPECIAL FORMAT OR STYLE NOT OTHERWISE PROVIDED FOR; DEVICES FOR USE THEREWITH AND NOT OTHERWISE PROVIDED FOR; MOVABLE-STRIP WRITING OR READING APPARATUS
B44D,"PAINTING OR ARTISTIC DRAWING, NOT OTHERWISE PROVIDED FOR; PRESERVING PAINTINGS; SURFACE TREATMENT TO OBTAIN SPECIAL ARTISTIC SURFACE EFFECTS OR FINISHES"
B60D,VEHICLE CONNECTIONS
B60M,"POWER SUPPLY LINES, AND DEVICES ALONG RAILS, FOR ELECTRICALLY- PROPELLED VEHICLES"
B62K,"CYCLES; CYCLE FRAMES; CYCLE STEERING DEVICES; RIDER-OPERATED TERMINAL CONTROLS SPECIALLY ADAPTED FOR CYCLES; CYCLE AXLE SUSPENSIONS; CYCLE SIDE-CARS, FORECARS, OR THE LIKE"
B64U,UNMANNED AERIAL VEHICLES [UAV]; EQUIPMENT THEREFOR
B66C,"CRANES; LOAD-ENGAGING ELEMENTS OR DEVICES FOR CRANES, CAPSTANS, WINCHES, OR TACKLES"
B67D,"DISPENSING, DELIVERING OR TRANSFERRING LIQUIDS, NOT OTHERWISE PROVIDED FOR"
B81B,"MICROSTRUCTURAL DEVICES OR SYSTEMS, e.g. MICROMECHANICAL DEVICES"
C01B,NON-METALLIC ELEMENTS; COMPOUNDS THEREOF; METALLOIDS OR COMPOUNDS THEREOF NOT COVERED BY SUBCLASS C01C
C01F,"COMPOUNDS OF THE METALS BERYLLIUM, MAGNESIUM, ALUMINIUM, CALCIUM, STRONTIUM, BARIUM, RADIUM, THORIUM, OR OF THE RARE-EARTH METALS"
C08G,MACROMOLECULAR COMPOUNDS OBTAINED OTHERWISE THAN BY REACTIONS ONLY INVOLVING UNSATURATED CARBON-TO-CARBON BONDS
C09H,PREPARATION OF GLUE OR GELATINE
C09C,"TREATMENT OF INORGANIC MATERIALS, OTHER THAN FIBROUS FILLERS, TO ENHANCE THEIR PIGMENTING OR FILLING PROPERTIES; PREPARATION OF CARBON BLACK ; PREPARATION OF INORGANIC MATERIALS WHICH ARE NO SINGLE CHEMICAL COMPOUNDS AND WHICH ARE MAINLY USED AS PIGMENTS OR FILLERS"
C10M,LUBRICATING COMPOSITIONS; USE OF CHEMICAL SUBSTANCES EITHER ALONE OR AS LUBRICATING INGREDIENTS IN A LUBRICATING COMPOSITION
C10G,"CRACKING HYDROCARBON OILS; PRODUCTION OF LIQUID HYDROCARBON MIXTURES, e.g. BY DESTRUCTIVE HYDROGENATION, OLIGOMERISATION, POLYMERISATION; RECOVERY OF HYDROCARBON OILS FROM OIL-SHALE, OIL-SAND, OR GASES; REFINING MIXTURES MAINLY CONSISTING OF HYDROCARBONS; REFORMING OF NAPHTHA; MINERAL WAXES"
C10J,"PRODUCTION OF PRODUCER GAS, WATER-GAS, SYNTHESIS GAS FROM SOLID CARBONACEOUS MATERIAL, OR MIXTURES CONTAINING THESE GASES; CARBURETTING AIR OR OTHER GASES"
C11C,"FATTY ACIDS FROM FATS, OILS OR WAXES; CANDLES; FATS, OILS OR FATTY ACIDS BY CHEMICAL MODIFICATION OF FATS, OILS, OR FATTY ACIDS OBTAINED THEREFROM"
C12M,"APPARATUS FOR ENZYMOLOGY OR MICROBIOLOGY; APPARATUS FOR CULTURING MICROORGANISMS FOR PRODUCING BIOMASS, FOR GROWING CELLS OR FOR OBTAINING FERMENTATION OR METABOLIC PRODUCTS, i.e. BI
Query:
-- Corrected SQL 3
SELECT t."publication_number", t."assignee_harmonized", d."titleFull" AS "cpc_title"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     TABLE(FLATTEN(input => t."cpc")) c,
     PATENTS.PATENTS.CPC_DEFINITION d
WHERE c.value:"code"::STRING = d."symbol"
  AND t."assignee_harmonized" IS NOT NULL
LIMIT 100
Answer:
Too long, hard cut:
publication_number,assignee_harmonized,cpc_title
US-2020311356-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""MEPS REAL TIME INC""
  }
]","Methods or arrangements for sensing record carriers, e.g. for reading patterns by electromagnetic radiation, e.g. optical sensing; by corpuscular radiation sensing by radiation using wavelengths larger than 0.1 mm, e.g. radio-waves or microwaves methods and means used by the interrogation device for reliably powering the wireless record carriers using an electromagnetic interrogation field including auxiliary means for focusing, repeating or boosting the electromagnetic interrogation field"
US-2020311356-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""MEPS REAL TIME INC""
  }
]","Methods or arrangements for sensing record carriers, e.g. for reading patterns by electromagnetic radiation, e.g. optical sensing; by corpuscular radiation sensing by radiation using wavelengths larger than 0.1 mm, e.g. radio-waves or microwaves methods and means used by the interrogation device for reliably powering the wireless record carriers using an electromagnetic interrogation field including auxiliary means for focusing, repeating or boosting the electromagnetic interrogation field"
US-2020311356-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""MEPS REAL TIME INC""
  }
]","Methods or arrangements for sensing record carriers, e.g. for reading patterns by electromagnetic radiation, e.g. optical sensing; by corpuscular radiation sensing by radiation using wavelengths larger than 0.1 mm, e.g. radio-waves or microwaves methods and means used by the interrogation device for reliably powering the wireless record carriers using an electromagnetic interrogation field including auxiliary means for focusing, repeating or boosting the electromagnetic interrogation field"
US-10949711-B2,"[
  {
    ""country_code"": ""US"",
    ""name"": ""INTEL CORP""
  }
]","Processor architectures; Processor configuration, e.g. pipelining"
US-10949711-B2,"[
  {
    ""country_code"": ""US"",
    ""name"": ""INTEL CORP""
  }
]","Processor architectures; Processor configuration, e.g. pipelining"
US-89397-A,[],Slabs; Blocks; Pot sleepers; Fastening tie-rods to them
FR-1443904-A,"[
  {
    ""country_code"": """",
    ""name"": ""CALOR APP ELECTRO DOMESTIQUES""
  }
]",Independent devices characterised by heating the hair-curling or hair-waving means before use
FR-1443904-A,"[
  {
    ""country_code"": """",
    ""name"": ""CALOR APP ELECTRO DOMESTIQUES""
  }
]","Hair curlers or hair winders with incorporated heating or drying means, e.g. electric, using chemical reaction"
US-10220314-B2,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""IKEDA AKIO""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""KOBE NAOTO""
  },
  {
    ""country_code"": ""JP"",
    ""name"": ""NINTENDO CO LTD""
  }
]","Input arrangements for video game devices characterised by their sensors, purposes or types comprising photodetecting means, e.g. cameras, photodiodes or infrared cells"
US-2020401305-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""ROVI GUIDES INC""
  }
]","Interaction techniques based on graphical user interfaces [GUI] using specific features provided by the input device, e.g. functions controlled by the rotation of a mouse with dual sensing arrangements, or of the nature of the input device, e.g. tap gestures based on pressure sensed by a digitiser using a touch-screen or digitiser, e.g. input of commands through traced gestures for inputting data by handwriting, e.g. gesture or text"
US-2020401305-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""ROVI GUIDES INC""
  }
]","Interaction techniques based on graphical user interfaces [GUI] using specific features provided by the input device, e.g. functions controlled by the rotation of a mouse with dual sensing arrangements, or of the nature of the input device, e.g. tap gestures based on pressure sensed by a digitiser using a touch-screen or digitiser, e.g. input of commands through traced gestures for inputting data by handwriting, e.g. gesture or text"
US-2020401305-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""ROVI GUIDES INC""
  }
]","Interaction techniques based on graphical user interfaces [GUI] using specific features provided by the input device, e.g. functions controlled by the rotation of a mouse with dual sensing arrangements, or of the nature of the input device, e.g. tap gestures based on pressure sensed by a digitiser using a touch-screen or digitiser, e.g. input of commands through traced gestures for inputting data by handwriting, e.g. gesture or text"
US-10949711-B2,"[
  {
    ""country_code"": ""US"",
    ""name"": ""INTEL CORP""
  }
]","Selection of the most significant subset of features by evaluating different subsets according to an optimisation criterion, e.g. class separability, forward selection or backward elimination"
US-10949711-B2,"[
  {
    ""country_code"": ""US"",
    ""name"": ""INTEL CORP""
  }
]"
Query:
-- Corrected SQL 4
SELECT DISTINCT f.value:"publication_number"::STRING AS "cited_publication_number", p."assignee_harmonized" AS "cited_assignee"
FROM PATENTS.PATENTS.PUBLICATIONS t,
     TABLE(FLATTEN(input => t."citation")) f,
     PATENTS.PATENTS.PUBLICATIONS p
WHERE f.value:"publication_number"::STRING = p."publication_number"
  AND p."assignee_harmonized" IS NOT NULL
LIMIT 100
Answer:
Too long, hard cut:
cited_publication_number,cited_assignee
JP-2006291469-A,"[
  {
    ""country_code"": """",
    ""name"": ""KUROSAWA KENSETSU KK""
  }
]"
JP-2007193854-A,"[
  {
    ""country_code"": """",
    ""name"": ""TOSHIBA CORP""
  }
]"
CN-101613346-A,"[
  {
    ""country_code"": """",
    ""name"": ""UNIV DALI""
  }
]"
US-9274095-B2,"[
  {
    ""country_code"": ""US"",
    ""name"": ""UNIV SOUTHERN CALIFORNIA""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""DOHENY EYE INST""
  }
]"
JP-2012157476-A,"[
  {
    ""country_code"": """",
    ""name"": ""KAO CORP""
  }
]"
CN-104038880-A,"[
  {
    ""country_code"": """",
    ""name"": ""NANJING INST TECHNOLOGY""
  }
]"
CN-113638676-A,"[
  {
    ""country_code"": """",
    ""name"": ""SOUTHEAST UNIV SHENZHEN INSTITUTE""
  }
]"
US-3925910-A,"[
  {
    ""country_code"": """",
    ""name"": ""OLYMPUS OPTICAL CO""
  }
]"
JP-H11263147-A,"[
  {
    ""country_code"": """",
    ""name"": ""SUZUKI MOTOR CO""
  }
]"
CN-104088166-A,"[
  {
    ""country_code"": """",
    ""name"": ""SHANGHAI ANOKY TEXTILE CHEMICALS CO LTD""
  }
]"
CN-102669328-A,"[
  {
    ""country_code"": """",
    ""name"": ""ANHUI LOVE ON YOUR FOOD CO LTD""
  }
]"
CN-111347106-A,"[
  {
    ""country_code"": """",
    ""name"": ""ANHUI PHETOM INTELLIGENT TRAFFIC TECH CO LTD""
  }
]"
CN-210893210-U,"[
  {
    ""country_code"": """",
    ""name"": ""SHENZHEN ZHONGWU XINGHUA TECH DEVELOPMENT CO LTD""
  }
]"
US-2002136428-A1,[]
CN-102698580-A,"[
  {
    ""country_code"": """",
    ""name"": ""SHANGHAI FUZHEN TECHNOLOGY CO LTD""
  }
]"
US-8807431-B2,"[
  {
    ""country_code"": ""US"",
    ""name"": ""HAND HELD PROD INC""
  }
]"
US-5410993-A,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""YAMAHA MOTOR CO LTD""
  }
]"
US-5425546-A,[]
US-3821630-A,"[
  {
    ""country_code"": """",
    ""name"": ""GEN ELECTRIC""
  }
]"
JP-S5392717-A,"[
  {
    ""country_code"": """",
    ""name"": ""BRITISH PETROLEUM CO""
  }
]"
JP-H09222148-A,"[
  {
    ""country_code"": """",
    ""name"": ""NOK MEGULASTIK CO LTD""
  }
]"
JP-H03245910-A,"[
  {
    ""country_code"": """",
    ""name"": ""OPTON KK""
  }
]"
US-2291161-A,"[
  {
    ""country_code"": """",
    ""name"": ""MORRIS KATCHER""
  }
]"
US-2009245322-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""MASSACHUSETTS INST TECHNOLOGY""
  },
  {
    ""country_code"": ""US"",
    ""name"": ""MOUNT HOLYOKE COLLEGE""
  }
]"
CN-209777651-U,"[
  {
    ""country_code"": """",
    ""name"": ""YANTAI JIATONG IND AUTOMATION CO LTD""
  }
]"
US-2002173144-A1,[]
US-6611248-B2,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""CASIO COMPUTER CO LTD""
  }
]"
US-5556357-A,[]
CN-101638749-A,"[
  {
    ""country_code"": """",
    ""name"": ""CENTRAL IRON & STEEL RES INST""
  }
]"
JP-H07252228-A,"[
  {
    ""country_code"": """",
    ""name"": ""FUJISAWA PHARMACEUTICAL CO""
  }
]"
US-2018366105-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""APPLE INC""
  }
]"
US-4095066-A,"[
  {
    ""country_code"": """",
    ""name"": ""IBM""
  }
]"
US-2005227703-A1,"[
  {
    ""country_code"": """",
    ""name"": ""CHENG STEVEN D""
  }
]"
DE-102006051376-A1,"[
  {
    ""country_code"": ""DE"",
    ""name"": ""ESKA FLOWFORM GMBH""
  }
]"
US-5396129-A,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""MATSUSHITA ELECTRONICS CORP""
  }
]"
US-2009285279-A1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""ATHEROS COMM INC""
  }
]"
US-6419729-B1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""3M INNOVATIVE PROPERTIES CO""
  }
]"
JP-H06210640-A,"[
  {
    ""country_code"": """",
    ""name"": ""AIRTECH INT INC""
  }
]"
KR-101758189-B1,"[
  {
    ""country_code"": ""KR"",
    ""name"": ""MOTORTRONICS INT'L KOREA CO LTD""
  }
]"
US-10275331-B1,"[
  {
    ""country_code"": ""US"",
    ""name"": ""CAPITAL ONE SERVICES LLC""
  }
]"
US-2008307155-A1,"[
  {
    ""country_code"": """",
    ""name"": ""SINCLAIR ALAN W""
  }
]"
JP-H0459752-A,"[
  {
    ""country_code"": """",
    ""name"": ""SHOWA DENKO KK""
  }
]"
CN-103306799-A,"[
  {
    ""country_code"": """",
    ""name"": ""GREAT WALL MOTOR CO LTD""
  }
]"
CN-105631498-A,"[
  {
    ""country_code"": """",
    ""name"": ""GUANGXI ZHUANG AUTONOMOUS REGION INST OF METROLOGY & TEST""
  }
]"
CN-103295149-A,"[
  {
    ""country_code"": """",
    ""name"": ""MU SIGMA BUSINESS SOLUTIONS PVT LTD""
  }
]"
US-5523667-A,[]
US-4830006-A,"[
  {
    ""country_code"": ""US"",
    ""name"": ""INTERMEDICS INC""
  }
]"
JP-2008127472-A,"[
  {
    ""country_code"": """",
    ""name"": ""NIPPON STEEL CORP""
  }
]"
CN-105294667-A,"[
  {
    ""country_code"": """",
    ""name"": ""SHANGHAI INSITITUTE OF ORGANIC CHEMISTRY CHINESE ACADEMY OF SCIENCES""
  }
]"
US-4452846-A,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""FUJI PHOTO FILM CO LTD""
  }
]"
JP-H0855343-A,"[
  {
    ""country_code"": """",
    ""name"": ""MATSUSHITA ELECTRIC IND CO LTD""
  }
]"
US-2011055074-A1,"[
  {
    ""country_code"": """",
    ""name"": ""CHEN YONGHUI""
  },
  {
    ""country_code"
End Exploring Related Columns
Task: Which assignees, excluding DENSO CORP itself, have cited patents assigned to DENSO CORP, and what are the titles of the primary CPC subclasses associated with these citations? Provide the name of each citing assignee, the full title of the CPC subclass, and the count of citations grouped by the assignee and the CPC subclass title. Please focus specifically on the main categories of the CPC codes,

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Assignee,CPC_Subclass_Title,Citation_Count
assignee1:str,cpc_subclass_title1:str,count1:int
assignee2:str,cpc_subclass_title2:str,count2:int
...
```

**Explanation:**

To address this task, we first identify all patents assigned to **DENSO CORP** from the `PUBLICATIONS` table by filtering the `assignee_harmonized` field. Next, we find all patents that cite these DENSO CORP patents by examining the `citation` field in the same table, excluding any citations originating from DENSO CORP itself. For each citing patent, we retrieve the assignee's name and the primary CPC subclass code from the `cpc` field. We then join this CPC code with the `CPC_DEFINITION` table to obtain the full title of the CPC subclass. Finally, we group the results by the assignee and the CPC subclass title, counting the number of citations in each group. The focus on the main categories of the CPC codes ensures that we consider the primary technological areas relevant to the cited patents..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-25 10:31:55 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:31:55 - root - INFO - ```sql
WITH DENSO_PUBS AS (
    SELECT DISTINCT t1."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t1,
         LATERAL FLATTEN(input => t1."assignee_harmonized") assignee
    WHERE assignee.value:"name"::STRING = 'DENSO CORP'
),
CITING_PUBS AS (
    SELECT DISTINCT t2."publication_number" AS citing_publication_number
    FROM PATENTS.PATENTS.PUBLICATIONS t2,
         LATERAL FLATTEN(input => t2."citation") c2
    WHERE c2.value:"publication_number"::STRING IN (SELECT "publication_number" FROM DENSO_PUBS)
),
CITING_PUBS_WITH_ASSIGNEE AS (
    SELECT DISTINCT cp.citing_publication_number, assignee.value:"name"::STRING AS assignee_name
    FROM CITING_PUBS cp
    JOIN PATENTS.PATENTS.PUBLICATIONS t2 ON t2."publication_number" = cp.citing_publication_number
    , LATERAL FLATTEN(input => t2."assignee_harmonized") assignee
    WHERE assignee.value:"name"::STRING != 'DENSO CORP'
),
CITING_PUBS_WITH_CPC AS (
    SELECT cpwa.citing_publication_number, cpwa.assignee_name, SUBSTR(cpc.value:"code"::STRING,1,4) AS cpc_subclass
    FROM CITING_PUBS_WITH_ASSIGNEE cpwa
    JOIN PATENTS.PATENTS.PUBLICATIONS t2 ON t2."publication_number" = cpwa.citing_publication_number
    , LATERAL FLATTEN(input => t2."cpc") cpc
)
SELECT cpwc.assignee_name AS Assignee, def."titleFull" AS CPC_Subclass_Title, COUNT(DISTINCT cpwc.citing_publication_number) AS Citation_Count
FROM CITING_PUBS_WITH_CPC cpwc
JOIN PATENTS.PATENTS.CPC_DEFINITION def ON cpwc.cpc_subclass = def."symbol"
GROUP BY cpwc.assignee_name, def."titleFull"
ORDER BY Citation_Count DESC;
```
2025-01-25 10:31:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:31:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:31:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:31:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 29
2025-01-25 10:31:57 - snowflake.connector.connection - INFO - closed
2025-01-25 10:31:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:31:58 - root - INFO - itercount: 1
2025-01-25 10:31:58 - root - INFO - 0
2025-01-25 10:31:58 - root - INFO - results: 
ASSIGNEE,CPC_SUBCLASS_TITLE,CITATION_COUNT
MAHLE INT GMBH,"PREHEATING, OR ACCUMULATING PREHEATED, FEED-WATER FOR STEAM GENERATION; FEED-WATER SUPPLY FOR STEAM GENERATION; CONTROLLING WATER LEVEL FOR STEAM GENERATION; AUXILIARY DEVICES FOR PROMOTING WATER CIRCULATION WITHIN STEAM BOILERS",1
MAHLE INT GMBH,"ARRANGEMENTS OF HEATING, COOLING, VENTILATING OR OTHER AIR-TREATING DEVICES SPECIALLY ADAPTED FOR PASSENGER OR GOODS SPACES OF VEHICLES",1
SUZUKI HISAO,SUPPLYING COMBUSTION ENGINES IN GENERAL WITH COMBUSTIBLE MIXTURES OR CONSTITUENTS THEREOF,1
FUJI ELECTRIC CO LTD,PRINTED CIRCUITS; CASINGS OR CONSTRUCTIONAL DETAILS OF ELECTRIC APPARATUS; MANUFACTURE OF ASSEMBLAGES OF ELECTRICAL COMPONENTS,1
HONDA MOTOR CO LTD,"VEHICLES, VEHICLE FITTINGS, OR VEHICLE PARTS, NOT OTHERWISE PROVIDED FOR",1
FUJI ELECTRIC CO LTD,EMERGENCY PROTECTIVE CIRCUIT ARRANGEMENTS,1
TOYOTA MOTOR CO LTD,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,1
FUJI ELECTRIC CO LTD,ELECTRIC DIGITAL DATA PROCESSING,1
HONDA MOTOR CO LTD,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,1
SAHASHI HIDEO,SEATS SPECIALLY ADAPTED FOR VEHICLES; VEHICLE PASSENGER ACCOMMODATION NOT OTHERWISE PROVIDED FOR,1
HONDA MOTOR CO LTD,"SYSTEMS INTEGRATING TECHNOLOGIES RELATED TO POWER NETWORK OPERATION, COMMUNICATION OR INFORMATION TECHNOLOGIES FOR IMPROVING THE ELECTRICAL POWER GENERATION, TRANSMISSION, DISTRIBUTION, MANAGEMENT OR USAGE, i.e. SMART GRIDS",1
KIA MOTORS CORP,"ELECTRIC HEATING; ELECTRIC LIGHT SOURCES NOT OTHERWISE PROVIDED FOR; CIRCUIT ARRANGEMENTS FOR ELECTRIC LIGHT SOURCES, IN GENERAL",1
TOYOTA BOSHOKU KK,SEATS SPECIALLY ADAPTED FOR VEHICLES; VEHICLE PASSENGER ACCOMMODATION NOT OTHERWISE PROVIDED FOR,1
YAZAKI CORP,"ARRANGEMENT OR MOUNTING OF PROPULSION UNITS OR OF TRANSMISSIONS IN VEHICLES; ARRANGEMENT OR MOUNTING OF PLURAL DIVERSE PRIME-MOVERS IN VEHICLES; AUXILIARY DRIVES FOR VEHICLES; INSTRUMENTATION OR DASHBOARDS FOR VEHICLES; ARRANGEMENTS IN CONNECTION WITH COOLING, AIR INTAKE, GAS EXHAUST OR FUEL SUPPLY OF PROPULSION UNITS IN VEHICLES",1
HYUNDAI MOTOR CO LTD,"DOMESTIC- OR SPACE-HEATING SYSTEMS, e.g. CENTRAL HEATING SYSTEMS; DOMESTIC HOT-WATER SUPPLY SYSTEMS; ELEMENTS OR COMPONENTS THEREFOR",1
HYUNDAI MOTOR CO LTD,"FLUID HEATERS, e.g. WATER OR AIR HEATERS, HAVING HEAT-GENERATING MEANS, e.g. HEAT PUMPS, IN GENERAL",1
YAZAKI CORP,"ARRANGEMENT OF SIGNALLING OR LIGHTING DEVICES, THE MOUNTING OR SUPPORTING THEREOF OR CIRCUITS THEREFOR, FOR VEHICLES IN GENERAL",1
KIA MOTORS CORP,"FLUID HEATERS, e.g. WATER OR AIR HEATERS, HAVING HEAT-GENERATING MEANS, e.g. HEAT PUMPS, IN GENERAL",1
HYUNDAI MOTOR CO LTD,"ELECTRIC HEATING; ELECTRIC LIGHT SOURCES NOT OTHERWISE PROVIDED FOR; CIRCUIT ARRANGEMENTS FOR ELECTRIC LIGHT SOURCES, IN GENERAL",1
MAHLE INT GMBH,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,1
HONDA MOTOR CO LTD,CIRCUIT ARRANGEMENTS OR SYSTEMS FOR SUPPLYING OR DISTRIBUTING ELECTRIC POWER; SYSTEMS FOR STORING ELECTRIC ENERGY,1
TOYOTA MOTOR CO LTD,"IGNITION, OTHER THAN COMPRESSION IGNITION, FOR INTERNAL-COMBUSTION ENGINES; TESTING OF IGNITION TIMING IN COMPRESSION-IGNITION ENGINES",1
MAHLE INT GMBH,STEAM ENGINE PLANTS; STEAM ACCUMULATORS; ENGINE PLANTS NOT OTHERWISE PROVIDED FOR; ENGINES USING SPECIAL WORKING FLUIDS OR CYCLES,1
MAHLE INT GMBH,"ELECTRIC HEATING; ELECTRIC LIGHT SOURCES NOT OTHERWISE PROVIDED FOR; CIRCUIT ARRANGEMENTS FOR ELECTRIC LIGHT SOURCES, IN GENERAL",1
HONDA MOTOR CO LTD,PROPULSION OF ELECTRICALLY-PROPELLED VEHICLES; SUPPLYING ELECTRIC POWER FOR AUXILIARY EQUIPMENT OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRODYNAMIC BRAKE SYSTEMS FOR VEHICLES IN GENERAL; MAGNETIC SUSPENSION OR LEVITATION FOR VEHICLES; MONITORING OPERATING VARIABLES OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRIC SAFETY DEVICES FOR ELECTRICALLY-PROPELLED VEHICLES,1
TOYOTA MOTOR CO LTD,SUPPLYING COMBUSTION ENGINES IN GENERAL WITH COMBUSTIBLE MIXTURES OR CONSTITUENTS THEREOF,1
KIA MOTORS CORP,"DOMESTIC- OR SPACE-HEATING SYSTEMS, e.g. CENTRAL HEATING SYSTEMS; DOMESTIC HOT-WATER SUPPLY SYSTEMS; ELEMENTS OR COMPONENTS THEREFOR",1
MAHLE INT GMBH,"FLUID HEATERS, e.g. WATER OR AIR HEATERS, HAVING HEAT-GENERATING MEANS, e.g. HEAT PUMPS, IN GENERAL",1
MAHLE INT GMBH,HOT GAS OR COMBUSTION-PRODUCT POSITIVE-DISPLACEMENT ENGINE PLANTS; USE OF WASTE HEAT OF COMBUSTION ENGINES; NOT OTHERWISE PROVIDED FOR,1


2025-01-25 10:31:58 - root - INFO - Please check the answer again by reviewing Which assignees, excluding DENSO CORP itself, have cited patents assigned to DENSO CORP, and what are the titles of the primary CPC subclasses associated with these citations? Provide the name of each citing assignee, the full title of the CPC subclass, and the count of citations grouped by the assignee and the CPC subclass title. Please focus specifically on the main categories of the CPC codes,, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Assignee,CPC_Subclass_Title,Citation_Count
assignee1:str,cpc_subclass_title1:str,count1:int
assignee2:str,cpc_subclass_title2:str,count2:int
...
```

**Explanation:**

To address this task, we first identify all patents assigned to **DENSO CORP** from the `PUBLICATIONS` table by filtering the `assignee_harmonized` field. Next, we find all patents that cite these DENSO CORP patents by examining the `citation` field in the same table, excluding any citations originating from DENSO CORP itself. For each citing patent, we retrieve the assignee's name and the primary CPC subclass code from the `cpc` field. We then join this CPC code with the `CPC_DEFINITION` table to obtain the full title of the CPC subclass. Finally, we group the results by the assignee and the CPC subclass title, counting the number of citations in each group. The focus on the main categories of the CPC codes ensures that we consider the primary technological areas relevant to the cited patents. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
ASSIGNEE,CPC_SUBCLASS_TITLE,CITATION_COUNT
MAHLE INT GMBH,"PREHEATING, OR ACCUMULATING PREHEATED, FEED-WATER FOR STEAM GENERATION; FEED-WATER SUPPLY FOR STEAM GENERATION; CONTROLLING WATER LEVEL FOR STEAM GENERATION; AUXILIARY DEVICES FOR PROMOTING WATER CIRCULATION WITHIN STEAM BOILERS",1
MAHLE INT GMBH,"ARRANGEMENTS OF HEATING, COOLING, VENTILATING OR OTHER AIR-TREATING DEVICES SPECIALLY ADAPTED FOR PASSENGER OR GOODS SPACES OF VEHICLES",1
SUZUKI HISAO,SUPPLYING COMBUSTION ENGINES IN GENERAL WITH COMBUSTIBLE MIXTURES OR CONSTITUENTS THEREOF,1
FUJI ELECTRIC CO LTD,PRINTED CIRCUITS; CASINGS OR CONSTRUCTIONAL DETAILS OF ELECTRIC APPARATUS; MANUFACTURE OF ASSEMBLAGES OF ELECTRICAL COMPONENTS,1
HONDA MOTOR CO LTD,"VEHICLES, VEHICLE FITTINGS, OR VEHICLE PARTS, NOT OTHERWISE PROVIDED FOR",1
FUJI ELECTRIC CO LTD,EMERGENCY PROTECTIVE CIRCUIT ARRANGEMENTS,1
TOYOTA MOTOR CO LTD,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,1
FUJI ELECTRIC CO LTD,ELECTRIC DIGITAL DATA PROCESSING,1
HONDA MOTOR CO LTD,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,1
SAHASHI HIDEO,SEATS SPECIALLY ADAPTED FOR VEHICLES; VEHICLE PASSENGER ACCOMMODATION NOT OTHERWISE PROVIDED FOR,1
HONDA MOTOR CO LTD,"SYSTEMS INTEGRATING TECHNOLOGIES RELATED TO POWER NETWORK OPERATION, COMMUNICATION OR INFORMATION TECHNOLOGIES FOR IMPROVING THE ELECTRICAL POWER GENERATION, TRANSMISSION, DISTRIBUTION, MANAGEMENT OR USAGE, i.e. SMART GRIDS",1
KIA MOTORS CORP,"ELECTRIC HEATING; ELECTRIC LIGHT SOURCES NOT OTHERWISE PROVIDED FOR; CIRCUIT ARRANGEMENTS FOR ELECTRIC LIGHT SOURCES, IN GENERAL",1
TOYOTA BOSHOKU KK,SEATS SPECIALLY ADAPTED FOR VEHICLES; VEHICLE PASSENGER ACCOMMODATION NOT OTHERWISE PROVIDED FOR,1
YAZAKI CORP,"ARRANGEMENT OR MOUNTING OF PROPULSION UNITS OR OF TRANSMISSIONS IN VEHICLES; ARRANGEMENT OR MOUNTING OF PLURAL DIVERSE PRIME-MOVERS IN VEHICLES; AUXILIARY DRIVES FOR VEHICLES; INSTRUMENTATION OR DASHBOARDS FOR VEHICLES; ARRANGEMENTS IN CONNECTION WITH COOLING, AIR INTAKE, GAS EXHAUST OR FUEL SUPPLY OF PROPULSION UNITS IN VEHICLES",1
HYUNDAI MOTOR CO LTD,"DOMESTIC- OR SPACE-HEATING SYSTEMS, e.g. CENTRAL HEATING SYSTEMS; DOMESTIC HOT-WATER SUPPLY SYSTEMS; ELEMENTS OR COMPONENTS THEREFOR",1
HYUNDAI MOTOR CO LTD,"FLUID HEATERS, e.g. WATER OR AIR HEATERS, HAVING HEAT-GENERATING MEANS, e.g. HEAT PUMPS, IN GENERAL",1
YAZAKI CORP,"ARRANGEMENT OF SIGNALLING OR LIGHTING DEVICES, THE MOUNTING OR SUPPORTING THEREOF OR CIRCUITS THEREFOR, FOR VEHICLES IN GENERAL",1
KIA MOTORS CORP,"FLUID HEATERS, e.g. WATER OR AIR HEATERS, HAVING HEAT-GENERATING MEANS, e.g. HEAT PUMPS, IN GENERAL",1
HYUNDAI MOTOR CO LTD,"ELECTRIC HEATING; ELECTRIC LIGHT SOURCES NOT OTHERWISE PROVIDED FOR; CIRCUIT ARRANGEMENTS FOR ELECTRIC LIGHT SOURCES, IN GENERAL",1
MAHLE INT GMBH,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,1
HONDA MOTOR CO LTD,CIRCUIT ARRANGEMENTS OR SYSTEMS FOR SUPPLYING OR DISTRIBUTING ELECTRIC POWER; SYSTEMS FOR STORING ELECTRIC ENERGY,1
TOYOTA MOTOR CO LTD,"IGNITION, OTHER THAN COMPRESSION IGNITION, FOR INTERNAL-COMBUSTION ENGINES; TESTING OF IGNITION TIMING IN COMPRESSION-IGNITION ENGINES",1
MAHLE INT GMBH,STEAM ENGINE PLANTS; STEAM ACCUMULATORS; ENGINE PLANTS NOT OTHERWISE PROVIDED FOR; ENGINES USING SPECIAL WORKING FLUIDS OR CYCLES,1
MAHLE INT GMBH,"ELECTRIC HEATING; ELECTRIC LIGHT SOURCES NOT OTHERWISE PROVIDED FOR; CIRCUIT ARRANGEMENTS FOR ELECTRIC LIGHT SOURCES, IN GENERAL",1
HONDA MOTOR CO LTD,PROPULSION OF ELECTRICALLY-PROPELLED VEHICLES; SUPPLYING ELECTRIC POWER FOR AUXILIARY EQUIPMENT OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRODYNAMIC BRAKE SYSTEMS FOR VEHICLES IN GENERAL; MAGNETIC SUSPENSION OR LEVITATION FOR VEHICLES; MONITORING OPERATING VARIABLES OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRIC SAFETY DEVICES FOR ELECTRICALLY-PROPELLED VEHICLES,1
TOYOTA MOTOR CO LTD,SUPPLYING COMBUSTION ENGINES IN GENERAL WITH COMBUSTIBLE MIXTURES OR CONSTITUENTS THEREOF,1
KIA MOTORS CORP,"DOMESTIC- OR SPACE-HEATING SYSTEMS, e.g. CENTRAL HEATING SYSTEMS; DOMESTIC HOT-WATER SUPPLY SYSTEMS; ELEMENTS OR COMPONENTS THEREFOR",1
MAHLE INT GMBH,"FLUID HEATERS, e.g. WATER OR AIR HEATERS, HAVING HEAT-GENERATING MEANS, e.g. HEAT PUMPS, IN GENERAL",1
MAHLE INT GMBH,HOT GAS OR COMBUSTION-PRODUCT POSITIVE-DISPLACEMENT ENGINE PLANTS; USE OF WASTE HEAT OF COMBUSTION ENGINES; NOT OTHERWISE PROVIDED FOR,1
Current sql:
WITH DENSO_PUBS AS (
    SELECT DISTINCT t1."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t1,
         LATERAL FLATTEN(input => t1."assignee_harmonized") assignee
    WHERE assignee.value:"name"::STRING = 'DENSO CORP'
),
CITING_PUBS AS (
    SELECT DISTINCT t2."publication_number" AS citing_publication_number
    FROM PATENTS.PATENTS.PUBLICATIONS t2,
         LATERAL FLATTEN(input => t2."citation") c2
    WHERE c2.value:"publication_number"::STRING IN (SELECT "publication_number" FROM DENSO_PUBS)
),
CITING_PUBS_WITH_ASSIGNEE AS (
    SELECT DISTINCT cp.citing_publication_number, assignee.value:"name"::STRING AS assignee_name
    FROM CITING_PUBS cp
    JOIN PATENTS.PATENTS.PUBLICATIONS t2 ON t2."publication_number" = cp.citing_publication_number
    , LATERAL FLATTEN(input => t2."assignee_harmonized") assignee
    WHERE assignee.value:"name"::STRING != 'DENSO CORP'
),
CITING_PUBS_WITH_CPC AS (
    SELECT cpwa.citing_publication_number, cpwa.assignee_name, SUBSTR(cpc.value:"code"::STRING,1,4) AS cpc_subclass
    FROM CITING_PUBS_WITH_ASSIGNEE cpwa
    JOIN PATENTS.PATENTS.PUBLICATIONS t2 ON t2."publication_number" = cpwa.citing_publication_number
    , LATERAL FLATTEN(input => t2."cpc") cpc
)
SELECT cpwc.assignee_name AS Assignee, def."titleFull" AS CPC_Subclass_Title, COUNT(DISTINCT cpwc.citing_publication_number) AS Citation_Count
FROM CITING_PUBS_WITH_CPC cpwc
JOIN PATENTS.PATENTS.CPC_DEFINITION def ON cpwc.cpc_subclass = def."symbol"
GROUP BY cpwc.assignee_name, def."titleFull"
ORDER BY Citation_Count DESC;When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-25 10:32:38 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:32:38 - root - INFO - ```sql
WITH DENSO_PUBS AS (
    SELECT DISTINCT t1."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t1,
         LATERAL FLATTEN(input => t1."assignee_harmonized") assignee
    WHERE assignee.value:"name"::STRING = 'DENSO CORP'
),
CITING_PUBS AS (
    SELECT DISTINCT t2."publication_number" AS citing_publication_number
    FROM PATENTS.PATENTS.PUBLICATIONS t2,
         LATERAL FLATTEN(input => t2."citation") c2
    WHERE c2.value:"publication_number"::STRING IN (SELECT "publication_number" FROM DENSO_PUBS)
),
CITING_PUBS_WITH_ASSIGNEE AS (
    SELECT DISTINCT cp.citing_publication_number, assignee.value:"name"::STRING AS assignee_name
    FROM CITING_PUBS cp
    JOIN PATENTS.PATENTS.PUBLICATIONS t2 ON t2."publication_number" = cp.citing_publication_number
    , LATERAL FLATTEN(input => t2."assignee_harmonized") assignee
    WHERE assignee.value:"name"::STRING != 'DENSO CORP'
),
CITING_PUBS_WITH_CPC AS (
    SELECT cpwa.citing_publication_number, cpwa.assignee_name, SUBSTR(cpc.value:"code"::STRING,1,4) AS cpc_subclass
    FROM CITING_PUBS_WITH_ASSIGNEE cpwa
    JOIN PATENTS.PATENTS.PUBLICATIONS t2 ON t2."publication_number" = cpwa.citing_publication_number
    , LATERAL FLATTEN(input => t2."cpc") cpc
)
SELECT cpwc.assignee_name AS Assignee, def."titleFull" AS CPC_Subclass_Title, COUNT(DISTINCT cpwc.citing_publication_number) AS Citation_Count
FROM CITING_PUBS_WITH_CPC cpwc
JOIN PATENTS.PATENTS.CPC_DEFINITION def ON cpwc.cpc_subclass = def."symbol"
GROUP BY cpwc.assignee_name, def."titleFull"
ORDER BY Citation_Count DESC NULLS LAST;
```
2025-01-25 10:32:38 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:32:38 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:32:38 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:32:40 - snowflake.connector.cursor - INFO - Number of results in first chunk: 29
2025-01-25 10:32:40 - snowflake.connector.connection - INFO - closed
2025-01-25 10:32:40 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:32:40 - root - INFO - itercount: 2
2025-01-25 10:32:40 - root - INFO - 0
2025-01-25 10:32:40 - root - INFO - results: 
ASSIGNEE,CPC_SUBCLASS_TITLE,CITATION_COUNT
MAHLE INT GMBH,"PREHEATING, OR ACCUMULATING PREHEATED, FEED-WATER FOR STEAM GENERATION; FEED-WATER SUPPLY FOR STEAM GENERATION; CONTROLLING WATER LEVEL FOR STEAM GENERATION; AUXILIARY DEVICES FOR PROMOTING WATER CIRCULATION WITHIN STEAM BOILERS",1
HONDA MOTOR CO LTD,CIRCUIT ARRANGEMENTS OR SYSTEMS FOR SUPPLYING OR DISTRIBUTING ELECTRIC POWER; SYSTEMS FOR STORING ELECTRIC ENERGY,1
TOYOTA MOTOR CO LTD,SUPPLYING COMBUSTION ENGINES IN GENERAL WITH COMBUSTIBLE MIXTURES OR CONSTITUENTS THEREOF,1
YAZAKI CORP,"ARRANGEMENT OF SIGNALLING OR LIGHTING DEVICES, THE MOUNTING OR SUPPORTING THEREOF OR CIRCUITS THEREFOR, FOR VEHICLES IN GENERAL",1
FUJI ELECTRIC CO LTD,EMERGENCY PROTECTIVE CIRCUIT ARRANGEMENTS,1
MAHLE INT GMBH,"FLUID HEATERS, e.g. WATER OR AIR HEATERS, HAVING HEAT-GENERATING MEANS, e.g. HEAT PUMPS, IN GENERAL",1
KIA MOTORS CORP,"ELECTRIC HEATING; ELECTRIC LIGHT SOURCES NOT OTHERWISE PROVIDED FOR; CIRCUIT ARRANGEMENTS FOR ELECTRIC LIGHT SOURCES, IN GENERAL",1
FUJI ELECTRIC CO LTD,PRINTED CIRCUITS; CASINGS OR CONSTRUCTIONAL DETAILS OF ELECTRIC APPARATUS; MANUFACTURE OF ASSEMBLAGES OF ELECTRICAL COMPONENTS,1
TOYOTA MOTOR CO LTD,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,1
HONDA MOTOR CO LTD,"SYSTEMS INTEGRATING TECHNOLOGIES RELATED TO POWER NETWORK OPERATION, COMMUNICATION OR INFORMATION TECHNOLOGIES FOR IMPROVING THE ELECTRICAL POWER GENERATION, TRANSMISSION, DISTRIBUTION, MANAGEMENT OR USAGE, i.e. SMART GRIDS",1
HONDA MOTOR CO LTD,PROPULSION OF ELECTRICALLY-PROPELLED VEHICLES; SUPPLYING ELECTRIC POWER FOR AUXILIARY EQUIPMENT OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRODYNAMIC BRAKE SYSTEMS FOR VEHICLES IN GENERAL; MAGNETIC SUSPENSION OR LEVITATION FOR VEHICLES; MONITORING OPERATING VARIABLES OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRIC SAFETY DEVICES FOR ELECTRICALLY-PROPELLED VEHICLES,1
MAHLE INT GMBH,HOT GAS OR COMBUSTION-PRODUCT POSITIVE-DISPLACEMENT ENGINE PLANTS; USE OF WASTE HEAT OF COMBUSTION ENGINES; NOT OTHERWISE PROVIDED FOR,1
FUJI ELECTRIC CO LTD,ELECTRIC DIGITAL DATA PROCESSING,1
TOYOTA BOSHOKU KK,SEATS SPECIALLY ADAPTED FOR VEHICLES; VEHICLE PASSENGER ACCOMMODATION NOT OTHERWISE PROVIDED FOR,1
HONDA MOTOR CO LTD,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,1
HYUNDAI MOTOR CO LTD,"DOMESTIC- OR SPACE-HEATING SYSTEMS, e.g. CENTRAL HEATING SYSTEMS; DOMESTIC HOT-WATER SUPPLY SYSTEMS; ELEMENTS OR COMPONENTS THEREFOR",1
HYUNDAI MOTOR CO LTD,"ELECTRIC HEATING; ELECTRIC LIGHT SOURCES NOT OTHERWISE PROVIDED FOR; CIRCUIT ARRANGEMENTS FOR ELECTRIC LIGHT SOURCES, IN GENERAL",1
HONDA MOTOR CO LTD,"VEHICLES, VEHICLE FITTINGS, OR VEHICLE PARTS, NOT OTHERWISE PROVIDED FOR",1
SUZUKI HISAO,SUPPLYING COMBUSTION ENGINES IN GENERAL WITH COMBUSTIBLE MIXTURES OR CONSTITUENTS THEREOF,1
TOYOTA MOTOR CO LTD,"IGNITION, OTHER THAN COMPRESSION IGNITION, FOR INTERNAL-COMBUSTION ENGINES; TESTING OF IGNITION TIMING IN COMPRESSION-IGNITION ENGINES",1
MAHLE INT GMBH,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,1
KIA MOTORS CORP,"FLUID HEATERS, e.g. WATER OR AIR HEATERS, HAVING HEAT-GENERATING MEANS, e.g. HEAT PUMPS, IN GENERAL",1
MAHLE INT GMBH,STEAM ENGINE PLANTS; STEAM ACCUMULATORS; ENGINE PLANTS NOT OTHERWISE PROVIDED FOR; ENGINES USING SPECIAL WORKING FLUIDS OR CYCLES,1
MAHLE INT GMBH,"ELECTRIC HEATING; ELECTRIC LIGHT SOURCES NOT OTHERWISE PROVIDED FOR; CIRCUIT ARRANGEMENTS FOR ELECTRIC LIGHT SOURCES, IN GENERAL",1
HYUNDAI MOTOR CO LTD,"FLUID HEATERS, e.g. WATER OR AIR HEATERS, HAVING HEAT-GENERATING MEANS, e.g. HEAT PUMPS, IN GENERAL",1
SAHASHI HIDEO,SEATS SPECIALLY ADAPTED FOR VEHICLES; VEHICLE PASSENGER ACCOMMODATION NOT OTHERWISE PROVIDED FOR,1
KIA MOTORS CORP,"DOMESTIC- OR SPACE-HEATING SYSTEMS, e.g. CENTRAL HEATING SYSTEMS; DOMESTIC HOT-WATER SUPPLY SYSTEMS; ELEMENTS OR COMPONENTS THEREFOR",1
MAHLE INT GMBH,"ARRANGEMENTS OF HEATING, COOLING, VENTILATING OR OTHER AIR-TREATING DEVICES SPECIALLY ADAPTED FOR PASSENGER OR GOODS SPACES OF VEHICLES",1
YAZAKI CORP,"ARRANGEMENT OR MOUNTING OF PROPULSION UNITS OR OF TRANSMISSIONS IN VEHICLES; ARRANGEMENT OR MOUNTING OF PLURAL DIVERSE PRIME-MOVERS IN VEHICLES; AUXILIARY DRIVES FOR VEHICLES; INSTRUMENTATION OR DASHBOARDS FOR VEHICLES; ARRANGEMENTS IN CONNECTION WITH COOLING, AIR INTAKE, GAS EXHAUST OR FUEL SUPPLY OF PROPULSION UNITS IN VEHICLES",1


2025-01-25 10:32:40 - root - INFO - Please check the answer again by reviewing Which assignees, excluding DENSO CORP itself, have cited patents assigned to DENSO CORP, and what are the titles of the primary CPC subclasses associated with these citations? Provide the name of each citing assignee, the full title of the CPC subclass, and the count of citations grouped by the assignee and the CPC subclass title. Please focus specifically on the main categories of the CPC codes,, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Assignee,CPC_Subclass_Title,Citation_Count
assignee1:str,cpc_subclass_title1:str,count1:int
assignee2:str,cpc_subclass_title2:str,count2:int
...
```

**Explanation:**

To address this task, we first identify all patents assigned to **DENSO CORP** from the `PUBLICATIONS` table by filtering the `assignee_harmonized` field. Next, we find all patents that cite these DENSO CORP patents by examining the `citation` field in the same table, excluding any citations originating from DENSO CORP itself. For each citing patent, we retrieve the assignee's name and the primary CPC subclass code from the `cpc` field. We then join this CPC code with the `CPC_DEFINITION` table to obtain the full title of the CPC subclass. Finally, we group the results by the assignee and the CPC subclass title, counting the number of citations in each group. The focus on the main categories of the CPC codes ensures that we consider the primary technological areas relevant to the cited patents. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
ASSIGNEE,CPC_SUBCLASS_TITLE,CITATION_COUNT
MAHLE INT GMBH,"PREHEATING, OR ACCUMULATING PREHEATED, FEED-WATER FOR STEAM GENERATION; FEED-WATER SUPPLY FOR STEAM GENERATION; CONTROLLING WATER LEVEL FOR STEAM GENERATION; AUXILIARY DEVICES FOR PROMOTING WATER CIRCULATION WITHIN STEAM BOILERS",1
HONDA MOTOR CO LTD,CIRCUIT ARRANGEMENTS OR SYSTEMS FOR SUPPLYING OR DISTRIBUTING ELECTRIC POWER; SYSTEMS FOR STORING ELECTRIC ENERGY,1
TOYOTA MOTOR CO LTD,SUPPLYING COMBUSTION ENGINES IN GENERAL WITH COMBUSTIBLE MIXTURES OR CONSTITUENTS THEREOF,1
YAZAKI CORP,"ARRANGEMENT OF SIGNALLING OR LIGHTING DEVICES, THE MOUNTING OR SUPPORTING THEREOF OR CIRCUITS THEREFOR, FOR VEHICLES IN GENERAL",1
FUJI ELECTRIC CO LTD,EMERGENCY PROTECTIVE CIRCUIT ARRANGEMENTS,1
MAHLE INT GMBH,"FLUID HEATERS, e.g. WATER OR AIR HEATERS, HAVING HEAT-GENERATING MEANS, e.g. HEAT PUMPS, IN GENERAL",1
KIA MOTORS CORP,"ELECTRIC HEATING; ELECTRIC LIGHT SOURCES NOT OTHERWISE PROVIDED FOR; CIRCUIT ARRANGEMENTS FOR ELECTRIC LIGHT SOURCES, IN GENERAL",1
FUJI ELECTRIC CO LTD,PRINTED CIRCUITS; CASINGS OR CONSTRUCTIONAL DETAILS OF ELECTRIC APPARATUS; MANUFACTURE OF ASSEMBLAGES OF ELECTRICAL COMPONENTS,1
TOYOTA MOTOR CO LTD,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,1
HONDA MOTOR CO LTD,"SYSTEMS INTEGRATING TECHNOLOGIES RELATED TO POWER NETWORK OPERATION, COMMUNICATION OR INFORMATION TECHNOLOGIES FOR IMPROVING THE ELECTRICAL POWER GENERATION, TRANSMISSION, DISTRIBUTION, MANAGEMENT OR USAGE, i.e. SMART GRIDS",1
HONDA MOTOR CO LTD,PROPULSION OF ELECTRICALLY-PROPELLED VEHICLES; SUPPLYING ELECTRIC POWER FOR AUXILIARY EQUIPMENT OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRODYNAMIC BRAKE SYSTEMS FOR VEHICLES IN GENERAL; MAGNETIC SUSPENSION OR LEVITATION FOR VEHICLES; MONITORING OPERATING VARIABLES OF ELECTRICALLY-PROPELLED VEHICLES; ELECTRIC SAFETY DEVICES FOR ELECTRICALLY-PROPELLED VEHICLES,1
MAHLE INT GMBH,HOT GAS OR COMBUSTION-PRODUCT POSITIVE-DISPLACEMENT ENGINE PLANTS; USE OF WASTE HEAT OF COMBUSTION ENGINES; NOT OTHERWISE PROVIDED FOR,1
FUJI ELECTRIC CO LTD,ELECTRIC DIGITAL DATA PROCESSING,1
TOYOTA BOSHOKU KK,SEATS SPECIALLY ADAPTED FOR VEHICLES; VEHICLE PASSENGER ACCOMMODATION NOT OTHERWISE PROVIDED FOR,1
HONDA MOTOR CO LTD,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,1
HYUNDAI MOTOR CO LTD,"DOMESTIC- OR SPACE-HEATING SYSTEMS, e.g. CENTRAL HEATING SYSTEMS; DOMESTIC HOT-WATER SUPPLY SYSTEMS; ELEMENTS OR COMPONENTS THEREFOR",1
HYUNDAI MOTOR CO LTD,"ELECTRIC HEATING; ELECTRIC LIGHT SOURCES NOT OTHERWISE PROVIDED FOR; CIRCUIT ARRANGEMENTS FOR ELECTRIC LIGHT SOURCES, IN GENERAL",1
HONDA MOTOR CO LTD,"VEHICLES, VEHICLE FITTINGS, OR VEHICLE PARTS, NOT OTHERWISE PROVIDED FOR",1
SUZUKI HISAO,SUPPLYING COMBUSTION ENGINES IN GENERAL WITH COMBUSTIBLE MIXTURES OR CONSTITUENTS THEREOF,1
TOYOTA MOTOR CO LTD,"IGNITION, OTHER THAN COMPRESSION IGNITION, FOR INTERNAL-COMBUSTION ENGINES; TESTING OF IGNITION TIMING IN COMPRESSION-IGNITION ENGINES",1
MAHLE INT GMBH,CLIMATE CHANGE MITIGATION TECHNOLOGIES RELATED TO TRANSPORTATION,1
KIA MOTORS CORP,"FLUID HEATERS, e.g. WATER OR AIR HEATERS, HAVING HEAT-GENERATING MEANS, e.g. HEAT PUMPS, IN GENERAL",1
MAHLE INT GMBH,STEAM ENGINE PLANTS; STEAM ACCUMULATORS; ENGINE PLANTS NOT OTHERWISE PROVIDED FOR; ENGINES USING SPECIAL WORKING FLUIDS OR CYCLES,1
MAHLE INT GMBH,"ELECTRIC HEATING; ELECTRIC LIGHT SOURCES NOT OTHERWISE PROVIDED FOR; CIRCUIT ARRANGEMENTS FOR ELECTRIC LIGHT SOURCES, IN GENERAL",1
HYUNDAI MOTOR CO LTD,"FLUID HEATERS, e.g. WATER OR AIR HEATERS, HAVING HEAT-GENERATING MEANS, e.g. HEAT PUMPS, IN GENERAL",1
SAHASHI HIDEO,SEATS SPECIALLY ADAPTED FOR VEHICLES; VEHICLE PASSENGER ACCOMMODATION NOT OTHERWISE PROVIDED FOR,1
KIA MOTORS CORP,"DOMESTIC- OR SPACE-HEATING SYSTEMS, e.g. CENTRAL HEATING SYSTEMS; DOMESTIC HOT-WATER SUPPLY SYSTEMS; ELEMENTS OR COMPONENTS THEREFOR",1
MAHLE INT GMBH,"ARRANGEMENTS OF HEATING, COOLING, VENTILATING OR OTHER AIR-TREATING DEVICES SPECIALLY ADAPTED FOR PASSENGER OR GOODS SPACES OF VEHICLES",1
YAZAKI CORP,"ARRANGEMENT OR MOUNTING OF PROPULSION UNITS OR OF TRANSMISSIONS IN VEHICLES; ARRANGEMENT OR MOUNTING OF PLURAL DIVERSE PRIME-MOVERS IN VEHICLES; AUXILIARY DRIVES FOR VEHICLES; INSTRUMENTATION OR DASHBOARDS FOR VEHICLES; ARRANGEMENTS IN CONNECTION WITH COOLING, AIR INTAKE, GAS EXHAUST OR FUEL SUPPLY OF PROPULSION UNITS IN VEHICLES",1
Current sql:
WITH DENSO_PUBS AS (
    SELECT DISTINCT t1."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t1,
         LATERAL FLATTEN(input => t1."assignee_harmonized") assignee
    WHERE assignee.value:"name"::STRING = 'DENSO CORP'
),
CITING_PUBS AS (
    SELECT DISTINCT t2."publication_number" AS citing_publication_number
    FROM PATENTS.PATENTS.PUBLICATIONS t2,
         LATERAL FLATTEN(input => t2."citation") c2
    WHERE c2.value:"publication_number"::STRING IN (SELECT "publication_number" FROM DENSO_PUBS)
),
CITING_PUBS_WITH_ASSIGNEE AS (
    SELECT DISTINCT cp.citing_publication_number, assignee.value:"name"::STRING AS assignee_name
    FROM CITING_PUBS cp
    JOIN PATENTS.PATENTS.PUBLICATIONS t2 ON t2."publication_number" = cp.citing_publication_number
    , LATERAL FLATTEN(input => t2."assignee_harmonized") assignee
    WHERE assignee.value:"name"::STRING != 'DENSO CORP'
),
CITING_PUBS_WITH_CPC AS (
    SELECT cpwa.citing_publication_number, cpwa.assignee_name, SUBSTR(cpc.value:"code"::STRING,1,4) AS cpc_subclass
    FROM CITING_PUBS_WITH_ASSIGNEE cpwa
    JOIN PATENTS.PATENTS.PUBLICATIONS t2 ON t2."publication_number" = cpwa.citing_publication_number
    , LATERAL FLATTEN(input => t2."cpc") cpc
)
SELECT cpwc.assignee_name AS Assignee, def."titleFull" AS CPC_Subclass_Title, COUNT(DISTINCT cpwc.citing_publication_number) AS Citation_Count
FROM CITING_PUBS_WITH_CPC cpwc
JOIN PATENTS.PATENTS.CPC_DEFINITION def ON cpwc.cpc_subclass = def."symbol"
GROUP BY cpwc.assignee_name, def."titleFull"
ORDER BY Citation_Count DESC NULLS LAST;
2025-01-25 10:33:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:33:14 - root - INFO - ```sql
WITH DENSO_PUBS AS (
    SELECT DISTINCT t1."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t1,
         LATERAL FLATTEN(input => t1."assignee_harmonized") assignee
    WHERE assignee.value:"name"::STRING = 'DENSO CORP'
),
CITING_PUBS AS (
    SELECT DISTINCT t2."publication_number" AS citing_publication_number
    FROM PATENTS.PATENTS.PUBLICATIONS t2,
         LATERAL FLATTEN(input => t2."citation") c2
    WHERE c2.value:"publication_number"::STRING IN (SELECT "publication_number" FROM DENSO_PUBS)
),
CITING_PUBS_WITH_ASSIGNEE AS (
    SELECT DISTINCT cp.citing_publication_number, assignee.value:"name"::STRING AS assignee_name
    FROM CITING_PUBS cp
    JOIN PATENTS.PATENTS.PUBLICATIONS t2 ON t2."publication_number" = cp.citing_publication_number
    , LATERAL FLATTEN(input => t2."assignee_harmonized") assignee
    WHERE assignee.value:"name"::STRING != 'DENSO CORP'
),
CITING_PUBS_WITH_CPC AS (
    SELECT cpwa.citing_publication_number, cpwa.assignee_name, SUBSTR(cpc.value:"code"::STRING,1,1) AS cpc_main_category
    FROM CITING_PUBS_WITH_ASSIGNEE cpwa
    JOIN PATENTS.PATENTS.PUBLICATIONS t2 ON t2."publication_number" = cpwa.citing_publication_number
    , LATERAL FLATTEN(input => t2."cpc") cpc
)
SELECT cpwc.assignee_name AS Assignee, def."titleFull" AS CPC_Subclass_Title, COUNT(DISTINCT cpwc.citing_publication_number) AS Citation_Count
FROM CITING_PUBS_WITH_CPC cpwc
JOIN PATENTS.PATENTS.CPC_DEFINITION def ON cpwc.cpc_main_category = def."symbol"
GROUP BY cpwc.assignee_name, def."titleFull"
ORDER BY Citation_Count DESC NULLS LAST;
```
2025-01-25 10:33:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:33:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:33:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:33:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 19
2025-01-25 10:33:16 - snowflake.connector.connection - INFO - closed
2025-01-25 10:33:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:33:17 - root - INFO - itercount: 3
2025-01-25 10:33:17 - root - INFO - 0
2025-01-25 10:33:17 - root - INFO - results: 
ASSIGNEE,CPC_SUBCLASS_TITLE,CITATION_COUNT
TOYOTA MOTOR CO LTD,MECHANICAL ENGINEERING; LIGHTING; HEATING; WEAPONS; BLASTING,2
MAHLE INT GMBH,MECHANICAL ENGINEERING; LIGHTING; HEATING; WEAPONS; BLASTING,2
MAHLE INT GMBH,ELECTRICITY,1
HONDA MOTOR CO LTD,PERFORMING OPERATIONS; TRANSPORTING,1
SAHASHI HIDEO,PERFORMING OPERATIONS; TRANSPORTING,1
HONDA MOTOR CO LTD,GENERAL TAGGING OF NEW TECHNOLOGICAL DEVELOPMENTS; GENERAL TAGGING OF CROSS-SECTIONAL TECHNOLOGIES SPANNING OVER SEVERAL SECTIONS OF THE IPC; TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS,1
KIA MOTORS CORP,ELECTRICITY,1
MAHLE INT GMBH,GENERAL TAGGING OF NEW TECHNOLOGICAL DEVELOPMENTS; GENERAL TAGGING OF CROSS-SECTIONAL TECHNOLOGIES SPANNING OVER SEVERAL SECTIONS OF THE IPC; TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS,1
SUZUKI HISAO,MECHANICAL ENGINEERING; LIGHTING; HEATING; WEAPONS; BLASTING,1
FUJI ELECTRIC CO LTD,PHYSICS,1
KIA MOTORS CORP,MECHANICAL ENGINEERING; LIGHTING; HEATING; WEAPONS; BLASTING,1
TOYOTA BOSHOKU KK,PERFORMING OPERATIONS; TRANSPORTING,1
FUJI ELECTRIC CO LTD,ELECTRICITY,1
MAHLE INT GMBH,PERFORMING OPERATIONS; TRANSPORTING,1
HYUNDAI MOTOR CO LTD,MECHANICAL ENGINEERING; LIGHTING; HEATING; WEAPONS; BLASTING,1
YAZAKI CORP,PERFORMING OPERATIONS; TRANSPORTING,1
HONDA MOTOR CO LTD,ELECTRICITY,1
HYUNDAI MOTOR CO LTD,ELECTRICITY,1
TOYOTA MOTOR CO LTD,GENERAL TAGGING OF NEW TECHNOLOGICAL DEVELOPMENTS; GENERAL TAGGING OF CROSS-SECTIONAL TECHNOLOGIES SPANNING OVER SEVERAL SECTIONS OF THE IPC; TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS,1


2025-01-25 10:33:17 - root - INFO - Please check the answer again by reviewing Which assignees, excluding DENSO CORP itself, have cited patents assigned to DENSO CORP, and what are the titles of the primary CPC subclasses associated with these citations? Provide the name of each citing assignee, the full title of the CPC subclass, and the count of citations grouped by the assignee and the CPC subclass title. Please focus specifically on the main categories of the CPC codes,, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Assignee,CPC_Subclass_Title,Citation_Count
assignee1:str,cpc_subclass_title1:str,count1:int
assignee2:str,cpc_subclass_title2:str,count2:int
...
```

**Explanation:**

To address this task, we first identify all patents assigned to **DENSO CORP** from the `PUBLICATIONS` table by filtering the `assignee_harmonized` field. Next, we find all patents that cite these DENSO CORP patents by examining the `citation` field in the same table, excluding any citations originating from DENSO CORP itself. For each citing patent, we retrieve the assignee's name and the primary CPC subclass code from the `cpc` field. We then join this CPC code with the `CPC_DEFINITION` table to obtain the full title of the CPC subclass. Finally, we group the results by the assignee and the CPC subclass title, counting the number of citations in each group. The focus on the main categories of the CPC codes ensures that we consider the primary technological areas relevant to the cited patents. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
ASSIGNEE,CPC_SUBCLASS_TITLE,CITATION_COUNT
TOYOTA MOTOR CO LTD,MECHANICAL ENGINEERING; LIGHTING; HEATING; WEAPONS; BLASTING,2
MAHLE INT GMBH,MECHANICAL ENGINEERING; LIGHTING; HEATING; WEAPONS; BLASTING,2
MAHLE INT GMBH,ELECTRICITY,1
HONDA MOTOR CO LTD,PERFORMING OPERATIONS; TRANSPORTING,1
SAHASHI HIDEO,PERFORMING OPERATIONS; TRANSPORTING,1
HONDA MOTOR CO LTD,GENERAL TAGGING OF NEW TECHNOLOGICAL DEVELOPMENTS; GENERAL TAGGING OF CROSS-SECTIONAL TECHNOLOGIES SPANNING OVER SEVERAL SECTIONS OF THE IPC; TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS,1
KIA MOTORS CORP,ELECTRICITY,1
MAHLE INT GMBH,GENERAL TAGGING OF NEW TECHNOLOGICAL DEVELOPMENTS; GENERAL TAGGING OF CROSS-SECTIONAL TECHNOLOGIES SPANNING OVER SEVERAL SECTIONS OF THE IPC; TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS,1
SUZUKI HISAO,MECHANICAL ENGINEERING; LIGHTING; HEATING; WEAPONS; BLASTING,1
FUJI ELECTRIC CO LTD,PHYSICS,1
KIA MOTORS CORP,MECHANICAL ENGINEERING; LIGHTING; HEATING; WEAPONS; BLASTING,1
TOYOTA BOSHOKU KK,PERFORMING OPERATIONS; TRANSPORTING,1
FUJI ELECTRIC CO LTD,ELECTRICITY,1
MAHLE INT GMBH,PERFORMING OPERATIONS; TRANSPORTING,1
HYUNDAI MOTOR CO LTD,MECHANICAL ENGINEERING; LIGHTING; HEATING; WEAPONS; BLASTING,1
YAZAKI CORP,PERFORMING OPERATIONS; TRANSPORTING,1
HONDA MOTOR CO LTD,ELECTRICITY,1
HYUNDAI MOTOR CO LTD,ELECTRICITY,1
TOYOTA MOTOR CO LTD,GENERAL TAGGING OF NEW TECHNOLOGICAL DEVELOPMENTS; GENERAL TAGGING OF CROSS-SECTIONAL TECHNOLOGIES SPANNING OVER SEVERAL SECTIONS OF THE IPC; TECHNICAL SUBJECTS COVERED BY FORMER USPC CROSS-REFERENCE ART COLLECTIONS [XRACs] AND DIGESTS,1
Current sql:
WITH DENSO_PUBS AS (
    SELECT DISTINCT t1."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t1,
         LATERAL FLATTEN(input => t1."assignee_harmonized") assignee
    WHERE assignee.value:"name"::STRING = 'DENSO CORP'
),
CITING_PUBS AS (
    SELECT DISTINCT t2."publication_number" AS citing_publication_number
    FROM PATENTS.PATENTS.PUBLICATIONS t2,
         LATERAL FLATTEN(input => t2."citation") c2
    WHERE c2.value:"publication_number"::STRING IN (SELECT "publication_number" FROM DENSO_PUBS)
),
CITING_PUBS_WITH_ASSIGNEE AS (
    SELECT DISTINCT cp.citing_publication_number, assignee.value:"name"::STRING AS assignee_name
    FROM CITING_PUBS cp
    JOIN PATENTS.PATENTS.PUBLICATIONS t2 ON t2."publication_number" = cp.citing_publication_number
    , LATERAL FLATTEN(input => t2."assignee_harmonized") assignee
    WHERE assignee.value:"name"::STRING != 'DENSO CORP'
),
CITING_PUBS_WITH_CPC AS (
    SELECT cpwa.citing_publication_number, cpwa.assignee_name, SUBSTR(cpc.value:"code"::STRING,1,1) AS cpc_main_category
    FROM CITING_PUBS_WITH_ASSIGNEE cpwa
    JOIN PATENTS.PATENTS.PUBLICATIONS t2 ON t2."publication_number" = cpwa.citing_publication_number
    , LATERAL FLATTEN(input => t2."cpc") cpc
)
SELECT cpwc.assignee_name AS Assignee, def."titleFull" AS CPC_Subclass_Title, COUNT(DISTINCT cpwc.citing_publication_number) AS Citation_Count
FROM CITING_PUBS_WITH_CPC cpwc
JOIN PATENTS.PATENTS.CPC_DEFINITION def ON cpwc.cpc_main_category = def."symbol"
GROUP BY cpwc.assignee_name, def."titleFull"
ORDER BY Citation_Count DESC NULLS LAST;
2025-01-25 10:33:36 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-25 10:33:36 - root - INFO - ```sql
WITH DENSO_PUBS AS (
    SELECT DISTINCT t1."publication_number"
    FROM PATENTS.PATENTS.PUBLICATIONS t1,
         LATERAL FLATTEN(input => t1."assignee_harmonized") assignee
    WHERE assignee.value:"name"::STRING = 'DENSO CORP'
),
CITING_PUBS AS (
    SELECT DISTINCT t2."publication_number" AS citing_publication_number
    FROM PATENTS.PATENTS.PUBLICATIONS t2,
         LATERAL FLATTEN(input => t2."citation") c2
    WHERE c2.value:"publication_number"::STRING IN (SELECT "publication_number" FROM DENSO_PUBS)
),
CITING_PUBS_WITH_ASSIGNEE AS (
    SELECT DISTINCT cp.citing_publication_number, assignee.value:"name"::STRING AS assignee_name
    FROM CITING_PUBS cp
    JOIN PATENTS.PATENTS.PUBLICATIONS t2 ON t2."publication_number" = cp.citing_publication_number
    , LATERAL FLATTEN(input => t2."assignee_harmonized") assignee
    WHERE assignee.value:"name"::STRING != 'DENSO CORP'
),
CITING_PUBS_WITH_CPC AS (
    SELECT cpwa.citing_publication_number, cpwa.assignee_name, SUBSTR(cpc.value:"code"::STRING,1,1) AS cpc_main_category
    FROM CITING_PUBS_WITH_ASSIGNEE cpwa
    JOIN PATENTS.PATENTS.PUBLICATIONS t2 ON t2."publication_number" = cpwa.citing_publication_number
    , LATERAL FLATTEN(input => t2."cpc") cpc
)
SELECT cpwc.assignee_name AS Assignee, def."titleFull" AS CPC_Subclass_Title, COUNT(DISTINCT cpwc.citing_publication_number) AS Citation_Count
FROM CITING_PUBS_WITH_CPC cpwc
JOIN PATENTS.PATENTS.CPC_DEFINITION def ON cpwc.cpc_main_category = def."symbol"
GROUP BY cpwc.assignee_name, def."titleFull"
ORDER BY Citation_Count DESC NULLS LAST;
```
2025-01-25 10:33:36 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-25 10:33:36 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-25 10:33:36 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-25 10:33:38 - snowflake.connector.cursor - INFO - Number of results in first chunk: 19
2025-01-25 10:33:38 - snowflake.connector.connection - INFO - closed
2025-01-25 10:33:38 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-25 10:33:38 - root - INFO - itercount: 4
2025-01-25 10:33:38 - root - INFO - 0
2025-01-25 10:33:38 - root - INFO - Total iteration counts: 4
