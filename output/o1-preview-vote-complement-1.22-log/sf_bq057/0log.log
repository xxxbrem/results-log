2025-01-24 08:19:31 - openai._base_client - INFO - Retrying request to /chat/completions in 0.390955 seconds
2025-01-24 08:20:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 08:20:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:20:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:20:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:20:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:20:41 - snowflake.connector.connection - INFO - closed
2025-01-24 08:20:41 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:20:41 - root - INFO - SQL:
SELECT "hash", "block_timestamp_month"
   FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
   WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
   LIMIT 100;
Results:
Too long, hard cut:
hash,block_timestamp_month
11f1bf1fc4f1d7270c4cca45d1ffec3031ab3c2082820c6a5829ccc16a76a331,2021-12-01
06778da7f4da997b74b2b38a02e9a2ce509b84cee91609fb7cd8a2c718592f3a,2021-12-01
e875f008b50dd1840c24a4c1da7573e38edfe1cf99ec5b747964d4d52e3dcec1,2021-12-01
4f306854a91ebb111b379671bd8acf3072a5196625ff7d2d1594d0e0d26c83ab,2021-12-01
dbe31c264dfeb875c71c0ed89014095208e81d8e07525b0aff80ba93acc93874,2021-12-01
a6a32f47b067cdcc443a245497bdaa9c9f3dcf530e06b6b88bebd981e520f7c5,2021-12-01
14d25856db9707fc46909745cf6190e752309e9163d7b52cf327a05194c2e0ed,2021-12-01
0a64f00d6469b152aab1944d6291d21b4e39e98721c255f519823d50162c1c68,2021-12-01
2e918cca0fd3267f68454da0a203a38ea8df22c5b7d71ec7365a8eb6b5f56c0a,2021-12-01
5dcf303044ef2d9c0bdd1bf04bd46a9670fb7bff581eceef8e1f11edf5d15b97,2021-12-01
8b385b606e62750decf99fdac7a0dae1f13146900b4972648583532217813c5f,2021-12-01
c92fb75be6d5aed6f265db15a41fad2d0eb97c1de45b47bd44c44e1c2ebffa3e,2021-12-01
c9ce1866d274a3b0217bcd7620139672bdedbff3d18eea5bd5d526e4b0908eb5,2021-12-01
9adfc708ce0b43631335eac8a4928b682d232e50d8f30634fb9ab9abee59cd54,2021-12-01
b79c0a6f5d506f89c4ab0aa6f0c3bfaba44b14ef84600cdd20b5bc21d28347c9,2021-12-01
7e27748e523a43ed169325dfa955d388eeacf897935b29be52ca18b99efc8e0d,2021-12-01
e494da1c4a2342d68e60d0de9f8c615b4b6a4b6bed5ffb676fe02691d3a2bd66,2021-12-01
e9b00d3aa1fbd938e675bd115bfff5ff054be5fcbb17bcec0443415e792db65b,2021-12-01
8b2154791852bf17bdfd5a91a0050df570c5993ddc7c3f9e1ede5e7e16436bf9,2021-12-01
e130aededa84455a0ce8531e5645a13de939234795b9822517aa2934539c24aa,2021-12-01
6b49821e125271e722c346f5aa1092cbc744664d07325473ace9d86c3ca5f4f4,2021-12-01
546f4d582f86c4a193339e4dfd40f712dca77633cba508ddea91479d59661830,2021-12-01
98f7ebe5c30ea59a9df2bf72264e5576f24b1e80fc1a9d2cb58c9ebb65567f6c,2021-12-01
960f1a54456089ce1ad01bb91d5c0746bd113b2926772a0870fa54b2b3cfad86,2021-12-01
c9ce06d48bf764feddc6b208d7e5e52fdc47f40e11d7d170bf17bad8c856a9b4,2021-12-01
4c9b6731fc41372d3ebdcafa29841f5d577333cbad77b6e2670d1b4ab9eecba8,2021-12-01
42aff86c374e9a12d23213f2b2b30cfb7f8108c8a53efbceefcbfef8e1db47a1,2021-12-01
e9c652be6ca4dd2d0fb8aee6443691753e15d03594f15ec2ec8cea112554eedf,2021-12-01
00d644c8c68504926bb8818b180ad8cb4195d274f9070532e151091832253398,2021-12-01
90f6607d0239b1383375266d76a0f0b76dbcb6cd8a6dbacab891d31de6b23b34,2021-12-01
9c5e3ed0baadcbe3982173199b3aaa59865cc897148af59ee811b6abc0263bb1,2021-12-01
eed48de426c2fae09301f93e4aeb63f759e784d97e28ba8b6b69eb60aaee30c0,2021-12-01
bb5baa76c927753d0d2b5873d828f77f4fafc2f1b78952cd303cd5b8bfdc787a,2021-12-01
4a42c967676e98427e619953beba8e89619089c4ad0f9e41da6ac71f09548972,2021-12-01
529511689f7837ea08d363d7c55b16a1723fedc6a0e6a87092969554093062e8,2021-12-01
332d4b8be96b0dba7fc267ded86cbc4899e5b7deb1f335afc48f82e2ef7f259d,2021-12-01
0718c2b88a237fd68e112c73dd830cafb95cf57707c84adc96f2146437075f72,2021-12-01
6491c0b389cf1c6ffa7c97b4e8a12134d3b4679861c4ffc5bc1de7937c5fc05a,2021-12-01
9fcb743abfd815545c04c1987e6a1c3b2c999cf8161c80c5b9f106b3e646c1f7,2021-12-01
db4231178a80e5b7da2e5bcf7921216d72142de9f15684db2241b3784e98816e,2021-12-01
369952419812c76ea3c9ac3c8935400ecad8b40688a415a4c24ee924224d26ef,2021-12-01
d34d105a750fab58359d53737878c758ec1e099d84df3e45a274331d8d92526d,2021-12-01
73934ffbae58a328ab8127816daba8672aa5f324e7a613cbe8c406a534def0a3,2021-12-01
716a0ea0cb4f3e4317d598f42b6848b5648eaa27aaa0abb9c1bc4e40a6200f4a,2021-12-01
34a26d0773c2b0cce2a7d7a7208d60e99e36b3c495e8dd73bf31ddb023e8c592,2021-12-01
11ea0acee17c41936d1d160dd1142e9e1912c07c4672aa35043c1048b4436bdf,2021-12-01
3e8254e626d9f303fb7b19ba191e5ca73c817fc00a614a1103965f5ab4793cb7,2021-12-01
c0d196f0db97e05980856660c4e67d33e4bbc548697ac21fd79694d1f2722814,2021-12-01
1e9a09c0afec42cf75db0395242e3ae12d27733425738a1f06de5c1e55fede81,2021-12-01
26e8087526b5e11c6cbfa1ee304b90efb9ce371f017f3d096864d830ed60b6e8,2021-12-01
e0ce6246751ef77833ca70b5e14fdc49870a7cd4d6d9a746d1a4c8d1e654b597,2021-12-01
4eb665a0bdee7f955b020f9781e34e7f6055658a1a29b4c81d00feba82b4f566,2021-12-01
89308d2d21da0c550d22a6c8b57607b88c8267195a19bd8700dea1d59add634e,2021-12-01
e8b3e5810f4e1c266ab80d0900655c50997b55ac77fa0fb37c37ebdb467723b3,2021-12-01
9ae11bbb5e85e52dff59d3062b7e320230274b80a197712978d056677428f690,2021-12-01
5be8f56d06cf076af431ae34843aa49c15af52b1eb75a00187ab17c814924670,2021-12-01
db45dfd610ba52a7e79d4a4c04b6dbbe83e0ac245e0f36574471fcf0d7d911f8,2021-12-01
27f69d5dac2a747dcc7e4a2ab2382d4e3d6384010d5c926ecab947b3e8d0723d,2021-12-01
05c9acb8ef1ef9064030b862e2dc9ca52892280ad9d6b99892a05bca86a93a08,2021-12-01
b5be7f089c3fb79c4a3a7ebaa81a6d3b905d3ec10be4de990f28816e2308ccd5,2021-12-01
a7c00df620ef435206008f700a187af062d3d420a5c2da346d6ad44e7f04bc43,2021-12-01
57d6b0a491409ccd8414dabbea314a9f81ce866e4748c11037b1ca1d76255497,2021-12-01
0b4ea377b95c432c23ffdb309f01ff28930c77079c196a5bc0baec0b8061d40d,2021-12-01
995d0fcc384736ceb74776678636dc7cd38181fb876549d07738508ff533179e,2021-12-01
c689a02d4ea89004d05a6e38e79f4709833c7f113d91b461564e8ddffabe391e,2021-12-01
a10007cc41b048a9df431589b2ab0dcb7

2025-01-24 08:20:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:20:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:20:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:20:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 08:20:43 - snowflake.connector.connection - INFO - closed
2025-01-24 08:20:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:20:43 - root - INFO - SQL:
SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month", COUNT(*) AS "Transaction_Count"
   FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
   WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
   GROUP BY "Month"
   ORDER BY "Month"
   LIMIT 100;
Results:
Month,Transaction_Count
12,41762

2025-01-24 08:20:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:20:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:20:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:20:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 08:20:45 - snowflake.connector.connection - INFO - closed
2025-01-24 08:20:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:20:45 - root - INFO - SQL:
SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
          AVG("input_count") AS "Avg_Input_Count",
          AVG("output_count") AS "Avg_Output_Count"
   FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
   WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
     AND "is_coinbase" = false
   GROUP BY "Month"
   ORDER BY "Month"
   LIMIT 100;
Results:
Month,Avg_Input_Count,Avg_Output_Count
12,3.274559,3.249671

2025-01-24 08:20:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:20:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:20:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:20:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:20:47 - snowflake.connector.connection - INFO - closed
2025-01-24 08:20:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:20:47 - root - INFO - SQL:
SELECT "hash", "input_count", "output_count", "block_timestamp_month"
   FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
   WHERE "input_count" >= 5 AND "output_count" >= 5
     AND "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
     AND "is_coinbase" = false
   LIMIT 100;
Results:
Too long, hard cut:
hash,input_count,output_count,block_timestamp_month
62c9c74241373248ba554a64123a0442fb878de5dc4a97ef2039d6d4249148ee,5,5,2021-12-01
7714956269c9925d800fbc8b888278df5a32e1c82c9e8ae498c805575390defe,5,5,2021-12-01
9a7ac8aeb235c1c273ac7054f08eaf7e5a49bba3e8c5c8f71e561992634cd434,5,7,2021-12-01
3f3f5ffb2e5371cdb92374d3a4a1fc0963bef2285be5676defed4ba92f8d75df,14,8,2021-12-01
240c3da27cb7ac77e37db59c312316b53edfe5ac14fbb8b7ff147d0d6e21d2b8,6,10,2021-12-01
80dd8704fef4ffb855cd127e94bd17ae3dc46b5efe8778012b84835408ba9420,15,34,2021-12-01
8cea9e2bdb4df0f5fef620c17ac6762dedf75a512118b9201b718917a755c6a1,7,55,2021-12-01
299f4bda26eb58dd972284c844fe7f400b1d39e02d5bd9f222fefd984a38e593,16,5,2021-12-01
ab070a3bc5cf4380b7ac9d692512d247d9d6ea6452b12ba4e6e83e3289edb75f,19,5,2021-12-01
373f99fec3704e321b6a725d88933c83adc5dd4a8c0e78e1d9d039806549bfd6,69,5,2021-12-01
f5257b4827b626724451b1a6a6f4142170298bbb9b97ebef1c0339c30601292e,6,7,2021-12-01
7565cc09f97b7bda57733721bb2c165eb3f88676bafd888ad3d412f802fe673e,5,15,2021-12-01
1a6e515749dcbb5a85fd23d758d494daa20e47f58b5d1e3b70476f931279519f,195,24,2021-12-01
397f2e699118c2a1522fa02c583b8ff50e50ecd452a183ba73a724feafa91ec0,5,5,2021-12-01
b7a7e0a09d132fa128fd7eff145490896fcaf6d8eb2d65f4e3f3ad36e61fd871,5,5,2021-12-01
3f88f52a5f88212613d549da8a4efbb2d67d2145af206de6a4cedbfb11b5449b,5,5,2021-12-01
7f240a603be32d1fa567699873ca4755a502ec85db19d6b75a7e0283fcdc3d10,5,6,2021-12-01
ab9e516787e5de6340b2e49a7b8b06933555fbbff5b566a57ed031b6dcb07796,11,7,2021-12-01
42dfb92b8bad1386be3e16d9c3ace3ec33d631e2c354ff035bf3612fd0b09db2,6,11,2021-12-01
fc7fc062a86379389e79b1d55fdac2a9efb25f652099793be8fb683daf448418,7,15,2021-12-01
20f53ebdb990c92e907746889ffc7caa9f674ac0978bf0e18602bd0fe156e138,18,35,2021-12-01
0a464af1a054ac6ddcbda147bd9a2ce8da4b0d703664dea81748579e86ffb021,19,5,2021-12-01
eb7ad1a8c3088c802a3b68a764dfebba5cbc9534aed1341aa2bb2578625528be,5,5,2021-12-01
25ceffb95793b617e0bbc9b8ba7c3a3e4f03970e0188335ae5bd170dd8109316,5,5,2021-12-01
142d147c68705020a4ae0b3107b3ef1a5f848a9ff4691410ec6f5f5e13f5fdd3,14,10,2021-12-01
a642d904ccd79e3ab45919a8086c1497c9c947f5005f074e80a6c542fb0471b6,10,5,2021-12-01
f550c8469597b937ff89c31b3f6c473f7e42b6a4f9f798537ed1e1d315aa43df,13,5,2021-12-01
6114f0af5e8c094e901fbace950229826c8a8dade1c2cbcf967fb3d7068ec01b,23,5,2021-12-01
d4ef2e450055a78e5f2a20a92a9fd5acce2dcf9b33860ce8839c8fdc89e8d4d2,5,11,2021-12-01
dfedd28af34146e2474e5c8ae59c49df23d53c1ee09dedd5a975dc25f08008ea,6,20,2021-12-01
894608ee2cf6a8bb1ca321751c6eccec17ef62c5b9863c6f9937a74370e7a321,101,7,2021-12-01
1d8a348244576a7905c9a646c94d4c84cc38d48632ac174b31f7abfa5f985973,19,11,2021-12-01
5576083d4604bac813d42aaff31503de4a7f8b9330b3c6b328fdd476d21714bd,5,20,2021-12-01
c5f596715bf3832948b453cc814ab1726a8fc1718e82191c5b1d6c4dbdfe9688,63,101,2021-12-01
eb99472a56c5172380123084ad46cc529769c12678c14e509935b322df4a8cc2,20,200,2021-12-01
53ed38f3b58f2c991737b3fcfec2dc2c1465f38744bc56e9aabdfa65d6fa45a3,48,5,2021-12-01
ca1d471bd91416f7462ac7e9144bf8d6d8e2d7763d6ec76d6bb8241fd1677ac0,5,5,2021-12-01
48113e0a957960ad4dea69502719af75e9c767a9eea8897795b8c78fb5d6e978,269,6,2021-12-01
65fc3012658253b3af9a9cc800290c41fa561d55049c7314fa8c04cd51dee8e7,9,7,2021-12-01
a4cc2ddc73b084692f410250bf2f80b2bb3839e8d121d48259b03a24490a1730,15,7,2021-12-01
f18b6bdbacc45ce45ab7f4a4a7ccfd9023513e6bf8507e89f68b963d3a271a60,6,12,2021-12-01
0b210110c89a55ee12ccf7e17f1fac1c1d816b0e45efdc9408dc01e49d83f011,6,10,2021-12-01
9be7e3642ae06259ce0579eb7bf8a0a4a8bc37c586e3c42862e303f67a3808d2,7,14,2021-12-01
d32e24c4581ca518aab14fee69b8353c9957732fbe8ec421eb49171e80e3724a,5,7,2021-12-01
aa16648940c8a35102c239281589c84867a907fb606cd62d340221e3b85ec920,5,27,2021-12-01
030dbacca11b1b8fa254b824887fac52b861a948f4ab58153040251eb41f0844,6,134,2021-12-01
b4e6bfe8b8de01c8382c21159e6d440416484a114a23473ca0bf6aa5320c8e97,66,5,2021-12-01
f49696a2782627167748d4a031ddd4c466e25fc1bea5c832d69b7d39daf791cf,5,5,2021-12-01
7f6226104e8b1ffc8a5f8178c57e52254bc16525e0c5d27e1407a8a71a45188f,5,5,2021-12-01
902628702f60a13b360914dbdc97ddca19d134f07945f41a9e11a71868aa306b,8,9,2021-12-01
2c43a81e302f9a3a0f4d85ddddd304428fdefe9b8039f09d8e34df0193f09421,6,19,2021-12-01
345d5a69ec7a03f47725891cc45e759cbb90f3ecbbda404d5987ceadf126f1ea,101,5,2021-12-01
00723d46a77b03f1350a927fae449855f59c4265e5b0e96f242a571a589432d5,5,6,2021-12-01
b9d97b02dac51d364b0ef9df9da9edafef784bf2466667498f337dff62409f30,6,7,2021-12-01
7967187fc9219745e2e881cda5e68f31cbbb5f7f0b30bbf8609643011d807d50,10,21,2021-12-01
7a5a781e109cefbcd625a59a9921b9aed5e24ce7fb7db5be4dc2e1e0d7b4aef3,42,23,2021-12-01
e5c92af61fa050d6975765d3ac0cae67213ec7f30d88190b9febeabf2a9c5978,89,47,2021-12-01
887872e43752a023f30ec17e333cb793dce622e4b2cc22d8072e723c3bc17b18,5,5,2021-12-01
5c5c84691f342e7629afca5e2c8359fa3cc05354701ab376139d8488a7629816,8,8,2021-12-01
9ff3da4ab77ceebba67abf6139e2d8b023e5aa4d31252f5718596b0f235421f8,10,8,2021-12-01
3665a11377cc66a7ae3722a436a528a190d74dd83d7dea52e19468b651e7d55d,8,10,2021-12-01
b080e6fe2c

2025-01-24 08:20:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:20:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:20:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:20:49 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 08:20:49 - snowflake.connector.connection - INFO - closed
2025-01-24 08:20:49 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:20:49 - root - INFO - SQL:
SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
          SUM("output_value") AS "Total_Volume"
   FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
   WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
     AND "is_coinbase" = false
   GROUP BY "Month"
   ORDER BY "Month"
   LIMIT 100;
Results:
Month,Total_Volume
12,73208621149507.000000000

2025-01-24 08:20:49 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:20:49 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:20:49 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:20:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 08:20:50 - snowflake.connector.connection - INFO - closed
2025-01-24 08:20:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:20:51 - root - INFO - SQL:
SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
          SUM("output_value") AS "CoinJoin_Volume"
   FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
   WHERE "input_count" >= 5 AND "output_count" >= 5
     AND "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
     AND "is_coinbase" = false
   GROUP BY "Month"
   ORDER BY "Month"
   LIMIT 100;
Results:
Month,CoinJoin_Volume
12,128296606152.000000000

2025-01-24 08:20:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:20:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:20:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:20:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 08:20:52 - snowflake.connector.connection - INFO - closed
2025-01-24 08:20:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:20:53 - root - INFO - SQL:
SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
          COUNT(*) AS "CoinJoin_Transactions"
   FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
   WHERE "input_count" >= 5 AND "output_count" >= 5
     AND "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
     AND "is_coinbase" = false
   GROUP BY "Month"
   ORDER BY "Month"
   LIMIT 100;
Results:
Month,CoinJoin_Transactions
12,293

2025-01-24 08:20:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:20:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:20:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:20:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 08:20:54 - snowflake.connector.connection - INFO - closed
2025-01-24 08:20:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:20:55 - root - INFO - SQL:
SELECT t1."Month",
          (t2."CoinJoin_Transactions" / t1."Total_Transactions") * 100 AS "Percentage_CoinJoin_Transactions"
   FROM (
     SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
            COUNT(*) AS "Total_Transactions"
     FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
     WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
       AND "is_coinbase" = false
     GROUP BY "Month"
   ) t1
   JOIN (
     SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
            COUNT(*) AS "CoinJoin_Transactions"
     FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
     WHERE "input_count" >= 5 AND "output_count" >= 5
       AND "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
       AND "is_coinbase" = false
     GROUP BY "Month"
   ) t2
   ON t1."Month" = t2."Month"
   ORDER BY t1."Month"
   LIMIT 100;
Results:
Month,Percentage_CoinJoin_Transactions
12,0.701800

2025-01-24 08:20:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:20:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:20:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:20:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 08:20:56 - snowflake.connector.connection - INFO - closed
2025-01-24 08:20:56 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:20:56 - root - INFO - SQL:
SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
          AVG("input_count"::FLOAT / NULLIF("output_count", 0)) AS "Avg_Input_Output_Ratio"
   FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
   WHERE "input_count" >= 5 AND "output_count" >= 5
     AND "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
     AND "is_coinbase" = false
   GROUP BY "Month"
   ORDER BY "Month"
   LIMIT 100;
Results:
Month,Avg_Input_Output_Ratio
12,2.6723575232638446

2025-01-24 08:20:56 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:20:56 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:20:56 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:20:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-24 08:20:58 - snowflake.connector.connection - INFO - closed
2025-01-24 08:20:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:21:27 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 08:21:27 - root - INFO - ```sql
SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
       AVG("input_count"::FLOAT / NULLIF("output_count", 0)) AS "Avg_Input_Output_Ratio"
FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
  AND "is_coinbase" = false
GROUP BY "Month"
ORDER BY "Month"
LIMIT 100;
```
2025-01-24 08:21:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:21:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:21:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:21:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 08:21:29 - snowflake.connector.connection - INFO - closed
2025-01-24 08:21:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:22:42 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 08:22:42 - root - INFO - SQL:
SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
       AVG("input_count"::FLOAT / NULLIF("output_count", 0)) AS "Avg_Input_Output_Ratio"
FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
  AND "is_coinbase" = false
GROUP BY "Month"
ORDER BY "Month"
LIMIT 100;
Results:
Month,Avg_Input_Output_Ratio
12,2.076715608196059

2025-01-24 08:22:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:22:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:22:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:22:43 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 08:22:43 - snowflake.connector.connection - INFO - closed
2025-01-24 08:22:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:22:44 - root - INFO - SQL:
SELECT t1."Month",
       (COALESCE(t2."CoinJoin_Transactions", 0) / t1."Total_Transactions") * 100 AS "Percentage_CoinJoin_Transactions"
FROM (
  SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
         COUNT(*)::FLOAT AS "Total_Transactions"
  FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
  WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
    AND "is_coinbase" = false
  GROUP BY "Month"
) t1
LEFT JOIN (
  SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
         COUNT(*)::FLOAT AS "CoinJoin_Transactions"
  FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
  WHERE "input_count" >= 2 AND "output_count" >= 2
    AND "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
    AND "is_coinbase" = false
  GROUP BY "Month"
) t2
ON t1."Month" = t2."Month"
ORDER BY t1."Month"
LIMIT 100
Results:
Month,Percentage_CoinJoin_Transactions
12,17.019187007449638

2025-01-24 08:22:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:22:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:22:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:22:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-24 08:22:45 - snowflake.connector.connection - INFO - closed
2025-01-24 08:22:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:23:26 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 08:23:26 - root - INFO - ```sql
SELECT t1."Month",
       (COALESCE(t2."CoinJoin_Transactions", 0) / NULLIF(t1."Total_Transactions", 0)) * 100 AS "Percentage_CoinJoin_Transactions"
FROM (
  SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
         COUNT(*)::FLOAT AS "Total_Transactions"
  FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
  WHERE "block_timestamp_month" BETWEEN '2021-01-01' AND '2021-12-31'
  GROUP BY "Month"
) t1
LEFT JOIN (
  SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
         COUNT(*)::FLOAT AS "CoinJoin_Transactions"
  FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
  WHERE "input_count" >= 1 AND "output_count" >= 1
    AND "block_timestamp_month" BETWEEN '2021-01-01' AND '2021-12-31'
  GROUP BY "Month"
) t2
ON t1."Month" = t2."Month"
ORDER BY t1."Month"
LIMIT 100;
```
2025-01-24 08:23:26 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:23:26 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:23:26 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:23:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 08:23:28 - snowflake.connector.connection - INFO - closed
2025-01-24 08:23:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:24:01 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 08:24:01 - root - INFO - SQL:
SELECT t1."Month",
       (COALESCE(t2."CoinJoin_Transactions", 0) / NULLIF(t1."Total_Transactions", 0)) * 100 AS "Percentage_CoinJoin_Transactions"
FROM (
  SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
         COUNT(*)::FLOAT AS "Total_Transactions"
  FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
  WHERE "block_timestamp_month" BETWEEN '2021-01-01' AND '2021-12-31'
  GROUP BY "Month"
) t1
LEFT JOIN (
  SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
         COUNT(*)::FLOAT AS "CoinJoin_Transactions"
  FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
  WHERE "input_count" >= 1 AND "output_count" >= 1
    AND "block_timestamp_month" BETWEEN '2021-01-01' AND '2021-12-31'
  GROUP BY "Month"
) t2
ON t1."Month" = t2."Month"
ORDER BY t1."Month"
LIMIT 100;
Results:
Month,Percentage_CoinJoin_Transactions
12,99.96408217997222

2025-01-24 08:24:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:24:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:24:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:24:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 08:24:02 - snowflake.connector.connection - INFO - closed
2025-01-24 08:24:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:24:03 - root - INFO - SQL:
SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
       SUM("output_value") AS "CoinJoin_Volume"
FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
WHERE "input_count" >= 1 AND "output_count" >= 1
  AND "block_timestamp_month" BETWEEN '2021-01-01' AND '2021-12-31'
GROUP BY "Month"
ORDER BY "Month"
LIMIT 100
Results:
Month,CoinJoin_Volume
12,73208621149507.000000000

2025-01-24 08:24:03 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:24:03 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:24:03 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:24:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 08:24:04 - snowflake.connector.connection - INFO - closed
2025-01-24 08:24:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:24:04 - root - INFO - SQL:
SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
       COUNT(*) AS "CoinJoin_Transactions"
FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
WHERE "input_count" >= 1 AND "output_count" >= 1
  AND "block_timestamp_month" BETWEEN '2021-01-01' AND '2021-12-31'
GROUP BY "Month"
ORDER BY "Month"
LIMIT 100
Results:
Month,CoinJoin_Transactions
12,41747

2025-01-24 08:24:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:24:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:24:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:24:06 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-24 08:24:06 - snowflake.connector.connection - INFO - closed
2025-01-24 08:24:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:24:06 - root - INFO - SQL:
SELECT "hash", "input_count", "output_count", "block_timestamp_month"
FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
WHERE "input_count" >= 1 AND "output_count" >= 1
  AND "block_timestamp_month" BETWEEN '2021-01-01' AND '2021-12-31'
LIMIT 100
Results:
Too long, hard cut:
hash,input_count,output_count,block_timestamp_month
2eae767c800d84e6a36d274f807533793069df812f261029013c9b297e48be34,2,2,2021-12-01
cbf98be5200cc71e99a8a32901fba42e8e9c56561228e74072781ef339d1b78d,7,2,2021-12-01
1d4f342a4f3f66d26dd0bb06b8bf9b9788c6d2ab185c689b2bdd65dbfcb7e621,2,2,2021-12-01
03ef6e1815ffbc34c3874621351fe4f3b37e6f03508e382b72aed59981eabe0b,3,2,2021-12-01
b07dcb84531b85bd85f2e41f815cf4fe324ae66ac7e69b3a62e6afa75663abaa,2,2,2021-12-01
fe53b191d9c9e2e1e9242db917eae59cfc38096f7dd9c8b01e871844ec531209,2,2,2021-12-01
cf4eba62a46b9e2afbe1c601180a2e374dce592546554af8b0e1a5af7b6f54b0,2,2,2021-12-01
7ea60bb9180879eb842d4ae31bb01c806a00f21e0714e2f4f818e53e3eda93ed,2,2,2021-12-01
fa7f88f7ebe0cc6604b9955ee66444919ba8a92b072726b0cc76651f9e3beea4,2,2,2021-12-01
a1a3e9c9f782279f2a2a0db83323ec300bede692fd79a94bd739e8094f8e8879,2,2,2021-12-01
43a316a543b39c0ee89eb2c8ff8594c74d4e1e9629b6132a1c7500d5ef39dbb9,2,2,2021-12-01
8c320cf1f7e51e955965b209b1538c1f33cfa95481978dcaa87fbdc7340e3ade,2,2,2021-12-01
634c789bf2f180951d4392b4f556f3dd55f6d6e9309a7ea32949cb36df421843,2,2,2021-12-01
66ea0ab60597a20ab4f5ea659d6f468eef0ac123d9b6137952430cd3743d4235,2,2,2021-12-01
54f3cb179e3738a1227552ec458d6ae0bc3b6fecdd64d7cef0263aa3ffb3c721,2,2,2021-12-01
424bd24cb529ac5da2702ca1925a360d4df57eba7b47329fa490d0627d713992,2,2,2021-12-01
c4324fee2507e9ba113e1175cadf4f2ccc7e2dd5ef2850049039fd6d93e3a33b,2,2,2021-12-01
9d46944ce1fcae5bd8fd04201d850030d5c17f9b091c74c7d5c49144fa9824fb,2,2,2021-12-01
eb1fcf69744b3dd6ad4cf31f6cf2dcb65783186b768b2ac6d15f3f84c5d2cd6f,2,2,2021-12-01
54f79507af188380f5787bf21a0a036f6fdeae8ad6fe947ca614e935550ed959,2,2,2021-12-01
87b2299d8c1c7c9c141eae37e57921026e2a5bb65d65c42e9064161eb1b97b83,2,2,2021-12-01
fef37197f4e8e3de766e74af80ff275717c74b8562413051c5c13f2af6ffd64c,2,2,2021-12-01
8e88e957958fd0aadd507df06e37bddd6101083faa4a4aa10a1c1e5afb0768f9,2,2,2021-12-01
ef79b20104aef98f10648c8764ccdca5b8a57f910a5d7b631ad89ec222ab23f6,2,2,2021-12-01
7cf42b8b30b497c4be098e6555bfa150323ba599e7ea922ada88ea004cfac0e0,2,2,2021-12-01
83bf8801d8384404237c0e8f2fed9d1120e788dac1c70e78ab696b8f61df6401,2,2,2021-12-01
cd7943d95465fb2e96a2e6acedc37e18c41e79d655a64d1c200e2c960c44878f,2,2,2021-12-01
8cd86a1d347a8ff5a29b52d212e235382c14962edae05d15c58a73ccfb6da22c,2,2,2021-12-01
c9d450614a9cf61e7d3fb0438263f202d2f6f108bc82bc8235d5c460688f4598,2,2,2021-12-01
47dcdaf1858337bb692ab017fb80d1aa9943290ae32e349d0207dc4cfd430752,2,2,2021-12-01
4521cdf5647adeb65da05fe0b2fba5ccd32c7d721f65fb858b9e28235cd9532c,2,2,2021-12-01
162ad96a4033b0b53b2dcc959d50f325e71a06f00cd26e5195ef7cd0aa3808dd,2,2,2021-12-01
64273f9516aadf400111cd0a84372164714117360af820b49dbad33d5bdc0294,2,2,2021-12-01
fc5963bcb4fc6969d5f8f9307d0ab1afa71d2ba7292602c55a33c11d4d6a0a88,2,2,2021-12-01
b64d4155bec5da2b10b0be1ad0ae7f7f1b4989723e71da586e782e2ac65fb049,2,2,2021-12-01
7aad057a3b38c2d5d2fd7c7c2c96f07636da93f4117852075e6bc6cd58473366,2,2,2021-12-01
f92f6355a49c828282d3b2df056bf19e6f7619a7398c496deb1717db1c86694c,2,2,2021-12-01
fa0a989fda992d92982b8dd74475c7b7212457ff40f40e05f12d6a4fcd0c97c8,2,2,2021-12-01
07da46d20fec1bd70c294aa9185b5b927d2c78dbd922459f3149e8d7970451b9,2,2,2021-12-01
9cc7371757fd4f615a3351199ec4dd592ffd8534c3c5cd574eb4e936a55d2d4a,2,2,2021-12-01
72cfc563aafe70ba4cc10694a6f3de81125d9441fbff6a0a554b0ebf91ae8e13,2,2,2021-12-01
537eaa2d67ad69f5ff401194ba93a5e5b875162e4b1b26fd16ddc614495ee415,2,2,2021-12-01
45e0574392eb7b72d384380f5e9a231688049730fef1d5934dc7b5b03425ddfb,2,2,2021-12-01
79a7d4e070ffc9cbf7fafc25c094d96ad2853b4b4755e4e23bf0024d1aecc7c0,2,2,2021-12-01
1971d77d7d83257d9775fd92b7ee166a31b816f71963157fa0caebcc2768e931,2,2,2021-12-01
60f82a228e50091e807ae8563f0ebd49991974c514731c585111d6b1e8d83343,2,2,2021-12-01
b64b99b930b5764e915dfc2e04df32e82203a7cacabfc48eaa2f0a5c6404754d,2,2,2021-12-01
f619857c6e4e7035f6dabcd9dc1dd3ec27a6827aa8165b4c2d2a52b476c7f3ec,2,2,2021-12-01
c3fd39643986f30908b43482af3587ba792e695fac5cd6cd57a35a082de5029f,2,2,2021-12-01
77e418dd747564322d155bc26750193806b5564b5dc59d6a5a15e05ae9631b77,3,2,2021-12-01
d1632a778d828aa89e2b489f5af2b7b8b875761e9fbd61cc12d1136965db0174,3,2,2021-12-01
3c5242a9ddec1774ca13b4592b6b28344defc0f23426b11fd9ef216b031945ee,3,2,2021-12-01
a508fdb381e3bf79b348e8297dece758be73927b81e428b8d99651e54948c2b7,3,2,2021-12-01
a303d13304eb4ab056281da8b1a6ecb69ab5a4b484ea944b7175eb0f9065116a,3,2,2021-12-01
7911c23f910d8bc53ccbdb9507faf3dace649a29b80f69ebf9bf289d6ee540d9,3,2,2021-12-01
b0dcca18ae2c03d6a0f4be3b2210025a0d17ef527ef81f0e3cc9c372a462607c,3,2,2021-12-01
b02efa8a62f508dc14023e4c5dbb4e4f48a87eb095db12da71db1574dd04fa50,3,2,2021-12-01
09723c07ff3b963e6f8b2ccc44e16bdee11d39f8ef236b7467783609bdd4f4ac,3,2,2021-12-01
3a8932f793ceb909e12181883b598c717030ce7e28945f32325bace35eb56b3e,3,2,2021-12-01
bf066af68951c2b8b6effb22c18a691558eaf54566060845fe34dfe2b49f5c31,6,2,2021-12-01
ff89f9985e148011e986e42c8c722d42afc511b2185866f5c8517624c05a3948,4,2,2021-12-01
a75330fbdda126827eff3e99890f82ae1f80cbde171e680810818160b24508a7,4,2

2025-01-24 08:24:06 - root - INFO - itercount: 0
2025-01-24 08:24:06 - root - INFO - Database Name: CRYPTO
Schema Name: CRYPTO_BAND
DDL describes table information.
,0
table_name,BLOCKS
description,
DDL,"create or replace TABLE BLOCKS (
	""block_height"" NUMBER(38,0),
	""block_timestamp"" VARCHAR(16777216),
	""block_timestamp_truncated"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216),
	""proposer_address"" VARCHAR(16777216),
	""last_commit_hash"" VARCHAR(16777216),
	""data_hash"" VARCHAR(16777216),
	""validators_hash"" VARCHAR(16777216),
	""next_validators_hash"" VARCHAR(16777216),
	""consensus_hash"" VARCHAR(16777216),
	""app_hash"" VARCHAR(16777216),
	""last_results_hash"" VARCHAR(16777216),
	""evidence_hash"" VARCHAR(16777216),
	""signatures"" VARIANT
);"

,1
table_name,ORACLE_REQUESTS
description,
DDL,"create or replace TABLE ORACLE_REQUESTS (
	""block_height"" NUMBER(38,0),
	""block_timestamp"" VARCHAR(16777216),
	""block_timestamp_truncated"" NUMBER(38,0),
	""oracle_request_id"" NUMBER(38,0),
	""request"" VARIANT,
	""reports"" VARIANT,
	""result"" VARIANT,
	""decoded_result"" VARIANT,
	""oracle_script"" VARIANT
);"

,2
table_name,ERRORS
description,
DDL,"create or replace TABLE ERRORS (
	""tableRow"" VARCHAR(16777216),
	""errors"" VARCHAR(16777216)
);"

,3
table_name,LOGS
description,
DDL,"create or replace TABLE LOGS (
	""block_height"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""block_timestamp_truncated"" NUMBER(38,0),
	""txhash"" VARCHAR(16777216),
	""log_index"" NUMBER(38,0),
	""msg_index"" NUMBER(38,0),
	""log"" VARCHAR(16777216),
	""events"" VARIANT
);"

,4
table_name,MESSAGES
description,
DDL,"create or replace TABLE MESSAGES (
	""block_height"" NUMBER(38,0),
	""block_timestamp"" VARCHAR(16777216),
	""block_timestamp_truncated"" NUMBER(38,0),
	""txhash"" VARCHAR(16777216),
	""message_type"" VARCHAR(16777216),
	""oracle_Activate"" VARIANT,
	""oracle_AddReporter"" VARIANT,
	""oracle_CreateDataSource"" VARIANT,
	""oracle_CreateOracleScript"" VARIANT,
	""oracle_EditDataSource"" VARIANT,
	""oracle_EditOracleScript"" VARIANT,
	""oracle_Report"" VARIANT,
	""oracle_Request"" VARIANT,
	""cosmos_sdk_MsgDelegate"" VARIANT,
	""cosmos_sdk_MsgEditValidator"" VARIANT,
	""cosmos_sdk_MsgMultiSend"" VARIANT,
	""cosmos_sdk_MsgSend"" VARIANT,
	""oracle_RemoveReporter"" VARIANT,
	""cosmos_sdk_MsgBeginRedelegate"" VARIANT,
	""cosmos_sdk_MsgCreateValidator"" VARIANT,
	""cosmos_sdk_MsgDeposit"" VARIANT,
	""cosmos_sdk_MsgFundCommunityPool"" VARIANT,
	""cosmos_sdk_MsgModifyWithdrawAddress"" VARIANT,
	""cosmos_sdk_MsgSubmitEvidence"" VARIANT,
	""cosmos_sdk_MsgSubmitProposal"" VARIANT,
	""cosmos_sdk_MsgUndelegate"" VARIANT,
	""cosmos_sdk_MsgUnjail"" VARIANT,
	""cosmos_sdk_MsgVerifyInvariant"" VARIANT,
	""cosmos_sdk_MsgVote"" VARIANT,
	""cosmos_sdk_MsgWithdrawDelegationReward"" VARIANT,
	""cosmos_sdk_MsgWithdrawValidatorCommission"" VARIANT
);"

,5
table_name,BLOCK_EVENTS
description,
DDL,"create or replace TABLE BLOCK_EVENTS (
	""block_height"" NUMBER(38,0),
	""block_timestamp"" VARCHAR(16777216),
	""block_timestamp_truncated"" NUMBER(38,0),
	""event_type"" VARCHAR(16777216),
	""block_event_type"" VARCHAR(16777216),
	""attributes"" VARIANT
);"

,6
table_name,TRANSACTIONS
description,
DDL,"create or replace TABLE TRANSACTIONS (
	""block_height"" NUMBER(38,0),
	""block_timestamp"" VARCHAR(16777216),
	""block_timestamp_truncated"" NUMBER(38,0),
	""txhash"" VARCHAR(16777216),
	""transaction_type"" VARCHAR(16777216),
	""gas_wanted"" NUMBER(38,9),
	""gas_used"" NUMBER(38,9),
	""sender"" VARCHAR(16777216),
	""fee"" VARIANT,
	""memo"" VARCHAR(16777216)
);"

Database Name: CRYPTO
Schema Name: CRYPTO_BITCOIN
DDL describes table information.
,0
table_name,OUTPUTS
description,
DDL,"create or replace TABLE OUTPUTS (
	""transaction_hash"" VARCHAR(16777216),
	""block_hash"" VARCHAR(16777216),
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""index"" NUMBER(38,0),
	""script_asm"" VARCHAR(16777216),
	""script_hex"" VARCHAR(16777216),
	""required_signatures"" NUMBER(38,0),
	""type"" VARCHAR(16777216),
	""addresses"" VARIANT,
	""value"" NUMBER(38,9)
);"

,1
table_name,INPUTS
description,
DDL,"create or replace TABLE INPUTS (
	""transaction_hash"" VARCHAR(16777216),
	""block_hash"" VARCHAR(16777216),
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""index"" NUMBER(38,0),
	""spent_transaction_hash"" VARCHAR(16777216),
	""spent_output_index"" NUMBER(38,0),
	""script_asm"" VARCHAR(16777216),
	""script_hex"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0),
	""required_signatures"" NUMBER(38,0),
	""type"" VARCHAR(16777216),
	""addresses"" VARIANT,
	""value"" NUMBER(38,9)
);"

,2
table_name,BLOCKS
description,
DDL,"create or replace TABLE BLOCKS (
	""hash"" VARCHAR(16777216),
	""size"" NUMBER(38,0),
	""stripped_size"" NUMBER(38,0),
	""weight"" NUMBER(38,0),
	""number"" NUMBER(38,0),
	""version"" NUMBER(38,0),
	""merkle_root"" VARCHAR(16777216),
	""timestamp"" NUMBER(38,0),
	""timestamp_month"" DATE,
	""nonce"" VARCHAR(16777216),
	""bits"" VARCHAR(16777216),
	""coinbase_param"" VARCHAR(16777216),
	""transaction_count"" NUMBER(38,0)
);"

,3
table_name,TRANSACTIONS
description,
DDL,"create or replace TABLE TRANSACTIONS (
	""hash"" VARCHAR(16777216),
	""size"" NUMBER(38,0),
	""virtual_size"" NUMBER(38,0),
	""version"" NUMBER(38,0),
	""lock_time"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216),
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""block_timestamp_month"" DATE,
	""input_count"" NUMBER(38,0),
	""output_count"" NUMBER(38,0),
	""input_value"" NUMBER(38,9),
	""output_value"" NUMBER(38,9),
	""is_coinbase"" BOOLEAN,
	""fee"" NUMBER(38,9),
	""inputs"" VARIANT,
	""outputs"" VARIANT
);"

Database Name: CRYPTO
Schema Name: CRYPTO_BITCOIN_CASH
DDL describes table information.
,0
table_name,OUTPUTS
description,
DDL,"create or replace TABLE OUTPUTS (
	""transaction_hash"" VARCHAR(16777216),
	""block_hash"" VARCHAR(16777216),
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""index"" NUMBER(38,0),
	""script_asm"" VARCHAR(16777216),
	""script_hex"" VARCHAR(16777216),
	""required_signatures"" NUMBER(38,0),
	""type"" VARCHAR(16777216),
	""addresses"" VARIANT,
	""value"" NUMBER(38,9)
);"

,1
table_name,BLOCKS
description,
DDL,"create or replace TABLE BLOCKS (
	""hash"" VARCHAR(16777216),
	""size"" NUMBER(38,0),
	""stripped_size"" NUMBER(38,0),
	""weight"" NUMBER(38,0),
	""number"" NUMBER(38,0),
	""version"" NUMBER(38,0),
	""merkle_root"" VARCHAR(16777216),
	""timestamp"" NUMBER(38,0),
	""timestamp_month"" DATE,
	""nonce"" VARCHAR(16777216),
	""bits"" VARCHAR(16777216),
	""coinbase_param"" VARCHAR(16777216),
	""transaction_count"" NUMBER(38,0)
);"

,2
table_name,INPUTS
description,
DDL,"create or replace TABLE INPUTS (
	""transaction_hash"" VARCHAR(16777216),
	""block_hash"" VARCHAR(16777216),
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""index"" NUMBER(38,0),
	""spent_transaction_hash"" VARCHAR(16777216),
	""spent_output_index"" NUMBER(38,0),
	""script_asm"" VARCHAR(16777216),
	""script_hex"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0),
	""required_signatures"" NUMBER(38,0),
	""type"" VARCHAR(16777216),
	""addresses"" VARIANT,
	""value"" NUMBER(38,9)
);"

,3
table_name,TRANSACTIONS
description,
DDL,"create or replace TABLE TRANSACTIONS (
	""hash"" VARCHAR(16777216),
	""size"" NUMBER(38,0),
	""virtual_size"" NUMBER(38,0),
	""version"" NUMBER(38,0),
	""lock_time"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216),
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""block_timestamp_month"" DATE,
	""input_count"" NUMBER(38,0),
	""output_count"" NUMBER(38,0),
	""input_value"" NUMBER(38,9),
	""output_value"" NUMBER(38,9),
	""is_coinbase"" BOOLEAN,
	""fee"" NUMBER(38,9),
	""inputs"" VARIANT,
	""outputs"" VARIANT
);"

Database Name: CRYPTO
Schema Name: CRYPTO_DASH
DDL describes table information.
,0
table_name,INPUTS
description,
DDL,"create or replace TABLE INPUTS (
	""transaction_hash"" VARCHAR(16777216),
	""block_hash"" VARCHAR(16777216),
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""index"" NUMBER(38,0),
	""spent_transaction_hash"" VARCHAR(16777216),
	""spent_output_index"" NUMBER(38,0),
	""script_asm"" VARCHAR(16777216),
	""script_hex"" VARCHAR(16777216),
	""sequence"" NUMBER(38,0),
	""required_signatures"" NUMBER(38,0),
	""type"" VARCHAR(16777216),
	""addresses"" VARIANT,
	""value"" NUMBER(38,9)
);"

,1
table_name,TRANSACTIONS
description,
DDL,"create or replace TABLE TRANSACTIONS (
	""hash"" VARCHAR(16777216),
	""size"" NUMBER(38,0),
	""virtual_size"" NUMBER(38,0),
	""version"" NUMBER(38,0),
	""lock_time"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216),
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""block_timestamp_month"" DATE,
	""input_count"" NUMBER(38,0),
	""output_count"" NUMBER(38,0),
	""input_value"" NUMBER(38,9),
	""output_value"" NUMBER(38,9),
	""is_coinbase"" BOOLEAN,
	""fee"" NUMBER(38,9),
	""inputs"" VARIANT,
	""outputs"" VARIANT
);"

,2
table_name,BLOCKS
description,
DDL,"create or replace TABLE BLOCKS (
	""hash"" VARCHAR(16777216),
	""size"" NUMBER(38,0),
	""stripped_size"" NUMBER(38,0),
	""weight"" NUMBER(38,0),
	""number"" NUMBER(38,0),
	""version"" NUMBER(38,0),
	""merkle_root"" VARCHAR(16777216),
	""timestamp"" NUMBER(38,0),
	""timestamp_month"" DATE,
	""nonce"" VARCHAR(16777216),
	""bits"" VARCHAR(16777216),
	""coinbase_param"" VARCHAR(16777216),
	""transaction_count"" NUMBER(38,0)
);"

,3
table_name,OUTPUTS
description,
DDL,"create or replace TABLE OUTPUTS (
	""transaction_hash"" VARCHAR(16777216),
	""block_hash"" VARCHAR(16777216),
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""index"" NUMBER(38,0),
	""script_asm"" VARCHAR(16777216),
	""script_hex"" VARCHAR(16777216),
	""required_signatures"" NUMBER(38,0),
	""type"" VARCHAR(16777216),
	""addresses"" VARIANT,
	""value"" NUMBER(38,9)
);"

Database Name: CRYPTO
Schema Name: CRYPTO_ETHEREUM
DDL describes table information.
,0
table_name,BLOCKS
description,
DDL,"create or replace TABLE BLOCKS (
	""timestamp"" NUMBER(38,0),
	""number"" NUMBER(38,0),
	""hash"" VARCHAR(16777216),
	""parent_hash"" VARCHAR(16777216),
	""nonce"" VARCHAR(16777216),
	""sha3_uncles"" VARCHAR(16777216),
	""logs_bloom"" VARCHAR(16777216),
	""transactions_root"" VARCHAR(16777216),
	""state_root"" VARCHAR(16777216),
	""receipts_root"" VARCHAR(16777216),
	""miner"" VARCHAR(16777216),
	""difficulty"" NUMBER(38,9),
	""total_difficulty"" NUMBER(38,9),
	""size"" NUMBER(38,0),
	""extra_data"" VARCHAR(16777216),
	""gas_limit"" NUMBER(38,0),
	""gas_used"" NUMBER(38,0),
	""transaction_count"" NUMBER(38,0),
	""base_fee_per_gas"" NUMBER(38,0),
	""withdrawals_root"" VARCHAR(16777216),
	""withdrawals"" VARIANT,
	""blob_gas_used"" NUMBER(38,0),
	""excess_blob_gas"" NUMBER(38,0)
);"

,1
table_name,LOGS
description,
DDL,"create or replace TABLE LOGS (
	""log_index"" NUMBER(38,0),
	""transaction_hash"" VARCHAR(16777216),
	""transaction_index"" NUMBER(38,0),
	""address"" VARCHAR(16777216),
	""data"" VARCHAR(16777216),
	""topics"" VARIANT,
	""block_timestamp"" NUMBER(38,0),
	""block_number"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216)
);"

,2
table_name,TRACES
description,
DDL,"create or replace TABLE TRACES (
	""transaction_hash"" VARCHAR(16777216),
	""transaction_index"" NUMBER(38,0),
	""from_address"" VARCHAR(16777216),
	""to_address"" VARCHAR(16777216),
	""value"" NUMBER(38,9),
	""input"" VARCHAR(16777216),
	""output"" VARCHAR(16777216),
	""trace_type"" VARCHAR(16777216),
	""call_type"" VARCHAR(16777216),
	""reward_type"" VARCHAR(16777216),
	""gas"" NUMBER(38,0),
	""gas_used"" NUMBER(38,0),
	""subtraces"" NUMBER(38,0),
	""trace_address"" VARCHAR(16777216),
	""error"" VARCHAR(16777216),
	""status"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""block_number"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216),
	""trace_id"" VARCHAR(16777216)
);"

,3
table_name,TRANSACTIONS
description,
DDL,"create or replace TABLE TRANSACTIONS (
	""hash"" VARCHAR(16777216),
	""nonce"" NUMBER(38,0),
	""transaction_index"" NUMBER(38,0),
	""from_address"" VARCHAR(16777216),
	""to_address"" VARCHAR(16777216),
	""value"" NUMBER(38,9),
	""gas"" NUMBER(38,0),
	""gas_price"" NUMBER(38,0),
	""input"" VARCHAR(16777216),
	""receipt_cumulative_gas_used"" NUMBER(38,0),
	""receipt_gas_used"" NUMBER(38,0),
	""receipt_contract_address"" VARCHAR(16777216),
	""receipt_root"" VARCHAR(16777216),
	""receipt_status"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""block_number"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216),
	""max_fee_per_gas"" NUMBER(38,0),
	""max_priority_fee_per_gas"" NUMBER(38,0),
	""transaction_type"" NUMBER(38,0),
	""receipt_effective_gas_price"" NUMBER(38,0),
	""max_fee_per_blob_gas"" NUMBER(38,0),
	""blob_versioned_hashes"" VARIANT,
	""receipt_blob_gas_price"" NUMBER(38,0),
	""receipt_blob_gas_used"" NUMBER(38,0)
);"

,4
table_name,CONTRACTS
description,
DDL,"create or replace TABLE CONTRACTS (
	""address"" VARCHAR(16777216),
	""bytecode"" VARCHAR(16777216),
	""function_sighashes"" VARIANT,
	""is_erc20"" BOOLEAN,
	""is_erc721"" BOOLEAN,
	""block_timestamp"" NUMBER(38,0),
	""block_number"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216)
);"

,5
table_name,TOKEN_TRANSFERS
description,
DDL,"create or replace TABLE TOKEN_TRANSFERS (
	""token_address"" VARCHAR(16777216),
	""from_address"" VARCHAR(16777216),
	""to_address"" VARCHAR(16777216),
	""value"" VARCHAR(16777216),
	""transaction_hash"" VARCHAR(16777216),
	""log_index"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""block_number"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216)
);"

Database Name: CRYPTO
Schema Name: CRYPTO_ETHEREUM_CLASSIC
DDL describes table information.
,0
table_name,BLOCKS
description,
DDL,"create or replace TABLE BLOCKS (
	""timestamp"" NUMBER(38,0),
	""number"" NUMBER(38,0),
	""hash"" VARCHAR(16777216),
	""parent_hash"" VARCHAR(16777216),
	""nonce"" VARCHAR(16777216),
	""sha3_uncles"" VARCHAR(16777216),
	""logs_bloom"" VARCHAR(16777216),
	""transactions_root"" VARCHAR(16777216),
	""state_root"" VARCHAR(16777216),
	""receipts_root"" VARCHAR(16777216),
	""miner"" VARCHAR(16777216),
	""difficulty"" NUMBER(38,9),
	""total_difficulty"" NUMBER(38,9),
	""size"" NUMBER(38,0),
	""extra_data"" VARCHAR(16777216),
	""gas_limit"" NUMBER(38,0),
	""gas_used"" NUMBER(38,0),
	""transaction_count"" NUMBER(38,0)
);"

,1
table_name,CONTRACTS
description,
DDL,"create or replace TABLE CONTRACTS (
	""address"" VARCHAR(16777216),
	""bytecode"" VARCHAR(16777216),
	""function_sighashes"" VARIANT,
	""is_erc20"" BOOLEAN,
	""is_erc721"" BOOLEAN,
	""block_timestamp"" NUMBER(38,0),
	""block_number"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216)
);"

,2
table_name,TRACES
description,
DDL,"create or replace TABLE TRACES (
	""transaction_hash"" VARCHAR(16777216),
	""transaction_index"" NUMBER(38,0),
	""from_address"" VARCHAR(16777216),
	""to_address"" VARCHAR(16777216),
	""value"" NUMBER(38,9),
	""input"" VARCHAR(16777216),
	""output"" VARCHAR(16777216),
	""trace_type"" VARCHAR(16777216),
	""call_type"" VARCHAR(16777216),
	""reward_type"" VARCHAR(16777216),
	""gas"" NUMBER(38,0),
	""gas_used"" NUMBER(38,0),
	""subtraces"" NUMBER(38,0),
	""trace_address"" VARCHAR(16777216),
	""error"" VARCHAR(16777216),
	""status"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""block_number"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216),
	""trace_id"" VARCHAR(16777216)
);"

,3
table_name,TOKENS
description,
DDL,"create or replace TABLE TOKENS (
	""address"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""name"" VARCHAR(16777216),
	""decimals"" VARCHAR(16777216),
	""total_supply"" VARCHAR(16777216),
	""block_timestamp"" NUMBER(38,0),
	""block_number"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216)
);"

,4
table_name,TOKEN_TRANSFERS
description,
DDL,"create or replace TABLE TOKEN_TRANSFERS (
	""token_address"" VARCHAR(16777216),
	""from_address"" VARCHAR(16777216),
	""to_address"" VARCHAR(16777216),
	""value"" VARCHAR(16777216),
	""transaction_hash"" VARCHAR(16777216),
	""log_index"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""block_number"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216)
);"

,5
table_name,BALANCES
description,
DDL,"create or replace TABLE BALANCES (
	""address"" VARCHAR(16777216),
	""eth_balance"" NUMBER(38,9)
);"

,6
table_name,LOGS
description,
DDL,"create or replace TABLE LOGS (
	""log_index"" NUMBER(38,0),
	""transaction_hash"" VARCHAR(16777216),
	""transaction_index"" NUMBER(38,0),
	""address"" VARCHAR(16777216),
	""data"" VARCHAR(16777216),
	""topics"" VARIANT,
	""block_timestamp"" NUMBER(38,0),
	""block_number"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216)
);"

,7
table_name,TRANSACTIONS
description,
DDL,"create or replace TABLE TRANSACTIONS (
	""hash"" VARCHAR(16777216),
	""nonce"" NUMBER(38,0),
	""transaction_index"" NUMBER(38,0),
	""from_address"" VARCHAR(16777216),
	""to_address"" VARCHAR(16777216),
	""value"" NUMBER(38,9),
	""gas"" NUMBER(38,0),
	""gas_price"" NUMBER(38,0),
	""input"" VARCHAR(16777216),
	""receipt_cumulative_gas_used"" NUMBER(38,0),
	""receipt_gas_used"" NUMBER(38,0),
	""receipt_contract_address"" VARCHAR(16777216),
	""receipt_root"" VARCHAR(16777216),
	""receipt_status"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""block_number"" NUMBER(38,0),
	""block_hash"" VARCHAR(16777216)
);"

Database Name: CRYPTO
Schema Name: CRYPTO_ZILLIQA
DDL describes table information.
,0
table_name,EVENT_LOGS
description,
DDL,"create or replace TABLE EVENT_LOGS (
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""transaction_id"" VARCHAR(16777216),
	""index"" NUMBER(38,0),
	""address"" VARCHAR(16777216),
	""event_name"" VARCHAR(16777216),
	""params"" VARIANT
);"

,1
table_name,TX_BLOCKS
description,
DDL,"create or replace TABLE TX_BLOCKS (
	""number"" NUMBER(38,0),
	""ds_block_number"" NUMBER(38,0),
	""timestamp"" NUMBER(38,0),
	""version"" NUMBER(38,0),
	""gas_limit"" NUMBER(38,0),
	""gas_used"" NUMBER(38,0),
	""mb_info_hash"" VARCHAR(16777216),
	""tx_leader_pub_key"" VARCHAR(16777216),
	""tx_leader_address"" VARCHAR(16777216),
	""num_micro_blocks"" NUMBER(38,0),
	""num_transactions"" NUMBER(38,0),
	""num_present_transactions"" NUMBER(38,0),
	""prev_block_hash"" VARCHAR(16777216),
	""rewards"" NUMBER(38,0),
	""state_delta_hash"" VARCHAR(16777216),
	""state_root_hash"" VARCHAR(16777216),
	""header_signature"" BINARY(8388608)
);"

,2
table_name,EXCEPTIONS
description,
DDL,"create or replace TABLE EXCEPTIONS (
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""transaction_id"" VARCHAR(16777216),
	""index"" NUMBER(38,0),
	""line"" NUMBER(38,0),
	""message"" VARCHAR(16777216)
);"

,3
table_name,TRANSACTIONS
description,
DDL,"create or replace TABLE TRANSACTIONS (
	""id"" VARCHAR(16777216),
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""amount"" NUMBER(38,9),
	""code"" VARCHAR(16777216),
	""data"" VARCHAR(16777216),
	""gas_limit"" NUMBER(38,0),
	""gas_price"" NUMBER(38,0),
	""sender_pub_key"" VARCHAR(16777216),
	""sender"" VARCHAR(16777216),
	""signature"" BINARY(8388608),
	""to_addr"" VARCHAR(16777216),
	""version"" NUMBER(38,0),
	""accepted"" BOOLEAN,
	""success"" BOOLEAN,
	""cumulative_gas"" NUMBER(38,0),
	""epoch_num"" NUMBER(38,0)
);"

,4
table_name,TRANSITIONS
description,
DDL,"create or replace TABLE TRANSITIONS (
	""block_number"" NUMBER(38,0),
	""block_timestamp"" NUMBER(38,0),
	""transaction_id"" VARCHAR(16777216),
	""index"" NUMBER(38,0),
	""accepted"" BOOLEAN,
	""addr"" VARCHAR(16777216),
	""depth"" NUMBER(38,0),
	""amount"" NUMBER(38,9),
	""recipient"" VARCHAR(16777216),
	""tag"" VARCHAR(16777216),
	""params"" VARIANT
);"

,5
table_name,DS_BLOCKS
description,
DDL,"create or replace TABLE DS_BLOCKS (
	""number"" NUMBER(38,0),
	""timestamp"" NUMBER(38,0),
	""difficulty"" NUMBER(38,0),
	""difficulty_ds"" NUMBER(38,0),
	""gas_price"" NUMBER(38,0),
	""ds_leader_pub_key"" VARCHAR(16777216),
	""ds_leader_address"" VARCHAR(16777216),
	""prev_hash"" VARCHAR(16777216),
	""signature"" BINARY(8388608)
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'CRYPTO': {'CRYPTO_BAND': ['BLOCKS', 'BLOCK_EVENTS', 'ERRORS', 'LOGS', 'MESSAGES', 'ORACLE_REQUESTS', 'TRANSACTIONS'], 'CRYPTO_BITCOIN': ['BLOCKS', 'INPUTS', 'OUTPUTS', 'TRANSACTIONS'], 'CRYPTO_BITCOIN_CASH': ['BLOCKS', 'INPUTS', 'OUTPUTS', 'TRANSACTIONS'], 'CRYPTO_DASH': ['BLOCKS', 'INPUTS', 'OUTPUTS', 'TRANSACTIONS'], 'CRYPTO_ETHEREUM': ['BLOCKS', 'CONTRACTS', 'LOGS', 'TOKEN_TRANSFERS', 'TRACES', 'TRANSACTIONS'], 'CRYPTO_ETHEREUM_CLASSIC': ['BALANCES', 'BLOCKS', 'CONTRACTS', 'LOGS', 'TOKENS', 'TOKEN_TRANSFERS', 'TRACES', 'TRANSACTIONS'], 'CRYPTO_ZILLIQA': ['DS_BLOCKS', 'EVENT_LOGS', 'EXCEPTIONS', 'TRANSACTIONS', 'TRANSITIONS', 'TX_BLOCKS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

To accomplish the task, we'll focus on the `CRYPTO.CRYPTO_BITCOIN` schema, specifically the following tables and columns:

1. **TRANSACTIONS Table**:
   - `"hash"`: Transaction identifier.
   - `"block_timestamp_month"`: Date of the transaction (of type DATE), used to extract the month and filter for the year 2021.
   - `"input_count"`: Number of inputs in each transaction, potential usage to identify CoinJoin transactions with high input counts.
   - `"output_count"`: Number of outputs in each transaction, potential usage to identify CoinJoin transactions with high output counts.
   - `"input_value"`: Total value of inputs in a transaction, used to calculate transaction volume.
   - `"output_value"`: Total value of outputs in a transaction, used to calculate transaction volume.
   - `"is_coinbase"`: Indicates if the transaction is a coinbase transaction; potential usage to exclude these from analysis.
   - Conditions:
     - Exclude coinbase transactions (`"is_coinbase" = false`).
     - Filter transactions within the year 2021 (`"block_timestamp_month" >= '2021-01-01'` and `"block_timestamp_month" < '2022-01-01'`).
     - Identify potential CoinJoin transactions (`"input_count" >= 5` and `"output_count" >= 5`).

2. **BLOCKS Table**:
   - `"number"`: Block number, potential usage for joins if necessary.
   - `"timestamp_month"`: Date of the block (of type DATE), similar usage as `"block_timestamp_month"` in the TRANSACTIONS table.

**SQL Queries:**

Below are 10 SQL queries ranging from simple to complex to help understand the values in the related columns.

---

1. **Query 1: List Transaction Hashes from 2021**

   ```sql
   SELECT "hash", "block_timestamp_month"
   FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
   WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
   LIMIT 100;
   ```

2. **Query 2: Total Number of Transactions per Month in 2021**

   ```sql
   SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month", COUNT(*) AS "Transaction_Count"
   FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
   WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
   GROUP BY "Month"
   ORDER BY "Month"
   LIMIT 100;
   ```

3. **Query 3: Average Input and Output Counts per Month**

   ```sql
   SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
          AVG("input_count") AS "Avg_Input_Count",
          AVG("output_count") AS "Avg_Output_Count"
   FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
   WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
     AND "is_coinbase" = false
   GROUP BY "Month"
   ORDER BY "Month"
   LIMIT 100;
   ```

4. **Query 4: Transactions with High Input and Output Counts**

   ```sql
   SELECT "hash", "input_count", "output_count", "block_timestamp_month"
   FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
   WHERE "input_count" >= 5 AND "output_count" >= 5
     AND "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
     AND "is_coinbase" = false
   LIMIT 100;
   ```

5. **Query 5: Total Transaction Volume per Month in 2021**

   ```sql
   SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
          SUM("output_value") AS "Total_Volume"
   FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
   WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
     AND "is_coinbase" = false
   GROUP BY "Month"
   ORDER BY "Month"
   LIMIT 100;
   ```

6. **Query 6: Total Volume of Potential CoinJoin Transactions per Month**

   ```sql
   SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
          SUM("output_value") AS "CoinJoin_Volume"
   FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
   WHERE "input_count" >= 5 AND "output_count" >= 5
     AND "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
     AND "is_coinbase" = false
   GROUP BY "Month"
   ORDER BY "Month"
   LIMIT 100;
   ```

7. **Query 7: Count of Potential CoinJoin Transactions per Month**

   ```sql
   SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
          COUNT(*) AS "CoinJoin_Transactions"
   FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
   WHERE "input_count" >= 5 AND "output_count" >= 5
     AND "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
     AND "is_coinbase" = false
   GROUP BY "Month"
   ORDER BY "Month"
   LIMIT 100;
   ```

8. **Query 8: Percentage of Potential CoinJoin Transactions per Month**

   ```sql
   SELECT t1."Month",
          (t2."CoinJoin_Transactions" / t1."Total_Transactions") * 100 AS "Percentage_CoinJoin_Transactions"
   FROM (
     SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
            COUNT(*) AS "Total_Transactions"
     FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
     WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
       AND "is_coinbase" = false
     GROUP BY "Month"
   ) t1
   JOIN (
     SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
            COUNT(*) AS "CoinJoin_Transactions"
     FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
     WHERE "input_count" >= 5 AND "output_count" >= 5
       AND "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
       AND "is_coinbase" = false
     GROUP BY "Month"
   ) t2
   ON t1."Month" = t2."Month"
   ORDER BY t1."Month"
   LIMIT 100;
   ```

9. **Query 9: Average Input to Output UTXOs Ratio for Potential CoinJoin Transactions per Month**

   ```sql
   SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
          AVG("input_count"::FLOAT / NULLIF("output_count", 0)) AS "Avg_Input_Output_Ratio"
   FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
   WHERE "input_count" >= 5 AND "output_count" >= 5
     AND "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
     AND "is_coinbase" = false
   GROUP BY "Month"
   ORDER BY "Month"
   LIMIT 100;
   ```

10. **Query 10: Inspecting Individual Potential CoinJoin Transactions in the Month with Highest CoinJoin Volume**

    Assuming March (Month 3) has the highest CoinJoin volume:

    ```sql
    SELECT "hash", "input_count", "output_count", "input_value", "output_value", "fee"
    FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
    WHERE "input_count" >= 5 AND "output_count" >= 5
      AND EXTRACT(MONTH FROM "block_timestamp_month") = 3
      AND "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
      AND "is_coinbase" = false
    LIMIT 100;
    ```

**Notes:**

- All column names are enclosed in double quotations as per requirements.
- Conditions are applied to filter data for the year 2021 and to exclude coinbase transactions.
- High `"input_count"` and `"output_count"` (e.g., `>= 5`) are used as heuristics to identify potential CoinJoin transactions.
- The `EXTRACT(MONTH FROM ...)` function is used to group and filter data by month.
- `NULLIF("output_count", 0)` is used to prevent division by zero when calculating the input/output ratio.
- Each query is limited to 100 rows using `LIMIT 100` as per instructions.
- No external knowledge or assumptions beyond the provided tables and columns have been used.

---

By analyzing the results of these queries, you can determine which month in 2021 had the highest percentage of Bitcoin volume in CoinJoin transactions, along with the other requested metrics.Query:
SELECT "hash", "block_timestamp_month"
   FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
   WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
   LIMIT 100;
Answer:
Too long, hard cut:
hash,block_timestamp_month
11f1bf1fc4f1d7270c4cca45d1ffec3031ab3c2082820c6a5829ccc16a76a331,2021-12-01
06778da7f4da997b74b2b38a02e9a2ce509b84cee91609fb7cd8a2c718592f3a,2021-12-01
e875f008b50dd1840c24a4c1da7573e38edfe1cf99ec5b747964d4d52e3dcec1,2021-12-01
4f306854a91ebb111b379671bd8acf3072a5196625ff7d2d1594d0e0d26c83ab,2021-12-01
dbe31c264dfeb875c71c0ed89014095208e81d8e07525b0aff80ba93acc93874,2021-12-01
a6a32f47b067cdcc443a245497bdaa9c9f3dcf530e06b6b88bebd981e520f7c5,2021-12-01
14d25856db9707fc46909745cf6190e752309e9163d7b52cf327a05194c2e0ed,2021-12-01
0a64f00d6469b152aab1944d6291d21b4e39e98721c255f519823d50162c1c68,2021-12-01
2e918cca0fd3267f68454da0a203a38ea8df22c5b7d71ec7365a8eb6b5f56c0a,2021-12-01
5dcf303044ef2d9c0bdd1bf04bd46a9670fb7bff581eceef8e1f11edf5d15b97,2021-12-01
8b385b606e62750decf99fdac7a0dae1f13146900b4972648583532217813c5f,2021-12-01
c92fb75be6d5aed6f265db15a41fad2d0eb97c1de45b47bd44c44e1c2ebffa3e,2021-12-01
c9ce1866d274a3b0217bcd7620139672bdedbff3d18eea5bd5d526e4b0908eb5,2021-12-01
9adfc708ce0b43631335eac8a4928b682d232e50d8f30634fb9ab9abee59cd54,2021-12-01
b79c0a6f5d506f89c4ab0aa6f0c3bfaba44b14ef84600cdd20b5bc21d28347c9,2021-12-01
7e27748e523a43ed169325dfa955d388eeacf897935b29be52ca18b99efc8e0d,2021-12-01
e494da1c4a2342d68e60d0de9f8c615b4b6a4b6bed5ffb676fe02691d3a2bd66,2021-12-01
e9b00d3aa1fbd938e675bd115bfff5ff054be5fcbb17bcec0443415e792db65b,2021-12-01
8b2154791852bf17bdfd5a91a0050df570c5993ddc7c3f9e1ede5e7e16436bf9,2021-12-01
e130aededa84455a0ce8531e5645a13de939234795b9822517aa2934539c24aa,2021-12-01
6b49821e125271e722c346f5aa1092cbc744664d07325473ace9d86c3ca5f4f4,2021-12-01
546f4d582f86c4a193339e4dfd40f712dca77633cba508ddea91479d59661830,2021-12-01
98f7ebe5c30ea59a9df2bf72264e5576f24b1e80fc1a9d2cb58c9ebb65567f6c,2021-12-01
960f1a54456089ce1ad01bb91d5c0746bd113b2926772a0870fa54b2b3cfad86,2021-12-01
c9ce06d48bf764feddc6b208d7e5e52fdc47f40e11d7d170bf17bad8c856a9b4,2021-12-01
4c9b6731fc41372d3ebdcafa29841f5d577333cbad77b6e2670d1b4ab9eecba8,2021-12-01
42aff86c374e9a12d23213f2b2b30cfb7f8108c8a53efbceefcbfef8e1db47a1,2021-12-01
e9c652be6ca4dd2d0fb8aee6443691753e15d03594f15ec2ec8cea112554eedf,2021-12-01
00d644c8c68504926bb8818b180ad8cb4195d274f9070532e151091832253398,2021-12-01
90f6607d0239b1383375266d76a0f0b76dbcb6cd8a6dbacab891d31de6b23b34,2021-12-01
9c5e3ed0baadcbe3982173199b3aaa59865cc897148af59ee811b6abc0263bb1,2021-12-01
eed48de426c2fae09301f93e4aeb63f759e784d97e28ba8b6b69eb60aaee30c0,2021-12-01
bb5baa76c927753d0d2b5873d828f77f4fafc2f1b78952cd303cd5b8bfdc787a,2021-12-01
4a42c967676e98427e619953beba8e89619089c4ad0f9e41da6ac71f09548972,2021-12-01
529511689f7837ea08d363d7c55b16a1723fedc6a0e6a87092969554093062e8,2021-12-01
332d4b8be96b0dba7fc267ded86cbc4899e5b7deb1f335afc48f82e2ef7f259d,2021-12-01
0718c2b88a237fd68e112c73dd830cafb95cf57707c84adc96f2146437075f72,2021-12-01
6491c0b389cf1c6ffa7c97b4e8a12134d3b4679861c4ffc5bc1de7937c5fc05a,2021-12-01
9fcb743abfd815545c04c1987e6a1c3b2c999cf8161c80c5b9f106b3e646c1f7,2021-12-01
db4231178a80e5b7da2e5bcf7921216d72142de9f15684db2241b3784e98816e,2021-12-01
369952419812c76ea3c9ac3c8935400ecad8b40688a415a4c24ee924224d26ef,2021-12-01
d34d105a750fab58359d53737878c758ec1e099d84df3e45a274331d8d92526d,2021-12-01
73934ffbae58a328ab8127816daba8672aa5f324e7a613cbe8c406a534def0a3,2021-12-01
716a0ea0cb4f3e4317d598f42b6848b5648eaa27aaa0abb9c1bc4e40a6200f4a,2021-12-01
34a26d0773c2b0cce2a7d7a7208d60e99e36b3c495e8dd73bf31ddb023e8c592,2021-12-01
11ea0acee17c41936d1d160dd1142e9e1912c07c4672aa35043c1048b4436bdf,2021-12-01
3e8254e626d9f303fb7b19ba191e5ca73c817fc00a614a1103965f5ab4793cb7,2021-12-01
c0d196f0db97e05980856660c4e67d33e4bbc548697ac21fd79694d1f2722814,2021-12-01
1e9a09c0afec42cf75db0395242e3ae12d27733425738a1f06de5c1e55fede81,2021-12-01
26e8087526b5e11c6cbfa1ee304b90efb9ce371f017f3d096864d830ed60b6e8,2021-12-01
e0ce6246751ef77833ca70b5e14fdc49870a7cd4d6d9a746d1a4c8d1e654b597,2021-12-01
4eb665a0bdee7f955b020f9781e34e7f6055658a1a29b4c81d00feba82b4f566,2021-12-01
89308d2d21da0c550d22a6c8b57607b88c8267195a19bd8700dea1d59add634e,2021-12-01
e8b3e5810f4e1c266ab80d0900655c50997b55ac77fa0fb37c37ebdb467723b3,2021-12-01
9ae11bbb5e85e52dff59d3062b7e320230274b80a197712978d056677428f690,2021-12-01
5be8f56d06cf076af431ae34843aa49c15af52b1eb75a00187ab17c814924670,2021-12-01
db45dfd610ba52a7e79d4a4c04b6dbbe83e0ac245e0f36574471fcf0d7d911f8,2021-12-01
27f69d5dac2a747dcc7e4a2ab2382d4e3d6384010d5c926ecab947b3e8d0723d,2021-12-01
05c9acb8ef1ef9064030b862e2dc9ca52892280ad9d6b99892a05bca86a93a08,2021-12-01
b5be7f089c3fb79c4a3a7ebaa81a6d3b905d3ec10be4de990f28816e2308ccd5,2021-12-01
a7c00df620ef435206008f700a187af062d3d420a5c2da346d6ad44e7f04bc43,2021-12-01
57d6b0a491409ccd8414dabbea314a9f81ce866e4748c11037b1ca1d76255497,2021-12-01
0b4ea377b95c432c23ffdb309f01ff28930c77079c196a5bc0baec0b8061d40d,2021-12-01
995d0fcc384736ceb74776678636dc7cd38181fb876549d07738508ff533179e,2021-12-01
c689a02d4ea89004d05a6e38e79f4709833c7f113d91b461564e8ddffabe391e,2021-12-01
a10007cc41b048a9df431589b2ab0dcb7
Query:
SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month", COUNT(*) AS "Transaction_Count"
   FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
   WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
   GROUP BY "Month"
   ORDER BY "Month"
   LIMIT 100;
Answer:
Month,Transaction_Count
12,41762
Query:
SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
          AVG("input_count") AS "Avg_Input_Count",
          AVG("output_count") AS "Avg_Output_Count"
   FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
   WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
     AND "is_coinbase" = false
   GROUP BY "Month"
   ORDER BY "Month"
   LIMIT 100;
Answer:
Month,Avg_Input_Count,Avg_Output_Count
12,3.274559,3.249671
Query:
SELECT "hash", "input_count", "output_count", "block_timestamp_month"
   FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
   WHERE "input_count" >= 5 AND "output_count" >= 5
     AND "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
     AND "is_coinbase" = false
   LIMIT 100;
Answer:
Too long, hard cut:
hash,input_count,output_count,block_timestamp_month
62c9c74241373248ba554a64123a0442fb878de5dc4a97ef2039d6d4249148ee,5,5,2021-12-01
7714956269c9925d800fbc8b888278df5a32e1c82c9e8ae498c805575390defe,5,5,2021-12-01
9a7ac8aeb235c1c273ac7054f08eaf7e5a49bba3e8c5c8f71e561992634cd434,5,7,2021-12-01
3f3f5ffb2e5371cdb92374d3a4a1fc0963bef2285be5676defed4ba92f8d75df,14,8,2021-12-01
240c3da27cb7ac77e37db59c312316b53edfe5ac14fbb8b7ff147d0d6e21d2b8,6,10,2021-12-01
80dd8704fef4ffb855cd127e94bd17ae3dc46b5efe8778012b84835408ba9420,15,34,2021-12-01
8cea9e2bdb4df0f5fef620c17ac6762dedf75a512118b9201b718917a755c6a1,7,55,2021-12-01
299f4bda26eb58dd972284c844fe7f400b1d39e02d5bd9f222fefd984a38e593,16,5,2021-12-01
ab070a3bc5cf4380b7ac9d692512d247d9d6ea6452b12ba4e6e83e3289edb75f,19,5,2021-12-01
373f99fec3704e321b6a725d88933c83adc5dd4a8c0e78e1d9d039806549bfd6,69,5,2021-12-01
f5257b4827b626724451b1a6a6f4142170298bbb9b97ebef1c0339c30601292e,6,7,2021-12-01
7565cc09f97b7bda57733721bb2c165eb3f88676bafd888ad3d412f802fe673e,5,15,2021-12-01
1a6e515749dcbb5a85fd23d758d494daa20e47f58b5d1e3b70476f931279519f,195,24,2021-12-01
397f2e699118c2a1522fa02c583b8ff50e50ecd452a183ba73a724feafa91ec0,5,5,2021-12-01
b7a7e0a09d132fa128fd7eff145490896fcaf6d8eb2d65f4e3f3ad36e61fd871,5,5,2021-12-01
3f88f52a5f88212613d549da8a4efbb2d67d2145af206de6a4cedbfb11b5449b,5,5,2021-12-01
7f240a603be32d1fa567699873ca4755a502ec85db19d6b75a7e0283fcdc3d10,5,6,2021-12-01
ab9e516787e5de6340b2e49a7b8b06933555fbbff5b566a57ed031b6dcb07796,11,7,2021-12-01
42dfb92b8bad1386be3e16d9c3ace3ec33d631e2c354ff035bf3612fd0b09db2,6,11,2021-12-01
fc7fc062a86379389e79b1d55fdac2a9efb25f652099793be8fb683daf448418,7,15,2021-12-01
20f53ebdb990c92e907746889ffc7caa9f674ac0978bf0e18602bd0fe156e138,18,35,2021-12-01
0a464af1a054ac6ddcbda147bd9a2ce8da4b0d703664dea81748579e86ffb021,19,5,2021-12-01
eb7ad1a8c3088c802a3b68a764dfebba5cbc9534aed1341aa2bb2578625528be,5,5,2021-12-01
25ceffb95793b617e0bbc9b8ba7c3a3e4f03970e0188335ae5bd170dd8109316,5,5,2021-12-01
142d147c68705020a4ae0b3107b3ef1a5f848a9ff4691410ec6f5f5e13f5fdd3,14,10,2021-12-01
a642d904ccd79e3ab45919a8086c1497c9c947f5005f074e80a6c542fb0471b6,10,5,2021-12-01
f550c8469597b937ff89c31b3f6c473f7e42b6a4f9f798537ed1e1d315aa43df,13,5,2021-12-01
6114f0af5e8c094e901fbace950229826c8a8dade1c2cbcf967fb3d7068ec01b,23,5,2021-12-01
d4ef2e450055a78e5f2a20a92a9fd5acce2dcf9b33860ce8839c8fdc89e8d4d2,5,11,2021-12-01
dfedd28af34146e2474e5c8ae59c49df23d53c1ee09dedd5a975dc25f08008ea,6,20,2021-12-01
894608ee2cf6a8bb1ca321751c6eccec17ef62c5b9863c6f9937a74370e7a321,101,7,2021-12-01
1d8a348244576a7905c9a646c94d4c84cc38d48632ac174b31f7abfa5f985973,19,11,2021-12-01
5576083d4604bac813d42aaff31503de4a7f8b9330b3c6b328fdd476d21714bd,5,20,2021-12-01
c5f596715bf3832948b453cc814ab1726a8fc1718e82191c5b1d6c4dbdfe9688,63,101,2021-12-01
eb99472a56c5172380123084ad46cc529769c12678c14e509935b322df4a8cc2,20,200,2021-12-01
53ed38f3b58f2c991737b3fcfec2dc2c1465f38744bc56e9aabdfa65d6fa45a3,48,5,2021-12-01
ca1d471bd91416f7462ac7e9144bf8d6d8e2d7763d6ec76d6bb8241fd1677ac0,5,5,2021-12-01
48113e0a957960ad4dea69502719af75e9c767a9eea8897795b8c78fb5d6e978,269,6,2021-12-01
65fc3012658253b3af9a9cc800290c41fa561d55049c7314fa8c04cd51dee8e7,9,7,2021-12-01
a4cc2ddc73b084692f410250bf2f80b2bb3839e8d121d48259b03a24490a1730,15,7,2021-12-01
f18b6bdbacc45ce45ab7f4a4a7ccfd9023513e6bf8507e89f68b963d3a271a60,6,12,2021-12-01
0b210110c89a55ee12ccf7e17f1fac1c1d816b0e45efdc9408dc01e49d83f011,6,10,2021-12-01
9be7e3642ae06259ce0579eb7bf8a0a4a8bc37c586e3c42862e303f67a3808d2,7,14,2021-12-01
d32e24c4581ca518aab14fee69b8353c9957732fbe8ec421eb49171e80e3724a,5,7,2021-12-01
aa16648940c8a35102c239281589c84867a907fb606cd62d340221e3b85ec920,5,27,2021-12-01
030dbacca11b1b8fa254b824887fac52b861a948f4ab58153040251eb41f0844,6,134,2021-12-01
b4e6bfe8b8de01c8382c21159e6d440416484a114a23473ca0bf6aa5320c8e97,66,5,2021-12-01
f49696a2782627167748d4a031ddd4c466e25fc1bea5c832d69b7d39daf791cf,5,5,2021-12-01
7f6226104e8b1ffc8a5f8178c57e52254bc16525e0c5d27e1407a8a71a45188f,5,5,2021-12-01
902628702f60a13b360914dbdc97ddca19d134f07945f41a9e11a71868aa306b,8,9,2021-12-01
2c43a81e302f9a3a0f4d85ddddd304428fdefe9b8039f09d8e34df0193f09421,6,19,2021-12-01
345d5a69ec7a03f47725891cc45e759cbb90f3ecbbda404d5987ceadf126f1ea,101,5,2021-12-01
00723d46a77b03f1350a927fae449855f59c4265e5b0e96f242a571a589432d5,5,6,2021-12-01
b9d97b02dac51d364b0ef9df9da9edafef784bf2466667498f337dff62409f30,6,7,2021-12-01
7967187fc9219745e2e881cda5e68f31cbbb5f7f0b30bbf8609643011d807d50,10,21,2021-12-01
7a5a781e109cefbcd625a59a9921b9aed5e24ce7fb7db5be4dc2e1e0d7b4aef3,42,23,2021-12-01
e5c92af61fa050d6975765d3ac0cae67213ec7f30d88190b9febeabf2a9c5978,89,47,2021-12-01
887872e43752a023f30ec17e333cb793dce622e4b2cc22d8072e723c3bc17b18,5,5,2021-12-01
5c5c84691f342e7629afca5e2c8359fa3cc05354701ab376139d8488a7629816,8,8,2021-12-01
9ff3da4ab77ceebba67abf6139e2d8b023e5aa4d31252f5718596b0f235421f8,10,8,2021-12-01
3665a11377cc66a7ae3722a436a528a190d74dd83d7dea52e19468b651e7d55d,8,10,2021-12-01
b080e6fe2c
Query:
SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
          SUM("output_value") AS "Total_Volume"
   FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
   WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
     AND "is_coinbase" = false
   GROUP BY "Month"
   ORDER BY "Month"
   LIMIT 100;
Answer:
Month,Total_Volume
12,73208621149507.000000000
Query:
SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
          SUM("output_value") AS "CoinJoin_Volume"
   FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
   WHERE "input_count" >= 5 AND "output_count" >= 5
     AND "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
     AND "is_coinbase" = false
   GROUP BY "Month"
   ORDER BY "Month"
   LIMIT 100;
Answer:
Month,CoinJoin_Volume
12,128296606152.000000000
Query:
SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
          COUNT(*) AS "CoinJoin_Transactions"
   FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
   WHERE "input_count" >= 5 AND "output_count" >= 5
     AND "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
     AND "is_coinbase" = false
   GROUP BY "Month"
   ORDER BY "Month"
   LIMIT 100;
Answer:
Month,CoinJoin_Transactions
12,293
Query:
SELECT t1."Month",
          (t2."CoinJoin_Transactions" / t1."Total_Transactions") * 100 AS "Percentage_CoinJoin_Transactions"
   FROM (
     SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
            COUNT(*) AS "Total_Transactions"
     FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
     WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
       AND "is_coinbase" = false
     GROUP BY "Month"
   ) t1
   JOIN (
     SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
            COUNT(*) AS "CoinJoin_Transactions"
     FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
     WHERE "input_count" >= 5 AND "output_count" >= 5
       AND "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
       AND "is_coinbase" = false
     GROUP BY "Month"
   ) t2
   ON t1."Month" = t2."Month"
   ORDER BY t1."Month"
   LIMIT 100;
Answer:
Month,Percentage_CoinJoin_Transactions
12,0.701800
Query:
SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
          AVG("input_count"::FLOAT / NULLIF("output_count", 0)) AS "Avg_Input_Output_Ratio"
   FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
   WHERE "input_count" >= 5 AND "output_count" >= 5
     AND "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
     AND "is_coinbase" = false
   GROUP BY "Month"
   ORDER BY "Month"
   LIMIT 100;
Answer:
Month,Avg_Input_Output_Ratio
12,2.6723575232638446
Query:
SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
       AVG("input_count"::FLOAT / NULLIF("output_count", 0)) AS "Avg_Input_Output_Ratio"
FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
  AND "is_coinbase" = false
GROUP BY "Month"
ORDER BY "Month"
LIMIT 100;
Answer:
Month,Avg_Input_Output_Ratio
12,2.076715608196059
Query:
SELECT t1."Month",
       (COALESCE(t2."CoinJoin_Transactions", 0) / t1."Total_Transactions") * 100 AS "Percentage_CoinJoin_Transactions"
FROM (
  SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
         COUNT(*)::FLOAT AS "Total_Transactions"
  FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
  WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
    AND "is_coinbase" = false
  GROUP BY "Month"
) t1
LEFT JOIN (
  SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
         COUNT(*)::FLOAT AS "CoinJoin_Transactions"
  FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
  WHERE "input_count" >= 2 AND "output_count" >= 2
    AND "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
    AND "is_coinbase" = false
  GROUP BY "Month"
) t2
ON t1."Month" = t2."Month"
ORDER BY t1."Month"
LIMIT 100
Answer:
Month,Percentage_CoinJoin_Transactions
12,17.019187007449638
Query:
SELECT t1."Month",
       (COALESCE(t2."CoinJoin_Transactions", 0) / NULLIF(t1."Total_Transactions", 0)) * 100 AS "Percentage_CoinJoin_Transactions"
FROM (
  SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
         COUNT(*)::FLOAT AS "Total_Transactions"
  FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
  WHERE "block_timestamp_month" BETWEEN '2021-01-01' AND '2021-12-31'
  GROUP BY "Month"
) t1
LEFT JOIN (
  SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
         COUNT(*)::FLOAT AS "CoinJoin_Transactions"
  FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
  WHERE "input_count" >= 1 AND "output_count" >= 1
    AND "block_timestamp_month" BETWEEN '2021-01-01' AND '2021-12-31'
  GROUP BY "Month"
) t2
ON t1."Month" = t2."Month"
ORDER BY t1."Month"
LIMIT 100;
Answer:
Month,Percentage_CoinJoin_Transactions
12,99.96408217997222
Query:
SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
       SUM("output_value") AS "CoinJoin_Volume"
FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
WHERE "input_count" >= 1 AND "output_count" >= 1
  AND "block_timestamp_month" BETWEEN '2021-01-01' AND '2021-12-31'
GROUP BY "Month"
ORDER BY "Month"
LIMIT 100
Answer:
Month,CoinJoin_Volume
12,73208621149507.000000000
Query:
SELECT EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
       COUNT(*) AS "CoinJoin_Transactions"
FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
WHERE "input_count" >= 1 AND "output_count" >= 1
  AND "block_timestamp_month" BETWEEN '2021-01-01' AND '2021-12-31'
GROUP BY "Month"
ORDER BY "Month"
LIMIT 100
Answer:
Month,CoinJoin_Transactions
12,41747
Query:
SELECT "hash", "input_count", "output_count", "block_timestamp_month"
FROM CRYPTO.CRYPTO_BITCOIN.TRANSACTIONS
WHERE "input_count" >= 1 AND "output_count" >= 1
  AND "block_timestamp_month" BETWEEN '2021-01-01' AND '2021-12-31'
LIMIT 100
Answer:
Too long, hard cut:
hash,input_count,output_count,block_timestamp_month
2eae767c800d84e6a36d274f807533793069df812f261029013c9b297e48be34,2,2,2021-12-01
cbf98be5200cc71e99a8a32901fba42e8e9c56561228e74072781ef339d1b78d,7,2,2021-12-01
1d4f342a4f3f66d26dd0bb06b8bf9b9788c6d2ab185c689b2bdd65dbfcb7e621,2,2,2021-12-01
03ef6e1815ffbc34c3874621351fe4f3b37e6f03508e382b72aed59981eabe0b,3,2,2021-12-01
b07dcb84531b85bd85f2e41f815cf4fe324ae66ac7e69b3a62e6afa75663abaa,2,2,2021-12-01
fe53b191d9c9e2e1e9242db917eae59cfc38096f7dd9c8b01e871844ec531209,2,2,2021-12-01
cf4eba62a46b9e2afbe1c601180a2e374dce592546554af8b0e1a5af7b6f54b0,2,2,2021-12-01
7ea60bb9180879eb842d4ae31bb01c806a00f21e0714e2f4f818e53e3eda93ed,2,2,2021-12-01
fa7f88f7ebe0cc6604b9955ee66444919ba8a92b072726b0cc76651f9e3beea4,2,2,2021-12-01
a1a3e9c9f782279f2a2a0db83323ec300bede692fd79a94bd739e8094f8e8879,2,2,2021-12-01
43a316a543b39c0ee89eb2c8ff8594c74d4e1e9629b6132a1c7500d5ef39dbb9,2,2,2021-12-01
8c320cf1f7e51e955965b209b1538c1f33cfa95481978dcaa87fbdc7340e3ade,2,2,2021-12-01
634c789bf2f180951d4392b4f556f3dd55f6d6e9309a7ea32949cb36df421843,2,2,2021-12-01
66ea0ab60597a20ab4f5ea659d6f468eef0ac123d9b6137952430cd3743d4235,2,2,2021-12-01
54f3cb179e3738a1227552ec458d6ae0bc3b6fecdd64d7cef0263aa3ffb3c721,2,2,2021-12-01
424bd24cb529ac5da2702ca1925a360d4df57eba7b47329fa490d0627d713992,2,2,2021-12-01
c4324fee2507e9ba113e1175cadf4f2ccc7e2dd5ef2850049039fd6d93e3a33b,2,2,2021-12-01
9d46944ce1fcae5bd8fd04201d850030d5c17f9b091c74c7d5c49144fa9824fb,2,2,2021-12-01
eb1fcf69744b3dd6ad4cf31f6cf2dcb65783186b768b2ac6d15f3f84c5d2cd6f,2,2,2021-12-01
54f79507af188380f5787bf21a0a036f6fdeae8ad6fe947ca614e935550ed959,2,2,2021-12-01
87b2299d8c1c7c9c141eae37e57921026e2a5bb65d65c42e9064161eb1b97b83,2,2,2021-12-01
fef37197f4e8e3de766e74af80ff275717c74b8562413051c5c13f2af6ffd64c,2,2,2021-12-01
8e88e957958fd0aadd507df06e37bddd6101083faa4a4aa10a1c1e5afb0768f9,2,2,2021-12-01
ef79b20104aef98f10648c8764ccdca5b8a57f910a5d7b631ad89ec222ab23f6,2,2,2021-12-01
7cf42b8b30b497c4be098e6555bfa150323ba599e7ea922ada88ea004cfac0e0,2,2,2021-12-01
83bf8801d8384404237c0e8f2fed9d1120e788dac1c70e78ab696b8f61df6401,2,2,2021-12-01
cd7943d95465fb2e96a2e6acedc37e18c41e79d655a64d1c200e2c960c44878f,2,2,2021-12-01
8cd86a1d347a8ff5a29b52d212e235382c14962edae05d15c58a73ccfb6da22c,2,2,2021-12-01
c9d450614a9cf61e7d3fb0438263f202d2f6f108bc82bc8235d5c460688f4598,2,2,2021-12-01
47dcdaf1858337bb692ab017fb80d1aa9943290ae32e349d0207dc4cfd430752,2,2,2021-12-01
4521cdf5647adeb65da05fe0b2fba5ccd32c7d721f65fb858b9e28235cd9532c,2,2,2021-12-01
162ad96a4033b0b53b2dcc959d50f325e71a06f00cd26e5195ef7cd0aa3808dd,2,2,2021-12-01
64273f9516aadf400111cd0a84372164714117360af820b49dbad33d5bdc0294,2,2,2021-12-01
fc5963bcb4fc6969d5f8f9307d0ab1afa71d2ba7292602c55a33c11d4d6a0a88,2,2,2021-12-01
b64d4155bec5da2b10b0be1ad0ae7f7f1b4989723e71da586e782e2ac65fb049,2,2,2021-12-01
7aad057a3b38c2d5d2fd7c7c2c96f07636da93f4117852075e6bc6cd58473366,2,2,2021-12-01
f92f6355a49c828282d3b2df056bf19e6f7619a7398c496deb1717db1c86694c,2,2,2021-12-01
fa0a989fda992d92982b8dd74475c7b7212457ff40f40e05f12d6a4fcd0c97c8,2,2,2021-12-01
07da46d20fec1bd70c294aa9185b5b927d2c78dbd922459f3149e8d7970451b9,2,2,2021-12-01
9cc7371757fd4f615a3351199ec4dd592ffd8534c3c5cd574eb4e936a55d2d4a,2,2,2021-12-01
72cfc563aafe70ba4cc10694a6f3de81125d9441fbff6a0a554b0ebf91ae8e13,2,2,2021-12-01
537eaa2d67ad69f5ff401194ba93a5e5b875162e4b1b26fd16ddc614495ee415,2,2,2021-12-01
45e0574392eb7b72d384380f5e9a231688049730fef1d5934dc7b5b03425ddfb,2,2,2021-12-01
79a7d4e070ffc9cbf7fafc25c094d96ad2853b4b4755e4e23bf0024d1aecc7c0,2,2,2021-12-01
1971d77d7d83257d9775fd92b7ee166a31b816f71963157fa0caebcc2768e931,2,2,2021-12-01
60f82a228e50091e807ae8563f0ebd49991974c514731c585111d6b1e8d83343,2,2,2021-12-01
b64b99b930b5764e915dfc2e04df32e82203a7cacabfc48eaa2f0a5c6404754d,2,2,2021-12-01
f619857c6e4e7035f6dabcd9dc1dd3ec27a6827aa8165b4c2d2a52b476c7f3ec,2,2,2021-12-01
c3fd39643986f30908b43482af3587ba792e695fac5cd6cd57a35a082de5029f,2,2,2021-12-01
77e418dd747564322d155bc26750193806b5564b5dc59d6a5a15e05ae9631b77,3,2,2021-12-01
d1632a778d828aa89e2b489f5af2b7b8b875761e9fbd61cc12d1136965db0174,3,2,2021-12-01
3c5242a9ddec1774ca13b4592b6b28344defc0f23426b11fd9ef216b031945ee,3,2,2021-12-01
a508fdb381e3bf79b348e8297dece758be73927b81e428b8d99651e54948c2b7,3,2,2021-12-01
a303d13304eb4ab056281da8b1a6ecb69ab5a4b484ea944b7175eb0f9065116a,3,2,2021-12-01
7911c23f910d8bc53ccbdb9507faf3dace649a29b80f69ebf9bf289d6ee540d9,3,2,2021-12-01
b0dcca18ae2c03d6a0f4be3b2210025a0d17ef527ef81f0e3cc9c372a462607c,3,2,2021-12-01
b02efa8a62f508dc14023e4c5dbb4e4f48a87eb095db12da71db1574dd04fa50,3,2,2021-12-01
09723c07ff3b963e6f8b2ccc44e16bdee11d39f8ef236b7467783609bdd4f4ac,3,2,2021-12-01
3a8932f793ceb909e12181883b598c717030ce7e28945f32325bace35eb56b3e,3,2,2021-12-01
bf066af68951c2b8b6effb22c18a691558eaf54566060845fe34dfe2b49f5c31,6,2,2021-12-01
ff89f9985e148011e986e42c8c722d42afc511b2185866f5c8517624c05a3948,4,2,2021-12-01
a75330fbdda126827eff3e99890f82ae1f80cbde171e680810818160b24508a7,4,2
End Exploring Related Columns
Task: Which month (e.g., 3) in 2021 witnessed the highest percent of Bitcoin volume that took place in CoinJoin transactions? Also give me the percentage of CoinJoins transactions, the average input and output UTXOs ratio, and the proportion of CoinJoin transaction volume for that month (all 1 decimal).

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: To determine which month in 2021 witnessed the highest percentage of Bitcoin volume in CoinJoin transactions, you would need to analyze the transaction data in your `CRYPTO_BITCOIN` schema, specifically the `TRANSACTIONS`, `INPUTS`, and `OUTPUTS` tables.

Once you've performed the analysis, you can present the results in the following CSV format:

```csv
Month,Percentage_of_CoinJoin_Transactions,Average_Input_Output_UTXOs_Ratio,CoinJoin_Transaction_Volume_Proportion
month_number,percentage_transactions:float,average_ratio:float,volume_proportion:float
(Attention: answer in one row)
```

**Explanation:**

- **Month**: The numerical representation of the month in 2021 (e.g., `3` for March).
- **Percentage_of_CoinJoin_Transactions**: The percentage of all Bitcoin transactions in that month that were identified as CoinJoin transactions (rounded to one decimal place).
- **Average_Input_Output_UTXOs_Ratio**: The average ratio of input to output UTXOs in CoinJoin transactions for that month (rounded to one decimal place).
- **CoinJoin_Transaction_Volume_Proportion**: The proportion of Bitcoin volume that took place in CoinJoin transactions compared to the total transaction volume for that month (rounded to one decimal place and expressed as a percentage).

To calculate these values:

1. **Identify CoinJoin Transactions**: CoinJoin transactions typically have multiple inputs and outputs from multiple parties. You can identify them by looking for transactions with a high number of inputs and outputs, where output amounts are often equal.

2. **Calculate Percentages**:
   - **Percentage of CoinJoin Transactions**: `(Number of CoinJoin Transactions / Total Transactions) * 100`
   - **CoinJoin Transaction Volume Proportion**: `(Total Volume of CoinJoin Transactions / Total Transaction Volume) * 100`

3. **Compute Average Input/Output UTXOs Ratio**: For each CoinJoin transaction, calculate the ratio of input UTXOs to output UTXOs, then compute the average ratio for the month.

Please replace the placeholders with your actual calculated values..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'CRYPTO': {'CRYPTO_BAND': ['BLOCKS', 'BLOCK_EVENTS', 'ERRORS', 'LOGS', 'MESSAGES', 'ORACLE_REQUESTS', 'TRANSACTIONS'], 'CRYPTO_BITCOIN': ['BLOCKS', 'INPUTS', 'OUTPUTS', 'TRANSACTIONS'], 'CRYPTO_BITCOIN_CASH': ['BLOCKS', 'INPUTS', 'OUTPUTS', 'TRANSACTIONS'], 'CRYPTO_DASH': ['BLOCKS', 'INPUTS', 'OUTPUTS', 'TRANSACTIONS'], 'CRYPTO_ETHEREUM': ['BLOCKS', 'CONTRACTS', 'LOGS', 'TOKEN_TRANSFERS', 'TRACES', 'TRANSACTIONS'], 'CRYPTO_ETHEREUM_CLASSIC': ['BALANCES', 'BLOCKS', 'CONTRACTS', 'LOGS', 'TOKENS', 'TOKEN_TRANSFERS', 'TRACES', 'TRANSACTIONS'], 'CRYPTO_ZILLIQA': ['DS_BLOCKS', 'EVENT_LOGS', 'EXCEPTIONS', 'TRANSACTIONS', 'TRANSITIONS', 'TX_BLOCKS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-24 08:25:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 08:25:05 - root - INFO - ```sql
WITH monthly_stats AS (
  SELECT
    EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
    COUNT(*) FILTER (WHERE "is_coinbase" = false) AS "Total_Transactions",
    COUNT(*) FILTER (WHERE "is_coinbase" = false AND "input_count" >= 5 AND "output_count" >= 5) AS "CoinJoin_Transactions",
    SUM("output_value") FILTER (WHERE "is_coinbase" = false) AS "Total_Volume",
    SUM("output_value") FILTER (WHERE "is_coinbase" = false AND "input_count" >= 5 AND "output_count" >=5) AS "CoinJoin_Volume",
    AVG("input_count"::FLOAT / NULLIF("output_count", 0)) FILTER (WHERE "is_coinbase" = false AND "input_count" >= 5 AND "output_count" >=5) AS "Avg_Input_Output_Ratio"
  FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
  WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
  GROUP BY "Month"
), final_stats AS (
  SELECT
    "Month",
    ("CoinJoin_Transactions"::FLOAT / NULLIF("Total_Transactions", 0)) * 100 AS "Percentage_of_CoinJoin_Transactions",
    "Avg_Input_Output_Ratio",
    ("CoinJoin_Volume" / NULLIF("Total_Volume", 0)) * 100 AS "CoinJoin_Transaction_Volume_Proportion"
  FROM monthly_stats
)
SELECT
  "Month",
  ROUND("Percentage_of_CoinJoin_Transactions",1) AS "Percentage_of_CoinJoin_Transactions",
  ROUND("Avg_Input_Output_Ratio",1) AS "Average_Input_Output_UTXOs_Ratio",
  ROUND("CoinJoin_Transaction_Volume_Proportion",1) AS "CoinJoin_Transaction_Volume_Proportion"
FROM final_stats
ORDER BY "CoinJoin_Transaction_Volume_Proportion" DESC NULLS LAST
LIMIT 1;
```
2025-01-24 08:25:05 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:25:05 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:25:05 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:25:06 - snowflake.connector.connection - INFO - closed
2025-01-24 08:25:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:25:07 - root - INFO - itercount: 1
2025-01-24 08:25:07 - root - INFO - 001003 (42000): 01b9ebf9-0004-8094-0001-11c300f942c6: SQL compilation error:
syntax error line 4 at position 20 unexpected '('.
syntax error line 4 at position 21 unexpected 'WHERE'.
syntax error line 4 at position 50 unexpected 'AS'.
2025-01-24 08:25:07 - root - INFO - Input sql:
WITH monthly_stats AS (
  SELECT
    EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
    COUNT(*) FILTER (WHERE "is_coinbase" = false) AS "Total_Transactions",
    COUNT(*) FILTER (WHERE "is_coinbase" = false AND "input_count" >= 5 AND "output_count" >= 5) AS "CoinJoin_Transactions",
    SUM("output_value") FILTER (WHERE "is_coinbase" = false) AS "Total_Volume",
    SUM("output_value") FILTER (WHERE "is_coinbase" = false AND "input_count" >= 5 AND "output_count" >=5) AS "CoinJoin_Volume",
    AVG("input_count"::FLOAT / NULLIF("output_count", 0)) FILTER (WHERE "is_coinbase" = false AND "input_count" >= 5 AND "output_count" >=5) AS "Avg_Input_Output_Ratio"
  FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
  WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
  GROUP BY "Month"
), final_stats AS (
  SELECT
    "Month",
    ("CoinJoin_Transactions"::FLOAT / NULLIF("Total_Transactions", 0)) * 100 AS "Percentage_of_CoinJoin_Transactions",
    "Avg_Input_Output_Ratio",
    ("CoinJoin_Volume" / NULLIF("Total_Volume", 0)) * 100 AS "CoinJoin_Transaction_Volume_Proportion"
  FROM monthly_stats
)
SELECT
  "Month",
  ROUND("Percentage_of_CoinJoin_Transactions",1) AS "Percentage_of_CoinJoin_Transactions",
  ROUND("Avg_Input_Output_Ratio",1) AS "Average_Input_Output_UTXOs_Ratio",
  ROUND("CoinJoin_Transaction_Volume_Proportion",1) AS "CoinJoin_Transaction_Volume_Proportion"
FROM final_stats
ORDER BY "CoinJoin_Transaction_Volume_Proportion" DESC NULLS LAST
LIMIT 1;
The error information is:
001003 (42000): 01b9ebf9-0004-8094-0001-11c300f942c6: SQL compilation error:
syntax error line 4 at position 20 unexpected '('.
syntax error line 4 at position 21 unexpected 'WHERE'.
syntax error line 4 at position 50 unexpected 'AS'.
Please correct it and output only 1 complete SQL query.
2025-01-24 08:25:34 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 08:25:34 - root - INFO - ```sql
WITH monthly_stats AS (
  SELECT
    EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
    COUNT(CASE WHEN "is_coinbase" = false THEN 1 END) AS "Total_Transactions",
    COUNT(CASE WHEN "is_coinbase" = false AND "input_count" >= 5 AND "output_count" >= 5 THEN 1 END) AS "CoinJoin_Transactions",
    SUM(CASE WHEN "is_coinbase" = false THEN "output_value" END) AS "Total_Volume",
    SUM(CASE WHEN "is_coinbase" = false AND "input_count" >= 5 AND "output_count" >=5 THEN "output_value" END) AS "CoinJoin_Volume",
    AVG(CASE WHEN "is_coinbase" = false AND "input_count" >= 5 AND "output_count" >=5 THEN "input_count"::FLOAT / NULLIF("output_count", 0) END) AS "Avg_Input_Output_Ratio"
  FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
  WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
  GROUP BY "Month"
), final_stats AS (
  SELECT
    "Month",
    ("CoinJoin_Transactions"::FLOAT / NULLIF("Total_Transactions", 0)) * 100 AS "Percentage_of_CoinJoin_Transactions",
    "Avg_Input_Output_Ratio",
    ("CoinJoin_Volume" / NULLIF("Total_Volume", 0)) * 100 AS "CoinJoin_Transaction_Volume_Proportion"
  FROM monthly_stats
)
SELECT
  "Month",
  ROUND("Percentage_of_CoinJoin_Transactions",1) AS "Percentage_of_CoinJoin_Transactions",
  ROUND("Avg_Input_Output_Ratio",1) AS "Average_Input_Output_UTXOs_Ratio",
  ROUND("CoinJoin_Transaction_Volume_Proportion",1) AS "CoinJoin_Transaction_Volume_Proportion"
FROM final_stats
ORDER BY "CoinJoin_Transaction_Volume_Proportion" DESC NULLS LAST
LIMIT 1;
```
2025-01-24 08:25:34 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:25:34 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:25:34 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:25:36 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 08:25:36 - snowflake.connector.connection - INFO - closed
2025-01-24 08:25:36 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:25:36 - root - INFO - itercount: 2
2025-01-24 08:25:36 - root - INFO - 0
2025-01-24 08:25:36 - root - INFO - results: 
Month,Percentage_of_CoinJoin_Transactions,Average_Input_Output_UTXOs_Ratio,CoinJoin_Transaction_Volume_Proportion
12,0.7,2.7,0.2


2025-01-24 08:25:36 - root - INFO - Please check the answer again by reviewing Which month (e.g., 3) in 2021 witnessed the highest percent of Bitcoin volume that took place in CoinJoin transactions? Also give me the percentage of CoinJoins transactions, the average input and output UTXOs ratio, and the proportion of CoinJoin transaction volume for that month (all 1 decimal)., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To determine which month in 2021 witnessed the highest percentage of Bitcoin volume in CoinJoin transactions, you would need to analyze the transaction data in your `CRYPTO_BITCOIN` schema, specifically the `TRANSACTIONS`, `INPUTS`, and `OUTPUTS` tables.

Once you've performed the analysis, you can present the results in the following CSV format:

```csv
Month,Percentage_of_CoinJoin_Transactions,Average_Input_Output_UTXOs_Ratio,CoinJoin_Transaction_Volume_Proportion
month_number,percentage_transactions:float,average_ratio:float,volume_proportion:float
(Attention: answer in one row)
```

**Explanation:**

- **Month**: The numerical representation of the month in 2021 (e.g., `3` for March).
- **Percentage_of_CoinJoin_Transactions**: The percentage of all Bitcoin transactions in that month that were identified as CoinJoin transactions (rounded to one decimal place).
- **Average_Input_Output_UTXOs_Ratio**: The average ratio of input to output UTXOs in CoinJoin transactions for that month (rounded to one decimal place).
- **CoinJoin_Transaction_Volume_Proportion**: The proportion of Bitcoin volume that took place in CoinJoin transactions compared to the total transaction volume for that month (rounded to one decimal place and expressed as a percentage).

To calculate these values:

1. **Identify CoinJoin Transactions**: CoinJoin transactions typically have multiple inputs and outputs from multiple parties. You can identify them by looking for transactions with a high number of inputs and outputs, where output amounts are often equal.

2. **Calculate Percentages**:
   - **Percentage of CoinJoin Transactions**: `(Number of CoinJoin Transactions / Total Transactions) * 100`
   - **CoinJoin Transaction Volume Proportion**: `(Total Volume of CoinJoin Transactions / Total Transaction Volume) * 100`

3. **Compute Average Input/Output UTXOs Ratio**: For each CoinJoin transaction, calculate the ratio of input UTXOs to output UTXOs, then compute the average ratio for the month.

Please replace the placeholders with your actual calculated values. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Month,Percentage_of_CoinJoin_Transactions,Average_Input_Output_UTXOs_Ratio,CoinJoin_Transaction_Volume_Proportion
12,0.7,2.7,0.2
Current sql:
WITH monthly_stats AS (
  SELECT
    EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
    COUNT(CASE WHEN "is_coinbase" = false THEN 1 END) AS "Total_Transactions",
    COUNT(CASE WHEN "is_coinbase" = false AND "input_count" >= 5 AND "output_count" >= 5 THEN 1 END) AS "CoinJoin_Transactions",
    SUM(CASE WHEN "is_coinbase" = false THEN "output_value" END) AS "Total_Volume",
    SUM(CASE WHEN "is_coinbase" = false AND "input_count" >= 5 AND "output_count" >=5 THEN "output_value" END) AS "CoinJoin_Volume",
    AVG(CASE WHEN "is_coinbase" = false AND "input_count" >= 5 AND "output_count" >=5 THEN "input_count"::FLOAT / NULLIF("output_count", 0) END) AS "Avg_Input_Output_Ratio"
  FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
  WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
  GROUP BY "Month"
), final_stats AS (
  SELECT
    "Month",
    ("CoinJoin_Transactions"::FLOAT / NULLIF("Total_Transactions", 0)) * 100 AS "Percentage_of_CoinJoin_Transactions",
    "Avg_Input_Output_Ratio",
    ("CoinJoin_Volume" / NULLIF("Total_Volume", 0)) * 100 AS "CoinJoin_Transaction_Volume_Proportion"
  FROM monthly_stats
)
SELECT
  "Month",
  ROUND("Percentage_of_CoinJoin_Transactions",1) AS "Percentage_of_CoinJoin_Transactions",
  ROUND("Avg_Input_Output_Ratio",1) AS "Average_Input_Output_UTXOs_Ratio",
  ROUND("CoinJoin_Transaction_Volume_Proportion",1) AS "CoinJoin_Transaction_Volume_Proportion"
FROM final_stats
ORDER BY "CoinJoin_Transaction_Volume_Proportion" DESC NULLS LAST
LIMIT 1;
2025-01-24 08:26:07 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 08:26:07 - root - INFO - ```sql
WITH monthly_stats AS (
  SELECT
    EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
    COUNT(CASE WHEN "is_coinbase" = false THEN 1 END) AS "Total_Transactions",
    COUNT(CASE WHEN "is_coinbase" = false AND "input_count" >= 5 AND "output_count" >= 5 THEN 1 END) AS "CoinJoin_Transactions",
    SUM(CASE WHEN "is_coinbase" = false THEN "output_value" END) AS "Total_Volume",
    SUM(CASE WHEN "is_coinbase" = false AND "input_count" >= 5 AND "output_count" >=5 THEN "output_value" END) AS "CoinJoin_Volume",
    AVG(CASE WHEN "is_coinbase" = false AND "input_count" >= 5 AND "output_count" >=5 THEN "input_count"::FLOAT / NULLIF("output_count", 0) END) AS "Avg_Input_Output_Ratio"
  FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
  WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
  GROUP BY "Month"
), final_stats AS (
  SELECT
    "Month",
    ("CoinJoin_Transactions"::FLOAT / NULLIF("Total_Transactions", 0)) * 100 AS "Percentage_of_CoinJoin_Transactions",
    "Avg_Input_Output_Ratio",
    ("CoinJoin_Volume" / NULLIF("Total_Volume", 0)) * 100 AS "CoinJoin_Transaction_Volume_Proportion"
  FROM monthly_stats
)
SELECT
  "Month",
  ROUND("Percentage_of_CoinJoin_Transactions",4) AS "Percentage_of_CoinJoin_Transactions",
  ROUND("Avg_Input_Output_Ratio",4) AS "Average_Input_Output_UTXOs_Ratio",
  ROUND("CoinJoin_Transaction_Volume_Proportion",4) AS "CoinJoin_Transaction_Volume_Proportion"
FROM final_stats
ORDER BY "CoinJoin_Transaction_Volume_Proportion" DESC NULLS LAST
LIMIT 1;
```
2025-01-24 08:26:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:26:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:26:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:26:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 08:26:09 - snowflake.connector.connection - INFO - closed
2025-01-24 08:26:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:26:09 - root - INFO - itercount: 3
2025-01-24 08:26:09 - root - INFO - 0
2025-01-24 08:26:09 - root - INFO - results: 
Month,Percentage_of_CoinJoin_Transactions,Average_Input_Output_UTXOs_Ratio,CoinJoin_Transaction_Volume_Proportion
12,0.7018,2.6724,0.1752


2025-01-24 08:26:09 - root - INFO - Please check the answer again by reviewing Which month (e.g., 3) in 2021 witnessed the highest percent of Bitcoin volume that took place in CoinJoin transactions? Also give me the percentage of CoinJoins transactions, the average input and output UTXOs ratio, and the proportion of CoinJoin transaction volume for that month (all 1 decimal)., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: To determine which month in 2021 witnessed the highest percentage of Bitcoin volume in CoinJoin transactions, you would need to analyze the transaction data in your `CRYPTO_BITCOIN` schema, specifically the `TRANSACTIONS`, `INPUTS`, and `OUTPUTS` tables.

Once you've performed the analysis, you can present the results in the following CSV format:

```csv
Month,Percentage_of_CoinJoin_Transactions,Average_Input_Output_UTXOs_Ratio,CoinJoin_Transaction_Volume_Proportion
month_number,percentage_transactions:float,average_ratio:float,volume_proportion:float
(Attention: answer in one row)
```

**Explanation:**

- **Month**: The numerical representation of the month in 2021 (e.g., `3` for March).
- **Percentage_of_CoinJoin_Transactions**: The percentage of all Bitcoin transactions in that month that were identified as CoinJoin transactions (rounded to one decimal place).
- **Average_Input_Output_UTXOs_Ratio**: The average ratio of input to output UTXOs in CoinJoin transactions for that month (rounded to one decimal place).
- **CoinJoin_Transaction_Volume_Proportion**: The proportion of Bitcoin volume that took place in CoinJoin transactions compared to the total transaction volume for that month (rounded to one decimal place and expressed as a percentage).

To calculate these values:

1. **Identify CoinJoin Transactions**: CoinJoin transactions typically have multiple inputs and outputs from multiple parties. You can identify them by looking for transactions with a high number of inputs and outputs, where output amounts are often equal.

2. **Calculate Percentages**:
   - **Percentage of CoinJoin Transactions**: `(Number of CoinJoin Transactions / Total Transactions) * 100`
   - **CoinJoin Transaction Volume Proportion**: `(Total Volume of CoinJoin Transactions / Total Transaction Volume) * 100`

3. **Compute Average Input/Output UTXOs Ratio**: For each CoinJoin transaction, calculate the ratio of input UTXOs to output UTXOs, then compute the average ratio for the month.

Please replace the placeholders with your actual calculated values. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Month,Percentage_of_CoinJoin_Transactions,Average_Input_Output_UTXOs_Ratio,CoinJoin_Transaction_Volume_Proportion
12,0.7018,2.6724,0.1752
Current sql:
WITH monthly_stats AS (
  SELECT
    EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
    COUNT(CASE WHEN "is_coinbase" = false THEN 1 END) AS "Total_Transactions",
    COUNT(CASE WHEN "is_coinbase" = false AND "input_count" >= 5 AND "output_count" >= 5 THEN 1 END) AS "CoinJoin_Transactions",
    SUM(CASE WHEN "is_coinbase" = false THEN "output_value" END) AS "Total_Volume",
    SUM(CASE WHEN "is_coinbase" = false AND "input_count" >= 5 AND "output_count" >=5 THEN "output_value" END) AS "CoinJoin_Volume",
    AVG(CASE WHEN "is_coinbase" = false AND "input_count" >= 5 AND "output_count" >=5 THEN "input_count"::FLOAT / NULLIF("output_count", 0) END) AS "Avg_Input_Output_Ratio"
  FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
  WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
  GROUP BY "Month"
), final_stats AS (
  SELECT
    "Month",
    ("CoinJoin_Transactions"::FLOAT / NULLIF("Total_Transactions", 0)) * 100 AS "Percentage_of_CoinJoin_Transactions",
    "Avg_Input_Output_Ratio",
    ("CoinJoin_Volume" / NULLIF("Total_Volume", 0)) * 100 AS "CoinJoin_Transaction_Volume_Proportion"
  FROM monthly_stats
)
SELECT
  "Month",
  ROUND("Percentage_of_CoinJoin_Transactions",4) AS "Percentage_of_CoinJoin_Transactions",
  ROUND("Avg_Input_Output_Ratio",4) AS "Average_Input_Output_UTXOs_Ratio",
  ROUND("CoinJoin_Transaction_Volume_Proportion",4) AS "CoinJoin_Transaction_Volume_Proportion"
FROM final_stats
ORDER BY "CoinJoin_Transaction_Volume_Proportion" DESC NULLS LAST
LIMIT 1;
2025-01-24 08:27:04 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-12-01-preview "HTTP/1.1 200 OK"
2025-01-24 08:27:04 - root - INFO - ```sql
WITH monthly_stats AS (
  SELECT
    EXTRACT(MONTH FROM "block_timestamp_month") AS "Month",
    COUNT(CASE WHEN "is_coinbase" = false THEN 1 END) AS "Total_Transactions",
    COUNT(CASE WHEN "is_coinbase" = false AND "input_count" >= 5 AND "output_count" >= 5 THEN 1 END) AS "CoinJoin_Transactions",
    SUM(CASE WHEN "is_coinbase" = false THEN "output_value" END) AS "Total_Volume",
    SUM(CASE WHEN "is_coinbase" = false AND "input_count" >= 5 AND "output_count" >=5 THEN "output_value" END) AS "CoinJoin_Volume",
    AVG(CASE WHEN "is_coinbase" = false AND "input_count" >= 5 AND "output_count" >=5 THEN "input_count"::FLOAT / NULLIF("output_count", 0) END) AS "Avg_Input_Output_Ratio"
  FROM "CRYPTO"."CRYPTO_BITCOIN"."TRANSACTIONS"
  WHERE "block_timestamp_month" >= '2021-01-01' AND "block_timestamp_month" < '2022-01-01'
  GROUP BY "Month"
), final_stats AS (
  SELECT
    "Month",
    ("CoinJoin_Transactions"::FLOAT / NULLIF("Total_Transactions", 0)) * 100 AS "Percentage_of_CoinJoin_Transactions",
    "Avg_Input_Output_Ratio",
    ("CoinJoin_Volume" / NULLIF("Total_Volume", 0)) * 100 AS "CoinJoin_Transaction_Volume_Proportion"
  FROM monthly_stats
)
SELECT
  "Month",
  ROUND("Percentage_of_CoinJoin_Transactions",4) AS "Percentage_of_CoinJoin_Transactions",
  ROUND("Avg_Input_Output_Ratio",4) AS "Average_Input_Output_UTXOs_Ratio",
  ROUND("CoinJoin_Transaction_Volume_Proportion",4) AS "CoinJoin_Transaction_Volume_Proportion"
FROM final_stats
ORDER BY "CoinJoin_Transaction_Volume_Proportion" DESC NULLS LAST
LIMIT 1;
```
2025-01-24 08:27:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-24 08:27:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-24 08:27:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-24 08:27:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-24 08:27:05 - snowflake.connector.connection - INFO - closed
2025-01-24 08:27:06 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-24 08:27:06 - root - INFO - itercount: 4
2025-01-24 08:27:06 - root - INFO - 0
2025-01-24 08:27:06 - root - INFO - Total iteration counts: 4
