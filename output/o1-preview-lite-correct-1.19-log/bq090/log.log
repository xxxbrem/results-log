2025-01-19 05:23:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 05:24:05 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 05:24:07 - root - INFO - SQL:
SELECT DISTINCT side.Side
   FROM `bigquery-public-data.cymbal_investments.trade_capture_report`, 
   UNNEST(Sides) AS side
   LIMIT 1000;
Results:
Side
LONG
SHORT

2025-01-19 05:24:09 - root - INFO - SQL:
SELECT DISTINCT party.PartyID
   FROM `bigquery-public-data.cymbal_investments.trade_capture_report`, 
   UNNEST(Sides) AS side, 
   UNNEST(side.PartyIDs) AS party
   LIMIT 1000;
Results:
PartyID
MOMOES
MOMONQ
LUCKYES
LUCKYNQ
MOMOBTC
LUCKYBTC
PREDICTES
PREDICTNQ
PREDICTBTC

2025-01-19 05:24:25 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 05:24:25 - root - INFO - ```sql
SELECT DISTINCT party.PartyID
FROM `bigquery-public-data.cymbal_investments.trade_capture_report`, 
UNNEST(Sides) AS side, 
UNNEST(side.PartyIDs) AS party
WHERE LOWER(party.PartyID) LIKE '%lucky%' 
   OR LOWER(party.PartyID) LIKE '%momo%'
LIMIT 1000;
```
2025-01-19 05:25:06 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 05:25:06 - root - INFO - SQL:
SELECT DISTINCT party.PartyID
FROM `bigquery-public-data.cymbal_investments.trade_capture_report`, 
UNNEST(Sides) AS side, 
UNNEST(side.PartyIDs) AS party
WHERE LOWER(party.PartyID) LIKE '%lucky%' 
   OR LOWER(party.PartyID) LIKE '%momo%'
LIMIT 1000;
Results:
PartyID
MOMOES
MOMONQ
LUCKYES
LUCKYNQ
MOMOBTC
LUCKYBTC

2025-01-19 05:25:08 - root - INFO - SQL:
SELECT DISTINCT SenderCompID
FROM `bigquery-public-data.cymbal_investments.trade_capture_report`
LIMIT 1000
Results:
SenderCompID
MDOC

2025-01-19 05:25:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 05:25:39 - root - INFO - ```sql
SELECT 
  CASE 
    WHEN LOWER(party.PartyID) LIKE '%lucky%' THEN 'lucky'
    WHEN LOWER(party.PartyID) LIKE '%momo%' THEN 'momo'
  END AS strategy,
  AVG(t.StrikePrice - t.LastPx) AS avg_intrinsic_value
FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t,
UNNEST(Sides) AS side,
UNNEST(side.PartyIDs) AS party
WHERE LOWER(side.Side) = 'long'
  AND (LOWER(party.PartyID) LIKE '%lucky%' OR LOWER(party.PartyID) LIKE '%momo%')
GROUP BY strategy
```
2025-01-19 05:26:30 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 05:26:30 - root - INFO - SQL:
SELECT 
  CASE 
    WHEN LOWER(party.PartyID) LIKE '%lucky%' THEN 'lucky'
    WHEN LOWER(party.PartyID) LIKE '%momo%' THEN 'momo'
  END AS strategy,
  AVG(t.StrikePrice - t.LastPx) AS avg_intrinsic_value
FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t,
UNNEST(Sides) AS side,
UNNEST(side.PartyIDs) AS party
WHERE LOWER(side.Side) = 'long'
  AND (LOWER(party.PartyID) LIKE '%lucky%' OR LOWER(party.PartyID) LIKE '%momo%')
GROUP BY strategy
Results:
strategy,avg_intrinsic_value
momo,-0.01660770374277693
lucky,0.006461746030370916

2025-01-19 05:26:32 - root - INFO - SQL:
SELECT DISTINCT CFICode
FROM `bigquery-public-data.cymbal_investments.trade_capture_report`
LIMIT 1000
Results:
CFICode
MMMXXX

2025-01-19 05:26:34 - root - INFO - SQL:
SELECT *
FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t, 
UNNEST(Sides) AS side
WHERE side.Side = 'LONG'
LIMIT 1000
Results:
Too long, hard cut:
SendingTime,TargetCompID,SenderCompID,Symbol,Quantity,OrderID,TransactTime,StrikePrice,LastPx,MaturityDate,TradeReportID,TradeDate,CFICode,Sides,Side,OrderID_1,PartyIDs
2020-05-18 17:22:08+00:00,MOMOES-COMPID,MDOC,ESM0,1,941cec35-a984-4748-a4e5-202c8005c284,2020-05-18 17:22:09.166000+00:00,2953.375,2952.375,2020-05-18 17:23:09.166000+00:00,941cec35-a984-4748-a4e5-202c8005c284-0,2020-05-18,MMMXXX,"[{'Side': 'LONG', 'OrderID': '941cec35-a984-4748-a4e5-202c8005c284', 'PartyIDs': [{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]}]",LONG,941cec35-a984-4748-a4e5-202c8005c284,"[{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]"
2020-05-18 17:24:42+00:00,MOMOES-COMPID,MDOC,ESM0,1,e2475938-6771-462c-aa1e-037eb1da9ec3,2020-05-18 17:24:42.808000+00:00,2952.625,2952.875,2020-05-18 17:25:42.808000+00:00,e2475938-6771-462c-aa1e-037eb1da9ec3-0,2020-05-18,MMMXXX,"[{'Side': 'LONG', 'OrderID': 'e2475938-6771-462c-aa1e-037eb1da9ec3', 'PartyIDs': [{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]}]",LONG,e2475938-6771-462c-aa1e-037eb1da9ec3,"[{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]"
2020-05-18 17:47:27+00:00,MOMOES-COMPID,MDOC,ESM0,1,01644bd7-e8a9-4dd2-82a4-8764a9e239a9,2020-05-18 17:47:28.282000+00:00,2953.625,2952.125,2020-05-18 17:48:28.282000+00:00,01644bd7-e8a9-4dd2-82a4-8764a9e239a9-0,2020-05-18,MMMXXX,"[{'Side': 'LONG', 'OrderID': '01644bd7-e8a9-4dd2-82a4-8764a9e239a9', 'PartyIDs': [{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]}]",LONG,01644bd7-e8a9-4dd2-82a4-8764a9e239a9,"[{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]"
2020-05-18 18:00:09+00:00,MOMOES-COMPID,MDOC,ESM0,1,0da7c30c-8518-48fe-80ac-6fe0332bb0c1,2020-05-18 18:00:10.385000+00:00,2953.875,2953.125,2020-05-18 18:01:10.385000+00:00,0da7c30c-8518-48fe-80ac-6fe0332bb0c1-0,2020-05-18,MMMXXX,"[{'Side': 'LONG', 'OrderID': '0da7c30c-8518-48fe-80ac-6fe0332bb0c1', 'PartyIDs': [{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]}]",LONG,0da7c30c-8518-48fe-80ac-6fe0332bb0c1,"[{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]"
2020-05-18 18:01:33+00:00,MOMOES-COMPID,MDOC,ESM0,1,c0b13981-d5bf-4db1-8091-bc12eb8bd82b,2020-05-18 18:01:33.801000+00:00,2953.625,2954.125,2020-05-18 18:02:33.801000+00:00,c0b13981-d5bf-4db1-8091-bc12eb8bd82b-0,2020-05-18,MMMXXX,"[{'Side': 'LONG', 'OrderID': 'c0b13981-d5bf-4db1-8091-bc12eb8bd82b', 'PartyIDs': [{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]}]",LONG,c0b13981-d5bf-4db1-8091-bc12eb8bd82b,"[{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]"
2020-05-18 18:04:36+00:00,MOMOES-COMPID,MDOC,ESM0,1,aac40cae-8951-4bde-afeb-8d4bd04bdad4,2020-05-18 18:04:36.775000+00:00,2956.125,2956.125,2020-05-18 18:05:36.775000+00:00,aac40cae-8951-4bde-afeb-8d4bd04bdad4-0,2020-05-18,MMMXXX,"[{'Side': 'LONG', 'OrderID': 'aac40cae-8951-4bde-afeb-8d4bd04bdad4', 'PartyIDs': [{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]}]",LONG,aac40cae-8951-4bde-afeb-8d4bd04bdad4,"[{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]"
2020-05-18 18:08:26+00:00,MOMOES-COMPID,MDOC,ESM0,1,8d47d94d-92ee-438c-929d-9381a26d923f,2020-05-18 18:08:27.374000+00:00,2952.125,2954.375,2020-05-18 18:09:27.374000+00:00,8d47d94d-92ee-438c-929d-9381a26d923f-0,2020-05-18,MMMXXX,"[{'Side': 'LONG', 'OrderID': '8d47d94d-92ee-438c-929d-9381a26d923f', 'PartyIDs': [{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]}]",LONG,8d47d94d-92ee-438c-929d-9381a26d923f,"[{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]"
2020-05-18 18:34:00+00:00,MOMOES-COMPID,MDOC,ESM0,1,15d5d37d-4e8b-4733-8d76-ba3e17fdf795,2020-05-18 18:34:07.094000+00:00,2954.625,2954.875,2020-05-18 18:35:07.094000+00:00,15d5d37d-4e8b-4733-8d76-ba3e17fdf795-0,2020-05-18,MMMXXX,"[{'Side': 'LONG', 'OrderID': '15d5d37d-4e8b-4733-8d76-ba3e17fdf795', 'PartyIDs': [{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]}]",LONG,15d5d37d-4e8b-4733-8d76-ba3e17fdf795,"[{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]"
2020-05-18 18:35:23+00:00,MOMOES-COMPID,MDOC,ESM0,1,ffb471a2-af58-432c-9257-8039e93a0a14,2020-05-18 18:35:24.418000+00:00,2954.875,2954.625,2020-05-18 18:36:24.418000+00:00,ffb471a2-af58-432c-9257-8039e93a0a14-0,2020-05-18,MMMXXX,"[{'Side': 'LONG', 'OrderID': 'ffb471a2-af58-432c-9257-8039e93a0a14', 'PartyIDs': [{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]}]",LONG,ffb471a2-af58-432c-9257-8039e93a0a14,"[{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]"
2020-05-18 18:39

2025-01-19 05:26:36 - root - INFO - SQL:
SELECT party.PartyID, AVG(t.StrikePrice) AS avg_strike_price
FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t,
UNNEST(Sides) AS side,
UNNEST(side.PartyIDs) AS party
WHERE side.Side = 'LONG'
GROUP BY party.PartyID
LIMIT 1000
Results:
PartyID,avg_strike_price
MOMOES,3270.0658570163487
MOMONQ,10995.11875084931
LUCKYES,3339.0445850944493
LUCKYNQ,10931.961821299525
MOMOBTC,12139.427802294786
LUCKYBTC,11611.033421952154
PREDICTES,3298.5604822273503
PREDICTNQ,11012.582432432433
PREDICTBTC,11258.958970941123

2025-01-19 05:26:38 - root - INFO - SQL:
SELECT DISTINCT party.PartyRole
FROM `bigquery-public-data.cymbal_investments.trade_capture_report`,
UNNEST(Sides) AS side,
UNNEST(side.PartyIDs) AS party
LIMIT 1000
Results:
PartyRole
INITIATING TRADER

2025-01-19 05:26:40 - root - INFO - SQL:
SELECT DISTINCT t.Symbol
FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t,
UNNEST(Sides) AS side,
UNNEST(side.PartyIDs) AS party
WHERE side.Side = 'LONG' 
  AND LOWER(party.PartyID) LIKE '%lucky%'
LIMIT 1000
Results:
Symbol
ESM0
ESU0
ESZ0
NQM0
NQU0
NQZ0
BTCK0
BTCN0
BTCQ0
BTCU0
BTCV0
BTCZ0

2025-01-19 05:26:42 - root - INFO - SQL:
SELECT DISTINCT t.Symbol
FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t,
UNNEST(Sides) AS side,
UNNEST(side.PartyIDs) AS party
WHERE side.Side = 'LONG' 
  AND LOWER(party.PartyID) LIKE '%momo%'
LIMIT 1000
Results:
Symbol
ESM0
ESU0
ESZ0
NQM0
NQU0
NQZ0
BTCK0
BTCM0
BTCN0
BTCU0
BTCV0
BTCZ0

2025-01-19 05:26:44 - root - INFO - SQL:
SELECT 
  CASE 
    WHEN LOWER(party.PartyID) LIKE '%lucky%' THEN 'lucky'
    WHEN LOWER(party.PartyID) LIKE '%momo%' THEN 'momo'
    ELSE 'other'
  END AS strategy,
  COUNT(*) AS trade_count
FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t,
UNNEST(Sides) AS side,
UNNEST(side.PartyIDs) AS party
WHERE side.Side = 'LONG'
GROUP BY strategy
LIMIT 1000
Results:
strategy,trade_count
momo,166828
lucky,230878
other,381544

2025-01-19 05:26:46 - root - INFO - SQL:
SELECT 
  CASE 
    WHEN LOWER(party.PartyID) LIKE '%lucky%' THEN 'lucky'
    WHEN LOWER(party.PartyID) LIKE '%momo%' THEN 'momo'
    ELSE 'other'
  END AS strategy,
  AVG(t.LastPx) AS avg_last_px
FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t,
UNNEST(Sides) AS side,
UNNEST(side.PartyIDs) AS party
WHERE side.Side = 'LONG'
GROUP BY strategy
LIMIT 1000
Results:
strategy,avg_last_px
momo,7842.739364075572
lucky,8837.999898214643
other,7215.267011144189

2025-01-19 05:26:49 - root - INFO - SQL:
SELECT DISTINCT t.TradeReportID, 
  CASE 
    WHEN LOWER(party.PartyID) LIKE '%lucky%' THEN 'lucky'
    WHEN LOWER(party.PartyID) LIKE '%momo%' THEN 'momo'
    ELSE 'other'
  END AS strategy
FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t,
UNNEST(Sides) AS side,
UNNEST(side.PartyIDs) AS party
WHERE side.Side = 'LONG'
LIMIT 1000
Results:
Too long, hard cut:
TradeReportID,strategy
9b714e1a-f0af-4bf5-a9b2-e347a1684570-0,momo
28150993-e066-46a4-8fdb-335cbe22faf0-0,momo
01feee11-69d1-4a2e-b36a-9ebba87736e6-0,momo
48fe371f-f591-4840-8e9c-6d9f5891ac11-0,momo
840efeb4-19b9-4bcd-9f49-39b5860a4839-0,momo
c0e59831-9d93-4e84-8225-ae9f69bd372c-0,momo
45754918-2d7a-4d3c-a2e1-e576408a3b6d-0,momo
0bb20482-2074-4d0c-8a8e-bd8036e71f5f-0,momo
c8fba02e-cc8b-4dad-ab13-511fb6410e8c-0,momo
516dd0f6-3aa7-4f2e-b139-c31b68be6502-0,momo
dfe79093-86f2-4c3f-b80d-8d12cfe90ccc-0,momo
b246a020-d478-45e4-902a-7e49b9d6435f-0,momo
eb6923c0-49f9-49e1-bf41-d294f6cf4663-0,momo
e0d857f6-fdb3-41a5-a852-b028f3b33715-0,momo
6d36cc04-f932-4082-b172-909cef2778d6-0,momo
13f84ec0-2541-49d4-bc0f-cda7e100b262-0,momo
084b933c-0e83-4ab9-b197-dc46a8947dc2-0,momo
2e8b9e61-ec83-4bbe-b58b-b7cfbb842926-0,momo
dea5784b-c9c4-4456-9c97-5def6d979b2b-0,momo
74c822dd-a4e0-4758-812f-0f99cf7ae2f4-0,momo
5d3df63d-4bf8-4acb-8084-7296ed57d820-0,momo
a02f81df-7983-49ba-a0ca-e78314e01a45-0,momo
3ee25339-a105-4be0-bf81-a8cd27010c25-0,momo
5ef10390-0f9e-4a87-9447-80a5297f02c4-0,momo
115cc308-4003-4734-82d2-bda11de04ac7-0,momo
3c48b3f0-b341-4dfa-a26f-20d40dcdc1b4-0,momo
ced9e10e-2f1a-46be-a987-2e4edbe1e2fa-0,momo
cf8a7898-bb04-4127-89a5-5db5433f06b5-0,momo
b793d3d3-42f0-44de-8f60-4a049d0ad454-0,momo
70e53ae5-387a-4168-8e13-5ca14ba7055c-0,momo
94d3fee1-9df7-4161-8e33-afb26f43ba84-0,momo
e7ad788f-2eca-4252-8f89-f572e24ed65b-0,momo
a77247c9-0aa3-4aa3-b736-74d15ee17756-0,momo
48666f41-3507-456b-a9bd-d942dd92cd7f-0,momo
da34e1e6-a5c2-4e6b-bba1-4bc5e136a2cc-0,momo
071efa5e-1513-4873-b831-1db5e2c131db-0,momo
09028b79-66a7-415e-91b1-b1721a7ce8a4-0,momo
d94098c0-c8dd-46f7-89ae-510850771bdd-0,momo
ed4dff23-961a-4a51-89b0-0009b25af117-0,momo
a8de7074-5d45-43ce-a804-9117b86a70fa-0,momo
6861cc17-3163-4149-941c-f035ff8fd8ef-0,momo
f05b4e4f-2257-4454-842e-6d6304169889-0,momo
8d94d916-912c-4590-95da-846edc4f92c7-0,momo
b348b2ed-6369-4a47-ad1a-e95bd3b4a205-0,momo
81da75a4-0901-4521-a31e-48e62fb9945d-0,momo
1ae08af3-ba99-4a8c-8c98-0d4a76fa04b4-0,momo
12192413-9669-4d96-9ce7-af45dadde3fc-0,momo
c630a218-a524-45b4-ad13-c7c7fb7ca557-0,momo
a68c0078-c56f-495f-8e23-edf6546d22d2-0,momo
4e026ebe-6db0-414e-9a10-a642e3a98ed8-0,momo
f3890a7d-15f8-4e2b-8caa-83cf056bb6a9-0,momo
2c69a7dc-c16a-400a-b724-9da51f5509d1-0,momo
f88ce14b-2c3a-4d84-8628-d8e61bb152d3-0,momo
135d80c0-556b-4e72-9a2b-31ad4d520f4b-0,momo
fd92d81f-98bc-4509-8dfc-774be7eff8eb-0,momo
08b4a8e7-5c89-49dd-b6c6-1d2d74151c5e-0,momo
bab3f26e-c418-41f7-a259-2edd91529e6c-0,momo
6497b826-c493-4d2c-a1c0-977614ac8d3e-0,momo
a31008ce-2045-4679-8de6-7726c7ef7538-0,momo
1d848c46-bc8d-4be7-bc7b-ac365975522c-0,momo
780a7e8d-c9a5-4428-8a9d-3c9126eeff39-0,momo
94d92855-6704-41c5-9597-786884aded06-0,momo
fc2e0174-2b0b-4b1d-b9d1-958d8ac653d2-0,momo
b0a699f7-d659-4d1f-8368-bc3ba90d0118-0,momo
4eca185c-9e2c-499f-8aac-1dec1324a95d-0,momo
72eaf8fb-a6b8-4821-b014-757c74735389-0,momo
f7554db4-d94a-47cf-9036-4881131c0eda-0,momo
770b6541-2344-4cb6-ae10-1575b9393be4-0,momo
d743a293-bb88-4b61-8199-62e151b4bb48-0,momo
0c5ce0ee-a49e-4722-b81d-064dfb150b3c-0,momo
4aab3386-3caa-4dc0-9e8d-744288ff2992-0,momo
fb1998c5-6a74-48bf-8aa6-7a0cb45c973d-0,momo
867cd8dc-c1ed-4113-899b-0543125a4819-0,momo
b4af693c-91c7-4b30-934d-03959846d2e6-0,momo
a2734fe3-b1e1-42d1-a8f0-d25668ca994d-0,momo
dd5f03b4-ffbb-4265-b459-45102b02cdfe-0,momo
959c8167-f63f-4cf7-8498-f46076067584-0,momo
419802b8-734b-4c87-8d89-6ffd6d1240a9-0,momo
3f802557-a753-4cb7-a49a-61eba0632d66-0,momo
ab5f0ecf-e796-4797-b708-f46d8e61ab9d-0,momo
b6966401-d404-41d5-b232-3832713e8b0a-0,momo
70f2ffe2-af0c-4615-b63d-ced647789371-0,momo
10a5bf49-6b28-4b51-b8a8-e4871f42a8a7-0,momo
9b3b1eb8-79bb-4dea-8ca6-d7160ff56e98-0,momo
3c33c430-6d03-4179-8dc1-7d9df021fa9a-0,momo
a470612b-79f3-4469-a578-92e9a633f368-0,momo
a43f5a80-2f6e-46e9-9c70-dcf097d8887b-0,momo
fc072b27-7bb9-4cbd-b1f2-c7ac58f0d2dd-0,momo
e37120e5-763a-4173-8616-1654c13b7bf8-0,momo
94ff3d3e-19c5-4d01-b12f-c19bd0665c53-0,momo
11624afa-e16c-463d-a591-44734d8ea1ae-0,momo
e6248477-6964-49d3-922a-1bba4f0657fd-0,momo
4ce0354a-5532-41cb-9afd-b364f366f2b0-0,momo
b4b44fee-675f-4213-94af-5feb266d98b2-0,momo
7d70a1e5-5781-4e6d-a055-63c5ac96c775-0,momo
0a0ca590-eeb3-46fe-959a-61191b992fab-0,momo
a4270289-719b-466c-9acb-8f3ef61d5a73-0,momo
4637ec8d-b064-46bc-9dec-8b72efcade7e-0,momo
4de26240-6e35-4df1-b7c2-03d2ef52c1d6-0,momo
6ea1d66d-4bc2-4483-a3e4-37e107bc6961-0,momo
7824ac89-65aa-4a5a-8092-553a288e450b-0,momo
9c3f31a0-3e69-43bb-b121-4db73b439042-0,momo
bf43f650-1cb5-4cd9-969a-ed0a361bdb2e-0,momo
733d0852-c8cd-4bde-aef6-590c7f567b1e-0,momo
45662c70-2c3c-41ac-b765-514030a06f66-0,momo
447c0547-aa67-45e6-bbe1-3cd7255b4240-0,momo
d22cf05f-919b-47b5-a1d5-c5ccee8f8a40-0,momo
d0ec97e6-929b-4257-848c-88dd6a0b2daf-0,momo
d8dc654c-9668-42c3-9370-3d17d0dc32e8-0,momo
643cf646-4971-4929-9ae6-b6efebbd9070-0,momo
ae9b2891-ecad-4d8e-aa3d-b197eb5e0e8e-0,momo
ad5e47b8-de12-42e4-940b-271e4c89e850-0,momo
e2f3efea-9292-4730-9826-6b5345f2e3c7-0,momo
3aee3

2025-01-19 05:26:50 - root - INFO - SQL:
SELECT t.TradeDate, 
  CASE 
    WHEN LOWER(party.PartyID) LIKE '%lucky%' THEN 'lucky'
    WHEN LOWER(party.PartyID) LIKE '%momo%' THEN 'momo'
    ELSE 'other'
  END AS strategy
FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t,
UNNEST(Sides) AS side,
UNNEST(side.PartyIDs) AS party
WHERE side.Side = 'LONG'
LIMIT 1000
Results:
Too long, hard cut:
TradeDate,strategy
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-

2025-01-19 05:26:50 - root - INFO - itercount: 0
2025-01-19 05:26:50 - root - INFO - Database Name: bigquery-public-data
Schema Name: cymbal_investments
DDL describes table information.
,0
table_name,trade_capture_report
ddl,"CREATE TABLE `bigquery-public-data.cymbal_investments.trade_capture_report`
(
  SendingTime TIMESTAMP OPTIONS(description=""Time the message was sent""),
  TargetCompID STRING OPTIONS(description=""Assigned value used to identify firm receiving message.""),
  SenderCompID STRING OPTIONS(description=""Assigned value used to identify firm sending message.""),
  Symbol STRING OPTIONS(description=""Trading symbol of the asset""),
  Quantity INT64 OPTIONS(description=""Overall/total quantity (e.g. number of shares)""),
  OrderID STRING OPTIONS(description=""Order identifier""),
  TransactTime TIMESTAMP OPTIONS(description=""Time the transaction occured""),
  StrikePrice FLOAT64 OPTIONS(description=""Price at which the CFD closed""),
  LastPx FLOAT64 OPTIONS(description=""Price at which the CFD was entered""),
  MaturityDate TIMESTAMP OPTIONS(description=""Date of contract expiry""),
  TradeReportID STRING OPTIONS(description=""ID of this trade report""),
  TradeDate DATE OPTIONS(description=""Date trade was executed""),
  CFICode STRING OPTIONS(description=""Financial instrument classification code""),
  Sides ARRAY<STRUCT<Side STRING OPTIONS(description=""Direction of the trade (long or short)""), OrderID STRING OPTIONS(description=""""), PartyIDs ARRAY<STRUCT<PartyID STRING OPTIONS(description=""Counterparty identifier""), PartyIDSource STRING, PartyRole STRING OPTIONS(description=""Counterparty irole"")>> OPTIONS(description="""")>>
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'cymbal_investments': ['trade_capture_report']}}
Begin Exploring Related Columns
**Relevant columns and potential usage:**

- **Sides.Side**: Used to determine the direction of the trade (long or short). We can filter trades that are on the long side.
- **PartyIDs.PartyID**: May contain identifiers or metadata that indicate the trading strategy used ('feeling-lucky' or 'momentum').
- **PartyIDs.PartyRole**: Could help in identifying the role associated with the PartyID, possibly indicating a strategy.
- **SenderCompID**: May represent different trading strategies if each strategy uses a different sender ID.
- **Symbol**: Specific symbols might be associated with certain strategies.
- **CFICode**: Could provide classification that differentiates strategies.

**Conditions that may be used:**

- **Filter for long-side trades**: `WHERE LOWER(side.Side) = 'long'`
- **Filter for specific strategies**: 
  - For 'feeling-lucky' strategy: `WHERE LOWER(party.PartyID) LIKE '%feeling-lucky%'`
  - For 'momentum' strategy: `WHERE LOWER(party.PartyID) LIKE '%momentum%'`

---

**SQL Queries:**

1. **Retrieve distinct trade sides to identify possible directions:**
   ```sql
   SELECT DISTINCT side.Side
   FROM `bigquery-public-data.cymbal_investments.trade_capture_report`, 
   UNNEST(Sides) AS side
   LIMIT 1000;
   ```

2. **List distinct PartyIDs to explore potential strategy identifiers:**
   ```sql
   SELECT DISTINCT party.PartyID
   FROM `bigquery-public-data.cymbal_investments.trade_capture_report`, 
   UNNEST(Sides) AS side, 
   UNNEST(side.PartyIDs) AS party
   LIMIT 1000;
   ```

3. **Find all PartyIDs containing 'feeling-lucky' or 'momentum' (case-insensitive):**
   ```sql
   SELECT DISTINCT party.PartyID
   FROM `bigquery-public-data.cymbal_investments.trade_capture_report`, 
   UNNEST(Sides) AS side, 
   UNNEST(side.PartyIDs) AS party
   WHERE LOWER(party.PartyID) LIKE '%feeling-lucky%' 
      OR LOWER(party.PartyID) LIKE '%momentum%'
   LIMIT 1000;
   ```

4. **Get distinct SenderCompIDs to see if they indicate strategies:**
   ```sql
   SELECT DISTINCT SenderCompID
   FROM `bigquery-public-data.cymbal_investments.trade_capture_report`
   LIMIT 1000;
   ```

5. **Filter SenderCompIDs containing 'feeling-lucky' or 'momentum':**
   ```sql
   SELECT DISTINCT SenderCompID
   FROM `bigquery-public-data.cymbal_investments.trade_capture_report`
   WHERE LOWER(SenderCompID) LIKE '%feeling-lucky%' 
      OR LOWER(SenderCompID) LIKE '%momentum%'
   LIMIT 1000;
   ```

6. **List distinct CFICodes to explore instrument classifications:**
   ```sql
   SELECT DISTINCT CFICode
   FROM `bigquery-public-data.cymbal_investments.trade_capture_report`
   LIMIT 1000;
   ```

7. **Retrieve trades on the long side:**
   ```sql
   SELECT *
   FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t, 
   UNNEST(Sides) AS side
   WHERE LOWER(side.Side) = 'long'
   LIMIT 1000;
   ```

8. **Calculate average StrikePrice for long-side trades per PartyID:**
   ```sql
   SELECT party.PartyID, AVG(t.StrikePrice) AS avg_strike_price
   FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t,
   UNNEST(Sides) AS side,
   UNNEST(side.PartyIDs) AS party
   WHERE LOWER(side.Side) = 'long'
   GROUP BY party.PartyID
   LIMIT 1000;
   ```

9. **Find PartyRoles to see if roles indicate strategies:**
   ```sql
   SELECT DISTINCT party.PartyRole
   FROM `bigquery-public-data.cymbal_investments.trade_capture_report`,
   UNNEST(Sides) AS side,
   UNNEST(side.PartyIDs) AS party
   LIMIT 1000;
   ```

10. **Retrieve symbols traded under the 'feeling-lucky' strategy on the long side:**
    ```sql
    SELECT DISTINCT t.Symbol
    FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t,
    UNNEST(Sides) AS side,
    UNNEST(side.PartyIDs) AS party
    WHERE LOWER(side.Side) = 'long' 
      AND LOWER(party.PartyID) LIKE '%feeling-lucky%'
    LIMIT 1000;
    ```

11. **Retrieve symbols traded under the 'momentum' strategy on the long side:**
    ```sql
    SELECT DISTINCT t.Symbol
    FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t,
    UNNEST(Sides) AS side,
    UNNEST(side.PartyIDs) AS party
    WHERE LOWER(side.Side) = 'long' 
      AND LOWER(party.PartyID) LIKE '%momentum%'
    LIMIT 1000;
    ```

12. **Count the number of long-side trades per strategy:**
    ```sql
    SELECT 
      CASE 
        WHEN LOWER(party.PartyID) LIKE '%feeling-lucky%' THEN 'feeling-lucky'
        WHEN LOWER(party.PartyID) LIKE '%momentum%' THEN 'momentum'
        ELSE 'other'
      END AS strategy,
      COUNT(*) AS trade_count
    FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t,
    UNNEST(Sides) AS side,
    UNNEST(side.PartyIDs) AS party
    WHERE LOWER(side.Side) = 'long'
    GROUP BY strategy
    LIMIT 1000;
    ```

13. **Get average LastPx (entry price) for each strategy on long-side trades:**
    ```sql
    SELECT 
      CASE 
        WHEN LOWER(party.PartyID) LIKE '%feeling-lucky%' THEN 'feeling-lucky'
        WHEN LOWER(party.PartyID) LIKE '%momentum%' THEN 'momentum'
        ELSE 'other'
      END AS strategy,
      AVG(t.LastPx) AS avg_last_px
    FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t,
    UNNEST(Sides) AS side,
    UNNEST(side.PartyIDs) AS party
    WHERE LOWER(side.Side) = 'long'
    GROUP BY strategy
    LIMIT 1000;
    ```

14. **List trades with TradeReportID and associated strategies on the long side:**
    ```sql
    SELECT DISTINCT t.TradeReportID, 
      CASE 
        WHEN LOWER(party.PartyID) LIKE '%feeling-lucky%' THEN 'feeling-lucky'
        WHEN LOWER(party.PartyID) LIKE '%momentum%' THEN 'momentum'
        ELSE 'other'
      END AS strategy
    FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t,
    UNNEST(Sides) AS side,
    UNNEST(side.PartyIDs) AS party
    WHERE LOWER(side.Side) = 'long'
    LIMIT 1000;
    ```

15. **Explore TradeDates for trades under different strategies:**
    ```sql
    SELECT t.TradeDate, 
      CASE 
        WHEN LOWER(party.PartyID) LIKE '%feeling-lucky%' THEN 'feeling-lucky'
        WHEN LOWER(party.PartyID) LIKE '%momentum%' THEN 'momentum'
        ELSE 'other'
      END AS strategy
    FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t,
    UNNEST(Sides) AS side,
    UNNEST(side.PartyIDs) AS party
    WHERE LOWER(side.Side) = 'long'
    LIMIT 1000;
    ```

*Note:* These queries are designed to explore the dataset to identify how the trading strategies ('feeling-lucky' or 'momentum') might be represented within the data, specifically focusing on long-side trades. The assumption is that the `PartyID` or `SenderCompID` fields may contain indicators of the strategy used. Adjustments may be required based on actual data content.Query:
SELECT DISTINCT side.Side
   FROM `bigquery-public-data.cymbal_investments.trade_capture_report`, 
   UNNEST(Sides) AS side
   LIMIT 1000;
Answer:
Side
LONG
SHORT
Query:
SELECT DISTINCT party.PartyID
   FROM `bigquery-public-data.cymbal_investments.trade_capture_report`, 
   UNNEST(Sides) AS side, 
   UNNEST(side.PartyIDs) AS party
   LIMIT 1000;
Answer:
PartyID
MOMOES
MOMONQ
LUCKYES
LUCKYNQ
MOMOBTC
LUCKYBTC
PREDICTES
PREDICTNQ
PREDICTBTC
Query:
SELECT DISTINCT party.PartyID
FROM `bigquery-public-data.cymbal_investments.trade_capture_report`, 
UNNEST(Sides) AS side, 
UNNEST(side.PartyIDs) AS party
WHERE LOWER(party.PartyID) LIKE '%lucky%' 
   OR LOWER(party.PartyID) LIKE '%momo%'
LIMIT 1000;
Answer:
PartyID
MOMOES
MOMONQ
LUCKYES
LUCKYNQ
MOMOBTC
LUCKYBTC
Query:
SELECT DISTINCT SenderCompID
FROM `bigquery-public-data.cymbal_investments.trade_capture_report`
LIMIT 1000
Answer:
SenderCompID
MDOC
Query:
SELECT 
  CASE 
    WHEN LOWER(party.PartyID) LIKE '%lucky%' THEN 'lucky'
    WHEN LOWER(party.PartyID) LIKE '%momo%' THEN 'momo'
  END AS strategy,
  AVG(t.StrikePrice - t.LastPx) AS avg_intrinsic_value
FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t,
UNNEST(Sides) AS side,
UNNEST(side.PartyIDs) AS party
WHERE LOWER(side.Side) = 'long'
  AND (LOWER(party.PartyID) LIKE '%lucky%' OR LOWER(party.PartyID) LIKE '%momo%')
GROUP BY strategy
Answer:
strategy,avg_intrinsic_value
momo,-0.01660770374277693
lucky,0.006461746030370916
Query:
SELECT DISTINCT CFICode
FROM `bigquery-public-data.cymbal_investments.trade_capture_report`
LIMIT 1000
Answer:
CFICode
MMMXXX
Query:
SELECT *
FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t, 
UNNEST(Sides) AS side
WHERE side.Side = 'LONG'
LIMIT 1000
Answer:
Too long, hard cut:
SendingTime,TargetCompID,SenderCompID,Symbol,Quantity,OrderID,TransactTime,StrikePrice,LastPx,MaturityDate,TradeReportID,TradeDate,CFICode,Sides,Side,OrderID_1,PartyIDs
2020-05-18 17:22:08+00:00,MOMOES-COMPID,MDOC,ESM0,1,941cec35-a984-4748-a4e5-202c8005c284,2020-05-18 17:22:09.166000+00:00,2953.375,2952.375,2020-05-18 17:23:09.166000+00:00,941cec35-a984-4748-a4e5-202c8005c284-0,2020-05-18,MMMXXX,"[{'Side': 'LONG', 'OrderID': '941cec35-a984-4748-a4e5-202c8005c284', 'PartyIDs': [{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]}]",LONG,941cec35-a984-4748-a4e5-202c8005c284,"[{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]"
2020-05-18 17:24:42+00:00,MOMOES-COMPID,MDOC,ESM0,1,e2475938-6771-462c-aa1e-037eb1da9ec3,2020-05-18 17:24:42.808000+00:00,2952.625,2952.875,2020-05-18 17:25:42.808000+00:00,e2475938-6771-462c-aa1e-037eb1da9ec3-0,2020-05-18,MMMXXX,"[{'Side': 'LONG', 'OrderID': 'e2475938-6771-462c-aa1e-037eb1da9ec3', 'PartyIDs': [{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]}]",LONG,e2475938-6771-462c-aa1e-037eb1da9ec3,"[{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]"
2020-05-18 17:47:27+00:00,MOMOES-COMPID,MDOC,ESM0,1,01644bd7-e8a9-4dd2-82a4-8764a9e239a9,2020-05-18 17:47:28.282000+00:00,2953.625,2952.125,2020-05-18 17:48:28.282000+00:00,01644bd7-e8a9-4dd2-82a4-8764a9e239a9-0,2020-05-18,MMMXXX,"[{'Side': 'LONG', 'OrderID': '01644bd7-e8a9-4dd2-82a4-8764a9e239a9', 'PartyIDs': [{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]}]",LONG,01644bd7-e8a9-4dd2-82a4-8764a9e239a9,"[{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]"
2020-05-18 18:00:09+00:00,MOMOES-COMPID,MDOC,ESM0,1,0da7c30c-8518-48fe-80ac-6fe0332bb0c1,2020-05-18 18:00:10.385000+00:00,2953.875,2953.125,2020-05-18 18:01:10.385000+00:00,0da7c30c-8518-48fe-80ac-6fe0332bb0c1-0,2020-05-18,MMMXXX,"[{'Side': 'LONG', 'OrderID': '0da7c30c-8518-48fe-80ac-6fe0332bb0c1', 'PartyIDs': [{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]}]",LONG,0da7c30c-8518-48fe-80ac-6fe0332bb0c1,"[{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]"
2020-05-18 18:01:33+00:00,MOMOES-COMPID,MDOC,ESM0,1,c0b13981-d5bf-4db1-8091-bc12eb8bd82b,2020-05-18 18:01:33.801000+00:00,2953.625,2954.125,2020-05-18 18:02:33.801000+00:00,c0b13981-d5bf-4db1-8091-bc12eb8bd82b-0,2020-05-18,MMMXXX,"[{'Side': 'LONG', 'OrderID': 'c0b13981-d5bf-4db1-8091-bc12eb8bd82b', 'PartyIDs': [{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]}]",LONG,c0b13981-d5bf-4db1-8091-bc12eb8bd82b,"[{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]"
2020-05-18 18:04:36+00:00,MOMOES-COMPID,MDOC,ESM0,1,aac40cae-8951-4bde-afeb-8d4bd04bdad4,2020-05-18 18:04:36.775000+00:00,2956.125,2956.125,2020-05-18 18:05:36.775000+00:00,aac40cae-8951-4bde-afeb-8d4bd04bdad4-0,2020-05-18,MMMXXX,"[{'Side': 'LONG', 'OrderID': 'aac40cae-8951-4bde-afeb-8d4bd04bdad4', 'PartyIDs': [{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]}]",LONG,aac40cae-8951-4bde-afeb-8d4bd04bdad4,"[{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]"
2020-05-18 18:08:26+00:00,MOMOES-COMPID,MDOC,ESM0,1,8d47d94d-92ee-438c-929d-9381a26d923f,2020-05-18 18:08:27.374000+00:00,2952.125,2954.375,2020-05-18 18:09:27.374000+00:00,8d47d94d-92ee-438c-929d-9381a26d923f-0,2020-05-18,MMMXXX,"[{'Side': 'LONG', 'OrderID': '8d47d94d-92ee-438c-929d-9381a26d923f', 'PartyIDs': [{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]}]",LONG,8d47d94d-92ee-438c-929d-9381a26d923f,"[{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]"
2020-05-18 18:34:00+00:00,MOMOES-COMPID,MDOC,ESM0,1,15d5d37d-4e8b-4733-8d76-ba3e17fdf795,2020-05-18 18:34:07.094000+00:00,2954.625,2954.875,2020-05-18 18:35:07.094000+00:00,15d5d37d-4e8b-4733-8d76-ba3e17fdf795-0,2020-05-18,MMMXXX,"[{'Side': 'LONG', 'OrderID': '15d5d37d-4e8b-4733-8d76-ba3e17fdf795', 'PartyIDs': [{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]}]",LONG,15d5d37d-4e8b-4733-8d76-ba3e17fdf795,"[{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]"
2020-05-18 18:35:23+00:00,MOMOES-COMPID,MDOC,ESM0,1,ffb471a2-af58-432c-9257-8039e93a0a14,2020-05-18 18:35:24.418000+00:00,2954.875,2954.625,2020-05-18 18:36:24.418000+00:00,ffb471a2-af58-432c-9257-8039e93a0a14-0,2020-05-18,MMMXXX,"[{'Side': 'LONG', 'OrderID': 'ffb471a2-af58-432c-9257-8039e93a0a14', 'PartyIDs': [{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]}]",LONG,ffb471a2-af58-432c-9257-8039e93a0a14,"[{'PartyID': 'MOMOES', 'PartyIDSource': 'PROP CODE', 'PartyRole': 'INITIATING TRADER'}]"
2020-05-18 18:39
Query:
SELECT party.PartyID, AVG(t.StrikePrice) AS avg_strike_price
FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t,
UNNEST(Sides) AS side,
UNNEST(side.PartyIDs) AS party
WHERE side.Side = 'LONG'
GROUP BY party.PartyID
LIMIT 1000
Answer:
PartyID,avg_strike_price
MOMOES,3270.0658570163487
MOMONQ,10995.11875084931
LUCKYES,3339.0445850944493
LUCKYNQ,10931.961821299525
MOMOBTC,12139.427802294786
LUCKYBTC,11611.033421952154
PREDICTES,3298.5604822273503
PREDICTNQ,11012.582432432433
PREDICTBTC,11258.958970941123
Query:
SELECT DISTINCT party.PartyRole
FROM `bigquery-public-data.cymbal_investments.trade_capture_report`,
UNNEST(Sides) AS side,
UNNEST(side.PartyIDs) AS party
LIMIT 1000
Answer:
PartyRole
INITIATING TRADER
Query:
SELECT DISTINCT t.Symbol
FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t,
UNNEST(Sides) AS side,
UNNEST(side.PartyIDs) AS party
WHERE side.Side = 'LONG' 
  AND LOWER(party.PartyID) LIKE '%lucky%'
LIMIT 1000
Answer:
Symbol
ESM0
ESU0
ESZ0
NQM0
NQU0
NQZ0
BTCK0
BTCN0
BTCQ0
BTCU0
BTCV0
BTCZ0
Query:
SELECT DISTINCT t.Symbol
FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t,
UNNEST(Sides) AS side,
UNNEST(side.PartyIDs) AS party
WHERE side.Side = 'LONG' 
  AND LOWER(party.PartyID) LIKE '%momo%'
LIMIT 1000
Answer:
Symbol
ESM0
ESU0
ESZ0
NQM0
NQU0
NQZ0
BTCK0
BTCM0
BTCN0
BTCU0
BTCV0
BTCZ0
Query:
SELECT 
  CASE 
    WHEN LOWER(party.PartyID) LIKE '%lucky%' THEN 'lucky'
    WHEN LOWER(party.PartyID) LIKE '%momo%' THEN 'momo'
    ELSE 'other'
  END AS strategy,
  COUNT(*) AS trade_count
FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t,
UNNEST(Sides) AS side,
UNNEST(side.PartyIDs) AS party
WHERE side.Side = 'LONG'
GROUP BY strategy
LIMIT 1000
Answer:
strategy,trade_count
momo,166828
lucky,230878
other,381544
Query:
SELECT 
  CASE 
    WHEN LOWER(party.PartyID) LIKE '%lucky%' THEN 'lucky'
    WHEN LOWER(party.PartyID) LIKE '%momo%' THEN 'momo'
    ELSE 'other'
  END AS strategy,
  AVG(t.LastPx) AS avg_last_px
FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t,
UNNEST(Sides) AS side,
UNNEST(side.PartyIDs) AS party
WHERE side.Side = 'LONG'
GROUP BY strategy
LIMIT 1000
Answer:
strategy,avg_last_px
momo,7842.739364075572
lucky,8837.999898214643
other,7215.267011144189
Query:
SELECT DISTINCT t.TradeReportID, 
  CASE 
    WHEN LOWER(party.PartyID) LIKE '%lucky%' THEN 'lucky'
    WHEN LOWER(party.PartyID) LIKE '%momo%' THEN 'momo'
    ELSE 'other'
  END AS strategy
FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t,
UNNEST(Sides) AS side,
UNNEST(side.PartyIDs) AS party
WHERE side.Side = 'LONG'
LIMIT 1000
Answer:
Too long, hard cut:
TradeReportID,strategy
9b714e1a-f0af-4bf5-a9b2-e347a1684570-0,momo
28150993-e066-46a4-8fdb-335cbe22faf0-0,momo
01feee11-69d1-4a2e-b36a-9ebba87736e6-0,momo
48fe371f-f591-4840-8e9c-6d9f5891ac11-0,momo
840efeb4-19b9-4bcd-9f49-39b5860a4839-0,momo
c0e59831-9d93-4e84-8225-ae9f69bd372c-0,momo
45754918-2d7a-4d3c-a2e1-e576408a3b6d-0,momo
0bb20482-2074-4d0c-8a8e-bd8036e71f5f-0,momo
c8fba02e-cc8b-4dad-ab13-511fb6410e8c-0,momo
516dd0f6-3aa7-4f2e-b139-c31b68be6502-0,momo
dfe79093-86f2-4c3f-b80d-8d12cfe90ccc-0,momo
b246a020-d478-45e4-902a-7e49b9d6435f-0,momo
eb6923c0-49f9-49e1-bf41-d294f6cf4663-0,momo
e0d857f6-fdb3-41a5-a852-b028f3b33715-0,momo
6d36cc04-f932-4082-b172-909cef2778d6-0,momo
13f84ec0-2541-49d4-bc0f-cda7e100b262-0,momo
084b933c-0e83-4ab9-b197-dc46a8947dc2-0,momo
2e8b9e61-ec83-4bbe-b58b-b7cfbb842926-0,momo
dea5784b-c9c4-4456-9c97-5def6d979b2b-0,momo
74c822dd-a4e0-4758-812f-0f99cf7ae2f4-0,momo
5d3df63d-4bf8-4acb-8084-7296ed57d820-0,momo
a02f81df-7983-49ba-a0ca-e78314e01a45-0,momo
3ee25339-a105-4be0-bf81-a8cd27010c25-0,momo
5ef10390-0f9e-4a87-9447-80a5297f02c4-0,momo
115cc308-4003-4734-82d2-bda11de04ac7-0,momo
3c48b3f0-b341-4dfa-a26f-20d40dcdc1b4-0,momo
ced9e10e-2f1a-46be-a987-2e4edbe1e2fa-0,momo
cf8a7898-bb04-4127-89a5-5db5433f06b5-0,momo
b793d3d3-42f0-44de-8f60-4a049d0ad454-0,momo
70e53ae5-387a-4168-8e13-5ca14ba7055c-0,momo
94d3fee1-9df7-4161-8e33-afb26f43ba84-0,momo
e7ad788f-2eca-4252-8f89-f572e24ed65b-0,momo
a77247c9-0aa3-4aa3-b736-74d15ee17756-0,momo
48666f41-3507-456b-a9bd-d942dd92cd7f-0,momo
da34e1e6-a5c2-4e6b-bba1-4bc5e136a2cc-0,momo
071efa5e-1513-4873-b831-1db5e2c131db-0,momo
09028b79-66a7-415e-91b1-b1721a7ce8a4-0,momo
d94098c0-c8dd-46f7-89ae-510850771bdd-0,momo
ed4dff23-961a-4a51-89b0-0009b25af117-0,momo
a8de7074-5d45-43ce-a804-9117b86a70fa-0,momo
6861cc17-3163-4149-941c-f035ff8fd8ef-0,momo
f05b4e4f-2257-4454-842e-6d6304169889-0,momo
8d94d916-912c-4590-95da-846edc4f92c7-0,momo
b348b2ed-6369-4a47-ad1a-e95bd3b4a205-0,momo
81da75a4-0901-4521-a31e-48e62fb9945d-0,momo
1ae08af3-ba99-4a8c-8c98-0d4a76fa04b4-0,momo
12192413-9669-4d96-9ce7-af45dadde3fc-0,momo
c630a218-a524-45b4-ad13-c7c7fb7ca557-0,momo
a68c0078-c56f-495f-8e23-edf6546d22d2-0,momo
4e026ebe-6db0-414e-9a10-a642e3a98ed8-0,momo
f3890a7d-15f8-4e2b-8caa-83cf056bb6a9-0,momo
2c69a7dc-c16a-400a-b724-9da51f5509d1-0,momo
f88ce14b-2c3a-4d84-8628-d8e61bb152d3-0,momo
135d80c0-556b-4e72-9a2b-31ad4d520f4b-0,momo
fd92d81f-98bc-4509-8dfc-774be7eff8eb-0,momo
08b4a8e7-5c89-49dd-b6c6-1d2d74151c5e-0,momo
bab3f26e-c418-41f7-a259-2edd91529e6c-0,momo
6497b826-c493-4d2c-a1c0-977614ac8d3e-0,momo
a31008ce-2045-4679-8de6-7726c7ef7538-0,momo
1d848c46-bc8d-4be7-bc7b-ac365975522c-0,momo
780a7e8d-c9a5-4428-8a9d-3c9126eeff39-0,momo
94d92855-6704-41c5-9597-786884aded06-0,momo
fc2e0174-2b0b-4b1d-b9d1-958d8ac653d2-0,momo
b0a699f7-d659-4d1f-8368-bc3ba90d0118-0,momo
4eca185c-9e2c-499f-8aac-1dec1324a95d-0,momo
72eaf8fb-a6b8-4821-b014-757c74735389-0,momo
f7554db4-d94a-47cf-9036-4881131c0eda-0,momo
770b6541-2344-4cb6-ae10-1575b9393be4-0,momo
d743a293-bb88-4b61-8199-62e151b4bb48-0,momo
0c5ce0ee-a49e-4722-b81d-064dfb150b3c-0,momo
4aab3386-3caa-4dc0-9e8d-744288ff2992-0,momo
fb1998c5-6a74-48bf-8aa6-7a0cb45c973d-0,momo
867cd8dc-c1ed-4113-899b-0543125a4819-0,momo
b4af693c-91c7-4b30-934d-03959846d2e6-0,momo
a2734fe3-b1e1-42d1-a8f0-d25668ca994d-0,momo
dd5f03b4-ffbb-4265-b459-45102b02cdfe-0,momo
959c8167-f63f-4cf7-8498-f46076067584-0,momo
419802b8-734b-4c87-8d89-6ffd6d1240a9-0,momo
3f802557-a753-4cb7-a49a-61eba0632d66-0,momo
ab5f0ecf-e796-4797-b708-f46d8e61ab9d-0,momo
b6966401-d404-41d5-b232-3832713e8b0a-0,momo
70f2ffe2-af0c-4615-b63d-ced647789371-0,momo
10a5bf49-6b28-4b51-b8a8-e4871f42a8a7-0,momo
9b3b1eb8-79bb-4dea-8ca6-d7160ff56e98-0,momo
3c33c430-6d03-4179-8dc1-7d9df021fa9a-0,momo
a470612b-79f3-4469-a578-92e9a633f368-0,momo
a43f5a80-2f6e-46e9-9c70-dcf097d8887b-0,momo
fc072b27-7bb9-4cbd-b1f2-c7ac58f0d2dd-0,momo
e37120e5-763a-4173-8616-1654c13b7bf8-0,momo
94ff3d3e-19c5-4d01-b12f-c19bd0665c53-0,momo
11624afa-e16c-463d-a591-44734d8ea1ae-0,momo
e6248477-6964-49d3-922a-1bba4f0657fd-0,momo
4ce0354a-5532-41cb-9afd-b364f366f2b0-0,momo
b4b44fee-675f-4213-94af-5feb266d98b2-0,momo
7d70a1e5-5781-4e6d-a055-63c5ac96c775-0,momo
0a0ca590-eeb3-46fe-959a-61191b992fab-0,momo
a4270289-719b-466c-9acb-8f3ef61d5a73-0,momo
4637ec8d-b064-46bc-9dec-8b72efcade7e-0,momo
4de26240-6e35-4df1-b7c2-03d2ef52c1d6-0,momo
6ea1d66d-4bc2-4483-a3e4-37e107bc6961-0,momo
7824ac89-65aa-4a5a-8092-553a288e450b-0,momo
9c3f31a0-3e69-43bb-b121-4db73b439042-0,momo
bf43f650-1cb5-4cd9-969a-ed0a361bdb2e-0,momo
733d0852-c8cd-4bde-aef6-590c7f567b1e-0,momo
45662c70-2c3c-41ac-b765-514030a06f66-0,momo
447c0547-aa67-45e6-bbe1-3cd7255b4240-0,momo
d22cf05f-919b-47b5-a1d5-c5ccee8f8a40-0,momo
d0ec97e6-929b-4257-848c-88dd6a0b2daf-0,momo
d8dc654c-9668-42c3-9370-3d17d0dc32e8-0,momo
643cf646-4971-4929-9ae6-b6efebbd9070-0,momo
ae9b2891-ecad-4d8e-aa3d-b197eb5e0e8e-0,momo
ad5e47b8-de12-42e4-940b-271e4c89e850-0,momo
e2f3efea-9292-4730-9826-6b5345f2e3c7-0,momo
3aee3
Query:
SELECT t.TradeDate, 
  CASE 
    WHEN LOWER(party.PartyID) LIKE '%lucky%' THEN 'lucky'
    WHEN LOWER(party.PartyID) LIKE '%momo%' THEN 'momo'
    ELSE 'other'
  END AS strategy
FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t,
UNNEST(Sides) AS side,
UNNEST(side.PartyIDs) AS party
WHERE side.Side = 'LONG'
LIMIT 1000
Answer:
Too long, hard cut:
TradeDate,strategy
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-18,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-19,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-20,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-05-21,momo
2020-
End Exploring Related Columns
Task: How much higher the average intrinsic value is for trades using the feeling-lucky strategy compared to those using the momentum strategy under long-side trades?

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
higher
value:float > 0
```

The dataset does not contain information about the trading strategies ('feeling-lucky' or 'momentum') used in the trades. Without this information, we cannot calculate the difference in average intrinsic value between these strategies under long-side trades..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: 

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
You need to follow the format's positive and negative signs.

2025-01-19 05:27:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 05:27:13 - root - INFO - ```sql
WITH avg_intrinsic_values AS (
  SELECT 
    CASE 
      WHEN LOWER(party.PartyID) LIKE '%lucky%' THEN 'lucky'
      WHEN LOWER(party.PartyID) LIKE '%momo%' THEN 'momo'
    END AS strategy,
    AVG(t.StrikePrice - t.LastPx) AS avg_intrinsic_value
  FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t
  CROSS JOIN UNNEST(t.Sides) AS side
  CROSS JOIN UNNEST(side.PartyIDs) AS party
  WHERE LOWER(side.Side) = 'long'
    AND (LOWER(party.PartyID) LIKE '%lucky%' OR LOWER(party.PartyID) LIKE '%momo%')
  GROUP BY strategy
)
SELECT lucky.avg_intrinsic_value - momo.avg_intrinsic_value AS higher
FROM (SELECT avg_intrinsic_value FROM avg_intrinsic_values WHERE strategy = 'lucky') AS lucky,
     (SELECT avg_intrinsic_value FROM avg_intrinsic_values WHERE strategy = 'momo') AS momo;
```
2025-01-19 05:27:15 - root - INFO - itercount: 1
2025-01-19 05:27:15 - root - INFO - 0
2025-01-19 05:27:15 - root - INFO - results: 
higher
0.02306944977314785


2025-01-19 05:27:15 - root - INFO - Please check the answer again by reviewing How much higher the average intrinsic value is for trades using the feeling-lucky strategy compared to those using the momentum strategy under long-side trades?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
higher
value:float > 0
```

The dataset does not contain information about the trading strategies ('feeling-lucky' or 'momentum') used in the trades. Without this information, we cannot calculate the difference in average intrinsic value between these strategies under long-side trades. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
higher
0.02306944977314785
Current sql:
WITH avg_intrinsic_values AS (
  SELECT 
    CASE 
      WHEN LOWER(party.PartyID) LIKE '%lucky%' THEN 'lucky'
      WHEN LOWER(party.PartyID) LIKE '%momo%' THEN 'momo'
    END AS strategy,
    AVG(t.StrikePrice - t.LastPx) AS avg_intrinsic_value
  FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t
  CROSS JOIN UNNEST(t.Sides) AS side
  CROSS JOIN UNNEST(side.PartyIDs) AS party
  WHERE LOWER(side.Side) = 'long'
    AND (LOWER(party.PartyID) LIKE '%lucky%' OR LOWER(party.PartyID) LIKE '%momo%')
  GROUP BY strategy
)
SELECT lucky.avg_intrinsic_value - momo.avg_intrinsic_value AS higher
FROM (SELECT avg_intrinsic_value FROM avg_intrinsic_values WHERE strategy = 'lucky') AS lucky,
     (SELECT avg_intrinsic_value FROM avg_intrinsic_values WHERE strategy = 'momo') AS momo;
2025-01-19 05:27:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 05:27:33 - root - INFO - ```sql
WITH avg_intrinsic_values AS (
  SELECT 
    CASE 
      WHEN LOWER(party.PartyID) LIKE '%lucky%' THEN 'lucky'
      WHEN LOWER(party.PartyID) LIKE '%momo%' THEN 'momo'
    END AS strategy,
    AVG(t.StrikePrice - t.LastPx) AS avg_intrinsic_value
  FROM `bigquery-public-data.cymbal_investments.trade_capture_report` t
  CROSS JOIN UNNEST(t.Sides) AS side
  CROSS JOIN UNNEST(side.PartyIDs) AS party
  WHERE LOWER(side.Side) = 'long'
    AND (LOWER(party.PartyID) LIKE '%lucky%' OR LOWER(party.PartyID) LIKE '%momo%')
  GROUP BY strategy
)
SELECT ROUND(lucky.avg_intrinsic_value - momo.avg_intrinsic_value, 4) AS higher
FROM (SELECT avg_intrinsic_value FROM avg_intrinsic_values WHERE strategy = 'lucky') AS lucky,
     (SELECT avg_intrinsic_value FROM avg_intrinsic_values WHERE strategy = 'momo') AS momo;
```
2025-01-19 05:27:35 - root - INFO - itercount: 2
2025-01-19 05:27:35 - root - INFO - 0
2025-01-19 05:27:35 - root - INFO - Total iteration counts: 2
