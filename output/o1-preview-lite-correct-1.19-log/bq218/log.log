2025-01-19 06:27:16 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 06:27:46 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 06:27:48 - root - INFO - SQL:
-- 1. Retrieve distinct years from the data
SELECT DISTINCT EXTRACT(YEAR FROM `date`) AS year
FROM `bigquery-public-data.iowa_liquor_sales.sales`
LIMIT 1000;
Results:
year
2012
2024
2019
2023
2014
2015
2022
2017
2021
2013
2016
2020
2018

2025-01-19 06:27:50 - root - INFO - SQL:
-- 2. Get the list of unique items sold
SELECT DISTINCT `item_description`
FROM `bigquery-public-data.iowa_liquor_sales.sales`
LIMIT 1000;
Results:
Too long, hard cut:
item_description
SKYY VODKA
WHITE CLAW PREMIUM VODKA
DEWARS WHITE LABEL SCOTCH
FIREBALL HALLOWEEN ADULT TRICK-OR-TREAT BAG MINI
MIDNIGHT MOON HOLIDAY MOONSHAKE VARIETY CANDY CANE MINI
RICH & RARE PEACH MINI
JACK DANIELS OLD #7 BLACK LABEL MINI
JIM BEAM HONEY MINI
JIM BEAM PEACH MINI
ABSOLUT GRAPEFRUIT MINI
REVELTON VODKA MINI
WESTERN SON LIME MINI
BACARDI COCO MINI
FIREBALL CINNAMON WHISKEY 50ML SLEEVE
CAPTAIN MORGAN SLICED APPLE MINI
EZRA BROOKS BOURBON CREAM MINI
99 APPLES MINI DISPLAY
SKREWBALL PEANUT BUTTER WHISKEY MINI
GLENMORANGIE TASTER PACK
RIVER ROSE GIN MINI
AMERICAN ANTHEM VODKA MINI
SOUTHERN COMFORT 80PRF
FIVE STAR
NEW AMSTERDAM GIN
FIREBALL CINNAMON
JOSE CUERVO ESPECIAL REPOSADO
KAH BLANCO MINI
BLAIR ATHOL
HENNESSY BLACK
REMY MARTIN VSOP FLASK
CIROC PINEAPPLE
TOOTERS ALA BAMA SLAMA
ARROW PEPPERMINT SCHNAPPS
COURVOISIER VS COGANC
JOHNNIE WALKER RED
CEDAR RIDGE GRAPPA
BETINI LEMON DROP
DEKUYPER HOT DAMN!
DEWAR'S WHITE LABEL SCOTCH
HENDRICKS GIN MINI
SEAGRAMS SEVEN CROWN AMERICAN SPICED MINI
VAN GOGH DOUBLE EXPRESSO VODKA MINI
UV BLUE RASPBERRY VODKA MINI
DR. MCGILLICUDDY'S PEACH MINI
CAPTAIN MORGAN LOCONUT MINI
CAPTAIN MORGAN WATERMELON SMASH MINI
OLMECA ALTOS PLATA MINI
JOHNNIE WALKER MINI DISCOVERY PACK
JACK DANIELS 12YR
JACK DANIELS TWICE BARRELED SPECIAL RELEASE
BAILEYS ORIGINAL IRISH CREAM W/2 DESSERT BOWLS
CROWN ROYAL W/NFL JERSEY BAG
GRAND MARNIER W/ROCKS GLASS GIFT SET
CROWN ROYAL GOLDEN APPLE
CANADIAN LTD WHISKY CONVENIENCE PACK
PENDLETON VIKINGS
SWEAR JAR CANDIED GREEN APPLE
FARMSTOCK IOWA BATCH
JAMESON BLACK BARREL
THE SEXTON
BEN HOLLADAY 6YR MO BOURBON
OLD FORESTER SIGNATURE 100PRF BOURBON
BASIL HAYDEN SUBTLE SMOKE
BLANTONS BOURBON
CLYDE MAYS SPECIAL RESERVE STRAIGHT BOURBON WHISKEY 6YR
BP ELIJAH CRAIG PRIVATE BARREL - BARREL PROOF
FIGHTING COCK BOURBON
GARRISON BROTHERS SNGL BRL SAMPLER TEXAS STRAIGHT BOURBON
JAMES E PEPPER 1776 STRAIGHT BOURBON WHISKEY 100PRF
LUX ROW FOUR GRAIN DOUBLE BARREL
REDEMPTION WHEATED BOURBON
RIDGEMONT RESERVE 1792
WILD TURKEY KENTUCKY SPIRIT SINGLE BARREL
WELLER RESERVE 7YR BOURBON
BP YELLOWSTONE HAND PICKED 115PRF
OLD ELK WHEAT N RYE
HIGH WEST CASK COLLECTION SAUVIGNON FINISH
WHISTLEPIG CAMPSTOCK WHEAT WHISKEY
TEMPLETON 10YR SINGLE BARREL RYE
SLIPKNOT IOWA WHISKEY NO. 9 RESERVE
JACK DANIELS TENNESSEE RYE
CEDAR RIDGE WHEAT WHISKEY
PLYMOUTH GIN
JACK DANIELS 4YR RYE SINGLE BARREL
GREY GOOSE LA POIRE VODKA
STOLICHNAYA 80PRF
INGENIOZ
ABSOLUT GRAPEFRUIT
NORTH FORTY VODKA
SMIRNOFF 80PRF PET
SEAGRAMS RUBY RED GRAPEFRUIT VODKA
UV RED (CHERRY) VODKA
BLUE CHAIR BAY COCONUT
MT. GAY ECLIPSE RUM
RON ZACAPA 23YR
ZAYA GRAN RESERVA RUM
BACARDI SPICED RUM
BACARDI RASPBERRY
CENTENARIO 7YR
BUCHANAN'S 12 YR DELUXE SCOTCH
DALMORE 15YR
CALVADOS MORIN SELECTION
JOHNNIE WALKER BLUE
PAUL MASSON PINEAPPLE GRANDE AMBER BRANDY
BLONDIES STRAWBERRY LEMONADE
JOSE CUERVO AUTHENTIC STRAWBERRY LIME MARGARITA
TAMNAVULIN SCOTCH WHISKY
JOSE CUERVO ESPECIAL SILVER W/1L CLASSIC MARGARITA MIX
LAGAVULIN OFFERMAN CARIBBEAN RUM CASK FINISH
GREY GOOSE ESSENCES WHITE PEACH & ROSEMARY
HENDRICKS LUNAR
ARDBEG ANAMORPHIC
ROCK N ROLL TEQUILA GUITAR MANGO
RUMCHATA PUMPKIN SPICE
SOLERNO BLOOD ORANGE LIQUEUR
BAILEYS VANILLA CINNAMON
BUMBU CREME
KERRYGOLD IRISH CREAM LIQUEUR
BAILEYS ALMANDE
BALLOTIN CHOCOLATE PEANUT BUTTER CREAM
GODIVA DARK CHOCOLATE LIQUEUR
KINKY ALOHA
BP REBEL STAVE FINISH COLLECTION
SMIRNOFF BLUE RASPBERRY LEMONADE
SMIRNOFF SORBET LIGHT RASPBERRY POMEGRANATE
SUGARLANDS FRUIT PUNCH MOONSHINE
ARROW CREME DE MENTHE GREEN
CASHEL IRISH CREAM
CODY ROAD EXPERIMENTAL - MERLOT BARREL FINISH BOURBON
EL MAYOR EXTRA ANEJO PORT FINISH
OLE SMOKY MINT CHOCOLATE CHIP CREAM WHISKEY
GARRISON BROTHERS HONEY DEW STRAIGHT BOURBON WHISKEY
818 REPOSADO TEQUILA
AMOR EXTRA ANEJO
CAMPO BRAVO PLATA TEQUILA
SOLANA AGAVE BLANCO
JOSE CUERVO TRADICIONAL REPOSADO
HERRADURA ANJEO
OLMECA ALTOS REPOSADO
TRES GENERACIONES ANEJO
HA OLD FORESTER BIRTHDAY BOURBON 2023
HA OLD FITZGERALD 17 YR BIB DECANTER
HA DAVIESS COUNTY MEDIUM TOAST
SOOH WILDERNESS TRAIL BOTTLED IN BOND SMALL BATCH
HA W L WELLER 2024 BOURBON
SOOH MILLET ARMAGNAC VSOP
BUSHMILLS RED BUSH
MICHAEL COLLINS IRISH WHISKEY
IOWISH WHISKEY
SEAGRAMS SEVEN CROWN STONE CHERRY
MAD HEN FIERY CINNAMON
BELVEDERE VODKA
PINNACLE VODKA
THREE OLIVES VODKA
THREE OLIVES POMEGRANATE
PINNACLE CHOCOLATE WHIPPED
PINNACLE ATOMIC HOT
THREE OLIVES CUCUMBER LIME
UV WHIPPED DISCO
UV WHIPPED
RAIN CUCUMBER
UV PINK LEMONADE VODKA
UV IVORY (VANILLA) VODKA
MYERS'S RUM ORIGINAL DARK
CALICO JACK WHIPPED
FAMOUS GROUSE SCOTCH
E & J VS BRANDY TRAVELERS
ISLE OF JURA 10YR
KAHLUA PUMPKIN SPICE
KINKY GOLD
PARAMOUNT CREME DE MENTHE/WHITE
BLUE CHAIR BAY KEY LIME CREAM
SASSY GIRL
ARROW MCDALE'S BUTTERSCOTCH SCHNAPPS
JEREMIAH WEED SARSAPARILLA WHISKEY
HA GLEN GARIOCH VIRGIN OAK
CODIGO 1530 COMBO PACK
GLENMORANGIE PIONEER PACK
HAWKEYE LIGHT RUM
TEACHER'S
OLD FORESTER MINT JULEP
DEKUYPER CACTUS JUICE
DEKUYPER PEACHTREE
MR BOSTON GOLD TEQUILA
MONTEZUMA TRIPLE SEC
99 COCONUT MINI
BARREL RIVER ROSE GIN
HENNESSY V

2025-01-19 06:27:52 - root - INFO - SQL:
-- 3. Fetch total sales revenue per item for 2023
SELECT `item_description`, SUM(`sale_dollars`) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
GROUP BY `item_description`
LIMIT 1000;
Results:
Too long, hard cut:
item_description,total_sales
HENNESSY VS,6458602.139999998
SEAGRAMS EXTRA SMOOTH VODKA,412311.03
MARASKA SLIVOVITZ,31798.80000000002
ABSOLUT SWEDISH VODKA 80PRF MINI,272824.19999999995
SEAGRAMS EXTRA SMOOTH VODKA MINI,30774.000000000015
WHITE CLAW PINEAPPLE VODKA MINI,3812.520000000001
DEEP EDDY LEMON MINI,105114.01000000002
HENNESSY VS MINI,131031.9
BAILEYS COLADA MINI,603.4499999999999
MIDNIGHT MOON CHOCOLATE BROWNIE MOONSHAKE MINI,20489.039999999986
THE ORIGINAL PICKLE SHOT MINI (SPICY PICKLE VODKA),38088.0
99 BLUE RASPBERRIES MINI,180759.9600000001
OLE SMOKY PEACH WHISKEY MINI,17797.5
KINKY PINK,198790.6900000001
JAGERMEISTER LIQUEUR MINI MEISTERS,20837.699999999997
BOND & LILLARD,13500.0
BLUE OX VODKA,1878983.4600000002
COURVOISIER VS COGNAC,425750.25
JD TWICE BARRELED HERITAGE RYE,10125.0
HA JACK DANIELS 12YR,10608.0
REVEL STOKE SMOREGASM TOASTED SMORES WHISKY,44123.49
WHISTLEPIG 18YR DOUBLE MALT RYE EDITION #4,112200.0
1792 BOTTLED IN BOND BOURBON,6457.5
CEDAR RIDGE BOURBON,1933558.31
ELIJAH CRAIG,913466.5199999998
BP JEFFERSONS RESERVE BOURBON BARREL,22170.20999999999
JEFFERSONS OCEAN AGED AT SEA,247682.67999999985
OLD ELK 8YR WHEATED BOURBON,5400.0
VERY OLD BARTON BOURBON CRAFTED 80PRF,1977.75
BP BRECKENRIDGE BOURBON WHISKEY RESERVE BLEND ALPHA,10800.0
LEADSLINGERS BOURBON WHISKEY 10YR,10950.0
CODY ROAD PEACH,31926.0
CEDAR RIDGE QUINTESSENTIAL AMERICAN SINGLE MALT,182710.32000000004
GENTLEMAN JACK,403431.7600000001
JACK DANIELS SINGLE BARREL,107149.5
BP KNOB CREEK RYE SINGLE BARREL,15688.080000000014
CRYSTAL HEAD VODKA,23782.000000000015
BURNETTS RASPBERRY,24441.75
BUMBU XO,50326.63999999998
B&B DOM,56615.25
GOLDSCHLAGER CINNAMON SCHNAPPS,115394.25
JAMESON ORANGE,508318.9800000003
AMARO MONTENEGRO,24696.0
PROPER NO. TWELVE  APPLE,65982.0
EVAN WILLIAMS PEACH,42363.0
SODA JERK ROOT BEER SHOT,13530.0
WILD TURKEY AMERICAN HONEY STING,23418.0
ARROW CREME DE CACAO WHITE,16770.0
OLE SMOKY BANANA PUDDING CREAM MOONSHINE,286416.0
RUMCOQUI,5400.0
CALIROSA ANEJO,4893.75
CAZADORES ANEJO,20123.5
HA OBAN DISTILLERS EDITION,1034.8799999999999
SOOH JINRO CHAMISUL CLASSIC SOJU,15800.399999999985
HA MICHTERS 10YR OLD SINGLE BARREL,7593.75
JOSE CUERVO AUTHENTIC LIME LIGHT,26823.840000000015
BIRD DOG SALTED CARAMEL,55631.25
HORSE SOLDIER SMALL BATCH BOURBON WHISKEY,54060.0
MICHTERS US*1 KENTUCKY STRAIGHT SINGLE BARREL RYE,84525.0
MINOR CASE STRAIGHT RYE,40260.0
BEEFEATER GIN,411287.01000000007
WESTERN SON STRAWBERRY VODKA,14831.44
BLACKHEART PREMIUM SPICED RUM,56073.75
AMARULA CREAM LIQUEUR,27246.0
BALLOTIN CHOCOLATE CHERRY CREAM WHISKEY,20262.42000000001
KETEL ONE BOTANICAL CUCUMBER & MINT,116977.0
KURVBALL WHISKEY,38808.0
ROCKET FUEL,40668.49999999997
DON JULIO ANEJO,675388.19
MARGARITAVILLE GOLD TEQUILA,112196.80999999998
SOOH STRANAHANS BLUE PEAK,15544.5
CHI-CHI'S SKINNY MARGARITA,133789.5
CIROC VS,22155.89999999999
E & J VS SQUARE,24640.199999999993
JIM BEAM DOUBLE OAK,26187.0
SEAGRAMS 7 CROWN PET FLASK,105570.0
IOWA STATE 1858 VODKA,140965.5
TWISTED SHOTZ SEXY PARTY PACK 2.0,58833.280000000115
DON Q CRISTAL,38787.38000000001
DR MCGILLICUDDYS WILD GRAPE,74542.14000000003
SCORESBY RARE SCOTCH,206119.96000000002
FINAGRENS IRISH WHISKEY,143350.18000000005
EVAN WILLIAMS BLACK PET,31374.0
ABSOLUT MANDRIN,233433.89999999994
OLE SMOKY PUMPKIN SPICE CREAM MOONSHINE,38220.0
MCMASTERS CANADIAN WHISKEY,15309.0
BUZZBALLZ BIGGIES TEQUILA RITA,75885.0
BULLEIT BOURBON WHISKEY W/ MUG,10580.079999999998
RUSSELLS RESERVE SINGLE BARREL BOURBON,104761.5
TOOTERS RAINBOW PACK,16767.0
RIEGERS MIDWESTERN DRY GIN,19380.599999999984
VAN GOGH DOUBLE ESPRESSO VODKA,8484.0
TRUST ME VODKA ORGANIC,38148.0
DUBLINER HONEYCOMB LIQUEUR,52736.25
MOZART WHITE CHOCOLATE CREAM LIQUEUR,17404.419999999995
SUGARLANDS SOUR BLUE RASPBERRY MOONSHINE FOLDS OF HONOR,17606.400000000016
BALLOTIN CHOCOLATE WHISKEY CHOCOLATE MINT,13809.42000000001
THE BUTTERFLY CANNON CRISTALLINO SILVER TEQUILA,8348.800000000001
FLEISCHMANNS 80PRF VODKA,625757.9100000003
TULLAMORE DEW,290535.75
FIVE STAR PET,116810.98999999992
TANQUERAY STERLING VODKA,24066.0
SVEDKA 80PRF PET,26688.0
CHICKEN COCK CHANTICLEER COGNAC FINISH BOURBON,13440.119999999999
G & W BOURBON,19357.239999999983
SOOH WINDSOR BLACK CHERRY,5896.320000000007
SOOH BARRELL BOURBON DOVETAIL WHISKEY,42010.46999999996
GOTCHA GIN,21451.5
BIRD DOG HONEY FLAVORED WHISKEY MINI,2670.0
MR BOSTON BLACKBERRY BRANDY MINI,796.5000000000002
OLE SMOKY PEPPERMINT MOONSHINE MINI,11567.53
NEW AMSTERDAM PINEAPPLE MINI,11334.840000000002
BOLS COCKTAILS AZUL MARGARITA,1784.25
TOOTERS BLU-DACIOUS KAMIKAZI MINI,13734.799999999997
KEEPERS HEARTS IRISH WHISKEY,15225.0
EFFEN RASPBERRY,18168.75
1800 CUCUMBER & JALAPENO,20592.0
TEQUILA KOMOS ANEJO CRISTALINO,16436.199999999997
HA REMUS GATSBY 2023,8438.849999999999
POWERS GOLD IRISH WHISKEY,45497.61000000001
MR BOSTON PEPPERMINT SCHNAPPS,9515.520000000006
TRAVELLER BLENDED NO 40,28080.0
RIVER ROSE GIN,42236.65999999999
CRUZAN BLACKSTRAP,19556.999999999993
KINKY BLUE PATIO PUNCH,8316.0
HORNITOS

2025-01-19 06:27:54 - root - INFO - SQL:
-- 4. Fetch total sales revenue per item for 2022
SELECT `item_description`, SUM(`sale_dollars`) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2022
GROUP BY `item_description`
LIMIT 1000;
Results:
Too long, hard cut:
item_description,total_sales
BARTON VODKA,1315892.2400000002
BLACK VELVET,11674549.60000002
99 BRAND VARIETY PARTY YARD PACK MINI,6578.999999999998
FIREBALL CINNAMON WHISKEY PARTY YARD MINI,46362.60000000002
CROWN ROYAL PEACH MINI,18203.129999999997
SEAGRAMS 7 CROWN MINI,36706.64
UV RED CHERRY MINI,18416.100000000013
ADMIRAL NELSON SPICED MINI,69201.99000000002
HPNOTIQ MINI,33550.67999999997
99 BRAND MYSTERY FLAVOR PET MINI,28638.000000000022
99 WATERMELON PET MINI,126858.6
JACK DANIELS TENNESSEE FIRE MINI,139759.5
OLE SMOKY BANANA PUDDING CREAM MOONSHINE MINI,58809.26999999998
BLACK VELVET PEACH CANADIAN WHISKEY MINI,22389.0
ABSOLUT SWEDISH VODKA 80PRF,3591595.3600000017
NEW AMSTERDAM RED BERRY,134654.82999999996
WHITE DOG WHEAT,14647.5
WHITE DOG STRAIGHT RYE,14701.5
CROWN ROYAL PEACH,5298659.220000001
ELIJAH CRAIG  BARREL PROOF,153562.5
TEMPLETON RYE 4YR,1051562.49
WESTERN SON ORIGINAL,35609.42000000003
DEEP EDDY RUBY RED GRAPEFRUIT,186439.5
CAPTAIN MORGAN WHITE,100891.77000000008
SELVAREY OWNERS RESERVE GIFT BOX,9490.5
PAPAS PILAR DARK RUM,10264.38
COPPER DOG,17639.619999999988
JOHNNIE WALKER BLACK,706975.7500000003
CIROC SUMMER CITRUS,69592.68000000002
1800 COCONUT,78958.6500000001
TIPPY COW CHOCOLATE,61842.0
PARAMOUNT PEPPERMINT SCHNAPPS PET,65718.0
DEKUYPER LUSCIOUS PEACHTREE,904327.5999999994
99 PEACHES,35661.03
OLE SMOKY PEANUT BUTTER WHISKEY,224152.5
CINCORO BLANCO TEQUILA,25522.5
TEREMANA BLANCO TEQUILA,818192.8999999998
PATRON REPOSADO,414978.0
HA OLD RIP VAN WINKLE 15YR (PAPPY),1260.0
HA CEDAR RIDGE BOURBON: SINGLE BARREL COLLECTION (S.B.C.),5985.0
HORNITOS GOLD,187290.0
SIP SHINE SHINE BERRY SWEET TEA,3571.5
DAVID NICHOLSON RESERVE,12783.75
FOUR ROSES SINGLE BARREL,439155.0
UNCLE NEAREST 1856 AGED WHISKEY,36696.0
ABSOLUT APEACH,108486.95000000004
NEW AMSTERDAM PET,105964.5
360 DOUBLE CHOCOLATE,45745.64000000001
MALIBU PASSION FRUIT,51400.899999999994
CRUZAN BLACK CHERRY,130956.0
GLEN MORAY,29137.320000000007
MR BOSTON BLACKBERRY BRANDY,82253.76000000001
ST BRENDANS IRISH CREAM,65740.5
CHILA COFFEE LIQUEUR,20231.52000000001
SMIRNOFF ZERO SUGAR INFUSION STRAWBERRY & ROSE,60847.699999999975
PARAMOUNT CREME DE MENTHE GREEN,45015.38
DEKUYPER HOT DAMN! 100PRF,18257.51999999998
OLE SMOKY PEACH WHISKEY,142054.5
CASA NOBLE CRYSTAL,33201.00000000004
CORRALEJO REPOSADO,289238.66000000003
EL JIMADOR ANEJO,36298.80000000003
HUSSONGS REPOSADO,18670.5
ESPOLON ANEJO,27426.0
SOOH SMOOTH AMBLER CONTRADICTION,7653.899999999997
TWISTED SHOTZ PINEAPPLE UPSIDE DOWN CAKE,5385.9
MR BOSTON PEACH,98310.0
CANADIAN CLUB RESERVE TRIPLE AGED,8886.240000000007
UNCLE NEAREST STRAIGHT RYE WHISKEY,6240.0
JIM BEAM ORANGE,82854.0
LIMOUSIN RYE WHISKEY,5638.450000000002
SMIRNOFF ZERO SUGAR INFUSION CUCUMBER & LIME,73871.46
CASAMIGOS ANEJO,206254.0900000002
CABIN STILL STR BOURBON,89707.5
STOLICHNAYA OHRANJ,33136.68
CRUZAN TROPICAL FRUIT,26124.0
SOOH MONKEY 47,37713.72000000002
BASIL HAYDEN,61833.0
MCCORMICK BLEND WHISKEY PET,36801.6
BOMBAY SAPPHIRE FEVER TREE VARIETY PACK,12201.0
NELSON BROS WHISKEY RESERVE BOURBON,17820.0
EFFEN BLACK CHERRY,49856.25
DIPLOMATICO MANTUANO,18306.0
LAGAVULIN 8YR,47853.640000000014
THE ORIGINAL PICKLE SHOT DILL PICKLE VODKA,66633.75
TIPPY COW SHAMROCK MINT,46315.5
BLACKENED WHISKEY,39250.19999999999
STARA SOKOLOVA SILVER,936.0
SOOH CHERRY HEERING,10434.029999999999
99 BUTTERSCOTCH,5494.060000000005
SEAGRAMS VO CANADIAN WHISKEY PET,422997.5300000001
PINNACLE,613126.5
FORTY CREEK,26007.96000000001
CLEARHEART GIN,16143.750000000002
ON THE ROCKS COCKTAILS LARIOS AVIATION,37872.0
OLD ST NICKS EGG NOG,16600.770000000008
EZRA BROOKS BOURBON CREAM,23433.75
ELLA PLUM,333.0
TRADER VICS PRIVATE SELECTION SPICED RUM,48406.5
SUGARLANDS SHINE BLUEBERRY MUFFIN MOONSHINE,934.5600000000001
KOVAL CRANBERRY GIN LIQUEUR,2754.0
BRECKENRIDGE MADEIRA FINISH,1890.0
GREY GOOSE ESSENCES STRAWBERRY & LEMONGRASS MINI,1912.3200000000015
WHEEL HORSE BOURBON,8104.639999999998
HA RUSSELLS RESERVE 13YR BARREL PROOF,8100.0
BACARDI RUM PUNCH RTS,14614.599999999988
TWISTED SHOTZ CHOCOLATE BUTTERY NIPPLE,8204.25
WOODFORD RESERVE KENTUCKY DERBY 2022,23963.21999999999
KYODIE RAVIN APPLE WHISKEY,1228.5
CM NASSIF FAMILY RESERVE,18606.75
COUNTRY SMOOTH SMALL BATCH STRAIGHT BOURBON WHISKEY,1580.4599999999996
SWEET REVENGE,13472.45999999999
EVAN WILLIAMS SPICED CIDER,9187.5
HORNITOS STRAWBERRY TAMARIND MARGARITA,3267.0
ZIYAD BERRY BUSSIN TEA,804.0
SOOH AALBORG TAFFEL AQUAVIT,6781.5
MONTEZUMA BLUE,138723.53999999998
HA WILD TURKEY RARE BREED RYE BARREL PROOF,6588.0
CRAIGELLACHIE 13YR SINGLE MALT,14597.079999999989
DULCE VIDA PINEAPPLE JALAPENO,26301.0
ROSSVILLE UNION BARREL PROOF RYE,7875.0
CAPEL PREMIUM PISCO,4498.200000000003
WESTWARD STOUT CASK WHISKEY,3172.5
LOBOS 1707 JOVEN NECKTIE,8788.999999999996
LUSTER CLASSIC LIMONCELLO,3076.920000000001
SOOH BARTENDERS BANANAS OVER YOU,9331.96
ROW VODKA MINI,1575.729999999999
SOUTHERN COMFORT HOLIDAY COCKTAIL CALENDAR,907.1999999999999
MOSSBURN ISLAND BLENDED MALT SCOTCH WHISKY,3473.5499999999993
HAKU 

2025-01-19 06:27:56 - root - INFO - SQL:
-- 5. Find items sold only in 2023
SELECT DISTINCT s2023.`item_description`
FROM (
  SELECT DISTINCT `item_description`
  FROM `bigquery-public-data.iowa_liquor_sales.sales`
  WHERE EXTRACT(YEAR FROM `date`) = 2023
) s2023
LEFT JOIN (
  SELECT DISTINCT `item_description`
  FROM `bigquery-public-data.iowa_liquor_sales.sales`
  WHERE EXTRACT(YEAR FROM `date`) = 2022
) s2022
ON s2023.`item_description` = s2022.`item_description`
WHERE s2022.`item_description` IS NULL
LIMIT 1000;
Results:
Too long, hard cut:
item_description
BLANTONS GOLD BOURBON
HA THOMAS HANDY RYE 2023
BOWMAN BROTHERS BOURBON
GLENDALOUGH DOUBLE BARREL
EZRA BROOKS RYE 99
REBEL STRAIGHT RYE 100
TANQUERAY NEGRONI COCKTAIL
BIG HOUSE BOURBON
ELIJAH CRAIG RYE HOLIDAY VAP
PIGGYBACK RYE W/POUR SNOUT
HA LEDAIG SINGLE MALT SCOTCH RIOJA CASK FINISH
ZING ZANG BLAZING BLOODY MARY RTS
WRAY & NEPHEW OVERPROOF RUM MINI
HA EL MAYOR EXTRA ANEJO 25TH ANNIVERSARY BOURBON BARREL AGED
CANTERA NEGRA REPOSADO
CODY ROAD EXPERIMENTAL  PINOT NOIR BARREL FINISH
IMMORTAL CLAN USE CODE 6281
BARRELL FOUNDATION BOURBON
SOOH OLE SMOKY AMARETTO WHISKEY
CHOYA GOLDEN UME FRUITS
CONCIERE RUM SILVER
LOCH LOMOND THE OPEN SPECIAL ED. SINGLE MALT SCOTCH 2022
KIRKLAND SIGNATURE TOUR OF SCOTLAND  6-4 PACK
BARTENDERS TRADING COMPANY AWESOME ORANGE
YELLOWSTONE HAND PICKED BARREL PROGRAM - BUY THE BARREL
BIMBER APOGEE 12YR BLENDED MALT WHISKY
CLEAR CREEK CHERRY BRANDY MINI
KOLOA HAWAIIAN RUM PUNCH COCKTAIL
ARETTE SUAVE BLANCO TEQUILA
MR BOSTON SOUR CHERRY SCHNAPPS
GRACIAS A DIOS GIN OAXACA RECIPE
LOS AMANTES JOVEN
OAK & EDEN SPIRE SELECT RYE FRENCH OAK BUY THE BARREL
JAGERMEISTER MINIMEISTER ICE BUCKET VAP
FIREBALL BIRDIE SHOT MINI
BAILEYS CHOCOLATE
WIDOW JANE APPLE WOOD RYE
WHITE CLAW MANGO VODKA
JOSE CUERVO AUTHENTIC TROPICAL PARADISE
CUTWATER TEQUILA BLANCO
SOOH DON JULIO ANEJO
SMOOTH AMBLER CONTRADICTION W/2 GLASSES
SKYY INFUSIONS ESPRESSO
JIM BEAM WHITE W/HIGHBALL GLASS
BUBBAS MARSHMALLOW CHOCOLATE WHISKEY
PLOW POINT SMALL BATCH WHISKEY
CARAVEDO PURO QUEBRANTA
STEEPLE RIDGE 5YR WHEAT WHISKEY
10TH MOUNTAIN RYE
99 WATERMELON SCHNAPPS
POWERS JOHN LANE
CORAZON ANEJO TEQUILA BUY THE BARREL
CANCION ANEJO TEQUILA
ALIPUS SAN JUAN MEZCAL
MONTELOBOS PECHUGA MEZCAL
173 CRAFT DISTILLERY SPICED RUM
BARTENDERS TRADING COMPANY PINA COLADA
NO. 3 LONDON DRY GIN
99 RED MINI
HIRSCH THE BIVOUAC BOURBON
LEROUX ROCK AND RYE
CONCIERE BOURBON WHISKEY
LAGRIMAS DE DOLORES ANEJO MEZCAL
LOST REPUBLIC STRAIGHT RYE WHISKEY
YU
SHANKY''S WHIP
RD ONE FINISHED WITH FRENCH OAK
EL TRAGO BLANCO
SHADEHOUSE GIN
UV MANGO GLOW MINI
HA HEAVEN HILL HERITAGE COLLECTION 20YR CORN WHISKEY 2ND ED.
GRACIAS A DIOS OAXACA GIN
BUZZARDS ROOST CIGAR RYE STRAIGHT RYE WHISKEY
HA JOHNNIE WALKER BLUE YEAR OF THE RABBIT
BARRELL SEAGRASS
KOVAL FOUR GRAIN
TRAVERSE CITY WHISKEY CO. FINISHING SERIES HIGH RYEPX SHERRY
GENTLEMAN JACK MINI
BENROMACH 15 YEAR OLD
APPLETON ESTATE 15YR BLACK RIVER CASKS
NELSON BROS. WHISKEY COGNAC CASK
COMPASS BOX ORCHARD HOUSE
STARA SOKOLOVA TRAVKA
TEQUILA CIMARRON REPOSADO
NUESTRA SOLEDAD SANTIAGO MATATLAN
OLE SMOKY ORIGINAL CORN MOONSHINE
SCORPION MEZCAL SILVER
THE SCARLET IBIS TRINIDAD RUM
HA LAST DROP 50YR BSW 700ML & 50ML
MOSSBURN ROYAL BRACKLA SINGLE MALT SCOTCH WHISKY
GRACIAS A DIOS MEZCAL TEPEXTATE
PHANTOM V DISTILLING BUTTERSCOTCH
TRAVIS HASSE CHERRY
KAIYO WHISKY PEATED 2ND EDITION
HORSE SOLDIER STRAIGHT BOURBON WHISKEY
ALVISA XO BRANDY
RUMPLE MINZE
LONGBRANCH WITH 2 ROCK GLASSES
SOBIESKI RASPBERRY VODKA
METHOD AND MADNESS SINGLE MALT
GLENMORANGIE 15YR CADBOLL ESTATE 2023 EDITION
MI CAMPO COCKTAILS SPICY JALAPENO MARGARITA
HA WIDOW JANE DECADENCE
KENTUCKY OWL MAIGHSTIR
PANAMA PACIFIC RUM 23 YEARS
BUBBAS BURNT SUGAR WHISKEY USE CODE 73120
RD ONE DOUBLE FINISHED WITH OAK AND MAPLE BARRELS
NUMBER JUAN EXTRA ANEJO
BENROMACH 10YR
MOSHINE PASSION FRUIT
MIDNIGHT MOON APPLE PIE W/POUR LID
REVELTON DISTILLERS EDITION RYE BARREL PICK BUY THE BARREL
MCCORMICK GIN
DUKE REPOSADO
CM CATS EYE SINGLE MALT SCOTCH WHISKEY BUY THE BARREL
MACNAIRS LUM REEK 12 YR PEATED BLENDED MALT
GLENALLACHIE 8YR SPEYSIDE SINGLE MALT SCOTCH WHISKY
MAYALEN MACHETAZO ESPADIN
PLANTATION BARBADOS RUM XO 20TH ANNIVERSARY-USE CODE 942851
TOMINTOUL 12YR PORT CASK FINISH
CONTROL C PISCO
CM OBTAINIUM SINGLE GRAIN SCOTCH WHISKEY BUY THE BARREL
LAIRDS 10TH GENERATION APPLE BRANDY
CLEMENT CANNE BLEUE
DRIFTLESS GLEN SINGLE BARREL STRAIGHT BOURBON BUY THE BARREL
R. JELINEK SILVER SLIVOVITZ
360 WATERMELON VODKA
SKYY VODKA MINI
TWISTED TEA WHISKEY MINI
RABBIT HOLE 2PK W/CAVEHILL & HEIGOLD
SOOH CALUMET FARMS SMALL BATCH BOURBON
HORSE SOLDIER BARREL STRENGTH BOURBON WHISKEY
TX BOURBON W/BOTTLE CAP STAVE
ABSOLUT W/RISE COLD BREW
CORAL ISLE SPICED RUM
HERRADURA LEGEND ANEJO
R. JELINEK FERNET
SOOH ADICTIVO ANEJO
NEW AMSTERDAM PINK WHITNEY PET
JAGERMEISTER ALUMINUM SHOT CUP VAP
99 WHIPPED
REDBREAST 12YR CASK STRENGTH
ARETTE ARTESANAL SUAVE ANEJO TEQUILA
TATTERSALL TIGHTLINE ORGANIC VODKA
JAMESON COLD BREW MINI
JOURNEYMAN LAST FEATHER RYE SBS CASK STRENGTH BUY THE BARREL
CLEMENT CREOLE SHRUBB
SAZERAC DE FORGE COGNAC
VILLA MASSA LIMONCELLO
ROCK N ROLL TEQUILA PLATINUM
GLEN SCOTIA 18 YEAR OLD SINGLE MALT SCOTCH WHISKY
ZUCCA RABARBARO
TOWN BRANCH SINGLE BARREL RESERVE MALT WHISKEY BARREL BUY
ELIJAH CRAIG RYE WHISKEY
360 LIME
WESTWARD PINOT NOIR SB BUY THE BARREL
ROYAL SALUTE 21 YO
REDEMPTION STRAIGHT BOURBON COGNAC CASK FINISH
BP EZRA BROOKS CASK STRENGTH
BASIL HAYDEN MALTED RYE
MICHTERS US*1 SOUR MASH WHISKEY
HA MAKERS MARK CELLAR AGED
MIDNIGHT MOON CHOCOLATE BROWNI

2025-01-19 06:27:58 - root - INFO - SQL:
-- 6. List the top 10 items by sales revenue in 2023
SELECT `item_description`, SUM(`sale_dollars`) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
GROUP BY `item_description`
ORDER BY total_sales DESC
LIMIT 10;
Results:
item_description,total_sales
TITOS HANDMADE VODKA,30042562.53000001
BLACK VELVET,12263890.700000005
FIREBALL CINNAMON WHISKEY,11592055.799999995
CROWN ROYAL,10209429.249999994
JACK DANIELS OLD #7 BLACK LABEL,9611569.679999996
CAPTAIN MORGAN ORIGINAL SPICED,9261306.21
CROWN ROYAL REGAL APPLE,9239467.830000002
CAPTAIN MORGAN ORIGINAL SPICED BARREL,7061536.24
PATRON SILVER,6963129.0
JAMESON,6958456.299999997

2025-01-19 06:28:00 - root - INFO - SQL:
-- 7. List the top 10 items by sales revenue in 2022
SELECT `item_description`, SUM(`sale_dollars`) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2022
GROUP BY `item_description`
ORDER BY total_sales DESC
LIMIT 10;
Results:
item_description,total_sales
TITOS HANDMADE VODKA,27247213.760000017
FIREBALL CINNAMON WHISKEY,11839539.810000004
BLACK VELVET,11674549.600000018
CROWN ROYAL,11343341.339999996
CAPTAIN MORGAN ORIGINAL SPICED,10358733.520000005
CROWN ROYAL REGAL APPLE,10139859.319999998
JACK DANIELS OLD #7 BLACK LABEL,9517637.009999992
HENNESSY VS,7424003.100000001
JAMESON,6830823.149999999
PATRON SILVER,6729499.5

2025-01-19 06:28:02 - root - INFO - SQL:
-- 8. Calculate the total sales revenue per month in 2023
SELECT EXTRACT(MONTH FROM `date`) AS month, SUM(`sale_dollars`) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
GROUP BY month
ORDER BY month
LIMIT 1000;
Results:
month,total_sales
1,32547784.89000004
2,32114831.48
3,36403505.90000004
4,32884344.370000023
5,39684933.970000066
6,41194749.13000002
7,35838999.870000005
8,39788043.980000034
9,35096963.96000002
10,40281758.90000003
11,39289673.490000024
12,40945072.58000005

2025-01-19 06:28:04 - root - INFO - SQL:
-- 9. Retrieve the number of items sold per category in 2023
SELECT `category_name`, COUNT(DISTINCT `item_description`) AS item_count
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
GROUP BY `category_name`
LIMIT 1000;
Results:
category_name,item_count
AMERICAN CORDIALS & LIQUEURS,164
TEMPORARY & SPECIALTY PACKAGES,491
AMERICAN VODKAS,151
AMERICAN FLAVORED VODKA,223
IRISH WHISKIES,105
100% AGAVE TEQUILA,404
COCKTAILS/RTD,215
STRAIGHT BOURBON WHISKIES,384
SINGLE BARREL BOURBON WHISKIES,51
STRAIGHT RYE WHISKIES,143
CORN WHISKIES,35
FLAVORED GIN,31
IMPORTED FLAVORED VODKA,67
SINGLE MALT SCOTCH,180
SPICED RUM,38
SCOTCH WHISKIES,111
IMPORTED CORDIALS & LIQUEURS,182
TENNESSEE WHISKIES,63
AMERICAN SCHNAPPS,87
WHISKEY LIQUEUR,77
FLAVORED RUM,87
IMPORTED BRANDIES,90
AMERICAN BRANDIES,58
CANADIAN WHISKIES,94
BOTTLED IN BOND BOURBON,30
IMPORTED DRY GINS,60
IMPORTED VODKAS,56
WHITE RUM,50
IMPORTED SCHNAPPS,17
CREAM LIQUEURS,93
BLENDED WHISKIES,216
AMERICAN DRY GINS,80
AMERICAN DISTILLED SPIRITS SPECIALTY,101
MEZCAL,67
SPECIAL ORDER ITEMS,168
IMPORTED DISTILLED SPIRITS SPECIALTY,80
AGED DARK RUM,69
GOLD RUM,44
NEUTRAL GRAIN SPIRITS FLAVORED,45
MIXTO TEQUILA,29
TRIPLE SEC,9
NEUTRAL GRAIN SPIRITS,14
COFFEE LIQUEURS,19
AMERICAN SLOE GINS,2

2025-01-19 06:28:06 - root - INFO - SQL:
-- 10. Get daily sales revenue trend for a specific item in 2023
SELECT `date`, SUM(`sale_dollars`) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
AND LOWER(`item_description`) LIKE '%vodka%'
GROUP BY `date`
ORDER BY `date`
LIMIT 1000;
Results:
Too long, hard cut:
date,total_sales
2023-01-02,5289.52
2023-01-03,208584.43999999986
2023-01-04,196532.96000000008
2023-01-05,181457.38999999998
2023-01-06,160464.40999999997
2023-01-08,119946.88000000005
2023-01-09,254325.5299999999
2023-01-10,156040.21000000002
2023-01-11,224449.97000000012
2023-01-12,212271.83000000005
2023-01-13,214770.5999999999
2023-01-15,134.97
2023-01-16,252072.55000000002
2023-01-17,205048.5399999999
2023-01-18,224691.70000000007
2023-01-19,161882.63999999998
2023-01-20,206585.22999999992
2023-01-23,212915.0699999999
2023-01-24,183365.22000000006
2023-01-25,246136.17000000004
2023-01-26,206753.61999999997
2023-01-27,213086.25000000003
2023-01-29,1768.08
2023-01-30,371683.59
2023-01-31,164853.9900000001
2023-02-01,265933.3700000001
2023-02-02,203668.09000000014
2023-02-03,251806.67999999985
2023-02-06,318794.04000000004
2023-02-07,290954.84000000026
2023-02-08,230230.75000000012
2023-02-09,339231.0699999998
2023-02-10,202940.66000000003
2023-02-12,483.36
2023-02-13,256195.80000000013
2023-02-14,189174.48000000007
2023-02-15,207313.9499999999
2023-02-16,221227.41000000003
2023-02-17,253262.77
2023-02-20,209778.09000000005
2023-02-21,168135.40000000002
2023-02-22,226742.37999999998
2023-02-23,337239.6000000001
2023-02-24,240819.00000000012
2023-02-27,242137.36999999997
2023-02-28,198332.85000000006
2023-03-01,196586.33999999997
2023-03-02,187089.2000000001
2023-03-03,268688.6599999999
2023-03-06,272762.16
2023-03-07,242187.92999999996
2023-03-08,304517.20999999985
2023-03-09,193525.94999999992
2023-03-10,197232.77000000002
2023-03-13,240412.4700000001
2023-03-14,151440.55999999997
2023-03-15,185395.77999999997
2023-03-16,151095.18999999997
2023-03-17,195096.20999999996
2023-03-20,217694.28
2023-03-21,197738.50999999992
2023-03-22,205474.01999999987
2023-03-23,163266.41999999998
2023-03-24,215798.2300000001
2023-03-26,189.0
2023-03-27,190882.63999999996
2023-03-28,197405.33000000013
2023-03-29,262233.35
2023-03-30,184429.49000000022
2023-03-31,239851.00000000003
2023-04-03,418956.0900000001
2023-04-04,273382.8799999999
2023-04-05,249329.79
2023-04-06,274210.9299999999
2023-04-07,278322.3500000001
2023-04-09,889.1999999999999
2023-04-10,257666.12999999998
2023-04-11,170762.21999999988
2023-04-12,227736.35
2023-04-13,173817.73000000004
2023-04-14,231612.30000000005
2023-04-17,243092.71999999986
2023-04-18,222440.17000000007
2023-04-19,167484.5500000001
2023-04-20,237125.85000000003
2023-04-21,214260.64000000013
2023-04-24,476778.21
2023-04-25,178698.69000000012
2023-04-26,255378.89000000013
2023-04-27,212789.0699999999
2023-04-28,215989.73000000007
2023-05-01,243249.40999999992
2023-05-02,266167.73000000004
2023-05-03,449086.6599999999
2023-05-04,383586.78
2023-05-05,335507.3299999999
2023-05-08,264242.8199999999
2023-05-09,249728.5399999997
2023-05-10,210253.4400000001
2023-05-11,271652.99
2023-05-12,283915.93000000005
2023-05-15,239513.28000000003
2023-05-16,245249.07999999996
2023-05-17,266586.4000000001
2023-05-18,219126.6200000001
2023-05-19,293441.2700000001
2023-05-21,1124.7
2023-05-22,312690.9999999999
2023-05-23,302422.1300000001
2023-05-24,335663.0000000002
2023-05-25,268035.55
2023-05-26,293981.6499999999
2023-05-29,903.8399999999999
2023-05-30,305827.9299999999
2023-05-31,371439.9
2023-06-01,311864.5499999998
2023-06-02,171842.58000000002
2023-06-03,228048.82000000004
2023-06-05,279194.79999999993
2023-06-06,320548.95
2023-06-07,368199.10000000003
2023-06-08,325479.6600000001
2023-06-09,264241.3800000001
2023-06-12,258349.75000000003
2023-06-13,286342.83999999997
2023-06-14,275204.67999999993
2023-06-15,211010.59
2023-06-16,249435.5899999999
2023-06-19,228183.90999999995
2023-06-20,227626.37999999983
2023-06-21,276804.48999999993
2023-06-22,224837.55000000002
2023-06-23,289506.9999999999
2023-06-26,269693.3
2023-06-27,383968.7699999999
2023-06-28,428952.1700000001
2023-06-29,448967.8299999996
2023-06-30,300484.3400000001
2023-07-03,333144.07999999984
2023-07-05,202766.22999999995
2023-07-06,275261.53999999986
2023-07-07,260741.88999999996
2023-07-08,172119.17999999993
2023-07-10,241340.46999999997
2023-07-11,205891.1600000002
2023-07-12,246412.36999999988
2023-07-13,189356.48
2023-07-14,253634.47999999995
2023-07-17,262329.31999999995
2023-07-18,221963.64000000013
2023-07-19,270025.19000000006
2023-07-20,227051.6200000001
2023-07-21,265392.3199999999
2023-07-23,701.34
2023-07-24,439594.29
2023-07-25,236107.55999999994
2023-07-26,303783.60000000003
2023-07-27,200163.03999999986
2023-07-28,239162.20999999996
2023-07-30,132.6
2023-07-31,199013.88000000006
2023-08-01,362711.46
2023-08-02,489323.97000000003
2023-08-03,343831.5700000001
2023-08-04,398357.18999999994
2023-08-07,301727.1900000001
2023-08-08,283392.3300000001
2023-08-09,306160.05
2023-08-10,194278.03000000017
2023-08-11,246299.54999999993
2023-08-14,301405.8499999998
2023-08-15,251850.84999999992
2023-08-16,280104.01999999996
2023-08-17,228755.55000000002
2023-08-18,257012.36000000004
2023-08-21,318556.04000000004
2023-08-22,257979.0000

2025-01-19 06:28:06 - root - INFO - itercount: 0
2025-01-19 06:28:06 - root - INFO - Database Name: bigquery-public-data
Schema Name: iowa_liquor_sales
DDL describes table information.
,0
table_name,sales
ddl,"CREATE TABLE `bigquery-public-data.iowa_liquor_sales.sales`
(
  invoice_and_item_number STRING OPTIONS(description=""Concatenated invoice and line number associated with the liquor order. This provides a unique identifier for the individual liquor products included in the store order.""),
  date DATE OPTIONS(description=""Date of order""),
  store_number STRING OPTIONS(description=""Unique number assigned to the store who ordered the liquor.""),
  store_name STRING OPTIONS(description=""Name of store who ordered the liquor.""),
  address STRING OPTIONS(description=""Address of store who ordered the liquor.""),
  city STRING OPTIONS(description=""City where the store who ordered the liquor is located""),
  zip_code STRING OPTIONS(description=""Zip code where the store who ordered the liquor is located""),
  store_location GEOGRAPHY OPTIONS(description=""Location of store who ordered the liquor. The Address, City, State and Zip Code are geocoded to provide geographic coordinates. Accuracy of geocoding is dependent on how well the address is interpreted and the completeness of the reference data used.""),
  county_number STRING OPTIONS(description=""Iowa county number for the county where store who ordered the liquor is located""),
  county STRING OPTIONS(description=""County where the store who ordered the liquor is located""),
  category STRING OPTIONS(description=""Category code associated with the liquor ordered""),
  category_name STRING OPTIONS(description=""Category of the liquor ordered.""),
  vendor_number STRING OPTIONS(description=""The vendor number of the company for the brand of liquor ordered""),
  vendor_name STRING OPTIONS(description=""The vendor name of the company for the brand of liquor ordered""),
  item_number STRING OPTIONS(description=""Item number for the individual liquor product ordered.""),
  item_description STRING OPTIONS(description=""Description of the individual liquor product ordered.""),
  pack INT64 OPTIONS(description=""The number of bottles in a case for the liquor ordered""),
  bottle_volume_ml INT64 OPTIONS(description=""Volume of each liquor bottle ordered in milliliters.""),
  state_bottle_cost FLOAT64 OPTIONS(description=""The amount that Alcoholic Beverages Division paid for each bottle of liquor ordered""),
  state_bottle_retail FLOAT64 OPTIONS(description=""The amount the store paid for each bottle of liquor ordered""),
  bottles_sold INT64 OPTIONS(description=""The number of bottles of liquor ordered by the store""),
  sale_dollars FLOAT64 OPTIONS(description=""Total cost of liquor order (number of bottles multiplied by the state bottle retail)""),
  volume_sold_liters FLOAT64 OPTIONS(description=""Total volume of liquor ordered in liters. (i.e. (Bottle Volume (ml) x Bottles Sold)/1,000)\""""),
  volume_sold_gallons FLOAT64 OPTIONS(description=""Total volume of liquor ordered in gallons. (i.e. (Bottle Volume (ml) x Bottles Sold)/3785.411784)\"""")
)
OPTIONS(
  description=""Sales Dataset""
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'bigquery-public-data': {'iowa_liquor_sales': ['sales']}}
Begin Exploring Related Columns
**Relevant Columns and Their Potential Usage:**

- **`date`**: Used to filter sales data by year (e.g., 2022, 2023).
- **`item_description`**: Used to identify and group sales by item.
- **`sale_dollars`**: Used to calculate the total sales revenue per item.

**Potential Conditions:**

- Filter records where `date` falls within the years 2022 or 2023.
- Group data by `item_description` to aggregate sales.
- Calculate year-over-year growth percentages based on total sales.

**Sample SQL Queries to Understand the Data:**

```sql
-- 1. Retrieve distinct years from the data
SELECT DISTINCT EXTRACT(YEAR FROM `date`) AS year
FROM `bigquery-public-data.iowa_liquor_sales.sales`
LIMIT 1000;
```

```sql
-- 2. Get the list of unique items sold
SELECT DISTINCT `item_description`
FROM `bigquery-public-data.iowa_liquor_sales.sales`
LIMIT 1000;
```

```sql
-- 3. Fetch total sales revenue per item for 2023
SELECT `item_description`, SUM(`sale_dollars`) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
GROUP BY `item_description`
LIMIT 1000;
```

```sql
-- 4. Fetch total sales revenue per item for 2022
SELECT `item_description`, SUM(`sale_dollars`) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2022
GROUP BY `item_description`
LIMIT 1000;
```

```sql
-- 5. Find items sold only in 2023
SELECT DISTINCT s2023.`item_description`
FROM (
  SELECT DISTINCT `item_description`
  FROM `bigquery-public-data.iowa_liquor_sales.sales`
  WHERE EXTRACT(YEAR FROM `date`) = 2023
) s2023
LEFT JOIN (
  SELECT DISTINCT `item_description`
  FROM `bigquery-public-data.iowa_liquor_sales.sales`
  WHERE EXTRACT(YEAR FROM `date`) = 2022
) s2022
ON s2023.`item_description` = s2022.`item_description`
WHERE s2022.`item_description` IS NULL
LIMIT 1000;
```

```sql
-- 6. List the top 10 items by sales revenue in 2023
SELECT `item_description`, SUM(`sale_dollars`) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
GROUP BY `item_description`
ORDER BY total_sales DESC
LIMIT 10;
```

```sql
-- 7. List the top 10 items by sales revenue in 2022
SELECT `item_description`, SUM(`sale_dollars`) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2022
GROUP BY `item_description`
ORDER BY total_sales DESC
LIMIT 10;
```

```sql
-- 8. Calculate the total sales revenue per month in 2023
SELECT EXTRACT(MONTH FROM `date`) AS month, SUM(`sale_dollars`) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
GROUP BY month
ORDER BY month
LIMIT 1000;
```

```sql
-- 9. Retrieve the number of items sold per category in 2023
SELECT `category_name`, COUNT(DISTINCT `item_description`) AS item_count
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
GROUP BY `category_name`
LIMIT 1000;
```

```sql
-- 10. Get daily sales revenue trend for a specific item in 2023
SELECT `date`, SUM(`sale_dollars`) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
AND LOWER(`item_description`) LIKE '%vodka%'
GROUP BY `date`
ORDER BY `date`
LIMIT 1000;
```

These queries help in exploring the dataset to understand the distribution of sales across items, years, and categories, which is essential for calculating the year-over-year growth percentages.Query:
-- 1. Retrieve distinct years from the data
SELECT DISTINCT EXTRACT(YEAR FROM `date`) AS year
FROM `bigquery-public-data.iowa_liquor_sales.sales`
LIMIT 1000;
Answer:
year
2012
2024
2019
2023
2014
2015
2022
2017
2021
2013
2016
2020
2018
Query:
-- 2. Get the list of unique items sold
SELECT DISTINCT `item_description`
FROM `bigquery-public-data.iowa_liquor_sales.sales`
LIMIT 1000;
Answer:
Too long, hard cut:
item_description
SKYY VODKA
WHITE CLAW PREMIUM VODKA
DEWARS WHITE LABEL SCOTCH
FIREBALL HALLOWEEN ADULT TRICK-OR-TREAT BAG MINI
MIDNIGHT MOON HOLIDAY MOONSHAKE VARIETY CANDY CANE MINI
RICH & RARE PEACH MINI
JACK DANIELS OLD #7 BLACK LABEL MINI
JIM BEAM HONEY MINI
JIM BEAM PEACH MINI
ABSOLUT GRAPEFRUIT MINI
REVELTON VODKA MINI
WESTERN SON LIME MINI
BACARDI COCO MINI
FIREBALL CINNAMON WHISKEY 50ML SLEEVE
CAPTAIN MORGAN SLICED APPLE MINI
EZRA BROOKS BOURBON CREAM MINI
99 APPLES MINI DISPLAY
SKREWBALL PEANUT BUTTER WHISKEY MINI
GLENMORANGIE TASTER PACK
RIVER ROSE GIN MINI
AMERICAN ANTHEM VODKA MINI
SOUTHERN COMFORT 80PRF
FIVE STAR
NEW AMSTERDAM GIN
FIREBALL CINNAMON
JOSE CUERVO ESPECIAL REPOSADO
KAH BLANCO MINI
BLAIR ATHOL
HENNESSY BLACK
REMY MARTIN VSOP FLASK
CIROC PINEAPPLE
TOOTERS ALA BAMA SLAMA
ARROW PEPPERMINT SCHNAPPS
COURVOISIER VS COGANC
JOHNNIE WALKER RED
CEDAR RIDGE GRAPPA
BETINI LEMON DROP
DEKUYPER HOT DAMN!
DEWAR'S WHITE LABEL SCOTCH
HENDRICKS GIN MINI
SEAGRAMS SEVEN CROWN AMERICAN SPICED MINI
VAN GOGH DOUBLE EXPRESSO VODKA MINI
UV BLUE RASPBERRY VODKA MINI
DR. MCGILLICUDDY'S PEACH MINI
CAPTAIN MORGAN LOCONUT MINI
CAPTAIN MORGAN WATERMELON SMASH MINI
OLMECA ALTOS PLATA MINI
JOHNNIE WALKER MINI DISCOVERY PACK
JACK DANIELS 12YR
JACK DANIELS TWICE BARRELED SPECIAL RELEASE
BAILEYS ORIGINAL IRISH CREAM W/2 DESSERT BOWLS
CROWN ROYAL W/NFL JERSEY BAG
GRAND MARNIER W/ROCKS GLASS GIFT SET
CROWN ROYAL GOLDEN APPLE
CANADIAN LTD WHISKY CONVENIENCE PACK
PENDLETON VIKINGS
SWEAR JAR CANDIED GREEN APPLE
FARMSTOCK IOWA BATCH
JAMESON BLACK BARREL
THE SEXTON
BEN HOLLADAY 6YR MO BOURBON
OLD FORESTER SIGNATURE 100PRF BOURBON
BASIL HAYDEN SUBTLE SMOKE
BLANTONS BOURBON
CLYDE MAYS SPECIAL RESERVE STRAIGHT BOURBON WHISKEY 6YR
BP ELIJAH CRAIG PRIVATE BARREL - BARREL PROOF
FIGHTING COCK BOURBON
GARRISON BROTHERS SNGL BRL SAMPLER TEXAS STRAIGHT BOURBON
JAMES E PEPPER 1776 STRAIGHT BOURBON WHISKEY 100PRF
LUX ROW FOUR GRAIN DOUBLE BARREL
REDEMPTION WHEATED BOURBON
RIDGEMONT RESERVE 1792
WILD TURKEY KENTUCKY SPIRIT SINGLE BARREL
WELLER RESERVE 7YR BOURBON
BP YELLOWSTONE HAND PICKED 115PRF
OLD ELK WHEAT N RYE
HIGH WEST CASK COLLECTION SAUVIGNON FINISH
WHISTLEPIG CAMPSTOCK WHEAT WHISKEY
TEMPLETON 10YR SINGLE BARREL RYE
SLIPKNOT IOWA WHISKEY NO. 9 RESERVE
JACK DANIELS TENNESSEE RYE
CEDAR RIDGE WHEAT WHISKEY
PLYMOUTH GIN
JACK DANIELS 4YR RYE SINGLE BARREL
GREY GOOSE LA POIRE VODKA
STOLICHNAYA 80PRF
INGENIOZ
ABSOLUT GRAPEFRUIT
NORTH FORTY VODKA
SMIRNOFF 80PRF PET
SEAGRAMS RUBY RED GRAPEFRUIT VODKA
UV RED (CHERRY) VODKA
BLUE CHAIR BAY COCONUT
MT. GAY ECLIPSE RUM
RON ZACAPA 23YR
ZAYA GRAN RESERVA RUM
BACARDI SPICED RUM
BACARDI RASPBERRY
CENTENARIO 7YR
BUCHANAN'S 12 YR DELUXE SCOTCH
DALMORE 15YR
CALVADOS MORIN SELECTION
JOHNNIE WALKER BLUE
PAUL MASSON PINEAPPLE GRANDE AMBER BRANDY
BLONDIES STRAWBERRY LEMONADE
JOSE CUERVO AUTHENTIC STRAWBERRY LIME MARGARITA
TAMNAVULIN SCOTCH WHISKY
JOSE CUERVO ESPECIAL SILVER W/1L CLASSIC MARGARITA MIX
LAGAVULIN OFFERMAN CARIBBEAN RUM CASK FINISH
GREY GOOSE ESSENCES WHITE PEACH & ROSEMARY
HENDRICKS LUNAR
ARDBEG ANAMORPHIC
ROCK N ROLL TEQUILA GUITAR MANGO
RUMCHATA PUMPKIN SPICE
SOLERNO BLOOD ORANGE LIQUEUR
BAILEYS VANILLA CINNAMON
BUMBU CREME
KERRYGOLD IRISH CREAM LIQUEUR
BAILEYS ALMANDE
BALLOTIN CHOCOLATE PEANUT BUTTER CREAM
GODIVA DARK CHOCOLATE LIQUEUR
KINKY ALOHA
BP REBEL STAVE FINISH COLLECTION
SMIRNOFF BLUE RASPBERRY LEMONADE
SMIRNOFF SORBET LIGHT RASPBERRY POMEGRANATE
SUGARLANDS FRUIT PUNCH MOONSHINE
ARROW CREME DE MENTHE GREEN
CASHEL IRISH CREAM
CODY ROAD EXPERIMENTAL - MERLOT BARREL FINISH BOURBON
EL MAYOR EXTRA ANEJO PORT FINISH
OLE SMOKY MINT CHOCOLATE CHIP CREAM WHISKEY
GARRISON BROTHERS HONEY DEW STRAIGHT BOURBON WHISKEY
818 REPOSADO TEQUILA
AMOR EXTRA ANEJO
CAMPO BRAVO PLATA TEQUILA
SOLANA AGAVE BLANCO
JOSE CUERVO TRADICIONAL REPOSADO
HERRADURA ANJEO
OLMECA ALTOS REPOSADO
TRES GENERACIONES ANEJO
HA OLD FORESTER BIRTHDAY BOURBON 2023
HA OLD FITZGERALD 17 YR BIB DECANTER
HA DAVIESS COUNTY MEDIUM TOAST
SOOH WILDERNESS TRAIL BOTTLED IN BOND SMALL BATCH
HA W L WELLER 2024 BOURBON
SOOH MILLET ARMAGNAC VSOP
BUSHMILLS RED BUSH
MICHAEL COLLINS IRISH WHISKEY
IOWISH WHISKEY
SEAGRAMS SEVEN CROWN STONE CHERRY
MAD HEN FIERY CINNAMON
BELVEDERE VODKA
PINNACLE VODKA
THREE OLIVES VODKA
THREE OLIVES POMEGRANATE
PINNACLE CHOCOLATE WHIPPED
PINNACLE ATOMIC HOT
THREE OLIVES CUCUMBER LIME
UV WHIPPED DISCO
UV WHIPPED
RAIN CUCUMBER
UV PINK LEMONADE VODKA
UV IVORY (VANILLA) VODKA
MYERS'S RUM ORIGINAL DARK
CALICO JACK WHIPPED
FAMOUS GROUSE SCOTCH
E & J VS BRANDY TRAVELERS
ISLE OF JURA 10YR
KAHLUA PUMPKIN SPICE
KINKY GOLD
PARAMOUNT CREME DE MENTHE/WHITE
BLUE CHAIR BAY KEY LIME CREAM
SASSY GIRL
ARROW MCDALE'S BUTTERSCOTCH SCHNAPPS
JEREMIAH WEED SARSAPARILLA WHISKEY
HA GLEN GARIOCH VIRGIN OAK
CODIGO 1530 COMBO PACK
GLENMORANGIE PIONEER PACK
HAWKEYE LIGHT RUM
TEACHER'S
OLD FORESTER MINT JULEP
DEKUYPER CACTUS JUICE
DEKUYPER PEACHTREE
MR BOSTON GOLD TEQUILA
MONTEZUMA TRIPLE SEC
99 COCONUT MINI
BARREL RIVER ROSE GIN
HENNESSY V
Query:
-- 3. Fetch total sales revenue per item for 2023
SELECT `item_description`, SUM(`sale_dollars`) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
GROUP BY `item_description`
LIMIT 1000;
Answer:
Too long, hard cut:
item_description,total_sales
HENNESSY VS,6458602.139999998
SEAGRAMS EXTRA SMOOTH VODKA,412311.03
MARASKA SLIVOVITZ,31798.80000000002
ABSOLUT SWEDISH VODKA 80PRF MINI,272824.19999999995
SEAGRAMS EXTRA SMOOTH VODKA MINI,30774.000000000015
WHITE CLAW PINEAPPLE VODKA MINI,3812.520000000001
DEEP EDDY LEMON MINI,105114.01000000002
HENNESSY VS MINI,131031.9
BAILEYS COLADA MINI,603.4499999999999
MIDNIGHT MOON CHOCOLATE BROWNIE MOONSHAKE MINI,20489.039999999986
THE ORIGINAL PICKLE SHOT MINI (SPICY PICKLE VODKA),38088.0
99 BLUE RASPBERRIES MINI,180759.9600000001
OLE SMOKY PEACH WHISKEY MINI,17797.5
KINKY PINK,198790.6900000001
JAGERMEISTER LIQUEUR MINI MEISTERS,20837.699999999997
BOND & LILLARD,13500.0
BLUE OX VODKA,1878983.4600000002
COURVOISIER VS COGNAC,425750.25
JD TWICE BARRELED HERITAGE RYE,10125.0
HA JACK DANIELS 12YR,10608.0
REVEL STOKE SMOREGASM TOASTED SMORES WHISKY,44123.49
WHISTLEPIG 18YR DOUBLE MALT RYE EDITION #4,112200.0
1792 BOTTLED IN BOND BOURBON,6457.5
CEDAR RIDGE BOURBON,1933558.31
ELIJAH CRAIG,913466.5199999998
BP JEFFERSONS RESERVE BOURBON BARREL,22170.20999999999
JEFFERSONS OCEAN AGED AT SEA,247682.67999999985
OLD ELK 8YR WHEATED BOURBON,5400.0
VERY OLD BARTON BOURBON CRAFTED 80PRF,1977.75
BP BRECKENRIDGE BOURBON WHISKEY RESERVE BLEND ALPHA,10800.0
LEADSLINGERS BOURBON WHISKEY 10YR,10950.0
CODY ROAD PEACH,31926.0
CEDAR RIDGE QUINTESSENTIAL AMERICAN SINGLE MALT,182710.32000000004
GENTLEMAN JACK,403431.7600000001
JACK DANIELS SINGLE BARREL,107149.5
BP KNOB CREEK RYE SINGLE BARREL,15688.080000000014
CRYSTAL HEAD VODKA,23782.000000000015
BURNETTS RASPBERRY,24441.75
BUMBU XO,50326.63999999998
B&B DOM,56615.25
GOLDSCHLAGER CINNAMON SCHNAPPS,115394.25
JAMESON ORANGE,508318.9800000003
AMARO MONTENEGRO,24696.0
PROPER NO. TWELVE  APPLE,65982.0
EVAN WILLIAMS PEACH,42363.0
SODA JERK ROOT BEER SHOT,13530.0
WILD TURKEY AMERICAN HONEY STING,23418.0
ARROW CREME DE CACAO WHITE,16770.0
OLE SMOKY BANANA PUDDING CREAM MOONSHINE,286416.0
RUMCOQUI,5400.0
CALIROSA ANEJO,4893.75
CAZADORES ANEJO,20123.5
HA OBAN DISTILLERS EDITION,1034.8799999999999
SOOH JINRO CHAMISUL CLASSIC SOJU,15800.399999999985
HA MICHTERS 10YR OLD SINGLE BARREL,7593.75
JOSE CUERVO AUTHENTIC LIME LIGHT,26823.840000000015
BIRD DOG SALTED CARAMEL,55631.25
HORSE SOLDIER SMALL BATCH BOURBON WHISKEY,54060.0
MICHTERS US*1 KENTUCKY STRAIGHT SINGLE BARREL RYE,84525.0
MINOR CASE STRAIGHT RYE,40260.0
BEEFEATER GIN,411287.01000000007
WESTERN SON STRAWBERRY VODKA,14831.44
BLACKHEART PREMIUM SPICED RUM,56073.75
AMARULA CREAM LIQUEUR,27246.0
BALLOTIN CHOCOLATE CHERRY CREAM WHISKEY,20262.42000000001
KETEL ONE BOTANICAL CUCUMBER & MINT,116977.0
KURVBALL WHISKEY,38808.0
ROCKET FUEL,40668.49999999997
DON JULIO ANEJO,675388.19
MARGARITAVILLE GOLD TEQUILA,112196.80999999998
SOOH STRANAHANS BLUE PEAK,15544.5
CHI-CHI'S SKINNY MARGARITA,133789.5
CIROC VS,22155.89999999999
E & J VS SQUARE,24640.199999999993
JIM BEAM DOUBLE OAK,26187.0
SEAGRAMS 7 CROWN PET FLASK,105570.0
IOWA STATE 1858 VODKA,140965.5
TWISTED SHOTZ SEXY PARTY PACK 2.0,58833.280000000115
DON Q CRISTAL,38787.38000000001
DR MCGILLICUDDYS WILD GRAPE,74542.14000000003
SCORESBY RARE SCOTCH,206119.96000000002
FINAGRENS IRISH WHISKEY,143350.18000000005
EVAN WILLIAMS BLACK PET,31374.0
ABSOLUT MANDRIN,233433.89999999994
OLE SMOKY PUMPKIN SPICE CREAM MOONSHINE,38220.0
MCMASTERS CANADIAN WHISKEY,15309.0
BUZZBALLZ BIGGIES TEQUILA RITA,75885.0
BULLEIT BOURBON WHISKEY W/ MUG,10580.079999999998
RUSSELLS RESERVE SINGLE BARREL BOURBON,104761.5
TOOTERS RAINBOW PACK,16767.0
RIEGERS MIDWESTERN DRY GIN,19380.599999999984
VAN GOGH DOUBLE ESPRESSO VODKA,8484.0
TRUST ME VODKA ORGANIC,38148.0
DUBLINER HONEYCOMB LIQUEUR,52736.25
MOZART WHITE CHOCOLATE CREAM LIQUEUR,17404.419999999995
SUGARLANDS SOUR BLUE RASPBERRY MOONSHINE FOLDS OF HONOR,17606.400000000016
BALLOTIN CHOCOLATE WHISKEY CHOCOLATE MINT,13809.42000000001
THE BUTTERFLY CANNON CRISTALLINO SILVER TEQUILA,8348.800000000001
FLEISCHMANNS 80PRF VODKA,625757.9100000003
TULLAMORE DEW,290535.75
FIVE STAR PET,116810.98999999992
TANQUERAY STERLING VODKA,24066.0
SVEDKA 80PRF PET,26688.0
CHICKEN COCK CHANTICLEER COGNAC FINISH BOURBON,13440.119999999999
G & W BOURBON,19357.239999999983
SOOH WINDSOR BLACK CHERRY,5896.320000000007
SOOH BARRELL BOURBON DOVETAIL WHISKEY,42010.46999999996
GOTCHA GIN,21451.5
BIRD DOG HONEY FLAVORED WHISKEY MINI,2670.0
MR BOSTON BLACKBERRY BRANDY MINI,796.5000000000002
OLE SMOKY PEPPERMINT MOONSHINE MINI,11567.53
NEW AMSTERDAM PINEAPPLE MINI,11334.840000000002
BOLS COCKTAILS AZUL MARGARITA,1784.25
TOOTERS BLU-DACIOUS KAMIKAZI MINI,13734.799999999997
KEEPERS HEARTS IRISH WHISKEY,15225.0
EFFEN RASPBERRY,18168.75
1800 CUCUMBER & JALAPENO,20592.0
TEQUILA KOMOS ANEJO CRISTALINO,16436.199999999997
HA REMUS GATSBY 2023,8438.849999999999
POWERS GOLD IRISH WHISKEY,45497.61000000001
MR BOSTON PEPPERMINT SCHNAPPS,9515.520000000006
TRAVELLER BLENDED NO 40,28080.0
RIVER ROSE GIN,42236.65999999999
CRUZAN BLACKSTRAP,19556.999999999993
KINKY BLUE PATIO PUNCH,8316.0
HORNITOS
Query:
-- 4. Fetch total sales revenue per item for 2022
SELECT `item_description`, SUM(`sale_dollars`) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2022
GROUP BY `item_description`
LIMIT 1000;
Answer:
Too long, hard cut:
item_description,total_sales
BARTON VODKA,1315892.2400000002
BLACK VELVET,11674549.60000002
99 BRAND VARIETY PARTY YARD PACK MINI,6578.999999999998
FIREBALL CINNAMON WHISKEY PARTY YARD MINI,46362.60000000002
CROWN ROYAL PEACH MINI,18203.129999999997
SEAGRAMS 7 CROWN MINI,36706.64
UV RED CHERRY MINI,18416.100000000013
ADMIRAL NELSON SPICED MINI,69201.99000000002
HPNOTIQ MINI,33550.67999999997
99 BRAND MYSTERY FLAVOR PET MINI,28638.000000000022
99 WATERMELON PET MINI,126858.6
JACK DANIELS TENNESSEE FIRE MINI,139759.5
OLE SMOKY BANANA PUDDING CREAM MOONSHINE MINI,58809.26999999998
BLACK VELVET PEACH CANADIAN WHISKEY MINI,22389.0
ABSOLUT SWEDISH VODKA 80PRF,3591595.3600000017
NEW AMSTERDAM RED BERRY,134654.82999999996
WHITE DOG WHEAT,14647.5
WHITE DOG STRAIGHT RYE,14701.5
CROWN ROYAL PEACH,5298659.220000001
ELIJAH CRAIG  BARREL PROOF,153562.5
TEMPLETON RYE 4YR,1051562.49
WESTERN SON ORIGINAL,35609.42000000003
DEEP EDDY RUBY RED GRAPEFRUIT,186439.5
CAPTAIN MORGAN WHITE,100891.77000000008
SELVAREY OWNERS RESERVE GIFT BOX,9490.5
PAPAS PILAR DARK RUM,10264.38
COPPER DOG,17639.619999999988
JOHNNIE WALKER BLACK,706975.7500000003
CIROC SUMMER CITRUS,69592.68000000002
1800 COCONUT,78958.6500000001
TIPPY COW CHOCOLATE,61842.0
PARAMOUNT PEPPERMINT SCHNAPPS PET,65718.0
DEKUYPER LUSCIOUS PEACHTREE,904327.5999999994
99 PEACHES,35661.03
OLE SMOKY PEANUT BUTTER WHISKEY,224152.5
CINCORO BLANCO TEQUILA,25522.5
TEREMANA BLANCO TEQUILA,818192.8999999998
PATRON REPOSADO,414978.0
HA OLD RIP VAN WINKLE 15YR (PAPPY),1260.0
HA CEDAR RIDGE BOURBON: SINGLE BARREL COLLECTION (S.B.C.),5985.0
HORNITOS GOLD,187290.0
SIP SHINE SHINE BERRY SWEET TEA,3571.5
DAVID NICHOLSON RESERVE,12783.75
FOUR ROSES SINGLE BARREL,439155.0
UNCLE NEAREST 1856 AGED WHISKEY,36696.0
ABSOLUT APEACH,108486.95000000004
NEW AMSTERDAM PET,105964.5
360 DOUBLE CHOCOLATE,45745.64000000001
MALIBU PASSION FRUIT,51400.899999999994
CRUZAN BLACK CHERRY,130956.0
GLEN MORAY,29137.320000000007
MR BOSTON BLACKBERRY BRANDY,82253.76000000001
ST BRENDANS IRISH CREAM,65740.5
CHILA COFFEE LIQUEUR,20231.52000000001
SMIRNOFF ZERO SUGAR INFUSION STRAWBERRY & ROSE,60847.699999999975
PARAMOUNT CREME DE MENTHE GREEN,45015.38
DEKUYPER HOT DAMN! 100PRF,18257.51999999998
OLE SMOKY PEACH WHISKEY,142054.5
CASA NOBLE CRYSTAL,33201.00000000004
CORRALEJO REPOSADO,289238.66000000003
EL JIMADOR ANEJO,36298.80000000003
HUSSONGS REPOSADO,18670.5
ESPOLON ANEJO,27426.0
SOOH SMOOTH AMBLER CONTRADICTION,7653.899999999997
TWISTED SHOTZ PINEAPPLE UPSIDE DOWN CAKE,5385.9
MR BOSTON PEACH,98310.0
CANADIAN CLUB RESERVE TRIPLE AGED,8886.240000000007
UNCLE NEAREST STRAIGHT RYE WHISKEY,6240.0
JIM BEAM ORANGE,82854.0
LIMOUSIN RYE WHISKEY,5638.450000000002
SMIRNOFF ZERO SUGAR INFUSION CUCUMBER & LIME,73871.46
CASAMIGOS ANEJO,206254.0900000002
CABIN STILL STR BOURBON,89707.5
STOLICHNAYA OHRANJ,33136.68
CRUZAN TROPICAL FRUIT,26124.0
SOOH MONKEY 47,37713.72000000002
BASIL HAYDEN,61833.0
MCCORMICK BLEND WHISKEY PET,36801.6
BOMBAY SAPPHIRE FEVER TREE VARIETY PACK,12201.0
NELSON BROS WHISKEY RESERVE BOURBON,17820.0
EFFEN BLACK CHERRY,49856.25
DIPLOMATICO MANTUANO,18306.0
LAGAVULIN 8YR,47853.640000000014
THE ORIGINAL PICKLE SHOT DILL PICKLE VODKA,66633.75
TIPPY COW SHAMROCK MINT,46315.5
BLACKENED WHISKEY,39250.19999999999
STARA SOKOLOVA SILVER,936.0
SOOH CHERRY HEERING,10434.029999999999
99 BUTTERSCOTCH,5494.060000000005
SEAGRAMS VO CANADIAN WHISKEY PET,422997.5300000001
PINNACLE,613126.5
FORTY CREEK,26007.96000000001
CLEARHEART GIN,16143.750000000002
ON THE ROCKS COCKTAILS LARIOS AVIATION,37872.0
OLD ST NICKS EGG NOG,16600.770000000008
EZRA BROOKS BOURBON CREAM,23433.75
ELLA PLUM,333.0
TRADER VICS PRIVATE SELECTION SPICED RUM,48406.5
SUGARLANDS SHINE BLUEBERRY MUFFIN MOONSHINE,934.5600000000001
KOVAL CRANBERRY GIN LIQUEUR,2754.0
BRECKENRIDGE MADEIRA FINISH,1890.0
GREY GOOSE ESSENCES STRAWBERRY & LEMONGRASS MINI,1912.3200000000015
WHEEL HORSE BOURBON,8104.639999999998
HA RUSSELLS RESERVE 13YR BARREL PROOF,8100.0
BACARDI RUM PUNCH RTS,14614.599999999988
TWISTED SHOTZ CHOCOLATE BUTTERY NIPPLE,8204.25
WOODFORD RESERVE KENTUCKY DERBY 2022,23963.21999999999
KYODIE RAVIN APPLE WHISKEY,1228.5
CM NASSIF FAMILY RESERVE,18606.75
COUNTRY SMOOTH SMALL BATCH STRAIGHT BOURBON WHISKEY,1580.4599999999996
SWEET REVENGE,13472.45999999999
EVAN WILLIAMS SPICED CIDER,9187.5
HORNITOS STRAWBERRY TAMARIND MARGARITA,3267.0
ZIYAD BERRY BUSSIN TEA,804.0
SOOH AALBORG TAFFEL AQUAVIT,6781.5
MONTEZUMA BLUE,138723.53999999998
HA WILD TURKEY RARE BREED RYE BARREL PROOF,6588.0
CRAIGELLACHIE 13YR SINGLE MALT,14597.079999999989
DULCE VIDA PINEAPPLE JALAPENO,26301.0
ROSSVILLE UNION BARREL PROOF RYE,7875.0
CAPEL PREMIUM PISCO,4498.200000000003
WESTWARD STOUT CASK WHISKEY,3172.5
LOBOS 1707 JOVEN NECKTIE,8788.999999999996
LUSTER CLASSIC LIMONCELLO,3076.920000000001
SOOH BARTENDERS BANANAS OVER YOU,9331.96
ROW VODKA MINI,1575.729999999999
SOUTHERN COMFORT HOLIDAY COCKTAIL CALENDAR,907.1999999999999
MOSSBURN ISLAND BLENDED MALT SCOTCH WHISKY,3473.5499999999993
HAKU 
Query:
-- 5. Find items sold only in 2023
SELECT DISTINCT s2023.`item_description`
FROM (
  SELECT DISTINCT `item_description`
  FROM `bigquery-public-data.iowa_liquor_sales.sales`
  WHERE EXTRACT(YEAR FROM `date`) = 2023
) s2023
LEFT JOIN (
  SELECT DISTINCT `item_description`
  FROM `bigquery-public-data.iowa_liquor_sales.sales`
  WHERE EXTRACT(YEAR FROM `date`) = 2022
) s2022
ON s2023.`item_description` = s2022.`item_description`
WHERE s2022.`item_description` IS NULL
LIMIT 1000;
Answer:
Too long, hard cut:
item_description
BLANTONS GOLD BOURBON
HA THOMAS HANDY RYE 2023
BOWMAN BROTHERS BOURBON
GLENDALOUGH DOUBLE BARREL
EZRA BROOKS RYE 99
REBEL STRAIGHT RYE 100
TANQUERAY NEGRONI COCKTAIL
BIG HOUSE BOURBON
ELIJAH CRAIG RYE HOLIDAY VAP
PIGGYBACK RYE W/POUR SNOUT
HA LEDAIG SINGLE MALT SCOTCH RIOJA CASK FINISH
ZING ZANG BLAZING BLOODY MARY RTS
WRAY & NEPHEW OVERPROOF RUM MINI
HA EL MAYOR EXTRA ANEJO 25TH ANNIVERSARY BOURBON BARREL AGED
CANTERA NEGRA REPOSADO
CODY ROAD EXPERIMENTAL  PINOT NOIR BARREL FINISH
IMMORTAL CLAN USE CODE 6281
BARRELL FOUNDATION BOURBON
SOOH OLE SMOKY AMARETTO WHISKEY
CHOYA GOLDEN UME FRUITS
CONCIERE RUM SILVER
LOCH LOMOND THE OPEN SPECIAL ED. SINGLE MALT SCOTCH 2022
KIRKLAND SIGNATURE TOUR OF SCOTLAND  6-4 PACK
BARTENDERS TRADING COMPANY AWESOME ORANGE
YELLOWSTONE HAND PICKED BARREL PROGRAM - BUY THE BARREL
BIMBER APOGEE 12YR BLENDED MALT WHISKY
CLEAR CREEK CHERRY BRANDY MINI
KOLOA HAWAIIAN RUM PUNCH COCKTAIL
ARETTE SUAVE BLANCO TEQUILA
MR BOSTON SOUR CHERRY SCHNAPPS
GRACIAS A DIOS GIN OAXACA RECIPE
LOS AMANTES JOVEN
OAK & EDEN SPIRE SELECT RYE FRENCH OAK BUY THE BARREL
JAGERMEISTER MINIMEISTER ICE BUCKET VAP
FIREBALL BIRDIE SHOT MINI
BAILEYS CHOCOLATE
WIDOW JANE APPLE WOOD RYE
WHITE CLAW MANGO VODKA
JOSE CUERVO AUTHENTIC TROPICAL PARADISE
CUTWATER TEQUILA BLANCO
SOOH DON JULIO ANEJO
SMOOTH AMBLER CONTRADICTION W/2 GLASSES
SKYY INFUSIONS ESPRESSO
JIM BEAM WHITE W/HIGHBALL GLASS
BUBBAS MARSHMALLOW CHOCOLATE WHISKEY
PLOW POINT SMALL BATCH WHISKEY
CARAVEDO PURO QUEBRANTA
STEEPLE RIDGE 5YR WHEAT WHISKEY
10TH MOUNTAIN RYE
99 WATERMELON SCHNAPPS
POWERS JOHN LANE
CORAZON ANEJO TEQUILA BUY THE BARREL
CANCION ANEJO TEQUILA
ALIPUS SAN JUAN MEZCAL
MONTELOBOS PECHUGA MEZCAL
173 CRAFT DISTILLERY SPICED RUM
BARTENDERS TRADING COMPANY PINA COLADA
NO. 3 LONDON DRY GIN
99 RED MINI
HIRSCH THE BIVOUAC BOURBON
LEROUX ROCK AND RYE
CONCIERE BOURBON WHISKEY
LAGRIMAS DE DOLORES ANEJO MEZCAL
LOST REPUBLIC STRAIGHT RYE WHISKEY
YU
SHANKY''S WHIP
RD ONE FINISHED WITH FRENCH OAK
EL TRAGO BLANCO
SHADEHOUSE GIN
UV MANGO GLOW MINI
HA HEAVEN HILL HERITAGE COLLECTION 20YR CORN WHISKEY 2ND ED.
GRACIAS A DIOS OAXACA GIN
BUZZARDS ROOST CIGAR RYE STRAIGHT RYE WHISKEY
HA JOHNNIE WALKER BLUE YEAR OF THE RABBIT
BARRELL SEAGRASS
KOVAL FOUR GRAIN
TRAVERSE CITY WHISKEY CO. FINISHING SERIES HIGH RYEPX SHERRY
GENTLEMAN JACK MINI
BENROMACH 15 YEAR OLD
APPLETON ESTATE 15YR BLACK RIVER CASKS
NELSON BROS. WHISKEY COGNAC CASK
COMPASS BOX ORCHARD HOUSE
STARA SOKOLOVA TRAVKA
TEQUILA CIMARRON REPOSADO
NUESTRA SOLEDAD SANTIAGO MATATLAN
OLE SMOKY ORIGINAL CORN MOONSHINE
SCORPION MEZCAL SILVER
THE SCARLET IBIS TRINIDAD RUM
HA LAST DROP 50YR BSW 700ML & 50ML
MOSSBURN ROYAL BRACKLA SINGLE MALT SCOTCH WHISKY
GRACIAS A DIOS MEZCAL TEPEXTATE
PHANTOM V DISTILLING BUTTERSCOTCH
TRAVIS HASSE CHERRY
KAIYO WHISKY PEATED 2ND EDITION
HORSE SOLDIER STRAIGHT BOURBON WHISKEY
ALVISA XO BRANDY
RUMPLE MINZE
LONGBRANCH WITH 2 ROCK GLASSES
SOBIESKI RASPBERRY VODKA
METHOD AND MADNESS SINGLE MALT
GLENMORANGIE 15YR CADBOLL ESTATE 2023 EDITION
MI CAMPO COCKTAILS SPICY JALAPENO MARGARITA
HA WIDOW JANE DECADENCE
KENTUCKY OWL MAIGHSTIR
PANAMA PACIFIC RUM 23 YEARS
BUBBAS BURNT SUGAR WHISKEY USE CODE 73120
RD ONE DOUBLE FINISHED WITH OAK AND MAPLE BARRELS
NUMBER JUAN EXTRA ANEJO
BENROMACH 10YR
MOSHINE PASSION FRUIT
MIDNIGHT MOON APPLE PIE W/POUR LID
REVELTON DISTILLERS EDITION RYE BARREL PICK BUY THE BARREL
MCCORMICK GIN
DUKE REPOSADO
CM CATS EYE SINGLE MALT SCOTCH WHISKEY BUY THE BARREL
MACNAIRS LUM REEK 12 YR PEATED BLENDED MALT
GLENALLACHIE 8YR SPEYSIDE SINGLE MALT SCOTCH WHISKY
MAYALEN MACHETAZO ESPADIN
PLANTATION BARBADOS RUM XO 20TH ANNIVERSARY-USE CODE 942851
TOMINTOUL 12YR PORT CASK FINISH
CONTROL C PISCO
CM OBTAINIUM SINGLE GRAIN SCOTCH WHISKEY BUY THE BARREL
LAIRDS 10TH GENERATION APPLE BRANDY
CLEMENT CANNE BLEUE
DRIFTLESS GLEN SINGLE BARREL STRAIGHT BOURBON BUY THE BARREL
R. JELINEK SILVER SLIVOVITZ
360 WATERMELON VODKA
SKYY VODKA MINI
TWISTED TEA WHISKEY MINI
RABBIT HOLE 2PK W/CAVEHILL & HEIGOLD
SOOH CALUMET FARMS SMALL BATCH BOURBON
HORSE SOLDIER BARREL STRENGTH BOURBON WHISKEY
TX BOURBON W/BOTTLE CAP STAVE
ABSOLUT W/RISE COLD BREW
CORAL ISLE SPICED RUM
HERRADURA LEGEND ANEJO
R. JELINEK FERNET
SOOH ADICTIVO ANEJO
NEW AMSTERDAM PINK WHITNEY PET
JAGERMEISTER ALUMINUM SHOT CUP VAP
99 WHIPPED
REDBREAST 12YR CASK STRENGTH
ARETTE ARTESANAL SUAVE ANEJO TEQUILA
TATTERSALL TIGHTLINE ORGANIC VODKA
JAMESON COLD BREW MINI
JOURNEYMAN LAST FEATHER RYE SBS CASK STRENGTH BUY THE BARREL
CLEMENT CREOLE SHRUBB
SAZERAC DE FORGE COGNAC
VILLA MASSA LIMONCELLO
ROCK N ROLL TEQUILA PLATINUM
GLEN SCOTIA 18 YEAR OLD SINGLE MALT SCOTCH WHISKY
ZUCCA RABARBARO
TOWN BRANCH SINGLE BARREL RESERVE MALT WHISKEY BARREL BUY
ELIJAH CRAIG RYE WHISKEY
360 LIME
WESTWARD PINOT NOIR SB BUY THE BARREL
ROYAL SALUTE 21 YO
REDEMPTION STRAIGHT BOURBON COGNAC CASK FINISH
BP EZRA BROOKS CASK STRENGTH
BASIL HAYDEN MALTED RYE
MICHTERS US*1 SOUR MASH WHISKEY
HA MAKERS MARK CELLAR AGED
MIDNIGHT MOON CHOCOLATE BROWNI
Query:
-- 6. List the top 10 items by sales revenue in 2023
SELECT `item_description`, SUM(`sale_dollars`) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
GROUP BY `item_description`
ORDER BY total_sales DESC
LIMIT 10;
Answer:
item_description,total_sales
TITOS HANDMADE VODKA,30042562.53000001
BLACK VELVET,12263890.700000005
FIREBALL CINNAMON WHISKEY,11592055.799999995
CROWN ROYAL,10209429.249999994
JACK DANIELS OLD #7 BLACK LABEL,9611569.679999996
CAPTAIN MORGAN ORIGINAL SPICED,9261306.21
CROWN ROYAL REGAL APPLE,9239467.830000002
CAPTAIN MORGAN ORIGINAL SPICED BARREL,7061536.24
PATRON SILVER,6963129.0
JAMESON,6958456.299999997
Query:
-- 7. List the top 10 items by sales revenue in 2022
SELECT `item_description`, SUM(`sale_dollars`) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2022
GROUP BY `item_description`
ORDER BY total_sales DESC
LIMIT 10;
Answer:
item_description,total_sales
TITOS HANDMADE VODKA,27247213.760000017
FIREBALL CINNAMON WHISKEY,11839539.810000004
BLACK VELVET,11674549.600000018
CROWN ROYAL,11343341.339999996
CAPTAIN MORGAN ORIGINAL SPICED,10358733.520000005
CROWN ROYAL REGAL APPLE,10139859.319999998
JACK DANIELS OLD #7 BLACK LABEL,9517637.009999992
HENNESSY VS,7424003.100000001
JAMESON,6830823.149999999
PATRON SILVER,6729499.5
Query:
-- 8. Calculate the total sales revenue per month in 2023
SELECT EXTRACT(MONTH FROM `date`) AS month, SUM(`sale_dollars`) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
GROUP BY month
ORDER BY month
LIMIT 1000;
Answer:
month,total_sales
1,32547784.89000004
2,32114831.48
3,36403505.90000004
4,32884344.370000023
5,39684933.970000066
6,41194749.13000002
7,35838999.870000005
8,39788043.980000034
9,35096963.96000002
10,40281758.90000003
11,39289673.490000024
12,40945072.58000005
Query:
-- 9. Retrieve the number of items sold per category in 2023
SELECT `category_name`, COUNT(DISTINCT `item_description`) AS item_count
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
GROUP BY `category_name`
LIMIT 1000;
Answer:
category_name,item_count
AMERICAN CORDIALS & LIQUEURS,164
TEMPORARY & SPECIALTY PACKAGES,491
AMERICAN VODKAS,151
AMERICAN FLAVORED VODKA,223
IRISH WHISKIES,105
100% AGAVE TEQUILA,404
COCKTAILS/RTD,215
STRAIGHT BOURBON WHISKIES,384
SINGLE BARREL BOURBON WHISKIES,51
STRAIGHT RYE WHISKIES,143
CORN WHISKIES,35
FLAVORED GIN,31
IMPORTED FLAVORED VODKA,67
SINGLE MALT SCOTCH,180
SPICED RUM,38
SCOTCH WHISKIES,111
IMPORTED CORDIALS & LIQUEURS,182
TENNESSEE WHISKIES,63
AMERICAN SCHNAPPS,87
WHISKEY LIQUEUR,77
FLAVORED RUM,87
IMPORTED BRANDIES,90
AMERICAN BRANDIES,58
CANADIAN WHISKIES,94
BOTTLED IN BOND BOURBON,30
IMPORTED DRY GINS,60
IMPORTED VODKAS,56
WHITE RUM,50
IMPORTED SCHNAPPS,17
CREAM LIQUEURS,93
BLENDED WHISKIES,216
AMERICAN DRY GINS,80
AMERICAN DISTILLED SPIRITS SPECIALTY,101
MEZCAL,67
SPECIAL ORDER ITEMS,168
IMPORTED DISTILLED SPIRITS SPECIALTY,80
AGED DARK RUM,69
GOLD RUM,44
NEUTRAL GRAIN SPIRITS FLAVORED,45
MIXTO TEQUILA,29
TRIPLE SEC,9
NEUTRAL GRAIN SPIRITS,14
COFFEE LIQUEURS,19
AMERICAN SLOE GINS,2
Query:
-- 10. Get daily sales revenue trend for a specific item in 2023
SELECT `date`, SUM(`sale_dollars`) AS total_sales
FROM `bigquery-public-data.iowa_liquor_sales.sales`
WHERE EXTRACT(YEAR FROM `date`) = 2023
AND LOWER(`item_description`) LIKE '%vodka%'
GROUP BY `date`
ORDER BY `date`
LIMIT 1000;
Answer:
Too long, hard cut:
date,total_sales
2023-01-02,5289.52
2023-01-03,208584.43999999986
2023-01-04,196532.96000000008
2023-01-05,181457.38999999998
2023-01-06,160464.40999999997
2023-01-08,119946.88000000005
2023-01-09,254325.5299999999
2023-01-10,156040.21000000002
2023-01-11,224449.97000000012
2023-01-12,212271.83000000005
2023-01-13,214770.5999999999
2023-01-15,134.97
2023-01-16,252072.55000000002
2023-01-17,205048.5399999999
2023-01-18,224691.70000000007
2023-01-19,161882.63999999998
2023-01-20,206585.22999999992
2023-01-23,212915.0699999999
2023-01-24,183365.22000000006
2023-01-25,246136.17000000004
2023-01-26,206753.61999999997
2023-01-27,213086.25000000003
2023-01-29,1768.08
2023-01-30,371683.59
2023-01-31,164853.9900000001
2023-02-01,265933.3700000001
2023-02-02,203668.09000000014
2023-02-03,251806.67999999985
2023-02-06,318794.04000000004
2023-02-07,290954.84000000026
2023-02-08,230230.75000000012
2023-02-09,339231.0699999998
2023-02-10,202940.66000000003
2023-02-12,483.36
2023-02-13,256195.80000000013
2023-02-14,189174.48000000007
2023-02-15,207313.9499999999
2023-02-16,221227.41000000003
2023-02-17,253262.77
2023-02-20,209778.09000000005
2023-02-21,168135.40000000002
2023-02-22,226742.37999999998
2023-02-23,337239.6000000001
2023-02-24,240819.00000000012
2023-02-27,242137.36999999997
2023-02-28,198332.85000000006
2023-03-01,196586.33999999997
2023-03-02,187089.2000000001
2023-03-03,268688.6599999999
2023-03-06,272762.16
2023-03-07,242187.92999999996
2023-03-08,304517.20999999985
2023-03-09,193525.94999999992
2023-03-10,197232.77000000002
2023-03-13,240412.4700000001
2023-03-14,151440.55999999997
2023-03-15,185395.77999999997
2023-03-16,151095.18999999997
2023-03-17,195096.20999999996
2023-03-20,217694.28
2023-03-21,197738.50999999992
2023-03-22,205474.01999999987
2023-03-23,163266.41999999998
2023-03-24,215798.2300000001
2023-03-26,189.0
2023-03-27,190882.63999999996
2023-03-28,197405.33000000013
2023-03-29,262233.35
2023-03-30,184429.49000000022
2023-03-31,239851.00000000003
2023-04-03,418956.0900000001
2023-04-04,273382.8799999999
2023-04-05,249329.79
2023-04-06,274210.9299999999
2023-04-07,278322.3500000001
2023-04-09,889.1999999999999
2023-04-10,257666.12999999998
2023-04-11,170762.21999999988
2023-04-12,227736.35
2023-04-13,173817.73000000004
2023-04-14,231612.30000000005
2023-04-17,243092.71999999986
2023-04-18,222440.17000000007
2023-04-19,167484.5500000001
2023-04-20,237125.85000000003
2023-04-21,214260.64000000013
2023-04-24,476778.21
2023-04-25,178698.69000000012
2023-04-26,255378.89000000013
2023-04-27,212789.0699999999
2023-04-28,215989.73000000007
2023-05-01,243249.40999999992
2023-05-02,266167.73000000004
2023-05-03,449086.6599999999
2023-05-04,383586.78
2023-05-05,335507.3299999999
2023-05-08,264242.8199999999
2023-05-09,249728.5399999997
2023-05-10,210253.4400000001
2023-05-11,271652.99
2023-05-12,283915.93000000005
2023-05-15,239513.28000000003
2023-05-16,245249.07999999996
2023-05-17,266586.4000000001
2023-05-18,219126.6200000001
2023-05-19,293441.2700000001
2023-05-21,1124.7
2023-05-22,312690.9999999999
2023-05-23,302422.1300000001
2023-05-24,335663.0000000002
2023-05-25,268035.55
2023-05-26,293981.6499999999
2023-05-29,903.8399999999999
2023-05-30,305827.9299999999
2023-05-31,371439.9
2023-06-01,311864.5499999998
2023-06-02,171842.58000000002
2023-06-03,228048.82000000004
2023-06-05,279194.79999999993
2023-06-06,320548.95
2023-06-07,368199.10000000003
2023-06-08,325479.6600000001
2023-06-09,264241.3800000001
2023-06-12,258349.75000000003
2023-06-13,286342.83999999997
2023-06-14,275204.67999999993
2023-06-15,211010.59
2023-06-16,249435.5899999999
2023-06-19,228183.90999999995
2023-06-20,227626.37999999983
2023-06-21,276804.48999999993
2023-06-22,224837.55000000002
2023-06-23,289506.9999999999
2023-06-26,269693.3
2023-06-27,383968.7699999999
2023-06-28,428952.1700000001
2023-06-29,448967.8299999996
2023-06-30,300484.3400000001
2023-07-03,333144.07999999984
2023-07-05,202766.22999999995
2023-07-06,275261.53999999986
2023-07-07,260741.88999999996
2023-07-08,172119.17999999993
2023-07-10,241340.46999999997
2023-07-11,205891.1600000002
2023-07-12,246412.36999999988
2023-07-13,189356.48
2023-07-14,253634.47999999995
2023-07-17,262329.31999999995
2023-07-18,221963.64000000013
2023-07-19,270025.19000000006
2023-07-20,227051.6200000001
2023-07-21,265392.3199999999
2023-07-23,701.34
2023-07-24,439594.29
2023-07-25,236107.55999999994
2023-07-26,303783.60000000003
2023-07-27,200163.03999999986
2023-07-28,239162.20999999996
2023-07-30,132.6
2023-07-31,199013.88000000006
2023-08-01,362711.46
2023-08-02,489323.97000000003
2023-08-03,343831.5700000001
2023-08-04,398357.18999999994
2023-08-07,301727.1900000001
2023-08-08,283392.3300000001
2023-08-09,306160.05
2023-08-10,194278.03000000017
2023-08-11,246299.54999999993
2023-08-14,301405.8499999998
2023-08-15,251850.84999999992
2023-08-16,280104.01999999996
2023-08-17,228755.55000000002
2023-08-18,257012.36000000004
2023-08-21,318556.04000000004
2023-08-22,257979.0000
End Exploring Related Columns
Task: What are the top 5 items with the highest year-over-year growth percentage in total sales revenue for the year 2023?

Please answer only one complete SQL in bigquery dialect in ```sql``` format.
Usage example: ```sql
SELECT `column_name` FROM `database.schema.table` WHERE ... ``` (Replace `database`, `schema`, and `table` with actual names. Enclose column names and table identifiers with backticks.)
Follow the answer format like: ```csv
item_description,growth_percentage
item1:str,percentage1:float
item2:str,percentage2:float
item3:str,percentage3:float
item4:str,percentage4:float
item5:str,percentage5:float
```

These are the top 5 items with the highest year-over-year growth percentage in total sales revenue for the year 2023..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: 

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.

2025-01-19 06:28:32 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 06:28:32 - root - INFO - ```sql
WITH sales_2022 AS (
  SELECT
    item_description,
    SUM(sale_dollars) AS total_sales_2022
  FROM `bigquery-public-data.iowa_liquor_sales.sales`
  WHERE EXTRACT(YEAR FROM `date`) = 2022
  GROUP BY item_description
),
sales_2023 AS (
  SELECT
    item_description,
    SUM(sale_dollars) AS total_sales_2023
  FROM `bigquery-public-data.iowa_liquor_sales.sales`
  WHERE EXTRACT(YEAR FROM `date`) = 2023
  GROUP BY item_description
),
sales_growth AS (
  SELECT
    s2023.item_description,
    s2022.total_sales_2022,
    s2023.total_sales_2023
  FROM sales_2023 s2023
  INNER JOIN sales_2022 s2022 ON s2023.item_description = s2022.item_description
  WHERE s2022.total_sales_2022 > 0
)
SELECT
  item_description,
  ROUND(100.0 * (total_sales_2023 - total_sales_2022) / total_sales_2022, 4) AS growth_percentage
FROM sales_growth
ORDER BY growth_percentage DESC, item_description
LIMIT 5;
```
2025-01-19 06:28:34 - root - INFO - itercount: 1
2025-01-19 06:28:34 - root - INFO - 0
2025-01-19 06:28:34 - root - INFO - results: 
item_description,growth_percentage
JACK DANIELS WINTER JACK,82851.2924
99 CHERRIES,58511.7333
THE BUTTERFLY CANNON ROSA FLAVORED TEQUILA,13140.0
MR BOSTON HOLIDAY NOG,5440.293
MICHTERS US*1 AMERICAN WHISKEY,5140.5486


2025-01-19 06:28:34 - root - INFO - Please check the answer again by reviewing What are the top 5 items with the highest year-over-year growth percentage in total sales revenue for the year 2023?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
item_description,growth_percentage
item1:str,percentage1:float
item2:str,percentage2:float
item3:str,percentage3:float
item4:str,percentage4:float
item5:str,percentage5:float
```

These are the top 5 items with the highest year-over-year growth percentage in total sales revenue for the year 2023. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
item_description,growth_percentage
JACK DANIELS WINTER JACK,82851.2924
99 CHERRIES,58511.7333
THE BUTTERFLY CANNON ROSA FLAVORED TEQUILA,13140.0
MR BOSTON HOLIDAY NOG,5440.293
MICHTERS US*1 AMERICAN WHISKEY,5140.5486
Current sql:
WITH sales_2022 AS (
  SELECT
    item_description,
    SUM(sale_dollars) AS total_sales_2022
  FROM `bigquery-public-data.iowa_liquor_sales.sales`
  WHERE EXTRACT(YEAR FROM `date`) = 2022
  GROUP BY item_description
),
sales_2023 AS (
  SELECT
    item_description,
    SUM(sale_dollars) AS total_sales_2023
  FROM `bigquery-public-data.iowa_liquor_sales.sales`
  WHERE EXTRACT(YEAR FROM `date`) = 2023
  GROUP BY item_description
),
sales_growth AS (
  SELECT
    s2023.item_description,
    s2022.total_sales_2022,
    s2023.total_sales_2023
  FROM sales_2023 s2023
  INNER JOIN sales_2022 s2022 ON s2023.item_description = s2022.item_description
  WHERE s2022.total_sales_2022 > 0
)
SELECT
  item_description,
  ROUND(100.0 * (total_sales_2023 - total_sales_2022) / total_sales_2022, 4) AS growth_percentage
FROM sales_growth
ORDER BY growth_percentage DESC, item_description
LIMIT 5;
2025-01-19 06:28:58 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-19 06:28:58 - root - INFO - ```sql
WITH sales_2022 AS (
  SELECT
    item_description,
    SUM(sale_dollars) AS total_sales_2022
  FROM `bigquery-public-data.iowa_liquor_sales.sales`
  WHERE EXTRACT(YEAR FROM `date`) = 2022
  GROUP BY item_description
),
sales_2023 AS (
  SELECT
    item_description,
    SUM(sale_dollars) AS total_sales_2023
  FROM `bigquery-public-data.iowa_liquor_sales.sales`
  WHERE EXTRACT(YEAR FROM `date`) = 2023
  GROUP BY item_description
),
sales_growth AS (
  SELECT
    s2023.item_description,
    s2022.total_sales_2022,
    s2023.total_sales_2023
  FROM sales_2023 s2023
  INNER JOIN sales_2022 s2022 ON s2023.item_description = s2022.item_description
  WHERE s2022.total_sales_2022 > 0
)
SELECT
  item_description,
  ROUND(100.0 * (total_sales_2023 - total_sales_2022) / total_sales_2022, 4) AS growth_percentage
FROM sales_growth
ORDER BY growth_percentage DESC, item_description
LIMIT 5;
```

```csv
item_description,growth_percentage
JACK DANIELS WINTER JACK,82851.2924
99 CHERRIES,58511.7333
THE BUTTERFLY CANNON ROSA FLAVORED TEQUILA,13140.0000
MR BOSTON HOLIDAY NOG,5440.2930
MICHTERS US*1 AMERICAN WHISKEY,5140.5486
```
2025-01-19 06:29:00 - root - INFO - itercount: 2
2025-01-19 06:29:00 - root - INFO - 0
2025-01-19 06:29:00 - root - INFO - Total iteration counts: 2
