2025-01-21 14:39:46 - openai._base_client - INFO - Retrying request to /chat/completions in 0.492246 seconds
2025-01-21 14:40:52 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 14:40:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:40:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:40:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:40:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:40:53 - snowflake.connector.connection - INFO - closed
2025-01-21 14:40:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:40:54 - root - INFO - SQL:
-- 1. List the first 100 customers
SELECT "customer_id", "customer_unique_id", "customer_city", "customer_state"
FROM E_COMMERCE.E_COMMERCE.CUSTOMERS
LIMIT 100
Results:
Too long, hard cut:
customer_id,customer_unique_id,customer_city,customer_state
06b8999e2fba1a1fbc88172c00ba8bc7,861eff4711a542e4b93843c6dd7febb0,franca,SP
18955e83d337fd6b2def6b18a428ac77,290c77bc529b7ac935b93aa66c333dc3,sao bernardo do campo,SP
4e7b3e00288586ebd08712fdd0374a03,060e732b5b29e8181a18229c7b0b2b5e,sao paulo,SP
b2b6027bc5c5109e529d4dc6358b12c3,259dac757896d24d7702b9acbbff3f3c,mogi das cruzes,SP
4f2d8ab171c80ec8364f7c12e35b23ad,345ecd01c38d18a9036ed96c73b8d066,campinas,SP
879864dab9bc3047522c92c82e1212b8,4c93744516667ad3b8f1fb645a3116a4,jaragua do sul,SC
fd826e7cf63160e536e0908c76c3f441,addec96d2e059c80c30fe6871d30d177,sao paulo,SP
5e274e7a0c3809e14aba7ad5aae0d407,57b2a98a409812fe9618067b6b8ebe4f,timoteo,MG
5adf08e34b2e993982a47070956c5c65,1175e95fb47ddff9de6b2b06188f7e0d,curitiba,PR
4b7139f34592b3a31687243a302fa75b,9afe194fb833f79e300e37e580171f22,belo horizonte,MG
9fb35e4ed6f0a14a4977cd9aea4042bb,2a7745e1ed516b289ed9b29c7d0539a5,montes claros,MG
5aa9e4fdd4dfd20959cad2d772509598,2a46fb94aef5cbeeb850418118cee090,rio de janeiro,RJ
b2d1536598b73a9abd18e0d75d92f0a3,918dc87cd72cd9f6ed4bd442ed785235,lencois paulista,SP
eabebad39a88bb6f5b52376faec28612,295c05e81917928d76245e842748184d,sao paulo,SP
1f1c7bf1c9b041b292af6c1c4470b753,3151a81801c8386361b62277d7fa5ecf,caxias do sul,RS
206f3129c0e4d7d0b9550426023f0a08,21f748a16f4e1688a9014eb3ee6fa325,piracicaba,SP
a7c125a0a07b75146167b7f04a7f8e98,5c2991dbd08bbf3cf410713c4de5a0b5,rio de janeiro,RJ
c5c61596a3b6bd0cee5766992c48a9a1,b6e99561fe6f34a55b0b7da92f8ed775,guarulhos,SP
9b8ce803689b3562defaad4613ef426f,7f3a72e8f988c6e735ba118d54f47458,sao paulo,SP
49d0ea0986edde72da777f15456a0ee0,3e6fd6b2f0d499456a6a6820a40f2d79,pacaja,PA
154c4ded6991bdfa3cd249d11abf4130,e607ede0e63436308660236f5a52da5e,florianopolis,SC
690172ab319622688d3b4df42f676898,a96d5cfa0d3181817e2b946f921ea021,aparecida de goiania,GO
2938121a40a20953c43caa8c98787fcb,482441ea6a06b1f72fe9784756c0ea75,sao paulo,SP
237098a64674ae89babdc426746260fc,4390ddbb6276a66ff1736a6710205dca,curitiba,PR
cb721d7b4f271fd87011c4c83462c076,a5844ba4bfc8d0cc61d13027c7e63bcc,sao paulo,SP
f681356046d9fde60e70c73a18d65ea2,5f102dd37243f152aec3607970aad100,santo andre,SP
167bd30a409e3e4127df5a9408ebd394,9c0096673baf55453a50073f12d1a37f,goiania,GO
6e359a57a91f84095cc64e1b351aef8c,2e6a42a9b5cbb0da62988694f18ee295,sao paulo,SP
e0eea8f69a457b3f1fa246e44c9ebefd,4d221875624017bc47b4d1ce7314a5b7,cachoeiro de itapemirim,ES
e3109970a3fe8021d5ff82c577ce5606,a8654e2af5da6bb72f52c22b164855e1,sao paulo,SP
261cb4f92498ca05d5bd1a327a261d9c,424aca6872c5bab80780a8dec03b7516,sao jose dos campos,SP
6f92779347724b67e44e3224f3b4cffd,bf4862777db128507e9efcc789215e9b,sao roque,SP
2d5831cb2dff7cdefba62e950ae3dc7b,e9dd12dca17352644a959d9dea133935,camacari,BA
b2bed119388167a954382cca36c4777f,e079b18794454de9d2be5c12b4392294,resende,RJ
469634941c27cd844170935a3cf60b95,ef07ba9aa5226f77264ffa5762b2280b,curitiba,PR
df0aa5b8586495e0ddf6b601122e43a1,85d234692f7bee8d6fea586e237334b6,sumare,SP
41c8f4b570869791379a925899a6af8a,fe3634ccefbcdb0537b45fd589e32e8e,guarulhos,SP
54f755c3fd2709231f9964a1430c5218,40febde16f4718a5def537786473b0be,novo hamburgo,RS
4c06b42fbf7b97ab10779cda5549cd1c,07d190f123147d9e89d4b922543d7948,sao luis,MA
b6368ca0f56d4632f44d58ca431487b2,dd992305cba295d997f263dbdf4e8c2e,sao jose,SC
4a0e66fd30684aa1409cd1b66fec77cc,86085586aaa8c5f47ed0b400da64c59d,guarulhos,SP
c168abb9077b7821adae01dc1f0886c5,5ad58a4e6a1a656b6bed070cadbaa003,santa barbara,MG
a3b0fda37bae14cf754877bed475e80c,c9158d089637ab443c78984d20da7fc0,sao paulo,SP
0ccd415657ae8a6cd1c71b00155a019e,66cc90195ca44cc7ac6a1cd0e1e1e7b2,guarulhos,SP
c532a74a3ebf1bacce2e2bcce3783317,91ec50a00ae74d0a229d2efdf4344e1e,ribeirao preto,SP
19cecb194f54e614b70d971306a9931b,d251c190ca75786e9ab937982d60d1d4,belo horizonte,MG
f34a6e874087ec1f0e3dab9fdf659c5d,233896de79986082f1f479f1f85281cb,ituiutaba,MG
c132855c926907970dcf6f2bf0b33a24,a8ae36a2bb6c2bbc3b5d62ede131c9ef,taquarituba,SP
df85b96ba2ce3e49bde101b1614f52ac,8d46223c91cbeb93e0930ca8bd8ffca2,sao jose dos pinhais,PR
4d27341acd30a36bca39008ee9bb9050,e021e698833bdeb89dfef3acb2e91f37,jaragua do sul,SC
d3b6830d18c7de943d1e707d1f061d40,27cf4b153010911a0957150255a6c6db,sao paulo,SP
79de53946db384e2d7a9bd131792ad17,7ce5b57a120a2da6a804afa58ffcbfb5,montes claros,MG
a562ab1e728449e3461829dfe2e36f73,d33eeadf54cb883e79be640f38c32cdc,barrinha,SP
b64ed91eab98972150bdaf77ca921934,3da7750bf3c1dbd724624a60a9f5942b,rio de janeiro,RJ
8247b5583327ab8be19f96e1fb82f77b,d85547cd859833520b311b4458a14c1c,parati,RJ
8fcaa9368903f3a9a28aeaff28c14638,3af0b2f7654f613ff1527b997a2ac57e,dourados,MS
a9b0d1c26105279e1b8edc63d06bd668,3d49f4455a3947c8dd7e972b3ad8cb76,sao paulo,SP
aa9f03ecd3728c9bd12e6d962c66c7cb,b03e9d9818ee170e9d6b983803c7d406,trindade,GO
230c0d740401730c7197d16376893525,a302a693d5722d95984e6472150b9391,cascavel,PR
a905baa530258422594f1b05615bd225,c80da60feddb7cf8325bd104032e314a,fortaleza,CE
4fa19f7da692e6bf9602aaad3c372eda,a2b8841410cf77619574d311cd06fd5e,brasilia,DF
03f846ad034

2025-01-21 14:40:54 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:40:54 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:40:54 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:40:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:40:55 - snowflake.connector.connection - INFO - closed
2025-01-21 14:40:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:40:55 - root - INFO - SQL:
-- 2. List the first 100 orders
SELECT "order_id", "customer_id", "order_purchase_timestamp", "order_status"
FROM E_COMMERCE.E_COMMERCE.ORDERS
LIMIT 100
Results:
Too long, hard cut:
order_id,customer_id,order_purchase_timestamp,order_status
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,2017-10-02 10:56:33,delivered
53cdb2fc8bc7dce0b6741e2150273451,b0830fb4747a6c6d20dea0b8c802d7ef,2018-07-24 20:41:37,delivered
47770eb9100c2d0c44946d9cf07ec65d,41ce2a54c0b03bf3443c3d931a367089,2018-08-08 08:38:49,delivered
949d5b44dbf5de918fe9c16f97b45f8a,f88197465ea7920adcdbec7375364d82,2017-11-18 19:28:06,delivered
ad21c59c0840e6cb83a9ceb5573f8159,8ab97904e6daea8866dbdbc4fb7aad2c,2018-02-13 21:18:39,delivered
a4591c265e18cb1dcee52889e2d8acc3,503740e9ca751ccdda7ba28e9ab8f608,2017-07-09 21:57:05,delivered
136cce7faa42fdb2cefd53fdc79a6098,ed0271e0b7da060a393796590e7b737a,2017-04-11 12:22:08,invoiced
6514b8ad8028c9f2cc2374ded245783f,9bdf08b4b3b52b5526ff42d37d47f222,2017-05-16 13:10:30,delivered
76c6e866289321a7c93b82b54852dc33,f54a9f0e6b351c431402b8461ea51999,2017-01-23 18:29:09,delivered
e69bfb5eb88e0ed6a785585b27e16dbf,31ad1d1b63eb9962463f764d4e6e0c9d,2017-07-29 11:55:02,delivered
e6ce16cb79ec1d90b1da9085a6118aeb,494dded5b201313c64ed7f100595b95c,2017-05-16 19:41:10,delivered
34513ce0c4fab462a55830c0989c7edb,7711cf624183d843aafe81855097bc37,2017-07-13 19:58:11,delivered
82566a660a982b15fb86e904c8d32918,d3e3b74c766bc6214e0c830b17ee2341,2018-06-07 10:06:19,delivered
5ff96c15d0b717ac6ad1f3d77225a350,19402a48fe860416adf93348aba37740,2018-07-25 17:44:10,delivered
432aaf21d85167c2c86ec9448c4e42cc,3df704f53d3f1d4818840b34ec672a9f,2018-03-01 14:14:28,delivered
dcb36b511fcac050b97cd5c05de84dc3,3b6828a50ffe546942b7a473d70ac0fc,2018-06-07 19:03:12,delivered
403b97836b0c04a622354cf531062e5f,738b086814c6fcc74b8cc583f8516ee3,2018-01-02 19:00:43,delivered
116f0b09343b49556bbad5f35bee0cdf,3187789bec990987628d7a9beb4dd6ac,2017-12-26 23:41:31,delivered
85ce859fd6dc634de8d2f1e290444043,059f7fc5719c7da6cbafe370971a8d70,2017-11-21 00:03:41,delivered
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,2017-10-26 15:54:26,delivered
203096f03d82e0dffbc41ebc2e2bcfb7,d2b091571da224a1b36412c18bc3bbfe,2017-09-18 14:31:30,delivered
f848643eec1d69395095eb3840d2051e,4fa1cd166fa598be6de80fa84eaade43,2018-03-15 08:52:40,delivered
2807d0e504d6d4894d41672727bc139f,72ae281627a6102d9b3718528b420f8a,2018-02-03 20:37:35,delivered
95266dbfb7e20354baba07964dac78d5,a166da34890074091a942054b36e4265,2018-01-08 07:55:29,delivered
f3e7c359154d965827355f39d6b1fdac,62b423aab58096ca514ba6aa06be2f98,2018-08-09 11:44:40,delivered
fbf9ac61453ac646ce8ad9783d7d0af6,3a874b4d4c4b6543206ff5d89287f0c3,2018-02-20 23:46:53,delivered
acce194856392f074dbf9dada14d8d82,7e20bf5ca92da68200643bda76c504c6,2018-06-04 00:00:13,delivered
dd78f560c270f1909639c11b925620ea,8b212b9525f9e74e85e37ed6df37693e,2018-03-12 01:50:26,delivered
91b2a010e1e45e6ba3d133fa997597be,cce89a605105b148387c52e286ac8335,2018-05-02 11:45:38,delivered
ecab90c9933c58908d3d6add7c6f5ae3,761df82feda9778854c6dafdaeb567e4,2018-02-25 13:50:30,delivered
f70a0aff17df5a6cdd9a7196128bd354,456dc10730fbdba34615447ea195d643,2017-08-10 11:58:33,delivered
1790eea0b567cf50911c057cf20f90f9,52142aa69d8d0e1247ab0cada0f76023,2018-04-16 21:15:39,delivered
989225ba6d0ebd5873335f7e01de2ae7,816f8653d5361cbf94e58c33f2502a5c,2017-12-12 13:56:04,delivered
d887b52c6516beb39e8cd44a5f8b60f7,d9ef95f98d8da3b492bb8c0447910498,2018-02-03 12:38:58,delivered
b276e4f8c0fb86bd82fce576f21713e0,cf8ffeddf027932e51e4eae73b384059,2018-07-29 23:34:51,delivered
8563039e855156e48fccee4d611a3196,5f16605299d698660e0606f7eae2d2f9,2018-02-17 15:59:46,delivered
60550084e6b4c0cb89a87df1f3e5ebd9,f5458ddc3545711efa883dd7ae7c4497,2018-02-21 18:15:12,delivered
5acce57f8d9dfd55fa48e212a641a69d,295ae9b35379e077273387ff64354b6f,2017-07-31 21:37:10,delivered
434d158e96bdd6972ad6e6d73ddcfd22,2a1dfb647f32f4390e7b857c67458536,2018-06-01 12:23:13,delivered
7206b86ea789983f7a273ea7fa0bc2a8,3391c4bc11a817e7973e498b0b023158,2018-03-26 17:12:18,delivered
1e7aff52cdbb2451ace09d0f848c3699,ddaff536587109b89777e0353215e150,2017-05-19 18:53:40,delivered
6ea2f835b4556291ffdc53fa0b3b95e8,c7340080e394356141681bd4c9b8fe31,2017-11-24 21:27:48,delivered
948097deef559c742e7ce321e5e58919,8644be24d48806bc3a88fd59fb47ceb1,2017-08-04 17:10:39,delivered
d22e9fa5731b9e30e8b27afcdc2f8563,756fb9391752dad934e0fe3733378e57,2018-08-04 23:25:30,delivered
ee64d42b8cf066f35eac1cf57de1aa85,caded193e8e47b8362864762a83db3c5,2018-06-04 16:44:48,shipped
6ebaec694d7025e2ad4a05dba887c032,4f28355e5c17a4a42d3ce2439a1d4501,2017-05-18 13:55:47,delivered
d17dc4a904426827ca80f2ccb3a6be56,569cf68214806a39acc0f39344aea67f,2017-05-14 20:28:25,delivered
25f4376934e13d3508486352e11a5db0,12fd2740039676063a874b9567dfa651,2018-05-17 16:59:11,delivered
5820a1100976432c7968a52da59e9364,2b56e94c2f66f2d97cfa63356f69cee8,2018-07-29 11:24:17,delivered
2ce1ad82022c1ba30c2079502ac725aa,7f2178c5d771e17f507d3c1637339298,2017-08-09 20:19:05,delivered
138849fd84dff2fb4ca70a0a34c4aa1c,9b18f3fc296990b97854e351334a32f6,2018-02-01 14:02:19,delivered
47aa4816b27ba60ec948cd019cc1afc1,148348ff65384b4

2025-01-21 14:40:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:40:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:40:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:40:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:40:56 - snowflake.connector.connection - INFO - closed
2025-01-21 14:40:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:40:57 - root - INFO - SQL:
-- 3. List the first 100 order payments
SELECT "order_id", "payment_type", "payment_installments", "payment_value"
FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS
LIMIT 100
Results:
Too long, hard cut:
order_id,payment_type,payment_installments,payment_value
b81ef226f3fe1789b1e8b2acac839d17,credit_card,8,99.33
a9810da82917af2d9aefd1278f1dcfa0,credit_card,1,24.39
25e8ea4e93396b6fa0d3dd708e76c1bd,credit_card,1,65.71
ba78997921bbcdc1373bb41e913ab953,credit_card,8,107.78
42fdf880ba16b47b59251dd489d4441a,credit_card,2,128.45
298fcdf1f73eb413e4d26d01b25bc1cd,credit_card,2,96.12
771ee386b001f06208a7419e4fc1bbd7,credit_card,1,81.16
3d7239c394a212faae122962df514ac7,credit_card,3,51.84
1f78449c87a54faf9e96e88ba1491fa9,credit_card,6,341.09
0573b5e23cbd798006520e1d5b4c6714,boleto,1,51.95
d88e0d5fa41661ce03cf6cf336527646,credit_card,8,188.73
2480f727e869fdeb397244a21b721b67,credit_card,1,141.9
616105c9352a9668c38303ad44e056cd,credit_card,1,75.78
cf95215a722f3ebf29e6bbab87a29e61,credit_card,5,102.66
769214176682788a92801d8907fa1b40,credit_card,4,105.28
12e5cfe0e4716b59afb0e0f4a3bd6570,credit_card,10,157.45
61059985a6fc0ad64e95d9944caacdad,credit_card,1,132.04
79da3f5fe31ad1e454f06f95dc032ad5,credit_card,1,98.94
8ac09207f415d55acff302df7d6a895c,credit_card,4,244.15
b2349a3f20dfbeef62e7b31baa22f84b,credit_card,3,136.71
5a1f6d22f7dfb061ef29216b9af687a1,credit_card,4,47.69
4214cda550ece8ee66441f459dc33a8c,credit_card,2,170.57
adfbf6c2a620196f9a3ec747491c72b7,credit_card,4,67.5
4d680edbaa7d3d9bed69532957368a03,credit_card,10,353.09
8cd68144cdb62dc0d60848cf8616d2a4,boleto,1,330.66
5cfd514482e22bc992e7693f0e3e8df7,voucher,1,45.17
d0a945f85ba1074b60aac97ade7e240e,credit_card,2,541.0
c39414c195d0f94c9d9c35e7c6ed4f1a,credit_card,2,139.22
5d9c5817e278892b7498d90bfa28ade8,credit_card,2,290.16
b69b9260e79a0da00e15f48de1bd2524,boleto,1,283.34
f45074ae38f2e01d9b854ec8d40362ff,credit_card,1,13.78
81cedc4d2132eb6f512354166e51b187,credit_card,1,30.28
595f598849d89203c28d05d0fbf3f92e,credit_card,1,26.58
f9d0ec2fa088ac583e1ccd15b6686073,credit_card,1,89.68
e647bf617de735448a4ba54f8910393c,credit_card,1,65.09
b2bb080b6bc860118a246fd9b6fad6da,credit_card,1,173.84
23f10f509600c30cf2852f9dbdf28fc3,credit_card,1,103.49
f86f6472fa9f395d8d9a6751ca118afb,credit_card,1,64.03
1dcf0c8cd36ffaf57784fbdc90079310,credit_card,3,157.15
00d8d65b666158b633f96054d31af43b,boleto,1,130.88
cf30fe76d1505192acee1c6dccb15545,credit_card,2,47.72
d3e774a185c0b1b2286ffd6c70abe2e6,credit_card,8,117.74
32b1d8f3789a57f1f752e20ac7404b4c,boleto,1,56.6
c10d412026c4077b8e83acf0fea04eee,credit_card,1,266.16
56c3277583e16009c925fdf116df420f,boleto,1,31.38
0e0441786430b7cfcd0d91f822ea4c99,credit_card,1,121.49
6ffb3f1686bceae3466facf7e02ce3fb,credit_card,1,32.0
afef48d3c8a0b1b7c9b7f8f922fb5674,credit_card,5,153.41
c0db7d31ace61fc360a3eaa34dd3457c,credit_card,5,65.71
d574338f566ca28dd67820f48ec1f1d8,credit_card,4,278.22
1807cc736321f14baa58ef39cf6e5989,credit_card,4,91.66
e8977f709bbb0367f51b589e6325f991,credit_card,1,132.51
2e2c60b99754ae1e4d8b18846cfec9f2,credit_card,4,542.66
1ffb3c1929b16d9c1aec1958e11b3e9b,boleto,1,166.04
95442deb81a5d91c97c0df96b431634a,boleto,1,368.98
10af96a0689260134307879127ac1952,credit_card,2,113.2
85eef2d342b0de363c45c1bc324729c5,credit_card,3,99.43
aa964845f1de8125410aea8b73e9e1ec,credit_card,2,27.35
343348b1e29e9fa9e7b6ab1027f9177d,credit_card,4,43.77
ad4098a257676ea4d394fb3bbbf36ca3,credit_card,2,68.49
3e0c3cab458e8b3cc8d1d38ecb7e7775,credit_card,2,105.53
3ab4eea6776259ae8dfbabaeffece352,credit_card,8,387.8
10d9871bed9fb8d0887d3b9022edd1ff,boleto,1,84.14
c108072ab31ec90a754129c171577f5f,credit_card,4,210.82
fc662bafa52d2ef16078f6f6141009d6,boleto,1,90.05
4217849b1ff18a9270fe048eabc4dc45,credit_card,1,67.88
795c16acb4e3c30dfa5b6827727ef488,credit_card,2,37.58
55e2d723733c45033e71cb4d44690234,boleto,1,89.63
947e9c6bfd83a06953c420ef92d3da6e,voucher,1,69.46
60e43c5f5ba559d9dd19357ed72cb2f2,credit_card,2,78.3
e3e9e3295f4e1512167c232a0aaae8a5,voucher,1,50.8
460d57443ffdcaeba240360239747cf7,credit_card,1,34.0
4cb51127f19f7254b320efe1718477dd,boleto,1,77.1
110d9355d6338eab0a65a0cacdde5434,credit_card,5,566.4
42f5954cda381bd032934ee38c453711,credit_card,8,402.42
3689194c14ad4e2e7361ebd1df0e77b0,voucher,1,57.53
97c111c4f22dfa1089a9c0b5338dcc79,credit_card,3,44.01
4b2d035932915aa9c2a0d4d84cd6d3b0,credit_card,3,187.51
e1b4ee0e390fbac1dec439d72b45a115,credit_card,3,77.7
fee72a68ce935ebf2939fe72f27d3d9b,credit_card,1,48.68
4d3bfdf4c7d6578ea445d588371ae10e,credit_card,1,77.29
4c2e1a95586c815795a324d1599e7b5a,credit_card,8,117.71
c9f23db8a1cb725df9bdb3383bd72b38,credit_card,3,169.34
8e47a04b25d7a7075064e8e0bd2e0318,credit_card,1,37.61
723e462ce1ee50e024887c0b403130f3,credit_card,1,13.8
fa2ea4b6e84c1c0fc4f3a6d468c55183,debit_card,1,227.12
fb1a2a1296f822405a946cbdfc0d3ed6,credit_card,3,34.78
198298d54f269d8c5fe89e85a859af61,credit_card,10,342.56
b19ca559688b49e8cf7f88c1aa3f0009,credit_card,7,73.34
5be8d4719fe2e3669e2d07dddf3b6b0c,credit_card,4,117.85
4a02e985c7239d866a632f07ed20d9c0,credit_card,1,48.62
3e17eef8a8bd0131c7aed90d7508799e,credit_card,1,53.99
f8d323a2702fed37f0229965f7e9f8b3,credit_card,1,51.14
de4090fd9b7900d46323b0c7c36b7128,credit_card,2,121.45
17e51

2025-01-21 14:40:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:40:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:40:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:40:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-21 14:40:58 - snowflake.connector.connection - INFO - closed
2025-01-21 14:40:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:40:59 - root - INFO - SQL:
-- 4. View distinct payment types
SELECT DISTINCT "payment_type"
FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS
LIMIT 100
Results:
payment_type
credit_card
boleto
voucher
debit_card
not_defined

2025-01-21 14:40:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:40:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:40:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:41:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:41:00 - snowflake.connector.connection - INFO - closed
2025-01-21 14:41:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:41:00 - root - INFO - SQL:
-- 5. Count the number of orders per customer (first 100 customers)
SELECT "customer_id", COUNT("order_id") AS "number_of_orders"
FROM E_COMMERCE.E_COMMERCE.ORDERS
GROUP BY "customer_id"
LIMIT 100
Results:
customer_id,number_of_orders
9ef432eb6251297304e76186b10a928d,1
b0830fb4747a6c6d20dea0b8c802d7ef,1
41ce2a54c0b03bf3443c3d931a367089,1
f88197465ea7920adcdbec7375364d82,1
8ab97904e6daea8866dbdbc4fb7aad2c,1
503740e9ca751ccdda7ba28e9ab8f608,1
ed0271e0b7da060a393796590e7b737a,1
9bdf08b4b3b52b5526ff42d37d47f222,1
f54a9f0e6b351c431402b8461ea51999,1
31ad1d1b63eb9962463f764d4e6e0c9d,1
494dded5b201313c64ed7f100595b95c,1
7711cf624183d843aafe81855097bc37,1
d3e3b74c766bc6214e0c830b17ee2341,1
19402a48fe860416adf93348aba37740,1
3b6828a50ffe546942b7a473d70ac0fc,1
3187789bec990987628d7a9beb4dd6ac,1
059f7fc5719c7da6cbafe370971a8d70,1
d2b091571da224a1b36412c18bc3bbfe,1
4fa1cd166fa598be6de80fa84eaade43,1
72ae281627a6102d9b3718528b420f8a,1
a166da34890074091a942054b36e4265,1
8b212b9525f9e74e85e37ed6df37693e,1
52142aa69d8d0e1247ab0cada0f76023,1
816f8653d5361cbf94e58c33f2502a5c,1
cf8ffeddf027932e51e4eae73b384059,1
f5458ddc3545711efa883dd7ae7c4497,1
295ae9b35379e077273387ff64354b6f,1
2a1dfb647f32f4390e7b857c67458536,1
3391c4bc11a817e7973e498b0b023158,1
8644be24d48806bc3a88fd59fb47ceb1,1
caded193e8e47b8362864762a83db3c5,1
12fd2740039676063a874b9567dfa651,1
9b18f3fc296990b97854e351334a32f6,1
67407057a7d5ee17d1cd09523f484d13,1
81e08b08e5ed4472008030d70327c71f,1
be8c14c16a4d47194ccdfe10f1fc5b1a,1
55e6b290205c84ddd23ddf5eb134efd4,1
636e15840ab051faa13d3f781b6e4233,1
9f6618c17568ac301465fe7ad056c674,1
df9b032b2ad0fd6bf37dfb48e5f83845,1
48558a50a7ba1aab61891936d2ca7681,1
2e068340b3037f667ce3224bd59260af,1
6feea03756fd7ef4fb37d8f7e44aaeb9,1
e42998ccffc48dc87bf70b37e2d61f33,1
3a017955f82b5bf61bb51aec865a01ca,1
64d181ef52b1829800c598942459061b,1
738b086814c6fcc74b8cc583f8516ee3,1
3a874b4d4c4b6543206ff5d89287f0c3,1
7e20bf5ca92da68200643bda76c504c6,1
79183cd650e2bb0d475b0067d45946ac,1
684fa6da5134b9e4dab731e00011712d,1
b673f0597cb0c4d12778f731045f361a,1
82f0b75bb50fcb30711e5277e36b3983,1
167b9485947ed0a354a3f8dad04eb199,1
5883f965ac70043c2e908c3657c5d548,1
4dafe3c841d2d6cc8a8b6d25b35704b9,1
c1ddb7521d14db9071dccad0a94305c2,1
0dd5a932b1e29daa12845dbf696cbb54,1
8458f7ae02bda5950ce48c01a720559a,1
c178d6d544925594fafab0ba493cd645,1
9a80c8377644236e27f59e83862f1ae2,1
15bea20cd005ed59d34db54c6b32ec98,1
d0e6cb83a3fc27f56be011b2941f54c6,1
c40c7807639289e3f1308ac6e5bc104f,1
3df704f53d3f1d4818840b34ec672a9f,1
cce89a605105b148387c52e286ac8335,1
148348ff65384b4249b762579532e248,1
f5afca14dfa9dc64251cf2b45c54c363,1
241e78de29b3090cfa1b5d73a8130c72,1
4632eb5a8f175f6fe020520ae0c678f3,1
c77ee2d8ba1614a4d489a44166894938,1
a9d37ddc8ba4d9f6dbac7d8ec378cc95,1
a90391a47de936d56c66a5366cba1462,1
05e996469a2bf9559c7122b87e156724,1
f26a435864aebedff7f7c84f82ee229f,1
bf141bf67fbe428d558bcf0e018eab60,1
3a897024068ed42a183de61d5727d866,1
332df68ccac2f2f7d9e11299188f8bce,1
d4faa220408c20e53595d2950f361f3b,1
65ee4aa816cda8ad41e05c75e1cb691e,1
7f8c8b9c2ae27bf3300f670c3d478be8,1
62b423aab58096ca514ba6aa06be2f98,1
456dc10730fbdba34615447ea195d643,1
d9ef95f98d8da3b492bb8c0447910498,1
5f16605299d698660e0606f7eae2d2f9,1
ddaff536587109b89777e0353215e150,1
c7340080e394356141681bd4c9b8fe31,1
756fb9391752dad934e0fe3733378e57,1
4f28355e5c17a4a42d3ce2439a1d4501,1
7f2178c5d771e17f507d3c1637339298,1
f178c1827f67a8467b0385b7378d951a,1
2932d241d1f31e6df6c701d52370ae02,1
911e4c37f5cafe1604fe6767034bf1ae,1
9916715c2ab6ee1710c9c32f0a534ad2,1
afb19a4b667cb708caab312757ec3d3f,1
fee181bf648906d1c57f84f216976286,1
93ada7a24817edda9f4ab998fa823d16,1
64fb950e760ec8b0db79154a1fa9c1bf,1
8628fac2267e8c8804525da99c10ed0e,1
3135962ee745ef39b85576df7ddbaa99,1

2025-01-21 14:41:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:41:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:41:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:41:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:41:01 - snowflake.connector.connection - INFO - closed
2025-01-21 14:41:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:41:02 - root - INFO - SQL:
-- 6. Calculate the total payment per order (first 100 orders)
SELECT "order_id", SUM("payment_value") AS "total_payment"
FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS
GROUP BY "order_id"
LIMIT 100
Results:
order_id,total_payment
b81ef226f3fe1789b1e8b2acac839d17,99.33
a9810da82917af2d9aefd1278f1dcfa0,24.39
25e8ea4e93396b6fa0d3dd708e76c1bd,65.71
ba78997921bbcdc1373bb41e913ab953,107.78
298fcdf1f73eb413e4d26d01b25bc1cd,96.12
771ee386b001f06208a7419e4fc1bbd7,81.16
1f78449c87a54faf9e96e88ba1491fa9,341.09
0573b5e23cbd798006520e1d5b4c6714,51.95
d88e0d5fa41661ce03cf6cf336527646,188.73
2480f727e869fdeb397244a21b721b67,141.9
616105c9352a9668c38303ad44e056cd,75.78
769214176682788a92801d8907fa1b40,105.28
79da3f5fe31ad1e454f06f95dc032ad5,98.94
8ac09207f415d55acff302df7d6a895c,244.15
5a1f6d22f7dfb061ef29216b9af687a1,47.69
4214cda550ece8ee66441f459dc33a8c,170.57
4d680edbaa7d3d9bed69532957368a03,353.09
5d9c5817e278892b7498d90bfa28ade8,290.16
f45074ae38f2e01d9b854ec8d40362ff,13.78
81cedc4d2132eb6f512354166e51b187,30.28
f9d0ec2fa088ac583e1ccd15b6686073,89.68
23f10f509600c30cf2852f9dbdf28fc3,103.49
cf30fe76d1505192acee1c6dccb15545,47.72
0e0441786430b7cfcd0d91f822ea4c99,121.49
6ffb3f1686bceae3466facf7e02ce3fb,32.0
1807cc736321f14baa58ef39cf6e5989,91.66
10af96a0689260134307879127ac1952,113.2
85eef2d342b0de363c45c1bc324729c5,99.43
3e0c3cab458e8b3cc8d1d38ecb7e7775,105.53
795c16acb4e3c30dfa5b6827727ef488,37.58
e3e9e3295f4e1512167c232a0aaae8a5,50.8
42f5954cda381bd032934ee38c453711,402.42
c9f23db8a1cb725df9bdb3383bd72b38,169.34
fb1a2a1296f822405a946cbdfc0d3ed6,34.78
b19ca559688b49e8cf7f88c1aa3f0009,73.34
4a02e985c7239d866a632f07ed20d9c0,48.62
46ee6eaca194413758f200a6974b7e4d,71.99
a490a5d59a9bf4ef3334bfd7cf1dbdfc,17.78
c1b770015e27aaf2b475026989d04fe0,137.73
d087b8e096ca051f548e29b324272834,72.05
5cfd514482e22bc992e7693f0e3e8df7,710.5799999999999
f86f6472fa9f395d8d9a6751ca118afb,64.03
d3e774a185c0b1b2286ffd6c70abe2e6,117.74
56c3277583e16009c925fdf116df420f,31.38
afef48d3c8a0b1b7c9b7f8f922fb5674,153.41
2e2c60b99754ae1e4d8b18846cfec9f2,542.66
343348b1e29e9fa9e7b6ab1027f9177d,43.77
97c111c4f22dfa1089a9c0b5338dcc79,44.01
4b2d035932915aa9c2a0d4d84cd6d3b0,187.51
e1b4ee0e390fbac1dec439d72b45a115,77.7
f8d323a2702fed37f0229965f7e9f8b3,51.14
3ba2d0012b1f34bc6ccbc31c4ba69f93,60.07
96de2b7f7f3c401fbee3eef068376da6,32.15
f090de1b2ed9f4e251662cb31e3c7127,27.63
2ccde1e4676c20b9444e2bcbed36334c,134.56
68d7420c86be23f313c81a554320f986,121.88
a5f860aaf6a3c35399495aefe92d363f,75.75
55779fa8fe072d9f8c92d672154558f2,233.66
845af9472cc76e66fbf445931b511755,123.41
67c8c2016ddabf0059783eb44e921f99,68.54
332c6742772f2df936696b6512b10edb,143.25
27a7ac440630f9de788e4d66e72c6424,186.39
e6670c9089973cc68e5b90b7d1f4fec4,88.49
aa7c35fd606f4275e267e859c6a84d0f,26.68
3d7239c394a212faae122962df514ac7,51.84
cf95215a722f3ebf29e6bbab87a29e61,102.66
12e5cfe0e4716b59afb0e0f4a3bd6570,157.45
61059985a6fc0ad64e95d9944caacdad,132.04
8cd68144cdb62dc0d60848cf8616d2a4,330.66
c39414c195d0f94c9d9c35e7c6ed4f1a,139.22
e647bf617de735448a4ba54f8910393c,65.09
aa964845f1de8125410aea8b73e9e1ec,27.35
ad4098a257676ea4d394fb3bbbf36ca3,68.49
4217849b1ff18a9270fe048eabc4dc45,67.88
55e2d723733c45033e71cb4d44690234,89.63
4c2e1a95586c815795a324d1599e7b5a,117.71
723e462ce1ee50e024887c0b403130f3,113.8
198298d54f269d8c5fe89e85a859af61,342.56
20f136d890c31a62486c809f91a5b098,117.68
cf61ad2218e5c14397e7c0ba7a6a50f9,35.14
99bc267f49d76932cd195bfb2a94dd03,163.08
aa600269bffea363cca75ad2d1908903,93.26
57e4fc8f20507381b3f7abbe4e2ccda3,215.56
ae1126b6891f58552443772c80b1f562,133.81
42fdf880ba16b47b59251dd489d4441a,128.45
adfbf6c2a620196f9a3ec747491c72b7,67.5
d0a945f85ba1074b60aac97ade7e240e,541.0
595f598849d89203c28d05d0fbf3f92e,26.58
b2bb080b6bc860118a246fd9b6fad6da,197.92000000000002
32b1d8f3789a57f1f752e20ac7404b4c,56.6
c0db7d31ace61fc360a3eaa34dd3457c,65.71
d574338f566ca28dd67820f48ec1f1d8,278.22
e8977f709bbb0367f51b589e6325f991,132.51
95442deb81a5d91c97c0df96b431634a,368.98
fc662bafa52d2ef16078f6f6141009d6,90.05
947e9c6bfd83a06953c420ef92d3da6e,69.46
60e43c5f5ba559d9dd19357ed72cb2f2,78.3
460d57443ffdcaeba240360239747cf7,34.0
4d3bfdf4c7d6578ea445d588371ae10e,77.29
8e47a04b25d7a7075064e8e0bd2e0318,37.61

2025-01-21 14:41:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:41:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:41:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:41:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:41:03 - snowflake.connector.connection - INFO - closed
2025-01-21 14:41:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:41:04 - root - INFO - SQL:
-- 7. Calculate the total payment per customer (first 100 customers)
SELECT o."customer_id", SUM(p."payment_value") AS "total_payment"
FROM E_COMMERCE.E_COMMERCE.ORDERS o
JOIN E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p ON o."order_id" = p."order_id"
GROUP BY o."customer_id"
LIMIT 100
Results:
customer_id,total_payment
0a8556ac6be836b46b3e89920d59291c,99.33
f2c7fc58a9de810828715166c672f10a,24.39
a24e6f72471e9dbafcb292bc318f4859,96.12
c4e17eff78176dfe3401f03db0346f85,51.95
94967f1e8a9ea8ec6c7129f098f32155,141.9
8c0b2ef9efb43af92d5c0afff70d33d9,75.78
2b01b5fb8141bbb9fcdc853a0e26da83,105.28
4c7ef01bf8ed05e43a5e9e44bb08358e,47.69
be4ecdb7c9401fd98ed01456634cfcb2,170.57
5b670130533827957619dfe306899fdd,67.5
1444f701e835b7d189637c10f5287e76,353.09
c03b40c7971bc52b3d018247891270c5,330.66
d036487ffd91aa5b2f21e17f2bb83543,13.78
a8f6bb35d78515a1762eb626d52b6352,30.28
ce6d32fa00bbae809e07c14126e5fa6e,64.03
c3d06eb8905fc0c39966b0a57ee7244c,31.38
f1220b145cc86460b4276b9b3e23e57d,121.49
d990663a73af8129834fca277b4743ca,27.35
73e4f0d08b9eaf4009d3218057343b5a,78.3
31f9366e8fbe2412ddbae2d9c49d8adf,77.7
7badbcce7da90b7920997ddbac3187b5,77.29
b5d838521379fbc2a2e8c3f360f57e01,227.12
ff93b4413884cd9b2d851e9133d8c1ab,34.09
6de980369453bc98c75da669412a0e85,348.02
fe0c5425832ac53c3be5cb4aea25b60f,188.73
0ff24a24edd69d8774270ac863c8e230,136.71
b583a7efe4522c8ce8942bd47f33d487,290.16
11440840f5653ebba13e919285c71389,65.09
34955e04695a861e22cfc5600244118d,157.15
4e2311c6a3b9c353851097a679ede20a,266.16
15e65458c1de2332a93656f2272c808e,166.04
daddb546b42f656e57ba8a3cf71a309f,368.98
2737211835d5ea370af15ee145f7840c,69.46
2514a33b1704c36bdfbe51840e105cde,34.0
2d1276417ffab1c174139789098cecc3,77.1
2346308634084083a80df78332c411dc,48.68
8d4fd10d20cdc0fa3589cfdee2b1cb07,342.56
a97f15194f6fc81433e550a34dec906a,53.99
b78f37cd0654fbbf35c5277b24936535,56.77
eec30b788184a6d93954fd5e82c48add,32.15
e2bea5774e2c8aa227075fc4d2c3ba39,40.99
27a2735706788ec6d39d0de52ce2457b,71.99
0f687ed7edef79545319e147f39a290a,47.0
d49bac4ac7d77b956f2b185ab700fbf1,231.45
84e14521bff8cbb289a87be1961d3d08,144.2
ab2b94cec822788e131f15e0033544cf,27.63
a10c24a3a00d939852f086c7162e564d,134.56
a3343433090af3beb34febb7899bf0ee,96.98
b8fc2edd015cea8b8cd1f308c30541fd,267.05
54efba24ef631ff2c2088f8320499ea5,48.61
55d6fe64c9ff321e925f284f7e0d69d8,125.53
d50a8dc7e28e47e8119560e53b1c7deb,44.35
61260c512475ab1d7519b332199e8c1d,213.9
e957d597f76d275f40a848397fb6c7c3,362.17
ad5eaed951a10f80d09e7f473a8fd08e,103.79
4068269eb194e5957c5b2abce6939ee4,49.7
680e38a70d371582570f41cc47dc2791,285.79
b0c22a057e308ffdd32ce03e1734aa62,404.88
bf0b4acdb6eb69084a7714bf7cc748f0,54.85
3d3e7494fc24a4f50a6bff232428f8fe,44.83
f5025a3893cbcdd251b06c0b3f7451da,52.529999999999994
ae6a20cbef31289987c08cdc617a19ac,256.37
047c4f9e8ca120c41c8d4a61df722ea2,102.26
79bdc6288517cb7f94c86be6c97b7ba7,127.53
381aee1e9f4b0395a780330fab335b03,91.66
017395cf7b4c0be4fa72650f0a8184ed,43.77
1353b6db7e448ecfad1a4cd13b95f832,113.8
92f70647283582ec50ca1bb5794f6c90,107.72
58d45cf285d3d5bdd45609c696e00b9e,46.63
90cf9029b6b6b9469c7f0f9c82a59da3,52.21
519a8af813fe88578029697625439e8b,710.5799999999999
4a44c8f258b8780e1da133c1f1c39854,541.0
f9bdbea246da607ab4641959ba6aa32f,34.78
e46db370a98dec564da620109436f09a,117.68
bdbf22817eb36add4815586f4957adb1,88.49
8e5b95cc9167186235d12c22e7d79015,81.78
1387e2d23533abc24be58c9b3a1f06b9,17.78
c7ada2a2ca6ff94ccc7bbd16af1dec55,61.77
b7d2c0ccf5e66c2d1c496d6a8250eae4,31.0
58b3208913cae35dadfac41929721901,116.05
79e2cae59c2216c721c54ff9c53ad657,85.14
7ac0cc6086ab6987cb2bf47141b2288a,180.55
bf372d35de99f49cb07c1a238d7db256,26.08
12ea47b284521261ac272de65bbb3506,375.74
4ed6dff46316b8f7e80d1972f27ca39f,33.13
b755c5f04fe5e214d68445fb210d512a,142.04000000000002
810923268bc2be268d447dd5c892a5ce,348.77
ffc2f51857cae8a61ec9f9a15c7861c8,77.77
8978d77f12a2fc5b1890c49b39dd288a,26.68
4304f16b63cae276cb72b52baeb978cf,50.09
d4fcd56a6eb869293c5da42565707dd9,89.88
9a6fb2784ae4acd6acca8b15eae329e3,48.22
ee2de94f683ada4fc7ff42ddc0482a08,67.58
bbf02c631b2d633a8532316e697e71b4,69.33
f68313aa890cb1f32ea402439c6f1c4d,106.96
b7f69471fed8a036911323fca290a2c2,132.51
76382f6496effe36685eb200ef95b3ac,50.8
7c6a9e2bdbb00e3007395f1ce3bda802,402.42
ef82ec18f684c8b9f44339a739570043,57.53
a086fa78ca272b05a6404f91bb04928c,186.72

2025-01-21 14:41:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:41:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:41:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:41:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:41:05 - snowflake.connector.connection - INFO - closed
2025-01-21 14:41:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:41:06 - root - INFO - SQL:
-- 8. Calculate the average payment per order for each customer (first 100 customers)
SELECT o."customer_id", AVG(p."payment_value") AS "average_payment_per_order"
FROM E_COMMERCE.E_COMMERCE.ORDERS o
JOIN E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p ON o."order_id" = p."order_id"
GROUP BY o."customer_id"
LIMIT 100
Results:
customer_id,average_payment_per_order
0a8556ac6be836b46b3e89920d59291c,99.33
f2c7fc58a9de810828715166c672f10a,24.39
a24e6f72471e9dbafcb292bc318f4859,96.12
c4e17eff78176dfe3401f03db0346f85,51.95
94967f1e8a9ea8ec6c7129f098f32155,141.9
8c0b2ef9efb43af92d5c0afff70d33d9,75.78
2b01b5fb8141bbb9fcdc853a0e26da83,105.28
4c7ef01bf8ed05e43a5e9e44bb08358e,47.69
be4ecdb7c9401fd98ed01456634cfcb2,170.57
5b670130533827957619dfe306899fdd,67.5
1444f701e835b7d189637c10f5287e76,353.09
c03b40c7971bc52b3d018247891270c5,330.66
d036487ffd91aa5b2f21e17f2bb83543,13.78
a8f6bb35d78515a1762eb626d52b6352,30.28
ce6d32fa00bbae809e07c14126e5fa6e,64.03
c3d06eb8905fc0c39966b0a57ee7244c,31.38
f1220b145cc86460b4276b9b3e23e57d,121.49
d990663a73af8129834fca277b4743ca,27.35
73e4f0d08b9eaf4009d3218057343b5a,78.3
31f9366e8fbe2412ddbae2d9c49d8adf,77.7
7badbcce7da90b7920997ddbac3187b5,77.29
b5d838521379fbc2a2e8c3f360f57e01,227.12
ff93b4413884cd9b2d851e9133d8c1ab,34.09
6de980369453bc98c75da669412a0e85,348.02
fe0c5425832ac53c3be5cb4aea25b60f,188.73
0ff24a24edd69d8774270ac863c8e230,136.71
b583a7efe4522c8ce8942bd47f33d487,290.16
11440840f5653ebba13e919285c71389,65.09
34955e04695a861e22cfc5600244118d,157.15
4e2311c6a3b9c353851097a679ede20a,266.16
15e65458c1de2332a93656f2272c808e,166.04
daddb546b42f656e57ba8a3cf71a309f,368.98
2737211835d5ea370af15ee145f7840c,69.46
2514a33b1704c36bdfbe51840e105cde,34.0
2d1276417ffab1c174139789098cecc3,77.1
2346308634084083a80df78332c411dc,48.68
8d4fd10d20cdc0fa3589cfdee2b1cb07,342.56
a97f15194f6fc81433e550a34dec906a,53.99
b78f37cd0654fbbf35c5277b24936535,56.77
eec30b788184a6d93954fd5e82c48add,32.15
e2bea5774e2c8aa227075fc4d2c3ba39,40.99
27a2735706788ec6d39d0de52ce2457b,71.99
0f687ed7edef79545319e147f39a290a,47.0
d49bac4ac7d77b956f2b185ab700fbf1,231.45
84e14521bff8cbb289a87be1961d3d08,144.2
ab2b94cec822788e131f15e0033544cf,27.63
a10c24a3a00d939852f086c7162e564d,134.56
a3343433090af3beb34febb7899bf0ee,96.98
b8fc2edd015cea8b8cd1f308c30541fd,267.05
54efba24ef631ff2c2088f8320499ea5,48.61
55d6fe64c9ff321e925f284f7e0d69d8,125.53
d50a8dc7e28e47e8119560e53b1c7deb,44.35
61260c512475ab1d7519b332199e8c1d,213.9
e957d597f76d275f40a848397fb6c7c3,362.17
ad5eaed951a10f80d09e7f473a8fd08e,103.79
4068269eb194e5957c5b2abce6939ee4,49.7
680e38a70d371582570f41cc47dc2791,285.79
b0c22a057e308ffdd32ce03e1734aa62,404.88
bf0b4acdb6eb69084a7714bf7cc748f0,54.85
3d3e7494fc24a4f50a6bff232428f8fe,44.83
f5025a3893cbcdd251b06c0b3f7451da,26.264999999999997
ae6a20cbef31289987c08cdc617a19ac,256.37
047c4f9e8ca120c41c8d4a61df722ea2,102.26
79bdc6288517cb7f94c86be6c97b7ba7,127.53
381aee1e9f4b0395a780330fab335b03,91.66
017395cf7b4c0be4fa72650f0a8184ed,43.77
1353b6db7e448ecfad1a4cd13b95f832,56.9
92f70647283582ec50ca1bb5794f6c90,21.544
58d45cf285d3d5bdd45609c696e00b9e,46.63
90cf9029b6b6b9469c7f0f9c82a59da3,52.21
519a8af813fe88578029697625439e8b,355.28999999999996
4a44c8f258b8780e1da133c1f1c39854,541.0
f9bdbea246da607ab4641959ba6aa32f,34.78
e46db370a98dec564da620109436f09a,117.68
bdbf22817eb36add4815586f4957adb1,88.49
8e5b95cc9167186235d12c22e7d79015,81.78
1387e2d23533abc24be58c9b3a1f06b9,17.78
c7ada2a2ca6ff94ccc7bbd16af1dec55,61.77
b7d2c0ccf5e66c2d1c496d6a8250eae4,31.0
58b3208913cae35dadfac41929721901,116.05
79e2cae59c2216c721c54ff9c53ad657,85.14
7ac0cc6086ab6987cb2bf47141b2288a,180.55
bf372d35de99f49cb07c1a238d7db256,26.08
12ea47b284521261ac272de65bbb3506,375.74
4ed6dff46316b8f7e80d1972f27ca39f,33.13
b755c5f04fe5e214d68445fb210d512a,47.34666666666667
810923268bc2be268d447dd5c892a5ce,348.77
ffc2f51857cae8a61ec9f9a15c7861c8,77.77
8978d77f12a2fc5b1890c49b39dd288a,26.68
4304f16b63cae276cb72b52baeb978cf,25.045
d4fcd56a6eb869293c5da42565707dd9,89.88
9a6fb2784ae4acd6acca8b15eae329e3,48.22
ee2de94f683ada4fc7ff42ddc0482a08,67.58
bbf02c631b2d633a8532316e697e71b4,69.33
f68313aa890cb1f32ea402439c6f1c4d,106.96
b7f69471fed8a036911323fca290a2c2,132.51
76382f6496effe36685eb200ef95b3ac,50.8
7c6a9e2bdbb00e3007395f1ce3bda802,402.42
ef82ec18f684c8b9f44339a739570043,57.53
a086fa78ca272b05a6404f91bb04928c,186.72

2025-01-21 14:41:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:41:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:41:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:41:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:41:07 - snowflake.connector.connection - INFO - closed
2025-01-21 14:41:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:41:08 - root - INFO - SQL:
-- 9. Find the earliest and latest order dates for each customer (first 100 customers)
SELECT "customer_id",
       MIN("order_purchase_timestamp") AS "first_order_date",
       MAX("order_purchase_timestamp") AS "last_order_date"
FROM E_COMMERCE.E_COMMERCE.ORDERS
GROUP BY "customer_id"
LIMIT 100
Results:
Too long, hard cut:
customer_id,first_order_date,last_order_date
8ab97904e6daea8866dbdbc4fb7aad2c,2018-02-13 21:18:39,2018-02-13 21:18:39
503740e9ca751ccdda7ba28e9ab8f608,2017-07-09 21:57:05,2017-07-09 21:57:05
a166da34890074091a942054b36e4265,2018-01-08 07:55:29,2018-01-08 07:55:29
caded193e8e47b8362864762a83db3c5,2018-06-04 16:44:48,2018-06-04 16:44:48
9b18f3fc296990b97854e351334a32f6,2018-02-01 14:02:19,2018-02-01 14:02:19
f5afca14dfa9dc64251cf2b45c54c363,2017-12-15 00:06:10,2017-12-15 00:06:10
81e08b08e5ed4472008030d70327c71f,2018-04-22 08:48:13,2018-04-22 08:48:13
be8c14c16a4d47194ccdfe10f1fc5b1a,2018-06-13 13:47:39,2018-06-13 13:47:39
a9d37ddc8ba4d9f6dbac7d8ec378cc95,2018-07-15 08:33:19,2018-07-15 08:33:19
f26a435864aebedff7f7c84f82ee229f,2017-07-30 03:06:35,2017-07-30 03:06:35
7e20bf5ca92da68200643bda76c504c6,2018-06-04 00:00:13,2018-06-04 00:00:13
388025bec8128ff20ec1a316ed4dcf02,2017-04-20 17:15:46,2017-04-20 17:15:46
d0e71d7a6dbca8ac513ac63d08a81fa0,2018-04-25 22:18:10,2018-04-25 22:18:10
5232c22d7ed2b631db6b2cab74b2c5f2,2018-08-01 10:48:19,2018-08-01 10:48:19
5dda11942d4f77bee3a46d71e442aec4,2018-01-07 21:44:54,2018-01-07 21:44:54
e8a332c3433fbd37920ec89fc295d075,2017-09-29 09:32:17,2017-09-29 09:32:17
4c9c7c2b6de6ee2568681b5599bb7495,2018-05-08 22:12:34,2018-05-08 22:12:34
fa5c31ea5a141cb29a683b6420f2693a,2017-09-20 17:12:34,2017-09-20 17:12:34
f7398fc942c8fa80e5419ae52e49f7fb,2018-04-15 19:42:06,2018-04-15 19:42:06
a338f42b6e47cb49d5c5128a348b76ba,2018-05-15 19:55:51,2018-05-15 19:55:51
56dfafb543cfa4c2edcc08b9b2c5f0c6,2017-08-01 18:52:12,2017-08-01 18:52:12
b3519c0352b07bc3017acebea4ce6724,2017-11-16 14:32:06,2017-11-16 14:32:06
7a7893d13f178fdf58daeff7347e2d94,2018-05-08 14:38:14,2018-05-08 14:38:14
ed532487db04478dfba09d112649fc13,2018-02-01 07:47:34,2018-02-01 07:47:34
86acfb656743da0c113d176832c9d535,2018-02-08 18:56:45,2018-02-08 18:56:45
64a254d30eed42cd0e6c36dddb88adf0,2017-11-16 15:09:28,2017-11-16 15:09:28
977275bd3cd425aa9926a3388658f485,2018-03-09 14:58:05,2018-03-09 14:58:05
6ee311afc0adb5663ad53868d46ba39d,2017-11-11 22:16:49,2017-11-11 22:16:49
53379b14e4048e025dc5a2185f461bb7,2018-03-27 22:14:59,2018-03-27 22:14:59
da2fbad9b2235c67c9bc7c7a274ee389,2018-08-03 13:32:54,2018-08-03 13:32:54
b7b15ab12fa50616eee696a22f098e07,2017-01-21 17:08:01,2017-01-21 17:08:01
5d6e19aed6284c2fcb4b1a0eba6820de,2018-08-21 16:45:44,2018-08-21 16:45:44
ffdc2af7160aed3bad21cbc8ec68c0c5,2017-05-20 02:48:00,2017-05-20 02:48:00
5265029daa29cc08d86b9f96cd99d03f,2018-04-18 15:40:36,2018-04-18 15:40:36
bd13582471af02ce718568d9cf8bbd93,2018-03-29 22:46:19,2018-03-29 22:46:19
364fbe9334877bc7ca3da92913b2cdbf,2017-06-02 14:00:19,2017-06-02 14:00:19
610a4163b8ab832daf93b4fbb48e9119,2017-11-19 16:12:34,2017-11-19 16:12:34
2f9902d85fcd930227f711cf47012bdf,2017-05-10 14:03:27,2017-05-10 14:03:27
940526d0df4938d234d0a900268106c4,2017-08-28 22:47:13,2017-08-28 22:47:13
9c338ea8093192e203bc16add78c123c,2017-11-21 12:08:32,2017-11-21 12:08:32
a4156bb8aff5d6722dc68f605d8fa241,2017-09-26 11:08:38,2017-09-26 11:08:38
ddbd5d378c4a0981ba1ef29fb8e40b8f,2017-09-13 15:07:45,2017-09-13 15:07:45
d44c356f894fa28cffe33c455abb72ba,2017-08-17 17:03:31,2017-08-17 17:03:31
24c63a7108d652ad0ed85589c4575297,2018-06-13 22:54:20,2018-06-13 22:54:20
18c934f4cdc994cd04eb13bce3f47a18,2018-02-02 15:26:38,2018-02-02 15:26:38
f31eb05ebdef1ede72cebeba759e7c92,2018-08-06 22:25:10,2018-08-06 22:25:10
021e84751ba0ead75b6d314a6ead88d9,2017-08-01 18:17:41,2017-08-01 18:17:41
1f7945736d0f303827055ca99168ad20,2017-04-03 23:09:50,2017-04-03 23:09:50
016c5c3fb572754f302fdac24aa9cfa4,2018-06-04 08:33:09,2018-06-04 08:33:09
5072cf2f4cbec30b8ba917d5d7b6b125,2017-04-27 14:17:37,2017-04-27 14:17:37
40eb5b16b04bc62c59d4905857958e82,2017-10-31 21:47:13,2017-10-31 21:47:13
e54367d4b00c5cb76d2dfe71b9bdb89c,2018-07-04 16:49:21,2018-07-04 16:49:21
c5064807abdc55acd37860160154ed1a,2018-08-27 13:57:36,2018-08-27 13:57:36
90714b0e62fe1fbd304fb45fd644ebdd,2018-02-24 08:45:01,2018-02-24 08:45:01
17ebae22126d3df35f5e1fa1efedab94,2018-05-17 07:17:54,2018-05-17 07:17:54
5957d9ae822bcbe88c00fb8286362339,2018-03-01 12:43:37,2018-03-01 12:43:37
32fa597a3b06db1949ee96c416335b6b,2018-03-01 20:30:22,2018-03-01 20:30:22
80f70f0ca0bcd19bf71e848e51206d68,2017-07-12 18:45:24,2017-07-12 18:45:24
cb633030180d869d7bb76aa783a78b6d,2017-07-04 23:29:52,2017-07-04 23:29:52
08fe63b02e7e846c85b8a49b9fd540d9,2018-02-15 11:58:49,2018-02-15 11:58:49
99ae056139c928155fbb6789440c8824,2018-07-31 21:51:41,2018-07-31 21:51:41
6c5aeca0152670c75e44c9c67eb7c1f3,2018-01-22 15:24:44,2018-01-22 15:24:44
cb1e2bf26acb98ef66bb11447a218cc2,2017-02-25 14:34:40,2017-02-25 14:34:40
d436bce514752338004b26a232f21008,2018-05-16 13:47:51,2018-05-16 13:47:51
0dae7978fb6595f295dd3fd9ede02cda,2017-06-19 18:00:01,2017-06-19 18:00:01
88196bd808ae8abe1b944efe1807b508,2017-11-19 20:06:12,2017-11-19 20:06:12
af684ccf558442d5fa8d9daa7456ac76,2018-08-02 12:25:18,2018-08-02 12:25:18
f1b66f0324a631de414bc2bf62b5e915,2018-06-23 19:29:12,2018-06-23 

2025-01-21 14:41:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:41:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:41:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:41:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:41:09 - snowflake.connector.connection - INFO - closed
2025-01-21 14:41:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:41:43 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 14:41:43 - root - INFO - ```sql
SELECT 
    o."customer_id",
    COUNT(DISTINCT o."order_id") AS "number_of_orders",
    AVG(p."payment_value") AS "average_payment_per_order",
    CASE
        WHEN DATEDIFF('week', 
                      MIN(TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')), 
                      MAX(TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) < 1 THEN 1.0
        ELSE DATEDIFF('week', 
                      MIN(TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')), 
                      MAX(TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')))
    END AS "lifespan_in_weeks"
FROM 
    E_COMMERCE.E_COMMERCE.ORDERS o
JOIN 
    E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p 
    ON o."order_id" = p."order_id"
GROUP BY 
    o."customer_id"
ORDER BY 
    "average_payment_per_order" DESC
LIMIT 3;
```
2025-01-21 14:41:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:41:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:41:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:41:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-21 14:41:45 - snowflake.connector.connection - INFO - closed
2025-01-21 14:41:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:42:58 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 14:42:58 - root - INFO - SQL:
SELECT 
    o."customer_id",
    COUNT(DISTINCT o."order_id") AS "number_of_orders",
    AVG(p."payment_value") AS "average_payment_per_order",
    CASE
        WHEN DATEDIFF('week', 
                      MIN(TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')), 
                      MAX(TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) < 1 THEN 1.0
        ELSE DATEDIFF('week', 
                      MIN(TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')), 
                      MAX(TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')))
    END AS "lifespan_in_weeks"
FROM 
    E_COMMERCE.E_COMMERCE.ORDERS o
JOIN 
    E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p 
    ON o."order_id" = p."order_id"
GROUP BY 
    o."customer_id"
ORDER BY 
    "average_payment_per_order" DESC
LIMIT 3;
Results:
customer_id,number_of_orders,average_payment_per_order,lifespan_in_weeks
1617b1357756262bfa56ab541c47bc16,1,13664.08,1
ec5b2ba62e574342386871631fafd3fc,1,7274.88,1
c6e2731c5b391845f6800c97401a43a9,1,6929.31,1

2025-01-21 14:42:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:42:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:42:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:43:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:43:00 - snowflake.connector.connection - INFO - closed
2025-01-21 14:43:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:43:00 - root - INFO - SQL:
-- 11. Calculate the lifespan in weeks for each customer, setting it to 1.0 if less than one week (first 100 customers)
SELECT "customer_id",
       CASE
           WHEN DATEDIFF('week',
                         MIN(TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')),
                         MAX(TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) < 1 THEN 1.0
           ELSE DATEDIFF('week',
                         MIN(TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')),
                         MAX(TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')))::FLOAT
       END AS "lifespan_in_weeks"
FROM E_COMMERCE.E_COMMERCE.ORDERS
GROUP BY "customer_id"
LIMIT 100
Results:
customer_id,lifespan_in_weeks
9ef432eb6251297304e76186b10a928d,1.0
b0830fb4747a6c6d20dea0b8c802d7ef,1.0
41ce2a54c0b03bf3443c3d931a367089,1.0
f88197465ea7920adcdbec7375364d82,1.0
8ab97904e6daea8866dbdbc4fb7aad2c,1.0
503740e9ca751ccdda7ba28e9ab8f608,1.0
ed0271e0b7da060a393796590e7b737a,1.0
9bdf08b4b3b52b5526ff42d37d47f222,1.0
f54a9f0e6b351c431402b8461ea51999,1.0
31ad1d1b63eb9962463f764d4e6e0c9d,1.0
494dded5b201313c64ed7f100595b95c,1.0
7711cf624183d843aafe81855097bc37,1.0
d3e3b74c766bc6214e0c830b17ee2341,1.0
19402a48fe860416adf93348aba37740,1.0
3b6828a50ffe546942b7a473d70ac0fc,1.0
3187789bec990987628d7a9beb4dd6ac,1.0
059f7fc5719c7da6cbafe370971a8d70,1.0
d2b091571da224a1b36412c18bc3bbfe,1.0
4fa1cd166fa598be6de80fa84eaade43,1.0
72ae281627a6102d9b3718528b420f8a,1.0
a166da34890074091a942054b36e4265,1.0
8b212b9525f9e74e85e37ed6df37693e,1.0
52142aa69d8d0e1247ab0cada0f76023,1.0
816f8653d5361cbf94e58c33f2502a5c,1.0
cf8ffeddf027932e51e4eae73b384059,1.0
f5458ddc3545711efa883dd7ae7c4497,1.0
295ae9b35379e077273387ff64354b6f,1.0
2a1dfb647f32f4390e7b857c67458536,1.0
3391c4bc11a817e7973e498b0b023158,1.0
8644be24d48806bc3a88fd59fb47ceb1,1.0
caded193e8e47b8362864762a83db3c5,1.0
12fd2740039676063a874b9567dfa651,1.0
9b18f3fc296990b97854e351334a32f6,1.0
67407057a7d5ee17d1cd09523f484d13,1.0
81e08b08e5ed4472008030d70327c71f,1.0
be8c14c16a4d47194ccdfe10f1fc5b1a,1.0
55e6b290205c84ddd23ddf5eb134efd4,1.0
636e15840ab051faa13d3f781b6e4233,1.0
9f6618c17568ac301465fe7ad056c674,1.0
df9b032b2ad0fd6bf37dfb48e5f83845,1.0
48558a50a7ba1aab61891936d2ca7681,1.0
2e068340b3037f667ce3224bd59260af,1.0
6feea03756fd7ef4fb37d8f7e44aaeb9,1.0
e42998ccffc48dc87bf70b37e2d61f33,1.0
3a017955f82b5bf61bb51aec865a01ca,1.0
64d181ef52b1829800c598942459061b,1.0
738b086814c6fcc74b8cc583f8516ee3,1.0
3a874b4d4c4b6543206ff5d89287f0c3,1.0
7e20bf5ca92da68200643bda76c504c6,1.0
79183cd650e2bb0d475b0067d45946ac,1.0
684fa6da5134b9e4dab731e00011712d,1.0
b673f0597cb0c4d12778f731045f361a,1.0
82f0b75bb50fcb30711e5277e36b3983,1.0
167b9485947ed0a354a3f8dad04eb199,1.0
5883f965ac70043c2e908c3657c5d548,1.0
4dafe3c841d2d6cc8a8b6d25b35704b9,1.0
c1ddb7521d14db9071dccad0a94305c2,1.0
0dd5a932b1e29daa12845dbf696cbb54,1.0
8458f7ae02bda5950ce48c01a720559a,1.0
c178d6d544925594fafab0ba493cd645,1.0
9a80c8377644236e27f59e83862f1ae2,1.0
15bea20cd005ed59d34db54c6b32ec98,1.0
d0e6cb83a3fc27f56be011b2941f54c6,1.0
3df704f53d3f1d4818840b34ec672a9f,1.0
cce89a605105b148387c52e286ac8335,1.0
148348ff65384b4249b762579532e248,1.0
f5afca14dfa9dc64251cf2b45c54c363,1.0
241e78de29b3090cfa1b5d73a8130c72,1.0
4632eb5a8f175f6fe020520ae0c678f3,1.0
c77ee2d8ba1614a4d489a44166894938,1.0
a9d37ddc8ba4d9f6dbac7d8ec378cc95,1.0
a90391a47de936d56c66a5366cba1462,1.0
05e996469a2bf9559c7122b87e156724,1.0
f26a435864aebedff7f7c84f82ee229f,1.0
bf141bf67fbe428d558bcf0e018eab60,1.0
3a897024068ed42a183de61d5727d866,1.0
332df68ccac2f2f7d9e11299188f8bce,1.0
d4faa220408c20e53595d2950f361f3b,1.0
65ee4aa816cda8ad41e05c75e1cb691e,1.0
7f8c8b9c2ae27bf3300f670c3d478be8,1.0
62b423aab58096ca514ba6aa06be2f98,1.0
456dc10730fbdba34615447ea195d643,1.0
d9ef95f98d8da3b492bb8c0447910498,1.0
5f16605299d698660e0606f7eae2d2f9,1.0
ddaff536587109b89777e0353215e150,1.0
c7340080e394356141681bd4c9b8fe31,1.0
756fb9391752dad934e0fe3733378e57,1.0
4f28355e5c17a4a42d3ce2439a1d4501,1.0
7f2178c5d771e17f507d3c1637339298,1.0
f178c1827f67a8467b0385b7378d951a,1.0
2932d241d1f31e6df6c701d52370ae02,1.0
911e4c37f5cafe1604fe6767034bf1ae,1.0
9916715c2ab6ee1710c9c32f0a534ad2,1.0
afb19a4b667cb708caab312757ec3d3f,1.0
fee181bf648906d1c57f84f216976286,1.0
93ada7a24817edda9f4ab998fa823d16,1.0
64fb950e760ec8b0db79154a1fa9c1bf,1.0
8628fac2267e8c8804525da99c10ed0e,1.0
3135962ee745ef39b85576df7ddbaa99,1.0
1833a0540067becaf59368fe4cd4303a,1.0

2025-01-21 14:43:00 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:43:00 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:43:00 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:43:02 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-21 14:43:02 - snowflake.connector.connection - INFO - closed
2025-01-21 14:43:02 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:43:02 - root - INFO - SQL:
-- 12. Identify the top 3 customers with the highest average payment per order
SELECT o."customer_id",
       COUNT(DISTINCT o."order_id") AS "number_of_orders",
       AVG(p."payment_value") AS "average_payment_per_order"
FROM E_COMMERCE.E_COMMERCE.ORDERS o
JOIN E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p ON o."order_id" = p."order_id"
GROUP BY o."customer_id"
ORDER BY "average_payment_per_order" DESC
LIMIT 3
Results:
customer_id,number_of_orders,average_payment_per_order
1617b1357756262bfa56ab541c47bc16,1,13664.08
ec5b2ba62e574342386871631fafd3fc,1,7274.88
c6e2731c5b391845f6800c97401a43a9,1,6929.31

2025-01-21 14:43:02 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:43:02 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:43:02 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:43:04 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:43:04 - snowflake.connector.connection - INFO - closed
2025-01-21 14:43:04 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:43:04 - root - INFO - SQL:
-- 13. Sample order purchase timestamps to understand the date format
SELECT DISTINCT "order_purchase_timestamp"
FROM E_COMMERCE.E_COMMERCE.ORDERS
LIMIT 100
Results:
order_purchase_timestamp
2017-10-02 10:56:33
2018-07-24 20:41:37
2018-08-08 08:38:49
2018-02-13 21:18:39
2017-07-09 21:57:05
2017-04-11 12:22:08
2017-05-16 13:10:30
2017-01-23 18:29:09
2017-07-29 11:55:02
2018-06-07 10:06:19
2018-06-07 19:03:12
2018-01-02 19:00:43
2017-12-26 23:41:31
2017-10-26 15:54:26
2018-01-08 07:55:29
2018-06-04 00:00:13
2018-05-02 11:45:38
2018-02-25 13:50:30
2018-04-16 21:15:39
2018-02-03 12:38:58
2018-02-21 18:15:12
2018-03-26 17:12:18
2017-11-24 21:27:48
2018-06-04 16:44:48
2017-05-18 13:55:47
2018-06-26 13:42:52
2017-08-31 08:15:24
2017-11-30 22:02:15
2018-07-28 16:52:55
2018-08-03 08:59:39
2018-05-14 08:35:33
2018-08-22 16:10:29
2018-04-25 22:18:10
2017-10-19 15:08:48
2018-01-18 09:30:54
2017-12-21 04:59:55
2017-11-18 19:28:06
2018-03-01 14:14:28
2018-03-15 08:52:40
2017-08-10 11:58:33
2018-07-29 11:24:17
2017-09-13 14:27:11
2017-10-16 14:56:50
2018-04-11 22:32:31
2018-03-01 22:14:26
2018-03-31 14:20:46
2018-07-22 15:19:05
2018-01-09 06:37:43
2018-06-08 12:19:58
2017-12-02 14:08:33
2018-02-28 17:00:28
2017-04-20 16:18:26
2018-06-13 13:47:39
2018-07-15 08:33:19
2017-05-09 20:48:59
2017-09-27 12:07:22
2017-11-15 13:47:34
2018-04-04 08:39:50
2017-07-05 09:16:49
2017-06-25 19:30:09
2018-04-16 21:07:16
2018-01-11 16:51:17
2017-11-29 17:43:34
2017-07-13 19:58:11
2017-11-21 00:03:41
2017-09-18 14:31:30
2018-08-09 11:44:40
2018-02-20 23:46:53
2018-03-12 01:50:26
2018-07-29 23:34:51
2017-07-31 21:37:10
2018-08-04 23:25:30
2017-08-09 20:19:05
2018-07-26 14:39:59
2017-12-15 00:06:10
2018-06-11 08:18:19
2017-03-13 18:14:36
2018-08-05 13:09:48
2017-11-15 11:31:41
2018-04-22 08:48:13
2017-02-20 11:45:39
2017-12-08 09:42:43
2018-01-22 19:22:22
2017-09-03 14:22:03
2018-04-09 13:56:45
2017-04-27 11:08:59
2018-05-23 16:37:35
2017-05-16 19:41:10
2017-12-12 13:56:04
2018-06-01 12:23:13
2017-05-19 18:53:40
2017-08-04 17:10:39
2017-05-14 20:28:25
2018-05-17 16:59:11
2018-02-10 13:26:59
2018-02-15 10:33:30
2017-04-20 17:15:46
2017-08-09 18:32:47
2017-12-22 00:17:37
2017-04-20 20:42:44

2025-01-21 14:43:04 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:43:04 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:43:04 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:43:05 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:43:05 - snowflake.connector.connection - INFO - closed
2025-01-21 14:43:05 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:43:06 - root - INFO - SQL:
-- 14. List the payment values for orders (first 100 entries)
SELECT "order_id", "payment_value"
FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS
LIMIT 100
Results:
order_id,payment_value
b81ef226f3fe1789b1e8b2acac839d17,99.33
a9810da82917af2d9aefd1278f1dcfa0,24.39
25e8ea4e93396b6fa0d3dd708e76c1bd,65.71
ba78997921bbcdc1373bb41e913ab953,107.78
42fdf880ba16b47b59251dd489d4441a,128.45
298fcdf1f73eb413e4d26d01b25bc1cd,96.12
771ee386b001f06208a7419e4fc1bbd7,81.16
3d7239c394a212faae122962df514ac7,51.84
1f78449c87a54faf9e96e88ba1491fa9,341.09
0573b5e23cbd798006520e1d5b4c6714,51.95
d88e0d5fa41661ce03cf6cf336527646,188.73
2480f727e869fdeb397244a21b721b67,141.9
616105c9352a9668c38303ad44e056cd,75.78
cf95215a722f3ebf29e6bbab87a29e61,102.66
769214176682788a92801d8907fa1b40,105.28
12e5cfe0e4716b59afb0e0f4a3bd6570,157.45
61059985a6fc0ad64e95d9944caacdad,132.04
79da3f5fe31ad1e454f06f95dc032ad5,98.94
8ac09207f415d55acff302df7d6a895c,244.15
b2349a3f20dfbeef62e7b31baa22f84b,136.71
5a1f6d22f7dfb061ef29216b9af687a1,47.69
4214cda550ece8ee66441f459dc33a8c,170.57
adfbf6c2a620196f9a3ec747491c72b7,67.5
4d680edbaa7d3d9bed69532957368a03,353.09
8cd68144cdb62dc0d60848cf8616d2a4,330.66
5cfd514482e22bc992e7693f0e3e8df7,45.17
d0a945f85ba1074b60aac97ade7e240e,541.0
c39414c195d0f94c9d9c35e7c6ed4f1a,139.22
5d9c5817e278892b7498d90bfa28ade8,290.16
b69b9260e79a0da00e15f48de1bd2524,283.34
f45074ae38f2e01d9b854ec8d40362ff,13.78
81cedc4d2132eb6f512354166e51b187,30.28
595f598849d89203c28d05d0fbf3f92e,26.58
f9d0ec2fa088ac583e1ccd15b6686073,89.68
e647bf617de735448a4ba54f8910393c,65.09
b2bb080b6bc860118a246fd9b6fad6da,173.84
23f10f509600c30cf2852f9dbdf28fc3,103.49
f86f6472fa9f395d8d9a6751ca118afb,64.03
1dcf0c8cd36ffaf57784fbdc90079310,157.15
00d8d65b666158b633f96054d31af43b,130.88
cf30fe76d1505192acee1c6dccb15545,47.72
d3e774a185c0b1b2286ffd6c70abe2e6,117.74
32b1d8f3789a57f1f752e20ac7404b4c,56.6
c10d412026c4077b8e83acf0fea04eee,266.16
56c3277583e16009c925fdf116df420f,31.38
0e0441786430b7cfcd0d91f822ea4c99,121.49
6ffb3f1686bceae3466facf7e02ce3fb,32.0
afef48d3c8a0b1b7c9b7f8f922fb5674,153.41
c0db7d31ace61fc360a3eaa34dd3457c,65.71
d574338f566ca28dd67820f48ec1f1d8,278.22
1807cc736321f14baa58ef39cf6e5989,91.66
e8977f709bbb0367f51b589e6325f991,132.51
2e2c60b99754ae1e4d8b18846cfec9f2,542.66
1ffb3c1929b16d9c1aec1958e11b3e9b,166.04
95442deb81a5d91c97c0df96b431634a,368.98
10af96a0689260134307879127ac1952,113.2
85eef2d342b0de363c45c1bc324729c5,99.43
aa964845f1de8125410aea8b73e9e1ec,27.35
343348b1e29e9fa9e7b6ab1027f9177d,43.77
ad4098a257676ea4d394fb3bbbf36ca3,68.49
3e0c3cab458e8b3cc8d1d38ecb7e7775,105.53
3ab4eea6776259ae8dfbabaeffece352,387.8
10d9871bed9fb8d0887d3b9022edd1ff,84.14
c108072ab31ec90a754129c171577f5f,210.82
fc662bafa52d2ef16078f6f6141009d6,90.05
4217849b1ff18a9270fe048eabc4dc45,67.88
795c16acb4e3c30dfa5b6827727ef488,37.58
55e2d723733c45033e71cb4d44690234,89.63
947e9c6bfd83a06953c420ef92d3da6e,69.46
60e43c5f5ba559d9dd19357ed72cb2f2,78.3
e3e9e3295f4e1512167c232a0aaae8a5,50.8
460d57443ffdcaeba240360239747cf7,34.0
4cb51127f19f7254b320efe1718477dd,77.1
110d9355d6338eab0a65a0cacdde5434,566.4
42f5954cda381bd032934ee38c453711,402.42
3689194c14ad4e2e7361ebd1df0e77b0,57.53
97c111c4f22dfa1089a9c0b5338dcc79,44.01
4b2d035932915aa9c2a0d4d84cd6d3b0,187.51
e1b4ee0e390fbac1dec439d72b45a115,77.7
fee72a68ce935ebf2939fe72f27d3d9b,48.68
4d3bfdf4c7d6578ea445d588371ae10e,77.29
4c2e1a95586c815795a324d1599e7b5a,117.71
c9f23db8a1cb725df9bdb3383bd72b38,169.34
8e47a04b25d7a7075064e8e0bd2e0318,37.61
723e462ce1ee50e024887c0b403130f3,13.8
fa2ea4b6e84c1c0fc4f3a6d468c55183,227.12
fb1a2a1296f822405a946cbdfc0d3ed6,34.78
198298d54f269d8c5fe89e85a859af61,342.56
b19ca559688b49e8cf7f88c1aa3f0009,73.34
5be8d4719fe2e3669e2d07dddf3b6b0c,117.85
4a02e985c7239d866a632f07ed20d9c0,48.62
3e17eef8a8bd0131c7aed90d7508799e,53.99
f8d323a2702fed37f0229965f7e9f8b3,51.14
de4090fd9b7900d46323b0c7c36b7128,121.45
17e5131fe1d4b1a8dc14d4a66914f9d7,73.34
20f136d890c31a62486c809f91a5b098,117.68
557cc2675910c4a6c9b54ad276f25097,56.77
d60a89ab9bc1e68834465ae630c3343e,115.59
3ba2d0012b1f34bc6ccbc31c4ba69f93,60.07
d46f45b0d795bcf47a19d301710e63fe,27.27

2025-01-21 14:43:06 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:43:06 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:43:06 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:43:07 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-21 14:43:07 - snowflake.connector.connection - INFO - closed
2025-01-21 14:43:07 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:43:07 - root - INFO - SQL:
-- 15. Count the total number of customers
SELECT COUNT(DISTINCT "customer_id") AS "total_customers"
FROM E_COMMERCE.E_COMMERCE.CUSTOMERS
Results:
total_customers
99441

2025-01-21 14:43:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:43:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:43:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:43:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-21 14:43:09 - snowflake.connector.connection - INFO - closed
2025-01-21 14:43:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:43:09 - root - INFO - SQL:
-- 16. Count the total number of orders
SELECT COUNT(DISTINCT "order_id") AS "total_orders"
FROM E_COMMERCE.E_COMMERCE.ORDERS
Results:
total_orders
99441

2025-01-21 14:43:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:43:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:43:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:43:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 24
2025-01-21 14:43:10 - snowflake.connector.connection - INFO - closed
2025-01-21 14:43:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:43:11 - root - INFO - SQL:
-- 17. View the distribution of payment installments
SELECT "payment_installments", COUNT(*) AS "count"
FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS
GROUP BY "payment_installments"
ORDER BY "count" DESC
LIMIT 100
Results:
payment_installments,count
1,52546
2,12413
3,10461
4,7098
10,5328
5,5239
8,4268
6,3920
7,1626
9,644
12,133
15,74
18,27
11,23
24,18
20,17
13,16
14,15
17,8
16,5
21,3
0,2
22,1
23,1

2025-01-21 14:43:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:43:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:43:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:43:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 5
2025-01-21 14:43:12 - snowflake.connector.connection - INFO - closed
2025-01-21 14:43:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:43:13 - root - INFO - SQL:
-- 18. Aggregate payment values by payment type (first 100 entries)
SELECT "payment_type", SUM("payment_value") AS "total_payment"
FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS
GROUP BY "payment_type"
LIMIT 100
Results:
payment_type,total_payment
credit_card,12542084.19
boleto,2869361.27
voucher,379436.87
debit_card,217989.79
not_defined,0.0

2025-01-21 14:43:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:43:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:43:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:43:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:43:14 - snowflake.connector.connection - INFO - closed
2025-01-21 14:43:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:43:14 - root - INFO - SQL:
-- 19. List customers along with their city and state (first 100 customers)
SELECT "customer_id", "customer_city", "customer_state"
FROM E_COMMERCE.E_COMMERCE.CUSTOMERS
LIMIT 100
Results:
customer_id,customer_city,customer_state
06b8999e2fba1a1fbc88172c00ba8bc7,franca,SP
18955e83d337fd6b2def6b18a428ac77,sao bernardo do campo,SP
4e7b3e00288586ebd08712fdd0374a03,sao paulo,SP
b2b6027bc5c5109e529d4dc6358b12c3,mogi das cruzes,SP
4f2d8ab171c80ec8364f7c12e35b23ad,campinas,SP
879864dab9bc3047522c92c82e1212b8,jaragua do sul,SC
fd826e7cf63160e536e0908c76c3f441,sao paulo,SP
5e274e7a0c3809e14aba7ad5aae0d407,timoteo,MG
5adf08e34b2e993982a47070956c5c65,curitiba,PR
4b7139f34592b3a31687243a302fa75b,belo horizonte,MG
9fb35e4ed6f0a14a4977cd9aea4042bb,montes claros,MG
5aa9e4fdd4dfd20959cad2d772509598,rio de janeiro,RJ
b2d1536598b73a9abd18e0d75d92f0a3,lencois paulista,SP
eabebad39a88bb6f5b52376faec28612,sao paulo,SP
1f1c7bf1c9b041b292af6c1c4470b753,caxias do sul,RS
206f3129c0e4d7d0b9550426023f0a08,piracicaba,SP
a7c125a0a07b75146167b7f04a7f8e98,rio de janeiro,RJ
c5c61596a3b6bd0cee5766992c48a9a1,guarulhos,SP
9b8ce803689b3562defaad4613ef426f,sao paulo,SP
49d0ea0986edde72da777f15456a0ee0,pacaja,PA
154c4ded6991bdfa3cd249d11abf4130,florianopolis,SC
690172ab319622688d3b4df42f676898,aparecida de goiania,GO
2938121a40a20953c43caa8c98787fcb,sao paulo,SP
237098a64674ae89babdc426746260fc,curitiba,PR
cb721d7b4f271fd87011c4c83462c076,sao paulo,SP
f681356046d9fde60e70c73a18d65ea2,santo andre,SP
167bd30a409e3e4127df5a9408ebd394,goiania,GO
6e359a57a91f84095cc64e1b351aef8c,sao paulo,SP
e0eea8f69a457b3f1fa246e44c9ebefd,cachoeiro de itapemirim,ES
e3109970a3fe8021d5ff82c577ce5606,sao paulo,SP
261cb4f92498ca05d5bd1a327a261d9c,sao jose dos campos,SP
6f92779347724b67e44e3224f3b4cffd,sao roque,SP
2d5831cb2dff7cdefba62e950ae3dc7b,camacari,BA
b2bed119388167a954382cca36c4777f,resende,RJ
469634941c27cd844170935a3cf60b95,curitiba,PR
df0aa5b8586495e0ddf6b601122e43a1,sumare,SP
41c8f4b570869791379a925899a6af8a,guarulhos,SP
54f755c3fd2709231f9964a1430c5218,novo hamburgo,RS
4c06b42fbf7b97ab10779cda5549cd1c,sao luis,MA
b6368ca0f56d4632f44d58ca431487b2,sao jose,SC
4a0e66fd30684aa1409cd1b66fec77cc,guarulhos,SP
c168abb9077b7821adae01dc1f0886c5,santa barbara,MG
a3b0fda37bae14cf754877bed475e80c,sao paulo,SP
0ccd415657ae8a6cd1c71b00155a019e,guarulhos,SP
c532a74a3ebf1bacce2e2bcce3783317,ribeirao preto,SP
19cecb194f54e614b70d971306a9931b,belo horizonte,MG
f34a6e874087ec1f0e3dab9fdf659c5d,ituiutaba,MG
c132855c926907970dcf6f2bf0b33a24,taquarituba,SP
df85b96ba2ce3e49bde101b1614f52ac,sao jose dos pinhais,PR
4d27341acd30a36bca39008ee9bb9050,jaragua do sul,SC
d3b6830d18c7de943d1e707d1f061d40,sao paulo,SP
79de53946db384e2d7a9bd131792ad17,montes claros,MG
a562ab1e728449e3461829dfe2e36f73,barrinha,SP
b64ed91eab98972150bdaf77ca921934,rio de janeiro,RJ
8247b5583327ab8be19f96e1fb82f77b,parati,RJ
8fcaa9368903f3a9a28aeaff28c14638,dourados,MS
a9b0d1c26105279e1b8edc63d06bd668,sao paulo,SP
aa9f03ecd3728c9bd12e6d962c66c7cb,trindade,GO
230c0d740401730c7197d16376893525,cascavel,PR
a905baa530258422594f1b05615bd225,fortaleza,CE
4fa19f7da692e6bf9602aaad3c372eda,brasilia,DF
03f846ad03437d864a8d2a22976dcafe,sao paulo,SP
de4e13fd7d6469c5ada77d0843c55e42,pelotas,RS
8276de07ef25225d412b8462d73f8664,porto alegre,RS
cc32707d2e2f7c92ab449f9b28154809,rio de janeiro,RJ
a02f66c3af7b16eec19ddcd98b645fe3,salto,SP
26acee41e2f75689a5615892f06ea0bd,belo horizonte,MG
f64cdee66599119324ce57a97e43700d,jundiai,SP
7ab7a537b678b6dd73d825ff6ee7be9d,cachoeiro de itapemirim,ES
7300450cedf7e4c35c243c4a03c1e8a6,cacapava,SP
4c7241af24b5344cb01fe687643de4fe,fortaleza,CE
97e126f19a6f04b3462619f36862bcd2,sao vicente,SP
6d27a9361e591da38c87a5e70253f3f2,uberlandia,MG
6810c3dc47f641181fcc7f73275c3d19,botelhos,MG
b514422efcf14bef34858a0829bef189,sao goncalo,RJ
0aae2862f8eac77f10a34f44860720ac,sao paulo,SP
6c9a5923526346cbc0bd7bbd92269c01,sao paulo,SP
1b2cb35b19b40b61f953d32ea157b337,araucaria,PR
12d1b4294fef21016c9614eb31e55e15,sao vicente,SP
f6529ffebe6b3440d45d89604a4239ac,nova iguacu,RJ
8264e3518163dd09211870b24a5d741d,sao paulo,SP
8392e3d4cfeec63f2a8bfea68bf1f91f,areia branca,RN
38d1cd89306128348ffdf4cc23f3a50a,sao paulo,SP
91ec76836092bba85d11761078ed7bb5,campos dos goytacazes,RJ
f9dfa0a2934ffbb22e66924952548be8,sao carlos,SP
5a3260cfde2a918b597dada7ddd247bb,sao paulo,SP
ee3a81b2771fec5f9e982cdb1b3a4804,itajuba,MG
784c407781aa34749a388c9283782b56,porto alegre,RS
3f6ede29d4c69cd3316d2035b6cec1fb,sao bernardo do campo,SP
6bed27564bd99d78d09c1fac13da56fd,salto,SP
670254dd2e886ffe621b3831afb47d7d,cruz das almas,BA
f7cb015ff73be957ee6a30e2577742c5,vassouras,RJ
ea2196dc456ba36fe4f6b81dca4867d4,feira de santana,BA
09241c552e9fe2420997a6c535e9d408,sao paulo,SP
e50a30de3c32f9406a7185f40ce6874d,brasilia,DF
f89c1a6b9c966869e441e55bc14acddc,sao carlos,SP
23e96758fd640560e9b1fbcda90abfc4,sao paulo,SP
369708cabd9831ea6fde670a3b602a92,sao paulo,SP
5f8b4882b5a4ec7bf6d2107e6cd0cf29,niteroi,RJ
ad6891a1937cb8723a2c08ba1ae59873,sao luis,MA

2025-01-21 14:43:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:43:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:43:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:43:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:43:16 - snowflake.connector.connection - INFO - closed
2025-01-21 14:43:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:43:16 - root - INFO - SQL:
-- 20. Display orders with their status and associated payment values (first 100 orders)
SELECT o."order_id", o."order_status", p."payment_value"
FROM E_COMMERCE.E_COMMERCE.ORDERS o
JOIN E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p ON o."order_id" = p."order_id"
LIMIT 100
Results:
order_id,order_status,payment_value
b81ef226f3fe1789b1e8b2acac839d17,delivered,99.33
a9810da82917af2d9aefd1278f1dcfa0,delivered,24.39
25e8ea4e93396b6fa0d3dd708e76c1bd,delivered,65.71
ba78997921bbcdc1373bb41e913ab953,delivered,107.78
42fdf880ba16b47b59251dd489d4441a,delivered,128.45
298fcdf1f73eb413e4d26d01b25bc1cd,delivered,96.12
771ee386b001f06208a7419e4fc1bbd7,delivered,81.16
3d7239c394a212faae122962df514ac7,delivered,51.84
1f78449c87a54faf9e96e88ba1491fa9,delivered,341.09
0573b5e23cbd798006520e1d5b4c6714,delivered,51.95
d88e0d5fa41661ce03cf6cf336527646,delivered,188.73
2480f727e869fdeb397244a21b721b67,delivered,141.9
616105c9352a9668c38303ad44e056cd,delivered,75.78
cf95215a722f3ebf29e6bbab87a29e61,delivered,102.66
769214176682788a92801d8907fa1b40,delivered,105.28
12e5cfe0e4716b59afb0e0f4a3bd6570,delivered,157.45
61059985a6fc0ad64e95d9944caacdad,delivered,132.04
79da3f5fe31ad1e454f06f95dc032ad5,delivered,98.94
8ac09207f415d55acff302df7d6a895c,delivered,244.15
b2349a3f20dfbeef62e7b31baa22f84b,delivered,136.71
5a1f6d22f7dfb061ef29216b9af687a1,delivered,47.69
4214cda550ece8ee66441f459dc33a8c,delivered,170.57
adfbf6c2a620196f9a3ec747491c72b7,delivered,67.5
4d680edbaa7d3d9bed69532957368a03,delivered,353.09
8cd68144cdb62dc0d60848cf8616d2a4,delivered,330.66
5cfd514482e22bc992e7693f0e3e8df7,delivered,45.17
d0a945f85ba1074b60aac97ade7e240e,delivered,541.0
c39414c195d0f94c9d9c35e7c6ed4f1a,delivered,139.22
5d9c5817e278892b7498d90bfa28ade8,canceled,290.16
b69b9260e79a0da00e15f48de1bd2524,delivered,283.34
f45074ae38f2e01d9b854ec8d40362ff,delivered,13.78
81cedc4d2132eb6f512354166e51b187,delivered,30.28
595f598849d89203c28d05d0fbf3f92e,delivered,26.58
f9d0ec2fa088ac583e1ccd15b6686073,delivered,89.68
e647bf617de735448a4ba54f8910393c,delivered,65.09
b2bb080b6bc860118a246fd9b6fad6da,delivered,173.84
23f10f509600c30cf2852f9dbdf28fc3,delivered,103.49
f86f6472fa9f395d8d9a6751ca118afb,delivered,64.03
1dcf0c8cd36ffaf57784fbdc90079310,delivered,157.15
00d8d65b666158b633f96054d31af43b,delivered,130.88
cf30fe76d1505192acee1c6dccb15545,delivered,47.72
d3e774a185c0b1b2286ffd6c70abe2e6,delivered,117.74
32b1d8f3789a57f1f752e20ac7404b4c,delivered,56.6
c10d412026c4077b8e83acf0fea04eee,delivered,266.16
56c3277583e16009c925fdf116df420f,delivered,31.38
0e0441786430b7cfcd0d91f822ea4c99,delivered,121.49
6ffb3f1686bceae3466facf7e02ce3fb,delivered,32.0
afef48d3c8a0b1b7c9b7f8f922fb5674,invoiced,153.41
c0db7d31ace61fc360a3eaa34dd3457c,delivered,65.71
d574338f566ca28dd67820f48ec1f1d8,delivered,278.22
1807cc736321f14baa58ef39cf6e5989,delivered,91.66
e8977f709bbb0367f51b589e6325f991,delivered,132.51
2e2c60b99754ae1e4d8b18846cfec9f2,delivered,542.66
1ffb3c1929b16d9c1aec1958e11b3e9b,delivered,166.04
95442deb81a5d91c97c0df96b431634a,delivered,368.98
10af96a0689260134307879127ac1952,delivered,113.2
85eef2d342b0de363c45c1bc324729c5,delivered,99.43
aa964845f1de8125410aea8b73e9e1ec,delivered,27.35
343348b1e29e9fa9e7b6ab1027f9177d,delivered,43.77
ad4098a257676ea4d394fb3bbbf36ca3,delivered,68.49
3e0c3cab458e8b3cc8d1d38ecb7e7775,delivered,105.53
3ab4eea6776259ae8dfbabaeffece352,delivered,387.8
10d9871bed9fb8d0887d3b9022edd1ff,delivered,84.14
c108072ab31ec90a754129c171577f5f,shipped,210.82
fc662bafa52d2ef16078f6f6141009d6,delivered,90.05
4217849b1ff18a9270fe048eabc4dc45,delivered,67.88
795c16acb4e3c30dfa5b6827727ef488,delivered,37.58
55e2d723733c45033e71cb4d44690234,delivered,89.63
947e9c6bfd83a06953c420ef92d3da6e,canceled,69.46
60e43c5f5ba559d9dd19357ed72cb2f2,delivered,78.3
e3e9e3295f4e1512167c232a0aaae8a5,delivered,50.8
460d57443ffdcaeba240360239747cf7,delivered,34.0
4cb51127f19f7254b320efe1718477dd,delivered,77.1
110d9355d6338eab0a65a0cacdde5434,delivered,566.4
42f5954cda381bd032934ee38c453711,delivered,402.42
3689194c14ad4e2e7361ebd1df0e77b0,delivered,57.53
97c111c4f22dfa1089a9c0b5338dcc79,delivered,44.01
4b2d035932915aa9c2a0d4d84cd6d3b0,delivered,187.51
e1b4ee0e390fbac1dec439d72b45a115,delivered,77.7
fee72a68ce935ebf2939fe72f27d3d9b,delivered,48.68
4d3bfdf4c7d6578ea445d588371ae10e,delivered,77.29
4c2e1a95586c815795a324d1599e7b5a,delivered,117.71
c9f23db8a1cb725df9bdb3383bd72b38,delivered,169.34
8e47a04b25d7a7075064e8e0bd2e0318,delivered,37.61
723e462ce1ee50e024887c0b403130f3,delivered,13.8
fa2ea4b6e84c1c0fc4f3a6d468c55183,delivered,227.12
fb1a2a1296f822405a946cbdfc0d3ed6,delivered,34.78
198298d54f269d8c5fe89e85a859af61,delivered,342.56
b19ca559688b49e8cf7f88c1aa3f0009,delivered,73.34
5be8d4719fe2e3669e2d07dddf3b6b0c,delivered,117.85
4a02e985c7239d866a632f07ed20d9c0,delivered,48.62
3e17eef8a8bd0131c7aed90d7508799e,delivered,53.99
f8d323a2702fed37f0229965f7e9f8b3,delivered,51.14
de4090fd9b7900d46323b0c7c36b7128,delivered,121.45
17e5131fe1d4b1a8dc14d4a66914f9d7,delivered,73.34
20f136d890c31a62486c809f91a5b098,delivered,117.68
557cc2675910c4a6c9b54ad276f25097,delivered,56.77
d60a89ab9bc1e68834465ae630c3343e,delivered,115.59
3ba2d0012b1f34bc6ccbc31c4ba69f93,delivered,60.07
d46f45b0d795bcf47a19d301710e63fe,delivered,27.27

2025-01-21 14:43:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:43:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:43:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:43:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:43:18 - snowflake.connector.connection - INFO - closed
2025-01-21 14:43:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:43:18 - root - INFO - SQL:
-- 9. Find the earliest and latest order dates for each customer (first 100 customers)
SELECT "customer_id",
       MIN(TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')) AS "first_order_date",
       MAX(TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')) AS "last_order_date"
FROM E_COMMERCE.E_COMMERCE.ORDERS
GROUP BY "customer_id"
LIMIT 100
Results:
Too long, hard cut:
customer_id,first_order_date,last_order_date
9ef432eb6251297304e76186b10a928d,2017-10-02 10:56:33,2017-10-02 10:56:33
b0830fb4747a6c6d20dea0b8c802d7ef,2018-07-24 20:41:37,2018-07-24 20:41:37
41ce2a54c0b03bf3443c3d931a367089,2018-08-08 08:38:49,2018-08-08 08:38:49
f88197465ea7920adcdbec7375364d82,2017-11-18 19:28:06,2017-11-18 19:28:06
8ab97904e6daea8866dbdbc4fb7aad2c,2018-02-13 21:18:39,2018-02-13 21:18:39
503740e9ca751ccdda7ba28e9ab8f608,2017-07-09 21:57:05,2017-07-09 21:57:05
ed0271e0b7da060a393796590e7b737a,2017-04-11 12:22:08,2017-04-11 12:22:08
9bdf08b4b3b52b5526ff42d37d47f222,2017-05-16 13:10:30,2017-05-16 13:10:30
f54a9f0e6b351c431402b8461ea51999,2017-01-23 18:29:09,2017-01-23 18:29:09
31ad1d1b63eb9962463f764d4e6e0c9d,2017-07-29 11:55:02,2017-07-29 11:55:02
494dded5b201313c64ed7f100595b95c,2017-05-16 19:41:10,2017-05-16 19:41:10
7711cf624183d843aafe81855097bc37,2017-07-13 19:58:11,2017-07-13 19:58:11
d3e3b74c766bc6214e0c830b17ee2341,2018-06-07 10:06:19,2018-06-07 10:06:19
19402a48fe860416adf93348aba37740,2018-07-25 17:44:10,2018-07-25 17:44:10
3b6828a50ffe546942b7a473d70ac0fc,2018-06-07 19:03:12,2018-06-07 19:03:12
3187789bec990987628d7a9beb4dd6ac,2017-12-26 23:41:31,2017-12-26 23:41:31
059f7fc5719c7da6cbafe370971a8d70,2017-11-21 00:03:41,2017-11-21 00:03:41
d2b091571da224a1b36412c18bc3bbfe,2017-09-18 14:31:30,2017-09-18 14:31:30
4fa1cd166fa598be6de80fa84eaade43,2018-03-15 08:52:40,2018-03-15 08:52:40
72ae281627a6102d9b3718528b420f8a,2018-02-03 20:37:35,2018-02-03 20:37:35
a166da34890074091a942054b36e4265,2018-01-08 07:55:29,2018-01-08 07:55:29
8b212b9525f9e74e85e37ed6df37693e,2018-03-12 01:50:26,2018-03-12 01:50:26
52142aa69d8d0e1247ab0cada0f76023,2018-04-16 21:15:39,2018-04-16 21:15:39
816f8653d5361cbf94e58c33f2502a5c,2017-12-12 13:56:04,2017-12-12 13:56:04
cf8ffeddf027932e51e4eae73b384059,2018-07-29 23:34:51,2018-07-29 23:34:51
f5458ddc3545711efa883dd7ae7c4497,2018-02-21 18:15:12,2018-02-21 18:15:12
295ae9b35379e077273387ff64354b6f,2017-07-31 21:37:10,2017-07-31 21:37:10
2a1dfb647f32f4390e7b857c67458536,2018-06-01 12:23:13,2018-06-01 12:23:13
3391c4bc11a817e7973e498b0b023158,2018-03-26 17:12:18,2018-03-26 17:12:18
8644be24d48806bc3a88fd59fb47ceb1,2017-08-04 17:10:39,2017-08-04 17:10:39
caded193e8e47b8362864762a83db3c5,2018-06-04 16:44:48,2018-06-04 16:44:48
12fd2740039676063a874b9567dfa651,2018-05-17 16:59:11,2018-05-17 16:59:11
9b18f3fc296990b97854e351334a32f6,2018-02-01 14:02:19,2018-02-01 14:02:19
67407057a7d5ee17d1cd09523f484d13,2018-06-11 10:25:52,2018-06-11 10:25:52
81e08b08e5ed4472008030d70327c71f,2018-04-22 08:48:13,2018-04-22 08:48:13
be8c14c16a4d47194ccdfe10f1fc5b1a,2018-06-13 13:47:39,2018-06-13 13:47:39
55e6b290205c84ddd23ddf5eb134efd4,2018-04-13 08:44:17,2018-04-13 08:44:17
636e15840ab051faa13d3f781b6e4233,2018-07-28 16:52:55,2018-07-28 16:52:55
9f6618c17568ac301465fe7ad056c674,2017-10-16 14:56:50,2017-10-16 14:56:50
df9b032b2ad0fd6bf37dfb48e5f83845,2017-08-26 16:53:30,2017-08-26 16:53:30
48558a50a7ba1aab61891936d2ca7681,2018-01-22 19:22:22,2018-01-22 19:22:22
2e068340b3037f667ce3224bd59260af,2017-10-19 15:08:48,2017-10-19 15:08:48
6feea03756fd7ef4fb37d8f7e44aaeb9,2018-02-06 18:25:39,2018-02-06 18:25:39
e42998ccffc48dc87bf70b37e2d61f33,2018-06-08 12:19:58,2018-06-08 12:19:58
3a017955f82b5bf61bb51aec865a01ca,2018-06-01 11:26:06,2018-06-01 11:26:06
64d181ef52b1829800c598942459061b,2018-05-09 14:32:09,2018-05-09 14:32:09
738b086814c6fcc74b8cc583f8516ee3,2018-01-02 19:00:43,2018-01-02 19:00:43
3a874b4d4c4b6543206ff5d89287f0c3,2018-02-20 23:46:53,2018-02-20 23:46:53
7e20bf5ca92da68200643bda76c504c6,2018-06-04 00:00:13,2018-06-04 00:00:13
79183cd650e2bb0d475b0067d45946ac,2018-07-26 14:39:59,2018-07-26 14:39:59
684fa6da5134b9e4dab731e00011712d,2018-03-09 14:50:15,2018-03-09 14:50:15
b673f0597cb0c4d12778f731045f361a,2017-05-09 20:48:59,2017-05-09 20:48:59
82f0b75bb50fcb30711e5277e36b3983,2018-04-22 23:23:18,2018-04-22 23:23:18
167b9485947ed0a354a3f8dad04eb199,2018-07-05 18:40:47,2018-07-05 18:40:47
5883f965ac70043c2e908c3657c5d548,2017-12-21 17:43:41,2017-12-21 17:43:41
4dafe3c841d2d6cc8a8b6d25b35704b9,2017-05-09 11:48:37,2017-05-09 11:48:37
c1ddb7521d14db9071dccad0a94305c2,2018-07-15 12:37:12,2018-07-15 12:37:12
0dd5a932b1e29daa12845dbf696cbb54,2018-06-03 18:24:33,2018-06-03 18:24:33
8458f7ae02bda5950ce48c01a720559a,2018-05-23 16:37:35,2018-05-23 16:37:35
c178d6d544925594fafab0ba493cd645,2018-08-08 21:11:25,2018-08-08 21:11:25
9a80c8377644236e27f59e83862f1ae2,2017-07-10 12:23:05,2017-07-10 12:23:05
15bea20cd005ed59d34db54c6b32ec98,2018-07-23 18:27:07,2018-07-23 18:27:07
d0e6cb83a3fc27f56be011b2941f54c6,2018-05-30 22:33:08,2018-05-30 22:33:08
3df704f53d3f1d4818840b34ec672a9f,2018-03-01 14:14:28,2018-03-01 14:14:28
cce89a605105b148387c52e286ac8335,2018-05-02 11:45:38,2018-05-02 11:45:38
148348ff65384b4249b762579532e248,2018-06-26 13:42:52,2018-06-26 13:42:52
f5afca14dfa9dc64251cf2b45c54c363,2017-12-15 00:06:10,2017-12-15 00:06:10
241e78de29b3090cfa1b5d73a8130c72,2017-06-13 21:11:26,2017-06-13 

2025-01-21 14:43:18 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:43:18 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:43:18 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:43:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:43:19 - snowflake.connector.connection - INFO - closed
2025-01-21 14:43:20 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:44:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 14:44:22 - root - INFO - ```sql
SELECT 
    o."customer_id",
    COUNT(DISTINCT o."order_id") AS "number_of_orders",
    AVG(p."payment_value") AS "average_payment_per_order",
    CASE
        WHEN DATEDIFF('day', 
                      MIN(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')),
                      MAX(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) < 7 THEN 1.0
        ELSE ROUND(
            DATEDIFF('day', 
                     MIN(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')),
                     MAX(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) / 7.0,
            2)
    END AS "lifespan_in_weeks"
FROM 
    E_COMMERCE.E_COMMERCE.ORDERS o
JOIN 
    E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p 
    ON o."order_id" = p."order_id"
WHERE 
    TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS') IS NOT NULL
GROUP BY 
    o."customer_id"
ORDER BY 
    "average_payment_per_order" DESC
LIMIT 3;
```
2025-01-21 14:44:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:44:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:44:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:44:23 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-21 14:44:23 - snowflake.connector.connection - INFO - closed
2025-01-21 14:44:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:45:13 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 14:45:13 - root - INFO - SQL:
SELECT 
    o."customer_id",
    COUNT(DISTINCT o."order_id") AS "number_of_orders",
    AVG(p."payment_value") AS "average_payment_per_order",
    CASE
        WHEN DATEDIFF('day', 
                      MIN(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')),
                      MAX(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) < 7 THEN 1.0
        ELSE ROUND(
            DATEDIFF('day', 
                     MIN(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')),
                     MAX(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) / 7.0,
            2)
    END AS "lifespan_in_weeks"
FROM 
    E_COMMERCE.E_COMMERCE.ORDERS o
JOIN 
    E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p 
    ON o."order_id" = p."order_id"
WHERE 
    TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS') IS NOT NULL
GROUP BY 
    o."customer_id"
ORDER BY 
    "average_payment_per_order" DESC
LIMIT 3;
Results:
customer_id,number_of_orders,average_payment_per_order,lifespan_in_weeks
1617b1357756262bfa56ab541c47bc16,1,13664.08,1.00
ec5b2ba62e574342386871631fafd3fc,1,7274.88,1.00
c6e2731c5b391845f6800c97401a43a9,1,6929.31,1.00

2025-01-21 14:45:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:45:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:45:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:45:14 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:45:14 - snowflake.connector.connection - INFO - closed
2025-01-21 14:45:14 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:45:14 - root - INFO - SQL:
-- 9. Find the earliest and latest order dates for each customer (first 100 customers)
SELECT "customer_id",
       MIN(TRY_TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')) AS "first_order_date",
       MAX(TRY_TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')) AS "last_order_date"
FROM E_COMMERCE.E_COMMERCE.ORDERS
WHERE TRY_TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS') IS NOT NULL
GROUP BY "customer_id"
LIMIT 100
Results:
Too long, hard cut:
customer_id,first_order_date,last_order_date
9ef432eb6251297304e76186b10a928d,2017-10-02 10:56:33,2017-10-02 10:56:33
b0830fb4747a6c6d20dea0b8c802d7ef,2018-07-24 20:41:37,2018-07-24 20:41:37
41ce2a54c0b03bf3443c3d931a367089,2018-08-08 08:38:49,2018-08-08 08:38:49
f88197465ea7920adcdbec7375364d82,2017-11-18 19:28:06,2017-11-18 19:28:06
8ab97904e6daea8866dbdbc4fb7aad2c,2018-02-13 21:18:39,2018-02-13 21:18:39
503740e9ca751ccdda7ba28e9ab8f608,2017-07-09 21:57:05,2017-07-09 21:57:05
ed0271e0b7da060a393796590e7b737a,2017-04-11 12:22:08,2017-04-11 12:22:08
9bdf08b4b3b52b5526ff42d37d47f222,2017-05-16 13:10:30,2017-05-16 13:10:30
31ad1d1b63eb9962463f764d4e6e0c9d,2017-07-29 11:55:02,2017-07-29 11:55:02
494dded5b201313c64ed7f100595b95c,2017-05-16 19:41:10,2017-05-16 19:41:10
d3e3b74c766bc6214e0c830b17ee2341,2018-06-07 10:06:19,2018-06-07 10:06:19
19402a48fe860416adf93348aba37740,2018-07-25 17:44:10,2018-07-25 17:44:10
3b6828a50ffe546942b7a473d70ac0fc,2018-06-07 19:03:12,2018-06-07 19:03:12
738b086814c6fcc74b8cc583f8516ee3,2018-01-02 19:00:43,2018-01-02 19:00:43
3187789bec990987628d7a9beb4dd6ac,2017-12-26 23:41:31,2017-12-26 23:41:31
059f7fc5719c7da6cbafe370971a8d70,2017-11-21 00:03:41,2017-11-21 00:03:41
7e20bf5ca92da68200643bda76c504c6,2018-06-04 00:00:13,2018-06-04 00:00:13
456dc10730fbdba34615447ea195d643,2017-08-10 11:58:33,2017-08-10 11:58:33
816f8653d5361cbf94e58c33f2502a5c,2017-12-12 13:56:04,2017-12-12 13:56:04
cf8ffeddf027932e51e4eae73b384059,2018-07-29 23:34:51,2018-07-29 23:34:51
295ae9b35379e077273387ff64354b6f,2017-07-31 21:37:10,2017-07-31 21:37:10
8644be24d48806bc3a88fd59fb47ceb1,2017-08-04 17:10:39,2017-08-04 17:10:39
756fb9391752dad934e0fe3733378e57,2018-08-04 23:25:30,2018-08-04 23:25:30
f178c1827f67a8467b0385b7378d951a,2017-08-31 08:15:24,2017-08-31 08:15:24
911e4c37f5cafe1604fe6767034bf1ae,2017-03-13 18:14:36,2017-03-13 18:14:36
9916715c2ab6ee1710c9c32f0a534ad2,2017-11-15 11:31:41,2017-11-15 11:31:41
5dda11942d4f77bee3a46d71e442aec4,2018-01-07 21:44:54,2018-01-07 21:44:54
be8c14c16a4d47194ccdfe10f1fc5b1a,2018-06-13 13:47:39,2018-06-13 13:47:39
f5618502bee8eafdee72fb6955e2ebdf,2018-02-15 10:33:30,2018-02-15 10:33:30
a90391a47de936d56c66a5366cba1462,2017-02-20 11:45:39,2017-02-20 11:45:39
3135962ee745ef39b85576df7ddbaa99,2018-08-03 08:59:39,2018-08-03 08:59:39
c622b892a190735ef81c0087973fa16d,2018-06-05 09:10:34,2018-06-05 09:10:34
c39bde0d4030d5e31e654f0c20db9786,2018-02-06 21:09:10,2018-02-06 21:09:10
4924a47e8cd5630b3564e26fac55c5ec,2018-07-18 13:39:54,2018-07-18 13:39:54
15bea20cd005ed59d34db54c6b32ec98,2018-07-23 18:27:07,2018-07-23 18:27:07
52006a9383bf149a4fb24226b173106f,2018-01-10 11:33:07,2018-01-10 11:33:07
c1ddb7521d14db9071dccad0a94305c2,2018-07-15 12:37:12,2018-07-15 12:37:12
4fa1cd166fa598be6de80fa84eaade43,2018-03-15 08:52:40,2018-03-15 08:52:40
a166da34890074091a942054b36e4265,2018-01-08 07:55:29,2018-01-08 07:55:29
5f16605299d698660e0606f7eae2d2f9,2018-02-17 15:59:46,2018-02-17 15:59:46
3391c4bc11a817e7973e498b0b023158,2018-03-26 17:12:18,2018-03-26 17:12:18
ddaff536587109b89777e0353215e150,2017-05-19 18:53:40,2017-05-19 18:53:40
caded193e8e47b8362864762a83db3c5,2018-06-04 16:44:48,2018-06-04 16:44:48
12fd2740039676063a874b9567dfa651,2018-05-17 16:59:11,2018-05-17 16:59:11
684fa6da5134b9e4dab731e00011712d,2018-03-09 14:50:15,2018-03-09 14:50:15
bb2f5e670f7155dc622c57e4b31d0a69,2017-09-13 14:27:11,2017-09-13 14:27:11
f26a435864aebedff7f7c84f82ee229f,2017-07-30 03:06:35,2017-07-30 03:06:35
bf141bf67fbe428d558bcf0e018eab60,2017-04-06 22:39:29,2017-04-06 22:39:29
b673f0597cb0c4d12778f731045f361a,2017-05-09 20:48:59,2017-05-09 20:48:59
fb9590a1e30e0ba8304ea73a31325797,2017-05-17 08:36:11,2017-05-17 08:36:11
dd854e24b40e3bc2b306946dee252015,2017-07-01 15:42:32,2017-07-01 15:42:32
61449fa1b8b8998c9c3f3a7f0ae954ef,2017-07-16 10:27:45,2017-07-16 10:27:45
d68901955dc622165460ba6cb4ac49f3,2017-03-28 16:03:34,2017-03-28 16:03:34
167b9485947ed0a354a3f8dad04eb199,2018-07-05 18:40:47,2018-07-05 18:40:47
7251aa758779438faea714941f1051c4,2018-05-25 08:54:21,2018-05-25 08:54:21
d4cd9729eeca5306a2c039fe6e55601e,2017-12-04 17:24:57,2017-12-04 17:24:57
9b18f3fc296990b97854e351334a32f6,2018-02-01 14:02:19,2018-02-01 14:02:19
cc3590e4afbb4b3e056b50a80a6a7d0c,2018-01-30 07:51:17,2018-01-30 07:51:17
818596f5b68adfe2c11498ebb6d39e02,2017-11-24 21:55:22,2017-11-24 21:55:22
cf9e2b07f78cce347089900f49fb4746,2017-03-14 16:25:43,2017-03-14 16:25:43
a8b396cd7edcd4340e02a07685084cd6,2017-09-27 14:43:47,2017-09-27 14:43:47
aa3d8c9eec8e52e90b117efe5e97a560,2017-12-21 04:59:55,2017-12-21 04:59:55
f54a9f0e6b351c431402b8461ea51999,2017-01-23 18:29:09,2017-01-23 18:29:09
3df704f53d3f1d4818840b34ec672a9f,2018-03-01 14:14:28,2018-03-01 14:14:28
7f8c8b9c2ae27bf3300f670c3d478be8,2017-10-26 15:54:26,2017-10-26 15:54:26
d2b091571da224a1b36412c18bc3bbfe,2017-09-18 14:31:30,2017-09-18 14:31:30
72ae281627a6102d9b3718528b420f8a,2018-02-03 20:37:35,2018-02-03 20:37:35
62b423aab58096ca514ba6aa06be2f98,2018-08-09 11:44:40,2018-08-09 

2025-01-21 14:45:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:45:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:45:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:45:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:45:16 - snowflake.connector.connection - INFO - closed
2025-01-21 14:45:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:45:52 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 14:45:52 - root - INFO - ```sql
SELECT 
    o."customer_id",
    COUNT(DISTINCT o."order_id") AS "number_of_orders",
    AVG(p."payment_value") AS "average_payment_per_order",
    CASE
        WHEN (DATEDIFF('day', 
                       MIN(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')), 
                       MAX(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) + 1) < 7 THEN 1.0
        ELSE ROUND(
            (DATEDIFF('day', 
                      MIN(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')), 
                      MAX(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) + 1) / 7.0,
            2)
    END AS "lifespan_in_weeks"
FROM 
    E_COMMERCE.E_COMMERCE.ORDERS o
JOIN 
    E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p 
    ON o."order_id" = p."order_id"
WHERE 
    TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS') IS NOT NULL
GROUP BY 
    o."customer_id"
ORDER BY 
    "average_payment_per_order" DESC
LIMIT 3;
```
2025-01-21 14:45:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:45:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:45:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:45:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-21 14:45:54 - snowflake.connector.connection - INFO - closed
2025-01-21 14:45:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:46:40 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 14:46:40 - root - INFO - SQL:
SELECT 
    o."customer_id",
    COUNT(DISTINCT o."order_id") AS "number_of_orders",
    AVG(p."payment_value") AS "average_payment_per_order",
    CASE
        WHEN (DATEDIFF('day', 
                       MIN(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')), 
                       MAX(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) + 1) < 7 THEN 1.0
        ELSE ROUND(
            (DATEDIFF('day', 
                      MIN(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')), 
                      MAX(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) + 1) / 7.0,
            2)
    END AS "lifespan_in_weeks"
FROM 
    E_COMMERCE.E_COMMERCE.ORDERS o
JOIN 
    E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p 
    ON o."order_id" = p."order_id"
WHERE 
    TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS') IS NOT NULL
GROUP BY 
    o."customer_id"
ORDER BY 
    "average_payment_per_order" DESC
LIMIT 3;
Results:
customer_id,number_of_orders,average_payment_per_order,lifespan_in_weeks
1617b1357756262bfa56ab541c47bc16,1,13664.08,1.00
ec5b2ba62e574342386871631fafd3fc,1,7274.88,1.00
c6e2731c5b391845f6800c97401a43a9,1,6929.31,1.00

2025-01-21 14:46:40 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:46:40 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:46:40 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:46:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 14:46:41 - snowflake.connector.connection - INFO - closed
2025-01-21 14:46:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:46:42 - root - INFO - SQL:
-- 11. Calculate the lifespan in weeks for each customer, setting it to 1.0 if less than one week (first 100 customers)
SELECT "customer_id",
       CASE
           WHEN (DATEDIFF('day',
                          MIN(TRY_TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')),
                          MAX(TRY_TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) + 1) < 7 THEN 1.0
           ELSE ROUND(
               (DATEDIFF('day',
                          MIN(TRY_TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')),
                          MAX(TRY_TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) + 1) / 7.0,
               2)
       END AS "lifespan_in_weeks"
FROM E_COMMERCE.E_COMMERCE.ORDERS
WHERE TRY_TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS') IS NOT NULL
GROUP BY "customer_id"
LIMIT 100
Results:
customer_id,lifespan_in_weeks
9ef432eb6251297304e76186b10a928d,1.00
b0830fb4747a6c6d20dea0b8c802d7ef,1.00
41ce2a54c0b03bf3443c3d931a367089,1.00
f88197465ea7920adcdbec7375364d82,1.00
8ab97904e6daea8866dbdbc4fb7aad2c,1.00
503740e9ca751ccdda7ba28e9ab8f608,1.00
ed0271e0b7da060a393796590e7b737a,1.00
9bdf08b4b3b52b5526ff42d37d47f222,1.00
31ad1d1b63eb9962463f764d4e6e0c9d,1.00
494dded5b201313c64ed7f100595b95c,1.00
d3e3b74c766bc6214e0c830b17ee2341,1.00
19402a48fe860416adf93348aba37740,1.00
3b6828a50ffe546942b7a473d70ac0fc,1.00
738b086814c6fcc74b8cc583f8516ee3,1.00
3187789bec990987628d7a9beb4dd6ac,1.00
059f7fc5719c7da6cbafe370971a8d70,1.00
7e20bf5ca92da68200643bda76c504c6,1.00
456dc10730fbdba34615447ea195d643,1.00
816f8653d5361cbf94e58c33f2502a5c,1.00
cf8ffeddf027932e51e4eae73b384059,1.00
295ae9b35379e077273387ff64354b6f,1.00
8644be24d48806bc3a88fd59fb47ceb1,1.00
756fb9391752dad934e0fe3733378e57,1.00
f178c1827f67a8467b0385b7378d951a,1.00
911e4c37f5cafe1604fe6767034bf1ae,1.00
9916715c2ab6ee1710c9c32f0a534ad2,1.00
5dda11942d4f77bee3a46d71e442aec4,1.00
be8c14c16a4d47194ccdfe10f1fc5b1a,1.00
f5618502bee8eafdee72fb6955e2ebdf,1.00
a90391a47de936d56c66a5366cba1462,1.00
3135962ee745ef39b85576df7ddbaa99,1.00
c622b892a190735ef81c0087973fa16d,1.00
c39bde0d4030d5e31e654f0c20db9786,1.00
4924a47e8cd5630b3564e26fac55c5ec,1.00
15bea20cd005ed59d34db54c6b32ec98,1.00
52006a9383bf149a4fb24226b173106f,1.00
c1ddb7521d14db9071dccad0a94305c2,1.00
4fa1cd166fa598be6de80fa84eaade43,1.00
a166da34890074091a942054b36e4265,1.00
5f16605299d698660e0606f7eae2d2f9,1.00
3391c4bc11a817e7973e498b0b023158,1.00
ddaff536587109b89777e0353215e150,1.00
caded193e8e47b8362864762a83db3c5,1.00
12fd2740039676063a874b9567dfa651,1.00
684fa6da5134b9e4dab731e00011712d,1.00
bb2f5e670f7155dc622c57e4b31d0a69,1.00
f26a435864aebedff7f7c84f82ee229f,1.00
bf141bf67fbe428d558bcf0e018eab60,1.00
b673f0597cb0c4d12778f731045f361a,1.00
fb9590a1e30e0ba8304ea73a31325797,1.00
dd854e24b40e3bc2b306946dee252015,1.00
61449fa1b8b8998c9c3f3a7f0ae954ef,1.00
d68901955dc622165460ba6cb4ac49f3,1.00
167b9485947ed0a354a3f8dad04eb199,1.00
7251aa758779438faea714941f1051c4,1.00
d4cd9729eeca5306a2c039fe6e55601e,1.00
9b18f3fc296990b97854e351334a32f6,1.00
cc3590e4afbb4b3e056b50a80a6a7d0c,1.00
818596f5b68adfe2c11498ebb6d39e02,1.00
cf9e2b07f78cce347089900f49fb4746,1.00
a8b396cd7edcd4340e02a07685084cd6,1.00
aa3d8c9eec8e52e90b117efe5e97a560,1.00
f54a9f0e6b351c431402b8461ea51999,1.00
3df704f53d3f1d4818840b34ec672a9f,1.00
7f8c8b9c2ae27bf3300f670c3d478be8,1.00
d2b091571da224a1b36412c18bc3bbfe,1.00
72ae281627a6102d9b3718528b420f8a,1.00
62b423aab58096ca514ba6aa06be2f98,1.00
8b212b9525f9e74e85e37ed6df37693e,1.00
cce89a605105b148387c52e286ac8335,1.00
761df82feda9778854c6dafdaeb567e4,1.00
d9ef95f98d8da3b492bb8c0447910498,1.00
f5458ddc3545711efa883dd7ae7c4497,1.00
4f28355e5c17a4a42d3ce2439a1d4501,1.00
4632eb5a8f175f6fe020520ae0c678f3,1.00
81e08b08e5ed4472008030d70327c71f,1.00
a9d37ddc8ba4d9f6dbac7d8ec378cc95,1.00
55e6b290205c84ddd23ddf5eb134efd4,1.00
1833a0540067becaf59368fe4cd4303a,1.00
0bf19317b1830a69e55b40710576aa7a,1.00
803ac05904124294f8767894d6da532b,1.00
fc849c5fbc7e2b0c7cfebc138886c693,1.00
9e3a06f863456c3934b9d26037c119cd,1.00
328d7a69cb9cbaf088eed3ed778804bb,1.00
1755fad7863475346bc6c3773fe055d3,1.00
3a874b4d4c4b6543206ff5d89287f0c3,1.00
7f2178c5d771e17f507d3c1637339298,1.00
148348ff65384b4249b762579532e248,1.00
79183cd650e2bb0d475b0067d45946ac,1.00
2932d241d1f31e6df6c701d52370ae02,1.00
74805bc388861fa350ed2fade8444e0b,1.00
636e15840ab051faa13d3f781b6e4233,1.00
05e996469a2bf9559c7122b87e156724,1.00
5bb39c890c91b1d26801aa19a9336eac,1.00
8628fac2267e8c8804525da99c10ed0e,1.00
332df68ccac2f2f7d9e11299188f8bce,1.00
68451b39b1314302c08c65a29f1140fc,1.00
d2a79636084590b7465af8ab374a8cf5,1.00
b896b244963dc7543d400ad82d6710e0,1.00
d4faa220408c20e53595d2950f361f3b,1.00

2025-01-21 14:46:42 - root - INFO - itercount: 0
2025-01-21 14:46:42 - root - INFO - Database Name: E_COMMERCE
Schema Name: E_COMMERCE
DDL describes table information.
,0
table_name,LEADS_QUALIFIED
description,
DDL,"create or replace TABLE LEADS_QUALIFIED (
	""mql_id"" VARCHAR(16777216),
	""first_contact_date"" VARCHAR(16777216),
	""landing_page_id"" VARCHAR(16777216),
	""origin"" VARCHAR(16777216)
);"

,1
table_name,GEOLOCATION
description,
DDL,"create or replace TABLE GEOLOCATION (
	""geolocation_zip_code_prefix"" NUMBER(38,0),
	""geolocation_lat"" FLOAT,
	""geolocation_lng"" FLOAT,
	""geolocation_city"" VARCHAR(16777216),
	""geolocation_state"" VARCHAR(16777216)
);"

,2
table_name,LEADS_CLOSED
description,
DDL,"create or replace TABLE LEADS_CLOSED (
	""mql_id"" VARCHAR(16777216),
	""seller_id"" VARCHAR(16777216),
	""sdr_id"" VARCHAR(16777216),
	""sr_id"" VARCHAR(16777216),
	""won_date"" VARCHAR(16777216),
	""business_segment"" VARCHAR(16777216),
	""lead_type"" VARCHAR(16777216),
	""lead_behaviour_profile"" VARCHAR(16777216),
	""has_company"" FLOAT,
	""has_gtin"" FLOAT,
	""average_stock"" VARCHAR(16777216),
	""business_type"" VARCHAR(16777216),
	""declared_product_catalog_size"" FLOAT,
	""declared_monthly_revenue"" FLOAT
);"

,3
table_name,ORDER_ITEMS
description,
DDL,"create or replace TABLE ORDER_ITEMS (
	""order_id"" VARCHAR(16777216),
	""order_item_id"" NUMBER(38,0),
	""product_id"" VARCHAR(16777216),
	""seller_id"" VARCHAR(16777216),
	""shipping_limit_date"" VARCHAR(16777216),
	""price"" FLOAT,
	""freight_value"" FLOAT
);"

,4
table_name,SELLERS
description,
DDL,"create or replace TABLE SELLERS (
	""seller_id"" VARCHAR(16777216),
	""seller_zip_code_prefix"" NUMBER(38,0),
	""seller_city"" VARCHAR(16777216),
	""seller_state"" VARCHAR(16777216)
);"

,5
table_name,CUSTOMERS
description,
DDL,"create or replace TABLE CUSTOMERS (
	""customer_id"" VARCHAR(16777216),
	""customer_unique_id"" VARCHAR(16777216),
	""customer_zip_code_prefix"" NUMBER(38,0),
	""customer_city"" VARCHAR(16777216),
	""customer_state"" VARCHAR(16777216)
);"

,6
table_name,ORDER_REVIEWS
description,
DDL,"create or replace TABLE ORDER_REVIEWS (
	""review_id"" VARCHAR(16777216),
	""order_id"" VARCHAR(16777216),
	""review_score"" NUMBER(38,0),
	""review_comment_title"" VARCHAR(16777216),
	""review_comment_message"" VARCHAR(16777216),
	""review_creation_date"" VARCHAR(16777216),
	""review_answer_timestamp"" VARCHAR(16777216)
);"

,7
table_name,PRODUCTS
description,
DDL,"create or replace TABLE PRODUCTS (
	""product_id"" VARCHAR(16777216),
	""product_category_name"" VARCHAR(16777216),
	""product_name_lenght"" FLOAT,
	""product_description_lenght"" FLOAT,
	""product_photos_qty"" FLOAT,
	""product_weight_g"" FLOAT,
	""product_length_cm"" FLOAT,
	""product_height_cm"" FLOAT,
	""product_width_cm"" FLOAT
);"

,8
table_name,PRODUCT_CATEGORY_NAME_TRANSLATION
description,
DDL,"create or replace TABLE PRODUCT_CATEGORY_NAME_TRANSLATION (
	""product_category_name"" VARCHAR(16777216),
	""product_category_name_english"" VARCHAR(16777216)
);"

,9
table_name,ORDERS
description,
DDL,"create or replace TABLE ORDERS (
	""order_id"" VARCHAR(16777216),
	""customer_id"" VARCHAR(16777216),
	""order_status"" VARCHAR(16777216),
	""order_purchase_timestamp"" VARCHAR(16777216),
	""order_approved_at"" VARCHAR(16777216),
	""order_delivered_carrier_date"" VARCHAR(16777216),
	""order_delivered_customer_date"" VARCHAR(16777216),
	""order_estimated_delivery_date"" VARCHAR(16777216)
);"

,10
table_name,ORDER_PAYMENTS
description,
DDL,"create or replace TABLE ORDER_PAYMENTS (
	""order_id"" VARCHAR(16777216),
	""payment_sequential"" NUMBER(38,0),
	""payment_type"" VARCHAR(16777216),
	""payment_installments"" NUMBER(38,0),
	""payment_value"" FLOAT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'E_COMMERCE': {'E_COMMERCE': ['CUSTOMERS', 'GEOLOCATION', 'LEADS_CLOSED', 'LEADS_QUALIFIED', 'ORDERS', 'ORDER_ITEMS', 'ORDER_PAYMENTS', 'ORDER_REVIEWS', 'PRODUCTS', 'PRODUCT_CATEGORY_NAME_TRANSLATION', 'SELLERS']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **CUSTOMERS**
  - `"customer_id"`: Unique identifier for each customer; used to link customers to their orders.
- **ORDERS**
  - `"order_id"`: Unique identifier for each order; used to link orders to payments.
  - `"customer_id"`: Associates orders with customers.
  - `"order_purchase_timestamp"`: Timestamp when the order was made; used to calculate customer lifespan.
- **ORDER_PAYMENTS**
  - `"order_id"`: Links payments to orders.
  - `"payment_value"`: Amount paid for each order; used to calculate total and average payments per customer.

**Potential Conditions:**

- Join **ORDERS** and **CUSTOMERS** on `"customer_id"` to get all orders for each customer.
- Join **ORDER_PAYMENTS** and **ORDERS** on `"order_id"` to get payment details for each order.
- Calculate the total number of orders and total payment per customer.
- Calculate the average payment per order for each customer.
- Calculate the customer's lifespan based on their first and last `"order_purchase_timestamp"`.
- When calculating lifespan in weeks, set it to `1.0` if it's less than one week.
- Identify the top 3 customers with the highest average payment per order.

**SQL Queries:**

```sql
-- 1. List the first 100 customers
SELECT "customer_id", "customer_unique_id", "customer_city", "customer_state"
FROM E_COMMERCE.E_COMMERCE.CUSTOMERS
LIMIT 100;

-- 2. List the first 100 orders
SELECT "order_id", "customer_id", "order_purchase_timestamp", "order_status"
FROM E_COMMERCE.E_COMMERCE.ORDERS
LIMIT 100;

-- 3. List the first 100 order payments
SELECT "order_id", "payment_type", "payment_installments", "payment_value"
FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS
LIMIT 100;

-- 4. View distinct payment types
SELECT DISTINCT "payment_type"
FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS
LIMIT 100;

-- 5. Count the number of orders per customer (first 100 customers)
SELECT "customer_id", COUNT("order_id") AS "number_of_orders"
FROM E_COMMERCE.E_COMMERCE.ORDERS
GROUP BY "customer_id"
LIMIT 100;

-- 6. Calculate the total payment per order (first 100 orders)
SELECT "order_id", SUM("payment_value") AS "total_payment"
FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS
GROUP BY "order_id"
LIMIT 100;

-- 7. Calculate the total payment per customer (first 100 customers)
SELECT o."customer_id", SUM(p."payment_value") AS "total_payment"
FROM E_COMMERCE.E_COMMERCE.ORDERS o
JOIN E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p ON o."order_id" = p."order_id"
GROUP BY o."customer_id"
LIMIT 100;

-- 8. Calculate the average payment per order for each customer (first 100 customers)
SELECT o."customer_id", AVG(p."payment_value") AS "average_payment_per_order"
FROM E_COMMERCE.E_COMMERCE.ORDERS o
JOIN E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p ON o."order_id" = p."order_id"
GROUP BY o."customer_id"
LIMIT 100;

-- 9. Find the earliest and latest order dates for each customer (first 100 customers)
SELECT "customer_id",
       MIN("order_purchase_timestamp") AS "first_order_date",
       MAX("order_purchase_timestamp") AS "last_order_date"
FROM E_COMMERCE.E_COMMERCE.ORDERS
GROUP BY "customer_id"
LIMIT 100;

-- 10. Calculate the lifespan in days for each customer (first 100 customers)
SELECT "customer_id",
       DATEDIFF(day, MIN("order_purchase_timestamp"), MAX("order_purchase_timestamp")) AS "lifespan_days"
FROM E_COMMERCE.E_COMMERCE.ORDERS
GROUP BY "customer_id"
LIMIT 100;

-- 11. Calculate the lifespan in weeks for each customer, setting it to 1.0 if less than one week (first 100 customers)
SELECT "customer_id",
       CASE
           WHEN DATEDIFF(week, MIN("order_purchase_timestamp"), MAX("order_purchase_timestamp")) < 1 THEN 1.0
           ELSE DATEDIFF(week, MIN("order_purchase_timestamp"), MAX("order_purchase_timestamp"))::FLOAT
       END AS "lifespan_in_weeks"
FROM E_COMMERCE.E_COMMERCE.ORDERS
GROUP BY "customer_id"
LIMIT 100;

-- 12. Identify the top 3 customers with the highest average payment per order
SELECT o."customer_id",
       COUNT(o."order_id") AS "number_of_orders",
       AVG(p."payment_value") AS "average_payment_per_order"
FROM E_COMMERCE.E_COMMERCE.ORDERS o
JOIN E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p ON o."order_id" = p."order_id"
GROUP BY o."customer_id"
ORDER BY "average_payment_per_order" DESC
LIMIT 3;

-- 13. Sample order purchase timestamps to understand the date format
SELECT DISTINCT "order_purchase_timestamp"
FROM E_COMMERCE.E_COMMERCE.ORDERS
LIMIT 100;

-- 14. List the payment values for orders (first 100 entries)
SELECT "order_id", "payment_value"
FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS
LIMIT 100;

-- 15. Count the total number of customers
SELECT COUNT(DISTINCT "customer_id") AS "total_customers"
FROM E_COMMERCE.E_COMMERCE.CUSTOMERS;

-- 16. Count the total number of orders
SELECT COUNT(DISTINCT "order_id") AS "total_orders"
FROM E_COMMERCE.E_COMMERCE.ORDERS;

-- 17. View the distribution of payment installments
SELECT "payment_installments", COUNT(*) AS "count"
FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS
GROUP BY "payment_installments"
ORDER BY "count" DESC
LIMIT 100;

-- 18. Aggregate payment values by payment type (first 100 entries)
SELECT "payment_type", SUM("payment_value") AS "total_payment"
FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS
GROUP BY "payment_type"
LIMIT 100;

-- 19. List customers along with their city and state (first 100 customers)
SELECT "customer_id", "customer_city", "customer_state"
FROM E_COMMERCE.E_COMMERCE.CUSTOMERS
LIMIT 100;

-- 20. Display orders with their status and associated payment values (first 100 orders)
SELECT o."order_id", o."order_status", p."payment_value"
FROM E_COMMERCE.E_COMMERCE.ORDERS o
JOIN E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p ON o."order_id" = p."order_id"
LIMIT 100;
```

These queries help in understanding the data and extracting the necessary information to compute the number of orders, average payment per order, and customer lifespan in weeks for the top 3 customers with the highest average payment per order.

**Note:** Since the `"order_purchase_timestamp"` is stored as a `VARCHAR`, date functions like `DATEDIFF` assume the timestamps are in a standard format (e.g., ISO 8601). If the format is different, you may need to parse or cast the timestamps appropriately.Query:
-- 1. List the first 100 customers
SELECT "customer_id", "customer_unique_id", "customer_city", "customer_state"
FROM E_COMMERCE.E_COMMERCE.CUSTOMERS
LIMIT 100
Answer:
Too long, hard cut:
customer_id,customer_unique_id,customer_city,customer_state
06b8999e2fba1a1fbc88172c00ba8bc7,861eff4711a542e4b93843c6dd7febb0,franca,SP
18955e83d337fd6b2def6b18a428ac77,290c77bc529b7ac935b93aa66c333dc3,sao bernardo do campo,SP
4e7b3e00288586ebd08712fdd0374a03,060e732b5b29e8181a18229c7b0b2b5e,sao paulo,SP
b2b6027bc5c5109e529d4dc6358b12c3,259dac757896d24d7702b9acbbff3f3c,mogi das cruzes,SP
4f2d8ab171c80ec8364f7c12e35b23ad,345ecd01c38d18a9036ed96c73b8d066,campinas,SP
879864dab9bc3047522c92c82e1212b8,4c93744516667ad3b8f1fb645a3116a4,jaragua do sul,SC
fd826e7cf63160e536e0908c76c3f441,addec96d2e059c80c30fe6871d30d177,sao paulo,SP
5e274e7a0c3809e14aba7ad5aae0d407,57b2a98a409812fe9618067b6b8ebe4f,timoteo,MG
5adf08e34b2e993982a47070956c5c65,1175e95fb47ddff9de6b2b06188f7e0d,curitiba,PR
4b7139f34592b3a31687243a302fa75b,9afe194fb833f79e300e37e580171f22,belo horizonte,MG
9fb35e4ed6f0a14a4977cd9aea4042bb,2a7745e1ed516b289ed9b29c7d0539a5,montes claros,MG
5aa9e4fdd4dfd20959cad2d772509598,2a46fb94aef5cbeeb850418118cee090,rio de janeiro,RJ
b2d1536598b73a9abd18e0d75d92f0a3,918dc87cd72cd9f6ed4bd442ed785235,lencois paulista,SP
eabebad39a88bb6f5b52376faec28612,295c05e81917928d76245e842748184d,sao paulo,SP
1f1c7bf1c9b041b292af6c1c4470b753,3151a81801c8386361b62277d7fa5ecf,caxias do sul,RS
206f3129c0e4d7d0b9550426023f0a08,21f748a16f4e1688a9014eb3ee6fa325,piracicaba,SP
a7c125a0a07b75146167b7f04a7f8e98,5c2991dbd08bbf3cf410713c4de5a0b5,rio de janeiro,RJ
c5c61596a3b6bd0cee5766992c48a9a1,b6e99561fe6f34a55b0b7da92f8ed775,guarulhos,SP
9b8ce803689b3562defaad4613ef426f,7f3a72e8f988c6e735ba118d54f47458,sao paulo,SP
49d0ea0986edde72da777f15456a0ee0,3e6fd6b2f0d499456a6a6820a40f2d79,pacaja,PA
154c4ded6991bdfa3cd249d11abf4130,e607ede0e63436308660236f5a52da5e,florianopolis,SC
690172ab319622688d3b4df42f676898,a96d5cfa0d3181817e2b946f921ea021,aparecida de goiania,GO
2938121a40a20953c43caa8c98787fcb,482441ea6a06b1f72fe9784756c0ea75,sao paulo,SP
237098a64674ae89babdc426746260fc,4390ddbb6276a66ff1736a6710205dca,curitiba,PR
cb721d7b4f271fd87011c4c83462c076,a5844ba4bfc8d0cc61d13027c7e63bcc,sao paulo,SP
f681356046d9fde60e70c73a18d65ea2,5f102dd37243f152aec3607970aad100,santo andre,SP
167bd30a409e3e4127df5a9408ebd394,9c0096673baf55453a50073f12d1a37f,goiania,GO
6e359a57a91f84095cc64e1b351aef8c,2e6a42a9b5cbb0da62988694f18ee295,sao paulo,SP
e0eea8f69a457b3f1fa246e44c9ebefd,4d221875624017bc47b4d1ce7314a5b7,cachoeiro de itapemirim,ES
e3109970a3fe8021d5ff82c577ce5606,a8654e2af5da6bb72f52c22b164855e1,sao paulo,SP
261cb4f92498ca05d5bd1a327a261d9c,424aca6872c5bab80780a8dec03b7516,sao jose dos campos,SP
6f92779347724b67e44e3224f3b4cffd,bf4862777db128507e9efcc789215e9b,sao roque,SP
2d5831cb2dff7cdefba62e950ae3dc7b,e9dd12dca17352644a959d9dea133935,camacari,BA
b2bed119388167a954382cca36c4777f,e079b18794454de9d2be5c12b4392294,resende,RJ
469634941c27cd844170935a3cf60b95,ef07ba9aa5226f77264ffa5762b2280b,curitiba,PR
df0aa5b8586495e0ddf6b601122e43a1,85d234692f7bee8d6fea586e237334b6,sumare,SP
41c8f4b570869791379a925899a6af8a,fe3634ccefbcdb0537b45fd589e32e8e,guarulhos,SP
54f755c3fd2709231f9964a1430c5218,40febde16f4718a5def537786473b0be,novo hamburgo,RS
4c06b42fbf7b97ab10779cda5549cd1c,07d190f123147d9e89d4b922543d7948,sao luis,MA
b6368ca0f56d4632f44d58ca431487b2,dd992305cba295d997f263dbdf4e8c2e,sao jose,SC
4a0e66fd30684aa1409cd1b66fec77cc,86085586aaa8c5f47ed0b400da64c59d,guarulhos,SP
c168abb9077b7821adae01dc1f0886c5,5ad58a4e6a1a656b6bed070cadbaa003,santa barbara,MG
a3b0fda37bae14cf754877bed475e80c,c9158d089637ab443c78984d20da7fc0,sao paulo,SP
0ccd415657ae8a6cd1c71b00155a019e,66cc90195ca44cc7ac6a1cd0e1e1e7b2,guarulhos,SP
c532a74a3ebf1bacce2e2bcce3783317,91ec50a00ae74d0a229d2efdf4344e1e,ribeirao preto,SP
19cecb194f54e614b70d971306a9931b,d251c190ca75786e9ab937982d60d1d4,belo horizonte,MG
f34a6e874087ec1f0e3dab9fdf659c5d,233896de79986082f1f479f1f85281cb,ituiutaba,MG
c132855c926907970dcf6f2bf0b33a24,a8ae36a2bb6c2bbc3b5d62ede131c9ef,taquarituba,SP
df85b96ba2ce3e49bde101b1614f52ac,8d46223c91cbeb93e0930ca8bd8ffca2,sao jose dos pinhais,PR
4d27341acd30a36bca39008ee9bb9050,e021e698833bdeb89dfef3acb2e91f37,jaragua do sul,SC
d3b6830d18c7de943d1e707d1f061d40,27cf4b153010911a0957150255a6c6db,sao paulo,SP
79de53946db384e2d7a9bd131792ad17,7ce5b57a120a2da6a804afa58ffcbfb5,montes claros,MG
a562ab1e728449e3461829dfe2e36f73,d33eeadf54cb883e79be640f38c32cdc,barrinha,SP
b64ed91eab98972150bdaf77ca921934,3da7750bf3c1dbd724624a60a9f5942b,rio de janeiro,RJ
8247b5583327ab8be19f96e1fb82f77b,d85547cd859833520b311b4458a14c1c,parati,RJ
8fcaa9368903f3a9a28aeaff28c14638,3af0b2f7654f613ff1527b997a2ac57e,dourados,MS
a9b0d1c26105279e1b8edc63d06bd668,3d49f4455a3947c8dd7e972b3ad8cb76,sao paulo,SP
aa9f03ecd3728c9bd12e6d962c66c7cb,b03e9d9818ee170e9d6b983803c7d406,trindade,GO
230c0d740401730c7197d16376893525,a302a693d5722d95984e6472150b9391,cascavel,PR
a905baa530258422594f1b05615bd225,c80da60feddb7cf8325bd104032e314a,fortaleza,CE
4fa19f7da692e6bf9602aaad3c372eda,a2b8841410cf77619574d311cd06fd5e,brasilia,DF
03f846ad034
Query:
-- 2. List the first 100 orders
SELECT "order_id", "customer_id", "order_purchase_timestamp", "order_status"
FROM E_COMMERCE.E_COMMERCE.ORDERS
LIMIT 100
Answer:
Too long, hard cut:
order_id,customer_id,order_purchase_timestamp,order_status
e481f51cbdc54678b7cc49136f2d6af7,9ef432eb6251297304e76186b10a928d,2017-10-02 10:56:33,delivered
53cdb2fc8bc7dce0b6741e2150273451,b0830fb4747a6c6d20dea0b8c802d7ef,2018-07-24 20:41:37,delivered
47770eb9100c2d0c44946d9cf07ec65d,41ce2a54c0b03bf3443c3d931a367089,2018-08-08 08:38:49,delivered
949d5b44dbf5de918fe9c16f97b45f8a,f88197465ea7920adcdbec7375364d82,2017-11-18 19:28:06,delivered
ad21c59c0840e6cb83a9ceb5573f8159,8ab97904e6daea8866dbdbc4fb7aad2c,2018-02-13 21:18:39,delivered
a4591c265e18cb1dcee52889e2d8acc3,503740e9ca751ccdda7ba28e9ab8f608,2017-07-09 21:57:05,delivered
136cce7faa42fdb2cefd53fdc79a6098,ed0271e0b7da060a393796590e7b737a,2017-04-11 12:22:08,invoiced
6514b8ad8028c9f2cc2374ded245783f,9bdf08b4b3b52b5526ff42d37d47f222,2017-05-16 13:10:30,delivered
76c6e866289321a7c93b82b54852dc33,f54a9f0e6b351c431402b8461ea51999,2017-01-23 18:29:09,delivered
e69bfb5eb88e0ed6a785585b27e16dbf,31ad1d1b63eb9962463f764d4e6e0c9d,2017-07-29 11:55:02,delivered
e6ce16cb79ec1d90b1da9085a6118aeb,494dded5b201313c64ed7f100595b95c,2017-05-16 19:41:10,delivered
34513ce0c4fab462a55830c0989c7edb,7711cf624183d843aafe81855097bc37,2017-07-13 19:58:11,delivered
82566a660a982b15fb86e904c8d32918,d3e3b74c766bc6214e0c830b17ee2341,2018-06-07 10:06:19,delivered
5ff96c15d0b717ac6ad1f3d77225a350,19402a48fe860416adf93348aba37740,2018-07-25 17:44:10,delivered
432aaf21d85167c2c86ec9448c4e42cc,3df704f53d3f1d4818840b34ec672a9f,2018-03-01 14:14:28,delivered
dcb36b511fcac050b97cd5c05de84dc3,3b6828a50ffe546942b7a473d70ac0fc,2018-06-07 19:03:12,delivered
403b97836b0c04a622354cf531062e5f,738b086814c6fcc74b8cc583f8516ee3,2018-01-02 19:00:43,delivered
116f0b09343b49556bbad5f35bee0cdf,3187789bec990987628d7a9beb4dd6ac,2017-12-26 23:41:31,delivered
85ce859fd6dc634de8d2f1e290444043,059f7fc5719c7da6cbafe370971a8d70,2017-11-21 00:03:41,delivered
83018ec114eee8641c97e08f7b4e926f,7f8c8b9c2ae27bf3300f670c3d478be8,2017-10-26 15:54:26,delivered
203096f03d82e0dffbc41ebc2e2bcfb7,d2b091571da224a1b36412c18bc3bbfe,2017-09-18 14:31:30,delivered
f848643eec1d69395095eb3840d2051e,4fa1cd166fa598be6de80fa84eaade43,2018-03-15 08:52:40,delivered
2807d0e504d6d4894d41672727bc139f,72ae281627a6102d9b3718528b420f8a,2018-02-03 20:37:35,delivered
95266dbfb7e20354baba07964dac78d5,a166da34890074091a942054b36e4265,2018-01-08 07:55:29,delivered
f3e7c359154d965827355f39d6b1fdac,62b423aab58096ca514ba6aa06be2f98,2018-08-09 11:44:40,delivered
fbf9ac61453ac646ce8ad9783d7d0af6,3a874b4d4c4b6543206ff5d89287f0c3,2018-02-20 23:46:53,delivered
acce194856392f074dbf9dada14d8d82,7e20bf5ca92da68200643bda76c504c6,2018-06-04 00:00:13,delivered
dd78f560c270f1909639c11b925620ea,8b212b9525f9e74e85e37ed6df37693e,2018-03-12 01:50:26,delivered
91b2a010e1e45e6ba3d133fa997597be,cce89a605105b148387c52e286ac8335,2018-05-02 11:45:38,delivered
ecab90c9933c58908d3d6add7c6f5ae3,761df82feda9778854c6dafdaeb567e4,2018-02-25 13:50:30,delivered
f70a0aff17df5a6cdd9a7196128bd354,456dc10730fbdba34615447ea195d643,2017-08-10 11:58:33,delivered
1790eea0b567cf50911c057cf20f90f9,52142aa69d8d0e1247ab0cada0f76023,2018-04-16 21:15:39,delivered
989225ba6d0ebd5873335f7e01de2ae7,816f8653d5361cbf94e58c33f2502a5c,2017-12-12 13:56:04,delivered
d887b52c6516beb39e8cd44a5f8b60f7,d9ef95f98d8da3b492bb8c0447910498,2018-02-03 12:38:58,delivered
b276e4f8c0fb86bd82fce576f21713e0,cf8ffeddf027932e51e4eae73b384059,2018-07-29 23:34:51,delivered
8563039e855156e48fccee4d611a3196,5f16605299d698660e0606f7eae2d2f9,2018-02-17 15:59:46,delivered
60550084e6b4c0cb89a87df1f3e5ebd9,f5458ddc3545711efa883dd7ae7c4497,2018-02-21 18:15:12,delivered
5acce57f8d9dfd55fa48e212a641a69d,295ae9b35379e077273387ff64354b6f,2017-07-31 21:37:10,delivered
434d158e96bdd6972ad6e6d73ddcfd22,2a1dfb647f32f4390e7b857c67458536,2018-06-01 12:23:13,delivered
7206b86ea789983f7a273ea7fa0bc2a8,3391c4bc11a817e7973e498b0b023158,2018-03-26 17:12:18,delivered
1e7aff52cdbb2451ace09d0f848c3699,ddaff536587109b89777e0353215e150,2017-05-19 18:53:40,delivered
6ea2f835b4556291ffdc53fa0b3b95e8,c7340080e394356141681bd4c9b8fe31,2017-11-24 21:27:48,delivered
948097deef559c742e7ce321e5e58919,8644be24d48806bc3a88fd59fb47ceb1,2017-08-04 17:10:39,delivered
d22e9fa5731b9e30e8b27afcdc2f8563,756fb9391752dad934e0fe3733378e57,2018-08-04 23:25:30,delivered
ee64d42b8cf066f35eac1cf57de1aa85,caded193e8e47b8362864762a83db3c5,2018-06-04 16:44:48,shipped
6ebaec694d7025e2ad4a05dba887c032,4f28355e5c17a4a42d3ce2439a1d4501,2017-05-18 13:55:47,delivered
d17dc4a904426827ca80f2ccb3a6be56,569cf68214806a39acc0f39344aea67f,2017-05-14 20:28:25,delivered
25f4376934e13d3508486352e11a5db0,12fd2740039676063a874b9567dfa651,2018-05-17 16:59:11,delivered
5820a1100976432c7968a52da59e9364,2b56e94c2f66f2d97cfa63356f69cee8,2018-07-29 11:24:17,delivered
2ce1ad82022c1ba30c2079502ac725aa,7f2178c5d771e17f507d3c1637339298,2017-08-09 20:19:05,delivered
138849fd84dff2fb4ca70a0a34c4aa1c,9b18f3fc296990b97854e351334a32f6,2018-02-01 14:02:19,delivered
47aa4816b27ba60ec948cd019cc1afc1,148348ff65384b4
Query:
-- 3. List the first 100 order payments
SELECT "order_id", "payment_type", "payment_installments", "payment_value"
FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS
LIMIT 100
Answer:
Too long, hard cut:
order_id,payment_type,payment_installments,payment_value
b81ef226f3fe1789b1e8b2acac839d17,credit_card,8,99.33
a9810da82917af2d9aefd1278f1dcfa0,credit_card,1,24.39
25e8ea4e93396b6fa0d3dd708e76c1bd,credit_card,1,65.71
ba78997921bbcdc1373bb41e913ab953,credit_card,8,107.78
42fdf880ba16b47b59251dd489d4441a,credit_card,2,128.45
298fcdf1f73eb413e4d26d01b25bc1cd,credit_card,2,96.12
771ee386b001f06208a7419e4fc1bbd7,credit_card,1,81.16
3d7239c394a212faae122962df514ac7,credit_card,3,51.84
1f78449c87a54faf9e96e88ba1491fa9,credit_card,6,341.09
0573b5e23cbd798006520e1d5b4c6714,boleto,1,51.95
d88e0d5fa41661ce03cf6cf336527646,credit_card,8,188.73
2480f727e869fdeb397244a21b721b67,credit_card,1,141.9
616105c9352a9668c38303ad44e056cd,credit_card,1,75.78
cf95215a722f3ebf29e6bbab87a29e61,credit_card,5,102.66
769214176682788a92801d8907fa1b40,credit_card,4,105.28
12e5cfe0e4716b59afb0e0f4a3bd6570,credit_card,10,157.45
61059985a6fc0ad64e95d9944caacdad,credit_card,1,132.04
79da3f5fe31ad1e454f06f95dc032ad5,credit_card,1,98.94
8ac09207f415d55acff302df7d6a895c,credit_card,4,244.15
b2349a3f20dfbeef62e7b31baa22f84b,credit_card,3,136.71
5a1f6d22f7dfb061ef29216b9af687a1,credit_card,4,47.69
4214cda550ece8ee66441f459dc33a8c,credit_card,2,170.57
adfbf6c2a620196f9a3ec747491c72b7,credit_card,4,67.5
4d680edbaa7d3d9bed69532957368a03,credit_card,10,353.09
8cd68144cdb62dc0d60848cf8616d2a4,boleto,1,330.66
5cfd514482e22bc992e7693f0e3e8df7,voucher,1,45.17
d0a945f85ba1074b60aac97ade7e240e,credit_card,2,541.0
c39414c195d0f94c9d9c35e7c6ed4f1a,credit_card,2,139.22
5d9c5817e278892b7498d90bfa28ade8,credit_card,2,290.16
b69b9260e79a0da00e15f48de1bd2524,boleto,1,283.34
f45074ae38f2e01d9b854ec8d40362ff,credit_card,1,13.78
81cedc4d2132eb6f512354166e51b187,credit_card,1,30.28
595f598849d89203c28d05d0fbf3f92e,credit_card,1,26.58
f9d0ec2fa088ac583e1ccd15b6686073,credit_card,1,89.68
e647bf617de735448a4ba54f8910393c,credit_card,1,65.09
b2bb080b6bc860118a246fd9b6fad6da,credit_card,1,173.84
23f10f509600c30cf2852f9dbdf28fc3,credit_card,1,103.49
f86f6472fa9f395d8d9a6751ca118afb,credit_card,1,64.03
1dcf0c8cd36ffaf57784fbdc90079310,credit_card,3,157.15
00d8d65b666158b633f96054d31af43b,boleto,1,130.88
cf30fe76d1505192acee1c6dccb15545,credit_card,2,47.72
d3e774a185c0b1b2286ffd6c70abe2e6,credit_card,8,117.74
32b1d8f3789a57f1f752e20ac7404b4c,boleto,1,56.6
c10d412026c4077b8e83acf0fea04eee,credit_card,1,266.16
56c3277583e16009c925fdf116df420f,boleto,1,31.38
0e0441786430b7cfcd0d91f822ea4c99,credit_card,1,121.49
6ffb3f1686bceae3466facf7e02ce3fb,credit_card,1,32.0
afef48d3c8a0b1b7c9b7f8f922fb5674,credit_card,5,153.41
c0db7d31ace61fc360a3eaa34dd3457c,credit_card,5,65.71
d574338f566ca28dd67820f48ec1f1d8,credit_card,4,278.22
1807cc736321f14baa58ef39cf6e5989,credit_card,4,91.66
e8977f709bbb0367f51b589e6325f991,credit_card,1,132.51
2e2c60b99754ae1e4d8b18846cfec9f2,credit_card,4,542.66
1ffb3c1929b16d9c1aec1958e11b3e9b,boleto,1,166.04
95442deb81a5d91c97c0df96b431634a,boleto,1,368.98
10af96a0689260134307879127ac1952,credit_card,2,113.2
85eef2d342b0de363c45c1bc324729c5,credit_card,3,99.43
aa964845f1de8125410aea8b73e9e1ec,credit_card,2,27.35
343348b1e29e9fa9e7b6ab1027f9177d,credit_card,4,43.77
ad4098a257676ea4d394fb3bbbf36ca3,credit_card,2,68.49
3e0c3cab458e8b3cc8d1d38ecb7e7775,credit_card,2,105.53
3ab4eea6776259ae8dfbabaeffece352,credit_card,8,387.8
10d9871bed9fb8d0887d3b9022edd1ff,boleto,1,84.14
c108072ab31ec90a754129c171577f5f,credit_card,4,210.82
fc662bafa52d2ef16078f6f6141009d6,boleto,1,90.05
4217849b1ff18a9270fe048eabc4dc45,credit_card,1,67.88
795c16acb4e3c30dfa5b6827727ef488,credit_card,2,37.58
55e2d723733c45033e71cb4d44690234,boleto,1,89.63
947e9c6bfd83a06953c420ef92d3da6e,voucher,1,69.46
60e43c5f5ba559d9dd19357ed72cb2f2,credit_card,2,78.3
e3e9e3295f4e1512167c232a0aaae8a5,voucher,1,50.8
460d57443ffdcaeba240360239747cf7,credit_card,1,34.0
4cb51127f19f7254b320efe1718477dd,boleto,1,77.1
110d9355d6338eab0a65a0cacdde5434,credit_card,5,566.4
42f5954cda381bd032934ee38c453711,credit_card,8,402.42
3689194c14ad4e2e7361ebd1df0e77b0,voucher,1,57.53
97c111c4f22dfa1089a9c0b5338dcc79,credit_card,3,44.01
4b2d035932915aa9c2a0d4d84cd6d3b0,credit_card,3,187.51
e1b4ee0e390fbac1dec439d72b45a115,credit_card,3,77.7
fee72a68ce935ebf2939fe72f27d3d9b,credit_card,1,48.68
4d3bfdf4c7d6578ea445d588371ae10e,credit_card,1,77.29
4c2e1a95586c815795a324d1599e7b5a,credit_card,8,117.71
c9f23db8a1cb725df9bdb3383bd72b38,credit_card,3,169.34
8e47a04b25d7a7075064e8e0bd2e0318,credit_card,1,37.61
723e462ce1ee50e024887c0b403130f3,credit_card,1,13.8
fa2ea4b6e84c1c0fc4f3a6d468c55183,debit_card,1,227.12
fb1a2a1296f822405a946cbdfc0d3ed6,credit_card,3,34.78
198298d54f269d8c5fe89e85a859af61,credit_card,10,342.56
b19ca559688b49e8cf7f88c1aa3f0009,credit_card,7,73.34
5be8d4719fe2e3669e2d07dddf3b6b0c,credit_card,4,117.85
4a02e985c7239d866a632f07ed20d9c0,credit_card,1,48.62
3e17eef8a8bd0131c7aed90d7508799e,credit_card,1,53.99
f8d323a2702fed37f0229965f7e9f8b3,credit_card,1,51.14
de4090fd9b7900d46323b0c7c36b7128,credit_card,2,121.45
17e51
Query:
-- 4. View distinct payment types
SELECT DISTINCT "payment_type"
FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS
LIMIT 100
Answer:
payment_type
credit_card
boleto
voucher
debit_card
not_defined
Query:
-- 5. Count the number of orders per customer (first 100 customers)
SELECT "customer_id", COUNT("order_id") AS "number_of_orders"
FROM E_COMMERCE.E_COMMERCE.ORDERS
GROUP BY "customer_id"
LIMIT 100
Answer:
customer_id,number_of_orders
9ef432eb6251297304e76186b10a928d,1
b0830fb4747a6c6d20dea0b8c802d7ef,1
41ce2a54c0b03bf3443c3d931a367089,1
f88197465ea7920adcdbec7375364d82,1
8ab97904e6daea8866dbdbc4fb7aad2c,1
503740e9ca751ccdda7ba28e9ab8f608,1
ed0271e0b7da060a393796590e7b737a,1
9bdf08b4b3b52b5526ff42d37d47f222,1
f54a9f0e6b351c431402b8461ea51999,1
31ad1d1b63eb9962463f764d4e6e0c9d,1
494dded5b201313c64ed7f100595b95c,1
7711cf624183d843aafe81855097bc37,1
d3e3b74c766bc6214e0c830b17ee2341,1
19402a48fe860416adf93348aba37740,1
3b6828a50ffe546942b7a473d70ac0fc,1
3187789bec990987628d7a9beb4dd6ac,1
059f7fc5719c7da6cbafe370971a8d70,1
d2b091571da224a1b36412c18bc3bbfe,1
4fa1cd166fa598be6de80fa84eaade43,1
72ae281627a6102d9b3718528b420f8a,1
a166da34890074091a942054b36e4265,1
8b212b9525f9e74e85e37ed6df37693e,1
52142aa69d8d0e1247ab0cada0f76023,1
816f8653d5361cbf94e58c33f2502a5c,1
cf8ffeddf027932e51e4eae73b384059,1
f5458ddc3545711efa883dd7ae7c4497,1
295ae9b35379e077273387ff64354b6f,1
2a1dfb647f32f4390e7b857c67458536,1
3391c4bc11a817e7973e498b0b023158,1
8644be24d48806bc3a88fd59fb47ceb1,1
caded193e8e47b8362864762a83db3c5,1
12fd2740039676063a874b9567dfa651,1
9b18f3fc296990b97854e351334a32f6,1
67407057a7d5ee17d1cd09523f484d13,1
81e08b08e5ed4472008030d70327c71f,1
be8c14c16a4d47194ccdfe10f1fc5b1a,1
55e6b290205c84ddd23ddf5eb134efd4,1
636e15840ab051faa13d3f781b6e4233,1
9f6618c17568ac301465fe7ad056c674,1
df9b032b2ad0fd6bf37dfb48e5f83845,1
48558a50a7ba1aab61891936d2ca7681,1
2e068340b3037f667ce3224bd59260af,1
6feea03756fd7ef4fb37d8f7e44aaeb9,1
e42998ccffc48dc87bf70b37e2d61f33,1
3a017955f82b5bf61bb51aec865a01ca,1
64d181ef52b1829800c598942459061b,1
738b086814c6fcc74b8cc583f8516ee3,1
3a874b4d4c4b6543206ff5d89287f0c3,1
7e20bf5ca92da68200643bda76c504c6,1
79183cd650e2bb0d475b0067d45946ac,1
684fa6da5134b9e4dab731e00011712d,1
b673f0597cb0c4d12778f731045f361a,1
82f0b75bb50fcb30711e5277e36b3983,1
167b9485947ed0a354a3f8dad04eb199,1
5883f965ac70043c2e908c3657c5d548,1
4dafe3c841d2d6cc8a8b6d25b35704b9,1
c1ddb7521d14db9071dccad0a94305c2,1
0dd5a932b1e29daa12845dbf696cbb54,1
8458f7ae02bda5950ce48c01a720559a,1
c178d6d544925594fafab0ba493cd645,1
9a80c8377644236e27f59e83862f1ae2,1
15bea20cd005ed59d34db54c6b32ec98,1
d0e6cb83a3fc27f56be011b2941f54c6,1
c40c7807639289e3f1308ac6e5bc104f,1
3df704f53d3f1d4818840b34ec672a9f,1
cce89a605105b148387c52e286ac8335,1
148348ff65384b4249b762579532e248,1
f5afca14dfa9dc64251cf2b45c54c363,1
241e78de29b3090cfa1b5d73a8130c72,1
4632eb5a8f175f6fe020520ae0c678f3,1
c77ee2d8ba1614a4d489a44166894938,1
a9d37ddc8ba4d9f6dbac7d8ec378cc95,1
a90391a47de936d56c66a5366cba1462,1
05e996469a2bf9559c7122b87e156724,1
f26a435864aebedff7f7c84f82ee229f,1
bf141bf67fbe428d558bcf0e018eab60,1
3a897024068ed42a183de61d5727d866,1
332df68ccac2f2f7d9e11299188f8bce,1
d4faa220408c20e53595d2950f361f3b,1
65ee4aa816cda8ad41e05c75e1cb691e,1
7f8c8b9c2ae27bf3300f670c3d478be8,1
62b423aab58096ca514ba6aa06be2f98,1
456dc10730fbdba34615447ea195d643,1
d9ef95f98d8da3b492bb8c0447910498,1
5f16605299d698660e0606f7eae2d2f9,1
ddaff536587109b89777e0353215e150,1
c7340080e394356141681bd4c9b8fe31,1
756fb9391752dad934e0fe3733378e57,1
4f28355e5c17a4a42d3ce2439a1d4501,1
7f2178c5d771e17f507d3c1637339298,1
f178c1827f67a8467b0385b7378d951a,1
2932d241d1f31e6df6c701d52370ae02,1
911e4c37f5cafe1604fe6767034bf1ae,1
9916715c2ab6ee1710c9c32f0a534ad2,1
afb19a4b667cb708caab312757ec3d3f,1
fee181bf648906d1c57f84f216976286,1
93ada7a24817edda9f4ab998fa823d16,1
64fb950e760ec8b0db79154a1fa9c1bf,1
8628fac2267e8c8804525da99c10ed0e,1
3135962ee745ef39b85576df7ddbaa99,1
Query:
-- 6. Calculate the total payment per order (first 100 orders)
SELECT "order_id", SUM("payment_value") AS "total_payment"
FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS
GROUP BY "order_id"
LIMIT 100
Answer:
order_id,total_payment
b81ef226f3fe1789b1e8b2acac839d17,99.33
a9810da82917af2d9aefd1278f1dcfa0,24.39
25e8ea4e93396b6fa0d3dd708e76c1bd,65.71
ba78997921bbcdc1373bb41e913ab953,107.78
298fcdf1f73eb413e4d26d01b25bc1cd,96.12
771ee386b001f06208a7419e4fc1bbd7,81.16
1f78449c87a54faf9e96e88ba1491fa9,341.09
0573b5e23cbd798006520e1d5b4c6714,51.95
d88e0d5fa41661ce03cf6cf336527646,188.73
2480f727e869fdeb397244a21b721b67,141.9
616105c9352a9668c38303ad44e056cd,75.78
769214176682788a92801d8907fa1b40,105.28
79da3f5fe31ad1e454f06f95dc032ad5,98.94
8ac09207f415d55acff302df7d6a895c,244.15
5a1f6d22f7dfb061ef29216b9af687a1,47.69
4214cda550ece8ee66441f459dc33a8c,170.57
4d680edbaa7d3d9bed69532957368a03,353.09
5d9c5817e278892b7498d90bfa28ade8,290.16
f45074ae38f2e01d9b854ec8d40362ff,13.78
81cedc4d2132eb6f512354166e51b187,30.28
f9d0ec2fa088ac583e1ccd15b6686073,89.68
23f10f509600c30cf2852f9dbdf28fc3,103.49
cf30fe76d1505192acee1c6dccb15545,47.72
0e0441786430b7cfcd0d91f822ea4c99,121.49
6ffb3f1686bceae3466facf7e02ce3fb,32.0
1807cc736321f14baa58ef39cf6e5989,91.66
10af96a0689260134307879127ac1952,113.2
85eef2d342b0de363c45c1bc324729c5,99.43
3e0c3cab458e8b3cc8d1d38ecb7e7775,105.53
795c16acb4e3c30dfa5b6827727ef488,37.58
e3e9e3295f4e1512167c232a0aaae8a5,50.8
42f5954cda381bd032934ee38c453711,402.42
c9f23db8a1cb725df9bdb3383bd72b38,169.34
fb1a2a1296f822405a946cbdfc0d3ed6,34.78
b19ca559688b49e8cf7f88c1aa3f0009,73.34
4a02e985c7239d866a632f07ed20d9c0,48.62
46ee6eaca194413758f200a6974b7e4d,71.99
a490a5d59a9bf4ef3334bfd7cf1dbdfc,17.78
c1b770015e27aaf2b475026989d04fe0,137.73
d087b8e096ca051f548e29b324272834,72.05
5cfd514482e22bc992e7693f0e3e8df7,710.5799999999999
f86f6472fa9f395d8d9a6751ca118afb,64.03
d3e774a185c0b1b2286ffd6c70abe2e6,117.74
56c3277583e16009c925fdf116df420f,31.38
afef48d3c8a0b1b7c9b7f8f922fb5674,153.41
2e2c60b99754ae1e4d8b18846cfec9f2,542.66
343348b1e29e9fa9e7b6ab1027f9177d,43.77
97c111c4f22dfa1089a9c0b5338dcc79,44.01
4b2d035932915aa9c2a0d4d84cd6d3b0,187.51
e1b4ee0e390fbac1dec439d72b45a115,77.7
f8d323a2702fed37f0229965f7e9f8b3,51.14
3ba2d0012b1f34bc6ccbc31c4ba69f93,60.07
96de2b7f7f3c401fbee3eef068376da6,32.15
f090de1b2ed9f4e251662cb31e3c7127,27.63
2ccde1e4676c20b9444e2bcbed36334c,134.56
68d7420c86be23f313c81a554320f986,121.88
a5f860aaf6a3c35399495aefe92d363f,75.75
55779fa8fe072d9f8c92d672154558f2,233.66
845af9472cc76e66fbf445931b511755,123.41
67c8c2016ddabf0059783eb44e921f99,68.54
332c6742772f2df936696b6512b10edb,143.25
27a7ac440630f9de788e4d66e72c6424,186.39
e6670c9089973cc68e5b90b7d1f4fec4,88.49
aa7c35fd606f4275e267e859c6a84d0f,26.68
3d7239c394a212faae122962df514ac7,51.84
cf95215a722f3ebf29e6bbab87a29e61,102.66
12e5cfe0e4716b59afb0e0f4a3bd6570,157.45
61059985a6fc0ad64e95d9944caacdad,132.04
8cd68144cdb62dc0d60848cf8616d2a4,330.66
c39414c195d0f94c9d9c35e7c6ed4f1a,139.22
e647bf617de735448a4ba54f8910393c,65.09
aa964845f1de8125410aea8b73e9e1ec,27.35
ad4098a257676ea4d394fb3bbbf36ca3,68.49
4217849b1ff18a9270fe048eabc4dc45,67.88
55e2d723733c45033e71cb4d44690234,89.63
4c2e1a95586c815795a324d1599e7b5a,117.71
723e462ce1ee50e024887c0b403130f3,113.8
198298d54f269d8c5fe89e85a859af61,342.56
20f136d890c31a62486c809f91a5b098,117.68
cf61ad2218e5c14397e7c0ba7a6a50f9,35.14
99bc267f49d76932cd195bfb2a94dd03,163.08
aa600269bffea363cca75ad2d1908903,93.26
57e4fc8f20507381b3f7abbe4e2ccda3,215.56
ae1126b6891f58552443772c80b1f562,133.81
42fdf880ba16b47b59251dd489d4441a,128.45
adfbf6c2a620196f9a3ec747491c72b7,67.5
d0a945f85ba1074b60aac97ade7e240e,541.0
595f598849d89203c28d05d0fbf3f92e,26.58
b2bb080b6bc860118a246fd9b6fad6da,197.92000000000002
32b1d8f3789a57f1f752e20ac7404b4c,56.6
c0db7d31ace61fc360a3eaa34dd3457c,65.71
d574338f566ca28dd67820f48ec1f1d8,278.22
e8977f709bbb0367f51b589e6325f991,132.51
95442deb81a5d91c97c0df96b431634a,368.98
fc662bafa52d2ef16078f6f6141009d6,90.05
947e9c6bfd83a06953c420ef92d3da6e,69.46
60e43c5f5ba559d9dd19357ed72cb2f2,78.3
460d57443ffdcaeba240360239747cf7,34.0
4d3bfdf4c7d6578ea445d588371ae10e,77.29
8e47a04b25d7a7075064e8e0bd2e0318,37.61
Query:
-- 7. Calculate the total payment per customer (first 100 customers)
SELECT o."customer_id", SUM(p."payment_value") AS "total_payment"
FROM E_COMMERCE.E_COMMERCE.ORDERS o
JOIN E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p ON o."order_id" = p."order_id"
GROUP BY o."customer_id"
LIMIT 100
Answer:
customer_id,total_payment
0a8556ac6be836b46b3e89920d59291c,99.33
f2c7fc58a9de810828715166c672f10a,24.39
a24e6f72471e9dbafcb292bc318f4859,96.12
c4e17eff78176dfe3401f03db0346f85,51.95
94967f1e8a9ea8ec6c7129f098f32155,141.9
8c0b2ef9efb43af92d5c0afff70d33d9,75.78
2b01b5fb8141bbb9fcdc853a0e26da83,105.28
4c7ef01bf8ed05e43a5e9e44bb08358e,47.69
be4ecdb7c9401fd98ed01456634cfcb2,170.57
5b670130533827957619dfe306899fdd,67.5
1444f701e835b7d189637c10f5287e76,353.09
c03b40c7971bc52b3d018247891270c5,330.66
d036487ffd91aa5b2f21e17f2bb83543,13.78
a8f6bb35d78515a1762eb626d52b6352,30.28
ce6d32fa00bbae809e07c14126e5fa6e,64.03
c3d06eb8905fc0c39966b0a57ee7244c,31.38
f1220b145cc86460b4276b9b3e23e57d,121.49
d990663a73af8129834fca277b4743ca,27.35
73e4f0d08b9eaf4009d3218057343b5a,78.3
31f9366e8fbe2412ddbae2d9c49d8adf,77.7
7badbcce7da90b7920997ddbac3187b5,77.29
b5d838521379fbc2a2e8c3f360f57e01,227.12
ff93b4413884cd9b2d851e9133d8c1ab,34.09
6de980369453bc98c75da669412a0e85,348.02
fe0c5425832ac53c3be5cb4aea25b60f,188.73
0ff24a24edd69d8774270ac863c8e230,136.71
b583a7efe4522c8ce8942bd47f33d487,290.16
11440840f5653ebba13e919285c71389,65.09
34955e04695a861e22cfc5600244118d,157.15
4e2311c6a3b9c353851097a679ede20a,266.16
15e65458c1de2332a93656f2272c808e,166.04
daddb546b42f656e57ba8a3cf71a309f,368.98
2737211835d5ea370af15ee145f7840c,69.46
2514a33b1704c36bdfbe51840e105cde,34.0
2d1276417ffab1c174139789098cecc3,77.1
2346308634084083a80df78332c411dc,48.68
8d4fd10d20cdc0fa3589cfdee2b1cb07,342.56
a97f15194f6fc81433e550a34dec906a,53.99
b78f37cd0654fbbf35c5277b24936535,56.77
eec30b788184a6d93954fd5e82c48add,32.15
e2bea5774e2c8aa227075fc4d2c3ba39,40.99
27a2735706788ec6d39d0de52ce2457b,71.99
0f687ed7edef79545319e147f39a290a,47.0
d49bac4ac7d77b956f2b185ab700fbf1,231.45
84e14521bff8cbb289a87be1961d3d08,144.2
ab2b94cec822788e131f15e0033544cf,27.63
a10c24a3a00d939852f086c7162e564d,134.56
a3343433090af3beb34febb7899bf0ee,96.98
b8fc2edd015cea8b8cd1f308c30541fd,267.05
54efba24ef631ff2c2088f8320499ea5,48.61
55d6fe64c9ff321e925f284f7e0d69d8,125.53
d50a8dc7e28e47e8119560e53b1c7deb,44.35
61260c512475ab1d7519b332199e8c1d,213.9
e957d597f76d275f40a848397fb6c7c3,362.17
ad5eaed951a10f80d09e7f473a8fd08e,103.79
4068269eb194e5957c5b2abce6939ee4,49.7
680e38a70d371582570f41cc47dc2791,285.79
b0c22a057e308ffdd32ce03e1734aa62,404.88
bf0b4acdb6eb69084a7714bf7cc748f0,54.85
3d3e7494fc24a4f50a6bff232428f8fe,44.83
f5025a3893cbcdd251b06c0b3f7451da,52.529999999999994
ae6a20cbef31289987c08cdc617a19ac,256.37
047c4f9e8ca120c41c8d4a61df722ea2,102.26
79bdc6288517cb7f94c86be6c97b7ba7,127.53
381aee1e9f4b0395a780330fab335b03,91.66
017395cf7b4c0be4fa72650f0a8184ed,43.77
1353b6db7e448ecfad1a4cd13b95f832,113.8
92f70647283582ec50ca1bb5794f6c90,107.72
58d45cf285d3d5bdd45609c696e00b9e,46.63
90cf9029b6b6b9469c7f0f9c82a59da3,52.21
519a8af813fe88578029697625439e8b,710.5799999999999
4a44c8f258b8780e1da133c1f1c39854,541.0
f9bdbea246da607ab4641959ba6aa32f,34.78
e46db370a98dec564da620109436f09a,117.68
bdbf22817eb36add4815586f4957adb1,88.49
8e5b95cc9167186235d12c22e7d79015,81.78
1387e2d23533abc24be58c9b3a1f06b9,17.78
c7ada2a2ca6ff94ccc7bbd16af1dec55,61.77
b7d2c0ccf5e66c2d1c496d6a8250eae4,31.0
58b3208913cae35dadfac41929721901,116.05
79e2cae59c2216c721c54ff9c53ad657,85.14
7ac0cc6086ab6987cb2bf47141b2288a,180.55
bf372d35de99f49cb07c1a238d7db256,26.08
12ea47b284521261ac272de65bbb3506,375.74
4ed6dff46316b8f7e80d1972f27ca39f,33.13
b755c5f04fe5e214d68445fb210d512a,142.04000000000002
810923268bc2be268d447dd5c892a5ce,348.77
ffc2f51857cae8a61ec9f9a15c7861c8,77.77
8978d77f12a2fc5b1890c49b39dd288a,26.68
4304f16b63cae276cb72b52baeb978cf,50.09
d4fcd56a6eb869293c5da42565707dd9,89.88
9a6fb2784ae4acd6acca8b15eae329e3,48.22
ee2de94f683ada4fc7ff42ddc0482a08,67.58
bbf02c631b2d633a8532316e697e71b4,69.33
f68313aa890cb1f32ea402439c6f1c4d,106.96
b7f69471fed8a036911323fca290a2c2,132.51
76382f6496effe36685eb200ef95b3ac,50.8
7c6a9e2bdbb00e3007395f1ce3bda802,402.42
ef82ec18f684c8b9f44339a739570043,57.53
a086fa78ca272b05a6404f91bb04928c,186.72
Query:
-- 8. Calculate the average payment per order for each customer (first 100 customers)
SELECT o."customer_id", AVG(p."payment_value") AS "average_payment_per_order"
FROM E_COMMERCE.E_COMMERCE.ORDERS o
JOIN E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p ON o."order_id" = p."order_id"
GROUP BY o."customer_id"
LIMIT 100
Answer:
customer_id,average_payment_per_order
0a8556ac6be836b46b3e89920d59291c,99.33
f2c7fc58a9de810828715166c672f10a,24.39
a24e6f72471e9dbafcb292bc318f4859,96.12
c4e17eff78176dfe3401f03db0346f85,51.95
94967f1e8a9ea8ec6c7129f098f32155,141.9
8c0b2ef9efb43af92d5c0afff70d33d9,75.78
2b01b5fb8141bbb9fcdc853a0e26da83,105.28
4c7ef01bf8ed05e43a5e9e44bb08358e,47.69
be4ecdb7c9401fd98ed01456634cfcb2,170.57
5b670130533827957619dfe306899fdd,67.5
1444f701e835b7d189637c10f5287e76,353.09
c03b40c7971bc52b3d018247891270c5,330.66
d036487ffd91aa5b2f21e17f2bb83543,13.78
a8f6bb35d78515a1762eb626d52b6352,30.28
ce6d32fa00bbae809e07c14126e5fa6e,64.03
c3d06eb8905fc0c39966b0a57ee7244c,31.38
f1220b145cc86460b4276b9b3e23e57d,121.49
d990663a73af8129834fca277b4743ca,27.35
73e4f0d08b9eaf4009d3218057343b5a,78.3
31f9366e8fbe2412ddbae2d9c49d8adf,77.7
7badbcce7da90b7920997ddbac3187b5,77.29
b5d838521379fbc2a2e8c3f360f57e01,227.12
ff93b4413884cd9b2d851e9133d8c1ab,34.09
6de980369453bc98c75da669412a0e85,348.02
fe0c5425832ac53c3be5cb4aea25b60f,188.73
0ff24a24edd69d8774270ac863c8e230,136.71
b583a7efe4522c8ce8942bd47f33d487,290.16
11440840f5653ebba13e919285c71389,65.09
34955e04695a861e22cfc5600244118d,157.15
4e2311c6a3b9c353851097a679ede20a,266.16
15e65458c1de2332a93656f2272c808e,166.04
daddb546b42f656e57ba8a3cf71a309f,368.98
2737211835d5ea370af15ee145f7840c,69.46
2514a33b1704c36bdfbe51840e105cde,34.0
2d1276417ffab1c174139789098cecc3,77.1
2346308634084083a80df78332c411dc,48.68
8d4fd10d20cdc0fa3589cfdee2b1cb07,342.56
a97f15194f6fc81433e550a34dec906a,53.99
b78f37cd0654fbbf35c5277b24936535,56.77
eec30b788184a6d93954fd5e82c48add,32.15
e2bea5774e2c8aa227075fc4d2c3ba39,40.99
27a2735706788ec6d39d0de52ce2457b,71.99
0f687ed7edef79545319e147f39a290a,47.0
d49bac4ac7d77b956f2b185ab700fbf1,231.45
84e14521bff8cbb289a87be1961d3d08,144.2
ab2b94cec822788e131f15e0033544cf,27.63
a10c24a3a00d939852f086c7162e564d,134.56
a3343433090af3beb34febb7899bf0ee,96.98
b8fc2edd015cea8b8cd1f308c30541fd,267.05
54efba24ef631ff2c2088f8320499ea5,48.61
55d6fe64c9ff321e925f284f7e0d69d8,125.53
d50a8dc7e28e47e8119560e53b1c7deb,44.35
61260c512475ab1d7519b332199e8c1d,213.9
e957d597f76d275f40a848397fb6c7c3,362.17
ad5eaed951a10f80d09e7f473a8fd08e,103.79
4068269eb194e5957c5b2abce6939ee4,49.7
680e38a70d371582570f41cc47dc2791,285.79
b0c22a057e308ffdd32ce03e1734aa62,404.88
bf0b4acdb6eb69084a7714bf7cc748f0,54.85
3d3e7494fc24a4f50a6bff232428f8fe,44.83
f5025a3893cbcdd251b06c0b3f7451da,26.264999999999997
ae6a20cbef31289987c08cdc617a19ac,256.37
047c4f9e8ca120c41c8d4a61df722ea2,102.26
79bdc6288517cb7f94c86be6c97b7ba7,127.53
381aee1e9f4b0395a780330fab335b03,91.66
017395cf7b4c0be4fa72650f0a8184ed,43.77
1353b6db7e448ecfad1a4cd13b95f832,56.9
92f70647283582ec50ca1bb5794f6c90,21.544
58d45cf285d3d5bdd45609c696e00b9e,46.63
90cf9029b6b6b9469c7f0f9c82a59da3,52.21
519a8af813fe88578029697625439e8b,355.28999999999996
4a44c8f258b8780e1da133c1f1c39854,541.0
f9bdbea246da607ab4641959ba6aa32f,34.78
e46db370a98dec564da620109436f09a,117.68
bdbf22817eb36add4815586f4957adb1,88.49
8e5b95cc9167186235d12c22e7d79015,81.78
1387e2d23533abc24be58c9b3a1f06b9,17.78
c7ada2a2ca6ff94ccc7bbd16af1dec55,61.77
b7d2c0ccf5e66c2d1c496d6a8250eae4,31.0
58b3208913cae35dadfac41929721901,116.05
79e2cae59c2216c721c54ff9c53ad657,85.14
7ac0cc6086ab6987cb2bf47141b2288a,180.55
bf372d35de99f49cb07c1a238d7db256,26.08
12ea47b284521261ac272de65bbb3506,375.74
4ed6dff46316b8f7e80d1972f27ca39f,33.13
b755c5f04fe5e214d68445fb210d512a,47.34666666666667
810923268bc2be268d447dd5c892a5ce,348.77
ffc2f51857cae8a61ec9f9a15c7861c8,77.77
8978d77f12a2fc5b1890c49b39dd288a,26.68
4304f16b63cae276cb72b52baeb978cf,25.045
d4fcd56a6eb869293c5da42565707dd9,89.88
9a6fb2784ae4acd6acca8b15eae329e3,48.22
ee2de94f683ada4fc7ff42ddc0482a08,67.58
bbf02c631b2d633a8532316e697e71b4,69.33
f68313aa890cb1f32ea402439c6f1c4d,106.96
b7f69471fed8a036911323fca290a2c2,132.51
76382f6496effe36685eb200ef95b3ac,50.8
7c6a9e2bdbb00e3007395f1ce3bda802,402.42
ef82ec18f684c8b9f44339a739570043,57.53
a086fa78ca272b05a6404f91bb04928c,186.72
Query:
-- 9. Find the earliest and latest order dates for each customer (first 100 customers)
SELECT "customer_id",
       MIN("order_purchase_timestamp") AS "first_order_date",
       MAX("order_purchase_timestamp") AS "last_order_date"
FROM E_COMMERCE.E_COMMERCE.ORDERS
GROUP BY "customer_id"
LIMIT 100
Answer:
Too long, hard cut:
customer_id,first_order_date,last_order_date
8ab97904e6daea8866dbdbc4fb7aad2c,2018-02-13 21:18:39,2018-02-13 21:18:39
503740e9ca751ccdda7ba28e9ab8f608,2017-07-09 21:57:05,2017-07-09 21:57:05
a166da34890074091a942054b36e4265,2018-01-08 07:55:29,2018-01-08 07:55:29
caded193e8e47b8362864762a83db3c5,2018-06-04 16:44:48,2018-06-04 16:44:48
9b18f3fc296990b97854e351334a32f6,2018-02-01 14:02:19,2018-02-01 14:02:19
f5afca14dfa9dc64251cf2b45c54c363,2017-12-15 00:06:10,2017-12-15 00:06:10
81e08b08e5ed4472008030d70327c71f,2018-04-22 08:48:13,2018-04-22 08:48:13
be8c14c16a4d47194ccdfe10f1fc5b1a,2018-06-13 13:47:39,2018-06-13 13:47:39
a9d37ddc8ba4d9f6dbac7d8ec378cc95,2018-07-15 08:33:19,2018-07-15 08:33:19
f26a435864aebedff7f7c84f82ee229f,2017-07-30 03:06:35,2017-07-30 03:06:35
7e20bf5ca92da68200643bda76c504c6,2018-06-04 00:00:13,2018-06-04 00:00:13
388025bec8128ff20ec1a316ed4dcf02,2017-04-20 17:15:46,2017-04-20 17:15:46
d0e71d7a6dbca8ac513ac63d08a81fa0,2018-04-25 22:18:10,2018-04-25 22:18:10
5232c22d7ed2b631db6b2cab74b2c5f2,2018-08-01 10:48:19,2018-08-01 10:48:19
5dda11942d4f77bee3a46d71e442aec4,2018-01-07 21:44:54,2018-01-07 21:44:54
e8a332c3433fbd37920ec89fc295d075,2017-09-29 09:32:17,2017-09-29 09:32:17
4c9c7c2b6de6ee2568681b5599bb7495,2018-05-08 22:12:34,2018-05-08 22:12:34
fa5c31ea5a141cb29a683b6420f2693a,2017-09-20 17:12:34,2017-09-20 17:12:34
f7398fc942c8fa80e5419ae52e49f7fb,2018-04-15 19:42:06,2018-04-15 19:42:06
a338f42b6e47cb49d5c5128a348b76ba,2018-05-15 19:55:51,2018-05-15 19:55:51
56dfafb543cfa4c2edcc08b9b2c5f0c6,2017-08-01 18:52:12,2017-08-01 18:52:12
b3519c0352b07bc3017acebea4ce6724,2017-11-16 14:32:06,2017-11-16 14:32:06
7a7893d13f178fdf58daeff7347e2d94,2018-05-08 14:38:14,2018-05-08 14:38:14
ed532487db04478dfba09d112649fc13,2018-02-01 07:47:34,2018-02-01 07:47:34
86acfb656743da0c113d176832c9d535,2018-02-08 18:56:45,2018-02-08 18:56:45
64a254d30eed42cd0e6c36dddb88adf0,2017-11-16 15:09:28,2017-11-16 15:09:28
977275bd3cd425aa9926a3388658f485,2018-03-09 14:58:05,2018-03-09 14:58:05
6ee311afc0adb5663ad53868d46ba39d,2017-11-11 22:16:49,2017-11-11 22:16:49
53379b14e4048e025dc5a2185f461bb7,2018-03-27 22:14:59,2018-03-27 22:14:59
da2fbad9b2235c67c9bc7c7a274ee389,2018-08-03 13:32:54,2018-08-03 13:32:54
b7b15ab12fa50616eee696a22f098e07,2017-01-21 17:08:01,2017-01-21 17:08:01
5d6e19aed6284c2fcb4b1a0eba6820de,2018-08-21 16:45:44,2018-08-21 16:45:44
ffdc2af7160aed3bad21cbc8ec68c0c5,2017-05-20 02:48:00,2017-05-20 02:48:00
5265029daa29cc08d86b9f96cd99d03f,2018-04-18 15:40:36,2018-04-18 15:40:36
bd13582471af02ce718568d9cf8bbd93,2018-03-29 22:46:19,2018-03-29 22:46:19
364fbe9334877bc7ca3da92913b2cdbf,2017-06-02 14:00:19,2017-06-02 14:00:19
610a4163b8ab832daf93b4fbb48e9119,2017-11-19 16:12:34,2017-11-19 16:12:34
2f9902d85fcd930227f711cf47012bdf,2017-05-10 14:03:27,2017-05-10 14:03:27
940526d0df4938d234d0a900268106c4,2017-08-28 22:47:13,2017-08-28 22:47:13
9c338ea8093192e203bc16add78c123c,2017-11-21 12:08:32,2017-11-21 12:08:32
a4156bb8aff5d6722dc68f605d8fa241,2017-09-26 11:08:38,2017-09-26 11:08:38
ddbd5d378c4a0981ba1ef29fb8e40b8f,2017-09-13 15:07:45,2017-09-13 15:07:45
d44c356f894fa28cffe33c455abb72ba,2017-08-17 17:03:31,2017-08-17 17:03:31
24c63a7108d652ad0ed85589c4575297,2018-06-13 22:54:20,2018-06-13 22:54:20
18c934f4cdc994cd04eb13bce3f47a18,2018-02-02 15:26:38,2018-02-02 15:26:38
f31eb05ebdef1ede72cebeba759e7c92,2018-08-06 22:25:10,2018-08-06 22:25:10
021e84751ba0ead75b6d314a6ead88d9,2017-08-01 18:17:41,2017-08-01 18:17:41
1f7945736d0f303827055ca99168ad20,2017-04-03 23:09:50,2017-04-03 23:09:50
016c5c3fb572754f302fdac24aa9cfa4,2018-06-04 08:33:09,2018-06-04 08:33:09
5072cf2f4cbec30b8ba917d5d7b6b125,2017-04-27 14:17:37,2017-04-27 14:17:37
40eb5b16b04bc62c59d4905857958e82,2017-10-31 21:47:13,2017-10-31 21:47:13
e54367d4b00c5cb76d2dfe71b9bdb89c,2018-07-04 16:49:21,2018-07-04 16:49:21
c5064807abdc55acd37860160154ed1a,2018-08-27 13:57:36,2018-08-27 13:57:36
90714b0e62fe1fbd304fb45fd644ebdd,2018-02-24 08:45:01,2018-02-24 08:45:01
17ebae22126d3df35f5e1fa1efedab94,2018-05-17 07:17:54,2018-05-17 07:17:54
5957d9ae822bcbe88c00fb8286362339,2018-03-01 12:43:37,2018-03-01 12:43:37
32fa597a3b06db1949ee96c416335b6b,2018-03-01 20:30:22,2018-03-01 20:30:22
80f70f0ca0bcd19bf71e848e51206d68,2017-07-12 18:45:24,2017-07-12 18:45:24
cb633030180d869d7bb76aa783a78b6d,2017-07-04 23:29:52,2017-07-04 23:29:52
08fe63b02e7e846c85b8a49b9fd540d9,2018-02-15 11:58:49,2018-02-15 11:58:49
99ae056139c928155fbb6789440c8824,2018-07-31 21:51:41,2018-07-31 21:51:41
6c5aeca0152670c75e44c9c67eb7c1f3,2018-01-22 15:24:44,2018-01-22 15:24:44
cb1e2bf26acb98ef66bb11447a218cc2,2017-02-25 14:34:40,2017-02-25 14:34:40
d436bce514752338004b26a232f21008,2018-05-16 13:47:51,2018-05-16 13:47:51
0dae7978fb6595f295dd3fd9ede02cda,2017-06-19 18:00:01,2017-06-19 18:00:01
88196bd808ae8abe1b944efe1807b508,2017-11-19 20:06:12,2017-11-19 20:06:12
af684ccf558442d5fa8d9daa7456ac76,2018-08-02 12:25:18,2018-08-02 12:25:18
f1b66f0324a631de414bc2bf62b5e915,2018-06-23 19:29:12,2018-06-23 
Query:
SELECT 
    o."customer_id",
    COUNT(DISTINCT o."order_id") AS "number_of_orders",
    AVG(p."payment_value") AS "average_payment_per_order",
    CASE
        WHEN DATEDIFF('week', 
                      MIN(TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')), 
                      MAX(TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) < 1 THEN 1.0
        ELSE DATEDIFF('week', 
                      MIN(TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')), 
                      MAX(TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')))
    END AS "lifespan_in_weeks"
FROM 
    E_COMMERCE.E_COMMERCE.ORDERS o
JOIN 
    E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p 
    ON o."order_id" = p."order_id"
GROUP BY 
    o."customer_id"
ORDER BY 
    "average_payment_per_order" DESC
LIMIT 3;
Answer:
customer_id,number_of_orders,average_payment_per_order,lifespan_in_weeks
1617b1357756262bfa56ab541c47bc16,1,13664.08,1
ec5b2ba62e574342386871631fafd3fc,1,7274.88,1
c6e2731c5b391845f6800c97401a43a9,1,6929.31,1
Query:
-- 11. Calculate the lifespan in weeks for each customer, setting it to 1.0 if less than one week (first 100 customers)
SELECT "customer_id",
       CASE
           WHEN DATEDIFF('week',
                         MIN(TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')),
                         MAX(TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) < 1 THEN 1.0
           ELSE DATEDIFF('week',
                         MIN(TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')),
                         MAX(TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')))::FLOAT
       END AS "lifespan_in_weeks"
FROM E_COMMERCE.E_COMMERCE.ORDERS
GROUP BY "customer_id"
LIMIT 100
Answer:
customer_id,lifespan_in_weeks
9ef432eb6251297304e76186b10a928d,1.0
b0830fb4747a6c6d20dea0b8c802d7ef,1.0
41ce2a54c0b03bf3443c3d931a367089,1.0
f88197465ea7920adcdbec7375364d82,1.0
8ab97904e6daea8866dbdbc4fb7aad2c,1.0
503740e9ca751ccdda7ba28e9ab8f608,1.0
ed0271e0b7da060a393796590e7b737a,1.0
9bdf08b4b3b52b5526ff42d37d47f222,1.0
f54a9f0e6b351c431402b8461ea51999,1.0
31ad1d1b63eb9962463f764d4e6e0c9d,1.0
494dded5b201313c64ed7f100595b95c,1.0
7711cf624183d843aafe81855097bc37,1.0
d3e3b74c766bc6214e0c830b17ee2341,1.0
19402a48fe860416adf93348aba37740,1.0
3b6828a50ffe546942b7a473d70ac0fc,1.0
3187789bec990987628d7a9beb4dd6ac,1.0
059f7fc5719c7da6cbafe370971a8d70,1.0
d2b091571da224a1b36412c18bc3bbfe,1.0
4fa1cd166fa598be6de80fa84eaade43,1.0
72ae281627a6102d9b3718528b420f8a,1.0
a166da34890074091a942054b36e4265,1.0
8b212b9525f9e74e85e37ed6df37693e,1.0
52142aa69d8d0e1247ab0cada0f76023,1.0
816f8653d5361cbf94e58c33f2502a5c,1.0
cf8ffeddf027932e51e4eae73b384059,1.0
f5458ddc3545711efa883dd7ae7c4497,1.0
295ae9b35379e077273387ff64354b6f,1.0
2a1dfb647f32f4390e7b857c67458536,1.0
3391c4bc11a817e7973e498b0b023158,1.0
8644be24d48806bc3a88fd59fb47ceb1,1.0
caded193e8e47b8362864762a83db3c5,1.0
12fd2740039676063a874b9567dfa651,1.0
9b18f3fc296990b97854e351334a32f6,1.0
67407057a7d5ee17d1cd09523f484d13,1.0
81e08b08e5ed4472008030d70327c71f,1.0
be8c14c16a4d47194ccdfe10f1fc5b1a,1.0
55e6b290205c84ddd23ddf5eb134efd4,1.0
636e15840ab051faa13d3f781b6e4233,1.0
9f6618c17568ac301465fe7ad056c674,1.0
df9b032b2ad0fd6bf37dfb48e5f83845,1.0
48558a50a7ba1aab61891936d2ca7681,1.0
2e068340b3037f667ce3224bd59260af,1.0
6feea03756fd7ef4fb37d8f7e44aaeb9,1.0
e42998ccffc48dc87bf70b37e2d61f33,1.0
3a017955f82b5bf61bb51aec865a01ca,1.0
64d181ef52b1829800c598942459061b,1.0
738b086814c6fcc74b8cc583f8516ee3,1.0
3a874b4d4c4b6543206ff5d89287f0c3,1.0
7e20bf5ca92da68200643bda76c504c6,1.0
79183cd650e2bb0d475b0067d45946ac,1.0
684fa6da5134b9e4dab731e00011712d,1.0
b673f0597cb0c4d12778f731045f361a,1.0
82f0b75bb50fcb30711e5277e36b3983,1.0
167b9485947ed0a354a3f8dad04eb199,1.0
5883f965ac70043c2e908c3657c5d548,1.0
4dafe3c841d2d6cc8a8b6d25b35704b9,1.0
c1ddb7521d14db9071dccad0a94305c2,1.0
0dd5a932b1e29daa12845dbf696cbb54,1.0
8458f7ae02bda5950ce48c01a720559a,1.0
c178d6d544925594fafab0ba493cd645,1.0
9a80c8377644236e27f59e83862f1ae2,1.0
15bea20cd005ed59d34db54c6b32ec98,1.0
d0e6cb83a3fc27f56be011b2941f54c6,1.0
3df704f53d3f1d4818840b34ec672a9f,1.0
cce89a605105b148387c52e286ac8335,1.0
148348ff65384b4249b762579532e248,1.0
f5afca14dfa9dc64251cf2b45c54c363,1.0
241e78de29b3090cfa1b5d73a8130c72,1.0
4632eb5a8f175f6fe020520ae0c678f3,1.0
c77ee2d8ba1614a4d489a44166894938,1.0
a9d37ddc8ba4d9f6dbac7d8ec378cc95,1.0
a90391a47de936d56c66a5366cba1462,1.0
05e996469a2bf9559c7122b87e156724,1.0
f26a435864aebedff7f7c84f82ee229f,1.0
bf141bf67fbe428d558bcf0e018eab60,1.0
3a897024068ed42a183de61d5727d866,1.0
332df68ccac2f2f7d9e11299188f8bce,1.0
d4faa220408c20e53595d2950f361f3b,1.0
65ee4aa816cda8ad41e05c75e1cb691e,1.0
7f8c8b9c2ae27bf3300f670c3d478be8,1.0
62b423aab58096ca514ba6aa06be2f98,1.0
456dc10730fbdba34615447ea195d643,1.0
d9ef95f98d8da3b492bb8c0447910498,1.0
5f16605299d698660e0606f7eae2d2f9,1.0
ddaff536587109b89777e0353215e150,1.0
c7340080e394356141681bd4c9b8fe31,1.0
756fb9391752dad934e0fe3733378e57,1.0
4f28355e5c17a4a42d3ce2439a1d4501,1.0
7f2178c5d771e17f507d3c1637339298,1.0
f178c1827f67a8467b0385b7378d951a,1.0
2932d241d1f31e6df6c701d52370ae02,1.0
911e4c37f5cafe1604fe6767034bf1ae,1.0
9916715c2ab6ee1710c9c32f0a534ad2,1.0
afb19a4b667cb708caab312757ec3d3f,1.0
fee181bf648906d1c57f84f216976286,1.0
93ada7a24817edda9f4ab998fa823d16,1.0
64fb950e760ec8b0db79154a1fa9c1bf,1.0
8628fac2267e8c8804525da99c10ed0e,1.0
3135962ee745ef39b85576df7ddbaa99,1.0
1833a0540067becaf59368fe4cd4303a,1.0
Query:
-- 12. Identify the top 3 customers with the highest average payment per order
SELECT o."customer_id",
       COUNT(DISTINCT o."order_id") AS "number_of_orders",
       AVG(p."payment_value") AS "average_payment_per_order"
FROM E_COMMERCE.E_COMMERCE.ORDERS o
JOIN E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p ON o."order_id" = p."order_id"
GROUP BY o."customer_id"
ORDER BY "average_payment_per_order" DESC
LIMIT 3
Answer:
customer_id,number_of_orders,average_payment_per_order
1617b1357756262bfa56ab541c47bc16,1,13664.08
ec5b2ba62e574342386871631fafd3fc,1,7274.88
c6e2731c5b391845f6800c97401a43a9,1,6929.31
Query:
-- 13. Sample order purchase timestamps to understand the date format
SELECT DISTINCT "order_purchase_timestamp"
FROM E_COMMERCE.E_COMMERCE.ORDERS
LIMIT 100
Answer:
order_purchase_timestamp
2017-10-02 10:56:33
2018-07-24 20:41:37
2018-08-08 08:38:49
2018-02-13 21:18:39
2017-07-09 21:57:05
2017-04-11 12:22:08
2017-05-16 13:10:30
2017-01-23 18:29:09
2017-07-29 11:55:02
2018-06-07 10:06:19
2018-06-07 19:03:12
2018-01-02 19:00:43
2017-12-26 23:41:31
2017-10-26 15:54:26
2018-01-08 07:55:29
2018-06-04 00:00:13
2018-05-02 11:45:38
2018-02-25 13:50:30
2018-04-16 21:15:39
2018-02-03 12:38:58
2018-02-21 18:15:12
2018-03-26 17:12:18
2017-11-24 21:27:48
2018-06-04 16:44:48
2017-05-18 13:55:47
2018-06-26 13:42:52
2017-08-31 08:15:24
2017-11-30 22:02:15
2018-07-28 16:52:55
2018-08-03 08:59:39
2018-05-14 08:35:33
2018-08-22 16:10:29
2018-04-25 22:18:10
2017-10-19 15:08:48
2018-01-18 09:30:54
2017-12-21 04:59:55
2017-11-18 19:28:06
2018-03-01 14:14:28
2018-03-15 08:52:40
2017-08-10 11:58:33
2018-07-29 11:24:17
2017-09-13 14:27:11
2017-10-16 14:56:50
2018-04-11 22:32:31
2018-03-01 22:14:26
2018-03-31 14:20:46
2018-07-22 15:19:05
2018-01-09 06:37:43
2018-06-08 12:19:58
2017-12-02 14:08:33
2018-02-28 17:00:28
2017-04-20 16:18:26
2018-06-13 13:47:39
2018-07-15 08:33:19
2017-05-09 20:48:59
2017-09-27 12:07:22
2017-11-15 13:47:34
2018-04-04 08:39:50
2017-07-05 09:16:49
2017-06-25 19:30:09
2018-04-16 21:07:16
2018-01-11 16:51:17
2017-11-29 17:43:34
2017-07-13 19:58:11
2017-11-21 00:03:41
2017-09-18 14:31:30
2018-08-09 11:44:40
2018-02-20 23:46:53
2018-03-12 01:50:26
2018-07-29 23:34:51
2017-07-31 21:37:10
2018-08-04 23:25:30
2017-08-09 20:19:05
2018-07-26 14:39:59
2017-12-15 00:06:10
2018-06-11 08:18:19
2017-03-13 18:14:36
2018-08-05 13:09:48
2017-11-15 11:31:41
2018-04-22 08:48:13
2017-02-20 11:45:39
2017-12-08 09:42:43
2018-01-22 19:22:22
2017-09-03 14:22:03
2018-04-09 13:56:45
2017-04-27 11:08:59
2018-05-23 16:37:35
2017-05-16 19:41:10
2017-12-12 13:56:04
2018-06-01 12:23:13
2017-05-19 18:53:40
2017-08-04 17:10:39
2017-05-14 20:28:25
2018-05-17 16:59:11
2018-02-10 13:26:59
2018-02-15 10:33:30
2017-04-20 17:15:46
2017-08-09 18:32:47
2017-12-22 00:17:37
2017-04-20 20:42:44
Query:
-- 14. List the payment values for orders (first 100 entries)
SELECT "order_id", "payment_value"
FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS
LIMIT 100
Answer:
order_id,payment_value
b81ef226f3fe1789b1e8b2acac839d17,99.33
a9810da82917af2d9aefd1278f1dcfa0,24.39
25e8ea4e93396b6fa0d3dd708e76c1bd,65.71
ba78997921bbcdc1373bb41e913ab953,107.78
42fdf880ba16b47b59251dd489d4441a,128.45
298fcdf1f73eb413e4d26d01b25bc1cd,96.12
771ee386b001f06208a7419e4fc1bbd7,81.16
3d7239c394a212faae122962df514ac7,51.84
1f78449c87a54faf9e96e88ba1491fa9,341.09
0573b5e23cbd798006520e1d5b4c6714,51.95
d88e0d5fa41661ce03cf6cf336527646,188.73
2480f727e869fdeb397244a21b721b67,141.9
616105c9352a9668c38303ad44e056cd,75.78
cf95215a722f3ebf29e6bbab87a29e61,102.66
769214176682788a92801d8907fa1b40,105.28
12e5cfe0e4716b59afb0e0f4a3bd6570,157.45
61059985a6fc0ad64e95d9944caacdad,132.04
79da3f5fe31ad1e454f06f95dc032ad5,98.94
8ac09207f415d55acff302df7d6a895c,244.15
b2349a3f20dfbeef62e7b31baa22f84b,136.71
5a1f6d22f7dfb061ef29216b9af687a1,47.69
4214cda550ece8ee66441f459dc33a8c,170.57
adfbf6c2a620196f9a3ec747491c72b7,67.5
4d680edbaa7d3d9bed69532957368a03,353.09
8cd68144cdb62dc0d60848cf8616d2a4,330.66
5cfd514482e22bc992e7693f0e3e8df7,45.17
d0a945f85ba1074b60aac97ade7e240e,541.0
c39414c195d0f94c9d9c35e7c6ed4f1a,139.22
5d9c5817e278892b7498d90bfa28ade8,290.16
b69b9260e79a0da00e15f48de1bd2524,283.34
f45074ae38f2e01d9b854ec8d40362ff,13.78
81cedc4d2132eb6f512354166e51b187,30.28
595f598849d89203c28d05d0fbf3f92e,26.58
f9d0ec2fa088ac583e1ccd15b6686073,89.68
e647bf617de735448a4ba54f8910393c,65.09
b2bb080b6bc860118a246fd9b6fad6da,173.84
23f10f509600c30cf2852f9dbdf28fc3,103.49
f86f6472fa9f395d8d9a6751ca118afb,64.03
1dcf0c8cd36ffaf57784fbdc90079310,157.15
00d8d65b666158b633f96054d31af43b,130.88
cf30fe76d1505192acee1c6dccb15545,47.72
d3e774a185c0b1b2286ffd6c70abe2e6,117.74
32b1d8f3789a57f1f752e20ac7404b4c,56.6
c10d412026c4077b8e83acf0fea04eee,266.16
56c3277583e16009c925fdf116df420f,31.38
0e0441786430b7cfcd0d91f822ea4c99,121.49
6ffb3f1686bceae3466facf7e02ce3fb,32.0
afef48d3c8a0b1b7c9b7f8f922fb5674,153.41
c0db7d31ace61fc360a3eaa34dd3457c,65.71
d574338f566ca28dd67820f48ec1f1d8,278.22
1807cc736321f14baa58ef39cf6e5989,91.66
e8977f709bbb0367f51b589e6325f991,132.51
2e2c60b99754ae1e4d8b18846cfec9f2,542.66
1ffb3c1929b16d9c1aec1958e11b3e9b,166.04
95442deb81a5d91c97c0df96b431634a,368.98
10af96a0689260134307879127ac1952,113.2
85eef2d342b0de363c45c1bc324729c5,99.43
aa964845f1de8125410aea8b73e9e1ec,27.35
343348b1e29e9fa9e7b6ab1027f9177d,43.77
ad4098a257676ea4d394fb3bbbf36ca3,68.49
3e0c3cab458e8b3cc8d1d38ecb7e7775,105.53
3ab4eea6776259ae8dfbabaeffece352,387.8
10d9871bed9fb8d0887d3b9022edd1ff,84.14
c108072ab31ec90a754129c171577f5f,210.82
fc662bafa52d2ef16078f6f6141009d6,90.05
4217849b1ff18a9270fe048eabc4dc45,67.88
795c16acb4e3c30dfa5b6827727ef488,37.58
55e2d723733c45033e71cb4d44690234,89.63
947e9c6bfd83a06953c420ef92d3da6e,69.46
60e43c5f5ba559d9dd19357ed72cb2f2,78.3
e3e9e3295f4e1512167c232a0aaae8a5,50.8
460d57443ffdcaeba240360239747cf7,34.0
4cb51127f19f7254b320efe1718477dd,77.1
110d9355d6338eab0a65a0cacdde5434,566.4
42f5954cda381bd032934ee38c453711,402.42
3689194c14ad4e2e7361ebd1df0e77b0,57.53
97c111c4f22dfa1089a9c0b5338dcc79,44.01
4b2d035932915aa9c2a0d4d84cd6d3b0,187.51
e1b4ee0e390fbac1dec439d72b45a115,77.7
fee72a68ce935ebf2939fe72f27d3d9b,48.68
4d3bfdf4c7d6578ea445d588371ae10e,77.29
4c2e1a95586c815795a324d1599e7b5a,117.71
c9f23db8a1cb725df9bdb3383bd72b38,169.34
8e47a04b25d7a7075064e8e0bd2e0318,37.61
723e462ce1ee50e024887c0b403130f3,13.8
fa2ea4b6e84c1c0fc4f3a6d468c55183,227.12
fb1a2a1296f822405a946cbdfc0d3ed6,34.78
198298d54f269d8c5fe89e85a859af61,342.56
b19ca559688b49e8cf7f88c1aa3f0009,73.34
5be8d4719fe2e3669e2d07dddf3b6b0c,117.85
4a02e985c7239d866a632f07ed20d9c0,48.62
3e17eef8a8bd0131c7aed90d7508799e,53.99
f8d323a2702fed37f0229965f7e9f8b3,51.14
de4090fd9b7900d46323b0c7c36b7128,121.45
17e5131fe1d4b1a8dc14d4a66914f9d7,73.34
20f136d890c31a62486c809f91a5b098,117.68
557cc2675910c4a6c9b54ad276f25097,56.77
d60a89ab9bc1e68834465ae630c3343e,115.59
3ba2d0012b1f34bc6ccbc31c4ba69f93,60.07
d46f45b0d795bcf47a19d301710e63fe,27.27
Query:
-- 15. Count the total number of customers
SELECT COUNT(DISTINCT "customer_id") AS "total_customers"
FROM E_COMMERCE.E_COMMERCE.CUSTOMERS
Answer:
total_customers
99441
Query:
-- 16. Count the total number of orders
SELECT COUNT(DISTINCT "order_id") AS "total_orders"
FROM E_COMMERCE.E_COMMERCE.ORDERS
Answer:
total_orders
99441
Query:
-- 17. View the distribution of payment installments
SELECT "payment_installments", COUNT(*) AS "count"
FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS
GROUP BY "payment_installments"
ORDER BY "count" DESC
LIMIT 100
Answer:
payment_installments,count
1,52546
2,12413
3,10461
4,7098
10,5328
5,5239
8,4268
6,3920
7,1626
9,644
12,133
15,74
18,27
11,23
24,18
20,17
13,16
14,15
17,8
16,5
21,3
0,2
22,1
23,1
Query:
-- 18. Aggregate payment values by payment type (first 100 entries)
SELECT "payment_type", SUM("payment_value") AS "total_payment"
FROM E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS
GROUP BY "payment_type"
LIMIT 100
Answer:
payment_type,total_payment
credit_card,12542084.19
boleto,2869361.27
voucher,379436.87
debit_card,217989.79
not_defined,0.0
Query:
-- 19. List customers along with their city and state (first 100 customers)
SELECT "customer_id", "customer_city", "customer_state"
FROM E_COMMERCE.E_COMMERCE.CUSTOMERS
LIMIT 100
Answer:
customer_id,customer_city,customer_state
06b8999e2fba1a1fbc88172c00ba8bc7,franca,SP
18955e83d337fd6b2def6b18a428ac77,sao bernardo do campo,SP
4e7b3e00288586ebd08712fdd0374a03,sao paulo,SP
b2b6027bc5c5109e529d4dc6358b12c3,mogi das cruzes,SP
4f2d8ab171c80ec8364f7c12e35b23ad,campinas,SP
879864dab9bc3047522c92c82e1212b8,jaragua do sul,SC
fd826e7cf63160e536e0908c76c3f441,sao paulo,SP
5e274e7a0c3809e14aba7ad5aae0d407,timoteo,MG
5adf08e34b2e993982a47070956c5c65,curitiba,PR
4b7139f34592b3a31687243a302fa75b,belo horizonte,MG
9fb35e4ed6f0a14a4977cd9aea4042bb,montes claros,MG
5aa9e4fdd4dfd20959cad2d772509598,rio de janeiro,RJ
b2d1536598b73a9abd18e0d75d92f0a3,lencois paulista,SP
eabebad39a88bb6f5b52376faec28612,sao paulo,SP
1f1c7bf1c9b041b292af6c1c4470b753,caxias do sul,RS
206f3129c0e4d7d0b9550426023f0a08,piracicaba,SP
a7c125a0a07b75146167b7f04a7f8e98,rio de janeiro,RJ
c5c61596a3b6bd0cee5766992c48a9a1,guarulhos,SP
9b8ce803689b3562defaad4613ef426f,sao paulo,SP
49d0ea0986edde72da777f15456a0ee0,pacaja,PA
154c4ded6991bdfa3cd249d11abf4130,florianopolis,SC
690172ab319622688d3b4df42f676898,aparecida de goiania,GO
2938121a40a20953c43caa8c98787fcb,sao paulo,SP
237098a64674ae89babdc426746260fc,curitiba,PR
cb721d7b4f271fd87011c4c83462c076,sao paulo,SP
f681356046d9fde60e70c73a18d65ea2,santo andre,SP
167bd30a409e3e4127df5a9408ebd394,goiania,GO
6e359a57a91f84095cc64e1b351aef8c,sao paulo,SP
e0eea8f69a457b3f1fa246e44c9ebefd,cachoeiro de itapemirim,ES
e3109970a3fe8021d5ff82c577ce5606,sao paulo,SP
261cb4f92498ca05d5bd1a327a261d9c,sao jose dos campos,SP
6f92779347724b67e44e3224f3b4cffd,sao roque,SP
2d5831cb2dff7cdefba62e950ae3dc7b,camacari,BA
b2bed119388167a954382cca36c4777f,resende,RJ
469634941c27cd844170935a3cf60b95,curitiba,PR
df0aa5b8586495e0ddf6b601122e43a1,sumare,SP
41c8f4b570869791379a925899a6af8a,guarulhos,SP
54f755c3fd2709231f9964a1430c5218,novo hamburgo,RS
4c06b42fbf7b97ab10779cda5549cd1c,sao luis,MA
b6368ca0f56d4632f44d58ca431487b2,sao jose,SC
4a0e66fd30684aa1409cd1b66fec77cc,guarulhos,SP
c168abb9077b7821adae01dc1f0886c5,santa barbara,MG
a3b0fda37bae14cf754877bed475e80c,sao paulo,SP
0ccd415657ae8a6cd1c71b00155a019e,guarulhos,SP
c532a74a3ebf1bacce2e2bcce3783317,ribeirao preto,SP
19cecb194f54e614b70d971306a9931b,belo horizonte,MG
f34a6e874087ec1f0e3dab9fdf659c5d,ituiutaba,MG
c132855c926907970dcf6f2bf0b33a24,taquarituba,SP
df85b96ba2ce3e49bde101b1614f52ac,sao jose dos pinhais,PR
4d27341acd30a36bca39008ee9bb9050,jaragua do sul,SC
d3b6830d18c7de943d1e707d1f061d40,sao paulo,SP
79de53946db384e2d7a9bd131792ad17,montes claros,MG
a562ab1e728449e3461829dfe2e36f73,barrinha,SP
b64ed91eab98972150bdaf77ca921934,rio de janeiro,RJ
8247b5583327ab8be19f96e1fb82f77b,parati,RJ
8fcaa9368903f3a9a28aeaff28c14638,dourados,MS
a9b0d1c26105279e1b8edc63d06bd668,sao paulo,SP
aa9f03ecd3728c9bd12e6d962c66c7cb,trindade,GO
230c0d740401730c7197d16376893525,cascavel,PR
a905baa530258422594f1b05615bd225,fortaleza,CE
4fa19f7da692e6bf9602aaad3c372eda,brasilia,DF
03f846ad03437d864a8d2a22976dcafe,sao paulo,SP
de4e13fd7d6469c5ada77d0843c55e42,pelotas,RS
8276de07ef25225d412b8462d73f8664,porto alegre,RS
cc32707d2e2f7c92ab449f9b28154809,rio de janeiro,RJ
a02f66c3af7b16eec19ddcd98b645fe3,salto,SP
26acee41e2f75689a5615892f06ea0bd,belo horizonte,MG
f64cdee66599119324ce57a97e43700d,jundiai,SP
7ab7a537b678b6dd73d825ff6ee7be9d,cachoeiro de itapemirim,ES
7300450cedf7e4c35c243c4a03c1e8a6,cacapava,SP
4c7241af24b5344cb01fe687643de4fe,fortaleza,CE
97e126f19a6f04b3462619f36862bcd2,sao vicente,SP
6d27a9361e591da38c87a5e70253f3f2,uberlandia,MG
6810c3dc47f641181fcc7f73275c3d19,botelhos,MG
b514422efcf14bef34858a0829bef189,sao goncalo,RJ
0aae2862f8eac77f10a34f44860720ac,sao paulo,SP
6c9a5923526346cbc0bd7bbd92269c01,sao paulo,SP
1b2cb35b19b40b61f953d32ea157b337,araucaria,PR
12d1b4294fef21016c9614eb31e55e15,sao vicente,SP
f6529ffebe6b3440d45d89604a4239ac,nova iguacu,RJ
8264e3518163dd09211870b24a5d741d,sao paulo,SP
8392e3d4cfeec63f2a8bfea68bf1f91f,areia branca,RN
38d1cd89306128348ffdf4cc23f3a50a,sao paulo,SP
91ec76836092bba85d11761078ed7bb5,campos dos goytacazes,RJ
f9dfa0a2934ffbb22e66924952548be8,sao carlos,SP
5a3260cfde2a918b597dada7ddd247bb,sao paulo,SP
ee3a81b2771fec5f9e982cdb1b3a4804,itajuba,MG
784c407781aa34749a388c9283782b56,porto alegre,RS
3f6ede29d4c69cd3316d2035b6cec1fb,sao bernardo do campo,SP
6bed27564bd99d78d09c1fac13da56fd,salto,SP
670254dd2e886ffe621b3831afb47d7d,cruz das almas,BA
f7cb015ff73be957ee6a30e2577742c5,vassouras,RJ
ea2196dc456ba36fe4f6b81dca4867d4,feira de santana,BA
09241c552e9fe2420997a6c535e9d408,sao paulo,SP
e50a30de3c32f9406a7185f40ce6874d,brasilia,DF
f89c1a6b9c966869e441e55bc14acddc,sao carlos,SP
23e96758fd640560e9b1fbcda90abfc4,sao paulo,SP
369708cabd9831ea6fde670a3b602a92,sao paulo,SP
5f8b4882b5a4ec7bf6d2107e6cd0cf29,niteroi,RJ
ad6891a1937cb8723a2c08ba1ae59873,sao luis,MA
Query:
-- 20. Display orders with their status and associated payment values (first 100 orders)
SELECT o."order_id", o."order_status", p."payment_value"
FROM E_COMMERCE.E_COMMERCE.ORDERS o
JOIN E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p ON o."order_id" = p."order_id"
LIMIT 100
Answer:
order_id,order_status,payment_value
b81ef226f3fe1789b1e8b2acac839d17,delivered,99.33
a9810da82917af2d9aefd1278f1dcfa0,delivered,24.39
25e8ea4e93396b6fa0d3dd708e76c1bd,delivered,65.71
ba78997921bbcdc1373bb41e913ab953,delivered,107.78
42fdf880ba16b47b59251dd489d4441a,delivered,128.45
298fcdf1f73eb413e4d26d01b25bc1cd,delivered,96.12
771ee386b001f06208a7419e4fc1bbd7,delivered,81.16
3d7239c394a212faae122962df514ac7,delivered,51.84
1f78449c87a54faf9e96e88ba1491fa9,delivered,341.09
0573b5e23cbd798006520e1d5b4c6714,delivered,51.95
d88e0d5fa41661ce03cf6cf336527646,delivered,188.73
2480f727e869fdeb397244a21b721b67,delivered,141.9
616105c9352a9668c38303ad44e056cd,delivered,75.78
cf95215a722f3ebf29e6bbab87a29e61,delivered,102.66
769214176682788a92801d8907fa1b40,delivered,105.28
12e5cfe0e4716b59afb0e0f4a3bd6570,delivered,157.45
61059985a6fc0ad64e95d9944caacdad,delivered,132.04
79da3f5fe31ad1e454f06f95dc032ad5,delivered,98.94
8ac09207f415d55acff302df7d6a895c,delivered,244.15
b2349a3f20dfbeef62e7b31baa22f84b,delivered,136.71
5a1f6d22f7dfb061ef29216b9af687a1,delivered,47.69
4214cda550ece8ee66441f459dc33a8c,delivered,170.57
adfbf6c2a620196f9a3ec747491c72b7,delivered,67.5
4d680edbaa7d3d9bed69532957368a03,delivered,353.09
8cd68144cdb62dc0d60848cf8616d2a4,delivered,330.66
5cfd514482e22bc992e7693f0e3e8df7,delivered,45.17
d0a945f85ba1074b60aac97ade7e240e,delivered,541.0
c39414c195d0f94c9d9c35e7c6ed4f1a,delivered,139.22
5d9c5817e278892b7498d90bfa28ade8,canceled,290.16
b69b9260e79a0da00e15f48de1bd2524,delivered,283.34
f45074ae38f2e01d9b854ec8d40362ff,delivered,13.78
81cedc4d2132eb6f512354166e51b187,delivered,30.28
595f598849d89203c28d05d0fbf3f92e,delivered,26.58
f9d0ec2fa088ac583e1ccd15b6686073,delivered,89.68
e647bf617de735448a4ba54f8910393c,delivered,65.09
b2bb080b6bc860118a246fd9b6fad6da,delivered,173.84
23f10f509600c30cf2852f9dbdf28fc3,delivered,103.49
f86f6472fa9f395d8d9a6751ca118afb,delivered,64.03
1dcf0c8cd36ffaf57784fbdc90079310,delivered,157.15
00d8d65b666158b633f96054d31af43b,delivered,130.88
cf30fe76d1505192acee1c6dccb15545,delivered,47.72
d3e774a185c0b1b2286ffd6c70abe2e6,delivered,117.74
32b1d8f3789a57f1f752e20ac7404b4c,delivered,56.6
c10d412026c4077b8e83acf0fea04eee,delivered,266.16
56c3277583e16009c925fdf116df420f,delivered,31.38
0e0441786430b7cfcd0d91f822ea4c99,delivered,121.49
6ffb3f1686bceae3466facf7e02ce3fb,delivered,32.0
afef48d3c8a0b1b7c9b7f8f922fb5674,invoiced,153.41
c0db7d31ace61fc360a3eaa34dd3457c,delivered,65.71
d574338f566ca28dd67820f48ec1f1d8,delivered,278.22
1807cc736321f14baa58ef39cf6e5989,delivered,91.66
e8977f709bbb0367f51b589e6325f991,delivered,132.51
2e2c60b99754ae1e4d8b18846cfec9f2,delivered,542.66
1ffb3c1929b16d9c1aec1958e11b3e9b,delivered,166.04
95442deb81a5d91c97c0df96b431634a,delivered,368.98
10af96a0689260134307879127ac1952,delivered,113.2
85eef2d342b0de363c45c1bc324729c5,delivered,99.43
aa964845f1de8125410aea8b73e9e1ec,delivered,27.35
343348b1e29e9fa9e7b6ab1027f9177d,delivered,43.77
ad4098a257676ea4d394fb3bbbf36ca3,delivered,68.49
3e0c3cab458e8b3cc8d1d38ecb7e7775,delivered,105.53
3ab4eea6776259ae8dfbabaeffece352,delivered,387.8
10d9871bed9fb8d0887d3b9022edd1ff,delivered,84.14
c108072ab31ec90a754129c171577f5f,shipped,210.82
fc662bafa52d2ef16078f6f6141009d6,delivered,90.05
4217849b1ff18a9270fe048eabc4dc45,delivered,67.88
795c16acb4e3c30dfa5b6827727ef488,delivered,37.58
55e2d723733c45033e71cb4d44690234,delivered,89.63
947e9c6bfd83a06953c420ef92d3da6e,canceled,69.46
60e43c5f5ba559d9dd19357ed72cb2f2,delivered,78.3
e3e9e3295f4e1512167c232a0aaae8a5,delivered,50.8
460d57443ffdcaeba240360239747cf7,delivered,34.0
4cb51127f19f7254b320efe1718477dd,delivered,77.1
110d9355d6338eab0a65a0cacdde5434,delivered,566.4
42f5954cda381bd032934ee38c453711,delivered,402.42
3689194c14ad4e2e7361ebd1df0e77b0,delivered,57.53
97c111c4f22dfa1089a9c0b5338dcc79,delivered,44.01
4b2d035932915aa9c2a0d4d84cd6d3b0,delivered,187.51
e1b4ee0e390fbac1dec439d72b45a115,delivered,77.7
fee72a68ce935ebf2939fe72f27d3d9b,delivered,48.68
4d3bfdf4c7d6578ea445d588371ae10e,delivered,77.29
4c2e1a95586c815795a324d1599e7b5a,delivered,117.71
c9f23db8a1cb725df9bdb3383bd72b38,delivered,169.34
8e47a04b25d7a7075064e8e0bd2e0318,delivered,37.61
723e462ce1ee50e024887c0b403130f3,delivered,13.8
fa2ea4b6e84c1c0fc4f3a6d468c55183,delivered,227.12
fb1a2a1296f822405a946cbdfc0d3ed6,delivered,34.78
198298d54f269d8c5fe89e85a859af61,delivered,342.56
b19ca559688b49e8cf7f88c1aa3f0009,delivered,73.34
5be8d4719fe2e3669e2d07dddf3b6b0c,delivered,117.85
4a02e985c7239d866a632f07ed20d9c0,delivered,48.62
3e17eef8a8bd0131c7aed90d7508799e,delivered,53.99
f8d323a2702fed37f0229965f7e9f8b3,delivered,51.14
de4090fd9b7900d46323b0c7c36b7128,delivered,121.45
17e5131fe1d4b1a8dc14d4a66914f9d7,delivered,73.34
20f136d890c31a62486c809f91a5b098,delivered,117.68
557cc2675910c4a6c9b54ad276f25097,delivered,56.77
d60a89ab9bc1e68834465ae630c3343e,delivered,115.59
3ba2d0012b1f34bc6ccbc31c4ba69f93,delivered,60.07
d46f45b0d795bcf47a19d301710e63fe,delivered,27.27
Query:
-- 9. Find the earliest and latest order dates for each customer (first 100 customers)
SELECT "customer_id",
       MIN(TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')) AS "first_order_date",
       MAX(TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')) AS "last_order_date"
FROM E_COMMERCE.E_COMMERCE.ORDERS
GROUP BY "customer_id"
LIMIT 100
Answer:
Too long, hard cut:
customer_id,first_order_date,last_order_date
9ef432eb6251297304e76186b10a928d,2017-10-02 10:56:33,2017-10-02 10:56:33
b0830fb4747a6c6d20dea0b8c802d7ef,2018-07-24 20:41:37,2018-07-24 20:41:37
41ce2a54c0b03bf3443c3d931a367089,2018-08-08 08:38:49,2018-08-08 08:38:49
f88197465ea7920adcdbec7375364d82,2017-11-18 19:28:06,2017-11-18 19:28:06
8ab97904e6daea8866dbdbc4fb7aad2c,2018-02-13 21:18:39,2018-02-13 21:18:39
503740e9ca751ccdda7ba28e9ab8f608,2017-07-09 21:57:05,2017-07-09 21:57:05
ed0271e0b7da060a393796590e7b737a,2017-04-11 12:22:08,2017-04-11 12:22:08
9bdf08b4b3b52b5526ff42d37d47f222,2017-05-16 13:10:30,2017-05-16 13:10:30
f54a9f0e6b351c431402b8461ea51999,2017-01-23 18:29:09,2017-01-23 18:29:09
31ad1d1b63eb9962463f764d4e6e0c9d,2017-07-29 11:55:02,2017-07-29 11:55:02
494dded5b201313c64ed7f100595b95c,2017-05-16 19:41:10,2017-05-16 19:41:10
7711cf624183d843aafe81855097bc37,2017-07-13 19:58:11,2017-07-13 19:58:11
d3e3b74c766bc6214e0c830b17ee2341,2018-06-07 10:06:19,2018-06-07 10:06:19
19402a48fe860416adf93348aba37740,2018-07-25 17:44:10,2018-07-25 17:44:10
3b6828a50ffe546942b7a473d70ac0fc,2018-06-07 19:03:12,2018-06-07 19:03:12
3187789bec990987628d7a9beb4dd6ac,2017-12-26 23:41:31,2017-12-26 23:41:31
059f7fc5719c7da6cbafe370971a8d70,2017-11-21 00:03:41,2017-11-21 00:03:41
d2b091571da224a1b36412c18bc3bbfe,2017-09-18 14:31:30,2017-09-18 14:31:30
4fa1cd166fa598be6de80fa84eaade43,2018-03-15 08:52:40,2018-03-15 08:52:40
72ae281627a6102d9b3718528b420f8a,2018-02-03 20:37:35,2018-02-03 20:37:35
a166da34890074091a942054b36e4265,2018-01-08 07:55:29,2018-01-08 07:55:29
8b212b9525f9e74e85e37ed6df37693e,2018-03-12 01:50:26,2018-03-12 01:50:26
52142aa69d8d0e1247ab0cada0f76023,2018-04-16 21:15:39,2018-04-16 21:15:39
816f8653d5361cbf94e58c33f2502a5c,2017-12-12 13:56:04,2017-12-12 13:56:04
cf8ffeddf027932e51e4eae73b384059,2018-07-29 23:34:51,2018-07-29 23:34:51
f5458ddc3545711efa883dd7ae7c4497,2018-02-21 18:15:12,2018-02-21 18:15:12
295ae9b35379e077273387ff64354b6f,2017-07-31 21:37:10,2017-07-31 21:37:10
2a1dfb647f32f4390e7b857c67458536,2018-06-01 12:23:13,2018-06-01 12:23:13
3391c4bc11a817e7973e498b0b023158,2018-03-26 17:12:18,2018-03-26 17:12:18
8644be24d48806bc3a88fd59fb47ceb1,2017-08-04 17:10:39,2017-08-04 17:10:39
caded193e8e47b8362864762a83db3c5,2018-06-04 16:44:48,2018-06-04 16:44:48
12fd2740039676063a874b9567dfa651,2018-05-17 16:59:11,2018-05-17 16:59:11
9b18f3fc296990b97854e351334a32f6,2018-02-01 14:02:19,2018-02-01 14:02:19
67407057a7d5ee17d1cd09523f484d13,2018-06-11 10:25:52,2018-06-11 10:25:52
81e08b08e5ed4472008030d70327c71f,2018-04-22 08:48:13,2018-04-22 08:48:13
be8c14c16a4d47194ccdfe10f1fc5b1a,2018-06-13 13:47:39,2018-06-13 13:47:39
55e6b290205c84ddd23ddf5eb134efd4,2018-04-13 08:44:17,2018-04-13 08:44:17
636e15840ab051faa13d3f781b6e4233,2018-07-28 16:52:55,2018-07-28 16:52:55
9f6618c17568ac301465fe7ad056c674,2017-10-16 14:56:50,2017-10-16 14:56:50
df9b032b2ad0fd6bf37dfb48e5f83845,2017-08-26 16:53:30,2017-08-26 16:53:30
48558a50a7ba1aab61891936d2ca7681,2018-01-22 19:22:22,2018-01-22 19:22:22
2e068340b3037f667ce3224bd59260af,2017-10-19 15:08:48,2017-10-19 15:08:48
6feea03756fd7ef4fb37d8f7e44aaeb9,2018-02-06 18:25:39,2018-02-06 18:25:39
e42998ccffc48dc87bf70b37e2d61f33,2018-06-08 12:19:58,2018-06-08 12:19:58
3a017955f82b5bf61bb51aec865a01ca,2018-06-01 11:26:06,2018-06-01 11:26:06
64d181ef52b1829800c598942459061b,2018-05-09 14:32:09,2018-05-09 14:32:09
738b086814c6fcc74b8cc583f8516ee3,2018-01-02 19:00:43,2018-01-02 19:00:43
3a874b4d4c4b6543206ff5d89287f0c3,2018-02-20 23:46:53,2018-02-20 23:46:53
7e20bf5ca92da68200643bda76c504c6,2018-06-04 00:00:13,2018-06-04 00:00:13
79183cd650e2bb0d475b0067d45946ac,2018-07-26 14:39:59,2018-07-26 14:39:59
684fa6da5134b9e4dab731e00011712d,2018-03-09 14:50:15,2018-03-09 14:50:15
b673f0597cb0c4d12778f731045f361a,2017-05-09 20:48:59,2017-05-09 20:48:59
82f0b75bb50fcb30711e5277e36b3983,2018-04-22 23:23:18,2018-04-22 23:23:18
167b9485947ed0a354a3f8dad04eb199,2018-07-05 18:40:47,2018-07-05 18:40:47
5883f965ac70043c2e908c3657c5d548,2017-12-21 17:43:41,2017-12-21 17:43:41
4dafe3c841d2d6cc8a8b6d25b35704b9,2017-05-09 11:48:37,2017-05-09 11:48:37
c1ddb7521d14db9071dccad0a94305c2,2018-07-15 12:37:12,2018-07-15 12:37:12
0dd5a932b1e29daa12845dbf696cbb54,2018-06-03 18:24:33,2018-06-03 18:24:33
8458f7ae02bda5950ce48c01a720559a,2018-05-23 16:37:35,2018-05-23 16:37:35
c178d6d544925594fafab0ba493cd645,2018-08-08 21:11:25,2018-08-08 21:11:25
9a80c8377644236e27f59e83862f1ae2,2017-07-10 12:23:05,2017-07-10 12:23:05
15bea20cd005ed59d34db54c6b32ec98,2018-07-23 18:27:07,2018-07-23 18:27:07
d0e6cb83a3fc27f56be011b2941f54c6,2018-05-30 22:33:08,2018-05-30 22:33:08
3df704f53d3f1d4818840b34ec672a9f,2018-03-01 14:14:28,2018-03-01 14:14:28
cce89a605105b148387c52e286ac8335,2018-05-02 11:45:38,2018-05-02 11:45:38
148348ff65384b4249b762579532e248,2018-06-26 13:42:52,2018-06-26 13:42:52
f5afca14dfa9dc64251cf2b45c54c363,2017-12-15 00:06:10,2017-12-15 00:06:10
241e78de29b3090cfa1b5d73a8130c72,2017-06-13 21:11:26,2017-06-13 
Query:
SELECT 
    o."customer_id",
    COUNT(DISTINCT o."order_id") AS "number_of_orders",
    AVG(p."payment_value") AS "average_payment_per_order",
    CASE
        WHEN DATEDIFF('day', 
                      MIN(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')),
                      MAX(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) < 7 THEN 1.0
        ELSE ROUND(
            DATEDIFF('day', 
                     MIN(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')),
                     MAX(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) / 7.0,
            2)
    END AS "lifespan_in_weeks"
FROM 
    E_COMMERCE.E_COMMERCE.ORDERS o
JOIN 
    E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p 
    ON o."order_id" = p."order_id"
WHERE 
    TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS') IS NOT NULL
GROUP BY 
    o."customer_id"
ORDER BY 
    "average_payment_per_order" DESC
LIMIT 3;
Answer:
customer_id,number_of_orders,average_payment_per_order,lifespan_in_weeks
1617b1357756262bfa56ab541c47bc16,1,13664.08,1.00
ec5b2ba62e574342386871631fafd3fc,1,7274.88,1.00
c6e2731c5b391845f6800c97401a43a9,1,6929.31,1.00
Query:
-- 9. Find the earliest and latest order dates for each customer (first 100 customers)
SELECT "customer_id",
       MIN(TRY_TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')) AS "first_order_date",
       MAX(TRY_TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')) AS "last_order_date"
FROM E_COMMERCE.E_COMMERCE.ORDERS
WHERE TRY_TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS') IS NOT NULL
GROUP BY "customer_id"
LIMIT 100
Answer:
Too long, hard cut:
customer_id,first_order_date,last_order_date
9ef432eb6251297304e76186b10a928d,2017-10-02 10:56:33,2017-10-02 10:56:33
b0830fb4747a6c6d20dea0b8c802d7ef,2018-07-24 20:41:37,2018-07-24 20:41:37
41ce2a54c0b03bf3443c3d931a367089,2018-08-08 08:38:49,2018-08-08 08:38:49
f88197465ea7920adcdbec7375364d82,2017-11-18 19:28:06,2017-11-18 19:28:06
8ab97904e6daea8866dbdbc4fb7aad2c,2018-02-13 21:18:39,2018-02-13 21:18:39
503740e9ca751ccdda7ba28e9ab8f608,2017-07-09 21:57:05,2017-07-09 21:57:05
ed0271e0b7da060a393796590e7b737a,2017-04-11 12:22:08,2017-04-11 12:22:08
9bdf08b4b3b52b5526ff42d37d47f222,2017-05-16 13:10:30,2017-05-16 13:10:30
31ad1d1b63eb9962463f764d4e6e0c9d,2017-07-29 11:55:02,2017-07-29 11:55:02
494dded5b201313c64ed7f100595b95c,2017-05-16 19:41:10,2017-05-16 19:41:10
d3e3b74c766bc6214e0c830b17ee2341,2018-06-07 10:06:19,2018-06-07 10:06:19
19402a48fe860416adf93348aba37740,2018-07-25 17:44:10,2018-07-25 17:44:10
3b6828a50ffe546942b7a473d70ac0fc,2018-06-07 19:03:12,2018-06-07 19:03:12
738b086814c6fcc74b8cc583f8516ee3,2018-01-02 19:00:43,2018-01-02 19:00:43
3187789bec990987628d7a9beb4dd6ac,2017-12-26 23:41:31,2017-12-26 23:41:31
059f7fc5719c7da6cbafe370971a8d70,2017-11-21 00:03:41,2017-11-21 00:03:41
7e20bf5ca92da68200643bda76c504c6,2018-06-04 00:00:13,2018-06-04 00:00:13
456dc10730fbdba34615447ea195d643,2017-08-10 11:58:33,2017-08-10 11:58:33
816f8653d5361cbf94e58c33f2502a5c,2017-12-12 13:56:04,2017-12-12 13:56:04
cf8ffeddf027932e51e4eae73b384059,2018-07-29 23:34:51,2018-07-29 23:34:51
295ae9b35379e077273387ff64354b6f,2017-07-31 21:37:10,2017-07-31 21:37:10
8644be24d48806bc3a88fd59fb47ceb1,2017-08-04 17:10:39,2017-08-04 17:10:39
756fb9391752dad934e0fe3733378e57,2018-08-04 23:25:30,2018-08-04 23:25:30
f178c1827f67a8467b0385b7378d951a,2017-08-31 08:15:24,2017-08-31 08:15:24
911e4c37f5cafe1604fe6767034bf1ae,2017-03-13 18:14:36,2017-03-13 18:14:36
9916715c2ab6ee1710c9c32f0a534ad2,2017-11-15 11:31:41,2017-11-15 11:31:41
5dda11942d4f77bee3a46d71e442aec4,2018-01-07 21:44:54,2018-01-07 21:44:54
be8c14c16a4d47194ccdfe10f1fc5b1a,2018-06-13 13:47:39,2018-06-13 13:47:39
f5618502bee8eafdee72fb6955e2ebdf,2018-02-15 10:33:30,2018-02-15 10:33:30
a90391a47de936d56c66a5366cba1462,2017-02-20 11:45:39,2017-02-20 11:45:39
3135962ee745ef39b85576df7ddbaa99,2018-08-03 08:59:39,2018-08-03 08:59:39
c622b892a190735ef81c0087973fa16d,2018-06-05 09:10:34,2018-06-05 09:10:34
c39bde0d4030d5e31e654f0c20db9786,2018-02-06 21:09:10,2018-02-06 21:09:10
4924a47e8cd5630b3564e26fac55c5ec,2018-07-18 13:39:54,2018-07-18 13:39:54
15bea20cd005ed59d34db54c6b32ec98,2018-07-23 18:27:07,2018-07-23 18:27:07
52006a9383bf149a4fb24226b173106f,2018-01-10 11:33:07,2018-01-10 11:33:07
c1ddb7521d14db9071dccad0a94305c2,2018-07-15 12:37:12,2018-07-15 12:37:12
4fa1cd166fa598be6de80fa84eaade43,2018-03-15 08:52:40,2018-03-15 08:52:40
a166da34890074091a942054b36e4265,2018-01-08 07:55:29,2018-01-08 07:55:29
5f16605299d698660e0606f7eae2d2f9,2018-02-17 15:59:46,2018-02-17 15:59:46
3391c4bc11a817e7973e498b0b023158,2018-03-26 17:12:18,2018-03-26 17:12:18
ddaff536587109b89777e0353215e150,2017-05-19 18:53:40,2017-05-19 18:53:40
caded193e8e47b8362864762a83db3c5,2018-06-04 16:44:48,2018-06-04 16:44:48
12fd2740039676063a874b9567dfa651,2018-05-17 16:59:11,2018-05-17 16:59:11
684fa6da5134b9e4dab731e00011712d,2018-03-09 14:50:15,2018-03-09 14:50:15
bb2f5e670f7155dc622c57e4b31d0a69,2017-09-13 14:27:11,2017-09-13 14:27:11
f26a435864aebedff7f7c84f82ee229f,2017-07-30 03:06:35,2017-07-30 03:06:35
bf141bf67fbe428d558bcf0e018eab60,2017-04-06 22:39:29,2017-04-06 22:39:29
b673f0597cb0c4d12778f731045f361a,2017-05-09 20:48:59,2017-05-09 20:48:59
fb9590a1e30e0ba8304ea73a31325797,2017-05-17 08:36:11,2017-05-17 08:36:11
dd854e24b40e3bc2b306946dee252015,2017-07-01 15:42:32,2017-07-01 15:42:32
61449fa1b8b8998c9c3f3a7f0ae954ef,2017-07-16 10:27:45,2017-07-16 10:27:45
d68901955dc622165460ba6cb4ac49f3,2017-03-28 16:03:34,2017-03-28 16:03:34
167b9485947ed0a354a3f8dad04eb199,2018-07-05 18:40:47,2018-07-05 18:40:47
7251aa758779438faea714941f1051c4,2018-05-25 08:54:21,2018-05-25 08:54:21
d4cd9729eeca5306a2c039fe6e55601e,2017-12-04 17:24:57,2017-12-04 17:24:57
9b18f3fc296990b97854e351334a32f6,2018-02-01 14:02:19,2018-02-01 14:02:19
cc3590e4afbb4b3e056b50a80a6a7d0c,2018-01-30 07:51:17,2018-01-30 07:51:17
818596f5b68adfe2c11498ebb6d39e02,2017-11-24 21:55:22,2017-11-24 21:55:22
cf9e2b07f78cce347089900f49fb4746,2017-03-14 16:25:43,2017-03-14 16:25:43
a8b396cd7edcd4340e02a07685084cd6,2017-09-27 14:43:47,2017-09-27 14:43:47
aa3d8c9eec8e52e90b117efe5e97a560,2017-12-21 04:59:55,2017-12-21 04:59:55
f54a9f0e6b351c431402b8461ea51999,2017-01-23 18:29:09,2017-01-23 18:29:09
3df704f53d3f1d4818840b34ec672a9f,2018-03-01 14:14:28,2018-03-01 14:14:28
7f8c8b9c2ae27bf3300f670c3d478be8,2017-10-26 15:54:26,2017-10-26 15:54:26
d2b091571da224a1b36412c18bc3bbfe,2017-09-18 14:31:30,2017-09-18 14:31:30
72ae281627a6102d9b3718528b420f8a,2018-02-03 20:37:35,2018-02-03 20:37:35
62b423aab58096ca514ba6aa06be2f98,2018-08-09 11:44:40,2018-08-09 
Query:
SELECT 
    o."customer_id",
    COUNT(DISTINCT o."order_id") AS "number_of_orders",
    AVG(p."payment_value") AS "average_payment_per_order",
    CASE
        WHEN (DATEDIFF('day', 
                       MIN(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')), 
                       MAX(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) + 1) < 7 THEN 1.0
        ELSE ROUND(
            (DATEDIFF('day', 
                      MIN(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')), 
                      MAX(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) + 1) / 7.0,
            2)
    END AS "lifespan_in_weeks"
FROM 
    E_COMMERCE.E_COMMERCE.ORDERS o
JOIN 
    E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p 
    ON o."order_id" = p."order_id"
WHERE 
    TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS') IS NOT NULL
GROUP BY 
    o."customer_id"
ORDER BY 
    "average_payment_per_order" DESC
LIMIT 3;
Answer:
customer_id,number_of_orders,average_payment_per_order,lifespan_in_weeks
1617b1357756262bfa56ab541c47bc16,1,13664.08,1.00
ec5b2ba62e574342386871631fafd3fc,1,7274.88,1.00
c6e2731c5b391845f6800c97401a43a9,1,6929.31,1.00
Query:
-- 11. Calculate the lifespan in weeks for each customer, setting it to 1.0 if less than one week (first 100 customers)
SELECT "customer_id",
       CASE
           WHEN (DATEDIFF('day',
                          MIN(TRY_TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')),
                          MAX(TRY_TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) + 1) < 7 THEN 1.0
           ELSE ROUND(
               (DATEDIFF('day',
                          MIN(TRY_TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')),
                          MAX(TRY_TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) + 1) / 7.0,
               2)
       END AS "lifespan_in_weeks"
FROM E_COMMERCE.E_COMMERCE.ORDERS
WHERE TRY_TO_TIMESTAMP("order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS') IS NOT NULL
GROUP BY "customer_id"
LIMIT 100
Answer:
customer_id,lifespan_in_weeks
9ef432eb6251297304e76186b10a928d,1.00
b0830fb4747a6c6d20dea0b8c802d7ef,1.00
41ce2a54c0b03bf3443c3d931a367089,1.00
f88197465ea7920adcdbec7375364d82,1.00
8ab97904e6daea8866dbdbc4fb7aad2c,1.00
503740e9ca751ccdda7ba28e9ab8f608,1.00
ed0271e0b7da060a393796590e7b737a,1.00
9bdf08b4b3b52b5526ff42d37d47f222,1.00
31ad1d1b63eb9962463f764d4e6e0c9d,1.00
494dded5b201313c64ed7f100595b95c,1.00
d3e3b74c766bc6214e0c830b17ee2341,1.00
19402a48fe860416adf93348aba37740,1.00
3b6828a50ffe546942b7a473d70ac0fc,1.00
738b086814c6fcc74b8cc583f8516ee3,1.00
3187789bec990987628d7a9beb4dd6ac,1.00
059f7fc5719c7da6cbafe370971a8d70,1.00
7e20bf5ca92da68200643bda76c504c6,1.00
456dc10730fbdba34615447ea195d643,1.00
816f8653d5361cbf94e58c33f2502a5c,1.00
cf8ffeddf027932e51e4eae73b384059,1.00
295ae9b35379e077273387ff64354b6f,1.00
8644be24d48806bc3a88fd59fb47ceb1,1.00
756fb9391752dad934e0fe3733378e57,1.00
f178c1827f67a8467b0385b7378d951a,1.00
911e4c37f5cafe1604fe6767034bf1ae,1.00
9916715c2ab6ee1710c9c32f0a534ad2,1.00
5dda11942d4f77bee3a46d71e442aec4,1.00
be8c14c16a4d47194ccdfe10f1fc5b1a,1.00
f5618502bee8eafdee72fb6955e2ebdf,1.00
a90391a47de936d56c66a5366cba1462,1.00
3135962ee745ef39b85576df7ddbaa99,1.00
c622b892a190735ef81c0087973fa16d,1.00
c39bde0d4030d5e31e654f0c20db9786,1.00
4924a47e8cd5630b3564e26fac55c5ec,1.00
15bea20cd005ed59d34db54c6b32ec98,1.00
52006a9383bf149a4fb24226b173106f,1.00
c1ddb7521d14db9071dccad0a94305c2,1.00
4fa1cd166fa598be6de80fa84eaade43,1.00
a166da34890074091a942054b36e4265,1.00
5f16605299d698660e0606f7eae2d2f9,1.00
3391c4bc11a817e7973e498b0b023158,1.00
ddaff536587109b89777e0353215e150,1.00
caded193e8e47b8362864762a83db3c5,1.00
12fd2740039676063a874b9567dfa651,1.00
684fa6da5134b9e4dab731e00011712d,1.00
bb2f5e670f7155dc622c57e4b31d0a69,1.00
f26a435864aebedff7f7c84f82ee229f,1.00
bf141bf67fbe428d558bcf0e018eab60,1.00
b673f0597cb0c4d12778f731045f361a,1.00
fb9590a1e30e0ba8304ea73a31325797,1.00
dd854e24b40e3bc2b306946dee252015,1.00
61449fa1b8b8998c9c3f3a7f0ae954ef,1.00
d68901955dc622165460ba6cb4ac49f3,1.00
167b9485947ed0a354a3f8dad04eb199,1.00
7251aa758779438faea714941f1051c4,1.00
d4cd9729eeca5306a2c039fe6e55601e,1.00
9b18f3fc296990b97854e351334a32f6,1.00
cc3590e4afbb4b3e056b50a80a6a7d0c,1.00
818596f5b68adfe2c11498ebb6d39e02,1.00
cf9e2b07f78cce347089900f49fb4746,1.00
a8b396cd7edcd4340e02a07685084cd6,1.00
aa3d8c9eec8e52e90b117efe5e97a560,1.00
f54a9f0e6b351c431402b8461ea51999,1.00
3df704f53d3f1d4818840b34ec672a9f,1.00
7f8c8b9c2ae27bf3300f670c3d478be8,1.00
d2b091571da224a1b36412c18bc3bbfe,1.00
72ae281627a6102d9b3718528b420f8a,1.00
62b423aab58096ca514ba6aa06be2f98,1.00
8b212b9525f9e74e85e37ed6df37693e,1.00
cce89a605105b148387c52e286ac8335,1.00
761df82feda9778854c6dafdaeb567e4,1.00
d9ef95f98d8da3b492bb8c0447910498,1.00
f5458ddc3545711efa883dd7ae7c4497,1.00
4f28355e5c17a4a42d3ce2439a1d4501,1.00
4632eb5a8f175f6fe020520ae0c678f3,1.00
81e08b08e5ed4472008030d70327c71f,1.00
a9d37ddc8ba4d9f6dbac7d8ec378cc95,1.00
55e6b290205c84ddd23ddf5eb134efd4,1.00
1833a0540067becaf59368fe4cd4303a,1.00
0bf19317b1830a69e55b40710576aa7a,1.00
803ac05904124294f8767894d6da532b,1.00
fc849c5fbc7e2b0c7cfebc138886c693,1.00
9e3a06f863456c3934b9d26037c119cd,1.00
328d7a69cb9cbaf088eed3ed778804bb,1.00
1755fad7863475346bc6c3773fe055d3,1.00
3a874b4d4c4b6543206ff5d89287f0c3,1.00
7f2178c5d771e17f507d3c1637339298,1.00
148348ff65384b4249b762579532e248,1.00
79183cd650e2bb0d475b0067d45946ac,1.00
2932d241d1f31e6df6c701d52370ae02,1.00
74805bc388861fa350ed2fade8444e0b,1.00
636e15840ab051faa13d3f781b6e4233,1.00
05e996469a2bf9559c7122b87e156724,1.00
5bb39c890c91b1d26801aa19a9336eac,1.00
8628fac2267e8c8804525da99c10ed0e,1.00
332df68ccac2f2f7d9e11299188f8bce,1.00
68451b39b1314302c08c65a29f1140fc,1.00
d2a79636084590b7465af8ab374a8cf5,1.00
b896b244963dc7543d400ad82d6710e0,1.00
d4faa220408c20e53595d2950f361f3b,1.00
End Exploring Related Columns
Task: Could you tell me the number of orders, average payment per order and customer lifespan in weeks of the 3 custumers with the highest average payment per order. Attention: I want the lifespan in float number if it's longer than one week, otherwise set it to be 1.0.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
customer_id,number_of_orders,average_payment_per_order,lifespan_in_weeks
customer_id1:str,number_of_orders1:int,average_payment_per_order1:float,lifespan_in_weeks1:float
customer_id2:str,number_of_orders2:int,average_payment_per_order2:float,lifespan_in_weeks2:float
customer_id3:str,number_of_orders3:int,average_payment_per_order3:float,lifespan_in_weeks3:float
(Attention: Answer in three rows)
```

This table displays the number of orders, average payment per order, and customer lifespan in weeks for the top three customers who have the highest average payment per order. If a customer's lifespan is less than one week, it is set to 1.0 as per the requirement..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'E_COMMERCE': {'E_COMMERCE': ['CUSTOMERS', 'GEOLOCATION', 'LEADS_CLOSED', 'LEADS_QUALIFIED', 'ORDERS', 'ORDER_ITEMS', 'ORDER_PAYMENTS', 'ORDER_REVIEWS', 'PRODUCTS', 'PRODUCT_CATEGORY_NAME_TRANSLATION', 'SELLERS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-21 14:47:17 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 14:47:17 - root - INFO - ```sql
SELECT 
    o."customer_id",
    COUNT(DISTINCT o."order_id") AS "number_of_orders",
    AVG(p."payment_value") AS "average_payment_per_order",
    CASE
        WHEN (DATEDIFF('day', 
                       MIN(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')), 
                       MAX(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) + 1) < 7 THEN 1.0
        ELSE ROUND(
            (DATEDIFF('day', 
                      MIN(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')), 
                      MAX(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) + 1) / 7.0,
            2)
    END AS "lifespan_in_weeks"
FROM 
    E_COMMERCE.E_COMMERCE.ORDERS o
JOIN 
    E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p 
    ON o."order_id" = p."order_id"
WHERE 
    TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS') IS NOT NULL
GROUP BY 
    o."customer_id"
ORDER BY 
    "average_payment_per_order" DESC
LIMIT 3;
```
2025-01-21 14:47:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:47:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:47:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:47:18 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-21 14:47:18 - snowflake.connector.connection - INFO - closed
2025-01-21 14:47:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:47:19 - root - INFO - itercount: 1
2025-01-21 14:47:19 - root - INFO - 0
2025-01-21 14:47:19 - root - INFO - results: 
customer_id,number_of_orders,average_payment_per_order,lifespan_in_weeks
1617b1357756262bfa56ab541c47bc16,1,13664.08,1.00
ec5b2ba62e574342386871631fafd3fc,1,7274.88,1.00
c6e2731c5b391845f6800c97401a43a9,1,6929.31,1.00


2025-01-21 14:47:19 - root - INFO - Please check the answer again by reviewing Could you tell me the number of orders, average payment per order and customer lifespan in weeks of the 3 custumers with the highest average payment per order. Attention: I want the lifespan in float number if it's longer than one week, otherwise set it to be 1.0., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
customer_id,number_of_orders,average_payment_per_order,lifespan_in_weeks
customer_id1:str,number_of_orders1:int,average_payment_per_order1:float,lifespan_in_weeks1:float
customer_id2:str,number_of_orders2:int,average_payment_per_order2:float,lifespan_in_weeks2:float
customer_id3:str,number_of_orders3:int,average_payment_per_order3:float,lifespan_in_weeks3:float
(Attention: Answer in three rows)
```

This table displays the number of orders, average payment per order, and customer lifespan in weeks for the top three customers who have the highest average payment per order. If a customer's lifespan is less than one week, it is set to 1.0 as per the requirement. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
customer_id,number_of_orders,average_payment_per_order,lifespan_in_weeks
1617b1357756262bfa56ab541c47bc16,1,13664.08,1.00
ec5b2ba62e574342386871631fafd3fc,1,7274.88,1.00
c6e2731c5b391845f6800c97401a43a9,1,6929.31,1.00
Current sql:
SELECT 
    o."customer_id",
    COUNT(DISTINCT o."order_id") AS "number_of_orders",
    AVG(p."payment_value") AS "average_payment_per_order",
    CASE
        WHEN (DATEDIFF('day', 
                       MIN(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')), 
                       MAX(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) + 1) < 7 THEN 1.0
        ELSE ROUND(
            (DATEDIFF('day', 
                      MIN(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')), 
                      MAX(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) + 1) / 7.0,
            2)
    END AS "lifespan_in_weeks"
FROM 
    E_COMMERCE.E_COMMERCE.ORDERS o
JOIN 
    E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p 
    ON o."order_id" = p."order_id"
WHERE 
    TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS') IS NOT NULL
GROUP BY 
    o."customer_id"
ORDER BY 
    "average_payment_per_order" DESC
LIMIT 3;When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-21 14:47:55 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 14:47:55 - root - INFO - ```csv
customer_id,number_of_orders,average_payment_per_order,lifespan_in_weeks
1617b1357756262bfa56ab541c47bc16,1,13664.0800,1.0000
ec5b2ba62e574342386871631fafd3fc,1,7274.8800,1.0000
c6e2731c5b391845f6800c97401a43a9,1,6929.3100,1.0000
```

```sql
SELECT 
    o."customer_id",
    COUNT(DISTINCT o."order_id") AS "number_of_orders",
    ROUND(AVG(p."payment_value"), 4) AS "average_payment_per_order",
    CASE
        WHEN (DATEDIFF('day', 
                       MIN(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')), 
                       MAX(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) + 1) < 7 THEN 1.0000
        ELSE ROUND(
            ((DATEDIFF('day', 
                       MIN(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS')), 
                       MAX(TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS'))) + 1) / 7.0),
            4)
    END AS "lifespan_in_weeks"
FROM 
    E_COMMERCE.E_COMMERCE.ORDERS o
JOIN 
    E_COMMERCE.E_COMMERCE.ORDER_PAYMENTS p 
    ON o."order_id" = p."order_id"
WHERE 
    TRY_TO_TIMESTAMP(o."order_purchase_timestamp", 'YYYY-MM-DD HH24:MI:SS') IS NOT NULL
GROUP BY 
    o."customer_id"
ORDER BY 
    "average_payment_per_order" DESC NULLS LAST
LIMIT 3;
```
2025-01-21 14:47:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 14:47:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 14:47:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 14:47:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-21 14:47:57 - snowflake.connector.connection - INFO - closed
2025-01-21 14:47:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 14:47:57 - root - INFO - itercount: 2
2025-01-21 14:47:57 - root - INFO - 0
2025-01-21 14:47:57 - root - INFO - Total iteration counts: 2
