2025-01-21 07:26:14 - openai._base_client - INFO - Retrying request to /chat/completions in 0.378327 seconds
2025-01-21 07:27:07 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 07:27:07 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 07:27:07 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 07:27:07 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 07:27:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 07:27:09 - snowflake.connector.connection - INFO - closed
2025-01-21 07:27:09 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 07:27:09 - root - INFO - SQL:
SELECT DISTINCT "category_name"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   LIMIT 100;
Results:
category_name
IMPORTED WHISKIES
COCKTAILS/RTD
LOW PROOF VODKA
VODKA FLAVORED
DARK CREME DE CACAO
WATERMELON SCHNAPPS
ANISETTE
IOWA DISTILLERY WHISKIES
100 PROOF VODKA
WHITE CREME DE CACAO
TENNESSEE WHISKIES
IRISH WHISKIES
VODKA 80 PROOF
IMPORTED DISTILLED SPIRITS SPECIALTY
TRIPLE SEC
CHERRY BRANDIES
IMPORTED FLAVORED VODKA
NEUTRAL GRAIN SPIRITS FLAVORED
DELISTED ITEMS
MISC. IMPORTED CORDIALS & LIQUEURS
MISCELLANEOUS SCHNAPPS
BLENDED WHISKIES
IMPORTED VODKA - MISC
APRICOT BRANDIES
FLAVORED GINS
AMERICAN CORDIALS & LIQUEURS
AMERICAN SLOE GINS
JAMAICA RUM
WHITE CREME DE MENTHE
GOLD RUM
DECANTERS & SPECIALTY PACKAGES
IMPORTED SCHNAPPS
TROPICAL FRUIT SCHNAPPS
IMPORTED AMARETTO
AMARETTO - IMPORTED
IMPORTED BRANDIES
100% AGAVE TEQUILA
SCOTCH WHISKIES
SINGLE BARREL BOURBON WHISKIES
SPEARMINT SCHNAPPS
ROOT BEER SCHNAPPS
AMERICAN FLAVORED VODKA
WHISKEY LIQUEUR
PEACH BRANDIES
SINGLE MALT SCOTCH
BOTTLED IN BOND BOURBON
JAPANESE WHISKY
PEACH SCHNAPPS
AMERICAN ALCOHOL
PUERTO RICO & VIRGIN ISLANDS RUM
TEQUILA
IMPORTED GRAPE BRANDIES
BARBADOS RUM
CINNAMON SCHNAPPS
IMPORTED GINS
MISC. AMERICAN CORDIALS & LIQUEURS
MIXTO TEQUILA
AMERICAN DISTILLED SPIRITS SPECIALTY
SPICED RUM
PEPPERMINT SCHNAPPS
CORN WHISKIES
AMERICAN DRY GINS
STRAWBERRY SCHNAPPS
IOWA DISTILLERIES
CREAM LIQUEURS
BUTTERSCOTCH SCHNAPPS
IMPORTED VODKA - CHERRY
AGED DARK RUM
AMERICAN GRAPE BRANDIES
MEZCAL
AMERICAN AMARETTO
STRAIGHT BOURBON WHISKIES
STRAIGHT RYE WHISKIES
DELISTED / SPECIAL ORDER ITEMS
COFFEE LIQUEURS
CREME DE ALMOND
HIGH PROOF BEER - AMERICAN
IMPORTED DRY GINS
IMPORTED VODKAS
AMERICAN COCKTAILS
BLACKBERRY BRANDIES
OTHER PROOF VODKA
GREEN CREME DE MENTHE
FLAVORED RUM
IMPORTED CORDIALS & LIQUEURS
FLAVORED GIN
AMERICAN VODKAS
RASPBERRY SCHNAPPS
TEMPORARY & SPECIALTY PACKAGES
SPECIAL ORDER ITEMS
APPLE SCHNAPPS
""
GRAPE SCHNAPPS
SCHNAPPS - IMPORTED
AMERICAN WHISKIES
CANADIAN WHISKIES
AMERICAN BRANDIES
MISCELLANEOUS  BRANDIES
AMERICAN SCHNAPPS
ROCK & RYE

2025-01-21 07:27:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 07:27:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 07:27:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 07:27:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-21 07:27:11 - snowflake.connector.connection - INFO - closed
2025-01-21 07:27:11 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 07:27:11 - root - INFO - SQL:
SELECT MIN("date") AS "start_date", MAX("date") AS "end_date"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES;
Results:
start_date,end_date
2012-01-03,2024-09-30

2025-01-21 07:27:11 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 07:27:11 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 07:27:11 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 07:27:12 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 07:27:12 - snowflake.connector.connection - INFO - closed
2025-01-21 07:27:13 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 07:27:13 - root - INFO - SQL:
SELECT "category_name", SUM("volume_sold_liters") AS "total_volume_liters"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   GROUP BY "category_name"
   ORDER BY "total_volume_liters" DESC
   LIMIT 100;
Results:
category_name,total_volume_liters
AMERICAN VODKAS,43578325.99000001
CANADIAN WHISKIES,35353278.57
SPICED RUM,18085561.129999995
VODKA 80 PROOF,17797396.77
STRAIGHT BOURBON WHISKIES,13291240.159999998
WHISKEY LIQUEUR,11803035.060000002
IMPORTED VODKAS,10417847.39
BLENDED WHISKIES,10343125.13
COCKTAILS/RTD,7344877.080000001
TENNESSEE WHISKIES,6199089.47
FLAVORED RUM,5807658.7700000005
AMERICAN FLAVORED VODKA,5654748.53
WHITE RUM,4705618.080000001
MIXTO TEQUILA,4690751.700000001
AMERICAN DRY GINS,4607653.11
CREAM LIQUEURS,4222257.319999999
100% AGAVE TEQUILA,4201076.46
AMERICAN SCHNAPPS,3931786.6799999997
PUERTO RICO & VIRGIN ISLANDS RUM,3889666.92
IMPORTED SCHNAPPS,3670160.7199999993
TEQUILA,3351430.8600000003
AMERICAN BRANDIES,3296756.13
AMERICAN COCKTAILS,3206271.1799999997
SCOTCH WHISKIES,3150192.29
VODKA FLAVORED,2907612.7600000002
IRISH WHISKIES,2818290.6399999997
IMPORTED CORDIALS & LIQUEURS,2680998.6899999995
TRIPLE SEC,2350501.6599999997
IMPORTED DRY GINS,2310817.4899999998
TEMPORARY & SPECIALTY PACKAGES,2284119.1799999997
IMPORTED BRANDIES,2177553.6999999993
IMPORTED FLAVORED VODKA,2038622.8
AMERICAN CORDIALS & LIQUEURS,1908081.4600000004
IMPORTED DISTILLED SPIRITS SPECIALTY,1848275.3599999996
MISC. IMPORTED CORDIALS & LIQUEURS,1453209.4600000002
IMPORTED VODKA - MISC,1301889.4399999995
AMERICAN GRAPE BRANDIES,1293088.4699999997
STRAIGHT RYE WHISKIES,1179474.28
SPECIAL ORDER ITEMS,1175383.4700000002
COFFEE LIQUEURS,1156503.3600000006
100 PROOF VODKA,959031.7200000001
GOLD RUM,817480.3099999999
PEPPERMINT SCHNAPPS,789853.18
SINGLE MALT SCOTCH,758599.1499999998
DISTILLED SPIRITS SPECIALTY,754358.4700000001
MISC. AMERICAN CORDIALS & LIQUEURS,688978.18
IMPORTED GRAPE BRANDIES,659869.7900000002
DECANTERS & SPECIALTY PACKAGES,522822.86999999994
PEACH SCHNAPPS,518755.7500000001
AMERICAN AMARETTO,414314.4900000002
NEUTRAL GRAIN SPIRITS FLAVORED,412364.17000000004
BLACKBERRY BRANDIES,373640.7299999999
AMERICAN DISTILLED SPIRITS SPECIALTY,305283.0299999999
NEUTRAL GRAIN SPIRITS,290027.9200000001
AGED DARK RUM,285129.8
APPLE SCHNAPPS,224426.81000000006
SINGLE BARREL BOURBON WHISKIES,203549.7
,191247.90000000005
BUTTERSCOTCH SCHNAPPS,190362.58000000007
APRICOT BRANDIES,180888.71999999994
AMERICAN ALCOHOL,171628.80000000002
BOTTLED IN BOND BOURBON,168498.22999999998
CINNAMON SCHNAPPS,151383.77000000002
WATERMELON SCHNAPPS,147316.75
GRAPE SCHNAPPS,133591.0
MISCELLANEOUS SCHNAPPS,133371.15000000002
FLAVORED GIN,121226.04999999996
ROOT BEER SCHNAPPS,93714.25
JAMAICA RUM,65725.0
PEACH BRANDIES,64483.360000000015
IMPORTED AMARETTO,64228.779999999984
CORN WHISKIES,62460.40000000001
RASPBERRY SCHNAPPS,61734.5
MEZCAL,59139.799999999996
CHERRY BRANDIES,56881.82
AMERICAN SLOE GINS,56105.0
TROPICAL FRUIT SCHNAPPS,54243.25
STRAWBERRY SCHNAPPS,54208.5
FLAVORED GINS,45033.45
BARBADOS RUM,44283.07
GREEN CREME DE MENTHE,34282.5
WHITE CREME DE CACAO,26446.5
DARK CREME DE CACAO,24541.5
SPEARMINT SCHNAPPS,18743.25
MISCELLANEOUS  BRANDIES,16564.99
OTHER PROOF VODKA,13520.5
IOWA DISTILLERIES,12138.75
ROCK & RYE,9125.25
WHITE CREME DE MENTHE,7937.25
IOWA DISTILLERY WHISKIES,7452.37
LOW PROOF VODKA,6966.0
CREME DE ALMOND,4998.0
ANISETTE,4072.5
JAPANESE WHISKY,1313.7
AMARETTO - IMPORTED,1131.75
SCHNAPPS - IMPORTED,288.05999999999995
IMPORTED GINS,234.0
IMPORTED VODKA - CHERRY,222.0
DELISTED ITEMS,111.97999999999999
HOLIDAY VAP,106.9

2025-01-21 07:27:13 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 07:27:13 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 07:27:13 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 07:27:15 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 07:27:15 - snowflake.connector.connection - INFO - closed
2025-01-21 07:27:15 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 07:27:15 - root - INFO - SQL:
SELECT TO_CHAR("date", 'YYYY-MM') AS "month", "category_name", SUM("volume_sold_liters") AS "monthly_volume"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   GROUP BY "month", "category_name"
   ORDER BY "month", "monthly_volume" DESC
   LIMIT 100;
Results:
month,category_name,monthly_volume
2012-01,VODKA 80 PROOF,239276.21999999994
2012-01,CANADIAN WHISKIES,129605.65
2012-01,SPICED RUM,83884.33000000002
2012-01,BLENDED WHISKIES,67090.8
2012-01,PUERTO RICO & VIRGIN ISLANDS RUM,59032.55000000002
2012-01,STRAIGHT BOURBON WHISKIES,53386.64999999999
2012-01,AMERICAN COCKTAILS,50729.25
2012-01,IMPORTED VODKAS,43234.12999999999
2012-01,TEQUILA,43016.159999999996
2012-01,VODKA FLAVORED,40753.85
2012-01,FLAVORED RUM,28902.120000000003
2012-01,AMERICAN DRY GINS,28517.209999999992
2012-01,IMPORTED SCHNAPPS,26458.480000000007
2012-01,MISC. IMPORTED CORDIALS & LIQUEURS,25854.409999999996
2012-01,WHISKEY LIQUEUR,24708.829999999998
2012-01,TENNESSEE WHISKIES,24678.31
2012-01,AMERICAN GRAPE BRANDIES,20746.23
2012-01,SCOTCH WHISKIES,18373.06000000001
2012-01,IMPORTED VODKA - MISC,18280.940000000002
2012-01,CREAM LIQUEURS,18068.860000000004
2012-01,MISC. AMERICAN CORDIALS & LIQUEURS,14408.490000000002
2012-01,100 PROOF VODKA,14100.75
2012-01,PEPPERMINT SCHNAPPS,12748.230000000003
2012-01,TRIPLE SEC,11289.5
2012-01,PEACH SCHNAPPS,9345.22
2012-01,DISTILLED SPIRITS SPECIALTY,9261.75
2012-01,AMERICAN AMARETTO,8013.5
2012-01,IMPORTED DRY GINS,7838.71
2012-01,BLACKBERRY BRANDIES,7161.849999999999
2012-01,COFFEE LIQUEURS,7132.12
2012-01,IMPORTED GRAPE BRANDIES,7040.820000000002
2012-01,IRISH WHISKIES,6428.46
2012-01,STRAIGHT RYE WHISKIES,5481.37
2012-01,APPLE SCHNAPPS,5160.99
2012-01,BUTTERSCOTCH SCHNAPPS,4265.61
2012-01,CINNAMON SCHNAPPS,3796.890000000001
2012-01,APRICOT BRANDIES,3403.620000000001
2012-01,GRAPE SCHNAPPS,2912.0
2012-01,AMERICAN ALCOHOL,2850.0
2012-01,SINGLE MALT SCOTCH,2638.2400000000002
2012-01,DECANTERS & SPECIALTY PACKAGES,2574.76
2012-01,WATERMELON SCHNAPPS,2522.0
2012-01,MISCELLANEOUS SCHNAPPS,2234.15
2012-01,ROOT BEER SCHNAPPS,2002.25
2012-01,IMPORTED AMARETTO,1526.6600000000003
2012-01,RASPBERRY SCHNAPPS,1363.0
2012-01,TROPICAL FRUIT SCHNAPPS,1328.75
2012-01,STRAWBERRY SCHNAPPS,1156.5
2012-01,CHERRY BRANDIES,1091.26
2012-01,JAMAICA RUM,987.75
2012-01,FLAVORED GINS,592.5
2012-01,WHITE CREME DE CACAO,590.25
2012-01,AMERICAN SLOE GINS,554.5
2012-01,GREEN CREME DE MENTHE,550.5
2012-01,PEACH BRANDIES,545.25
2012-01,DARK CREME DE CACAO,411.0
2012-01,SPEARMINT SCHNAPPS,319.75
2012-01,BOTTLED IN BOND BOURBON,293.25
2012-01,SINGLE BARREL BOURBON WHISKIES,279.0
2012-01,MISCELLANEOUS  BRANDIES,241.5
2012-01,,210.75
2012-01,OTHER PROOF VODKA,207.75
2012-01,BARBADOS RUM,165.0
2012-01,CREME DE ALMOND,120.75
2012-01,ROCK & RYE,120.0
2012-01,WHITE CREME DE MENTHE,92.25
2012-01,ANISETTE,51.0
2012-01,SCHNAPPS - IMPORTED,45.0
2012-01,LOW PROOF VODKA,17.25
2012-01,IMPORTED VODKA - CHERRY,12.0
2012-02,VODKA 80 PROOF,242492.53000000003
2012-02,CANADIAN WHISKIES,234011.37000000005
2012-02,SPICED RUM,104165.01000000001
2012-02,PUERTO RICO & VIRGIN ISLANDS RUM,65527.97000000001
2012-02,BLENDED WHISKIES,64533.07
2012-02,STRAIGHT BOURBON WHISKIES,55334.090000000004
2012-02,TEQUILA,50106.090000000004
2012-02,IMPORTED VODKAS,47198.920000000006
2012-02,AMERICAN COCKTAILS,43200.46000000001
2012-02,VODKA FLAVORED,39213.13
2012-02,TENNESSEE WHISKIES,31079.479999999996
2012-02,AMERICAN DRY GINS,31011.35999999999
2012-02,MISC. IMPORTED CORDIALS & LIQUEURS,28062.44
2012-02,FLAVORED RUM,27770.16
2012-02,WHISKEY LIQUEUR,27391.750000000004
2012-02,IMPORTED SCHNAPPS,26289.490000000013
2012-02,MISC. AMERICAN CORDIALS & LIQUEURS,22095.469999999998
2012-02,CREAM LIQUEURS,21083.79
2012-02,SCOTCH WHISKIES,20511.15
2012-02,IMPORTED VODKA - MISC,20453.409999999996
2012-02,AMERICAN GRAPE BRANDIES,20244.239999999987
2012-02,100 PROOF VODKA,14163.0
2012-02,PEPPERMINT SCHNAPPS,12880.190000000002
2012-02,TRIPLE SEC,12369.5
2012-02,IRISH WHISKIES,11407.81
2012-02,IMPORTED GRAPE BRANDIES,10588.620000000003
2012-02,DISTILLED SPIRITS SPECIALTY,10545.5
2012-02,IMPORTED DRY GINS,9061.09
2012-02,PEACH SCHNAPPS,8998.59
2012-02,AMERICAN AMARETTO,8527.0

2025-01-21 07:27:15 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 07:27:15 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 07:27:15 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 07:27:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 07:27:17 - snowflake.connector.connection - INFO - closed
2025-01-21 07:27:17 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 07:27:17 - root - INFO - SQL:
SELECT TO_CHAR("date", 'YYYY-MM') AS "month", SUM("volume_sold_liters") AS "total_monthly_volume"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   GROUP BY "month"
   ORDER BY "month" ASC
   LIMIT 100;
Results:
month,total_monthly_volume
2012-01,1212082.4899999998
2012-02,1386565.5299999998
2012-03,1352873.0
2012-04,1499566.7800000007
2012-05,1709432.6399999994
2012-06,1618025.9499999993
2012-07,1548759.0399999998
2012-08,1626636.1199999999
2012-09,1308896.5200000003
2012-10,2362800.93
2012-11,1376736.2599999995
2012-12,1752904.16
2013-01,1326088.83
2013-02,1320254.6199999999
2013-03,1298132.8699999999
2013-04,1656555.23
2013-05,1684864.3499999996
2013-06,1437004.53
2013-07,1663535.5700000003
2013-08,1559804.9499999997
2013-09,1389415.98
2013-10,2241359.78
2013-11,1248725.5899999999
2013-12,1750707.92
2014-01,1467399.73
2014-02,1382314.37
2014-03,1377646.2600000002
2014-04,1637259.8899999997
2014-05,1541196.8699999999
2014-06,1727003.4499999995
2014-07,1602277.98
2014-08,1529543.5600000003
2014-09,1617234.9800000007
2014-10,1867398.29
2014-11,1379794.8699999999
2014-12,2028542.2600000007
2015-01,1321350.0599999998
2015-02,1494080.5700000003
2015-03,1579862.2699999996
2015-04,1597903.8399999994
2015-05,1602766.25
2015-06,1883666.33
2015-07,1570712.72
2015-08,1558103.9100000006
2015-09,1679661.1500000004
2015-10,1774251.8999999994
2015-11,1576465.1
2015-12,1978878.3699999999
2016-01,1301957.4300000002
2016-02,1648109.82
2016-03,1605508.7799999993
2016-04,1559814.74
2016-05,1823960.9899999995
2016-06,1907398.3599999996
2016-07,1519271.1199999999
2016-08,1587701.8100000005
2016-09,1728796.1200000003
2016-10,1785493.1300000006
2016-11,1741649.4600000002
2016-12,2090602.2500000005
2017-01,1359767.73
2017-02,1622074.6600000001
2017-03,1669404.4499999997
2017-04,1584324.5599999994
2017-05,1946475.9100000001
2017-06,1961078.6599999997
2017-07,1739276.3499999996
2017-08,1901480.55
2017-09,1651396.86
2017-10,1959416.5899999996
2017-11,1724606.1300000006
2017-12,1977547.6599999997
2018-01,1515722.01
2018-02,1541561.03
2018-03,1629002.7300000002
2018-04,1767687.5100000005
2018-05,2067618.2699999998
2018-06,1913407.5800000003
2018-07,1754940.8700000003
2018-08,2025107.2500000007
2018-09,1576146.3299999994
2018-10,2150140.1099999994
2018-11,1801354.8499999999
2018-12,2153293.6299999994
2019-01,1561962.7799999993
2019-02,1680941.5700000003
2019-03,1607152.3700000003
2019-04,1856193.5000000005
2019-05,2173322.88
2019-06,1862667.6400000004
2019-07,2062816.3800000001
2019-08,1807243.96
2019-09,1748074.9300000002
2019-10,2098335.5599999996
2019-11,1801591.5900000003
2019-12,2041118.8599999996
2020-01,1566948.29
2020-02,1630476.3699999996
2020-03,1956066.8100000003
2020-04,2036555.5500000003

2025-01-21 07:27:17 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 07:27:17 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 07:27:17 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 07:27:19 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 07:27:19 - snowflake.connector.connection - INFO - closed
2025-01-21 07:27:19 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 07:27:20 - root - INFO - SQL:
SELECT
     category_month."month",
     category_month."category_name",
     (category_month."monthly_volume" / total_month."total_monthly_volume") * 100 AS "volume_percentage"
   FROM
     (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", "category_name", SUM("volume_sold_liters") AS "monthly_volume"
      FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
      GROUP BY "month", "category_name") AS category_month
   JOIN
     (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", SUM("volume_sold_liters") AS "total_monthly_volume"
      FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
      GROUP BY "month") AS total_month
   ON category_month."month" = total_month."month"
   ORDER BY category_month."month", "volume_percentage" DESC
   LIMIT 100;
Results:
month,category_name,volume_percentage
2012-01,VODKA 80 PROOF,19.740918788456383
2012-01,CANADIAN WHISKIES,10.692807714762056
2012-01,SPICED RUM,6.920678311259162
2012-01,BLENDED WHISKIES,5.535167825087551
2012-01,PUERTO RICO & VIRGIN ISLANDS RUM,4.870340961694778
2012-01,STRAIGHT BOURBON WHISKIES,4.4045393313123435
2012-01,AMERICAN COCKTAILS,4.185296827446126
2012-01,IMPORTED VODKAS,3.566929673243609
2012-01,TEQUILA,3.5489465737600083
2012-01,VODKA FLAVORED,3.3623000361963813
2012-01,FLAVORED RUM,2.384501074675206
2012-01,AMERICAN DRY GINS,2.3527449852031115
2012-01,IMPORTED SCHNAPPS,2.1828943341966776
2012-01,MISC. IMPORTED CORDIALS & LIQUEURS,2.1330569671046065
2012-01,WHISKEY LIQUEUR,2.03854359780414
2012-01,TENNESSEE WHISKIES,2.0360256173653664
2012-01,AMERICAN GRAPE BRANDIES,1.7116186539416143
2012-01,SCOTCH WHISKIES,1.5158258741944213
2012-01,IMPORTED VODKA - MISC,1.5082257314021592
2012-01,CREAM LIQUEURS,1.4907285724422932
2012-01,MISC. AMERICAN CORDIALS & LIQUEURS,1.1887384001397463
2012-01,100 PROOF VODKA,1.1633490390575645
2012-01,PEPPERMINT SCHNAPPS,1.0517625743442596
2012-01,TRIPLE SEC,0.9314135047029678
2012-01,PEACH SCHNAPPS,0.7710052803419344
2012-01,DISTILLED SPIRITS SPECIALTY,0.7641187853476871
2012-01,AMERICAN AMARETTO,0.6611348704492876
2012-01,IMPORTED DRY GINS,0.6467142347712656
2012-01,BLACKBERRY BRANDIES,0.5908715008332477
2012-01,COFFEE LIQUEURS,0.5884186974766049
2012-01,IMPORTED GRAPE BRANDIES,0.5808862068455424
2012-01,IRISH WHISKIES,0.5303648929042776
2012-01,STRAIGHT RYE WHISKIES,0.4522274717457555
2012-01,APPLE SCHNAPPS,0.4257952773494814
2012-01,BUTTERSCOTCH SCHNAPPS,0.35192406747827865
2012-01,CINNAMON SCHNAPPS,0.31325343211582907
2012-01,APRICOT BRANDIES,0.280807620610046
2012-01,GRAPE SCHNAPPS,0.2402476748921602
2012-01,AMERICAN ALCOHOL,0.23513251148442876
2012-01,SINGLE MALT SCOTCH,0.21766175336795768
2012-01,DECANTERS & SPECIALTY PACKAGES,0.21242448605952552
2012-01,WATERMELON SCHNAPPS,0.20807164700481728
2012-01,MISCELLANEOUS SCHNAPPS,0.18432326334489002
2012-01,ROOT BEER SCHNAPPS,0.1651909021472623
2012-01,IMPORTED AMARETTO,0.12595347367818177
2012-01,RASPBERRY SCHNAPPS,0.11245109233448294
2012-01,TROPICAL FRUIT SCHNAPPS,0.10962537706488938
2012-01,STRAWBERRY SCHNAPPS,0.09541429808131294
2012-01,CHERRY BRANDIES,0.09003182613420971
2012-01,JAMAICA RUM,0.0814919783223665
2012-01,FLAVORED GINS,0.04888281159807861
2012-01,WHITE CREME DE CACAO,0.048697180667959326
2012-01,AMERICAN SLOE GINS,0.04574771144495289
2012-01,GREEN CREME DE MENTHE,0.04541770090251861
2012-01,PEACH BRANDIES,0.04498456206557361
2012-01,DARK CREME DE CACAO,0.033908583235122886
2012-01,SPEARMINT SCHNAPPS,0.026380217735840737
2012-01,BOTTLED IN BOND BOURBON,0.02419389789221359
2012-01,SINGLE BARREL BOURBON WHISKIES,0.023018235334791446
2012-01,MISCELLANEOUS  BRANDIES,0.019924386499470016
2012-01,,0.017387430454506442
2012-01,OTHER PROOF VODKA,0.01713992254768073
2012-01,BARBADOS RUM,0.013612934875414297
2012-01,CREME DE ALMOND,0.009962193249735008
2012-01,ROCK & RYE,0.009900316273028578
2012-01,WHITE CREME DE MENTHE,0.00761086813489072
2012-01,ANISETTE,0.004207634416037146
2012-01,SCHNAPPS - IMPORTED,0.003712618602385717
2012-01,LOW PROOF VODKA,0.0014231704642478581
2012-01,IMPORTED VODKA - CHERRY,0.000990031627302858
2012-02,VODKA 80 PROOF,17.48871760860808
2012-02,CANADIAN WHISKIES,16.877050881251893
2012-02,SPICED RUM,7.512447680709328
2012-02,PUERTO RICO & VIRGIN ISLANDS RUM,4.72591944500452
2012-02,BLENDED WHISKIES,4.6541666155511585
2012-02,STRAIGHT BOURBON WHISKIES,3.9907302469865957
2012-02,TEQUILA,3.6136835162778063
2012-02,IMPORTED VODKAS,3.4040165415045327
2012-02,AMERICAN COCKTAILS,3.11564502833126
2012-02,VODKA FLAVORED,2.828076217933962
2012-02,TENNESSEE WHISKIES,2.241472135831906
2012-02,AMERICAN DRY GINS,2.2365592775121117
2012-02,MISC. IMPORTED CORDIALS & LIQUEURS,2.0238812658208802
2012-02,FLAVORED RUM,2.0028018437758215
2012-02,WHISKEY LIQUEUR,1.9755106705991745
2012-02,IMPORTED SCHNAPPS,1.896014968726361
2012-02,MISC. AMERICAN CORDIALS & LIQUEURS,1.593539542267432
2012-02,CREAM LIQUEURS,1.5205765283953072
2012-02,SCOTCH WHISKIES,1.4792773623905098
2012-02,IMPORTED VODKA - MISC,1.4751131163631332
2012-02,AMERICAN GRAPE BRANDIES,1.4600276411025441
2012-02,100 PROOF VODKA,1.0214446914744806
2012-02,PEPPERMINT SCHNAPPS,0.9289276071935814
2012-02,TRIPLE SEC,0.8920963151305225
2012-02,IRISH WHISKIES,0.8227386122890272
2012-02,IMPORTED GRAPE BRANDIES,0.7636581013232024
2012-02,DISTILLED SPIRITS SPECIALTY,0.760548259121947
2012-02,IMPORTED DRY GINS,0.6534916528611524
2012-02,PEACH SCHNAPPS,0.6489841125648059
2012-02,AMERICAN AMARETTO,0.6149727377111415

2025-01-21 07:27:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 07:27:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 07:27:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 07:27:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 07:27:22 - snowflake.connector.connection - INFO - closed
2025-01-21 07:27:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 07:27:22 - root - INFO - SQL:
SELECT
     "category_name",
     AVG("volume_percentage") AS "average_monthly_percentage"
   FROM
     (SELECT
        category_month."month",
        category_month."category_name",
        (category_month."monthly_volume" / total_month."total_monthly_volume") * 100 AS "volume_percentage"
      FROM
        (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", "category_name", SUM("volume_sold_liters") AS "monthly_volume"
         FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
         GROUP BY "month", "category_name") AS category_month
      JOIN
        (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", SUM("volume_sold_liters") AS "total_monthly_volume"
         FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
         GROUP BY "month") AS total_month
      ON category_month."month" = total_month."month"
     ) AS category_percentage
   GROUP BY "category_name"
   ORDER BY "average_monthly_percentage" DESC
   LIMIT 100;
Results:
category_name,average_monthly_percentage
AMERICAN VODKAS,23.21156067164384
VODKA 80 PROOF,19.98911814597784
CANADIAN WHISKIES,12.846569201285472
SPICED RUM,6.63366832927565
STRAIGHT BOURBON WHISKIES,4.77922915934246
PUERTO RICO & VIRGIN ISLANDS RUM,4.380897163822909
WHISKEY LIQUEUR,4.23948593933842
COCKTAILS/RTD,3.8749806651602934
BLENDED WHISKIES,3.836941878100829
IMPORTED VODKAS,3.814308724253921
TEQUILA,3.776803816848492
AMERICAN COCKTAILS,3.6147245155504635
VODKA FLAVORED,3.2600479470398684
AMERICAN FLAVORED VODKA,3.0131590305263667
WHITE RUM,2.5156675926018526
MIXTO TEQUILA,2.4962369977908465
TENNESSEE WHISKIES,2.254553462817315
100% AGAVE TEQUILA,2.2011268984503154
AMERICAN SCHNAPPS,2.1070002633160447
FLAVORED RUM,2.106856927639865
AMERICAN BRANDIES,1.7717188611942372
AMERICAN DRY GINS,1.715339041730076
MISC. IMPORTED CORDIALS & LIQUEURS,1.643144270725072
CREAM LIQUEURS,1.5341837293758045
IMPORTED VODKA - MISC,1.4644595366481572
AMERICAN GRAPE BRANDIES,1.4587593663076601
IMPORTED CORDIALS & LIQUEURS,1.4266010593150484
IMPORTED SCHNAPPS,1.3494648110187932
TEMPORARY & SPECIALTY PACKAGES,1.1949668899206516
SCOTCH WHISKIES,1.1672623847938823
IMPORTED BRANDIES,1.1544979014680163
IMPORTED FLAVORED VODKA,1.086978395901683
100 PROOF VODKA,1.0855406376304846
AMERICAN CORDIALS & LIQUEURS,1.0259900695077675
IRISH WHISKIES,1.0104208675045347
IMPORTED DISTILLED SPIRITS SPECIALTY,0.9790846251860491
PEPPERMINT SCHNAPPS,0.887381282142442
TRIPLE SEC,0.8598156069343933
IMPORTED DRY GINS,0.83773254837913
MISC. AMERICAN CORDIALS & LIQUEURS,0.7764740170238629
IMPORTED GRAPE BRANDIES,0.7421926249728007
SPECIAL ORDER ITEMS,0.6215479173638517
DISTILLED SPIRITS SPECIALTY,0.614906930955018
PEACH SCHNAPPS,0.5888059426851562
DECANTERS & SPECIALTY PACKAGES,0.5341673654963249
AMERICAN AMARETTO,0.4709215788228319
GOLD RUM,0.43800563747257426
STRAIGHT RYE WHISKIES,0.4261299069707224
BLACKBERRY BRANDIES,0.4239016785793931
COFFEE LIQUEURS,0.4238453173203895
SINGLE MALT SCOTCH,0.2735606859083315
APPLE SCHNAPPS,0.25689994548352935
BUTTERSCOTCH SCHNAPPS,0.21606976327261687
NEUTRAL GRAIN SPIRITS FLAVORED,0.21393550785622498
APRICOT BRANDIES,0.20467814719595387
AMERICAN ALCOHOL,0.192027505374809
CINNAMON SCHNAPPS,0.17248540755658853
WATERMELON SCHNAPPS,0.16712363567309518
AMERICAN DISTILLED SPIRITS SPECIALTY,0.15824304740994824
NEUTRAL GRAIN SPIRITS,0.15350968921217575
GRAPE SCHNAPPS,0.15257947827709245
AGED DARK RUM,0.15103698410598584
MISCELLANEOUS SCHNAPPS,0.15083439729063478
,0.10680653023729461
ROOT BEER SCHNAPPS,0.10664758301399259
IMPORTED AMARETTO,0.07827016957892703
JAMAICA RUM,0.07391948390877782
PEACH BRANDIES,0.07145068337366521
SINGLE BARREL BOURBON WHISKIES,0.07040151830115142
RASPBERRY SCHNAPPS,0.0701028888875891
CHERRY BRANDIES,0.06457247631462931
FLAVORED GIN,0.06373269240319517
TROPICAL FRUIT SCHNAPPS,0.06210982763342481
STRAWBERRY SCHNAPPS,0.06181374410399589
BOTTLED IN BOND BOURBON,0.05771101016768754
FLAVORED GINS,0.05110278204869394
BARBADOS RUM,0.04965279751388498
GREEN CREME DE MENTHE,0.038516517402351284
MEZCAL,0.030817982282738774
WHITE CREME DE CACAO,0.030324630520731474
CORN WHISKIES,0.030258744720055006
DARK CREME DE CACAO,0.027921190618576838
IOWA DISTILLERIES,0.027177471625577168
AMERICAN SLOE GINS,0.02129985747968865
SPEARMINT SCHNAPPS,0.02126867898536337
MISCELLANEOUS  BRANDIES,0.018375319064891118
IOWA DISTILLERY WHISKIES,0.016662550156904404
OTHER PROOF VODKA,0.015473222983465144
ROCK & RYE,0.010378321385332812
LOW PROOF VODKA,0.010285774222367776
WHITE CREME DE MENTHE,0.010225936350506646
JAPANESE WHISKY,0.006220941670409949
CREME DE ALMOND,0.005833093518711603
ANISETTE,0.004683147064224649
AMERICAN WHISKIES,0.002395587844057472
AMARETTO - IMPORTED,0.0019197529212686229
HOLIDAY VAP,0.001405422119778114
DELISTED ITEMS,0.001378963963727594
SCHNAPPS - IMPORTED,0.001341477833351315
IMPORTED VODKA - CHERRY,0.00122051761228994

2025-01-21 07:27:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 07:27:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 07:27:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 07:27:25 - snowflake.connector.cursor - INFO - Number of results in first chunk: 35
2025-01-21 07:27:25 - snowflake.connector.connection - INFO - closed
2025-01-21 07:27:25 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 07:27:25 - root - INFO - SQL:
SELECT
     "category_name",
     AVG("volume_percentage") AS "average_monthly_percentage"
   FROM
     (SELECT
        category_month."month",
        category_month."category_name",
        (category_month."monthly_volume" / total_month."total_monthly_volume") * 100 AS "volume_percentage"
      FROM
        (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", "category_name", SUM("volume_sold_liters") AS "monthly_volume"
         FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
         GROUP BY "month", "category_name") AS category_month
      JOIN
        (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", SUM("volume_sold_liters") AS "total_monthly_volume"
         FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
         GROUP BY "month") AS total_month
      ON category_month."month" = total_month."month"
     ) AS category_percentage
   GROUP BY "category_name"
   HAVING AVG("volume_percentage") >= 1
   ORDER BY "average_monthly_percentage" DESC
   LIMIT 100;
Results:
category_name,average_monthly_percentage
AMERICAN VODKAS,23.21156067164384
VODKA 80 PROOF,19.989118145977837
CANADIAN WHISKIES,12.846569201285467
SPICED RUM,6.6336683292756495
STRAIGHT BOURBON WHISKIES,4.779229159342459
PUERTO RICO & VIRGIN ISLANDS RUM,4.38089716382291
WHISKEY LIQUEUR,4.239485939338419
COCKTAILS/RTD,3.8749806651602947
BLENDED WHISKIES,3.8369418781008275
IMPORTED VODKAS,3.8143087242539195
TEQUILA,3.776803816848492
AMERICAN COCKTAILS,3.614724515550464
VODKA FLAVORED,3.260047947039869
AMERICAN FLAVORED VODKA,3.0131590305263667
WHITE RUM,2.5156675926018512
MIXTO TEQUILA,2.496236997790848
TENNESSEE WHISKIES,2.2545534628173147
100% AGAVE TEQUILA,2.2011268984503154
AMERICAN SCHNAPPS,2.107000263316044
FLAVORED RUM,2.106856927639865
AMERICAN BRANDIES,1.7717188611942374
AMERICAN DRY GINS,1.7153390417300753
MISC. IMPORTED CORDIALS & LIQUEURS,1.6431442707250716
CREAM LIQUEURS,1.5341837293758038
IMPORTED VODKA - MISC,1.4644595366481574
AMERICAN GRAPE BRANDIES,1.45875936630766
IMPORTED CORDIALS & LIQUEURS,1.426601059315048
IMPORTED SCHNAPPS,1.3494648110187932
TEMPORARY & SPECIALTY PACKAGES,1.1949668899206514
SCOTCH WHISKIES,1.1672623847938821
IMPORTED BRANDIES,1.1544979014680168
IMPORTED FLAVORED VODKA,1.086978395901683
100 PROOF VODKA,1.0855406376304844
AMERICAN CORDIALS & LIQUEURS,1.0259900695077677
IRISH WHISKIES,1.010420867504535

2025-01-21 07:27:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 07:27:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 07:27:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 07:27:27 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-21 07:27:27 - snowflake.connector.connection - INFO - closed
2025-01-21 07:27:27 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 07:27:27 - root - INFO - SQL:
SELECT COUNT(DISTINCT TO_CHAR("date", 'YYYY-MM')) AS "number_of_months"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES;
Results:
number_of_months
153

2025-01-21 07:27:27 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 07:27:27 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 07:27:27 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 07:27:29 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-21 07:27:29 - snowflake.connector.connection - INFO - closed
2025-01-21 07:27:29 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 07:27:30 - root - INFO - SQL:
SELECT
      category_month."month",
      category_month."category_name",
      category_month."monthly_volume"
    FROM
      (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", "category_name", SUM("volume_sold_liters") AS "monthly_volume"
       FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
       GROUP BY "month", "category_name") AS category_month
    WHERE
      category_month."category_name" IN (
        SELECT "category_name"
        FROM
          (SELECT
             "category_name",
             AVG("volume_percentage") AS "average_monthly_percentage"
           FROM
             (SELECT
                category_month."month",
                category_month."category_name",
                (category_month."monthly_volume" / total_month."total_monthly_volume") * 100 AS "volume_percentage"
              FROM
                (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", "category_name", SUM("volume_sold_liters") AS "monthly_volume"
                 FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
                 GROUP BY "month", "category_name") AS category_month
              JOIN
                (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", SUM("volume_sold_liters") AS "total_monthly_volume"
                 FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
                 GROUP BY "month") AS total_month
              ON category_month."month" = total_month."month"
             ) AS category_percentage
           GROUP BY "category_name"
           HAVING AVG("volume_percentage") >= 1
          )
      )
    ORDER BY category_month."category_name", category_month."month"
    LIMIT 100;
Results:
month,category_name,monthly_volume
2012-01,100 PROOF VODKA,14100.75
2012-02,100 PROOF VODKA,14163.0
2012-03,100 PROOF VODKA,16090.0
2012-04,100 PROOF VODKA,14406.0
2012-05,100 PROOF VODKA,17656.25
2012-06,100 PROOF VODKA,16616.25
2012-07,100 PROOF VODKA,16528.5
2012-08,100 PROOF VODKA,18921.75
2012-09,100 PROOF VODKA,14106.75
2012-10,100 PROOF VODKA,20406.5
2012-11,100 PROOF VODKA,14130.5
2012-12,100 PROOF VODKA,15879.75
2013-01,100 PROOF VODKA,13943.75
2013-02,100 PROOF VODKA,13145.0
2013-03,100 PROOF VODKA,16281.5
2013-04,100 PROOF VODKA,17923.25
2013-05,100 PROOF VODKA,18085.75
2013-06,100 PROOF VODKA,18799.0
2013-07,100 PROOF VODKA,20754.75
2013-08,100 PROOF VODKA,20380.0
2013-09,100 PROOF VODKA,18212.5
2013-10,100 PROOF VODKA,21499.0
2013-11,100 PROOF VODKA,14686.25
2013-12,100 PROOF VODKA,17733.5
2014-01,100 PROOF VODKA,15742.0
2014-02,100 PROOF VODKA,14233.75
2014-03,100 PROOF VODKA,15658.25
2014-04,100 PROOF VODKA,16558.75
2014-05,100 PROOF VODKA,16650.75
2014-06,100 PROOF VODKA,19033.5
2014-07,100 PROOF VODKA,18204.0
2014-08,100 PROOF VODKA,16906.5
2014-09,100 PROOF VODKA,15911.0
2014-10,100 PROOF VODKA,17242.5
2014-11,100 PROOF VODKA,15652.5
2014-12,100 PROOF VODKA,19919.25
2015-01,100 PROOF VODKA,15121.5
2015-02,100 PROOF VODKA,14573.5
2015-03,100 PROOF VODKA,19845.75
2015-04,100 PROOF VODKA,21206.25
2015-05,100 PROOF VODKA,18079.0
2015-06,100 PROOF VODKA,24351.5
2015-07,100 PROOF VODKA,20954.75
2015-08,100 PROOF VODKA,21320.5
2015-09,100 PROOF VODKA,23366.0
2015-10,100 PROOF VODKA,19716.75
2015-11,100 PROOF VODKA,20987.5
2015-12,100 PROOF VODKA,23682.75
2016-01,100 PROOF VODKA,18579.75
2016-02,100 PROOF VODKA,78968.62000000001
2016-03,100 PROOF VODKA,1007.75
2016-04,100 PROOF VODKA,5715.75
2016-05,100 PROOF VODKA,938.35
2016-06,100 PROOF VODKA,2282.5
2016-07,100 PROOF VODKA,1078.25
2016-08,100 PROOF VODKA,1092.0
2016-08,100% AGAVE TEQUILA,896.4899999999999
2016-09,100% AGAVE TEQUILA,18627.51
2016-10,100% AGAVE TEQUILA,18442.800000000003
2016-11,100% AGAVE TEQUILA,23408.62
2016-12,100% AGAVE TEQUILA,22305.759999999995
2017-01,100% AGAVE TEQUILA,17440.909999999996
2017-02,100% AGAVE TEQUILA,18223.79
2017-03,100% AGAVE TEQUILA,21474.829999999998
2017-04,100% AGAVE TEQUILA,25924.620000000003
2017-05,100% AGAVE TEQUILA,29597.199999999993
2017-06,100% AGAVE TEQUILA,26214.739999999998
2017-07,100% AGAVE TEQUILA,23481.46
2017-08,100% AGAVE TEQUILA,27977.459999999995
2017-09,100% AGAVE TEQUILA,20259.850000000002
2017-10,100% AGAVE TEQUILA,23859.82
2017-11,100% AGAVE TEQUILA,23581.21
2017-12,100% AGAVE TEQUILA,23363.65
2018-01,100% AGAVE TEQUILA,18609.000000000007
2018-02,100% AGAVE TEQUILA,20005.229999999996
2018-03,100% AGAVE TEQUILA,23341.210000000006
2018-04,100% AGAVE TEQUILA,28077.449999999993
2018-05,100% AGAVE TEQUILA,32202.639999999996
2018-06,100% AGAVE TEQUILA,28566.97
2018-07,100% AGAVE TEQUILA,25795.099999999995
2018-08,100% AGAVE TEQUILA,32746.43
2018-09,100% AGAVE TEQUILA,21986.579999999998
2018-10,100% AGAVE TEQUILA,36463.880000000005
2018-11,100% AGAVE TEQUILA,25767.660000000003
2018-12,100% AGAVE TEQUILA,27316.219999999987
2019-01,100% AGAVE TEQUILA,21465.680000000004
2019-02,100% AGAVE TEQUILA,20534.94
2019-03,100% AGAVE TEQUILA,25059.840000000004
2019-04,100% AGAVE TEQUILA,39754.00999999999
2019-05,100% AGAVE TEQUILA,41287.880000000005
2019-06,100% AGAVE TEQUILA,41581.069999999985
2019-07,100% AGAVE TEQUILA,37799.069999999985
2019-08,100% AGAVE TEQUILA,29998.979999999996
2019-09,100% AGAVE TEQUILA,23098.65
2019-10,100% AGAVE TEQUILA,28131.57
2019-11,100% AGAVE TEQUILA,26893.110000000004
2019-12,100% AGAVE TEQUILA,32177.309999999998
2020-01,100% AGAVE TEQUILA,26029.979999999992
2020-02,100% AGAVE TEQUILA,23893.790000000008
2020-03,100% AGAVE TEQUILA,32267.049999999996

2025-01-21 07:27:30 - root - INFO - itercount: 0
2025-01-21 07:27:30 - root - INFO - Database Name: IOWA_LIQUOR_SALES
Schema Name: IOWA_LIQUOR_SALES
DDL describes table information.
,0
table_name,SALES
description,
DDL,"create or replace TABLE SALES (
	""invoice_and_item_number"" VARCHAR(16777216),
	""date"" DATE,
	""store_number"" VARCHAR(16777216),
	""store_name"" VARCHAR(16777216),
	""address"" VARCHAR(16777216),
	""city"" VARCHAR(16777216),
	""zip_code"" VARCHAR(16777216),
	""store_location"" BINARY(8388608),
	""county_number"" VARCHAR(16777216),
	""county"" VARCHAR(16777216),
	""category"" VARCHAR(16777216),
	""category_name"" VARCHAR(16777216),
	""vendor_number"" VARCHAR(16777216),
	""vendor_name"" VARCHAR(16777216),
	""item_number"" VARCHAR(16777216),
	""item_description"" VARCHAR(16777216),
	""pack"" NUMBER(38,0),
	""bottle_volume_ml"" NUMBER(38,0),
	""state_bottle_cost"" FLOAT,
	""state_bottle_retail"" FLOAT,
	""bottles_sold"" NUMBER(38,0),
	""sale_dollars"" FLOAT,
	""volume_sold_liters"" FLOAT,
	""volume_sold_gallons"" FLOAT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'IOWA_LIQUOR_SALES': {'IOWA_LIQUOR_SALES': ['SALES']}}
Begin Exploring Related Columns
Considered tables and columns relevant to the task:

- **Table:** `SALES`
  
**Columns and potential usage:**

- `"date"`: Used to extract month and year for grouping sales data over months.
- `"category_name"`: Used to identify and group data by liquor categories.
- `"volume_sold_liters"`: Used to calculate the sales volume in liters.

**Conditions that may be used:**

- Limiting data to a specific time range (e.g., last 24 months).
- Filtering categories that contribute at least 1% to the monthly sales volume.
- Calculating percentages and correlations based on sales volumes.

---

Below are 10 SQL queries to explore the data:

1. **Query to retrieve distinct liquor categories:**

   ```sql
   SELECT DISTINCT "category_name"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   LIMIT 100;
   ```

2. **Query to determine the date range of the sales data:**

   ```sql
   SELECT MIN("date") AS "start_date", MAX("date") AS "end_date"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES;
   ```

3. **Query to get the total sales volume per category:**

   ```sql
   SELECT "category_name", SUM("volume_sold_liters") AS "total_volume_liters"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   GROUP BY "category_name"
   ORDER BY "total_volume_liters" DESC
   LIMIT 100;
   ```

4. **Query to calculate monthly sales volume per category:**

   ```sql
   SELECT TO_CHAR("date", 'YYYY-MM') AS "month", "category_name", SUM("volume_sold_liters") AS "monthly_volume"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   GROUP BY "month", "category_name"
   ORDER BY "month", "monthly_volume" DESC
   LIMIT 100;
   ```

5. **Query to find the total sales volume per month:**

   ```sql
   SELECT TO_CHAR("date", 'YYYY-MM') AS "month", SUM("volume_sold_liters") AS "total_monthly_volume"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   GROUP BY "month"
   ORDER BY "month" ASC
   LIMIT 100;
   ```

6. **Query to calculate each category's monthly percentage contribution to total sales volume:**

   ```sql
   SELECT
     category_month."month",
     category_month."category_name",
     (category_month."monthly_volume" / total_month."total_monthly_volume") * 100 AS "volume_percentage"
   FROM
     (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", "category_name", SUM("volume_sold_liters") AS "monthly_volume"
      FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
      GROUP BY "month", "category_name") AS category_month
   JOIN
     (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", SUM("volume_sold_liters") AS "total_monthly_volume"
      FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
      GROUP BY "month") AS total_month
   ON category_month."month" = total_month."month"
   ORDER BY category_month."month", "volume_percentage" DESC
   LIMIT 100;
   ```

7. **Query to list categories with their average monthly percentage contribution over all months:**

   ```sql
   SELECT
     "category_name",
     AVG("volume_percentage") AS "average_monthly_percentage"
   FROM
     (SELECT
        category_month."month",
        category_month."category_name",
        (category_month."monthly_volume" / total_month."total_monthly_volume") * 100 AS "volume_percentage"
      FROM
        (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", "category_name", SUM("volume_sold_liters") AS "monthly_volume"
         FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
         GROUP BY "month", "category_name") AS category_month
      JOIN
        (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", SUM("volume_sold_liters") AS "total_monthly_volume"
         FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
         GROUP BY "month") AS total_month
      ON category_month."month" = total_month."month"
     ) AS category_percentage
   GROUP BY "category_name"
   ORDER BY "average_monthly_percentage" DESC
   LIMIT 100;
   ```

8. **Query to identify categories contributing at least 1% on average to monthly sales volume:**

   ```sql
   SELECT
     "category_name",
     AVG("volume_percentage") AS "average_monthly_percentage"
   FROM
     (SELECT
        category_month."month",
        category_month."category_name",
        (category_month."monthly_volume" / total_month."total_monthly_volume") * 100 AS "volume_percentage"
      FROM
        (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", "category_name", SUM("volume_sold_liters") AS "monthly_volume"
         FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
         GROUP BY "month", "category_name") AS category_month
      JOIN
        (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", SUM("volume_sold_liters") AS "total_monthly_volume"
         FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
         GROUP BY "month") AS total_month
      ON category_month."month" = total_month."month"
     ) AS category_percentage
   GROUP BY "category_name"
   HAVING AVG("volume_percentage") >= 1
   ORDER BY "average_monthly_percentage" DESC
   LIMIT 100;
   ```

9. **Query to count the number of months in the dataset:**

   ```sql
   SELECT COUNT(DISTINCT TO_CHAR("date", 'YYYY-MM')) AS "number_of_months"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES;
   ```

10. **Query to retrieve monthly sales volumes for categories contributing at least 1% on average:**

    ```sql
    SELECT
      category_month."month",
      category_month."category_name",
      category_month."monthly_volume"
    FROM
      (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", "category_name", SUM("volume_sold_liters") AS "monthly_volume"
       FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
       GROUP BY "month", "category_name") AS category_month
    WHERE
      category_month."category_name" IN (
        SELECT "category_name"
        FROM
          (SELECT
             "category_name",
             AVG("volume_percentage") AS "average_monthly_percentage"
           FROM
             (SELECT
                category_month."month",
                category_month."category_name",
                (category_month."monthly_volume" / total_month."total_monthly_volume") * 100 AS "volume_percentage"
              FROM
                (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", "category_name", SUM("volume_sold_liters") AS "monthly_volume"
                 FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
                 GROUP BY "month", "category_name") AS category_month
              JOIN
                (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", SUM("volume_sold_liters") AS "total_monthly_volume"
                 FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
                 GROUP BY "month") AS total_month
              ON category_month."month" = total_month."month"
             ) AS category_percentage
           GROUP BY "category_name"
           HAVING AVG("volume_percentage") >= 1
          )
      )
    ORDER BY category_month."category_name", category_month."month"
    LIMIT 100;
    ```

---

These queries progressively explore the sales data to understand categories, time ranges, sales volumes, and the contribution of each category to monthly sales volumes. They set the groundwork for further analysis required to identify the two liquor categories with the lowest Pearson correlation coefficient in their sales percentages.Query:
SELECT DISTINCT "category_name"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   LIMIT 100;
Answer:
category_name
IMPORTED WHISKIES
COCKTAILS/RTD
LOW PROOF VODKA
VODKA FLAVORED
DARK CREME DE CACAO
WATERMELON SCHNAPPS
ANISETTE
IOWA DISTILLERY WHISKIES
100 PROOF VODKA
WHITE CREME DE CACAO
TENNESSEE WHISKIES
IRISH WHISKIES
VODKA 80 PROOF
IMPORTED DISTILLED SPIRITS SPECIALTY
TRIPLE SEC
CHERRY BRANDIES
IMPORTED FLAVORED VODKA
NEUTRAL GRAIN SPIRITS FLAVORED
DELISTED ITEMS
MISC. IMPORTED CORDIALS & LIQUEURS
MISCELLANEOUS SCHNAPPS
BLENDED WHISKIES
IMPORTED VODKA - MISC
APRICOT BRANDIES
FLAVORED GINS
AMERICAN CORDIALS & LIQUEURS
AMERICAN SLOE GINS
JAMAICA RUM
WHITE CREME DE MENTHE
GOLD RUM
DECANTERS & SPECIALTY PACKAGES
IMPORTED SCHNAPPS
TROPICAL FRUIT SCHNAPPS
IMPORTED AMARETTO
AMARETTO - IMPORTED
IMPORTED BRANDIES
100% AGAVE TEQUILA
SCOTCH WHISKIES
SINGLE BARREL BOURBON WHISKIES
SPEARMINT SCHNAPPS
ROOT BEER SCHNAPPS
AMERICAN FLAVORED VODKA
WHISKEY LIQUEUR
PEACH BRANDIES
SINGLE MALT SCOTCH
BOTTLED IN BOND BOURBON
JAPANESE WHISKY
PEACH SCHNAPPS
AMERICAN ALCOHOL
PUERTO RICO & VIRGIN ISLANDS RUM
TEQUILA
IMPORTED GRAPE BRANDIES
BARBADOS RUM
CINNAMON SCHNAPPS
IMPORTED GINS
MISC. AMERICAN CORDIALS & LIQUEURS
MIXTO TEQUILA
AMERICAN DISTILLED SPIRITS SPECIALTY
SPICED RUM
PEPPERMINT SCHNAPPS
CORN WHISKIES
AMERICAN DRY GINS
STRAWBERRY SCHNAPPS
IOWA DISTILLERIES
CREAM LIQUEURS
BUTTERSCOTCH SCHNAPPS
IMPORTED VODKA - CHERRY
AGED DARK RUM
AMERICAN GRAPE BRANDIES
MEZCAL
AMERICAN AMARETTO
STRAIGHT BOURBON WHISKIES
STRAIGHT RYE WHISKIES
DELISTED / SPECIAL ORDER ITEMS
COFFEE LIQUEURS
CREME DE ALMOND
HIGH PROOF BEER - AMERICAN
IMPORTED DRY GINS
IMPORTED VODKAS
AMERICAN COCKTAILS
BLACKBERRY BRANDIES
OTHER PROOF VODKA
GREEN CREME DE MENTHE
FLAVORED RUM
IMPORTED CORDIALS & LIQUEURS
FLAVORED GIN
AMERICAN VODKAS
RASPBERRY SCHNAPPS
TEMPORARY & SPECIALTY PACKAGES
SPECIAL ORDER ITEMS
APPLE SCHNAPPS
""
GRAPE SCHNAPPS
SCHNAPPS - IMPORTED
AMERICAN WHISKIES
CANADIAN WHISKIES
AMERICAN BRANDIES
MISCELLANEOUS  BRANDIES
AMERICAN SCHNAPPS
ROCK & RYE
Query:
SELECT MIN("date") AS "start_date", MAX("date") AS "end_date"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES;
Answer:
start_date,end_date
2012-01-03,2024-09-30
Query:
SELECT "category_name", SUM("volume_sold_liters") AS "total_volume_liters"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   GROUP BY "category_name"
   ORDER BY "total_volume_liters" DESC
   LIMIT 100;
Answer:
category_name,total_volume_liters
AMERICAN VODKAS,43578325.99000001
CANADIAN WHISKIES,35353278.57
SPICED RUM,18085561.129999995
VODKA 80 PROOF,17797396.77
STRAIGHT BOURBON WHISKIES,13291240.159999998
WHISKEY LIQUEUR,11803035.060000002
IMPORTED VODKAS,10417847.39
BLENDED WHISKIES,10343125.13
COCKTAILS/RTD,7344877.080000001
TENNESSEE WHISKIES,6199089.47
FLAVORED RUM,5807658.7700000005
AMERICAN FLAVORED VODKA,5654748.53
WHITE RUM,4705618.080000001
MIXTO TEQUILA,4690751.700000001
AMERICAN DRY GINS,4607653.11
CREAM LIQUEURS,4222257.319999999
100% AGAVE TEQUILA,4201076.46
AMERICAN SCHNAPPS,3931786.6799999997
PUERTO RICO & VIRGIN ISLANDS RUM,3889666.92
IMPORTED SCHNAPPS,3670160.7199999993
TEQUILA,3351430.8600000003
AMERICAN BRANDIES,3296756.13
AMERICAN COCKTAILS,3206271.1799999997
SCOTCH WHISKIES,3150192.29
VODKA FLAVORED,2907612.7600000002
IRISH WHISKIES,2818290.6399999997
IMPORTED CORDIALS & LIQUEURS,2680998.6899999995
TRIPLE SEC,2350501.6599999997
IMPORTED DRY GINS,2310817.4899999998
TEMPORARY & SPECIALTY PACKAGES,2284119.1799999997
IMPORTED BRANDIES,2177553.6999999993
IMPORTED FLAVORED VODKA,2038622.8
AMERICAN CORDIALS & LIQUEURS,1908081.4600000004
IMPORTED DISTILLED SPIRITS SPECIALTY,1848275.3599999996
MISC. IMPORTED CORDIALS & LIQUEURS,1453209.4600000002
IMPORTED VODKA - MISC,1301889.4399999995
AMERICAN GRAPE BRANDIES,1293088.4699999997
STRAIGHT RYE WHISKIES,1179474.28
SPECIAL ORDER ITEMS,1175383.4700000002
COFFEE LIQUEURS,1156503.3600000006
100 PROOF VODKA,959031.7200000001
GOLD RUM,817480.3099999999
PEPPERMINT SCHNAPPS,789853.18
SINGLE MALT SCOTCH,758599.1499999998
DISTILLED SPIRITS SPECIALTY,754358.4700000001
MISC. AMERICAN CORDIALS & LIQUEURS,688978.18
IMPORTED GRAPE BRANDIES,659869.7900000002
DECANTERS & SPECIALTY PACKAGES,522822.86999999994
PEACH SCHNAPPS,518755.7500000001
AMERICAN AMARETTO,414314.4900000002
NEUTRAL GRAIN SPIRITS FLAVORED,412364.17000000004
BLACKBERRY BRANDIES,373640.7299999999
AMERICAN DISTILLED SPIRITS SPECIALTY,305283.0299999999
NEUTRAL GRAIN SPIRITS,290027.9200000001
AGED DARK RUM,285129.8
APPLE SCHNAPPS,224426.81000000006
SINGLE BARREL BOURBON WHISKIES,203549.7
,191247.90000000005
BUTTERSCOTCH SCHNAPPS,190362.58000000007
APRICOT BRANDIES,180888.71999999994
AMERICAN ALCOHOL,171628.80000000002
BOTTLED IN BOND BOURBON,168498.22999999998
CINNAMON SCHNAPPS,151383.77000000002
WATERMELON SCHNAPPS,147316.75
GRAPE SCHNAPPS,133591.0
MISCELLANEOUS SCHNAPPS,133371.15000000002
FLAVORED GIN,121226.04999999996
ROOT BEER SCHNAPPS,93714.25
JAMAICA RUM,65725.0
PEACH BRANDIES,64483.360000000015
IMPORTED AMARETTO,64228.779999999984
CORN WHISKIES,62460.40000000001
RASPBERRY SCHNAPPS,61734.5
MEZCAL,59139.799999999996
CHERRY BRANDIES,56881.82
AMERICAN SLOE GINS,56105.0
TROPICAL FRUIT SCHNAPPS,54243.25
STRAWBERRY SCHNAPPS,54208.5
FLAVORED GINS,45033.45
BARBADOS RUM,44283.07
GREEN CREME DE MENTHE,34282.5
WHITE CREME DE CACAO,26446.5
DARK CREME DE CACAO,24541.5
SPEARMINT SCHNAPPS,18743.25
MISCELLANEOUS  BRANDIES,16564.99
OTHER PROOF VODKA,13520.5
IOWA DISTILLERIES,12138.75
ROCK & RYE,9125.25
WHITE CREME DE MENTHE,7937.25
IOWA DISTILLERY WHISKIES,7452.37
LOW PROOF VODKA,6966.0
CREME DE ALMOND,4998.0
ANISETTE,4072.5
JAPANESE WHISKY,1313.7
AMARETTO - IMPORTED,1131.75
SCHNAPPS - IMPORTED,288.05999999999995
IMPORTED GINS,234.0
IMPORTED VODKA - CHERRY,222.0
DELISTED ITEMS,111.97999999999999
HOLIDAY VAP,106.9
Query:
SELECT TO_CHAR("date", 'YYYY-MM') AS "month", "category_name", SUM("volume_sold_liters") AS "monthly_volume"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   GROUP BY "month", "category_name"
   ORDER BY "month", "monthly_volume" DESC
   LIMIT 100;
Answer:
month,category_name,monthly_volume
2012-01,VODKA 80 PROOF,239276.21999999994
2012-01,CANADIAN WHISKIES,129605.65
2012-01,SPICED RUM,83884.33000000002
2012-01,BLENDED WHISKIES,67090.8
2012-01,PUERTO RICO & VIRGIN ISLANDS RUM,59032.55000000002
2012-01,STRAIGHT BOURBON WHISKIES,53386.64999999999
2012-01,AMERICAN COCKTAILS,50729.25
2012-01,IMPORTED VODKAS,43234.12999999999
2012-01,TEQUILA,43016.159999999996
2012-01,VODKA FLAVORED,40753.85
2012-01,FLAVORED RUM,28902.120000000003
2012-01,AMERICAN DRY GINS,28517.209999999992
2012-01,IMPORTED SCHNAPPS,26458.480000000007
2012-01,MISC. IMPORTED CORDIALS & LIQUEURS,25854.409999999996
2012-01,WHISKEY LIQUEUR,24708.829999999998
2012-01,TENNESSEE WHISKIES,24678.31
2012-01,AMERICAN GRAPE BRANDIES,20746.23
2012-01,SCOTCH WHISKIES,18373.06000000001
2012-01,IMPORTED VODKA - MISC,18280.940000000002
2012-01,CREAM LIQUEURS,18068.860000000004
2012-01,MISC. AMERICAN CORDIALS & LIQUEURS,14408.490000000002
2012-01,100 PROOF VODKA,14100.75
2012-01,PEPPERMINT SCHNAPPS,12748.230000000003
2012-01,TRIPLE SEC,11289.5
2012-01,PEACH SCHNAPPS,9345.22
2012-01,DISTILLED SPIRITS SPECIALTY,9261.75
2012-01,AMERICAN AMARETTO,8013.5
2012-01,IMPORTED DRY GINS,7838.71
2012-01,BLACKBERRY BRANDIES,7161.849999999999
2012-01,COFFEE LIQUEURS,7132.12
2012-01,IMPORTED GRAPE BRANDIES,7040.820000000002
2012-01,IRISH WHISKIES,6428.46
2012-01,STRAIGHT RYE WHISKIES,5481.37
2012-01,APPLE SCHNAPPS,5160.99
2012-01,BUTTERSCOTCH SCHNAPPS,4265.61
2012-01,CINNAMON SCHNAPPS,3796.890000000001
2012-01,APRICOT BRANDIES,3403.620000000001
2012-01,GRAPE SCHNAPPS,2912.0
2012-01,AMERICAN ALCOHOL,2850.0
2012-01,SINGLE MALT SCOTCH,2638.2400000000002
2012-01,DECANTERS & SPECIALTY PACKAGES,2574.76
2012-01,WATERMELON SCHNAPPS,2522.0
2012-01,MISCELLANEOUS SCHNAPPS,2234.15
2012-01,ROOT BEER SCHNAPPS,2002.25
2012-01,IMPORTED AMARETTO,1526.6600000000003
2012-01,RASPBERRY SCHNAPPS,1363.0
2012-01,TROPICAL FRUIT SCHNAPPS,1328.75
2012-01,STRAWBERRY SCHNAPPS,1156.5
2012-01,CHERRY BRANDIES,1091.26
2012-01,JAMAICA RUM,987.75
2012-01,FLAVORED GINS,592.5
2012-01,WHITE CREME DE CACAO,590.25
2012-01,AMERICAN SLOE GINS,554.5
2012-01,GREEN CREME DE MENTHE,550.5
2012-01,PEACH BRANDIES,545.25
2012-01,DARK CREME DE CACAO,411.0
2012-01,SPEARMINT SCHNAPPS,319.75
2012-01,BOTTLED IN BOND BOURBON,293.25
2012-01,SINGLE BARREL BOURBON WHISKIES,279.0
2012-01,MISCELLANEOUS  BRANDIES,241.5
2012-01,,210.75
2012-01,OTHER PROOF VODKA,207.75
2012-01,BARBADOS RUM,165.0
2012-01,CREME DE ALMOND,120.75
2012-01,ROCK & RYE,120.0
2012-01,WHITE CREME DE MENTHE,92.25
2012-01,ANISETTE,51.0
2012-01,SCHNAPPS - IMPORTED,45.0
2012-01,LOW PROOF VODKA,17.25
2012-01,IMPORTED VODKA - CHERRY,12.0
2012-02,VODKA 80 PROOF,242492.53000000003
2012-02,CANADIAN WHISKIES,234011.37000000005
2012-02,SPICED RUM,104165.01000000001
2012-02,PUERTO RICO & VIRGIN ISLANDS RUM,65527.97000000001
2012-02,BLENDED WHISKIES,64533.07
2012-02,STRAIGHT BOURBON WHISKIES,55334.090000000004
2012-02,TEQUILA,50106.090000000004
2012-02,IMPORTED VODKAS,47198.920000000006
2012-02,AMERICAN COCKTAILS,43200.46000000001
2012-02,VODKA FLAVORED,39213.13
2012-02,TENNESSEE WHISKIES,31079.479999999996
2012-02,AMERICAN DRY GINS,31011.35999999999
2012-02,MISC. IMPORTED CORDIALS & LIQUEURS,28062.44
2012-02,FLAVORED RUM,27770.16
2012-02,WHISKEY LIQUEUR,27391.750000000004
2012-02,IMPORTED SCHNAPPS,26289.490000000013
2012-02,MISC. AMERICAN CORDIALS & LIQUEURS,22095.469999999998
2012-02,CREAM LIQUEURS,21083.79
2012-02,SCOTCH WHISKIES,20511.15
2012-02,IMPORTED VODKA - MISC,20453.409999999996
2012-02,AMERICAN GRAPE BRANDIES,20244.239999999987
2012-02,100 PROOF VODKA,14163.0
2012-02,PEPPERMINT SCHNAPPS,12880.190000000002
2012-02,TRIPLE SEC,12369.5
2012-02,IRISH WHISKIES,11407.81
2012-02,IMPORTED GRAPE BRANDIES,10588.620000000003
2012-02,DISTILLED SPIRITS SPECIALTY,10545.5
2012-02,IMPORTED DRY GINS,9061.09
2012-02,PEACH SCHNAPPS,8998.59
2012-02,AMERICAN AMARETTO,8527.0
Query:
SELECT TO_CHAR("date", 'YYYY-MM') AS "month", SUM("volume_sold_liters") AS "total_monthly_volume"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
   GROUP BY "month"
   ORDER BY "month" ASC
   LIMIT 100;
Answer:
month,total_monthly_volume
2012-01,1212082.4899999998
2012-02,1386565.5299999998
2012-03,1352873.0
2012-04,1499566.7800000007
2012-05,1709432.6399999994
2012-06,1618025.9499999993
2012-07,1548759.0399999998
2012-08,1626636.1199999999
2012-09,1308896.5200000003
2012-10,2362800.93
2012-11,1376736.2599999995
2012-12,1752904.16
2013-01,1326088.83
2013-02,1320254.6199999999
2013-03,1298132.8699999999
2013-04,1656555.23
2013-05,1684864.3499999996
2013-06,1437004.53
2013-07,1663535.5700000003
2013-08,1559804.9499999997
2013-09,1389415.98
2013-10,2241359.78
2013-11,1248725.5899999999
2013-12,1750707.92
2014-01,1467399.73
2014-02,1382314.37
2014-03,1377646.2600000002
2014-04,1637259.8899999997
2014-05,1541196.8699999999
2014-06,1727003.4499999995
2014-07,1602277.98
2014-08,1529543.5600000003
2014-09,1617234.9800000007
2014-10,1867398.29
2014-11,1379794.8699999999
2014-12,2028542.2600000007
2015-01,1321350.0599999998
2015-02,1494080.5700000003
2015-03,1579862.2699999996
2015-04,1597903.8399999994
2015-05,1602766.25
2015-06,1883666.33
2015-07,1570712.72
2015-08,1558103.9100000006
2015-09,1679661.1500000004
2015-10,1774251.8999999994
2015-11,1576465.1
2015-12,1978878.3699999999
2016-01,1301957.4300000002
2016-02,1648109.82
2016-03,1605508.7799999993
2016-04,1559814.74
2016-05,1823960.9899999995
2016-06,1907398.3599999996
2016-07,1519271.1199999999
2016-08,1587701.8100000005
2016-09,1728796.1200000003
2016-10,1785493.1300000006
2016-11,1741649.4600000002
2016-12,2090602.2500000005
2017-01,1359767.73
2017-02,1622074.6600000001
2017-03,1669404.4499999997
2017-04,1584324.5599999994
2017-05,1946475.9100000001
2017-06,1961078.6599999997
2017-07,1739276.3499999996
2017-08,1901480.55
2017-09,1651396.86
2017-10,1959416.5899999996
2017-11,1724606.1300000006
2017-12,1977547.6599999997
2018-01,1515722.01
2018-02,1541561.03
2018-03,1629002.7300000002
2018-04,1767687.5100000005
2018-05,2067618.2699999998
2018-06,1913407.5800000003
2018-07,1754940.8700000003
2018-08,2025107.2500000007
2018-09,1576146.3299999994
2018-10,2150140.1099999994
2018-11,1801354.8499999999
2018-12,2153293.6299999994
2019-01,1561962.7799999993
2019-02,1680941.5700000003
2019-03,1607152.3700000003
2019-04,1856193.5000000005
2019-05,2173322.88
2019-06,1862667.6400000004
2019-07,2062816.3800000001
2019-08,1807243.96
2019-09,1748074.9300000002
2019-10,2098335.5599999996
2019-11,1801591.5900000003
2019-12,2041118.8599999996
2020-01,1566948.29
2020-02,1630476.3699999996
2020-03,1956066.8100000003
2020-04,2036555.5500000003
Query:
SELECT
     category_month."month",
     category_month."category_name",
     (category_month."monthly_volume" / total_month."total_monthly_volume") * 100 AS "volume_percentage"
   FROM
     (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", "category_name", SUM("volume_sold_liters") AS "monthly_volume"
      FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
      GROUP BY "month", "category_name") AS category_month
   JOIN
     (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", SUM("volume_sold_liters") AS "total_monthly_volume"
      FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
      GROUP BY "month") AS total_month
   ON category_month."month" = total_month."month"
   ORDER BY category_month."month", "volume_percentage" DESC
   LIMIT 100;
Answer:
month,category_name,volume_percentage
2012-01,VODKA 80 PROOF,19.740918788456383
2012-01,CANADIAN WHISKIES,10.692807714762056
2012-01,SPICED RUM,6.920678311259162
2012-01,BLENDED WHISKIES,5.535167825087551
2012-01,PUERTO RICO & VIRGIN ISLANDS RUM,4.870340961694778
2012-01,STRAIGHT BOURBON WHISKIES,4.4045393313123435
2012-01,AMERICAN COCKTAILS,4.185296827446126
2012-01,IMPORTED VODKAS,3.566929673243609
2012-01,TEQUILA,3.5489465737600083
2012-01,VODKA FLAVORED,3.3623000361963813
2012-01,FLAVORED RUM,2.384501074675206
2012-01,AMERICAN DRY GINS,2.3527449852031115
2012-01,IMPORTED SCHNAPPS,2.1828943341966776
2012-01,MISC. IMPORTED CORDIALS & LIQUEURS,2.1330569671046065
2012-01,WHISKEY LIQUEUR,2.03854359780414
2012-01,TENNESSEE WHISKIES,2.0360256173653664
2012-01,AMERICAN GRAPE BRANDIES,1.7116186539416143
2012-01,SCOTCH WHISKIES,1.5158258741944213
2012-01,IMPORTED VODKA - MISC,1.5082257314021592
2012-01,CREAM LIQUEURS,1.4907285724422932
2012-01,MISC. AMERICAN CORDIALS & LIQUEURS,1.1887384001397463
2012-01,100 PROOF VODKA,1.1633490390575645
2012-01,PEPPERMINT SCHNAPPS,1.0517625743442596
2012-01,TRIPLE SEC,0.9314135047029678
2012-01,PEACH SCHNAPPS,0.7710052803419344
2012-01,DISTILLED SPIRITS SPECIALTY,0.7641187853476871
2012-01,AMERICAN AMARETTO,0.6611348704492876
2012-01,IMPORTED DRY GINS,0.6467142347712656
2012-01,BLACKBERRY BRANDIES,0.5908715008332477
2012-01,COFFEE LIQUEURS,0.5884186974766049
2012-01,IMPORTED GRAPE BRANDIES,0.5808862068455424
2012-01,IRISH WHISKIES,0.5303648929042776
2012-01,STRAIGHT RYE WHISKIES,0.4522274717457555
2012-01,APPLE SCHNAPPS,0.4257952773494814
2012-01,BUTTERSCOTCH SCHNAPPS,0.35192406747827865
2012-01,CINNAMON SCHNAPPS,0.31325343211582907
2012-01,APRICOT BRANDIES,0.280807620610046
2012-01,GRAPE SCHNAPPS,0.2402476748921602
2012-01,AMERICAN ALCOHOL,0.23513251148442876
2012-01,SINGLE MALT SCOTCH,0.21766175336795768
2012-01,DECANTERS & SPECIALTY PACKAGES,0.21242448605952552
2012-01,WATERMELON SCHNAPPS,0.20807164700481728
2012-01,MISCELLANEOUS SCHNAPPS,0.18432326334489002
2012-01,ROOT BEER SCHNAPPS,0.1651909021472623
2012-01,IMPORTED AMARETTO,0.12595347367818177
2012-01,RASPBERRY SCHNAPPS,0.11245109233448294
2012-01,TROPICAL FRUIT SCHNAPPS,0.10962537706488938
2012-01,STRAWBERRY SCHNAPPS,0.09541429808131294
2012-01,CHERRY BRANDIES,0.09003182613420971
2012-01,JAMAICA RUM,0.0814919783223665
2012-01,FLAVORED GINS,0.04888281159807861
2012-01,WHITE CREME DE CACAO,0.048697180667959326
2012-01,AMERICAN SLOE GINS,0.04574771144495289
2012-01,GREEN CREME DE MENTHE,0.04541770090251861
2012-01,PEACH BRANDIES,0.04498456206557361
2012-01,DARK CREME DE CACAO,0.033908583235122886
2012-01,SPEARMINT SCHNAPPS,0.026380217735840737
2012-01,BOTTLED IN BOND BOURBON,0.02419389789221359
2012-01,SINGLE BARREL BOURBON WHISKIES,0.023018235334791446
2012-01,MISCELLANEOUS  BRANDIES,0.019924386499470016
2012-01,,0.017387430454506442
2012-01,OTHER PROOF VODKA,0.01713992254768073
2012-01,BARBADOS RUM,0.013612934875414297
2012-01,CREME DE ALMOND,0.009962193249735008
2012-01,ROCK & RYE,0.009900316273028578
2012-01,WHITE CREME DE MENTHE,0.00761086813489072
2012-01,ANISETTE,0.004207634416037146
2012-01,SCHNAPPS - IMPORTED,0.003712618602385717
2012-01,LOW PROOF VODKA,0.0014231704642478581
2012-01,IMPORTED VODKA - CHERRY,0.000990031627302858
2012-02,VODKA 80 PROOF,17.48871760860808
2012-02,CANADIAN WHISKIES,16.877050881251893
2012-02,SPICED RUM,7.512447680709328
2012-02,PUERTO RICO & VIRGIN ISLANDS RUM,4.72591944500452
2012-02,BLENDED WHISKIES,4.6541666155511585
2012-02,STRAIGHT BOURBON WHISKIES,3.9907302469865957
2012-02,TEQUILA,3.6136835162778063
2012-02,IMPORTED VODKAS,3.4040165415045327
2012-02,AMERICAN COCKTAILS,3.11564502833126
2012-02,VODKA FLAVORED,2.828076217933962
2012-02,TENNESSEE WHISKIES,2.241472135831906
2012-02,AMERICAN DRY GINS,2.2365592775121117
2012-02,MISC. IMPORTED CORDIALS & LIQUEURS,2.0238812658208802
2012-02,FLAVORED RUM,2.0028018437758215
2012-02,WHISKEY LIQUEUR,1.9755106705991745
2012-02,IMPORTED SCHNAPPS,1.896014968726361
2012-02,MISC. AMERICAN CORDIALS & LIQUEURS,1.593539542267432
2012-02,CREAM LIQUEURS,1.5205765283953072
2012-02,SCOTCH WHISKIES,1.4792773623905098
2012-02,IMPORTED VODKA - MISC,1.4751131163631332
2012-02,AMERICAN GRAPE BRANDIES,1.4600276411025441
2012-02,100 PROOF VODKA,1.0214446914744806
2012-02,PEPPERMINT SCHNAPPS,0.9289276071935814
2012-02,TRIPLE SEC,0.8920963151305225
2012-02,IRISH WHISKIES,0.8227386122890272
2012-02,IMPORTED GRAPE BRANDIES,0.7636581013232024
2012-02,DISTILLED SPIRITS SPECIALTY,0.760548259121947
2012-02,IMPORTED DRY GINS,0.6534916528611524
2012-02,PEACH SCHNAPPS,0.6489841125648059
2012-02,AMERICAN AMARETTO,0.6149727377111415
Query:
SELECT
     "category_name",
     AVG("volume_percentage") AS "average_monthly_percentage"
   FROM
     (SELECT
        category_month."month",
        category_month."category_name",
        (category_month."monthly_volume" / total_month."total_monthly_volume") * 100 AS "volume_percentage"
      FROM
        (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", "category_name", SUM("volume_sold_liters") AS "monthly_volume"
         FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
         GROUP BY "month", "category_name") AS category_month
      JOIN
        (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", SUM("volume_sold_liters") AS "total_monthly_volume"
         FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
         GROUP BY "month") AS total_month
      ON category_month."month" = total_month."month"
     ) AS category_percentage
   GROUP BY "category_name"
   ORDER BY "average_monthly_percentage" DESC
   LIMIT 100;
Answer:
category_name,average_monthly_percentage
AMERICAN VODKAS,23.21156067164384
VODKA 80 PROOF,19.98911814597784
CANADIAN WHISKIES,12.846569201285472
SPICED RUM,6.63366832927565
STRAIGHT BOURBON WHISKIES,4.77922915934246
PUERTO RICO & VIRGIN ISLANDS RUM,4.380897163822909
WHISKEY LIQUEUR,4.23948593933842
COCKTAILS/RTD,3.8749806651602934
BLENDED WHISKIES,3.836941878100829
IMPORTED VODKAS,3.814308724253921
TEQUILA,3.776803816848492
AMERICAN COCKTAILS,3.6147245155504635
VODKA FLAVORED,3.2600479470398684
AMERICAN FLAVORED VODKA,3.0131590305263667
WHITE RUM,2.5156675926018526
MIXTO TEQUILA,2.4962369977908465
TENNESSEE WHISKIES,2.254553462817315
100% AGAVE TEQUILA,2.2011268984503154
AMERICAN SCHNAPPS,2.1070002633160447
FLAVORED RUM,2.106856927639865
AMERICAN BRANDIES,1.7717188611942372
AMERICAN DRY GINS,1.715339041730076
MISC. IMPORTED CORDIALS & LIQUEURS,1.643144270725072
CREAM LIQUEURS,1.5341837293758045
IMPORTED VODKA - MISC,1.4644595366481572
AMERICAN GRAPE BRANDIES,1.4587593663076601
IMPORTED CORDIALS & LIQUEURS,1.4266010593150484
IMPORTED SCHNAPPS,1.3494648110187932
TEMPORARY & SPECIALTY PACKAGES,1.1949668899206516
SCOTCH WHISKIES,1.1672623847938823
IMPORTED BRANDIES,1.1544979014680163
IMPORTED FLAVORED VODKA,1.086978395901683
100 PROOF VODKA,1.0855406376304846
AMERICAN CORDIALS & LIQUEURS,1.0259900695077675
IRISH WHISKIES,1.0104208675045347
IMPORTED DISTILLED SPIRITS SPECIALTY,0.9790846251860491
PEPPERMINT SCHNAPPS,0.887381282142442
TRIPLE SEC,0.8598156069343933
IMPORTED DRY GINS,0.83773254837913
MISC. AMERICAN CORDIALS & LIQUEURS,0.7764740170238629
IMPORTED GRAPE BRANDIES,0.7421926249728007
SPECIAL ORDER ITEMS,0.6215479173638517
DISTILLED SPIRITS SPECIALTY,0.614906930955018
PEACH SCHNAPPS,0.5888059426851562
DECANTERS & SPECIALTY PACKAGES,0.5341673654963249
AMERICAN AMARETTO,0.4709215788228319
GOLD RUM,0.43800563747257426
STRAIGHT RYE WHISKIES,0.4261299069707224
BLACKBERRY BRANDIES,0.4239016785793931
COFFEE LIQUEURS,0.4238453173203895
SINGLE MALT SCOTCH,0.2735606859083315
APPLE SCHNAPPS,0.25689994548352935
BUTTERSCOTCH SCHNAPPS,0.21606976327261687
NEUTRAL GRAIN SPIRITS FLAVORED,0.21393550785622498
APRICOT BRANDIES,0.20467814719595387
AMERICAN ALCOHOL,0.192027505374809
CINNAMON SCHNAPPS,0.17248540755658853
WATERMELON SCHNAPPS,0.16712363567309518
AMERICAN DISTILLED SPIRITS SPECIALTY,0.15824304740994824
NEUTRAL GRAIN SPIRITS,0.15350968921217575
GRAPE SCHNAPPS,0.15257947827709245
AGED DARK RUM,0.15103698410598584
MISCELLANEOUS SCHNAPPS,0.15083439729063478
,0.10680653023729461
ROOT BEER SCHNAPPS,0.10664758301399259
IMPORTED AMARETTO,0.07827016957892703
JAMAICA RUM,0.07391948390877782
PEACH BRANDIES,0.07145068337366521
SINGLE BARREL BOURBON WHISKIES,0.07040151830115142
RASPBERRY SCHNAPPS,0.0701028888875891
CHERRY BRANDIES,0.06457247631462931
FLAVORED GIN,0.06373269240319517
TROPICAL FRUIT SCHNAPPS,0.06210982763342481
STRAWBERRY SCHNAPPS,0.06181374410399589
BOTTLED IN BOND BOURBON,0.05771101016768754
FLAVORED GINS,0.05110278204869394
BARBADOS RUM,0.04965279751388498
GREEN CREME DE MENTHE,0.038516517402351284
MEZCAL,0.030817982282738774
WHITE CREME DE CACAO,0.030324630520731474
CORN WHISKIES,0.030258744720055006
DARK CREME DE CACAO,0.027921190618576838
IOWA DISTILLERIES,0.027177471625577168
AMERICAN SLOE GINS,0.02129985747968865
SPEARMINT SCHNAPPS,0.02126867898536337
MISCELLANEOUS  BRANDIES,0.018375319064891118
IOWA DISTILLERY WHISKIES,0.016662550156904404
OTHER PROOF VODKA,0.015473222983465144
ROCK & RYE,0.010378321385332812
LOW PROOF VODKA,0.010285774222367776
WHITE CREME DE MENTHE,0.010225936350506646
JAPANESE WHISKY,0.006220941670409949
CREME DE ALMOND,0.005833093518711603
ANISETTE,0.004683147064224649
AMERICAN WHISKIES,0.002395587844057472
AMARETTO - IMPORTED,0.0019197529212686229
HOLIDAY VAP,0.001405422119778114
DELISTED ITEMS,0.001378963963727594
SCHNAPPS - IMPORTED,0.001341477833351315
IMPORTED VODKA - CHERRY,0.00122051761228994
Query:
SELECT
     "category_name",
     AVG("volume_percentage") AS "average_monthly_percentage"
   FROM
     (SELECT
        category_month."month",
        category_month."category_name",
        (category_month."monthly_volume" / total_month."total_monthly_volume") * 100 AS "volume_percentage"
      FROM
        (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", "category_name", SUM("volume_sold_liters") AS "monthly_volume"
         FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
         GROUP BY "month", "category_name") AS category_month
      JOIN
        (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", SUM("volume_sold_liters") AS "total_monthly_volume"
         FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
         GROUP BY "month") AS total_month
      ON category_month."month" = total_month."month"
     ) AS category_percentage
   GROUP BY "category_name"
   HAVING AVG("volume_percentage") >= 1
   ORDER BY "average_monthly_percentage" DESC
   LIMIT 100;
Answer:
category_name,average_monthly_percentage
AMERICAN VODKAS,23.21156067164384
VODKA 80 PROOF,19.989118145977837
CANADIAN WHISKIES,12.846569201285467
SPICED RUM,6.6336683292756495
STRAIGHT BOURBON WHISKIES,4.779229159342459
PUERTO RICO & VIRGIN ISLANDS RUM,4.38089716382291
WHISKEY LIQUEUR,4.239485939338419
COCKTAILS/RTD,3.8749806651602947
BLENDED WHISKIES,3.8369418781008275
IMPORTED VODKAS,3.8143087242539195
TEQUILA,3.776803816848492
AMERICAN COCKTAILS,3.614724515550464
VODKA FLAVORED,3.260047947039869
AMERICAN FLAVORED VODKA,3.0131590305263667
WHITE RUM,2.5156675926018512
MIXTO TEQUILA,2.496236997790848
TENNESSEE WHISKIES,2.2545534628173147
100% AGAVE TEQUILA,2.2011268984503154
AMERICAN SCHNAPPS,2.107000263316044
FLAVORED RUM,2.106856927639865
AMERICAN BRANDIES,1.7717188611942374
AMERICAN DRY GINS,1.7153390417300753
MISC. IMPORTED CORDIALS & LIQUEURS,1.6431442707250716
CREAM LIQUEURS,1.5341837293758038
IMPORTED VODKA - MISC,1.4644595366481574
AMERICAN GRAPE BRANDIES,1.45875936630766
IMPORTED CORDIALS & LIQUEURS,1.426601059315048
IMPORTED SCHNAPPS,1.3494648110187932
TEMPORARY & SPECIALTY PACKAGES,1.1949668899206514
SCOTCH WHISKIES,1.1672623847938821
IMPORTED BRANDIES,1.1544979014680168
IMPORTED FLAVORED VODKA,1.086978395901683
100 PROOF VODKA,1.0855406376304844
AMERICAN CORDIALS & LIQUEURS,1.0259900695077677
IRISH WHISKIES,1.010420867504535
Query:
SELECT COUNT(DISTINCT TO_CHAR("date", 'YYYY-MM')) AS "number_of_months"
   FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES;
Answer:
number_of_months
153
Query:
SELECT
      category_month."month",
      category_month."category_name",
      category_month."monthly_volume"
    FROM
      (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", "category_name", SUM("volume_sold_liters") AS "monthly_volume"
       FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
       GROUP BY "month", "category_name") AS category_month
    WHERE
      category_month."category_name" IN (
        SELECT "category_name"
        FROM
          (SELECT
             "category_name",
             AVG("volume_percentage") AS "average_monthly_percentage"
           FROM
             (SELECT
                category_month."month",
                category_month."category_name",
                (category_month."monthly_volume" / total_month."total_monthly_volume") * 100 AS "volume_percentage"
              FROM
                (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", "category_name", SUM("volume_sold_liters") AS "monthly_volume"
                 FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
                 GROUP BY "month", "category_name") AS category_month
              JOIN
                (SELECT TO_CHAR("date", 'YYYY-MM') AS "month", SUM("volume_sold_liters") AS "total_monthly_volume"
                 FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
                 GROUP BY "month") AS total_month
              ON category_month."month" = total_month."month"
             ) AS category_percentage
           GROUP BY "category_name"
           HAVING AVG("volume_percentage") >= 1
          )
      )
    ORDER BY category_month."category_name", category_month."month"
    LIMIT 100;
Answer:
month,category_name,monthly_volume
2012-01,100 PROOF VODKA,14100.75
2012-02,100 PROOF VODKA,14163.0
2012-03,100 PROOF VODKA,16090.0
2012-04,100 PROOF VODKA,14406.0
2012-05,100 PROOF VODKA,17656.25
2012-06,100 PROOF VODKA,16616.25
2012-07,100 PROOF VODKA,16528.5
2012-08,100 PROOF VODKA,18921.75
2012-09,100 PROOF VODKA,14106.75
2012-10,100 PROOF VODKA,20406.5
2012-11,100 PROOF VODKA,14130.5
2012-12,100 PROOF VODKA,15879.75
2013-01,100 PROOF VODKA,13943.75
2013-02,100 PROOF VODKA,13145.0
2013-03,100 PROOF VODKA,16281.5
2013-04,100 PROOF VODKA,17923.25
2013-05,100 PROOF VODKA,18085.75
2013-06,100 PROOF VODKA,18799.0
2013-07,100 PROOF VODKA,20754.75
2013-08,100 PROOF VODKA,20380.0
2013-09,100 PROOF VODKA,18212.5
2013-10,100 PROOF VODKA,21499.0
2013-11,100 PROOF VODKA,14686.25
2013-12,100 PROOF VODKA,17733.5
2014-01,100 PROOF VODKA,15742.0
2014-02,100 PROOF VODKA,14233.75
2014-03,100 PROOF VODKA,15658.25
2014-04,100 PROOF VODKA,16558.75
2014-05,100 PROOF VODKA,16650.75
2014-06,100 PROOF VODKA,19033.5
2014-07,100 PROOF VODKA,18204.0
2014-08,100 PROOF VODKA,16906.5
2014-09,100 PROOF VODKA,15911.0
2014-10,100 PROOF VODKA,17242.5
2014-11,100 PROOF VODKA,15652.5
2014-12,100 PROOF VODKA,19919.25
2015-01,100 PROOF VODKA,15121.5
2015-02,100 PROOF VODKA,14573.5
2015-03,100 PROOF VODKA,19845.75
2015-04,100 PROOF VODKA,21206.25
2015-05,100 PROOF VODKA,18079.0
2015-06,100 PROOF VODKA,24351.5
2015-07,100 PROOF VODKA,20954.75
2015-08,100 PROOF VODKA,21320.5
2015-09,100 PROOF VODKA,23366.0
2015-10,100 PROOF VODKA,19716.75
2015-11,100 PROOF VODKA,20987.5
2015-12,100 PROOF VODKA,23682.75
2016-01,100 PROOF VODKA,18579.75
2016-02,100 PROOF VODKA,78968.62000000001
2016-03,100 PROOF VODKA,1007.75
2016-04,100 PROOF VODKA,5715.75
2016-05,100 PROOF VODKA,938.35
2016-06,100 PROOF VODKA,2282.5
2016-07,100 PROOF VODKA,1078.25
2016-08,100 PROOF VODKA,1092.0
2016-08,100% AGAVE TEQUILA,896.4899999999999
2016-09,100% AGAVE TEQUILA,18627.51
2016-10,100% AGAVE TEQUILA,18442.800000000003
2016-11,100% AGAVE TEQUILA,23408.62
2016-12,100% AGAVE TEQUILA,22305.759999999995
2017-01,100% AGAVE TEQUILA,17440.909999999996
2017-02,100% AGAVE TEQUILA,18223.79
2017-03,100% AGAVE TEQUILA,21474.829999999998
2017-04,100% AGAVE TEQUILA,25924.620000000003
2017-05,100% AGAVE TEQUILA,29597.199999999993
2017-06,100% AGAVE TEQUILA,26214.739999999998
2017-07,100% AGAVE TEQUILA,23481.46
2017-08,100% AGAVE TEQUILA,27977.459999999995
2017-09,100% AGAVE TEQUILA,20259.850000000002
2017-10,100% AGAVE TEQUILA,23859.82
2017-11,100% AGAVE TEQUILA,23581.21
2017-12,100% AGAVE TEQUILA,23363.65
2018-01,100% AGAVE TEQUILA,18609.000000000007
2018-02,100% AGAVE TEQUILA,20005.229999999996
2018-03,100% AGAVE TEQUILA,23341.210000000006
2018-04,100% AGAVE TEQUILA,28077.449999999993
2018-05,100% AGAVE TEQUILA,32202.639999999996
2018-06,100% AGAVE TEQUILA,28566.97
2018-07,100% AGAVE TEQUILA,25795.099999999995
2018-08,100% AGAVE TEQUILA,32746.43
2018-09,100% AGAVE TEQUILA,21986.579999999998
2018-10,100% AGAVE TEQUILA,36463.880000000005
2018-11,100% AGAVE TEQUILA,25767.660000000003
2018-12,100% AGAVE TEQUILA,27316.219999999987
2019-01,100% AGAVE TEQUILA,21465.680000000004
2019-02,100% AGAVE TEQUILA,20534.94
2019-03,100% AGAVE TEQUILA,25059.840000000004
2019-04,100% AGAVE TEQUILA,39754.00999999999
2019-05,100% AGAVE TEQUILA,41287.880000000005
2019-06,100% AGAVE TEQUILA,41581.069999999985
2019-07,100% AGAVE TEQUILA,37799.069999999985
2019-08,100% AGAVE TEQUILA,29998.979999999996
2019-09,100% AGAVE TEQUILA,23098.65
2019-10,100% AGAVE TEQUILA,28131.57
2019-11,100% AGAVE TEQUILA,26893.110000000004
2019-12,100% AGAVE TEQUILA,32177.309999999998
2020-01,100% AGAVE TEQUILA,26029.979999999992
2020-02,100% AGAVE TEQUILA,23893.790000000008
2020-03,100% AGAVE TEQUILA,32267.049999999996
End Exploring Related Columns
Task: Which two liquor categories, each contributing an average of at least 1% to monthly sales volume over 24 months, have the lowest Pearson correlation coefficient in their sales percentages?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Category_1,Category_2,Lowest_Pearson_Correlation_Coefficient
category_name_1,category_name_2,correlation_coefficient:float
(Attention: answer in one row)
```

**Explanation:**

The two liquor categories listed above each contributed an average of at least 1% to the monthly sales volume over a 24-month period and have the lowest Pearson correlation coefficient in their sales percentages. This low correlation coefficient indicates that the sales patterns of these two categories are the least similar among all categories meeting the 1% threshold, suggesting that their sales percentages move independently of each other over time..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'IOWA_LIQUOR_SALES': {'IOWA_LIQUOR_SALES': ['SALES']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-21 07:28:51 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 07:28:51 - root - INFO - ```sql
WITH latest_month AS (
    SELECT DATE_TRUNC('month', MAX("date")) AS latest_month
    FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
    WHERE "date" <= CURRENT_DATE()
),
start_month AS (
    SELECT DATEADD(month, -23, latest_month) AS start_month
    FROM latest_month
),
monthly_sales AS (
    SELECT
        DATE_TRUNC('month', "date") AS "month",
        "category_name",
        SUM("volume_sold_liters") AS monthly_volume
    FROM
        IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
    WHERE
        "date" >= (SELECT start_month FROM start_month)
        AND "date" <= (SELECT latest_month FROM latest_month)
    GROUP BY
        DATE_TRUNC('month', "date"), "category_name"
),
total_monthly_sales AS (
    SELECT
        "month",
        SUM(monthly_volume) AS total_monthly_volume
    FROM
        monthly_sales
    GROUP BY
        "month"
),
monthly_sales_percentage AS (
    SELECT
        ms."month",
        ms."category_name",
        (ms.monthly_volume / tms.total_monthly_volume) * 100 AS volume_percentage
    FROM
        monthly_sales ms
    JOIN
        total_monthly_sales tms ON ms."month" = tms."month"
),
average_monthly_percentage AS (
    SELECT
        "category_name",
        AVG(volume_percentage) AS average_monthly_percentage
    FROM
        monthly_sales_percentage
    GROUP BY
        "category_name"
),
selected_categories AS (
    SELECT
        "category_name"
    FROM
        average_monthly_percentage
    WHERE
        average_monthly_percentage >= 1
),
filtered_monthly_percentage AS (
    SELECT
        msp."month",
        msp."category_name",
        msp.volume_percentage
    FROM
        monthly_sales_percentage msp
    WHERE
        msp."category_name" IN (SELECT "category_name" FROM selected_categories)
),
category_pairs AS (
    SELECT
        c1."category_name" AS category1,
        c2."category_name" AS category2
    FROM
        selected_categories c1
    JOIN
        selected_categories c2 ON c1."category_name" < c2."category_name"
),
correlation_results AS (
    SELECT
        cp.category1,
        cp.category2,
        CORR(fp1.volume_percentage, fp2.volume_percentage) AS correlation_coefficient
    FROM
        category_pairs cp
    JOIN
        filtered_monthly_percentage fp1 ON fp1."category_name" = cp.category1
    JOIN
        filtered_monthly_percentage fp2 ON fp2."category_name" = cp.category2
        AND fp1."month" = fp2."month"
    GROUP BY
        cp.category1,
        cp.category2
)
SELECT
    'Category_1,Category_2,Lowest_Pearson_Correlation_Coefficient'
UNION ALL
SELECT
    category1 || ',' || category2 || ',' || TO_CHAR(correlation_coefficient, '0.0000')
FROM
    correlation_results
ORDER BY
    correlation_coefficient
LIMIT 1;
```
2025-01-21 07:28:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 07:28:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 07:28:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 07:28:52 - snowflake.connector.connection - INFO - closed
2025-01-21 07:28:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 07:28:52 - root - INFO - itercount: 1
2025-01-21 07:28:52 - root - INFO - 000904 (42000): 01b9dae0-0004-7e70-0001-11c300f3f0ce: SQL compilation error: error line 102 at position 4
invalid identifier 'CORRELATION_COEFFICIENT'
2025-01-21 07:28:52 - root - INFO - Input sql:
WITH latest_month AS (
    SELECT DATE_TRUNC('month', MAX("date")) AS latest_month
    FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
    WHERE "date" <= CURRENT_DATE()
),
start_month AS (
    SELECT DATEADD(month, -23, latest_month) AS start_month
    FROM latest_month
),
monthly_sales AS (
    SELECT
        DATE_TRUNC('month', "date") AS "month",
        "category_name",
        SUM("volume_sold_liters") AS monthly_volume
    FROM
        IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
    WHERE
        "date" >= (SELECT start_month FROM start_month)
        AND "date" <= (SELECT latest_month FROM latest_month)
    GROUP BY
        DATE_TRUNC('month', "date"), "category_name"
),
total_monthly_sales AS (
    SELECT
        "month",
        SUM(monthly_volume) AS total_monthly_volume
    FROM
        monthly_sales
    GROUP BY
        "month"
),
monthly_sales_percentage AS (
    SELECT
        ms."month",
        ms."category_name",
        (ms.monthly_volume / tms.total_monthly_volume) * 100 AS volume_percentage
    FROM
        monthly_sales ms
    JOIN
        total_monthly_sales tms ON ms."month" = tms."month"
),
average_monthly_percentage AS (
    SELECT
        "category_name",
        AVG(volume_percentage) AS average_monthly_percentage
    FROM
        monthly_sales_percentage
    GROUP BY
        "category_name"
),
selected_categories AS (
    SELECT
        "category_name"
    FROM
        average_monthly_percentage
    WHERE
        average_monthly_percentage >= 1
),
filtered_monthly_percentage AS (
    SELECT
        msp."month",
        msp."category_name",
        msp.volume_percentage
    FROM
        monthly_sales_percentage msp
    WHERE
        msp."category_name" IN (SELECT "category_name" FROM selected_categories)
),
category_pairs AS (
    SELECT
        c1."category_name" AS category1,
        c2."category_name" AS category2
    FROM
        selected_categories c1
    JOIN
        selected_categories c2 ON c1."category_name" < c2."category_name"
),
correlation_results AS (
    SELECT
        cp.category1,
        cp.category2,
        CORR(fp1.volume_percentage, fp2.volume_percentage) AS correlation_coefficient
    FROM
        category_pairs cp
    JOIN
        filtered_monthly_percentage fp1 ON fp1."category_name" = cp.category1
    JOIN
        filtered_monthly_percentage fp2 ON fp2."category_name" = cp.category2
        AND fp1."month" = fp2."month"
    GROUP BY
        cp.category1,
        cp.category2
)
SELECT
    'Category_1,Category_2,Lowest_Pearson_Correlation_Coefficient'
UNION ALL
SELECT
    category1 || ',' || category2 || ',' || TO_CHAR(correlation_coefficient, '0.0000')
FROM
    correlation_results
ORDER BY
    correlation_coefficient
LIMIT 1;
The error information is:
000904 (42000): 01b9dae0-0004-7e70-0001-11c300f3f0ce: SQL compilation error: error line 102 at position 4
invalid identifier 'CORRELATION_COEFFICIENT'
Please correct it and output only 1 complete SQL query.
2025-01-21 07:29:45 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 07:29:45 - root - INFO - ```sql
WITH latest_month AS (
    SELECT DATE_TRUNC('month', MAX("date")) AS latest_month
    FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
    WHERE "date" <= CURRENT_DATE()
),
start_month AS (
    SELECT DATEADD(month, -23, latest_month) AS start_month
    FROM latest_month
),
monthly_sales AS (
    SELECT
        DATE_TRUNC('month', "date") AS "month",
        "category_name",
        SUM("volume_sold_liters") AS monthly_volume
    FROM
        IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
    WHERE
        "date" >= (SELECT start_month FROM start_month)
        AND "date" <= (SELECT latest_month FROM latest_month)
    GROUP BY
        DATE_TRUNC('month', "date"), "category_name"
),
total_monthly_sales AS (
    SELECT
        "month",
        SUM(monthly_volume) AS total_monthly_volume
    FROM
        monthly_sales
    GROUP BY
        "month"
),
monthly_sales_percentage AS (
    SELECT
        ms."month",
        ms."category_name",
        (ms.monthly_volume / tms.total_monthly_volume) * 100 AS volume_percentage
    FROM
        monthly_sales ms
    JOIN
        total_monthly_sales tms ON ms."month" = tms."month"
),
average_monthly_percentage AS (
    SELECT
        "category_name",
        AVG(volume_percentage) AS average_monthly_percentage
    FROM
        monthly_sales_percentage
    GROUP BY
        "category_name"
),
selected_categories AS (
    SELECT
        "category_name"
    FROM
        average_monthly_percentage
    WHERE
        average_monthly_percentage >= 1
),
filtered_monthly_percentage AS (
    SELECT
        msp."month",
        msp."category_name",
        msp.volume_percentage
    FROM
        monthly_sales_percentage msp
    WHERE
        msp."category_name" IN (SELECT "category_name" FROM selected_categories)
),
category_pairs AS (
    SELECT
        c1."category_name" AS category1,
        c2."category_name" AS category2
    FROM
        selected_categories c1
    JOIN
        selected_categories c2 ON c1."category_name" < c2."category_name"
),
correlation_results AS (
    SELECT
        cp.category1,
        cp.category2,
        CORR(fp1.volume_percentage, fp2.volume_percentage) AS correlation_coefficient
    FROM
        category_pairs cp
    JOIN
        filtered_monthly_percentage fp1 ON fp1."category_name" = cp.category1
    JOIN
        filtered_monthly_percentage fp2 ON fp2."category_name" = cp.category2
        AND fp1."month" = fp2."month"
    GROUP BY
        cp.category1,
        cp.category2
)
SELECT
    'Category_1,Category_2,Lowest_Pearson_Correlation_Coefficient'
UNION ALL
SELECT
    category1 || ',' || category2 || ',' || TO_CHAR(correlation_coefficient, '0.0000')
FROM
    (SELECT * FROM correlation_results ORDER BY correlation_coefficient LIMIT 1);
```
2025-01-21 07:29:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 07:29:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 07:29:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 07:29:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 2
2025-01-21 07:29:47 - snowflake.connector.connection - INFO - closed
2025-01-21 07:29:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 07:29:47 - root - INFO - itercount: 2
2025-01-21 07:29:47 - root - INFO - 0
2025-01-21 07:29:47 - root - INFO - results: 
"'CATEGORY_1,CATEGORY_2,LOWEST_PEARSON_CORRELATION_COEFFICIENT'"
"AMERICAN FLAVORED VODKA,CREAM LIQUEURS,-0.7626"
"Category_1,Category_2,Lowest_Pearson_Correlation_Coefficient"


2025-01-21 07:29:47 - root - INFO - Please check the answer again by reviewing Which two liquor categories, each contributing an average of at least 1% to monthly sales volume over 24 months, have the lowest Pearson correlation coefficient in their sales percentages?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Category_1,Category_2,Lowest_Pearson_Correlation_Coefficient
category_name_1,category_name_2,correlation_coefficient:float
(Attention: answer in one row)
```

**Explanation:**

The two liquor categories listed above each contributed an average of at least 1% to the monthly sales volume over a 24-month period and have the lowest Pearson correlation coefficient in their sales percentages. This low correlation coefficient indicates that the sales patterns of these two categories are the least similar among all categories meeting the 1% threshold, suggesting that their sales percentages move independently of each other over time. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
"'CATEGORY_1,CATEGORY_2,LOWEST_PEARSON_CORRELATION_COEFFICIENT'"
"AMERICAN FLAVORED VODKA,CREAM LIQUEURS,-0.7626"
"Category_1,Category_2,Lowest_Pearson_Correlation_Coefficient"
Current sql:
WITH latest_month AS (
    SELECT DATE_TRUNC('month', MAX("date")) AS latest_month
    FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
    WHERE "date" <= CURRENT_DATE()
),
start_month AS (
    SELECT DATEADD(month, -23, latest_month) AS start_month
    FROM latest_month
),
monthly_sales AS (
    SELECT
        DATE_TRUNC('month', "date") AS "month",
        "category_name",
        SUM("volume_sold_liters") AS monthly_volume
    FROM
        IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
    WHERE
        "date" >= (SELECT start_month FROM start_month)
        AND "date" <= (SELECT latest_month FROM latest_month)
    GROUP BY
        DATE_TRUNC('month', "date"), "category_name"
),
total_monthly_sales AS (
    SELECT
        "month",
        SUM(monthly_volume) AS total_monthly_volume
    FROM
        monthly_sales
    GROUP BY
        "month"
),
monthly_sales_percentage AS (
    SELECT
        ms."month",
        ms."category_name",
        (ms.monthly_volume / tms.total_monthly_volume) * 100 AS volume_percentage
    FROM
        monthly_sales ms
    JOIN
        total_monthly_sales tms ON ms."month" = tms."month"
),
average_monthly_percentage AS (
    SELECT
        "category_name",
        AVG(volume_percentage) AS average_monthly_percentage
    FROM
        monthly_sales_percentage
    GROUP BY
        "category_name"
),
selected_categories AS (
    SELECT
        "category_name"
    FROM
        average_monthly_percentage
    WHERE
        average_monthly_percentage >= 1
),
filtered_monthly_percentage AS (
    SELECT
        msp."month",
        msp."category_name",
        msp.volume_percentage
    FROM
        monthly_sales_percentage msp
    WHERE
        msp."category_name" IN (SELECT "category_name" FROM selected_categories)
),
category_pairs AS (
    SELECT
        c1."category_name" AS category1,
        c2."category_name" AS category2
    FROM
        selected_categories c1
    JOIN
        selected_categories c2 ON c1."category_name" < c2."category_name"
),
correlation_results AS (
    SELECT
        cp.category1,
        cp.category2,
        CORR(fp1.volume_percentage, fp2.volume_percentage) AS correlation_coefficient
    FROM
        category_pairs cp
    JOIN
        filtered_monthly_percentage fp1 ON fp1."category_name" = cp.category1
    JOIN
        filtered_monthly_percentage fp2 ON fp2."category_name" = cp.category2
        AND fp1."month" = fp2."month"
    GROUP BY
        cp.category1,
        cp.category2
)
SELECT
    'Category_1,Category_2,Lowest_Pearson_Correlation_Coefficient'
UNION ALL
SELECT
    category1 || ',' || category2 || ',' || TO_CHAR(correlation_coefficient, '0.0000')
FROM
    (SELECT * FROM correlation_results ORDER BY correlation_coefficient LIMIT 1);
2025-01-21 07:30:44 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 07:30:44 - root - INFO - ```sql
WITH latest_month AS (
    SELECT DATE_TRUNC('month', MAX("date")) AS latest_month
    FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
    WHERE "date" <= CURRENT_DATE()
),
start_month AS (
    SELECT DATEADD(month, -23, latest_month) AS start_month
    FROM latest_month
),
monthly_sales AS (
    SELECT
        DATE_TRUNC('month', "date") AS "month",
        "category_name",
        SUM("volume_sold_liters") AS monthly_volume
    FROM
        IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
    WHERE
        "date" >= (SELECT start_month FROM start_month)
        AND "date" <= (SELECT latest_month FROM latest_month)
    GROUP BY
        DATE_TRUNC('month', "date"), "category_name"
),
total_monthly_sales AS (
    SELECT
        "month",
        SUM(monthly_volume) AS total_monthly_volume
    FROM
        monthly_sales
    GROUP BY
        "month"
),
monthly_sales_percentage AS (
    SELECT
        ms."month",
        ms."category_name",
        (ms.monthly_volume / tms.total_monthly_volume) * 100 AS volume_percentage
    FROM
        monthly_sales ms
    JOIN
        total_monthly_sales tms ON ms."month" = tms."month"
),
average_monthly_percentage AS (
    SELECT
        "category_name",
        AVG(volume_percentage) AS average_monthly_percentage
    FROM
        monthly_sales_percentage
    GROUP BY
        "category_name"
),
selected_categories AS (
    SELECT
        "category_name"
    FROM
        average_monthly_percentage
    WHERE
        average_monthly_percentage >= 1
),
filtered_monthly_percentage AS (
    SELECT
        msp."month",
        msp."category_name",
        msp.volume_percentage
    FROM
        monthly_sales_percentage msp
    WHERE
        msp."category_name" IN (SELECT "category_name" FROM selected_categories)
),
category_pairs AS (
    SELECT
        c1."category_name" AS category1,
        c2."category_name" AS category2
    FROM
        selected_categories c1
    JOIN
        selected_categories c2 ON c1."category_name" < c2."category_name"
),
correlation_results AS (
    SELECT
        cp.category1,
        cp.category2,
        CORR(fp1.volume_percentage, fp2.volume_percentage) AS correlation_coefficient
    FROM
        category_pairs cp
    JOIN
        filtered_monthly_percentage fp1 ON fp1."category_name" = cp.category1
    JOIN
        filtered_monthly_percentage fp2 ON fp2."category_name" = cp.category2
            AND fp1."month" = fp2."month"
    GROUP BY
        cp.category1,
        cp.category2
)
SELECT
    category1 AS "Category_1",
    category2 AS "Category_2",
    ROUND(correlation_coefficient, 4) AS "Lowest_Pearson_Correlation_Coefficient"
FROM
    correlation_results
ORDER BY
    correlation_coefficient
LIMIT 1;
```
2025-01-21 07:30:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 07:30:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 07:30:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 07:30:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-21 07:30:46 - snowflake.connector.connection - INFO - closed
2025-01-21 07:30:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 07:30:46 - root - INFO - itercount: 3
2025-01-21 07:30:46 - root - INFO - 0
2025-01-21 07:30:46 - root - INFO - results: 
Category_1,Category_2,Lowest_Pearson_Correlation_Coefficient
AMERICAN FLAVORED VODKA,CREAM LIQUEURS,-0.7626


2025-01-21 07:30:46 - root - INFO - Please check the answer again by reviewing Which two liquor categories, each contributing an average of at least 1% to monthly sales volume over 24 months, have the lowest Pearson correlation coefficient in their sales percentages?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Category_1,Category_2,Lowest_Pearson_Correlation_Coefficient
category_name_1,category_name_2,correlation_coefficient:float
(Attention: answer in one row)
```

**Explanation:**

The two liquor categories listed above each contributed an average of at least 1% to the monthly sales volume over a 24-month period and have the lowest Pearson correlation coefficient in their sales percentages. This low correlation coefficient indicates that the sales patterns of these two categories are the least similar among all categories meeting the 1% threshold, suggesting that their sales percentages move independently of each other over time. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Category_1,Category_2,Lowest_Pearson_Correlation_Coefficient
AMERICAN FLAVORED VODKA,CREAM LIQUEURS,-0.7626
Current sql:
WITH latest_month AS (
    SELECT DATE_TRUNC('month', MAX("date")) AS latest_month
    FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
    WHERE "date" <= CURRENT_DATE()
),
start_month AS (
    SELECT DATEADD(month, -23, latest_month) AS start_month
    FROM latest_month
),
monthly_sales AS (
    SELECT
        DATE_TRUNC('month', "date") AS "month",
        "category_name",
        SUM("volume_sold_liters") AS monthly_volume
    FROM
        IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
    WHERE
        "date" >= (SELECT start_month FROM start_month)
        AND "date" <= (SELECT latest_month FROM latest_month)
    GROUP BY
        DATE_TRUNC('month', "date"), "category_name"
),
total_monthly_sales AS (
    SELECT
        "month",
        SUM(monthly_volume) AS total_monthly_volume
    FROM
        monthly_sales
    GROUP BY
        "month"
),
monthly_sales_percentage AS (
    SELECT
        ms."month",
        ms."category_name",
        (ms.monthly_volume / tms.total_monthly_volume) * 100 AS volume_percentage
    FROM
        monthly_sales ms
    JOIN
        total_monthly_sales tms ON ms."month" = tms."month"
),
average_monthly_percentage AS (
    SELECT
        "category_name",
        AVG(volume_percentage) AS average_monthly_percentage
    FROM
        monthly_sales_percentage
    GROUP BY
        "category_name"
),
selected_categories AS (
    SELECT
        "category_name"
    FROM
        average_monthly_percentage
    WHERE
        average_monthly_percentage >= 1
),
filtered_monthly_percentage AS (
    SELECT
        msp."month",
        msp."category_name",
        msp.volume_percentage
    FROM
        monthly_sales_percentage msp
    WHERE
        msp."category_name" IN (SELECT "category_name" FROM selected_categories)
),
category_pairs AS (
    SELECT
        c1."category_name" AS category1,
        c2."category_name" AS category2
    FROM
        selected_categories c1
    JOIN
        selected_categories c2 ON c1."category_name" < c2."category_name"
),
correlation_results AS (
    SELECT
        cp.category1,
        cp.category2,
        CORR(fp1.volume_percentage, fp2.volume_percentage) AS correlation_coefficient
    FROM
        category_pairs cp
    JOIN
        filtered_monthly_percentage fp1 ON fp1."category_name" = cp.category1
    JOIN
        filtered_monthly_percentage fp2 ON fp2."category_name" = cp.category2
            AND fp1."month" = fp2."month"
    GROUP BY
        cp.category1,
        cp.category2
)
SELECT
    category1 AS "Category_1",
    category2 AS "Category_2",
    ROUND(correlation_coefficient, 4) AS "Lowest_Pearson_Correlation_Coefficient"
FROM
    correlation_results
ORDER BY
    correlation_coefficient
LIMIT 1;
2025-01-21 07:31:09 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-21 07:31:09 - root - INFO - ```sql
WITH latest_month AS (
    SELECT DATE_TRUNC('month', MAX("date")) AS latest_month
    FROM IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
    WHERE "date" <= CURRENT_DATE()
),
start_month AS (
    SELECT DATEADD(month, -23, latest_month) AS start_month
    FROM latest_month
),
monthly_sales AS (
    SELECT
        DATE_TRUNC('month', "date") AS "month",
        "category_name",
        SUM("volume_sold_liters") AS monthly_volume
    FROM
        IOWA_LIQUOR_SALES.IOWA_LIQUOR_SALES.SALES
    WHERE
        "date" >= (SELECT start_month FROM start_month)
        AND "date" <= (SELECT latest_month FROM latest_month)
    GROUP BY
        DATE_TRUNC('month', "date"), "category_name"
),
total_monthly_sales AS (
    SELECT
        "month",
        SUM(monthly_volume) AS total_monthly_volume
    FROM
        monthly_sales
    GROUP BY
        "month"
),
monthly_sales_percentage AS (
    SELECT
        ms."month",
        ms."category_name",
        (ms.monthly_volume / tms.total_monthly_volume) * 100 AS volume_percentage
    FROM
        monthly_sales ms
    JOIN
        total_monthly_sales tms ON ms."month" = tms."month"
),
average_monthly_percentage AS (
    SELECT
        "category_name",
        AVG(volume_percentage) AS average_monthly_percentage
    FROM
        monthly_sales_percentage
    GROUP BY
        "category_name"
),
selected_categories AS (
    SELECT
        "category_name"
    FROM
        average_monthly_percentage
    WHERE
        average_monthly_percentage >= 1
),
filtered_monthly_percentage AS (
    SELECT
        msp."month",
        msp."category_name",
        msp.volume_percentage
    FROM
        monthly_sales_percentage msp
    WHERE
        msp."category_name" IN (SELECT "category_name" FROM selected_categories)
),
category_pairs AS (
    SELECT
        c1."category_name" AS category1,
        c2."category_name" AS category2
    FROM
        selected_categories c1
    JOIN
        selected_categories c2 ON c1."category_name" < c2."category_name"
),
correlation_results AS (
    SELECT
        cp.category1,
        cp.category2,
        CORR(fp1.volume_percentage, fp2.volume_percentage) AS correlation_coefficient
    FROM
        category_pairs cp
    JOIN
        filtered_monthly_percentage fp1 ON fp1."category_name" = cp.category1
    JOIN
        filtered_monthly_percentage fp2 ON fp2."category_name" = cp.category2
            AND fp1."month" = fp2."month"
    GROUP BY
        cp.category1,
        cp.category2
)
SELECT
    category1 AS "Category_1",
    category2 AS "Category_2",
    ROUND(correlation_coefficient, 4) AS "Lowest_Pearson_Correlation_Coefficient"
FROM
    correlation_results
ORDER BY
    correlation_coefficient
LIMIT 1;
```
2025-01-21 07:31:09 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.38-x86_64-with-glibc2.31
2025-01-21 07:31:09 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-21 07:31:09 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-21 07:31:10 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-21 07:31:10 - snowflake.connector.connection - INFO - closed
2025-01-21 07:31:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-21 07:31:11 - root - INFO - itercount: 4
2025-01-21 07:31:11 - root - INFO - 0
2025-01-21 07:31:11 - root - INFO - Total iteration counts: 4
