2025-01-22 21:24:40 - openai._base_client - INFO - Retrying request to /chat/completions in 0.392553 seconds
2025-01-22 21:25:39 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:25:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:25:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:25:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:25:41 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:25:41 - snowflake.connector.connection - INFO - closed
2025-01-22 21:25:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:25:42 - root - INFO - SQL:
SELECT t."publication_number", t."cpc"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t
   LIMIT 100;
Results:
Too long, hard cut:
publication_number,cpc
CR-5634-A,[]
CR-5990-A,[]
FI-429-A,[]
HK-6083-A,"[
  {
    ""code"": ""H02M5/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
HU-T52763-A,"[
  {
    ""code"": ""A01N47/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D521/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
JP-H03206829-A,"[
  {
    ""code"": ""Y02A40/81"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
JP-S62159089-A,"[
  {
    ""code"": ""Y02E30/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
US-416-A,"[
  {
    ""code"": ""Y10T83/465"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""B26F1/42"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
US-2528225-A,"[
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A41580-A,"[
  {
    ""code"": ""B22D11/086"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A47682-A,"[
  {
    ""code"": ""C07D471/16"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D471/22"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A63682-A,"[
  {
    ""code"": ""G01N33/48728"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-920790-A,"[
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-950907-A,"[
  {
    ""code"": ""C11B5/0064"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/35"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C11B5/0035"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M135/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C09K15/30"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D263/56"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/44"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D235/12"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/3447"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/48"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/46"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D277/64"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/47"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/224"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/102"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/106"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/104"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/10"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/221"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/226"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/225"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/22"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10L1/14"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-920830-A,"[
  {
    ""code"": ""E02D5/808"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/385"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/26"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/28"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/54"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-9086-A,[]
CH-3256-A,[]
CH-540255-A,"[
  {
    ""code"": ""C07D213/32"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/51"",
    ""first"": false,
    ""inven

2025-01-22 21:25:42 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:25:42 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:25:42 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:25:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:25:44 - snowflake.connector.connection - INFO - closed
2025-01-22 21:25:44 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:25:44 - root - INFO - SQL:
SELECT t."application_number", t."assignee_harmonized"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t
   LIMIT 100;
Results:
Too long, hard cut:
application_number,assignee_harmonized
CR-5634-A,"[
  {
    ""country_code"": ""CR"",
    ""name"": ""UNIV COSTA RICA""
  }
]"
CR-5990-A,"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BAYER AG""
  }
]"
FI-429D-A,[]
HK-6083-A,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""CRABTREE ELECTRICAL IND LTD""
  }
]"
HU-7590-A,"[
  {
    ""country_code"": """",
    ""name"": ""BASF AG""
  }
]"
JP-4890-A,"[
  {
    ""country_code"": """",
    ""name"": ""MORITA SANGYO KK""
  }
]"
JP-6286-A,"[
  {
    ""country_code"": """",
    ""name"": ""TOSHIBA CORP""
  }
]"
US-416D-A,[]
US-9948-A,"[
  {
    ""country_code"": """",
    ""name"": ""ADOLPH BEREN""
  }
]"
AT-41580-A,"[
  {
    ""country_code"": ""AT"",
    ""name"": ""VOEST ALPINE AG""
  }
]"
AT-47682-A,"[
  {
    ""country_code"": ""HU"",
    ""name"": ""CHINOIN GYOGYSZER ES VEGYESZET""
  }
]"
AT-63682-A,"[
  {
    ""country_code"": ""AT"",
    ""name"": ""PFUETZNER HELMUT DIPL ING DR T""
  },
  {
    ""country_code"": ""AT"",
    ""name"": ""KRAUSE ERWIN DIPL ING""
  }
]"
CA-72337-A,"[
  {
    ""country_code"": ""US"",
    ""name"": ""BROCKWAY GLASS CO INC""
  }
]"
CA-75688-A,"[
  {
    ""country_code"": """",
    ""name"": ""CIBA GEIGY""
  }
]"
CA-81627-A,"[
  {
    ""country_code"": ""DE"",
    ""name"": ""MUELLER G""
  }
]"
CA-9086D-A,"[
  {
    ""country_code"": ""CA"",
    ""name"": ""SHARMAN JAMES""
  }
]"
CH-3256D-A,"[
  {
    ""country_code"": ""FR"",
    ""name"": ""LE BLON CHARLES""
  },
  {
    ""country_code"": ""FR"",
    ""name"": ""A OBLASSER A GODDYN ET CIE SOC""
  }
]"
CH-32972-A,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""ICI LTD""
  }
]"
CH-59566-A,"[
  {
    ""country_code"": ""IT"",
    ""name"": ""FARINA & FIGLI A""
  }
]"
CH-8494D-A,"[
  {
    ""country_code"": ""CH"",
    ""name"": ""KNOBEL & HEER""
  }
]"
CH-9587D-A,"[
  {
    ""country_code"": ""DE"",
    ""name"": ""ROESCH ARTHUR""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""ENGEL HUGO""
  }
]"
CH-9968D-A,"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BOECKLEIN JOSEF""
  }
]"
DD-8297D-A,[]
FR-19873-A,[]
FR-20966-A,"[
  {
    ""country_code"": """",
    ""name"": ""M & T CHEMICALS INC""
  }
]"
FR-56170-A,"[
  {
    ""country_code"": """",
    ""name"": ""LOEWE OPTA AG""
  }
]"
FR-60658-A,"[
  {
    ""country_code"": """",
    ""name"": ""BAYER AG""
  }
]"
FR-68041-A,"[
  {
    ""country_code"": """",
    ""name"": ""MITSUBISHI HEAVY IND LTD""
  }
]"
FR-70755-A,"[
  {
    ""country_code"": """",
    ""name"": ""GLOBE UNION INC""
  }
]"
FR-84394-A,"[
  {
    ""country_code"": """",
    ""name"": ""ISAP SPA""
  }
]"
GB-15660-A,"[
  {
    ""country_code"": """",
    ""name"": ""JOSHUA BIGWOOD AND SON LTD""
  }
]"
GB-50958-A,"[
  {
    ""country_code"": """",
    ""name"": ""ERWIN SCHWARZ""
  }
]"
GB-54729-A,[]
GB-93140-A,"[
  {
    ""country_code"": """",
    ""name"": ""BOSCH GMBH ROBERT""
  }
]"
HK-39487-A,"[
  {
    ""country_code"": ""NL"",
    ""name"": ""PHILIPS NV""
  }
]"
HK-52284-A,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""SUWA SEIKOSHA KK""
  }
]"
HK-55992-A,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""NIPPON STEEL CORP""
  }
]"
HK-60178-A,"[
  {
    ""country_code"": ""DE"",
    ""name"": ""HOLLINGSWORTH GMBH""
  }
]"
HK-82486-A,"[
  {
    ""country_code"": ""DE"",
    ""name"": ""ECKOLD VORRICHTUNG""
  }
]"
HU-62391-A,"[
  {
    ""country_code"": """",
    ""name"": ""DOWELANCO""
  }
]"
JP-42386-A,"[
  {
    ""country_code"": """",
    ""name"": ""IGARASHI KAZUYOSHI""
  }
]"
JP-67093-A,"[
  {
    ""country_code"": """",
    ""name"": ""HITACHI LTD""
  }
]"
MA-42286-A,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""CHIYODA CORP""
  }
]"
OA-58112-A,"[
  {
    ""country_code"": """",
    ""name"": ""ROUSSEL UCLAF""
  }
]"
OA-58887-A,"[
  {
    ""country_code"": """",
    ""name"": ""PETROL ENGINERING S A""
  }
]"
PH-14999-A,"[
  {
    ""country_code"": """",
    ""name"": ""IRECO CHEMICALS""
  }
]"
PH-21568-A,"[
  {
    ""country_code"": """",
    ""name"": ""COLGATE PALMOLIVE CO""
  }
]"
PH-27280-A,"[
  {
    ""country_code"": """",
    ""name"": ""FERRER INT""
  }
]"
PH-36517-A,"[
  {
    ""country_code"": """",
    ""name"": ""LILLY CO ELI""
  }
]"
TR-25990-A,"[
  {
    ""country_code"": ""DE"",
    ""name"": ""MAUSER WERKE GMBH""
  }
]"
US-4613D-A,[]
US-59779-A,"[
  {
    ""country_code"": """",
    ""name"": ""HOEYER ELLEFSEN AS""
  }
]"
US-6310D-A,[]
US-8947D-A,[]
YU-24971-A,"[
  {
    ""country_code"": ""IT"",
    ""name"": ""SOMET SOC MEC TESSILE""
  }
]"
YU-51397-A,"[
  {
    ""country_code"": ""CH"",
    ""name"": ""MIODRAG SPASOJEVIC""
  }
]"
YU-53588-A,"[
  {
    ""country_code"": ""YU"",
    ""name"": ""TEHNOLOSKI FAK N SAD""
  }
]"
YU-94082-A,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""BEECHAM GROUP LTD""
  }
]"
AT-134275-A,"[
  {
    ""country_code"": ""DE"",
    ""name"": ""HOECHST AG""
  }
]"
AT-160683-A,"[
  {
    ""country_code"": ""AT"",
    ""name"": ""BLUM GMBH JULIUS""
  }
]"
AT-168281-A,"[
  

2025-01-22 21:25:44 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:25:44 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:25:44 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:25:46 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:25:46 - snowflake.connector.connection - INFO - closed
2025-01-22 21:25:46 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:25:46 - root - INFO - SQL:
SELECT DISTINCT f.value:"code"::STRING AS "cpc_code"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(input => t."cpc") f
   LIMIT 100;
Results:
cpc_code
B41C1/055
B01J2219/00867
G06N99/005
F04D19/002
B23K2103/10
B60L2230/16
H01J49/025
F01D5/147
G05B2219/25011
B23K26/037
F02M45/086
B29C45/14
B25B7/12
H05K2201/098
A01C7/044
C04B2235/3294
G06F40/129
H01L29/7818
C07D413/10
G06F9/45558
A45C2011/002
A63B37/005
G06F2203/04104
B60L53/12
Y02W30/62
H01L21/00
Y10T156/1783
A46B9/04
B41L11/00
G01C19/38
F02D41/005
H01L23/49811
C01P2004/51
H04M1/72418
C09D175/04
H01M4/485
G06Q10/10
C04B35/62675
A61B1/32
A61B5/065
B22F2998/10
A61M5/31511
G06F16/9035
F21S10/026
A61B5/061
H04N23/45
H01L21/761
H01L27/14621
G06K9/00765
G06F18/2113
G06F21/602
A01K89/01902
H01J2237/332
G03B15/00
C07C215/60
F04D29/051
G02F1/133528
H10K59/65
H04B7/0413
A61B5/6893
A61B34/73
H01Q13/24
G11B2220/2575
B01D65/08
G01N27/221
C08L23/04
C08L99/00
B01D53/9472
F27D3/10
C03C3/325
A61B2017/00867
B60K2370/146
B60K2370/23
B01D2253/102
B01D46/88
H04W68/00
G06Q30/0233
G06T2207/30268
H03F3/2171
G06F30/39
D06F39/08
B64C1/066
F02B51/04
B60K11/08
H04N25/766
F28F3/12
G05B17/02
G01S1/02
C07C29/147
D01H5/36
B31B2105/00
C12Q1/6883
H05K2201/0391
B60N2/02246
B60R21/215
H04L1/0025
F01D25/12
H04L2209/125
B26B29/063
B60Y2200/14

2025-01-22 21:25:46 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:25:46 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:25:46 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:25:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:25:48 - snowflake.connector.connection - INFO - closed
2025-01-22 21:25:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:25:48 - root - INFO - SQL:
SELECT DISTINCT f.value:"name"::STRING AS "assignee_name"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(input => t."assignee_harmonized") f
   LIMIT 100;
Results:
assignee_name
KOMATSU MFG CO LTD
SAMPUTENSILI SPA
ARPE PLAST KUNSTSTOFF
UNIV READING
CLEVELAND ROCK DRILL CO
UNICHARM CORP
CAREY PHILIP MFG CO
WESTINGHOUSE CANADA LTD
UNITED SHOE MACHINERY AB
HERWIG JORG
MATSUO MIE
JOE MATTHEW D
KOTZIN MICHAEL D
DAVIDSON MATTHEW
MARTIN KATHARINE
AMERICAN HATCHERY ENGINEERS IN
AETNA PRODUCTS & MFG CO
MAY ZIEGLER ALFRED
AUTONETWORKS TECHNOLOGIES LTD
DUERR SYSTEMS AG
DARAMIC INC
DLR EV
FUJI PHOTO OPTICAL CO LTD
GAMBRO LUNDIA AB
SHUMAN ROBERT
SCRAMOGE TECH LIMITED
MATHWORKS INC
BASF SE
HARMONIC DRIVE SYSTEMS
MUELLER FRIEDRICH
IKA INNOVATIVE KUNSTSTOFFAUFBEREITUNG GMBH & CO KG
KOBE STEEL LTD
SNECMA
LI DAQI
GS YUASA INT LTD
FLYNN ERROL W
NEGLEY GERALD H
PAUKERT DOROTHY A
KIM JAE-CHANG
VERLEGER JOBST
ERWIN SCHWARZ
IRECO CHEMICALS
BRUPAT LTD
SENSITAP LLC
WENZEL JUERGEN MICHAEL DR ING
MARHVEL S R L
BLACK & DECKER INC
SHUNAN DENKO KK
KIM JUNG WOOK
TIANMA MICROELECTRONICS CO LTD
COMMUNICATIONS SYSTEMS INC
MIMAKI ENG CO LTD
HUBEI SILE ANIMAL HUSBANDRY GROUP CO LTD
GUOKUNGKE QUANTUM TECH BEIJING LIMITED COMPANY
XINJIANG YUIN SUNSHINE CURTAIN WALL DECORATION ENGINEERING LTD COMPANY
SON SEONG GEUN
KURARAY CO
STICKNEY RONALD E
NOVA RICHARD C
KONINKLIJKE KPN NV
ILSENBURGER GROBBLECH GMBH
ENSEM THERAPEUTICS INC
LEE CHEL WON
KUROKI RENTARO
SCHILLER GROUNDS CARE INC
CHENG UEI PREC IND CO LTD
PURIDIFY LTD
AUTOMATED PACKAGING SYST INC
NOYES ANNA V
SWA HOLDING COMPANY INC
KO YOUNG HWAN
HERTLEIN ROBERT
IM JAE H
INNOVATIVE DRUG DELIVERY SYSTE
NAGURNY NICHOLAS J
COMMW SCIENT IND RES ORG
NAIKI MITSURU
COVESTRO LLC
UNIV SHANGHAI MARITIME
SINGULAR GENOMICS SYSTEMS INC
ST MICROELECTRONICS INC
YAMAICHI ELECTRONICS CO
KAIN MICHAEL T
VOLVO CAR CORP
THE BROAD INST INC
BRUSS I MEKH SELSKOGO KHOZ
NGUYEN HIEP
FRESHPOINT QUALITY ASSURANCE LTD
SUGAWARA SATORU
HUNTER CLAUD M
RENE BUCHER
HOLLYFIELD GARY
KARL MAYER STOLL R&D GMBH
BELGORODSKIJ VSESOYUZNOGO NI V
JAPAN AVIATION ELECTRON
JUNG YOUNG-BAE
IWASA AKIRA
RENAULT SA
ARENA CHANTAL
RENENSAS ELECTRONICS CORP

2025-01-22 21:25:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:25:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:25:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:25:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:25:50 - snowflake.connector.connection - INFO - closed
2025-01-22 21:25:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:25:50 - root - INFO - SQL:
SELECT f.value:"code"::STRING AS "cpc_code", COUNT(*) AS "application_count"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(input => t."cpc") f
   GROUP BY f.value:"code"::STRING
   ORDER BY "application_count" DESC
   LIMIT 100;
Results:
cpc_code,application_count
Y02E60/10,5576
A61P35/00,5514
A61P43/00,3803
A61K45/06,3065
Y02P70/50,2621
A61P29/00,2555
A61K38/00,2489
A61P25/00,2136
A61K2039/505,1915
Y02T10/12,1834
Y02E10/50,1825
A23V2002/00,1817
Y02T10/70,1777
C07D471/04,1747
H01L2924/0002,1714
A61P25/28,1694
Y02E60/50,1668
Y02A50/30,1659
H01M10/0525,1650
Y02D30/70,1618
A61P9/00,1605
A61P9/10,1499
C07D487/04,1485
A61P31/04,1483
G06N3/08,1467
A61P3/10,1463
G06N20/00,1397
C07D401/12,1347
H01L2224/48091,1339
C07D401/14,1327
A61P11/00,1312
A61P17/00,1294
A61K9/0019,1294
H04N19/176,1189
A61P19/02,1179
A61Q19/00,1172
B32B27/08,1150
C07K2317/92,1147
H01M10/052,1138
B82Y30/00,1132
Y02D10/00,1128
F21Y2115/10,1115
Y02P10/20,1096
C07K2317/76,1094
Y02P70/10,1088
H04W72/23,1063
C07K2317/24,1061
Y02T10/7072,1037
A61P35/02,1035
A61P31/12,1019
A61P1/04,1018
Y02T10/40,1000
A61P27/02,1000
G06N3/045,983
C07D401/04,980
A61P37/00,974
Y02E10/72,972
A61P1/00,967
B32B7/12,962
Y02E30/30,953
C07D413/14,940
B32B27/32,934
C08J5/18,932
H04L5/0053,926
C07D405/12,901
A61P31/00,898
A61P1/16,894
A61P37/06,893
H04W4/80,885
H04L5/0048,882
A61P37/02,881
A61P13/12,877
C07K2319/00,857
C07D405/14,849
H01M2220/20,848
A61K31/519,825
C09K11/06,819
H04L67/12,818
H01L2924/00014,808
C22C38/02,804
H01L2924/181,803
A61P11/06,802
B82Y40/00,796
G06Q30/02,785
C07K2317/565,784
A61P3/00,779
C07D417/12,777
H04W84/12,773
B33Y10/00,767
C07D403/12,761
G06F3/0482,757
C22C38/04,757
A61K39/00,755
Y02P90/02,750
A61P3/04,749
A61P9/12,744
G06Q10/10,743
C07D417/14,742
Y02W10/10,740
A61P17/06,736

2025-01-22 21:25:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:25:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:25:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:25:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:25:52 - snowflake.connector.connection - INFO - closed
2025-01-22 21:25:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:25:52 - root - INFO - SQL:
SELECT f.value:"name"::STRING AS "assignee_name", COUNT(*) AS "total_applications"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(input => t."assignee_harmonized") f
   GROUP BY f.value:"name"::STRING
   ORDER BY "total_applications" DESC
   LIMIT 100;
Results:
assignee_name,total_applications
SAMSUNG ELECTRONICS CO LTD,2242
CANON KK,2114
HITACHI LTD,2012
MATSUSHITA ELECTRIC IND CO LTD,1948
MITSUBISHI ELECTRIC CORP,1734
SONY CORP,1477
FUJITSU LTD,1364
TOSHIBA CORP,1296
NEC CORP,1280
IBM,1240
LG ELECTRONICS INC,1054
HUAWEI TECH CO LTD,1029
SIEMENS AG,988
SEIKO EPSON CORP,963
GEN ELECTRIC,947
SHARP KK,914
STATE GRID CORP CHINA,841
TOYOTA MOTOR CORP,839
HONDA MOTOR CO LTD,837
BOSCH GMBH ROBERT,837
QUALCOMM INC,813
RICOH KK,735
DENSO CORP,628
SANYO ELECTRIC CO,616
HYUNDAI MOTOR CO LTD,577
NIPPON TELEGRAPH & TELEPHONE,568
TOSHIBA KK,546
BAYER AG,529
FUJI PHOTO FILM CO LTD,522
NISSAN MOTOR,515
TOYOTA MOTOR CO LTD,508
MITSUBISHI HEAVY IND LTD,488
ZTE CORP,479
INTEL CORP,475
ERICSSON TELEFON AB L M,464
BOE TECHNOLOGY GROUP CO LTD,436
FUJI XEROX CO LTD,427
DU PONT,423
NIPPON STEEL CORP,403
MATSUSHITA ELECTRIC WORKS LTD,403
SUMITOMO ELECTRIC INDUSTRIES,400
PROCTER & GAMBLE,394
BASF AG,366
HOECHST AG,365
GREE ELECTRIC APPLIANCES INC ZHUHAI,364
PANASONIC CORP,357
SUMITOMO CHEMICAL CO,355
TOKYO SHIBAURA ELECTRIC CO,353
FUJIFILM CORP,349
BROTHER IND LTD,325
HOFFMANN LA ROCHE,324
FORD GLOBAL TECH LLC,319
LG CHEMICAL LTD,318
KYOCERA CORP,316
UNIV ZHEJIANG,314
MURATA MANUFACTURING CO,306
PHILIPS NV,304
APPLE INC,299
KONINKL PHILIPS ELECTRONICS NV,299
TORAY INDUSTRIES,298
HON HAI PREC IND CO LTD,296
DAINIPPON PRINTING CO LTD,294
SAMSUNG DISPLAY CO LTD,293
MICROSOFT CORP,285
MIDEA GROUP CO LTD,278
TAIWAN SEMICONDUCTOR MFG CO LTD,276
FUJI ELECTRIC CO LTD,270
NIPPON ELECTRIC CO,270
UNIV TSINGHUA,264
KOBE STEEL LTD,262
MICROSOFT TECHNOLOGY LICENSING LLC,256
3M INNOVATIVE PROPERTIES CO,253
SEKISUI CHEMICAL CO LTD,249
OKI ELECTRIC IND CO LTD,241
RICOH CO LTD,240
EASTMAN KODAK CO,238
OMRON TATEISI ELECTRONICS CO,236
XEROX CORP,236
KAO CORP,234
NIKON CORP,231
WESTINGHOUSE ELECTRIC CORP,231
TOKYO ELECTRON LTD,230
MOTOROLA INC,229
TOPPAN PRINTING CO LTD,229
CASIO COMPUTER CO LTD,229
BASF SE,225
KONISHIROKU PHOTO IND,225
APPLIED MATERIALS INC,224
BRIDGESTONE CORP,222
NITTO DENKO CORP,221
MICRON TECHNOLOGY INC,220
YAZAKI CORP,219
BOEING CO,217
HYNIX SEMICONDUCTOR INC,214
RCA CORP,213
HEWLETT PACKARD DEVELOPMENT CO,213
DAIKIN IND LTD,212
TDK CORP,209
LG DISPLAY CO LTD,208
SAMSUNG SDI CO LTD,208

2025-01-22 21:25:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:25:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:25:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:25:54 - snowflake.connector.connection - INFO - closed
2025-01-22 21:25:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:26:14 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:26:14 - root - INFO - The error occurs because some entries in the `"publication_date"` column have a value of `0` or are invalid, which cannot be parsed as a date using the format `'YYYYMMDD'`. To resolve this issue, we need to exclude these invalid dates from our query.

You can modify your SQL query by adding a `WHERE` clause to filter out records where `"publication_date"` is `0` or `NULL`. Alternatively, you can use the `TRY_TO_DATE` function, which attempts to convert the value to a date and returns `NULL` if it fails.

Here are two possible solutions:

**Option 1: Using `TRY_TO_DATE`**

```sql
SELECT EXTRACT(year FROM TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD')) AS "year", 
       COUNT(*) AS "applications_per_year"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t
WHERE TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD') IS NOT NULL
GROUP BY "year"
ORDER BY "applications_per_year" DESC
LIMIT 100;
```

**Option 2: Filtering Out Invalid Dates**

```sql
SELECT EXTRACT(year FROM TO_DATE(t."publication_date"::STRING, 'YYYYMMDD')) AS "year", 
       COUNT(*) AS "applications_per_year"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t
WHERE t."publication_date" IS NOT NULL 
  AND t."publication_date" != 0
GROUP BY "year"
ORDER BY "applications_per_year" DESC
LIMIT 100;
```

**Explanation:**

- **`TRY_TO_DATE` Function:** This function attempts to convert a string to a date. If it fails (e.g., when the value is `0`), it returns `NULL` instead of throwing an error. By filtering out `NULL` results using `WHERE TRY_TO_DATE(...) IS NOT NULL`, we ensure only valid dates are processed.

- **Filtering in the `WHERE` Clause:** By adding `t."publication_date" != 0` and checking for `NOT NULL`, we exclude invalid date values before attempting to parse them with `TO_DATE`.

**Next Steps:**

- Run one of the modified queries above.
- This should resolve the parsing error and return a list of years along with the count of applications per year.
- You can proceed to analyze the data as needed for your task.

**Example Result (First Few Rows):**

```csv
year,applications_per_year
2020,15000
2019,14750
2018,14320
2017,13980
2016,13550
...
```

This will give you the number of patent applications per year, excluding any records with invalid publication dates.
2025-01-22 21:26:14 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:26:14 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:26:14 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:26:16 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:26:16 - snowflake.connector.connection - INFO - closed
2025-01-22 21:26:16 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:27:20 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:27:20 - root - INFO - SQL:
SELECT EXTRACT(year FROM TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD')) AS "year", 
       COUNT(*) AS "applications_per_year"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t
WHERE TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD') IS NOT NULL
GROUP BY "year"
ORDER BY "applications_per_year" DESC
LIMIT 100;
Results:
year,applications_per_year
2021,41292
2020,32403
2022,31642
2018,29555
2019,27259
2017,22925
2023,20332
2016,19668
2015,16901
2014,14404
2024,12612
2013,10925
2012,9998
2010,9468
2009,9382
2011,9167
2008,8707
2007,7994
2006,7967
2005,7441
2004,6997
2002,6333
2003,6253
2001,5873
2000,5612
1999,5422
1998,4927
1991,4669
1989,4584
1994,4451
1995,4309
1997,4269
1990,4243
1988,4242
1996,4223
1992,4086
1987,3997
1986,3941
1993,3858
1985,3785
1982,3520
1984,3494
1983,3413
1980,3178
1976,3135
1979,3123
1981,3122
1975,3071
1978,2991
1977,2940
1974,2880
1973,2440
1972,1335
1971,1244
1970,1151
1969,1146
1968,983
1967,909
1966,900
1965,777
1959,693
1961,668
1960,667
1962,656
1964,646
1958,636
1963,572
1957,560
1953,468
1956,457
1951,445
1954,432
1952,431
1950,382
1955,374
1941,351
1914,351
1936,351
1939,348
1930,335
1932,335
1938,334
1940,323
1937,322
1931,319
1935,296
1949,293
1942,290
1913,279
1943,269
1934,265
1944,262
1933,259
1929,259
1945,253
1925,252
1927,244
1928,243
1948,243
1922,235

2025-01-22 21:27:20 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:27:20 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:27:20 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:27:22 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:27:22 - snowflake.connector.connection - INFO - closed
2025-01-22 21:27:22 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:27:22 - root - INFO - SQL:
SELECT f.value:"name"::STRING AS "assignee_name",
       EXTRACT(year FROM TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD')) AS "year",
       COUNT(*) AS "applications"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f
WHERE TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD') IS NOT NULL
GROUP BY f.value:"name"::STRING, "year"
ORDER BY "applications" DESC
LIMIT 100
Results:
assignee_name,year,applications
SAMSUNG ELECTRONICS CO LTD,2008,146
SAMSUNG ELECTRONICS CO LTD,2007,141
SAMSUNG ELECTRONICS CO LTD,2006,131
STATE GRID CORP CHINA,2017,120
SAMSUNG ELECTRONICS CO LTD,2023,116
HUAWEI TECH CO LTD,2021,113
STATE GRID CORP CHINA,2015,109
SAMSUNG ELECTRONICS CO LTD,2021,109
SAMSUNG ELECTRONICS CO LTD,2022,108
STATE GRID CORP CHINA,2018,106
STATE GRID CORP CHINA,2016,100
MATSUSHITA ELECTRIC IND CO LTD,2006,100
SAMSUNG ELECTRONICS CO LTD,2020,100
STATE GRID CORP CHINA,2014,97
HUAWEI TECH CO LTD,2022,96
SAMSUNG ELECTRONICS CO LTD,2000,95
HUAWEI TECH CO LTD,2023,91
HITACHI LTD,1986,91
NEC CORP,1991,91
IBM,2021,90
MATSUSHITA ELECTRIC IND CO LTD,2005,88
MATSUSHITA ELECTRIC IND CO LTD,2003,86
HITACHI LTD,1989,86
NEC CORP,1988,85
SAMSUNG ELECTRONICS CO LTD,2014,84
HUAWEI TECH CO LTD,2019,84
SAMSUNG ELECTRONICS CO LTD,2019,83
STATE GRID CORP CHINA,2019,83
SAMSUNG ELECTRONICS CO LTD,2005,82
CANON KK,2004,82
CANON KK,2006,82
NEC CORP,1989,82
NEC CORP,1990,82
SAMSUNG ELECTRONICS CO LTD,2024,80
SAMSUNG ELECTRONICS CO LTD,2018,80
SAMSUNG ELECTRONICS CO LTD,2015,80
SAMSUNG ELECTRONICS CO LTD,2017,79
MATSUSHITA ELECTRIC IND CO LTD,2001,79
MATSUSHITA ELECTRIC IND CO LTD,2004,79
MATSUSHITA ELECTRIC IND CO LTD,2007,78
HUAWEI TECH CO LTD,2018,78
IBM,2020,75
MATSUSHITA ELECTRIC IND CO LTD,2008,75
MITSUBISHI ELECTRIC CORP,1989,75
MATSUSHITA ELECTRIC IND CO LTD,1985,75
TOSHIBA CORP,1989,73
TOSHIBA CORP,1987,73
MATSUSHITA ELECTRIC IND CO LTD,1986,73
CANON KK,2021,73
QUALCOMM INC,2021,72
SAMSUNG ELECTRONICS CO LTD,2004,72
GREE ELECTRIC APPLIANCES INC ZHUHAI,2019,72
SAMSUNG ELECTRONICS CO LTD,2009,72
MATSUSHITA ELECTRIC IND CO LTD,1991,71
HITACHI LTD,1987,70
CANON KK,2009,70
SAMSUNG ELECTRONICS CO LTD,1999,70
GREE ELECTRIC APPLIANCES INC ZHUHAI,2021,70
SAMSUNG ELECTRONICS CO LTD,2010,69
CANON KK,2008,69
CANON KK,2020,69
SAMSUNG ELECTRONICS CO LTD,2016,69
TOSHIBA CORP,1988,68
NEC CORP,1992,68
MATSUSHITA ELECTRIC IND CO LTD,2002,68
CANON KK,2001,67
HITACHI LTD,1990,67
CANON KK,2000,67
SAMSUNG ELECTRONICS CO LTD,2013,67
HITACHI LTD,1983,66
MATSUSHITA ELECTRIC IND CO LTD,1992,66
MATSUSHITA ELECTRIC IND CO LTD,1989,66
HITACHI LTD,1988,66
QUALCOMM INC,2022,66
SONY CORP,2008,65
HUAWEI TECH CO LTD,2020,65
SONY CORP,2001,65
HITACHI LTD,1977,64
NEC CORP,1987,64
HITACHI LTD,1985,64
HUAWEI TECH CO LTD,2024,63
HITACHI LTD,1982,63
SEIKO EPSON CORP,2007,63
FUJITSU LTD,1991,63
PANASONIC CORP,2010,63
SONY CORP,2009,62
CANON KK,2005,62
NEC CORP,2000,62
FUJITSU LTD,1989,62
STATE GRID CORP CHINA,2021,62
MATSUSHITA ELECTRIC IND CO LTD,2000,62
TAIWAN SEMICONDUCTOR MFG CO LTD,2021,61
TOSHIBA CORP,1991,61
TOYOTA MOTOR CORP,2009,61
QUALCOMM INC,2023,61
TOYOTA MOTOR CORP,2008,61
SONY CORP,2000,60
SONY CORP,2012,60
BOE TECHNOLOGY GROUP CO LTD,2018,60
CANON KK,1996,60

2025-01-22 21:27:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:27:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:27:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:27:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 93
2025-01-22 21:27:24 - snowflake.connector.connection - INFO - closed
2025-01-22 21:27:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:27:25 - root - INFO - SQL:
SELECT t."country_code", COUNT(*) AS "application_count"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t
WHERE t."country_code" IS NOT NULL
GROUP BY t."country_code"
ORDER BY "application_count" DESC
LIMIT 100
Results:
country_code,application_count
CN,208729
JP,110525
US,57953
KR,28416
CA,13358
DE,12656
AU,9744
WO,9409
EP,8335
GB,5551
AT,4482
BR,4469
TW,4270
IT,3866
CH,3513
FR,3326
RU,2979
SU,2526
BE,2457
ES,2080
SE,1473
NL,1274
ZA,1261
PL,1187
IL,1185
HU,969
NO,890
MX,863
DD,722
AR,666
DK,575
CS,528
UA,479
FI,467
HK,440
CZ,414
IE,372
PT,372
SG,284
NZ,276
CL,267
BG,265
YU,228
IN,222
TR,222
GR,207
MY,195
RO,172
HR,167
LU,139
CO,118
SI,117
PH,116
EA,108
SK,99
CY,81
PE,77
AP,65
MA,54
LT,50
ID,43
CR,41
RS,38
MD,30
OA,29
IS,28
JO,26
CU,23
GE,23
LV,23
SA,20
EG,18
TN,15
GT,15
EC,14
SM,11
ZM,10
EE,7
NI,7
DO,6
PA,5
KE,5
ME,5
HN,5
MC,4
MW,4
SV,3
ZW,2
MN,1
MT,1
KZ,1
BA,1
DZ,1

2025-01-22 21:27:25 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:27:25 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:27:25 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:27:28 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-22 21:27:28 - snowflake.connector.connection - INFO - closed
2025-01-22 21:27:28 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:28:08 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:28:08 - root - INFO - ```sql
SELECT f_assignee.value:"name"::STRING AS "assignee_name",
       COUNT(*) AS "total_applications"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee,
     LATERAL FLATTEN(input => t."cpc") f_cpc
WHERE f_cpc.value:"code"::STRING LIKE 'A01B3%'
  AND f_assignee.value:"name"::STRING IS NOT NULL
GROUP BY f_assignee.value:"name"::STRING
ORDER BY "total_applications" DESC
LIMIT 100;
```
2025-01-22 21:28:08 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:28:08 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:28:08 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:28:09 - snowflake.connector.cursor - INFO - Number of results in first chunk: 87
2025-01-22 21:28:09 - snowflake.connector.connection - INFO - closed
2025-01-22 21:28:10 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:28:53 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:28:53 - root - INFO - SQL:
SELECT f_assignee.value:"name"::STRING AS "assignee_name",
       COUNT(*) AS "total_applications"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee,
     LATERAL FLATTEN(input => t."cpc") f_cpc
WHERE f_cpc.value:"code"::STRING LIKE 'A01B3%'
  AND f_assignee.value:"name"::STRING IS NOT NULL
GROUP BY f_assignee.value:"name"::STRING
ORDER BY "total_applications" DESC
LIMIT 100;
Results:
assignee_name,total_applications
LELY NV C VAN DER,13
TEXAS INDUSTRIES INC,6
DEERE & CO,6
CARLUCCI JAMES J,4
TWOSE OF TIVERTON LTD,4
WALTER ROWAN JAMES,4
MCKAY RALPH LTD,4
OTULAK PRZEMYSLAW PRO CNC,4
PATENT CONCERN NV,3
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,3
MARTIN CHARLES H,3
UNIV HEILONGJIANG SCI & TECH,3
LEINFELDER DIPL-LANDW HERMANN,3
UNIV JIANGSU,3
AMAZONEN-WERKE H DREYER GMBH & CO KG,3
CNH IND AMERICA LLC,3
PREC PLANTING LLC,3
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,3
MARTIN DOMINIC R,3
BETEK GMBH & CO KG,3
ARWAC LTD,3
BOTVID SETTERGREN ANDERS GOSTA,2
RICHARD CO,2
KUHN SA,2
QUINSTAR CORP,2
CHRISTOPHER H R WOODWARD,2
SHEPPARD RICHARD H,2
GLASIER HAROLD H,2
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,2
FISHER VAN E,2
AMAZONEN WERKE DREYER H,2
RUDOLPH HASSON PAUL,2
JIM ALEX SMITH,2
AUGUST SETTERGREN OTTO GORAN,2
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,2
KIM BYUNG SUB,2
ZHANG LIJIN,2
UNIV SYDNEY,2
KORSMEYER ERNEST H,2
WILLIAM DREFKE,2
CAMPBELL CLARENCE L,2
SIGFRID ANDERSON ANDERS,2
HARRELL DANNY H,2
CHOATE STOREY NORMAN,2
EDMOND HEE,2
EDWARDS JOHN W,2
WILLIAM HENRY HONY FROST,2
HUBEI SHUANGYU MACHINERY TECH CO LTD,2
UNIV TONGJI,2
WANG XUEDONG,2
LEIJENAAR SYTZE,2
SAMSUNG SDI CO LTD,2
Liu Yueshang,2
AGSOILWORKS TECH COMPANY LLC,2
SAPHIR MASCHB GMBH,2
CHONGQING TIANJI IND CO LTD,2
DAEHO FARMING MACHINERY CO LTD,1
GEORGE A KELLY PLOW COMPANY,1
GERBER MAURICE,1
HUBER FRANZ FERDINAND,1
GUERBET FRANCOIS,1
EMPR IMPORT EXPORT Y DISTRIB P,1
UNIV CHUNG ANG IND,1
NIEMEYER SOEHNE STAHL PFLUG,1
CHO SUNG GU,1
TRECKER FRANCIS J,1
KUBOTA KK,1
SALGE HENRY F,1
ALLEN SAMUEL L,1
KIM JAE KEUN,1
SOUTHERN PLOW COMPANY,1
CHRISTEN ARNE JENSEN,1
GERBER HUBERT,1
LG ELECTRONICS INC,1
NEW ZEALAND INVENTIONS DEV,1
BULLS CO LTD,1
INT HARVESTER GREAT BRITAIN,1
ARTHUR BROOKS SPURR,1
ELEOS ROBOTICS INC,1
LIM HEON HO,1
KIM JONG JIN,1
HOLGER LETH,1
WALLNER KLAUS,1
SJOEHOLMS MEKANISKA AB,1
SAMSUNG KWANGJU ELECTRONICS CO,1
DAIYO TANGO CO LTD,1
LEMKEN GMBH & CO KG,1

2025-01-22 21:28:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:28:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:28:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:28:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 95
2025-01-22 21:28:54 - snowflake.connector.connection - INFO - closed
2025-01-22 21:28:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:28:55 - root - INFO - SQL:
SELECT f_assignee.value:"name"::STRING AS "assignee_name",
       EXTRACT(year FROM TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD')) AS "year",
       COUNT(*) AS "applications"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee,
     LATERAL FLATTEN(input => t."cpc") f_cpc
WHERE f_cpc.value:"code"::STRING LIKE 'A01B3%'
  AND TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD') IS NOT NULL
GROUP BY f_assignee.value:"name"::STRING, "year"
ORDER BY f_assignee.value:"name"::STRING, "applications" DESC
LIMIT 100
Results:
assignee_name,year,applications
AGSOILWORKS TECH COMPANY LLC,2019,2
ALLEN SAMUEL L,1906,1
AMAZONEN WERKE DREYER H,1980,1
AMAZONEN WERKE DREYER H,1982,1
AMAZONEN-WERKE H DREYER GMBH & CO KG,2017,3
ARTHUR BROOKS SPURR,1953,1
ARWAC LTD,2022,3
AUGUST SETTERGREN OTTO GORAN,1951,2
BETEK GMBH & CO KG,2017,3
BOTVID SETTERGREN ANDERS GOSTA,1951,2
BULLS CO LTD,2012,1
CAMPBELL CLARENCE L,1936,2
CARLUCCI JAMES J,1976,4
CHO SUNG GU,1999,1
CHOATE STOREY NORMAN,1936,2
CHONGQING TIANJI IND CO LTD,2016,2
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,2017,2
CHRISTEN ARNE JENSEN,1928,1
CHRISTOPHER H R WOODWARD,1923,2
CNH IND AMERICA LLC,2024,3
DAEHO FARMING MACHINERY CO LTD,2000,1
DAIYO TANGO CO LTD,1990,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,2019,2
DEERE & CO,2020,2
DEERE & CO,2007,2
DEERE & CO,2018,1
DEERE & CO,1980,1
EDMOND HEE,1920,2
EDWARDS JOHN W,2005,2
ELEOS ROBOTICS INC,2019,1
EMPR IMPORT EXPORT Y DISTRIB P,1991,1
FISHER VAN E,1925,2
GEORGE A KELLY PLOW COMPANY,1902,1
GERBER HUBERT,2010,1
GERBER MAURICE,2010,1
GLASIER HAROLD H,1932,2
GUERBET FRANCOIS,1976,1
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,2022,3
HARRELL DANNY H,1993,2
HOLGER LETH,1928,1
HUBEI SHUANGYU MACHINERY TECH CO LTD,2018,2
HUBER FRANZ FERDINAND,2018,1
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,2023,3
INT HARVESTER GREAT BRITAIN,1958,1
JIM ALEX SMITH,1958,2
KIM BYUNG SUB,1999,2
KIM JAE KEUN,2002,1
KIM JONG JIN,2002,1
KORSMEYER ERNEST H,1922,2
KUBOTA KK,2001,1
KUHN SA,2017,2
LEIJENAAR SYTZE,1995,2
LEINFELDER DIPL-LANDW HERMANN,1967,3
LELY NV C VAN DER,1987,6
LELY NV C VAN DER,1988,2
LELY NV C VAN DER,1986,2
LELY NV C VAN DER,1985,2
LELY NV C VAN DER,1984,1
LEMKEN GMBH & CO KG,2014,1
LG ELECTRONICS INC,2019,1
LIM HEON HO,2016,1
Liu Yueshang,2022,2
MARTIN CHARLES H,2019,3
MARTIN DOMINIC R,2019,3
MCKAY RALPH LTD,1982,4
NEW ZEALAND INVENTIONS DEV,1976,1
NIEMEYER SOEHNE STAHL PFLUG,1952,1
OTULAK PRZEMYSLAW PRO CNC,2023,4
PATENT CONCERN NV,1979,3
PREC PLANTING LLC,2018,3
QUINSTAR CORP,1997,2
RICHARD CO,1964,2
RUDOLPH HASSON PAUL,1936,2
SALGE HENRY F,1914,1
SAMSUNG KWANGJU ELECTRONICS CO,2008,1
SAMSUNG SDI CO LTD,2007,2
SAPHIR MASCHB GMBH,2023,2
SHEPPARD RICHARD H,1957,2
SIGFRID ANDERSON ANDERS,1962,2
SJOEHOLMS MEKANISKA AB,1986,1
SOUTHERN PLOW COMPANY,1913,1
TEXAS INDUSTRIES INC,1982,6
TRECKER FRANCIS J,1959,1
TWOSE OF TIVERTON LTD,1984,4
UNIV CHUNG ANG IND,2013,1
UNIV HEILONGJIANG SCI & TECH,2018,3
UNIV JIANGSU,2021,3
UNIV SYDNEY,2018,2
UNIV TONGJI,2018,2
WALLNER KLAUS,2020,1
WALTER ROWAN JAMES,1952,4
WANG XUEDONG,2022,2
WILLIAM DREFKE,1927,2
WILLIAM HENRY HONY FROST,1935,2
ZHANG LIJIN,2021,2

2025-01-22 21:28:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:28:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:28:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:28:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 87
2025-01-22 21:28:57 - snowflake.connector.connection - INFO - closed
2025-01-22 21:28:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:28:57 - root - INFO - SQL:
SELECT final."assignee_name", final."year", t."country_code", COUNT(*) AS "applications"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee,
     LATERAL FLATTEN(input => t."cpc") f_cpc,
     (
       SELECT f_assignee_sub.value:"name"::STRING AS "assignee_name",
              EXTRACT(year FROM TRY_TO_DATE(t_sub."publication_date"::STRING, 'YYYYMMDD')) AS "year",
              COUNT(*) AS "applications"
       FROM "PATENTS"."PATENTS"."PUBLICATIONS" t_sub,
            LATERAL FLATTEN(input => t_sub."assignee_harmonized") f_assignee_sub,
            LATERAL FLATTEN(input => t_sub."cpc") f_cpc_sub
       WHERE f_cpc_sub.value:"code"::STRING LIKE 'A01B3%'
         AND TRY_TO_DATE(t_sub."publication_date"::STRING, 'YYYYMMDD') IS NOT NULL
       GROUP BY f_assignee_sub.value:"name"::STRING, "year"
       QUALIFY ROW_NUMBER() OVER (PARTITION BY f_assignee_sub.value:"name"::STRING ORDER BY COUNT(*) DESC) = 1
     ) final
WHERE f_assignee.value:"name"::STRING = final."assignee_name"
  AND EXTRACT(year FROM TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD')) = final."year"
  AND f_cpc.value:"code"::STRING LIKE 'A01B3%'
  AND TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD') IS NOT NULL
GROUP BY final."assignee_name", final."year", t."country_code"
ORDER BY final."assignee_name", "applications" DESC
LIMIT 100
Results:
assignee_name,year,country_code,applications
AGSOILWORKS TECH COMPANY LLC,2019,IL,2
ALLEN SAMUEL L,1906,US,1
AMAZONEN WERKE DREYER H,1980,AT,1
AMAZONEN-WERKE H DREYER GMBH & CO KG,2017,CN,3
ARTHUR BROOKS SPURR,1953,GB,1
ARWAC LTD,2022,GB,3
AUGUST SETTERGREN OTTO GORAN,1951,US,2
BETEK GMBH & CO KG,2017,CN,3
BOTVID SETTERGREN ANDERS GOSTA,1951,US,2
BULLS CO LTD,2012,KR,1
CAMPBELL CLARENCE L,1936,US,2
CARLUCCI JAMES J,1976,US,4
CHO SUNG GU,1999,KR,1
CHOATE STOREY NORMAN,1936,US,2
CHONGQING TIANJI IND CO LTD,2016,CN,2
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,2017,CN,2
CHRISTEN ARNE JENSEN,1928,DE,1
CHRISTOPHER H R WOODWARD,1923,US,2
CNH IND AMERICA LLC,2024,US,3
DAEHO FARMING MACHINERY CO LTD,2000,KR,1
DAIYO TANGO CO LTD,1990,KR,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,2019,CN,2
DEERE & CO,2007,AU,2
EDMOND HEE,1920,FR,2
EDWARDS JOHN W,2005,CA,2
ELEOS ROBOTICS INC,2019,CA,1
EMPR IMPORT EXPORT Y DISTRIB P,1991,NO,1
FISHER VAN E,1925,US,2
GEORGE A KELLY PLOW COMPANY,1902,US,1
GERBER HUBERT,2010,FR,1
GERBER MAURICE,2010,FR,1
GLASIER HAROLD H,1932,US,2
GUERBET FRANCOIS,1976,CA,1
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,2022,CN,3
HARRELL DANNY H,1993,US,2
HOLGER LETH,1928,DE,1
HUBEI SHUANGYU MACHINERY TECH CO LTD,2018,CN,2
HUBER FRANZ FERDINAND,2018,DE,1
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,2023,CN,3
INT HARVESTER GREAT BRITAIN,1958,GB,1
JIM ALEX SMITH,1958,US,2
KIM BYUNG SUB,1999,KR,2
KIM JAE KEUN,2002,KR,1
KIM JONG JIN,2002,KR,1
KORSMEYER ERNEST H,1922,US,2
KUBOTA KK,2001,KR,1
KUHN SA,2017,CA,2
LEIJENAAR SYTZE,1995,BE,2
LEINFELDER DIPL-LANDW HERMANN,1967,DE,3
LELY NV C VAN DER,1987,IT,6
LEMKEN GMBH & CO KG,2014,DE,1
LG ELECTRONICS INC,2019,US,1
LIM HEON HO,2016,KR,1
Liu Yueshang,2022,CN,2
MARTIN CHARLES H,2019,US,3
MARTIN DOMINIC R,2019,US,3
MCKAY RALPH LTD,1982,ZA,4
NEW ZEALAND INVENTIONS DEV,1976,AU,1
NIEMEYER SOEHNE STAHL PFLUG,1952,DE,1
OTULAK PRZEMYSLAW PRO CNC,2023,PL,4
PATENT CONCERN NV,1979,BE,3
PREC PLANTING LLC,2018,CN,3
QUINSTAR CORP,1997,US,2
RICHARD CO,1964,US,2
RUDOLPH HASSON PAUL,1936,US,2
SALGE HENRY F,1914,US,1
SAMSUNG KWANGJU ELECTRONICS CO,2008,CN,1
SAMSUNG SDI CO LTD,2007,KR,2
SAPHIR MASCHB GMBH,2023,EP,2
SHEPPARD RICHARD H,1957,US,2
SIGFRID ANDERSON ANDERS,1962,US,2
SJOEHOLMS MEKANISKA AB,1986,NO,1
SOUTHERN PLOW COMPANY,1913,US,1
TEXAS INDUSTRIES INC,1982,FR,6
TRECKER FRANCIS J,1959,US,1
TWOSE OF TIVERTON LTD,1984,GB,4
UNIV CHUNG ANG IND,2013,KR,1
UNIV HEILONGJIANG SCI & TECH,2018,CN,3
UNIV JIANGSU,2021,CN,3
UNIV SYDNEY,2018,AU,2
UNIV TONGJI,2018,CN,2
WALLNER KLAUS,2020,HU,1
WALTER ROWAN JAMES,1952,US,4
WANG XUEDONG,2022,CN,2
WILLIAM DREFKE,1927,US,2
WILLIAM HENRY HONY FROST,1935,GB,2
ZHANG LIJIN,2021,CN,2

2025-01-22 21:28:57 - root - INFO - itercount: 0
2025-01-22 21:28:57 - root - INFO - Database Name: PATENTS
Schema Name: PATENTS
DDL describes table information.
,0
table_name,DISCLOSURES_13
description,
DDL,"create or replace TABLE DISCLOSURES_13 (
	""family_id"" VARCHAR(16777216),
	""record_id"" VARCHAR(16777216),
	""disclosure_event"" VARCHAR(16777216),
	""sso"" VARCHAR(16777216),
	""patent_owner_harmonized"" VARCHAR(16777216),
	""patent_owner_unharmonized"" VARCHAR(16777216),
	""date"" NUMBER(38,0),
	""standard"" VARCHAR(16777216),
	""committee_project"" VARCHAR(16777216),
	""tc_name"" VARCHAR(16777216),
	""sc_name"" VARCHAR(16777216),
	""wg_name"" VARCHAR(16777216),
	""licensing_commitment"" VARCHAR(16777216),
	""copyright"" VARCHAR(16777216),
	""blanket_type"" VARCHAR(16777216),
	""blanket_scope"" VARCHAR(16777216),
	""third_party"" VARCHAR(16777216),
	""reciprocity"" VARCHAR(16777216),
	""serial_cleaned"" VARCHAR(16777216),
	""pub_cleaned"" VARCHAR(16777216)
);"

,1
table_name,PUBLICATIONS
description,
DDL,"create or replace TABLE PUBLICATIONS (
	""publication_number"" VARCHAR(16777216),
	""application_number"" VARCHAR(16777216),
	""country_code"" VARCHAR(16777216),
	""kind_code"" VARCHAR(16777216),
	""application_kind"" VARCHAR(16777216),
	""application_number_formatted"" VARCHAR(16777216),
	""pct_number"" VARCHAR(16777216),
	""family_id"" VARCHAR(16777216),
	""spif_publication_number"" VARCHAR(16777216),
	""spif_application_number"" VARCHAR(16777216),
	""title_localized"" VARIANT,
	""abstract_localized"" VARIANT,
	""claims_localized"" VARIANT,
	""claims_localized_html"" VARIANT,
	""description_localized"" VARIANT,
	""description_localized_html"" VARIANT,
	""publication_date"" NUMBER(38,0),
	""filing_date"" NUMBER(38,0),
	""grant_date"" NUMBER(38,0),
	""priority_date"" NUMBER(38,0),
	""priority_claim"" VARIANT,
	""inventor"" VARIANT,
	""inventor_harmonized"" VARIANT,
	""assignee"" VARIANT,
	""assignee_harmonized"" VARIANT,
	""examiner"" VARIANT,
	""uspc"" VARIANT,
	""ipc"" VARIANT,
	""cpc"" VARIANT,
	""fi"" VARIANT,
	""fterm"" VARIANT,
	""locarno"" VARIANT,
	""citation"" VARIANT,
	""parent"" VARIANT,
	""child"" VARIANT,
	""entity_status"" VARCHAR(16777216),
	""art_unit"" VARCHAR(16777216)
);"

,2
table_name,CPC_DEFINITION
description,
DDL,"create or replace TABLE CPC_DEFINITION (
	""applicationReferences"" VARIANT,
	""breakdownCode"" BOOLEAN,
	""childGroups"" VARIANT,
	""children"" VARIANT,
	""dateRevised"" FLOAT,
	""definition"" VARIANT,
	""glossary"" VARIANT,
	""informativeReferences"" VARIANT,
	""ipcConcordant"" VARCHAR(16777216),
	""level"" FLOAT,
	""limitingReferences"" VARIANT,
	""notAllocatable"" BOOLEAN,
	""parents"" VARIANT,
	""precedenceLimitingReferences"" VARIANT,
	""residualReferences"" VARIANT,
	""rules"" VARIANT,
	""scopeLimitingReferences"" VARIANT,
	""status"" VARCHAR(16777216),
	""symbol"" VARCHAR(16777216),
	""synonyms"" VARIANT,
	""titleFull"" VARCHAR(16777216),
	""titlePart"" VARIANT
);"

External knowledge that might be helpful: 
None
The table structure information is ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}
Begin Exploring Related Columns
Columns and potential usage:

- `"cpc"`: Used to filter patents in class 'A01B3' by matching CPC codes.
- `"assignee_harmonized"`: Used to extract assignee names.
- `"application_number"`: Used to count the number of applications per assignee.
- `"publication_date"`: Used to determine the year of publication for each application.
- `"country_code"`: Used to identify the country code associated with each application.

Conditions that may be used:

- Filter entries where the CPC code is 'A01B3'.
- Extract the year from the `"publication_date"` column.
- Group data by assignee names and years.
- Count the number of applications per assignee and per year.
- Identify the country code with the most applications for each assignee during the peak year.

SQL queries:

1. **Retrieve a sample of publication numbers and CPC codes:**
   ```sql
   SELECT t."publication_number", t."cpc"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t
   LIMIT 100;
   ```

2. **Retrieve a sample of application numbers and assignee information:**
   ```sql
   SELECT t."application_number", t."assignee_harmonized"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t
   LIMIT 100;
   ```

3. **List distinct CPC codes present in the dataset:**
   ```sql
   SELECT DISTINCT f.value:"code"::STRING AS "cpc_code"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(input => t."cpc") f
   LIMIT 100;
   ```

4. **Extract assignee names from the harmonized assignee data:**
   ```sql
   SELECT DISTINCT f.value:"name"::STRING AS "assignee_name"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(input => t."assignee_harmonized") f
   LIMIT 100;
   ```

5. **Count the number of applications per CPC code:**
   ```sql
   SELECT f.value:"code"::STRING AS "cpc_code", COUNT(*) AS "application_count"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(input => t."cpc") f
   GROUP BY f.value:"code"::STRING
   ORDER BY "application_count" DESC
   LIMIT 100;
   ```

6. **Count total applications per assignee:**
   ```sql
   SELECT f.value:"name"::STRING AS "assignee_name", COUNT(*) AS "total_applications"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(input => t."assignee_harmonized") f
   GROUP BY f.value:"name"::STRING
   ORDER BY "total_applications" DESC
   LIMIT 100;
   ```

7. **Extract the year from publication dates and count applications per year:**
   ```sql
   SELECT EXTRACT(year FROM TO_DATE(t."publication_date"::STRING, 'YYYYMMDD')) AS "year", COUNT(*) AS "applications_per_year"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t
   GROUP BY "year"
   ORDER BY "applications_per_year" DESC
   LIMIT 100;
   ```

8. **Count applications per assignee per year:**
   ```sql
   SELECT f.value:"name"::STRING AS "assignee_name",
          EXTRACT(year FROM TO_DATE(t."publication_date"::STRING, 'YYYYMMDD')) AS "year",
          COUNT(*) AS "applications"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(input => t."assignee_harmonized") f
   GROUP BY f.value:"name"::STRING, "year"
   ORDER BY "applications" DESC
   LIMIT 100;
   ```

9. **Identify the country codes with the most applications:**
   ```sql
   SELECT t."country_code", COUNT(*) AS "application_count"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t
   GROUP BY t."country_code"
   ORDER BY "application_count" DESC
   LIMIT 100;
   ```

10. **Count applications for CPC code 'A01B3' per assignee:**
    ```sql
    SELECT f_assignee.value:"name"::STRING AS "assignee_name", COUNT(*) AS "total_applications"
    FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee,
    LATERAL FLATTEN(input => t."cpc") f_cpc
    WHERE f_cpc.value:"code"::STRING = 'A01B3'
    GROUP BY f_assignee.value:"name"::STRING
    ORDER BY "total_applications" DESC
    LIMIT 100;
    ```

11. **Find the year with the most applications for each assignee in CPC class 'A01B3':**
    ```sql
    SELECT f_assignee.value:"name"::STRING AS "assignee_name",
           EXTRACT(year FROM TO_DATE(t."publication_date"::STRING, 'YYYYMMDD')) AS "year",
           COUNT(*) AS "applications"
    FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee,
    LATERAL FLATTEN(input => t."cpc") f_cpc
    WHERE f_cpc.value:"code"::STRING = 'A01B3'
    GROUP BY f_assignee.value:"name"::STRING, "year"
    ORDER BY f_assignee.value:"name"::STRING, "applications" DESC
    LIMIT 100;
    ```

12. **Identify the country code with the most applications for each assignee during their peak year in CPC class 'A01B3':**
    ```sql
    SELECT final."assignee_name", final."year", t."country_code", COUNT(*) AS "applications"
    FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
    LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee,
    LATERAL FLATTEN(input => t."cpc") f_cpc,
    (
      SELECT f_assignee.value:"name"::STRING AS "assignee_name",
             EXTRACT(year FROM TO_DATE(t."publication_date"::STRING, 'YYYYMMDD')) AS "year",
             COUNT(*) AS "applications"
      FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
      LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee,
      LATERAL FLATTEN(input => t."cpc") f_cpc
      WHERE f_cpc.value:"code"::STRING = 'A01B3'
      GROUP BY f_assignee.value:"name"::STRING, "year"
      QUALIFY ROW_NUMBER() OVER (PARTITION BY f_assignee.value:"name"::STRING ORDER BY COUNT(*) DESC) = 1
    ) final
    WHERE f_assignee.value:"name"::STRING = final."assignee_name"
      AND EXTRACT(year FROM TO_DATE(t."publication_date"::STRING, 'YYYYMMDD')) = final."year"
      AND f_cpc.value:"code"::STRING = 'A01B3'
    GROUP BY final."assignee_name", final."year", t."country_code"
    ORDER BY final."assignee_name", "applications" DESC
    LIMIT 100;
    ```

In these queries:

- We use `LATERAL FLATTEN` to parse JSON arrays in the `"cpc"` and `"assignee_harmonized"` columns.
- We extract the CPC code and assignee names from the nested JSON structure.
- We use `EXTRACT(year FROM TO_DATE(...))` to convert the numeric `"publication_date"` into a year.
- We group and count the data as needed to explore counts per assignee, year, and country code.
- All column names are enclosed in double quotations as per the instructions.

These queries help in understanding the structure and content of the data, which is essential for performing the analysis required by the task.Query:
SELECT t."publication_number", t."cpc"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t
   LIMIT 100;
Answer:
Too long, hard cut:
publication_number,cpc
CR-5634-A,[]
CR-5990-A,[]
FI-429-A,[]
HK-6083-A,"[
  {
    ""code"": ""H02M5/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
HU-T52763-A,"[
  {
    ""code"": ""A01N47/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D521/00"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
JP-H03206829-A,"[
  {
    ""code"": ""Y02A40/81"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
JP-S62159089-A,"[
  {
    ""code"": ""Y02E30/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  }
]"
US-416-A,"[
  {
    ""code"": ""Y10T83/465"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""B26F1/42"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
US-2528225-A,"[
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E21B27/02"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A41580-A,"[
  {
    ""code"": ""B22D11/086"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A47682-A,"[
  {
    ""code"": ""C07D471/16"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D471/22"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
AT-A63682-A,"[
  {
    ""code"": ""G01N33/48728"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-920790-A,"[
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C03C4/12"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-950907-A,"[
  {
    ""code"": ""C11B5/0064"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/35"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C11B5/0035"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M135/36"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C09K15/30"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D263/56"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/44"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D235/12"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/3447"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M133/48"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/46"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D277/64"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C08K5/47"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/224"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/102"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/106"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/104"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2219/10"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/30"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/221"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/226"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/225"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10M2215/22"",
    ""first"": false,
    ""inventive"": false,
    ""tree"": []
  },
  {
    ""code"": ""C10L1/14"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-920830-A,"[
  {
    ""code"": ""E02D5/808"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/385"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/26"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D7/28"",
    ""first"": true,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""E02D5/54"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  }
]"
CA-9086-A,[]
CH-3256-A,[]
CH-540255-A,"[
  {
    ""code"": ""C07D213/32"",
    ""first"": false,
    ""inventive"": true,
    ""tree"": []
  },
  {
    ""code"": ""C07D213/51"",
    ""first"": false,
    ""inven
Query:
SELECT t."application_number", t."assignee_harmonized"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t
   LIMIT 100;
Answer:
Too long, hard cut:
application_number,assignee_harmonized
CR-5634-A,"[
  {
    ""country_code"": ""CR"",
    ""name"": ""UNIV COSTA RICA""
  }
]"
CR-5990-A,"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BAYER AG""
  }
]"
FI-429D-A,[]
HK-6083-A,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""CRABTREE ELECTRICAL IND LTD""
  }
]"
HU-7590-A,"[
  {
    ""country_code"": """",
    ""name"": ""BASF AG""
  }
]"
JP-4890-A,"[
  {
    ""country_code"": """",
    ""name"": ""MORITA SANGYO KK""
  }
]"
JP-6286-A,"[
  {
    ""country_code"": """",
    ""name"": ""TOSHIBA CORP""
  }
]"
US-416D-A,[]
US-9948-A,"[
  {
    ""country_code"": """",
    ""name"": ""ADOLPH BEREN""
  }
]"
AT-41580-A,"[
  {
    ""country_code"": ""AT"",
    ""name"": ""VOEST ALPINE AG""
  }
]"
AT-47682-A,"[
  {
    ""country_code"": ""HU"",
    ""name"": ""CHINOIN GYOGYSZER ES VEGYESZET""
  }
]"
AT-63682-A,"[
  {
    ""country_code"": ""AT"",
    ""name"": ""PFUETZNER HELMUT DIPL ING DR T""
  },
  {
    ""country_code"": ""AT"",
    ""name"": ""KRAUSE ERWIN DIPL ING""
  }
]"
CA-72337-A,"[
  {
    ""country_code"": ""US"",
    ""name"": ""BROCKWAY GLASS CO INC""
  }
]"
CA-75688-A,"[
  {
    ""country_code"": """",
    ""name"": ""CIBA GEIGY""
  }
]"
CA-81627-A,"[
  {
    ""country_code"": ""DE"",
    ""name"": ""MUELLER G""
  }
]"
CA-9086D-A,"[
  {
    ""country_code"": ""CA"",
    ""name"": ""SHARMAN JAMES""
  }
]"
CH-3256D-A,"[
  {
    ""country_code"": ""FR"",
    ""name"": ""LE BLON CHARLES""
  },
  {
    ""country_code"": ""FR"",
    ""name"": ""A OBLASSER A GODDYN ET CIE SOC""
  }
]"
CH-32972-A,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""ICI LTD""
  }
]"
CH-59566-A,"[
  {
    ""country_code"": ""IT"",
    ""name"": ""FARINA & FIGLI A""
  }
]"
CH-8494D-A,"[
  {
    ""country_code"": ""CH"",
    ""name"": ""KNOBEL & HEER""
  }
]"
CH-9587D-A,"[
  {
    ""country_code"": ""DE"",
    ""name"": ""ROESCH ARTHUR""
  },
  {
    ""country_code"": ""DE"",
    ""name"": ""ENGEL HUGO""
  }
]"
CH-9968D-A,"[
  {
    ""country_code"": ""DE"",
    ""name"": ""BOECKLEIN JOSEF""
  }
]"
DD-8297D-A,[]
FR-19873-A,[]
FR-20966-A,"[
  {
    ""country_code"": """",
    ""name"": ""M & T CHEMICALS INC""
  }
]"
FR-56170-A,"[
  {
    ""country_code"": """",
    ""name"": ""LOEWE OPTA AG""
  }
]"
FR-60658-A,"[
  {
    ""country_code"": """",
    ""name"": ""BAYER AG""
  }
]"
FR-68041-A,"[
  {
    ""country_code"": """",
    ""name"": ""MITSUBISHI HEAVY IND LTD""
  }
]"
FR-70755-A,"[
  {
    ""country_code"": """",
    ""name"": ""GLOBE UNION INC""
  }
]"
FR-84394-A,"[
  {
    ""country_code"": """",
    ""name"": ""ISAP SPA""
  }
]"
GB-15660-A,"[
  {
    ""country_code"": """",
    ""name"": ""JOSHUA BIGWOOD AND SON LTD""
  }
]"
GB-50958-A,"[
  {
    ""country_code"": """",
    ""name"": ""ERWIN SCHWARZ""
  }
]"
GB-54729-A,[]
GB-93140-A,"[
  {
    ""country_code"": """",
    ""name"": ""BOSCH GMBH ROBERT""
  }
]"
HK-39487-A,"[
  {
    ""country_code"": ""NL"",
    ""name"": ""PHILIPS NV""
  }
]"
HK-52284-A,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""SUWA SEIKOSHA KK""
  }
]"
HK-55992-A,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""NIPPON STEEL CORP""
  }
]"
HK-60178-A,"[
  {
    ""country_code"": ""DE"",
    ""name"": ""HOLLINGSWORTH GMBH""
  }
]"
HK-82486-A,"[
  {
    ""country_code"": ""DE"",
    ""name"": ""ECKOLD VORRICHTUNG""
  }
]"
HU-62391-A,"[
  {
    ""country_code"": """",
    ""name"": ""DOWELANCO""
  }
]"
JP-42386-A,"[
  {
    ""country_code"": """",
    ""name"": ""IGARASHI KAZUYOSHI""
  }
]"
JP-67093-A,"[
  {
    ""country_code"": """",
    ""name"": ""HITACHI LTD""
  }
]"
MA-42286-A,"[
  {
    ""country_code"": ""JP"",
    ""name"": ""CHIYODA CORP""
  }
]"
OA-58112-A,"[
  {
    ""country_code"": """",
    ""name"": ""ROUSSEL UCLAF""
  }
]"
OA-58887-A,"[
  {
    ""country_code"": """",
    ""name"": ""PETROL ENGINERING S A""
  }
]"
PH-14999-A,"[
  {
    ""country_code"": """",
    ""name"": ""IRECO CHEMICALS""
  }
]"
PH-21568-A,"[
  {
    ""country_code"": """",
    ""name"": ""COLGATE PALMOLIVE CO""
  }
]"
PH-27280-A,"[
  {
    ""country_code"": """",
    ""name"": ""FERRER INT""
  }
]"
PH-36517-A,"[
  {
    ""country_code"": """",
    ""name"": ""LILLY CO ELI""
  }
]"
TR-25990-A,"[
  {
    ""country_code"": ""DE"",
    ""name"": ""MAUSER WERKE GMBH""
  }
]"
US-4613D-A,[]
US-59779-A,"[
  {
    ""country_code"": """",
    ""name"": ""HOEYER ELLEFSEN AS""
  }
]"
US-6310D-A,[]
US-8947D-A,[]
YU-24971-A,"[
  {
    ""country_code"": ""IT"",
    ""name"": ""SOMET SOC MEC TESSILE""
  }
]"
YU-51397-A,"[
  {
    ""country_code"": ""CH"",
    ""name"": ""MIODRAG SPASOJEVIC""
  }
]"
YU-53588-A,"[
  {
    ""country_code"": ""YU"",
    ""name"": ""TEHNOLOSKI FAK N SAD""
  }
]"
YU-94082-A,"[
  {
    ""country_code"": ""GB"",
    ""name"": ""BEECHAM GROUP LTD""
  }
]"
AT-134275-A,"[
  {
    ""country_code"": ""DE"",
    ""name"": ""HOECHST AG""
  }
]"
AT-160683-A,"[
  {
    ""country_code"": ""AT"",
    ""name"": ""BLUM GMBH JULIUS""
  }
]"
AT-168281-A,"[
  
Query:
SELECT DISTINCT f.value:"code"::STRING AS "cpc_code"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(input => t."cpc") f
   LIMIT 100;
Answer:
cpc_code
B41C1/055
B01J2219/00867
G06N99/005
F04D19/002
B23K2103/10
B60L2230/16
H01J49/025
F01D5/147
G05B2219/25011
B23K26/037
F02M45/086
B29C45/14
B25B7/12
H05K2201/098
A01C7/044
C04B2235/3294
G06F40/129
H01L29/7818
C07D413/10
G06F9/45558
A45C2011/002
A63B37/005
G06F2203/04104
B60L53/12
Y02W30/62
H01L21/00
Y10T156/1783
A46B9/04
B41L11/00
G01C19/38
F02D41/005
H01L23/49811
C01P2004/51
H04M1/72418
C09D175/04
H01M4/485
G06Q10/10
C04B35/62675
A61B1/32
A61B5/065
B22F2998/10
A61M5/31511
G06F16/9035
F21S10/026
A61B5/061
H04N23/45
H01L21/761
H01L27/14621
G06K9/00765
G06F18/2113
G06F21/602
A01K89/01902
H01J2237/332
G03B15/00
C07C215/60
F04D29/051
G02F1/133528
H10K59/65
H04B7/0413
A61B5/6893
A61B34/73
H01Q13/24
G11B2220/2575
B01D65/08
G01N27/221
C08L23/04
C08L99/00
B01D53/9472
F27D3/10
C03C3/325
A61B2017/00867
B60K2370/146
B60K2370/23
B01D2253/102
B01D46/88
H04W68/00
G06Q30/0233
G06T2207/30268
H03F3/2171
G06F30/39
D06F39/08
B64C1/066
F02B51/04
B60K11/08
H04N25/766
F28F3/12
G05B17/02
G01S1/02
C07C29/147
D01H5/36
B31B2105/00
C12Q1/6883
H05K2201/0391
B60N2/02246
B60R21/215
H04L1/0025
F01D25/12
H04L2209/125
B26B29/063
B60Y2200/14
Query:
SELECT DISTINCT f.value:"name"::STRING AS "assignee_name"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(input => t."assignee_harmonized") f
   LIMIT 100;
Answer:
assignee_name
KOMATSU MFG CO LTD
SAMPUTENSILI SPA
ARPE PLAST KUNSTSTOFF
UNIV READING
CLEVELAND ROCK DRILL CO
UNICHARM CORP
CAREY PHILIP MFG CO
WESTINGHOUSE CANADA LTD
UNITED SHOE MACHINERY AB
HERWIG JORG
MATSUO MIE
JOE MATTHEW D
KOTZIN MICHAEL D
DAVIDSON MATTHEW
MARTIN KATHARINE
AMERICAN HATCHERY ENGINEERS IN
AETNA PRODUCTS & MFG CO
MAY ZIEGLER ALFRED
AUTONETWORKS TECHNOLOGIES LTD
DUERR SYSTEMS AG
DARAMIC INC
DLR EV
FUJI PHOTO OPTICAL CO LTD
GAMBRO LUNDIA AB
SHUMAN ROBERT
SCRAMOGE TECH LIMITED
MATHWORKS INC
BASF SE
HARMONIC DRIVE SYSTEMS
MUELLER FRIEDRICH
IKA INNOVATIVE KUNSTSTOFFAUFBEREITUNG GMBH & CO KG
KOBE STEEL LTD
SNECMA
LI DAQI
GS YUASA INT LTD
FLYNN ERROL W
NEGLEY GERALD H
PAUKERT DOROTHY A
KIM JAE-CHANG
VERLEGER JOBST
ERWIN SCHWARZ
IRECO CHEMICALS
BRUPAT LTD
SENSITAP LLC
WENZEL JUERGEN MICHAEL DR ING
MARHVEL S R L
BLACK & DECKER INC
SHUNAN DENKO KK
KIM JUNG WOOK
TIANMA MICROELECTRONICS CO LTD
COMMUNICATIONS SYSTEMS INC
MIMAKI ENG CO LTD
HUBEI SILE ANIMAL HUSBANDRY GROUP CO LTD
GUOKUNGKE QUANTUM TECH BEIJING LIMITED COMPANY
XINJIANG YUIN SUNSHINE CURTAIN WALL DECORATION ENGINEERING LTD COMPANY
SON SEONG GEUN
KURARAY CO
STICKNEY RONALD E
NOVA RICHARD C
KONINKLIJKE KPN NV
ILSENBURGER GROBBLECH GMBH
ENSEM THERAPEUTICS INC
LEE CHEL WON
KUROKI RENTARO
SCHILLER GROUNDS CARE INC
CHENG UEI PREC IND CO LTD
PURIDIFY LTD
AUTOMATED PACKAGING SYST INC
NOYES ANNA V
SWA HOLDING COMPANY INC
KO YOUNG HWAN
HERTLEIN ROBERT
IM JAE H
INNOVATIVE DRUG DELIVERY SYSTE
NAGURNY NICHOLAS J
COMMW SCIENT IND RES ORG
NAIKI MITSURU
COVESTRO LLC
UNIV SHANGHAI MARITIME
SINGULAR GENOMICS SYSTEMS INC
ST MICROELECTRONICS INC
YAMAICHI ELECTRONICS CO
KAIN MICHAEL T
VOLVO CAR CORP
THE BROAD INST INC
BRUSS I MEKH SELSKOGO KHOZ
NGUYEN HIEP
FRESHPOINT QUALITY ASSURANCE LTD
SUGAWARA SATORU
HUNTER CLAUD M
RENE BUCHER
HOLLYFIELD GARY
KARL MAYER STOLL R&D GMBH
BELGORODSKIJ VSESOYUZNOGO NI V
JAPAN AVIATION ELECTRON
JUNG YOUNG-BAE
IWASA AKIRA
RENAULT SA
ARENA CHANTAL
RENENSAS ELECTRONICS CORP
Query:
SELECT f.value:"code"::STRING AS "cpc_code", COUNT(*) AS "application_count"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(input => t."cpc") f
   GROUP BY f.value:"code"::STRING
   ORDER BY "application_count" DESC
   LIMIT 100;
Answer:
cpc_code,application_count
Y02E60/10,5576
A61P35/00,5514
A61P43/00,3803
A61K45/06,3065
Y02P70/50,2621
A61P29/00,2555
A61K38/00,2489
A61P25/00,2136
A61K2039/505,1915
Y02T10/12,1834
Y02E10/50,1825
A23V2002/00,1817
Y02T10/70,1777
C07D471/04,1747
H01L2924/0002,1714
A61P25/28,1694
Y02E60/50,1668
Y02A50/30,1659
H01M10/0525,1650
Y02D30/70,1618
A61P9/00,1605
A61P9/10,1499
C07D487/04,1485
A61P31/04,1483
G06N3/08,1467
A61P3/10,1463
G06N20/00,1397
C07D401/12,1347
H01L2224/48091,1339
C07D401/14,1327
A61P11/00,1312
A61P17/00,1294
A61K9/0019,1294
H04N19/176,1189
A61P19/02,1179
A61Q19/00,1172
B32B27/08,1150
C07K2317/92,1147
H01M10/052,1138
B82Y30/00,1132
Y02D10/00,1128
F21Y2115/10,1115
Y02P10/20,1096
C07K2317/76,1094
Y02P70/10,1088
H04W72/23,1063
C07K2317/24,1061
Y02T10/7072,1037
A61P35/02,1035
A61P31/12,1019
A61P1/04,1018
Y02T10/40,1000
A61P27/02,1000
G06N3/045,983
C07D401/04,980
A61P37/00,974
Y02E10/72,972
A61P1/00,967
B32B7/12,962
Y02E30/30,953
C07D413/14,940
B32B27/32,934
C08J5/18,932
H04L5/0053,926
C07D405/12,901
A61P31/00,898
A61P1/16,894
A61P37/06,893
H04W4/80,885
H04L5/0048,882
A61P37/02,881
A61P13/12,877
C07K2319/00,857
C07D405/14,849
H01M2220/20,848
A61K31/519,825
C09K11/06,819
H04L67/12,818
H01L2924/00014,808
C22C38/02,804
H01L2924/181,803
A61P11/06,802
B82Y40/00,796
G06Q30/02,785
C07K2317/565,784
A61P3/00,779
C07D417/12,777
H04W84/12,773
B33Y10/00,767
C07D403/12,761
G06F3/0482,757
C22C38/04,757
A61K39/00,755
Y02P90/02,750
A61P3/04,749
A61P9/12,744
G06Q10/10,743
C07D417/14,742
Y02W10/10,740
A61P17/06,736
Query:
SELECT f.value:"name"::STRING AS "assignee_name", COUNT(*) AS "total_applications"
   FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
   LATERAL FLATTEN(input => t."assignee_harmonized") f
   GROUP BY f.value:"name"::STRING
   ORDER BY "total_applications" DESC
   LIMIT 100;
Answer:
assignee_name,total_applications
SAMSUNG ELECTRONICS CO LTD,2242
CANON KK,2114
HITACHI LTD,2012
MATSUSHITA ELECTRIC IND CO LTD,1948
MITSUBISHI ELECTRIC CORP,1734
SONY CORP,1477
FUJITSU LTD,1364
TOSHIBA CORP,1296
NEC CORP,1280
IBM,1240
LG ELECTRONICS INC,1054
HUAWEI TECH CO LTD,1029
SIEMENS AG,988
SEIKO EPSON CORP,963
GEN ELECTRIC,947
SHARP KK,914
STATE GRID CORP CHINA,841
TOYOTA MOTOR CORP,839
HONDA MOTOR CO LTD,837
BOSCH GMBH ROBERT,837
QUALCOMM INC,813
RICOH KK,735
DENSO CORP,628
SANYO ELECTRIC CO,616
HYUNDAI MOTOR CO LTD,577
NIPPON TELEGRAPH & TELEPHONE,568
TOSHIBA KK,546
BAYER AG,529
FUJI PHOTO FILM CO LTD,522
NISSAN MOTOR,515
TOYOTA MOTOR CO LTD,508
MITSUBISHI HEAVY IND LTD,488
ZTE CORP,479
INTEL CORP,475
ERICSSON TELEFON AB L M,464
BOE TECHNOLOGY GROUP CO LTD,436
FUJI XEROX CO LTD,427
DU PONT,423
NIPPON STEEL CORP,403
MATSUSHITA ELECTRIC WORKS LTD,403
SUMITOMO ELECTRIC INDUSTRIES,400
PROCTER & GAMBLE,394
BASF AG,366
HOECHST AG,365
GREE ELECTRIC APPLIANCES INC ZHUHAI,364
PANASONIC CORP,357
SUMITOMO CHEMICAL CO,355
TOKYO SHIBAURA ELECTRIC CO,353
FUJIFILM CORP,349
BROTHER IND LTD,325
HOFFMANN LA ROCHE,324
FORD GLOBAL TECH LLC,319
LG CHEMICAL LTD,318
KYOCERA CORP,316
UNIV ZHEJIANG,314
MURATA MANUFACTURING CO,306
PHILIPS NV,304
APPLE INC,299
KONINKL PHILIPS ELECTRONICS NV,299
TORAY INDUSTRIES,298
HON HAI PREC IND CO LTD,296
DAINIPPON PRINTING CO LTD,294
SAMSUNG DISPLAY CO LTD,293
MICROSOFT CORP,285
MIDEA GROUP CO LTD,278
TAIWAN SEMICONDUCTOR MFG CO LTD,276
FUJI ELECTRIC CO LTD,270
NIPPON ELECTRIC CO,270
UNIV TSINGHUA,264
KOBE STEEL LTD,262
MICROSOFT TECHNOLOGY LICENSING LLC,256
3M INNOVATIVE PROPERTIES CO,253
SEKISUI CHEMICAL CO LTD,249
OKI ELECTRIC IND CO LTD,241
RICOH CO LTD,240
EASTMAN KODAK CO,238
OMRON TATEISI ELECTRONICS CO,236
XEROX CORP,236
KAO CORP,234
NIKON CORP,231
WESTINGHOUSE ELECTRIC CORP,231
TOKYO ELECTRON LTD,230
MOTOROLA INC,229
TOPPAN PRINTING CO LTD,229
CASIO COMPUTER CO LTD,229
BASF SE,225
KONISHIROKU PHOTO IND,225
APPLIED MATERIALS INC,224
BRIDGESTONE CORP,222
NITTO DENKO CORP,221
MICRON TECHNOLOGY INC,220
YAZAKI CORP,219
BOEING CO,217
HYNIX SEMICONDUCTOR INC,214
RCA CORP,213
HEWLETT PACKARD DEVELOPMENT CO,213
DAIKIN IND LTD,212
TDK CORP,209
LG DISPLAY CO LTD,208
SAMSUNG SDI CO LTD,208
Query:
SELECT EXTRACT(year FROM TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD')) AS "year", 
       COUNT(*) AS "applications_per_year"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t
WHERE TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD') IS NOT NULL
GROUP BY "year"
ORDER BY "applications_per_year" DESC
LIMIT 100;
Answer:
year,applications_per_year
2021,41292
2020,32403
2022,31642
2018,29555
2019,27259
2017,22925
2023,20332
2016,19668
2015,16901
2014,14404
2024,12612
2013,10925
2012,9998
2010,9468
2009,9382
2011,9167
2008,8707
2007,7994
2006,7967
2005,7441
2004,6997
2002,6333
2003,6253
2001,5873
2000,5612
1999,5422
1998,4927
1991,4669
1989,4584
1994,4451
1995,4309
1997,4269
1990,4243
1988,4242
1996,4223
1992,4086
1987,3997
1986,3941
1993,3858
1985,3785
1982,3520
1984,3494
1983,3413
1980,3178
1976,3135
1979,3123
1981,3122
1975,3071
1978,2991
1977,2940
1974,2880
1973,2440
1972,1335
1971,1244
1970,1151
1969,1146
1968,983
1967,909
1966,900
1965,777
1959,693
1961,668
1960,667
1962,656
1964,646
1958,636
1963,572
1957,560
1953,468
1956,457
1951,445
1954,432
1952,431
1950,382
1955,374
1941,351
1914,351
1936,351
1939,348
1930,335
1932,335
1938,334
1940,323
1937,322
1931,319
1935,296
1949,293
1942,290
1913,279
1943,269
1934,265
1944,262
1933,259
1929,259
1945,253
1925,252
1927,244
1928,243
1948,243
1922,235
Query:
SELECT f.value:"name"::STRING AS "assignee_name",
       EXTRACT(year FROM TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD')) AS "year",
       COUNT(*) AS "applications"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f
WHERE TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD') IS NOT NULL
GROUP BY f.value:"name"::STRING, "year"
ORDER BY "applications" DESC
LIMIT 100
Answer:
assignee_name,year,applications
SAMSUNG ELECTRONICS CO LTD,2008,146
SAMSUNG ELECTRONICS CO LTD,2007,141
SAMSUNG ELECTRONICS CO LTD,2006,131
STATE GRID CORP CHINA,2017,120
SAMSUNG ELECTRONICS CO LTD,2023,116
HUAWEI TECH CO LTD,2021,113
STATE GRID CORP CHINA,2015,109
SAMSUNG ELECTRONICS CO LTD,2021,109
SAMSUNG ELECTRONICS CO LTD,2022,108
STATE GRID CORP CHINA,2018,106
STATE GRID CORP CHINA,2016,100
MATSUSHITA ELECTRIC IND CO LTD,2006,100
SAMSUNG ELECTRONICS CO LTD,2020,100
STATE GRID CORP CHINA,2014,97
HUAWEI TECH CO LTD,2022,96
SAMSUNG ELECTRONICS CO LTD,2000,95
HUAWEI TECH CO LTD,2023,91
HITACHI LTD,1986,91
NEC CORP,1991,91
IBM,2021,90
MATSUSHITA ELECTRIC IND CO LTD,2005,88
MATSUSHITA ELECTRIC IND CO LTD,2003,86
HITACHI LTD,1989,86
NEC CORP,1988,85
SAMSUNG ELECTRONICS CO LTD,2014,84
HUAWEI TECH CO LTD,2019,84
SAMSUNG ELECTRONICS CO LTD,2019,83
STATE GRID CORP CHINA,2019,83
SAMSUNG ELECTRONICS CO LTD,2005,82
CANON KK,2004,82
CANON KK,2006,82
NEC CORP,1989,82
NEC CORP,1990,82
SAMSUNG ELECTRONICS CO LTD,2024,80
SAMSUNG ELECTRONICS CO LTD,2018,80
SAMSUNG ELECTRONICS CO LTD,2015,80
SAMSUNG ELECTRONICS CO LTD,2017,79
MATSUSHITA ELECTRIC IND CO LTD,2001,79
MATSUSHITA ELECTRIC IND CO LTD,2004,79
MATSUSHITA ELECTRIC IND CO LTD,2007,78
HUAWEI TECH CO LTD,2018,78
IBM,2020,75
MATSUSHITA ELECTRIC IND CO LTD,2008,75
MITSUBISHI ELECTRIC CORP,1989,75
MATSUSHITA ELECTRIC IND CO LTD,1985,75
TOSHIBA CORP,1989,73
TOSHIBA CORP,1987,73
MATSUSHITA ELECTRIC IND CO LTD,1986,73
CANON KK,2021,73
QUALCOMM INC,2021,72
SAMSUNG ELECTRONICS CO LTD,2004,72
GREE ELECTRIC APPLIANCES INC ZHUHAI,2019,72
SAMSUNG ELECTRONICS CO LTD,2009,72
MATSUSHITA ELECTRIC IND CO LTD,1991,71
HITACHI LTD,1987,70
CANON KK,2009,70
SAMSUNG ELECTRONICS CO LTD,1999,70
GREE ELECTRIC APPLIANCES INC ZHUHAI,2021,70
SAMSUNG ELECTRONICS CO LTD,2010,69
CANON KK,2008,69
CANON KK,2020,69
SAMSUNG ELECTRONICS CO LTD,2016,69
TOSHIBA CORP,1988,68
NEC CORP,1992,68
MATSUSHITA ELECTRIC IND CO LTD,2002,68
CANON KK,2001,67
HITACHI LTD,1990,67
CANON KK,2000,67
SAMSUNG ELECTRONICS CO LTD,2013,67
HITACHI LTD,1983,66
MATSUSHITA ELECTRIC IND CO LTD,1992,66
MATSUSHITA ELECTRIC IND CO LTD,1989,66
HITACHI LTD,1988,66
QUALCOMM INC,2022,66
SONY CORP,2008,65
HUAWEI TECH CO LTD,2020,65
SONY CORP,2001,65
HITACHI LTD,1977,64
NEC CORP,1987,64
HITACHI LTD,1985,64
HUAWEI TECH CO LTD,2024,63
HITACHI LTD,1982,63
SEIKO EPSON CORP,2007,63
FUJITSU LTD,1991,63
PANASONIC CORP,2010,63
SONY CORP,2009,62
CANON KK,2005,62
NEC CORP,2000,62
FUJITSU LTD,1989,62
STATE GRID CORP CHINA,2021,62
MATSUSHITA ELECTRIC IND CO LTD,2000,62
TAIWAN SEMICONDUCTOR MFG CO LTD,2021,61
TOSHIBA CORP,1991,61
TOYOTA MOTOR CORP,2009,61
QUALCOMM INC,2023,61
TOYOTA MOTOR CORP,2008,61
SONY CORP,2000,60
SONY CORP,2012,60
BOE TECHNOLOGY GROUP CO LTD,2018,60
CANON KK,1996,60
Query:
SELECT t."country_code", COUNT(*) AS "application_count"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t
WHERE t."country_code" IS NOT NULL
GROUP BY t."country_code"
ORDER BY "application_count" DESC
LIMIT 100
Answer:
country_code,application_count
CN,208729
JP,110525
US,57953
KR,28416
CA,13358
DE,12656
AU,9744
WO,9409
EP,8335
GB,5551
AT,4482
BR,4469
TW,4270
IT,3866
CH,3513
FR,3326
RU,2979
SU,2526
BE,2457
ES,2080
SE,1473
NL,1274
ZA,1261
PL,1187
IL,1185
HU,969
NO,890
MX,863
DD,722
AR,666
DK,575
CS,528
UA,479
FI,467
HK,440
CZ,414
IE,372
PT,372
SG,284
NZ,276
CL,267
BG,265
YU,228
IN,222
TR,222
GR,207
MY,195
RO,172
HR,167
LU,139
CO,118
SI,117
PH,116
EA,108
SK,99
CY,81
PE,77
AP,65
MA,54
LT,50
ID,43
CR,41
RS,38
MD,30
OA,29
IS,28
JO,26
CU,23
GE,23
LV,23
SA,20
EG,18
TN,15
GT,15
EC,14
SM,11
ZM,10
EE,7
NI,7
DO,6
PA,5
KE,5
ME,5
HN,5
MC,4
MW,4
SV,3
ZW,2
MN,1
MT,1
KZ,1
BA,1
DZ,1
Query:
SELECT f_assignee.value:"name"::STRING AS "assignee_name",
       COUNT(*) AS "total_applications"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee,
     LATERAL FLATTEN(input => t."cpc") f_cpc
WHERE f_cpc.value:"code"::STRING LIKE 'A01B3%'
  AND f_assignee.value:"name"::STRING IS NOT NULL
GROUP BY f_assignee.value:"name"::STRING
ORDER BY "total_applications" DESC
LIMIT 100;
Answer:
assignee_name,total_applications
LELY NV C VAN DER,13
TEXAS INDUSTRIES INC,6
DEERE & CO,6
CARLUCCI JAMES J,4
TWOSE OF TIVERTON LTD,4
WALTER ROWAN JAMES,4
MCKAY RALPH LTD,4
OTULAK PRZEMYSLAW PRO CNC,4
PATENT CONCERN NV,3
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,3
MARTIN CHARLES H,3
UNIV HEILONGJIANG SCI & TECH,3
LEINFELDER DIPL-LANDW HERMANN,3
UNIV JIANGSU,3
AMAZONEN-WERKE H DREYER GMBH & CO KG,3
CNH IND AMERICA LLC,3
PREC PLANTING LLC,3
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,3
MARTIN DOMINIC R,3
BETEK GMBH & CO KG,3
ARWAC LTD,3
BOTVID SETTERGREN ANDERS GOSTA,2
RICHARD CO,2
KUHN SA,2
QUINSTAR CORP,2
CHRISTOPHER H R WOODWARD,2
SHEPPARD RICHARD H,2
GLASIER HAROLD H,2
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,2
FISHER VAN E,2
AMAZONEN WERKE DREYER H,2
RUDOLPH HASSON PAUL,2
JIM ALEX SMITH,2
AUGUST SETTERGREN OTTO GORAN,2
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,2
KIM BYUNG SUB,2
ZHANG LIJIN,2
UNIV SYDNEY,2
KORSMEYER ERNEST H,2
WILLIAM DREFKE,2
CAMPBELL CLARENCE L,2
SIGFRID ANDERSON ANDERS,2
HARRELL DANNY H,2
CHOATE STOREY NORMAN,2
EDMOND HEE,2
EDWARDS JOHN W,2
WILLIAM HENRY HONY FROST,2
HUBEI SHUANGYU MACHINERY TECH CO LTD,2
UNIV TONGJI,2
WANG XUEDONG,2
LEIJENAAR SYTZE,2
SAMSUNG SDI CO LTD,2
Liu Yueshang,2
AGSOILWORKS TECH COMPANY LLC,2
SAPHIR MASCHB GMBH,2
CHONGQING TIANJI IND CO LTD,2
DAEHO FARMING MACHINERY CO LTD,1
GEORGE A KELLY PLOW COMPANY,1
GERBER MAURICE,1
HUBER FRANZ FERDINAND,1
GUERBET FRANCOIS,1
EMPR IMPORT EXPORT Y DISTRIB P,1
UNIV CHUNG ANG IND,1
NIEMEYER SOEHNE STAHL PFLUG,1
CHO SUNG GU,1
TRECKER FRANCIS J,1
KUBOTA KK,1
SALGE HENRY F,1
ALLEN SAMUEL L,1
KIM JAE KEUN,1
SOUTHERN PLOW COMPANY,1
CHRISTEN ARNE JENSEN,1
GERBER HUBERT,1
LG ELECTRONICS INC,1
NEW ZEALAND INVENTIONS DEV,1
BULLS CO LTD,1
INT HARVESTER GREAT BRITAIN,1
ARTHUR BROOKS SPURR,1
ELEOS ROBOTICS INC,1
LIM HEON HO,1
KIM JONG JIN,1
HOLGER LETH,1
WALLNER KLAUS,1
SJOEHOLMS MEKANISKA AB,1
SAMSUNG KWANGJU ELECTRONICS CO,1
DAIYO TANGO CO LTD,1
LEMKEN GMBH & CO KG,1
Query:
SELECT f_assignee.value:"name"::STRING AS "assignee_name",
       EXTRACT(year FROM TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD')) AS "year",
       COUNT(*) AS "applications"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee,
     LATERAL FLATTEN(input => t."cpc") f_cpc
WHERE f_cpc.value:"code"::STRING LIKE 'A01B3%'
  AND TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD') IS NOT NULL
GROUP BY f_assignee.value:"name"::STRING, "year"
ORDER BY f_assignee.value:"name"::STRING, "applications" DESC
LIMIT 100
Answer:
assignee_name,year,applications
AGSOILWORKS TECH COMPANY LLC,2019,2
ALLEN SAMUEL L,1906,1
AMAZONEN WERKE DREYER H,1980,1
AMAZONEN WERKE DREYER H,1982,1
AMAZONEN-WERKE H DREYER GMBH & CO KG,2017,3
ARTHUR BROOKS SPURR,1953,1
ARWAC LTD,2022,3
AUGUST SETTERGREN OTTO GORAN,1951,2
BETEK GMBH & CO KG,2017,3
BOTVID SETTERGREN ANDERS GOSTA,1951,2
BULLS CO LTD,2012,1
CAMPBELL CLARENCE L,1936,2
CARLUCCI JAMES J,1976,4
CHO SUNG GU,1999,1
CHOATE STOREY NORMAN,1936,2
CHONGQING TIANJI IND CO LTD,2016,2
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,2017,2
CHRISTEN ARNE JENSEN,1928,1
CHRISTOPHER H R WOODWARD,1923,2
CNH IND AMERICA LLC,2024,3
DAEHO FARMING MACHINERY CO LTD,2000,1
DAIYO TANGO CO LTD,1990,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,2019,2
DEERE & CO,2020,2
DEERE & CO,2007,2
DEERE & CO,2018,1
DEERE & CO,1980,1
EDMOND HEE,1920,2
EDWARDS JOHN W,2005,2
ELEOS ROBOTICS INC,2019,1
EMPR IMPORT EXPORT Y DISTRIB P,1991,1
FISHER VAN E,1925,2
GEORGE A KELLY PLOW COMPANY,1902,1
GERBER HUBERT,2010,1
GERBER MAURICE,2010,1
GLASIER HAROLD H,1932,2
GUERBET FRANCOIS,1976,1
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,2022,3
HARRELL DANNY H,1993,2
HOLGER LETH,1928,1
HUBEI SHUANGYU MACHINERY TECH CO LTD,2018,2
HUBER FRANZ FERDINAND,2018,1
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,2023,3
INT HARVESTER GREAT BRITAIN,1958,1
JIM ALEX SMITH,1958,2
KIM BYUNG SUB,1999,2
KIM JAE KEUN,2002,1
KIM JONG JIN,2002,1
KORSMEYER ERNEST H,1922,2
KUBOTA KK,2001,1
KUHN SA,2017,2
LEIJENAAR SYTZE,1995,2
LEINFELDER DIPL-LANDW HERMANN,1967,3
LELY NV C VAN DER,1987,6
LELY NV C VAN DER,1988,2
LELY NV C VAN DER,1986,2
LELY NV C VAN DER,1985,2
LELY NV C VAN DER,1984,1
LEMKEN GMBH & CO KG,2014,1
LG ELECTRONICS INC,2019,1
LIM HEON HO,2016,1
Liu Yueshang,2022,2
MARTIN CHARLES H,2019,3
MARTIN DOMINIC R,2019,3
MCKAY RALPH LTD,1982,4
NEW ZEALAND INVENTIONS DEV,1976,1
NIEMEYER SOEHNE STAHL PFLUG,1952,1
OTULAK PRZEMYSLAW PRO CNC,2023,4
PATENT CONCERN NV,1979,3
PREC PLANTING LLC,2018,3
QUINSTAR CORP,1997,2
RICHARD CO,1964,2
RUDOLPH HASSON PAUL,1936,2
SALGE HENRY F,1914,1
SAMSUNG KWANGJU ELECTRONICS CO,2008,1
SAMSUNG SDI CO LTD,2007,2
SAPHIR MASCHB GMBH,2023,2
SHEPPARD RICHARD H,1957,2
SIGFRID ANDERSON ANDERS,1962,2
SJOEHOLMS MEKANISKA AB,1986,1
SOUTHERN PLOW COMPANY,1913,1
TEXAS INDUSTRIES INC,1982,6
TRECKER FRANCIS J,1959,1
TWOSE OF TIVERTON LTD,1984,4
UNIV CHUNG ANG IND,2013,1
UNIV HEILONGJIANG SCI & TECH,2018,3
UNIV JIANGSU,2021,3
UNIV SYDNEY,2018,2
UNIV TONGJI,2018,2
WALLNER KLAUS,2020,1
WALTER ROWAN JAMES,1952,4
WANG XUEDONG,2022,2
WILLIAM DREFKE,1927,2
WILLIAM HENRY HONY FROST,1935,2
ZHANG LIJIN,2021,2
Query:
SELECT final."assignee_name", final."year", t."country_code", COUNT(*) AS "applications"
FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
     LATERAL FLATTEN(input => t."assignee_harmonized") f_assignee,
     LATERAL FLATTEN(input => t."cpc") f_cpc,
     (
       SELECT f_assignee_sub.value:"name"::STRING AS "assignee_name",
              EXTRACT(year FROM TRY_TO_DATE(t_sub."publication_date"::STRING, 'YYYYMMDD')) AS "year",
              COUNT(*) AS "applications"
       FROM "PATENTS"."PATENTS"."PUBLICATIONS" t_sub,
            LATERAL FLATTEN(input => t_sub."assignee_harmonized") f_assignee_sub,
            LATERAL FLATTEN(input => t_sub."cpc") f_cpc_sub
       WHERE f_cpc_sub.value:"code"::STRING LIKE 'A01B3%'
         AND TRY_TO_DATE(t_sub."publication_date"::STRING, 'YYYYMMDD') IS NOT NULL
       GROUP BY f_assignee_sub.value:"name"::STRING, "year"
       QUALIFY ROW_NUMBER() OVER (PARTITION BY f_assignee_sub.value:"name"::STRING ORDER BY COUNT(*) DESC) = 1
     ) final
WHERE f_assignee.value:"name"::STRING = final."assignee_name"
  AND EXTRACT(year FROM TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD')) = final."year"
  AND f_cpc.value:"code"::STRING LIKE 'A01B3%'
  AND TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD') IS NOT NULL
GROUP BY final."assignee_name", final."year", t."country_code"
ORDER BY final."assignee_name", "applications" DESC
LIMIT 100
Answer:
assignee_name,year,country_code,applications
AGSOILWORKS TECH COMPANY LLC,2019,IL,2
ALLEN SAMUEL L,1906,US,1
AMAZONEN WERKE DREYER H,1980,AT,1
AMAZONEN-WERKE H DREYER GMBH & CO KG,2017,CN,3
ARTHUR BROOKS SPURR,1953,GB,1
ARWAC LTD,2022,GB,3
AUGUST SETTERGREN OTTO GORAN,1951,US,2
BETEK GMBH & CO KG,2017,CN,3
BOTVID SETTERGREN ANDERS GOSTA,1951,US,2
BULLS CO LTD,2012,KR,1
CAMPBELL CLARENCE L,1936,US,2
CARLUCCI JAMES J,1976,US,4
CHO SUNG GU,1999,KR,1
CHOATE STOREY NORMAN,1936,US,2
CHONGQING TIANJI IND CO LTD,2016,CN,2
CHONGQING YUBAO AGRICULTURE EXPL CO LTD,2017,CN,2
CHRISTEN ARNE JENSEN,1928,DE,1
CHRISTOPHER H R WOODWARD,1923,US,2
CNH IND AMERICA LLC,2024,US,3
DAEHO FARMING MACHINERY CO LTD,2000,KR,1
DAIYO TANGO CO LTD,1990,KR,1
DALIAN TIANZU ECOLOGICAL AGRICULTURE TECH DEVELOPMENT CO LTD,2019,CN,2
DEERE & CO,2007,AU,2
EDMOND HEE,1920,FR,2
EDWARDS JOHN W,2005,CA,2
ELEOS ROBOTICS INC,2019,CA,1
EMPR IMPORT EXPORT Y DISTRIB P,1991,NO,1
FISHER VAN E,1925,US,2
GEORGE A KELLY PLOW COMPANY,1902,US,1
GERBER HUBERT,2010,FR,1
GERBER MAURICE,2010,FR,1
GLASIER HAROLD H,1932,US,2
GUERBET FRANCOIS,1976,CA,1
GUIZHOU SPACEFLIGHT SMART AGRICULTURE LTD COMPANY,2022,CN,3
HARRELL DANNY H,1993,US,2
HOLGER LETH,1928,DE,1
HUBEI SHUANGYU MACHINERY TECH CO LTD,2018,CN,2
HUBER FRANZ FERDINAND,2018,DE,1
HUNAN BIOLOGICAL & ELECTROMECHANICAL POLYTECHNIC,2023,CN,3
INT HARVESTER GREAT BRITAIN,1958,GB,1
JIM ALEX SMITH,1958,US,2
KIM BYUNG SUB,1999,KR,2
KIM JAE KEUN,2002,KR,1
KIM JONG JIN,2002,KR,1
KORSMEYER ERNEST H,1922,US,2
KUBOTA KK,2001,KR,1
KUHN SA,2017,CA,2
LEIJENAAR SYTZE,1995,BE,2
LEINFELDER DIPL-LANDW HERMANN,1967,DE,3
LELY NV C VAN DER,1987,IT,6
LEMKEN GMBH & CO KG,2014,DE,1
LG ELECTRONICS INC,2019,US,1
LIM HEON HO,2016,KR,1
Liu Yueshang,2022,CN,2
MARTIN CHARLES H,2019,US,3
MARTIN DOMINIC R,2019,US,3
MCKAY RALPH LTD,1982,ZA,4
NEW ZEALAND INVENTIONS DEV,1976,AU,1
NIEMEYER SOEHNE STAHL PFLUG,1952,DE,1
OTULAK PRZEMYSLAW PRO CNC,2023,PL,4
PATENT CONCERN NV,1979,BE,3
PREC PLANTING LLC,2018,CN,3
QUINSTAR CORP,1997,US,2
RICHARD CO,1964,US,2
RUDOLPH HASSON PAUL,1936,US,2
SALGE HENRY F,1914,US,1
SAMSUNG KWANGJU ELECTRONICS CO,2008,CN,1
SAMSUNG SDI CO LTD,2007,KR,2
SAPHIR MASCHB GMBH,2023,EP,2
SHEPPARD RICHARD H,1957,US,2
SIGFRID ANDERSON ANDERS,1962,US,2
SJOEHOLMS MEKANISKA AB,1986,NO,1
SOUTHERN PLOW COMPANY,1913,US,1
TEXAS INDUSTRIES INC,1982,FR,6
TRECKER FRANCIS J,1959,US,1
TWOSE OF TIVERTON LTD,1984,GB,4
UNIV CHUNG ANG IND,2013,KR,1
UNIV HEILONGJIANG SCI & TECH,2018,CN,3
UNIV JIANGSU,2021,CN,3
UNIV SYDNEY,2018,AU,2
UNIV TONGJI,2018,CN,2
WALLNER KLAUS,2020,HU,1
WALTER ROWAN JAMES,1952,US,4
WANG XUEDONG,2022,CN,2
WILLIAM DREFKE,1927,US,2
WILLIAM HENRY HONY FROST,1935,GB,2
ZHANG LIJIN,2021,CN,2
End Exploring Related Columns
Task: For patent class A01B3, I want to analyze the information of the top 3 assignees based on the total number of applications. Please provide the following five pieces of information: the name of this assignee,  total number of applications, the year with the most applications, the number of applications in that year, and the country code with the most applications during that year.

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Assignee_Name,Total_Number_of_Applications,Year_With_Most_Applications,Number_of_Applications_in_that_Year,Country_Code_With_Most_Applications_During_That_Year
assignee1:str,total_applications1:int,year1:int,num_applications_year1:int,country_code1:str
assignee2:str,total_applications2:int,year2:int,num_applications_year2:int,country_code2:str
assignee3:str,total_applications3:int,year3:int,num_applications_year3:int,country_code3:str
```
(Attention: answer in three rows)

We analyzed the patent applications in class A01B3 and identified the top 3 assignees based on the total number of applications. For each assignee, we determined the year with the highest number of applications, the number of applications in that year, and the country code with the most applications during that year..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'PATENTS': {'PATENTS': ['CPC_DEFINITION', 'DISCLOSURES_13', 'PUBLICATIONS']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-22 21:29:58 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:29:58 - root - INFO - ```sql
WITH cte_applications AS (
    SELECT f_assignee.value:"name"::STRING AS "Assignee_Name",
           EXTRACT(YEAR FROM TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD')) AS "Year",
           t."country_code" AS "Country_Code"
    FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
         LATERAL FLATTEN(INPUT => t."cpc") f_cpc,
         LATERAL FLATTEN(INPUT => t."assignee_harmonized") f_assignee
    WHERE f_cpc.value:"code"::STRING LIKE 'A01B3%'
      AND TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD') IS NOT NULL
),

cte_total_applications AS (
    SELECT "Assignee_Name",
           COUNT(*) AS "Total_Number_of_Applications"
    FROM cte_applications
    GROUP BY "Assignee_Name"
),

cte_top_assignees AS (
    SELECT "Assignee_Name",
           "Total_Number_of_Applications"
    FROM cte_total_applications
    ORDER BY "Total_Number_of_Applications" DESC
    LIMIT 3
),

cte_assignee_year_counts AS (
    SELECT "Assignee_Name",
           "Year",
           COUNT(*) AS "Number_of_Applications_in_that_Year"
    FROM cte_applications
    WHERE "Assignee_Name" IN (SELECT "Assignee_Name" FROM cte_top_assignees)
    GROUP BY "Assignee_Name", "Year"
),

cte_top_year_per_assignee AS (
    SELECT * FROM (
        SELECT "Assignee_Name",
               "Year" AS "Year_With_Most_Applications",
               "Number_of_Applications_in_that_Year",
               ROW_NUMBER() OVER (PARTITION BY "Assignee_Name" ORDER BY "Number_of_Applications_in_that_Year" DESC) AS rn
        FROM cte_assignee_year_counts
    )
    WHERE rn = 1
),

cte_assignee_year_country_counts AS (
    SELECT "Assignee_Name",
           "Year",
           "Country_Code",
           COUNT(*) AS "Applications_in_Country"
    FROM cte_applications
    WHERE "Assignee_Name" IN (SELECT "Assignee_Name" FROM cte_top_assignees)
      AND "Year" IN (SELECT "Year_With_Most_Applications" FROM cte_top_year_per_assignee)
    GROUP BY "Assignee_Name", "Year", "Country_Code"
),

cte_top_country_per_assignee_year AS (
    SELECT * FROM (
        SELECT "Assignee_Name",
               "Year",
               "Country_Code" AS "Country_Code_With_Most_Applications_During_That_Year",
               ROW_NUMBER() OVER (PARTITION BY "Assignee_Name", "Year" ORDER BY "Applications_in_Country" DESC) AS rn
        FROM cte_assignee_year_country_counts
    )
    WHERE rn = 1
)

SELECT
    ta."Assignee_Name",
    ta."Total_Number_of_Applications",
    ty."Year_With_Most_Applications",
    ty."Number_of_Applications_in_that_Year",
    tc."Country_Code_With_Most_Applications_During_That_Year"
FROM cte_top_assignees ta
JOIN cte_top_year_per_assignee ty ON ta."Assignee_Name" = ty."Assignee_Name"
JOIN cte_top_country_per_assignee_year tc ON ta."Assignee_Name" = tc."Assignee_Name" AND ty."Year_With_Most_Applications" = tc."Year"
ORDER BY ta."Total_Number_of_Applications" DESC;
```
2025-01-22 21:29:58 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:29:58 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:29:58 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:30:00 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-22 21:30:00 - snowflake.connector.connection - INFO - closed
2025-01-22 21:30:00 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:30:01 - root - INFO - itercount: 1
2025-01-22 21:30:01 - root - INFO - 0
2025-01-22 21:30:01 - root - INFO - results: 
Assignee_Name,Total_Number_of_Applications,Year_With_Most_Applications,Number_of_Applications_in_that_Year,Country_Code_With_Most_Applications_During_That_Year
LELY NV C VAN DER,13,1987,6,IT
DEERE & CO,6,2007,2,AU
TEXAS INDUSTRIES INC,6,1982,6,FR


2025-01-22 21:30:01 - root - INFO - Please check the answer again by reviewing For patent class A01B3, I want to analyze the information of the top 3 assignees based on the total number of applications. Please provide the following five pieces of information: the name of this assignee,  total number of applications, the year with the most applications, the number of applications in that year, and the country code with the most applications during that year., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Assignee_Name,Total_Number_of_Applications,Year_With_Most_Applications,Number_of_Applications_in_that_Year,Country_Code_With_Most_Applications_During_That_Year
assignee1:str,total_applications1:int,year1:int,num_applications_year1:int,country_code1:str
assignee2:str,total_applications2:int,year2:int,num_applications_year2:int,country_code2:str
assignee3:str,total_applications3:int,year3:int,num_applications_year3:int,country_code3:str
```
(Attention: answer in three rows)

We analyzed the patent applications in class A01B3 and identified the top 3 assignees based on the total number of applications. For each assignee, we determined the year with the highest number of applications, the number of applications in that year, and the country code with the most applications during that year. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Assignee_Name,Total_Number_of_Applications,Year_With_Most_Applications,Number_of_Applications_in_that_Year,Country_Code_With_Most_Applications_During_That_Year
LELY NV C VAN DER,13,1987,6,IT
DEERE & CO,6,2007,2,AU
TEXAS INDUSTRIES INC,6,1982,6,FR
Current sql:
WITH cte_applications AS (
    SELECT f_assignee.value:"name"::STRING AS "Assignee_Name",
           EXTRACT(YEAR FROM TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD')) AS "Year",
           t."country_code" AS "Country_Code"
    FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
         LATERAL FLATTEN(INPUT => t."cpc") f_cpc,
         LATERAL FLATTEN(INPUT => t."assignee_harmonized") f_assignee
    WHERE f_cpc.value:"code"::STRING LIKE 'A01B3%'
      AND TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD') IS NOT NULL
),

cte_total_applications AS (
    SELECT "Assignee_Name",
           COUNT(*) AS "Total_Number_of_Applications"
    FROM cte_applications
    GROUP BY "Assignee_Name"
),

cte_top_assignees AS (
    SELECT "Assignee_Name",
           "Total_Number_of_Applications"
    FROM cte_total_applications
    ORDER BY "Total_Number_of_Applications" DESC
    LIMIT 3
),

cte_assignee_year_counts AS (
    SELECT "Assignee_Name",
           "Year",
           COUNT(*) AS "Number_of_Applications_in_that_Year"
    FROM cte_applications
    WHERE "Assignee_Name" IN (SELECT "Assignee_Name" FROM cte_top_assignees)
    GROUP BY "Assignee_Name", "Year"
),

cte_top_year_per_assignee AS (
    SELECT * FROM (
        SELECT "Assignee_Name",
               "Year" AS "Year_With_Most_Applications",
               "Number_of_Applications_in_that_Year",
               ROW_NUMBER() OVER (PARTITION BY "Assignee_Name" ORDER BY "Number_of_Applications_in_that_Year" DESC) AS rn
        FROM cte_assignee_year_counts
    )
    WHERE rn = 1
),

cte_assignee_year_country_counts AS (
    SELECT "Assignee_Name",
           "Year",
           "Country_Code",
           COUNT(*) AS "Applications_in_Country"
    FROM cte_applications
    WHERE "Assignee_Name" IN (SELECT "Assignee_Name" FROM cte_top_assignees)
      AND "Year" IN (SELECT "Year_With_Most_Applications" FROM cte_top_year_per_assignee)
    GROUP BY "Assignee_Name", "Year", "Country_Code"
),

cte_top_country_per_assignee_year AS (
    SELECT * FROM (
        SELECT "Assignee_Name",
               "Year",
               "Country_Code" AS "Country_Code_With_Most_Applications_During_That_Year",
               ROW_NUMBER() OVER (PARTITION BY "Assignee_Name", "Year" ORDER BY "Applications_in_Country" DESC) AS rn
        FROM cte_assignee_year_country_counts
    )
    WHERE rn = 1
)

SELECT
    ta."Assignee_Name",
    ta."Total_Number_of_Applications",
    ty."Year_With_Most_Applications",
    ty."Number_of_Applications_in_that_Year",
    tc."Country_Code_With_Most_Applications_During_That_Year"
FROM cte_top_assignees ta
JOIN cte_top_year_per_assignee ty ON ta."Assignee_Name" = ty."Assignee_Name"
JOIN cte_top_country_per_assignee_year tc ON ta."Assignee_Name" = tc."Assignee_Name" AND ty."Year_With_Most_Applications" = tc."Year"
ORDER BY ta."Total_Number_of_Applications" DESC;When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.

2025-01-22 21:30:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:30:29 - root - INFO - ```sql
WITH cte_applications AS (
    SELECT f_assignee.value:"name"::STRING AS "Assignee_Name",
           EXTRACT(YEAR FROM TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD')) AS "Year",
           t."country_code" AS "Country_Code"
    FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
         LATERAL FLATTEN(INPUT => t."cpc") f_cpc,
         LATERAL FLATTEN(INPUT => t."assignee_harmonized") f_assignee
    WHERE f_cpc.value:"code"::STRING LIKE 'A01B3%'
      AND TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD') IS NOT NULL
),

cte_total_applications AS (
    SELECT "Assignee_Name",
           COUNT(*) AS "Total_Number_of_Applications"
    FROM cte_applications
    GROUP BY "Assignee_Name"
),

cte_top_assignees AS (
    SELECT "Assignee_Name",
           "Total_Number_of_Applications"
    FROM cte_total_applications
    ORDER BY "Total_Number_of_Applications" DESC NULLS LAST
    LIMIT 3
),

cte_assignee_year_counts AS (
    SELECT "Assignee_Name",
           "Year",
           COUNT(*) AS "Number_of_Applications_in_that_Year"
    FROM cte_applications
    WHERE "Assignee_Name" IN (SELECT "Assignee_Name" FROM cte_top_assignees)
    GROUP BY "Assignee_Name", "Year"
),

cte_top_year_per_assignee AS (
    SELECT * FROM (
        SELECT "Assignee_Name",
               "Year" AS "Year_With_Most_Applications",
               "Number_of_Applications_in_that_Year",
               ROW_NUMBER() OVER (PARTITION BY "Assignee_Name" ORDER BY "Number_of_Applications_in_that_Year" DESC NULLS LAST) AS rn
        FROM cte_assignee_year_counts
    )
    WHERE rn = 1
),

cte_assignee_year_country_counts AS (
    SELECT "Assignee_Name",
           "Year",
           "Country_Code",
           COUNT(*) AS "Applications_in_Country"
    FROM cte_applications
    WHERE "Assignee_Name" IN (SELECT "Assignee_Name" FROM cte_top_assignees)
      AND "Year" IN (SELECT "Year_With_Most_Applications" FROM cte_top_year_per_assignee)
    GROUP BY "Assignee_Name", "Year", "Country_Code"
),

cte_top_country_per_assignee_year AS (
    SELECT * FROM (
        SELECT "Assignee_Name",
               "Year",
               "Country_Code" AS "Country_Code_With_Most_Applications_During_That_Year",
               ROW_NUMBER() OVER (PARTITION BY "Assignee_Name", "Year" ORDER BY "Applications_in_Country" DESC NULLS LAST) AS rn
        FROM cte_assignee_year_country_counts
    )
    WHERE rn = 1
)

SELECT
    ta."Assignee_Name",
    ta."Total_Number_of_Applications",
    ty."Year_With_Most_Applications",
    ty."Number_of_Applications_in_that_Year",
    tc."Country_Code_With_Most_Applications_During_That_Year"
FROM cte_top_assignees ta
JOIN cte_top_year_per_assignee ty ON ta."Assignee_Name" = ty."Assignee_Name"
JOIN cte_top_country_per_assignee_year tc ON ta."Assignee_Name" = tc."Assignee_Name" AND ty."Year_With_Most_Applications" = tc."Year"
ORDER BY ta."Total_Number_of_Applications" DESC NULLS LAST;
```
2025-01-22 21:30:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:30:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:30:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:30:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-22 21:30:31 - snowflake.connector.connection - INFO - closed
2025-01-22 21:30:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:30:31 - root - INFO - itercount: 2
2025-01-22 21:30:31 - root - INFO - 0
2025-01-22 21:30:31 - root - INFO - results: 
Assignee_Name,Total_Number_of_Applications,Year_With_Most_Applications,Number_of_Applications_in_that_Year,Country_Code_With_Most_Applications_During_That_Year
LELY NV C VAN DER,13,1987,6,IT
TEXAS INDUSTRIES INC,6,1982,6,FR
DEERE & CO,6,2007,2,AU


2025-01-22 21:30:31 - root - INFO - Please check the answer again by reviewing For patent class A01B3, I want to analyze the information of the top 3 assignees based on the total number of applications. Please provide the following five pieces of information: the name of this assignee,  total number of applications, the year with the most applications, the number of applications in that year, and the country code with the most applications during that year., reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Assignee_Name,Total_Number_of_Applications,Year_With_Most_Applications,Number_of_Applications_in_that_Year,Country_Code_With_Most_Applications_During_That_Year
assignee1:str,total_applications1:int,year1:int,num_applications_year1:int,country_code1:str
assignee2:str,total_applications2:int,year2:int,num_applications_year2:int,country_code2:str
assignee3:str,total_applications3:int,year3:int,num_applications_year3:int,country_code3:str
```
(Attention: answer in three rows)

We analyzed the patent applications in class A01B3 and identified the top 3 assignees based on the total number of applications. For each assignee, we determined the year with the highest number of applications, the number of applications in that year, and the country code with the most applications during that year. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Assignee_Name,Total_Number_of_Applications,Year_With_Most_Applications,Number_of_Applications_in_that_Year,Country_Code_With_Most_Applications_During_That_Year
LELY NV C VAN DER,13,1987,6,IT
TEXAS INDUSTRIES INC,6,1982,6,FR
DEERE & CO,6,2007,2,AU
Current sql:
WITH cte_applications AS (
    SELECT f_assignee.value:"name"::STRING AS "Assignee_Name",
           EXTRACT(YEAR FROM TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD')) AS "Year",
           t."country_code" AS "Country_Code"
    FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
         LATERAL FLATTEN(INPUT => t."cpc") f_cpc,
         LATERAL FLATTEN(INPUT => t."assignee_harmonized") f_assignee
    WHERE f_cpc.value:"code"::STRING LIKE 'A01B3%'
      AND TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD') IS NOT NULL
),

cte_total_applications AS (
    SELECT "Assignee_Name",
           COUNT(*) AS "Total_Number_of_Applications"
    FROM cte_applications
    GROUP BY "Assignee_Name"
),

cte_top_assignees AS (
    SELECT "Assignee_Name",
           "Total_Number_of_Applications"
    FROM cte_total_applications
    ORDER BY "Total_Number_of_Applications" DESC NULLS LAST
    LIMIT 3
),

cte_assignee_year_counts AS (
    SELECT "Assignee_Name",
           "Year",
           COUNT(*) AS "Number_of_Applications_in_that_Year"
    FROM cte_applications
    WHERE "Assignee_Name" IN (SELECT "Assignee_Name" FROM cte_top_assignees)
    GROUP BY "Assignee_Name", "Year"
),

cte_top_year_per_assignee AS (
    SELECT * FROM (
        SELECT "Assignee_Name",
               "Year" AS "Year_With_Most_Applications",
               "Number_of_Applications_in_that_Year",
               ROW_NUMBER() OVER (PARTITION BY "Assignee_Name" ORDER BY "Number_of_Applications_in_that_Year" DESC NULLS LAST) AS rn
        FROM cte_assignee_year_counts
    )
    WHERE rn = 1
),

cte_assignee_year_country_counts AS (
    SELECT "Assignee_Name",
           "Year",
           "Country_Code",
           COUNT(*) AS "Applications_in_Country"
    FROM cte_applications
    WHERE "Assignee_Name" IN (SELECT "Assignee_Name" FROM cte_top_assignees)
      AND "Year" IN (SELECT "Year_With_Most_Applications" FROM cte_top_year_per_assignee)
    GROUP BY "Assignee_Name", "Year", "Country_Code"
),

cte_top_country_per_assignee_year AS (
    SELECT * FROM (
        SELECT "Assignee_Name",
               "Year",
               "Country_Code" AS "Country_Code_With_Most_Applications_During_That_Year",
               ROW_NUMBER() OVER (PARTITION BY "Assignee_Name", "Year" ORDER BY "Applications_in_Country" DESC NULLS LAST) AS rn
        FROM cte_assignee_year_country_counts
    )
    WHERE rn = 1
)

SELECT
    ta."Assignee_Name",
    ta."Total_Number_of_Applications",
    ty."Year_With_Most_Applications",
    ty."Number_of_Applications_in_that_Year",
    tc."Country_Code_With_Most_Applications_During_That_Year"
FROM cte_top_assignees ta
JOIN cte_top_year_per_assignee ty ON ta."Assignee_Name" = ty."Assignee_Name"
JOIN cte_top_country_per_assignee_year tc ON ta."Assignee_Name" = tc."Assignee_Name" AND ty."Year_With_Most_Applications" = tc."Year"
ORDER BY ta."Total_Number_of_Applications" DESC NULLS LAST;
2025-01-22 21:31:16 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:31:16 - root - INFO - ```sql
WITH cte_applications AS (
    SELECT f_assignee.value:"name"::STRING AS "Assignee_Name",
           EXTRACT(YEAR FROM TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD')) AS "Year",
           t."country_code" AS "Country_Code"
    FROM "PATENTS"."PATENTS"."PUBLICATIONS" t,
         LATERAL FLATTEN(INPUT => t."cpc") f_cpc,
         LATERAL FLATTEN(INPUT => t."assignee_harmonized") f_assignee
    WHERE f_cpc.value:"code"::STRING LIKE 'A01B3%'
      AND TRY_TO_DATE(t."publication_date"::STRING, 'YYYYMMDD') IS NOT NULL
),

cte_total_applications AS (
    SELECT "Assignee_Name",
           COUNT(*) AS "Total_Number_of_Applications"
    FROM cte_applications
    GROUP BY "Assignee_Name"
),

cte_top_assignees AS (
    SELECT "Assignee_Name",
           "Total_Number_of_Applications"
    FROM cte_total_applications
    ORDER BY "Total_Number_of_Applications" DESC NULLS LAST
    LIMIT 3
),

cte_assignee_year_counts AS (
    SELECT "Assignee_Name",
           "Year",
           COUNT(*) AS "Number_of_Applications_in_that_Year"
    FROM cte_applications
    WHERE "Assignee_Name" IN (SELECT "Assignee_Name" FROM cte_top_assignees)
    GROUP BY "Assignee_Name", "Year"
),

cte_top_year_per_assignee AS (
    SELECT * FROM (
        SELECT "Assignee_Name",
               "Year" AS "Year_With_Most_Applications",
               "Number_of_Applications_in_that_Year",
               ROW_NUMBER() OVER (PARTITION BY "Assignee_Name" ORDER BY "Number_of_Applications_in_that_Year" DESC NULLS LAST) AS rn
        FROM cte_assignee_year_counts
    )
    WHERE rn = 1
),

cte_assignee_year_country_counts AS (
    SELECT "Assignee_Name",
           "Year",
           "Country_Code",
           COUNT(*) AS "Applications_in_Country"
    FROM cte_applications
    WHERE "Assignee_Name" IN (SELECT "Assignee_Name" FROM cte_top_assignees)
      AND "Year" IN (SELECT "Year_With_Most_Applications" FROM cte_top_year_per_assignee)
    GROUP BY "Assignee_Name", "Year", "Country_Code"
),

cte_top_country_per_assignee_year AS (
    SELECT * FROM (
        SELECT "Assignee_Name",
               "Year",
               "Country_Code" AS "Country_Code_With_Most_Applications_During_That_Year",
               ROW_NUMBER() OVER (PARTITION BY "Assignee_Name", "Year" ORDER BY "Applications_in_Country" DESC NULLS LAST) AS rn
        FROM cte_assignee_year_country_counts
    )
    WHERE rn = 1
)

SELECT
    ta."Assignee_Name",
    ta."Total_Number_of_Applications",
    ty."Year_With_Most_Applications",
    ty."Number_of_Applications_in_that_Year",
    tc."Country_Code_With_Most_Applications_During_That_Year"
FROM cte_top_assignees ta
JOIN cte_top_year_per_assignee ty ON ta."Assignee_Name" = ty."Assignee_Name"
JOIN cte_top_country_per_assignee_year tc ON ta."Assignee_Name" = tc."Assignee_Name" AND ty."Year_With_Most_Applications" = tc."Year"
ORDER BY ta."Total_Number_of_Applications" DESC NULLS LAST;
```
2025-01-22 21:31:16 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:31:16 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:31:16 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:31:17 - snowflake.connector.cursor - INFO - Number of results in first chunk: 3
2025-01-22 21:31:17 - snowflake.connector.connection - INFO - closed
2025-01-22 21:31:18 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:31:18 - root - INFO - itercount: 3
2025-01-22 21:31:18 - root - INFO - 0
2025-01-22 21:31:18 - root - INFO - Total iteration counts: 3
