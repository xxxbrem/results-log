2025-01-22 21:10:36 - openai._base_client - INFO - Retrying request to /chat/completions in 0.440908 seconds
2025-01-22 21:12:37 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:12:37 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:12:37 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:12:37 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:12:39 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:12:39 - snowflake.connector.connection - INFO - closed
2025-01-22 21:12:39 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:12:39 - root - INFO - SQL:
SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
   LIMIT 100;
Results:
USER_PSEUDO_ID
1003046.9452926974
1023282.4639847710
1026043.4481623879
1026409.1551860912
1032138.1796039159
1037928.9294661675
1045950.7099606829
1051288.9523352374
1066655.6240997015
1080064.0071613184
1082746.7285674512
1097358.9593491100
1104313.9641823605
1112823.8475775772
1116587.1725520171
1127824.3503063268
1107198.5152483918
1134825.6533092350
1164648.0319944302
1168297.2853699605
1170405.4925804370
1178889.6850461952
1205590.2516186397
1218586.5350251990
1246063.3665874179
1259302.9069938124
1296701.2382814729
1269423.6724500672
1277765.6068129494
1308776.9803994658
1318624.9067804638
1320187.6719997668
1375005.2583322863
1382535.7283137323
1401649.9529464111
1422161.0871788362
1437260.5988606411
1448835.0934102497
1499810.5142637849
1543004.7243225422
1582390.8206269591
1674937.2501954408
1693134.9790437518
1707918.4797422153
1820733.6464417466
1912537.7440240268
1961265.4757052307
2019465.0056495205
2157133.5876722467
2329161.7120010083
2340587.9439563847
2411763.0850272555
2432374.8482039518
2501661.0331987453
2687473.9692412289
1677450.9117017807
2007867.8957787066
2304235.4728947355
2327547.5435328629
2417078.3361324500
1054372.6755770068
1064574.6224708641
1138692.0103796281
1160488.2375923167
1174066.6437027818
1188134.8498680538
1213932.4846099850
1215465.1474478000
1255322.2973246181
1211099.8247563235
1275797.1936238018
1326289.2331853598
1333091.0887566663
1352892.5937639189
1385112.5897617274
1396456.6482506733
1453555.6810069410
1453951.1387928223
1473136.1149103090
1501018.3808301483
1518831.1475327211
1539940.5253610440
1564015.6880680172
1616136.8949543878
1684301.4109152707
1713530.3382800695
1719564.6333875501
1734528.1974041204
1762263.6990880514
1784794.0627143380
1829763.3860332334
1884090.9722372635
1958116.3750166429
1967725.7354072666
1993768.0582544668
2077981.6202330137
2194957.7885097322
2228172.7936687802
2244553.9738621373
2247846.3358362547

2025-01-22 21:12:39 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:12:39 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:12:39 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:12:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:12:42 - snowflake.connector.connection - INFO - closed
2025-01-22 21:12:43 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:12:43 - root - INFO - SQL:
SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
   UNION
   SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
   UNION
   SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
   UNION
   SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
   UNION
   SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
   UNION
   SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
   UNION
   SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
   LIMIT 100;
Results:
USER_PSEUDO_ID
1003046.9452926974
1023282.4639847710
1026043.4481623879
1026409.1551860912
1032138.1796039159
1037928.9294661675
1045950.7099606829
1051288.9523352374
1066655.6240997015
1080064.0071613184
1082746.7285674512
1097358.9593491100
1104313.9641823605
1112823.8475775772
1127824.3503063268
1107198.5152483918
1168297.2853699605
1178889.6850461952
1205590.2516186397
1277765.6068129494
1308776.9803994658
1318624.9067804638
1320187.6719997668
1422161.0871788362
1437260.5988606411
1499810.5142637849
1582390.8206269591
1693134.9790437518
1707918.4797422153
1912537.7440240268
2157133.5876722467
2411763.0850272555
2501661.0331987453
2304235.4728947355
2754697.4847843626
1160488.2375923167
1174066.6437027818
1326289.2331853598
1473136.1149103090
1684301.4109152707
1884090.9722372635
1745171.2191701968
2091407.8804833129
1259302.9069938124
1543004.7243225422
1677450.9117017807
1213932.4846099850
1396456.6482506733
2077981.6202330137
2378480.6534474606
2492721.1881800375
2589245.5979068367
2560700.2802998477
3909413.6458295238
1759212.2216007988
2268837.3082004933
2344300.8375944627
3195953.1676635966
1352892.5937639189
3149868.5539413842
3158627.0434170250
3728034.7421262430
3896620.4310661501
7416334.3056558010
1134825.6533092350
1170405.4925804370
1218586.5350251990
1296701.2382814729
1375005.2583322863
2019465.0056495205
2916336.4829526738
1064574.6224708641
1539940.5253610440
2362829.7919429820
2275476.3701234224
2767600.1190297171
2795133.4288865632
2844832.0483599899
3067110.2430706696
3849458.8298476645
2167343.6164963557
2912682.3106786643
3443159.5753502239
4660834.1784425237
1116587.1725520171
1164648.0319944302
1401649.9529464111
1448835.0934102497
1674937.2501954408
1820733.6464417466
1961265.4757052307
2340587.9439563847
2687473.9692412289
2007867.8957787066
2327547.5435328629
4132154.7009329565
4233290.6269558513
1138692.0103796281
1255322.2973246181
1211099.8247563235

2025-01-22 21:12:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:12:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:12:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:12:45 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:12:45 - snowflake.connector.connection - INFO - closed
2025-01-22 21:12:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:12:45 - root - INFO - SQL:
SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
   LIMIT 100;
Results:
USER_PSEUDO_ID
1001303.4827739208
1014060.1100191558
1015239.8458513676
1023213.5350684501
1025773.0920505617
1033020.5841925327
1042140.6802444773
1045720.9269650087
1049106.9990499157
1049739.7909391395
1065322.6541302193
1072513.2161702512
1075240.7394043586
1075333.9269112947
1078788.8328338285
1081165.5314971225
1087271.0550084610
1095740.4839642689
1114964.3576383224
1118833.2974558782
1126378.6956818362
1069165.2811408476
1083792.6034832516
1086843.9052907013
1128261.6033595713
1128289.3662024583
1133313.1103337373
1144792.8191246270
1146837.4730107711
1151687.1996189042
1153093.0119048067
1163998.9977514528
1170673.0496256889
1173439.7311015929
1180762.6954492448
1214408.9886831537
1216128.7020381390
1243180.2889994882
1257670.9852008771
1218031.2772164166
1255130.2864074728
1278990.5126400811
1280885.4587684428
1304296.6040710271
1311409.7691253264
1324330.4963761152
1326729.2901375460
1328537.2795814770
1357835.0893556888
1369631.9406198523
1408865.7005954025
1442352.3658130118
1474912.2146834138
1524322.6852456903
1537642.0362746652
1390300.4796021112
1069494.0113686800
1084471.2677471598
1087808.3711873816
1115377.5526866793
1060274.1098179258
1086668.0925005810
1111626.7442894456
1130911.8567954377
1141870.4386338572
1148615.3691736909
1160488.2375923167
1169456.0744217795
1185502.9456478888
1185607.4529846208
1213730.2023854144
1214882.5762650867
1224512.5360000287
1230929.5891057900
1252675.9812778248
1253621.4143036992
1256871.5825332697
1270650.6052564575
1133962.3740970739
1177018.6074439798
1211099.8247563235
1285418.4651557245
1285421.1033375628
1295893.9741062295
1304912.9788917690
1306493.1469289903
1314525.6769250991
1324723.7882312578
1325005.1519738149
1358070.7682863119
1362293.0058255347
1366045.3922534826
1372261.7721304420
1374353.8427076075
1377886.1560338090
1380305.7377133735
1383476.9026182603
1388300.4678602079
1395824.1622992884
1418623.6541339375

2025-01-22 21:12:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:12:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:12:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:12:48 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:12:48 - snowflake.connector.connection - INFO - closed
2025-01-22 21:12:48 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:12:48 - root - INFO - SQL:
SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
   LIMIT 100;
Results:
USER_PSEUDO_ID
1000557.2911835023
1002616.3660015684
1008726.7423030385
1009541.6887464068
1009676.4905193951
1016428.1065641732
1020795.7432964012
1028144.2081628525
1030326.1353640844
1036021.1054561259
1043511.9901401232
1046404.1129546883
1073430.9059120582
1087808.3711873816
1099671.3398238118
1107549.5710254296
1109808.6106046131
1124540.2333393152
1019574.8776308935
1066407.3757892113
1072012.7284818935
1116865.4647068394
1132479.2425986879
1132946.8730897471
1122146.8997157148
1144754.6830399719
1149393.9441120966
1150418.5729329589
1151529.7874029554
1151687.1996189042
1168153.2069804316
1174920.8866835138
1177876.9777589683
1181141.8389731329
1194177.8166317724
1209023.5496836341
1224731.3666771048
1237924.3309856915
1246241.1259892311
1247293.4194247843
1272559.2391561764
1276927.7607362138
1366363.8080922440
1196040.9501767394
1256871.5825332697
1266942.9616912837
1275281.1401174806
1299775.3014967415
1317681.8410322222
1404246.6716592021
1425808.3063725064
1431033.2186997626
1446850.8020489502
1447620.3308368044
1459124.3307795496
1550391.0083775168
1631724.2395953902
1667250.8018262205
1750084.1602132369
1883648.1654112367
1947449.4066998823
1709858.9795411204
1056020.6709260931
1063386.3828577009
1100949.9283905733
1114216.0904812151
1098584.0776604006
1138520.5891734753
1150257.3416332583
1163998.9977514528
1166484.2621554560
1169660.2704170325
1172211.4577928962
1182923.0909175622
1195966.3969559148
1231601.8963574336
1242735.7779476738
1280885.4587684428
1291324.6496937233
1309980.6522015685
1333728.0047687977
1359026.8307338454
1362228.4966015575
1366103.4269040146
1374932.4478575733
1263510.2346903431
1283562.7271739130
1287483.1535140122
1320383.7530644264
1332979.8914503740
1342173.6511298548
1357251.3765617872
1366281.7261580221
1369023.5738995470
1378696.4627477130
1385336.9757682390
1390701.8959589858
1406007.4609789626
1406098.2272398299
1406568.6449738818

2025-01-22 21:12:48 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:12:48 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:12:48 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:12:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:12:50 - snowflake.connector.connection - INFO - closed
2025-01-22 21:12:50 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:12:50 - root - INFO - SQL:
SELECT f.value
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101" t,
   LATERAL FLATTEN(input => t."EVENT_PARAMS") f
   LIMIT 100;
Results:
Too long, hard cut:
VALUE
"{
  ""key"": ""ga_session_number"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""ga_session_id"",
  ""value"": {
    ""int_value"": 3209612510
  }
}"
"{
  ""key"": ""page_referrer"",
  ""value"": null
}"
"{
  ""key"": ""page_location"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""
  }
}"
"{
  ""key"": ""page_title"",
  ""value"": {
    ""string_value"": ""Google Dino Game Tee""
  }
}"
"{
  ""key"": ""session_engaged"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""engaged_session_event"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""page_location"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""
  }
}"
"{
  ""key"": ""entrances"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""medium"",
  ""value"": {
    ""string_value"": ""organic""
  }
}"
"{
  ""key"": ""campaign"",
  ""value"": {
    ""string_value"": ""(organic)""
  }
}"
"{
  ""key"": ""source"",
  ""value"": {
    ""string_value"": ""google""
  }
}"
"{
  ""key"": ""page_title"",
  ""value"": {
    ""string_value"": ""Google Dino Game Tee""
  }
}"
"{
  ""key"": ""engaged_session_event"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""page_referrer"",
  ""value"": null
}"
"{
  ""key"": ""term"",
  ""value"": {
    ""string_value"": ""<obfuscated>""
  }
}"
"{
  ""key"": ""session_engaged"",
  ""value"": {
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""ga_session_number"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""all_data"",
  ""value"": null
}"
"{
  ""key"": ""clean_event"",
  ""value"": {
    ""string_value"": ""gtm.js""
  }
}"
"{
  ""key"": ""debug_mode"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""ga_session_id"",
  ""value"": {
    ""int_value"": 3209612510
  }
}"
"{
  ""key"": ""ga_session_number"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""engaged_session_event"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""ga_session_id"",
  ""value"": {
    ""int_value"": 3209612510
  }
}"
"{
  ""key"": ""page_location"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""
  }
}"
"{
  ""key"": ""page_title"",
  ""value"": {
    ""string_value"": ""Google Dino Game Tee""
  }
}"
"{
  ""key"": ""page_referrer"",
  ""value"": null
}"
"{
  ""key"": ""engaged_session_event"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""ga_session_number"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""page_title"",
  ""value"": {
    ""string_value"": ""Google Dino Game Tee""
  }
}"
"{
  ""key"": ""debug_mode"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""engagement_time_msec"",
  ""value"": {
    ""int_value"": 2075
  }
}"
"{
  ""key"": ""session_engaged"",
  ""value"": {
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""page_location"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""
  }
}"
"{
  ""key"": ""ga_session_id"",
  ""value"": {
    ""int_value"": 3209612510
  }
}"
"{
  ""key"": ""page_referrer"",
  ""value"": null
}"
"{
  ""key"": ""ga_session_id"",
  ""value"": {
    ""int_value"": 3209612510
  }
}"
"{
  ""key"": ""ga_session_number"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""engagement_time_msec"",
  ""value"": {
    ""int_value"": 9
  }
}"
"{
  ""key"": ""debug_mode"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""engaged_session_event"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""page_title"",
  ""value"": {
    ""string_value"": ""Google Dino Game Tee""
  }
}"
"{
  ""key"": ""page_location"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""
  }
}"
"{
  ""key"": ""session_engaged"",
  ""value"": {
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""page_referrer"",
  ""value"": null
}"
"{
  ""key"": ""page_referrer"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/New?""
  }
}"
"{
  ""key"": ""page_location"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Campus+Collection/Google+Sunnyvale+Campus+Bottle""
  }
}"
"{
  ""key"": ""engagement_time_msec"",
  ""value"": {
    ""int_value"": 15567
  }
}"
"{
  ""key"": ""page_title"",
  ""value"": {
    ""string_value"": ""Google Sunnyvale Campus Bottle""
  }
}"
"{
  ""key"": ""session_engaged"",
  ""value"": {
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""ga_session_number"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""ga_session_id"",
  ""value"": {
    ""int_value"": 7473279052
  }
}"
"{
  ""key"": ""debug_mode"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""engaged_session_event"",
  ""

2025-01-22 21:12:50 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:12:50 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:12:50 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:12:52 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:12:52 - snowflake.connector.connection - INFO - closed
2025-01-22 21:12:52 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:12:52 - root - INFO - SQL:
SELECT f.value:"key"::STRING AS "PARAM_KEY",
          f.value:"value" AS "PARAM_VALUE"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101" t,
   LATERAL FLATTEN(input => t."EVENT_PARAMS") f
   LIMIT 100;
Results:
Too long, hard cut:
PARAM_KEY,PARAM_VALUE
ga_session_number,"{
  ""int_value"": 1
}"
ga_session_id,"{
  ""int_value"": 3209612510
}"
page_referrer,null
page_location,"{
  ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""
}"
page_title,"{
  ""string_value"": ""Google Dino Game Tee""
}"
session_engaged,"{
  ""int_value"": 1
}"
engaged_session_event,"{
  ""int_value"": 1
}"
page_location,"{
  ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""
}"
entrances,"{
  ""int_value"": 1
}"
medium,"{
  ""string_value"": ""organic""
}"
campaign,"{
  ""string_value"": ""(organic)""
}"
source,"{
  ""string_value"": ""google""
}"
page_title,"{
  ""string_value"": ""Google Dino Game Tee""
}"
engaged_session_event,"{
  ""int_value"": 1
}"
page_referrer,null
term,"{
  ""string_value"": ""<obfuscated>""
}"
session_engaged,"{
  ""string_value"": ""0""
}"
ga_session_number,"{
  ""int_value"": 1
}"
all_data,null
clean_event,"{
  ""string_value"": ""gtm.js""
}"
debug_mode,"{
  ""int_value"": 1
}"
ga_session_id,"{
  ""int_value"": 3209612510
}"
ga_session_number,"{
  ""int_value"": 1
}"
engaged_session_event,"{
  ""int_value"": 1
}"
ga_session_id,"{
  ""int_value"": 3209612510
}"
page_location,"{
  ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""
}"
page_title,"{
  ""string_value"": ""Google Dino Game Tee""
}"
page_referrer,null
engaged_session_event,"{
  ""int_value"": 1
}"
ga_session_number,"{
  ""int_value"": 1
}"
page_title,"{
  ""string_value"": ""Google Dino Game Tee""
}"
debug_mode,"{
  ""int_value"": 1
}"
engagement_time_msec,"{
  ""int_value"": 2075
}"
session_engaged,"{
  ""string_value"": ""1""
}"
page_location,"{
  ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""
}"
ga_session_id,"{
  ""int_value"": 3209612510
}"
page_referrer,null
ga_session_id,"{
  ""int_value"": 3209612510
}"
ga_session_number,"{
  ""int_value"": 1
}"
engagement_time_msec,"{
  ""int_value"": 9
}"
debug_mode,"{
  ""int_value"": 1
}"
engaged_session_event,"{
  ""int_value"": 1
}"
page_title,"{
  ""string_value"": ""Google Dino Game Tee""
}"
page_location,"{
  ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""
}"
session_engaged,"{
  ""string_value"": ""1""
}"
page_referrer,null
page_referrer,"{
  ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/New?""
}"
page_location,"{
  ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Campus+Collection/Google+Sunnyvale+Campus+Bottle""
}"
engagement_time_msec,"{
  ""int_value"": 15567
}"
page_title,"{
  ""string_value"": ""Google Sunnyvale Campus Bottle""
}"
session_engaged,"{
  ""string_value"": ""1""
}"
ga_session_number,"{
  ""int_value"": 1
}"
ga_session_id,"{
  ""int_value"": 7473279052
}"
debug_mode,"{
  ""int_value"": 1
}"
engaged_session_event,"{
  ""int_value"": 1
}"
percent_scrolled,"{
  ""int_value"": 90
}"
campaign,"{
  ""string_value"": ""<Other>""
}"
medium,"{
  ""string_value"": ""<Other>""
}"
session_engaged,"{
  ""string_value"": ""1""
}"
page_location,"{
  ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Lifestyle/Fun/Malibu+Sunglasses.axd""
}"
ga_session_number,"{
  ""int_value"": 1
}"
ga_session_id,"{
  ""int_value"": 7473279052
}"
debug_mode,"{
  ""int_value"": 1
}"
page_referrer,null
engagement_time_msec,"{
  ""int_value"": 21900
}"
source,"{
  ""string_value"": ""<Other>""
}"
engaged_session_event,"{
  ""int_value"": 1
}"
page_title,"{
  ""string_value"": ""The Google Merchandise Store/Malibu Sunglasses""
}"
engaged_session_event,"{
  ""int_value"": 1
}"
ga_session_id,"{
  ""int_value"": 7473279052
}"
session_engaged,"{
  ""string_value"": ""1""
}"
page_title,"{
  ""string_value"": ""Home""
}"
ga_session_number,"{
  ""int_value"": 1
}"
debug_mode,"{
  ""int_value"": 1
}"
engagement_time_msec,"{
  ""int_value"": 7
}"
page_location,"{
  ""string_value"": ""https://shop.googlemerchandisestore.com/""
}"
campaign,"{
  ""string_value"": ""<Other>""
}"
engaged_session_event,"{
  ""int_value"": 1
}"
engagement_time_msec,"{
  ""int_value"": 6603
}"
session_engaged,"{
  ""string_value"": ""1""
}"
medium,"{
  ""string_value"": ""<Other>""
}"
ga_session_id,"{
  ""int_value"": 7473279052
}"
debug_mode,"{
  ""int_value"": 1
}"
page_referrer,"{
  ""string_value"": ""https://shop.googlemerchandisestore.com/basket.html?""
}"
ga_session_number,"{
  ""int_value"": 1
}"
page_location,"{
  ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Accessories/Google+Clear+Framed+Yellow+Shades""
}"
page_title,"{
  ""string_value"": ""Google Clear Framed Yellow Shades""
}"
source,"{
  ""string_value"": ""<Other>""
}"
ga_session_number,"{
  ""int_value"": 1
}"
engagement_time_msec,"{
  ""int_value"": 2187
}"
page_referrer,"{
  ""string_value"": ""https://shop.goog

2025-01-22 21:12:52 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:12:52 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:12:52 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:12:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 17
2025-01-22 21:12:54 - snowflake.connector.connection - INFO - closed
2025-01-22 21:12:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:12:55 - root - INFO - SQL:
SELECT DISTINCT "EVENT_NAME"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
   UNION
   SELECT DISTINCT "EVENT_NAME"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
   UNION
   SELECT DISTINCT "EVENT_NAME"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
   UNION
   SELECT DISTINCT "EVENT_NAME"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
   UNION
   SELECT DISTINCT "EVENT_NAME"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
   UNION
   SELECT DISTINCT "EVENT_NAME"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
   UNION
   SELECT DISTINCT "EVENT_NAME"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
   LIMIT 100;
Results:
EVENT_NAME
first_visit
page_view
session_start
user_engagement
scroll
view_item
add_shipping_info
add_payment_info
view_search_results
select_promotion
click
select_item
view_promotion
begin_checkout
purchase
add_to_cart
view_item_list

2025-01-22 21:12:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:12:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:12:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:12:56 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:12:56 - snowflake.connector.connection - INFO - closed
2025-01-22 21:12:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:12:57 - root - INFO - SQL:
SELECT "USER_PSEUDO_ID", COUNT(*) AS "EVENT_COUNT"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
   GROUP BY "USER_PSEUDO_ID"
   ORDER BY "EVENT_COUNT" DESC
   LIMIT 100;
Results:
USER_PSEUDO_ID,EVENT_COUNT
72522849.6381089738,1011
1160488.2375923167,427
2783014.3813479767,318
5563930.3593101391,203
53550354.6354713181,180
8186100.1619066340,171
59533896.5320638489,170
68546038.8820428933,163
87047667.1042912591,149
53104811.8176614311,148
17007406.8391181695,144
72065348.6852495696,133
7515221.4303230400,126
28134106.1591086954,121
81574425.5434958788,117
6867779.6634381231,115
1188134.8498680538,114
7105959.6709528403,110
50844046.9564028621,99
74953787.0199910547,94
3354006.4211651279,90
75073588.1859607099,88
6328102986.3137432902,85
15817556.8554808751,83
10860969.8635427479,80
6101467.4740745406,80
1023282.4639847710,77
32537212.0554785312,77
76975305.9969820299,76
6801661.0213744991,76
45942478.6625384752,76
62524109.3161787418,76
1112823.8475775772,73
2885429.0157235569,68
1990491.3893000361,67
40650638.8176789956,67
6772624.5257726160,67
4626089.7083106102,66
78839661.7033676134,65
29404827.7870928470,63
2856545.1057637132,61
15047683.3025668953,57
82379049.4680589452,57
5510821.7058149595,57
4107999736.9770670225,56
53067943.8636445638,55
18097479.9566775994,53
3351786.5083077372,52
42142866.3416900702,51
6482353.8828196074,50
64527390.2197615970,50
1646722.0078157231,48
10115718.4867090359,48
5393985456.0596119848,48
38359877.5815012009,47
61687008.5702070839,47
22288916.8827658539,46
43470418.6139420304,45
81213220.7958656808,43
4124604.0408794437,43
84760862.0017504152,42
15932166.2076268855,41
43120797.5731831365,41
13167690.2693949122,40
8903783.1803413789,40
12685424.3792504835,39
83736385.8758161413,38
8813737.3153270447,38
1684301.4109152707,38
5686154.7174932299,38
16910393.5498744454,38
1566834642.5850724108,37
63655374.9348413503,37
5554878.0772348619,36
39447924.7392393021,36
73990466.9253242963,36
6351413.2459505432,35
28889932.1687420790,35
76874793.6611457255,34
16584748.2250156564,34
3001110.3208062401,33
34851780.6903374642,33
14801022.9686481759,33
48293850.3499088450,33
4647802.5572043944,33
5337490.6328314089,33
87188220.6252432191,32
11116091.7897694184,32
12177989.5566440967,32
5831980.2827657871,31
77052125.0799530822,31
1829763.3860332334,31
2779137.7674526641,31
4289529.7500442979,31
52170675.5101121559,31
9221726.8946931934,30
11369626.1068446121,30
88839956.1260646312,30
8858380583.2491355805,30
50994991.7786921042,30

2025-01-22 21:12:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:12:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:12:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:12:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-22 21:12:58 - snowflake.connector.connection - INFO - closed
2025-01-22 21:12:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:14:55 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:14:55 - root - INFO - ```sql
SELECT COUNT(DISTINCT "USER_PSEUDO_ID") AS "Number_of_Pseudo_Users"
FROM (
    -- Users active in the last 7 days (January 1 to January 7, 2021)
    SELECT "USER_PSEUDO_ID"
    FROM (
        SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
        UNION
        SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
        UNION
        SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
        UNION
        SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
        UNION
        SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
        UNION
        SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
        UNION
        SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
    ) AS last7days
    WHERE "USER_PSEUDO_ID" NOT IN (
        -- Users active in the last 2 days (January 6 and 7, 2021)
        SELECT DISTINCT "USER_PSEUDO_ID"
        FROM (
            SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
            UNION
            SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
        )
    )
) AS result;
```
2025-01-22 21:14:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:14:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:14:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:14:58 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-22 21:14:58 - snowflake.connector.connection - INFO - closed
2025-01-22 21:14:58 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:16:33 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:16:33 - root - INFO - SQL:
SELECT COUNT(DISTINCT "USER_PSEUDO_ID") AS "Number_of_Pseudo_Users"
FROM (
    -- Users active in the last 7 days (January 1 to January 7, 2021)
    SELECT "USER_PSEUDO_ID"
    FROM (
        SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
        UNION
        SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
        UNION
        SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
        UNION
        SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
        UNION
        SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
        UNION
        SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
        UNION
        SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
    ) AS last7days
    WHERE "USER_PSEUDO_ID" NOT IN (
        -- Users active in the last 2 days (January 6 and 7, 2021)
        SELECT DISTINCT "USER_PSEUDO_ID"
        FROM (
            SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
            UNION
            SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
        )
    )
) AS result;
Results:
Number_of_Pseudo_Users
13442

2025-01-22 21:16:33 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:16:33 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:16:33 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:16:34 - snowflake.connector.cursor - INFO - Number of results in first chunk: 0
2025-01-22 21:16:34 - snowflake.connector.connection - INFO - closed
2025-01-22 21:16:35 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:18:22 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:18:22 - root - INFO - ```sql
SELECT COUNT(DISTINCT last7days."USER_PSEUDO_ID") AS "Number_of_Pseudo_Users"
FROM (
    -- Users active from January 1 to January 5, 2021
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
) AS last7days
LEFT JOIN (
    -- Users active in the last 2 days (January 6 and 7, 2021)
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
) AS last2days
ON last7days."USER_PSEUDO_ID" = last2days."USER_PSEUDO_ID"
WHERE last2days."USER_PSEUDO_ID" IS NULL;
```
2025-01-22 21:18:22 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:18:22 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:18:22 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:18:24 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-22 21:18:24 - snowflake.connector.connection - INFO - closed
2025-01-22 21:18:24 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:19:41 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:19:41 - root - INFO - SQL:
SELECT COUNT(DISTINCT last7days."USER_PSEUDO_ID") AS "Number_of_Pseudo_Users"
FROM (
    -- Users active from January 1 to January 5, 2021
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
) AS last7days
LEFT JOIN (
    -- Users active in the last 2 days (January 6 and 7, 2021)
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
) AS last2days
ON last7days."USER_PSEUDO_ID" = last2days."USER_PSEUDO_ID"
WHERE last2days."USER_PSEUDO_ID" IS NULL;
Results:
Number_of_Pseudo_Users
13442

2025-01-22 21:19:41 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:19:41 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:19:41 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:19:42 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-22 21:19:42 - snowflake.connector.connection - INFO - closed
2025-01-22 21:19:42 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:19:43 - root - INFO - SQL:
SELECT DISTINCT "EVENT_DATE"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
WHERE "EVENT_DATE" IS NOT NULL
LIMIT 100
Results:
EVENT_DATE
20210101

2025-01-22 21:19:43 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:19:43 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:19:43 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:19:44 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:19:44 - snowflake.connector.connection - INFO - closed
2025-01-22 21:19:45 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:19:45 - root - INFO - SQL:
SELECT "USER_PSEUDO_ID", MAX("EVENT_TIMESTAMP") AS "LAST_EVENT_TIMESTAMP"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
GROUP BY "USER_PSEUDO_ID"
LIMIT 100
Results:
USER_PSEUDO_ID,LAST_EVENT_TIMESTAMP
1003046.9452926974,1609468320458554
1023282.4639847710,1609518484536210
1026043.4481623879,1609516112499719
1026409.1551860912,1609512092439022
1032138.1796039159,1609463890898989
1037928.9294661675,1609536630795770
1045950.7099606829,1609486806967750
1051288.9523352374,1609510184020907
1064574.6224708641,1609517227080600
1066655.6240997015,1609520937538856
1080064.0071613184,1609543822475931
1082746.7285674512,1609537501394824
1097358.9593491100,1609487255084735
1104313.9641823605,1609515677954027
1112823.8475775772,1609460211851305
1127824.3503063268,1609540688714136
1138692.0103796281,1609527125974168
1160488.2375923167,1609519478307490
1054372.6755770068,1609471957177721
1116587.1725520171,1609543578148128
1164648.0319944302,1609539281241418
1168297.2853699605,1609508032589826
1174066.6437027818,1609481872526551
1178889.6850461952,1609512750376960
1205590.2516186397,1609507381593819
1211099.8247563235,1609520884004282
1213932.4846099850,1609483110633501
1218586.5350251990,1609529007992038
1246063.3665874179,1609510384582537
1255322.2973246181,1609497619324582
1275797.1936238018,1609524822705447
1296701.2382814729,1609545591562483
1375005.2583322863,1609519291701096
1401649.9529464111,1609477397606058
1453951.1387928223,1609514749986299
1485472.4390061373,1609517236174073
1501018.3808301483,1609479297903773
1582390.8206269591,1609536484327607
1620024.8966870933,1609507301821257
1680043.1145812114,1609523494028844
1688147.2939632391,1609531765463950
1693134.9790437518,1609495677933394
1734528.1974041204,1609463208552274
1846974.0316175078,1609495306056327
1884090.9722372635,1609501779850680
1886250.8920156183,1609541431171439
2007362.2149327588,1609476995844969
2041235.3400307589,1609483884577498
2150276.2168438227,1609475171944849
2245992.8909040661,1609467878317255
2264573.5209212671,1609520651290650
2311908.3797713386,1609516885190561
2322051.0966144624,1609459842550905
2378480.6534474606,1609535031893808
2613632.7561400432,1609534119732155
1515646.3111272928,1609486445394916
2304235.4728947355,1609519181910818
2376646.7974930863,1609526465814202
2539661.0024435471,1609513432452757
2589245.5979068367,1609501163076544
2687473.9692412289,1609522432576845
2709449.6736747839,1609525721491020
2873742.8991614203,1609461475616880
3259639.2895579600,1609461964842838
1107198.5152483918,1609506990211110
1134825.6533092350,1609544905325971
1170405.4925804370,1609491446415397
1188134.8498680538,1609517303601428
1215465.1474478000,1609507504174418
1259302.9069938124,1609514720533888
1269423.6724500672,1609499787823322
1277765.6068129494,1609476659803391
1318624.9067804638,1609514314290554
1320187.6719997668,1609461112865699
1333091.0887566663,1609528859010236
1352892.5937639189,1609474022530051
1382535.7283137323,1609463610554556
1396456.6482506733,1609510193708003
1422161.0871788362,1609489680596864
1437260.5988606411,1609534211177552
1456890.1673716823,1609540742591402
1473136.1149103090,1609480140346213
1518831.1475327211,1609484869486115
1534689.9343310805,1609534136676260
1539940.5253610440,1609485216192787
1543004.7243225422,1609519699396488
1619900.3195973863,1609519428571764
1646722.0078157231,1609485882025254
1674937.2501954408,1609519580047997
1684301.4109152707,1609530412997652
1713530.3382800695,1609542864424131
1719564.6333875501,1609514645951076
1729803.5105688857,1609539921326577
1759212.2216007988,1609500922602626
1762263.6990880514,1609509032083576
1784794.0627143380,1609462323131983
1804199.2014328535,1609526443966314
1820733.6464417466,1609491345193666
1912537.7440240268,1609518518256358
1990491.3893000361,1609481547819704

2025-01-22 21:19:45 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:19:45 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:19:45 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:19:47 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:19:47 - snowflake.connector.connection - INFO - closed
2025-01-22 21:19:47 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:19:47 - root - INFO - SQL:
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
WHERE "EVENT_NAME" = 'session_start'
LIMIT 100
Results:
USER_PSEUDO_ID
1003046.9452926974
1023282.4639847710
1026043.4481623879
1026409.1551860912
1032138.1796039159
1037928.9294661675
1045950.7099606829
1051288.9523352374
1054372.6755770068
1064574.6224708641
1066655.6240997015
1080064.0071613184
1082746.7285674512
1107198.5152483918
1116587.1725520171
1127824.3503063268
1134825.6533092350
1138692.0103796281
1097358.9593491100
1164648.0319944302
1170405.4925804370
1174066.6437027818
1178889.6850461952
1188134.8498680538
1205590.2516186397
1211099.8247563235
1240786.8917310160
1269423.6724500672
1275797.1936238018
1277765.6068129494
1296701.2382814729
1259302.9069938124
1318624.9067804638
1333091.0887566663
1382535.7283137323
1422161.0871788362
1453951.1387928223
1459436.8826692932
1473136.1149103090
1501018.3808301483
1503421.5168556763
1515646.3111272928
1518831.1475327211
1534689.9343310805
1539940.5253610440
1582390.8206269591
1620024.8966870933
1646722.0078157231
1707918.4797422153
1846974.0316175078
1884090.9722372635
1961265.4757052307
2102395.6721696580
2290904.3176780756
2432374.8482039518
2709449.6736747839
1550901.3980286554
1619900.3195973863
1820733.6464417466
2165252.0147518395
2438148.3441039719
1104313.9641823605
1160488.2375923167
1168297.2853699605
1213932.4846099850
1215465.1474478000
1218586.5350251990
1255322.2973246181
1308776.9803994658
1320187.6719997668
1352892.5937639189
1375005.2583322863
1385112.5897617274
1437260.5988606411
1448835.0934102497
1485472.4390061373
1499810.5142637849
1543004.7243225422
1564015.6880680172
1575061.4789497906
1616136.8949543878
1674937.2501954408
1693134.9790437518
1713530.3382800695
1729803.5105688857
1734528.1974041204
1749246.8534368616
1804199.2014328535
1829763.3860332334
1859470.4546513665
1886250.8920156183
1990491.3893000361
2041235.3400307589
2091407.8804833129
2142722.9676010623
2167343.6164963557
2168528.2202958861
2194957.7885097322
2327547.5435328629
2376646.7974930863

2025-01-22 21:19:47 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:19:47 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:19:47 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:19:50 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:19:50 - snowflake.connector.connection - INFO - closed
2025-01-22 21:19:51 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:19:51 - root - INFO - SQL:
SELECT f.value
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101" t,
LATERAL FLATTEN(input => t."ITEMS") f
WHERE t."ITEMS" IS NOT NULL
LIMIT 100
Results:
Too long, hard cut:
VALUE
"{
  ""affiliation"": ""(not set)"",
  ""coupon"": ""(not set)"",
  ""creative_name"": ""(not set)"",
  ""creative_slot"": ""(not set)"",
  ""item_brand"": ""Google"",
  ""item_category"": ""Bags"",
  ""item_category2"": ""(not set)"",
  ""item_category3"": ""(not set)"",
  ""item_category4"": ""(not set)"",
  ""item_category5"": ""(not set)"",
  ""item_id"": ""9188227"",
  ""item_list_id"": ""(not set)"",
  ""item_list_index"": ""(not set)"",
  ""item_list_name"": ""Not available in demo dataset"",
  ""item_name"": ""Google Flat Front Bag Grey"",
  ""item_variant"": ""Single Option Only"",
  ""location_id"": ""(not set)"",
  ""price"": 3.000000000000000e+01,
  ""promotion_id"": ""(not set)"",
  ""promotion_name"": ""Reach New Heights"",
  ""quantity"": 1
}"
"{
  ""affiliation"": ""(not set)"",
  ""coupon"": ""(not set)"",
  ""creative_name"": ""(not set)"",
  ""creative_slot"": ""(not set)"",
  ""item_brand"": ""Google"",
  ""item_category"": ""Bags"",
  ""item_category2"": ""(not set)"",
  ""item_category3"": ""(not set)"",
  ""item_category4"": ""(not set)"",
  ""item_category5"": ""(not set)"",
  ""item_id"": ""9188227"",
  ""item_list_id"": ""(not set)"",
  ""item_list_index"": ""(not set)"",
  ""item_list_name"": ""Not available in demo dataset"",
  ""item_name"": ""Google Flat Front Bag Grey"",
  ""item_variant"": ""Single Option Only"",
  ""location_id"": ""(not set)"",
  ""price"": 3.000000000000000e+01,
  ""promotion_id"": ""(not set)"",
  ""promotion_name"": ""Reach New Heights"",
  ""quantity"": 1
}"
"{
  ""affiliation"": ""(not set)"",
  ""coupon"": ""(not set)"",
  ""creative_name"": ""(not set)"",
  ""creative_slot"": ""(not set)"",
  ""item_brand"": ""Google"",
  ""item_category"": ""Bags"",
  ""item_category2"": ""(not set)"",
  ""item_category3"": ""(not set)"",
  ""item_category4"": ""(not set)"",
  ""item_category5"": ""(not set)"",
  ""item_id"": ""9188227"",
  ""item_list_id"": ""(not set)"",
  ""item_list_index"": ""(not set)"",
  ""item_list_name"": ""Not available in demo dataset"",
  ""item_name"": ""Google Flat Front Bag Grey"",
  ""item_variant"": ""Single Option Only"",
  ""location_id"": ""(not set)"",
  ""price"": 3.000000000000000e+01,
  ""promotion_id"": ""(not set)"",
  ""promotion_name"": ""Reach New Heights"",
  ""quantity"": 1
}"
"{
  ""affiliation"": ""(not set)"",
  ""coupon"": ""(not set)"",
  ""creative_name"": ""(not set)"",
  ""creative_slot"": ""(not set)"",
  ""item_brand"": ""Google"",
  ""item_category"": ""Bags"",
  ""item_category2"": ""(not set)"",
  ""item_category3"": ""(not set)"",
  ""item_category4"": ""(not set)"",
  ""item_category5"": ""(not set)"",
  ""item_id"": ""9188227"",
  ""item_list_id"": ""(not set)"",
  ""item_list_index"": ""(not set)"",
  ""item_list_name"": ""Not available in demo dataset"",
  ""item_name"": ""Google Flat Front Bag Grey"",
  ""item_variant"": ""Single Option Only"",
  ""location_id"": ""(not set)"",
  ""price"": 3.000000000000000e+01,
  ""promotion_id"": ""(not set)"",
  ""promotion_name"": ""Reach New Heights"",
  ""quantity"": 1
}"
"{
  ""affiliation"": ""(not set)"",
  ""coupon"": ""(not set)"",
  ""creative_name"": ""(not set)"",
  ""creative_slot"": ""(not set)"",
  ""item_brand"": ""Google"",
  ""item_category"": ""Bags"",
  ""item_category2"": ""(not set)"",
  ""item_category3"": ""(not set)"",
  ""item_category4"": ""(not set)"",
  ""item_category5"": ""(not set)"",
  ""item_id"": ""9188227"",
  ""item_list_id"": ""(not set)"",
  ""item_list_index"": ""(not set)"",
  ""item_list_name"": ""Not available in demo dataset"",
  ""item_name"": ""Google Flat Front Bag Grey"",
  ""item_variant"": ""Single Option Only"",
  ""location_id"": ""(not set)"",
  ""price"": 3.000000000000000e+01,
  ""promotion_id"": ""(not set)"",
  ""promotion_name"": ""Reach New Heights"",
  ""quantity"": 1
}"
"{
  ""affiliation"": ""(not set)"",
  ""coupon"": ""(not set)"",
  ""creative_name"": ""(not set)"",
  ""creative_slot"": ""(not set)"",
  ""item_brand"": ""Google"",
  ""item_category"": ""Bags"",
  ""item_category2"": ""(not set)"",
  ""item_category3"": ""(not set)"",
  ""item_category4"": ""(not set)"",
  ""item_category5"": ""(not set)"",
  ""item_id"": ""9188227"",
  ""item_list_id"": ""(not set)"",
  ""item_list_index"": ""(not set)"",
  ""item_list_name"": ""Not available in demo dataset"",
  ""item_name"": ""Google Flat Front Bag Grey"",
  ""item_variant"": ""Single Option Only"",
  ""location_id"": ""(not set)"",
  ""price"": 3.000000000000000e+01,
  ""promotion_id"": ""(not set)"",
  ""promotion_name"": ""Reach New Heights"",
  ""quantity"": 1
}"
"{
  ""affiliation"": ""(not set)"",
  ""coupon"": ""(not set)"",
  ""creative_name"": ""(not set)"",
  ""creative_slot"": ""(not set)"",
  ""item_brand"": ""Google"",
  ""item_category"": ""Bags"",
  ""item_category2"": ""(not set)"",
  ""item_category3"": ""(not set)"",
  ""item_category4"": ""(not set)"",
  ""item_category5"": ""(not set)"",
  ""item_id"": ""9188227"",
  ""i

2025-01-22 21:19:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:19:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:19:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:19:53 - snowflake.connector.cursor - INFO - Number of results in first chunk: 67
2025-01-22 21:19:53 - snowflake.connector.connection - INFO - closed
2025-01-22 21:19:53 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:19:53 - root - INFO - SQL:
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
WHERE "EVENT_NAME" = 'add_to_cart'
LIMIT 100
Results:
USER_PSEUDO_ID
5289818.5896545465
8186100.1619066340
17007406.8391181695
22570371.0320972505
2885429.0157235569
68546038.8820428933
2783014.3813479767
81213220.7958656808
8697832.7658029149
69538214.0147460457
75446459.8381341234
82379049.4680589452
1160488.2375923167
1211099.8247563235
1539940.5253610440
2486846.9299481244
1023282.4639847710
1990491.3893000361
3071789.9352232891
3354006.4211651279
4015519.0757720765
4813555.8829728696
9312196.4289187337
15817556.8554808751
22288916.8827658539
26776431.5444855772
32537212.0554785312
38359877.5815012009
42142866.3416900702
53550354.6354713181
61687008.5702070839
78839661.7033676134
88839956.1260646312
89439614.4776585611
3671634874.2560291757
62524109.3161787418
73990466.9253242963
76975305.9969820299
1188134.8498680538
2272023.1096248377
2856545.1057637132
4651894.8591529595
5337490.6328314089
5510821.7058149595
5952403.0699076194
6101467.4740745406
10860969.8635427479
15047683.3025668953
38945261.7275220036
39335113.7845260204
40650638.8176789956
41872628.9123536919
43120797.5731831365
50844046.9564028621
68049257.5560117388
14801022.9686481759
53104811.8176614311
67150059.7765111802
72522849.6381089738
28134106.1591086954
53067943.8636445638
65541226.9896109368
78966520.2065669153
81952815.1086227980
38050258.5403414260
53327798.6735383085
39447924.7392393021

2025-01-22 21:19:53 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:19:53 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:19:53 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:19:55 - snowflake.connector.cursor - INFO - Number of results in first chunk: 7
2025-01-22 21:19:55 - snowflake.connector.connection - INFO - closed
2025-01-22 21:19:55 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:19:55 - root - INFO - SQL:
SELECT "EVENT_DATE", SUM("EVENT_COUNT") AS "EVENT_COUNT"
FROM (
    SELECT "EVENT_DATE", COUNT(*) AS "EVENT_COUNT"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
    GROUP BY "EVENT_DATE"
    UNION ALL
    SELECT "EVENT_DATE", COUNT(*) AS "EVENT_COUNT"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
    GROUP BY "EVENT_DATE"
    UNION ALL
    SELECT "EVENT_DATE", COUNT(*) AS "EVENT_COUNT"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
    GROUP BY "EVENT_DATE"
    UNION ALL
    SELECT "EVENT_DATE", COUNT(*) AS "EVENT_COUNT"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
    GROUP BY "EVENT_DATE"
    UNION ALL
    SELECT "EVENT_DATE", COUNT(*) AS "EVENT_COUNT"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
    GROUP BY "EVENT_DATE"
    UNION ALL
    SELECT "EVENT_DATE", COUNT(*) AS "EVENT_COUNT"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
    GROUP BY "EVENT_DATE"
    UNION ALL
    SELECT "EVENT_DATE", COUNT(*) AS "EVENT_COUNT"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
    GROUP BY "EVENT_DATE"
) AS sub
GROUP BY "EVENT_DATE"
ORDER BY "EVENT_DATE"
LIMIT 100
Results:
EVENT_DATE,EVENT_COUNT
20210101,22096
20210102,23599
20210103,24743
20210104,31395
20210105,42827
20210106,56076
20210107,44473

2025-01-22 21:19:55 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:19:55 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:19:55 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:19:57 - snowflake.connector.cursor - INFO - Number of results in first chunk: 12
2025-01-22 21:19:57 - snowflake.connector.connection - INFO - closed
2025-01-22 21:19:57 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:19:57 - root - INFO - SQL:
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
WHERE "EVENT_NAME" = 'purchase'
LIMIT 100
Results:
USER_PSEUDO_ID
3351786.5083077372
40650638.8176789956
87047667.1042912591
68546038.8820428933
6101467.4740745406
15817556.8554808751
50844046.9564028621
53104811.8176614311
2783014.3813479767
53550354.6354713181
3354006.4211651279
1160488.2375923167

2025-01-22 21:19:57 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:19:57 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:19:57 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:19:59 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:19:59 - snowflake.connector.connection - INFO - closed
2025-01-22 21:19:59 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:19:59 - root - INFO - SQL:
SELECT DISTINCT "USER_PSEUDO_ID"
FROM (
    SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
    UNION ALL
    SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
    UNION ALL
    SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
    UNION ALL
    SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
    UNION ALL
    SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
) AS last5days
LIMIT 100
Results:
USER_PSEUDO_ID
1003046.9452926974
1023282.4639847710
1026043.4481623879
1026409.1551860912
1037928.9294661675
1045950.7099606829
1054372.6755770068
1064574.6224708641
1066655.6240997015
1080064.0071613184
1097358.9593491100
1104313.9641823605
1112823.8475775772
1116587.1725520171
1127824.3503063268
1134825.6533092350
1138692.0103796281
1082746.7285674512
1164648.0319944302
1170405.4925804370
1174066.6437027818
1188134.8498680538
1215465.1474478000
1218586.5350251990
1240786.8917310160
1255322.2973246181
1259302.9069938124
1269423.6724500672
1275797.1936238018
1277765.6068129494
1318624.9067804638
1326289.2331853598
1333091.0887566663
1375005.2583322863
1422161.0871788362
1453555.6810069410
1453951.1387928223
1456890.1673716823
1459436.8826692932
1473136.1149103090
1485472.4390061373
1519124.8641457524
1543004.7243225422
1550901.3980286554
1674937.2501954408
1677450.9117017807
1707918.4797422153
1719564.6333875501
1729803.5105688857
1745072.0004799132
1749246.8534368616
1859470.4546513665
1912537.7440240268
1958116.3750166429
2244553.9738621373
2362829.7919429820
2432374.8482039518
2492721.1881800375
2692657.2939750667
1745171.2191701968
1765594.3047173009
1032138.1796039159
1051288.9523352374
1107198.5152483918
1160488.2375923167
1168297.2853699605
1205590.2516186397
1213932.4846099850
1296701.2382814729
1178889.6850461952
1246063.3665874179
1308776.9803994658
1382535.7283137323
1385112.5897617274
1396456.6482506733
1401649.9529464111
1437260.5988606411
1503421.5168556763
1515646.3111272928
1518831.1475327211
1534689.9343310805
1539940.5253610440
1564015.6880680172
1575061.4789497906
1582390.8206269591
1646722.0078157231
1693134.9790437518
1713530.3382800695
1734528.1974041204
1759212.2216007988
1762263.6990880514
1784794.0627143380
1804199.2014328535
1820733.6464417466
1846974.0316175078
1886250.8920156183
1993768.0582544668
2007362.2149327588
2019465.0056495205
2041235.3400307589

2025-01-22 21:19:59 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:19:59 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:19:59 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:20:01 - snowflake.connector.cursor - INFO - Number of results in first chunk: 100
2025-01-22 21:20:01 - snowflake.connector.connection - INFO - closed
2025-01-22 21:20:01 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:20:01 - root - INFO - SQL:
SELECT f.value
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101" t,
LATERAL FLATTEN(input => t."EVENT_PARAMS") f
WHERE t."EVENT_NAME" = 'page_view'
LIMIT 100
Results:
Too long, hard cut:
VALUE
"{
  ""key"": ""page_location"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""
  }
}"
"{
  ""key"": ""entrances"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""medium"",
  ""value"": {
    ""string_value"": ""organic""
  }
}"
"{
  ""key"": ""campaign"",
  ""value"": {
    ""string_value"": ""(organic)""
  }
}"
"{
  ""key"": ""source"",
  ""value"": {
    ""string_value"": ""google""
  }
}"
"{
  ""key"": ""page_title"",
  ""value"": {
    ""string_value"": ""Google Dino Game Tee""
  }
}"
"{
  ""key"": ""engaged_session_event"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""page_referrer"",
  ""value"": null
}"
"{
  ""key"": ""term"",
  ""value"": {
    ""string_value"": ""<obfuscated>""
  }
}"
"{
  ""key"": ""session_engaged"",
  ""value"": {
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""ga_session_number"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""all_data"",
  ""value"": null
}"
"{
  ""key"": ""clean_event"",
  ""value"": {
    ""string_value"": ""gtm.js""
  }
}"
"{
  ""key"": ""debug_mode"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""ga_session_id"",
  ""value"": {
    ""int_value"": 3209612510
  }
}"
"{
  ""key"": ""ga_session_id"",
  ""value"": {
    ""int_value"": 3209612510
  }
}"
"{
  ""key"": ""ga_session_number"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""engagement_time_msec"",
  ""value"": {
    ""int_value"": 9
  }
}"
"{
  ""key"": ""debug_mode"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""engaged_session_event"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""page_title"",
  ""value"": {
    ""string_value"": ""Google Dino Game Tee""
  }
}"
"{
  ""key"": ""page_location"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""
  }
}"
"{
  ""key"": ""session_engaged"",
  ""value"": {
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""page_referrer"",
  ""value"": null
}"
"{
  ""key"": ""engaged_session_event"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""ga_session_id"",
  ""value"": {
    ""int_value"": 7473279052
  }
}"
"{
  ""key"": ""session_engaged"",
  ""value"": {
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""page_title"",
  ""value"": {
    ""string_value"": ""Home""
  }
}"
"{
  ""key"": ""ga_session_number"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""debug_mode"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""engagement_time_msec"",
  ""value"": {
    ""int_value"": 7
  }
}"
"{
  ""key"": ""page_location"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/""
  }
}"
"{
  ""key"": ""session_engaged"",
  ""value"": {
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""page_location"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/yourinfo.html""
  }
}"
"{
  ""key"": ""ga_session_id"",
  ""value"": {
    ""int_value"": 7473279052
  }
}"
"{
  ""key"": ""engagement_time_msec"",
  ""value"": {
    ""int_value"": 5
  }
}"
"{
  ""key"": ""engaged_session_event"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""ga_session_number"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""debug_mode"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""page_title"",
  ""value"": {
    ""string_value"": ""Checkout Your Information""
  }
}"
"{
  ""key"": ""page_referrer"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/yourinfo.html?""
  }
}"
"{
  ""key"": ""ga_session_number"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""page_referrer"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/basket.html?""
  }
}"
"{
  ""key"": ""debug_mode"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""page_title"",
  ""value"": {
    ""string_value"": ""Checkout Your Information""
  }
}"
"{
  ""key"": ""engagement_time_msec"",
  ""value"": {
    ""int_value"": 5
  }
}"
"{
  ""key"": ""session_engaged"",
  ""value"": {
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""page_location"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/yourinfo.html""
  }
}"
"{
  ""key"": ""ga_session_id"",
  ""value"": {
    ""int_value"": 7473279052
  }
}"
"{
  ""key"": ""engaged_session_event"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""session_engaged"",
  ""value"": {
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""engaged_session_event"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""page_referrer"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Shop+by+Brand/Google?""
  }
}"
"{
  ""key"": ""engagement_time_msec"",
  ""value"": {
    ""int_value"": 5
  }
}"
"{
  ""key"": ""ga_session_id"",
  ""value"": {
    ""int_value"": 7473279052
  }
}"

2025-01-22 21:20:01 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:20:01 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:20:01 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:20:03 - snowflake.connector.cursor - INFO - Number of results in first chunk: 24
2025-01-22 21:20:03 - snowflake.connector.connection - INFO - closed
2025-01-22 21:20:03 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:20:03 - root - INFO - SQL:
SELECT DATE_PART(hour, TO_TIMESTAMP("EVENT_TIMESTAMP" / 1000000)) AS "HOUR",
       COUNT(*) AS "EVENT_COUNT"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
GROUP BY "HOUR"
ORDER BY "HOUR"
LIMIT 100
Results:
HOUR,EVENT_COUNT
0,712
1,495
2,635
3,846
4,1463
5,1142
6,1011
7,945
8,840
9,810
10,750
11,746
12,719
13,1091
14,654
15,1012
16,1515
17,763
18,829
19,925
20,936
21,1209
22,1030
23,1018

2025-01-22 21:20:03 - root - INFO - itercount: 0
2025-01-22 21:20:03 - root - INFO - Database Name: GA4
Schema Name: GA4_OBFUSCATED_SAMPLE_ECOMMERCE
DDL describes table information.
,0
table_name,EVENTS_20201104
description,
DDL,"create or replace TABLE EVENTS_20201104 (
	EVENT_DATE VARCHAR(16777216),
	EVENT_TIMESTAMP NUMBER(38,0),
	EVENT_NAME VARCHAR(16777216),
	EVENT_PARAMS VARIANT,
	EVENT_PREVIOUS_TIMESTAMP NUMBER(38,0),
	EVENT_VALUE_IN_USD FLOAT,
	EVENT_BUNDLE_SEQUENCE_ID NUMBER(38,0),
	EVENT_SERVER_TIMESTAMP_OFFSET NUMBER(38,0),
	USER_ID VARCHAR(16777216),
	USER_PSEUDO_ID VARCHAR(16777216),
	PRIVACY_INFO VARIANT,
	USER_PROPERTIES VARIANT,
	USER_FIRST_TOUCH_TIMESTAMP NUMBER(38,0),
	USER_LTV VARIANT,
	DEVICE VARIANT,
	GEO VARIANT,
	APP_INFO VARIANT,
	TRAFFIC_SOURCE VARIANT,
	STREAM_ID NUMBER(38,0),
	PLATFORM VARCHAR(16777216),
	EVENT_DIMENSIONS VARIANT,
	ECOMMERCE VARIANT,
	ITEMS VARIANT
);"

Some other tables have the similar structure: ['EVENTS_20201104', 'EVENTS_20201108', 'EVENTS_20201114', 'EVENTS_20201116', 'EVENTS_20201204', 'EVENTS_20201207', 'EVENTS_20201211', 'EVENTS_20201220', 'EVENTS_20201115', 'EVENTS_20201208', 'EVENTS_20201223', 'EVENTS_20210103', 'EVENTS_20210114', 'EVENTS_20210122', 'EVENTS_20210123', 'EVENTS_20210126', 'EVENTS_20201212', 'EVENTS_20210107', 'EVENTS_20201101', 'EVENTS_20201103', 'EVENTS_20201105', 'EVENTS_20201119', 'EVENTS_20201128', 'EVENTS_20201202', 'EVENTS_20201203', 'EVENTS_20201206', 'EVENTS_20201210', 'EVENTS_20201216', 'EVENTS_20201218', 'EVENTS_20201224', 'EVENTS_20201227', 'EVENTS_20201228', 'EVENTS_20210118', 'EVENTS_20210130', 'EVENTS_20201214', 'EVENTS_20201215', 'EVENTS_20201222', 'EVENTS_20201231', 'EVENTS_20210109', 'EVENTS_20210115', 'EVENTS_20210116', 'EVENTS_20210105', 'EVENTS_20210119', 'EVENTS_20210120', 'EVENTS_20201118', 'EVENTS_20201219', 'EVENTS_20210127', 'EVENTS_20210106', 'EVENTS_20210108', 'EVENTS_20210124', 'EVENTS_20201106', 'EVENTS_20201110', 'EVENTS_20201117', 'EVENTS_20201121', 'EVENTS_20201125', 'EVENTS_20201201', 'EVENTS_20201213', 'EVENTS_20201217', 'EVENTS_20201226', 'EVENTS_20210121', 'EVENTS_20201124', 'EVENTS_20201126', 'EVENTS_20201127', 'EVENTS_20201230', 'EVENTS_20210110', 'EVENTS_20210112', 'EVENTS_20210129', 'EVENTS_20201205', 'EVENTS_20201221', 'EVENTS_20210125', 'EVENTS_20201102', 'EVENTS_20201107', 'EVENTS_20201109', 'EVENTS_20201111', 'EVENTS_20201112', 'EVENTS_20201113', 'EVENTS_20201120', 'EVENTS_20201122', 'EVENTS_20201225', 'EVENTS_20210102', 'EVENTS_20201123', 'EVENTS_20201129', 'EVENTS_20201209', 'EVENTS_20210101', 'EVENTS_20210111', 'EVENTS_20210117', 'EVENTS_20210128', 'EVENTS_20210131', 'EVENTS_20201130', 'EVENTS_20201229', 'EVENTS_20210104', 'EVENTS_20210113']
External knowledge that might be helpful: 
# GA4 - BigQuery Export schema

This article explains the format and schema of the Google Analytics 4 property data and the Google Analytics for Firebase data that is exported to BigQuery.

## Datasets

For each Google Analytics 4 property and each Firebase project that is linked to BigQuery, a single dataset named "analytics_<property_id>" is added to your BigQuery project. Property ID refers to your Analytics Property ID, which you can find in the property settings for your Google Analytics 4 property, and in App Analytics Settings in Firebase. Each Google Analytics 4 property and each app for which BigQuery exporting is enabled will export its data to that single dataset.

## Tables

Within each dataset, a table named `events_YYYYMMDD` is created each day if the Daily export option is enabled.

If the Streaming export option is enabled, a table named`events_intraday_YYYYMMDD`is created. This table is populated continuously as events are recorded throughout the day. This table is deleted at the end of each day once `events_YYYYMMDD` is complete.

Not all devices on which events are triggered send their data to Analytics on the same day the events are triggered. To account for this latency, Analytics will update the daily tables (`events_YYYYMMDD`) with events for those dates for up to three days after the dates of the events. Events will have the correct time stamp regardless of arriving late. Events that arrive after that three-day window are not recorded.

## Columns

Each column in the `events_YYYYMMDD`table represents an event-specific parameter. Note that some parameters are nested within RECORDS, and some RECORDS such as
`[items](https://support.google.com/analytics/answer/7029846?hl=en&ref_topic=9359001&sjid=16041154979191290935-EU#items)`
and
`[event_params](https://support.google.com/analytics/answer/7029846?hl=en&ref_topic=9359001&sjid=16041154979191290935-EU#event_params)`
are repeatable. Table columns are described below.

### event

The event fields contain information that uniquely identifies an event.

| Field name | Data type | Description |
|---|---|---|
| batch_event_index | INTEGER | A number indicating the sequential order of each event within a batch based on their order of occurrence on the device. |
| batch_ordering_id | INTEGER | A monotonically increasing number that is incremented each time a network request is sent from a given page. |
| batch_page_id | INTEGER | A sequential number assigned to a page that increases for each subsequent page within an engagement. |
| event_date | STRING | The date when the event was logged (YYYYMMDD format in the registered timezone of your app). |
| event_timestamp | INTEGER | The time (in microseconds, UTC) when the event was logged on the client. |
| event_previous_timestamp | INTEGER | The time (in microseconds, UTC) when the event was previously logged on the client. |
| event_name | STRING | The name of the event. |
| event_value_in_usd | FLOAT | The currency-converted value (in USD) of the event's "value" parameter. |
| event_bundle_sequence_id | INTEGER | The sequential ID of the bundle in which these events were uploaded. |
| event_server_timestamp_offset | INTEGER | Timestamp offset between collection time and upload time in micros. |

#### event_params RECORD

The event_params RECORD can store campaign-level and contextual event parameters as well as any user-defined event parameters. The event_params RECORD is repeated for each key that is associated with an event. The set of parameters stored in the event_params RECORD is unique to each implementation. To see the complete list of event parameters for your implementation, query the event parameter list.

| Field name | Data type | Description |
|---|---|---|
| event_params.key | STRING | The name of the event parameter. |
| event_params.value | RECORD | A record containing the event parameter's value. |
| event_params.value.string_value | STRING | If the event parameter is represented by a string, such as a URL or campaign name, it is populated in this field. |
| event_params.value.int_value | INTEGER | If the event parameter is represented by an integer, it is populated in this field. |
| event_params.value.double_value | FLOAT | If the event parameter is represented by a double value, it is populated in this field. |
| event_params.value.float_value | FLOAT | If the event parameter is represented by a floating point value, it is populated in this field. This field is not currently in use. |

#### item_params RECORD

The item_params RECORD can store item parameters as well as any user-defined item parameters. The set of parameters stored in the item_params RECORD is unique to each implementation.

| Field name | Data type | Description |
|---|---|---|
| item_params.key | STRING | The name of the item parameter. |
| item_params.value | RECORD | A record containing the item parameters value. |
| item_params.value.string_value | STRING | If the item parameter is represented by a string, it is populated in this field. |
| item_params.value.int_value | INTEGER | If the item parameter is represented by an integer, it is populated in this field. |
| item_params.value.double_value | FLOAT | If the item parameter is represented by a double value, it is populated in this field. |
| item_params.value.float_value | FLOAT | If the item parameter is represented by a floating point value, it is populated in this field. | 

### user

The user fields contain information that uniquely identifies the user associated with the event.

| Field name | Data type | Description |
|---|---|---|
| is_active_user | BOOLEAN | Whether the user was active (True) or inactive (False) at any point in the calendar day Included in only the daily tables ( events_YYYYMMDD) . |
| user_id | STRING | The unique ID assigned to a user. |
| user_pseudo_id | STRING | The pseudonymous id (e.g., app instance ID) for the user. |
| user_first_touch_timestamp | INTEGER | The time (in microseconds) at which the user first opened the app or visited the site. |

#### privacy_info fields

The privacy_info fields contain information based on the consent status of a user when consent mode is enabled .

| Field name | Data type | Description |
|---|---|---|
| privacy_info.ads_storage | STRING | Whether ad targeting is enabled for a user. Possible values: Yes, No, Unset |
| privacy_info.analytics_storage | STRING | Whether Analytics storage is enabled for the user. Possible values: Yes, No, Unset |
| privacy_info.uses_transient_token | STRING | Whether a web user has denied Analytics storage and the developer has enabled measurement without cookies based on transient tokens in server data. Possible values: Yes, No, Unset |

#### user_properties RECORD

The user_properties RECORD contains any user properties that you have set. It is repeated for each key that is associated with a user.

| Field name | Data type | Description |
|---|---|---|
| user_properties.key | STRING | The name of the user property. |
| user_properties.value | RECORD | A record for the user property value. |
| user_properties.value.string_value | STRING | The string value of the user property. |
| user_properties.value.int_value | INTEGER | The integer value of the user property. |
| user_properties.value.double_value | FLOAT | The double value of the user property. |
| user_properties.value.float_value | FLOAT | This field is currently unused. |
| user_properties.value.set_timestamp_micros | INTEGER | The time (in microseconds) at which the user property was last set. |

#### user_ltv RECORD

The user_ltv RECORD contains Lifetime Value information about the user. This RECORD is not populated in intraday tables.

| Field name | Data type | Description |
|---|---|---|
| user_ltv.revenue | FLOAT | The Lifetime Value (revenue) of the user. This field is not populated in intraday tables. |
| user_ltv.currency | STRING | The Lifetime Value (currency) of the user. This field is not populated in intraday tables. | 

### device

The device RECORD contains information about the device from which the event originated.

| Field name | Data type | Description |
|---|---|---|
| device.category | STRING | The device category (mobile, tablet, desktop). |
| device.mobile_brand_name | STRING | The device brand name. |
| device.mobile_model_name | STRING | The device model name. |
| device.mobile_marketing_name | STRING | The device marketing name. |
| device.mobile_os_hardware_model | STRING | The device model information retrieved directly from the operating system. |
| device.operating_system | STRING | The operating system of the device. |
| device.operating_system_version | STRING | The OS version. |
| device.vendor_id | STRING | IDFV (present only if IDFA is not collected). |
| device.advertising_id | STRING | Advertising ID/IDFA. |
| device.language | STRING | The OS language. |
| device.time_zone_offset_seconds | INTEGER | The offset from GMT in seconds. |
| device.is_limited_ad_tracking | BOOLEAN | The device's Limit Ad Tracking setting. On iOS14+, returns false if the IDFA is non-zero. |
| device.web_info.browser | STRING | The browser in which the user viewed content. |
| device.web_info.browser_version | STRING | The version of the browser in which the user viewed content. |
| device.web_info.hostname | STRING | The hostname associated with the logged event. | 

### geo

The geo RECORD contains information about the geographic location where the event was initiated.

| Field name | Data type | Description |
|---|---|---|
| geo.continent | STRING | The continent from which events were reported, based on IP address. |
| geo.sub_continent | STRING | The subcontinent from which events were reported, based on IP address. |
| geo.country | STRING | The country from which events were reported, based on IP address. |
| geo.region | STRING | The region from which events were reported, based on IP address. |
| geo.metro | STRING | The metro from which events were reported, based on IP address. |
| geo.city | STRING | The city from which events were reported, based on IP address. | 

### app_info

The app_info RECORD contains information about the app in which the event was initiated. | Field name | Data type | Description |
|---|---|---|
| app_info.id | STRING | The package name or bundle ID of the app. |
| app_info.firebase_app_id | STRING | The Firebase App ID associated with the app |
| app_info.install_source | STRING | The store that installed the app. |
| app_info.version | STRING | The app's versionName (Android) or short bundle version. | 

### collected_traffic_source

The collected_traffic_source RECORD contains the traffic source data that was collected with the event.

| Field name | Data type | Description |
|---|---|---|
| manual_campaign_id | STRING | The manual campaign id (utm_id) that was collected with the event. |
| manual_campaign_name | STRING | The manual campaign name (utm_campaign) that was collected with the event. |
| manual_source | STRING | The manual campaign source (utm_source) that was collected with the event. Also includes parsed parameters from referral params, not just UTM values. |
| manual_medium | STRING | The manual campaign medium (utm_medium) that was collected with the event. Also includes parsed parameters from referral params, not just UTM values. |
| manual_term | STRING | The manual campaign keyword/term (utm_term) that was collected with the event. |
| manual_content | STRING | The additional manual campaign metadata (utm_content) that was collected with the event. |
| manual_creative_format | STRING | The manual campaign creative format (utm_creative_format) that was collected with the event. |
| manual_marketing_tactic | STRING | The manual campaign marketing tactic (utm_marketing_tactic) that was collected with the event. |
| manual_source_platform | STRING | The manual campaign source platform (utm_source_platform) that was collected with the event. |
| gclid | STRING | The Google click identifier that was collected with the event. |
| dclid | STRING | The DoubleClick Click Identifier for Display and Video 360 and Campaign Manager 360 that was collected with the event. |
| srsltid | STRING | The Google Merchant Center identifier that was collected with the event. | 

### session_traffic_source_last_click

The session_traffic_source_last_click RECORD contains the last-click attributed session traffic source data across Google ads and manual contexts, where available.

| Field Name | Data Type | Description |
|---|---|---|
| session_traffic_source_last_click. manual_campaign.campaign_id | STRING | The ID of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.campaign_name | STRING | The name of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.medium | STRING | The medium of the last clicked manual campaign (e.g., paid search, organic search, email) |
| session_traffic_source_last_click. manual_campaign.term | STRING | The keyword/search term of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.content | STRING | Additional metadata of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.source_platform | STRING | The platform of the last clicked manual campaign (e.g., search engine, social media) |
| session_traffic_source_last_click. manual_campaign.source | STRING | The specific source within the platform of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.creative_format | STRING | The format of the creative of the last clicked manual campaign |
| session_traffic_source_last_click. manual_campaign.marketing_tactic | STRING | The marketing tactic of the last clicked manual campaign |
| session_traffic_source_last_click. google_ads_campaign.customer_id | STRING | The customer ID associated with the Google Ads account |
| session_traffic_source_last_click. google_ads_campaign.account_name | STRING | The name of the Google Ads account |
| session_traffic_source_last_click. google_ads_campaign.campaign_id | STRING | The ID of the Google Ads campaign |
| session_traffic_source_last_click. google_ads_campaign.campaign_name | STRING | The name of the Google Ads campaign |
| session_traffic_source_last_click. google_ads_campaign.ad_group_id | STRING | The ID of the ad group within the Google Ads campaign |
| session_traffic_source_last_click. google_ads_campaign.ad_group_name | STRING | The name of the ad group within the Google Ads campaign | 

### traffic_source

The traffic_source RECORD contains information about the traffic source that first acquired the user. This record is not populated in intraday tables. Note: The traffic_source values do not change if the user interacts with subsequent campaigns after installation.

| Field name | Data type | Description |
|---|---|---|
| traffic_source.name | STRING | Name of the marketing campaign that first acquired the user. This field is not populated in intraday tables. |
| traffic_source.medium | STRING | Name of the medium (paid search, organic search, email, etc.) that first acquired the user. This field is not populated in intraday tables. |
| traffic_source.source | STRING | Name of the network that first acquired the user. This field is not populated in intraday tables. | 

### stream and platform

The stream and platform fields contain information about the stream and the app platform.

| Field name | Data type | Description |
|---|---|---|
| stream_id | STRING | The numeric ID of the data stream from which the event originated. |
| platform | STRING | The data stream platform (Web, IOS or Android) from which the event originated. | 

### ecommerce

This ecommerce RECORD contains information about any ecommerce events that have been setup on a website or app.

| Field name | Data type | Description |
|---|---|---|
| ecommerce.total_item_quantity | INTEGER | Total number of items in this event, which is the sum of items.quantity. |
| ecommerce.purchase_revenue_in_usd | FLOAT | Purchase revenue of this event, represented in USD with standard unit. Populated for purchase event only. |
| ecommerce.purchase_revenue | FLOAT | Purchase revenue of this event, represented in local currency with standard unit. Populated for purchase event only. |
| ecommerce.refund_value_in_usd | FLOAT | The amount of refund in this event, represented in USD with standard unit. Populated for refund event only. |
| ecommerce.refund_value | FLOAT | The amount of refund in this event, represented in local currency with standard unit. Populated for refund event only. |
| ecommerce.shipping_value_in_usd | FLOAT | The shipping cost in this event, represented in USD with standard unit. |
| ecommerce.shipping_value | FLOAT | The shipping cost in this event, represented in local currency. |
| ecommerce.tax_value_in_usd | FLOAT | The tax value in this event, represented in USD with standard unit. |
| ecommerce.tax_value | FLOAT | The tax value in this event, represented in local currency with standard unit. |
| ecommerce.transaction_id | STRING | The transaction ID of the ecommerce transaction. |
| ecommerce.unique_items | INTEGER | The number of unique items in this event, based on item_id, item_name, and item_brand. | 

### items

The items RECORD contains information about items included in an event. It is repeated for each item.

| Field name | Data type | Description |
|---|---|---|
| items.item_id | STRING | The ID of the item. |
| items.item_name | STRING | The name of the item. |
| items.item_brand | STRING | The brand of the item. |
| items.item_variant | STRING | The variant of the item. |
| items.item_category | STRING | The category of the item. |
| items.item_category2 | STRING | The sub category of the item. |
| items.item_category3 | STRING | The sub category of the item. |
| items.item_category4 | STRING | The sub category of the item. |
| items.item_category5 | STRING | The sub category of the item. |
| items.price_in_usd | FLOAT | The price of the item, in USD with standard unit. |
| items.price | FLOAT | The price of the item in local currency. |
| items.quantity | INTEGER | The quantity of the item. Quantity set to 1 if not specified. |
| items.item_revenue_in_usd | FLOAT | The revenue of this item, calculated as price_in_usd * quantity. It is populated for purchase events only, in USD with standard unit. |
| items.item_revenue | FLOAT | The revenue of this item, calculated as price * quantity. It is populated for purchase events only, in local currency with standard unit. |
| items.item_refund_in_usd | FLOAT | The refund value of this item, calculated as price_in_usd * quantity. It is populated for refund events only, in USD with standard unit. |
| items.item_refund | FLOAT | The refund value of this item, calculated as price * quantity. It is populated for refund events only, in local currency with standard unit. |
| items.coupon | STRING | Coupon code applied to this item. |
| items.affiliation | STRING | A product affiliation to designate a supplying company or brick and mortar store location. |
| items.location_id | STRING | The location associated with the item. |
| items.item_list_id | STRING | The ID of the list in which the item was presented to the user. |
| items.item_list_name | STRING | The name of the list in which the item was presented to the user. |
| Items.item_list_index | STRING | The position of the item in a list. |
| items.promotion_id | STRING | The ID of a product promotion. |
| items.promotion_name | STRING | The name of a product promotion. |
| items.creative_name | STRING | The name of a creative used in a promotional spot. |
| items.creative_slot | STRING | The name of a creative slot. |

#### item_params RECORD

The item_params RECORD stores the custom item parameters that you defined. Note that predefined item parameters like item_id, item_name etc, are not included here, instead they are exported as explicit fields. The set of parameters stored in the item_params RECORD is unique to each implementation. To learn more about ecommerce implementations and the Google Analytics 4 items array, see Measure ecommerce .

| Field name | Data type | Description |
|---|---|---|
| items.item_params.key | STRING | The name of the item parameter. |
| items.item_params.value | RECORD | A record containing the item parameters value. |
| items.item_params.value.string_value | STRING | If the item parameter is represented by a string, it is populated in this field. |
| items.item_params.value.int_value | INTEGER | If the item parameter is represented by an integer, it is populated in this field. |
| items.item_params.value.double_value | FLOAT | If the item parameter is represented by a double value, it is populated in this field. |
| items.item_params.value.float_value | FLOAT | If the item parameter is represented by a floating point value, it is populated in this field. | 

## Rows

Data for a single event may be represented in one or multiple rows, depending on whether it contains repeated RECORDS. A `page_view` event with multiple
`[event_params](https://support.google.com/analytics/answer/7029846?hl=en&ref_topic=9359001&sjid=16041154979191290935-EU#event_params)`,
for example, would look similar to the following table. The initial row contains the event name, date, timestamp and other non-repeated data items. The
`[event_params](https://support.google.com/analytics/answer/7029846?hl=en&ref_topic=9359001&sjid=16041154979191290935-EU#event_params)`
RECORD is repeated for each parameter associated with the event. These repeated RECORDS are populated in subsequent rows directly under the initial event row.

| event_date | event_timestamp | event_name | event_params.key | event_params_value.string_value |
|---|---|---|---|---|
| 20220222 | 1643673600483790 | page_view | page_location | https://example.com |
| - | - | - | page_title | Home |
| - | - | - | medium | referral |
| - | - | - | source | google |
| - | - | - | page_referrer | https://www.google.com |
| - | - | - | parameters... | values... |
The table structure information is ({database name: {schema name: {table name}}}): 
{'GA4': {'GA4_OBFUSCATED_SAMPLE_ECOMMERCE': ['EVENTS_20201101', 'EVENTS_20201102', 'EVENTS_20201103', 'EVENTS_20201104', 'EVENTS_20201105', 'EVENTS_20201106', 'EVENTS_20201107', 'EVENTS_20201108', 'EVENTS_20201109', 'EVENTS_20201110', 'EVENTS_20201111', 'EVENTS_20201112', 'EVENTS_20201113', 'EVENTS_20201114', 'EVENTS_20201115', 'EVENTS_20201116', 'EVENTS_20201117', 'EVENTS_20201118', 'EVENTS_20201119', 'EVENTS_20201120', 'EVENTS_20201121', 'EVENTS_20201122', 'EVENTS_20201123', 'EVENTS_20201124', 'EVENTS_20201125', 'EVENTS_20201126', 'EVENTS_20201127', 'EVENTS_20201128', 'EVENTS_20201129', 'EVENTS_20201130', 'EVENTS_20201201', 'EVENTS_20201202', 'EVENTS_20201203', 'EVENTS_20201204', 'EVENTS_20201205', 'EVENTS_20201206', 'EVENTS_20201207', 'EVENTS_20201208', 'EVENTS_20201209', 'EVENTS_20201210', 'EVENTS_20201211', 'EVENTS_20201212', 'EVENTS_20201213', 'EVENTS_20201214', 'EVENTS_20201215', 'EVENTS_20201216', 'EVENTS_20201217', 'EVENTS_20201218', 'EVENTS_20201219', 'EVENTS_20201220', 'EVENTS_20201221', 'EVENTS_20201222', 'EVENTS_20201223', 'EVENTS_20201224', 'EVENTS_20201225', 'EVENTS_20201226', 'EVENTS_20201227', 'EVENTS_20201228', 'EVENTS_20201229', 'EVENTS_20201230', 'EVENTS_20201231', 'EVENTS_20210101', 'EVENTS_20210102', 'EVENTS_20210103', 'EVENTS_20210104', 'EVENTS_20210105', 'EVENTS_20210106', 'EVENTS_20210107', 'EVENTS_20210108', 'EVENTS_20210109', 'EVENTS_20210110', 'EVENTS_20210111', 'EVENTS_20210112', 'EVENTS_20210113', 'EVENTS_20210114', 'EVENTS_20210115', 'EVENTS_20210116', 'EVENTS_20210117', 'EVENTS_20210118', 'EVENTS_20210119', 'EVENTS_20210120', 'EVENTS_20210121', 'EVENTS_20210122', 'EVENTS_20210123', 'EVENTS_20210124', 'EVENTS_20210125', 'EVENTS_20210126', 'EVENTS_20210127', 'EVENTS_20210128', 'EVENTS_20210129', 'EVENTS_20210130', 'EVENTS_20210131']}}
Begin Exploring Related Columns
**Relevant Tables and Columns:**

- **Tables:**
  - `GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"` to `GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"`: To identify active pseudo users in the last 7 days.
  - `GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"` and `GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"`: To identify inactive pseudo users in the last 2 days.

- **Columns and Potential Usage:**
  - `"USER_PSEUDO_ID"`: Identifies unique pseudo users.
  - `"EVENT_DATE"`: Used to filter events by date.
  - `"EVENT_TIMESTAMP"`: May be used for more precise time filtering.
  - `"EVENT_NAME"`: To filter specific events if necessary.

- **Conditions that May Be Used:**
  - Date ranges to filter events within specific periods.
  - `DISTINCT` to find unique pseudo users.
  - Excluding pseudo users active in the last 2 days from those active in the last 7 days.

---

**SQL Queries:**

1. **Retrieve unique pseudo users active on January 1, 2021:**

   ```sql
   SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
   LIMIT 100;
   ```

2. **Retrieve unique pseudo users active between January 1 and January 7, 2021:**

   ```sql
   SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
   UNION
   SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
   UNION
   SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
   UNION
   SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
   UNION
   SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
   UNION
   SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
   UNION
   SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
   LIMIT 100;
   ```

3. **Retrieve unique pseudo users active on January 6, 2021:**

   ```sql
   SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
   LIMIT 100;
   ```

4. **Retrieve unique pseudo users active on January 7, 2021:**

   ```sql
   SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
   LIMIT 100;
   ```

5. **Inspect the structure of the "EVENT_PARAMS" column:**

   ```sql
   SELECT f.value
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101" t,
   LATERAL FLATTEN(input => t."EVENT_PARAMS") f
   LIMIT 100;
   ```

6. **Extract keys and values from "EVENT_PARAMS":**

   ```sql
   SELECT f.value:"key"::STRING AS "PARAM_KEY",
          f.value:"value" AS "PARAM_VALUE"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101" t,
   LATERAL FLATTEN(input => t."EVENT_PARAMS") f
   LIMIT 100;
   ```

7. **Retrieve event names recorded between January 1 and January 7, 2021:**

   ```sql
   SELECT DISTINCT "EVENT_NAME"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
   UNION
   SELECT DISTINCT "EVENT_NAME"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
   UNION
   SELECT DISTINCT "EVENT_NAME"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
   UNION
   SELECT DISTINCT "EVENT_NAME"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
   UNION
   SELECT DISTINCT "EVENT_NAME"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
   UNION
   SELECT DISTINCT "EVENT_NAME"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
   UNION
   SELECT DISTINCT "EVENT_NAME"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
   LIMIT 100;
   ```

8. **Retrieve event counts per pseudo user on January 1, 2021:**

   ```sql
   SELECT "USER_PSEUDO_ID", COUNT(*) AS "EVENT_COUNT"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
   GROUP BY "USER_PSEUDO_ID"
   ORDER BY "EVENT_COUNT" DESC
   LIMIT 100;
   ```

9. **Inspect the "USER_PROPERTIES" column:**

   ```sql
   SELECT f.value
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101" t,
   LATERAL FLATTEN(input => t."USER_PROPERTIES") f
   LIMIT 100;
   ```

10. **Extract keys and values from "USER_PROPERTIES":**

    ```sql
    SELECT f.value:"key"::STRING AS "PROPERTY_KEY",
           f.value:"value" AS "PROPERTY_VALUE"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101" t,
    LATERAL FLATTEN(input => t."USER_PROPERTIES") f
    LIMIT 100;
    ```

11. **Retrieve distinct event dates from the January 1, 2021, table:**

    ```sql
    SELECT DISTINCT "EVENT_DATE"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
    LIMIT 100;
    ```

12. **Find the latest event timestamp per pseudo user on January 1, 2021:**

    ```sql
    SELECT "USER_PSEUDO_ID", MAX("EVENT_TIMESTAMP") AS "LAST_EVENT_TIMESTAMP"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
    GROUP BY "USER_PSEUDO_ID"
    LIMIT 100;
    ```

13. **Retrieve pseudo users who started sessions on January 1, 2021:**

    ```sql
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
    WHERE "EVENT_NAME" = 'session_start'
    LIMIT 100;
    ```

14. **Inspect the "ITEMS" column by flattening it:**

    ```sql
    SELECT f.value
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101" t,
    LATERAL FLATTEN(input => t."ITEMS") f
    LIMIT 100;
    ```

15. **Retrieve pseudo users who performed an 'add_to_cart' event on January 1, 2021:**

    ```sql
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
    WHERE "EVENT_NAME" = 'add_to_cart'
    LIMIT 100;
    ```

16. **Check event counts per day between January 1 and January 7, 2021:**

    ```sql
    SELECT "EVENT_DATE", COUNT(*) AS "EVENT_COUNT"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
    GROUP BY "EVENT_DATE"
    UNION ALL
    SELECT "EVENT_DATE", COUNT(*) AS "EVENT_COUNT"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
    GROUP BY "EVENT_DATE"
    UNION ALL
    SELECT "EVENT_DATE", COUNT(*) AS "EVENT_COUNT"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
    GROUP BY "EVENT_DATE"
    UNION ALL
    SELECT "EVENT_DATE", COUNT(*) AS "EVENT_COUNT"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
    GROUP BY "EVENT_DATE"
    UNION ALL
    SELECT "EVENT_DATE", COUNT(*) AS "EVENT_COUNT"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
    GROUP BY "EVENT_DATE"
    UNION ALL
    SELECT "EVENT_DATE", COUNT(*) AS "EVENT_COUNT"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
    GROUP BY "EVENT_DATE"
    UNION ALL
    SELECT "EVENT_DATE", COUNT(*) AS "EVENT_COUNT"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
    GROUP BY "EVENT_DATE"
    LIMIT 100;
    ```

17. **Retrieve pseudo users who made a purchase event on January 1, 2021:**

    ```sql
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
    WHERE "EVENT_NAME" ILIKE '%purchase%'
    LIMIT 100;
    ```

18. **Find pseudo users active in the last 7 days but not in the last 2 days (partial step):**

    ```sql
    -- Retrieve pseudo users active from January 1 to January 5, 2021
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
    UNION
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
    UNION
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
    UNION
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
    UNION
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
    LIMIT 100;
    ```

19. **Inspect event parameters for 'page_view' events:**

    ```sql
    SELECT f.value
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101" t,
    LATERAL FLATTEN(input => t."EVENT_PARAMS") f
    WHERE t."EVENT_NAME" = 'page_view'
    LIMIT 100;
    ```

20. **Check the distribution of events by hour on January 1, 2021:**

    ```sql
    SELECT DATE_PART(hour, TO_TIMESTAMP("EVENT_TIMESTAMP" / 1000000)) AS "HOUR",
           COUNT(*) AS "EVENT_COUNT"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
    GROUP BY "HOUR"
    ORDER BY "HOUR"
    LIMIT 100;
    ```

These queries explore various aspects of the data, such as unique users, event counts, and the contents of nested columns. They help in understanding the dataset's structure and content, which is essential before performing more complex analyses related to user activity over specific periods.Query:
SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
   LIMIT 100;
Answer:
USER_PSEUDO_ID
1003046.9452926974
1023282.4639847710
1026043.4481623879
1026409.1551860912
1032138.1796039159
1037928.9294661675
1045950.7099606829
1051288.9523352374
1066655.6240997015
1080064.0071613184
1082746.7285674512
1097358.9593491100
1104313.9641823605
1112823.8475775772
1116587.1725520171
1127824.3503063268
1107198.5152483918
1134825.6533092350
1164648.0319944302
1168297.2853699605
1170405.4925804370
1178889.6850461952
1205590.2516186397
1218586.5350251990
1246063.3665874179
1259302.9069938124
1296701.2382814729
1269423.6724500672
1277765.6068129494
1308776.9803994658
1318624.9067804638
1320187.6719997668
1375005.2583322863
1382535.7283137323
1401649.9529464111
1422161.0871788362
1437260.5988606411
1448835.0934102497
1499810.5142637849
1543004.7243225422
1582390.8206269591
1674937.2501954408
1693134.9790437518
1707918.4797422153
1820733.6464417466
1912537.7440240268
1961265.4757052307
2019465.0056495205
2157133.5876722467
2329161.7120010083
2340587.9439563847
2411763.0850272555
2432374.8482039518
2501661.0331987453
2687473.9692412289
1677450.9117017807
2007867.8957787066
2304235.4728947355
2327547.5435328629
2417078.3361324500
1054372.6755770068
1064574.6224708641
1138692.0103796281
1160488.2375923167
1174066.6437027818
1188134.8498680538
1213932.4846099850
1215465.1474478000
1255322.2973246181
1211099.8247563235
1275797.1936238018
1326289.2331853598
1333091.0887566663
1352892.5937639189
1385112.5897617274
1396456.6482506733
1453555.6810069410
1453951.1387928223
1473136.1149103090
1501018.3808301483
1518831.1475327211
1539940.5253610440
1564015.6880680172
1616136.8949543878
1684301.4109152707
1713530.3382800695
1719564.6333875501
1734528.1974041204
1762263.6990880514
1784794.0627143380
1829763.3860332334
1884090.9722372635
1958116.3750166429
1967725.7354072666
1993768.0582544668
2077981.6202330137
2194957.7885097322
2228172.7936687802
2244553.9738621373
2247846.3358362547
Query:
SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
   UNION
   SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
   UNION
   SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
   UNION
   SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
   UNION
   SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
   UNION
   SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
   UNION
   SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
   LIMIT 100;
Answer:
USER_PSEUDO_ID
1003046.9452926974
1023282.4639847710
1026043.4481623879
1026409.1551860912
1032138.1796039159
1037928.9294661675
1045950.7099606829
1051288.9523352374
1066655.6240997015
1080064.0071613184
1082746.7285674512
1097358.9593491100
1104313.9641823605
1112823.8475775772
1127824.3503063268
1107198.5152483918
1168297.2853699605
1178889.6850461952
1205590.2516186397
1277765.6068129494
1308776.9803994658
1318624.9067804638
1320187.6719997668
1422161.0871788362
1437260.5988606411
1499810.5142637849
1582390.8206269591
1693134.9790437518
1707918.4797422153
1912537.7440240268
2157133.5876722467
2411763.0850272555
2501661.0331987453
2304235.4728947355
2754697.4847843626
1160488.2375923167
1174066.6437027818
1326289.2331853598
1473136.1149103090
1684301.4109152707
1884090.9722372635
1745171.2191701968
2091407.8804833129
1259302.9069938124
1543004.7243225422
1677450.9117017807
1213932.4846099850
1396456.6482506733
2077981.6202330137
2378480.6534474606
2492721.1881800375
2589245.5979068367
2560700.2802998477
3909413.6458295238
1759212.2216007988
2268837.3082004933
2344300.8375944627
3195953.1676635966
1352892.5937639189
3149868.5539413842
3158627.0434170250
3728034.7421262430
3896620.4310661501
7416334.3056558010
1134825.6533092350
1170405.4925804370
1218586.5350251990
1296701.2382814729
1375005.2583322863
2019465.0056495205
2916336.4829526738
1064574.6224708641
1539940.5253610440
2362829.7919429820
2275476.3701234224
2767600.1190297171
2795133.4288865632
2844832.0483599899
3067110.2430706696
3849458.8298476645
2167343.6164963557
2912682.3106786643
3443159.5753502239
4660834.1784425237
1116587.1725520171
1164648.0319944302
1401649.9529464111
1448835.0934102497
1674937.2501954408
1820733.6464417466
1961265.4757052307
2340587.9439563847
2687473.9692412289
2007867.8957787066
2327547.5435328629
4132154.7009329565
4233290.6269558513
1138692.0103796281
1255322.2973246181
1211099.8247563235
Query:
SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
   LIMIT 100;
Answer:
USER_PSEUDO_ID
1001303.4827739208
1014060.1100191558
1015239.8458513676
1023213.5350684501
1025773.0920505617
1033020.5841925327
1042140.6802444773
1045720.9269650087
1049106.9990499157
1049739.7909391395
1065322.6541302193
1072513.2161702512
1075240.7394043586
1075333.9269112947
1078788.8328338285
1081165.5314971225
1087271.0550084610
1095740.4839642689
1114964.3576383224
1118833.2974558782
1126378.6956818362
1069165.2811408476
1083792.6034832516
1086843.9052907013
1128261.6033595713
1128289.3662024583
1133313.1103337373
1144792.8191246270
1146837.4730107711
1151687.1996189042
1153093.0119048067
1163998.9977514528
1170673.0496256889
1173439.7311015929
1180762.6954492448
1214408.9886831537
1216128.7020381390
1243180.2889994882
1257670.9852008771
1218031.2772164166
1255130.2864074728
1278990.5126400811
1280885.4587684428
1304296.6040710271
1311409.7691253264
1324330.4963761152
1326729.2901375460
1328537.2795814770
1357835.0893556888
1369631.9406198523
1408865.7005954025
1442352.3658130118
1474912.2146834138
1524322.6852456903
1537642.0362746652
1390300.4796021112
1069494.0113686800
1084471.2677471598
1087808.3711873816
1115377.5526866793
1060274.1098179258
1086668.0925005810
1111626.7442894456
1130911.8567954377
1141870.4386338572
1148615.3691736909
1160488.2375923167
1169456.0744217795
1185502.9456478888
1185607.4529846208
1213730.2023854144
1214882.5762650867
1224512.5360000287
1230929.5891057900
1252675.9812778248
1253621.4143036992
1256871.5825332697
1270650.6052564575
1133962.3740970739
1177018.6074439798
1211099.8247563235
1285418.4651557245
1285421.1033375628
1295893.9741062295
1304912.9788917690
1306493.1469289903
1314525.6769250991
1324723.7882312578
1325005.1519738149
1358070.7682863119
1362293.0058255347
1366045.3922534826
1372261.7721304420
1374353.8427076075
1377886.1560338090
1380305.7377133735
1383476.9026182603
1388300.4678602079
1395824.1622992884
1418623.6541339375
Query:
SELECT DISTINCT "USER_PSEUDO_ID"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
   LIMIT 100;
Answer:
USER_PSEUDO_ID
1000557.2911835023
1002616.3660015684
1008726.7423030385
1009541.6887464068
1009676.4905193951
1016428.1065641732
1020795.7432964012
1028144.2081628525
1030326.1353640844
1036021.1054561259
1043511.9901401232
1046404.1129546883
1073430.9059120582
1087808.3711873816
1099671.3398238118
1107549.5710254296
1109808.6106046131
1124540.2333393152
1019574.8776308935
1066407.3757892113
1072012.7284818935
1116865.4647068394
1132479.2425986879
1132946.8730897471
1122146.8997157148
1144754.6830399719
1149393.9441120966
1150418.5729329589
1151529.7874029554
1151687.1996189042
1168153.2069804316
1174920.8866835138
1177876.9777589683
1181141.8389731329
1194177.8166317724
1209023.5496836341
1224731.3666771048
1237924.3309856915
1246241.1259892311
1247293.4194247843
1272559.2391561764
1276927.7607362138
1366363.8080922440
1196040.9501767394
1256871.5825332697
1266942.9616912837
1275281.1401174806
1299775.3014967415
1317681.8410322222
1404246.6716592021
1425808.3063725064
1431033.2186997626
1446850.8020489502
1447620.3308368044
1459124.3307795496
1550391.0083775168
1631724.2395953902
1667250.8018262205
1750084.1602132369
1883648.1654112367
1947449.4066998823
1709858.9795411204
1056020.6709260931
1063386.3828577009
1100949.9283905733
1114216.0904812151
1098584.0776604006
1138520.5891734753
1150257.3416332583
1163998.9977514528
1166484.2621554560
1169660.2704170325
1172211.4577928962
1182923.0909175622
1195966.3969559148
1231601.8963574336
1242735.7779476738
1280885.4587684428
1291324.6496937233
1309980.6522015685
1333728.0047687977
1359026.8307338454
1362228.4966015575
1366103.4269040146
1374932.4478575733
1263510.2346903431
1283562.7271739130
1287483.1535140122
1320383.7530644264
1332979.8914503740
1342173.6511298548
1357251.3765617872
1366281.7261580221
1369023.5738995470
1378696.4627477130
1385336.9757682390
1390701.8959589858
1406007.4609789626
1406098.2272398299
1406568.6449738818
Query:
SELECT f.value
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101" t,
   LATERAL FLATTEN(input => t."EVENT_PARAMS") f
   LIMIT 100;
Answer:
Too long, hard cut:
VALUE
"{
  ""key"": ""ga_session_number"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""ga_session_id"",
  ""value"": {
    ""int_value"": 3209612510
  }
}"
"{
  ""key"": ""page_referrer"",
  ""value"": null
}"
"{
  ""key"": ""page_location"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""
  }
}"
"{
  ""key"": ""page_title"",
  ""value"": {
    ""string_value"": ""Google Dino Game Tee""
  }
}"
"{
  ""key"": ""session_engaged"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""engaged_session_event"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""page_location"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""
  }
}"
"{
  ""key"": ""entrances"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""medium"",
  ""value"": {
    ""string_value"": ""organic""
  }
}"
"{
  ""key"": ""campaign"",
  ""value"": {
    ""string_value"": ""(organic)""
  }
}"
"{
  ""key"": ""source"",
  ""value"": {
    ""string_value"": ""google""
  }
}"
"{
  ""key"": ""page_title"",
  ""value"": {
    ""string_value"": ""Google Dino Game Tee""
  }
}"
"{
  ""key"": ""engaged_session_event"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""page_referrer"",
  ""value"": null
}"
"{
  ""key"": ""term"",
  ""value"": {
    ""string_value"": ""<obfuscated>""
  }
}"
"{
  ""key"": ""session_engaged"",
  ""value"": {
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""ga_session_number"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""all_data"",
  ""value"": null
}"
"{
  ""key"": ""clean_event"",
  ""value"": {
    ""string_value"": ""gtm.js""
  }
}"
"{
  ""key"": ""debug_mode"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""ga_session_id"",
  ""value"": {
    ""int_value"": 3209612510
  }
}"
"{
  ""key"": ""ga_session_number"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""engaged_session_event"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""ga_session_id"",
  ""value"": {
    ""int_value"": 3209612510
  }
}"
"{
  ""key"": ""page_location"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""
  }
}"
"{
  ""key"": ""page_title"",
  ""value"": {
    ""string_value"": ""Google Dino Game Tee""
  }
}"
"{
  ""key"": ""page_referrer"",
  ""value"": null
}"
"{
  ""key"": ""engaged_session_event"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""ga_session_number"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""page_title"",
  ""value"": {
    ""string_value"": ""Google Dino Game Tee""
  }
}"
"{
  ""key"": ""debug_mode"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""engagement_time_msec"",
  ""value"": {
    ""int_value"": 2075
  }
}"
"{
  ""key"": ""session_engaged"",
  ""value"": {
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""page_location"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""
  }
}"
"{
  ""key"": ""ga_session_id"",
  ""value"": {
    ""int_value"": 3209612510
  }
}"
"{
  ""key"": ""page_referrer"",
  ""value"": null
}"
"{
  ""key"": ""ga_session_id"",
  ""value"": {
    ""int_value"": 3209612510
  }
}"
"{
  ""key"": ""ga_session_number"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""engagement_time_msec"",
  ""value"": {
    ""int_value"": 9
  }
}"
"{
  ""key"": ""debug_mode"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""engaged_session_event"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""page_title"",
  ""value"": {
    ""string_value"": ""Google Dino Game Tee""
  }
}"
"{
  ""key"": ""page_location"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""
  }
}"
"{
  ""key"": ""session_engaged"",
  ""value"": {
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""page_referrer"",
  ""value"": null
}"
"{
  ""key"": ""page_referrer"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/New?""
  }
}"
"{
  ""key"": ""page_location"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Campus+Collection/Google+Sunnyvale+Campus+Bottle""
  }
}"
"{
  ""key"": ""engagement_time_msec"",
  ""value"": {
    ""int_value"": 15567
  }
}"
"{
  ""key"": ""page_title"",
  ""value"": {
    ""string_value"": ""Google Sunnyvale Campus Bottle""
  }
}"
"{
  ""key"": ""session_engaged"",
  ""value"": {
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""ga_session_number"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""ga_session_id"",
  ""value"": {
    ""int_value"": 7473279052
  }
}"
"{
  ""key"": ""debug_mode"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""engaged_session_event"",
  ""
Query:
SELECT f.value:"key"::STRING AS "PARAM_KEY",
          f.value:"value" AS "PARAM_VALUE"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101" t,
   LATERAL FLATTEN(input => t."EVENT_PARAMS") f
   LIMIT 100;
Answer:
Too long, hard cut:
PARAM_KEY,PARAM_VALUE
ga_session_number,"{
  ""int_value"": 1
}"
ga_session_id,"{
  ""int_value"": 3209612510
}"
page_referrer,null
page_location,"{
  ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""
}"
page_title,"{
  ""string_value"": ""Google Dino Game Tee""
}"
session_engaged,"{
  ""int_value"": 1
}"
engaged_session_event,"{
  ""int_value"": 1
}"
page_location,"{
  ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""
}"
entrances,"{
  ""int_value"": 1
}"
medium,"{
  ""string_value"": ""organic""
}"
campaign,"{
  ""string_value"": ""(organic)""
}"
source,"{
  ""string_value"": ""google""
}"
page_title,"{
  ""string_value"": ""Google Dino Game Tee""
}"
engaged_session_event,"{
  ""int_value"": 1
}"
page_referrer,null
term,"{
  ""string_value"": ""<obfuscated>""
}"
session_engaged,"{
  ""string_value"": ""0""
}"
ga_session_number,"{
  ""int_value"": 1
}"
all_data,null
clean_event,"{
  ""string_value"": ""gtm.js""
}"
debug_mode,"{
  ""int_value"": 1
}"
ga_session_id,"{
  ""int_value"": 3209612510
}"
ga_session_number,"{
  ""int_value"": 1
}"
engaged_session_event,"{
  ""int_value"": 1
}"
ga_session_id,"{
  ""int_value"": 3209612510
}"
page_location,"{
  ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""
}"
page_title,"{
  ""string_value"": ""Google Dino Game Tee""
}"
page_referrer,null
engaged_session_event,"{
  ""int_value"": 1
}"
ga_session_number,"{
  ""int_value"": 1
}"
page_title,"{
  ""string_value"": ""Google Dino Game Tee""
}"
debug_mode,"{
  ""int_value"": 1
}"
engagement_time_msec,"{
  ""int_value"": 2075
}"
session_engaged,"{
  ""string_value"": ""1""
}"
page_location,"{
  ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""
}"
ga_session_id,"{
  ""int_value"": 3209612510
}"
page_referrer,null
ga_session_id,"{
  ""int_value"": 3209612510
}"
ga_session_number,"{
  ""int_value"": 1
}"
engagement_time_msec,"{
  ""int_value"": 9
}"
debug_mode,"{
  ""int_value"": 1
}"
engaged_session_event,"{
  ""int_value"": 1
}"
page_title,"{
  ""string_value"": ""Google Dino Game Tee""
}"
page_location,"{
  ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""
}"
session_engaged,"{
  ""string_value"": ""1""
}"
page_referrer,null
page_referrer,"{
  ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/New?""
}"
page_location,"{
  ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Campus+Collection/Google+Sunnyvale+Campus+Bottle""
}"
engagement_time_msec,"{
  ""int_value"": 15567
}"
page_title,"{
  ""string_value"": ""Google Sunnyvale Campus Bottle""
}"
session_engaged,"{
  ""string_value"": ""1""
}"
ga_session_number,"{
  ""int_value"": 1
}"
ga_session_id,"{
  ""int_value"": 7473279052
}"
debug_mode,"{
  ""int_value"": 1
}"
engaged_session_event,"{
  ""int_value"": 1
}"
percent_scrolled,"{
  ""int_value"": 90
}"
campaign,"{
  ""string_value"": ""<Other>""
}"
medium,"{
  ""string_value"": ""<Other>""
}"
session_engaged,"{
  ""string_value"": ""1""
}"
page_location,"{
  ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Lifestyle/Fun/Malibu+Sunglasses.axd""
}"
ga_session_number,"{
  ""int_value"": 1
}"
ga_session_id,"{
  ""int_value"": 7473279052
}"
debug_mode,"{
  ""int_value"": 1
}"
page_referrer,null
engagement_time_msec,"{
  ""int_value"": 21900
}"
source,"{
  ""string_value"": ""<Other>""
}"
engaged_session_event,"{
  ""int_value"": 1
}"
page_title,"{
  ""string_value"": ""The Google Merchandise Store/Malibu Sunglasses""
}"
engaged_session_event,"{
  ""int_value"": 1
}"
ga_session_id,"{
  ""int_value"": 7473279052
}"
session_engaged,"{
  ""string_value"": ""1""
}"
page_title,"{
  ""string_value"": ""Home""
}"
ga_session_number,"{
  ""int_value"": 1
}"
debug_mode,"{
  ""int_value"": 1
}"
engagement_time_msec,"{
  ""int_value"": 7
}"
page_location,"{
  ""string_value"": ""https://shop.googlemerchandisestore.com/""
}"
campaign,"{
  ""string_value"": ""<Other>""
}"
engaged_session_event,"{
  ""int_value"": 1
}"
engagement_time_msec,"{
  ""int_value"": 6603
}"
session_engaged,"{
  ""string_value"": ""1""
}"
medium,"{
  ""string_value"": ""<Other>""
}"
ga_session_id,"{
  ""int_value"": 7473279052
}"
debug_mode,"{
  ""int_value"": 1
}"
page_referrer,"{
  ""string_value"": ""https://shop.googlemerchandisestore.com/basket.html?""
}"
ga_session_number,"{
  ""int_value"": 1
}"
page_location,"{
  ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Accessories/Google+Clear+Framed+Yellow+Shades""
}"
page_title,"{
  ""string_value"": ""Google Clear Framed Yellow Shades""
}"
source,"{
  ""string_value"": ""<Other>""
}"
ga_session_number,"{
  ""int_value"": 1
}"
engagement_time_msec,"{
  ""int_value"": 2187
}"
page_referrer,"{
  ""string_value"": ""https://shop.goog
Query:
SELECT DISTINCT "EVENT_NAME"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
   UNION
   SELECT DISTINCT "EVENT_NAME"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
   UNION
   SELECT DISTINCT "EVENT_NAME"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
   UNION
   SELECT DISTINCT "EVENT_NAME"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
   UNION
   SELECT DISTINCT "EVENT_NAME"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
   UNION
   SELECT DISTINCT "EVENT_NAME"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
   UNION
   SELECT DISTINCT "EVENT_NAME"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
   LIMIT 100;
Answer:
EVENT_NAME
first_visit
page_view
session_start
user_engagement
scroll
view_item
add_shipping_info
add_payment_info
view_search_results
select_promotion
click
select_item
view_promotion
begin_checkout
purchase
add_to_cart
view_item_list
Query:
SELECT "USER_PSEUDO_ID", COUNT(*) AS "EVENT_COUNT"
   FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
   GROUP BY "USER_PSEUDO_ID"
   ORDER BY "EVENT_COUNT" DESC
   LIMIT 100;
Answer:
USER_PSEUDO_ID,EVENT_COUNT
72522849.6381089738,1011
1160488.2375923167,427
2783014.3813479767,318
5563930.3593101391,203
53550354.6354713181,180
8186100.1619066340,171
59533896.5320638489,170
68546038.8820428933,163
87047667.1042912591,149
53104811.8176614311,148
17007406.8391181695,144
72065348.6852495696,133
7515221.4303230400,126
28134106.1591086954,121
81574425.5434958788,117
6867779.6634381231,115
1188134.8498680538,114
7105959.6709528403,110
50844046.9564028621,99
74953787.0199910547,94
3354006.4211651279,90
75073588.1859607099,88
6328102986.3137432902,85
15817556.8554808751,83
10860969.8635427479,80
6101467.4740745406,80
1023282.4639847710,77
32537212.0554785312,77
76975305.9969820299,76
6801661.0213744991,76
45942478.6625384752,76
62524109.3161787418,76
1112823.8475775772,73
2885429.0157235569,68
1990491.3893000361,67
40650638.8176789956,67
6772624.5257726160,67
4626089.7083106102,66
78839661.7033676134,65
29404827.7870928470,63
2856545.1057637132,61
15047683.3025668953,57
82379049.4680589452,57
5510821.7058149595,57
4107999736.9770670225,56
53067943.8636445638,55
18097479.9566775994,53
3351786.5083077372,52
42142866.3416900702,51
6482353.8828196074,50
64527390.2197615970,50
1646722.0078157231,48
10115718.4867090359,48
5393985456.0596119848,48
38359877.5815012009,47
61687008.5702070839,47
22288916.8827658539,46
43470418.6139420304,45
81213220.7958656808,43
4124604.0408794437,43
84760862.0017504152,42
15932166.2076268855,41
43120797.5731831365,41
13167690.2693949122,40
8903783.1803413789,40
12685424.3792504835,39
83736385.8758161413,38
8813737.3153270447,38
1684301.4109152707,38
5686154.7174932299,38
16910393.5498744454,38
1566834642.5850724108,37
63655374.9348413503,37
5554878.0772348619,36
39447924.7392393021,36
73990466.9253242963,36
6351413.2459505432,35
28889932.1687420790,35
76874793.6611457255,34
16584748.2250156564,34
3001110.3208062401,33
34851780.6903374642,33
14801022.9686481759,33
48293850.3499088450,33
4647802.5572043944,33
5337490.6328314089,33
87188220.6252432191,32
11116091.7897694184,32
12177989.5566440967,32
5831980.2827657871,31
77052125.0799530822,31
1829763.3860332334,31
2779137.7674526641,31
4289529.7500442979,31
52170675.5101121559,31
9221726.8946931934,30
11369626.1068446121,30
88839956.1260646312,30
8858380583.2491355805,30
50994991.7786921042,30
Query:
SELECT COUNT(DISTINCT "USER_PSEUDO_ID") AS "Number_of_Pseudo_Users"
FROM (
    -- Users active in the last 7 days (January 1 to January 7, 2021)
    SELECT "USER_PSEUDO_ID"
    FROM (
        SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
        UNION
        SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
        UNION
        SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
        UNION
        SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
        UNION
        SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
        UNION
        SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
        UNION
        SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
    ) AS last7days
    WHERE "USER_PSEUDO_ID" NOT IN (
        -- Users active in the last 2 days (January 6 and 7, 2021)
        SELECT DISTINCT "USER_PSEUDO_ID"
        FROM (
            SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
            UNION
            SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
        )
    )
) AS result;
Answer:
Number_of_Pseudo_Users
13442
Query:
SELECT COUNT(DISTINCT last7days."USER_PSEUDO_ID") AS "Number_of_Pseudo_Users"
FROM (
    -- Users active from January 1 to January 5, 2021
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
) AS last7days
LEFT JOIN (
    -- Users active in the last 2 days (January 6 and 7, 2021)
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
) AS last2days
ON last7days."USER_PSEUDO_ID" = last2days."USER_PSEUDO_ID"
WHERE last2days."USER_PSEUDO_ID" IS NULL;
Answer:
Number_of_Pseudo_Users
13442
Query:
SELECT DISTINCT "EVENT_DATE"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
WHERE "EVENT_DATE" IS NOT NULL
LIMIT 100
Answer:
EVENT_DATE
20210101
Query:
SELECT "USER_PSEUDO_ID", MAX("EVENT_TIMESTAMP") AS "LAST_EVENT_TIMESTAMP"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
GROUP BY "USER_PSEUDO_ID"
LIMIT 100
Answer:
USER_PSEUDO_ID,LAST_EVENT_TIMESTAMP
1003046.9452926974,1609468320458554
1023282.4639847710,1609518484536210
1026043.4481623879,1609516112499719
1026409.1551860912,1609512092439022
1032138.1796039159,1609463890898989
1037928.9294661675,1609536630795770
1045950.7099606829,1609486806967750
1051288.9523352374,1609510184020907
1064574.6224708641,1609517227080600
1066655.6240997015,1609520937538856
1080064.0071613184,1609543822475931
1082746.7285674512,1609537501394824
1097358.9593491100,1609487255084735
1104313.9641823605,1609515677954027
1112823.8475775772,1609460211851305
1127824.3503063268,1609540688714136
1138692.0103796281,1609527125974168
1160488.2375923167,1609519478307490
1054372.6755770068,1609471957177721
1116587.1725520171,1609543578148128
1164648.0319944302,1609539281241418
1168297.2853699605,1609508032589826
1174066.6437027818,1609481872526551
1178889.6850461952,1609512750376960
1205590.2516186397,1609507381593819
1211099.8247563235,1609520884004282
1213932.4846099850,1609483110633501
1218586.5350251990,1609529007992038
1246063.3665874179,1609510384582537
1255322.2973246181,1609497619324582
1275797.1936238018,1609524822705447
1296701.2382814729,1609545591562483
1375005.2583322863,1609519291701096
1401649.9529464111,1609477397606058
1453951.1387928223,1609514749986299
1485472.4390061373,1609517236174073
1501018.3808301483,1609479297903773
1582390.8206269591,1609536484327607
1620024.8966870933,1609507301821257
1680043.1145812114,1609523494028844
1688147.2939632391,1609531765463950
1693134.9790437518,1609495677933394
1734528.1974041204,1609463208552274
1846974.0316175078,1609495306056327
1884090.9722372635,1609501779850680
1886250.8920156183,1609541431171439
2007362.2149327588,1609476995844969
2041235.3400307589,1609483884577498
2150276.2168438227,1609475171944849
2245992.8909040661,1609467878317255
2264573.5209212671,1609520651290650
2311908.3797713386,1609516885190561
2322051.0966144624,1609459842550905
2378480.6534474606,1609535031893808
2613632.7561400432,1609534119732155
1515646.3111272928,1609486445394916
2304235.4728947355,1609519181910818
2376646.7974930863,1609526465814202
2539661.0024435471,1609513432452757
2589245.5979068367,1609501163076544
2687473.9692412289,1609522432576845
2709449.6736747839,1609525721491020
2873742.8991614203,1609461475616880
3259639.2895579600,1609461964842838
1107198.5152483918,1609506990211110
1134825.6533092350,1609544905325971
1170405.4925804370,1609491446415397
1188134.8498680538,1609517303601428
1215465.1474478000,1609507504174418
1259302.9069938124,1609514720533888
1269423.6724500672,1609499787823322
1277765.6068129494,1609476659803391
1318624.9067804638,1609514314290554
1320187.6719997668,1609461112865699
1333091.0887566663,1609528859010236
1352892.5937639189,1609474022530051
1382535.7283137323,1609463610554556
1396456.6482506733,1609510193708003
1422161.0871788362,1609489680596864
1437260.5988606411,1609534211177552
1456890.1673716823,1609540742591402
1473136.1149103090,1609480140346213
1518831.1475327211,1609484869486115
1534689.9343310805,1609534136676260
1539940.5253610440,1609485216192787
1543004.7243225422,1609519699396488
1619900.3195973863,1609519428571764
1646722.0078157231,1609485882025254
1674937.2501954408,1609519580047997
1684301.4109152707,1609530412997652
1713530.3382800695,1609542864424131
1719564.6333875501,1609514645951076
1729803.5105688857,1609539921326577
1759212.2216007988,1609500922602626
1762263.6990880514,1609509032083576
1784794.0627143380,1609462323131983
1804199.2014328535,1609526443966314
1820733.6464417466,1609491345193666
1912537.7440240268,1609518518256358
1990491.3893000361,1609481547819704
Query:
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
WHERE "EVENT_NAME" = 'session_start'
LIMIT 100
Answer:
USER_PSEUDO_ID
1003046.9452926974
1023282.4639847710
1026043.4481623879
1026409.1551860912
1032138.1796039159
1037928.9294661675
1045950.7099606829
1051288.9523352374
1054372.6755770068
1064574.6224708641
1066655.6240997015
1080064.0071613184
1082746.7285674512
1107198.5152483918
1116587.1725520171
1127824.3503063268
1134825.6533092350
1138692.0103796281
1097358.9593491100
1164648.0319944302
1170405.4925804370
1174066.6437027818
1178889.6850461952
1188134.8498680538
1205590.2516186397
1211099.8247563235
1240786.8917310160
1269423.6724500672
1275797.1936238018
1277765.6068129494
1296701.2382814729
1259302.9069938124
1318624.9067804638
1333091.0887566663
1382535.7283137323
1422161.0871788362
1453951.1387928223
1459436.8826692932
1473136.1149103090
1501018.3808301483
1503421.5168556763
1515646.3111272928
1518831.1475327211
1534689.9343310805
1539940.5253610440
1582390.8206269591
1620024.8966870933
1646722.0078157231
1707918.4797422153
1846974.0316175078
1884090.9722372635
1961265.4757052307
2102395.6721696580
2290904.3176780756
2432374.8482039518
2709449.6736747839
1550901.3980286554
1619900.3195973863
1820733.6464417466
2165252.0147518395
2438148.3441039719
1104313.9641823605
1160488.2375923167
1168297.2853699605
1213932.4846099850
1215465.1474478000
1218586.5350251990
1255322.2973246181
1308776.9803994658
1320187.6719997668
1352892.5937639189
1375005.2583322863
1385112.5897617274
1437260.5988606411
1448835.0934102497
1485472.4390061373
1499810.5142637849
1543004.7243225422
1564015.6880680172
1575061.4789497906
1616136.8949543878
1674937.2501954408
1693134.9790437518
1713530.3382800695
1729803.5105688857
1734528.1974041204
1749246.8534368616
1804199.2014328535
1829763.3860332334
1859470.4546513665
1886250.8920156183
1990491.3893000361
2041235.3400307589
2091407.8804833129
2142722.9676010623
2167343.6164963557
2168528.2202958861
2194957.7885097322
2327547.5435328629
2376646.7974930863
Query:
SELECT f.value
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101" t,
LATERAL FLATTEN(input => t."ITEMS") f
WHERE t."ITEMS" IS NOT NULL
LIMIT 100
Answer:
Too long, hard cut:
VALUE
"{
  ""affiliation"": ""(not set)"",
  ""coupon"": ""(not set)"",
  ""creative_name"": ""(not set)"",
  ""creative_slot"": ""(not set)"",
  ""item_brand"": ""Google"",
  ""item_category"": ""Bags"",
  ""item_category2"": ""(not set)"",
  ""item_category3"": ""(not set)"",
  ""item_category4"": ""(not set)"",
  ""item_category5"": ""(not set)"",
  ""item_id"": ""9188227"",
  ""item_list_id"": ""(not set)"",
  ""item_list_index"": ""(not set)"",
  ""item_list_name"": ""Not available in demo dataset"",
  ""item_name"": ""Google Flat Front Bag Grey"",
  ""item_variant"": ""Single Option Only"",
  ""location_id"": ""(not set)"",
  ""price"": 3.000000000000000e+01,
  ""promotion_id"": ""(not set)"",
  ""promotion_name"": ""Reach New Heights"",
  ""quantity"": 1
}"
"{
  ""affiliation"": ""(not set)"",
  ""coupon"": ""(not set)"",
  ""creative_name"": ""(not set)"",
  ""creative_slot"": ""(not set)"",
  ""item_brand"": ""Google"",
  ""item_category"": ""Bags"",
  ""item_category2"": ""(not set)"",
  ""item_category3"": ""(not set)"",
  ""item_category4"": ""(not set)"",
  ""item_category5"": ""(not set)"",
  ""item_id"": ""9188227"",
  ""item_list_id"": ""(not set)"",
  ""item_list_index"": ""(not set)"",
  ""item_list_name"": ""Not available in demo dataset"",
  ""item_name"": ""Google Flat Front Bag Grey"",
  ""item_variant"": ""Single Option Only"",
  ""location_id"": ""(not set)"",
  ""price"": 3.000000000000000e+01,
  ""promotion_id"": ""(not set)"",
  ""promotion_name"": ""Reach New Heights"",
  ""quantity"": 1
}"
"{
  ""affiliation"": ""(not set)"",
  ""coupon"": ""(not set)"",
  ""creative_name"": ""(not set)"",
  ""creative_slot"": ""(not set)"",
  ""item_brand"": ""Google"",
  ""item_category"": ""Bags"",
  ""item_category2"": ""(not set)"",
  ""item_category3"": ""(not set)"",
  ""item_category4"": ""(not set)"",
  ""item_category5"": ""(not set)"",
  ""item_id"": ""9188227"",
  ""item_list_id"": ""(not set)"",
  ""item_list_index"": ""(not set)"",
  ""item_list_name"": ""Not available in demo dataset"",
  ""item_name"": ""Google Flat Front Bag Grey"",
  ""item_variant"": ""Single Option Only"",
  ""location_id"": ""(not set)"",
  ""price"": 3.000000000000000e+01,
  ""promotion_id"": ""(not set)"",
  ""promotion_name"": ""Reach New Heights"",
  ""quantity"": 1
}"
"{
  ""affiliation"": ""(not set)"",
  ""coupon"": ""(not set)"",
  ""creative_name"": ""(not set)"",
  ""creative_slot"": ""(not set)"",
  ""item_brand"": ""Google"",
  ""item_category"": ""Bags"",
  ""item_category2"": ""(not set)"",
  ""item_category3"": ""(not set)"",
  ""item_category4"": ""(not set)"",
  ""item_category5"": ""(not set)"",
  ""item_id"": ""9188227"",
  ""item_list_id"": ""(not set)"",
  ""item_list_index"": ""(not set)"",
  ""item_list_name"": ""Not available in demo dataset"",
  ""item_name"": ""Google Flat Front Bag Grey"",
  ""item_variant"": ""Single Option Only"",
  ""location_id"": ""(not set)"",
  ""price"": 3.000000000000000e+01,
  ""promotion_id"": ""(not set)"",
  ""promotion_name"": ""Reach New Heights"",
  ""quantity"": 1
}"
"{
  ""affiliation"": ""(not set)"",
  ""coupon"": ""(not set)"",
  ""creative_name"": ""(not set)"",
  ""creative_slot"": ""(not set)"",
  ""item_brand"": ""Google"",
  ""item_category"": ""Bags"",
  ""item_category2"": ""(not set)"",
  ""item_category3"": ""(not set)"",
  ""item_category4"": ""(not set)"",
  ""item_category5"": ""(not set)"",
  ""item_id"": ""9188227"",
  ""item_list_id"": ""(not set)"",
  ""item_list_index"": ""(not set)"",
  ""item_list_name"": ""Not available in demo dataset"",
  ""item_name"": ""Google Flat Front Bag Grey"",
  ""item_variant"": ""Single Option Only"",
  ""location_id"": ""(not set)"",
  ""price"": 3.000000000000000e+01,
  ""promotion_id"": ""(not set)"",
  ""promotion_name"": ""Reach New Heights"",
  ""quantity"": 1
}"
"{
  ""affiliation"": ""(not set)"",
  ""coupon"": ""(not set)"",
  ""creative_name"": ""(not set)"",
  ""creative_slot"": ""(not set)"",
  ""item_brand"": ""Google"",
  ""item_category"": ""Bags"",
  ""item_category2"": ""(not set)"",
  ""item_category3"": ""(not set)"",
  ""item_category4"": ""(not set)"",
  ""item_category5"": ""(not set)"",
  ""item_id"": ""9188227"",
  ""item_list_id"": ""(not set)"",
  ""item_list_index"": ""(not set)"",
  ""item_list_name"": ""Not available in demo dataset"",
  ""item_name"": ""Google Flat Front Bag Grey"",
  ""item_variant"": ""Single Option Only"",
  ""location_id"": ""(not set)"",
  ""price"": 3.000000000000000e+01,
  ""promotion_id"": ""(not set)"",
  ""promotion_name"": ""Reach New Heights"",
  ""quantity"": 1
}"
"{
  ""affiliation"": ""(not set)"",
  ""coupon"": ""(not set)"",
  ""creative_name"": ""(not set)"",
  ""creative_slot"": ""(not set)"",
  ""item_brand"": ""Google"",
  ""item_category"": ""Bags"",
  ""item_category2"": ""(not set)"",
  ""item_category3"": ""(not set)"",
  ""item_category4"": ""(not set)"",
  ""item_category5"": ""(not set)"",
  ""item_id"": ""9188227"",
  ""i
Query:
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
WHERE "EVENT_NAME" = 'add_to_cart'
LIMIT 100
Answer:
USER_PSEUDO_ID
5289818.5896545465
8186100.1619066340
17007406.8391181695
22570371.0320972505
2885429.0157235569
68546038.8820428933
2783014.3813479767
81213220.7958656808
8697832.7658029149
69538214.0147460457
75446459.8381341234
82379049.4680589452
1160488.2375923167
1211099.8247563235
1539940.5253610440
2486846.9299481244
1023282.4639847710
1990491.3893000361
3071789.9352232891
3354006.4211651279
4015519.0757720765
4813555.8829728696
9312196.4289187337
15817556.8554808751
22288916.8827658539
26776431.5444855772
32537212.0554785312
38359877.5815012009
42142866.3416900702
53550354.6354713181
61687008.5702070839
78839661.7033676134
88839956.1260646312
89439614.4776585611
3671634874.2560291757
62524109.3161787418
73990466.9253242963
76975305.9969820299
1188134.8498680538
2272023.1096248377
2856545.1057637132
4651894.8591529595
5337490.6328314089
5510821.7058149595
5952403.0699076194
6101467.4740745406
10860969.8635427479
15047683.3025668953
38945261.7275220036
39335113.7845260204
40650638.8176789956
41872628.9123536919
43120797.5731831365
50844046.9564028621
68049257.5560117388
14801022.9686481759
53104811.8176614311
67150059.7765111802
72522849.6381089738
28134106.1591086954
53067943.8636445638
65541226.9896109368
78966520.2065669153
81952815.1086227980
38050258.5403414260
53327798.6735383085
39447924.7392393021
Query:
SELECT "EVENT_DATE", SUM("EVENT_COUNT") AS "EVENT_COUNT"
FROM (
    SELECT "EVENT_DATE", COUNT(*) AS "EVENT_COUNT"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
    GROUP BY "EVENT_DATE"
    UNION ALL
    SELECT "EVENT_DATE", COUNT(*) AS "EVENT_COUNT"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
    GROUP BY "EVENT_DATE"
    UNION ALL
    SELECT "EVENT_DATE", COUNT(*) AS "EVENT_COUNT"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
    GROUP BY "EVENT_DATE"
    UNION ALL
    SELECT "EVENT_DATE", COUNT(*) AS "EVENT_COUNT"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
    GROUP BY "EVENT_DATE"
    UNION ALL
    SELECT "EVENT_DATE", COUNT(*) AS "EVENT_COUNT"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
    GROUP BY "EVENT_DATE"
    UNION ALL
    SELECT "EVENT_DATE", COUNT(*) AS "EVENT_COUNT"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
    GROUP BY "EVENT_DATE"
    UNION ALL
    SELECT "EVENT_DATE", COUNT(*) AS "EVENT_COUNT"
    FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
    GROUP BY "EVENT_DATE"
) AS sub
GROUP BY "EVENT_DATE"
ORDER BY "EVENT_DATE"
LIMIT 100
Answer:
EVENT_DATE,EVENT_COUNT
20210101,22096
20210102,23599
20210103,24743
20210104,31395
20210105,42827
20210106,56076
20210107,44473
Query:
SELECT DISTINCT "USER_PSEUDO_ID"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
WHERE "EVENT_NAME" = 'purchase'
LIMIT 100
Answer:
USER_PSEUDO_ID
3351786.5083077372
40650638.8176789956
87047667.1042912591
68546038.8820428933
6101467.4740745406
15817556.8554808751
50844046.9564028621
53104811.8176614311
2783014.3813479767
53550354.6354713181
3354006.4211651279
1160488.2375923167
Query:
SELECT DISTINCT "USER_PSEUDO_ID"
FROM (
    SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
    UNION ALL
    SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
    UNION ALL
    SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
    UNION ALL
    SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
    UNION ALL
    SELECT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
) AS last5days
LIMIT 100
Answer:
USER_PSEUDO_ID
1003046.9452926974
1023282.4639847710
1026043.4481623879
1026409.1551860912
1037928.9294661675
1045950.7099606829
1054372.6755770068
1064574.6224708641
1066655.6240997015
1080064.0071613184
1097358.9593491100
1104313.9641823605
1112823.8475775772
1116587.1725520171
1127824.3503063268
1134825.6533092350
1138692.0103796281
1082746.7285674512
1164648.0319944302
1170405.4925804370
1174066.6437027818
1188134.8498680538
1215465.1474478000
1218586.5350251990
1240786.8917310160
1255322.2973246181
1259302.9069938124
1269423.6724500672
1275797.1936238018
1277765.6068129494
1318624.9067804638
1326289.2331853598
1333091.0887566663
1375005.2583322863
1422161.0871788362
1453555.6810069410
1453951.1387928223
1456890.1673716823
1459436.8826692932
1473136.1149103090
1485472.4390061373
1519124.8641457524
1543004.7243225422
1550901.3980286554
1674937.2501954408
1677450.9117017807
1707918.4797422153
1719564.6333875501
1729803.5105688857
1745072.0004799132
1749246.8534368616
1859470.4546513665
1912537.7440240268
1958116.3750166429
2244553.9738621373
2362829.7919429820
2432374.8482039518
2492721.1881800375
2692657.2939750667
1745171.2191701968
1765594.3047173009
1032138.1796039159
1051288.9523352374
1107198.5152483918
1160488.2375923167
1168297.2853699605
1205590.2516186397
1213932.4846099850
1296701.2382814729
1178889.6850461952
1246063.3665874179
1308776.9803994658
1382535.7283137323
1385112.5897617274
1396456.6482506733
1401649.9529464111
1437260.5988606411
1503421.5168556763
1515646.3111272928
1518831.1475327211
1534689.9343310805
1539940.5253610440
1564015.6880680172
1575061.4789497906
1582390.8206269591
1646722.0078157231
1693134.9790437518
1713530.3382800695
1734528.1974041204
1759212.2216007988
1762263.6990880514
1784794.0627143380
1804199.2014328535
1820733.6464417466
1846974.0316175078
1886250.8920156183
1993768.0582544668
2007362.2149327588
2019465.0056495205
2041235.3400307589
Query:
SELECT f.value
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101" t,
LATERAL FLATTEN(input => t."EVENT_PARAMS") f
WHERE t."EVENT_NAME" = 'page_view'
LIMIT 100
Answer:
Too long, hard cut:
VALUE
"{
  ""key"": ""page_location"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""
  }
}"
"{
  ""key"": ""entrances"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""medium"",
  ""value"": {
    ""string_value"": ""organic""
  }
}"
"{
  ""key"": ""campaign"",
  ""value"": {
    ""string_value"": ""(organic)""
  }
}"
"{
  ""key"": ""source"",
  ""value"": {
    ""string_value"": ""google""
  }
}"
"{
  ""key"": ""page_title"",
  ""value"": {
    ""string_value"": ""Google Dino Game Tee""
  }
}"
"{
  ""key"": ""engaged_session_event"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""page_referrer"",
  ""value"": null
}"
"{
  ""key"": ""term"",
  ""value"": {
    ""string_value"": ""<obfuscated>""
  }
}"
"{
  ""key"": ""session_engaged"",
  ""value"": {
    ""string_value"": ""0""
  }
}"
"{
  ""key"": ""ga_session_number"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""all_data"",
  ""value"": null
}"
"{
  ""key"": ""clean_event"",
  ""value"": {
    ""string_value"": ""gtm.js""
  }
}"
"{
  ""key"": ""debug_mode"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""ga_session_id"",
  ""value"": {
    ""int_value"": 3209612510
  }
}"
"{
  ""key"": ""ga_session_id"",
  ""value"": {
    ""int_value"": 3209612510
  }
}"
"{
  ""key"": ""ga_session_number"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""engagement_time_msec"",
  ""value"": {
    ""int_value"": 9
  }
}"
"{
  ""key"": ""debug_mode"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""engaged_session_event"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""page_title"",
  ""value"": {
    ""string_value"": ""Google Dino Game Tee""
  }
}"
"{
  ""key"": ""page_location"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Apparel/Google+Dino+Game+Tee""
  }
}"
"{
  ""key"": ""session_engaged"",
  ""value"": {
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""page_referrer"",
  ""value"": null
}"
"{
  ""key"": ""engaged_session_event"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""ga_session_id"",
  ""value"": {
    ""int_value"": 7473279052
  }
}"
"{
  ""key"": ""session_engaged"",
  ""value"": {
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""page_title"",
  ""value"": {
    ""string_value"": ""Home""
  }
}"
"{
  ""key"": ""ga_session_number"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""debug_mode"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""engagement_time_msec"",
  ""value"": {
    ""int_value"": 7
  }
}"
"{
  ""key"": ""page_location"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/""
  }
}"
"{
  ""key"": ""session_engaged"",
  ""value"": {
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""page_location"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/yourinfo.html""
  }
}"
"{
  ""key"": ""ga_session_id"",
  ""value"": {
    ""int_value"": 7473279052
  }
}"
"{
  ""key"": ""engagement_time_msec"",
  ""value"": {
    ""int_value"": 5
  }
}"
"{
  ""key"": ""engaged_session_event"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""ga_session_number"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""debug_mode"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""page_title"",
  ""value"": {
    ""string_value"": ""Checkout Your Information""
  }
}"
"{
  ""key"": ""page_referrer"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/yourinfo.html?""
  }
}"
"{
  ""key"": ""ga_session_number"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""page_referrer"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/basket.html?""
  }
}"
"{
  ""key"": ""debug_mode"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""page_title"",
  ""value"": {
    ""string_value"": ""Checkout Your Information""
  }
}"
"{
  ""key"": ""engagement_time_msec"",
  ""value"": {
    ""int_value"": 5
  }
}"
"{
  ""key"": ""session_engaged"",
  ""value"": {
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""page_location"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/yourinfo.html""
  }
}"
"{
  ""key"": ""ga_session_id"",
  ""value"": {
    ""int_value"": 7473279052
  }
}"
"{
  ""key"": ""engaged_session_event"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""session_engaged"",
  ""value"": {
    ""string_value"": ""1""
  }
}"
"{
  ""key"": ""engaged_session_event"",
  ""value"": {
    ""int_value"": 1
  }
}"
"{
  ""key"": ""page_referrer"",
  ""value"": {
    ""string_value"": ""https://shop.googlemerchandisestore.com/Google+Redesign/Shop+by+Brand/Google?""
  }
}"
"{
  ""key"": ""engagement_time_msec"",
  ""value"": {
    ""int_value"": 5
  }
}"
"{
  ""key"": ""ga_session_id"",
  ""value"": {
    ""int_value"": 7473279052
  }
}"
Query:
SELECT DATE_PART(hour, TO_TIMESTAMP("EVENT_TIMESTAMP" / 1000000)) AS "HOUR",
       COUNT(*) AS "EVENT_COUNT"
FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
GROUP BY "HOUR"
ORDER BY "HOUR"
LIMIT 100
Answer:
HOUR,EVENT_COUNT
0,712
1,495
2,635
3,846
4,1463
5,1142
6,1011
7,945
8,840
9,810
10,750
11,746
12,719
13,1091
14,654
15,1012
16,1515
17,763
18,829
19,925
20,936
21,1209
22,1030
23,1018
End Exploring Related Columns
Task: How many pseudo users were active in the last 7 days but inactive in the last 2 days as of January 7, 2021?

Please answer only one complete SQL in snowflake dialect in ```sql``` format.
Usage example: ```sql
SELECT "COLUMN_NAME" FROM DATABASE.SCHEMA.TABLE WHERE ... ``` (Adjust "DATABASE", "SCHEMA", and "TABLE" to match actual names, ensure all column names are enclosed in double quotations)
Follow the answer format like: ```csv
Number_of_Pseudo_Users
num:int
```

**Explanation:**

To determine the number of pseudo users who were active in the last 7 days but inactive in the last 2 days as of January 7, 2021:

1. **Identify Active Pseudo Users in the Last 7 Days:**
   - Query the events from tables `EVENTS_20210101` to `EVENTS_20210107`.
   - Extract the unique `USER_PSEUDO_ID` values to find pseudo users who were active between January 1 and January 7, 2021.

2. **Identify Pseudo Users Active in the Last 2 Days:**
   - Query the events from tables `EVENTS_20210106` and `EVENTS_20210107`.
   - Extract the unique `USER_PSEUDO_ID` values to find pseudo users who were active on January 6 or January 7, 2021.

3. **Calculate the Difference:**
   - Subtract the set of pseudo users active in the last 2 days from those active in the last 7 days.
   - The resulting set contains pseudo users who were active in the last 7 days but inactive in the last 2 days.

4. **Count the Pseudo Users:**
   - Count the number of unique `USER_PSEUDO_ID` values in the resulting set.

**Note:** `num:int` represents the integer count of such pseudo users..
Here are some useful tips for answering:
When performing a UNION operation on many tables, ensure that all table names are explicitly listed. Union first and then add condition and selection. e.g. SELECT "col1", "col2" FROM (TABLE1 UNION ALL TABLE2) WHERE ...; Don't write sqls as (SELECT col1, col2 FROM TABLE1 WHERE ...) UNION ALL (SELECT col1, col2 FROM TABLE2 WHERE ...); Don't use ['-- Include all', '-- Omit', '-- Continue', '-- Union all', '-- ...', '-- List all', '-- Replace this', '-- Each table', '-- Add other'] to omit any table. Table names here: ({database name: {schema name: {table name}}}): 
{'GA4': {'GA4_OBFUSCATED_SAMPLE_ECOMMERCE': ['EVENTS_20201101', 'EVENTS_20201102', 'EVENTS_20201103', 'EVENTS_20201104', 'EVENTS_20201105', 'EVENTS_20201106', 'EVENTS_20201107', 'EVENTS_20201108', 'EVENTS_20201109', 'EVENTS_20201110', 'EVENTS_20201111', 'EVENTS_20201112', 'EVENTS_20201113', 'EVENTS_20201114', 'EVENTS_20201115', 'EVENTS_20201116', 'EVENTS_20201117', 'EVENTS_20201118', 'EVENTS_20201119', 'EVENTS_20201120', 'EVENTS_20201121', 'EVENTS_20201122', 'EVENTS_20201123', 'EVENTS_20201124', 'EVENTS_20201125', 'EVENTS_20201126', 'EVENTS_20201127', 'EVENTS_20201128', 'EVENTS_20201129', 'EVENTS_20201130', 'EVENTS_20201201', 'EVENTS_20201202', 'EVENTS_20201203', 'EVENTS_20201204', 'EVENTS_20201205', 'EVENTS_20201206', 'EVENTS_20201207', 'EVENTS_20201208', 'EVENTS_20201209', 'EVENTS_20201210', 'EVENTS_20201211', 'EVENTS_20201212', 'EVENTS_20201213', 'EVENTS_20201214', 'EVENTS_20201215', 'EVENTS_20201216', 'EVENTS_20201217', 'EVENTS_20201218', 'EVENTS_20201219', 'EVENTS_20201220', 'EVENTS_20201221', 'EVENTS_20201222', 'EVENTS_20201223', 'EVENTS_20201224', 'EVENTS_20201225', 'EVENTS_20201226', 'EVENTS_20201227', 'EVENTS_20201228', 'EVENTS_20201229', 'EVENTS_20201230', 'EVENTS_20201231', 'EVENTS_20210101', 'EVENTS_20210102', 'EVENTS_20210103', 'EVENTS_20210104', 'EVENTS_20210105', 'EVENTS_20210106', 'EVENTS_20210107', 'EVENTS_20210108', 'EVENTS_20210109', 'EVENTS_20210110', 'EVENTS_20210111', 'EVENTS_20210112', 'EVENTS_20210113', 'EVENTS_20210114', 'EVENTS_20210115', 'EVENTS_20210116', 'EVENTS_20210117', 'EVENTS_20210118', 'EVENTS_20210119', 'EVENTS_20210120', 'EVENTS_20210121', 'EVENTS_20210122', 'EVENTS_20210123', 'EVENTS_20210124', 'EVENTS_20210125', 'EVENTS_20210126', 'EVENTS_20210127', 'EVENTS_20210128', 'EVENTS_20210129', 'EVENTS_20210130', 'EVENTS_20210131']}}

For string-matching scenarios, if the string is decided, don't use fuzzy query, and avoid using REGEXP. e.g. Get the object's title contains the word "book"
However, if the string is not decided, you may use fuzzy query and ignore upper or lower case. e.g. Get articles that mention "education".
When using ORDER BY xxx DESC, add NULLS LAST to exclude null records: ORDER BY xxx DESC NULLS LAST.
When using ORDER BY, if there are duplicate values in the primary sort column, sort by an additional column as a secondary criterion.Keep all decimals to four decimal places.
Be careful of information in nested columns. e.g. When it comes to completed purchase, `hits.eCommerceAction.action_type` Indicates the type of ecommerce action and '6' represents completed purchases.
Be careful one country may have different country_name and country_region in different columns in a database.
Don't be misled by examples. For instance, a question related to Android development on StackOverflow might include tags like 'android-layout,' 'android-activity,' or 'android-intent.' However, you should not limit your analysis to just these three tags; instead, consider all tags related to Android: "tags" LIKE '%android%'.

2025-01-22 21:21:51 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:21:51 - root - INFO - ```sql
SELECT COUNT(DISTINCT last7days."USER_PSEUDO_ID") AS "Number_of_Pseudo_Users"
FROM (
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
) AS last7days
LEFT JOIN (
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
) AS last2days
ON last7days."USER_PSEUDO_ID" = last2days."USER_PSEUDO_ID"
WHERE last2days."USER_PSEUDO_ID" IS NULL;
```
2025-01-22 21:21:51 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:21:51 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:21:51 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:21:54 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-22 21:21:54 - snowflake.connector.connection - INFO - closed
2025-01-22 21:21:54 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:21:54 - root - INFO - itercount: 1
2025-01-22 21:21:54 - root - INFO - 0
2025-01-22 21:21:54 - root - INFO - results: 
Number_of_Pseudo_Users
13442


2025-01-22 21:21:54 - root - INFO - Please check the answer again by reviewing How many pseudo users were active in the last 7 days but inactive in the last 2 days as of January 7, 2021?, reviewing Relevant Tables and Columns and Possible Conditions and then give the final SQL query. Don't output other queries. If you think the answer is right, just output the current SQL.
Keep all decimals to four decimal places.
The answer format should be like: ```csv
Number_of_Pseudo_Users
num:int
```

**Explanation:**

To determine the number of pseudo users who were active in the last 7 days but inactive in the last 2 days as of January 7, 2021:

1. **Identify Active Pseudo Users in the Last 7 Days:**
   - Query the events from tables `EVENTS_20210101` to `EVENTS_20210107`.
   - Extract the unique `USER_PSEUDO_ID` values to find pseudo users who were active between January 1 and January 7, 2021.

2. **Identify Pseudo Users Active in the Last 2 Days:**
   - Query the events from tables `EVENTS_20210106` and `EVENTS_20210107`.
   - Extract the unique `USER_PSEUDO_ID` values to find pseudo users who were active on January 6 or January 7, 2021.

3. **Calculate the Difference:**
   - Subtract the set of pseudo users active in the last 2 days from those active in the last 7 days.
   - The resulting set contains pseudo users who were active in the last 7 days but inactive in the last 2 days.

4. **Count the Pseudo Users:**
   - Count the number of unique `USER_PSEUDO_ID` values in the resulting set.

**Note:** `num:int` represents the integer count of such pseudo users. The answer should match the number of rows, the column name of the format and the filled values in the format (e.g. filled year or month). Don't output extra rows or nested rows!
Current snswer: 
Number_of_Pseudo_Users
13442
Current sql:
SELECT COUNT(DISTINCT last7days."USER_PSEUDO_ID") AS "Number_of_Pseudo_Users"
FROM (
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
) AS last7days
LEFT JOIN (
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
) AS last2days
ON last7days."USER_PSEUDO_ID" = last2days."USER_PSEUDO_ID"
WHERE last2days."USER_PSEUDO_ID" IS NULL;
2025-01-22 21:23:29 - httpx - INFO - HTTP Request: POST https://sfc-ml-sweden.openai.azure.com/openai/deployments/o1-preview/chat/completions?api-version=2024-02-15-preview "HTTP/1.1 200 OK"
2025-01-22 21:23:29 - root - INFO - ```sql
SELECT COUNT(DISTINCT last7days."USER_PSEUDO_ID") AS "Number_of_Pseudo_Users"
FROM (
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210101"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210102"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210103"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210104"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210105"
) AS last7days
LEFT JOIN (
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210106"
    UNION ALL
    SELECT DISTINCT "USER_PSEUDO_ID" FROM GA4.GA4_OBFUSCATED_SAMPLE_ECOMMERCE."EVENTS_20210107"
) AS last2days
ON last7days."USER_PSEUDO_ID" = last2days."USER_PSEUDO_ID"
WHERE last2days."USER_PSEUDO_ID" IS NULL;
```
2025-01-22 21:23:29 - snowflake.connector.connection - INFO - Snowflake Connector for Python Version: 3.12.4, Python Version: 3.11.11, Platform: Linux-6.1.62-x86_64-with-glibc2.31
2025-01-22 21:23:29 - snowflake.connector.connection - INFO - Connecting to GLOBAL Snowflake domain
2025-01-22 21:23:29 - snowflake.connector.connection - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-01-22 21:23:31 - snowflake.connector.cursor - INFO - Number of results in first chunk: 1
2025-01-22 21:23:31 - snowflake.connector.connection - INFO - closed
2025-01-22 21:23:31 - snowflake.connector.connection - INFO - No async queries seem to be running, deleting session
2025-01-22 21:23:31 - root - INFO - itercount: 2
2025-01-22 21:23:31 - root - INFO - 0
2025-01-22 21:23:31 - root - INFO - Total iteration counts: 2
